Input arguments = Namespace(data_update='valueskew', update_size=20000, dataset='bjaq', debug=False, drift_test='distribution', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=15)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 7, 'transformer': {'epochs': 40}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.7525	95th: 1.7500	median: 1.0773	mean: 1.1757
ReportEsts: [1.0714285714285714, 1.001826245760501, 1.0634448736310635, 1.0993657505285412, 1.5789473684210527, 1.0, 1.0354919384877348, 1.055709241285547, 1.0, 1.0317880794701986, 1.1751363518310103, 1.0426286703388836, 1.118890977443609, 1.1232558139534883, 1.057223595902508, 1.0, 1.0666666666666667, 1.0140086206896552, 3.0, 2.0, 1.037037037037037, 1.0798286060267337, 1.0557354011393008, 1.1379917792131533, 1.07498766650222, 1.0, 1.1571475018966078, 1.2, 1.2, 1.079136690647482, 1.0, 1.0388536290765344, 1.0074799468530091, 1.1786903440621532, 1.0111375111375112, 1.2338470534185357, 1.1737967914438503, 1.0155252087371218, 1.1582753633170328, 1.0119047619047619, 1.0939691444600281, 1.0335365853658536, 1.0, 1.041665457710721, 1.1399683488658343, 1.8615384615384616, 1.0510204081632653, 1.204946996466431, 1.0299532425289692, 1.0648148148148149, 1.1530192767068497, 1.1512027491408934, 1.039228006564897, 2.0, 1.2, 1.1578718469121485, 1.2331838565022422, 1.3725490196078431, 1.049689440993789, 1.25, 1.1133224282079244, 1.0890410958904109, 1.0636363636363637, 1.0114942528735633, 1.0, 1.081654810932235, 1.2499233363998774, 1.75, 1.0, 1.0024237904353501, 1.0072115384615385, 1.0646100116414436, 1.0447058823529412, 1.0991130508235956, 1.0611764705882354, 1.073558648111332, 1.0, 1.1127348643006263, 2.0, 1.0211770782518867, 1.03125, 1.0314306319494526, 1.1717791411042944, 1.0845771144278606, 1.1089303238469088, 1.04, 1.0759789786092444, 1.0205249913535046, 1.0490196078431373, 1.75, 1.1362025316455697, 1.0510025821858586, 1.0249221183800623, 1.0142247510668563, 1.001826484018265, 1.0389610389610389, 1.0150375939849625, 1.142300194931774, 1.0, 1.2272229522558038, 1.0554355651547875, 1.0188679245283019, 1.2371867632934603, 1.4166666666666667, 1.0099989630239479, 1.0334705075445816, 1.1598114824335903, 1.119074706105423, 1.0511955855303494, 1.1666666666666667, 2.0, 1.0549065420560748, 1.0511213171111649, 1.0732785849652557, 1.1168831168831168, 1.0588897342228203, 2.0, 1.065279091769158, 1.1942857142857144, 1.0, 1.0055248618784531, 1.0, 1.1328320802005012, 1.010530337062754, 1.0316843985400326, 1.0467289719626167, 1.8, 1.1630794701986755, 1.0, 1.0, 1.0921471000194252, 1.1818181818181819, 1.072265625, 1.0357853881565313, 1.0915619389587075, 1.0, 1.0549132947976878, 1.038581449727202, 1.039972432804962, 1.07739183424741, 1.021661279735445, 1.255813953488372, 1.0123939986953685, 1.0438597558749436, 2.0, 1.0127620783956244, 1.0251428571428571, 1.0899256254225829, 1.1025233809775896, 1.5, 1.145434729958828, 1.0135135135135136, 1.0080645161290323, 1.1074561403508771, 1.0977564102564104, 1.0454705675008813, 1.117709751909527, 1.3929154628815474, 1.0647773279352226, 1.1085526315789473, 1.2857142857142858, 1.2432432432432432, 1.0382916053019147, 1.2857142857142858, 1.0447917592518958, 1.0317425218644443, 1.1929945054945055, 1.298683234421365, 1.1328719723183391, 1.0470435450955449, 1.3073684210526315, 1.1044083526682134, 1.0938317033020237, 1.1081900910010112, 1.0536363636363637, 1.0835762876579202, 1.0321975617380432, 1.143591334012671, 1.0038204695072857, 1.0, 1.0862068965517242, 1.018688901667625, 1.0285087719298245, 1.211021505376344, 1.144736842105263, 1.1080576441102756, 1.327118969825101, 1.1071359002662164, 1.16, 1.0713636363636363, 1.0705122696750593, 1.0, 1.5454545454545454, 1.033170574230257, 1.0783353733170136, 1.0534239922292374, 1.3461538461538463, 1.0482315112540193, 1.0456178031723848, 1.07395568051069, 1.0626410835214446, 1.169811320754717, 1.2642857142857142, 1.103448275862069, 1.2352941176470589, 1.0, 1.322314049586777, 1.0689165746727645, 1.2752613240418118, 1.2528735632183907, 1.0108749382105784, 1.0031277926720286, 1.012366449285417, 1.092803240483853, 1.1852051420213994, 1.0414201183431953, 1.033236994219653, 1.0032509752925878, 1.0411712332701477, 1.0153147911090423, 1.0, 1.067080745341615, 1.0932976188131487, 1.0121234261371903, 1.1582200247218788, 1.0310366393912545, 1.2785378251230195, 1.0357142857142858, 1.0066410139570992, 1.0532490974729243, 1.0112803158488437, 1.0847457627118644, 1.0855663138932672, 1.0247582205029013, 1.1393700787401575, 2.0, 1.1534478059416735, 1.045611880303707, 1.1549460853258322, 1.1452991452991452, 1.0, 1.6666666666666667, 1.186085366068131, 1.1272727272727272, 1.106481152835948, 1.5, 1.0, 1.1111111111111112, 1.0714285714285714, 1.0425531914893618, 1.0331491712707181, 1.1033755274261603, 1.0383333333333333, 1.002103491796382, 1.1044308085402914, 1.0178571428571428, 2.0, 1.1076326774001193, 1.0490930031672905, 1.1190893169877407, 1.0129163402291061, 1.1280978712431595, 1.0398212732574996, 1.1192368839427662, 1.0973188035843178, 1.0167464114832536, 1.006997900629811, 1.0054034139751935, 1.0, 1.0000961076405575, 1.0610859728506787, 1.2045454545454546, 1.3888888888888888, 1.0219249349684132, 1.0, 1.017094017094017, 1.1300720005383218, 1.0845921450151057, 1.3258145363408522, 1.0171726682181284, 1.0576752440106478, 1.0275760249796362, 1.0647966101694915, 1.25, 1.0415423790469263, 2.5, 1.0357039606822782, 1.0498866213151927, 1.0329752856037504, 1.0526315789473684, 2.0, 1.5217391304347827, 1.0142857142857142, 1.0692876959761937, 1.0, 1.025078369905956, 1.080684596577017, 1.0080128205128205, 1.0165448863900377, 1.0738636363636365, 1.1320754716981132, 1.0095230980171566, 1.1246301186802, 1.079147246677024, 1.1196581196581197, 1.0, 1.1062052505966586, 1.2727272727272727, 1.1546762589928057, 1.0387952822240945, 1.0075062552126772, 1.208450704225352, 1.1568627450980393, 1.00960219478738, 1.0079979360165119, 1.1428571428571428, 1.0039579955333924, 1.0520231213872833, 1.0, 1.1113589098073555, 1.2380952380952381, 1.4, 1.004936706185676, 2.0, 1.1522633744855968, 1.0508720930232558, 1.070549630844955, 1.101207830070804, 1.0026178010471205, 1.123456790123457, 1.1051962283039543, 1.1068052546594938, 1.0265734265734265, 1.04322423910626, 1.010261456283385, 2.0, 1.0, 1.0570282684704861, 1.25, 1.07035175879397, 1.3529411764705883, 2.0, 1.375, 1.323293172690763, 1.0639097744360901, 1.162162162162162, 1.0108225108225108, 1.0, 1.2383488681757657, 1.0532564340441544, 2.0, 1.1959499702203693, 1.0, 1.0958172018522736, 1.0595238095238095, 1.0149042246129625, 1.152073732718894, 1.1363636363636365, 1.3619489559164732, 1.2777777777777777, 1.025875043557559, 1.0299014364931796, 1.0884057971014494, 1.0, 1.0769230769230769, 1.5714285714285714, 3.0, 1.3333333333333333, 1.0690853984667499, 1.3333333333333333, 1.016638935108153, 1.216867469879518, 1.1309319119669876, 1.0663021964128454, 1.2842430484037075, 1.0424015655962682, 1.0110208816705337, 1.063095238095238, 1.5, 1.1085450346420322, 1.0468085106382978, 1.0556165956051164, 1.0952380952380953, 1.5714285714285714, 1.0274599542334095, 1.0159480212640284, 1.0377622722975548, 1.025735294117647, 1.1464387464387464, 1.027359781121751, 1.0666666666666667, 1.0907770515613653, 1.0879237288135593, 1.2692307692307692, 1.0212464589235128, 1.1603773584905661, 1.059044771421827, 1.0552077764556425, 1.042592060965107, 1.0116279069767442, 1.2197802197802199, 1.098159509202454, 1.0, 1.0148048621226582, 1.0474230676360905, 1.0621916758465444, 1.0536344515347047, 1.040079562406763, 1.1493485859548778, 1.5714285714285714, 1.136513157894737, 1.1666666666666667, 1.219470538001708, 1.25, 1.030570081632196, 1.0237388724035608, 1.1170464316423043, 1.1541501976284585, 1.0958663148636762, 3.0, 1.2455308281649033, 1.0076273594851533, 1.124977009380173, 2.0, 1.126984126984127, 1.3080614203454894, 1.3540856031128405, 1.1083819211843031, 1.2972972972972974, 1.105263157894737, 1.004314063848145, 1.0535296579912836, 1.030918710918711, 1.1107993704359047, 1.1155701754385965, 1.056384742951907, 1.1098484848484849, 2.142857142857143, 1.0648648648648649, 1.5, 1.2267782426778242, 1.0303030303030303, 1.1217236467236467, 2.0833333333333335, 1.0686792005219146, 1.1445290346972796, 1.0869833436150524, 1.0, 1.2, 1.12, 1.284757286407039, 1.2844638949671772, 1.0, 1.0418885850007198, 1.1088938675558797, 1.0721094073767095, 1.5, 2.0, 1.010596546310832, 1.0163934426229508, 1.0066006600660067, 1.1111111111111112, 1.081626828398145, 1.103125, 1.4705882352941178, 1.054613935969868, 1.0545454545454545, 1.1561679790026247, 1.007311129163282, 1.2027766091712242, 1.0174629132110735, 1.0, 1.0571428571428572, 1.0702006988463768, 1.0283578826008308, 1.0591390878739748, 2.0, 1.077416500774165, 1.0032275328581233, 1.0220010476689365, 2.0, 1.034688995215311, 1.0467671988961167, 1.0538169399711486, 1.0727796950766677, 1.0096717828041584, 1.0435441838426913, 1.0197086546700942, 1.1130665380906462, 2.0, 1.0679621685875238, 1.8974358974358974, 1.0, 1.1347150259067358, 1.1346153846153846, 1.0193836895275565, 1.0778388278388278, 1.033736643920714, 1.0284534189995411, 1.0921246500663033, 1.0976599486000271, 1.0534345851104407, 1.2261904761904763, 4.0, 1.0034953787060377, 1.1625506072874494, 1.0421570131847637, 1.0412714245978842, 1.0839675291730086, 1.1562962962962964, 2.4022988505747125, 2.4285714285714284, 1.00051153387085, 1.0640424275511682, 1.0117913280906652, 1.1432320959880016, 1.0651272657153876, 1.0210526315789474, 1.0675062841742466, 1.0679611650485437, 1.2058371735791091, 3.0, 1.0909090909090908, 1.0276073619631902, 1.082375478927203, 1.0604982206405693, 1.2552238805970148, 1.1470588235294117, 1.4014084507042253, 1.148905109489051, 1.0963855421686748, 1.1085229235552485, 1.2417582417582418, 1.030596061161326, 2.0, 1.2157205240174673, 1.0909090909090908, 1.4242424242424243, 1.1229050279329609, 1.0043956043956044, 1.0592885375494072, 1.0570687418936446, 1.1487492839411877, 1.0, 1.3829787234042554, 1.5, 1.0, 1.0795454545454546, 1.0443548387096775, 1.0093457943925233, 1.0728155339805825, 1.0669657161166293, 1.023201856148492, 1.028866488086846, 1.1505388542257515, 1.0386398763523956, 1.0896001690170602, 1.0810810810810811, 1.0709759188846641, 1.053701015965167, 1.0361816782140107, 1.176300578034682, 1.1638932496075354, 1.021689555566817, 1.2305890354025768, 1.0806826631416195, 2.0, 1.1891891891891893, 1.082, 1.4339622641509433, 1.0, 1.0851063829787233, 1.3636363636363635, 1.3262910798122065, 1.3703703703703705, 1.1666666666666667, 1.0168966545026865, 1.1285826029402917, 1.0293334023125276, 1.0578888534014692, 1.2378378378378379, 1.1151761517615175, 1.0, 1.1079136690647482, 1.0143416818245419, 1.0623290036390682, 1.0847575438992814, 1.0130424877548696, 1.0262761936217843, 1.0623376623376624, 1.0841829009791057, 1.1420959147424512, 1.03018140233648, 1.1412112426815264, 1.2727272727272727, 1.0601265822784811, 1.0, 1.2387640449438202, 1.2081150487930148, 3.0, 1.1348912540490514, 1.0663947271386431, 1.4285714285714286, 1.0061959654178674, 1.3, 1.1176470588235294, 1.0676829314399352, 1.6923076923076923, 1.0367765249024086, 1.0397266125587357, 1.3571428571428572, 1.0, 1.0701030927835051, 1.0157819225251077, 1.0377483443708608, 1.073331608898086, 1.156547083148948, 1.0, 1.0284053877905714, 1.100609756097561, 2.0, 1.0322208639896673, 1.1121463794445887, 1.1438032166508987, 1.0202967302365564, 1.0140708635014468, 1.008849557522124, 1.8571428571428572, 1.0845709570957096, 1.0370967741935484, 1.1409566796192285, 1.1911005164878825, 1.0033485294710938, 1.034369383803062, 1.1062271062271063, 1.091795288383428, 1.2240802675585285, 1.0724501059037619, 1.0820189274447949, 1.0144927536231885, 1.0068746694870438, 1.0688559917548954, 3.0, 1.1413354079083198, 1.027064828994385, 1.0286050834269906, 1.4615384615384615, 1.4075128454381336, 1.1483050847457628, 1.1428571428571428, 1.0551244974254073, 1.0420575865415722, 1.148471615720524, 1.0294117647058822, 1.3333333333333333, 1.0633732716215332, 1.5, 1.105140186915888, 1.0, 1.01340027578404, 1.3846153846153846, 1.2362869198312236, 1.0932914046121593, 1.0, 1.689153439153439, 1.2990654205607477, 1.25, 2.0, 1.1176470588235294, 1.1448275862068966, 1.0252971654983236, 1.201765447667087, 1.090289608177172, 1.2418879056047198, 1.1014466214978942, 1.0597402597402596, 1.1778846153846154, 1.110204081632653, 1.1923076923076923, 1.0, 1.0899122807017543, 1.1168831168831168, 1.0, 1.0210319104848735, 1.0735480233068104, 1.0477057064864161, 1.1059793080959297, 1.2516628108733372, 1.1770538243626063, 1.0194647201946472, 1.5714285714285714, 1.0, 1.2142857142857142, 1.0317067617818927, 1.0617828773168578, 1.107843137254902, 1.083743842364532, 1.015807560137457, 1.0192811170502891, 1.0032910130264168, 1.1142857142857143, 1.2222222222222223, 1.05546875, 1.0186240721102864, 1.0595859965607866, 1.003554800970938, 1.013157894736842, 1.1049173065564089, 1.00733610348645, 1.2396825396825397, 1.3472505091649694, 1.125, 1.055264411624583, 1.9821428571428572, 1.1818181818181819, 1.0396600566572238, 1.0701001430615165, 1.0, 1.0631067961165048, 1.0187995320712437, 1.1296296296296295, 1.0662001767248586, 1.057110862262038, 1.34375, 1.027563025210084, 1.0381759192501803, 1.0955210851463872, 1.0572519083969465, 1.0079455164585698, 1.2072390801469588, 1.2121212121212122, 1.2142857142857142, 1.0, 1.25, 1.0726171733074967, 1.3333333333333333, 1.2393557735176104, 1.111867966183835, 1.0407620735489589, 1.066137040714995, 1.0474080990077375, 1.02475884244373, 1.032258064516129, 1.0097087378640777, 1.0134454176157044, 1.1639482564679415, 1.044505973183261, 1.2785438997952547, 1.4285714285714286, 1.0491803278688525, 1.0632411067193677, 1.0832437866130542, 1.0199335548172757, 1.311670353982301, 1.0700757575757576, 2.211206896551724, 1.0518328992155146, 1.0644295302013422, 1.0720095693779905, 1.0625, 1.0567387569717366, 1.0275823942164575, 1.339493136219641, 1.0581052631578947, 1.0666666666666667, 1.1645885286783042, 1.1043956043956045, 1.5, 1.0654276162059173, 1.5, 1.0191532258064515, 1.0885167464114833, 1.0006743088334458, 1.006439586510761, 1.0179640718562875, 2.75, 1.0717703349282297, 1.099746314202728, 1.0550252791821768, 1.0126821857937105, 1.0104120767033864, 1.1263448784082535, 1.0, 1.0746395250212044, 1.0852236591053637, 1.0225519287833829, 1.0390781563126252, 1.0208333333333333, 1.0428313796212805, 1.0048871701160171, 1.3553149606299213, 1.0239209661283408, 1.0, 1.3333333333333333, 1.0507157160869243, 1.0012663571127058, 1.234752916627146, 1.1200259475488834, 1.063048683160415, 1.076555023923445, 1.093690550117791, 1.071216233682306, 1.125, 1.0946745562130178, 1.003501400560224, 1.0868306091395474, 1.119047619047619, 1.75, 1.0453047152784531, 1.1737957485535981, 1.0150462962962963, 1.0292397660818713, 1.2335264301230993, 1.0232665694261625, 1.1785212257520383, 1.2121212121212122, 1.3076923076923077, 1.0539083557951483, 1.2055837563451777, 1.15625, 1.4333333333333333, 1.064632919879316, 1.1813676907829533, 1.1608623548922057, 1.0, 1.048543819172769, 1.035920092201306, 1.0660977242302543, 1.2795603089720737, 1.3333333333333333, 1.2727272727272727, 1.3333333333333333, 1.1361894810170672, 1.3846153846153846, 1.0, 1.1538461538461537, 1.00265604249668, 1.0670289855072463, 1.0098991151051888, 1.0741741793112887, 1.0072727272727273, 1.2830188679245282, 1.1428571428571428, 1.096774193548387, 1.135135135135135, 1.1571428571428573, 1.1145833333333333, 1.0345157129059928, 1.030496085488479, 1.3333333333333333, 1.0756720898900993, 1.0473399729743256, 2.5, 1.0666360450478038, 1.2411347517730495, 3.0, 2.0, 1.155621301775148, 1.1296708025532525, 1.0631156466030234, 1.295031055900621, 1.0, 1.0530612244897959, 1.2300613496932515, 3.0, 2.0, 1.0167625719289468, 1.1863153649684097, 1.067208961194826, 1.6666666666666667, 1.0186002150196989, 1.0472501936483347, 1.0114107883817427, 1.0, 1.107981220657277, 1.0238988429160443, 1.3157894736842106, 1.1299227088700774, 1.0300226915692092, 1.328125, 1.1640625, 1.0599623319171303, 1.0933706816059756, 1.06198347107438, 1.2105263157894737, 1.0349675588329383, 1.6527188194865574, 1.0522247096683923, 1.2694610778443114, 1.1568627450980393, 1.3134328358208955, 1.0956284153005464, 1.051782945736434, 1.010350644295168, 1.0771872006131442, 1.0971615720524017, 1.5, 1.6666666666666667, 1.0520040912868376, 1.1816182937554969, 1.1604746158334955, 1.0162369141272198, 1.0899816022746278, 1.059800128949065, 1.1080402010050252, 1.0, 1.0901658674632497, 1.1345462390335108, 1.2270426608821403, 1.1284584980237153, 1.6666666666666667, 1.0, 1.0605789432728971, 1.1162976793811683, 1.04763850302337, 1.06543208840632, 1.0049715909090908, 1.6, 1.0821744627054362, 1.0105086030132835, 1.1793465844185516, 1.182509505703422, 1.0617579745386927, 1.0129032258064516, 1.3322295805739515, 1.0129183793305931, 1.0302076869200425, 1.06524118191767, 1.0195852534562213, 1.0683994528043776, 1.0, 1.232518955349621, 1.0616601151842033, 1.0707213578500707, 1.0715239954783682, 1.118232731798382, 1.046142208774584, 1.2857142857142858, 1.2297650130548303, 1.6666666666666667, 2.0, 1.1764705882352942, 1.0025575447570332, 1.0300157977883095, 1.072057008638879, 1.0058380736495445, 1.0724559023066487, 1.0690376569037656, 1.233695652173913, 1.183673469387755, 1.071066310317978, 1.6, 1.6666666666666667, 1.1525487256371814, 1.1428571428571428, 1.106038291605302, 1.1397795591182365, 1.040709126723572, 1.0894239664994887, 2.0, 1.1371517027863778, 1.182170542635659, 1.073627844712182, 1.0397763241190126, 1.1856060606060606, 1.1116438356164384, 1.145581903763357, 1.1142017864636413, 1.0254372019077902, 1.0289855072463767, 1.0754189944134078, 1.0, 1.0, 1.0418931726333107, 5.0, 1.4285714285714286, 1.7419354838709677, 1.0554885404101326, 1.1325301204819278, 1.0731707317073171, 1.1067085131424088, 1.0, 1.1241464928615768, 1.0268691588785046, 1.109452736318408, 1.2932692307692308, 1.4285714285714286, 1.0469798657718121, 1.1341463414634145, 1.1495535714285714, 1.0580141316474525, 1.0261364201728056, 1.1033221277437215, 1.139899438036084, 1.0, 1.1965139400093074, 1.0350789466532597, 1.077116212338594, 1.1774193548387097, 1.0380106749139522]
origin-bjaq_15.71 	max: 5.0000	99th: 2.7525	95th: 1.7500	median: 1.0773	mean: 1.1757

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/15 | Workload-time: 11.972894 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=valueskew', '--dataset=bjaq', '--drift_test=distribution', '--end2end', '--update_size=20000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
ValueSample - START
ValueSample - END
load_npy_dataset_from_path - df.shape = (402168, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (20000, 5)
[2.3841858e-07 0.0000000e+00 2.3841858e-07 0.0000000e+00 6.6173077e-04]
Distance score: 0.00013244152069091797
SAUCE Drift detection: True
Detection latency: 0.0218s

DRIFT-DETECTED after 2-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=bjaq', '--end2end', '--model=transformer', '--model_update=adapt', '--update_size=20000', '--epochs=40']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
update_size: 20000
AdaptTask - START
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
load_npy_dataset_from_path - df.shape = (402168, 5)
Parsing... done, took 0.0s
done, took 0.0s
dataset size: 402168
train data shape: torch.Size([20000, 5]), transfer data shape:torch.Size([4000, 5])
Epoch 0 Iter 0, train entropy gap 0.5302 bits (loss 19.144, data 18.614) 0.00300 lr
epoch 10 train loss 12.4151 nats / 17.9112 bits
time since start: 4.3 secs
Epoch 10 Iter 0, train entropy gap -0.7652 bits (loss 17.849, data 18.614) 0.00256 lr
epoch 20 train loss 12.1257 nats / 17.4936 bits
time since start: 8.6 secs
Epoch 20 Iter 0, train entropy gap -1.1872 bits (loss 17.427, data 18.614) 0.00150 lr
epoch 30 train loss 12.0105 nats / 17.3275 bits
time since start: 12.8 secs
Epoch 30 Iter 0, train entropy gap -1.2329 bits (loss 17.381, data 18.614) 0.00044 lr
epoch 40 train loss 11.9839 nats / 17.2891 bits
time since start: 17.1 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 20.6941 nats / 29.8553 bits
Saved to: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
AdaptTask - END

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/15 | Workload-time: 2.114350 | Model-update-time: 19.698293


WORKLOAD-START | Type: QueryWorkload | Progress: 3/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 402168, total size: 402168, split index: [335140 402168]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 22.0000	99th: 4.6709	95th: 2.5729	median: 1.1522	mean: 1.3951
ReportEsts: [1.2804878048780488, 1.0004946821667078, 1.025937628424946, 1.0097087378640777, 2.0, 1.0, 1.0987105597342972, 1.0039822782216759, 1.25, 1.0160295930949446, 1.0495684695051783, 1.0171452043540767, 1.0307385229540917, 1.0134228187919463, 1.0022950819672132, 1.0, 1.0210526315789474, 1.3443588581785229, 3.0, 1.0, 1.12, 1.227239042981156, 1.0274071151748625, 1.3515873015873017, 1.1789360558839335, 1.0, 1.043697528849862, 3.0, 1.0, 1.3238095238095238, 1.0, 1.0156587776750914, 1.0132869372779687, 1.1917989417989419, 1.2139418791228382, 1.0283110023189899, 1.4134366925064599, 2.0, 1.052193645990923, 1.2384219554030875, 1.0023503887181342, 1.091389564747229, 1.0001917335451533, 1.227621483375959, 1.2323834561757665, 1.0, 1.3076923076923077, 1.6917293233082706, 1.1896551724137931, 1.087378640776699, 1.0031948147467133, 1.1647577092511012, 1.401151631477927, 1.0358806096528366, 1.0458015267175573, 1.032856877668461, 1.2385403053712924, 1.030229137637405, 1.3309859154929577, 1.0178748758689176, 1.0169491525423728, 1.040024355591638, 1.2320675105485233, 1.0909090909090908, 1.4603174603174602, 1.0909090909090908, 1.0202738283307005, 1.3492221118834824, 3.5, 1.0, 1.1274100399822302, 1.016990291262136, 1.0808534531162268, 1.378494623655914, 1.1416945907132598, 2.1683673469387754, 1.0105633802816902, 1.5, 1.024928483857785, 1.0829562594268476, 1.0059876608710152, 1.6, 1.6866188046016781, 1.125, 1.0434782608695652, 1.0806599450045828, 1.1666666666666667, 1.037930995008929, 1.035759471831796, 1.2146892655367232, 1.1666666666666667, 1.4562383612662941, 1.0069817038949378, 1.0417910447761194, 1.3427495291902072, 1.3653366583541147, 1.0909090909090908, 3.5714285714285716, 1.6640625, 1.0, 1.0944005438015125, 1.4059142890146703, 1.0519902518277824, 1.0339347675225539, 1.0606060606060606, 1.019265267687393, 1.02598385469223, 1.2397211479747607, 1.130928252938792, 1.0706123644887195, 1.5, 1.3333333333333333, 1.1112748710390568, 1.020502012810116, 1.102456560814859, 1.0125, 1.0473215090597674, 1.0, 1.3136200716845878, 1.5842391304347827, 1.0, 1.1518987341772151, 1.0, 1.6419753086419753, 1.0139240074970182, 1.1687235695175628, 1.6470588235294117, 2.25, 1.1090750436300174, 1.0, 4.666666666666667, 1.0014700728221504, 1.1538461538461537, 1.0701522170747848, 1.0254634537017409, 1.2373891554004943, 4.633802816901408, 1.105263157894737, 1.278125, 1.0636908002177463, 1.0698393077873918, 1.2404164312807684, 2.16, 1.084840923268871, 1.0349820359281436, 1.0, 1.1468842729970326, 1.1729222520107239, 1.0921985815602837, 1.3340395480225988, 1.5, 1.0264494037076397, 1.448888888888889, 1.1670378619153674, 5.390804597701149, 1.4150197628458498, 1.0070828546160449, 1.0524405108908792, 1.261475456458677, 1.2214285714285715, 1.249211356466877, 1.0638297872340425, 2.4210526315789473, 1.0289017341040463, 1.1666666666666667, 1.020100245934423, 4.483969465648855, 1.412483039348711, 1.0025867937372361, 1.3620689655172413, 1.3384810083286303, 2.3514851485148514, 1.4705882352941178, 1.0633665299746142, 1.0133079847908746, 1.165556612749762, 1.0239852398523985, 1.0794058840331333, 1.1524757780059829, 1.0523915237134207, 1.41, 1.1669477234401349, 1.2605616455228477, 1.0923686182168468, 1.0858369098712446, 1.0216690728515303, 1.10625, 1.4, 1.0047411960893307, 1.0065489911784111, 1.1153846153846154, 1.3499610288386594, 1.0965829373161349, 1.2339080812419463, 1.1933547166707787, 1.0378061166911183, 1.2382271468144044, 1.1011451909986385, 1.1204620462046204, 1.1428571428571428, 1.66, 2.0, 1.1909364800401707, 1.3937007874015748, 1.8333333333333333, 1.8666666666666667, 1.0, 1.3790322580645162, 1.0242310577644411, 1.5434083601286173, 1.3181818181818181, 1.0562116202172886, 3.7804878048780486, 1.0191382297137515, 1.0337078651685394, 1.010939131224184, 1.1666666666666667, 1.4537931034482758, 1.3724832214765101, 1.035322527832351, 1.1876990933594707, 1.0, 1.167230546157564, 1.03781240157845, 1.0182564833729715, 1.2677760968229954, 1.0162272315588206, 1.0388220621957598, 1.0740740740740742, 1.0021057047870927, 1.0971099681606662, 1.224773091297384, 1.6271186440677967, 1.5203405865657522, 1.0696948682385576, 1.5815691158156913, 1.0, 1.2367036820572765, 1.0770950301517987, 1.1264853445999472, 1.0850202429149798, 1.0909090909090908, 3.6666666666666665, 1.2796732232074537, 1.1372549019607843, 1.0945917091175303, 1.5, 1.5, 1.0763052208835342, 1.026106526631658, 1.0115422029332535, 1.0924369747899159, 1.474339035769829, 1.5933503836317136, 1.098997995991984, 1.2477296879528548, 2.28, 2.0, 1.2810800131708924, 1.0458583925642428, 1.830128205128205, 1.23680128238275, 1.1526684036417927, 1.0845923494679142, 1.0316114109483423, 1.0844472839263481, 1.0681544028950543, 1.09155672823219, 1.5611579754601228, 1.8333333333333333, 1.198744348126602, 1.0446601941747573, 1.1111111111111112, 1.24, 1.288307051472776, 1.3888888888888888, 1.1574803149606299, 1.0211750593266748, 1.3530927835051547, 1.2270114942528736, 1.023843219636243, 1.0175718849840256, 1.01792801208785, 1.0107005264537992, 1.6666666666666667, 1.0392239561366512, 1.1596406357982032, 1.0096075851253672, 1.0944821405709897, 1.0143487410320369, 1.3523002421307506, 1.0837912087912087, 1.18692218798151, 1.422213195613068, 1.062767387849896, 1.073036315986522, 1.0183982683982684, 2.0, 1.5454545454545454, 1.0788550323176362, 4.848739495798319, 1.0020325203252032, 1.0076874774037639, 1.3815261044176708, 1.0909090909090908, 1.2475247524752475, 1.3284916201117318, 1.0171319796954315, 1.008517387218045, 1.3333333333333333, 1.0598596212422196, 1.0193056826458011, 1.1701030927835052, 1.0508474576271187, 1.4941634241245136, 1.1276073619631901, 1.7142857142857142, 1.036995402959345, 1.0504347826086957, 1.8181818181818181, 1.28211065501877, 1.1428571428571428, 2.0, 1.0836079432046777, 2.0, 4.657559198542805, 1.323076923076923, 1.038974358974359, 1.2514619883040936, 1.5506072874493928, 1.1818181818181819, 1.0112461808489892, 1.0093718889995023, 1.1233766233766234, 1.004729034871763, 1.302694649566006, 4.0, 1.2857142857142858, 1.3123500479846448, 2.0, 1.120758483033932, 1.5294117647058822, 5.0576923076923075, 1.0952380952380953, 1.8863636363636365, 1.0092905405405406, 1.8208955223880596, 2.4705882352941178, 1.0, 1.76084407971864, 1.0413610634698571, 3.5, 1.004169148302561, 1.0, 1.009768045370384, 1.8936170212765957, 1.0439420752224522, 1.1196581196581197, 1.068062827225131, 1.0630417651694248, 1.4210526315789473, 1.0106796531248665, 1.0069318949727708, 1.0093209054593875, 1.0, 1.2727272727272727, 1.0, 1.5, 1.125, 1.2282734646581692, 1.6, 1.2172619047619047, 1.1382978723404256, 1.1665862833992475, 1.0077188180611998, 1.071278825995807, 1.1965019849398868, 1.01969611705121, 1.3063763608087091, 1.5, 1.6653465346534653, 1.2566844919786095, 1.003214864410971, 1.05, 22.0, 4.670850767085077, 1.3063063063063063, 1.1277448865005968, 1.036848792884371, 1.2447457627118643, 1.021437908496732, 1.0666666666666667, 1.0101647388713635, 1.0646186440677967, 1.5, 4.171717171717172, 1.0969773299748111, 1.3737800052756528, 1.0271836007130124, 1.2437034961551632, 1.7307692307692308, 1.2758620689655173, 1.504201680672269, 1.0, 1.0932261740823401, 1.0728909198904026, 1.0886644700243913, 1.0023316964636872, 1.4865671641791045, 1.1233572281959379, 1.1818181818181819, 1.1155085135757017, 1.3333333333333333, 1.03, 1.8333333333333333, 1.0331884671367075, 1.449579831932773, 1.111919100102261, 1.0344827586206897, 1.3038728897715988, 3.0, 1.4003281378178836, 1.002291237960193, 1.0286125283765255, 2.0, 1.6097560975609757, 2.339673913043478, 2.8292682926829267, 1.098194331122069, 1.2888446215139442, 1.2352941176470589, 1.00990099009901, 1.2773382690987252, 1.1204232273173995, 1.0405421223370457, 1.1262040009878982, 1.5612535612535612, 1.4343434343434343, 5.0, 1.1117021276595744, 1.8695652173913044, 1.089308996088657, 2.8055555555555554, 1.0403028975530384, 1.5625, 4.556701030927835, 1.167442832407905, 3.1555555555555554, 2.5, 2.9705882352941178, 1.0978886756238004, 1.2324224034633373, 1.0625, 1.1802120141342756, 1.0079211685307816, 1.060660318493801, 1.4736842105263157, 1.2201117318435755, 2.0, 1.1031307550644567, 1.1310228233305157, 1.340983606557377, 1.5555555555555556, 1.0925038388162487, 1.174524400330852, 1.173913043478261, 1.0871088276506304, 1.017391304347826, 1.2235649546827794, 1.1807044410413476, 1.0242931103146158, 1.1663765399035886, 1.0, 1.7619047619047619, 1.2738919870854124, 1.0561938499744357, 1.2333246716904196, 1.0, 1.005625, 1.0017816151026142, 1.0076258261311641, 1.0, 1.031308940022633, 1.2147605907667671, 1.3630964324411092, 1.0479617304492512, 1.055534990053981, 1.2629405780623542, 1.2084664536741214, 1.2316289466331378, 1.5, 1.0609139700901464, 2.466666666666667, 1.4, 4.298130046748831, 1.5294117647058822, 1.0467947163849938, 1.2185686653771761, 1.1458476231821142, 1.0731593662628145, 1.0181491886810592, 1.1858582773365913, 1.014044365275961, 1.0642201834862386, 5.0, 1.0617429784644572, 1.0003827751196173, 1.0356619679010093, 1.0053604317667433, 1.048885511651469, 1.1325301204819278, 1.260115606936416, 1.5714285714285714, 1.043465665624585, 1.0094860646718868, 1.0105795000219675, 1.0851326341764342, 1.019857493283495, 1.1257731958762887, 1.0080980066445182, 1.0729684908789385, 1.2140266021765418, 1.187597707139135, 1.2623481781376518, 1.1046361046361046, 1.0068493150684932, 1.6842105263157894, 1.173913043478261, 1.507620164126612, 1.1806144067796611, 1.2427184466019416, 1.4038461538461537, 1.012654023996662, 1.3008849557522124, 1.208316747227751, 2.0, 1.2408510638297872, 1.2619047619047619, 1.0205479452054795, 1.0146103896103895, 1.3916849015317287, 1.020912547528517, 1.089452603471295, 1.0032845185915078, 1.0, 1.2553191489361701, 2.2222222222222223, 1.3333333333333333, 1.1363636363636365, 1.712784588441331, 1.0710743801652893, 1.40990990990991, 1.0012139605462822, 1.1615384615384616, 1.0104098057800126, 1.1353888028532544, 1.0399923126355048, 1.086834457588151, 1.0601186633688502, 1.2388535031847134, 1.1606001992849189, 1.0428935399503956, 1.4994954591321896, 1.3100511073253833, 1.233375156838143, 1.8129032258064517, 1.0137683188649305, 1.0097560975609756, 1.0110044642857143, 1.7798165137614679, 1.5532200357781754, 1.0218579234972678, 2.0, 1.2584070796460176, 1.2941176470588236, 1.0788530465949822, 2.3333333333333335, 1.5, 1.0824781522863105, 1.041819961521585, 1.0462371608106458, 1.1973627879099238, 1.2972972972972974, 1.4230769230769231, 3.0, 1.4128440366972477, 1.0469464622006994, 1.2889718218235355, 1.0340774126747267, 1.083395167106854, 1.1048005409060175, 1.158640226628895, 1.0526825994556503, 1.046468401486989, 1.038336891238704, 1.0060324491743649, 1.15625, 1.0066730219256435, 3.984848484848485, 1.1661768464094044, 1.0, 1.125, 1.2406417112299466, 1.0095617529880478, 1.7142857142857142, 1.1250638776274997, 1.1, 1.5714285714285714, 1.055339701764493, 1.0682842287694974, 1.0621024828314845, 1.0000373003498773, 1.216763005780347, 1.95, 1.2307692307692308, 1.300751879699248, 1.3847682119205298, 1.0598709103049189, 1.0186521930791272, 1.037948473402186, 1.0, 1.0127289661595777, 2.8771929824561404, 2.0, 1.2144137583328665, 1.01193498181455, 1.3379746835443038, 1.019892597384275, 1.1896672300250597, 1.7, 1.1428571428571428, 1.2812725958062183, 1.8902439024390243, 1.0397004874616815, 1.0877613986972918, 1.2088142163442355, 1.0171246353212566, 1.230899830220713, 1.1782456140350877, 1.2777777777777777, 1.117122248515195, 1.187947494033413, 1.3916167664670658, 1.2048484848484848, 3.1785714285714284, 4.451778825546507, 1.27625, 1.4444444444444444, 1.6666666666666667, 1.062849162011173, 1.1575293272683744, 1.0003518648838845, 1.0724856538810028, 1.4444444444444444, 1.2765388046387154, 1.1919961886612673, 1.3571428571428572, 1.247156291064389, 2.3333333333333335, 1.4105263157894736, 2.0, 1.0334075723830736, 2.3333333333333335, 1.0144216424095747, 1.0810810810810811, 1.6798418972332017, 1.0731969860064585, 1.0, 1.7085337676603158, 1.098419540229885, 2.0, 4.0, 1.75, 3.258426966292135, 1.3436358527676313, 1.2069377990430623, 1.1125, 1.2272174969623328, 1.0717439293598234, 1.0693333333333332, 1.023715415019763, 1.5408805031446542, 2.6, 1.0, 2.430317848410758, 1.026685393258427, 1.211514392991239, 1.4945803654382162, 1.0206384607702805, 1.2699125142639787, 1.009383368494328, 1.2171770503343893, 1.150197628458498, 1.0458333333333334, 1.8333333333333333, 2.0, 1.8, 1.2630237038599048, 1.1584800741427248, 1.084639498432602, 1.0254041570438799, 1.074082729609722, 1.2363955142412915, 1.0012220513666994, 1.064102564102564, 1.5714285714285714, 1.0626780626780628, 1.2614329905526294, 1.0698087391924544, 1.0147182348147683, 1.034013605442177, 1.127063097212351, 1.0002412884080727, 1.010843373493976, 1.1203453858607664, 1.0, 1.2035214914552046, 2.3617021276595747, 2.1666666666666665, 1.0971428571428572, 1.07856093979442, 1.0, 1.06651376146789, 1.0732037193575654, 2.5714285714285716, 1.0157660599448342, 1.4131736526946108, 1.4186046511627908, 1.0289546151098616, 1.0633948192049012, 1.3343785058826914, 1.0764762826718297, 1.393987341772152, 1.0424618320610688, 1.3892857142857142, 4.666666666666667, 1.0, 2.2, 1.019256461049431, 1.8333333333333333, 1.102414117880335, 1.0203351780306986, 1.1964698466064299, 1.1314944266011713, 1.0237907459901845, 1.2521809153133807, 1.384126984126984, 1.0479651162790697, 1.1059507284355825, 1.2983235464143366, 1.0368974157257387, 1.0252629738628747, 1.4285714285714286, 4.585782843431314, 1.0765957446808512, 1.007477312778958, 1.4413145539906103, 1.05729794933655, 1.1844863731656186, 1.478386167146974, 1.207527697410204, 1.6817155756207676, 1.0064993352952538, 1.1875, 1.0131820112206353, 1.0314791127195582, 1.1810986964618249, 1.0706033376123234, 1.565217391304348, 1.2420212765957446, 4.674418604651163, 1.0666666666666667, 1.2597016194159902, 1.0384615384615385, 1.1395856052344602, 1.3501483679525224, 1.5464025026068822, 1.1825965750696934, 1.0922222222222222, 5.5, 1.1789473684210525, 1.0042611899896963, 1.0399945107726087, 1.0012161233278305, 1.1310061283065704, 1.0151953240373703, 1.0, 1.134288272157565, 1.6307741318891367, 1.1285268037081821, 1.0247855100095329, 1.0567375886524824, 1.0920271416454623, 1.3815291445874338, 1.3528722157092614, 1.0, 1.0, 4.0, 1.0035437701437366, 1.176111458985598, 1.0938036834325437, 1.2732442892203133, 1.0138355111452728, 1.171875, 1.0049572681610315, 1.1195596077756753, 1.5491228070175438, 1.0216216216216216, 1.205069124423963, 1.0002092609600428, 1.1573033707865168, 2.3333333333333335, 1.0478673777044478, 1.0475118186965855, 1.2048040455120101, 1.0689655172413792, 1.85993265993266, 1.0075520660057222, 1.2685449358059915, 1.1413333333333333, 1.4444444444444444, 1.0859269282814614, 4.582617316589557, 1.3746223564954683, 1.302325581395349, 1.1746504583659305, 1.1198668146503885, 1.0561622464898597, 1.0731707317073171, 1.1944500939141254, 1.05686167304538, 1.004388056853954, 1.078994277136692, 1.3333333333333333, 1.4285714285714286, 2.0, 1.0978967495219885, 1.25, 1.0, 1.6666666666666667, 1.0768211920529802, 1.0035026269702276, 1.198984436279569, 1.2818822088394406, 1.1652542372881356, 1.511111111111111, 1.2142857142857142, 1.6842105263157894, 1.2982456140350878, 1.6666666666666667, 1.148479427549195, 1.0271153034857354, 1.0049318504713955, 1.32, 1.008409745873723, 1.0323263166162668, 2.5, 1.0289914148808732, 1.3717472118959109, 1.5, 3.6666666666666665, 1.0727876774388403, 1.124167495981015, 1.2560320713227924, 1.2763975155279503, 1.0, 1.1440677966101696, 1.304, 4.0, 1.0770494035159375, 1.021277277020861, 1.000516490813842, 1.1446212301116125, 2.5, 1.0069429377305272, 1.1510685335298452, 1.864244741873805, 2.142857142857143, 1.3260340632603407, 1.0, 1.3846153846153846, 1.115484769575486, 1.272357121705656, 1.1336760925449871, 1.0037593984962405, 1.1934167506575875, 1.072522159548751, 1.905511811023622, 1.6666666666666667, 1.250582140842181, 1.1276205450733752, 1.2240654332374803, 6.518518518518518, 1.1333333333333333, 4.591182364729459, 1.3333333333333333, 1.0054768041237114, 1.1266666666666667, 1.0079989424745532, 1.2937853107344632, 3.0, 1.25, 1.0493250417109055, 1.4423657211828607, 1.3981506663040522, 1.0331310964772227, 1.1859629209231934, 1.1109384037015615, 1.2114882506527416, 1.3333333333333333, 1.0631846324813463, 1.0641226766957912, 1.180221210149642, 1.1892430278884463, 1.6666666666666667, 1.54, 1.0292619977678572, 1.0495260663507109, 1.272934868943606, 1.0138538571503417, 1.390715667311412, 1.6, 1.7258064516129032, 1.2230779606150526, 1.0803550572296192, 1.3054545454545454, 1.00864392070887, 1.4537037037037037, 1.2699386503067485, 1.1673684210526316, 1.0139392922321746, 1.0138672915113431, 1.2135922330097086, 1.0751515151515152, 1.206896551724138, 1.1343283582089552, 1.6669980338878212, 1.0028913340293952, 1.1781998791865227, 1.0825785828449654, 1.6545682102628285, 2.6666666666666665, 1.2356687898089171, 1.25, 1.0, 1.7058823529411764, 1.0541237113402062, 1.1306306306306306, 1.0843447298901183, 1.0899914660527517, 1.0428802588996764, 1.0879601990049752, 1.4603174603174602, 1.0388349514563107, 1.0514576828266229, 2.6666666666666665, 1.3076923076923077, 1.187454677302393, 1.3333333333333333, 1.2171799027552674, 1.1118314424635332, 1.6815701727796302, 1.0067707645839319, 2.5, 1.0456458400776951, 1.1149897330595482, 1.3813296589734758, 1.0230956872293648, 1.4887218045112782, 1.23609443777511, 1.0659135078191693, 1.1601023656450908, 1.2273449920508743, 1.4444444444444444, 1.048342541436464, 1.0, 1.0, 1.0265600948855138, 2.5, 3.5, 2.175438596491228, 1.0335648148148149, 1.709090909090909, 1.0434304562946675, 1.2077963917525774, 6.0, 1.2088757396449703, 1.0267045454545454, 1.1973094170403586, 1.7651821862348178, 1.25, 1.3642633228840126, 1.147254073627037, 1.2559852670349907, 1.2310030395136777, 1.0015575941161652, 1.4022367429002263, 1.1656870976770222, 1.0, 1.01789069520464]
origin-bjaq_15.71 	max: 22.0000	99th: 4.6709	95th: 2.5729	median: 1.1522	mean: 1.3951

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/15 | Workload-time: 11.935299 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 4/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=valueskew', '--dataset=bjaq', '--drift_test=distribution', '--end2end', '--update_size=20000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
ValueSample - START
ValueSample - END
load_npy_dataset_from_path - df.shape = (422168, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (402168, 5), new data size: (20000, 5)
[1.7881393e-07 5.9604645e-08 1.7881393e-07 2.9802322e-07 5.9217215e-04]
Distance score: 0.00011857748177135363
SAUCE Drift detection: True
Detection latency: 0.0335s

DRIFT-DETECTED after 4-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=bjaq', '--end2end', '--model=transformer', '--model_update=adapt', '--update_size=20000', '--epochs=40']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
update_size: 20000
AdaptTask - START
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
load_npy_dataset_from_path - df.shape = (422168, 5)
Parsing... done, took 0.0s
done, took 0.0s
dataset size: 422168
train data shape: torch.Size([20000, 5]), transfer data shape:torch.Size([4000, 5])
Epoch 0 Iter 0, train entropy gap 0.0300 bits (loss 18.615, data 18.585) 0.00300 lr
epoch 10 train loss 12.2520 nats / 17.6759 bits
time since start: 4.3 secs
Epoch 10 Iter 0, train entropy gap -0.8644 bits (loss 17.720, data 18.585) 0.00256 lr
epoch 20 train loss 11.9956 nats / 17.3060 bits
time since start: 8.7 secs
Epoch 20 Iter 0, train entropy gap -1.1744 bits (loss 17.410, data 18.585) 0.00150 lr
epoch 30 train loss 11.8757 nats / 17.1331 bits
time since start: 12.9 secs
Epoch 30 Iter 0, train entropy gap -1.3807 bits (loss 17.204, data 18.585) 0.00044 lr
epoch 40 train loss 11.8440 nats / 17.0873 bits
time since start: 17.2 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 20.3305 nats / 29.3308 bits
Saved to: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
AdaptTask - END

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 4/15 | Workload-time: 2.057160 | Model-update-time: 19.621490


WORKLOAD-START | Type: QueryWorkload | Progress: 5/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 422168, total size: 422168, split index: [351806 422168]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 6.0000	99th: 3.7778	95th: 2.5000	median: 1.1427	mean: 1.3453
ReportEsts: [1.6237113402061856, 1.0409313725490197, 1.0328616005295175, 1.6774193548387097, 1.875, 1.0, 1.1449983708048224, 1.0326490420462282, 1.2, 1.2, 1.081732776617954, 1.0158188228093117, 1.016337386018237, 1.1508515815085159, 1.03562421185372, 5.5, 1.1079136690647482, 2.0, 2.0, 1.1140819964349375, 1.207625856419422, 1.0528134254689043, 1.2608813743464384, 1.0, 1.0848090591495, 1.007082934726617, 2.0, 1.0792834538878842, 3.0, 1.25, 1.0431654676258992, 1.0, 1.003778554501916, 1.0186484633334438, 1.4555735056542811, 1.0109873793615443, 1.0270432313032503, 1.5151515151515151, 1.5, 1.2241379310344827, 1.0195822454308094, 1.077800770247744, 1.084918535492241, 1.0164223046000058, 1.0100200400801602, 1.442600428642084, 1.35, 1.6097560975609757, 2.042372881355932, 1.1548117154811715, 1.043859649122807, 1.0308586359131453, 1.1607142857142858, 1.1497005988023952, 1.0090453489793423, 1.213740458015267, 1.0401044655046199, 1.1921564256484563, 1.0066760735421099, 1.0347222222222223, 1.0383540122658679, 1.140625, 1.0000185949644835, 1.825, 1.264367816091954, 1.1649484536082475, 2.8361344537815127, 1.1567026026353044, 1.0977646108268246, 3.5, 1.0, 1.0055182952712454, 1.0798969072164948, 1.140044994375703, 1.1522633744855968, 1.1187640449438203, 1.3364779874213837, 1.3054945054945055, 1.6666666666666667, 1.0803809523809524, 1.0215311004784688, 1.0472348498407131, 1.3846153846153846, 1.547785362755993, 1.0153846153846153, 1.2354709418837675, 1.0930888575458393, 1.0666666666666667, 1.0005453662952721, 1.0195740268534488, 1.0865384615384615, 3.5, 1.2649793388429753, 1.0782283019514256, 1.1121794871794872, 1.1037151702786379, 1.2237442922374429, 2.319277108433735, 1.0333333333333334, 1.5714285714285714, 1.0, 1.031156186612576, 1.4246694334523695, 1.2058596761757903, 1.015429592333929, 1.4, 1.0169327281073086, 1.0141929275920134, 1.4685352622061483, 1.3113528212100611, 1.0204826038159371, 1.5, 1.0, 1.0647662963739257, 1.005418302234294, 1.161639157655094, 1.2261904761904763, 1.0092301754912576, 1.0, 1.032796486090776, 1.2871883061049012, 1.0, 1.0769230769230769, 1.2857142857142858, 1.0871934604904632, 1.0159923242047746, 1.0305537412003773, 1.7777777777777777, 2.25, 1.0776699029126213, 1.0, 1.6470588235294117, 1.0252654399911056, 2.1666666666666665, 1.0971908298353246, 1.0447268937840204, 1.2238090673823445, 2.442857142857143, 1.0952380952380953, 1.0595854922279793, 1.1786588350465002, 1.1361141602634468, 1.1812740774898887, 1.0253164556962024, 1.082437275985663, 1.095780581410737, 2.0, 1.0792035398230089, 1.1142857142857143, 1.1310432569974556, 1.1111764705882352, 1.5, 1.0802103879026956, 1.3466666666666667, 1.1557894736842105, 1.2800829875518671, 1.4609375, 1.0010153889483189, 1.1379002131414298, 1.1101768628587996, 1.0516882034180908, 1.309090909090909, 1.1263803680981594, 1.142161635832522, 1.3865771812080536, 1.1666666666666667, 1.0072965183446632, 2.479357798165138, 1.2244897959183674, 1.1408220804273632, 1.5714285714285714, 1.0063222050395706, 1.1501210653753027, 1.1226415094339623, 1.0391320138006175, 1.0815533980582523, 1.2263565891472867, 1.238562091503268, 1.1830670926517572, 1.2749185024202312, 1.0314328278692568, 2.161764705882353, 1.1170520231213872, 1.2174416391778737, 1.1868131868131868, 1.1201716738197425, 1.156313834726091, 1.3159851301115242, 1.75, 1.0646915722763686, 1.0181825359229433, 1.2692307692307692, 1.177461139896373, 1.154779762716487, 1.1252308208829949, 1.0055841717614211, 1.1848290598290598, 1.1931211172323717, 1.078661638531042, 1.0177935943060499, 1.4694444444444446, 1.0409792442788717, 1.0317836434806271, 1.0361207323107373, 1.100069573283859, 2.269230769230769, 1.4782608695652173, 2.0, 1.0, 4.066666666666666, 1.072333118694999, 1.1094674556213018, 1.3384615384615384, 1.0794734275962945, 2.473684210526316, 1.0077839207729615, 1.7951219512195122, 1.0302847282139775, 2.08, 1.2210526315789474, 1.054539914686167, 1.034285330286943, 1.2849000751093504, 1.0, 1.3298458149779735, 1.0498373727835484, 1.00897559486285, 1.225621414913958, 1.011077590270576, 1.0235782605471937, 1.0357142857142858, 1.004219580785538, 1.0364772334894752, 1.0372881355932204, 1.009587727708533, 1.3047285464098073, 1.2222222222222223, 1.147244805781391, 1.0, 1.2930033608310418, 1.0228621461231637, 1.4649725274725274, 1.558139534883721, 1.0909090909090908, 2.6666666666666665, 1.2030764022596958, 1.1311475409836065, 1.097067892256676, 3.0, 1.0, 1.6766467065868262, 1.111059551430781, 1.0662050983915579, 1.167464114832536, 1.0284810126582278, 2.802908972054257, 1.0915708812260536, 1.1936736061369255, 1.9655172413793103, 1.0, 1.3057065764568483, 1.0009349289454001, 1.085551330798479, 1.3988653975494927, 1.1530397094998244, 1.0352098016474856, 1.06071964017991, 1.0941113408377365, 1.047006155567991, 1.0222222222222221, 1.9803015564202335, 1.2222222222222223, 1.229460501247951, 1.257799671592775, 1.2608695652173914, 1.0, 1.0727272727272728, 2.876809614859328, 1.0089897926488762, 1.0183591071836673, 1.6443914081145585, 1.4967105263157894, 1.0121569349788175, 1.0281910728269381, 1.1238316987183008, 1.0048525641335155, 3.3333333333333335, 1.0944913550462405, 1.541033434650456, 1.00956976447581, 1.013123746328108, 1.0248974832227722, 1.1186342592592593, 1.2931570762052877, 1.1543881555476276, 1.2131967131967132, 1.0041138814663872, 1.0480826885189733, 1.1521197007481296, 1.0, 1.0, 1.0219169120052338, 2.6344238975817924, 1.0155945419103314, 1.175736606732061, 1.1903114186851211, 1.3870967741935485, 2.8857142857142857, 1.5466804979253113, 1.070808283233133, 1.0000206541869479, 1.5555555555555556, 1.0248462793324131, 1.0157855976433672, 1.5319148936170213, 1.1206896551724137, 2.117493472584856, 1.154692253685935, 1.8571428571428572, 1.029035851286062, 1.1305970149253732, 1.2352941176470589, 1.3219744243673919, 1.75, 1.125, 1.0727099146239703, 2.0, 2.805452865064695, 1.2623853211009175, 1.2358674463937622, 1.0449708204600068, 1.1133720930232558, 1.010989010989011, 1.0243869576933442, 1.0190291117007362, 1.2026143790849673, 1.0548323718425399, 1.1014369732613836, 2.0, 1.3333333333333333, 1.1889740245625475, 1.0, 1.02099609375, 1.3529411764705883, 2.676190476190476, 2.5, 1.2008032128514057, 1.063793103448276, 1.1779661016949152, 1.0935616872819538, 1.2916666666666667, 1.3333333333333333, 1.1957441993583684, 1.2467443454420837, 1.0769230769230769, 1.2798222302298696, 1.7829457364341086, 2.096590909090909, 1.3669849931787177, 1.0, 2.0, 1.0248853962017026, 1.2954545454545454, 1.1432068543451652, 1.0065763274965582, 1.0664566026926383, 2.3819444444444446, 2.0, 1.0070209934342174, 1.3048703352308666, 1.1666666666666667, 1.3399911229471815, 1.2542722968101483, 1.75, 1.1994274809160306, 1.2696629213483146, 1.0143517222066647, 1.049150229500062, 1.0918238993710692, 1.122476266880599, 1.0226541946799181, 2.965670170827858, 1.0875912408759123, 1.1630115605407265, 1.1968503937007875, 3.75, 1.0151325988118647, 1.0388289214426454, 3.6363636363636362, 2.0951193204799785, 1.2328767123287672, 1.1090909090909091, 1.0138175817267394, 1.7555555555555555, 2.3088235294117645, 1.1971830985915493, 1.5846153846153845, 1.625, 2.979591836734694, 1.2712895377128954, 1.099300484891155, 1.1522770398481974, 1.0915997290235169, 1.6491228070175439, 1.7903225806451613, 1.4793388429752066, 1.0, 1.0064011782699824, 1.0427691062030497, 1.0741735873636216, 1.0259193243788063, 1.3942141047860286, 1.0135249366018597, 1.375, 1.1496478873239437, 2.0, 1.3730407523510972, 2.75, 1.003156238749735, 4.131736526946108, 1.2313603073598272, 1.4666666666666666, 1.107457898957498, 3.0, 1.3929008567931456, 1.0054772132469052, 1.0751410195033615, 2.0, 1.36, 1.6365979381443299, 1.5064935064935066, 1.1161807481566663, 1.2591170825335893, 1.1666666666666667, 1.4806629834254144, 1.2436996773537192, 1.217136496831202, 1.0326315789473683, 1.2009481169344218, 1.2586206896551724, 2.0, 1.020857929948839, 1.0470914127423823, 1.5666666666666667, 1.1142322097378277, 2.1906693711967544, 1.0058637539522852, 1.25, 1.797872340425532, 1.0742205740969648, 2.393258426966292, 1.6666666666666667, 3.533333333333333, 1.0575657894736843, 1.1973862100045065, 1.0555555555555556, 1.0902117213869285, 1.1501468208785282, 1.0937916333599786, 1.4181818181818182, 1.1405835543766578, 1.0157504632489192, 1.198090692124105, 1.0532094594594594, 1.4950819672131148, 1.2222222222222223, 1.0495498792358926, 1.0726338958180484, 2.9, 1.0124041185819916, 1.2765957446808511, 1.0616996507566938, 1.6289034132171387, 1.0291601866251945, 1.1893091206990716, 1.0, 1.2542372881355932, 1.2275413319168713, 1.0000207651256636, 1.2866645813783755, 1.0, 1.0068843430369787, 1.0087186566810447, 1.358041032428855, 1.0, 1.028115237764665, 1.1390803056710015, 1.4784330794341676, 1.0617466070976986, 1.0353187130703316, 1.3941736028537455, 1.0417981072555205, 1.1549504950495049, 2.0, 1.0735826296743063, 2.242424242424242, 1.6666666666666667, 2.7195916594265857, 1.7333333333333334, 1.041055480877235, 1.4070904645476772, 1.1244630755035159, 1.5045230263157894, 1.0135434897635232, 1.2334437086092715, 1.3006063432835822, 1.3630271732448052, 1.1358024691358024, 1.4166666666666667, 1.0326010605330211, 1.0515970515970516, 1.0536127326798106, 1.0057733490002188, 1.0, 2.000911577028259, 2.255813953488372, 1.2580645161290323, 1.0909090909090908, 1.0308851473900018, 1.2781456953642385, 1.0781053010746233, 1.0245901639344261, 1.024186046511628, 1.1128634795465746, 1.1301553294054634, 1.236482709048798, 1.2855740922473013, 1.0337682271680737, 1.2040260012581254, 1.6377952755905512, 1.3636363636363635, 1.1082410824108242, 1.1968685831622177, 1.0985442329227324, 1.4313725490196079, 1.0098717563939292, 1.527027027027027, 1.0587326732673268, 2.0, 1.1373193166885678, 1.00398406374502, 1.1132075471698113, 1.0872671599897934, 1.1702944942381561, 1.037037037037037, 2.7637714716493456, 1.0096749892380543, 1.0, 1.0212765957446808, 1.0833333333333333, 2.0, 1.6590909090909092, 1.0, 1.2, 1.3054393305439331, 1.2348713525945092, 1.067778936392075, 1.0404344471841107, 1.0142460353014964, 1.004165593797385, 1.0519130468628366, 1.0538911347312425, 1.017578125, 1.0884230687380294, 1.0084836852207293, 1.2804770318021201, 1.0970042796005706, 1.0608365019011408, 1.282258064516129, 1.0508422530268469, 1.1256038647342994, 1.0940424270652496, 1.0876288659793814, 1.6900243309002434, 1.0841121495327102, 1.5, 1.6729411764705882, 1.1111111111111112, 1.5130023640661938, 1.8888888888888888, 1.0, 1.0597549140668752, 1.000225026119103, 1.0068832599118942, 1.102224219276567, 1.3805970149253732, 1.2387005649717515, 2.0, 1.375, 1.1099744245524297, 1.0097877379126103, 1.0064486781547684, 1.1205565128597867, 1.0461063837000373, 1.028436018957346, 1.0165307698909964, 1.559556786703601, 1.0325396342082294, 1.1126141359485966, 1.0140724317173364, 1.1571428571428573, 2.8359375, 1.2325612803025188, 1.0, 1.067754077791719, 1.281767955801105, 1.020470053070508, 1.4285714285714286, 1.0751478716183458, 1.5, 1.3888888888888888, 1.0107347828573972, 1.1309701492537314, 1.013242487307626, 1.0000142127554743, 1.4771929824561403, 1.3333333333333333, 1.2142857142857142, 1.1299638989169676, 1.1432476763258612, 1.0191758465932272, 1.046354589764419, 1.00918715970688, 1.0, 1.1112148506151143, 1.3497942386831276, 2.0, 1.1132308008318998, 1.0284193778460526, 1.1666666666666667, 1.0132572746064556, 1.364219601029171, 1.1454545454545455, 1.0, 1.3952446588559615, 1.4351851851851851, 1.034475883751246, 1.1912160143412012, 1.2348607181360665, 1.031936363159826, 1.1537242472266245, 1.0241825613079019, 1.0491228070175438, 1.0366250520586155, 1.0184544405997693, 1.0572916666666667, 1.2395459976105137, 5.166666666666667, 2.9813499111900534, 1.1620760300478032, 1.1666666666666667, 1.0, 1.0871428571428572, 1.1521242576518957, 1.0114324142568931, 1.008338125359402, 1.0769230769230769, 1.4277310924369748, 1.0454726765057838, 1.971830985915493, 1.3558975847136032, 2.0, 1.2181818181818183, 2.5, 1.2196382428940569, 1.2307692307692308, 1.102908900888347, 1.105263157894737, 1.3494423791821561, 1.0126091173617846, 1.0, 1.495846362803626, 1.219298245614035, 1.5, 2.0, 1.3711340206185567, 2.761904761904762, 1.0352564102564104, 1.0177736202057999, 1.4746543778801844, 1.1829470198675496, 1.105740181268882, 1.121844811467747, 2.1845018450184504, 1.7625899280575539, 2.3636363636363638, 2.0, 1.595505617977528, 1.1551499348109517, 1.1906519065190653, 1.6094714023678507, 1.0165448757944606, 1.2093637708729656, 1.0437806702364143, 1.1873980599193064, 1.247816593886463, 1.0951814396192743, 1.8333333333333333, 2.0, 1.1875, 1.2956735496558505, 1.0899780541331383, 1.5045454545454546, 1.052516411378556, 1.0801760143198091, 1.431498716917538, 1.0239000175071016, 1.1304347826086956, 1.4666666666666666, 1.0924024640657084, 1.312, 1.0597108126110124, 1.0238702824141341, 1.4339622641509433, 1.0504378283712785, 1.0001611752763984, 1.015028901734104, 1.1472746331236898, 1.2857142857142858, 1.0078157136980666, 3.228091982597887, 1.0153620973278241, 4.0, 1.0876325088339223, 1.0, 1.2024390243902439, 1.068725551958041, 3.176470588235294, 1.00860342119295, 1.370101596516691, 1.0232558139534884, 1.0356562239114198, 1.1781241302532703, 1.2946725022638093, 1.1478599221789882, 1.4732441471571907, 1.0565230445878997, 1.4893617021276595, 2.0, 1.0, 1.7142857142857142, 1.0996685034357094, 2.0, 1.0122277283434165, 1.0175451421887565, 1.3597438975590237, 1.043407780979827, 1.01138678143199, 1.2616632860040569, 1.2979942693409743, 1.2967625899280575, 1.124216085818817, 1.2710970778350361, 1.003511559062774, 1.0705828534524515, 1.6666666666666667, 2.809501985945616, 1.2134387351778657, 1.0474914958999557, 1.4759615384615385, 1.1650355018230667, 1.0761904761904761, 2.093877551020408, 1.283013739713959, 1.0026845637583892, 1.040044105899164, 1.375, 1.0202628250709715, 1.0408606512039529, 1.0131789137380192, 1.088356729975227, 3.6363636363636362, 1.368421052631579, 1.4277475588177468, 1.064980740244515, 3.0, 1.0029661591829895, 1.696969696969697, 1.1461363238128615, 1.0068681318681318, 1.2615384615384615, 1.5148975791433892, 1.0140086206896552, 1.4941176470588236, 1.0315581854043392, 1.061432381234154, 1.158403869407497, 1.1030323867152583, 1.013309237959102, 1.0588235294117647, 1.3831877729257642, 1.5961958216401622, 1.1663412221094014, 1.0447193149381542, 1.0547945205479452, 1.18312674930028, 1.2757172848145557, 1.0474820143884893, 1.3333333333333333, 1.0, 2.5, 1.0460810626393122, 1.1355032979638657, 1.0534673071986504, 1.184952100052587, 1.1862093104655234, 1.0182604517059106, 1.0678489784254894, 1.09980323567993, 1.7197986577181208, 1.3909774436090225, 1.154158215010142, 1.009092833821776, 1.0957446808510638, 2.3333333333333335, 1.0191836695796366, 1.0158145110892882, 1.1485630784218217, 1.0209424083769634, 1.6759708737864079, 1.0201139307361484, 1.156371911573472, 1.0883054892601431, 1.368421052631579, 1.1245110821382007, 2.794436982314753, 1.0029239766081872, 2.263157894736842, 1.1797811075629794, 1.0802997858672376, 1.0814814814814815, 1.2926829268292683, 1.2056305867584356, 1.088622962192161, 1.008560406755633, 1.025027402265254, 1.0, 1.0769230769230769, 2.0, 1.0006966213862765, 1.0333333333333334, 1.3333333333333333, 1.1538461538461537, 1.0927152317880795, 1.0944350758853287, 1.346890506886797, 1.3000621118012423, 1.2820512820512822, 1.1764705882352942, 1.5, 1.121212121212121, 1.0422535211267605, 3.1818181818181817, 1.1145833333333333, 1.007433547656, 1.006854398602925, 2.3448275862068964, 1.0183032791013953, 1.0031796502384738, 2.5, 1.0014841579877016, 1.0292831906102162, 1.5, 4.666666666666667, 1.0782678859601937, 1.002992843201041, 1.22737239080863, 1.5046728971962617, 2.0, 1.2112068965517242, 1.0903010033444815, 4.0, 1.1080201033481984, 1.0038091239015026, 1.0115582480952534, 1.0785557453037327, 2.0, 1.013071875588037, 1.0939183987682832, 1.272845953002611, 1.2845528455284554, 1.266522210184182, 1.0, 1.7555555555555555, 1.1643489254108723, 1.301848204817452, 1.1280788177339902, 1.287037037037037, 1.1623574060100315, 1.1027801179443977, 1.423529411764706, 1.2463768115942029, 1.2443149342696171, 1.0765840876607908, 1.2034967459724741, 3.7755102040816326, 1.2142857142857142, 2.7479654120040693, 1.6, 1.163396361041741, 1.0119760479041917, 1.014149641637082, 1.7615384615384615, 3.0, 1.2467980295566503, 1.0321749740159971, 1.4054963544587773, 1.5264251781472684, 1.0047671945562433, 1.1554851206198273, 1.095069087901864, 1.7459016393442623, 1.0833333333333333, 1.095728803922962, 1.0024432549377995, 1.2194039315155358, 1.0831889081455806, 1.6666666666666667, 1.2741935483870968, 1.1496660632155788, 1.0141065830721003, 1.234830681511731, 1.0239681090794992, 1.2708456534594914, 4.0, 1.6557059961315281, 1.3431339149497135, 1.3237528228289879, 1.1, 1.041367814930801, 1.6102564102564103, 1.0194552529182879, 1.1136363636363635, 1.0006437479267047, 1.079654452172855, 1.3123732251521298, 1.0163934426229508, 1.2258064516129032, 1.2599849284099474, 1.4304814315525105, 1.0121138087239783, 1.0835827903973705, 1.180605438686506, 1.4591611479028697, 3.0, 1.2356687898089171, 2.5, 1.5, 1.6470588235294117, 1.0491803278688525, 1.0863813229571984, 1.0328039835811857, 1.0771623337912444, 1.000741473059812, 1.1450265755504936, 1.7864077669902914, 1.0028719126938541, 1.0271672849230145, 1.0, 1.0714285714285714, 1.2296870513924778, 1.75, 1.1553846153846155, 1.0777610818933132, 1.4490009141961604, 1.0201763409257898, 3.0, 1.169019182048498, 1.0383912248628884, 1.1273545122294069, 1.00345845494667, 1.2857142857142858, 1.0174739423666461, 1.0650661040308995, 1.1551274083281542, 1.4134831460674158, 1.0, 1.0216010165184244, 1.5, 1.0, 1.0005991781542884, 5.0, 1.2857142857142858, 1.1166666666666667, 1.247216035634744, 1.0106382978723405, 1.0380208333333334, 1.031790437436419, 6.0, 1.110238232810347, 1.0215789473684211, 1.3183856502242153, 1.080568720379147, 1.0, 1.0983574114387493, 1.2198297446169253, 2.87799991094884, 1.0364628178439472, 2.111111111111111, 1.00311888175568]
origin-bjaq_15.71 	max: 6.0000	99th: 3.7778	95th: 2.5000	median: 1.1427	mean: 1.3453

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 5/15 | Workload-time: 11.937728 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 6/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=valueskew', '--dataset=bjaq', '--drift_test=distribution', '--end2end', '--update_size=20000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
ValueSample - START
ValueSample - END
load_npy_dataset_from_path - df.shape = (442168, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (422168, 5), new data size: (20000, 5)
[5.9604645e-08 1.7881393e-07 2.9802322e-07 0.0000000e+00 5.2821636e-04]
Distance score: 0.000105750557850115
SAUCE Drift detection: True
Detection latency: 0.0350s

DRIFT-DETECTED after 6-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=bjaq', '--end2end', '--model=transformer', '--model_update=adapt', '--update_size=20000', '--epochs=40']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
update_size: 20000
AdaptTask - START
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
load_npy_dataset_from_path - df.shape = (442168, 5)
Parsing... done, took 0.0s
done, took 0.0s
dataset size: 442168
train data shape: torch.Size([20000, 5]), transfer data shape:torch.Size([4000, 5])
Epoch 0 Iter 0, train entropy gap 0.1285 bits (loss 18.654, data 18.525) 0.00300 lr
epoch 10 train loss 12.1998 nats / 17.6007 bits
time since start: 4.4 secs
Epoch 10 Iter 0, train entropy gap -0.9222 bits (loss 17.603, data 18.525) 0.00256 lr
epoch 20 train loss 11.9299 nats / 17.2112 bits
time since start: 8.7 secs
Epoch 20 Iter 0, train entropy gap -1.3116 bits (loss 17.214, data 18.525) 0.00150 lr
epoch 30 train loss 11.8129 nats / 17.0424 bits
time since start: 12.9 secs
Epoch 30 Iter 0, train entropy gap -1.5754 bits (loss 16.950, data 18.525) 0.00044 lr
epoch 40 train loss 11.8034 nats / 17.0287 bits
time since start: 17.1 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 20.1213 nats / 29.0289 bits
Saved to: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
AdaptTask - END

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 6/15 | Workload-time: 2.076145 | Model-update-time: 19.516749


WORKLOAD-START | Type: QueryWorkload | Progress: 7/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 442168, total size: 442168, split index: [368473 442168]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 6.0000	99th: 3.3762	95th: 2.3187	median: 1.1492	mean: 1.3402
ReportEsts: [1.09375, 1.0060769750168805, 1.0559891977684863, 1.0980769230769232, 2.142857142857143, 1.0, 1.0354939692477672, 1.0048932661189942, 1.2, 1.043525571273123, 1.1629140722291407, 1.0127843757448725, 1.3250120019203073, 1.1417004048582995, 1.1611711199545196, 3.375, 1.1258741258741258, 6.0, 1.7142857142857142, 1.270886075949367, 1.2070864969480424, 1.274098592616924, 1.125, 1.6333878887070377, 1.0276304359879498, 1.018590838704711, 2.0, 1.0586093429711942, 1.5, 1.0, 1.3762376237623761, 1.0, 1.0100306329095414, 1.028564210260378, 1.3569277108433735, 1.2541904586480015, 1.0527796673056706, 1.5907335907335907, 4.0, 1.0870535714285714, 1.3647058823529412, 1.1253245147731488, 1.0664502147382409, 1.006950929820053, 1.0, 1.3534931683423563, 1.6666666666666667, 1.302325581395349, 1.0941176470588236, 1.0439164866810655, 1.3228346456692914, 1.0083168400218976, 1.0466216216216215, 1.0174346201743463, 1.057188909064942, 1.0610687022900764, 1.0277632561613144, 1.3283950179198751, 2.159081967213115, 1.423728813559322, 1.0141513871405596, 1.5681818181818181, 1.035175567097261, 1.3242630385487528, 1.1891891891891893, 1.1485148514851484, 1.2691218130311614, 1.0853487842192637, 1.470949115842656, 2.3333333333333335, 1.0, 1.065448639870077, 1.2658610271903323, 1.0614385614385615, 1.075098814229249, 1.058337744838539, 1.199530516431925, 1.020854942290292, 1.1948051948051948, 1.119047619047619, 1.0048136135006815, 1.0675675675675675, 1.1666666666666667, 1.0, 1.9179104477611941, 1.2707482993197279, 2.8333333333333335, 1.1224066390041494, 1.5, 2.1954887218045114, 1.0318451666037542, 1.0258864135550674, 1.2251874230726194, 1.043855678338437, 1.396311923738084, 1.4166666666666667, 1.8282051282051281, 1.1764705882352942, 1.1448717948717948, 1.9251101321585904, 1.4054054054054055, 1.0398268398268398, 2.3178879310344827, 1.3085526315789473, 1.0015337423312884, 1.0263157894736843, 1.0653667111559622, 1.2962962962962963, 1.0362009646389085, 1.1619022174726155, 1.2145670272695548, 1.009049773755656, 1.0613934894346089, 1.8333333333333333, 1.9236641221374047, 1.1950870498449797, 1.0176521766012605, 1.2477995937711577, 1.0481927710843373, 1.0005626166790271, 1.0, 1.144753086419753, 1.1241830065359477, 1.0, 1.5423728813559323, 1.2857142857142858, 1.4, 1.0022248368809499, 1.0469843834141088, 1.4545454545454546, 1.2857142857142858, 1.3570402298850575, 1.0, 2.56, 1.254410726887791, 1.3, 1.0188679245283019, 1.061532098468111, 1.1911003311721629, 1.8429951690821256, 1.2777777777777777, 1.0877659574468086, 1.10351966873706, 1.066815144766147, 1.2338568059806332, 1.7419354838709677, 1.2428774928774928, 1.0164116948045692, 2.0, 1.0288836846213896, 1.0910224438902743, 1.156619018023617, 1.3560660445082555, 1.5, 1.1526486260578832, 1.024279210925645, 1.1823770491803278, 2.0, 1.3356164383561644, 1.008198809332868, 1.0631460914139257, 1.1097446124868429, 1.0051155740810913, 1.1554054054054055, 1.2650887573964498, 1.1471135940409682, 1.2612612612612613, 1.5714285714285714, 1.0056515646893975, 2.5765124555160144, 1.1085365853658538, 1.0837099494097808, 1.1568471337579618, 1.1102206343842032, 1.4179104477611941, 1.0252100840336134, 1.0265206604499957, 1.1846293769895406, 1.0382848392036754, 1.009306260575296, 1.03289124668435, 1.2910518681538539, 1.0432374924982268, 1.2857142857142858, 2.1761006289308176, 1.2627868379275509, 1.308545419578178, 2.080357142857143, 1.3544694153430212, 1.1644736842105263, 1.1666666666666667, 1.0011683970775282, 1.0142534395148277, 1.3333333333333333, 1.0664804469273743, 1.0246723207401696, 1.2139146641287968, 1.0477890689371052, 1.2361111111111112, 1.2047017381968537, 1.0761356667767348, 1.0655040408336878, 1.3016369321316903, 1.0119047619047619, 1.0299764593225074, 1.0801092398725536, 1.0358117698438694, 1.0925925925925926, 1.028169014084507, 1.3125, 1.0, 1.035897435897436, 1.2399152194721728, 1.1101928374655647, 2.5588235294117645, 1.0815264527320034, 1.611965811965812, 1.0019972488700717, 1.0952380952380953, 1.004191665981754, 1.025, 1.114609571788413, 1.0384087791495198, 1.025486716879056, 1.3272179627601315, 1.375, 1.105263157894737, 1.072978075114261, 1.0097625329815303, 1.9018987341772151, 1.6879194630872483, 1.2328159645232817, 1.0116934972746863, 1.0403225806451613, 1.0032836225990782, 1.0216129453703877, 1.4934640522875817, 1.1672095548317047, 1.4870259481037924, 1.0, 1.2475442043222005, 1.0, 1.4593103448275861, 1.067784223267711, 1.3453169347209082, 1.373134328358209, 1.0909090909090908, 2.3333333333333335, 1.1265403970360979, 1.391304347826087, 1.0445083180907586, 3.0, 1.0, 1.9666666666666666, 1.2711921648091862, 1.044077618754939, 1.3616071428571428, 1.022653721682848, 2.2027807213066835, 1.2117991938438988, 1.3282169944722972, 1.2954545454545454, 2.0, 1.2426348468201447, 1.1155508277375175, 1.746177370030581, 1.2051443543104752, 1.2553082956067079, 1.0120004024087035, 1.019876627827279, 1.1299797288554712, 1.048858204992034, 1.0601125613698958, 1.6263231475933693, 1.1, 1.2994708333983735, 1.2359882005899705, 1.2127659574468086, 1.12, 1.1215686274509804, 2.2209396071533276, 1.0310412437318897, 1.0124690998982113, 1.3473451327433628, 1.4005763688760806, 1.021083339191211, 1.0923636363636364, 1.0811700930755856, 1.0057131319435202, 1.1111111111111112, 1.1482904341144833, 1.0489028213166145, 1.0155875251100785, 1.0021428344433396, 1.0230290893760539, 1.4038781163434904, 1.0670322973796467, 1.044362292051756, 1.37059613018678, 1.0685223280115053, 1.0075729463021756, 1.0151515151515151, 1.1428571428571428, 1.5454545454545454, 1.0163960522126712, 2.2932187201528174, 1.1569037656903767, 1.2917472118959108, 1.131578947368421, 1.1395348837209303, 2.6578947368421053, 1.0445736434108528, 1.2937853107344632, 1.0442723467608706, 1.09375, 1.0674658844535136, 1.0095509815909245, 1.135667396061269, 2.411764705882353, 1.6111111111111112, 1.076957494407159, 3.0, 1.0451290820476364, 1.1394984326018809, 1.8181818181818181, 1.2956108629369638, 2.1, 1.5384615384615385, 1.0724592723392796, 2.0, 2.6596534653465347, 1.4827586206896552, 1.0218631178707225, 1.1942843419788665, 1.6092436974789917, 1.1375, 1.0212161261271797, 1.0053331093707352, 1.4885496183206106, 1.0109083356014268, 1.046593757120073, 3.0, 1.5, 1.2957567143407065, 1.0, 1.1659789087574508, 1.1764705882352942, 2.7875, 1.173913043478261, 1.0663811563169165, 1.0165876777251184, 1.0909090909090908, 1.5154798761609907, 1.5466666666666666, 4.0, 1.1520018012864592, 1.3169934640522876, 1.4736842105263157, 1.3123638407119158, 1.0304347826086957, 1.1165311653116532, 1.1146496815286624, 1.75, 2.0, 1.0657306955966817, 1.76, 1.0174358974358975, 1.0133135117277834, 1.008714596949891, 1.0888888888888888, 1.5, 1.0281132132403972, 1.2548298068077277, 2.0, 1.2099845599588266, 1.2679102566627927, 1.4, 1.0701004922901665, 1.5256410256410255, 1.1168910949479065, 1.0249078462348604, 1.0543666859456333, 1.131626467173997, 1.0421258195006278, 2.1883095317170373, 1.0621301775147929, 1.1670250325183829, 1.0257575757575759, 1.3636363636363635, 1.020951421459068, 1.049584556239924, 1.025, 1.7883546128500825, 1.3518518518518519, 1.036, 1.0522815540286021, 1.9090909090909092, 2.09, 1.0625, 1.2166666666666666, 1.4444444444444444, 2.0684931506849313, 1.383739837398374, 1.1382672617484904, 1.1100478468899522, 1.0057317159679364, 1.719298245614035, 2.5813953488372094, 1.2831541218637992, 1.0, 1.0144670264800135, 2.9130434782608696, 1.0315752406291572, 1.09774954608393, 1.2523051131601006, 1.0525613660618998, 1.5714285714285714, 1.2465825446898002, 1.1666666666666667, 1.0427927927927927, 1.8333333333333333, 1.0369579437454308, 1.2683823529411764, 1.057813733228098, 1.221774193548387, 1.5214659685863874, 3.0, 1.455863539445629, 1.012881177707676, 1.0745150262362855, 2.0, 1.320754716981132, 1.3838630806845966, 1.2747252747252746, 1.0105647454122513, 1.421441774491682, 1.0, 1.0083969465648854, 1.2207766270079032, 1.2807323660874346, 1.056544502617801, 1.1515151515151516, 1.1129032258064515, 1.5, 1.0398818316100442, 2.3773584905660377, 1.7, 1.0029958058717796, 2.60989010989011, 1.0704334816484349, 1.4705882352941178, 2.3035714285714284, 1.1017608113818849, 1.4059405940594059, 1.5, 1.1454545454545455, 1.0186625194401244, 1.2661424827257566, 1.736842105263158, 1.0271575135787567, 1.013933641034573, 1.01198069907026, 1.1866452131938858, 1.1405835543766578, 1.1498481268984138, 1.0309439874657267, 1.0657467532467533, 1.1553030303030303, 1.2222222222222223, 1.0454400576488685, 1.2996057818659659, 1.9375, 1.1888738127544098, 1.2135922330097086, 1.132013201320132, 1.0211714890613972, 1.0571736785329018, 1.3275165739541264, 1.0, 2.0, 1.3072725920693054, 1.0066946909543828, 1.0414971521562246, 1.0, 1.0870445344129556, 1.0162780056265464, 1.026634382566586, 1.0, 1.00062656641604, 1.3284135149079879, 1.42002508361204, 1.10097420245014, 1.0549873136695211, 1.291931929480901, 1.0021598272138228, 1.3319794205253181, 1.5, 1.09375611665688, 2.3116640912239568, 1.0, 2.0872395833333335, 3.0588235294117645, 1.048111927052518, 1.61863488624052, 1.151633929357879, 1.1525224872897928, 1.009382260958226, 1.3702422145328719, 1.3431002649112949, 1.4196797794507476, 1.7857142857142858, 1.4482758620689655, 1.0228837466216882, 1.337807606263982, 1.0644294608488982, 1.0048609314833161, 1.5, 1.3936507936507936, 1.1877551020408164, 1.2352941176470589, 1.2222222222222223, 1.0297655928718301, 1.2, 1.0153538050734312, 1.0, 1.1333333333333333, 1.0108748187530208, 1.009142491239928, 1.0108907040062232, 1.0153275250080671, 1.123627490849939, 1.2232142857142858, 1.011448481831757, 1.0731703328154387, 1.51, 1.198018918436552, 1.0246753246753246, 1.0164835164835164, 1.0291939218198576, 1.1379310344827587, 1.0465546584342595, 2.0, 1.5255544840887174, 1.2413793103448276, 1.0256322242204, 2.828767123287671, 1.0010952902519168, 1.077757685352622, 2.2080842379034444, 1.0789809482596007, 1.0, 2.0434782608695654, 1.1538461538461537, 1.0, 3.0344827586206895, 1.1333333333333333, 1.856733524355301, 1.2325581395348837, 1.0799881936245572, 1.1192739844425237, 1.0245819636987281, 1.0670996661025476, 1.0062956018760343, 1.0075187265917602, 1.0293068747572474, 1.0196779964221825, 1.0474102226769966, 1.0157517145859785, 1.061248527679623, 1.1096681096681096, 1.0881987577639751, 1.225609756097561, 1.0115665074176514, 2.3064066852367686, 1.039033719174635, 1.7477477477477477, 1.208, 1.0890173410404624, 1.5, 1.2606382978723405, 2.0, 2.033613445378151, 1.1385135135135136, 1.0422072954281167, 1.0192534381139489, 1.4217391304347826, 1.0194805194805194, 1.2871536523929472, 1.2002687088539568, 1.4434907010014306, 1.25, 1.4848484848484849, 1.3648695956590233, 1.4919354838709677, 1.114507299270073, 1.0723209995194618, 1.0, 1.025763358778626, 1.0727699530516432, 1.07321255369267, 1.8459016393442622, 1.017051182628926, 1.3156103785623139, 1.0004282272206155, 1.0121951219512195, 2.129032258064516, 1.271100278551532, 1.0, 1.095364238410596, 1.3333333333333333, 1.204525674499565, 1.7142857142857142, 1.0129426955238563, 1.6666666666666667, 1.6111111111111112, 1.000465614096618, 1.0877613986972918, 1.0101716345973284, 1.0000067849816692, 1.1960227272727273, 1.1714285714285715, 1.1388888888888888, 1.0287162162162162, 1.0625, 1.0734509643003693, 1.1276375526334361, 1.0409479169145115, 1.0, 1.0421000739462658, 1.1355417109861723, 2.0, 1.1832218006209037, 1.008598497716378, 1.0774719673802242, 1.027516708015807, 1.2895044376362086, 1.6923076923076923, 1.1428571428571428, 1.1989459815546772, 1.2462311557788945, 1.0716585208815008, 1.1686507936507937, 1.1826293975321633, 1.0230903493248649, 1.1468842729970326, 1.0445075757575757, 1.351170568561873, 1.0597786044988584, 1.1851052347544522, 1.0909803921568628, 1.16543438077634, 5.566666666666666, 2.114491233328338, 1.1141422959406373, 1.0588235294117647, 1.6, 1.1586121437422552, 1.2477434679334918, 1.0311712846347607, 1.023816041609636, 1.5, 1.30659253375695, 1.0025612879619465, 1.7285714285714286, 1.2812635131572008, 1.5, 2.2905982905982905, 3.0, 1.221130221130221, 1.3846153846153846, 1.0023285351397122, 1.1282051282051282, 1.3732394366197183, 1.2552800734618916, 1.0, 1.495177197355587, 1.2720465890183028, 2.0, 2.0, 1.9275362318840579, 2.436974789915966, 1.1640803866700584, 1.2889647326507394, 1.144901610017889, 1.0, 1.3346774193548387, 1.0833333333333333, 1.6042402826855124, 1.8421052631578947, 2.0, 1.0, 1.4343434343434343, 1.0846824408468243, 1.198019801980198, 1.5202394077807528, 1.004917658402903, 1.0793911160684995, 1.0055957803575903, 1.2415959786365065, 1.1098326359832635, 1.0674778761061947, 2.75, 2.0, 1.3666666666666667, 1.3239623418770785, 1.1327493261455526, 1.099041533546326, 1.4176470588235295, 1.0517922762254732, 1.3291251778093884, 1.0037917622314059, 1.04, 2.75, 1.1319148936170214, 1.299457411075704, 1.0408393202725272, 1.0370517747106573, 1.006578947368421, 1.1086306684474974, 1.0023915753559478, 1.2335135135135136, 1.0267737617135209, 2.25, 1.2428991185112634, 2.5095913261050877, 1.001476843999598, 2.0, 1.2292460015232292, 1.0, 1.1350762527233116, 1.00701724721001, 1.0555555555555556, 1.0262609714935353, 1.2521186440677967, 1.2285714285714286, 1.0557039171145215, 1.0547858214986723, 1.3209382406869103, 1.0203915171288744, 2.629850746268657, 1.0040448261914392, 2.248995983935743, 2.0, 1.0, 1.1818181818181819, 1.024799071646538, 2.5, 1.0143644996485002, 1.0661470451372732, 1.1226595338173482, 1.1499208860759493, 1.0081407174099781, 1.3871543264942017, 1.828125, 1.5405982905982907, 1.1308504720696775, 1.3569066395319258, 1.0054531279805594, 1.0629679793514093, 1.6666666666666667, 2.461885245901639, 1.5240963855421688, 1.0285577782572513, 1.4413145539906103, 1.0380025702221407, 1.0424778761061948, 1.8256227758007118, 1.2321782178217822, 1.25503355704698, 1.006144091861918, 2.2857142857142856, 1.018004935362993, 1.0355875246091386, 1.1526578827805543, 1.0291997116077867, 1.3333333333333333, 1.6, 1.262806876329558, 1.0375785886832296, 4.0, 1.004490284173018, 1.2692307692307692, 1.0390879478827362, 1.218503937007874, 1.1310344827586207, 1.1805996472663138, 1.2591587516960652, 1.5989208633093526, 1.3460815047021943, 1.0609027906688941, 1.187279151943463, 1.0350991755775039, 1.0529172623302359, 1.3571428571428572, 1.7695530726256983, 1.3456887486855942, 1.1136779721114674, 1.4502369668246446, 1.5676209279368214, 1.109772423025435, 1.0127877237851663, 1.0714285714285714, 1.0246724077052847, 1.7333333333333334, 1.0272614622057001, 1.0139265255719823, 1.3009458297506449, 2.007645259938838, 1.1708497467642094, 1.221419839724725, 1.1061337008959338, 1.4610389610389611, 1.019451503419576, 1.01815475399378, 1.1578099838969405, 1.027027027027027, 1.2116946399566866, 1.0021144540290343, 2.0, 1.75, 1.0371041289274783, 1.0643377893540684, 1.0975056689342404, 1.0851063829787233, 1.8028720626631853, 1.062041452952998, 1.1199622166246852, 1.03862660944206, 1.04, 1.1050920910075839, 2.335771351412175, 1.3531073446327684, 1.069767441860465, 1.2213980669813442, 1.278833967046895, 1.217741935483871, 1.1951219512195121, 1.5849056603773586, 1.0552058111380145, 1.0, 1.0483870967741935, 1.122703412073491, 1.1373626373626373, 1.3623298033282905, 1.2, 1.051097787264166, 2.191545574636724, 1.3824264564506825, 1.3272727272727274, 2.75, 1.038138138138138, 1.3080959351424388, 1.2874013326499232, 2.2540983606557377, 1.2647058823529411, 1.2857142857142858, 2.125, 1.3243243243243243, 1.0144927536231885, 1.2563600782778865, 1.0046836425607415, 1.0125580291877196, 1.6470588235294117, 1.0291311402861778, 1.0101524598528153, 1.6666666666666667, 1.0130964957079593, 1.0080054894784996, 1.5, 4.5, 1.1115404430705822, 1.040219142765066, 1.2296371144890608, 1.2453416149068324, 2.0, 1.1814516129032258, 1.1358885017421603, 3.0, 1.0918582207404808, 1.0132196953474095, 1.005728303254428, 1.0910482921083628, 3.3333333333333335, 1.0086998173471184, 1.0450070323488045, 1.516329704510109, 2.2698412698412698, 1.0019588638589618, 1.0, 1.4545454545454546, 1.281391304347826, 1.2374244024191225, 1.6981132075471699, 1.5706521739130435, 1.181543284789644, 1.2098331870061458, 1.4586776859504131, 1.0289855072463767, 1.2444419492476981, 1.0747758992397594, 1.240811780720208, 5.052631578947368, 1.02, 2.31145584725537, 1.6, 1.0046838407494145, 1.2114695340501793, 1.0020695194826457, 1.1331877729257642, 3.0, 1.2146788990825688, 1.0187609261075343, 1.0262025811497848, 1.2059582453671123, 1.0148188419449125, 1.0500765696784073, 1.050878694135457, 1.3125, 1.2916666666666667, 1.0467064168086315, 1.0089194470839236, 1.1453831041257367, 1.2956349206349207, 5.0, 1.1111111111111112, 1.1305838430734647, 1.103448275862069, 1.2749855804610275, 1.0002043220933479, 1.0390934844192634, 2.6666666666666665, 1.3784219001610305, 1.3273853090142578, 1.0174915523752732, 1.027681660899654, 1.0080702404098385, 1.3029045643153527, 1.221326164874552, 1.0067324955116697, 1.0053961345992248, 1.0315021575494883, 1.2093690248565965, 1.0231532524807057, 1.0789473684210527, 1.1819834376893557, 1.5194324980559568, 1.0198008753549155, 1.0151951794603091, 1.0578635014836795, 1.3050345508390917, 3.3333333333333335, 1.5193548387096774, 1.25, 2.0, 1.1176470588235294, 1.2225274725274726, 1.1312111801242235, 1.0347704683708407, 1.060106521399698, 1.0728056823947234, 1.174061433447099, 2.3896103896103895, 1.0959367945823928, 1.0532495664714572, 2.6666666666666665, 1.4666666666666666, 1.393653192293162, 2.0, 1.545267489711934, 1.049373618275608, 1.1770634415446637, 1.0097939482380014, 3.5, 1.6744427164333853, 1.638655462184874, 1.14250278147628, 1.0065793124222175, 1.1330472103004292, 1.232267441860465, 1.0191886052652637, 1.2104200586128298, 1.6045918367346939, 1.7282608695652173, 1.1778563015312131, 1.0, 1.0, 1.0046815611384075, 5.0, 1.75, 1.125, 1.0653804930332262, 1.119047619047619, 1.0562025316455697, 1.0272042749574932, 3.0, 1.0038846492671174, 1.305764411027569, 1.4025157232704402, 1.0084745762711864, 1.6666666666666667]
origin-bjaq_15.71 	max: 6.0000	99th: 3.3762	95th: 2.3187	median: 1.1492	mean: 1.3402

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 7/15 | Workload-time: 11.963461 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 8/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=valueskew', '--dataset=bjaq', '--drift_test=distribution', '--end2end', '--update_size=20000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
ValueSample - START
ValueSample - END
load_npy_dataset_from_path - df.shape = (462168, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (442168, 5), new data size: (20000, 5)
[1.1920929e-07 5.9604645e-08 5.9604645e-08 5.9604645e-08 4.7999620e-04]
Distance score: 9.605884406482801e-05
SAUCE Drift detection: True
Detection latency: 0.0368s

DRIFT-DETECTED after 8-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=bjaq', '--end2end', '--model=transformer', '--model_update=adapt', '--update_size=20000', '--epochs=40']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
update_size: 20000
AdaptTask - START
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
load_npy_dataset_from_path - df.shape = (462168, 5)
Parsing... done, took 0.0s
done, took 0.0s
dataset size: 462168
train data shape: torch.Size([20000, 5]), transfer data shape:torch.Size([4000, 5])
Epoch 0 Iter 0, train entropy gap 0.0446 bits (loss 18.495, data 18.450) 0.00300 lr
epoch 10 train loss 12.0986 nats / 17.4546 bits
time since start: 5.6 secs
Epoch 10 Iter 0, train entropy gap -1.0889 bits (loss 17.362, data 18.450) 0.00256 lr
epoch 20 train loss 11.8316 nats / 17.0694 bits
time since start: 10.5 secs
Epoch 20 Iter 0, train entropy gap -1.2753 bits (loss 17.175, data 18.450) 0.00150 lr
epoch 30 train loss 11.7075 nats / 16.8904 bits
time since start: 15.3 secs
Epoch 30 Iter 0, train entropy gap -1.6197 bits (loss 16.831, data 18.450) 0.00044 lr
epoch 40 train loss 11.6948 nats / 16.8720 bits
time since start: 20.1 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 19.9695 nats / 28.8099 bits
Saved to: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
AdaptTask - END

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 8/15 | Workload-time: 2.088778 | Model-update-time: 22.568460


WORKLOAD-START | Type: QueryWorkload | Progress: 9/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 462168, total size: 462168, split index: [385140 462168]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 11.0000	99th: 5.0050	95th: 2.5000	median: 1.1604	mean: 1.3907
ReportEsts: [1.141304347826087, 1.0382293762575452, 1.0619172054898545, 1.0337972166998013, 1.6666666666666667, 1.0, 1.008211018932142, 1.006038152176344, 1.25, 1.0485036119711042, 1.0668016194331984, 1.0022425781767768, 1.01734906315059, 1.0729166666666667, 1.3380394246137453, 3.875, 1.0993150684931507, 4.0, 1.3333333333333333, 1.1336, 1.319446704637917, 1.2124618625599302, 1.1083333333333334, 1.0121703853955375, 1.0013785497656464, 1.0128095356120863, 2.0, 1.006938849762208, 3.0, 1.0, 1.1411951348492861, 1.0, 1.0103724908114222, 1.0253236384087736, 1.2093959731543624, 1.2057729768018417, 1.0343944596403423, 1.0899742930591259, 1.0, 1.0274797666102014, 1.350764159424633, 1.061740890688259, 1.2482853223593964, 1.1153625996213288, 1.1858407079646018, 1.2607943902790453, 1.4090909090909092, 1.177404854659874, 1.895910780669145, 1.5270541082164328, 2.6666666666666665, 1.5714285714285714, 1.027237354085603, 1.7058823529411764, 1.0312934971062977, 1.0505880916527615, 1.1101411319656627, 2.0786516853932584, 1.048780487804878, 1.0539739401923807, 1.140625, 1.1514963599758747, 1.3242630385487528, 1.8032786885245902, 1.2352941176470589, 1.2253218884120172, 1.0521195274496178, 1.1967116852613036, 1.021978021978022, 1.1, 1.3048505358150029, 2.879725085910653, 1.1270886075949367, 1.279467680608365, 1.050883109078161, 1.2514551804423748, 1.0060902473322855, 2.2439024390243905, 1.0069444444444444, 1.0207617529296427, 1.3101067168863778, 1.6, 1.0, 1.0, 1.832917705735661, 1.5098039215686274, 1.423758865248227, 8.0, 2.525139664804469, 1.0253055097812076, 1.1103593444594797, 1.1100184090688887, 1.1442915392456676, 1.1755032232600973, 1.029490616621984, 1.3106617647058822, 1.2055938975662914, 1.1094890510948905, 1.1376146788990826, 1.2665872069924513, 2.03125, 1.5403726708074534, 1.2914986181452732, 1.134656883901597, 1.0375180375180375, 1.0412393097361292, 1.4, 1.020148528004416, 1.0516442797591476, 1.1365990202939118, 1.0737199259716224, 1.0114942528735633, 1.0, 2.0683760683760686, 1.059951554299556, 1.035899837614731, 1.2295918367346939, 1.0337078651685394, 1.010431734590605, 2.0, 1.317925012840267, 1.2700389105058365, 1.0, 4.232558139534884, 1.2857142857142858, 1.303921568627451, 1.0102906825470608, 1.0397506368145863, 1.4545454545454546, 1.5, 1.1945812807881773, 1.0, 2.3535353535353534, 1.108349161780494, 1.1818181818181819, 1.0969924812030074, 1.0622281773052762, 1.1809100998890123, 1.2176656151419558, 1.1177304964539008, 1.0059658578321529, 2.092250922509225, 1.4047619047619047, 1.0, 1.1065573770491803, 1.1073825503355705, 3.0, 1.033110119047619, 1.5967153284671534, 1.0442159383033418, 1.2967963386727688, 1.5, 1.189332003988036, 2.5, 1.004983388704319, 1.9035301194935879, 1.0, 1.0074220682830282, 1.1000784159968633, 1.3351393654807056, 1.1815431164901664, 1.336986301369863, 1.2037037037037037, 1.3623188405797102, 1.5471464019851116, 4.571428571428571, 1.0352594330580667, 2.1648267986296155, 1.176196032672112, 1.0001553824479987, 1.0029784065524945, 1.002039627039627, 2.3284313725490198, 3.449275362318841, 1.0766592351226205, 1.0896938335489434, 1.146067415730337, 1.0345381526104418, 1.1204701273261508, 1.0489429481610193, 1.0127726257942642, 1.0125, 1.2424242424242424, 1.065377730039384, 1.1656672948432414, 1.1365853658536584, 1.205291087268079, 1.6857142857142857, 1.543859649122807, 1.9617224880382775, 1.003950827826334, 1.8205128205128205, 1.1045932484781407, 1.0518299613548534, 1.1963625097953456, 1.0778570416213917, 1.0029411764705882, 1.1764571633506402, 1.0692708563352913, 1.121917808219178, 1.081013916500994, 1.233095577746077, 1.0465019762079304, 1.1155339805825242, 1.1323704941513488, 1.3208955223880596, 1.2131147540983607, 2.048780487804878, 1.0, 1.8157894736842106, 1.0313114109786454, 1.657216494845361, 1.3384615384615384, 1.4373956594323873, 1.6253263707571801, 1.0077685756807409, 1.7607655502392345, 1.05419717843697, 1.490909090909091, 1.7230955259975815, 1.21644908616188, 1.0338685160554817, 1.2274511459080741, 1.1764705882352942, 1.049079754601227, 1.0578078314200345, 1.02352339555101, 1.2911392405063291, 1.1227678571428572, 1.1588841722255914, 1.0299696865527048, 1.0615384615384615, 1.0012704039838387, 1.210182606767047, 1.695187165775401, 1.1879699248120301, 1.1374045801526718, 1.2307692307692308, 1.4334085778781038, 1.0, 1.2273781902552203, 1.006805964973123, 1.2911622276029056, 2.6019417475728157, 1.0909090909090908, 2.3333333333333335, 1.2140447519002477, 1.044776119402985, 1.034516004627844, 2.0, 1.1024945770065075, 1.0819502074688796, 4.0, 1.0117051491702334, 1.1377870563674322, 1.1218934911242604, 1.962577133982931, 1.2062685302837781, 1.29932092555332, 1.425, 2.0, 1.3347330286937549, 1.1707757065544198, 1.1978984238178634, 1.290833535713322, 1.2814971521562246, 1.002880865346723, 1.0365205843293492, 1.0948634264588384, 1.0796927508401344, 1.0442107778707133, 1.1347547380156076, 11.0, 1.3508364840086327, 1.368, 1.125, 1.0, 1.0536912751677852, 1.8986214502343535, 1.0249861875036077, 1.034962118579273, 1.0703296703296703, 1.2733990147783252, 1.0140047146485378, 1.133008356545961, 1.053308700355136, 1.0097153245831856, 1.0, 1.0272459499263622, 1.2661596958174905, 1.1709218436873747, 1.0125249663449272, 1.0448416661770754, 1.40552016985138, 1.1734693877551021, 1.0780988593155894, 1.3898718384938187, 1.0640225453413787, 1.019838574861561, 1.76, 1.2857142857142858, 1.5714285714285714, 1.0153245192307692, 2.021598272138229, 1.099250936329588, 1.306152416913902, 1.2727124183006535, 2.074074074074074, 3.2580645161290325, 1.24294813466788, 1.4774193548387098, 1.099928781783535, 1.3214285714285714, 1.0422037184897912, 1.0145398424173504, 1.8, 2.0, 2.6666666666666665, 1.1088770053475936, 2.0, 1.0351130336518892, 1.157185628742515, 1.1304347826086956, 1.2635582525111078, 1.4, 2.0, 1.0763015554295925, 2.0, 2.119804968655677, 1.3104761904761906, 1.1645962732919255, 1.1100897819581017, 1.6724890829694323, 2.4594594594594597, 1.0165858985734761, 1.0554833514628392, 1.6829268292682926, 1.0037152208378979, 1.1402245742223178, 6.0, 1.0, 1.2947215811586485, 1.3333333333333333, 1.0304232804232805, 1.0588235294117647, 2.4018691588785046, 1.2083333333333333, 1.296875, 1.13944817300522, 1.3577981651376148, 1.3011786600496278, 1.6153846153846154, 1.3333333333333333, 1.1503122512361112, 1.362047440699126, 1.9310344827586208, 1.2548673217768944, 1.013215859030837, 1.112917795844625, 1.1058394160583942, 1.0, 1.25, 1.1904225352112676, 2.23728813559322, 1.0139026812313803, 1.0398775329157335, 1.0396380321182768, 1.0233236151603498, 1.5, 1.0138331308245332, 1.8625680087051142, 1.2222222222222223, 1.9743589743589745, 1.3663366336633664, 2.75, 1.0868644067796611, 1.358695652173913, 1.0469734983449643, 1.0102560002325953, 1.075392670157068, 1.208806443094798, 1.0005335467520342, 1.8558423118683705, 1.0713266761768903, 1.1698509845662586, 1.0768156424581006, 2.142857142857143, 1.0142699456516655, 1.0136487887642567, 1.176706827309237, 1.0355029585798816, 1.1666666666666667, 1.0779816513761469, 2.0, 1.2045454545454546, 6.428571428571429, 1.0022988505747126, 7.37037037037037, 2.123328238440963, 1.1570588235294117, 1.055232558139535, 1.1166320724768626, 1.1049586776859504, 1.0479288350846427, 1.4166666666666667, 1.247191011235955, 1.6272727272727272, 1.0, 1.0139075945385776, 6.090909090909091, 1.0385306000299266, 1.1114795674467988, 1.3221238938053097, 1.1526116136562592, 1.1, 1.3152569809793606, 1.2, 1.4063400576368876, 1.2222222222222223, 1.0310977619867403, 1.216931216931217, 1.2646693046919164, 1.3333333333333333, 1.53714859437751, 3.0, 1.2293842275837235, 1.008004712818918, 1.0378692825367857, 2.0, 1.5319148936170213, 1.640371229698376, 1.1149425287356323, 1.0031350881549541, 1.2447146607710378, 1.04, 1.3175872093023255, 1.25049684358195, 1.2946890252742473, 1.0741787105371055, 1.2520424251110793, 1.1107536764705883, 1.736842105263158, 1.2404505386875613, 1.2743074166526287, 1.8305084745762712, 1.3161381921438713, 1.0, 1.5, 1.032156862745098, 1.0128205128205128, 1.088953700328108, 1.0448545813619765, 1.1980734497290788, 1.0, 1.5952380952380953, 1.9411764705882353, 1.028049472370362, 1.0, 1.0, 1.0567368993935624, 1.5, 1.0, 1.075, 2.0, 1.0175040518638574, 1.1065217391304347, 2.5, 1.3333333333333333, 1.0111515358855767, 1.1688388625592416, 1.0606060606060606, 1.1064939550949913, 1.131578947368421, 1.5182481751824817, 1.4061882817643185, 1.0456887667468224, 1.2580155979202774, 1.0, 1.510204081632653, 1.23362531598794, 1.022858884486437, 1.0614232209737828, 1.0, 1.0718347232752086, 1.01268183412949, 1.0384087791495198, 1.0, 1.0465116279069768, 1.192845510192621, 1.1604714724974377, 1.1602534318901796, 1.052153870283614, 1.0824920253872208, 1.018543956043956, 1.0050876386791834, 2.0, 1.0980816249764904, 1.0352264557872035, 1.0310616597125637, 1.656798245614035, 1.25, 1.061460659701719, 1.6466019417475728, 1.195278004905969, 1.100328947368421, 1.0052946913752263, 1.0855106888361046, 1.3817566172523434, 1.408374522055395, 2.511627906976744, 1.8936170212765957, 1.01290882669334, 1.5032258064516129, 1.0248911165721795, 1.0152878504055527, 1.0, 1.5578424414478353, 1.7852760736196318, 1.0263157894736843, 1.4193548387096775, 1.1706625152786496, 1.1661129568106312, 1.0594951923076923, 1.0, 2.111111111111111, 1.1126889601465872, 1.0382811132504814, 1.097250303275374, 1.0023312090613083, 1.0421469740634006, 1.1030245746691871, 1.1604705882352941, 1.0411801327117847, 1.047945205479452, 1.181986265187533, 2.8181818181818183, 2.2222222222222223, 1.3407821229050279, 1.0726770929162834, 1.0055028311667598, 1.008025463101978, 1.283590445384424, 1.1680487804878048, 1.0505933791380386, 1.065850903238061, 2.0, 1.1294452347083925, 1.2346260387811634, 1.1133180544945251, 1.1666666666666667, 1.3179190751445087, 1.0945849858580752, 1.0725720384204909, 1.0386429529620493, 1.1791044776119404, 1.1051524710830705, 1.5555555555555556, 1.8196571845368343, 1.4, 1.1979256698357823, 1.0568181818181819, 3.0, 1.0139571130174831, 1.1333333333333333, 1.449784349969193, 1.0649653979238753, 1.2864949258391882, 1.206896551724138, 1.0068206820682069, 1.2505175983436854, 1.0600514726908778, 1.0029298509961493, 1.1019788621542612, 1.0118291779807456, 3.0, 1.0317195325542572, 1.253968253968254, 2.4452054794520546, 1.0, 1.896, 1.75, 1.120253164556962, 1.0757575757575757, 1.0017823619217368, 1.0470278404815652, 2.7024793388429753, 1.2207792207792207, 1.2931089834381433, 1.1725799605502985, 1.336340206185567, 1.6666666666666667, 1.5909090909090908, 1.1434122736270989, 1.8316831683168318, 1.061598440545809, 1.1779000458505273, 1.0, 1.3931515535827521, 1.106029106029106, 1.0693769624855396, 1.255772646536412, 1.0573379599562078, 1.128353489215564, 1.3569405099150142, 1.0, 1.4381694255111976, 1.118957345971564, 1.6666666666666667, 1.0342197003952915, 3.0, 1.524238657551274, 1.261635357308395, 1.5714285714285714, 1.044691263956862, 1.4, 2.0625, 1.0073668676868732, 1.0413397706698853, 1.05413370651929, 1.0000108188577017, 1.2953846153846154, 1.4482758620689655, 1.1875, 1.0666666666666667, 1.271880819366853, 1.1188382082225403, 1.0014024016127618, 1.0477173190250166, 1.0, 1.0936151212978122, 1.0578026592022394, 2.0, 1.153491250016814, 1.0481960497858749, 1.4018567639257293, 1.0270730788644988, 1.241036552929554, 1.759493670886076, 1.2857142857142858, 1.1474480151228734, 1.2050534499514092, 1.025143768626957, 1.0868279569892474, 1.183932834633137, 1.027727159038125, 1.125, 1.0979874628835369, 1.0334448160535117, 1.0442524546584917, 1.3081591368846932, 1.0435435435435436, 1.0975609756097562, 4.533333333333333, 1.8227231536021749, 1.2189589302769819, 1.2857142857142858, 1.6, 1.124413145539906, 1.2834978843441467, 1.0002994011976047, 1.1246239793725827, 2.2857142857142856, 1.2010542168674698, 1.008050402520126, 1.2428571428571429, 1.2660809571452394, 1.6666666666666667, 1.1727662999731687, 7.0, 1.0076923076923077, 2.5, 1.0265757698307238, 1.25, 1.1070110701107012, 1.0161145926589077, 1.0, 1.4238083945933129, 1.01797603195739, 1.25, 2.0, 3.0930232558139537, 1.2719298245614035, 1.0143447605154388, 1.105263157894737, 1.0953125, 1.0208205756276791, 1.7421052631578948, 1.3636363636363635, 1.8915254237288135, 1.2128712871287128, 1.368421052631579, 1.0, 2.024439918533605, 1.1716328963051252, 1.213032581453634, 1.2380708055413032, 1.0392999939723935, 1.1198305240858433, 1.012630627439244, 1.2183027260316202, 1.0150905432595574, 1.0996732026143792, 2.75, 2.0, 1.375, 1.2486141775558357, 1.1404133998574484, 1.2605633802816902, 1.2718204488778055, 1.0214456919389427, 1.2170500985037203, 1.0034745914207805, 1.471698113207547, 1.8333333333333333, 1.0848375451263539, 1.3712623829864583, 1.013048285082532, 1.0368901855210246, 1.1603053435114503, 1.1611923430105249, 1.218017849414572, 1.0973725134452148, 1.0143939393939394, 1.2357598059131485, 1.0191693290734825, 1.082478457119409, 2.341692789968652, 1.0058963508270131, 2.15, 1.0420346167432002, 1.0, 1.3325242718446602, 1.0011113937949412, 1.7419354838709677, 1.0436971803175106, 1.0084745762711864, 1.4333333333333333, 1.015823089514395, 1.1337538236647626, 1.3220949658823293, 1.041002277904328, 1.405103668261563, 1.020950066383132, 1.1155378486055776, 2.3333333333333335, 1.0, 1.5555555555555556, 1.070906755509172, 2.0, 1.0054832806049343, 1.0009133233833063, 1.0131458827825452, 1.0828877005347595, 1.0114409209609616, 1.4956716896441167, 1.700712589073634, 1.1742671009771988, 1.108623942972954, 1.3042362002567394, 1.0035275245448705, 1.0374511041009464, 3.3333333333333335, 1.9654005843456865, 1.0160642570281124, 1.059445273061037, 1.5049019607843137, 1.0970583054430156, 1.1483739837398375, 2.2401746724890828, 1.2169742550316478, 1.7165898617511521, 1.0649367326175212, 2.2857142857142856, 1.0112124935051061, 1.032816973058163, 1.1381785554060118, 1.1411359724612737, 1.4545454545454546, 1.4761904761904763, 1.305879942634706, 1.0301828427919513, 5.0, 1.0012041363909479, 2.242424242424242, 1.0124669173979663, 1.0340694006309148, 2.5725490196078433, 1.0939244663382595, 1.1974193548387098, 2.5042253521126763, 1.0940812720848057, 1.0527184671687473, 1.3758127438231469, 1.068734188367673, 1.0125634509073222, 1.75, 1.1986754966887416, 1.1513720197930724, 1.1156824569868709, 1.0475059382422802, 1.632065775950668, 1.2598784194528876, 1.298045602605863, 1.0323741007194245, 1.025166605349068, 1.6, 1.077720207253886, 1.0135658914728682, 1.0417024935511607, 1.8085714285714285, 1.1777922500814066, 1.2836953677047893, 1.294930875576037, 1.2129380053908356, 1.0659503822087342, 1.0009509271539752, 1.0046583850931676, 1.3909774436090225, 1.3576826196473553, 1.0006431385159578, 1.0196078431372548, 2.3333333333333335, 1.0213504910954287, 1.0539823973075386, 1.4021231422505307, 1.1173708920187793, 1.8064094179202093, 1.022888020788518, 1.1801592568015926, 1.359964881474978, 1.3, 1.03690036900369, 1.924276608945795, 1.10840108401084, 1.0465116279069768, 1.180649765200577, 1.1651270207852193, 1.7613636363636365, 1.4642857142857142, 1.5621301775147929, 1.157773689052438, 1.36, 1.1111111111111112, 1.1590909090909092, 1.510948905109489, 1.750242954324587, 1.4166666666666667, 1.0131646452830962, 1.9073423904747366, 1.1798490318345913, 1.4608695652173913, 2.8, 1.2839152833428735, 1.1840029352412402, 1.2606504717928126, 1.25, 1.1333333333333333, 1.2, 1.0857142857142856, 1.1384615384615384, 1.2727272727272727, 1.205519244734931, 1.001355869657594, 1.0173426890828463, 2.306451612903226, 1.0177102954012955, 1.011436205413275, 5.0, 1.0206092440489134, 1.0235306993542739, 1.5, 3.5, 1.1620689655172414, 1.0576356224521795, 1.3167163242904187, 2.0, 2.0, 1.408256880733945, 1.0688524590163935, 1.5, 1.1177731947498533, 1.0144477856752323, 1.0671217058486926, 1.158361704322707, 3.3333333333333335, 1.0005857220666683, 1.222397476340694, 1.1977886977886978, 2.7674418604651163, 1.163265306122449, 1.0, 1.2523364485981308, 1.1841090254564155, 1.1754205990972508, 1.2021857923497268, 1.4018691588785046, 1.1205975529315582, 1.152623211446741, 1.5991735537190082, 2.3, 1.3246373662193731, 1.229384003974168, 1.2768910773410307, 6.1875, 1.2911392405063291, 1.9449929478138224, 1.6, 1.0249369571308489, 1.681592039800995, 1.0120701005596984, 2.926517571884984, 3.0, 1.058993847267463, 1.0628863781709657, 1.2571166207529845, 1.2376023110255177, 1.0344506060754772, 1.1492849108147196, 1.0165967126974464, 1.1177570093457945, 1.0625, 1.0942404981190816, 1.0194012973873714, 1.0855813953488371, 1.3333333333333333, 1.6666666666666667, 1.1097560975609757, 1.1038355107711089, 1.0286944045911048, 1.2978034213989271, 1.046268270069808, 1.1442986881937436, 1.3333333333333333, 1.646153846153846, 1.2343492642554756, 1.0226839496759437, 1.5392156862745099, 1.0003493836577024, 1.2265625, 1.1983122362869199, 1.184221396117307, 1.0164170912897044, 1.0353694180324837, 1.1647058823529413, 1.0158394931362196, 1.1578947368421053, 1.31965272296764, 1.4126787602248065, 1.0550289755426776, 1.1837866230885958, 1.0586154623547246, 1.283495145631068, 5.5, 1.1108490566037736, 2.5, 3.5, 1.0588235294117647, 1.0894117647058823, 1.0196891191709845, 1.0322679778733865, 1.0703674567241936, 1.1162211146352514, 1.0024432809773125, 1.010989010989011, 1.0914962325080733, 1.0351042121736629, 2.0, 1.125, 1.3178433889602055, 2.0, 1.7505827505827505, 1.1185209640145262, 1.208474022437643, 1.0184184560447305, 2.3333333333333335, 1.3066343042071198, 1.2139874739039667, 1.1122780609626766, 1.012461661529596, 1.2651757188498403, 1.056251821626348, 1.030705068149536, 1.2773005291732527, 1.1499085923217551, 1.3157894736842106, 1.0973154362416107, 1.0, 1.25, 1.0087720270624794, 2.5, 1.0, 1.4042553191489362, 1.147268408551069, 1.004610233412709, 1.212790039615167, 1.3401015228426396, 1.0206697384645338, 1.0384615384615385, 1.0740740740740742, 6.0]
origin-bjaq_15.71 	max: 11.0000	99th: 5.0050	95th: 2.5000	median: 1.1604	mean: 1.3907

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 9/15 | Workload-time: 12.006517 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 10/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=valueskew', '--dataset=bjaq', '--drift_test=distribution', '--end2end', '--update_size=20000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
ValueSample - START
ValueSample - END
load_npy_dataset_from_path - df.shape = (482168, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (462168, 5), new data size: (20000, 5)
[ 1.1920929e-07  5.9604645e-08  1.1920929e-07 -2.9802322e-08
  4.3225288e-04]
Distance score: 8.650422387290746e-05
SAUCE Drift detection: True
Detection latency: 0.0377s

DRIFT-DETECTED after 10-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=bjaq', '--end2end', '--model=transformer', '--model_update=adapt', '--update_size=20000', '--epochs=40']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
update_size: 20000
AdaptTask - START
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
load_npy_dataset_from_path - df.shape = (482168, 5)
Parsing... done, took 0.0s
done, took 0.0s
dataset size: 482168
train data shape: torch.Size([20000, 5]), transfer data shape:torch.Size([4000, 5])
Epoch 0 Iter 0, train entropy gap 0.1206 bits (loss 18.488, data 18.367) 0.00300 lr
epoch 10 train loss 12.0963 nats / 17.4513 bits
time since start: 4.3 secs
Epoch 10 Iter 0, train entropy gap -0.9526 bits (loss 17.415, data 18.367) 0.00256 lr
epoch 20 train loss 11.8315 nats / 17.0693 bits
time since start: 8.5 secs
Epoch 20 Iter 0, train entropy gap -1.3690 bits (loss 16.999, data 18.367) 0.00150 lr
epoch 30 train loss 11.7060 nats / 16.8881 bits
time since start: 12.8 secs
Epoch 30 Iter 0, train entropy gap -1.4230 bits (loss 16.944, data 18.367) 0.00044 lr
epoch 40 train loss 11.6870 nats / 16.8608 bits
time since start: 17.0 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 19.6353 nats / 28.3277 bits
Saved to: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
AdaptTask - END

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 10/15 | Workload-time: 2.092938 | Model-update-time: 19.495962


WORKLOAD-START | Type: QueryWorkload | Progress: 11/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 482168, total size: 482168, split index: [401806 482168]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 8.4286	99th: 5.0000	95th: 2.4782	median: 1.1467	mean: 1.3628
ReportEsts: [1.5594059405940595, 1.2228946041351487, 1.065159293531077, 1.0442307692307693, 1.7647058823529411, 1.0, 1.0191691962243752, 1.009819926162192, 1.0, 1.1349753694581282, 1.0063646318094717, 1.001497385571645, 1.073901464713715, 1.087686567164179, 1.1373089451265348, 3.5, 1.4261744966442953, 5.0, 1.3333333333333333, 1.1574144486692015, 1.1303499233235745, 1.0773932477735262, 1.094890510948905, 1.3652530779753762, 1.0145429594671487, 1.0075647118719064, 2.0, 1.0464385561245948, 2.0, 1.25, 1.0647873392680514, 1.0, 1.0068675150332402, 1.022564422626835, 1.1847468770545693, 1.3590818363273454, 1.1182454869286964, 1.2064220183486238, 1.1666666666666667, 1.2570912375790424, 1.4190146387533449, 1.149609229624116, 1.1147540983606556, 1.119037760847963, 1.029739776951673, 1.33314712305114, 1.434782608695652, 1.0888252148997135, 1.2456140350877194, 1.2745411013567438, 1.8, 1.2832618025751072, 1.0622568093385214, 1.16, 1.0039737956560737, 1.043718961165839, 1.0566211245401997, 1.7209302325581395, 1.0568181818181819, 1.016444038216404, 1.0266666666666666, 1.0128664495114006, 1.2192066805845512, 1.1458333333333333, 1.238532110091743, 1.5438898450946643, 1.0648226908749596, 1.194607268464244, 1.065217391304348, 3.6666666666666665, 1.017042330951072, 1.6528599605522682, 1.0447696943607405, 1.2820512820512822, 1.007634555073336, 1.3733333333333333, 1.0069936348943471, 1.7692307692307692, 1.167785234899329, 1.0504005426429803, 1.0813045475424896, 1.2857142857142858, 1.0, 1.0141509433962264, 1.3387978142076502, 1.8888888888888888, 1.1243611584327087, 5.0, 1.7510917030567685, 1.0300987017741912, 1.0755478662053057, 1.2441129074179966, 1.0748554913294797, 1.42254418086292, 1.1171875, 1.004225352112676, 1.2004175365344467, 1.4843568945538819, 1.6455696202531647, 1.0125762195121952, 4.363636363636363, 1.4368686868686869, 1.2615704561013732, 1.0365448504983388, 1.5579854208084825, 1.0400717368155579, 1.0606060606060606, 1.0239624146095183, 1.00253807106599, 1.3417226566802511, 1.1913069189828505, 1.2520486714675938, 2.1666666666666665, 1.8211009174311927, 1.0729261622607111, 1.0059051769527991, 1.3726158038147138, 1.1829268292682926, 1.0024953797949285, 1.0, 1.244968090328915, 1.276374442793462, 1.0, 1.3284671532846715, 1.0, 1.0952380952380953, 1.0052562712415278, 1.1450037101162502, 1.108910891089109, 1.5, 1.1551610782380013, 1.0, 2.065040650406504, 1.1035052326314463, 1.3, 1.1883830455259026, 1.0368098159509203, 1.023013300745621, 1.109936575052854, 1.2380952380952381, 1.0017780049673013, 1.1161417322834646, 1.5526315789473684, 1.1666666666666667, 1.4489795918367347, 1.0679340229242382, 3.0, 1.1750208855472013, 1.9574944071588367, 1.2171990171990172, 1.417813360020015, 3.0, 1.0171608351606445, 1.2735849056603774, 1.0080775444264944, 1.736834030989064, 1.0, 1.2591362126245846, 1.0440346978890693, 1.2054571149037938, 1.1921965317919074, 1.5602094240837696, 1.4464285714285714, 2.1904761904761907, 1.0648854961832062, 8.428571428571429, 1.0049203024601512, 1.9325808419768151, 1.0432748538011696, 1.0060978637614086, 1.0755244755244755, 1.022242174427621, 1.4797507788161994, 2.5869565217391304, 1.0745597316459556, 1.306352184400965, 1.148347425057648, 1.1537091988130563, 1.008494572911751, 1.0036031042128604, 1.1067521944632006, 1.0769230769230769, 1.0155138396548478, 1.2011661807580174, 1.0395997445177774, 1.3823529411764706, 1.2040089086859689, 1.0263157894736843, 1.0480161223207656, 1.0264430341492898, 1.1052017470553916, 1.1029411764705883, 1.032959326788219, 1.1131078620193497, 1.0, 1.2222222222222223, 1.0118460340127222, 1.7006779625051722, 1.1315192743764173, 1.2586206896551724, 1.3100958466453674, 1.1210120068610634, 1.0021932869752224, 1.0941274468971263, 1.1032863849765258, 1.1788413098236776, 1.0026724629418473, 1.0210607134420033, 1.0204081632653061, 1.1510416666666667, 1.0801140606965849, 2.3204819277108433, 1.16, 1.1004823151125402, 1.7028451001053742, 1.003786221574555, 1.295774647887324, 1.0130462896048078, 1.681918556333848, 1.2292358803986712, 1.1184503901895206, 1.0307101946003803, 1.2343279147744153, 1.3846153846153846, 1.3977695167286246, 1.0125189451348893, 1.0635148470440476, 2.5443037974683542, 1.4579710144927536, 1.10337972166998, 1.010405337879545, 3.769230769230769, 1.0001041242046682, 1.0953717981174196, 1.4242424242424243, 1.0869947275922671, 1.3925233644859814, 1.0, 1.1759259259259258, 1.0, 1.2288037166085946, 1.048334756618275, 1.0590863952333665, 1.2238805970149254, 1.0, 2.0, 1.256957800030948, 1.2962962962962963, 1.0762588345296042, 3.0, 1.0362182502351835, 1.19, 1.6, 1.0079834283381466, 1.2709551656920077, 1.0651685393258428, 1.7541689613393545, 1.1492248062015504, 1.2032654772441422, 1.5, 2.0, 1.1949874070888875, 1.003174776944551, 2.01056338028169, 1.210756770437864, 1.335526762092124, 1.0205716816926365, 1.1388379204892967, 1.0028541077393676, 1.1092896174863387, 1.0537162902872177, 1.3041319666880204, 1.7121951219512195, 1.2199164185940004, 1.0073529411764706, 1.2857142857142858, 1.0416666666666667, 1.0674846625766872, 1.0366748166259168, 1.0380835787314298, 2.2222222222222223, 1.020740539166733, 1.3196347031963471, 1.2239467849223946, 1.0132240452239347, 1.31491344873502, 1.1139056048789702, 1.004173414461917, 2.5, 1.034982332155477, 1.0778097982708934, 1.0810739914935077, 1.035430030758081, 1.0084960681299906, 1.0228188179088311, 1.0062532569046378, 1.040512027008018, 1.2801775920605902, 1.0706267693725722, 1.0618157632191554, 1.0108225108225108, 1.6666666666666667, 1.0909090909090908, 1.076755748912368, 2.00747556066705, 1.1213768115942029, 1.1778167566530544, 1.530025736345439, 1.7027027027027026, 2.1041666666666665, 1.1155682903533906, 1.5339712918660287, 1.0720144600090376, 1.1666666666666667, 1.0519537218947828, 1.0059200159444932, 1.1196581196581197, 2.5, 2.3333333333333335, 1.0168205128205128, 1.7142857142857142, 1.0451729776894318, 1.072628726287263, 1.0555555555555556, 1.0029718088628863, 2.6615384615384614, 1.6, 1.0824702109541553, 2.0, 2.0435186907197322, 1.3880813953488371, 1.2323404255319148, 1.0610250737463127, 1.6160337552742616, 1.1318681318681318, 1.0018048796209753, 1.0461640033587807, 1.0895522388059702, 1.0220554310036716, 1.050462915861227, 5.0, 1.1111111111111112, 1.2351529863384894, 1.75, 1.0194889562581204, 1.2142857142857142, 1.5830258302583027, 1.7222222222222223, 1.0943775100401607, 1.1203852327447834, 1.0486111111111112, 1.1687691783157177, 1.3703703703703705, 4.0, 1.1671360721671984, 1.031500926497838, 1.5555555555555556, 1.2685939651002716, 1.144278606965174, 1.07226738934056, 1.0008787346221442, 1.3333333333333333, 2.0, 1.0702127659574467, 1.65, 1.0130841121495326, 1.0142709661747737, 1.0464658881376767, 1.3775100401606426, 3.0, 1.0035870247607037, 1.7241078439926707, 4.125, 2.0638297872340425, 1.141858141858142, 2.0, 1.8951612903225807, 1.4193548387096775, 1.0539047334627445, 1.055908627202294, 1.085729788388497, 1.1108004194337644, 1.2266604010025062, 1.608523489932886, 1.0178343949044586, 1.2964229895903985, 1.334513274336283, 3.75, 1.0226446555116786, 1.0708966015907448, 1.0355769230769232, 1.4, 1.2962962962962963, 1.2806539509536785, 2.0, 1.2790697674418605, 1.7202472952086554, 1.3302752293577982, 1.3317073170731708, 1.6446009030381878, 1.0174912543728136, 1.2031662269129288, 1.1377640001095721, 1.169732441471572, 1.0181065700982928, 1.1121495327102804, 1.178131571042355, 1.2302405498281788, 1.0, 1.0037887630645352, 2.576923076923077, 1.0126658077627975, 1.0986702039775866, 1.1346425084083758, 1.0731266149870802, 1.1818181818181819, 1.1992233009708737, 2.0, 1.1200873362445414, 2.2, 1.0230850483848986, 1.358267716535433, 1.0925196850393701, 1.1626297577854672, 1.2014879107253564, 3.0, 1.1471774193548387, 1.0111750379273285, 1.0246607052849703, 2.0, 1.0, 1.3664459161147904, 1.1810344827586208, 1.0986530998271533, 1.212032188018904, 1.3461538461538463, 1.4834368530020703, 1.1794525456901066, 1.2816513980912287, 1.0891465420964779, 1.2384192805245438, 1.1472527472527472, 2.3333333333333335, 1.014986886474335, 1.208425913823901, 1.148936170212766, 1.3812472357363998, 6.0, 1.0, 1.7346938775510203, 1.4355828220858895, 1.0684931506849316, 1.0223063514544068, 1.3654223968565815, 1.0, 1.4946236559139785, 1.4166666666666667, 1.0231610415065606, 1.375, 1.0, 1.037229001875955, 1.5, 1.0, 1.1821428571428572, 1.6046511627906976, 1.1568209500609012, 1.1100346020761245, 1.0295081967213116, 1.1111111111111112, 1.5222254644489837, 2.4770992366412212, 1.1196701528559936, 1.5, 2.044642857142857, 1.0300751879699248, 1.0721343873517786, 1.2055311125078567, 1.1049046544336507, 1.4633204633204633, 1.0, 1.5416666666666667, 1.2382798137026596, 1.0752110514198006, 1.1320293398533008, 1.4, 1.1005741804037785, 1.0163174166952937, 1.0602352941176472, 2.0, 1.1364634816035146, 1.250279592677615, 1.3281653746770026, 1.244988864142539, 1.0507533087676275, 1.0676998558340696, 1.2760655737704918, 1.126675582371785, 2.0, 1.001601905857225, 1.0375260597637248, 1.141934046345811, 1.013898080741231, 1.202290076335878, 1.0526111166850607, 1.2897278314310798, 1.1215973961578072, 1.1330089213300891, 1.0142443198743467, 1.0669856459330143, 1.2305825242718447, 1.4111305361305362, 1.5263157894736843, 1.945054945054945, 1.0127495099865056, 1.4202898550724639, 1.0823448275862069, 1.0036263313688842, 1.5, 1.635618479880775, 1.1443298969072164, 1.025, 1.0, 1.1426247579095634, 1.1605263157894736, 1.1218161683277963, 1.0, 2.3333333333333335, 1.143610343961838, 1.7556060175986374, 1.2083333333333333, 1.0, 1.1333333333333333, 2.06984126984127, 1.4713541666666667, 1.2468619246861925, 1.0217166494312306, 1.2063253012048192, 1.3307392996108949, 1.408262454434994, 1.1741935483870967, 1.0082486092461156, 1.0135746606334841, 1.0584852536716347, 2.0, 1.036928487690504, 1.1300448430493273, 1.047448244123957, 1.3496732026143792, 2.9389067524115755, 1.0215384615384615, 1.713575996600826, 1.034965581977472, 1.0, 1.3617021276595744, 1.1904761904761905, 1.0, 4.0, 3.4, 1.3471933471933473, 1.0468227424749164, 1.0396162950043604, 1.0572100313479624, 1.0146144603489708, 1.1124395604395605, 1.012124963219254, 1.0605676863795068, 1.0603077720356429, 1.1032496914849856, 1.1026945858012847, 1.0133394385078365, 1.3971676858706148, 1.767816091954023, 1.093210586881473, 1.2985074626865671, 1.0253719294199055, 1.1661971830985915, 1.0174978929238887, 1.4477611940298507, 1.125405055087492, 1.2457786116322702, 1.68997668997669, 1.4583333333333333, 1.3333333333333333, 1.2944685466377441, 1.0512488843472299, 1.1040138828973685, 1.2271706586826348, 1.032690509063377, 1.0256410256410255, 1.0790914066776136, 1.0967733227756982, 1.1470588235294117, 1.4523809523809523, 1.0182875264270612, 1.0552359033371692, 1.0351238894928216, 1.2136752136752136, 1.1274265803882528, 1.0701794340097568, 1.0455939687995903, 1.2258064516129032, 1.0248507735412353, 1.2321428571428572, 1.0324678791330035, 1.08818682487029, 2.239247311827957, 1.0, 1.2705376344086021, 1.1009174311926606, 1.6666666666666667, 1.0467302953921096, 3.0, 1.4151759953837277, 1.2176464396610704, 1.7142857142857142, 1.0225327110831162, 1.4285714285714286, 1.2758620689655173, 1.0358591872285066, 1.0312771503040834, 1.0434824239761635, 1.000018666157841, 1.3493589743589745, 1.1944444444444444, 1.4814814814814814, 1.0045112781954888, 1.135935397039031, 1.0065255731922398, 1.144630218483947, 1.02171581769437, 1.0, 1.0696519580084505, 1.1630533558353888, 1.0, 1.2643420567637302, 1.0193512956924662, 1.3835078534031413, 1.0278926705088207, 1.2070066518847007, 1.6232876712328768, 1.4, 1.2370169082125604, 1.4302191464821223, 1.0353423666117165, 1.374340949033392, 1.1447042356512651, 1.0045277993563422, 1.1305483028720626, 1.0433742147771463, 1.0067340067340067, 1.0814336871048458, 1.1267258382642997, 1.1152922337870297, 1.0954214805305948, 5.7, 1.4253051557660776, 1.315043791859866, 1.0588235294117647, 1.4, 1.5316315205327413, 1.538795442213782, 1.0185938407902382, 1.1689696012633242, 5.666666666666667, 1.1626074498567336, 1.0747022735474558, 1.1285714285714286, 1.2187666161702297, 3.6666666666666665, 1.1478124844813031, 1.0807860262008733, 1.326086956521739, 1.8333333333333333, 1.0024721535512902, 1.146341463414634, 1.1746031746031746, 1.3661016949152542, 1.0, 1.355270367092342, 1.1351150705270971, 1.0, 2.0, 1.9, 1.7469879518072289, 1.0827120223671949, 1.0039651070578905, 1.03125, 1.1804034582132565, 1.2980392156862746, 1.0588235294117647, 1.1824104234527688, 1.3315217391304348, 1.625, 1.0, 1.483582089552239, 1.1425313568985176, 1.1138279932546373, 1.2123479095502923, 1.0132835610649387, 1.029027324927143, 1.005428138581314, 1.1553142618500731, 1.127906976744186, 1.6288798920377867, 1.7333333333333334, 2.5, 1.6956906140375896, 1.1777481833701278, 1.1531741409435061, 1.6592920353982301, 1.1876379690949228, 1.0495857773477657, 1.263672172163711, 1.0010278434589586, 1.1470588235294117, 2.4444444444444446, 1.017636684303351, 1.221898283122773, 1.0138563285047997, 1.0435084596768067, 1.1968503937007875, 1.0990257659274452, 1.1925316612528751, 1.0480320213475651, 1.1782106782106783, 1.1925015682408817, 1.2007299270072993, 1.169440887750747, 2.1563206835888415, 1.0090884496373074, 2.7857142857142856, 1.724094335035254, 1.0331167606065608, 1.0099071783824038, 1.0774689532820816, 1.5, 1.1153846153846154, 1.09009009009009, 1.230865746549561, 1.1857644955090128, 1.04522912120611, 1.1418707037063285, 1.014215748420287, 1.0055965403205291, 1.7340190572348078, 1.010885170027213, 1.5384615384615385, 1.2727272727272727, 1.0, 1.5, 1.0682743308252127, 1.3333333333333333, 1.0085261666889596, 1.0132221406040705, 1.0499357444464843, 1.0381703470031545, 1.008653850510396, 1.2805380181169366, 1.6483516483516483, 1.2649122807017543, 1.102206225246468, 1.2067532026809196, 1.0080161228233055, 1.0528977773653194, 3.3333333333333335, 1.7790289828318258, 1.0892156862745097, 1.0261420831155972, 1.5906735751295338, 1.1455653351387949, 1.2639821029082774, 3.186335403726708, 1.2627991070604947, 1.1939102564102564, 1.0660046010091926, 4.0, 1.0316278723532941, 1.0114507203843741, 1.0540007883326763, 1.1549620837454666, 1.2682926829268293, 1.7727272727272727, 1.172211440717124, 1.044082436065044, 5.0, 1.0058148199897536, 1.064516129032258, 1.1002934115764205, 1.2231003039513677, 1.4841628959276019, 1.0836665641341126, 1.1896551724137931, 1.8443983402489628, 1.0842440801457194, 1.0705806232851354, 1.269804822043628, 1.100059804638182, 1.0321075740944017, 1.1304347826086956, 1.4905882352941175, 1.138820912124583, 1.0902918053619355, 1.3413043478260869, 1.098961937716263, 1.5911708253358925, 1.044496487119438, 1.168192219679634, 1.0239619730050904, 2.0, 1.1079926784624772, 1.029724535554132, 1.0780581693755347, 1.804812834224599, 1.049455422712598, 1.1686430092014286, 1.108182653999387, 1.0657840297889947, 1.0009931573802542, 1.1102471239880698, 1.1377245508982037, 1.3214285714285714, 1.0540406544372831, 1.0023297007971042, 1.3, 2.3333333333333335, 1.0228541992035782, 1.0400045837391851, 1.1856, 1.0358744394618835, 1.4913606911447084, 1.048860382419056, 1.4625822368421053, 1.5770151636073424, 1.4230769230769231, 1.02297165200391, 1.7130114714117965, 1.4725848563968669, 1.5925925925925926, 1.1767355798313348, 1.2853503184713375, 1.2519685039370079, 1.3658536585365855, 1.7996289424860854, 1.0051491682516998, 1.1172381835032437, 1.5765124555160142, 1.010542811087014, 1.0507491541807636, 2.107142857142857, 2.0, 1.0975609756097562, 1.1025641025641026, 4.0, 1.0, 1.0225165562913907, 1.0705521472392638, 1.2510715285705054, 1.1983168260147707, 1.0327272727272727, 1.0735294117647058, 1.125, 1.44, 1.2432432432432432, 2.9166666666666665, 1.4030032467532467, 1.074640958107638, 1.0151691253166444, 1.3425925925925926, 1.018947072528637, 1.0067984603370292, 2.5, 1.0014555807414485, 1.0817890702924038, 1.0, 8.333333333333334, 1.1440114068441065, 1.1291403897505823, 1.209951438823004, 1.1645962732919255, 1.0, 1.4375, 1.3252032520325203, 1.4, 1.1292653861431812, 1.0016281726388214, 1.0137011947591603, 1.0364871665827882, 3.3333333333333335, 1.0034606343009467, 1.0958531611148878, 1.1948529411764706, 1.2941176470588236, 1.1899350649350648, 1.0, 1.0503597122302157, 1.0413839891451833, 1.2220563139931742, 1.3259911894273129, 1.6595744680851063, 1.2162071602244122, 1.2060367454068242, 1.5316455696202531, 1.2321428571428572, 1.0460935124472754, 1.188317564788153, 1.3636363636363635, 1.0597492728434657, 1.596774193548387, 1.0788288288288288, 1.234390009606148, 1.625, 1.073020134228188, 1.3151750972762646, 1.0084140056718889, 1.7447619047619047, 3.0, 1.2198221092757306, 1.0393271926311574, 1.0810913224706329, 1.1434608540925266, 1.0428625736551986, 1.026319323217403, 1.0988770017941392, 1.342293906810036, 1.5, 1.0029318195995258, 1.0112622340295492, 1.0283140283140284, 1.0351390922401171, 2.5, 1.3174603174603174, 1.1031444731375961, 1.0429184549356223, 1.2708907436410857, 1.0273787977973738, 1.279943635509629, 4.0, 1.0960307298335468, 1.3140741384807118, 1.1477779760842406, 1.1019108280254777, 1.0115001036894595, 1.2921810699588476, 1.0159489633173844, 1.1854559445940747, 1.0033629193589184, 1.0216324831194221, 1.239279588336192, 1.0810536980749748, 1.3055555555555556, 1.3931674800618974, 1.3323553079541937, 1.0135070929206542, 1.0195384397564775, 1.0960295475530932, 1.1416234887737478, 6.0, 1.1804511278195489, 2.5, 2.5, 1.411764705882353, 1.095576323987539, 4.0, 1.0679304897314377, 1.2, 1.7857142857142858, 1.3320950559956297, 1.0, 1.6402439024390243, 1.01340206185567, 1.0733439065634551, 1.1428571428571428, 1.1764705882352942, 1.0941333333333334, 2.375, 1.4223484848484849, 1.206102117061021, 1.58477360377089, 1.0327677945273344, 1.4, 1.2756714060031595, 1.1992400854903824, 1.0173099528203147, 1.0090222667945699, 1.0746268656716418, 1.120552778594531, 1.0527392947103276, 1.290336017772841, 1.3644251626898047, 1.6984126984126984, 1.118279569892473, 2.0, 1.52, 1.007030281565433, 2.5, 1.1666666666666667, 5.3076923076923075, 1.6372549019607843, 1.0064642439267386, 1.1318069306930694]
origin-bjaq_15.71 	max: 8.4286	99th: 5.0000	95th: 2.4782	median: 1.1467	mean: 1.3628

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 11/15 | Workload-time: 12.028348 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 12/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=valueskew', '--dataset=bjaq', '--drift_test=distribution', '--end2end', '--update_size=20000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
ValueSample - START
ValueSample - END
load_npy_dataset_from_path - df.shape = (502168, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (482168, 5), new data size: (20000, 5)
[1.1920929e-07 1.7881393e-07 0.0000000e+00 5.9604645e-08 4.0215254e-04]
Distance score: 8.050203177845106e-05
SAUCE Drift detection: True
Detection latency: 0.0412s

DRIFT-DETECTED after 12-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=bjaq', '--end2end', '--model=transformer', '--model_update=adapt', '--update_size=20000', '--epochs=40']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
update_size: 20000
AdaptTask - START
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
load_npy_dataset_from_path - df.shape = (502168, 5)
Parsing... done, took 0.0s
done, took 0.0s
dataset size: 502168
train data shape: torch.Size([20000, 5]), transfer data shape:torch.Size([4000, 5])
Epoch 0 Iter 0, train entropy gap -0.1503 bits (loss 18.130, data 18.280) 0.00300 lr
epoch 10 train loss 11.9487 nats / 17.2383 bits
time since start: 4.4 secs
Epoch 10 Iter 0, train entropy gap -1.0160 bits (loss 17.264, data 18.280) 0.00256 lr
epoch 20 train loss 11.6736 nats / 16.8414 bits
time since start: 8.7 secs
Epoch 20 Iter 0, train entropy gap -1.5041 bits (loss 16.776, data 18.280) 0.00150 lr
epoch 30 train loss 11.5578 nats / 16.6744 bits
time since start: 12.9 secs
Epoch 30 Iter 0, train entropy gap -1.5869 bits (loss 16.693, data 18.280) 0.00044 lr
epoch 40 train loss 11.5353 nats / 16.6419 bits
time since start: 17.1 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 19.4789 nats / 28.1020 bits
Saved to: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
AdaptTask - END

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 12/15 | Workload-time: 2.104805 | Model-update-time: 19.628699


WORKLOAD-START | Type: QueryWorkload | Progress: 13/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 502168, total size: 502168, split index: [418473 502168]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 9.6667	99th: 5.0011	95th: 2.3563	median: 1.1616	mean: 1.3702
ReportEsts: [1.23046875, 1.125272115574906, 1.0790645935531715, 5.252525252525253, 1.0344827586206897, 1.0, 1.0297817312590618, 1.0060082536238353, 1.6, 1.0264400377714826, 1.0343211609426999, 1.0014763795745523, 1.029285949325436, 1.10337972166998, 1.0893133711925658, 4.333333333333333, 1.638157894736842, 3.6666666666666665, 2.4, 1.0638143582306019, 1.3565333779488038, 1.1652609550383664, 1.2589285714285714, 1.0901803607214429, 1.0124326232032854, 1.0059059172450724, 2.0, 1.1016381430889204, 1.5, 1.0, 1.3369008841321546, 1.0, 1.0080899947505209, 1.020577096856526, 1.4211356466876972, 1.237549981824791, 1.0121019609902082, 1.0734966592427617, 3.5, 1.1877168632893824, 1.0235013623978202, 1.0551181102362204, 1.075512405609493, 1.076859956236324, 1.3020594965675056, 1.235283045503741, 1.4166666666666667, 1.068019747668678, 1.1686274509803922, 1.1148325358851674, 2.0, 1.0505050505050506, 1.0173010380622838, 1.1379310344827587, 1.0360318626066325, 1.026908587683555, 1.0621597545283579, 1.48, 1.1842105263157894, 1.0049864275920928, 1.28125, 1.0931823690856914, 1.4038461538461537, 1.1702127659574468, 1.2300884955752212, 1.7157142857142857, 1.0409079639679348, 1.1269007464749792, 1.271604938271605, 3.6666666666666665, 1.0682230869001297, 1.3365231259968102, 1.0585408475316733, 1.0053475935828877, 1.0841090525681578, 1.1553480475382003, 1.0032520325203251, 1.2602739726027397, 1.0119734751266798, 1.032287266143633, 1.0068, 1.0244086090813738, 2.7777777777777777, 1.2592999225006458, 1.3989637305699483, 1.6325459317585302, 1.3470225872689938, 1.2307692307692308, 1.007959964293478, 1.0169792712507442, 1.511111111111111, 2.3333333333333335, 1.1247540338449429, 1.0116928862757562, 1.032994923857868, 1.6976190476190476, 1.0010030090270812, 1.2419889502762431, 1.446808510638298, 1.2152269399707174, 1.5588235294117647, 1.7765957446808511, 1.2402946218807542, 1.0108129755706847, 1.1051964512040557, 1.03104280522651, 1.1666666666666667, 1.0224119808336962, 1.1293123143705734, 1.2997759282970551, 1.225, 1.0376984126984128, 1.3333333333333333, 1.2153846153846153, 1.186799501867995, 1.0219994322225376, 1.1572446555819478, 1.4507042253521127, 1.008163893326334, 1.0, 1.1801505174035747, 1.389638041163946, 1.0, 2.9836065573770494, 1.5714285714285714, 1.1145251396648044, 1.001578765868483, 1.2240639767357324, 1.6470588235294117, 1.5, 1.1568237610596839, 1.2727272727272727, 1.165318957771788, 1.2561115655025983, 1.0324765447177038, 2.0, 1.0117948717948717, 1.1012280701754387, 1.4601769911504425, 1.1379310344827587, 1.04, 1.1833996023856859, 1.1193499238191975, 1.3011915596097272, 1.4135802469135803, 1.1768953068592058, 1.0831392273499196, 1.0, 1.0120399036807706, 1.6440792082860647, 1.1072436500470366, 1.4253018108651911, 1.5, 1.0429480034096126, 1.4859259259259259, 1.021671826625387, 1.6449341623994147, 8.0, 1.1814038286235187, 1.0606443186765346, 1.357365811861191, 1.04178674351585, 1.2555205047318612, 1.0740740740740742, 2.3793103448275863, 1.1716216216216215, 1.0727069351230425, 1.1428571428571428, 2.1305970149253732, 1.155835436919276, 1.1510309278350515, 1.153061224489796, 1.0097310909254429, 1.2065727699530517, 1.1233133008277583, 4.415730337078652, 1.2780920287238737, 1.174124513618677, 1.2546125461254614, 1.3076923076923077, 1.2663494088210765, 1.0872062467152188, 1.0397594796907597, 1.0597495975433233, 1.077086280056577, 1.1536119892284276, 1.491103202846975, 1.0173880873103958, 1.2459016393442623, 1.0382338850510764, 1.2035052143684821, 1.0836734999028095, 1.2950819672131149, 1.0416386836803224, 1.0023556253815133, 1.8093645484949832, 6.25, 1.17015586797066, 1.9285714285714286, 1.274040696634839, 1.0178403571988093, 1.1355297641332833, 1.2608755696726972, 1.0731542108828178, 1.004767960402963, 1.0068300522298113, 1.094170403587444, 1.1364728495915426, 1.0405247296578621, 1.0163890942542229, 1.3333333333333333, 1.0032108455226543, 1.0118509468540011, 1.3552036199095023, 1.6896551724137931, 1.1722933643771827, 1.4257950530035335, 1.007225465359621, 5.111111111111111, 1.040423310895936, 1.6472614945942734, 1.6030927835051547, 1.080175302913122, 1.0098555036588968, 1.2401353195360474, 1.1176470588235294, 1.1176470588235294, 1.0139648451444319, 1.0208536515403592, 1.2793522267206479, 2.453658536585366, 1.017189792571708, 1.0138588133391078, 1.206896551724138, 1.0018478182104935, 1.0792756626089959, 1.2756598240469208, 2.453333333333333, 1.1787974683544304, 1.2666666666666666, 1.2487708947885938, 1.0, 1.173274189076795, 1.0350877192982457, 1.1817174515235458, 1.3134328358208955, 1.5, 2.6666666666666665, 1.305468821746717, 1.123076923076923, 1.0699975448072674, 2.0, 1.0545799715234931, 1.310657596371882, 1.6, 1.0127274298802886, 1.0186567164179106, 1.1689272503082615, 1.6750549157651904, 1.153497409326425, 1.2334893271572513, 1.6285714285714286, 2.0, 1.203131957844738, 1.1044316663762561, 1.8721311475409836, 1.233834567073328, 1.2964340983174738, 1.0098434400232503, 1.1796372147454652, 1.0410071680675326, 1.2036316472114137, 1.0486268273288886, 1.41004329004329, 1.8409090909090908, 1.3741193919169448, 1.2595505617977527, 1.18, 1.88, 1.0426829268292683, 1.0780456852791878, 1.0380458966372133, 1.8961748633879782, 1.020547541515022, 1.333846153846154, 1.24364406779661, 1.026569067212941, 1.0732375085557837, 1.0619967588939514, 1.0165819370129057, 1.4285714285714286, 1.078125, 1.0391254315304947, 1.07660382667417, 1.0251936394368046, 1.0037937396821286, 1.0181760766794528, 1.2132607619990103, 1.0781818181818181, 1.1766202592414787, 1.1301943410158521, 1.0164733346168655, 1.6410204392148906, 1.8333333333333333, 1.0909090909090908, 1.0072757800475725, 1.0424433610553485, 1.0331491712707181, 1.1872373031400876, 2.4741784037558685, 1.8922841864018334, 1.0038717604366088, 2.0, 1.309375, 1.3266055045871559, 1.5812807881773399, 1.0322506410677887, 1.1255992329817832, 1.644524236983842, 1.2, 4.222222222222222, 1.0795237082713163, 1.5714285714285714, 1.0485897432365798, 1.1887781856318826, 1.1764705882352942, 1.0545075922867448, 1.1502890173410405, 2.1666666666666665, 1.0326720285969615, 1.1732442998601718, 1.1685678073510772, 1.5290590405904059, 1.1175510204081633, 1.1252045826513912, 1.1425686591276252, 1.4237918215613383, 1.032967032967033, 1.0125695703833406, 1.0657166404251133, 1.3352601156069364, 1.0153016613232293, 1.0168460684462035, 3.0, 1.0, 1.2461803528456905, 1.0, 1.0180698151950718, 1.588235294117647, 1.7682926829268293, 3.0, 1.3209549071618036, 1.0020632737276478, 1.1578947368421053, 1.3443344334433442, 1.135135135135135, 2.6666666666666665, 1.1153412199952544, 1.318782309017806, 2.0, 1.2569490525694906, 1.1956521739130435, 2.1005692599620494, 1.1119473189087488, 1.3333333333333333, 2.0, 1.375443577004968, 1.6097560975609757, 1.1409601634320736, 1.0026818928973094, 1.033907851751718, 1.3294573643410852, 3.0, 1.00037795190562, 1.6096015152618925, 2.75, 2.8363636363636364, 1.1415929203539823, 3.25, 1.0846153846153845, 2.0144927536231885, 1.0416100853280366, 1.0303571546700008, 1.0052531041069723, 1.1557745000874482, 1.0082756916996047, 1.6515550574390585, 1.1839220462850182, 1.3223943450142879, 1.7254901960784315, 3.3333333333333335, 1.0178281730748542, 1.0463109318508022, 1.0543778801843318, 1.3257575757575757, 1.5909090909090908, 1.492063492063492, 2.0, 1.0, 1.3193916349809887, 1.1720183486238531, 1.0765306122448979, 1.7871756407392039, 1.0428163653663178, 1.0685279187817258, 1.1286422123734494, 1.0672760511882997, 1.0627095492363094, 1.2142857142857142, 1.2228320526893524, 1.2877697841726619, 1.0, 1.0005711649568332, 1.2884615384615385, 1.0114695463768615, 1.117661964692964, 1.2550102004080164, 1.0190585533869116, 1.4545454545454546, 1.1124392977213298, 2.0, 1.0887096774193548, 2.2, 1.0262159075641542, 1.1308411214953271, 1.0047952809619989, 1.7216494845360826, 1.25, 1.2028985507246377, 1.15, 1.0, 1.0873724349225242, 1.0309038476453707, 1.0101644643026904, 1.3333333333333333, 1.0593056894889104, 1.1202090592334495, 1.7592592592592593, 1.2272727272727273, 1.1577729471986538, 1.0755735492577598, 1.0350340573191106, 1.1578947368421053, 1.001466275659824, 1.041326759300762, 1.325, 1.2679083094555874, 1.471502590673575, 1.0532407407407407, 1.1075507614213198, 1.1071428571428572, 1.4107142857142858, 1.0205761316872428, 1.1495726495726495, 1.1098123654260228, 1.0104885959405734, 1.0491276400367309, 1.0, 2.0, 1.1290322580645162, 1.0027005076142133, 1.375, 1.0, 1.1443105084988627, 1.0, 1.0, 1.002054794520548, 1.853658536585366, 1.039745145631068, 1.072944297082228, 1.3639344262295081, 1.1111111111111112, 1.6201328173522527, 1.1001540832049306, 1.0055930568948892, 1.0, 1.5042735042735043, 1.289855072463768, 2.072930072930073, 1.2179487179487178, 1.006476215935125, 2.3793103448275863, 1.0515463917525774, 1.25, 1.0534976509195646, 1.0007423264164623, 1.2854594112399642, 1.25, 1.1765083440308088, 1.0484958079894788, 1.1458951533135509, 1.754416961130742, 1.0116489774786435, 1.3271892280296167, 1.0817484150817485, 1.3940149625935163, 1.0684489641396249, 1.0882740013270427, 1.1536050156739812, 1.037248183375672, 1.2, 1.065234752637552, 1.0660701995870612, 1.2873309412089429, 1.6733111849390918, 1.1682539682539683, 1.0396691202829624, 1.296, 1.1571892407137112, 1.0935386927122464, 1.0033060816525283, 1.4047217537942664, 1.2794708064084426, 1.2882923528084818, 1.5897435897435896, 1.8979591836734695, 1.035910259081753, 1.3153692614770458, 1.050121983096628, 1.0139868027748011, 1.5, 1.214720531267294, 1.515625, 1.1, 2.75, 1.1265648963869173, 1.781021897810219, 1.1956856702619414, 1.0, 1.15, 1.027988717726188, 1.7220495037665908, 1.2777777777777777, 1.0, 1.0588235294117647, 1.2325141776937618, 1.1970338983050848, 2.033766233766234, 1.2007083825265643, 1.1134185303514377, 1.1610486891385767, 1.0588928150765606, 1.7843137254901962, 1.067755810133859, 1.3013698630136987, 1.0594086849399447, 2.0, 1.3951104100946372, 2.3551401869158877, 1.0385568037043504, 1.341404358353511, 1.2783216783216784, 1.2537037037037038, 1.6492057574627883, 1.0189132947976878, 1.0, 1.3829787234042554, 1.1153846153846154, 1.0, 1.6680177969187897, 1.0357142857142858, 1.2134831460674158, 1.1366459627329193, 1.0495929868503444, 1.1251874062968517, 1.0264943172521428, 1.0010651652908282, 1.0094607333404602, 1.0278126183761942, 1.0569475208840433, 1.038474870017331, 1.1071233943168548, 1.0057553575217484, 1.136336866902238, 1.0785413744740533, 1.3534246575342466, 1.2785714285714285, 1.0641134542231414, 1.0471014492753623, 1.0045756561070107, 1.4696969696969697, 2.0883944678292243, 1.08745148771022, 1.384158415841584, 1.163265306122449, 1.5, 1.0507276507276506, 1.0014517042772164, 1.1242371746009747, 1.0437041564792175, 1.0210998434436749, 2.6, 1.2480630334865397, 1.0986485914001272, 1.0635838150289016, 3.9375, 1.0174729380208831, 1.2953476215368531, 1.1182485957079071, 1.0666666666666667, 1.0538461538461539, 1.0784103765196433, 1.0069124649722718, 1.15625, 1.030043728939588, 1.054054054054054, 2.875, 1.4067796610169492, 1.1977627106118829, 1.1551302025372803, 1.5027932960893855, 1.0512820512820513, 1.1187178229958323, 1.0, 1.1271604938271604, 1.620347394540943, 1.0572916666666667, 1.1082862523540489, 1.9545454545454546, 1.1507213806409209, 1.0, 1.3360655737704918, 1.1179624664879357, 1.331945889698231, 1.2189349112426036, 1.3715213358070502, 1.172442941673711, 1.1280620155038759, 2.0, 1.3719904197655364, 1.062795733418879, 1.2, 1.69625520110957, 1.4698226544622426, 1.3686567164179104, 1.2578960288020946, 5.333333333333333, 1.1630252100840337, 1.2393946171624544, 1.4813278008298756, 1.3592233009708738, 1.015133902624402, 1.0863309352517985, 1.4, 1.1801332778009164, 1.4657210401891252, 1.0884436843391156, 1.0547417116422513, 1.1376696493482779, 1.0092819279160368, 1.1773399014778325, 1.1524351676154332, 1.1455938697318007, 1.0176236366784004, 1.0798299480396787, 1.0261168384879724, 1.1228865979381444, 1.8333333333333333, 1.6347309945970627, 1.1073752711496747, 1.1666666666666667, 1.2, 1.0978947368421053, 1.2886259040105195, 1.022290331568682, 1.1597222222222223, 2.5714285714285716, 1.334016393442623, 1.0680425669138986, 1.7073170731707317, 1.1490905307365613, 6.0, 1.1754446754446755, 1.1514522821576763, 1.0313028764805414, 1.1699658703071671, 1.026586237712243, 1.087714627978171, 1.3548387096774193, 1.5545454545454545, 1.2176938369781312, 1.0, 1.3341865271220825, 1.0006540222367561, 1.5, 4.0, 3.022727272727273, 1.4379310344827587, 1.102018369708859, 1.7941176470588236, 1.02, 1.2767102229054574, 1.5212765957446808, 1.1756756756756757, 1.0408496732026145, 1.228125, 2.2685185185185186, 1.5294117647058822, 1.5, 1.4924924924924925, 1.1986928104575163, 1.2339350180505415, 1.2365271472584005, 1.0119548333400095, 1.1489471679634364, 1.049179499842859, 1.2498983418424976, 1.2933333333333332, 1.477043673012318, 1.6199059561128526, 2.0, 1.664944895384542, 1.244005135757713, 1.0310796074154853, 1.1323155216284988, 1.0558659217877095, 1.094977749523204, 1.198819623755072, 1.0016913721459546, 1.0769230769230769, 1.8333333333333333, 1.196013289036545, 1.255659121171771, 1.0010286622714732, 1.0445147069091054, 1.0704225352112675, 1.036138987180231, 1.1771945854990837, 1.0406470022641978, 1.4572301425661915, 1.1897428446898155, 1.112094395280236, 1.0418424753867792, 1.585837360790082, 1.0031285896059807, 1.4473684210526316, 1.6238159675236807, 1.0194536537249637, 1.0156577190973561, 1.1556381162767346, 2.111111111111111, 1.228855721393035, 1.167202572347267, 1.0002323250728864, 1.26702131522568, 1.0412157908935584, 1.1184364012409513, 1.0138830620238206, 1.0272970996831587, 1.7632007565806758, 1.0080546242538229, 1.671641791044776, 2.0, 1.0, 1.7777777777777777, 1.0556433518681105, 1.5, 1.10010764262648, 1.023339399934523, 1.1160458452722064, 1.475, 1.452991452991453, 1.0016288491005647, 1.038962268119295, 1.2696390658174097, 1.135135135135135, 1.328976034858388, 1.806903991370011, 1.2372726754460976, 1.1428571428571428, 1.1675444668492492, 1.625, 1.0575461454940283, 1.2630736392742796, 1.05353025567454, 1.9469026548672566, 1.8, 1.0122937645899532, 1.321113074204947, 1.0193320707462719, 1.1698265429608714, 1.0229845534155306, 1.0111899968210236, 1.0492142266335815, 1.0278392913634926, 1.6785714285714286, 1.434782608695652, 1.2198107255520505, 1.0847560459406835, 5.0, 1.0004203493818853, 2.2, 1.03551550490326, 1.3202576112412179, 1.2238805970149254, 1.1980312680949623, 1.0538793103448276, 1.1916890080428955, 1.178857951864087, 1.0482701947571698, 1.3375870069605569, 1.0249306489826533, 1.0056666043962887, 1.25, 1.3923076923076922, 1.594207412021177, 1.1077247859181731, 1.4435146443514644, 1.5707220573689415, 1.4990958408679929, 1.3546747967479675, 1.1291028446389497, 1.0576967019574988, 1.5555555555555556, 1.0753968253968254, 1.0263952410845065, 1.028099823147966, 2.101503759398496, 1.0538852677200288, 1.1483044270344016, 1.057474643539615, 1.2323429128105212, 1.0160322597601543, 1.0291047355686138, 1.885672937771346, 1.5163934426229508, 1.0994180407371483, 1.0093432772055615, 1.0603448275862069, 3.5, 1.019600762993257, 1.0355373350287194, 1.2136913767019668, 1.0086580086580086, 1.75253807106599, 1.0472766217870257, 1.3829704510108864, 1.1882783882783883, 1.4444444444444444, 1.145429986492571, 1.6599947277246365, 1.0613333333333332, 5.375, 1.1320956279983279, 1.273989898989899, 1.5121951219512195, 1.2926829268292683, 1.1442885771543085, 1.0057537630413609, 2.1059268600252206, 1.9012875536480687, 1.0196108511671909, 1.2043334768259435, 1.1785714285714286, 1.3333333333333333, 1.2329545454545454, 1.1904761904761905, 2.0, 1.875, 1.0926193921852387, 8.2, 1.1164241164241164, 1.1578350973108105, 1.00400699350603, 1.2428571428571429, 1.5, 1.608695652173913, 1.85, 2.1875, 1.002224075618571, 1.165905789582901, 1.057384545038866, 1.3867924528301887, 1.0192846469929024, 1.0055299925023502, 5.0, 1.015090936512187, 1.0203145478374835, 1.6666666666666667, 9.666666666666666, 1.0064043915827996, 1.1110505270810613, 1.263421606981643, 1.2931726907630523, 1.0, 1.2043010752688172, 1.1012269938650308, 1.6, 1.122376335587719, 1.0129716078671462, 1.0310376352277921, 1.0358392663207434, 2.5, 1.003015850220331, 1.000598086124402, 1.5725806451612903, 1.569767441860465, 1.0381451009723262, 1.0, 1.170731707317073, 1.1534848769490889, 1.1938732981383717, 1.0856531049250535, 1.247104247104247, 1.1521529188451163, 1.0863945578231293, 2.1228070175438596, 1.4081632653061225, 1.089732300105671, 1.0712161970833922, 2.1333333333333333, 1.0529184068452684, 1.401360544217687, 1.0089605734767024, 1.0424746075715605, 6.5, 1.1976774193548387, 2.5413533834586466, 1.0081056185291872, 1.49185667752443, 3.0, 1.063168449197861, 1.0511950715483291, 1.1620986687548942, 1.3454593038471605, 1.062732892025777, 1.0209679546353685, 1.0162049137480398, 1.5524956970740103, 1.1428571428571428, 1.038256919122482, 1.0300320038811552, 2.228494623655914, 1.0422919508867667, 1.25, 1.2857142857142858, 1.109585016768333, 1.0471821756225426, 1.1998182905332473, 1.0117322165574167, 1.0558487247141601, 4.0, 1.0794451450189155, 1.2406485155288, 1.2013698630136986, 1.1273291925465838, 1.015146031631139, 1.2265625, 1.0347957639939485, 1.193734245588765, 1.0053509139879901, 1.0138905418501454, 1.248780487804878, 1.0565853658536586, 1.0, 1.3735477056683487, 1.3106440889721795, 1.0118411738207091, 1.034739454094293, 1.1640625, 1.683535417996171, 1.25, 1.1893939393939394, 2.5, 3.0, 1.5294117647058822, 1.3281922525107603, 1.6, 1.0363349131121642, 1.1304347826086956, 2.4545454545454546, 1.3847464364813449, 1.08, 2.0692307692307694, 1.2219541616405307, 1.1004290171606865, 1.6, 1.2857142857142858, 1.230659434770197, 2.125, 1.5898801597869507, 1.095139911634757, 1.0293162631041841, 1.0086415635114767, 1.1666666666666667, 1.018266253869969, 1.0165238268322079, 1.2826152455558903, 1.3316831683168318, 1.184775536759922, 1.2871707731520816, 2.0, 1.5478260869565217, 1.3787375415282392, 1.32, 1.1332007952286283, 1.10727969348659, 1.0459183927690552, 1.5104450499545867, 1.1111111111111112]
origin-bjaq_15.71 	max: 9.6667	99th: 5.0011	95th: 2.3563	median: 1.1616	mean: 1.3702

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 13/15 | Workload-time: 12.092211 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 14/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=valueskew', '--dataset=bjaq', '--drift_test=distribution', '--end2end', '--update_size=20000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
ValueSample - START
ValueSample - END
load_npy_dataset_from_path - df.shape = (522168, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (502168, 5), new data size: (20000, 5)
[0.0000000e+00 5.9604645e-08 4.1723251e-07 0.0000000e+00 3.6430359e-04]
Distance score: 7.295608520507812e-05
SAUCE Drift detection: True
Detection latency: 0.0444s

DRIFT-DETECTED after 14-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=bjaq', '--end2end', '--model=transformer', '--model_update=adapt', '--update_size=20000', '--epochs=40']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
update_size: 20000
AdaptTask - START
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
load_npy_dataset_from_path - df.shape = (522168, 5)
Parsing... done, took 0.0s
done, took 0.0s
dataset size: 522168
train data shape: torch.Size([20000, 5]), transfer data shape:torch.Size([4000, 5])
Epoch 0 Iter 0, train entropy gap 0.0579 bits (loss 18.249, data 18.191) 0.00300 lr
epoch 10 train loss 11.9219 nats / 17.1997 bits
time since start: 4.4 secs
Epoch 10 Iter 0, train entropy gap -1.0793 bits (loss 17.112, data 18.191) 0.00256 lr
epoch 20 train loss 11.6406 nats / 16.7938 bits
time since start: 8.7 secs
Epoch 20 Iter 0, train entropy gap -1.5070 bits (loss 16.684, data 18.191) 0.00150 lr
epoch 30 train loss 11.5234 nats / 16.6248 bits
time since start: 12.8 secs
Epoch 30 Iter 0, train entropy gap -1.6657 bits (loss 16.525, data 18.191) 0.00044 lr
epoch 40 train loss 11.4941 nats / 16.5825 bits
time since start: 17.0 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 19.3853 nats / 27.9671 bits
Saved to: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
AdaptTask - END

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 14/15 | Workload-time: 2.140429 | Model-update-time: 19.463366


WORKLOAD-START | Type: QueryWorkload | Progress: 15/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 522168, total size: 522168, split index: [435140 522168]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 13.6667	99th: 4.3340	95th: 2.3106	median: 1.1382	mean: 1.3515
ReportEsts: [1.351931330472103, 1.0711838599162542, 1.029500226411497, 1.2560386473429952, 1.0344827586206897, 1.0, 1.0210226397659017, 1.0209220868457658, 1.2, 1.0380779691749773, 1.0442365137937093, 1.0052365348519072, 1.0835637480798772, 1.1762295081967213, 1.0636515912897822, 3.5833333333333335, 1.4212218649517685, 4.0, 3.0, 1.3187613843351549, 1.2629283489096572, 1.1286619455833022, 1.0, 2.3372365339578454, 1.0379716794557392, 1.0082207290359102, 1.0, 1.0404988693209072, 2.0, 1.0, 1.347082053532251, 1.0, 1.0092060551805744, 1.0009622733593009, 1.733433734939759, 1.1650821931155435, 1.0952380952380953, 1.02803738317757, 1.5714285714285714, 1.5, 1.139177424196938, 1.68, 1.0873267326732674, 1.1590106007067138, 1.4666666666666666, 1.1959242045048266, 1.093847110006215, 2.4923076923076923, 1.5212765957446808, 1.2412280701754386, 1.0571589507734123, 1.1368421052631579, 1.1240148452463994, 1.1908713692946058, 1.0163309165915295, 2.0, 1.068421052631579, 1.1126203316365102, 1.0428265524625269, 1.0049627791563276, 1.0952380952380953, 1.0, 1.188073394495413, 1.2926509186351707, 1.0253789213958406, 1.0126400385924037, 1.7142857142857142, 1.5555555555555556, 1.0081272349896222, 1.0120196989510586, 2.066666666666667, 2.0, 1.056, 1.2090887545917763, 1.0113851992409868, 1.1235521235521235, 1.0495677895522817, 1.0064987814784727, 1.0241233683132838, 1.978494623655914, 1.007257306490043, 1.0194747713189731, 1.1346007604562738, 1.0340276940926556, 4.333333333333333, 1.0001331945889698, 1.4, 1.0006788316381827, 1.1559466019417475, 1.1612903225806452, 1.5, 1.7439759036144578, 1.02967294465887, 1.06157733741189, 1.1036712468626366, 1.0029384507583463, 1.4381136327056172, 2.767123287671233, 1.002805049088359, 1.2577949212471875, 1.0021097046413503, 1.8571428571428572, 1.111228440689898, 1.6285714285714286, 1.4195933456561922, 1.3447383276652576, 1.0109375, 1.0775757575757576, 1.0173359552887602, 1.0857142857142856, 1.0232419587734358, 1.289458357600466, 1.556840692696019, 1.0538749639873235, 1.0996703018006595, 1.5, 1.5495049504950495, 1.1717549734094939, 1.0183802219089253, 1.3088410991636799, 1.1727272727272726, 1.009246078905097, 1.0, 1.0510503727128981, 1.2943575798776343, 1.0, 1.4175824175824177, 1.2857142857142858, 1.6625, 1.0068874370871546, 1.045662361412733, 1.435897435897436, 1.2857142857142858, 1.128757707348672, 2.0, 1.2565400843881858, 1.274132859573113, 1.0857687776967522, 1.3333333333333333, 1.0379746835443038, 1.067269813714362, 1.1785714285714286, 3.8823529411764706, 1.5294117647058822, 1.0807839388145315, 1.0526075022872827, 1.200382685436476, 1.7234042553191489, 1.0708994708994708, 1.0028568367674893, 1.0, 1.0880056777856635, 1.5539650888604029, 1.5217391304347827, 1.0949682621843244, 1.4955947136563876, 1.084361180258596, 1.5921259842519686, 1.034537918999491, 1.0776107273466071, 1.0320102432778488, 1.0150915454317844, 1.0067610152982296, 1.1312032630863358, 1.0608389957236928, 1.0377358490566038, 1.010255114396117, 1.1395572666025024, 1.2753623188405796, 1.1791831357048748, 1.0458401687368175, 1.7142857142857142, 1.6129032258064515, 1.1859670134990143, 1.132747681795998, 1.0928270042194093, 1.0088931951485371, 1.323008849557522, 1.1110929185427754, 1.5387453874538746, 1.2429627606655873, 1.0398517145505097, 1.304953560371517, 1.0294117647058822, 1.2750444576170716, 1.0048301342705235, 1.0626955475330926, 1.055662373861202, 1.0458565345561743, 1.0688439606013478, 1.306896551724138, 1.3477935676888557, 1.4342105263157894, 1.0425169693634195, 1.0725424672793094, 1.0824138323285177, 1.1204819277108433, 1.0041854475209273, 1.0022499850835036, 1.6147679324894515, 5.0, 1.3222533995251458, 1.1666666666666667, 1.2512424269031521, 1.0400081535838708, 1.1450683945284377, 1.2629766611401607, 1.2562399355877616, 1.0029483479708718, 1.0263157894736843, 1.123015873015873, 1.0142594296228151, 1.0489082397616787, 1.0127702596763641, 1.4615384615384615, 1.2530017152658661, 1.0245078111388581, 1.20682302771855, 2.3793103448275863, 1.3113525665043086, 1.2181818181818183, 1.0037378934624697, 1.2646048109965635, 1.0116453925511453, 1.5887367956251486, 1.3582554517133956, 1.038012365468285, 1.038395559489079, 1.311457174638487, 1.8181818181818181, 1.1128526645768024, 1.005460229056609, 1.0826549780839074, 1.0063694267515924, 1.6993243243243243, 1.0056956807984465, 1.0389519277696437, 1.1379310344827587, 1.0016613742757063, 1.181775691438558, 1.2826086956521738, 5.6, 1.153250773993808, 1.1428571428571428, 1.645077720207254, 1.0, 1.4679153659382587, 1.1127775327157772, 1.184342032204331, 2.310344827586207, 1.9375, 1.3333333333333333, 1.2406938686449924, 1.0526315789473684, 1.051297197674968, 2.0, 1.0008631851532153, 1.1665062560153994, 4.0, 1.023003159470096, 1.3858131487889274, 1.4023668639053255, 1.0096656561662494, 1.386759581881533, 1.4297060939835058, 1.425, 2.0, 1.2247349467375155, 1.2160193286232017, 2.758454106280193, 1.21173818329196, 1.2027002260370212, 1.0310581437342001, 1.2453781512605042, 1.0708126801152738, 1.1391519143680526, 1.0274768504508867, 1.2727414817130354, 1.6042553191489362, 1.257253270793693, 1.0688216892596454, 1.7450980392156863, 1.44, 1.0056179775280898, 1.036342986939239, 1.0411669069603362, 1.5841121495327102, 1.014248729052909, 1.4201474201474202, 1.1694915254237288, 1.0091928850634717, 1.0116350275566441, 1.0774832788675397, 1.0095077298933297, 3.3333333333333335, 1.1061755146262189, 1.0075067024128685, 1.0983793994829987, 1.0239407774689528, 1.0131925790173977, 1.0082903776231273, 1.0132575757575757, 1.0438902743142144, 1.2138576593531771, 1.0550571759154908, 1.0242522710561894, 1.5285506653553929, 1.7142857142857142, 1.8333333333333333, 1.0094620167612869, 1.0446773303916161, 1.0386740331491713, 1.2067281681348407, 1.379591836734694, 1.3396353814989872, 1.0924735010737376, 1.0, 1.165871121718377, 1.0527240773286468, 1.2687747035573123, 1.0642892037127503, 1.1410967344423906, 1.1923076923076923, 2.3333333333333335, 13.666666666666666, 1.016769468003084, 1.8571428571428572, 1.0358644069581056, 1.083841463414634, 1.1666666666666667, 1.031089024592888, 1.1502890173410405, 1.2727272727272727, 1.0193858380301595, 1.2738652207591015, 1.391501416430595, 1.3220988127154347, 1.0732628398791542, 1.0136, 1.1818644931227713, 2.0372340425531914, 1.1318681318681318, 1.0032664164730645, 1.0165528097718657, 1.1586538461538463, 1.0079457003798813, 1.0482177263969172, 2.0, 1.0, 1.2665045874214929, 1.3333333333333333, 1.1283086585912965, 1.0, 1.6088082901554404, 3.888888888888889, 1.7202072538860103, 1.2718855218855218, 1.0902777777777777, 1.3511827397972447, 1.144736842105263, 4.0, 1.1271964023428291, 1.1253451131971286, 2.074074074074074, 1.2329143584477198, 1.1782608695652175, 1.0355472404115997, 1.0715532286212914, 1.0, 1.0, 1.0404774260508562, 1.6097560975609757, 1.0283185840707965, 1.021383422666428, 1.0363310159228527, 2.6384615384615384, 3.5, 1.0028259310810241, 1.5339173967459325, 1.0303030303030303, 2.21875, 1.335427135678392, 7.0, 1.1457564575645756, 1.054421768707483, 1.0317598391711127, 1.0415448002238104, 1.0224153705397987, 1.0274061501597445, 1.0359203862913673, 1.4510568635947807, 1.058343057176196, 1.3024916303735965, 1.1600274725274726, 3.0, 1.0093635825737233, 1.0352392728244888, 1.0198019801980198, 2.6923076923076925, 1.75, 1.2806539509536785, 2.0, 1.3111111111111111, 1.456021650879567, 1.048165137614679, 1.7642276422764227, 1.6012323702587978, 1.0488704472106962, 1.3227383863080684, 1.0938387285688322, 1.1183823529411765, 1.04659793814433, 1.0769230769230769, 1.292066700353714, 1.7635467980295567, 1.0, 1.0017323821663229, 6.090909090909091, 1.039575886719824, 1.090051753398417, 1.0820486290739784, 1.0247691961269985, 1.375, 1.2695495495495495, 2.0, 1.0738636363636365, 1.2727272727272727, 1.0324279514312187, 1.2959183673469388, 1.0155509744167583, 2.5303030303030303, 1.1111111111111112, 1.14, 1.1428571428571428, 1.0, 1.0658413532878281, 1.0083796677085046, 1.0040450292953749, 1.3333333333333333, 1.157834365680202, 1.011437908496732, 1.6229508196721312, 3.25, 1.08, 1.0918177364037236, 1.0439088414270374, 1.18562874251497, 1.014852752880922, 1.037760078023407, 1.019090909090909, 1.3287482806052269, 1.9896907216494846, 1.013236629536956, 1.0521042084168337, 1.0320981534266949, 1.5, 1.1303297256481248, 1.3083654182709135, 1.0081573253164315, 2.6436781609195403, 1.0312775330396475, 1.0, 1.0955882352941178, 1.9444444444444444, 1.0031785814519656, 1.8333333333333333, 1.0, 1.0216426584017186, 1.5, 1.0, 1.1385248970423063, 2.0, 1.061327359283114, 1.1989795918367347, 4.295774647887324, 1.8888888888888888, 1.5469681145174172, 1.041602465331279, 1.143186100062801, 3.0, 1.9918032786885247, 1.1958041958041958, 1.032544378698225, 1.5347928068803753, 1.0010776858706536, 1.9714285714285715, 1.0470588235294118, 1.0210526315789474, 1.1377070034756138, 1.0181772949664152, 1.3186231244483673, 1.6666666666666667, 1.0581110088929777, 1.0085836909871244, 1.0926605504587157, 1.4157894736842105, 1.1082537349987753, 1.2545996869554945, 1.1650915534554047, 1.1457960644007155, 1.0594921885318314, 1.0293215564905935, 1.094488188976378, 1.031273729504739, 1.5, 1.053095328522598, 1.047945205479452, 1.0408584399504746, 1.0328092959671906, 1.1842105263157894, 1.0479130057737511, 1.0559646539027983, 1.1114231265063617, 1.0826173165895572, 1.0, 7.0, 1.0091803263551773, 1.1783405172413792, 2.3157894736842106, 3.1666666666666665, 1.042016376335619, 1.069364161849711, 1.0335548241528494, 1.0000123447137879, 1.5, 1.2911764705882354, 1.3780068728522337, 3.2857142857142856, 1.0203742241528158, 1.014009554218955, 1.0178112305239884, 1.0376280066682544, 1.0108874722441086, 1.056644880174292, 1.0044124792774252, 1.1085790884718498, 1.2225153913808267, 1.0517466628798637, 1.1083832335329342, 1.0237394957983192, 1.1748056607534383, 1.4077834179357023, 1.0, 1.271114864864865, 1.1894934333958724, 1.0686900958466454, 1.088302752293578, 1.0203803756920864, 1.2417582417582418, 1.1121236287248113, 1.0, 1.1042168674698796, 1.4078212290502794, 1.0118514665725484, 1.6720647773279351, 1.2067833698030634, 1.021551724137931, 1.5060388546461732, 1.0453723520419305, 1.0, 1.2884707894596183, 1.4761904761904763, 1.5, 1.568255003464721, 1.0333333333333334, 1.8100558659217878, 1.1043478260869566, 1.3703190013869626, 1.03812472357364, 1.0975609756097562, 1.011764705882353, 1.5332208226798298, 1.1332847778587036, 1.0514402368987796, 1.2671232876712328, 1.2872073578595318, 1.1153368859040806, 1.0045869705787263, 1.0707125440260092, 1.0325097529258778, 1.0447609359104781, 1.1572327044025157, 1.0693393041191315, 1.373134328358209, 1.0253285824733605, 2.3658536585365852, 1.6451918522027476, 1.1540574282147316, 1.4802065404475042, 1.0, 1.5, 1.0600636435958632, 1.0066091363605232, 1.0796330675985584, 1.2128240109140518, 1.0327596618357489, 2.45, 1.054474216380182, 1.099050485965446, 1.1091954022988506, 1.0862068965517242, 1.0138267609814269, 1.1120040180813662, 1.099175272021623, 1.282258064516129, 1.349188584219362, 1.066949560568279, 1.0058830681743782, 1.0909090909090908, 1.038780676065291, 1.1538461538461537, 1.2777777777777777, 1.118421052631579, 1.1696540583271753, 1.0220338983050847, 1.3940520446096654, 1.2647058823529411, 1.1747329128587978, 2.0, 1.0382571732199788, 1.80614406779661, 1.065449968533669, 1.0291497975708501, 1.25, 1.1544500029660096, 1.411764705882353, 1.1703204047217537, 1.168952967525196, 1.2877263581488934, 1.0336264873254009, 1.3095659875996457, 1.2311557788944723, 1.16841474378184, 1.7470588235294118, 1.0602549246813442, 1.1212955465587044, 1.0906774880352301, 1.0285757046645048, 1.0, 1.032806068920991, 1.1509090909090909, 2.0, 1.217508589601613, 1.00019012732193, 1.2435294117647058, 1.020058068712408, 1.1826885473848872, 1.1908396946564885, 1.1666666666666667, 1.261609287429944, 1.3304721030042919, 1.0028053437472966, 1.0479627473806752, 1.134049980140983, 1.0239052585286172, 1.3369734789391576, 1.0084948234669497, 1.099264705882353, 1.051001514896482, 1.2002718622564568, 1.4404213298222515, 1.0223759153783565, 2.8333333333333335, 1.4987247400431627, 1.4677975848188614, 1.2777777777777777, 1.6, 1.3795013850415512, 1.1733436055469955, 1.0367965367965368, 1.2969016002723868, 3.1666666666666665, 1.268754076973255, 1.0381868984787332, 1.794871794871795, 1.274836556725048, 4.333333333333333, 1.1374171112599087, 1.4633663366336633, 1.4027005559968229, 1.252156602521566, 1.0325501185600345, 1.0561046809382362, 1.1162790697674418, 1.6395348837209303, 1.0410846343467544, 1.0, 1.3281917827106025, 1.0209287115761936, 1.0, 1.3333333333333333, 1.3082706766917294, 1.1507936507936507, 1.0745349832671802, 1.3779527559055118, 1.180952380952381, 1.141340411413404, 1.4394618834080717, 1.1704035874439462, 1.0261739799846035, 1.0417910447761194, 1.1591836734693877, 2.0, 1.0, 1.4019746121297603, 1.0010460251046025, 1.1209398756046993, 1.251870493810366, 1.0031912380543326, 1.0551823540009782, 1.0121909275041083, 1.3630943582163095, 1.342701722574796, 1.5238735890433075, 1.0740740740740742, 2.0, 1.5321345423354982, 1.2653402216289924, 1.2401231400718318, 1.0906666666666667, 1.07168458781362, 1.1311466249441215, 1.2541525452166036, 1.0014653841956755, 1.4102564102564104, 4.4, 1.2391304347826086, 1.31646453189076, 1.3524774774774775, 1.039470038848221, 1.45, 1.1618612425923671, 1.0471977143720186, 1.0327171114255145, 1.0064516129032257, 1.0629100733307604, 2.25, 1.1638284452853989, 1.1900975786049874, 1.0002218009723136, 1.7715877437325904, 1.5239621436451256, 1.0093967230048433, 1.0195344506517692, 1.0632035039796544, 2.111111111111111, 1.4252873563218391, 1.2181208053691275, 1.0010504478109457, 1.2353732585105064, 1.0015628467855293, 1.1152173322624825, 1.0054288552619188, 1.0185141785797984, 1.5677573248120977, 1.0006058710862682, 1.042857142857143, 1.2857142857142858, 1.0, 1.4166666666666667, 1.014502949293793, 1.3333333333333333, 1.00739126314792, 1.0212791882296, 1.128755364806867, 1.5663716814159292, 1.237347294938918, 1.0064262533008124, 1.001427135678392, 1.3318485523385302, 1.271523178807947, 1.3786008230452675, 1.8848653667595172, 1.1862479844770573, 1.7777777777777777, 1.0831313074364324, 1.0769230769230769, 1.0931174089068827, 1.0906305846310953, 1.0407320781195182, 1.2716763005780347, 2.0, 1.0056362014435163, 1.340654415060511, 1.0051251764281925, 1.96, 1.5532676452845364, 1.2483660130718954, 1.0192080710431655, 1.0526315789473684, 1.6126126126126126, 1.4890190336749634, 1.0814133503323924, 1.150128111273792, 1.0268096140977023, 5.0, 1.003440283135302, 1.1515151515151516, 1.1921214788732395, 1.2621744054360136, 1.4774774774774775, 1.2755129958960327, 1.3052039381153304, 1.1029776674937966, 1.1250478011472276, 1.0694965708722912, 1.059239610963749, 1.0123210726580902, 1.0201277076777366, 1.0833333333333333, 1.2482758620689656, 1.098026598026598, 1.0877750865149018, 1.0685483870967742, 1.0523525513585155, 1.263719512195122, 1.003625815808557, 1.323611111111111, 1.0312172502114194, 1.55, 1.1786777843954734, 1.0248009436744323, 1.2935560859188544, 1.8751472320376914, 1.01261315228967, 1.152430190175535, 1.0413417684272472, 1.0230188679245282, 1.0038503650958241, 1.0224196948745268, 1.053146853146853, 1.2937062937062938, 1.2253638253638253, 1.0222551928783383, 1.4672131147540983, 1.75, 1.0083856651168408, 1.0340611077759172, 1.044054441260745, 1.1462264150943395, 1.4841483073616335, 1.0179029689512815, 1.3297196261682243, 1.0033898305084745, 1.1818181818181819, 1.0494247976139752, 1.5619246050973932, 1.0485436893203883, 1.5357142857142858, 1.1651917220806662, 1.2644110275689222, 1.2127659574468086, 1.0789473684210527, 1.2857142857142858, 1.0044257665019944, 2.507469879518072, 1.276657060518732, 1.019055065249783, 1.1319584849710203, 2.392857142857143, 1.3333333333333333, 1.0657193605683837, 1.1842105263157894, 2.0, 2.142857142857143, 1.80622009569378, 7.5, 1.0351966873706004, 1.245028703505973, 1.0025100401606426, 1.3043478260869565, 2.0, 1.2666666666666666, 1.0724637681159421, 1.0144927536231885, 1.0362880886426593, 1.0738848225383235, 1.0486295059311297, 1.2956521739130435, 1.0148161271544633, 1.0122680525564542, 2.5, 1.0057917400375855, 1.060200668896321, 2.2857142857142856, 1.363197424892704, 1.0013520732577874, 1.1793446920052424, 1.2581776226081485, 1.148723897911833, 2.0, 1.1063218390804597, 1.0994100495015935, 1.7295321637426901, 1.0178518066960711, 1.0776173285198556, 1.0058375134907651, 1.170982091935668, 1.0055965972688605, 2.5, 1.0046057820578984, 1.0421965317919075, 1.6142384105960266, 1.0866141732283465, 1.015927977839335, 1.0, 1.1266666666666667, 1.163319439181508, 1.2842731891999601, 1.212058212058212, 1.1399317406143346, 1.3375156838143036, 1.5725432192580129, 1.4922411278561012, 2.0, 1.0119154055511, 1.05, 1.0587477624717876, 1.2499030470914128, 1.3148148148148149, 1.3972602739726028, 1.5205912634210914, 1.375, 1.3201689021361152, 1.2810650887573964, 1.0052823421632264, 1.4379905808477238, 3.0, 1.2478873239436619, 1.005185052744502, 1.0671280276816608, 1.019645983271737, 1.0197304491106511, 1.0595919382931078, 1.1191222570532915, 1.2446280991735537, 1.4583333333333333, 1.0040872718899314, 1.0287953047935394, 1.78099173553719, 1.0118421052631579, 1.6666666666666667, 1.035294117647059, 1.0863680841648644, 1.067754077791719, 1.1340944933392443, 1.009787985248108, 1.2207523770152955, 2.0, 1.2551319648093842, 1.2114762859051436, 1.2234749345681497, 1.1818181818181819, 1.0384405190441133, 1.1544117647058822, 1.1495327102803738, 1.0144181256436664, 1.0081577194476954, 1.0242930569739992, 1.2116279069767442, 1.060878243512974, 1.150943396226415, 1.2170115420609338, 1.2017581257486245, 1.0611256787727377, 1.0798348544111256, 1.0026030368763557, 1.521153740900881, 1.6, 2.0933333333333333, 2.5, 4.0, 1.7058823529411764, 1.091627965357098, 4.25, 1.1144366197183098, 1.0681818181818181, 2.230769230769231, 1.2550957381099443, 1.4285714285714286, 5.38, 1.1823266219239374, 1.0312312111697508, 2.0, 1.1875, 1.0482300884955753, 2.0, 1.0266311584553929, 1.0190557451649602, 1.1829619362405375, 1.0053877133997837, 1.75, 1.2088323353293413, 1.0443986520656197, 1.1480160499331253, 1.8646153846153846, 1.1379492600422834, 1.6477850399419027, 1.3333333333333333, 1.9191176470588236]
origin-bjaq_15.71 	max: 13.6667	99th: 4.3340	95th: 2.3106	median: 1.1382	mean: 1.3515

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 15/15 | Workload-time: 12.157414 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=7, #drift=7 | total-time=250.797844