Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='naru', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 28, 'naru': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.6000	median: 1.0574	mean: 1.1480
ReportEsts: [1.171003717472119, 1.0563961485557083, 1.059299501176182, 1.0134615384615384, 1.1111111111111112, 1.0, 1.2176960140166448, 1.000706514691481, 1.25, 1.0277044854881265, 1.0312238478631, 1.0019970369343534, 1.0329718004338395, 1.0488372093023255, 1.066407629812787, 1.0, 1.3846153846153846, 1.042862203329791, 3.0, 2.6666666666666665, 1.125, 1.1107181367263317, 1.0314055259996568, 1.0518838789376157, 1.0685292567211386, 1.0, 1.0380464724373724, 1.2, 1.6, 1.1942446043165467, 1.0, 1.009207938113098, 1.0088393779833669, 1.3174250832408434, 1.001909237773535, 1.0319883555615734, 1.0053475935828877, 1.0006122776241684, 1.1485295130518631, 1.2261904761904763, 1.0064516129032257, 1.0640243902439024, 1.0, 1.1180280900625954, 1.0455036248650316, 1.1900826446280992, 1.1067961165048543, 1.2145922746781115, 1.0255907728104816, 1.0285714285714285, 1.0853990508539906, 1.2707423580786026, 1.0026542731732506, 2.0, 1.12987012987013, 1.0211906848629022, 1.0088041085840058, 1.0606060606060606, 1.2298136645962734, 1.25, 1.0355325336241368, 1.029887920298879, 1.0545454545454545, 1.160919540229885, 1.0, 1.0235713544010245, 1.005923000987167, 1.1666666666666667, 1.0, 1.061028684470821, 1.0334128878281623, 1.062754212667054, 1.117117117117117, 1.0749495134936662, 1.2094117647058824, 1.108829568788501, 1.0, 1.0472234368167905, 2.0, 1.048624063818187, 1.5, 1.0497009399031616, 1.098159509202454, 1.0378440366972477, 1.0435227854582694, 1.04, 1.0040651875406519, 1.0601236418598312, 1.2058823529411764, 2.3333333333333335, 1.1076011846001974, 1.0461734828922835, 1.0222929936305734, 1.3099579242636745, 1.2837045720984759, 1.1, 1.25, 1.008605851979346, 1.0, 1.0182627657641286, 1.1386609071274298, 1.0255057167985928, 1.0001411482409401, 1.0, 1.0055273965930622, 1.087785157377996, 1.1048310963346057, 1.0766021994690937, 1.0326052548274771, 1.1666666666666667, 1.3333333333333333, 1.1349774595597986, 1.001619975265993, 1.053226879574185, 1.077922077922078, 1.0039962234797428, 1.0, 1.2098435711560473, 1.139712918660287, 1.0, 1.2637362637362637, 1.1666666666666667, 1.005012531328321, 1.0144106796082162, 1.1016541119826047, 1.0467289719626167, 1.8, 1.2855960264900663, 1.0, 1.2142857142857142, 1.0045291429389331, 1.1818181818181819, 1.0128580729166667, 1.0033776332621258, 1.053987122337791, 1.1795275590551182, 1.0138888888888888, 1.0696123384743643, 1.00199203187251, 1.0478927203065134, 1.0546031229668185, 1.1358024691358024, 1.0404435746901501, 1.0518291902409052, 2.0, 1.0115260488704472, 1.0367298578199051, 1.0558312655086848, 1.003882124580907, 1.0, 1.0130782271736498, 1.0429629629629629, 1.01, 1.4476190476190476, 1.0481751824817518, 1.0289952798381659, 1.0465419265419265, 1.1056001442871315, 1.129277566539924, 1.167763157894737, 1.0208333333333333, 1.2318840579710144, 1.1335559265442403, 1.1428571428571428, 1.0000940262019682, 1.0120016164820167, 1.0166954519286127, 1.05443457310646, 1.030543677458766, 1.105616071665209, 1.016842105263158, 1.0735294117647058, 1.1709112036409413, 1.0856201975850714, 1.1730769230769231, 1.090042372881356, 1.0413118889940083, 1.037835229785694, 1.0805689620012235, 1.1666666666666667, 1.3125, 1.0359649122807018, 1.0471816283924844, 1.1263411024787273, 1.2258064516129032, 1.0219399929882496, 1.045742840668845, 1.029089020193494, 1.0740740740740742, 1.008711600183402, 1.0072816925634998, 1.0, 1.8181818181818181, 1.0295816195105738, 1.325766174801362, 1.1267532467532468, 1.3461538461538463, 1.0244372990353698, 1.0035608400088378, 1.0055714575491896, 1.1798245614035088, 1.0521766628017286, 1.10625, 1.015625, 1.0357142857142858, 1.0, 1.0526315789473684, 1.0276314723280122, 1.6933797909407666, 1.2413793103448276, 1.0153237765694514, 1.0957683741648108, 1.0785107169253512, 1.0120963267117966, 1.0702084821718516, 1.1972789115646258, 1.089763779527559, 1.0659758203799654, 1.0400511229823655, 1.0060306954325842, 1.0, 1.1097308488612836, 1.043408898430268, 1.009529087244707, 1.0739255014326647, 1.0092249960911033, 1.0067670444933174, 1.0344827586206897, 1.0028529195621985, 1.0059662775616083, 1.1517202481669486, 1.0572916666666667, 1.0446370530877573, 1.0058365758754864, 1.1039370078740158, 1.0, 1.0173076923076922, 1.117965609647164, 1.030239099859353, 1.4291044776119404, 1.0909090909090908, 2.6666666666666665, 1.1521429450765903, 1.1272727272727272, 1.0809292649098474, 1.5, 1.5, 1.2903225806451613, 1.0285026093938177, 1.5816326530612246, 1.143646408839779, 1.1218934911242604, 1.0815972222222223, 1.0071881606765327, 1.042004606956892, 1.087719298245614, 1.0, 1.002143048486472, 1.1026485522162757, 1.084063047285464, 1.014656598650999, 1.0494488748920607, 1.0211525900617997, 1.0866454689984102, 1.024945865535271, 1.0705741626794258, 1.093465045592705, 1.220839580209895, 1.6363636363636365, 1.076530367095906, 1.0106609808102345, 1.25, 1.25, 1.132, 1.0555555555555556, 1.0833333333333333, 1.0100935334095955, 1.158774373259053, 1.2391304347826086, 1.0050729640855207, 1.065236818588025, 1.0050924373653443, 1.0066323904727037, 1.5, 1.0364314296107675, 1.2, 1.000254122925393, 1.043196544276458, 1.0124937417504893, 1.3, 1.25, 1.0869565217391304, 1.4929577464788732, 1.0079374314814702, 1.0, 1.114678899082569, 1.0207852193995381, 1.0384615384615385, 1.001180472770622, 1.1524390243902438, 1.0314465408805031, 1.0099186120095627, 1.0775193798449612, 1.0581415030467163, 1.1196581196581197, 1.0, 1.2863961813842482, 1.020100502512563, 1.1495327102803738, 1.057329401853412, 1.006255212677231, 1.0901408450704226, 1.0172413793103448, 1.0123456790123457, 1.1267441860465117, 1.5714285714285714, 1.0201616678630505, 1.0695970695970696, 1.105263157894737, 1.0157318361220746, 1.1428571428571428, 1.75, 1.0499281099119568, 2.0, 1.0013717421124828, 1.0857558139534884, 1.0287120590648071, 1.032409215150332, 1.1357702349869452, 1.1868131868131868, 1.0182361774374653, 1.0059638275601859, 1.0251396648044693, 1.0012463613627978, 1.0889393939393939, 2.0, 1.1111111111111112, 1.0128811990046873, 1.3333333333333333, 1.0498357064622126, 1.0, 1.0, 1.0454545454545454, 1.1759149940968123, 1.0822179732313575, 1.1944444444444444, 1.0573593073593073, 1.0, 1.033288948069241, 1.008777332922698, 1.5, 1.265634306134604, 1.0, 1.0103241478782359, 1.0348837209302326, 1.054027814221989, 1.1705069124423964, 1.0018181818181817, 1.1353965183752417, 1.0833333333333333, 1.0100237991088308, 1.0060306999919633, 1.003994673768309, 1.0, 1.1428571428571428, 1.8333333333333333, 1.5, 1.3333333333333333, 1.0021533161068046, 1.25, 1.1797004991680533, 1.041237113402062, 1.1001003512293026, 1.0028337998203807, 1.0135699373695197, 1.1127379209370425, 1.0366806975345761, 1.2444444444444445, 1.5, 1.0169491525423728, 1.0730593607305936, 1.0020938088640503, 1.380952380952381, 3.142857142857143, 1.1158129175946547, 1.0343023255813955, 1.0021972855858066, 1.1333333333333333, 1.342769701606733, 1.033946251768034, 1.3333333333333333, 1.0808477237048666, 1.0190677966101696, 1.3076923076923077, 1.055306427503737, 1.0695652173913044, 1.0285971937761746, 1.0071091983765967, 1.0503957159259227, 1.3650793650793651, 1.018018018018018, 1.0591715976331362, 1.0, 1.0259807122406952, 1.002161852020717, 1.0192334206535227, 1.0118982486307093, 1.0433161216293747, 1.0224171539961013, 1.8333333333333333, 1.0207428847081523, 1.2, 1.0811272416737832, 1.1111111111111112, 1.0292619371145146, 1.0144927536231885, 1.0021496130696474, 1.158102766798419, 1.062233589087809, 3.0, 1.0115555555555555, 1.0032662196464477, 1.0035068290882245, 1.0, 1.2352941176470589, 1.0106692531522794, 1.3132183908045978, 1.077331189710611, 1.0736607142857142, 1.1666666666666667, 1.1069887834339949, 1.1023441699581649, 1.066608189317308, 1.0085631055999014, 1.0782894736842106, 1.2819237147595357, 1.0340909090909092, 1.1538461538461537, 1.0051020408163265, 1.3448275862068966, 1.0422919508867667, 1.1379310344827587, 1.0066689393616568, 1.1363636363636365, 1.1057993249463025, 1.0273481638418078, 1.1653486700215672, 1.0, 1.1067961165048543, 1.2, 1.0005058562589983, 1.4814004376367615, 1.0, 1.1389886709035646, 1.0232211538461538, 1.2528556593977154, 1.0, 2.0, 1.177864077669903, 1.0090415913200723, 1.4055299539170507, 1.0, 1.027491918992018, 1.0653923541247485, 1.0869565217391304, 1.1077589453860641, 1.0272727272727273, 1.010498687664042, 1.153225806451613, 1.0025305778152678, 1.1059066643705873, 1.0, 1.0675675675675675, 1.0873847032167134, 1.0022577203210292, 1.0643964877779504, 1.0, 1.058038848584133, 1.0186425769165164, 1.0282870612886328, 2.0, 1.1136363636363635, 1.0510569182241891, 1.1725697321181994, 1.2040539950198768, 1.03116649030615, 1.1968356583872066, 1.011764705882353, 1.0456264179480717, 2.0, 1.0887901183523696, 1.088235294117647, 1.0, 1.269736842105263, 1.1304347826086956, 1.0514037324779921, 1.1166982922201139, 1.0589770055622456, 1.3359901900674434, 1.0723999903547057, 1.007845259028811, 1.003427072136112, 1.116504854368932, 4.0, 1.0552010562957628, 1.0068825910931174, 1.0068422463094635, 1.01166303795283, 1.0823723228995057, 1.1394160583941606, 1.077319587628866, 1.4285714285714286, 1.0109154452935603, 1.0201523073425778, 1.0204983179919411, 1.1205439176773244, 1.026295609152752, 1.0309278350515463, 1.0051533814185463, 1.006514657980456, 1.0738714090287278, 2.0, 1.0, 1.0138036809815951, 1.0386029411764706, 1.011744966442953, 1.0083932853717026, 1.0098039215686274, 1.251572327044025, 1.0554699537750385, 1.1263736263736264, 1.0293050485264001, 1.4303797468354431, 1.0249757479635988, 1.0, 1.1466227347611202, 1.4166666666666667, 1.0567375886524824, 1.014804469273743, 1.1687979539641944, 1.0849802371541502, 1.2415458937198067, 1.0327697568389058, 1.0, 1.6382978723404256, 1.5, 1.0, 1.035294117647059, 1.0530785562632696, 1.3584905660377358, 1.138121546961326, 1.031079782121115, 1.227920227920228, 1.0433524031379535, 1.009712088345494, 1.103448275862069, 1.001271647122777, 1.1280487804878048, 1.0854206807964033, 1.1209482341557813, 1.1096455070074196, 1.0390173410404624, 1.0243161094224924, 1.008057568540009, 1.0424316856002456, 1.0079431586153174, 2.0, 1.0824468085106382, 1.0055452865064696, 1.0704225352112675, 1.0, 1.0408163265306123, 1.25, 1.0541044776119404, 1.5185185185185186, 1.5, 1.022671664538452, 1.0325928558734672, 1.003867146072066, 1.0452859960552268, 1.0108108108108107, 1.0522478736330498, 2.0, 1.2727272727272727, 1.1018314461585226, 1.0152775717695284, 1.0065302568567698, 1.077400615104226, 1.017414625424638, 1.152694610778443, 1.029403308351383, 1.1722912966252221, 1.021929422548121, 1.056618159227395, 1.393939393939394, 1.1254199328107504, 1.0, 1.0113378684807257, 1.0204772234273318, 3.0, 1.072375127420999, 1.0164082062996969, 1.2857142857142858, 1.1954696180181732, 1.2, 1.1875, 1.0133922804197109, 1.7692307692307692, 1.0216030359063606, 1.0128150363092696, 1.2258064516129032, 1.2608695652173914, 1.3002680965147453, 1.0043227665706052, 1.149746192893401, 1.0252007411982704, 1.0121930047142724, 1.0, 1.1551705409515534, 1.0121951219512195, 2.0, 1.0790183822681458, 1.0097586296392422, 1.0955534531693472, 1.0147779113196087, 1.0182185477535446, 1.3452380952380953, 1.7142857142857142, 1.00912894636744, 1.0499576629974599, 1.0132184005565643, 1.0256837891927952, 1.0418133929652065, 1.087857294413628, 1.1593406593406594, 1.0052356020942408, 1.1455938697318007, 1.0112657720809133, 1.0769716088328076, 1.0504281636536632, 1.1328781512605042, 1.0565047028813366, 4.0, 1.000458787751678, 1.0326338704386637, 1.0158921595833244, 1.0555555555555556, 1.0736543909348442, 1.272300469483568, 1.0, 1.009793796075359, 1.0134426229508198, 1.0865954922894425, 1.1470588235294117, 1.6666666666666667, 1.0219256900657072, 1.5, 1.3459119496855345, 1.0769230769230769, 1.090014653548252, 1.2857142857142858, 1.2473684210526317, 1.0974842767295598, 1.0, 1.2896825396825398, 1.0268636668905307, 2.0, 1.0, 1.0901639344262295, 1.0469314079422383, 1.0787752675386444, 1.0010504201680672, 1.056105610561056, 1.0029585798816567, 1.089150378938971, 1.0467532467532468, 1.6225165562913908, 1.6896551724137931, 1.2307692307692308, 1.0, 1.098342541436464, 1.2395382395382395, 1.083986562150056, 1.2628548999084128, 1.0291293040799043, 1.1888490092924922, 1.044496487119438, 1.057169061449098, 1.0962695547533092, 1.0125298329355608, 1.375, 1.0, 1.0303030303030303, 1.0017985884495713, 1.1318681318681318, 1.0065359477124183, 1.2807570977917981, 1.0721649484536082, 1.0581373950709907, 1.0096835456674906, 1.064102564102564, 1.1578947368421053, 1.0695780903034788, 1.1988997879109227, 1.0223359629351365, 1.0212003859421879, 1.1578947368421053, 1.0947282929710573, 1.0058459907486148, 1.1318840579710145, 1.0457933972310969, 1.4444444444444444, 1.0273654916512058, 1.079954954954955, 1.0384615384615385, 1.0955223880597016, 1.0347890451517394, 1.0, 1.0922693266832917, 1.0573710220763008, 1.2222222222222223, 1.0201812659379212, 1.1716101694915255, 1.0, 1.0020111704769867, 1.0177361211247296, 1.1435334407735698, 1.022439024390244, 1.0114810562571757, 1.014765554553652, 1.1991434689507494, 1.0714285714285714, 1.0, 1.1111111111111112, 1.004456824512535, 1.8333333333333333, 1.0585008318719367, 1.0687631253028915, 1.096588391670359, 1.0786203941730934, 1.0017164207411904, 1.0241157556270097, 1.0856031128404668, 1.0083217753120666, 1.0000610552221, 1.0596736944051255, 1.0016777317067325, 1.0265566662652053, 1.25, 1.032258064516129, 1.2608695652173914, 1.0034609297553, 1.1009771986970684, 1.0128610584018554, 1.1946902654867257, 1.01364522417154, 1.0199527630628014, 1.0205479452054795, 1.0270215311004784, 1.3125, 1.0447838467512296, 1.0013924575217572, 1.1558086560364464, 1.0008428150021071, 1.0625, 1.1188436830835118, 1.144278606965174, 1.625, 1.0205929956265711, 1.3076923076923077, 1.0091556459816886, 1.0065934065934066, 1.179366149696561, 1.034488765023515, 1.0741176470588236, 1.0, 1.0566037735849056, 1.0168020883120703, 1.0009286909905852, 1.020931060346033, 1.0623082124096324, 1.0586116738524405, 1.0833333333333333, 1.0419407894736843, 1.0760983813327727, 1.0725702040269656, 1.0183673469387755, 1.2083333333333333, 1.0164986251145738, 1.0151111874302396, 1.1590909090909092, 1.001712777670972, 1.0, 1.3333333333333333, 1.0059729535958861, 1.00679983000425, 1.0146531566640686, 1.1133924886504334, 1.0766161213088588, 1.066350710900474, 1.0076588697992135, 1.0942698706099816, 1.020637898686679, 1.3513513513513513, 1.0049019607843137, 1.0019056517943863, 1.0238095238095237, 1.75, 1.0367889033004962, 1.0102386214227768, 1.031356898517674, 1.3333333333333333, 1.0148443157132512, 1.0036498897356447, 1.019782110091743, 1.0178117048346056, 1.2307692307692308, 1.0721024258760108, 1.037117903930131, 1.090625, 1.5357142857142858, 1.0826908034417253, 1.0188305252725471, 1.0845323741007193, 1.2424242424242424, 1.0190122713745946, 1.0481175760016106, 1.020108565771056, 1.0838252656434475, 1.6666666666666667, 1.037037037037037, 2.0, 1.0368364030335862, 1.3846153846153846, 1.3333333333333333, 1.3636363636363635, 1.1871069182389937, 1.005464480874317, 1.0481242895035998, 1.0174838772401724, 1.198257080610022, 1.9558823529411764, 1.0, 1.0333333333333334, 1.3783783783783783, 1.2280701754385965, 1.0358255451713396, 1.0099552217637087, 1.005957135498705, 1.0625, 1.0063108199248483, 1.0016165357089235, 5.0, 1.0079275968833996, 1.0657142857142856, 1.0, 1.3333333333333333, 1.0514792899408285, 1.115613569533099, 1.0282134648135577, 1.046583850931677, 1.0, 1.1217391304347826, 1.168458781362007, 2.0, 1.5, 1.0066437007874016, 1.0372281093139988, 1.1975160855903038, 1.25, 1.01152979842097, 1.069713400464756, 1.1206896551724137, 1.1428571428571428, 1.13903743315508, 1.0041277033431708, 1.131578947368421, 1.0436851946285908, 1.082191205792843, 1.0611764705882354, 1.0118577075098814, 1.0135399449035813, 1.1648163962425278, 1.103305785123967, 1.2105263157894737, 1.0762093926553673, 1.034805720794836, 1.057877065257139, 1.2651515151515151, 1.186046511627907, 1.164179104477612, 1.072192513368984, 1.0446566060979365, 1.017240504015677, 1.0330867982372103, 1.0895196506550218, 3.0, 1.25, 1.0885873347251218, 1.1688654353562005, 1.2874927056992802, 1.022000075256814, 1.0108713831744438, 1.100326332524475, 1.1514360313315928, 1.1041666666666667, 1.0523543746560804, 1.002420010915794, 1.024160282852092, 1.1243432574430823, 2.5, 1.0266666666666666, 1.0019443119703584, 1.082915173237754, 1.0076749083534826, 1.024540263831463, 1.1278409090909092, 1.6, 1.0023419203747073, 1.017858746408046, 1.0328992460589446, 1.0722433460076046, 1.014137224049969, 1.193916349809886, 1.3206997084548104, 1.0643478260869565, 1.0029627472747458, 1.049984531754099, 1.1140552995391706, 1.1293213828425097, 1.03125, 1.053315105946685, 1.0060006897344522, 1.0726552179656539, 1.0601628244213797, 1.0262707024557396, 1.0517104216388227, 1.2857142857142858, 1.059447983014862, 2.5, 1.5, 1.4166666666666667, 1.030690537084399, 1.1540284360189574, 1.0419250622006015, 1.0593875026619484, 1.0316349384098544, 1.0610432852386238, 1.141304347826087, 1.7346938775510203, 1.0025034985689272, 1.6, 1.25, 1.1252032520325204, 1.0, 1.1293233082706766, 1.1146496815286624, 1.0184505232237928, 1.0370550713346642, 1.0, 1.105029079712624, 1.2829457364341086, 1.1698254364089775, 1.0008126087495466, 1.1330472103004292, 1.0465949820788532, 1.0192322959669737, 1.0212087912087913, 1.0604133545310015, 1.7317073170731707, 1.229050279329609, 1.0, 1.0, 1.0006482243124353, 1.6666666666666667, 1.5714285714285714, 1.3170731707317074, 1.0184275184275184, 1.1604938271604939, 1.0349971313826736, 1.1034632034632035, 1.0, 1.2613283674736189, 1.019047619047619, 1.2062780269058295, 1.0585241730279897, 1.1111111111111112, 1.060897435897436, 1.0543237250554325, 1.0980810234541578, 1.039791744142804, 1.0055143434343434, 1.098759354076408, 1.0285975053240037, 1.0, 1.0334018274821843, 1.0037897954880877, 1.0254662840746054, 1.2695652173913043, 1.0632899226296315]
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.6000	median: 1.0574	mean: 1.1480

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 16.367066 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=naru', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[1.1920929e-07 2.9802322e-07 0.0000000e+00 0.0000000e+00 5.9604645e-08]
Distance score: 9.536743306171047e-08
SAUCE Drift detection: False
Detection latency: 0.0231s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 2.134301 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 7.0000	99th: 3.0000	95th: 1.6373	median: 1.0644	mean: 1.1669
ReportEsts: [1.1023391812865497, 1.0424623680071894, 1.041638418079096, 1.0175438596491229, 1.088235294117647, 2.0, 1.179655207178143, 1.0063671816409179, 1.2, 1.0465116279069768, 1.0357048590281943, 1.0015093958083572, 1.0190812720848057, 1.0454545454545454, 1.0170337738619677, 1.0952380952380953, 1.0610932475884245, 1.3157894736842106, 1.4444444444444444, 1.1170915958451368, 1.1338404605263157, 1.148465703971119, 1.1146814404432133, 1.073148974130241, 1.0152488950714023, 1.0105744587457344, 2.0, 1.0712971224626366, 1.0, 1.1428571428571428, 1.0733788395904438, 1.0, 1.0038917775623513, 1.0126723443965318, 1.451213925790197, 1.055029201817002, 1.0259188382957167, 1.011467889908257, 1.2941176470588236, 1.0082710841953955, 1.049762803756414, 1.0378159449418356, 1.1033254156769596, 1.042608980662078, 1.0469314079422383, 1.1362292718096612, 1.173913043478261, 1.0309072781655035, 1.3191489361702127, 1.0886981402002862, 1.25, 1.0472727272727274, 1.0986547085201794, 1.0606060606060606, 1.0497578735707402, 1.0080248935473306, 1.0654885654885655, 1.0871559633027523, 1.1927710843373494, 1.0003300975090668, 1.0434782608695652, 1.0346727957825304, 1.0098870056497176, 1.0869565217391304, 1.0952380952380953, 2.5, 1.0153074461644902, 1.0271065349863417, 1.1428571428571428, 2.0, 1.0897501274859764, 1.0638516992790936, 1.072011521843495, 1.0998116760828625, 1.1088816178499625, 1.0335235378031384, 1.0977277996754, 1.0226244343891402, 1.1134751773049645, 1.0414379619676373, 1.126022913256956, 1.056, 1.0, 1.0, 1.050233644859813, 1.1578947368421053, 1.1095890410958904, 1.423728813559322, 1.5, 1.0248161617456224, 1.0839046686255305, 1.0587905149431738, 1.039660358274109, 1.2345366750977236, 1.0237467018469657, 1.2694475760992108, 1.5, 1.098814229249012, 2.0, 1.1497411389884509, 1.2424242424242424, 2.0, 1.0451876208552766, 1.164882226980728, 1.0159767610748003, 1.0094261812183338, 1.1578947368421053, 1.003008743424102, 1.0676602791577952, 1.0197725642864461, 1.0818951992469408, 1.0242503259452411, 1.1428571428571428, 1.5, 1.1596223021582734, 1.0004430603541927, 1.0773166571915862, 1.010752688172043, 1.007185480476391, 2.0, 1.152160681679854, 1.1448, 1.5, 1.2476635514018692, 1.1428571428571428, 1.0626262626262626, 1.0128722472933498, 1.0355228314926048, 1.0076923076923077, 2.6, 1.25, 2.0, 1.3333333333333333, 1.0075271814887092, 1.2307692307692308, 1.0568391866913125, 1.007942085243561, 1.0599486253818384, 2.0, 1.3333333333333333, 1.0139720558882235, 1.0187445510026156, 1.0394456289978677, 1.029577455240626, 1.0989583333333333, 1.0107296137339057, 1.023382413936126, 1.5, 1.0100115517905275, 1.055724417426545, 1.0601583113456465, 1.033724340175953, 1.0, 1.0996685082872928, 1.037037037037037, 1.003338898163606, 1.152542372881356, 1.0, 1.1118355065195586, 1.1000864731315627, 1.0358203345235857, 1.1373456790123457, 1.1263736263736264, 1.0172413793103448, 1.1686746987951808, 1.10148849797023, 1.2222222222222223, 1.0048112259438702, 1.3333333333333333, 1.094562647754137, 1.0094042942258035, 1.081924882629108, 1.0549590777083517, 1.0246478873239437, 1.0450606585788562, 1.1521528785679729, 1.0513219284603421, 1.0872323552735923, 1.0642040457343886, 1.0302398331595413, 1.072938689217759, 1.011406439530974, 1.0193548387096774, 1.0037037037037038, 1.023237431355509, 1.0267576289881122, 1.050179211469534, 2.1706349206349205, 1.168, 2.5, 1.0820895522388059, 1.0055525383032244, 1.1, 1.0228452751817239, 1.0919863916787393, 1.0052327291404188, 1.0050153881226491, 1.0318275154004106, 1.111417040051989, 1.0764184087424058, 1.0892307692307692, 1.0117867295292242, 1.0954747580434214, 1.0045495837055833, 1.1665796344647519, 1.056352817640882, 1.0754716981132075, 1.0125, 1.04, 1.0, 1.038888888888889, 1.0142667551426676, 1.655072463768116, 1.017094017094017, 1.0219552609776306, 1.1304347826086956, 1.0034251531670606, 1.054054054054054, 1.0406328956633393, 1.0, 1.1316818774445894, 1.0444633248371566, 1.0088311688311689, 1.0423312577833126, 4.0, 1.0269151138716357, 1.0194833948339483, 1.0187855073802563, 1.0160857908847185, 1.2189542483660132, 1.027412906910337, 1.0783431330683573, 1.0535714285714286, 1.003103225911587, 1.0114606321301665, 1.1174377224199288, 1.1791808873720135, 1.0045558086560364, 1.3076923076923077, 1.1456953642384107, 1.0, 1.0317524933848972, 1.0646738371280906, 1.09375611665688, 1.2660550458715596, 1.3076923076923077, 3.3333333333333335, 1.0571160911632536, 1.0869565217391304, 1.126309136872517, 1.5, 1.0547945205479452, 1.106361829025845, 1.2857142857142858, 1.0048790146924875, 1.110344827586207, 1.1159420289855073, 1.0554371002132197, 1.008138711960368, 1.0960145567607673, 1.0434782608695652, 2.0, 1.008201990075335, 1.1554729922835096, 1.083086053412463, 1.0277399469572073, 1.048367619330099, 1.0470201044573229, 1.0758665794637017, 1.0343817294874236, 1.0656641604010024, 1.0876884422110553, 1.2617760617760618, 1.7692307692307692, 1.1086330574366692, 1.1354723707664884, 1.2884615384615385, 1.1538461538461537, 1.0593739916101967, 1.0729166666666667, 1.0326358110946328, 1.0118645874036447, 1.1389521640091116, 1.2194513715710724, 1.0120979682986626, 1.0515988372093024, 1.0905723282089277, 1.0149075466690258, 1.2, 1.0553435114503817, 1.0036407766990292, 1.0239110533851823, 1.051233172509194, 1.0321799332680779, 1.1327668613913968, 1.0033783783783783, 1.0457414420435138, 1.0106661161574457, 1.012752585230387, 1.04719524608655, 1.0556088207094918, 2.0, 1.0, 1.0694825084636466, 1.6363636363636365, 1.0053956834532374, 1.0062708963222473, 1.1459979233443185, 1.1388888888888888, 1.224, 1.2580645161290323, 1.0184794086589228, 1.0001074402363686, 1.0909090909090908, 1.0114219114219114, 1.008954832792899, 1.0246636771300448, 2.0, 2.25, 1.0010813148788926, 1.2, 1.0264156865822438, 1.0548780487804879, 1.0833333333333333, 1.0551225614009767, 1.4090909090909092, 1.8888888888888888, 1.0385829507836932, 3.0, 1.16, 1.0632603406326033, 1.3417721518987342, 1.0178156467854376, 1.1317494600431965, 1.0423728813559323, 1.0073767076233486, 1.0068978576065786, 1.1458333333333333, 1.002302116991263, 1.1312483643025386, 3.0, 1.0909090909090908, 1.0292552930917926, 1.75, 1.033379058070416, 1.2, 2.0, 1.0, 1.1324245374878286, 1.1176470588235294, 1.325, 1.0961538461538463, 1.2179487179487178, 2.75, 1.0891156044496344, 1.3076923076923077, 1.1272727272727272, 1.036873881591954, 1.1505376344086022, 1.04527402700556, 1.0037664783427496, 1.8, 1.0, 1.1029609690444144, 1.2804878048780488, 1.0121457489878543, 1.0105401016292106, 1.083240706434482, 1.035264483627204, 1.0, 1.0050931302712143, 1.2, 1.2647058823529411, 2.0, 1.1415094339622642, 1.2, 1.0128479657387581, 1.0661157024793388, 1.0599261992619926, 1.0287005879659576, 1.010175240248728, 1.0541557591623036, 1.0327547592385218, 1.063157894736842, 1.0013422818791946, 1.0223497547209122, 1.0589101620029455, 1.0909090909090908, 1.0091030407015538, 1.0163529298194807, 1.0793319415448852, 1.0234741784037558, 1.2894736842105263, 1.0926640926640927, 2.0, 1.8148148148148149, 1.078740157480315, 1.0964083175803403, 1.0211640211640212, 1.0335195530726258, 1.015255905511811, 1.0689655172413792, 1.0246008951315804, 1.1009833585476552, 1.112404526472943, 1.2784810126582278, 1.0310077519379846, 1.1265822784810127, 1.0, 1.0076864448215364, 1.4310344827586208, 1.0060687412560971, 1.0685397704788286, 1.0433885936384548, 1.0131862217438106, 1.8571428571428572, 1.2228, 1.1666666666666667, 1.0279503105590062, 1.0909090909090908, 1.0108285050247143, 1.0206561360874848, 1.0078654732845131, 1.2060810810810811, 1.1605504587155964, 3.0, 1.0078067821419858, 1.0011839828373086, 1.0117908276548504, 1.0, 1.5, 1.0208667736757624, 1.30622009569378, 1.073293709095766, 1.1301255230125522, 1.0769230769230769, 1.140043763676149, 1.0975186974135245, 1.0429342836245934, 1.4479166666666667, 1.048321762716725, 1.0320512820512822, 1.3333333333333333, 1.201815269620929, 1.0139068071230484, 1.4615384615384615, 1.0697808535178777, 1.0, 1.0, 1.1042345276872965, 1.0980392156862746, 1.1931127616475354, 1.0163723273320548, 1.1821983273596177, 1.0, 1.094488188976378, 1.4814814814814814, 1.0098305150897187, 1.0833333333333333, 1.0, 1.0490191329619762, 1.0, 1.0, 1.1444401987008024, 1.75, 1.1963882618510158, 1.0022556390977444, 1.3653136531365313, 1.0, 1.0251860410734672, 1.0118296529968454, 1.2962962962962963, 1.0760333176174761, 1.0666666666666667, 1.0412946428571428, 1.1516172506738545, 1.063680118474639, 1.0983144726161487, 1.0, 1.0561797752808988, 1.0330453371336956, 1.0382889620101705, 1.086696562032885, 1.1666666666666667, 1.0287323943661972, 1.0167523478880136, 1.0306345733041575, 1.0, 1.1119868637110017, 1.0704938004755262, 1.0558892052808697, 1.2151145818128741, 1.0373272599491128, 1.0221825324852982, 1.0967514124293785, 1.0985021222857543, 1.5, 1.092979127134725, 1.0449034575662326, 1.0535976505139502, 1.0111172873818788, 1.1455525606469004, 1.0381495847271889, 1.068429237947123, 1.0434128279651231, 1.1831750339213025, 1.0424449877750612, 1.1598282442748091, 1.0060802392225268, 1.124233816714008, 1.072289156626506, 1.1379310344827587, 1.0062282457639005, 1.0889830508474576, 1.050807994012806, 1.0025821508238515, 1.0, 1.113413715146948, 1.2128851540616246, 1.4, 1.3409090909090908, 1.0107340135562148, 1.1524163568773234, 1.0387228260869565, 1.0, 1.0347222222222223, 1.0243498817966903, 1.018686894927348, 1.0302276640520376, 1.0615013157537776, 1.031868131868132, 1.0635696821515892, 1.1002178649237473, 1.0546373741902568, 1.206896551724138, 1.035259344308079, 1.017825044937088, 1.1566820276497696, 1.008609651640249, 1.25, 1.0509292978338862, 1.0, 1.0890052356020943, 1.3609271523178808, 1.0553839957035447, 1.0335429769392033, 1.1330603889457522, 1.0410509031198687, 1.0788288288288288, 1.0186590421164063, 1.0, 1.5714285714285714, 2.0, 1.3333333333333333, 1.1170212765957446, 1.308, 1.393238434163701, 1.081447963800905, 1.0304568527918783, 1.002717391304348, 1.035001285236912, 1.0090823161961122, 1.0304707294305908, 1.0357387355920362, 1.017830423530108, 1.0765143464399576, 1.014927994380049, 1.008255511697314, 1.116164112703905, 1.0419426048565121, 1.1330049261083743, 1.3453237410071943, 1.0195834885935495, 1.2797992471769135, 1.0134412890874283, 1.107981220657277, 1.1592039800995024, 1.0690537084398977, 1.25, 1.011806375442739, 1.0, 4.0, 1.2018072289156627, 1.0027685907125006, 1.0181117533718689, 1.0976863753213368, 1.063953488372093, 1.0252192849061423, 1.202606386695549, 1.071290944123314, 1.4, 1.6666666666666667, 1.0218400218400219, 1.440909090909091, 1.0052631578947369, 1.0194728093089527, 2.0, 1.1336772983114447, 1.064516129032258, 1.0122531262796484, 1.1472303206997085, 1.0248992152351022, 1.0294827124095416, 1.006153829970204, 1.2567567567567568, 2.5, 1.1200982901607455, 1.0, 1.082512315270936, 1.2033195020746887, 1.1666666666666667, 1.2911392405063291, 1.3103448275862069, 1.067394742148778, 1.1742424242424243, 1.0705218617771508, 1.0553327987169205, 1.0526315789473684, 1.0058754406580495, 1.0266653738000582, 1.0414414414414415, 1.0035807291666667, 1.3333333333333333, 1.065443849830467, 1.2018579446487323, 1.2380952380952381, 1.0041011619958988, 1.1456878349845705, 1.1491935483870968, 1.0637057950555615, 1.0909090909090908, 1.1051587301587302, 1.0042227241480899, 1.037313432835821, 1.3507462686567164, 1.013090976788268, 1.2952380952380953, 2.0, 1.042573623559539, 1.0351864883884587, 1.0265595436446302, 1.0556632511769592, 1.0447489505585814, 1.0105836121723812, 1.1234991423670668, 1.0357956394402863, 1.1360759493670887, 1.0248028939801503, 1.1148755955532028, 1.003058103975535, 1.1535415750109987, 1.0125614570593298, 1.3076923076923077, 1.1409209060527292, 1.1428571428571428, 1.6, 1.036340852130326, 1.0293791574279378, 1.0301631271160356, 1.1363636363636365, 1.4444444444444444, 1.0221343873517788, 1.0843123704215618, 1.272, 1.0218299883592095, 2.0, 1.0021941854086671, 1.3333333333333333, 1.3441734417344173, 1.1333333333333333, 1.077970728307585, 1.3235294117647058, 1.2042553191489362, 1.119724375538329, 1.0, 1.0876639600249844, 1.065998821449617, 2.25, 1.25, 1.0758620689655172, 1.0705521472392638, 1.0672957536627763, 1.025, 1.0352781546811398, 1.0199004975124377, 1.1095505617977528, 1.1754874651810585, 1.5434782608695652, 1.0033783783783783, 1.2580645161290323, 1.0, 1.1018348623853211, 1.2260024301336574, 1.0776255707762556, 1.294255177020708, 1.0148153269495737, 1.2036146576023876, 1.035482595425507, 1.0138441628795858, 1.0633165829145728, 1.0060331825037707, 1.2727272727272727, 1.0, 1.0, 1.0271436181962292, 1.1259320629660314, 1.008130081300813, 1.0102880658436213, 1.0914949275824666, 1.033388269733885, 1.0042298175462485, 1.0425531914893618, 1.1304347826086956, 4.0, 1.1052108633252373, 1.0478855138623007, 1.046376651982379, 1.1361256544502618, 1.053858967240422, 1.0091150340371524, 1.0138667079408186, 1.0015060240963856, 1.0065260569374823, 1.0949152542372882, 1.0236460717009916, 1.3004926108374384, 1.0076699637946946, 1.0545454545454545, 1.080738966814916, 1.0, 1.1615720524017468, 1.0366211756809665, 1.360655737704918, 1.0024787841331233, 1.1585040071237755, 1.16, 1.031746992815048, 1.0009908719673313, 1.1663952835485683, 1.0216346153846154, 1.0066985645933015, 1.0082681511756277, 1.2175438596491228, 1.2666666666666666, 1.0, 1.0, 1.0190124055441063, 2.1666666666666665, 1.0047046725864874, 1.0598642807551903, 1.2023655516540381, 1.0843158270811004, 1.0053531720976199, 1.1236679502104414, 1.025078369905956, 1.0152582159624413, 1.0089721717898954, 1.042783358412298, 1.0042087340223986, 1.0752780845161465, 1.2, 1.0683760683760684, 1.3388704318936877, 1.05090147514114, 1.0432432432432432, 1.018952261755766, 1.2062314540059347, 1.0031847133757963, 1.0387196761236044, 1.0439814814814814, 1.0104345397230756, 1.3333333333333333, 1.0222501029189783, 1.0107392641845194, 1.1495256166982921, 1.001756234632947, 1.1111111111111112, 1.0790816326530612, 1.0439800789158673, 1.068614219881501, 1.032114624505929, 1.0022087949305702, 1.1666666666666667, 1.203513536450819, 1.258816120906801, 1.1287001287001286, 1.144, 1.0550541516245486, 1.0977859778597785, 1.1136154553817847, 1.0471395361579223, 1.0274881516587677, 1.1384000645786245, 1.0405036160140808, 1.0625, 1.0679886685552409, 1.0311815270520817, 1.1678258240096764, 1.1407407407407408, 1.250778816199377, 1.209016393442623, 1.4223300970873787, 1.0575719649561952, 1.0077027106485565, 1.125, 1.0267909143855563, 1.010325211272237, 1.021373728989417, 1.541732283464567, 1.011794432161711, 1.0714191288254347, 1.0456349206349207, 1.075356415478615, 1.001758942661757, 1.072384182615952, 1.0573248407643312, 1.2760180995475112, 1.0269953051643192, 1.0067936864688154, 1.0198019801980198, 2.5, 1.0254520683675996, 1.0028185934756493, 1.0057416267942583, 1.3151515151515152, 1.016191904047976, 1.0225738584170445, 1.0268765133171913, 1.1194813213954924, 1.3666666666666667, 1.1151446398184912, 1.5, 1.1002638522427441, 1.2857142857142858, 1.030179066178248, 1.0, 1.0240549828178693, 1.3170731707317074, 1.2533026995979322, 1.025974025974026, 1.0, 1.3636363636363635, 1.0305486284289276, 1.0972222222222223, 1.0681818181818181, 1.5, 1.0405205499291381, 1.0109717868338557, 1.1778020179983637, 1.1759259259259258, 1.5, 1.0960916838084043, 1.0429381744166903, 1.0085047680274295, 1.1594454072790294, 1.3928571428571428, 1.0526315789473684, 1.162162162162162, 1.1578947368421053, 1.5384615384615385, 1.023062381852552, 1.016022872129376, 1.00782858727177, 1.032258064516129, 1.0058420524580765, 1.0003209376380657, 7.0, 1.0012605751374064, 1.167548967707782, 1.0, 1.1428571428571428, 1.0655778272704777, 1.1485929378024735, 1.0887260159694911, 1.077720207253886, 1.0, 1.0928571428571427, 1.291005291005291, 1.0, 1.0140936219170202, 1.0387035612222466, 1.0065181157661376, 1.1674780915287244, 1.4444444444444444, 1.0081933257896536, 1.0488578680203047, 1.0222419928825623, 1.2361111111111112, 1.1073512252042006, 1.0, 1.0144927536231885, 1.115711252653928, 1.0494362973637366, 1.0416666666666667, 1.0333333333333334, 1.0245690941222372, 1.1831085876508163, 1.1, 1.323076923076923, 1.0286403567384317, 1.029549147034931, 1.050301736486549, 1.4384615384615385, 1.203883495145631, 1.200657894736842, 1.0, 1.0100951831554659, 1.041871921182266, 1.0186253005600403, 1.0408542246982357, 2.0, 1.3233438485804416, 1.014580801944107, 1.1877777777777778, 1.227852186541875, 1.1377007317192949, 1.0259321558732828, 1.0964332892998678, 1.1362637362637362, 1.0655737704918034, 1.0113016886052386, 1.01340870026253, 1.0538951494365507, 1.054054054054054, 3.0, 1.101123595505618, 1.0899637850048407, 1.2283236994219653, 1.0019948108841055, 1.009075119985151, 1.0938967136150235, 1.5, 1.0038872691933916, 1.0291384335844342, 1.0262058488416255, 1.2835249042145593, 1.0055640209854422, 1.1924290220820188, 1.3349573690621193, 1.0848022868032396, 1.0031174943593975, 1.0132420148340533, 1.1191162343900096, 1.0951882845188285, 1.0833333333333333, 1.044058840331334, 1.120338876686539, 1.0543729383130922, 1.1076604554865424, 1.0433526011560694, 1.072199730094467, 1.4285714285714286, 1.0287253141831239, 4.0, 1.0, 1.4, 1.041304347826087, 1.176892950391645, 1.005447301251323, 1.0399608546729735, 1.0098195935145011, 1.0588132938924657, 1.0046511627906978, 1.0690196078431373, 1.0252119469159102, 1.5, 1.3076923076923077, 1.0575364667747165, 1.125, 1.1825293350717079, 1.124948282995449, 1.1659674882013633, 1.0316904023931555, 1.25, 1.0169851380042463, 1.0454545454545454, 1.0602034618888552, 1.000764751092638, 1.0784090909090909, 1.0465605286872934, 1.023625579424812, 1.0895274397693397, 1.1488250652741514, 1.2794117647058822, 1.2690951821386605, 1.3333333333333333, 3.0, 1.000156382063722, 1.25, 1.8571428571428572, 1.346938775510204, 1.0173469387755103, 1.034752321981424, 1.0753424657534247, 1.0843373493975903, 1.2857142857142858, 1.0213588283157038, 1.0254618072890664, 1.1891891891891893, 1.0432098765432098]
origin-bjaq_15.87 	max: 7.0000	99th: 3.0000	95th: 1.6373	median: 1.0644	mean: 1.1669

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 20.352488 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=38.886189