Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='naru', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 44, 'naru': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.6000	median: 1.0577	mean: 1.1495
ReportEsts: [1.0641891891891893, 1.0417797069994574, 1.040045740767211, 1.0038461538461538, 1.0, 1.0, 1.1595066436274801, 1.0006841566316242, 1.25, 1.025, 1.010273280812628, 1.0023878449590902, 1.0016827934371055, 1.0488372093023255, 1.0356764394206994, 1.0, 1.2857142857142858, 1.010626992561105, 3.0, 2.6666666666666665, 1.173913043478261, 1.0922147940478757, 1.0328488657566532, 1.1065627030539311, 1.002466699555994, 1.0, 1.0200630553167096, 1.0, 1.6, 1.2661870503597121, 1.0, 1.0064466439154744, 1.009399143742926, 1.295782463928968, 1.0152079916505143, 1.0231196262947668, 1.0053763440860215, 1.0085763543209576, 1.069736207727805, 1.1785714285714286, 1.1111111111111112, 1.076219512195122, 1.0, 1.0974200648040595, 1.0848372666975166, 1.2314049586776858, 1.1262135922330097, 1.304147465437788, 1.0207257756602865, 1.0285714285714285, 1.0156217505657839, 1.1781376518218623, 1.0054198483823307, 2.0, 1.122077922077922, 1.0067609866032303, 1.0829090909090908, 1.064638783269962, 1.31055900621118, 1.6666666666666667, 1.0266494002181026, 1.0485678704856787, 1.1, 1.1149425287356323, 1.1, 1.090374164964868, 1.0578769789774203, 1.1666666666666667, 1.0, 1.100995586574977, 1.0334128878281623, 1.057836899942163, 1.1261261261261262, 1.0603975189025219, 1.2211764705882353, 1.2272727272727273, 1.0, 1.048140043763676, 2.0, 1.0589113030503028, 1.125, 1.0370117853316452, 1.2147239263803682, 1.014908256880734, 1.0581516095534786, 1.04, 1.0092023800920238, 1.0352044519719332, 1.1715686274509804, 2.3333333333333335, 1.103787506148549, 1.024600883510417, 1.0809968847352025, 1.343618513323983, 1.2193763919821827, 1.1031518624641834, 1.1946902654867257, 1.0017094017094017, 1.0, 1.0041938074417776, 1.0846652267818575, 1.0410714285714286, 1.0091517698169645, 1.0303030303030303, 1.0028595400225622, 1.0423353624792473, 1.0235192710257357, 1.0333712552142587, 1.0270780856423174, 1.1666666666666667, 1.3333333333333333, 1.1446910938753678, 1.0134606146707412, 1.057448229792919, 1.1323529411764706, 1.0061576281552649, 1.0, 1.1276671408250356, 1.154066985645933, 1.0, 1.2637362637362637, 1.1666666666666667, 1.0601503759398496, 1.013710307845225, 1.1064688980352566, 1.0769230769230769, 1.8, 1.2235099337748345, 1.0, 1.1428571428571428, 1.0153561460367444, 1.1818181818181819, 1.0201822916666667, 1.015895545353489, 1.0567349472377405, 1.1452599388379205, 1.028169014084507, 1.0272217774219377, 1.00199203187251, 1.04923273657289, 1.0243249837345478, 1.1358024691358024, 1.0580560991519896, 1.0626568036624162, 2.0, 1.0138632162661738, 1.0102857142857142, 1.0490074441687345, 1.0434092112228692, 1.0, 1.0424135319363796, 1.031111111111111, 1.012, 1.4476190476190476, 1.145484949832776, 1.1262643290627108, 1.056676649220521, 1.0107556284750707, 1.1520912547528517, 1.111842105263158, 1.0425531914893618, 1.3115942028985508, 1.1149425287356323, 1.2857142857142858, 1.0139511233991165, 1.0029660920022265, 1.0057570523891768, 1.0369465422775064, 1.0348197923029934, 1.0781585433728234, 1.0281385281385282, 1.1260504201680672, 1.1537716665052775, 1.044350580781415, 1.1742654508611956, 1.0808823529411764, 1.0613950498232079, 1.0608688504377133, 1.1043472219809993, 1.1666666666666667, 1.2352941176470589, 1.0710399032648126, 1.0471816283924844, 1.1409544950055495, 1.2258064516129032, 1.0248804044196647, 1.0042462845010616, 1.0365344241715906, 1.1153846153846154, 1.206801974766868, 1.0379794736540335, 1.0, 1.5454545454545454, 1.0611484605832227, 1.2451759364358683, 1.1055045871559632, 1.25, 1.0263665594855305, 1.004701542003011, 1.004168889327195, 1.1798245614035088, 1.096553178033098, 1.2733812949640289, 1.0625, 1.0833333333333333, 1.0, 1.0389610389610389, 1.0105984540600845, 1.6550522648083623, 1.1724137931034482, 1.0143351458230352, 1.0957683741648108, 1.068070778971253, 1.007185661968705, 1.0039775691184143, 1.1428571428571428, 1.0548780487804879, 1.0496598639455783, 1.015164570049974, 1.0121110879097932, 1.0, 1.1093167701863353, 1.005624987621066, 1.0084919708616735, 1.0832369942196531, 1.0372192339919453, 1.0056673997631533, 1.0344827586206897, 1.0025595243084953, 1.0571078097314979, 1.1652566271855611, 1.0786516853932584, 1.140219871395976, 1.003883495145631, 1.1669291338582677, 1.0, 1.018531889290012, 1.1196404644930773, 1.0507389162561576, 1.328358208955224, 1.0909090909090908, 2.6666666666666665, 1.0553982518773852, 1.1636363636363636, 1.0727091290733286, 1.5, 1.5, 1.25, 1.0160031225604995, 1.4795918367346939, 1.138121546961326, 1.1476997578692494, 1.0853658536585367, 1.0110356536502547, 1.0331993360132798, 1.0526315789473684, 1.0, 1.0405674305154375, 1.1185673116508852, 1.106830122591944, 1.0834616778401884, 1.0585157718291258, 1.009002449195737, 1.1081081081081081, 1.035438269105505, 1.0717703349282297, 1.110682309354739, 1.2671957671957672, 1.8181818181818181, 1.0159283105900443, 1.0362473347547974, 1.25, 1.0, 1.1087272727272728, 1.0, 1.1470588235294117, 1.0231882107529775, 1.1197771587743732, 1.1981981981981982, 1.000302816778379, 1.0188034188034187, 1.0021249623497714, 1.007354631119283, 1.6, 1.0798472171698799, 1.0, 1.007680288143224, 1.0043383947939262, 1.0079377361066861, 1.3, 1.6666666666666667, 1.0454545454545454, 1.5492957746478873, 1.0125699870793083, 1.0, 1.0642201834862386, 1.009049773755656, 1.0360576923076923, 1.001678501508324, 1.2352941176470589, 1.0125786163522013, 1.0176662916608072, 1.1010581112431392, 1.0845296439259227, 1.1367521367521367, 1.0, 1.2517899761336515, 1.019704433497537, 1.1838006230529594, 1.0415021496885146, 1.026101839965768, 1.1601307189542485, 1.0338983050847457, 1.027434842249657, 1.088458298230834, 1.4285714285714286, 1.026851699141594, 1.0604395604395604, 1.0, 1.0359598021289564, 1.1904761904761905, 2.0, 1.0489366324255067, 2.0, 1.0013736263736264, 1.072674418604651, 1.0016406890894176, 1.023071104387292, 1.2010443864229765, 1.1538461538461537, 1.0061553863012216, 1.0195873193609373, 1.02945301542777, 1.0042573164907196, 1.1341328704434275, 2.0, 1.1111111111111112, 1.0129749875574383, 1.3333333333333333, 1.0498357064622126, 1.0, 1.0, 1.0, 1.1501154734411085, 1.0884615384615384, 1.162162162162162, 1.0757575757575757, 1.0, 1.0339547270306257, 1.0231863415494955, 1.5, 1.2406194163192377, 1.0, 1.0076520154862219, 1.1265822784810127, 1.0891891891891892, 1.1658986175115207, 1.0018181818181817, 1.1600790513833992, 1.0925925925925926, 1.0185312441004342, 1.001690360471767, 1.0758988015978694, 1.0, 1.1428571428571428, 1.8333333333333333, 1.5, 1.0666666666666667, 1.001940786725533, 1.25, 1.1114808652246255, 1.0297029702970297, 1.0387938679842899, 1.0019219513047428, 1.0030895983522141, 1.0884735276059132, 1.0286396181384247, 1.3003095975232197, 1.5, 1.0526315789473684, 1.0398230088495575, 1.002683641052329, 1.3333333333333333, 3.142857142857143, 1.1447661469933186, 1.0372093023255815, 1.0092729503822373, 1.1590909090909092, 1.342769701606733, 1.0575810185185186, 1.3559322033898304, 1.0808477237048666, 1.0434322033898304, 1.25, 1.0584707646176912, 1.0336134453781514, 1.056152795869364, 1.0101918960118428, 1.0145004825029205, 1.303030303030303, 1.09009009009009, 1.0718562874251496, 1.0, 1.040609774473856, 1.0346818440290364, 1.0100552361627775, 1.0153901843081656, 1.0309810671256454, 1.0194363459669582, 1.8333333333333333, 1.1519536903039074, 1.0, 1.1289496157130658, 1.1111111111111112, 1.0259174209658002, 1.018840579710145, 1.050085984522786, 1.134387351778656, 1.080659150043365, 3.0, 1.189961659114674, 1.0012616038745796, 1.0242091226779475, 1.0, 1.1454545454545455, 1.036468330134357, 1.3045977011494252, 1.0836904665642435, 1.0571428571428572, 1.05, 1.1138912855910268, 1.0695772080304766, 1.0834981896905678, 1.0026314168287467, 1.1026315789473684, 1.3250414593698177, 1.125, 1.25, 1.0532994923857868, 1.3448275862068966, 1.038881309686221, 1.1379310344827587, 1.0485120170435631, 1.1363636363636365, 1.1065123276735547, 1.0334789712986643, 1.16367552045944, 1.0, 1.0555555555555556, 1.36, 1.0006619422163383, 1.2166301969365427, 1.0, 1.055332964907433, 1.0025554966731438, 1.2554630593132154, 1.0, 2.0, 1.173980582524272, 1.0026881720430108, 1.412037037037037, 1.0, 1.0086582228379182, 1.015340364333653, 1.0869565217391304, 1.0683239171374765, 1.0272727272727273, 1.0013140604467805, 1.1193548387096774, 1.0046276819520403, 1.1462028586189081, 1.0, 1.0810810810810811, 1.0968560476541833, 1.015927752949727, 1.0757161038372356, 1.0, 1.0381171067738233, 1.0212623983153715, 1.0282870612886328, 2.0, 1.1128389154704945, 1.0879548985452663, 1.1105044626802236, 1.2061508889956751, 1.0270266649399133, 1.1685399479541554, 1.0076206604572395, 1.072082931533269, 2.0, 1.1024859165848364, 1.2758620689655173, 1.0, 1.2781456953642385, 1.1304347826086956, 1.0297009308094052, 1.0016992353440952, 1.0534052028977197, 1.2359614293817356, 1.0321910575238185, 1.0439605031786825, 1.0061779765826369, 1.1067961165048543, 4.0, 1.043058456367783, 1.0315789473684212, 1.005449141347424, 1.0178160021867313, 1.1069924178601516, 1.1394160583941606, 1.0717948717948718, 1.4285714285714286, 1.0106293981595393, 1.0087796508194713, 1.0382333370300543, 1.0959741193386052, 1.010870613189356, 1.027542372881356, 1.0000436956838374, 1.0170049369171694, 1.0636856368563685, 2.0, 1.0, 1.0904907975460123, 1.0424354243542435, 1.0153321976149914, 1.004778972520908, 1.1832946635730859, 1.1775147928994083, 1.0554699537750385, 1.0824175824175823, 1.014480807989567, 1.3950617283950617, 1.0296808358833696, 1.0, 1.0561456752655538, 1.4444444444444444, 1.0567375886524824, 1.0379888268156425, 1.1119221411192215, 1.1106719367588933, 1.066147859922179, 1.0070545471937251, 1.0, 1.6170212765957446, 1.5, 1.0, 1.1428571428571428, 1.1071428571428572, 1.4273127753303965, 1.1318681318681318, 1.0286767061839155, 1.1180285343709468, 1.0675721969100065, 1.0197692762768684, 1.099836333878887, 1.0032681327873476, 1.0393258426966292, 1.073697585768742, 1.138848572810837, 1.0708035003977725, 1.1170520231213872, 1.0175679385122152, 1.0242927588891773, 1.0800504045629393, 1.0105515361100947, 2.0, 1.0245700245700247, 1.0323475046210722, 1.0410958904109588, 1.0, 1.1590909090909092, 1.25, 1.1437246963562753, 1.5555555555555556, 1.5, 1.0235908176391042, 1.0354007464012795, 1.0088077808531002, 1.0486781700174133, 1.0972972972972972, 1.025516403402187, 2.0, 1.2125984251968505, 1.1752451973737537, 1.0033070364172445, 1.0074074074074073, 1.0611686980293884, 1.0140532808868228, 1.1290322580645162, 1.000074486508631, 1.1936056838365896, 1.0183474716567527, 1.0178295984747598, 1.3636363636363635, 1.1485714285714286, 1.0, 1.0113378684807257, 1.024513049235165, 3.0, 1.0452599388379205, 1.0222011133692674, 1.2857142857142858, 1.1824842392230364, 1.4, 1.1875, 1.0407577903682719, 1.7692307692307692, 1.0206868477536821, 1.038017941050833, 1.2258064516129032, 1.2608695652173914, 1.3002680965147453, 1.0033589251439539, 1.042817679558011, 1.0503733704594356, 1.0089053951519509, 1.0, 1.2461981316532695, 1.0218068535825544, 2.0, 1.115090988767673, 1.0220693831646337, 1.131504257332072, 1.0054354785013702, 1.0368235264240546, 1.2840909090909092, 2.142857142857143, 1.0433624952453404, 1.0130718954248366, 1.0761882137342407, 1.0670446964643094, 1.0401131929755805, 1.1471241589823087, 1.0224719101123596, 1.0275229357798166, 1.1115241635687731, 1.0134641407307172, 1.0782334384858043, 1.0687318489835431, 1.127626050420168, 1.0487030917171434, 4.0, 1.0005246039240374, 1.027315831850578, 1.055220505088579, 1.1176470588235294, 1.0939612609191036, 1.2374429223744292, 1.0, 1.0101175632347703, 1.0134426229508198, 1.080188679245283, 1.1470588235294117, 1.6666666666666667, 1.0160018327478721, 1.0, 1.470790378006873, 1.0769230769230769, 1.0347149535970972, 1.2857142857142858, 1.2741935483870968, 1.128930817610063, 1.0, 1.2936507936507937, 1.089807555238774, 2.0, 1.0, 1.08130081300813, 1.0984848484848484, 1.1316884661117717, 1.0203426124197001, 1.0738255033557047, 1.0619469026548674, 1.089150378938971, 1.0493506493506493, 1.5909090909090908, 1.183673469387755, 1.1923076923076923, 1.0, 1.0518518518518518, 1.2496392496392497, 1.0510314875135722, 1.0849820143884892, 1.0262569999700537, 1.1548380934186646, 1.006084546289983, 1.005196032120926, 1.0156438026474128, 1.0, 1.2222222222222223, 1.0, 1.0303030303030303, 1.0463417345593724, 1.1042884990253412, 1.0065359477124183, 1.180232558139535, 1.1226422298587246, 1.064845152283541, 1.006693345936424, 1.064102564102564, 1.1578947368421053, 1.0614359733530718, 1.0919273594909862, 1.0043980377985207, 1.0258528397150373, 1.1776315789473684, 1.0465888954518605, 1.004187859775226, 1.2146189735614308, 1.0627705627705628, 1.0, 1.0137299771167048, 1.2927927927927927, 1.0192307692307692, 1.2315436241610738, 1.0347890451517394, 1.0, 1.1116751269035532, 1.0346362358610535, 1.1666666666666667, 1.0110425201413313, 1.1536016949152543, 1.069767441860465, 1.0421618871079126, 1.0050468637346792, 1.1416868117109857, 1.0009551098376313, 1.006810442678774, 1.0063965284039675, 1.140529531568228, 1.0714285714285714, 1.0, 1.25, 1.0117233862177546, 1.8333333333333333, 1.0270157938487114, 1.0751171180873405, 1.134249003101462, 1.0712765957446808, 1.0011332170086864, 1.0166721150702844, 1.0449438202247192, 1.037410071942446, 1.0335313593350084, 1.0005392857980258, 1.0075162380461615, 1.0094219196401435, 1.4285714285714286, 1.1228070175438596, 1.2885375494071147, 1.0003639640888766, 1.022801302931596, 1.0113006396588486, 1.1734513274336282, 1.050682261208577, 1.014781209924315, 1.0149863760217983, 1.0081818181818183, 1.5, 1.0282948667533802, 1.0011960138389975, 1.1225663716814158, 1.0008428150021071, 1.15625, 1.030905077262693, 1.0746268656716418, 1.5625, 1.0329360100376412, 1.3076923076923077, 1.0735887096774193, 1.0373626373626375, 1.2029669588671612, 1.0303081326822698, 1.0835294117647059, 1.0, 1.061611374407583, 1.005092098974227, 1.0014111895105284, 1.01053830279847, 1.0898564644362627, 1.0363426789165, 1.0, 1.0584795321637428, 1.066902876198416, 1.1111879994642617, 1.0331262939958592, 1.1944444444444444, 1.0743913435527501, 1.007820990942994, 1.1809605488850772, 1.0292244613103028, 1.0, 1.3333333333333333, 1.0146752700932038, 1.0249495240842226, 1.0036621564319033, 1.1175666438824334, 1.0758180367118915, 1.0066666666666666, 1.0169812644726686, 1.1017247682031173, 1.0055452865064696, 1.2972972972972974, 1.0049261083743843, 1.0091297305256959, 1.0238095238095237, 1.75, 1.0381019845230812, 1.0004986840282588, 1.0162224797219004, 1.2571428571428571, 1.0456191165821869, 1.0115493096438846, 1.0200745626613135, 1.04, 1.3076923076923077, 1.112533692722372, 1.0673684210526315, 1.096875, 1.5925925925925926, 1.0583864118895967, 1.022794846382557, 1.0855085508550855, 1.1714285714285715, 1.0552980907479854, 1.0183881064162754, 1.012950030510543, 1.0228930307941653, 1.6666666666666667, 1.0357142857142858, 2.0, 1.0334773218142548, 1.5, 1.3333333333333333, 1.5, 1.206070287539936, 1.0760233918128654, 1.1248474989833266, 1.007500836080455, 1.3157894736842106, 1.6323529411764706, 1.0, 1.0333333333333334, 1.2972972972972974, 1.6666666666666667, 1.0514018691588785, 1.0122853109824872, 1.0046521684025318, 1.0390625, 1.0235051941213078, 1.0012511886291977, 5.0, 1.0071620564118267, 1.0385714285714285, 1.0, 1.3333333333333333, 1.042603550295858, 1.112959908197662, 1.0829492538735455, 1.015527950310559, 1.0, 1.084033613445378, 1.2361963190184049, 2.0, 1.5, 1.0563484251968505, 1.058630994734595, 1.2123920618088169, 1.25, 1.0141943450803004, 1.0735863671572425, 1.0857461024498887, 1.1428571428571428, 1.0441176470588236, 1.0031125841170816, 1.4473684210526316, 1.0564349621472815, 1.0471790080831878, 1.056470588235294, 1.0158730158730158, 1.001199784866162, 1.1699402220324508, 1.0743801652892562, 1.2777777777777777, 1.0639061000087269, 1.0176748817525516, 1.063927396030717, 1.5904761904761904, 1.2142857142857142, 1.1940298507462686, 1.0469973890339426, 1.0453004622496147, 1.0070563401517816, 1.0168461391071086, 1.0480349344978166, 3.0, 1.25, 1.0240246137732392, 1.16622691292876, 1.4240420151721456, 1.0018751114308022, 1.0388024753303229, 1.1177220569485762, 1.1473922902494331, 1.0212765957446808, 1.038194727821758, 1.0192208912905016, 1.0447849145550971, 1.1065891472868217, 2.5, 1.1333333333333333, 1.0298616970541838, 1.0618876941457587, 1.0303288437429683, 1.0214629908211121, 1.1356534090909092, 1.6, 1.0325693606755126, 1.0119294721571253, 1.0493488690884167, 1.0912863070539418, 1.0106386783006722, 1.236220472440945, 1.4290220820189274, 1.1078260869565217, 1.0044177629061006, 1.0478080620975567, 1.130184331797235, 1.085787451984635, 1.03125, 1.0246891962878655, 1.0118865917395126, 1.0501981505944518, 1.0428869934573357, 1.029209621993127, 1.0584467574059246, 1.3846153846153846, 1.029723991507431, 2.5, 1.5, 1.4166666666666667, 1.030690537084399, 1.1642969984202212, 1.04374466188867, 1.047906741185276, 1.2119402985074628, 1.0700836820083681, 1.0706521739130435, 1.3877551020408163, 1.0292849871120064, 1.6, 1.25, 1.0682926829268293, 1.0, 1.107669616519174, 1.132404181184669, 1.0276701216764308, 1.0264806609209394, 1.25, 1.2447013487475915, 1.3275193798449612, 1.1935162094763092, 1.0002615434735727, 1.0574098798397864, 1.040256501603135, 1.0246009577015163, 1.1350922193721753, 1.084260731319555, 1.6136363636363635, 1.276536312849162, 1.0, 1.0, 1.0007555166124245, 1.6666666666666667, 1.5714285714285714, 1.4210526315789473, 1.0361881785283473, 1.0681818181818181, 1.0464037122969838, 1.0911815068493151, 1.0, 1.2948479205462446, 1.023311416616856, 1.1838565022421526, 1.04, 1.25, 1.0218832891246685, 1.024390243902439, 1.079664570230608, 1.0550390479732243, 1.008945576456469, 1.1075930521091812, 1.0186803253992167, 1.0, 1.0630537440971441, 1.0113737207189704, 1.026856169296987, 1.2695652173913043, 1.0699814890991362]
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.6000	median: 1.0577	mean: 1.1495

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 15.827094 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=naru', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[1.7285347e-06 2.4437904e-06 2.3841858e-07 1.0728836e-06 2.3841858e-07]
Distance score: 1.144409225162235e-06
SAUCE Drift detection: False
Detection latency: 0.0233s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 2.036161 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 5.0000	99th: 2.5007	95th: 1.7500	median: 1.0648	mean: 1.1647
ReportEsts: [1.0929577464788733, 1.0350440877232647, 1.0421517286415753, 1.0247524752475248, 1.0, 2.0, 1.1603881562577756, 1.002903801781048, 1.4, 1.0344062153163152, 1.0195438946625452, 1.0013107295672425, 1.054024255788313, 1.0575396825396826, 1.003206997084548, 1.005952380952381, 1.0938511326860842, 1.5, 1.2, 1.2311557788944723, 1.1212527042340579, 1.0039557214406483, 1.0, 1.125233644859813, 1.0298062326993482, 1.0013790585327491, 2.0, 1.0890024123740598, 1.75, 1.8, 1.061273336524653, 1.0, 1.0050953662140194, 1.0146899347028557, 1.2873941674506115, 1.0521739130434782, 1.0282532073875652, 1.0549199084668193, 1.125, 1.0549859050215298, 1.027798933739528, 1.0136551157891902, 1.0822249093107619, 1.0117744309361076, 1.0577617328519855, 1.0441434579594, 1.3, 1.0667779632721202, 1.1126126126126126, 1.0870535714285714, 1.2727272727272727, 1.0035087719298246, 1.1031390134529149, 1.0303030303030303, 1.0344103970430427, 1.0597919567532148, 1.0292572077829854, 1.0864745011086474, 1.144578313253012, 1.0139485165035718, 1.0298507462686568, 1.0282775447157326, 1.0772532188841202, 1.0648854961832062, 1.1553398058252426, 1.6666666666666667, 1.1721294934993802, 1.006568144499179, 1.1428571428571428, 1.0, 1.1296539640823478, 1.0198609731876862, 1.0673076923076923, 1.1290944123314066, 1.0340168611714464, 1.2901960784313726, 1.045064029826552, 1.1869158878504673, 1.0567375886524824, 1.0207582713023757, 1.198840579710145, 1.5, 1.0, 1.6666666666666667, 1.01270207852194, 1.0526315789473684, 1.1944894651539708, 1.1, 1.0, 1.0131652795817898, 1.0935920430458177, 1.0330608537693007, 1.0273145780051152, 1.239024953789279, 1.0182291666666667, 1.3569739952718676, 1.2431372549019608, 1.2836787564766838, 1.0666666666666667, 1.137485311398355, 1.21875, 1.5, 1.0670161738069883, 1.0842600513259195, 1.014903129657228, 1.0019750611679392, 1.1219512195121952, 1.0035517558403595, 1.0771612288640153, 1.001195722728981, 1.0387767969735182, 1.0275590551181102, 1.1428571428571428, 1.0, 1.1677943166441136, 1.0254062831643418, 1.0555247084952804, 1.0319148936170213, 1.0059923535587647, 1.0, 1.2915678970538436, 1.1046420141620772, 1.0, 1.239819004524887, 1.4285714285714286, 1.059447983014862, 1.014671138207785, 1.1601879263740507, 1.0687022900763359, 2.0, 1.2582417582417582, 1.0, 1.4705882352941178, 1.0025692787667462, 1.0769230769230769, 1.0027906976744185, 1.0510768301465976, 1.0470107482572715, 1.5, 1.6, 1.0526315789473684, 1.0090826521344232, 1.0523504273504274, 1.045057932596153, 1.0909090909090908, 1.060687432867884, 1.0383667537281995, 3.0, 1.0215467487495191, 1.051359516616314, 1.0229007633587786, 1.0246931618936295, 1.3333333333333333, 1.0149329540837058, 1.028360049321825, 1.0132890365448506, 1.3708920187793427, 1.0, 1.144072036018009, 1.0318053824493376, 1.1054095710687568, 1.159016393442623, 1.037837837837838, 1.0535714285714286, 1.2024539877300613, 1.112482853223594, 1.2222222222222223, 1.009254828073481, 1.007936507936508, 1.0665054413542927, 1.0583264787257907, 1.6507936507936507, 1.0939364949205048, 1.0070422535211268, 1.092526690391459, 1.22825122954124, 1.1014231964665466, 1.141348497156783, 1.0526315789473684, 1.0454785827604443, 1.035584081370056, 1.006765436327824, 1.0123456790123457, 1.0960960960960962, 1.021152433361518, 1.045841652744387, 1.034364261168385, 1.0933709025208638, 1.2090395480225988, 2.0, 1.0723192019950125, 1.0301820653145903, 1.0769230769230769, 1.0155763239875388, 1.0504858470637939, 1.00477900702052, 1.0108637167875831, 1.0318275154004106, 1.0078326013331578, 1.0569192861634895, 1.085360459973463, 1.2141119221411192, 1.1272630457933972, 1.0065100981783015, 1.17911227154047, 1.1013265840460813, 1.0046948356807512, 1.1126760563380282, 1.03125, 2.0, 1.0441988950276244, 1.0074906367041199, 1.7653958944281525, 1.0380952380952382, 1.028738025822574, 1.2105263157894737, 1.0030649465271984, 1.0636363636363637, 1.0309630666611767, 2.25, 1.0559796437659033, 1.0760806916426513, 1.044827792752321, 1.0401058611666616, 1.0, 1.0675605982465188, 1.0037818015127207, 1.1020437850025457, 1.0159574468085106, 1.3448275862068966, 1.1078066914498141, 1.0628859646286657, 1.0603448275862069, 1.0014044158747903, 1.034272512920666, 1.1083916083916083, 1.1269035532994924, 1.0033594624860023, 1.6666666666666667, 1.0728692257644763, 2.0, 1.0093625498007968, 1.0999438517686693, 1.0586281024037523, 1.5129032258064516, 1.0769230769230769, 2.5, 1.1088007242673363, 1.2222222222222223, 1.1149576220604034, 1.75, 1.021469465648855, 1.0100908173562058, 1.1428571428571428, 1.0043412370157547, 1.1057471264367815, 1.1395348837209303, 1.0612244897959184, 1.0063784549964565, 1.0355786762123012, 1.0142857142857142, 2.0, 1.031439139206456, 1.217729927843317, 1.0547550432276658, 1.0187115364092347, 1.05357067175249, 1.032113391157182, 1.0962176509621766, 1.0221939558752577, 1.0852674066599395, 1.112888659527803, 1.2178464606181456, 1.8181818181818181, 1.0701462965557267, 1.0547703180212014, 1.2884615384615385, 1.2222222222222223, 1.0119735755573906, 1.0141921397379912, 1.004132160110421, 1.0230882250052473, 1.1626794258373205, 1.207070707070707, 1.009538381564687, 1.0013898540653232, 1.0488996883708799, 1.0069476939805964, 1.7, 1.2839506172839505, 1.0670322973796467, 1.087460866699621, 1.1083725987676694, 1.0403268506990655, 1.080020920502092, 1.0235822571588995, 1.0097046114613586, 1.0321901956658952, 1.0519179202403819, 1.089008900890089, 1.0977295162882528, 1.3333333333333333, 1.0714285714285714, 1.077457956015524, 1.4, 1.0217391304347827, 1.0191768795025677, 1.034637326813366, 1.1081081081081081, 1.2622950819672132, 1.0617283950617284, 1.1420708634330925, 1.0136232262936982, 1.0454545454545454, 1.1446871628910464, 1.009489591527788, 1.0368550368550369, 2.0, 3.0, 1.0925581395348838, 1.8571428571428572, 1.0222828425045953, 1.0657492354740061, 1.2916666666666667, 1.0510795597748466, 1.0833333333333333, 1.8, 1.0212876950862373, 3.0, 1.1362916006339143, 1.0828182941903586, 1.1393187371245148, 1.11605415860735, 1.0278372591006424, 1.0521739130434782, 1.0059621454672987, 1.008048906820784, 1.1291512915129152, 1.023193638160099, 1.1438056035055106, 1.5, 1.3333333333333333, 1.0158808405343231, 1.25, 1.040109389243391, 1.1111111111111112, 1.1, 1.1666666666666667, 1.1446360153256705, 1.0829346092503986, 1.2605042016806722, 1.157996146435453, 1.2179487179487178, 2.25, 1.0672726900197378, 1.2835820895522387, 1.0634920634920635, 1.0262647965381875, 1.2230483271375465, 1.0486274509803921, 1.0009191176470589, 2.25, 1.0, 1.0933512424445937, 1.0993788819875776, 1.0, 1.0112213708495583, 1.0471851204593683, 1.0510204081632653, 1.5, 1.0008210228430683, 1.0638297872340425, 1.1290322580645162, 1.5, 1.0510204081632653, 1.25, 1.1286407766990292, 1.040983606557377, 1.0328435609334485, 1.0062818089283119, 1.0337078651685394, 1.0178304446536353, 1.0353846153846153, 1.043956043956044, 1.024623803009576, 1.021581374253534, 1.1232449297971918, 1.0909090909090908, 1.004597386152087, 1.0048325788397992, 1.0917941585535467, 1.0476190476190477, 1.1951219512195121, 1.1196911196911197, 3.0, 1.8888888888888888, 1.1196581196581197, 1.1047430830039526, 1.2903225806451613, 1.0109809663250366, 1.0636685194542699, 1.0380952380952382, 1.0323030931910269, 1.1464162514373324, 1.035323297981526, 1.3611111111111112, 1.084033613445378, 1.092039800995025, 1.0, 1.0022619899785254, 1.3793103448275863, 1.0012621505538393, 1.0105708245243128, 1.0126814483968736, 1.0118279569892472, 1.5714285714285714, 1.1646825396825398, 1.0, 1.0029828486204324, 1.1818181818181819, 1.0231537499230943, 1.0180505415162455, 1.0842716711349418, 1.1286173633440515, 1.0301163586584532, 3.0, 1.0403450900786602, 1.004223470610943, 1.0817923479263623, 1.5, 1.3114754098360655, 1.0393081761006289, 1.3811764705882352, 1.0857886200837952, 1.032729842292909, 1.1304347826086956, 1.0326704545454546, 1.074548926386345, 1.1010482767201692, 1.0451882845188285, 1.1181657637877955, 1.0263371150729335, 1.5, 1.1727272727272726, 1.021777377713222, 1.6220472440944882, 1.1324422843256379, 1.0, 1.5, 1.1141552511415524, 1.1245136186770428, 1.2003412969283276, 1.04141083673195, 1.1228689006466783, 2.0, 1.180327868852459, 1.2258064516129032, 1.2236264700719677, 1.0833333333333333, 1.0, 1.1609558505082413, 1.0, 2.0, 1.1061812665908228, 2.0, 1.218648473034438, 1.0030075187969925, 1.379182156133829, 1.0, 1.0151183745339991, 1.0169354838709677, 1.0357142857142858, 1.0070872838378429, 1.0147058823529411, 1.0415300546448087, 1.1636606546426185, 1.0727462582666203, 1.1121446037301626, 1.0, 1.086021505376344, 1.000067540186411, 1.0434511758293101, 1.0941438102297998, 1.2, 1.0411490683229814, 1.014988740396016, 1.0370044052863436, 2.0, 1.1183043049622083, 1.0894971792985038, 1.085523860303919, 1.131758109731678, 1.0193096718390762, 1.046485536631522, 1.0468531468531468, 1.0189313068275132, 1.5, 1.0895863915033244, 1.0225721784776902, 1.0501453488372092, 1.0680044593088072, 1.1129476584022038, 1.0497845597509496, 1.0755555555555556, 1.0359853451906953, 1.4031385281385282, 1.0465399418741654, 1.2036727879799667, 1.0028231649427872, 1.1740112994350282, 1.072289156626506, 1.076086956521739, 1.0135707139375594, 1.0670859538784068, 1.0115126746267062, 1.003741455135358, 1.3333333333333333, 1.1968951154865581, 1.1704545454545454, 2.0, 1.2380952380952381, 1.0099722620499283, 1.0731707317073171, 1.1308446455505279, 1.0, 1.0049751243781095, 1.0335776779380468, 1.0070637976075898, 1.0310121765601217, 1.0417315809797734, 1.0039285714285715, 1.0884955752212389, 1.0787187839305103, 1.1005286741239806, 1.3333333333333333, 1.0419382590700883, 1.1144945188794153, 1.102803738317757, 1.0346106597978997, 1.111945905334335, 1.0112434541534039, 1.5, 1.1722900215362526, 1.4633333333333334, 1.1939695368355612, 1.0144329896907216, 1.12796697626419, 1.0229132569558101, 1.0386740331491713, 1.025971388829663, 1.0, 1.8867924528301887, 1.7142857142857142, 1.0, 1.0495049504950495, 2.0, 1.3240901213171576, 1.1018518518518519, 1.0212426978226234, 1.0149812734082397, 1.029521242459248, 1.0179869409880498, 1.0428795859902042, 1.0193077819709402, 1.022293972431616, 1.0630208333333333, 1.0783736004714202, 1.0111058072858445, 1.0690837824595787, 1.0407239819004526, 1.0783847980997625, 1.1144578313253013, 1.0180443092605533, 1.2153652392947103, 1.015769981283103, 1.0917874396135265, 1.1610027855153204, 1.103202846975089, 2.5, 1.0302325581395348, 1.0625, 2.3333333333333335, 1.0086206896551724, 1.016721932378721, 1.0188824662813103, 1.0984848484848484, 1.0297619047619047, 1.0078626188285802, 1.1725926431447484, 1.0552380952380953, 1.4, 2.0, 1.0890016017084891, 1.3571428571428572, 1.0024420024420024, 1.0376579203109815, 1.0, 1.0340201245807379, 1.1342925659472423, 1.0214953271028038, 1.1869436201780414, 1.007260189493749, 1.048625377373658, 1.0100393337029117, 1.1358024691358024, 1.0, 1.1245765321835541, 1.0, 1.1044776119402986, 1.1244813278008299, 1.103156274056967, 1.0656934306569343, 1.3333333333333333, 1.0362666210123836, 1.145985401459854, 1.0612244897959184, 1.0234100302263895, 1.0309079201545397, 1.0351585014409221, 1.0670020120724346, 1.0241286863270778, 1.0108196721311475, 1.2, 1.017182264474402, 1.0552176424615176, 1.25, 1.0033875338753389, 1.0825784535748948, 1.0198944988696308, 1.0699842792866048, 1.1818181818181819, 1.0786948176583493, 1.0624676802151205, 1.2045454545454546, 1.0382165605095541, 1.0104022191400832, 1.411764705882353, 2.5714285714285716, 1.0233659614777393, 1.067099567099567, 1.0446318996769688, 1.0619126589275842, 1.0460503572251671, 1.011768659540869, 1.04, 1.0162059103908485, 1.1125, 1.027981596059479, 1.0928050052137643, 1.0239752513534417, 1.1093613298337708, 1.0037631433314886, 1.6666666666666667, 1.0904921502910567, 1.3157894736842106, 1.6, 1.0074906367041199, 1.0225233473722761, 1.06575682382134, 1.1096096096096095, 1.6666666666666667, 1.0507246376811594, 1.1070551070551071, 1.5137614678899083, 1.0202838051746117, 2.3333333333333335, 1.0480308992555523, 2.5, 1.4702549575070822, 1.2222222222222223, 1.0730107840279801, 1.393939393939394, 1.1974248927038627, 1.1221837088388216, 1.0, 1.025925925925926, 1.0835308056872037, 2.25, 1.25, 1.0866666666666667, 1.0914634146341464, 1.0813550939663699, 1.002661934338953, 1.042995839112344, 1.0396825396825398, 1.1436781609195403, 1.0122581420502343, 1.530612244897959, 1.3574660633484164, 1.1818181818181819, 1.0, 1.0669045495093665, 1.2794292508917955, 1.1172607879924954, 1.2881299365891645, 1.0095600227947101, 1.2183184317676194, 1.0354345301341767, 1.0456353990836749, 1.0235063663075417, 1.0078239608801955, 1.2, 1.0, 1.024390243902439, 1.0247568121791835, 1.1606086221470837, 1.0193370165745856, 1.2845953002610966, 1.0517844646606018, 1.0481287801682284, 1.00864542231042, 1.0416666666666667, 1.173913043478261, 1.0792079207920793, 1.035799522673031, 1.0195448634590376, 1.0350631754040032, 1.1612903225806452, 1.0596573400714902, 1.0371194559097923, 1.0145771950826261, 1.0338983050847457, 1.007217133050708, 1.3504273504273505, 1.0344422700587084, 1.0941619585687383, 1.008314080919377, 2.0, 1.097424412094065, 1.0, 1.1040339702760085, 1.062073113106233, 1.34375, 1.0097664009322775, 1.2185840707964601, 1.0566037735849056, 1.0496124970949912, 1.0193929933055148, 1.1216589861751152, 1.004, 1.0338345864661653, 1.0100457692759066, 1.1487889273356402, 1.1176470588235294, 1.0, 1.1818181818181819, 1.009483348769782, 1.625, 1.0173511394048242, 1.032153767253105, 1.1143543321633105, 1.0780154592845588, 1.0017015340632556, 1.018010752688172, 1.0512820512820513, 1.019047619047619, 1.0357411116675013, 1.0084789210080056, 1.0064439226729278, 1.011444059629574, 1.2222222222222223, 1.1421800947867298, 1.3006756756756757, 1.0092745410197614, 1.083565459610028, 1.0005246589716683, 1.1352154531946508, 1.0358306188925082, 1.0795755095595878, 1.0044843049327354, 1.0115669817064044, 1.1363636363636365, 1.0281305736853452, 1.0076451966646667, 1.1047309498013724, 1.0031712473572938, 1.0769230769230769, 1.386120996441281, 1.1453976617816566, 1.058095952023988, 1.0, 1.004176803245017, 1.0769230769230769, 1.0352803396281658, 1.2054020100502512, 1.1539440203562341, 1.1008656379375235, 1.05570530098832, 1.1245318352059925, 1.0926012098650535, 1.0478047252725742, 1.0314885496183206, 1.12416719395541, 1.0607668891315194, 1.0, 1.043598615916955, 1.1939721792890263, 1.032747562183866, 1.1298922291548497, 1.201578947368421, 1.177277179236043, 1.3565292096219932, 1.0219244823386116, 1.0040928955897954, 1.25, 1.040117994100295, 1.0110946988347285, 1.036929460580913, 1.6277602523659307, 1.008353850619819, 1.0525372648041051, 1.0913333333333333, 1.0433145009416196, 1.0149884736058057, 1.0832674643626155, 1.015527950310559, 1.1798245614035088, 1.009428403064231, 1.0111137239665873, 1.0851063829787233, 2.0, 1.0214073741403147, 1.0057063326374391, 1.02020202020202, 1.3291139240506329, 1.0282815862280972, 1.0163225833082716, 1.013070342205323, 1.0364063417498532, 1.3571428571428572, 1.117081447963801, 1.7179487179487178, 1.1062176165803108, 1.6875, 1.017672610244533, 1.0179591836734694, 1.0, 1.2439024390243902, 1.0253456221198156, 1.0770416024653313, 1.03, 1.0810810810810811, 1.0135467980295567, 1.1312217194570136, 1.0148354195642095, 1.2, 1.0270121850132625, 1.2098214285714286, 1.2222536806342015, 1.0495867768595042, 1.1818181818181819, 1.10585520623017, 1.10429224034008, 1.0022218378723573, 1.1701388888888888, 1.4878048780487805, 1.105263157894737, 1.0, 1.3111111111111111, 1.1944444444444444, 1.0165247871807712, 1.0086418988531891, 1.0051347243504667, 1.018987341772152, 1.003662774138422, 1.001079621007174, 5.0, 1.02790976892787, 1.1029859841560024, 1.0, 1.2857142857142858, 1.0709376534118802, 1.1252395783421179, 1.0633376717568628, 1.0641711229946524, 1.0, 1.0161812297734627, 1.2816537467700257, 1.1111111111111112, 1.0135799976929287, 1.0779556227244624, 1.000852329809506, 1.133309883925431, 1.1111111111111112, 1.0071506356120543, 1.0818713450292399, 1.0716253443526171, 1.0424597364568082, 1.1126760563380282, 3.0, 1.2620689655172415, 1.0898283346487767, 1.1201775040753488, 3.5, 1.0166666666666666, 1.0248985083895898, 1.163236337828247, 1.0266666666666666, 1.3333333333333333, 1.0314678659795995, 1.1482720178372352, 1.0656072434979442, 1.8240740740740742, 1.268041237113402, 1.0917525773195875, 1.25, 1.0097982708933717, 1.022332506203474, 1.000394740088323, 1.088235294117647, 2.5, 1.037037037037037, 1.068425109189004, 1.1280289330922242, 1.3865397030342157, 1.0212519657522279, 1.015764806135492, 1.0992749581706638, 1.0475247524752476, 1.1132075471698113, 1.0081672655994773, 1.0093881459694245, 1.0764676862358165, 1.1455604075691412, 3.5, 1.065217391304348, 1.116412213740458, 1.234074074074074, 1.001627498209752, 1.0057743851166703, 1.1014749262536874, 2.0, 1.00682261208577, 1.0430287146107542, 1.0271192869334345, 1.1898734177215189, 1.0035755787968177, 1.1993670886075949, 1.2848629320619784, 1.075735648818138, 1.0029608147094244, 1.01883323617775, 1.1031518624641834, 1.1248654467169, 1.0263157894736843, 1.0924818453652285, 1.0666697979642092, 1.05983785391977, 1.1112097387775806, 1.0263409961685823, 1.0245954692556634, 1.0952380952380953, 1.0702702702702702, 2.5, 1.5, 1.4666666666666666, 1.0278372591006424, 1.1375905200789993, 1.05504302177492, 1.0648038839816125, 1.184341155234657, 1.0583840139009557, 1.0412844036697249, 1.2010582010582012, 1.0218890429295344, 1.3333333333333333, 1.0625, 1.124593716143012, 1.125, 1.2135135135135136, 1.0912762520193862, 1.067475299220821, 1.0168991253250481, 1.5, 1.041924213920989, 1.0338345864661653, 1.0789493603815004, 1.0006271558482283, 1.039572192513369, 1.0501501501501502, 1.029356329124481, 1.0553844696072392, 1.0862068965517242, 1.6274509803921569, 1.2551963048498844, 1.0, 2.0, 1.0003202430868454, 1.25, 1.75, 1.6097560975609757, 1.0408163265306123, 1.0103964947284, 1.0223239839725242, 1.054263565891473, 1.0, 1.0492147972928576, 1.0100050025012506, 1.011111111111111, 1.0081632653061225]
origin-bjaq_15.87 	max: 5.0000	99th: 2.5007	95th: 1.7500	median: 1.0648	mean: 1.1647

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 20.056725 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=37.952665