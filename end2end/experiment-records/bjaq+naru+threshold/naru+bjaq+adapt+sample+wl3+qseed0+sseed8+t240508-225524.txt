Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='naru', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 8, 'naru': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 5.0000	99th: 2.6667	95th: 1.5714	median: 1.0565	mean: 1.1475
ReportEsts: [1.1130742049469964, 1.0342041475895503, 1.0462402373312345, 1.0192307692307692, 1.0333333333333334, 1.0, 1.1816139413443438, 1.010530646192646, 1.25, 1.0414438502673797, 1.0081089660346867, 1.0021663496575002, 1.0406468531468531, 1.044186046511628, 1.028611797951254, 1.0, 1.4754098360655739, 1.0336521431101664, 3.0, 2.6666666666666665, 1.125, 1.1149450075479836, 1.0246979734996102, 1.0070963926670609, 1.0140070035017508, 1.0, 1.0642235364476045, 1.2, 1.4, 1.1223021582733812, 1.0, 1.006807006566013, 1.0109953988484819, 1.2758046614872365, 1.0726212980466288, 1.0242366799810438, 1.0108108108108107, 1.004953635919961, 1.082064880501412, 1.0595238095238095, 1.0743801652892562, 1.0823170731707317, 1.0, 1.1383771443066875, 1.0515193583217646, 1.1983471074380165, 1.1844660194174756, 1.0842911877394636, 1.0340550767290309, 1.0188679245283019, 1.0446387704463878, 1.1710261569416498, 1.00330708335917, 2.0, 1.2155844155844155, 1.1289843805215916, 1.112, 1.0606060606060606, 1.3167701863354038, 1.25, 1.0329652853507816, 1.044209215442092, 1.0454545454545454, 1.1379310344827587, 1.0, 1.1871517081444047, 1.0717854325532474, 1.1666666666666667, 1.0, 1.0442951713395638, 1.006002400960384, 1.059061957151129, 1.1081081081081081, 1.0800055335239325, 1.2258823529411764, 1.1637931034482758, 1.0, 1.0458515283842795, 2.0, 1.0130563287325318, 1.21875, 1.0592975823301165, 1.2392638036809815, 1.051605504587156, 1.0692549842602308, 1.0, 1.015417600154176, 1.0432185309356903, 1.1372549019607843, 2.3333333333333335, 1.1339060131379484, 1.0128202836904783, 1.0093457943925233, 1.2538569424964936, 1.2275784753363228, 1.0664819944598338, 1.25, 1.0209059233449478, 1.0, 1.0118273745034307, 1.1341972642188625, 1.0410714285714286, 1.0140991232778673, 1.0294117647058822, 1.0002640272325232, 1.0741374394069005, 1.074334031112753, 1.0508153204398938, 1.0290220820189275, 1.1666666666666667, 1.0, 1.1496105291431642, 1.0251479441134086, 1.0645595158036314, 1.0389610389610389, 1.0048631605199247, 1.0, 1.211692777990065, 1.1665071770334927, 1.0, 1.2197802197802199, 1.0, 1.1854636591478698, 1.0221006200766165, 1.1257280422458646, 1.009009009009009, 1.8, 1.1961920529801324, 1.0, 1.3214285714285714, 1.0103464845467278, 1.1818181818181819, 1.0029382957884427, 1.019192724851941, 1.0346420323325636, 1.1246246246246245, 1.0082872928176796, 1.0384459732901659, 1.00199203187251, 1.055984555984556, 1.0556197137280416, 1.2407407407407407, 1.0808871493803, 1.0058265499724586, 2.0, 1.0138632162661738, 1.0670731707317074, 1.0607940446650124, 1.0093523910358215, 1.0, 1.0252017380509, 1.0014814814814814, 1.012, 1.4476190476190476, 1.2408759124087592, 1.1060973335819504, 1.01141234462066, 1.0821083957074578, 1.1159695817490494, 1.1611842105263157, 1.0, 1.210144927536232, 1.1186161449752883, 1.2857142857142858, 1.0161608808408027, 1.0027908612674332, 1.0402993667242373, 1.0198805709292165, 1.0403176542455712, 1.0843868437094166, 1.0126315789473683, 1.0945378151260505, 1.2465382008327686, 1.1473317865429233, 1.1059160305343512, 1.033132530120482, 1.047921294827039, 1.03704298915227, 1.0846240447598254, 1.0, 1.05, 1.0440548106674525, 1.0476190476190477, 1.1019237883832778, 1.1176470588235294, 1.0316885878108637, 1.0321364808569728, 1.0177096411815238, 1.0943396226415094, 1.0054844606946984, 1.0180494237715727, 1.0, 1.6363636363636365, 1.0527187765505523, 1.3041997729852441, 1.107197549770291, 1.4, 1.0115755627009646, 1.00093003180606, 1.0268116875943587, 1.1798245614035088, 1.14419732265205, 1.2553191489361701, 1.0, 1.0238095238095237, 1.0, 1.0457516339869282, 1.0115123797508279, 1.6689895470383276, 1.1494252873563218, 1.0177953534354918, 1.0957683741648108, 1.0707943496606127, 1.0256089232870476, 1.0368903033058388, 1.1, 1.007278020378457, 1.0338358458961474, 1.0027070613984563, 1.0344803054376437, 1.0, 1.0501035196687372, 1.0690130581214425, 1.006615873762813, 1.064168086314594, 1.0204494083233613, 1.0035526983589917, 1.0344827586206897, 1.0025036394982663, 1.1626442812172089, 1.2075578116187253, 1.0607734806629834, 1.0904376685334993, 1.003104384943733, 1.079527559055118, 1.0, 1.0073251417769375, 1.0607972309066547, 1.0835661671323342, 1.5037313432835822, 1.0909090909090908, 2.6666666666666665, 1.086614727141626, 1.0909090909090908, 1.126676063464527, 2.0, 1.0, 1.3793103448275863, 1.0417642466822794, 1.6020408163265305, 1.1574585635359116, 1.143546441495778, 1.064957264957265, 1.008894536213469, 1.0305611522272538, 1.087719298245614, 1.0, 1.0154935948841322, 1.0689584191025112, 1.1330998248686515, 1.0460976623149423, 1.0640270229085182, 1.0346161677866015, 1.1089030206677266, 1.042673802440012, 1.0669856459330143, 1.0944630362032248, 1.4278449938628792, 1.8181818181818181, 1.0144628099173554, 1.004264392324094, 1.2272727272727273, 1.1904761904761905, 1.2043636363636363, 1.0555555555555556, 1.073394495412844, 1.014467397887087, 1.0345821325648414, 1.250783699059561, 1.013158981255382, 1.0075503355704698, 1.0108508755821912, 1.015360616334782, 1.5, 1.037959257911968, 1.0, 1.0154026802353768, 1.1274298056155507, 1.0063575819202828, 1.3, 1.4285714285714286, 1.0869565217391304, 1.408450704225352, 1.0152560148056755, 1.0, 1.0171073094867806, 1.0497737556561086, 1.0380608974358974, 1.000403838499464, 1.1666666666666667, 1.0314465408805031, 1.0290263324426945, 1.0936739659367396, 1.0700500663271857, 1.2136752136752136, 1.0, 1.2064439140811456, 1.0049261083743843, 1.249221183800623, 1.0697548666186012, 1.0096842105263157, 1.0619718309859154, 1.0727272727272728, 1.0164609053497942, 1.042776432606941, 1.5714285714285714, 1.0212214229366325, 1.0567765567765568, 1.0555555555555556, 1.070118156927627, 1.1904761904761905, 1.75, 1.042062146270563, 2.0, 1.01920438957476, 1.068313953488372, 1.0360951599671862, 1.0095456281023292, 1.1018276762402088, 1.1428571428571428, 1.0120672628147025, 1.004368128957598, 1.008174386920981, 1.0267147718420728, 1.1720482713633398, 2.0, 1.1111111111111112, 1.0231954544391704, 1.3333333333333333, 1.0498357064622126, 1.0, 1.0, 1.0454545454545454, 1.1759149940968123, 1.078095238095238, 1.2169811320754718, 1.0703463203463204, 1.0, 1.0246338215712383, 1.0058049847286155, 1.5, 1.266825491363907, 1.0, 1.0087907082669096, 1.1125, 1.0412227761742325, 1.1612903225806452, 1.0018181818181817, 1.195519348268839, 1.0925925925925926, 1.0061240074437088, 1.005526441774759, 1.0545938748335553, 1.0, 1.1428571428571428, 1.8333333333333333, 3.0, 1.1428571428571428, 1.0024368289076062, 1.25, 1.151414309484193, 1.0, 1.0584061826935258, 1.019857008198908, 1.008307372793354, 1.0688140556368961, 1.0298685782556751, 1.222707423580786, 1.5, 1.0278372591006424, 1.0262008733624455, 1.0031400966183575, 1.2857142857142858, 3.142857142857143, 1.0712694877505569, 1.0151162790697674, 1.020278003204528, 1.1912408759124087, 1.342769701606733, 1.056053163825484, 1.3793103448275863, 1.0808477237048666, 1.0593220338983051, 1.25, 1.055306427503737, 1.0695652173913044, 1.0499407139291064, 1.005823550241059, 1.0487962825213746, 1.4576271186440677, 1.121212121212121, 1.0623145400593472, 1.0, 1.0067253236245954, 1.0053431555867482, 1.0166403080519837, 1.0142276055319535, 1.0116657104608913, 1.0161446561188248, 1.8333333333333333, 1.0188133140376265, 1.2, 1.099060631938514, 1.1111111111111112, 1.02336209580572, 1.0217391304347827, 1.098237317282889, 1.134387351778656, 1.0997352162400706, 3.0, 1.0618973561430793, 1.0021822315292945, 1.0978710686040096, 1.0, 1.1886792452830188, 1.0422264875239924, 1.3620689655172413, 1.076076919988759, 1.0433839479392624, 1.1666666666666667, 1.0603968938740294, 1.0732231752635146, 1.0731215706767199, 1.0060813010992107, 1.136622807017544, 1.1907131011608623, 1.0602409638554218, 1.25, 1.00253807106599, 1.3448275862068966, 1.044338335607094, 1.064516129032258, 1.0659724426947743, 1.1363636363636365, 1.1218403685717844, 1.0658302042311567, 1.1335664335664335, 1.0, 1.1176470588235294, 1.24, 1.00222291552921, 1.3150984682713347, 1.0, 1.063622547665101, 1.0160691631818823, 1.2304946455889851, 1.0, 2.0, 1.1875728155339806, 1.0017953321364452, 1.3863636363636365, 1.0, 1.023929678738703, 1.0505952380952381, 1.0869565217391304, 1.1584934086629002, 1.0272727272727273, 1.0144356955380578, 1.1725806451612903, 1.070677324358435, 1.0615349291085472, 1.0, 1.0675675675675675, 1.1230491422675093, 1.0228284905747909, 1.0434532617426966, 1.0, 1.0048899755501222, 1.0118841157513538, 1.0282870612886328, 2.0, 1.1283891547049443, 1.0539758015159362, 1.0718523193436416, 1.1195229566205058, 1.0169312403272164, 1.216076058772688, 1.0134453781512605, 1.017357762777242, 1.5, 1.0637759057315623, 1.0, 1.0, 1.304054054054054, 1.1304347826086956, 1.0420794336713644, 1.1438289601554907, 1.1036183267389186, 1.1372651356993737, 1.0641120735033738, 1.0526173407277155, 1.01007316481154, 1.0970873786407767, 4.0, 1.036240547353259, 1.0188259109311741, 1.0065954487413353, 1.0295796127027363, 1.0913621262458473, 1.2007692307692308, 1.1358695652173914, 1.4285714285714286, 1.027427928209618, 1.0157654897329338, 1.0025015287119907, 1.1156238565678742, 1.03175747929671, 1.0309278350515463, 1.0146137787056368, 1.0382955771305287, 1.0933147632311977, 2.0, 1.1666666666666667, 1.0432, 1.0580524344569289, 1.0084602368866329, 1.02937576499388, 1.2085308056872037, 1.2838709677419355, 1.0554699537750385, 1.0934065934065933, 1.033561293216995, 1.4125, 1.0049206963249517, 1.0, 1.0364854802680565, 1.5317460317460319, 1.099290780141844, 1.0428196912321586, 1.1105710814094776, 1.0099800399201597, 1.0118110236220472, 1.097941204407295, 1.0, 1.9787234042553192, 1.5, 1.0, 1.0731707317073171, 1.0161290322580645, 1.3787234042553191, 1.0957446808510638, 1.0293175264338352, 1.1136950904392764, 1.0747661950601213, 1.000345218720718, 1.0980392156862746, 1.0022542875188263, 1.1349693251533743, 1.0805626598465474, 1.1678761490082246, 1.095496473141617, 1.1719653179190752, 1.044225352112676, 1.0245054773895437, 1.1297820079828063, 1.0071759887639122, 2.0, 1.0516795865633075, 1.0323475046210722, 1.0555555555555556, 1.0, 1.1590909090909092, 1.1538461538461537, 1.1322645290581161, 1.6296296296296295, 1.5, 1.033024461485331, 1.038688466323085, 1.0038024780775499, 1.0433104968895188, 1.0810810810810811, 1.040097205346294, 2.0, 1.1755725190839694, 1.127274140880112, 1.0030106037192945, 1.0072611094975312, 1.0028558373315055, 1.009047023064545, 1.0845070422535212, 1.0199236570151755, 1.2007104795737122, 1.0368858891853712, 1.0650238144543385, 1.4242424242424243, 1.1229050279329609, 1.0, 1.0090702947845804, 1.0202470592317567, 3.0, 1.053414882772681, 1.0610396459608815, 1.1428571428571428, 1.1558479410417621, 1.1, 1.1875, 1.018016997167139, 1.7692307692307692, 1.0109040262429674, 1.0064075181546348, 1.2258064516129032, 1.2608695652173914, 1.2630208333333333, 1.0096571704490584, 1.1005830903790088, 1.018948066032052, 1.0115445700481802, 1.0, 1.173962633065392, 1.0121951219512195, 2.0, 1.0971469428235348, 1.0034115471757077, 1.1125827814569536, 1.0106018436590036, 1.0151298531770205, 1.3614457831325302, 2.142857142857143, 1.0524914416127806, 1.054421768707483, 1.07776627695858, 1.043695797198132, 1.038758796373675, 1.0765342852000719, 1.0520231213872833, 1.0251716247139588, 1.1865079365079365, 1.0093909250728799, 1.0624605678233439, 1.0108695652173914, 1.1932773109243697, 1.0520779459848, 4.0, 1.0033688129194631, 1.0366000680068832, 1.0194009949502794, 1.0555555555555556, 1.0446830117510517, 1.231818181818182, 1.0, 1.037581878727998, 1.0134426229508198, 1.0840236686390532, 1.1764705882352942, 1.6666666666666667, 1.0517877034747924, 1.5, 1.3806451612903226, 1.1538461538461537, 1.1549787174656339, 1.2857142857142858, 1.2606382978723405, 1.1058700209643606, 1.0, 1.1917989417989419, 1.0913633119200572, 1.75, 1.0, 1.0991735537190082, 1.0622710622710623, 1.090665873959572, 1.0127523910733263, 1.0389610389610389, 1.0694006309148265, 1.089150378938971, 1.0467532467532468, 1.6554054054054055, 1.2009803921568627, 1.2692307692307692, 1.0, 1.1412169919632607, 1.2106782106782106, 1.0987514188422247, 1.1433309642264866, 1.0138574141899448, 1.2496769858907437, 1.0032683129279933, 1.0626512503361119, 1.016847172081829, 1.005966587112172, 1.375, 1.0, 1.0, 1.0466741862201534, 1.1765316718587746, 1.0065359477124183, 1.0437017994858613, 1.079495990836197, 1.0771514208311719, 1.007289968156289, 1.0512820512820513, 1.1, 1.0325684678016285, 1.0807926829268293, 1.0486136754057829, 1.0244121651092402, 1.1710526315789473, 1.037359716479622, 1.0136620947007982, 1.2318611987381702, 1.0071794871794872, 1.2222222222222223, 1.0369850187265917, 1.256011315417256, 1.0384615384615385, 1.0699708454810495, 1.0347890451517394, 1.0, 1.0330188679245282, 1.0625311452873958, 1.1481481481481481, 1.0292790103407925, 1.1705508474576272, 1.1395348837209303, 1.064030337173942, 1.0134462869502523, 1.0879666935267258, 1.0019120458891013, 1.006810442678774, 1.013807484220018, 1.1991434689507494, 1.0, 1.0, 1.1111111111111112, 1.014944895240402, 1.8333333333333333, 1.0338912133891214, 1.0671477034085401, 1.1174124944616748, 1.0758547008547008, 1.0045008787429928, 1.0256162915326903, 1.0772200772200773, 1.0140646976090013, 1.0038556366966445, 1.0454211377333529, 1.0029240466888767, 1.0197820065036733, 1.25, 1.032258064516129, 1.3359683794466404, 1.01665110214438, 1.0390879478827362, 1.041044776119403, 1.184070796460177, 1.037037037037037, 1.0656873506309503, 1.0304287690179805, 1.0210047846889951, 1.375, 1.0193502459228578, 1.0052972239235876, 1.1675103543488266, 1.0008428150021071, 1.0625, 1.0074946466809422, 1.1243781094527363, 1.5625, 1.038109916284283, 1.5769230769230769, 1.17396449704142, 1.0175824175824175, 1.1274443695212408, 1.0430277485072006, 1.0858823529411765, 1.5454545454545454, 1.087378640776699, 1.0189529026802455, 1.004778545669722, 1.0066811655061327, 1.1061467641483889, 1.0481398937082118, 1.0, 1.0540765391014975, 1.1495620929710308, 1.0813205946694049, 1.0101214574898785, 1.1944444444444444, 1.0467201510146296, 1.075943031350958, 1.1532663316582914, 1.008161685810276, 1.0, 1.3333333333333333, 1.001720685307424, 1.0083711691259931, 1.0117747639218124, 1.0351277722354386, 1.0574620909816441, 1.0739856801909309, 1.018698682122404, 1.1000431363440288, 1.0149253731343284, 1.2702702702702702, 1.0113314447592068, 1.001055318313454, 1.0119047619047619, 1.75, 1.0438268940211526, 1.0070552147239265, 1.0011415525114156, 1.2394366197183098, 1.0036337209302326, 1.004512149976601, 1.0235971223021583, 1.0309278350515463, 1.3461538461538463, 1.0485175202156334, 1.0, 1.090625, 1.4333333333333333, 1.0552240473795955, 1.0128840436075321, 1.0874661857529306, 1.2058823529411764, 1.0562543886046745, 1.0256107171000788, 1.0129156920573579, 1.0446927374301676, 1.6666666666666667, 1.12, 1.3333333333333333, 1.0504939626783754, 1.4230769230769231, 1.3333333333333333, 1.5, 1.2905982905982907, 1.0181159420289856, 1.110843373493976, 1.003232844425334, 1.0784313725490196, 1.4411764705882353, 1.0, 1.1290322580645162, 1.2972972972972974, 1.1666666666666667, 1.0467289719626167, 1.0151320721584731, 1.0000556596597339, 1.046875, 1.0226776909241364, 1.0015764976727892, 5.0, 1.0080211629410363, 1.062857142857143, 1.0, 1.3333333333333333, 1.0236686390532543, 1.0940256759664349, 1.0405397358486073, 1.0062111801242235, 1.0, 1.1168831168831168, 1.303680981595092, 2.0, 1.5, 1.0883366141732282, 1.0605930995152553, 1.1767387148948685, 1.25, 1.0051047385941516, 1.0704879938032532, 1.1271676300578035, 1.1428571428571428, 1.0597014925373134, 1.0041781231722813, 1.5526315789473684, 1.1142701590950335, 1.0976965000425785, 1.0023584905660377, 1.015625, 1.02099173553719, 1.1989752348420153, 1.1198347107438016, 1.3269230769230769, 1.030453892316795, 1.0154109589041096, 1.038274436798422, 1.1928571428571428, 1.2142857142857142, 1.1940298507462686, 1.0308483290488433, 1.0344617261360172, 1.0003994128630913, 1.0093964360988694, 1.0491266375545851, 3.0, 1.25, 1.0885115858325796, 1.1596306068601583, 1.3108344680023343, 1.0260216962897204, 1.0555276802140827, 1.0752248569092395, 1.0952380952380953, 1.125, 1.047426924660354, 1.002358077703294, 1.0176782557454331, 1.0385288966725044, 2.5, 1.1066666666666667, 1.0128764811621849, 1.0604540023894862, 1.0327356499605302, 1.008234210484524, 1.1022727272727273, 1.6, 1.01301775147929, 1.0955274730585223, 1.0303861092072195, 1.0874524714828897, 1.0263791541505745, 1.193916349809886, 1.3017241379310345, 1.0857971014492753, 1.0038359817271754, 1.0331811263318114, 1.086405529953917, 1.115236875800256, 1.03125, 1.1452494873547505, 1.0124953720844132, 1.0554821664464993, 1.0084286158416527, 1.0558166862514688, 1.0409448818897638, 1.3846153846153846, 1.0233545647558386, 2.5, 1.5, 1.4166666666666667, 1.0383631713554988, 1.1579778830963665, 1.0040641312453393, 1.0576383737130657, 1.044776119402985, 1.044560669456067, 1.108695652173913, 1.3265306122448979, 1.017421279511262, 1.6, 1.3333333333333333, 1.0208130081300812, 1.0, 1.0682788051209104, 1.1027629665535628, 1.027579990986931, 1.0156384411874504, 1.0, 1.047001620745543, 1.3488372093023255, 1.0807980049875312, 1.0000183494655719, 1.03125, 1.0533910533910533, 1.0160259580950874, 1.0290111837005869, 1.1192368839427662, 1.3396226415094339, 1.229050279329609, 1.0, 1.0, 1.0008270448124172, 1.6666666666666667, 1.5714285714285714, 1.4210526315789473, 1.0193003618817853, 1.1058823529411765, 1.0332187857961055, 1.086067319982957, 1.0, 1.2582247051520794, 1.0300842358604092, 1.1031390134529149, 1.0585241730279897, 1.25, 1.0748231653404068, 1.0238359201773837, 1.0887949260042282, 1.040535515061361, 1.0048688433005495, 1.2404401956425077, 1.0826128722382324, 1.0, 1.0032256695386443, 1.0145610930534186, 1.0270355093256816, 1.2695652173913043, 1.0168677014753231]
origin-bjaq_15.87 	max: 5.0000	99th: 2.6667	95th: 1.5714	median: 1.0565	mean: 1.1475

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 16.481578 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=naru', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[3.5762787e-07 5.9604645e-08 0.0000000e+00 2.3841858e-07 4.1723251e-07]
Distance score: 2.1457671550706436e-07
SAUCE Drift detection: False
Detection latency: 0.0233s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 2.048241 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 5.0000	99th: 3.0000	95th: 1.7143	median: 1.0653	mean: 1.1665
ReportEsts: [1.2375, 1.058541047335925, 1.0529675266170069, 1.0544554455445545, 1.1176470588235294, 1.0, 1.1891298800714467, 1.012902480213836, 1.0, 1.045912653975364, 1.0508952454394294, 1.0025722078719677, 1.0359738372093024, 1.0704225352112675, 1.0554577464788732, 1.1262939958592133, 1.0798722044728435, 1.0, 1.4444444444444444, 1.1226937269372694, 1.123373941771629, 1.105179568625442, 1.2361111111111112, 1.1088372093023255, 1.0326950608446672, 1.0133883034189612, 2.0, 1.0772810091100211, 1.6, 1.3333333333333333, 1.0768175582990398, 2.0, 1.0008565506739608, 1.0050977125648748, 1.2816251154201292, 1.0531599948513322, 1.03767181401663, 1.0634920634920635, 2.0, 1.1811680572109655, 1.0548135781858654, 1.0246445633891905, 1.1211031175059951, 1.0413825377724295, 1.0035906642728905, 1.096624913013222, 1.0909090909090908, 1.2537313432835822, 1.5705521472392638, 1.0711692084241105, 1.0, 1.0485074626865671, 1.116591928251121, 1.0588235294117647, 1.050705735215294, 1.0697484148087544, 1.0506434205064341, 1.044543429844098, 1.1204819277108433, 1.0200308166409862, 1.1147540983606556, 1.0781515838071218, 1.0495049504950495, 1.0151515151515151, 1.1272727272727272, 1.6, 1.178457984406584, 1.0495601802188372, 1.0, 2.0, 1.1075993091537133, 1.0100806451612903, 1.0424300867888139, 1.1539961013645224, 1.1266886458668381, 1.0929853181076672, 1.007690032534753, 1.030701754385965, 1.0780141843971631, 1.0469133679211933, 1.156840934371524, 1.25, 1.0, 1.0, 1.0341578327444052, 1.11864406779661, 1.1131025957972807, 1.1111111111111112, 1.2, 1.0548498937512982, 1.0842036553524803, 1.0143680709534368, 1.011671335200747, 1.2314857405703772, 1.0158311345646438, 1.310657596371882, 1.1635071090047393, 1.136774193548387, 1.2, 1.1397934868943607, 1.4642857142857142, 3.0, 1.0488332394920057, 1.0991452991452992, 1.0021629416005768, 1.0108654156755645, 1.1904761904761905, 1.0228414298808433, 1.0793841712773635, 1.0377255143610284, 1.034244423499843, 1.0219149491260109, 1.3333333333333333, 2.0, 1.1028744326777609, 1.00349390170889, 1.0545050055617353, 1.1294117647058823, 1.0081149954229447, 1.0, 1.1693821088226253, 1.1127098321342925, 2.0, 1.2971698113207548, 1.0, 1.0466101694915255, 1.015160848229417, 1.08277738195479, 1.0551181102362204, 1.6666666666666667, 1.1749654218533887, 1.0, 2.0, 1.001385425325575, 1.3076923076923077, 1.0753180661577608, 1.0631188992120428, 1.0767128088312599, 1.0, 1.4, 1.0368098159509203, 1.137573297248534, 1.0544580886278698, 1.030713230210268, 1.2487046632124352, 1.0359634997316156, 1.018322849853851, 3.0, 1.0176855055747789, 1.0869565217391304, 1.0348539210661198, 1.044414932861148, 1.0, 1.1046184738955824, 1.04625, 1.010016694490818, 1.0046296296296295, 2.0, 1.1406328478151682, 1.0376070757016504, 1.1113747645951035, 1.1939102564102564, 1.1416666666666666, 1.0545454545454545, 1.1479289940828403, 1.1192787794729542, 1.0, 1.00126122226617, 1.5555555555555556, 1.0840236686390532, 1.0110204981265154, 1.0257378174330816, 1.0556118180617322, 1.0471014492753623, 1.136602451838879, 1.1554571083366896, 1.0109546165884193, 1.1615575807787903, 1.0752136752136752, 1.0579748864547154, 1.0630698295466399, 1.0060789625237292, 1.0123456790123457, 1.1198501872659177, 1.0054313232636258, 1.0268612780571569, 1.0294117647058822, 1.0201726618705036, 1.180281690140845, 4.0, 1.08, 1.0479319012797075, 1.1923076923076923, 1.0368639667705088, 1.232268275793847, 1.0157514739682223, 1.0162424948472086, 1.0040816326530613, 1.0545897255657897, 1.0810149391840065, 1.0708938793483047, 1.0924499229583975, 1.0858990944372575, 1.0111547614550673, 1.1707571801566579, 1.1973591549295775, 1.2600896860986548, 1.1066666666666667, 1.0490196078431373, 1.0, 1.0273224043715847, 1.0788815789473685, 1.5875706214689265, 1.0857142857142856, 1.0093877551020407, 1.3333333333333333, 1.0078540707452235, 1.0247191011235954, 1.0128106688219842, 1.25, 1.1062416998671978, 1.0298133184731122, 1.0454860695922517, 1.0443543567472808, 2.3333333333333335, 1.118421052631579, 1.0573650788441658, 1.0148658059677507, 1.0, 1.226537216828479, 1.047751249305941, 1.0604400914977932, 1.0603448275862069, 1.0035973065603696, 1.0747957583759695, 1.1473684210526316, 1.2106598984771573, 1.0709134615384615, 1.6923076923076923, 1.1351706036745406, 1.0, 1.0082954769899268, 1.099025069637883, 1.0042859925969219, 1.1455108359133126, 1.1538461538461537, 3.3333333333333335, 1.090735714809653, 1.0869565217391304, 1.100628745166337, 1.75, 1.0227602905569007, 1.151006711409396, 1.4285714285714286, 1.0165205797192922, 1.1027397260273972, 1.1136363636363635, 1.0735405610310842, 1.0188477951635846, 1.0258050997711228, 1.088235294117647, 2.0, 1.0081493119701652, 1.0859674192626465, 1.0533910533910533, 1.0791231536362782, 1.097132304557322, 1.0430624055649, 1.113864701942398, 1.0236103774138638, 1.0683760683760684, 1.0444632905258058, 1.307391948296755, 1.7692307692307692, 1.0714342996912467, 1.0333333333333334, 1.346938775510204, 1.0344827586206897, 1.0415785764622973, 1.251548946716233, 1.0177339986087615, 1.0042304166960445, 1.1243781094527363, 1.2315521628498727, 1.025870230300856, 1.0336435218324982, 1.029912294573455, 1.0014881413734305, 1.5, 1.1397849462365592, 1.0294648226097414, 1.0238987924094307, 1.0088559670781894, 1.0319696384922166, 1.0471945464079706, 1.010567296996663, 1.0240011395199773, 1.0621795334729545, 1.023751916221857, 1.0009987646857834, 1.1195542046605877, 1.3333333333333333, 1.0714285714285714, 1.0850515463917525, 2.4, 1.0634328358208955, 1.0189725837433616, 1.0101658640984483, 1.1081081081081081, 1.2857142857142858, 1.5, 1.0550729673384294, 1.0052496829756417, 1.0, 1.0792291220556745, 1.0012597929215385, 1.2771084337349397, 2.3333333333333335, 3.125, 1.057039384336804, 1.0909090909090908, 1.020973721868089, 1.0532724505327244, 1.1304347826086956, 1.0322436552996908, 1.2272727272727273, 1.8, 1.045539211355538, 2.0, 1.1488833746898264, 1.0477326968973748, 1.054635761589404, 1.0970149253731343, 1.0176600441501105, 1.2358490566037736, 1.0337083718518185, 1.0004124129538232, 1.1888888888888889, 1.0248915021699565, 1.1402406770695583, 3.0, 1.0833333333333333, 1.0331218199320276, 1.0, 1.0415335463258786, 1.0526315789473684, 1.4, 1.0740740740740742, 1.2355371900826446, 1.091779728651237, 1.25, 1.0607966457023061, 1.2666666666666666, 2.25, 1.0238811069354288, 1.391304347826087, 1.171875, 1.0228261195596748, 1.1756272401433692, 1.075425790754258, 1.0111317254174397, 2.25, 1.5, 1.185663082437276, 1.1949685534591195, 1.0184824902723735, 1.0106959706959706, 1.0838876570583889, 1.0049627791563276, 1.5, 1.0037370234126417, 1.2266666666666666, 1.2, 1.0, 1.1637426900584795, 1.4285714285714286, 1.12, 1.0423728813559323, 1.0205674370472577, 1.002337077997248, 1.120836560805577, 1.0378048115214664, 1.0432833730214315, 1.16, 1.0480769230769231, 1.0441874596483234, 1.0341246290801187, 1.1176470588235294, 1.008540942218835, 1.016687794448754, 1.1299559471365639, 1.055, 1.1162790697674418, 1.0526315789473684, 3.0, 1.8148148148148149, 1.2912621359223302, 1.083495145631068, 1.7058823529411764, 1.2102272727272727, 1.0359640359640359, 1.05276225946617, 1.2013151822796493, 1.1369390103567318, 1.0628768303186908, 1.2911392405063291, 1.112, 1.0195121951219512, 1.0, 1.006060122001138, 1.2982456140350878, 1.0066332797883397, 1.0253137341435539, 1.0108357899768943, 1.0168719871451526, 1.7142857142857142, 1.1262729124236253, 1.0, 1.1818181818181819, 1.3, 1.058555367318651, 1.010688836104513, 1.0464556397681677, 1.1830508474576271, 1.1748031496062992, 3.0, 1.013550135501355, 1.0061181168027091, 1.0081274319998466, 1.0, 1.0294117647058822, 1.0215482841181165, 1.4879227053140096, 1.0839668862983611, 1.0501748348781705, 1.16, 1.2059248554913296, 1.0958054640120123, 1.0778969990500367, 1.0281860092387474, 1.0891535780780064, 1.0497219496238142, 1.1804511278195489, 1.1933583288698446, 1.02155494005703, 1.3358778625954197, 1.1525316455696202, 1.0, 1.5, 1.1890482398956974, 1.0574712643678161, 1.2172599059771658, 1.0126457451128257, 1.1400233372228705, 2.0, 1.0725806451612903, 1.2903225806451613, 1.0181694034573494, 1.173913043478261, 1.0, 1.0400311242819065, 1.0, 1.0, 1.095613048368954, 2.3333333333333335, 1.1613316261203586, 1.0022505626406601, 1.419607843137255, 1.0, 1.0193602462282558, 1.00703125, 1.0357142857142858, 1.0849500847617253, 1.0465116279069768, 1.0451541850220265, 1.1412391738840773, 1.0197912918315941, 1.1571387394312067, 1.0, 1.0444444444444445, 1.1187754311180005, 1.0054176072234764, 1.1310975609756098, 1.2, 1.0225352112676056, 1.0177807486631016, 1.0212581344902387, 2.0, 1.1050903119868638, 1.0419921491658488, 1.0908432377324069, 1.1387171842047852, 1.0354318894507044, 1.0374167422220657, 1.0323691460055096, 1.0597851549427748, 1.75, 1.074023126853802, 1.1102077687443541, 1.0592376790483127, 1.080135440180587, 1.0619946091644206, 1.0430530856461946, 1.0222222222222221, 1.0861465894332587, 1.2621686746987952, 1.0557661286332103, 1.0928270042194093, 1.0228464885021753, 1.2301903830235532, 1.1529411764705881, 1.2098765432098766, 1.010846206997103, 1.0706860706860706, 1.0284209669100681, 1.002904511831201, 1.0, 1.0631379962192817, 1.1293103448275863, 1.3636363636363635, 1.4615384615384615, 1.0041568284819133, 1.0761245674740485, 1.080327868852459, 1.0, 1.0408163265306123, 1.0454008039725704, 1.077773695811903, 1.0323940962238836, 1.0235181844327659, 1.0422065901517956, 1.0246823069403714, 1.1124721603563474, 1.1152425470711298, 1.2481751824817517, 1.0281807169037709, 1.0054100227790432, 1.102803738317757, 1.0576485656096246, 1.2120754716981132, 1.0536479236767071, 1.0, 1.144611186903138, 1.542483660130719, 1.060624302838223, 1.0144329896907216, 1.0870841487279843, 1.0272572402044293, 1.0543831168831168, 1.0021671795988243, 1.0, 1.6491228070175439, 1.7142857142857142, 1.3333333333333333, 1.0947368421052632, 1.0866141732283465, 1.4221824686940967, 1.08675799086758, 1.0259274032708416, 1.0243097238895558, 1.0254585976341506, 1.020902769205448, 1.0393401362405275, 1.0126637319077505, 1.0395024080281037, 1.0968783638320776, 1.0180858515109066, 1.0175937951375824, 1.083984375, 1.028921023359288, 1.1064356435643565, 1.373015873015873, 1.0350558715559321, 1.2318125770653514, 1.0127487500249, 1.107843137254902, 1.1319989180416554, 1.0583390528483185, 1.25, 1.0833333333333333, 1.0625, 1.6666666666666667, 1.4502923976608186, 1.0083023210629363, 1.0157996146435453, 1.0761421319796953, 1.0166666666666666, 1.0175716321038468, 1.1890509435266468, 1.001834862385321, 1.2, 2.0, 1.0049880604934995, 1.400921658986175, 1.0093992644053944, 1.022994011976048, 1.0, 1.1455902939804012, 1.0652680652680653, 1.0172612379494785, 1.2175226586102719, 1.0011977840994162, 1.0063537996980372, 1.021223487325974, 1.1645569620253164, 2.0, 1.133037922506183, 1.0, 1.1216730038022813, 1.112033195020747, 1.1044083526682134, 1.0656219392752204, 1.4827586206896552, 1.001857585139319, 1.1111111111111112, 1.0684647302904564, 1.0583657587548638, 1.0965473145780051, 1.0437912417516497, 1.0637240282334228, 1.0053956834532374, 1.00718719372754, 1.2, 1.0612925529751496, 1.1212932156806017, 1.0833333333333333, 1.0579514824797844, 1.086693059707522, 1.1764705882352942, 1.070805105058929, 1.0, 1.1363636363636365, 1.067260345730749, 1.134703196347032, 1.1721854304635762, 1.0093801356874974, 1.1403508771929824, 2.0, 1.0695322376738305, 1.0484891075193254, 1.0574865365315844, 1.0627777777777778, 1.0148994049850526, 1.0254098452005482, 1.2009132420091324, 1.004346476249612, 1.1401273885350318, 1.0073197961481148, 1.0909090909090908, 1.0120937263794407, 1.141530296329058, 1.1322764129250877, 1.5263157894736843, 1.118063112078346, 1.2380952380952381, 1.0, 1.0087173100871731, 1.011231884057971, 1.0450339296730413, 1.114864864864865, 1.6666666666666667, 1.0585874799357946, 1.1113061797752808, 1.391304347826087, 1.0260289194587449, 2.0, 1.0105451464080595, 2.0, 1.485632183908046, 1.0, 1.0524928300356327, 1.2424242424242424, 1.275109170305677, 1.0837651122625216, 1.0, 1.048954829408938, 1.032076533483399, 1.8, 1.0, 1.0680272108843538, 1.0308641975308641, 1.0463215258855585, 1.0675067506750675, 1.1025641025641026, 1.2666666666666666, 1.1284916201117319, 1.24609375, 1.639344262295082, 1.3696682464454977, 1.3333333333333333, 2.0, 1.0296943231441047, 1.2927710843373494, 1.0796296296296297, 1.236211160090313, 1.0158273523538368, 1.2282687009959736, 1.0187711205939667, 1.0002707336882952, 1.0603621730382293, 1.0303951367781155, 1.5555555555555556, 1.5, 1.0512820512820513, 1.0342094775149127, 1.1118367346938776, 1.0307262569832403, 1.2330827067669172, 1.079216084226549, 1.0304281503400659, 1.0048666620946458, 1.0879120879120878, 1.0434782608695652, 1.0512333965844403, 1.1071507029876977, 1.05729440822772, 1.1046036622292692, 1.2923976608187135, 1.0117226061204343, 1.0280214831370718, 1.015095450975654, 1.0150375939849625, 1.0116655454869217, 1.3556485355648535, 1.0308404009252121, 1.311965811965812, 1.0128157083883556, 1.6666666666666667, 1.0051347881899872, 1.0, 1.1083333333333334, 1.0190533714034702, 1.3174603174603174, 1.0339519927598335, 1.1219723183391004, 1.0344827586206897, 1.0293149079742208, 1.0073385665734307, 1.12074216894403, 1.0070422535211268, 1.0588235294117647, 1.020154565314416, 1.1580756013745706, 1.125, 1.0, 1.2, 1.003492832626691, 1.8571428571428572, 1.0121065375302662, 1.064477705861201, 1.1530406026088553, 1.0674476393326233, 1.0152773128611488, 1.054839864018608, 1.0788643533123028, 1.0139049826187718, 1.0161320643872636, 1.0276358243652177, 1.0031365623276889, 1.026748558535974, 1.2222222222222223, 1.0498533724340176, 1.3476821192052981, 1.0349565568801777, 1.1201117318435754, 1.008524240809803, 1.1595900439238653, 1.0098522167487685, 1.0359201382319927, 1.0548424737456243, 1.0098680239810083, 1.1904761904761905, 1.0009850188917802, 1.0023423808801004, 1.0435229609321452, 1.008078679311556, 1.1428571428571428, 1.0587482674059068, 1.1300546448087432, 1.0785309890255848, 1.2292609351432882, 1.0052608645345846, 1.0526315789473684, 1.0885348855020296, 1.1763224181360201, 1.1186868686868687, 1.0526315789473684, 1.0968609865470853, 1.1237209302325581, 1.0983992467043315, 1.047990730664746, 1.0333969465648856, 1.0255716878402903, 1.0383620842336438, 1.1176470588235294, 1.042320819112628, 1.095, 1.0701332750710073, 1.0482185273159146, 1.2688900468994269, 1.2119675456389452, 1.1029900332225913, 1.0072639225181599, 1.0286482945538737, 1.5, 1.0138010350776308, 1.0100272873721932, 1.0290006259127895, 1.4976671850699845, 1.0178371572467824, 1.078505856283634, 1.062753036437247, 1.0152380952380953, 1.0023306375899725, 1.0769857433808554, 1.0371517027863777, 1.244343891402715, 1.0285544318857822, 1.029270481688101, 1.0408163265306123, 2.0, 1.0322379940803683, 1.0071352699395002, 1.0348722986247545, 1.1864406779661016, 1.0509286998202516, 1.0180611955803192, 1.0282770189312245, 1.0222222222222221, 1.0571428571428572, 1.0896708286038592, 1.3636363636363635, 1.1451187335092348, 1.7, 1.0371181480998266, 1.0049792531120332, 1.1472727272727272, 1.205128205128205, 1.0918065153010859, 1.020358700920989, 1.0, 1.027027027027027, 1.0018259281801583, 1.1711711711711712, 1.0706521739130435, 1.4, 1.018052481821056, 1.1401869158878504, 1.2287294384571752, 1.1441441441441442, 2.25, 1.0943728018757326, 1.1392583141123163, 1.0091297954818874, 1.1391752577319587, 1.4878048780487805, 1.0, 1.03125, 1.451219512195122, 1.5686274509803921, 1.013663967611336, 1.0104469504867457, 1.0026544199503227, 1.0460526315789473, 1.0121647711417001, 1.0011216512040029, 5.0, 1.0000047467603361, 1.0106162012462496, 1.0, 1.1428571428571428, 1.0653192013803303, 1.147214459837089, 1.0397763943085798, 1.056555269922879, 1.0, 1.0921501706484642, 1.0471204188481675, 1.0, 1.0295293820508502, 1.0505553270259154, 1.0131629612132704, 1.1159051474840949, 1.1, 1.0066209722418862, 1.0818598559266537, 1.1114341085271318, 1.0, 1.0955188679245282, 2.0, 1.0725513905683193, 1.0920061074718022, 1.103963577932512, 1.0048780487804878, 1.0524590163934426, 1.0262456946039036, 1.172796668979875, 1.129692832764505, 1.1408450704225352, 1.0537637500898698, 1.0921133075198697, 1.0572321172740802, 1.3741496598639455, 1.1153846153846154, 1.0516332982086407, 1.1111111111111112, 1.0543093270365997, 1.0953608247422681, 1.010826104297537, 1.0656192236598891, 1.5, 1.062082514734774, 1.0230737704918034, 1.1294806144842722, 1.3737242831686376, 1.0218627022299955, 1.0785020804438281, 1.102497635478334, 1.005586592178771, 1.0166666666666666, 1.0337709843882683, 1.0453164708600375, 1.0457002457002458, 1.254360465116279, 3.0, 1.1954022988505748, 1.126708785930688, 1.3105497771173849, 1.0083657006274276, 1.0207011072532637, 1.0868794326241136, 1.8, 1.0038572806171648, 1.0717749948352697, 1.0535849056603774, 1.02803738317757, 1.0027037927789313, 1.2755102040816326, 1.3235294117647058, 1.0842105263157895, 1.0044511828296763, 1.0099453819189697, 1.0948275862068966, 1.1431718061674008, 1.0512820512820513, 1.0054660325122453, 1.0920137379358317, 1.0733503399223394, 1.0314934708657961, 1.0524017467248907, 1.0438768827766862, 1.1304347826086956, 1.0331588132635252, 3.5, 1.5, 1.4666666666666666, 1.0083507306889352, 1.1251612903225807, 1.0020130071229483, 1.0349202134525246, 1.110958904109589, 1.038134827399241, 1.0086206896551724, 1.0107120352867045, 1.0163672630991534, 1.8, 1.2, 1.1785132935431362, 1.1111111111111112, 1.1917989417989419, 1.114519427402863, 1.0472850500433446, 1.0130166951794275, 1.5, 1.1958709677419355, 1.1253481894150419, 1.0763277491490615, 1.0009607177441888, 1.1081703107019563, 1.0295770482105886, 1.0462606275561288, 1.0370318678762502, 1.1121495327102804, 1.459016393442623, 1.2359154929577465, 1.0, 3.0, 1.000953889147648, 1.75, 1.4444444444444444, 1.4042553191489362, 1.0184804928131417, 1.0041440238015726, 1.0552616108171664, 1.0038910505836576, 1.1666666666666667, 1.0419580419580419, 1.0074183976261128, 1.6382978723404256, 1.02680412371134]
origin-bjaq_15.87 	max: 5.0000	99th: 3.0000	95th: 1.7143	median: 1.0653	mean: 1.1665

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 20.681898 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=39.243804