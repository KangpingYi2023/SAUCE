Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='naru', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 25, 'naru': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.5714	median: 1.0568	mean: 1.1498
ReportEsts: [1.0285714285714285, 1.0625345877144439, 1.0438938935159665, 1.0115384615384615, 1.0344827586206897, 1.0, 1.2463174074548482, 1.0075918683655631, 1.25, 1.0456375838926175, 1.032753296972845, 1.0018755143587301, 1.0987540378403322, 1.036144578313253, 1.0226068527022254, 1.0, 1.3636363636363635, 1.0134608572440666, 3.0, 2.6666666666666665, 1.2272727272727273, 1.0986413629501832, 1.0383808466000246, 1.0703959773727216, 1.0084577114427862, 1.0, 1.105622864243554, 2.0, 1.4, 1.2374100719424461, 1.0, 1.0041563712628745, 1.0073753752275971, 1.3562708102108767, 1.0231404958677686, 1.0264030871301875, 1.0106951871657754, 1.0007867323895783, 1.057166471520077, 1.2738095238095237, 1.1271676300578035, 1.0853658536585367, 1.0, 1.1692613340281397, 1.036557149467839, 1.2148760330578512, 1.1067961165048543, 1.2577777777777779, 1.0325660283887437, 1.0485436893203883, 1.0611765556117656, 1.0121739130434784, 1.007925082019408, 2.0, 1.2285714285714286, 1.0615687992988607, 1.0283636363636364, 1.0727969348659003, 1.2857142857142858, 1.25, 1.0380543438749545, 1.0392278953922789, 1.0363636363636364, 1.1379310344827587, 1.1, 1.1226333460247135, 1.0464698331193838, 1.1666666666666667, 1.0, 1.0996412096360841, 1.0596658711217184, 1.0566146735990756, 1.1036036036036037, 1.078612876485217, 1.1976470588235295, 1.1111111111111112, 1.0, 1.048598949211909, 2.0, 1.0776779821515683, 1.3125, 1.0618918859017266, 1.2331288343558282, 1.0389908256880733, 1.0783068783068783, 1.04, 1.0010117800101177, 1.0598479030939583, 1.1372549019607843, 2.3333333333333335, 1.0741981809478218, 1.0101543653670189, 1.0222929936305734, 1.3071528751753156, 1.198030634573304, 1.0968660968660968, 1.2857142857142858, 1.0008539709649873, 1.0, 1.0094577553593946, 1.1684665226781858, 1.0248713550600344, 1.0022230847948057, 1.0294117647058822, 1.0089305634550785, 1.072302875035582, 1.0720354636128555, 1.080773606370876, 1.0296717171717171, 1.1666666666666667, 1.3333333333333333, 1.118954248366013, 1.0066178800298444, 1.040078843626807, 1.0, 1.0058726077584927, 1.0, 1.2568370986920332, 1.1425837320574164, 1.0, 1.2582417582417582, 1.1666666666666667, 1.0401002506265664, 1.0007180579186226, 1.086899122466413, 1.0666666666666667, 1.8, 1.2740066225165563, 1.0, 1.2857142857142858, 1.0022185643741501, 1.1818181818181819, 1.0185676392572944, 1.0216923009288625, 1.040968570380335, 1.1813880126182965, 1.042857142857143, 1.0255795363709033, 1.00199203187251, 1.055984555984556, 1.0594258295380612, 1.3395061728395061, 1.0378343118069147, 1.0683490651896923, 2.0, 1.0185701021355618, 1.05294825511432, 1.0576923076923077, 1.0298217751896948, 1.0, 1.0303181534622583, 1.04, 1.024, 1.4476190476190476, 1.0043988269794721, 1.1894926809705233, 1.001112464904381, 1.1042925421588963, 1.1596958174904943, 1.1611842105263157, 1.0204081632653061, 1.2246376811594204, 1.1241721854304636, 1.2857142857142858, 1.0160175779384135, 1.0001601488621805, 1.001727115716753, 1.063320932351378, 1.0232131948686622, 1.1315629058333996, 1.0442105263157895, 1.0546218487394958, 1.1745908782802363, 1.1238636363636363, 1.0682027649769585, 1.0478615071283095, 1.039018250471995, 1.0640174780493836, 1.079614914425428, 1.0, 1.1150442477876106, 1.063165791447862, 1.0476190476190477, 1.0876803551609322, 1.0410958904109588, 1.026033950442758, 1.0213338458581587, 1.0065147284808347, 1.0740740740740742, 1.0286363636363636, 1.0299753454503755, 1.0, 1.7272727272727273, 1.058790856654561, 1.3200908059023837, 1.1445910290237467, 1.5217391304347827, 1.0186495176848875, 1.0017397660066194, 1.0124528758612343, 1.1798245614035088, 1.1044587330030569, 1.0925925925925926, 1.140625, 1.0476190476190477, 1.0, 1.0596026490066226, 1.0346740638002774, 1.651567944250871, 1.2298850574712643, 1.018783984181908, 1.0957683741648108, 1.0787897830185191, 1.0270408890155294, 1.055919984412548, 1.1812080536912752, 1.0613496932515338, 1.0514480408858604, 1.0100091906485151, 1.0514606633243349, 1.0, 1.034368530020704, 1.026411675496819, 1.0118076474175801, 1.0665907797381902, 1.092996097866644, 1.0024107596007443, 1.0344827586206897, 1.000519728735131, 1.0836942853150762, 1.1816130851663846, 1.0434782608695652, 1.054552997303464, 1.0077369439071566, 1.1078740157480316, 1.0, 1.014413988657845, 1.06146717284502, 1.0112517580872011, 1.455223880597015, 1.0909090909090908, 2.6666666666666665, 1.0731081057315208, 1.1454545454545455, 1.0807793648592428, 2.0, 1.5, 1.2121212121212122, 1.0526932084309133, 1.4591836734693877, 1.1215469613259668, 1.0934256055363323, 1.064957264957265, 1.0192554557124518, 1.019589245272062, 1.087719298245614, 1.0, 1.0194101494539585, 1.0977768629065459, 1.1085814360770578, 1.01659724583475, 1.0679382333519583, 1.0035882411034664, 1.1001589825119238, 1.0239952115205182, 1.0604066985645932, 1.060427413411938, 1.2470137825421133, 1.7272727272727273, 1.0810710167211224, 1.0788912579957357, 1.2727272727272727, 1.1904761904761905, 1.1330909090909091, 1.0555555555555556, 1.0934579439252337, 1.0106991454141714, 1.0375722543352601, 1.1875, 1.0080220180040609, 1.0748422001803426, 1.0058504205924175, 1.001464431816373, 1.5, 1.0515823935976718, 1.2, 1.0272639323238915, 1.0129589632829374, 1.0155432160575304, 1.3, 1.4285714285714286, 1.0434782608695652, 1.5211267605633803, 1.007480823502764, 1.0, 1.0275229357798166, 1.0, 1.0376602564102564, 1.0009709245876477, 1.0988372093023255, 1.0251572327044025, 1.0152053157080578, 1.0419566570474736, 1.0766382502368035, 1.170940170940171, 1.0, 1.201670644391408, 1.0172413793103448, 1.1557632398753894, 1.0290420459471175, 1.03719723183391, 1.1163522012578617, 1.18, 1.0233196159122084, 1.0733868734422598, 1.5714285714285714, 1.0166318064832165, 1.0567765567765568, 1.1875, 1.0690694204721645, 1.1904761904761905, 1.75, 1.0322598941540395, 2.0, 1.0150891632373114, 1.0755813953488371, 1.0131255127153405, 1.0169230769230768, 1.195822454308094, 1.1538461538461537, 1.0241345256294052, 1.04506543982214, 1.0068119891008174, 1.0361336255968463, 1.1085917013728213, 2.0, 1.1111111111111112, 1.0433217300081064, 1.3333333333333333, 1.0498357064622126, 1.0, 1.0, 1.0454545454545454, 1.1541135573580532, 1.0884615384615384, 1.2772277227722773, 1.024891774891775, 1.0, 1.0579227696404794, 1.0226178010471205, 1.5, 1.0792138177486599, 1.0, 1.0168830182949973, 1.1265822784810127, 1.0283127787982156, 1.1682027649769586, 1.0018181818181817, 1.1834677419354838, 1.0740740740740742, 1.0367253134103505, 1.0100928268952696, 1.0292942743009321, 1.0, 1.1428571428571428, 1.8333333333333333, 1.5, 1.1428571428571428, 1.0013551876067772, 1.25, 1.1497504159733778, 1.030612244897959, 1.0331422288541585, 1.018807711423265, 1.0185375901132854, 1.0562154630897842, 1.0292537313432837, 1.215629522431259, 1.5, 1.0389610389610389, 1.0681818181818181, 1.0048430213272455, 1.4285714285714286, 3.6666666666666665, 1.0757238307349666, 1.0244186046511627, 1.0056677753810708, 1.1808972503617945, 1.342769701606733, 1.0365853658536586, 1.2698412698412698, 1.0808477237048666, 1.0656779661016949, 1.1923076923076923, 1.0568862275449102, 1.0789473684210527, 1.0344313448206957, 1.002266227221965, 1.0290387670115486, 1.2285714285714286, 1.018348623853211, 1.0498533724340176, 1.0, 1.0370058767391632, 1.012038749404466, 1.021215195581107, 1.0051539927019941, 1.0151426907396621, 1.0154888673765732, 1.8333333333333333, 1.3835021707670043, 1.2, 1.116994022203245, 1.1111111111111112, 1.0155589640598965, 1.0391304347826087, 1.0828675838349098, 1.1422924901185771, 1.087260034904014, 3.0, 1.0628891656288917, 1.006240578100301, 1.0896404267059039, 1.0, 1.2115384615384615, 1.034548944337812, 1.2040229885057472, 1.1124299647229716, 1.205513784461153, 1.2352941176470589, 1.1302847282139776, 1.126416902330147, 1.0576126311074614, 1.0042155473611025, 1.124890350877193, 1.2686567164179106, 1.0602409638554218, 1.25, 1.0507614213197969, 1.3448275862068966, 1.038881309686221, 1.1818181818181819, 1.0190276631320507, 1.1363636363636365, 1.1182895798423633, 1.0378105548520573, 1.152096659559346, 1.0, 1.0857142857142856, 1.28, 1.0025356947803699, 1.1444201312910285, 1.0, 1.1941834760983696, 1.0027956585067894, 1.2374358974358974, 1.0, 2.0, 1.1972815533980583, 1.0017953321364452, 1.4805825242718447, 1.0, 1.007157464212679, 1.007554296506138, 1.0869565217391304, 1.0775517890772128, 1.0272727272727273, 1.047244094488189, 1.1370967741935485, 1.0597391670172487, 1.0995924458986281, 1.0, 1.054054054054054, 1.1049893034555278, 1.0167859959484744, 1.053456488706015, 1.0, 1.0317206754906436, 1.014347613227247, 1.0288108957569408, 2.0, 1.0925039872408293, 1.0455840120521633, 1.0842031344760445, 1.1900747018478879, 1.02832626853392, 1.1862739587431848, 1.0235294117647058, 1.0503925044315017, 2.0, 1.0507519768463487, 1.3703703703703705, 1.25, 1.3687943262411348, 1.1063829787234043, 1.0435160782471797, 1.0729261622607111, 1.0613185006785557, 1.1721355567509413, 1.0235440328649843, 1.066278912484783, 1.0207069130922246, 1.1262135922330097, 4.0, 1.0295906853919097, 1.0068825910931174, 1.0078536571444878, 1.0161229990120946, 1.0794085432639648, 1.2016936104695919, 1.077319587628866, 1.4285714285714286, 1.0104180760384252, 1.0007693680032113, 1.0107482163321133, 1.1193098384728342, 1.0505684839583702, 1.0144329896907216, 1.0030973925409332, 1.0114566284779052, 1.0857538035961272, 2.0, 1.0, 1.00920245398773, 1.0482374768089053, 1.0067114093959733, 1.025609756097561, 1.0450819672131149, 1.0756756756756756, 1.0554699537750385, 1.098901098901099, 1.019187467742027, 1.4675324675324675, 1.0301054802125467, 1.0, 1.1658291457286432, 1.3253968253968254, 1.049645390070922, 1.005586592178771, 1.1482412060301508, 1.017786561264822, 1.0532786885245902, 1.0491308890577509, 1.0, 1.851063829787234, 1.1666666666666667, 1.0, 1.0602409638554218, 1.1670588235294117, 1.35, 1.138121546961326, 1.0291573213713554, 1.2402877697841728, 1.0356788051111645, 1.0022729518727147, 1.091795288383428, 1.0333698507954667, 1.088235294117647, 1.0549313358302121, 1.1030478955007257, 1.1108665749656121, 1.0447976878612717, 1.03115438108484, 1.0093606138107416, 1.031675641431739, 1.009831576711084, 2.0, 1.0442260442260443, 1.0351201478743068, 1.027027027027027, 1.0, 1.0196078431372548, 1.1538461538461537, 1.2046908315565032, 1.5555555555555556, 1.5, 1.0252858753422451, 1.0347965167940287, 1.0110711606611655, 1.0264177254415867, 1.145945945945946, 1.037667071688943, 2.0, 1.1666666666666667, 1.22883295194508, 1.008059765436727, 1.0074643125166434, 1.0259710673197402, 1.0015400042976863, 1.135693215339233, 1.0157550310183083, 1.2273534635879217, 1.035658302660149, 1.0031344716579755, 1.393939393939394, 1.1031833150384194, 1.0, 1.0090702947845804, 1.022109050457998, 3.0, 1.0405708460754333, 1.0049298527559398, 1.2857142857142858, 1.1869842220036773, 1.2, 1.1875, 1.0018518649912374, 1.7692307692307692, 1.0002779691333405, 1.022212729602734, 1.1875, 1.3181818181818181, 1.3857142857142857, 1.0038406144983196, 1.113295650036864, 1.041018564977421, 1.0124769563707285, 1.0, 1.178036063436889, 1.0091463414634145, 2.0, 1.0816707798048757, 1.0089627130374599, 1.1002838221381268, 1.0158347186556014, 1.034786906436528, 1.3614457831325302, 2.0, 1.0123219098960339, 1.0954063604240283, 1.012281424988835, 1.0483655770513676, 1.0546254084802518, 1.1240584430837652, 1.2527472527472527, 1.009009009009009, 1.099264705882353, 1.0208013441039678, 1.0902208201892745, 1.0605187319884726, 1.1880252100840336, 1.053340229139456, 4.0, 1.0181286703020134, 1.0114211029005178, 1.0364284742071594, 1.1176470588235294, 1.0682391336596944, 1.173160173160173, 1.0, 1.0204052254651457, 1.0134426229508198, 1.0983213429256595, 1.1176470588235294, 1.6666666666666667, 1.0205218676782328, 1.0, 1.3851132686084142, 1.1538461538461537, 1.1191473030493335, 1.2857142857142858, 1.253968253968254, 1.09853249475891, 1.0, 1.306878306878307, 1.1284132841328414, 2.0, 1.0, 1.1083333333333334, 1.0545454545454545, 1.0642092746730083, 1.006335797254488, 1.0543657331136738, 1.0210843373493976, 1.089150378938971, 1.051948051948052, 1.5408805031446542, 1.3243243243243243, 1.4615384615384615, 1.0, 1.0631016042780748, 1.2395382395382395, 1.0072840790842872, 1.1640135069946937, 1.0023633332358362, 1.207249488242049, 1.0274434529985474, 1.043486119144014, 1.125150421179302, 1.0184964200477327, 1.2222222222222223, 1.0, 1.0, 1.0092986917491344, 1.1140609636184857, 1.0065359477124183, 1.2807570977917981, 1.0900343642611683, 1.0669883095193913, 1.0005337774361602, 1.0512820512820513, 1.1578947368421053, 1.0377498149518876, 1.1121420996818663, 1.029117494130808, 1.051520638655018, 1.1842105263157894, 1.0521264028352038, 1.0092945835804619, 1.1368267831149927, 1.0347734457323499, 1.2222222222222223, 1.0443187175860442, 1.0608108108108107, 1.0196078431372548, 1.3201438848920863, 1.0347890451517394, 1.0, 1.0554216867469879, 1.0606356884337638, 1.1851851851851851, 1.0125420149440203, 1.173728813559322, 1.0, 1.036722034432208, 1.0018745493871666, 1.1243284985226967, 1.0155038759689923, 1.0192962542565267, 1.0146246618575292, 1.1740041928721174, 1.1428571428571428, 1.0, 1.1111111111111112, 1.019934600944653, 1.8333333333333333, 1.0419809773696294, 1.057482095740671, 1.0948161276030128, 1.0952795301283447, 1.0035561203201457, 1.145230439442658, 1.0772200772200773, 1.0041782729805013, 1.0127221922182825, 1.0187242219722534, 1.005675526687918, 1.018396964952427, 1.25, 1.0491803278688525, 1.1976284584980237, 1.0210228278180853, 1.019543973941368, 1.0458654906284455, 1.1415929203539823, 1.0350877192982457, 1.0459181724414564, 1.0094850948509486, 1.0029545454545454, 1.3125, 1.012278492928247, 1.0109420781671605, 1.1255545696539486, 1.0008428150021071, 1.03125, 1.0235546038543897, 1.1343283582089552, 1.5625, 1.0282056619483764, 1.3076923076923077, 1.0090725806451613, 1.0681318681318681, 1.1422791638570464, 1.0379238028661306, 1.0847058823529412, 1.2222222222222223, 1.0275229357798166, 1.0179234530681276, 1.0162620145563643, 1.0114419213863806, 1.0735873850197108, 1.0339153595738384, 1.0, 1.0342857142857143, 1.332032266458496, 1.103151926425287, 1.0225409836065573, 1.2083333333333333, 1.0680793507664563, 1.04351279788173, 1.179948586118252, 1.009244585314316, 1.0, 1.6666666666666667, 1.0215876783109594, 1.0092303322919625, 1.0146531566640686, 1.1127954461081548, 1.0407023144453311, 1.0922330097087378, 1.0052931957299582, 1.1252842741251146, 1.0149253731343284, 1.2756756756756757, 1.0091036414565826, 1.0058778775830757, 1.0119047619047619, 1.75, 1.030470589488712, 1.0147379069081304, 1.0045610034207526, 1.2307692307692308, 1.0651701665459812, 1.0233102555162623, 1.015995429877178, 1.0375, 1.2307692307692308, 1.0774932614555257, 1.039387308533917, 1.1125, 1.6538461538461537, 1.0276343725555928, 1.0237859266600595, 1.082585278276481, 1.1714285714285715, 1.042077105694319, 1.0589910496338486, 1.0081992104464015, 1.0489248987223434, 1.3333333333333333, 1.037037037037037, 1.3333333333333333, 1.0323624595469256, 1.5384615384615385, 1.3333333333333333, 1.5, 1.2862010221465077, 1.1017964071856288, 1.0736386824886326, 1.0363078243361445, 1.0721247563352827, 1.6176470588235294, 1.0, 1.1071428571428572, 1.2567567567567568, 1.3461538461538463, 1.0420560747663552, 1.0114174371720146, 1.0033692596936021, 1.0390625, 1.0013951293572148, 1.0010910364846604, 5.0, 1.0048314109761491, 1.0357142857142858, 1.0, 1.3333333333333333, 1.0322485207100591, 1.1651007674101699, 1.0407898341014923, 1.015527950310559, 1.0, 1.032, 1.2361963190184049, 2.0, 1.5, 1.110236220472441, 1.0189541605054442, 1.116801562936087, 1.25, 1.011760058649652, 1.0658404337722696, 1.1662679425837321, 1.1428571428571428, 1.13903743315508, 1.0000907556923988, 1.105263157894737, 1.1130581908272403, 1.1269671271201258, 1.0442260442260443, 1.0158730158730158, 1.0154407713498623, 1.1451750640478224, 1.1115702479338843, 1.1896551724137931, 1.0483622698621538, 1.1275686112260377, 1.073435058674911, 1.5045045045045045, 1.2289156626506024, 1.2238805970149254, 1.0415584415584416, 1.0319440219044722, 1.0024514218246583, 1.0138723893466182, 1.0851528384279476, 3.0, 1.25, 1.0075681942610544, 1.096306068601583, 1.4736432600661349, 1.0177746134052812, 1.012878407760495, 1.0881257757550682, 1.1519274376417235, 1.0, 1.0040091187799702, 1.0370446467095396, 1.0618738951090159, 1.0017543859649123, 2.5, 1.1866666666666668, 1.0108655343766224, 1.0599761051373955, 1.0009212128782439, 1.0101753436863543, 1.1221590909090908, 1.6, 1.0154211150652432, 1.0009603496997528, 1.046835732236692, 1.0038022813688212, 1.0003039622371621, 1.2265625, 1.3522388059701493, 1.0881159420289854, 1.0021821435195792, 1.058923159208415, 1.1209677419354838, 1.1395646606914211, 1.0, 1.0815105946684893, 1.025282939288141, 1.0779392338177014, 1.0258281094782995, 1.0233485193621867, 1.048374306106265, 1.2857142857142858, 1.1146496815286624, 2.5, 1.5, 1.4166666666666667, 1.0281329923273657, 1.1374407582938388, 1.0095598710354652, 1.053872296694282, 1.1440976933514246, 1.0801255230125524, 1.0706521739130435, 1.6734693877551021, 1.0143590035506158, 1.6, 1.25, 1.0441426146010186, 1.0, 1.060734463276836, 1.1352295409181636, 1.0604776926543489, 1.0092434792488354, 1.25, 1.0766666666666667, 1.3449612403100775, 1.1910224438902743, 1.0009182989430379, 1.0232558139534884, 1.0432297249017506, 1.024560073420853, 1.026623950508175, 1.124006359300477, 1.42, 1.2360335195530727, 1.0, 1.0, 1.0007376345624261, 1.6666666666666667, 1.5714285714285714, 1.4210526315789473, 1.002412545235223, 1.1325301204819278, 1.025, 1.112129144851658, 1.0, 1.2054624456859093, 1.0178359096313911, 1.188340807174888, 1.0297029702970297, 1.25, 1.004775124930594, 1.1579822616407982, 1.0706860706860706, 1.0223131275567126, 1.005260661043164, 1.2374140607673543, 1.0371165644171778, 1.0, 1.0251550505269549, 1.0106175730811442, 1.0005383097075184, 1.2695652173913043, 1.0217694266903743]
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.5714	median: 1.0568	mean: 1.1498

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 17.117930 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=naru', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[2.9802322e-07 1.1920929e-07 0.0000000e+00 0.0000000e+00 5.9604645e-08]
Distance score: 9.536743306171047e-08
SAUCE Drift detection: False
Detection latency: 0.0235s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 2.037904 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 4.5000	99th: 3.0000	95th: 1.7000	median: 1.0631	mean: 1.1649
ReportEsts: [1.119047619047619, 1.0419596280335677, 1.0455253089960228, 1.0449251247920133, 1.0588235294117647, 1.0, 1.174926966858064, 1.011296029057697, 1.4, 1.0308710033076074, 1.018892963999614, 1.0026306090148946, 1.0120268836222144, 1.0326923076923078, 1.008536944362673, 1.5454545454545454, 1.1155115511551155, 1.375, 1.3, 1.26215644820296, 1.1394516063024351, 1.062079407806191, 1.0394962793360045, 1.0869955156950672, 1.0264869971302781, 1.0119929443259676, 2.0, 1.0705944650372063, 1.0, 1.8, 1.0447916666666666, 1.0, 1.0074833870228763, 1.0097752512372844, 1.3221352968246665, 1.1184497816593886, 1.0208350954354506, 1.004566210045662, 2.0, 1.1933962264150944, 1.0895447219983885, 1.0149839943696506, 1.0351473922902494, 1.003040745996351, 1.0347349177330896, 1.1015351184634796, 1.2380952380952381, 1.2727272727272727, 1.5232558139534884, 1.0375260597637248, 1.1333333333333333, 1.141304347826087, 1.1076233183856503, 1.064516129032258, 1.0347856056284466, 1.0107210082658156, 1.0064102564102564, 1.01131221719457, 1.1204819277108433, 1.003947556987697, 1.0298507462686568, 1.0135523898651693, 1.0508241758241759, 1.0115830115830116, 1.1057692307692308, 1.3333333333333333, 1.0798329011812158, 1.0057412343653886, 1.0, 1.0, 1.04603810614114, 1.020730503455084, 1.0337674867342017, 1.094972067039106, 1.102581254426694, 1.1666666666666667, 1.1914893617021276, 1.040909090909091, 1.049645390070922, 1.025719345257615, 1.1514812744550027, 1.263157894736842, 1.0, 1.1111111111111112, 1.0705741626794258, 1.1016949152542372, 1.5714285714285714, 1.3, 2.0, 1.0131934560458014, 1.0830478055147659, 1.0205743108712004, 1.0044368075502668, 1.2475880506799955, 1.0292553191489362, 1.3006993006993006, 1.7843137254901962, 1.4254498714652957, 2.0, 1.1507120253164558, 1.1515151515151516, 1.0, 1.055151924375422, 1.0664079344545063, 1.0348406226834692, 1.0118299335863377, 1.0232558139534884, 1.0061151503242287, 1.0909090909090908, 1.1079797772767643, 1.0753688261706222, 1.0296510102335346, 1.0, 3.0, 1.1413261888814468, 1.0212614117995178, 1.0599104143337066, 1.0823529411764705, 1.0087516839686188, 2.0, 1.14796846573681, 1.1518784972022382, 2.5, 1.1990950226244343, 1.1428571428571428, 1.044776119402985, 1.017869136413447, 1.1026336173508908, 1.064516129032258, 2.4, 1.1878453038674033, 1.0, 1.5, 1.0120347047299187, 1.2307692307692308, 1.1608695652173913, 1.053443378655243, 1.1328490837358505, 3.0, 1.6, 1.008230452674897, 1.0084632516703786, 1.0496264674493063, 1.0449342252404286, 1.086021505376344, 1.0107933081489477, 1.0667617011166548, 3.0, 1.0275514163756305, 1.0353287536800786, 1.0650026001040043, 1.0518104209596704, 1.0, 1.0369089984748348, 1.0386533665835411, 1.0461538461538462, 1.0388349514563107, 2.0, 1.1779918864097363, 1.0286023286851673, 1.001838304258113, 1.1305732484076434, 1.2077562326869806, 1.1132075471698113, 1.1124260355029585, 1.106412005457026, 1.0, 1.0086179547566707, 1.0294117647058822, 1.107311320754717, 1.000997414346249, 1.0634737449509521, 1.0719752920639183, 1.0140845070422535, 1.1146384479717812, 1.2034485537023607, 1.0687022900763359, 1.1525144270403958, 1.0378469301934399, 1.071217414673475, 1.03632851445663, 1.00586634926033, 1.0124223602484472, 1.0, 1.0181478812071483, 1.0874236273424365, 1.0974729241877257, 1.0347245043268705, 1.1694444444444445, 2.0, 1.1158690176322419, 1.0370179764840428, 1.2962962962962963, 1.0202492211838006, 1.214114179674708, 1.0156559302906407, 1.0048465266558966, 1.0109018830525272, 1.0162517353945444, 1.0263974018845485, 1.0611448395490026, 1.0056668219220617, 1.0969400874260735, 1.0048712881643387, 1.1885117493472586, 1.1185418305795962, 1.3151515151515152, 1.0123456790123457, 1.0714285714285714, 1.0, 1.0437158469945356, 1.0515566131271068, 1.6355932203389831, 1.1682242990654206, 1.0135858377933307, 1.105263157894737, 1.0053414753499528, 1.055045871559633, 1.0321891058581707, 1.0, 1.0346534653465347, 1.04985835694051, 1.007167074892313, 1.0573671924736507, 1.7857142857142858, 1.0189125295508275, 1.075475419536168, 1.0616571089578801, 1.0159574468085106, 1.2772277227722773, 1.0061902082160945, 1.0788453960331013, 1.0423728813559323, 1.0025677237129285, 1.0055904002691183, 1.137809187279152, 1.2487352445193929, 1.024, 1.0555555555555556, 1.1002587322121604, 1.0, 1.0039635354736425, 1.001263216992608, 1.0879890986957368, 1.4431137724550898, 1.0, 3.3333333333333335, 1.0169449399105237, 1.171875, 1.1297159813480289, 1.5, 1.0351262349066959, 1.0943589743589743, 1.2857142857142858, 1.0040230973116244, 1.0976744186046512, 1.0949612403100775, 1.0535372848948374, 1.0124333925399644, 1.0041499157048372, 1.088235294117647, 2.0, 1.0064339258941957, 1.0813522604184482, 1.063768115942029, 1.0019227743886452, 1.0639966094511548, 1.032758888371371, 1.1168658698539176, 1.0208085873916677, 1.0602889885401097, 1.1595644575883854, 1.250891492613347, 1.125, 1.069431929677019, 1.2341549295774648, 1.36, 1.2592592592592593, 1.0013023916646933, 1.147147147147147, 1.0150462367251702, 1.0108680409479736, 1.072093023255814, 1.1843434343434343, 1.0169544244925768, 1.002135231316726, 1.0606469002695418, 1.012085661327211, 1.4166666666666667, 1.0541586073500968, 1.1287370347773031, 1.0203912716328065, 1.0210089789412073, 1.0273172125584884, 1.175646551724138, 1.0298759864712514, 1.0274604569420036, 1.0005790979697506, 1.0097480693758705, 1.0498100697561987, 1.0782608695652174, 1.088235294117647, 1.0666666666666667, 1.073316145665485, 2.0, 1.0035523978685612, 1.020924968862885, 1.020241327300151, 1.1666666666666667, 1.2155172413793103, 1.162079510703364, 1.0310338712537683, 1.0232362350564068, 1.0833333333333333, 1.009321533923304, 1.0168371817209638, 1.0523809523809524, 1.0714285714285714, 2.0, 1.084729981378026, 1.0909090909090908, 1.0200192455234653, 1.1015873015873017, 1.0454545454545454, 1.0470856297568774, 1.3043478260869565, 1.7777777777777777, 1.040416994924974, 2.0, 1.1400894187779433, 1.0745341614906831, 1.0549199084668193, 1.098375451263538, 1.2675438596491229, 1.0619469026548674, 1.0260859766747423, 1.0079319462007128, 1.1527777777777777, 1.007417323479995, 1.042148610185914, 3.0, 1.0909090909090908, 1.0084103804833089, 1.0, 1.0502283105022832, 1.1111111111111112, 4.0, 1.0384615384615385, 1.1593780369290574, 1.085395051875499, 1.319327731092437, 1.0233236151603498, 1.2151898734177216, 2.25, 1.044416087781311, 1.0, 1.2166666666666666, 1.0514762245281175, 1.237037037037037, 1.0402843601895735, 1.0230627306273063, 1.8, 1.0, 1.1495726495726495, 1.6866666666666668, 1.100497512437811, 1.0160351225631108, 1.0714109521460287, 1.0625, 1.5, 1.00439284043051, 1.0815217391304348, 1.2258064516129032, 2.0, 1.069879518072289, 1.4285714285714286, 1.0714285714285714, 1.1610169491525424, 1.00666835485777, 1.0062664063585378, 1.0482392667631453, 1.0752594210813764, 1.032903948473817, 1.3148148148148149, 1.0160642570281124, 1.0739259792681308, 1.0828313253012047, 1.2121212121212122, 1.0028195488721805, 1.0109563637739847, 1.0274509803921568, 1.0696517412935322, 1.2307692307692308, 1.010928961748634, 2.0, 1.9259259259259258, 1.112, 1.0296296296296297, 1.4539007092198581, 1.037162162162162, 1.0168150346191889, 1.2955465587044535, 1.0096567538177863, 1.112406015037594, 1.0586305518169583, 1.255813953488372, 1.0806451612903225, 1.0495049504950495, 4.0, 1.01930796104958, 1.4035087719298245, 1.0051969158666565, 1.038276159190048, 1.0042826552462527, 1.007232788641843, 2.0, 1.186278420422816, 1.1666666666666667, 1.0334977044720286, 1.1818181818181819, 1.0304703937481214, 1.0023952095808384, 1.0223114680946006, 1.1096774193548387, 1.114138438880707, 4.0, 1.0009720534629405, 1.0026903443995492, 1.047731596241425, 1.5, 1.2769230769230768, 1.0121457489878543, 1.2787286063569683, 1.1071022041323169, 1.0067021158745983, 1.173913043478261, 1.1111908177905307, 1.0742233123102078, 1.1023733561590539, 1.018474566616667, 1.1169560654486477, 1.1156207366984994, 1.009009009009009, 1.1707188160676534, 1.0019674764103594, 1.384, 1.0151761517615177, 1.0, 1.3333333333333333, 1.208689927583937, 1.163265306122449, 1.214915254237288, 1.0310029498525073, 1.1153184165232357, 1.0, 1.2314049586776858, 1.2666666666666666, 1.0006738669452808, 1.125, 1.0, 1.099687825182102, 1.0, 1.0, 1.0807966929725668, 1.75, 1.1656421869945002, 1.000751879699248, 1.368421052631579, 1.3, 1.017376254283968, 1.0202593192868719, 1.0, 1.082591882290062, 1.0305343511450382, 1.1002178649237473, 1.148521505376344, 1.1192076406084188, 1.1160922272403138, 1.0, 1.010752688172043, 1.1345291479820627, 1.0493233082706768, 1.105026256564141, 1.0, 1.0445132572092124, 1.0127970952229166, 1.0374284456186702, 2.0, 1.1087533156498675, 1.0361737595606981, 1.0687619697247948, 1.223355967900069, 1.0300665158675057, 1.0166939871476413, 1.0278551532033426, 1.550561797752809, 2.0, 1.111994469408918, 1.0358514724711907, 1.0235960358659746, 1.03559510567297, 1.0454545454545454, 1.0363707047363988, 1.0431654676258992, 1.0574443701652183, 1.2795333009236753, 1.0391228992619423, 1.0739986422267482, 1.0163676902807337, 1.1497551789077214, 1.1325301204819278, 1.3066666666666666, 1.0406108418084465, 1.108974358974359, 1.0375849222003068, 1.0020246425240544, 1.0, 1.1415490270888973, 1.0112676056338028, 2.0, 1.2682926829268293, 1.0033631325636985, 1.1555555555555554, 1.1063967262545769, 1.0, 1.1265822784810127, 1.0290917691579944, 1.0241608166251503, 1.031742978068488, 1.0085638489671869, 1.027456647398844, 1.0191204588910134, 1.0949506037321624, 1.08521794565304, 1.3161764705882353, 1.0305428810876245, 1.195754716981132, 1.0825688073394495, 1.0135221279966002, 1.7777777777777777, 1.0324916917128975, 1.5, 1.0607008760951189, 1.4006734006734007, 1.0117488425598522, 1.0186721991701244, 1.139121338912134, 1.0919732441471572, 1.1852941176470588, 1.0054277051543317, 1.0, 1.6785714285714286, 1.25, 1.0, 1.0485436893203883, 1.2042875157629256, 1.406810035842294, 1.116591928251121, 1.0318139286191685, 1.025516403402187, 1.0184963178626476, 1.0146732429099876, 1.0063750435793994, 1.0565714876693524, 1.0235854833104407, 1.0679405520169851, 1.0300655774146938, 1.0009484836192704, 1.0338567222767419, 1.0335946248600223, 1.1360201511335013, 1.3381294964028776, 1.0055250846910793, 1.2690863579474343, 1.0136119593637107, 1.060747663551402, 1.0921465968586388, 1.0542168674698795, 2.5, 1.025374855824683, 1.25, 2.5, 1.3042168674698795, 1.016573388428517, 1.0258188824662813, 1.0824742268041236, 1.0167597765363128, 1.0454035464279616, 1.134426878774877, 1.036259541984733, 1.2, 1.1428571428571428, 1.0660404212923427, 1.2657657657657657, 1.0289040545965475, 1.0298192063864757, 3.0, 1.0694315004659831, 1.1403508771929824, 1.0017661822576147, 1.1217391304347826, 1.036819678481503, 1.0682662188781606, 1.0150980938358072, 1.2916666666666667, 1.0, 1.052241677891091, 1.0, 1.1021170610211706, 1.1434426229508197, 1.051111111111111, 1.0783798001052078, 1.3548387096774193, 1.0055821371610845, 1.1159420289855073, 1.3333333333333333, 1.0099052398718922, 1.0163078930202218, 1.0040439052570769, 1.0413833300952011, 1.0270513976555455, 1.003567953292248, 1.2, 1.0507845589125087, 1.0699951560445644, 1.0454545454545454, 1.0020519835841313, 1.109527687296417, 1.0638297872340425, 1.0545331406899043, 1.0909090909090908, 1.093167701863354, 1.029016763062445, 1.3819444444444444, 1.0460526315789473, 1.0494549033673375, 1.3267326732673268, 2.111111111111111, 1.0611921369689283, 1.0264993026499303, 1.0320584528681271, 1.1000555864369095, 1.056124702358092, 1.002727762972581, 1.0424528301886793, 1.0167910447761195, 1.1261829652996846, 1.0189807688741352, 1.107905982905983, 1.0098261526832955, 1.0693025322079075, 1.090726615816941, 1.325, 1.1344506517690875, 1.1363636363636365, 1.6, 1.0436456996148908, 1.0049153468050245, 1.049576404141826, 1.302857142857143, 1.4444444444444444, 1.003875968992248, 1.1054481546572934, 1.3688524590163935, 1.0242337346518509, 2.3333333333333335, 1.001384039508037, 1.6666666666666667, 1.417142857142857, 1.1333333333333333, 1.0842393680589968, 1.2424242424242424, 1.139344262295082, 1.1454219030520647, 1.0, 1.2562380038387715, 1.0298837852794687, 1.5, 1.25, 1.1081081081081081, 1.1037735849056605, 1.0991282689912827, 1.0309734513274336, 1.0067294751009421, 1.0582822085889572, 1.1512605042016806, 1.1295601772928743, 1.5730337078651686, 1.646067415730337, 1.1875, 1.0, 1.084931506849315, 1.1818181818181819, 1.0447227191413238, 1.3884977926261783, 1.0304159840480163, 1.2668065390331322, 1.0129036245094707, 1.1480302977899215, 1.0240963855421688, 1.0078895463510849, 1.7777777777777777, 1.5, 1.0, 1.0095674833303527, 1.1622769753610875, 1.010840108401084, 1.4256559766763848, 1.051930758988016, 1.0031440911226979, 1.003093341189438, 1.0204081632653061, 1.2608695652173914, 1.1141843971631207, 1.055221160748799, 1.0161193952304255, 1.0058361045653754, 1.1891891891891893, 1.0987570341970194, 1.010421067455288, 1.1065648781427608, 1.0564578499613302, 1.0051072603364968, 1.2075471698113207, 1.077506991610068, 1.2603550295857988, 1.00788459205742, 1.0416666666666667, 1.0947368421052632, 1.0, 1.104602510460251, 1.045783847142393, 1.2, 1.0402280231331813, 1.2082216264521894, 1.1428571428571428, 1.0030695908558505, 1.0111935831437806, 1.1113909174851002, 1.0127287191726333, 1.0268456375838926, 1.0136517972134411, 1.1181506849315068, 1.0625, 1.0, 1.2, 1.0179795732632217, 1.8571428571428572, 1.078980949776684, 1.0663684991234774, 1.1686456400742116, 1.077652531758812, 1.02408490464903, 1.0954809843400448, 1.0786885245901638, 1.015222482435597, 1.0331151222986112, 1.0368224904804342, 1.006864046309326, 1.0286945843670903, 1.3333333333333333, 1.2935560859188544, 1.4364820846905537, 1.0326793487983779, 1.0106951871657754, 1.0346008289781943, 1.1395007342143906, 1.0461285008237233, 1.07186179971143, 1.0372960372960374, 1.001547554863316, 1.3157894736842106, 1.021755648478134, 1.0202168978910406, 1.151549508692366, 1.009834913944503, 1.0952380952380953, 1.168976897689769, 1.0761792161499233, 1.088385535690281, 1.0877390326209224, 1.0031551942754358, 1.0, 1.1217170514956756, 1.2220812182741116, 1.1030150753768844, 1.3544973544973544, 1.119241192411924, 1.1435272045028142, 1.0944954128440367, 1.0535298923772776, 1.0384245917387127, 1.1355807086614174, 1.0648195221148957, 1.3333333333333333, 1.0604166666666666, 1.032853513971211, 1.052870090634441, 1.094170403587444, 1.2180094786729858, 1.2416582406471184, 1.061712846347607, 1.0608020698576972, 1.0248936191415787, 1.1935483870967742, 1.039504716981132, 1.0122015391699006, 1.0173446211026222, 1.5332302936630602, 1.00259104649489, 1.090099493274524, 1.0459387483355527, 1.0813492063492063, 1.0112228877129732, 1.073490813648294, 1.001564945226917, 1.2995594713656389, 1.0, 1.0073063560188025, 1.0721649484536082, 2.0, 1.0160542620034527, 1.0043175294008704, 1.001911132345915, 1.2981366459627328, 1.008737571557698, 1.0056486690251116, 1.021608643457383, 1.1127783155856728, 1.0789473684210527, 1.1039772727272728, 1.4761904761904763, 1.1193633952254642, 1.625, 1.0817000148765248, 1.0247320692497939, 1.0588235294117647, 1.175, 1.0472837022132797, 1.00382226469183, 1.0, 1.05, 1.0135635018495683, 1.2350230414746544, 1.03562945368171, 1.7, 1.0432574721220411, 1.0863309352517985, 1.1698292220113853, 1.032520325203252, 1.0588235294117647, 1.093356745683348, 1.0913863077236472, 1.0169693039342844, 1.0535714285714286, 1.691358024691358, 1.1111111111111112, 1.0555555555555556, 1.4186046511627908, 1.4833333333333334, 1.0579641847313854, 1.0097925278510185, 1.0052545339788015, 1.1088435374149659, 1.02534026400383, 1.000437616697786, 2.5, 1.012852242010142, 1.0813035633739287, 1.0, 1.1428571428571428, 1.040126459143969, 1.0911682603789274, 1.0557222034605376, 1.073107049608355, 1.0, 1.064406779661017, 1.2307692307692308, 1.013157894736842, 1.0019912477714232, 1.032525685401901, 1.0049145375190482, 1.183749073845394, 1.3333333333333333, 1.0183851705870959, 1.0620998719590269, 1.0494604316546763, 1.0114942528735633, 1.0909090909090908, 1.0, 1.0344827586206897, 1.0697775839511556, 1.0588396465511336, 1.0344827586206897, 1.037162162162162, 1.0137068074847893, 1.1430615164520743, 1.1373239436619718, 1.2424242424242424, 1.047386030649749, 1.0311087756174462, 1.0341849552944653, 1.3862068965517242, 1.3225806451612903, 1.11781206171108, 1.1111111111111112, 1.0290528762347473, 1.06265664160401, 1.0097146130092638, 1.0353581142339074, 1.5, 1.0763790664780764, 1.0186437205490677, 1.0921539600296077, 1.3120440914248663, 1.0676994906621393, 1.0252229654403568, 1.077678540875338, 1.1655773420479303, 1.0892857142857142, 1.0442390876917027, 1.016736760057902, 1.065080135988344, 1.1976225854383358, 3.0, 1.0520833333333333, 1.0130099228224918, 1.277056277056277, 1.0006112548932904, 1.023794668365504, 1.1280524121500894, 1.8333333333333333, 1.0029585798816567, 1.0475324500380068, 1.0399155632316255, 1.0161290322580645, 1.0207800590878622, 1.1574074074074074, 1.3349573690621193, 1.0903351141330744, 1.0030555429126273, 1.0299050632911393, 1.120388349514563, 1.0954879328436515, 1.1142857142857143, 1.1079828937990022, 1.7006427915518825, 1.0483849185399812, 1.0536607548885857, 1.042953667953668, 1.0581162324649298, 1.1505376344086022, 1.079646017699115, 4.5, 1.5, 1.2666666666666666, 1.0522875816993464, 1.1198945981554678, 1.0057989088074826, 1.045222256158883, 1.011462631820266, 1.0329038997214484, 1.034934497816594, 1.173913043478261, 1.0016162278647054, 1.5, 1.4285714285714286, 1.0311576685468709, 1.125, 1.1821862348178138, 1.1252052545155993, 1.030410237109522, 1.010353030221117, 1.25, 1.0451473371181401, 1.1155115511551155, 1.1001423825344092, 1.0006463679095543, 1.0116772823779194, 1.0233175914994097, 1.0006967286161026, 1.079887263715438, 1.128686327077748, 1.5172413793103448, 1.2439306358381503, 1.0, 2.0, 1.0005438669686495, 1.25, 1.625, 1.3265306122448979, 1.0754527162977867, 1.022178511360073, 1.2515475520540236, 1.0335820895522387, 1.0, 1.0229421795070532, 1.0315789473684212, 1.3866481223922114, 1.039832285115304]
origin-bjaq_15.87 	max: 4.5000	99th: 3.0000	95th: 1.7000	median: 1.0631	mean: 1.1649

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 20.780269 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=39.968651