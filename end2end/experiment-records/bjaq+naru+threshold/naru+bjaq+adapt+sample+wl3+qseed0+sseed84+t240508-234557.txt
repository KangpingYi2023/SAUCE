Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='naru', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 84, 'naru': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.5716	median: 1.0605	mean: 1.1482
ReportEsts: [1.1797752808988764, 1.0540763107329125, 1.0289988835132118, 1.0346153846153847, 1.0333333333333334, 1.0, 1.1290977661734842, 1.0053361265205938, 1.25, 1.0345285524568393, 1.05690704989467, 1.002483422181771, 1.0118997025074372, 1.0093023255813953, 1.0342635111268104, 1.0, 1.6071428571428572, 1.0318809776833155, 3.0, 2.6666666666666665, 1.173913043478261, 1.1123139961181798, 1.0167238629223259, 1.0965872504829361, 1.0315521628498727, 1.0, 1.0627052851597492, 1.2, 1.4, 1.2014388489208634, 1.0, 1.0023761103665214, 1.0179401850302643, 1.4445061043285239, 1.0243718970964344, 1.0147586487035407, 1.016304347826087, 1.0137603387160299, 1.10751429161788, 1.0714285714285714, 1.056910569105691, 1.0945121951219512, 1.0, 1.1795571034301484, 1.063396575659417, 1.1983471074380165, 1.0970873786407767, 1.400990099009901, 1.0381491861957182, 1.0093457943925233, 1.0932644359326444, 1.0139372822299653, 1.0084834970013434, 2.0, 1.412987012987013, 1.0467321898084387, 1.0353915662650603, 1.0687022900763359, 1.236024844720497, 1.25, 1.027898945837877, 1.0404732254047322, 1.040909090909091, 1.1379310344827587, 1.0909090909090908, 1.081132532622616, 1.0269589317208365, 1.1666666666666667, 1.0, 1.0320377140658072, 1.0214797136038185, 1.057836899942163, 1.114864864864865, 1.1183745583038869, 1.223529411764706, 1.0975609756097562, 1.0, 1.048598949211909, 1.6, 1.045295417372091, 1.375, 1.0595201238390093, 1.177914110429448, 1.051605504587156, 1.0592515592515592, 1.04, 1.004390402543904, 1.0229038659239247, 1.2058823529411764, 2.3333333333333335, 1.0520393811533053, 1.0077289116586574, 1.0321543408360128, 1.246844319775596, 1.169871794871795, 1.1, 1.2162162162162162, 1.0316901408450705, 1.0, 1.0028635346756152, 1.0915766738660908, 1.004306632213609, 1.0101589791117132, 1.0588235294117647, 1.0125851184509462, 1.1085932901706887, 1.099700365308049, 1.087599544937429, 1.0216097713748826, 1.0, 1.3333333333333333, 1.1745334796926454, 1.0216626976420928, 1.0917241379310345, 1.0405405405405406, 1.0071789512436984, 1.0, 1.2333722287047841, 1.1894736842105262, 1.0, 1.2197802197802199, 1.1666666666666667, 1.0401002506265664, 1.0150792162910718, 1.1258057000854236, 1.0275229357798166, 1.8, 1.255794701986755, 1.0, 1.1428571428571428, 1.0140372759710052, 1.1818181818181819, 1.0185546875, 1.0117819214078014, 1.053074353581591, 1.1096296296296295, 1.0310734463276836, 1.0158353127474267, 1.00199203187251, 1.0505761843790014, 1.0362638256343526, 1.1851851851851851, 1.0652315720808871, 1.0685296680147203, 2.0, 1.0110599078341014, 1.0441527446300716, 1.0527295285359801, 1.022763366860773, 1.0, 1.0823066841415465, 1.0518518518518518, 1.02, 1.4476190476190476, 1.051094890510949, 1.0803132398470223, 1.0871656060126127, 1.0836414464784923, 1.1996197718631179, 1.200657894736842, 1.0208333333333333, 1.181159420289855, 1.1186161449752883, 1.2857142857142858, 1.003801345022432, 1.0141745800983637, 1.004626951995373, 1.002927525883613, 1.042150274893097, 1.0151069412419496, 1.0021052631578948, 1.0798319327731092, 1.1987992640650722, 1.1607981220657277, 1.1532338308457712, 1.079748163693599, 1.082622950819672, 1.0747834776815457, 1.0876481757068814, 1.1666666666666667, 1.2727272727272727, 1.039232289020604, 1.0476190476190477, 1.1193118756936737, 1.1343283582089552, 1.0164663040159234, 1.0111474149529118, 1.0299980520745406, 1.0357142857142858, 1.0313636363636363, 1.0565449228828623, 1.0, 1.4545454545454546, 1.0025081920789676, 1.3938706015891034, 1.1145940390544706, 1.3461538461538463, 1.0192926045016077, 1.0069226351543623, 1.0428536701665154, 1.1798245614035088, 1.1183725097501844, 1.120253164556962, 1.125, 1.0714285714285714, 1.0, 1.0526315789473684, 1.073108817058724, 1.602787456445993, 1.1264367816091954, 1.018783984181908, 1.0957683741648108, 1.092152533493002, 1.0132060814559982, 1.0421686746987953, 1.1733333333333333, 1.0221565731166913, 1.0334896182183524, 1.0185823424665403, 1.0148778019472589, 1.0, 1.060041407867495, 1.0245209067811631, 1.0031268284981008, 1.0751577739529548, 1.0260153471832303, 1.0032989341904923, 1.0344827586206897, 1.0025483473464496, 1.119838290499567, 1.1793570219966159, 1.0212765957446808, 1.0376668101592768, 1.0266084193804608, 1.1559055118110235, 1.0, 1.0092155009451795, 1.1475547119249665, 1.003764705882353, 1.4402985074626866, 1.0909090909090908, 2.6666666666666665, 1.0887778969768382, 1.1272727272727272, 1.088515660463005, 1.5, 1.0, 1.25, 1.0023474178403755, 1.6428571428571428, 1.080110497237569, 1.1984829329962072, 1.114490161001789, 1.0192554557124518, 1.0243288257921244, 1.0350877192982457, 1.0, 1.0203257047683671, 1.055029504597228, 1.0665499124343258, 1.0376789587852495, 1.0735510743129983, 1.054185829385525, 1.09697933227345, 1.033977078675422, 1.0645933014354068, 1.142063492063492, 1.3129635601418896, 1.2727272727272727, 1.0625, 1.1812366737739872, 1.2727272727272727, 1.0, 1.1654545454545455, 1.1111111111111112, 1.21875, 1.0101277868406742, 1.1337047353760445, 1.209090909090909, 1.0125677165307916, 1.032034632034632, 1.0018529222334154, 1.0190959786490086, 1.6, 1.0451618770461986, 1.2, 1.016469645361651, 1.0215982721382288, 1.0020386476514505, 1.275, 1.4285714285714286, 1.0, 1.591549295774648, 1.0229931499185698, 1.0, 1.0275229357798166, 1.0135746606334841, 1.0368589743589745, 1.0018067294124493, 1.1962025316455696, 1.0062893081761006, 1.0000791090562289, 1.0284897866802467, 1.1258892390814947, 1.1282051282051282, 1.0, 1.266109785202864, 1.019704433497537, 1.2211838006230529, 1.0568239258635215, 1.0591872791519434, 1.0113960113960114, 1.0338983050847457, 1.0150891632373114, 1.1083786102373463, 1.4285714285714286, 1.018373848226873, 1.0732600732600732, 1.0526315789473684, 1.0101026852965158, 1.1904761904761905, 2.0, 1.0423743374879393, 2.0, 1.0123456790123457, 1.0828488372093024, 1.0328137817883511, 1.0130268199233716, 1.2114882506527416, 1.2087912087912087, 1.0158551928462236, 1.004630120236397, 1.0095367847411445, 1.043097863966217, 1.1124525965482548, 2.0, 1.1111111111111112, 1.0182905545342424, 1.3333333333333333, 1.0498357064622126, 1.0625, 1.0, 1.0454545454545454, 1.177304964539007, 1.0863723608445297, 1.162162162162162, 1.0140692640692641, 1.0, 1.0279627163781624, 1.0159510891671517, 1.5, 1.1250744490768314, 1.0, 1.011675396644652, 1.1866666666666668, 1.0615848858567305, 1.1682027649769586, 1.0018181818181817, 1.1763527054108216, 1.0648148148148149, 1.0033400282674998, 1.0134718952301072, 1.0386151797603196, 1.0, 1.2142857142857142, 1.8333333333333333, 1.5, 1.0666666666666667, 1.001721911321567, 1.25, 1.0915141430948418, 1.041237113402062, 1.0407449638920563, 1.009076878809281, 1.008307372793354, 1.0633944174184102, 1.030484160191273, 1.2280701754385965, 1.5, 1.0526315789473684, 1.1084905660377358, 1.0208705029696061, 1.2857142857142858, 3.142857142857143, 1.066815144766147, 1.0284883720930234, 1.0073116261994841, 1.1741007194244604, 1.342769701606733, 1.0362914658349873, 1.4285714285714286, 1.0808477237048666, 1.0360169491525424, 1.2307692307692308, 1.055306427503737, 1.1941747572815533, 1.0490568978955572, 1.0054609789229219, 1.0193238358494578, 1.178082191780822, 1.117117117117117, 1.075075075075075, 1.0, 1.0142900195891305, 1.029056930477503, 1.002637808589787, 1.0083275419971722, 1.0364314400458978, 1.0257496740547587, 1.8333333333333333, 1.2301013024602026, 1.2, 1.1332194705380016, 1.1111111111111112, 1.0308702129327822, 1.0579710144927537, 1.0667454858125538, 1.158102766798419, 1.1065719360568385, 3.0, 1.118610747051114, 1.0014102062540373, 1.0026669118999447, 1.0, 1.1666666666666667, 1.0268714011516316, 1.2528735632183907, 1.098839831099086, 1.1479713603818615, 1.105263157894737, 1.190681622088007, 1.0714235632318228, 1.0684558247172558, 1.0007838785252514, 1.187719298245614, 1.285240464344942, 1.2815533980582525, 1.25, 1.0456852791878173, 1.3, 1.043656207366985, 1.064516129032258, 1.0598768175757192, 1.0416666666666667, 1.1198881292728402, 1.027529577962211, 1.1562054208273895, 1.0, 1.0754716981132075, 1.28, 1.0015564807969182, 1.1706783369803064, 1.0, 1.0867642995302569, 1.029631600590213, 1.2248730964467005, 1.0, 2.0, 1.1968932038834952, 1.0026954177897573, 1.3738738738738738, 1.0, 1.0228742001451283, 1.0382352941176471, 1.0869565217391304, 1.0638418079096046, 1.0272727272727273, 1.0, 1.1612903225806452, 1.1131678586453513, 1.0804201825383157, 1.0, 1.0675675675675675, 1.0846368764792769, 1.0061275457343004, 1.0639468216265615, 1.0, 1.00982800982801, 1.0188299915032548, 1.0277632268203247, 2.0, 1.118421052631579, 1.0735370274469187, 1.0894890464124194, 1.1971517190162073, 1.0208539557264038, 1.2083476468567502, 1.0092436974789916, 1.0788331726133076, 2.0, 1.1008837666029252, 1.3454545454545455, 1.0, 1.3129251700680271, 1.1304347826086956, 1.0300368753407427, 1.0351802990325418, 1.0502991379475122, 1.1313603322949117, 1.0412900959962539, 1.1513593940213716, 1.012980107955662, 1.087378640776699, 4.0, 1.033489377025567, 1.0218623481781377, 1.0066987446267517, 1.010406575804951, 1.0688720173535793, 1.1943381790359602, 1.1236559139784945, 1.4285714285714286, 1.0107661831112424, 1.0299488596481454, 1.032290858008946, 1.0702000702000702, 1.0504886818250874, 1.002061855670103, 1.002383842307132, 1.0436893203883495, 1.081267217630854, 2.0, 1.0833333333333333, 1.0368098159509203, 1.0620300751879699, 1.0016806722689076, 1.0011904761904762, 1.1486486486486487, 1.085427135678392, 1.0554699537750385, 1.0714285714285714, 1.0062494435045855, 1.4125, 1.0212608702489345, 1.0, 1.10828025477707, 1.503968253968254, 1.0851063829787233, 1.0081667136018022, 1.13681592039801, 1.0790513833992095, 1.0311284046692606, 1.0357380319148937, 1.0, 1.7659574468085106, 1.5, 1.0, 1.0114942528735633, 1.2097560975609756, 1.3787234042553191, 1.177142857142857, 1.024351169496956, 1.1680216802168022, 1.0162207529718064, 1.0132616840859792, 1.0935720097640358, 1.022550340775786, 1.088235294117647, 1.073015873015873, 1.10836961780358, 1.1008724100327154, 1.0361271676300579, 1.0692241130660514, 1.0396185659343553, 1.146423088731962, 1.0089581833417918, 2.0, 1.0147420147420148, 1.0378927911275415, 1.0201342281879195, 1.0, 1.2439024390243902, 1.25, 1.0660377358490567, 1.6296296296296295, 1.5, 1.0166997002407903, 1.0223387240092412, 1.004455624822163, 1.0236421231553736, 1.1027027027027028, 1.0291616038882139, 2.0, 1.2222222222222223, 1.1252619324796276, 1.0090729994505274, 1.007114854072891, 1.0126888914523013, 1.0143035937779368, 1.1159420289855073, 1.0181235663235322, 1.1793960923623446, 1.0009754019328654, 1.0211506240704833, 1.3636363636363635, 1.1166666666666667, 1.0, 1.0090702947845804, 1.0231939031180401, 3.0, 1.0719673802242609, 1.0518264269315574, 1.2857142857142858, 1.1821820969253045, 1.1111111111111112, 1.1176470588235294, 1.0243767705382436, 1.6923076923076923, 1.007537382494764, 1.0226398974797095, 1.1875, 1.2608695652173914, 1.350974930362117, 1.02099609375, 1.1308037943085372, 1.0533731040172623, 1.011504070465768, 1.0, 1.1343688898544428, 1.0154798761609907, 2.0, 1.1176511289987776, 1.059858119214465, 1.1069063386944182, 1.009176375331744, 1.0387360225928328, 1.3452380952380953, 2.142857142857143, 1.0114111829593002, 1.0726643598615917, 1.0698420239933484, 1.06971314209473, 1.0366148153698078, 1.1389695498325956, 1.1923076923076923, 1.0338461538461539, 1.1725490196078432, 1.0346262545341256, 1.0757097791798107, 1.0, 1.210609243697479, 1.0421199344314027, 4.0, 1.0004589983344918, 1.007465134541406, 1.0272618366664148, 1.1176470588235294, 1.018456969096952, 1.2604651162790699, 1.1428571428571428, 1.0263519872583797, 1.0134426229508198, 1.1266912669126692, 1.1470588235294117, 1.6666666666666667, 1.0248454164128205, 1.5, 1.3333333333333333, 1.1538461538461537, 1.1341148559067755, 1.2857142857142858, 1.2950819672131149, 1.120545073375262, 1.0, 1.2658730158730158, 1.01797603195739, 2.0, 1.0, 1.0901639344262295, 1.0661764705882353, 1.0576694411414982, 1.007399577167019, 1.0810810810810811, 1.0119402985074626, 1.089150378938971, 1.051948051948052, 1.5605095541401275, 1.25, 1.5, 1.0, 1.0362173038229376, 1.173160173160173, 1.013612565445026, 1.2530183045566663, 1.026724349717477, 1.174356483729966, 1.0091008804434827, 1.0208871503431987, 1.0601684717208182, 1.0119331742243436, 1.2222222222222223, 1.0, 1.0303030303030303, 1.0420142815344346, 1.1777546777546777, 1.0065359477124183, 1.256965944272446, 1.0138984345169912, 1.0130033444816053, 1.0026827059967625, 1.0897435897435896, 1.1578947368421053, 1.0629163582531458, 1.1080991516436904, 1.040213409778627, 1.0234340924410843, 1.1710526315789473, 1.0897814530419374, 1.0094027331835733, 1.064032697547684, 1.0282722513089004, 1.3333333333333333, 1.0649038461538463, 1.1103603603603605, 1.0576923076923077, 1.139751552795031, 1.0347890451517394, 1.0, 1.0138888888888888, 1.0271599195999934, 1.3333333333333333, 1.0170755404420695, 1.2171610169491525, 1.0930232558139534, 1.058178558014999, 1.0178082191780822, 1.120265914585012, 1.0047938638542666, 1.0385925085130534, 1.0078054553651938, 1.1914893617021276, 1.0714285714285714, 1.0, 1.1111111111111112, 1.0113842800048445, 1.6666666666666667, 1.04082917397365, 1.0652091971353186, 1.192512184315463, 1.074018771331058, 1.000512081326101, 1.1013933547695605, 1.0772200772200773, 1.0256045519203414, 1.0158499072486908, 1.0309736651365065, 1.0011168899647676, 1.0264556805538385, 1.25, 1.0625, 1.2490118577075098, 1.0795165394402035, 1.0390879478827362, 1.0230802415875755, 1.2053097345132744, 1.023391812865497, 1.036722051406328, 1.0122282608695652, 1.0224162679425837, 1.375, 1.002571011696044, 1.0006993990961612, 1.144339197113216, 1.0008428150021071, 1.125, 1.1049250535331905, 1.0945273631840795, 1.5625, 1.0242258777992812, 1.3461538461538463, 1.0269151138716357, 1.0044150110375276, 1.1476736345246124, 1.020446735395189, 1.06, 1.1818181818181819, 1.061611374407583, 1.0159748520166183, 1.0088107702137676, 1.0077612277421542, 1.0417729266551057, 1.0292072790936484, 1.1818181818181819, 1.073728813559322, 1.0112603713947057, 1.0807178891914817, 1.0267489711934157, 1.2083333333333333, 1.0734896302975654, 1.0458666902560927, 1.1427385892116182, 1.0086584657621034, 1.0, 1.3333333333333333, 1.0022843580805458, 1.0038135593220339, 1.0017699115044247, 1.0820648577101257, 1.036711891460495, 1.1363636363636365, 1.01172980059339, 1.1157405849291555, 1.0421455938697317, 1.2972972972972974, 1.0147058823529411, 1.0489495901438177, 1.0238095238095237, 1.75, 1.023296903268126, 1.003166754632073, 1.0034207525655645, 1.2941176470588236, 1.0263842437755482, 1.0330349959774738, 1.0183223590037218, 1.0526315789473684, 1.1923076923076923, 1.099056603773585, 1.0378947368421052, 1.09375, 1.7916666666666667, 1.0789250195552575, 1.0148662041625371, 1.089430894308943, 1.2058823529411764, 1.0462567291938343, 1.0401598401598402, 1.0117838277123121, 1.0915576694411415, 1.6666666666666667, 1.1071428571428572, 1.3333333333333333, 1.0268240343347639, 1.5, 1.3333333333333333, 1.5, 1.25, 1.010989010989011, 1.1109283555827565, 1.0364617720850389, 1.1088709677419355, 1.5588235294117647, 1.0, 1.032258064516129, 1.2972972972972974, 1.1290322580645162, 1.02803738317757, 1.0103942240802901, 1.0028241755379514, 1.0390625, 1.0359929696422587, 1.0012662028927481, 5.0, 1.0085485352658978, 1.1557142857142857, 1.0, 1.3333333333333333, 1.051775147928994, 1.114107437423797, 1.035287672538021, 1.0838509316770186, 1.0, 1.1120689655172413, 1.0858895705521472, 2.0, 1.5, 1.1488681102362204, 1.054280045351474, 1.1987717195925705, 1.25, 1.0050312081217598, 1.069713400464756, 1.1403508771929824, 1.1428571428571428, 1.0923076923076922, 1.0005949539835026, 1.2236842105263157, 1.0567986230636832, 1.0411315725708747, 1.118421052631579, 1.0078740157480315, 1.0091041768017235, 1.2186165670367208, 1.1239669421487604, 1.1896551724137931, 1.063785415739553, 1.1248776908023483, 1.087397360460091, 1.5754716981132075, 1.2592592592592593, 1.2537313432835822, 1.060846560846561, 1.038897396630934, 1.0095425231761386, 1.0137880820080476, 1.056768558951965, 3.0, 1.25, 1.0234551342863685, 1.1992084432717678, 1.3746352849640149, 1.0232835595966192, 1.0635557785582874, 1.0878557246856386, 1.0702947845804989, 1.0, 1.0328840532640469, 1.0048310176105044, 1.0771950500883913, 1.1138353765323994, 2.5, 1.0133333333333334, 1.005576139990462, 1.086499402628435, 1.0189953902400255, 1.0163773023077107, 1.1015625, 1.6, 1.009433962264151, 1.058653902282412, 1.0370116518163126, 1.0115384615384615, 1.03368020788633, 1.2170542635658914, 1.18122555410691, 1.0678260869565217, 1.0027802543714406, 1.026928895612708, 1.1059907834101383, 1.1075544174135723, 1.03125, 1.1006493506493507, 1.018315529800554, 1.023778071334214, 1.0495095856312586, 1.043554006968641, 1.0500397140587767, 1.2857142857142858, 1.0530785562632696, 2.5, 1.5, 1.4166666666666667, 1.030690537084399, 1.1398104265402844, 1.0201641353188013, 1.0513937791448011, 1.0601265822784811, 1.0786610878661087, 1.1195652173913044, 1.2653061224489797, 1.0052392570550157, 1.6, 1.25, 1.0185491884730042, 1.0, 1.160741885625966, 1.0995650072498793, 1.0281207751239296, 1.0210757819220593, 1.25, 1.136123812873725, 1.4031007751937985, 1.1758104738154613, 1.0001651694363134, 1.0252525252525253, 1.057587830496197, 1.0076130677916217, 1.0686522539098435, 1.0890302066772655, 1.6511627906976745, 1.2262569832402235, 1.0, 1.0, 1.0007152819999285, 1.6666666666666667, 1.5714285714285714, 1.5, 1.0171779141104293, 1.119047619047619, 1.0397694524495678, 1.1298758865248226, 1.0, 1.2364990689013036, 1.014819205690575, 1.1434977578475336, 1.0297029702970297, 1.25, 1.0717285587975243, 1.0117779024116658, 1.0819327731092436, 1.0669393826701377, 1.012800157137479, 1.058226647700332, 1.0984405458089668, 1.0, 1.021522105536108, 1.003826833163779, 1.0111524163568772, 1.2695652173913043, 1.0323898313229853]
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.5716	median: 1.0605	mean: 1.1482

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 20.286337 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=naru', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[1.6093254e-06 3.5762787e-07 1.1920929e-07 4.7683716e-07 4.1723251e-07]
Distance score: 5.960464477539062e-07
SAUCE Drift detection: False
Detection latency: 0.0233s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 2.031374 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 6.0000	99th: 2.3340	95th: 1.6690	median: 1.0656	mean: 1.1603
ReportEsts: [1.0773638968481376, 1.029773897470338, 1.0468425340566758, 1.0129449838187703, 1.1714285714285715, 1.0, 1.2316624632198403, 1.0073915783742258, 1.2, 1.011037527593819, 1.1056283916822744, 1.0020258558428428, 1.0303139660772285, 1.0216962524654833, 1.085925925925926, 1.7531645569620253, 1.0467289719626167, 1.0833333333333333, 1.5555555555555556, 1.0143338954468804, 1.093837389953392, 1.0490135201145856, 1.136516476126429, 1.0307692307692307, 1.0656280032527536, 1.0021688317525959, 2.0, 1.0560626533932658, 1.0, 1.0, 1.2018909899888766, 2.0, 1.0009058513769293, 1.018105638876994, 1.303470919324578, 1.041070995880785, 1.0275302040007923, 1.037122969837587, 1.25, 1.0623100303951367, 1.1110322449807342, 1.0076774203079832, 1.0250569476082005, 1.0520100502512564, 1.0163636363636364, 1.0616067525305175, 1.0416666666666667, 1.0666666666666667, 1.2660098522167487, 1.118939393939394, 1.0, 1.011070110701107, 1.116591928251121, 1.0625, 1.0967180269999524, 1.0266683103221566, 1.0290479499652536, 1.124716553287982, 1.072289156626506, 1.023214215939531, 1.140625, 1.0262723617914011, 1.0796586059743956, 1.0588235294117647, 1.1037735849056605, 2.4, 1.1425512212061582, 1.0083656396653744, 1.4285714285714286, 1.0, 1.1030017152658662, 1.0089820359281436, 1.0476878612716762, 1.1109022556390977, 1.088979938927757, 1.206896551724138, 1.0187586206896553, 1.0821256038647342, 1.0425531914893618, 1.0171091554846667, 1.1679864253393666, 1.2, 1.0, 1.3333333333333333, 1.0207852193995381, 1.0161290322580645, 1.1087584215591915, 1.489010989010989, 1.0, 1.0446409972920572, 1.0901224489795918, 1.162013471129621, 1.0414357279897677, 1.2481325863678805, 1.036939313984169, 1.314726840855107, 1.2, 1.116094986807388, 1.3636363636363635, 1.1630477694433479, 1.4137931034482758, 2.0, 1.0331816257408974, 1.2071307300509337, 1.015075376884422, 1.0083956057042485, 1.15, 1.0040475548422736, 1.099057743416284, 1.1193343626694117, 1.034439178515008, 1.0247460276113571, 1.0, 1.3333333333333333, 1.1627331984715668, 1.0497628318900578, 1.0910118711136234, 1.0326086956521738, 1.0055624900935172, 2.0, 1.1764886433394721, 1.169871794871795, 1.0, 1.2077922077922079, 1.1428571428571428, 1.0495867768595042, 1.0212700724332195, 1.1129669191428757, 1.0155038759689923, 1.8333333333333333, 1.329593267882188, 1.0, 1.2857142857142858, 1.0006458756228087, 1.0769230769230769, 1.043452380952381, 1.0486868358776855, 1.0573285645505193, 1.0, 1.5333333333333334, 1.0170575692963753, 1.2378353797180537, 1.0567755757900374, 1.0587689033193923, 1.134020618556701, 1.0879120879120878, 1.0154201131014307, 2.0, 1.0065234075211051, 1.0106692531522794, 1.0459183673469388, 1.0278884462151394, 1.0, 1.0448155586090266, 1.0241423125794156, 1.0182421227197347, 1.1284271284271283, 2.0, 1.188331627430911, 1.0073376682019326, 1.0734079855219998, 1.1176470588235294, 1.1019283746556474, 1.0545454545454545, 1.2303370786516854, 1.1105047748976808, 1.25, 1.0022502267019437, 1.625, 1.0510083036773428, 1.000830403853074, 1.1029082774049217, 1.0367821036782103, 1.0, 1.0543293718166384, 1.2123779552973453, 1.138659793814433, 1.1226180613090306, 1.0291497975708501, 1.0309331946971667, 1.1432393863717445, 1.017291804538565, 1.0192307692307692, 1.050420168067227, 1.0217594175313456, 1.0155962928183562, 1.00354609929078, 1.05137842065701, 1.1699716713881019, 1.5, 1.0810810810810811, 1.0199997088834223, 1.0740740740740742, 1.0181723779854621, 1.0790455727694221, 1.0078626390242262, 1.0012064036256685, 1.0294715447154472, 1.0072164948453608, 1.1206048409637208, 1.0704654197477164, 1.011324570273003, 1.11637133033589, 1.001743744410476, 1.177023498694517, 1.1164293824788192, 1.028436018957346, 1.0526315789473684, 1.02020202020202, 1.0, 1.0324324324324323, 1.0106588501765372, 1.612994350282486, 1.1142857142857143, 1.0008100445524504, 1.3846153846153846, 1.0024626893945918, 1.0424107142857142, 1.0367555959362353, 1.1666666666666667, 1.1522633744855968, 1.0405405405405406, 1.0025988957687102, 1.00862044083549, 1.3333333333333333, 1.1504424778761062, 1.0172614843891143, 1.009592887225082, 1.010840108401084, 1.3055091819699498, 1.1070831009481317, 1.0784752625168703, 1.017094017094017, 1.0021377622426477, 1.002108972720301, 1.1263537906137184, 1.2287917737789202, 1.046857142857143, 2.0, 1.130232558139535, 2.0, 1.0272511848341233, 1.0587743344329321, 1.0041023637429185, 1.2623456790123457, 1.1538461538461537, 3.3333333333333335, 1.1094922543555537, 1.1904761904761905, 1.1326583043675382, 1.5, 1.180952380952381, 1.0269709543568464, 1.2857142857142858, 1.0161173430804133, 1.1116279069767443, 1.1399798590130916, 1.2583333333333333, 1.0078291814946618, 1.0496858647609693, 1.0714285714285714, 2.0, 1.0264906475199032, 1.0432987325801457, 1.1192930780559647, 1.0916363360630876, 1.055611964293269, 1.0394961328480437, 1.1153342070773264, 1.0358623518553787, 1.0877727042110603, 1.0726639293268632, 1.322249256555826, 2.3333333333333335, 1.0893927417176135, 1.216998191681736, 1.2692307692307692, 1.103448275862069, 1.0616725322607676, 1.0696843359142347, 1.0147824741736424, 1.018246090123545, 1.1142191142191142, 1.2179487179487178, 1.0032550062092518, 1.1189358372456963, 1.108654848800834, 1.008830851821225, 1.4166666666666667, 1.0031790886612504, 1.0601907032181168, 1.0081336207354237, 1.0094890432656038, 1.0126526355432595, 1.148583645109567, 1.015625, 1.0109072522392373, 1.1333461390703035, 1.0265427880086444, 1.0073770491803278, 1.1133400200601806, 1.0512820512820513, 1.1538461538461537, 1.0764023210831721, 1.0, 1.0483271375464684, 1.0172712328767124, 1.0519038840506008, 1.0731707317073171, 1.358974358974359, 1.009154550350027, 1.1892918825561312, 1.023202704281402, 1.0434782608695652, 1.0509631797122654, 1.0073445432519328, 1.0167865707434052, 1.5, 1.9166666666666667, 1.0681818181818181, 1.625, 1.0249696288845636, 1.0689127105666156, 1.0869565217391304, 1.0859403981699023, 1.24, 2.0, 1.0164071170300362, 2.0, 1.8, 1.056969696969697, 1.1946308724832215, 1.0893817204301075, 1.0956340956340955, 1.1607142857142858, 1.023938806777217, 1.0466963622865628, 1.1782178217821782, 1.0255911025488629, 1.1668917094247908, 3.0, 1.0, 1.0267950535216774, 1.5, 1.0455996352029184, 1.1764705882352942, 2.3333333333333335, 1.125, 1.226202661207779, 1.1112877583465819, 1.2881355932203389, 1.0516717325227964, 1.103448275862069, 2.0, 1.0658835267265296, 1.0161290322580645, 1.098360655737705, 1.0347102174506415, 1.1777777777777778, 1.0584935897435896, 1.0102516309412861, 2.25, 1.25, 1.1880832735104092, 1.0443037974683544, 1.0101010101010102, 1.015710647396057, 1.0888723851961877, 1.0101010101010102, 1.0, 1.0111739241750513, 1.25, 1.5357142857142858, 2.0, 1.0330666666666666, 1.1, 1.167082294264339, 1.1176470588235294, 1.036223472985699, 1.0112427194324964, 1.081135902636917, 1.0994565217391303, 1.0369437447523089, 1.1383647798742138, 1.0146666666666666, 1.02898441047374, 1.0775075987841944, 1.0285714285714285, 1.0043578738857708, 1.0013326226012793, 1.14764090793165, 1.036697247706422, 1.1162790697674418, 1.00711743772242, 3.0, 2.037037037037037, 1.0909090909090908, 1.039179104477612, 1.5639097744360901, 1.1022304832713754, 1.000499251123315, 1.2275449101796407, 1.1682818968761761, 1.120289303387895, 1.0879854693092579, 1.1222222222222222, 1.0526315789473684, 1.0726817042606516, 1.0, 1.022466986380959, 1.4642857142857142, 1.002093036411291, 1.039417806196681, 1.0524725711559866, 1.0061728395061729, 1.7142857142857142, 1.2079967689822293, 1.6666666666666667, 1.2176795580110498, 1.0909090909090908, 1.0644314279943445, 1.00238379022646, 1.0032286995515696, 1.1464968152866242, 1.2808219178082192, 3.0, 1.0668574401664932, 1.0011068683963802, 1.0396145610278373, 1.5, 1.1323529411764706, 1.0040192926045015, 1.2674698795180723, 1.1081220544222368, 1.021491877307051, 1.0769230769230769, 1.1248196248196247, 1.08285952690509, 1.0810210704470289, 1.0745337268029813, 1.0804652549955265, 1.0316058107577541, 1.0876494023904382, 1.186458893068243, 1.0058690971005058, 1.492537313432836, 1.226198514517218, 1.0, 2.0, 1.0850097339390006, 1.1254901960784314, 1.2595890410958903, 1.0013159588619818, 1.1718088324258924, 2.0, 1.096, 1.21875, 1.0259694459451347, 1.2083333333333333, 1.0, 1.2010591350397175, 1.3333333333333333, 1.0, 1.1302857142857143, 1.75, 1.1659031413612566, 1.0205792682926829, 1.46, 1.0, 1.0177136093371504, 1.083756345177665, 1.2592592592592593, 1.0651867180886088, 1.0546875, 1.0098684210526316, 1.2210884353741496, 1.0257033692254256, 1.1767845230153435, 1.0, 1.0561797752808988, 1.0655032273487928, 1.039410395655547, 1.1046337817638265, 1.0, 1.0353728489483747, 1.0277641844270824, 1.026121027427079, 2.0, 1.1059602649006623, 1.06176617720625, 1.1394842598794375, 1.1948957610719633, 1.036205906311352, 1.0288285324937738, 1.0258019525801954, 1.0112999430506848, 1.75, 1.0932569376149142, 1.0684514755095833, 1.0388862217954873, 1.064569536423841, 1.0393700787401574, 1.0399422017520095, 1.1893333333333334, 1.0315472970823125, 1.2650024003840614, 1.0584575386508426, 1.0561797752808988, 1.0565381269933314, 1.1872170238454574, 1.0588235294117647, 1.0444444444444445, 1.0464840680372125, 1.0638297872340425, 1.0327090045322995, 1.004373895392174, 1.0, 1.1669765712160654, 1.1794871794871795, 1.0, 1.0980392156862746, 1.000329964830578, 1.1201413427561837, 1.0617696160267112, 1.0, 1.2307692307692308, 1.034311405584477, 1.1224925634963008, 1.025085518814139, 1.0191251509367818, 1.0046230440967283, 1.0534736842105263, 1.0816216216216217, 1.0649103366472616, 1.2444444444444445, 1.0381065308874473, 1.0623781676413255, 1.1095890410958904, 1.1141747052518756, 1.0494011976047903, 1.0608423061196675, 1.0, 1.1295546558704452, 1.303921568627451, 1.0552314274601322, 1.0602910602910602, 1.1282828282828283, 1.0971993410214167, 1.2091633466135459, 1.0374105561108857, 2.0, 1.7777777777777777, 1.8333333333333333, 1.3333333333333333, 1.0196078431372548, 1.2819277108433735, 1.360344827586207, 1.117391304347826, 1.0256956463853015, 1.053838802166295, 1.0386810671625777, 1.0053141091658084, 1.0076942334974548, 1.0132454397285047, 1.0231505979468727, 1.098983413590155, 1.0042101717750085, 1.0093902883391972, 1.060264576188143, 1.0065217391304349, 1.25, 1.5118110236220472, 1.000080716764872, 1.2566037735849056, 1.009974368654255, 1.0934579439252337, 1.109706910459801, 1.2586872586872586, 2.5, 1.0189125295508275, 1.0, 1.25, 1.4290030211480362, 1.03064267198106, 1.0165703275529865, 1.092071611253197, 1.0946745562130178, 1.0570239485981308, 1.1493239859789683, 1.0196078431372548, 1.0, 1.6666666666666667, 1.0095461575382647, 1.2139737991266375, 1.0346774193548387, 1.0094317377976891, 1.0, 1.0816888480954567, 1.106024096385542, 1.0122618373891719, 1.205621301775148, 1.0370111210628452, 1.0743832731648617, 1.003758205502768, 1.1578947368421053, 1.75, 1.0775976745331823, 1.0, 1.0921544209215441, 1.1791666666666667, 1.0895179801071155, 1.4411764705882353, 1.3333333333333333, 1.0976812519961674, 1.2076923076923076, 1.00990099009901, 1.0005847349774706, 1.009049773755656, 1.0866495507060334, 1.1055561282342026, 1.0224820143884892, 1.0052168242582329, 1.2, 1.1281731884369228, 1.130319438892321, 1.04, 1.0103092783505154, 1.0985972593853888, 1.2247738343771746, 1.0380892179880803, 1.1818181818181819, 1.0724070450097847, 1.077870146269599, 1.0591016548463357, 1.2142857142857142, 1.0260716048762937, 1.2181818181818183, 1.8888888888888888, 1.0338441890166028, 1.0451977401129944, 1.0710903153758076, 1.0552594670406732, 1.0477094011346113, 1.0065494711878975, 1.0138248847926268, 1.038548752834467, 1.2053872053872055, 1.0510559133000539, 1.0658995815899581, 1.061550759392486, 1.2229580573951435, 1.0648321196107495, 1.4193548387096775, 1.0159045725646123, 1.0, 1.0, 1.0375, 1.0050835148874364, 1.0262832405689548, 1.050531914893617, 1.5555555555555556, 1.0126382306477093, 1.07480179248535, 1.3650793650793651, 1.0293868683163567, 2.0, 1.0516366612111292, 1.3333333333333333, 1.3783068783068784, 1.0625, 1.0689985486211901, 1.3235294117647058, 1.1626016260162602, 1.1276223776223777, 1.0, 1.0629283134757017, 1.0159691629955947, 2.25, 1.25, 1.0405405405405406, 1.060790273556231, 1.0527644534208533, 1.0143112701252237, 1.0525587828492393, 1.2433035714285714, 1.1049723756906078, 1.0150375939849625, 1.5923913043478262, 1.0402930402930404, 1.0909090909090908, 1.5, 1.1796407185628743, 1.2096385542168675, 1.016211604095563, 1.1503766851704995, 1.0305043247907846, 1.1788802728269254, 1.0279202525090623, 1.0068656806702356, 1.0208333333333333, 1.0216515609264853, 1.4545454545454546, 1.5, 1.0, 1.0447753313268917, 1.1005677210056772, 1.008130081300813, 1.1538461538461537, 1.077637775232277, 1.1071948660989757, 1.0081737936546156, 1.1235955056179776, 1.2173913043478262, 1.0447115384615384, 1.091255592995636, 1.016244457696995, 1.0772182042688305, 1.1283422459893049, 1.0228108903605593, 1.0213081734336902, 1.0076837122122362, 1.0429017160686427, 1.0370283305637742, 1.1433962264150943, 1.063073852295409, 1.131578947368421, 1.0002847840192126, 1.5357142857142858, 1.029723991507431, 1.0, 1.1858407079646018, 1.0414279294461297, 1.2950819672131149, 1.0118581533928785, 1.2262118491921006, 1.0408163265306123, 1.0178286268723091, 1.0064752083458242, 1.0709974853310982, 1.0176565008025682, 1.0642857142857143, 1.0035031622504877, 1.149046793760832, 1.1176470588235294, 1.0, 1.4, 1.0235196737528516, 1.625, 1.023333677211213, 1.0583594800537874, 1.144580549368968, 1.0991387209089243, 1.0077616217656082, 1.1501776198934281, 1.1225806451612903, 1.0034562211981566, 1.0191191492859184, 1.040949591114366, 1.0076744743784476, 1.0564617001050682, 1.6666666666666667, 1.2295552367288378, 1.31438127090301, 1.0038292030922622, 1.098092643051771, 1.00905057675244, 1.1426470588235293, 1.0554621848739496, 1.0702119902078233, 1.0033594624860023, 1.0421434968653598, 1.368421052631579, 1.0064721250061617, 1.0149692743216185, 1.1422657132103877, 1.0060070671378092, 1.0277777777777777, 1.288888888888889, 1.150839606253619, 1.0336788802369465, 1.2564102564102564, 1.005437070037043, 1.0256410256410255, 1.1073185972037805, 1.214929214929215, 1.143041237113402, 1.2461964038727524, 1.1194295900178253, 1.1831637372802961, 1.0667903525046383, 1.0220879366185875, 1.0375, 1.2010213100265148, 1.0391784702549576, 1.1875, 1.033356024506467, 1.2047934528448947, 1.0227272727272727, 1.2198019801980198, 1.1910290237467018, 1.143438453713123, 1.0772727272727274, 1.0266836086404065, 1.002319057597223, 1.1176470588235294, 1.0352319436288901, 1.0066434256396763, 1.0290482076637824, 1.6009463722397477, 1.0049844382561486, 1.023318187555219, 1.0394912985274432, 1.0874751491053678, 1.009402972817607, 1.1192201809090399, 1.0121028744326777, 1.2727272727272727, 1.0260818020154119, 1.0001022840017593, 1.1063829787234043, 2.75, 1.037069797362496, 1.013827337630029, 1.0259490629505046, 1.3251533742331287, 1.030475052285629, 1.0185137142991911, 1.0118008024545668, 1.0114891736632787, 1.3214285714285714, 1.0978384527872582, 1.2758620689655173, 1.148936170212766, 1.4545454545454546, 1.000325951312187, 1.011513157894737, 1.2040816326530612, 1.205128205128205, 1.1140684410646389, 1.0502737680438028, 1.0196078431372548, 1.1578947368421053, 1.0261356565028001, 1.1461187214611872, 1.031413612565445, 1.6, 1.0546427759522186, 1.0244897959183674, 1.1503659347970725, 1.0672268907563025, 2.0, 1.0570440795159897, 1.0918863938658947, 1.0189448667917955, 1.051948051948052, 1.441860465116279, 1.0, 1.0526315789473684, 1.3707865168539326, 1.4736842105263157, 1.0448979591836736, 1.0154576378005926, 1.0052758315338128, 1.0324675324675325, 1.0040861812778603, 1.000537641130797, 6.0, 1.0011236596530928, 1.1907723169508526, 1.0, 1.1428571428571428, 1.0908866386762164, 1.191145677535148, 1.0917104779320421, 1.057591623036649, 1.0, 1.1318681318681318, 1.2377260981912144, 1.1971830985915493, 1.0385537991585536, 1.0054184888742195, 1.006531306293834, 1.2096388574304768, 1.1, 1.0063667927628384, 1.0602950609364978, 1.1052141527001862, 1.0553435114503817, 1.0959715639810426, 1.0, 1.1929824561403508, 1.1129439063761097, 1.0305221684704005, 1.2946428571428572, 1.0476190476190477, 1.008513274742422, 1.2198275862068966, 1.0604026845637584, 1.2727272727272727, 1.0371740624977852, 1.0440366972477064, 1.0746405204598382, 1.5522388059701493, 1.2795698924731183, 1.0816831683168318, 1.25, 1.018018018018018, 1.0218446601941749, 1.0019687859729558, 1.0565022421524664, 2.0, 1.0714285714285714, 1.036961498439126, 1.2495466086325717, 1.2932379713914175, 1.0361914811698776, 1.0252518283427625, 1.0814769188652773, 1.1593886462882097, 1.1228070175438596, 1.0123319121023286, 1.040798173062942, 1.0682376043200785, 1.0464071856287425, 2.5, 1.101123595505618, 1.128709961798413, 1.1851332398316972, 1.0052586251892062, 1.0315041752521419, 1.1004134672179562, 1.6, 1.0384615384615385, 1.0339420386093061, 1.0211026615969583, 1.0248447204968945, 1.0072793990032975, 1.3309608540925266, 1.2273236282194848, 1.1134924500730639, 1.0024291914911663, 1.0736253494874184, 1.0892687559354226, 1.1185344827586208, 1.0, 1.0585681753487048, 1.1159281613425585, 1.0288072270341049, 1.1442173060767291, 1.0596868884540118, 1.0706195869420387, 2.2, 1.0928196147110332, 2.5, 1.0, 1.7142857142857142, 1.0126849894291754, 1.162091503267974, 1.101417361908011, 1.0303177209006806, 1.104891922639363, 1.0353166318719556, 1.043103448275862, 1.0040485829959513, 1.010541226465207, 1.5, 1.4166666666666667, 1.1416239546803344, 1.125, 1.158236057068742, 1.1361560813615608, 1.0388117283950618, 1.0197271971841453, 1.25, 1.0567248459958931, 1.1121495327102804, 1.0481006413418845, 1.0011473152822397, 1.0607064017660044, 1.0423202130807931, 1.0231408260775468, 1.0514868229435805, 1.1059602649006623, 1.4310344827586208, 1.2175925925925926, 1.0, 2.0, 1.0001116981469278, 1.75, 1.5555555555555556, 1.441860465116279, 1.0290872617853561, 1.0103816995436201, 1.0581057524694946, 1.0076628352490422, 1.2857142857142858, 1.0428486776234684, 1.0223992035838725, 1.2775510204081633, 1.0201207243460764]
origin-bjaq_15.87 	max: 6.0000	99th: 2.3340	95th: 1.6690	median: 1.0656	mean: 1.1603

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 16.963536 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=39.313732