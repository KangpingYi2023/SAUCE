Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='naru', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 27, 'naru': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.5449	median: 1.0607	mean: 1.1473
ReportEsts: [1.0430463576158941, 1.023181454836131, 1.0428780495164527, 1.0, 1.0714285714285714, 1.0, 1.2278377184680422, 1.010313982380845, 1.25, 1.0317880794701986, 1.005078925345569, 1.002353094123765, 1.0638963360142986, 1.0325581395348837, 1.039208760155422, 1.0, 1.7647058823529411, 1.0393198724760893, 3.0, 2.6666666666666665, 1.08, 1.1488031054561139, 1.0211908634123843, 1.0551425030978934, 1.0497151734852408, 1.0, 1.04074471196023, 1.2, 1.4, 1.1942446043165467, 1.0, 1.0006341931583242, 1.0030418040450766, 1.411764705882353, 1.0126412849494348, 1.0203777672466319, 1.0218579234972678, 1.0054246987363529, 1.1088229216888215, 1.1071428571428572, 1.041388518024032, 1.0640243902439024, 1.0, 1.1154228546573044, 1.1130649390714176, 1.2231404958677685, 1.0776699029126213, 1.3101851851851851, 1.031180690360693, 1.0, 1.050348100503481, 1.3137697516930023, 1.0057601060854071, 1.0, 1.2103896103896103, 1.0552601156069363, 1.229818181818182, 1.0606060606060606, 1.0869565217391304, 1.25, 1.0330334423845875, 1.0386052303860522, 1.0045454545454546, 1.1149425287356323, 1.1818181818181819, 1.1279291128725208, 1.039000764720877, 1.1666666666666667, 1.0, 1.1022400328812165, 1.0107398568019093, 1.0615206035983749, 1.1193693693693694, 1.007571520757152, 1.2, 1.1464968152866242, 1.0, 1.0440278988666085, 1.6, 1.0484518924502855, 1.28125, 1.0179533213644525, 1.1717791411042944, 1.003440366972477, 1.0800211976682565, 1.04, 1.0123461251234613, 1.0603075474269854, 1.1813725490196079, 2.3333333333333335, 1.0856313497822931, 1.0111228097005487, 1.0186915887850467, 1.2959326788218795, 1.2372881355932204, 1.0906515580736544, 1.2162162162162162, 1.006872852233677, 1.0, 1.0170614393320627, 1.186033117350612, 1.0139130434782608, 1.014316904685207, 1.0294117647058822, 1.006774910207301, 1.1857097891092225, 1.0673151910684233, 1.081152825180129, 1.0312993993044577, 1.1666666666666667, 1.3333333333333333, 1.1277997364953887, 1.0051365817076052, 1.0469576719576719, 1.0129870129870129, 1.0037052651580378, 1.0, 1.2168073676132003, 1.184688995215311, 1.0, 1.2472527472527473, 1.1666666666666667, 1.023076923076923, 1.0161792951713258, 1.0874427273433254, 1.0769230769230769, 1.8, 1.1804635761589404, 1.0, 1.3571428571428572, 1.0092014190632956, 1.1818181818181819, 1.0516946251283807, 1.002411170708368, 1.0790163103186006, 1.1523076923076923, 1.0960960960960962, 1.0128604832424006, 1.00199203187251, 1.0532734274711169, 1.0659320104098895, 1.1111111111111112, 1.0365296803652968, 1.067031126231999, 2.0, 1.008735632183908, 1.028202115158637, 1.0496277915632755, 1.023116287277219, 1.0, 1.0166194755632156, 1.008888888888889, 1.012, 1.4476190476190476, 1.243795620437956, 1.0740539561832338, 1.0258402847593946, 1.0428803318604023, 1.085551330798479, 1.1217105263157894, 1.0425531914893618, 1.1884057971014492, 1.127906976744186, 1.2857142857142858, 1.0121911426137085, 1.0261687088731137, 1.0449050086355787, 1.0405676498996954, 1.0348197923029934, 1.052344226233071, 1.0127931769722816, 1.1365546218487395, 1.2048029437397114, 1.0738327904451683, 1.1090909090909091, 1.078616352201258, 1.040983606557377, 1.0515766316304083, 1.0605454090567925, 1.1666666666666667, 1.1150442477876106, 1.0931811169392163, 1.0478378942970545, 1.0971143174250833, 1.2258064516129032, 1.0384176062789094, 1.0823798627002288, 1.006925957188927, 1.1372549019607843, 1.1139240506329113, 1.0216263077121335, 1.0, 1.7272727272727273, 1.0467159450897572, 1.3166855845629966, 1.1267532467532468, 1.1666666666666667, 1.0141479099678457, 1.0021885556562578, 1.0040055627815707, 1.1798245614035088, 1.2171392431748709, 1.3615384615384616, 1.09375, 1.0238095238095237, 1.0, 1.0389610389610389, 1.0037198258804907, 1.7038327526132404, 1.0919540229885059, 1.0173010380622838, 1.0957683741648108, 1.0797277049150003, 1.0484002326934263, 1.0205474912176045, 1.1282051282051282, 1.1001589825119238, 1.0568493150684932, 1.027658107875237, 1.0371365397874515, 1.0, 1.0935817805383024, 1.0559352411714888, 1.0111977610669605, 1.0763928776565193, 1.079589253059502, 1.0016917611233294, 1.0344827586206897, 1.0011791694958352, 1.0586950586950588, 1.1522842639593909, 1.0607734806629834, 1.101223812487036, 1.004255319148936, 1.0913385826771653, 1.0, 1.0126824599186408, 1.1344908441268424, 1.0932958274730427, 1.4253731343283582, 1.0909090909090908, 2.6666666666666665, 1.0769244297497407, 1.1090909090909091, 1.111768901569187, 1.5, 1.5, 1.2121212121212122, 1.0089773614363777, 1.4183673469387754, 1.1243093922651934, 1.1152941176470588, 1.0383333333333333, 1.0114649681528662, 1.0220388944942331, 1.1228070175438596, 1.0, 1.0053437244829404, 1.0942774804446274, 1.085814360770578, 1.0307254745642196, 1.1048661553309291, 1.0031754388851413, 1.0810810810810811, 1.0259317289579775, 1.06877990430622, 1.158801739410533, 1.3095850755870055, 1.8181818181818181, 1.0658634441668269, 1.2302771855010661, 1.2727272727272727, 1.04, 1.172, 1.0555555555555556, 1.1584158415841583, 1.0490680304151807, 1.0557103064066853, 1.2314814814814814, 1.009259857694319, 1.143953934740883, 1.0097383648218246, 1.0105693774573006, 1.4, 1.007753358872372, 1.0, 1.003911622732091, 1.0907127429805616, 1.0204496836739338, 1.3, 1.4285714285714286, 1.1304347826086956, 1.4929577464788732, 1.0001579846025777, 1.0, 1.039755351681957, 1.0375586854460095, 1.0340544871794872, 1.0012923423632731, 1.0988372093023255, 1.050314465408805, 1.0062798832794262, 1.1033497425451253, 1.103822724463671, 1.1025641025641026, 1.0, 1.2494033412887828, 1.0246305418719213, 1.2180685358255452, 1.0212721145745578, 1.0050293378038557, 1.053412462908012, 1.0350877192982457, 1.008230452674897, 1.1008236296506675, 1.4285714285714286, 1.0216203967776467, 1.0567765567765568, 1.0526315789473684, 1.045652889251327, 1.2380952380952381, 1.75, 1.0268969348692263, 2.0, 1.008298755186722, 1.068313953488372, 1.0270713699753897, 1.0232198142414861, 1.0757180156657964, 1.164835164835165, 1.0067100474844086, 1.0101506779289695, 1.0163487738419619, 1.030601451355008, 1.0843391671695837, 2.0, 1.1111111111111112, 1.0225021030002803, 1.3333333333333333, 1.0498357064622126, 1.0, 1.0, 1.0454545454545454, 1.177304964539007, 1.0853307766059443, 1.1025641025641026, 1.0313852813852813, 1.0, 1.051930758988016, 1.0352263627964275, 1.5, 1.0244192972007147, 1.0, 1.0135124876641615, 1.0595238095238095, 1.0833901863028077, 1.1589861751152073, 1.0018181818181817, 1.2293193717277486, 1.1296296296296295, 1.0097245096571343, 1.008286643104076, 1.0252996005326231, 1.0, 1.1428571428571428, 1.8333333333333333, 1.5, 1.1428571428571428, 1.002172641430601, 1.25, 1.0732113144758735, 1.0297029702970297, 1.0029646522234892, 1.0165034345224906, 1.005175983436853, 1.1111793321683276, 1.0286396181384247, 1.2669683257918551, 1.5, 1.1214953271028036, 1.0585585585585586, 1.0027574314720025, 1.1904761904761905, 3.142857142857143, 1.1024498886414253, 1.036046511627907, 1.0119602905968794, 1.1380753138075315, 1.342769701606733, 1.026973869064344, 1.3333333333333333, 1.0808477237048666, 1.0095338983050848, 1.3076923076923077, 1.0584707646176912, 1.2424242424242424, 1.0583951937594362, 1.019279274371476, 1.0126574791506477, 1.1168831168831168, 1.045045045045045, 1.0783132530120483, 1.0, 1.0204932442613894, 1.0195540027561052, 1.0057367012833884, 1.0080980389807972, 1.0432205010518263, 1.0118971061093247, 1.8333333333333333, 1.1968162083936325, 1.2, 1.0512382578992314, 1.1111111111111112, 1.0252888161046312, 1.0115942028985507, 1.0981298366294068, 1.2292490118577075, 1.1666666666666667, 3.0, 1.0270758122743682, 1.0096561219631284, 1.0031956961559683, 1.0, 1.0677966101694916, 1.0235756385068762, 1.3620689655172413, 1.0732332332332333, 1.1057471264367815, 1.2352941176470589, 1.1596203623813632, 1.1098698202725126, 1.0955171512821469, 1.0093463701408996, 1.188267543859649, 1.1243781094527363, 1.0568181818181819, 1.25, 1.0380710659898478, 1.3448275862068966, 1.044338335607094, 1.064516129032258, 1.0261180604059517, 1.3157894736842106, 1.1165571942000247, 1.0668463414186973, 1.0908479138627187, 1.0, 1.1176470588235294, 1.24, 1.0011284485777656, 1.2800875273522976, 1.0, 1.1214423873998343, 1.015669783395198, 1.1249417249417248, 1.0, 1.5, 1.1444660194174758, 1.0026954177897573, 1.326086956521739, 1.0, 1.0147931921630715, 1.0495540138751238, 1.0869565217391304, 1.0113370998116762, 1.0272727272727273, 1.0026246719160106, 1.153225806451613, 1.027345393352966, 1.1268009873141611, 1.0, 1.0675675675675675, 1.1049893034555278, 1.0002088054010998, 1.0614210883944162, 1.0, 1.0002212389380531, 1.0290120954118522, 1.0288108957569408, 2.0, 1.122408293460925, 1.0718421919871945, 1.1319692071849903, 1.2043161067668515, 1.0278942334337484, 1.1847423374873696, 1.0176470588235293, 1.052314368370299, 2.0, 1.0630523541268282, 1.1935483870967742, 1.25, 1.2532467532467533, 1.1304347826086956, 1.0241893143586438, 1.0748858447488585, 1.0765907831106523, 1.1727664155005382, 1.049794636955906, 1.0511872600597185, 1.0088916616620702, 1.087378640776699, 4.0, 1.0431064698115473, 1.0077519379844961, 1.0055522020887668, 1.0106415630005467, 1.1076144984546221, 1.206336939721793, 1.1117021276595744, 1.4285714285714286, 1.0082849532974114, 1.0186846122135194, 1.0397120254334404, 1.1031114327062228, 1.0482591338622467, 1.0865979381443298, 1.0035684808467253, 1.0113268608414239, 1.079779917469051, 2.0, 1.0833333333333333, 1.0124223602484472, 1.0560747663551402, 1.0084602368866329, 1.036860879904875, 1.1778290993071594, 1.3006535947712419, 1.0554699537750385, 1.0769230769230769, 1.0149965262283878, 1.3614457831325302, 1.0012780438230449, 1.0, 1.0395817774458551, 1.4761904761904763, 1.0425531914893618, 1.0090191657271703, 1.1051995163240629, 1.0098814229249011, 1.0051880674448768, 1.077626329787234, 1.0, 1.9148936170212767, 1.3333333333333333, 1.0, 1.035294117647059, 1.092511013215859, 1.3642105263157895, 1.1318681318681318, 1.0299583466837552, 1.1601615074024225, 1.028964406837724, 1.0227272727272727, 1.1016393442622952, 1.0336994774448118, 1.0108108108108107, 1.0716550412175017, 1.14707305273343, 1.0937161430119176, 1.0780346820809248, 1.0439312869614192, 1.0115337297518967, 1.0017500767577525, 1.0108584040506567, 2.0, 1.0442260442260443, 1.0166358595194085, 1.0410958904109588, 1.0, 1.108695652173913, 1.25, 1.0125448028673836, 1.4814814814814814, 1.5, 1.031303740996436, 1.0406433268171318, 1.001649033860162, 1.0397080750215806, 1.0918918918918918, 1.0680437424058322, 2.0, 1.1755725190839694, 1.143724856038495, 1.0227939578352532, 1.0077408002324661, 1.0029616129399703, 1.0135884140890399, 1.0635359116022098, 1.0343001309606348, 1.1136767317939609, 1.0163168569540348, 1.0028897381351305, 1.3636363636363635, 1.1304836895388077, 1.0, 1.0113378684807257, 1.0213279608176875, 3.0, 1.071151885830785, 1.0180630115286455, 1.2857142857142858, 1.178118236217799, 1.2, 1.1875, 1.0178257790368272, 1.7692307692307692, 1.0183882624512044, 1.0132422041862452, 1.2258064516129032, 1.2083333333333333, 1.2663185378590078, 1.0066953610712577, 1.141633064516129, 1.0152302893143312, 1.010304056305736, 1.0, 1.1716271996524006, 1.0121951219512195, 2.0, 1.0536245588947575, 1.0219707351575968, 1.0662251655629138, 1.0160746115598747, 1.0414386837574134, 1.3452380952380953, 2.142857142857143, 1.0486877139596804, 1.0376569037656904, 1.006610186861613, 1.094062708472315, 1.0370470696044585, 1.1386443312869812, 1.0677655677655677, 1.024390243902439, 1.1115241635687731, 1.0352326590560117, 1.092744479495268, 1.0153985507246377, 1.103466386554622, 1.0459681448820555, 4.0, 1.001494337248322, 1.034393764909106, 1.0270789384236054, 1.1176470588235294, 1.0332161561087596, 1.355, 1.0, 1.0155180926853353, 1.0134426229508198, 1.106280193236715, 1.1176470588235294, 1.6666666666666667, 1.029785108149566, 1.5, 1.341692789968652, 1.0769230769230769, 1.1122392017305143, 1.2857142857142858, 1.2153846153846153, 1.1027253668763102, 1.0, 1.189153439153439, 1.0387228260869565, 1.75, 1.0, 1.0901639344262295, 1.0469314079422383, 1.0945303210463733, 1.0127523910733263, 1.0440456769983686, 1.0737463126843658, 1.089150378938971, 1.0467532467532468, 1.5605095541401275, 1.5217391304347827, 1.4615384615384615, 1.0, 1.1571594877764844, 1.2092352092352092, 1.0544662309368191, 1.0912379875635954, 1.0131440464505752, 1.188264779596049, 1.012754572673643, 1.0040285994265596, 1.0673886883273165, 1.0145278450363195, 1.375, 1.0, 1.0303030303030303, 1.0309834911196307, 1.1467611336032388, 1.0065359477124183, 1.2492307692307691, 1.0723940435280641, 1.0397540755577812, 1.0029351784191007, 1.1025641025641026, 1.1, 1.0318282753515915, 1.1127386002120891, 1.0495404293611004, 1.089691907109531, 1.25, 1.0719137625516835, 1.000887156700687, 1.1978527607361964, 1.046908315565032, 1.1111111111111112, 1.0705654905751572, 1.1113892365456821, 1.0192307692307692, 1.3297101449275361, 1.0347890451517394, 1.0, 1.1259640102827764, 1.0105411103302882, 1.1851851851851851, 1.0016984833261566, 1.1906779661016949, 1.069767441860465, 1.015204933425411, 1.0153929343907715, 1.108246038141284, 1.0028625954198473, 1.0080091533180777, 1.0123140216411182, 1.1428571428571428, 1.0, 1.0, 1.25, 1.0190626135400267, 1.8333333333333333, 1.0003148614609572, 1.0648322653599698, 1.2660611431103235, 1.0744771660264618, 1.0032526647194933, 1.1606645230439443, 1.0608365019011408, 1.0166435506241331, 1.0047338389649423, 1.0668533426671334, 1.007899719579129, 1.0096674165501307, 1.25, 1.103448275862069, 1.3359683794466404, 1.0155984609518527, 1.0618892508143323, 1.0213178294573644, 1.152212389380531, 1.02729044834308, 1.0379955112068182, 1.0390516039051605, 1.0329425837320574, 1.25, 1.0011001812063163, 1.010880001324306, 1.1427927927927928, 1.0008428150021071, 1.1875, 1.0674518201284797, 1.1044776119402986, 1.625, 1.0474288743594276, 1.4615384615384615, 1.0431125131440588, 1.0263736263736263, 1.2238705327039785, 1.0513365197380067, 1.0835294117647059, 1.1818181818181819, 1.087378640776699, 1.0037317548439282, 1.00188141518046, 1.018135371898731, 1.1620519628295087, 1.0381287939890478, 1.0, 1.0419407894736843, 1.1500293025981636, 1.0846019911603197, 1.021494370522006, 1.2083333333333333, 1.021190261496844, 1.0514006224988883, 1.1953125, 1.026851609526302, 1.0, 1.3333333333333333, 1.0100583825681337, 1.0039397776839736, 1.0015772263896903, 1.1068373438365438, 1.0710295291300878, 1.1111111111111112, 1.004484923756296, 1.1231874237701585, 1.0522243713733075, 1.2648648648648648, 1.0077628793225124, 1.0404825013498258, 1.0, 1.75, 1.0265333630506999, 1.0048415370488883, 1.020954598370198, 1.24822695035461, 1.054670528602462, 1.0002712552860005, 1.007934258996883, 1.0471204188481675, 1.1923076923076923, 1.1543126684636118, 1.0210526315789474, 1.11875, 1.6538461538461537, 1.0486087831042574, 1.0138751238850348, 1.0835579514824798, 1.1714285714285715, 1.0496004279934463, 1.073844884488449, 1.011681056373794, 1.0264281357999594, 1.6666666666666667, 1.037037037037037, 2.0, 1.0342219020172911, 1.4615384615384615, 1.0, 1.5, 1.1723602484472049, 1.0534351145038168, 1.0415277030661647, 1.0048731546509961, 1.0848126232741617, 1.5441176470588236, 1.0, 1.0, 1.3243243243243243, 1.4893617021276595, 1.0093457943925233, 1.014301344697865, 1.0086301103276898, 1.0625, 1.0257688598920827, 1.0002502377258395, 5.0, 1.006277431866898, 1.1014285714285714, 1.0, 1.3333333333333333, 1.078698224852071, 1.166104855483038, 1.0099086545904938, 1.065217391304348, 1.0, 1.015748031496063, 1.1411042944785277, 2.0, 1.5, 1.0959645669291338, 1.011420802175391, 1.1154006968641115, 1.25, 1.0027892110800831, 1.069713400464756, 1.0833333333333333, 1.1428571428571428, 1.0812182741116751, 1.0030453576782676, 1.5, 1.1352850539291217, 1.032934671554781, 1.0119047619047619, 1.01953125, 1.0208126721763084, 1.156276686592656, 1.0991735537190082, 1.2545454545454546, 1.0348975399398992, 1.0964194716373876, 1.0651684895227331, 1.7956989247311828, 1.2142857142857142, 1.1791044776119404, 1.0580474934036939, 1.0379436964504285, 1.0118161527818454, 1.0145391837516766, 1.0480349344978166, 3.0, 1.25, 1.0057853352937416, 1.0941072999120494, 1.2713479867730013, 1.0116710743596429, 1.0055499495459133, 1.0981669380767465, 1.065217391304348, 1.0208333333333333, 1.0219312339331619, 1.0184241637982445, 1.102533883323512, 1.059369202226345, 2.5, 1.0666666666666667, 1.1210242488719322, 1.0934289127837515, 1.0042453864711596, 1.0170204245094112, 1.1178977272727273, 1.6, 1.0058754406580495, 1.0346523356381643, 1.0440941283984464, 1.0038022813688212, 1.02796452581891, 1.250996015936255, 1.3073593073593073, 1.0782608695652174, 1.0035508259767503, 1.0470691934773029, 1.0783410138248848, 1.1101152368758003, 1.03125, 1.0738209159261791, 1.00762233736327, 1.0501981505944518, 1.0659747199671155, 1.0521077283372364, 1.0669895076674738, 1.3846153846153846, 1.0870488322717622, 2.5, 1.5, 1.4166666666666667, 1.020460358056266, 1.1563981042654028, 1.0654684540829589, 1.0361116896583813, 1.0116689280868385, 1.0422594142259414, 1.1032608695652173, 1.5714285714285714, 1.0099398836956446, 1.6, 1.25, 1.2445528455284554, 1.0, 1.266441821247892, 1.1420682730923695, 1.0070799673232278, 1.0227800230478323, 1.25, 1.0609907120743034, 1.2655038759689923, 1.1261845386533667, 1.000165142159876, 1.0702702702702702, 1.0480976310122039, 1.0297373170242632, 1.0736525908381953, 1.124006359300477, 1.4489795918367347, 1.229050279329609, 1.0, 1.0, 1.000710811487429, 1.6666666666666667, 1.5714285714285714, 1.3846153846153846, 1.0247218788627936, 1.1058823529411765, 1.014623172103487, 1.0814594823928723, 1.0, 1.2700186219739293, 1.022089552238806, 1.1704035874439462, 1.0096153846153846, 1.25, 1.0158045977011494, 1.1413525498891353, 1.0934182590233545, 1.029378951283005, 1.0078254545454546, 1.2855990783410138, 1.065217391304348, 1.0, 1.068194143167028, 1.0008461303986798, 1.028873744619799, 1.2695652173913043, 1.0278587305507532]
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.5449	median: 1.0607	mean: 1.1473

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 15.789764 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=naru', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[2.9802322e-07 6.5565109e-07 4.7683716e-07 3.5762787e-07 1.1920929e-07]
Distance score: 3.814697322468419e-07
SAUCE Drift detection: False
Detection latency: 0.0232s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 2.031109 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 6.0000	99th: 3.0000	95th: 1.7190	median: 1.0635	mean: 1.1692
ReportEsts: [1.1393939393939394, 1.031496062992126, 1.041748915571761, 1.0306946688206786, 1.0294117647058822, 1.0, 1.162037962037962, 1.0159919434527303, 1.0, 1.0109649122807018, 1.0133243542257926, 1.0027664015832773, 1.073318216175359, 1.0114942528735633, 1.0316901408450705, 3.8333333333333335, 1.1357615894039734, 1.1153846153846154, 1.5555555555555556, 1.0183727034120735, 1.0890100843795019, 1.0758625099920065, 1.1221864951768488, 1.161596958174905, 1.012810374822078, 1.004066184540057, 2.0, 1.0312776867935673, 1.1666666666666667, 1.0, 1.0918918918918918, 1.0, 1.0006695280179856, 1.0017242660340089, 1.409282700421941, 1.0524267120788224, 1.025551553354345, 1.090069284064665, 2.0, 1.125591669296308, 1.028737827000191, 1.1567192669890558, 1.0667447306791569, 1.092063492063492, 1.0072859744990892, 1.0893920509624706, 1.2380952380952381, 1.0384615384615385, 1.703448275862069, 1.1302043906131718, 1.0952380952380953, 1.0408921933085502, 1.1081081081081081, 1.0625, 1.0546696496572734, 1.0335683252725634, 1.0615315852205005, 1.0814977973568283, 1.108433734939759, 1.004377801207041, 1.0317460317460319, 1.0364604125083168, 1.1284671532846715, 1.0909090909090908, 1.1057692307692308, 1.0, 1.0653069455247313, 1.0259089009611366, 1.2857142857142858, 1.0, 1.153797921891795, 1.019019019019019, 1.053088803088803, 1.1111111111111112, 1.0900182050586822, 1.0845070422535212, 1.0551479107129065, 1.052132701421801, 1.070921985815603, 1.0180492535128807, 1.165811965811966, 1.271551724137931, 1.0, 1.1538461538461537, 1.0648259303721488, 1.0833333333333333, 1.0326086956521738, 1.2727272727272727, 2.0, 1.0115465304357574, 1.0858775510204082, 1.0241235835694051, 1.0256107171000788, 1.3470388532629196, 1.0103626943005182, 1.2144522144522145, 1.0053050397877985, 1.0782493368700266, 1.0571428571428572, 1.141897233201581, 1.4482758620689655, 4.0, 1.0508723929132093, 1.12, 1.0057512580877066, 1.0165769000598444, 1.1, 1.0157857919892759, 1.1164451009354996, 1.0993077924748131, 1.042857142857143, 1.0265625, 1.1428571428571428, 1.25, 1.1438752783964365, 1.010709909112571, 1.0826161790017212, 1.0777777777777777, 1.005179477801885, 1.0, 1.2926251691474966, 1.1849148418491484, 1.0, 1.2268518518518519, 1.0, 1.0637860082304527, 1.0127469105770166, 1.0914727691127588, 1.1031746031746033, 2.0, 1.1919191919191918, 1.0, 2.0, 1.0113488372093022, 1.3846153846153846, 1.0653487095002745, 1.009779267951942, 1.0420902806018706, 1.0, 1.4666666666666666, 1.014344262295082, 1.0227374052608114, 1.0495471497069793, 1.0215563100151117, 1.1597938144329898, 1.0434782608695652, 1.013165513668363, 3.0, 1.0185543100115964, 1.0717948717948718, 1.0370558375634518, 1.0422021028037383, 1.0, 1.0652459347540653, 1.0127064803049555, 1.0049180327868852, 1.0712468193384224, 2.0, 1.0603621730382293, 1.0026572985632571, 1.0160888718636276, 1.0771653543307087, 1.1476323119777159, 1.0545454545454545, 1.1988636363636365, 1.1178082191780823, 1.0, 1.0007353188185628, 1.011111111111111, 1.1194209891435465, 1.0069510581587846, 1.1692208766477334, 1.0376309042714986, 1.0126582278481013, 1.0593525179856116, 1.1787121151217943, 1.0825174825174826, 1.1607290803645403, 1.0405405405405406, 1.020514152168268, 1.0525853509508898, 1.016134868771153, 1.148936170212766, 1.16, 1.0202248126176197, 1.0325128118961606, 1.0422535211267605, 1.047451049567825, 1.2159090909090908, 1.25, 1.0936708860759494, 1.015873129314904, 1.1111111111111112, 1.014018691588785, 1.3298989113530326, 1.0022152948199243, 1.001099668315054, 1.0263157894736843, 1.014465585853028, 1.0913203424406148, 1.0851538118591173, 1.0943396226415094, 1.120671283963772, 1.0002314745676653, 1.1676240208877284, 1.1374199771989828, 1.304093567251462, 1.0506329113924051, 1.02, 1.0, 1.0546448087431695, 1.007207564636646, 1.630813953488372, 1.2142857142857142, 1.0206953642384107, 1.3333333333333333, 1.0001824804952453, 1.0363636363636364, 1.0306874819788276, 1.2857142857142858, 1.1042780748663101, 1.0282438478747205, 1.0358834178565863, 1.0054273695857459, 2.3333333333333335, 1.1119544592030361, 1.0138800019687946, 1.000146013822642, 1.0136612021857923, 1.3316912972085386, 1.0810363836824697, 1.0516667733060336, 1.0338983050847457, 1.00307607761682, 1.0588242077586605, 1.1911764705882353, 1.119724375538329, 1.025, 5.0, 1.1211525867714474, 1.0, 1.0279832100739557, 1.1410803786894375, 1.12548942834769, 1.4730158730158731, 1.1538461538461537, 3.3333333333333335, 1.0854009032787846, 1.088235294117647, 1.0895791524881482, 1.5, 1.0425531914893618, 1.0467091295116773, 1.2857142857142858, 1.0039103541437904, 1.1782407407407407, 1.0799238820171266, 1.2447368421052631, 1.0042583392476934, 1.0280387409200968, 1.1044776119402986, 2.0, 1.0061096829477292, 1.134324092597885, 1.1644444444444444, 1.0089934704940249, 1.0804975753742356, 1.0486519854144534, 1.1053677932405566, 1.0149372224999265, 1.0742226680040121, 1.1554779806659505, 1.3573114845160394, 1.9230769230769231, 1.083589907633252, 1.1941391941391941, 1.1355932203389831, 1.1481481481481481, 1.0750382848392037, 1.2082658022690438, 1.037404776170504, 1.021727477396991, 1.0808314087759816, 1.199004975124378, 1.0076559278476436, 1.0578687367678192, 1.1330496863056176, 1.0054673043716353, 1.7, 1.0255905511811023, 1.112530413625304, 1.0387124196897122, 1.0067801934580296, 1.011303746282601, 1.119536598209584, 1.0043715846994536, 1.0517397198373248, 1.0207194344813177, 1.0024604696602382, 1.0407862809782165, 1.0832526621490803, 1.3225806451612903, 1.1666666666666667, 1.0746172441579371, 1.0625, 1.0217785843920144, 1.0420054031067865, 1.036741214057508, 1.135135135135135, 1.28, 1.0573476702508962, 1.2113259668508287, 1.025287561374132, 1.1428571428571428, 1.0134895278665246, 1.004542162475708, 1.036231884057971, 1.8, 2.875, 1.0918055881662363, 1.3333333333333333, 1.0193972588499385, 1.0568356374807988, 1.0, 1.0284473653327075, 1.1071428571428572, 1.5, 1.003375512512371, 2.0, 1.2924528301886793, 1.0774818401937045, 1.0995989304812834, 1.1248454882571075, 1.1032967032967034, 1.2095238095238094, 1.00875806961311, 1.0081075963918154, 1.1775700934579438, 1.0205786570526008, 1.1162429652629535, 3.0, 1.2, 1.0132144132665373, 1.0, 1.0479233226837061, 1.0, 2.5, 1.173913043478261, 1.089579524680073, 1.0805422647527911, 1.2093023255813953, 1.0517904705534182, 1.3333333333333333, 2.5, 1.0308427484042735, 1.032258064516129, 1.1, 1.034705852597501, 1.257462686567164, 1.0719424460431655, 1.0056497175141244, 2.25, 1.0, 1.1512195121951219, 1.40625, 1.0780933062880325, 1.0116622950477046, 1.068069306930693, 1.0100250626566416, 1.5, 1.003734789063322, 1.1096774193548387, 1.3125, 2.0, 1.1055900621118013, 1.25, 1.1435643564356435, 1.032520325203252, 1.0484071861343918, 1.0162987399904082, 1.0565770862800565, 1.081714814210326, 1.0454990900181997, 1.1676300578034682, 1.0327868852459017, 1.034838978713725, 1.048048048048048, 1.088235294117647, 1.0080968769189027, 1.0160950519103384, 1.129860636215719, 1.0634146341463415, 1.225, 1.093385214007782, 3.0, 1.8518518518518519, 1.140625, 1.0229885057471264, 1.7304347826086957, 1.0564853556485356, 1.0398386283408976, 1.4, 1.2448469706433478, 1.1535493827160495, 1.2363341151001264, 1.3918918918918919, 1.1492537313432836, 1.0425, 1.0, 1.0214525945496427, 1.3103448275862069, 1.0054454696717592, 1.011026698502279, 1.071616977060187, 1.0075046904315197, 1.8571428571428572, 1.2835760517799353, 1.2, 1.005592841163311, 1.0, 1.0875632369811747, 1.0296208530805686, 1.026136572795877, 1.1933333333333334, 1.0104602510460252, 3.0, 1.149434794596085, 1.0032834269342428, 1.0051355753569033, 1.0, 1.1774193548387097, 1.0039745627980923, 1.159144893111639, 1.0942282243561468, 1.093782799283818, 1.04, 1.1364285714285713, 1.0783048211508555, 1.0596938538128693, 1.0426547034109521, 1.111298944035048, 1.0611467999048299, 1.0, 1.2347052280311457, 1.0063381062262573, 1.2781954887218046, 1.0092592592592593, 1.0, 2.0, 1.1058271935699933, 1.119047619047619, 1.203276496155132, 1.0099565217391304, 1.1935881627620222, 1.0, 1.0476190476190477, 1.1935483870967742, 1.046952716540942, 1.08, 2.0, 1.0661352229111307, 1.0, 1.0, 1.085820895522388, 2.0, 1.1629104958145524, 1.0022607385079125, 1.4264150943396225, 1.3, 1.0244911399699521, 1.0246422893481717, 1.037037037037037, 1.0642382861438235, 1.0384615384615385, 1.135135135135135, 1.178812415654521, 1.0505121865065348, 1.1540620243531203, 1.0, 1.0813953488372092, 1.0576860045886594, 1.033650218801871, 1.0913780397936625, 1.4, 1.0239134560637693, 1.0103142983621072, 1.0355887521968365, 2.0, 1.1150265957446808, 1.06607739570982, 1.1169999725674156, 1.12588478710661, 1.0225598731400793, 1.0186253371416751, 1.0825035561877667, 1.0213039915720472, 1.75, 1.0881809192140677, 1.0306871247498333, 1.0406054781355119, 1.0600109110747409, 1.077319587628866, 1.0349706718485732, 1.0191458026509572, 1.0641008277499382, 1.210574712643678, 1.0258183672095194, 1.0476190476190477, 1.0115307150050352, 1.166026943629111, 1.0121951219512195, 1.4054054054054055, 1.019616423760417, 1.061269146608315, 1.019358839548114, 1.0026974409494993, 1.0, 1.2647619047619048, 1.0304709141274238, 1.0, 1.435897435897436, 1.011029618652811, 1.1744186046511629, 1.0239767083404692, 1.0, 1.0212765957446808, 1.0326241134751772, 1.0701735179812797, 1.0255871682260835, 1.0287606831979141, 1.0322935779816513, 1.0192307692307692, 1.1022975929978118, 1.0271127819548873, 1.3037037037037038, 1.04007722366952, 1.0333167578319244, 1.0625, 1.0005094571332043, 1.1061343719571568, 1.0651127819548871, 1.5, 1.119837508463101, 1.3709677419354838, 1.0351692894611348, 1.0222672064777327, 1.1397058823529411, 1.1094771241830066, 1.041062801932367, 1.0077363896848137, 1.0, 1.85, 2.4285714285714284, 1.6666666666666667, 1.0194174757281553, 1.263157894736842, 1.419182948490231, 1.1135371179039302, 1.031726907630522, 1.0382626680455016, 1.0248208255560463, 1.0090599762226868, 1.004359301717922, 1.030809430410573, 1.0320421489561193, 1.0679304897314377, 1.0366666666666666, 1.0072131698908715, 1.1335326357747881, 1.0022172949002217, 1.1637055837563453, 1.0476190476190477, 1.0229815420655115, 1.1646634615384615, 1.0088087331729336, 1.0751173708920188, 1.1003167898627244, 1.0241391551295704, 2.5, 1.01270207852194, 1.0625, 2.2, 1.1756373937677054, 1.0277481482586546, 1.0211946050096339, 1.1324324324324324, 1.087719298245614, 1.0004011377725914, 1.1454817275747509, 1.030520646319569, 1.2, 2.0, 1.0796128809263206, 1.1666666666666667, 1.001231527093596, 1.0107066381156318, 1.0, 1.1929170549860204, 1.0898058252427185, 1.0544104627141548, 1.1751824817518248, 1.0238562457950213, 1.1087437271412774, 1.0045089666951323, 1.240506329113924, 1.0, 1.134055168857953, 2.0, 1.1016109045848823, 1.1788617886178863, 1.1371927042030134, 1.1733333333333333, 1.21875, 1.0997413649257468, 1.1555555555555554, 1.0636704119850187, 1.1214285714285714, 1.1249178172255094, 1.0635939323220536, 1.0372350768034222, 1.0400728597449909, 1.0108196721311475, 1.6, 1.1454401825682436, 1.1288753358019312, 1.2380952380952381, 1.0196877121520707, 1.0516030041185496, 1.1573033707865168, 1.121049972027215, 1.0909090909090908, 1.1287726358148893, 1.0581046090108752, 1.1074766355140186, 1.1733333333333333, 1.0154344432665259, 1.2735849056603774, 1.875, 1.0538656527249683, 1.044871794871795, 1.0586065052372673, 1.0957565605806812, 1.0528068186185955, 1.0063847774068289, 1.0075187969924813, 1.0096875, 1.1134969325153374, 1.015516155328294, 1.0654885654885655, 1.0186706497386109, 1.1742591773551525, 1.002570009245765, 1.4285714285714286, 1.1182266009852218, 1.25, 1.0, 1.0335403726708075, 1.0271022832745498, 1.0471138845553822, 1.0240963855421688, 1.5555555555555556, 1.0314769975786926, 1.0955391640323147, 1.7184466019417475, 1.0127956333015613, 2.3333333333333335, 1.0152619329238048, 2.5, 1.2928039702233252, 1.2857142857142858, 1.0897599814029175, 1.3636363636363635, 1.1604938271604939, 1.1458515283842794, 1.0, 1.015295148570063, 1.0394588500563697, 2.25, 1.0, 1.0526315789473684, 1.0237388724035608, 1.1091670773780187, 1.0026408450704225, 1.0583333333333333, 1.1215859030837005, 1.1037463976945245, 1.0562546262028127, 1.543956043956044, 1.164, 1.2758620689655173, 1.0, 1.086442220200182, 1.215496368038741, 1.04014272970562, 1.2045359966708282, 1.0138043156961276, 1.2015821736249173, 1.0280430405079868, 1.0222837870392676, 1.0468909276248726, 1.0209476309226932, 1.5, 1.0, 1.0256410256410255, 1.043630823214368, 1.1531223267750215, 1.016260162601626, 1.150943396226415, 1.0376651422764227, 1.0274068712066373, 1.0045872375228917, 1.1136363636363635, 1.173913043478261, 1.1576086956521738, 1.0964358284364875, 1.0695919812605545, 1.022550774942607, 1.2372881355932204, 1.076327909118821, 1.0090535797072653, 1.0163348727729353, 1.0412451361867705, 1.0094173414971361, 1.1026490066225165, 1.0488573680063042, 1.2857142857142858, 1.0006222428332008, 3.0, 1.047554347826087, 1.0, 1.1464968152866242, 1.0487419609612998, 1.2537313432835822, 1.0139533005310735, 1.142608695652174, 1.12, 1.0594627803684196, 1.0234041273088261, 1.1084755244755244, 1.003187250996016, 1.03768115942029, 1.0095379049498439, 1.1631578947368422, 1.125, 1.0, 1.3636363636363635, 1.01702093169338, 2.1666666666666665, 1.0573529411764706, 1.0558839333691563, 1.1049360146252285, 1.0760150241459487, 1.0109552740434333, 1.0288, 1.0723270440251573, 1.0069686411149825, 1.0285397693012475, 1.0819367246444196, 1.0053766016045982, 1.0429104010808918, 1.2, 1.049095607235142, 1.2905405405405406, 1.0175190648647057, 1.0194444444444444, 1.0049804340092494, 1.2088235294117646, 1.0490998363338788, 1.0623629767116998, 1.0425776754890679, 1.0186604329708304, 1.1904761904761905, 1.006356306279795, 1.0109897309636617, 1.084051724137931, 1.0, 1.2162162162162162, 1.1406926406926408, 1.0276304921265087, 1.0616792548245542, 1.4950980392156863, 1.0053505298822045, 1.2222222222222223, 1.0739923954372623, 1.319189360354655, 1.0911360799001248, 1.2380952380952381, 1.096745027124774, 1.1719038817005545, 1.1195294117647059, 1.0644352808029542, 1.0555555555555556, 1.0764067042927998, 1.0250943304110085, 1.2142857142857142, 1.0488308115543328, 1.0151865302079894, 1.026446047235186, 1.163265306122449, 1.4819532908704882, 1.2280524722502524, 1.0269662921348315, 1.0255754475703325, 1.00106872379805, 1.1975308641975309, 1.0425783560023654, 1.0211059938371823, 1.0139372822299653, 1.6094488188976377, 1.008493743087572, 1.0512416047354984, 1.0099272005294506, 1.1382113821138211, 1.0026561189414995, 1.0770749918839952, 1.0173501577287065, 1.3031674208144797, 1.0413030831879, 1.003840782122905, 1.0490196078431373, 2.25, 1.0413842023507016, 1.0147838606594797, 1.0028749401054144, 1.251497005988024, 1.023977866584691, 1.0217643576080522, 1.0173437871228321, 1.0924431401320616, 1.2424242424242424, 1.1184510250569477, 1.0344827586206897, 1.0566502463054188, 1.8, 1.0331295786477532, 1.0056956875508543, 1.2118644067796611, 1.2162162162162162, 1.042296072507553, 1.051220679751077, 1.053191489361702, 1.2307692307692308, 1.0311915159076732, 1.158139534883721, 1.0050925925925926, 1.2727272727272727, 1.0074879025529784, 1.0077120822622108, 1.167728813559322, 1.1043478260869566, 1.0416666666666667, 1.0941245249926923, 1.0234605829866674, 1.0002120947002837, 1.1663716814159293, 1.3975903614457832, 1.105263157894737, 1.0256410256410255, 1.411764705882353, 1.2575757575757576, 1.0698272693862552, 1.0136672400057427, 1.00099714482135, 1.0592105263157894, 1.0264541823589404, 1.002254443131672, 6.0, 1.0465076949095213, 1.0496343394234877, 1.0, 1.4285714285714286, 1.0302285573851069, 1.102670870263518, 1.0562761547767796, 1.0407124681933841, 1.0, 1.0258899676375404, 1.2041884816753927, 1.0384615384615385, 1.0425420168067228, 1.047298969072165, 1.0117538640626011, 1.1656197149069825, 1.3333333333333333, 1.0048676292955374, 1.0591639871382637, 1.0067739204064352, 1.014218009478673, 1.0970414201183432, 1.0, 1.235239852398524, 1.0971453970762544, 1.0437523236556596, 1.2281879194630871, 1.0133779264214047, 1.0521745123716315, 1.1631799163179917, 1.1914893617021276, 1.3015873015873016, 1.0455130220989737, 1.0430480465163725, 1.073051183827941, 1.4444444444444444, 1.4166666666666667, 1.0107066381156318, 1.25, 1.0215743440233236, 1.0670103092783505, 1.013712605395025, 1.0930875576036867, 1.5, 1.0538922155688624, 1.0426198029721157, 1.1534781008465218, 1.2582212862465576, 1.4103896103896103, 1.0395377975776139, 1.1070104246834114, 1.1106471816283925, 1.0169491525423728, 1.0083989154156472, 1.0208624159636877, 1.0798628123468887, 1.1635434412265757, 3.0, 1.2142857142857142, 1.1321625084796865, 1.200286123032904, 1.0094999409534058, 1.0062473199854867, 1.1067216981132075, 1.5, 1.003898635477583, 1.019636486220749, 1.046875, 1.0811688311688312, 1.0274255103460614, 1.1117824773413898, 1.1875693673695893, 1.099086099086099, 1.0016306291561343, 1.0120153128908767, 1.1215043394406943, 1.0752577319587628, 1.054054054054054, 1.0675618073316282, 1.0549463718617054, 1.0456235627966144, 1.0493937232524964, 1.018370230805464, 1.0489094514210178, 1.3018867924528301, 1.0859649122807018, 2.5, 1.5, 1.3333333333333333, 1.010548523206751, 1.0992720052945069, 1.0441628622006895, 1.028339620843003, 1.0849954669084316, 1.0421749738584873, 1.0044444444444445, 1.0691056910569106, 1.0074004678321224, 1.5, 1.5, 1.2023874118285405, 1.0, 1.1608751608751608, 1.1634125636672326, 1.0105920902232721, 1.0148318135970702, 1.5, 1.0522306855277475, 1.1865079365079365, 1.0734665171358513, 1.0012361223263593, 1.0749724366041897, 1.0316100443131462, 1.017512007526367, 1.063327302161699, 1.1291611185086552, 1.6603773584905661, 1.2655889145496535, 1.0, 2.0, 1.0016333897685659, 1.25, 1.625, 1.5227272727272727, 1.0589390962671905, 1.0216099405726635, 1.0344224037339556, 1.0116279069767442, 1.1666666666666667, 1.5785714285714285, 1.0257553244180286, 1.2594458438287153, 1.0334728033472804]
origin-bjaq_15.87 	max: 6.0000	99th: 3.0000	95th: 1.7190	median: 1.0635	mean: 1.1692

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 20.558574 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=38.411886