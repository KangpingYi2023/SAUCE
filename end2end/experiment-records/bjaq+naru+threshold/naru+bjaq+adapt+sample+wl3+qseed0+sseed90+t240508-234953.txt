Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='naru', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 90, 'naru': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.5429	median: 1.0590	mean: 1.1464
ReportEsts: [1.1797752808988764, 1.0434782608695652, 1.0303332935845457, 1.0307692307692307, 1.0344827586206897, 1.0, 1.160474685431451, 1.019177395465421, 1.25, 1.0372836218375499, 1.020690849277119, 1.0028528691278804, 1.047975352112676, 1.011764705882353, 1.0197809961144473, 1.0, 1.6981132075471699, 1.0212539851222104, 3.0, 2.6666666666666665, 1.35, 1.091912874703472, 1.065791807057989, 1.0812698412698414, 1.062160828811051, 1.0, 1.1042887678411364, 1.3333333333333333, 1.4, 1.158273381294964, 1.0, 1.0111191860465116, 1.0036661581615078, 1.314095449500555, 1.0490527243354384, 1.026267686683366, 1.0106951871657754, 1.0040065075395188, 1.1188787106550038, 1.2857142857142858, 1.1589895988112928, 1.0945121951219512, 1.0, 1.1663363763360515, 1.0996452259756286, 1.2066115702479339, 1.1650485436893203, 1.3412322274881516, 1.038140422262931, 1.0588235294117647, 1.0408807304088072, 1.0678899082568807, 1.0052532755311951, 2.0, 1.348051948051948, 1.011717018177212, 1.008, 1.0566037735849056, 1.2546583850931676, 1.25, 1.026990185387132, 1.0361145703611456, 1.0328638497652582, 1.1379310344827587, 1.0, 1.0707832889135025, 1.0600780234070222, 1.1666666666666667, 1.0, 1.0573681616559882, 1.0286396181384247, 1.059675550405562, 1.1193693693693694, 1.0903123690703411, 1.1929411764705882, 1.115702479338843, 1.0, 1.0467657342657342, 2.0, 1.069585927860197, 1.0625, 1.0728657000503834, 1.2269938650306749, 1.0412844036697249, 1.0788777130757015, 1.04, 1.0068957625689576, 1.0627833322983296, 1.1274509803921569, 2.3333333333333335, 1.0798845043310876, 1.0053290669427273, 1.0594059405940595, 1.2917251051893408, 1.2358916478555304, 1.0845070422535212, 1.2272727272727273, 1.0271691498685365, 1.0, 1.023189993609057, 1.1026637868970481, 1.0147954743255005, 1.0038462895656164, 1.0294117647058822, 1.006972878362709, 1.1221328567173072, 1.0804949441192124, 1.0155479711793705, 1.019375, 1.1666666666666667, 1.3333333333333333, 1.1367861885790174, 1.0204157766171646, 1.063129617192747, 1.013157894736842, 1.0094175489433463, 1.0, 1.1984126984126984, 1.1320574162679427, 1.0, 1.1923076923076923, 1.0, 1.0977443609022557, 1.0159316889924905, 1.1381532965752892, 1.0566037735849056, 1.8, 1.1970198675496688, 1.0, 1.2142857142857142, 1.019149175450614, 1.1818181818181819, 1.0143635463100544, 1.0102369572999554, 1.0555991897813237, 1.1331316187594553, 1.042857142857143, 1.0019485580670304, 1.00199203187251, 1.051923076923077, 1.0497072218607677, 1.1604938271604939, 1.0554468362687541, 1.033935626745854, 2.0, 1.0129270544783011, 1.0670731707317074, 1.0732009925558312, 1.019057702488089, 1.0, 1.1418018890772583, 1.048888888888889, 1.008, 1.4476190476190476, 1.1372262773722628, 1.0547652916073968, 1.0509408751809375, 1.1045179908016953, 1.123574144486692, 1.1842105263157894, 1.0425531914893618, 1.1304347826086956, 1.1058631921824105, 1.1428571428571428, 1.0095557524364005, 1.0179947998078522, 1.0122377622377623, 1.0275128393250184, 1.0439828955406232, 1.0517876547136307, 1.0210526315789474, 1.1092436974789917, 1.1817565604725477, 1.1540256709451575, 1.16016016016016, 1.0446700507614213, 1.0309085232594444, 1.0510627901294893, 1.0896611999383066, 1.0, 1.008, 1.010409239982889, 1.0476190476190477, 1.136884942656308, 1.0410958904109588, 1.0124062743856237, 1.0205963122793251, 1.0565331255546178, 1.183673469387755, 1.0990909090909091, 1.02714293905166, 1.0, 1.6363636363636365, 1.0781848242255483, 1.2690124858115777, 1.1209302325581396, 1.4, 1.0327974276527332, 1.0088539155767746, 1.019925497913314, 1.1798245614035088, 1.1356593232844945, 1.0338983050847457, 1.109375, 1.0, 1.0, 1.032258064516129, 1.0134048257372654, 1.6306620209059233, 1.1494252873563218, 1.0173010380622838, 1.0957683741648108, 1.077555014030424, 1.0206427863514087, 1.0499447944404754, 1.2571428571428571, 1.066255778120185, 1.0366140409808533, 1.019665265839837, 1.0454757881870798, 1.0, 1.1246376811594203, 1.020680282827487, 1.005188677784967, 1.055774647887324, 1.0466397556185905, 1.0022415834884115, 1.0344827586206897, 1.0037275168422848, 1.0486749594375337, 1.1635645798082346, 1.0726256983240223, 1.0790292470441818, 1.0386847195357833, 1.1039370078740158, 1.0, 1.0063799621928167, 1.0757034390352835, 1.086263478668542, 1.3656716417910448, 1.0909090909090908, 2.6666666666666665, 1.0337313800320078, 1.1090909090909091, 1.0922149814308737, 1.5, 1.5, 1.3333333333333333, 1.0285026093938177, 1.530612244897959, 1.1049723756906078, 1.1245551601423487, 1.0949033391915641, 1.016211604095563, 1.075598584218197, 1.0701754385964912, 1.0, 1.0285197294018464, 1.15850144092219, 1.1313485113835378, 1.006187678993248, 1.1021994209376746, 1.0082496883815522, 1.1120826709062004, 1.0248754467193635, 1.0598086124401913, 1.1789283958708832, 1.2128388442061364, 1.5454545454545454, 1.0965909090909092, 1.1513859275053304, 1.25, 1.1904761904761905, 1.1534545454545455, 1.0555555555555556, 1.0833333333333333, 1.0107048613944885, 1.0696378830083566, 1.250783699059561, 1.0238600464922214, 1.0856102003642987, 1.010226893560227, 1.0133496755434581, 1.4, 1.1013277555474719, 1.0, 1.009480433340703, 1.0323974082073435, 1.0106581168666884, 1.3, 1.4285714285714286, 1.0869565217391304, 1.408450704225352, 1.004743705584996, 1.0, 1.0718654434250765, 1.0135746606334841, 1.0356570512820513, 1.0016901572340766, 1.1385542168674698, 1.0377358490566038, 1.0051944171002671, 1.0693996491823685, 1.1061665044678404, 1.0854700854700854, 1.0, 1.220763723150358, 1.002469135802469, 1.1651090342679127, 1.0292204977022457, 1.0345125107851596, 1.0113960113960114, 1.0535714285714286, 1.008230452674897, 1.0906021384355655, 1.4285714285714286, 1.024939933289696, 1.0714285714285714, 1.1176470588235294, 1.0550415012630818, 1.1904761904761905, 1.75, 1.040128897818145, 2.0, 1.0069060773480663, 1.052325581395349, 1.0311730926989335, 1.0117246596066565, 1.0407608695652173, 1.1868131868131868, 1.0225381836875498, 1.0108728284770738, 1.0040871934604905, 1.0496904595957526, 1.0932461210830544, 2.0, 1.2222222222222223, 1.0340394862766875, 1.3333333333333333, 1.0504109589041095, 1.0, 1.0, 1.0454545454545454, 1.180094786729858, 1.0822179732313575, 1.303030303030303, 1.0692640692640694, 1.0, 1.059254327563249, 1.0051137911393973, 1.5, 1.170935080405003, 1.0, 1.014165338191756, 1.072289156626506, 1.0512726318551562, 1.1612903225806452, 1.0018181818181817, 1.1979591836734693, 1.2222222222222223, 1.0082677371367914, 1.0019145005810732, 1.0106524633821572, 1.0, 1.1428571428571428, 1.8333333333333333, 1.5, 1.1428571428571428, 1.0020438200152966, 1.25, 1.124792013311148, 1.0495049504950495, 1.0801675060214584, 1.0298813291829065, 1.0041365046535677, 1.0767959193312238, 1.0341931613677264, 1.2574850299401197, 1.5, 1.0166666666666666, 1.053811659192825, 1.0005517905993533, 1.2857142857142858, 3.142857142857143, 1.1069042316258353, 1.008139534883721, 1.0007790175534086, 1.1380753138075315, 1.342769701606733, 1.0594202898550724, 1.4545454545454546, 1.0808477237048666, 1.0381355932203389, 1.1923076923076923, 1.0568862275449102, 1.0789473684210527, 1.03861409059341, 1.0078513190765093, 1.0290387670115486, 1.2463768115942029, 1.0471698113207548, 1.0623145400593472, 1.0, 1.0210398102442464, 1.0326685552988428, 1.0196317326038482, 1.0088957091990265, 1.0107095046854082, 1.0158166559070367, 1.8333333333333333, 1.1418234442836468, 1.5, 1.116994022203245, 1.1111111111111112, 1.0151892869749382, 1.0130434782608695, 1.0841573516766982, 1.1976284584980237, 1.0374687760199834, 3.0, 1.0451083772700644, 1.006386869615059, 1.0208651160607412, 1.0, 1.3695652173913044, 1.0335892514395393, 1.2614942528735633, 1.0962332828923151, 1.0124740124740124, 1.105263157894737, 1.1570319240724762, 1.0881809895529015, 1.0840394162218656, 1.0077358374330045, 1.1700657894736841, 1.3134328358208955, 1.0416666666666667, 1.0714285714285714, 1.0355329949238579, 1.3448275862068966, 1.0463847203274215, 1.121212121212121, 1.029335195885453, 1.0869565217391304, 1.1049855890108542, 1.019286014573991, 1.1335664335664335, 1.0, 1.0754716981132075, 1.32, 1.0031907856336821, 1.3479212253829322, 1.0, 1.0797872340425532, 1.008977830979739, 1.2821466524973433, 1.0, 2.0, 1.1833009708737865, 1.013623978201635, 1.4454976303317535, 1.0, 1.0250016491853025, 1.0382352941176471, 1.0869565217391304, 1.1508097928436911, 1.0272727272727273, 1.0, 1.1411290322580645, 1.0239798064787546, 1.1467194764938866, 1.0, 1.0810810810810811, 1.1231733161337878, 1.0033827145220902, 1.063305100080133, 1.0, 1.0168690958164643, 1.0152808659157353, 1.0288108957569408, 2.0, 1.120414673046252, 1.0326608916717668, 1.0756198739668767, 1.196278013192958, 1.0345247948754859, 1.159997801473013, 1.0530973451327434, 1.0405014464802314, 2.0, 1.037521318931211, 1.3454545454545455, 1.25, 1.3591549295774648, 1.1304347826086956, 1.0392899992636644, 1.1699801192842942, 1.0580021790240266, 1.0840796019900498, 1.002293500623967, 1.037467875016908, 1.0106857611798836, 1.1067961165048543, 4.0, 1.047662945624775, 1.0342105263157895, 1.0053518255988068, 1.0083252606439608, 1.0605326876513317, 1.1270758122743683, 1.1058201058201058, 1.4285714285714286, 1.0125103225567895, 1.0021837710160106, 1.0306550589627002, 1.0900965319985698, 1.0242180363887723, 1.0288659793814432, 1.0057963795822895, 1.0140237324703345, 1.0724043715846994, 2.0, 1.0833333333333333, 1.0782208588957056, 1.0680529300567108, 1.0170648464163823, 1.0416171224732462, 1.146067415730337, 1.07035175879397, 1.0554699537750385, 1.065934065934066, 1.0083140414922982, 1.3780487804878048, 1.0021711346873412, 1.0, 1.1381847914963206, 1.25, 1.0217391304347827, 1.0331890331890332, 1.1453634085213034, 1.1106719367588933, 1.0131406044678055, 1.0433486892097263, 1.0, 1.5319148936170213, 1.6666666666666667, 1.0, 1.0602409638554218, 1.1350114416475972, 1.3846153846153846, 1.0957446808510638, 1.0277154758090357, 1.1282722513089005, 1.0334520913980336, 1.0232695720765135, 1.103448275862069, 1.0262731829330956, 1.0818713450292399, 1.077119184193754, 1.161586840832124, 1.0626315789473684, 1.134393063583815, 1.0594455558731066, 1.0110981604418994, 1.1017895199756436, 1.0111180615388247, 2.0, 1.0767195767195767, 1.033271719038817, 1.0410958904109588, 1.0, 1.108695652173913, 1.25, 1.1414141414141414, 1.5185185185185186, 1.5, 1.0343500160397285, 1.0315087968722232, 1.0074238857704545, 1.0330604288499026, 1.1027027027027028, 1.065613608748481, 2.0, 1.2222222222222223, 1.185721295387635, 1.0014343772412144, 1.0060598246518824, 1.0185100808748149, 1.026425889504738, 1.0405405405405406, 1.035396865179587, 1.1651865008880995, 1.0006726909881831, 1.0153240836612134, 1.393939393939394, 1.0748663101604279, 1.0, 1.0090702947845804, 1.0225533838770258, 3.0, 1.0448521916411824, 1.0136473165388828, 1.1428571428571428, 1.203659541256558, 1.5, 1.1875, 1.0410410764872522, 1.7692307692307692, 1.013149148568459, 1.026911576249466, 1.1875, 1.2608695652173914, 1.3360881542699725, 1.0106331561140647, 1.0608899297423888, 1.0269450889404486, 1.010843036050094, 1.0, 1.1344775146643493, 1.0121951219512195, 2.0, 1.0863759023917707, 1.0083830781209446, 1.0737937559129611, 1.0173482674405798, 1.0802937090692597, 1.313953488372093, 1.8571428571428572, 1.0178775199695702, 1.045531197301855, 1.0425228649483311, 1.0446964643095398, 1.03268994691918, 1.0884346520690857, 1.10989010989011, 1.009009009009009, 1.1634241245136188, 1.0315107817611322, 1.086435331230284, 1.0806159420289856, 1.1811974789915967, 1.0217217892863717, 4.0, 1.0088218330536913, 1.0223367173765028, 1.0306823534507497, 1.0555555555555556, 1.023330093042633, 1.2098214285714286, 1.0, 1.002085174059021, 1.0134426229508198, 1.106280193236715, 1.2647058823529411, 1.6666666666666667, 1.0046463638786205, 1.5, 1.480968858131488, 1.1538461538461537, 1.0727792896518038, 1.2857142857142858, 1.253968253968254, 1.1236897274633124, 1.0, 1.3650793650793651, 1.0429740791268758, 2.0, 1.0, 1.0901639344262295, 1.0469314079422383, 1.0787752675386444, 1.006335797254488, 1.0457516339869282, 1.0206489675516224, 1.089150378938971, 1.0493506493506493, 1.5605095541401275, 1.1502347417840375, 1.3461538461538463, 1.0, 1.0563230605738576, 1.230880230880231, 1.0254237288135593, 1.1789422254794186, 1.0004026869138425, 1.1812408402540302, 1.003698159072718, 1.085707056101793, 1.0697954271961492, 1.003579952267303, 1.5714285714285714, 1.0, 1.0303030303030303, 1.0498430453973262, 1.1284860557768925, 1.0065359477124183, 1.0797872340425532, 1.0521573119511265, 1.0661056835199316, 1.006508011512522, 1.064102564102564, 1.1, 1.0525536639526276, 1.0653499469777306, 1.0364827980195506, 1.003211779167052, 1.2105263157894737, 1.0736119314825754, 1.001644318367378, 1.1031073446327684, 1.0430164630908125, 1.1111111111111112, 1.0778588807785887, 1.027027027027027, 1.0769230769230769, 1.1838709677419355, 1.0347890451517394, 1.0, 1.0503597122302157, 1.0640853553605232, 1.2037037037037037, 1.000222896217929, 1.1408898305084745, 1.0465116279069768, 1.0478319339948388, 1.0001081470800288, 1.070675530486167, 1.0096339113680155, 1.0304093567251462, 1.0114686654643823, 1.1546391752577319, 1.0714285714285714, 1.0, 1.1111111111111112, 1.0086229865568608, 1.8333333333333333, 1.0201376146788992, 1.0640245544127942, 1.1745680106335845, 1.0606698967769117, 1.0019155634791184, 1.0735262593783494, 1.021978021978022, 1.0140646976090013, 1.0272994106182638, 1.0177932547822353, 1.0078038491958872, 1.011682524388775, 1.25, 1.015625, 1.2885375494071147, 1.0140732781032271, 1.0325732899022801, 1.0033848106621537, 1.1646017699115043, 1.0118343195266273, 1.0568594148073804, 1.0122282608695652, 1.0114575393512637, 1.3125, 1.0111959616878075, 1.014501150490821, 1.0592901878914405, 1.0008428150021071, 1.1875, 1.0364025695931478, 1.1194029850746268, 1.8125, 1.0216132368148914, 1.2307692307692308, 1.0344108446298228, 1.0483516483516484, 1.1416048550236009, 1.0330492259523396, 1.0752941176470587, 1.2222222222222223, 1.103448275862069, 1.0158645538438913, 1.017105270593288, 1.0068263022628972, 1.0713161759563605, 1.01070416015738, 1.0, 1.0532003325020782, 1.0353964401294498, 1.0750926380641992, 1.021494370522006, 1.2152777777777777, 1.0442561205273069, 1.0169885166229409, 1.1600673967986521, 1.0063683154497078, 1.0, 1.3333333333333333, 1.0239313703676234, 1.0220017256255391, 1.016515050950689, 1.0561602004463062, 1.0550678371907423, 1.0739856801909309, 1.0116410878157929, 1.139009139009139, 1.0421455938697317, 1.335135135135135, 1.0595238095238095, 1.0182594610513915, 1.0238095238095237, 1.75, 1.0363778582602918, 1.0110730034296913, 1.0057339449541285, 1.2753623188405796, 1.0104996379435192, 1.007328859993742, 1.0142571998859424, 1.1475, 1.2692307692307692, 1.1199460916442048, 1.0421052631578946, 1.10625, 1.5357142857142858, 1.0449212202480724, 1.0198216055500495, 1.0855085508550855, 1.2058823529411764, 1.0572641856421574, 1.0668032786885246, 1.0104835982414608, 1.0793073963232152, 1.6666666666666667, 1.0, 1.3333333333333333, 1.0516483516483517, 1.5384615384615385, 1.3333333333333333, 1.5, 1.2625418060200668, 1.0742753623188406, 1.0973080192689146, 1.0328815343619435, 1.038181818181818, 1.4558823529411764, 1.0, 1.1612903225806452, 1.337837837837838, 1.320754716981132, 1.0202492211838006, 1.0084558600055382, 1.0070170981048605, 1.0390625, 1.008295407529996, 1.0004153946248937, 5.0, 1.0048314109761491, 1.1371428571428572, 1.0, 1.3333333333333333, 1.0668639053254438, 1.1257261708384136, 1.0517822477878214, 1.0124223602484472, 1.0, 1.0278884462151394, 1.1288343558282208, 2.0, 1.5, 1.1348425196850394, 1.1121243833158918, 1.214600091060859, 1.25, 1.0006154131208724, 1.0681642137877614, 1.0869565217391304, 1.1428571428571428, 1.1833333333333333, 1.004934420608937, 1.2105263157894737, 1.0683835044370975, 1.0687768173621044, 1.1223529411764706, 1.00390625, 1.0061157024793388, 1.202391118701964, 1.1239669421487604, 1.2545454545454546, 1.0325834702623957, 1.0482051282051281, 1.0418204182041821, 1.176056338028169, 1.2592592592592593, 1.1492537313432836, 1.038860103626943, 1.0316301703163018, 1.0110197285433171, 1.0081829140137233, 1.0534934497816595, 3.0, 1.25, 1.0209169521944852, 1.140721196130167, 1.2929391169033262, 1.029508942390913, 1.004873949579832, 1.0881707973023294, 1.0793650793650793, 1.0625, 1.0187394890686314, 1.0166115345893858, 1.090159104301709, 1.0692883895131087, 2.5, 1.1333333333333333, 1.0168992016712677, 1.0719235364396655, 1.0179549177131269, 1.0020476471746407, 1.0980113636363635, 1.6, 1.014018691588785, 1.038325012595612, 1.0182773589216358, 1.02734375, 1.0290730939779718, 1.2868852459016393, 1.2778561354019746, 1.0440579710144928, 1.0029225931371835, 1.0317005384749, 1.1048387096774193, 1.1126760563380282, 1.0, 1.0408407382091593, 1.0074135469908367, 1.0779392338177014, 1.0344260610420306, 1.0309810671256454, 1.0567545963229417, 1.3846153846153846, 1.029723991507431, 2.5, 1.5, 1.3076923076923077, 1.0127877237851663, 1.1192733017377567, 1.0218351962568235, 1.038011436283563, 1.0919945725915876, 1.0518828451882845, 1.125, 1.2653061224489797, 1.0110482122940299, 1.6, 1.25, 1.1147967479674796, 1.0, 1.1483180428134556, 1.1518987341772151, 1.0315172926738565, 1.0237457596857704, 1.0, 1.0978925900747791, 1.255813953488372, 1.0316708229426435, 1.000655981357285, 1.180327868852459, 1.0328970640254687, 1.005128104754262, 1.0414658747058165, 1.0890302066772655, 1.5434782608695652, 1.2304469273743017, 1.0, 1.0, 1.00059904867494, 1.6666666666666667, 1.5714285714285714, 1.542857142857143, 1.006031363088058, 1.0561797752808988, 1.0611764705882354, 1.0902480752780155, 1.0, 1.175667287399131, 1.022700119474313, 1.1838565022421526, 1.0426065162907268, 1.1111111111111112, 1.022719565954561, 1.1823725055432373, 1.0684647302904564, 1.0189661584232057, 1.0176775734290349, 1.1308269152817187, 1.0632075471698113, 1.0, 1.0956243626587558, 1.0166560786679408, 1.0659522955523673, 1.2695652173913043, 1.0090190563933472]
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.5429	median: 1.0590	mean: 1.1464

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 19.390796 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=naru', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[ 5.9604645e-08  1.6689301e-06  0.0000000e+00  1.3113022e-06
 -2.9802322e-08]
Distance score: 6.020069349688129e-07
SAUCE Drift detection: False
Detection latency: 0.0232s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 2.036030 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 7.0000	99th: 2.7525	95th: 1.6683	median: 1.0640	mean: 1.1642
ReportEsts: [1.0054794520547945, 1.0329818263405879, 1.0591267357340861, 1.0550161812297734, 1.0606060606060606, 1.0, 1.203689390426135, 1.0020579506986593, 1.0, 1.034521158129176, 1.1287569127194037, 1.0019674664086697, 1.0467494521548575, 1.023391812865497, 1.0229276895943562, 1.0714285714285714, 1.0630914826498423, 1.4761904761904763, 1.4444444444444444, 1.0937781785392244, 1.0695732838589982, 1.0677581630763533, 1.5333333333333334, 1.0557522123893806, 1.0337450769781598, 1.0140475148235106, 3.0, 1.0405214940098662, 1.5, 1.3333333333333333, 1.0315315315315314, 1.0, 1.0029762009587242, 1.0063499873154007, 1.2494204914232732, 1.0416053019145803, 1.0239975184704755, 1.0154185022026432, 4.0, 1.081068127353646, 1.0998247070762985, 1.0104411720540978, 1.0428893905191874, 1.0116256663883358, 1.0425138632162663, 1.1010695746089258, 1.0, 1.0157706093189964, 1.2827225130890052, 1.0964207450693937, 1.1666666666666667, 1.00355871886121, 1.1121076233183858, 1.0606060606060606, 1.0737424188369604, 1.0053502345872087, 1.0130718954248366, 1.1155555555555556, 1.1686746987951808, 1.0046035916701048, 1.0634920634920635, 1.0020580895783489, 1.0572246065808297, 1.0408921933085502, 1.1346153846153846, 1.1538461538461537, 1.0985062575696407, 1.0574338968357173, 1.0, 1.0, 1.086871933682964, 1.043222003929273, 1.064158224794983, 1.0634057971014492, 1.0600890767720994, 1.0866318147871545, 1.0912102001567063, 1.0407239819004526, 1.099290780141844, 1.0280017647776662, 1.206997084548105, 1.1333333333333333, 1.0, 1.25, 1.0034207525655645, 1.0666666666666667, 1.0287929125138426, 1.037037037037037, 2.0, 1.0091392170043856, 1.087126774351444, 1.1421047300719134, 1.0168978825492856, 1.3564908722109534, 1.0888252148997135, 1.2855504587155964, 1.2463235294117647, 1.2112676056338028, 1.2857142857142858, 1.1460987261146496, 1.2058823529411764, 1.6666666666666667, 1.0258237957214287, 1.0082788671023966, 1.0474777448071217, 1.0133302014211052, 1.0217391304347827, 1.0073471432903915, 1.0361721611721613, 1.0224251925567447, 1.0691405011100539, 1.033421052631579, 1.0, 2.0, 1.1563841807909605, 1.0263025625112, 1.0603689211850196, 1.0888888888888888, 1.0056483470787996, 2.0, 1.21824, 1.1473684210526316, 1.0, 1.2283105022831051, 1.0, 1.0639175257731959, 1.0110364089540453, 1.1078954214360042, 1.0155038759689923, 2.2, 1.2370990237099024, 1.0, 1.0, 1.0103351955307263, 1.3076923076923077, 1.0815673730507798, 1.084863761853319, 1.07698824526104, 1.2, 1.6, 1.0396659707724425, 1.0347581023954908, 1.0491715660074827, 1.072012627614099, 1.1624365482233503, 1.0206746463547334, 1.0604507205725893, 2.0, 1.018640776699029, 1.0762970498474058, 1.0354938271604939, 1.0361107000147995, 1.0, 1.0575477775391884, 1.0037313432835822, 1.0283806343906512, 1.1911764705882353, 2.0, 1.1148036253776434, 1.0706913106096976, 1.0171315039736093, 1.1246006389776357, 1.1643835616438356, 1.0175438596491229, 1.2275449101796407, 1.1182943603851445, 1.4285714285714286, 1.006662910798122, 1.5, 1.084848484848485, 1.0273321561408122, 1.0177909562638991, 1.0643660848764065, 1.0069444444444444, 1.0669014084507042, 1.1544950590503735, 1.014612954186414, 1.1615062761506276, 1.012366034624897, 1.0108163790883338, 1.0227153459779594, 1.0129607559376863, 1.0123456790123457, 2.0, 1.0275747277897218, 1.0239300882064686, 1.0948616600790513, 1.0873298537810991, 1.1666666666666667, 1.0, 1.1017369727047146, 1.0176755747105553, 1.1379310344827587, 1.0150571131879542, 1.031934196201766, 1.0033978236353784, 1.0203382686126772, 1.0518134715025906, 1.0064196956780076, 1.0180118849173527, 1.0724137931034483, 1.012029396838524, 1.123896173401124, 1.0021215958285243, 1.1885117493472586, 1.1610714600405323, 1.375796178343949, 1.0933333333333333, 1.1, 1.0, 1.0802139037433156, 1.0806504707354005, 1.7477744807121662, 1.14, 1.0189300411522633, 1.6666666666666667, 1.0003032098901554, 1.0636363636363637, 1.0382687927107062, 1.25, 1.0520965692503177, 1.0159647674098542, 1.0144998565554175, 1.0538492502767436, 2.0, 1.0576036866359446, 1.0444415290509848, 1.033052276559865, 1.018716577540107, 1.284072249589491, 1.0733740967204002, 1.0556395330138617, 1.017094017094017, 1.0031692362862419, 1.0098099198407184, 1.15, 1.182916307161346, 1.0354691075514875, 1.3333333333333333, 1.1079280479680214, 1.0, 1.0188679245283019, 1.0852103499627699, 1.0031434184675836, 1.5391849529780564, 1.1538461538461537, 2.5, 1.0846824955353223, 1.1044776119402986, 1.132403758714762, 1.5, 1.013170272812794, 1.008991008991009, 1.4285714285714286, 1.0105040524650193, 1.1572769953051643, 1.166835187057634, 1.037344398340249, 1.0074047954866008, 1.0697340391194887, 1.042857142857143, 2.0, 1.0111997505391992, 1.1302754395006585, 1.1073025335320417, 1.0213430874675948, 1.0942933288210162, 1.0164777147938202, 1.099403578528827, 1.0411256363983157, 1.0611332007952285, 1.1098548117692406, 1.1667457868502256, 1.5, 1.0563612887727831, 1.1066907775768535, 1.2181818181818183, 1.037037037037037, 1.0427647936350075, 1.030735455543359, 1.0321974571472692, 1.0157488750803514, 1.0588235294117647, 1.2189054726368158, 1.0338998354669129, 1.0945121951219512, 1.0473459993135334, 1.0026135524413056, 1.3333333333333333, 2.090909090909091, 1.0518072289156626, 1.017346855542565, 1.0428709737073982, 1.0437206509852692, 1.1450053705692804, 1.0083658672615727, 1.0064827486854426, 1.0262956255224296, 1.0187049319574215, 1.0671116470819193, 1.0720545277507303, 1.0919540229885059, 1.3636363636363635, 1.0722365869424693, 1.3076923076923077, 1.0695488721804511, 1.0152430386345863, 1.0596654678863653, 1.1388888888888888, 1.3666666666666667, 1.0470249520153552, 1.071058091286307, 1.0151721064943746, 1.0952380952380953, 1.0456309537810184, 1.0077284802085569, 1.3270142180094786, 2.3333333333333335, 1.5714285714285714, 1.1110580367805112, 1.4444444444444444, 1.0229581855175292, 1.048265460030166, 1.1363636363636365, 1.048897709339582, 1.2307692307692308, 1.7777777777777777, 1.0219775077038273, 2.0, 1.013157894736842, 1.0934466019417475, 1.0993589743589745, 1.1586715867158672, 1.0504385964912282, 1.072072072072072, 1.019062228588831, 1.0073180029680457, 1.1333333333333333, 1.0186026134063992, 1.1212417024599766, 3.0, 1.0909090909090908, 1.032536063833969, 1.25, 1.0387243735763099, 1.15, 1.4, 1.0, 1.216733870967742, 1.1064516129032258, 1.1397058823529411, 1.0639269406392695, 1.2, 2.75, 1.050421430815677, 1.103448275862069, 1.15, 1.0362508991803527, 1.2517985611510791, 1.0358534684333593, 1.000942507068803, 1.8, 1.25, 1.166184971098266, 1.0440251572327044, 1.005911330049261, 1.015328917767942, 1.0955644156491402, 1.030379746835443, 1.0, 1.0057797713857397, 1.35, 1.1470588235294117, 3.0, 1.0556178987235236, 1.25, 1.0403587443946187, 1.0, 1.0121204442755183, 1.033202401783186, 1.017176054559232, 1.10291379121481, 1.0367575122292103, 1.2387543252595157, 1.0651872399445215, 1.1292217884083242, 1.1164596273291925, 1.0285714285714285, 1.0072035489960203, 1.007208984671422, 1.1061093247588425, 1.018348623853211, 1.0444444444444445, 1.0828516377649327, 2.0, 1.8148148148148149, 1.083969465648855, 1.0354477611940298, 1.0588235294117647, 1.0811965811965811, 1.0249875062468765, 1.1197411003236246, 1.0035140137741823, 1.1321686289403723, 1.1699102605687102, 1.2857142857142858, 1.0852713178294573, 1.06265664160401, 1.0, 1.0004000466721117, 1.3275862068965518, 1.0041009165643013, 1.0077687182817423, 1.0035836585171618, 1.0148008611410118, 1.8571428571428572, 1.3024013024013024, 1.6, 1.1122035858877963, 1.3636363636363635, 1.039446657537657, 1.02291917973462, 1.0628253455394006, 1.1892744479495267, 1.1357742181540809, 5.0, 1.2120225051821143, 1.0002476373376459, 1.0072322351050396, 1.0, 1.123076923076923, 1.0819277108433736, 1.3104265402843602, 1.082920583577614, 1.1085547122074637, 1.173913043478261, 1.11352133044107, 1.105321529331647, 1.04739336492891, 1.0454425841255222, 1.0762553211785888, 1.0917472077542267, 1.135135135135135, 1.1903225806451614, 1.0356709183938226, 1.037593984962406, 1.129455909943715, 1.0, 2.0, 1.1692103516921035, 1.0873015873015872, 1.2275059869996578, 1.0436545337582095, 1.1648616125150422, 1.0, 1.112, 1.2758620689655173, 1.0047206866977536, 1.04, 1.0, 1.002261661693105, 1.0, 1.0, 1.1073699962588852, 2.0, 1.2281791435109513, 1.0127627627627627, 1.3102189781021898, 1.0, 1.014760909040885, 1.0460048426150121, 1.0357142857142858, 1.0012586928474778, 1.0888888888888888, 1.111842105263158, 1.1358189081225034, 1.0038582953349702, 1.1448101748201782, 1.0, 1.144578313253012, 1.067897008899258, 1.0516312481293026, 1.0846441947565544, 1.0, 1.053719806763285, 1.0216926350163136, 1.0292576419213975, 1.0, 1.094420600858369, 1.0195136772157483, 1.094074133633513, 1.1379960821301602, 1.0214298410629379, 1.0085230677052126, 1.0328317373461013, 1.0097991180793728, 1.75, 1.055685156385001, 1.0438193129564513, 1.0529881442051778, 1.0194910665944776, 1.0132978723404256, 1.0409184883182976, 1.4021739130434783, 1.0472252760384302, 1.1271551724137931, 1.0560901406217482, 1.0382882882882882, 1.0075412136092599, 1.219423917961092, 1.0714285714285714, 1.0978260869565217, 1.0348160636868393, 1.0821052631578947, 1.037435644648921, 1.0086491247797893, 1.0, 1.1802525832376578, 1.7405247813411078, 2.0, 1.2045454545454546, 1.011831781763402, 1.0889679715302492, 1.119745845552297, 1.0, 1.1538461538461537, 1.0300378429517503, 1.0082048988578505, 1.0208054972322962, 1.0512194467548497, 1.0403966213734852, 1.0511432009626955, 1.075109649122807, 1.1082133315957516, 1.2253521126760563, 1.0491250950983588, 1.1255349500713268, 1.136150234741784, 1.030471675426844, 1.0786860198624904, 1.003091588303491, 1.0, 1.1948424068767909, 1.3979591836734695, 1.0038086424147505, 1.0021052631578948, 1.1507430997876857, 1.0256410256410255, 1.0517241379310345, 1.0209909591393505, 2.0, 1.7, 2.1666666666666665, 1.3333333333333333, 1.01, 1.1998078770413065, 1.3148148148148149, 1.1981566820276497, 1.0262067121272898, 1.125129265770424, 1.048438659587829, 1.0065838509316771, 1.071654708604185, 1.0022680358152438, 1.0356622925472636, 1.0817307692307692, 1.0220893970893972, 1.0021344270528165, 1.0805970149253732, 1.0122767857142858, 1.1134401972872996, 1.1776315789473684, 1.0610603733936799, 1.2215346534653466, 1.0106249626932489, 1.042857142857143, 1.1228733459357279, 1.0077269800386348, 2.5, 1.0129870129870129, 1.0625, 1.3333333333333333, 1.319526627218935, 1.0165491351525169, 1.0385356454720616, 1.0369458128078817, 1.0346820809248556, 1.0845108166049504, 1.1615600771913193, 1.0088809946714032, 1.4, 1.6666666666666667, 1.0511612251767082, 1.4136363636363636, 1.0410685805422648, 1.00543093270366, 1.0, 1.104602510460251, 1.1519607843137254, 1.022845621388201, 1.1858407079646018, 1.0052133454168342, 1.0342938203741467, 1.0133736573377683, 1.1923076923076923, 1.25, 1.0061332845111681, 1.0, 1.1141781681304894, 1.163265306122449, 1.156783103168156, 1.058217082721488, 1.3928571428571428, 1.0642854496276262, 1.1347517730496455, 1.4482758620689655, 1.0838571787779734, 1.093989769820972, 1.027027027027027, 1.0846193152784875, 1.0233183856502241, 1.0098264002620374, 1.3333333333333333, 1.0278967427605987, 1.1086218601493552, 1.2380952380952381, 1.0027567195037905, 1.0453663270257156, 1.0105263157894737, 1.0963967461471096, 1.2, 1.1680672268907564, 1.0598907329141325, 1.0976253298153034, 1.0903225806451613, 1.0095106765283524, 1.276190476190476, 1.6, 1.0183138616987686, 1.0615711252653928, 1.063577113935504, 1.0815642458100558, 1.0611078560382667, 1.0168025698047938, 1.2250755287009063, 1.050620509470934, 1.2101694915254237, 1.0188568088620042, 1.0643153526970954, 1.0284834488067744, 1.1106194690265487, 1.0069224989819854, 1.0780669144981412, 1.1339695356946229, 1.05, 1.3333333333333333, 1.0163522012578616, 1.0289454277286136, 1.0371991247264771, 1.049222797927461, 1.3333333333333333, 1.037825059101655, 1.0955391640323147, 1.3442622950819672, 1.0127823774536682, 2.3333333333333335, 1.016181075073496, 2.0, 1.3907103825136613, 1.0588235294117647, 1.0769787505066295, 1.3235294117647058, 1.2704918032786885, 1.092254134029591, 1.0, 1.074238925047239, 1.0850815850815851, 2.25, 1.0, 1.0263157894736843, 1.073394495412844, 1.118072890664004, 1.0080071174377223, 1.049655172413793, 1.4425675675675675, 1.1720116618075802, 1.0536451169188445, 1.5668449197860963, 1.0033670033670035, 1.0588235294117647, 1.0, 1.018835616438356, 1.188861985472155, 1.0521582733812949, 1.2082685732048493, 1.0025016913185472, 1.2410438806993487, 1.0291078769025663, 1.0073003802281368, 1.0316831683168317, 1.0050530570995453, 1.5, 1.0, 1.1, 1.0254757659264062, 1.1606837606837608, 1.002717391304348, 1.1867321867321867, 1.070978018477222, 1.0063477110109234, 1.008958589585896, 1.1379310344827587, 1.0, 1.1361702127659574, 1.1015309788315923, 1.046776435368331, 1.0775356013965218, 1.2458100558659218, 1.0883022583225648, 1.076431537931145, 1.0047981213140127, 1.0568720379146919, 1.024503205128205, 1.2619047619047619, 1.0337470907680373, 1.0522466039707419, 1.0037563083884995, 3.0, 1.059270998415214, 2.0, 1.1223628691983123, 1.015457201245354, 1.171875, 1.0060723102651907, 1.1090589270008795, 1.0392156862745099, 1.0582587978759919, 1.0164674310807513, 1.1199261992619927, 1.029647435897436, 1.020368574199806, 1.0091497747747749, 1.2522202486678509, 1.2666666666666666, 2.0, 1.2, 1.0131727816389202, 1.8571428571428572, 1.0130709438418546, 1.0518781133599604, 1.131796025496813, 1.098640705363703, 1.0001510411905226, 1.1457868925546144, 1.0838709677419356, 1.012401352874859, 1.0190551883985342, 1.0383077204165736, 1.0072946894660686, 1.0240319053132638, 1.3333333333333333, 1.0465116279069768, 1.3277591973244147, 1.035541050362297, 1.005449591280654, 1.0121406891626494, 1.1518248175182482, 1.0295081967213116, 1.0605339063437675, 1.0137772675086107, 1.013551025281318, 1.3157894736842106, 1.030884399067197, 1.013159347103219, 1.1551724137931034, 1.0144011239901651, 1.2857142857142858, 1.0323741007194245, 1.0179121625150138, 1.0796561890959973, 1.8666666666666667, 1.0054527050490472, 1.0789473684210527, 1.1183992422448497, 1.2149651236525048, 1.1524777636594663, 1.259493670886076, 1.10828025477707, 1.1323943661971831, 1.0978922716627635, 1.06464893125768, 1.039272030651341, 1.0850985954156562, 1.0199483721933469, 1.2142857142857142, 1.0575589459084604, 1.0851628895184136, 1.029498298667076, 1.2319939347990903, 1.2517150395778365, 1.1820925553319919, 1.2493188010899183, 1.01625, 1.008934836047476, 1.0, 1.0255962769051774, 1.0045922355393435, 1.0141712877387554, 1.5669291338582678, 1.0224951438060028, 1.0872581295350712, 1.0330906684315022, 1.1546610169491525, 1.0008962931289676, 1.0972325690478162, 1.0186335403726707, 1.1858407079646018, 1.0148544266191326, 1.0332309267793138, 1.1195652173913044, 2.0, 1.031596560870107, 1.00246725696366, 1.0204957102001906, 1.191860465116279, 1.035247645092677, 1.0138050955488846, 1.01738923296808, 1.0074971164936564, 1.2580645161290323, 1.106981981981982, 1.3333333333333333, 1.1108179419525066, 1.8333333333333333, 1.0464369485088798, 1.0149006622516556, 1.1, 1.1627906976744187, 1.0383944153577662, 1.0462700661000943, 1.0309278350515463, 1.1538461538461537, 1.0300375469336671, 1.18348623853211, 1.1029713114754098, 1.3, 1.0204534431338554, 1.1336405529953917, 1.1617962466487937, 1.0854700854700854, 1.0909090909090908, 1.0134110787172013, 1.0741150782667528, 1.033256014315064, 1.019578313253012, 1.4, 1.0, 1.0277777777777777, 1.3333333333333333, 1.328358208955224, 1.0740028832292168, 1.0092500872384254, 1.005951251380485, 1.025974025974026, 1.006066198458673, 1.0007924062458295, 7.0, 1.0139149450422973, 1.026066572902016, 1.3333333333333333, 1.2857142857142858, 1.041954590325765, 1.1716542973425903, 1.0790988487495037, 1.0437017994858613, 1.0, 1.0419354838709678, 1.3618090452261307, 1.1801801801801801, 1.0091306692229345, 1.0278414944028569, 1.015605586042659, 1.179757382673692, 1.1, 1.0048540477962458, 1.0602950609364978, 1.1226415094339623, 1.1763779527559055, 1.0747986191024166, 3.0, 1.032258064516129, 1.1230068337129842, 1.0351533158623913, 1.1428571428571428, 1.0066889632107023, 1.0343760782058655, 1.1752353367125272, 1.1837455830388692, 1.2878787878787878, 1.0344664176993152, 1.0123634865031939, 1.0812586509181508, 1.3246753246753247, 1.1714285714285715, 1.2640918580375784, 1.1111111111111112, 1.031431897555297, 1.0422885572139304, 1.0132949883315927, 1.0441839495040577, 1.5, 1.0858369098712446, 1.0549366766910924, 1.1337016574585634, 1.18952981095492, 1.0861937035417577, 1.0142737195633922, 1.077735255928381, 1.2987951807228915, 1.1090909090909091, 1.0053104307349374, 1.0154884115174192, 1.0451237263464337, 1.275811209439528, 2.5, 1.1395348837209303, 1.1005938137020297, 1.18830242510699, 1.050547621970348, 1.0074556205181855, 1.1384062312762133, 1.8, 1.005842259006816, 1.0747765983707727, 1.0372694428598592, 1.054421768707483, 1.0053663355523454, 1.1388888888888888, 1.13312693498452, 1.0807692307692307, 1.0033534337036778, 1.0081293446039534, 1.0910852713178294, 1.1313240043057051, 1.1025641025641026, 1.0674205248559847, 1.098544599541653, 1.0458126391505396, 1.0915774538888172, 1.0470475276044167, 1.0251288659793814, 1.4166666666666667, 1.1078610603290677, 3.0, 1.5, 1.5714285714285714, 1.041036717062635, 1.15359477124183, 1.053403173816018, 1.0498237288643049, 1.056748813022835, 1.046263966480447, 1.0669642857142858, 1.1081081081081081, 1.0390333895692492, 1.3333333333333333, 1.3571428571428572, 1.0258899676375404, 1.1111111111111112, 1.1394169835234473, 1.096438575430172, 1.0039608399970106, 1.013926804876071, 1.2, 1.1892878880097384, 1.1317494600431965, 1.0458538066058318, 1.0001872881064409, 1.052863436123348, 1.0584161397169527, 1.0175291052405924, 1.0623868939899037, 1.1259946949602122, 1.4067796610169492, 1.2043132803632237, 1.3333333333333333, 3.0, 1.0005252492139887, 1.5, 1.625, 1.3191489361702127, 1.067, 1.0050500653025685, 1.0936794582392777, 1.0, 1.1666666666666667, 1.0114606741573033, 1.026355047240179, 1.3333333333333333, 1.04989604989605]
origin-bjaq_15.87 	max: 7.0000	99th: 2.7525	95th: 1.6683	median: 1.0640	mean: 1.1642

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 16.637467 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=38.097020