Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='naru', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 18, 'naru': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 5.0000	99th: 2.6667	95th: 1.6012	median: 1.0580	mean: 1.1483
ReportEsts: [1.1091549295774648, 1.056105610561056, 1.046263991584237, 1.0173076923076922, 1.0, 1.0, 1.1448405694787622, 1.0277251838235295, 1.25, 1.0386666666666666, 1.005046550073958, 1.0025442535411502, 1.0586927523343708, 1.0070257611241218, 1.0279053338043094, 1.0, 1.3432835820895523, 1.0017711654268509, 3.0, 2.6666666666666665, 1.2857142857142858, 1.079318524908346, 1.0492580122209751, 1.0390482001220256, 1.0217069560927479, 1.0, 1.0605940200655608, 1.0, 1.4, 1.20863309352518, 1.0, 1.0093945146519758, 1.0103833472762167, 1.4445061043285239, 1.0644734909678366, 1.014047796357728, 1.0840579710144929, 1.0140980501663308, 1.094359115641573, 1.3095238095238095, 1.0182767624020888, 1.0030487804878048, 1.0, 1.1607928091050181, 1.074502545118001, 1.2066115702479339, 1.1262135922330097, 1.2690582959641257, 1.030161382874902, 1.0092592592592593, 1.0080134042398194, 1.1926229508196722, 1.0045598156758322, 2.0, 1.161038961038961, 1.0194651860361224, 1.1578181818181819, 1.0606060606060606, 1.3478260869565217, 1.25, 1.0354513161918653, 1.0379825653798256, 1.1227272727272728, 1.0919540229885059, 1.1, 1.165587899345817, 1.0570539419087137, 1.1666666666666667, 1.0, 1.0144694533762058, 1.009546539379475, 1.0584490740740742, 1.0945945945945945, 1.1048162649181565, 1.2070588235294117, 1.1368421052631579, 1.0, 1.049978079789566, 2.0, 1.054535280782806, 1.21875, 1.0297015871651318, 1.1411042944785277, 1.0080275229357798, 1.0664573521716378, 1.04, 1.011695695116957, 1.056550191381652, 1.107843137254902, 2.3333333333333335, 1.0935672514619883, 1.030126212592175, 1.0654205607476634, 1.2524544179523143, 1.2032967032967032, 1.0845070422535212, 1.25, 1.0077386070507308, 1.0, 1.0080050368771363, 1.1301655867530598, 1.0111492281303602, 1.0159168309732927, 1.1764705882352942, 1.0190075473027278, 1.0608279357927344, 1.0308254320075525, 1.0872203261281759, 1.0326052548274771, 1.1666666666666667, 1.3333333333333333, 1.1313772138514406, 1.0138132275835283, 1.0609919571045576, 1.0694444444444444, 1.0069295583965228, 1.0, 1.2628434886499402, 1.1722488038277512, 1.0, 1.1978021978021978, 1.1666666666666667, 1.0050377833753148, 1.0226347419766755, 1.0440319950298982, 1.0769230769230769, 1.8, 1.2682119205298013, 1.0, 1.2142857142857142, 1.023197799838464, 1.1818181818181819, 1.012858555885262, 1.0056711487373373, 1.1022575214745112, 1.1648522550544322, 1.0458452722063036, 1.0264, 1.00199203187251, 1.0465561224489797, 1.0394599869876382, 1.1296296296296295, 1.0776255707762556, 1.114167943485512, 2.0, 1.0115260488704472, 1.0567632850241546, 1.0452853598014888, 1.0236456679018882, 1.0, 1.028649725959143, 1.005925925925926, 1.02, 1.4476190476190476, 1.0603715170278638, 1.000842886041807, 1.0024161644053846, 1.074713680223645, 1.1368821292775666, 1.1085526315789473, 1.0204081632653061, 1.065217391304348, 1.139261744966443, 1.1428571428571428, 1.0097565827546295, 1.0213268877383739, 1.0110593713620488, 1.0324364172502765, 1.0226023213194868, 1.0567702949829052, 1.0105263157894737, 1.0798319327731092, 1.2171976372615474, 1.0566239316239316, 1.1252427184466018, 1.065217391304348, 1.041640378548896, 1.0454011583167957, 1.053324719212802, 1.1666666666666667, 1.4651162790697674, 1.0634849167041873, 1.0480568324279147, 1.1004439511653719, 1.0857142857142856, 1.0068089951608312, 1.0664070506251282, 1.0220764885397051, 1.0943396226415094, 1.1404545454545454, 1.0158706496187144, 1.0, 1.7272727272727273, 1.0876014922097872, 1.2792281498297389, 1.0850425212606303, 1.4, 1.0167202572347267, 1.0017110529912598, 1.0194912620649312, 1.1798245614035088, 1.04996310741014, 1.0282485875706215, 1.0625, 1.0, 1.0, 1.0738255033557047, 1.0365084371550228, 1.6236933797909407, 1.1379310344827587, 1.0202669303015324, 1.0957683741648108, 1.0820696303437025, 1.0406513454209494, 1.0176657790478665, 1.093167701863354, 1.1179321486268174, 1.0489462950373896, 1.0054288189431129, 1.0376546146527117, 1.0, 1.0604554865424431, 1.024225474169342, 1.001154759435437, 1.0776308223116733, 1.006742398404911, 1.0034681103028253, 1.0344827586206897, 1.0029535122206108, 1.0916256157635469, 1.1579244218838127, 1.032258064516129, 1.0715619166148103, 1.046034816247582, 1.1039370078740158, 1.0, 1.0122873345935728, 1.09072130415364, 1.0178152836380685, 1.2201492537313432, 1.0909090909090908, 2.6666666666666665, 1.0468159195230475, 1.1272727272727272, 1.0736697089719305, 2.0, 1.0, 1.2121212121212122, 1.003903200624512, 1.6326530612244898, 1.0939226519337018, 1.0846681922196797, 1.072289156626506, 1.0157782515991471, 1.0748377163781624, 1.087719298245614, 1.0, 1.0166610920645538, 1.1711952792644436, 1.136602451838879, 1.0271622434080563, 1.078071824046325, 1.0299498302336187, 1.0993640699523053, 1.0344348009788216, 1.0639952153110048, 1.1120556414219473, 1.2797422599402797, 1.7272727272727273, 1.0500792811839323, 1.0319829424307037, 1.2954545454545454, 1.0416666666666667, 1.1454545454545455, 1.0, 1.2061855670103092, 1.0233438920258917, 1.0222841225626742, 1.2018072289156627, 1.0152788613849681, 1.0826521344232516, 1.0076246197674341, 1.007094004849604, 1.6, 1.110694798108403, 1.0, 1.0141571832812075, 1.038876889848812, 1.017973692594784, 1.3, 1.6666666666666667, 1.173913043478261, 1.5070422535211268, 1.0339838154356513, 1.0, 1.0412844036697249, 1.0339366515837105, 1.0380608974358974, 1.0009854737105266, 1.2857142857142858, 1.0440251572327044, 1.0052295738995922, 1.1290103547784756, 1.060609916443992, 1.0086206896551724, 1.0, 1.2673031026252983, 1.019704433497537, 1.2180685358255452, 1.0020640269587195, 1.0122414520894893, 1.0823170731707317, 1.0727272727272728, 1.008230452674897, 1.0189274447949528, 1.5714285714285714, 1.0289851650729942, 1.0622710622710623, 1.0555555555555556, 1.0502960280508133, 1.1904761904761905, 1.75, 1.0164892999995703, 2.0, 1.01920438957476, 1.069767441860465, 1.0319934372436423, 1.010703363914373, 1.0652741514360313, 1.164835164835165, 1.0180873659005127, 1.0006247819348766, 1.013623978201635, 1.020409167315813, 1.1268422703041705, 3.0, 1.2222222222222223, 1.0417321335047374, 1.0, 1.0515633571036753, 1.0, 1.0, 1.0454545454545454, 1.1382857142857143, 1.0895091434071222, 1.2403846153846154, 1.0811688311688312, 1.0, 1.029960053262317, 1.0194333230674468, 1.5, 1.118522930315664, 1.0, 1.0087907082669096, 1.0224719101123596, 1.0071634741537654, 1.1682027649769586, 1.0018181818181817, 1.1321118611378977, 1.0740740740740742, 1.0048424707030523, 1.0041230034716653, 1.0532623169107855, 1.0, 1.1428571428571428, 1.8333333333333333, 1.5, 1.2307692307692308, 1.002701155708764, 1.25, 1.1068139963167587, 1.1386138613861385, 1.0906879513492969, 1.003156417030701, 1.006217616580311, 1.1204600198365844, 1.0311004784688995, 1.2444444444444445, 1.5, 1.0604166666666666, 1.0779816513761469, 1.003855795584354, 1.4285714285714286, 3.142857142857143, 1.0913140311804008, 1.030813953488372, 1.0003706474428726, 1.1724137931034482, 1.342769701606733, 1.0478784403669725, 1.3559322033898304, 1.0808477237048666, 1.0656779661016949, 1.3461538461538463, 1.0584707646176912, 1.1081081081081081, 1.0701257811630385, 1.027428976112004, 1.0048461880287418, 1.1466666666666667, 1.0277777777777777, 1.088145896656535, 1.0, 1.0327490079863377, 1.009011132001045, 1.0013301769811747, 1.0054181924623207, 1.0335628227194493, 1.0099486521181, 1.8333333333333333, 1.3931500241196333, 1.2, 1.0649017933390266, 1.1111111111111112, 1.0331557765815929, 1.0043478260869565, 1.002901977644024, 1.1897233201581028, 1.0750647109577223, 3.0, 1.224094657583363, 1.0098306735389506, 1.0581892587824169, 1.0, 1.105263157894737, 1.0508637236084453, 1.4655172413793103, 1.078631790744467, 1.103211009174312, 1.1666666666666667, 1.1130284728213977, 1.1188912520157992, 1.0834048747713785, 1.0070229786934444, 1.1174342105263158, 1.144278606965174, 1.0113636363636365, 1.3636363636363635, 1.00253807106599, 1.3448275862068966, 1.043656207366985, 1.1, 1.0850847672868118, 1.3157894736842106, 1.105629697806412, 1.0409108797538549, 1.1472045293701345, 1.0, 1.1176470588235294, 1.32, 1.0015589072060485, 1.350109409190372, 1.0, 1.057336280740536, 1.0120459991542545, 1.207103551775888, 1.0, 2.0, 1.1918446601941748, 1.006311992786294, 1.3677130044843049, 1.0, 1.0155765551817402, 1.0464426877470356, 1.0869565217391304, 1.0419209039548023, 1.0272727272727273, 1.0381471389645776, 1.1491935483870968, 1.0162462590850792, 1.0839791056770565, 1.0, 1.0675675675675675, 1.0811927907471794, 1.0022267926453987, 1.0450438243638058, 1.0, 1.0317206754906436, 1.0134868924575893, 1.0288108957569408, 2.0, 1.118421052631579, 1.0760675109458124, 1.034223426605365, 1.1870604167576777, 1.0166390380832393, 1.150700616105992, 1.0084033613445378, 1.0219382835101254, 2.0, 1.1061553568659879, 1.2542372881355932, 1.25, 1.3496503496503496, 1.1304347826086956, 1.0569521837764024, 1.0758683729433272, 1.0428732534357856, 1.0244475787494123, 1.0290861129429731, 1.0016231570404437, 1.0037564871643723, 1.1067961165048543, 4.0, 1.043735445924859, 1.0223509933774835, 1.0052831434703648, 1.0128331782737552, 1.0767549849767823, 1.2448165869218502, 1.045, 1.4285714285714286, 1.0178168752323131, 1.0015175692111988, 1.051310487597501, 1.083126110124334, 1.027550134978789, 1.0639175257731959, 1.0084259898457275, 1.0271468144044322, 1.0827586206896551, 2.0, 1.0, 1.0475460122699387, 1.0680529300567108, 1.0311418685121108, 1.0107015457788346, 1.0490196078431373, 1.0698924731182795, 1.0554699537750385, 1.0769230769230769, 1.011246772326596, 1.4125, 1.032597816546818, 1.0, 1.033764367816092, 1.3333333333333333, 1.070921985815603, 1.0, 1.0803782505910164, 1.0296442687747036, 1.0951704545454546, 1.042905434688394, 1.0, 1.8085106382978724, 1.1666666666666667, 1.0, 1.0340909090909092, 1.0598290598290598, 1.3846153846153846, 1.0957446808510638, 1.0278756808715155, 1.0802005012531328, 1.0441952388617624, 1.0014789982252021, 1.0989370400654128, 1.0256139296344053, 1.0324324324324323, 1.1221779548472774, 1.1528785679729077, 1.1139310344827587, 1.134393063583815, 1.0912569914630557, 1.0086898737412462, 1.0329189394900418, 1.0101266420385473, 2.0, 1.0738786279683377, 1.0489833641404807, 1.0410958904109588, 1.0, 1.0851063829787233, 1.1538461538461537, 1.0283185840707965, 1.5555555555555556, 1.5, 1.0290126578081351, 1.0353296605651323, 1.0086008432706486, 1.032577351726288, 1.037837837837838, 1.0157958687727826, 2.0, 1.2222222222222223, 1.2499137931034483, 1.0131872863794171, 1.0052578606224083, 1.0939173026540607, 1.0101197925978902, 1.0547945205479452, 1.003606667663328, 1.1989342806394316, 1.0143955871471175, 1.0295374536418231, 1.303030303030303, 1.1394557823129252, 1.0, 1.0113378684807257, 1.0221445829205125, 3.0, 1.0876656472986748, 1.0410826377483295, 1.2857142857142858, 1.2105882865989273, 1.0, 1.1875, 1.0273229461756375, 1.7692307692307692, 1.0032631159131287, 1.0252029047415634, 1.1875, 1.2608695652173914, 1.2185929648241205, 1.007173601147776, 1.0631307204881484, 1.0485485959758678, 1.0094697726455428, 1.0, 1.207310449706713, 1.0092307692307692, 2.0, 1.083815762160666, 1.0176918418548317, 1.0917691579943236, 1.01032552753474, 1.0883427078612748, 1.3452380952380953, 1.7142857142857142, 1.0741726892354508, 1.0517387616624259, 1.0480036651791016, 1.0873915943962642, 1.0132154528007193, 1.0818725790163835, 1.0531135531135531, 1.0120481927710843, 1.15, 1.0259808175890692, 1.0845425867507887, 1.039855072463768, 1.108718487394958, 1.0677425292998712, 4.0, 1.0047582843959733, 1.0023359608751403, 1.017059084376486, 1.2666666666666666, 1.0771071722384264, 1.1581196581196582, 1.0, 1.0000352696363701, 1.0134426229508198, 1.0688448074679113, 1.088235294117647, 1.6666666666666667, 1.0199884306851683, 1.5, 1.4172185430463575, 1.1538461538461537, 1.0847812434582373, 1.2857142857142858, 1.2950819672131149, 1.1331236897274632, 1.0, 1.287037037037037, 1.0472602739726027, 1.75, 1.0, 1.0991735537190082, 1.141732283464567, 1.1183115338882283, 1.0127523910733263, 1.0578512396694215, 1.0383480825958702, 1.089150378938971, 1.0415584415584416, 1.467065868263473, 1.1290322580645162, 1.3076923076923077, 1.0, 1.2033898305084745, 1.1803751803751803, 1.083986562150056, 1.1396859133309718, 1.018086212530822, 1.2013116057233704, 1.0070479945454007, 1.0465309828251494, 1.05294825511432, 1.0096385542168675, 1.2222222222222223, 1.0, 1.0303030303030303, 1.037804205717886, 1.116256157635468, 1.0065359477124183, 1.1032608695652173, 1.0743795341733486, 1.0249413829510086, 1.0162178740489232, 1.0897435897435896, 1.1578947368421053, 1.0473723168023685, 1.084437963944857, 1.045993946479189, 1.0617507500759988, 1.1776315789473684, 1.0862374483165977, 1.035156158018257, 1.1815431164901664, 1.0165631469979297, 1.1111111111111112, 1.0577841451766954, 1.2162162162162162, 1.0384615384615385, 1.115501519756839, 1.0347890451517394, 1.0, 1.0841584158415842, 1.0691819549392216, 1.1296296296296295, 1.0057807633489997, 1.1620762711864407, 1.0930232558139534, 1.0305310216988333, 1.0255948089401585, 1.1484689766317486, 1.0162213740458015, 1.0170261066969353, 1.016540802524797, 1.1290322580645162, 1.1428571428571428, 1.0, 1.25, 1.0119413830689112, 1.8333333333333333, 1.0373667880750033, 1.0614668030800711, 1.1043420469649978, 1.060223204885239, 1.0035324128513448, 1.0394426580921758, 1.037174721189591, 1.0027816411682893, 1.0230211097283208, 1.0839260312944523, 1.003767706061405, 1.015446224256293, 1.25, 1.046875, 1.284584980237154, 1.0609760582545695, 1.006514657980456, 1.0324336090552895, 1.1504424778761062, 1.02729044834308, 1.0370911900847735, 1.0318559556786704, 1.0006937799043063, 1.3125, 1.0030331999669535, 1.010652936772499, 1.116637323943662, 1.0008428150021071, 1.15625, 1.0481798715203425, 1.1592039800995024, 1.5625, 1.0480956254199527, 1.5, 1.0161290322580645, 1.032967032967033, 1.1827376938637897, 1.080604075691412, 1.0776470588235294, 1.2222222222222223, 1.0566037735849056, 1.0032537960954446, 1.0043804581345386, 1.0094776602497628, 1.070791975394939, 1.0384373673036094, 1.0, 1.0593645484949832, 1.0156746031746031, 1.0842671547836957, 1.0235897435897436, 1.2013888888888888, 1.0193868349864743, 1.0317204066495047, 1.1973913043478261, 1.0292533132205581, 1.0, 1.3333333333333333, 1.0048342541436464, 1.0130856901646264, 1.007897181790028, 1.0813925522106866, 1.0502793296089385, 1.0638297872340425, 1.002222749096082, 1.068041237113402, 1.0381679389312977, 1.308108108108108, 1.0042194092827004, 1.0285549501791587, 1.0119047619047619, 2.3333333333333335, 1.0299658172447208, 1.0004292083183342, 1.0305522914218566, 1.2137931034482758, 1.0010873504893076, 1.0028439314396969, 1.0298204979733643, 1.12, 1.2307692307692308, 1.1206199460916442, 1.0357894736842106, 1.109375, 1.6538461538461537, 1.0415912392446083, 1.004980079681275, 1.0855085508550855, 1.1714285714285715, 1.0467449092185777, 1.0694330320460148, 1.0081992104464015, 1.0459912989434432, 1.6666666666666667, 1.0769230769230769, 2.0, 1.0155642023346303, 1.4230769230769231, 1.3333333333333333, 1.3636363636363635, 1.31993006993007, 1.0036363636363637, 1.025583982202447, 1.044606882932811, 1.193058568329718, 1.6764705882352942, 1.0666666666666667, 1.0, 1.2432432432432432, 1.4, 1.0124610591900312, 1.0146120232603688, 1.00707730479493, 1.046875, 1.0059976884621435, 1.0010359841849756, 5.0, 1.0058691436153924, 1.19, 1.0, 1.3333333333333333, 1.0068513553768246, 1.1003370867101772, 1.0654304667309777, 1.0403726708074534, 1.0, 1.0271317829457365, 1.3282208588957056, 2.0, 1.5, 1.0725885826771653, 1.0486326473075838, 1.1802094086417934, 1.25, 1.0112962591179817, 1.0735863671572425, 1.1676646706586826, 1.1428571428571428, 1.1329787234042554, 1.0034319097014475, 1.2105263157894737, 1.1295069904341428, 1.0499511281257636, 1.0047281323877069, 1.0711297071129706, 1.0005234159779615, 1.1485909479077712, 1.1198347107438016, 1.2105263157894737, 1.0360496638933976, 1.1412618648799553, 1.032833571578959, 1.7216494845360826, 1.1724137931034482, 1.1791044776119404, 1.063660477453581, 1.0344617261360172, 1.0187299811886725, 1.003291117826632, 1.0316593886462881, 3.0, 1.25, 1.0367154881039167, 1.077396657871592, 1.3223108344680023, 1.0129035466106435, 1.0115403913697942, 1.1049027433516783, 1.1365979381443299, 1.0416666666666667, 1.0629667478971778, 1.0137248053255532, 1.0636417206835593, 1.0472854640980735, 2.5, 1.0533333333333332, 1.0610073737114347, 1.0862604540023895, 1.052661827974646, 1.0099310887970072, 1.1370738636363635, 2.0, 1.014218009478673, 1.0207460939258859, 1.0461503312771305, 1.102661596958175, 1.0026952244924792, 1.319327731092437, 1.3959938366718028, 1.1055072463768116, 1.0028349952689424, 1.058121409165813, 1.1002304147465438, 1.1101152368758003, 1.0, 1.015531453362256, 1.0014647990478807, 1.0528401585204756, 1.0818689411845306, 1.0472027972027973, 1.062700964630225, 1.3846153846153846, 1.0530785562632696, 2.5, 1.5, 1.4166666666666667, 1.0383631713554988, 1.146919431279621, 1.0224664859445207, 1.0591571499109858, 1.0480325644504749, 1.040794979079498, 1.076086956521739, 1.163265306122449, 1.0103186795457255, 1.6, 1.25, 1.0611382113821137, 1.0, 1.2331691297208538, 1.130153999006458, 1.054657794676806, 1.0306763402639139, 1.25, 1.1145510835913313, 1.3410852713178294, 1.1653366583541147, 1.000022936937185, 1.0285714285714285, 1.050737675422814, 1.0305845993297076, 1.0357779759251002, 1.1065182829888711, 1.392156862745098, 1.25, 1.0, 1.0, 1.0006973999499302, 1.6666666666666667, 1.5714285714285714, 1.35, 1.0036188178528347, 1.0804597701149425, 1.0174844895657078, 1.1039411000433088, 1.0, 1.2793296089385475, 1.0245362058647516, 1.2556053811659194, 1.0048076923076923, 1.25, 1.008695652173913, 1.0515521064301552, 1.0842105263157895, 1.0327259204165118, 1.0175302997911493, 1.023855399577943, 1.065889029003783, 1.0, 1.0526386105544423, 1.0027168905293198, 1.004393830703013, 1.2695652173913043, 1.0461515258156955]
origin-bjaq_15.87 	max: 5.0000	99th: 2.6667	95th: 1.6012	median: 1.0580	mean: 1.1483

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 17.201410 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=naru', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[2.3841858e-07 2.3841858e-07 1.1920929e-07 2.9802322e-07 5.9604645e-07]
Distance score: 2.980232238769531e-07
SAUCE Drift detection: False
Detection latency: 0.0232s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 2.044864 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 6.0000	99th: 2.5050	95th: 1.6259	median: 1.0637	mean: 1.1586
ReportEsts: [1.0823863636363635, 1.0328305235137534, 1.0486090461036208, 1.0256821829855538, 1.0285714285714285, 1.0, 1.1652785397237047, 1.009679992174744, 1.2, 1.0264608599779492, 1.0789353465894063, 1.0015988450780475, 1.0437956204379562, 1.027237354085603, 1.0105726872246696, 2.3790849673202614, 1.1025641025641026, 1.12, 1.6666666666666667, 1.1484674329501916, 1.0472247776755597, 1.0935207291358067, 1.1590909090909092, 1.0645446507515473, 1.0650145072166473, 1.005487490382095, 4.0, 1.0787109813608804, 1.0, 1.8, 1.1083333333333334, 1.0, 1.0109111285758088, 1.0098706716515438, 1.2380300957592338, 1.0020681265206812, 1.024057987364621, 1.0638297872340425, 1.0674157303370786, 1.2958300550747444, 1.0582470414201184, 1.0022631749110895, 1.0357142857142858, 1.0207500768521365, 1.0091074681238617, 1.1338844168501607, 1.368421052631579, 1.1375661375661377, 1.2698412698412698, 1.076867816091954, 1.6666666666666667, 1.0576923076923077, 1.0448430493273542, 1.0, 1.019237424667343, 1.0107174997954675, 1.0475215674806257, 1.1108545034642032, 1.072289156626506, 1.0150750495118308, 1.2622950819672132, 1.0240895831372918, 1.0680851063829788, 1.015625, 1.0740740740740742, 1.5, 1.1015175603410898, 1.063137339986982, 1.1428571428571428, 2.0, 1.0886641382216604, 1.0170511534603812, 1.0494479116658666, 1.1233396584440227, 1.0755452010846733, 1.1885521885521886, 1.0883155024124187, 1.0225225225225225, 1.0851063829787233, 1.0430292270393067, 1.0536535513541134, 1.1245674740484428, 1.0, 1.0, 1.0160919540229885, 1.0333333333333334, 1.0309278350515463, 1.5, 2.0, 1.0227557009525643, 1.0876448506610086, 1.1250810110174985, 1.0540970779483583, 1.2018916788649927, 1.1260744985673352, 1.2643020594965675, 1.2307692307692308, 1.1605744125326372, 1.3333333333333333, 1.1169403283940729, 1.4193548387096775, 1.0, 1.0565826532822995, 1.1218057921635434, 1.0153846153846153, 1.011737786758588, 1.05, 1.0035954489186056, 1.1061053668143772, 1.0711284206210925, 1.0588793922127255, 1.0170603674540681, 1.25, 2.0, 1.1446345256609642, 1.0110175121801641, 1.0591517857142858, 1.0319148936170213, 1.0063037164218245, 1.0, 1.1150805270863835, 1.1020569620253164, 2.0, 1.2181818181818183, 1.0, 1.0997920997920998, 1.013989744194271, 1.099236641221374, 1.0655737704918034, 1.5, 1.254001391788448, 2.0, 1.2941176470588236, 1.0116484950144442, 1.2307692307692308, 1.1153081510934393, 1.0766494563277738, 1.053260944264999, 1.5, 1.3333333333333333, 1.0525210084033614, 1.0828117477130477, 1.0357905982905984, 1.0539127726278583, 1.1927083333333333, 1.0404749055585536, 1.0026336047972124, 1.0, 1.0095492742551566, 1.0509683995922527, 1.0599173553719008, 1.0361714796070258, 1.3333333333333333, 1.059167422638847, 1.0272614622057001, 1.026890756302521, 2.0, 1.0, 1.0746268656716418, 1.1386443437992977, 1.0761822678558046, 1.1006191950464397, 1.1671309192200556, 1.0677966101694916, 1.1790123456790123, 1.1428571428571428, 1.2222222222222223, 1.0048219153427647, 1.3020408163265307, 1.1050119331742243, 1.0115021854152288, 1.0111695137976346, 1.0554459785229016, 1.0121527777777777, 1.0390763765541742, 1.2316945184467587, 1.048502994011976, 1.1720430107526882, 1.0569727891156462, 1.0582345191040843, 1.0507963839862247, 1.0026219304229196, 1.00625, 1.1, 1.022350027441738, 1.037266063311356, 1.0254545454545454, 1.0225674169586245, 1.1530054644808743, 2.0, 1.105793450881612, 1.0300140132124576, 1.103448275862069, 1.0202492211838006, 1.1091521233511703, 1.001680247615438, 1.0000515511368866, 1.0089730807577268, 1.0193238775727844, 1.0701802431589036, 1.0685290266259275, 1.08145106091718, 1.1182682154171066, 1.0018121424754987, 1.1801566579634464, 1.1459706476843308, 1.078125, 1.0266666666666666, 1.0297029702970297, 2.0, 1.0607734806629834, 1.0105353829843626, 1.6591549295774648, 1.1666666666666667, 1.023543990086741, 1.4444444444444444, 1.0022502730997598, 1.054054054054054, 1.053680529220916, 1.25, 1.038036809815951, 1.0607264472190692, 1.0050078247261345, 1.0207680977046814, 1.7142857142857142, 1.076056338028169, 1.05885636420351, 1.0089439845587136, 1.0361111111111112, 1.2537313432835822, 1.0424418604651162, 1.0594040185071343, 1.0446428571428572, 1.0026677840631328, 1.0060331641943236, 1.071917808219178, 1.183868169991327, 1.014908256880734, 1.1224489795918366, 1.0832786885245902, 2.0, 1.038343871099327, 1.0935416180927955, 1.024931291715744, 1.1268882175226587, 1.0769230769230769, 2.5, 1.0686468067681598, 1.140625, 1.074018863056503, 2.0, 1.053811659192825, 1.0696937697993665, 1.4285714285714286, 1.0157378100084138, 1.132882882882883, 1.1353754940711462, 1.0129870129870129, 1.0035360678925036, 1.0502991170539089, 1.0, 1.5, 1.015122386625013, 1.166599965696644, 1.0346320346320346, 1.025276376516046, 1.0331848599354034, 1.0101003132200959, 1.1085219707057257, 1.0269763901696454, 1.0585898709036743, 1.1084632229808065, 1.2789968652037618, 2.3636363636363638, 1.0114863243761996, 1.0553571428571429, 1.3137254901960784, 1.0357142857142858, 1.18873826903024, 1.0275229357798166, 1.0025672948954623, 1.0164397269575784, 1.074766355140187, 1.1715686274509804, 1.034476348380938, 1.1057471264367815, 1.0765558636666783, 1.0064143369936167, 1.5454545454545454, 1.0870098039215685, 1.1077111383108935, 1.0605061692262665, 1.0043013877297255, 1.0069820624598014, 1.0785979819437068, 1.0202133632790567, 1.0080806636155606, 1.0017049135608824, 1.0549580472921434, 1.0517934339737303, 1.1303462321792261, 1.25, 1.1538461538461537, 1.080400387471747, 1.0, 1.0347349177330896, 1.0334499185287433, 1.0034682080924855, 1.2058823529411764, 1.2941176470588236, 1.0980187695516164, 1.0246356696738377, 1.0479541308313787, 1.0416666666666667, 1.0116662738628328, 1.0037101544528426, 1.0763546798029557, 1.5, 1.9230769230769231, 1.0716589861751151, 1.5, 1.0158920879619133, 1.075968992248062, 1.1, 1.0045584503565237, 1.1481481481481481, 1.7, 1.0396141884293162, 3.0, 1.1416122004357299, 1.1183063511830635, 1.1649881593671116, 1.1722560975609757, 1.0242825607064017, 1.1120689655172413, 1.0348780845235546, 1.001368674960024, 1.1387874360847334, 1.0268594900114136, 1.095346628679962, 3.0, 1.3333333333333333, 1.0268901471366156, 1.25, 1.0500910746812386, 1.05, 1.3333333333333333, 1.0, 1.1673267326732673, 1.0861931364724662, 1.1418439716312057, 1.1411161000641437, 1.2179487179487178, 2.25, 1.0678171979173063, 1.0, 1.0819672131147542, 1.01657835161828, 1.247191011235955, 1.0750605326876512, 1.032166508987701, 2.25, 1.0, 1.0656934306569343, 1.155844155844156, 1.0618860510805501, 1.0101730357049505, 1.0448057589673576, 1.0384615384615385, 1.0, 1.00269188434824, 1.0, 1.1142857142857143, 4.0, 1.2140287769784173, 1.1111111111111112, 1.0485651214128036, 1.0521739130434782, 1.0228629278889756, 1.010308154200682, 1.1219325153374233, 1.0045224214024955, 1.038795518207283, 1.1407563025210083, 1.0298507462686568, 1.0775130671918793, 1.0723981900452488, 1.025, 1.0210315738732225, 1.036589684069717, 1.0788732394366196, 1.0666666666666667, 1.2972972972972974, 1.019927536231884, 2.0, 1.9259259259259258, 1.2142857142857142, 1.0686274509803921, 1.9158878504672898, 1.0961538461538463, 1.0311860940695297, 1.110344827586207, 1.0066788167048208, 1.1523846452113222, 1.0473448142200565, 1.0416666666666667, 1.0924369747899159, 1.0572139303482586, 1.0, 1.005862080760745, 1.4655172413793103, 1.0053074947113931, 1.0392717708882329, 1.0406252479568356, 1.0140010770059236, 2.0, 1.0194136291600633, 1.3333333333333333, 1.0465, 1.2727272727272727, 1.0492779444861215, 1.0061652281134401, 1.0479865176512329, 1.1885521885521886, 1.0745836350470674, 3.0, 1.0165513833992095, 1.0047867447103185, 1.0485520569983913, 1.0, 1.2096774193548387, 1.0547504025764896, 1.4628297362110312, 1.10749845498867, 1.0261943253438297, 1.0384615384615385, 1.0407142857142857, 1.1193131046272193, 1.0753940523332557, 1.0855549510337323, 1.106968106003786, 1.0916538658474142, 1.3076923076923077, 1.2164667393675028, 1.0001604959324313, 1.3461538461538463, 1.0280929227444624, 3.0, 1.5, 1.0763309813983322, 1.0148698884758365, 1.1993833504624871, 1.0252922579222117, 1.1368666278392545, 1.0, 1.113821138211382, 1.3214285714285714, 1.0293831484724654, 1.0416666666666667, 1.0, 1.090596768036646, 1.0, 1.0, 1.1198174210726513, 2.3333333333333335, 1.1771002270515731, 1.002245508982036, 1.3598484848484849, 1.2727272727272727, 1.0153854607396011, 1.037037037037037, 1.1071428571428572, 1.0462337337337337, 1.0714285714285714, 1.0655021834061136, 1.1783783783783783, 1.0727401129943503, 1.1105913798864016, 1.0, 1.0777777777777777, 1.0451566859144878, 1.0264802142219578, 1.1073318216175358, 1.0, 1.021726700971984, 1.005059796343197, 1.0216825672159584, 2.0, 1.0943827563683868, 1.0742044273641693, 1.1465796212398345, 1.1195239485981308, 1.0104416935247582, 1.0008621779765257, 1.0448398576512457, 1.0326821091429523, 1.75, 1.060657009829281, 1.1388888888888888, 1.0510913888222595, 1.0508006626173385, 1.047244094488189, 1.0347743245915195, 1.419277108433735, 1.048723123619432, 1.008361839604713, 1.0585781107543506, 1.0334928229665072, 1.008661714717361, 1.1632271571706296, 1.0238095238095237, 1.103448275862069, 1.001647195965637, 1.11482254697286, 1.0306596722024408, 1.0070571828362573, 1.0, 1.0614567526555387, 1.3579881656804733, 1.0, 1.2857142857142858, 1.002357679914071, 1.1107266435986158, 1.0443471119627703, 1.0, 2.0, 1.0342708579532025, 1.0150385048022843, 1.023936170212766, 1.0072331344008383, 1.0409123823316437, 1.006578947368421, 1.0820206409560023, 1.075709978373088, 1.2753623188405796, 1.0554371497880322, 1.2907444668008048, 1.1612903225806452, 1.0024112688666527, 1.09, 1.014709853287215, 1.0, 1.0847568988173455, 1.4867549668874172, 1.2615979381443299, 1.0575692963752665, 1.12668743509865, 1.0099502487562189, 1.0154867256637168, 1.036726542959675, 1.0, 1.7678571428571428, 1.5, 1.3333333333333333, 1.0198019801980198, 1.0219298245614035, 1.3687943262411348, 1.0960698689956332, 1.0194200585262039, 1.0933488914819136, 1.087728310502283, 1.0038222843286342, 1.002868882247562, 1.0096694198057394, 1.0394756292583285, 1.1044857768052516, 1.0017371163867979, 1.0057570008710073, 1.1052369077306734, 1.0516273849607183, 1.1709511568123394, 1.2457142857142858, 1.072895235790068, 1.1817102137767221, 1.0124618666879348, 1.1059907834101383, 1.0930540827147401, 1.022977022977023, 1.0, 1.0468384074941453, 1.1176470588235294, 3.0, 1.0028735632183907, 1.0103955697385039, 1.0157996146435453, 1.084788029925187, 1.1835443037974684, 1.0396086591464972, 1.1223605318039624, 1.0451127819548873, 1.0, 2.0, 1.0556962025316456, 1.4115044247787611, 1.014003294892916, 1.0040056550424128, 1.0, 1.0491573033707866, 1.105263157894737, 1.046174783707592, 1.1543026706231454, 1.0122815701730628, 1.0615649885880019, 1.023010728534908, 1.2465753424657535, 1.5, 1.0739217702060997, 1.0, 1.1224489795918366, 1.0946502057613168, 1.1533442088091355, 1.0857142857142856, 1.125, 1.0669544234102573, 1.2426470588235294, 1.122875816993464, 1.0258641823976464, 1.0270453008789724, 1.0126364158529582, 1.102633215840763, 1.0097431355181576, 1.0029277813923227, 1.0, 1.0278085443037974, 1.0905429071803854, 1.0909090909090908, 1.011111111111111, 1.060105734038227, 1.1515151515151516, 1.0923703115410996, 1.2727272727272727, 1.1471774193548387, 1.1270596041136791, 1.0555555555555556, 1.2246376811594204, 1.0079056992828939, 1.233009708737864, 2.25, 1.0772885650934432, 1.09149855907781, 1.0218199816163474, 1.046692607003891, 1.0188048534842453, 1.0092563648362336, 1.21483771251932, 1.0467380720545278, 1.1167192429022081, 1.0006305842641405, 1.0817181770560502, 1.0750605326876512, 1.2169934640522875, 1.032199625993455, 1.349056603773585, 1.0929897278788971, 1.1818181818181819, 1.3333333333333333, 1.01, 1.0149006622516556, 1.0299877600979193, 1.0579064587973275, 1.4444444444444444, 1.034099920697859, 1.0969782150386507, 1.4102564102564104, 1.0303598333463015, 2.3333333333333335, 1.036973764490543, 2.0, 1.3377308707124012, 1.2142857142857142, 1.1087680676650349, 1.3333333333333333, 1.3317535545023698, 1.1275862068965516, 1.0, 1.0328947368421053, 1.028507546115148, 1.8, 1.0, 1.0460526315789473, 1.0590062111801242, 1.1077150603894503, 1.0293333333333334, 1.0214190093708166, 1.0994236311239194, 1.0966850828729282, 1.3303571428571428, 1.4595959595959596, 1.097378277153558, 1.5172413793103448, 1.0, 1.0503533568904593, 1.2241379310344827, 1.0198618307426597, 1.1522731784792535, 1.0306450965839569, 1.202058191436601, 1.0197832062011674, 1.0562629647359183, 1.1004056795131847, 1.0105210420841684, 1.625, 1.0, 1.15, 1.0302308585746538, 1.1190283400809717, 1.008130081300813, 1.2049382716049384, 1.0145204432556363, 1.0258211657918261, 1.00042957946966, 1.0515463917525774, 1.173913043478261, 1.0334277620396601, 1.2113003095975232, 1.02510170178812, 1.0592746022652153, 1.190217391304348, 1.0818875353759074, 1.0813306843026789, 1.0823965880804782, 1.03003003003003, 1.0216476922214122, 1.096551724137931, 1.031886285055705, 1.0036363636363637, 1.0065302890169994, 1.0, 1.0593607305936072, 1.0, 1.1236673773987207, 1.059056129732199, 1.0746268656716418, 1.0115335893405493, 1.1696588868940754, 1.0, 1.0495193619795615, 1.005634309347559, 1.0968498659517427, 1.0016194331983805, 1.0536980749746707, 1.016326434729498, 1.1258278145695364, 1.2666666666666666, 1.0, 1.1, 1.0171759576958785, 1.625, 1.1424825174825175, 1.0467360877841227, 1.1809895833333333, 1.0839285714285714, 1.0017314791951482, 1.086322569102782, 1.0278637770897834, 1.0035335689045937, 1.0079716771001852, 1.0370925895897518, 1.003440325732118, 1.0224727583863906, 1.625, 1.028268551236749, 1.42, 1.0180793786224955, 1.123943661971831, 1.0289459311851448, 1.1759530791788857, 1.020967741935484, 1.0334281650071124, 1.0460992907801419, 1.0238539432334015, 1.1428571428571428, 1.0091627977664148, 1.016257836815022, 1.1776669224865695, 1.011727078891258, 1.0512820512820513, 1.2851851851851852, 1.20374531835206, 1.0639796837879905, 1.123076923076923, 1.0064625531768059, 1.0857142857142856, 1.0800551048522884, 1.1670792079207921, 1.1014851485148516, 1.0132450331125828, 1.1182893539581438, 1.1810344827586208, 1.0995348837209302, 1.0300730121113288, 1.0364333652924258, 1.1251665714829622, 1.0273195731929314, 1.2666666666666666, 1.0764872521246458, 1.078034172978686, 1.0562793966589177, 1.0046649703138253, 1.3508956796628029, 1.2626262626262625, 1.231237322515213, 1.035264483627204, 1.0062668473501657, 1.25, 1.0376692171865805, 1.0275449901505793, 1.0278868002478827, 1.519319938176198, 1.0253422469905393, 1.0701059953627028, 1.0773849232821882, 1.0708661417322836, 1.0089487295267026, 1.1193786691385073, 1.0078492935635792, 1.288888888888889, 1.0168997668997668, 1.017827919155552, 1.0303030303030303, 2.0, 1.029156481383073, 1.0056955270972532, 1.0024307243558581, 1.2439024390243902, 1.026500152299726, 1.0318389380636899, 1.0106232294617563, 1.0229042601923959, 1.1935483870967742, 1.1355742296918767, 1.0465116279069768, 1.037593984962406, 1.5, 1.063126168615522, 1.0131470829909615, 1.3880597014925373, 1.1951219512195121, 1.159767563332463, 1.0595181861124232, 1.15, 1.186046511627907, 1.0171884591774094, 1.1559633027522935, 1.0409638554216867, 1.1818181818181819, 1.072572878372081, 1.1851851851851851, 1.1467877654601308, 1.1441441441441442, 1.1785714285714286, 1.1737975804071998, 1.0656679380543173, 1.0082218709737405, 1.123076923076923, 1.4022988505747127, 1.0526315789473684, 1.1, 1.3111111111111111, 1.1884057971014492, 1.0167151162790697, 1.010316792507521, 1.0029086443794633, 1.00625, 1.0049629912421154, 1.0015232514950818, 6.0, 1.0413144947647281, 1.0305640163848335, 1.0, 1.4285714285714286, 1.0591437762929967, 1.1517393639238618, 1.032825776224887, 1.0389610389610389, 1.0, 1.0293159609120521, 1.1036414565826331, 1.169811320754717, 1.0105051164816024, 1.087848797250859, 1.0201280274533095, 1.2024063165810253, 1.5555555555555556, 1.00240720780477, 1.0684754521963824, 1.0886194029850746, 1.515625, 1.0996523754345306, 1.0, 1.086092715231788, 1.0658515452007318, 1.1007067137809188, 1.2222222222222223, 1.0419354838709678, 1.0256765737070053, 1.2323232323232323, 1.1137931034482758, 1.4516129032258065, 1.0545890129238495, 1.072506628594738, 1.0613818060966378, 1.578125, 1.0825688073394495, 1.1057463447806868, 1.0, 1.0277696579947384, 1.0476190476190477, 1.0142918958397427, 1.0604395604395604, 1.5, 1.20125, 1.0171622839354468, 1.106093979441997, 1.2, 1.0082636310775148, 1.043691359753536, 1.088820879612118, 1.045816733067729, 1.0535714285714286, 1.0071305955367753, 1.0088448641620475, 1.0694923607688516, 1.1915204678362572, 2.5, 1.1379310344827587, 1.1357227424389194, 1.2443778110944528, 1.0286980149647298, 1.0118332709838744, 1.1167361524717094, 1.3333333333333333, 1.0058252427184466, 1.0286484951731971, 1.0242320167906889, 1.0363036303630364, 1.0176993787339284, 1.3133802816901408, 1.3112745098039216, 1.0852826510721247, 1.0024552373850812, 1.0253822287017307, 1.0723120837297813, 1.12, 1.0256410256410255, 1.0276947173572548, 1.1236452450007632, 1.0641467634136932, 1.0635886093447608, 1.0455635491606714, 1.0452459016393443, 1.0723981900452488, 1.083916083916084, 3.0, 1.5, 1.6428571428571428, 1.0406852248394005, 1.1702544031311155, 1.0047546536561112, 1.0198042845038564, 1.0045672527974423, 1.0420284821118444, 1.0675675675675675, 1.3094688221709008, 1.0009482445768605, 1.3333333333333333, 1.4615384615384615, 1.1192073170731707, 1.1111111111111112, 1.1461836998706338, 1.1356637536412817, 1.0903500860867426, 1.0330044163696495, 1.2, 1.029885654885655, 1.0786749482401656, 1.0033323866325854, 1.000906881971416, 1.0567296996662958, 1.0497601918465227, 1.0228807512983458, 1.059972502726023, 1.1078561917443408, 1.607843137254902, 1.2126909518213866, 1.0, 3.0, 1.0007675254755117, 1.75, 1.3, 1.4444444444444444, 1.0732451678535098, 1.0019134385107276, 1.0056947608200455, 1.0121951219512195, 1.0, 1.0236911739248709, 1.0159760359460808, 1.4358288770053476, 1.045360824742268]
origin-bjaq_15.87 	max: 6.0000	99th: 2.5050	95th: 1.6259	median: 1.0637	mean: 1.1586

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 20.296331 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=39.575592