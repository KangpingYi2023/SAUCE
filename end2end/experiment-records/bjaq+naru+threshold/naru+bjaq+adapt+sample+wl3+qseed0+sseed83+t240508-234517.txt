Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='naru', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 83, 'naru': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.5789	median: 1.0581	mean: 1.1472
ReportEsts: [1.1496350364963503, 1.0446137105549511, 1.030678963103235, 1.001923076923077, 1.0714285714285714, 1.0, 1.2137466475394498, 1.022892767623543, 1.25, 1.0345285524568393, 1.1258765474850663, 1.002483422181771, 1.0280656303972366, 1.0627906976744186, 1.0604026845637584, 1.0, 1.0975609756097562, 1.0520722635494155, 3.0, 2.6666666666666665, 1.4210526315789473, 1.0620659909424197, 1.0075681371844614, 1.0847133757961784, 1.012993503248376, 1.0, 1.0605589033838818, 1.2, 1.4, 1.158273381294964, 1.0, 1.005115824810482, 1.0079474435313223, 1.3340732519422864, 1.0452870739944735, 1.0256922347843749, 1.0625, 1.00473981982857, 1.1396101659893931, 1.2261904761904763, 1.0427807486631016, 1.0121951219512195, 1.0, 1.083411292512901, 1.0433441308036402, 1.2314049586776858, 1.1067961165048543, 1.2466960352422907, 1.0264468121512607, 1.0, 1.045048300450483, 1.1663326653306614, 1.0032690658187993, 2.0, 1.2155844155844155, 1.0249780893952674, 1.0072727272727273, 1.0606060606060606, 1.3043478260869565, 1.25, 1.0860141766630316, 1.0367372353673723, 1.059090909090909, 1.1724137931034482, 1.0, 1.1059153369561454, 1.0892570817744522, 1.1666666666666667, 1.0, 1.0816779267923766, 1.0238663484486874, 1.054178674351585, 1.0990990990990992, 1.0429729248307802, 1.223529411764706, 1.1297071129707112, 1.0, 1.0472234368167905, 2.0, 1.0767740824700853, 1.1851851851851851, 1.0596490064028132, 1.196319018404908, 1.0011467889908257, 1.0614583333333334, 1.04, 1.0133217701332178, 1.0606098165592464, 1.1323529411764706, 2.3333333333333335, 1.0379278445883442, 1.0113261196737793, 1.0629139072847682, 1.3225806451612903, 1.2629757785467128, 1.046195652173913, 1.2272727272727273, 1.0059726962457338, 1.0, 1.0163235694205133, 1.1500359971202303, 1.0264084507042253, 1.0067140319715808, 1.0588235294117647, 1.0045312711126753, 1.108267137393351, 1.0168698436153183, 1.055365946150929, 1.026108839257628, 1.1666666666666667, 1.3333333333333333, 1.1434678065722683, 1.0010987213949163, 1.070317782285328, 1.103896103896104, 1.005575711511855, 1.0, 1.2533596837944665, 1.124401913875598, 1.0, 1.1868131868131868, 1.1666666666666667, 1.0426065162907268, 1.0079764561896238, 1.1965519919235847, 1.037037037037037, 1.8, 1.3642384105960266, 1.0, 1.3928571428571428, 1.02037603132572, 1.1818181818181819, 1.009695973705834, 1.0086605914826003, 1.0417329580222738, 1.1666666666666667, 1.0273972602739727, 1.0116913484021823, 1.00199203187251, 1.0478927203065134, 1.0484547820429408, 1.2901234567901234, 1.091976516634051, 1.01014186315246, 2.0, 1.0091996320147194, 1.0186263096623982, 1.0446650124069479, 1.0157049585318512, 1.0, 1.0053281666263019, 1.005925925925926, 1.014, 1.4476190476190476, 1.0223880597014925, 1.0318610923803102, 1.015028901734104, 1.1212913698259537, 1.1692015209125475, 1.1611842105263157, 1.0208333333333333, 1.0942028985507246, 1.084664536741214, 1.1428571428571428, 1.0049565240751852, 1.0078689124583489, 1.011648223645894, 1.008639771510175, 1.0580329871716554, 1.1151572977127562, 1.0063157894736843, 1.0756302521008403, 1.2021884380749492, 1.028066528066528, 1.1766497461928933, 1.045731707317073, 1.0364092906465787, 1.0233111322549953, 1.081120141462917, 1.0, 1.2, 1.0555638313719649, 1.0480568324279147, 1.1330003699593045, 1.1176470588235294, 1.030896938579329, 1.0038439361906593, 1.0199554141505962, 1.0740740740740742, 1.103309929789368, 1.069560231638094, 1.0, 1.5454545454545454, 1.0549146481631264, 1.2372304199772985, 1.0954545454545455, 1.4, 1.0186495176848875, 1.0006581349073727, 1.0101979359594981, 1.1798245614035088, 1.1876251712870243, 1.127388535031847, 1.109375, 1.0, 1.0, 1.0666666666666667, 1.0428165904431477, 1.7421602787456445, 1.1149425287356323, 1.0148294611962432, 1.0957683741648108, 1.0833750951240788, 1.0344095279093126, 1.006364876274599, 1.1972789115646258, 1.1107544141252006, 1.0478777589134125, 1.0310487274019455, 1.0156457358385136, 1.0, 1.0587991718426502, 1.087940440785457, 1.012265836147995, 1.0801152737752162, 1.0796196263785731, 1.0002960581965827, 1.0344827586206897, 1.0022633348142809, 1.139917695473251, 1.1810490693739424, 1.0208333333333333, 1.1302634308234807, 1.0173160173160174, 1.1590551181102362, 1.0, 1.0269352099005096, 1.0036846806610094, 1.0289435600578871, 1.3843283582089552, 1.0909090909090908, 2.6666666666666665, 1.04664005205677, 1.1454545454545455, 1.1031529778123783, 1.5, 1.0, 1.25, 1.0815768930523029, 1.7346938775510203, 1.0939226519337018, 1.1909547738693467, 1.1007067137809188, 1.0136170212765958, 1.0359845918584618, 1.0350877192982457, 1.0, 1.0141056484280222, 1.1051187045423356, 1.094570928196147, 1.0327950256919556, 1.1024533956417941, 1.040921895006402, 1.1136724960254372, 1.0401915391792687, 1.0651913875598087, 1.1422448007620256, 1.0998109130199891, 1.7272727272727273, 1.0621396309821256, 1.1023454157782515, 1.25, 1.1363636363636365, 1.108, 1.0555555555555556, 1.0934579439252337, 1.026808424735886, 1.0919220055710306, 1.1981981981981982, 1.005690833191843, 1.0401396160558465, 1.0043855720650339, 1.0118056550414127, 1.4, 1.0709530738450346, 1.0, 1.0072712512023154, 1.0647948164146868, 1.0016157662373129, 1.275, 1.6666666666666667, 1.0434782608695652, 1.5211267605633803, 1.0049216264571006, 1.0, 1.0749235474006116, 1.035128805620609, 1.0368589743589745, 1.0048295645221066, 1.18125, 1.0251572327044025, 1.0169631556743075, 1.058196118372659, 1.0974764099188061, 1.1538461538461537, 1.0, 1.224343675417661, 1.0172413793103448, 1.1838006230529594, 1.0545071609098569, 1.0610619469026548, 1.1414790996784565, 1.2040816326530612, 1.010973936899863, 1.1001986942946353, 1.4285714285714286, 1.0206514314708925, 1.0695970695970696, 1.1176470588235294, 1.0349182974144036, 1.2380952380952381, 1.75, 1.0178011417165325, 2.0, 1.0, 1.063953488372093, 1.0123051681706317, 1.0601443464314355, 1.1906005221932114, 1.1978021978021978, 1.0090098621464034, 1.0089562747136693, 1.008174386920981, 1.0381452174982575, 1.0373096629862164, 2.0, 1.1111111111111112, 1.0406544667594144, 1.3333333333333333, 1.0504109589041095, 1.0, 1.0, 1.0454545454545454, 1.1942446043165467, 1.0916104146576664, 1.162162162162162, 1.025974025974026, 1.0, 1.0639147802929427, 1.001672024136378, 1.5, 1.0559857057772484, 1.0, 1.0126470811508388, 1.0853658536585367, 1.0728942534767778, 1.1612903225806452, 1.0018181818181817, 1.1704885343968097, 1.1759259259259258, 1.0032728598100253, 1.0061730181235955, 1.0252996005326231, 1.0, 1.1428571428571428, 1.8333333333333333, 1.5, 1.1428571428571428, 1.0024883939249754, 1.25, 1.1148086522462561, 1.1782178217821782, 1.023945267958951, 1.0170812733788486, 1.012358393408857, 1.0816842204694659, 1.030484160191273, 1.2804878048780488, 1.5, 1.00418410041841, 1.053811659192825, 1.011768589066018, 1.2857142857142858, 3.142857142857143, 1.0913140311804008, 1.027906976744186, 1.0076208025646998, 1.152542372881356, 1.342769701606733, 1.039237986920671, 1.3793103448275863, 1.0808477237048666, 1.0360169491525424, 1.2692307692307692, 1.052160953800298, 1.128440366972477, 1.0228595747267946, 1.0121482853485142, 1.0411609865431894, 1.4333333333333333, 1.0360360360360361, 1.0623145400593472, 1.0, 1.057587020945301, 1.0256143604350343, 1.027187883559899, 1.0112355500012016, 1.0393000573723465, 1.0073623559539053, 1.8333333333333333, 1.0303180914512922, 1.2, 1.067463706233988, 1.1111111111111112, 1.0212159208175675, 1.0130434782608695, 1.0389079965606192, 1.1699604743083003, 1.0891608391608392, 3.0, 1.1012903225806452, 1.0040880817858973, 1.0799383851388633, 1.0, 1.1886792452830188, 1.0124760076775432, 1.3045977011494252, 1.0759473346178547, 1.26246719160105, 1.1666666666666667, 1.2096635030198446, 1.115221913197934, 1.0944346982195514, 1.001152894998548, 1.080921052631579, 1.2056384742951907, 1.1704545454545454, 1.1538461538461537, 1.0482233502538072, 1.3, 1.0470668485675307, 1.0909090909090908, 1.0120814857656963, 1.08, 1.1282324212635402, 1.0390336231987571, 1.1079972658920028, 1.0, 1.0857142857142856, 1.2, 1.003240162398501, 1.5645514223194747, 1.0, 1.0989223542415032, 1.0123455339942677, 1.3280132085855807, 1.0, 2.0, 1.1588349514563108, 1.0008968609865472, 1.3677130044843049, 1.0, 1.0172422323372254, 1.0505952380952381, 1.0869565217391304, 1.0088512241054615, 1.0272727272727273, 1.026246719160105, 1.142741935483871, 1.0151451409339503, 1.1087193616899145, 1.0, 1.054054054054054, 1.0818836978131212, 1.00689687166561, 1.0806711503432815, 1.0, 1.0221569070766447, 1.0083030136496511, 1.0282870612886328, 2.0, 1.1311802232854864, 1.0948637069817806, 1.055859496425241, 1.1578349569699882, 1.0261926116309474, 1.162169603524229, 1.0084033613445378, 1.011089681774349, 2.0, 1.0415008527572485, 1.2333333333333334, 1.0, 1.3402777777777777, 1.1555555555555554, 1.0486100489028543, 1.0, 1.0695854120075692, 1.2146042363433667, 1.0609895746355893, 1.0231299878263223, 1.0013696730122403, 1.087378640776699, 4.0, 1.0297251230344497, 1.055330057679983, 1.0046940076014474, 1.0166505212879215, 1.110735418427726, 1.0123216601815823, 1.1, 1.4285714285714286, 1.0328145037592094, 1.0042115583880205, 1.0209049573028723, 1.1091305929428883, 1.0531285696154333, 1.0783505154639175, 1.0085643540321405, 1.0153340635268346, 1.0902777777777777, 2.0, 1.0909090909090908, 1.0690184049079754, 1.050185873605948, 1.0347222222222223, 1.043424317617866, 1.0, 1.267515923566879, 1.0554699537750385, 1.032967032967033, 1.0324269878016206, 1.4675324675324675, 1.0247601743066996, 1.0, 1.1826677994902295, 1.3214285714285714, 1.177304964539007, 1.0181564245810055, 1.151133501259446, 1.0, 1.072632944228275, 1.020991641337386, 1.0, 1.702127659574468, 2.0, 1.0, 1.0113636363636365, 1.1046770601336302, 1.3556485355648535, 1.1256830601092895, 1.0289971163088754, 1.1570469798657719, 1.0733445239971224, 1.0309110629067244, 1.0980392156862746, 1.064471094651323, 1.0946745562130178, 1.0784939374601148, 1.1485244315432994, 1.068536649907383, 1.092485549132948, 1.0810731991834355, 1.0126691329245427, 1.0627264353699724, 1.0100204185206605, 2.0, 1.1007371007371007, 1.044362292051756, 1.0410958904109588, 1.0, 1.2439024390243902, 1.1538461538461537, 1.0235507246376812, 1.5185185185185186, 1.3333333333333333, 1.0283562801332073, 1.0300337657721699, 1.0028130577614527, 1.0500911468653404, 1.1027027027027028, 1.037667071688943, 2.0, 1.1578947368421053, 1.103676638501941, 1.0005578133715833, 1.0078546922300706, 1.0368492994646314, 1.013552655104595, 1.1458333333333333, 1.0428965356532547, 1.1616341030195383, 1.0018162656680942, 1.0339144185696267, 1.4242424242424243, 1.0876623376623376, 1.0, 1.0113378684807257, 1.0231761000817776, 3.0, 1.0662589194699286, 1.016921961189372, 1.2857142857142858, 1.184401399436812, 1.0, 1.1875, 1.0255453257790368, 1.6923076923076923, 1.008009940854353, 1.0140965399401964, 1.2258064516129032, 1.3181818181818181, 1.1945812807881773, 1.0019129603060737, 1.1187947641392937, 1.0143616696204854, 1.0130182576385363, 1.0, 1.168911579404736, 1.0304878048780488, 2.0, 1.0207578937657125, 1.0367159788909075, 1.1002838221381268, 1.00906938416215, 1.010226075881157, 1.2840909090909092, 2.0, 1.0330924305819704, 1.0508474576271187, 1.0641576027013728, 1.0290193462308206, 1.0325285720049104, 1.062290957525529, 1.0622710622710623, 1.0532915360501567, 1.1325757575757576, 1.0212964817411043, 1.0757097791798107, 1.010064043915828, 1.111344537815126, 1.0620973185248819, 4.0, 1.004600985738255, 1.0650192344012486, 1.0028156288412846, 1.1875, 1.0028549543903629, 1.0711462450592886, 1.0, 1.0082139174341287, 1.0134426229508198, 1.099639855942377, 1.1176470588235294, 1.6666666666666667, 1.0373250168338235, 1.5, 1.3587301587301588, 1.1538461538461537, 1.0802456213802247, 1.2857142857142858, 1.3166666666666667, 1.090146750524109, 1.0, 1.187830687830688, 1.047978067169294, 2.0, 1.0, 1.0991735537190082, 1.0984848484848484, 1.1043400713436384, 1.006335797254488, 1.0509031198686372, 1.0119402985074626, 1.089150378938971, 1.0467532467532468, 1.6554054054054055, 1.225, 1.2307692307692308, 1.0, 1.1044444444444443, 1.2813852813852813, 1.0031088082901554, 1.1413030625517322, 1.0220882096799209, 1.209423298154354, 1.0285403017816381, 1.0150809085238321, 1.0433212996389891, 1.0286396181384247, 1.375, 1.0, 1.0, 1.0232894052232258, 1.1964097148891235, 1.0065359477124183, 1.313915857605178, 1.042229858724704, 1.0139717851329355, 1.003719206040966, 1.0256410256410255, 1.1578947368421053, 1.0436713545521836, 1.1875, 1.039402282022311, 1.0161778506192258, 1.1973684210526316, 1.0499113998818665, 1.002112397799459, 1.2203125, 1.031512605042017, 1.1111111111111112, 1.0674698795180724, 1.1399229781771503, 1.0192307692307692, 1.3107142857142857, 1.0347890451517394, 1.0, 1.045346062052506, 1.0505266734624532, 1.1296296296296295, 1.023491669253855, 1.1769067796610169, 1.0238095238095237, 1.0466325009995274, 1.0035090257931483, 1.154781090518399, 1.0264446620959844, 1.0173210161662818, 1.004283137962128, 1.1715481171548117, 1.0, 1.0, 1.1111111111111112, 1.0166888700496548, 1.8333333333333333, 1.0395701245559603, 1.0404124710570244, 1.2392556490917146, 1.0933767643865364, 1.0025698896180253, 1.0981779206859592, 1.0608365019011408, 1.0083916083916085, 1.0182731819569353, 1.0498966637142013, 1.0049660858519283, 1.0010237263639647, 1.25, 1.0, 1.2450592885375493, 1.0167943429581614, 1.0488599348534202, 1.0313111545988258, 1.152212389380531, 1.0077972709551657, 1.0367063492063493, 1.0163710777626194, 1.0330741626794258, 1.375, 1.0449897630197915, 1.013038410906987, 1.1427927927927928, 1.0008428150021071, 1.09375, 1.0171306209850106, 1.099502487562189, 1.625, 1.0091777170428855, 1.2692307692307692, 1.215725806451613, 1.0043956043956044, 1.1362103843560352, 1.0436100353594882, 1.068235294117647, 1.375, 1.087378640776699, 1.0168020883120703, 1.0321178514699896, 1.0032561527590136, 1.0924601971866141, 1.0620966411006976, 1.0769230769230769, 1.0629194630872483, 1.0646838602329451, 1.0469217375775703, 1.017329255861366, 1.2083333333333333, 1.0422932330827068, 1.0143491409819188, 1.2068361086765995, 1.013742969330362, 1.0, 1.3333333333333333, 1.0094786026848623, 1.0147741663149008, 1.0106750514343388, 1.1083379552597523, 1.0766161213088588, 1.0975609756097562, 1.008614996402204, 1.0659121599897112, 1.0036764705882353, 1.2918918918918918, 1.0196078431372548, 1.02727875128847, 1.0238095238095237, 1.75, 1.0217834542938335, 1.0005399717553236, 1.015963511972634, 1.2394366197183098, 1.0492396813902969, 1.0018635051976497, 1.0203671830177854, 1.0525, 1.2307692307692308, 1.133423180592992, 1.0042283298097252, 1.08125, 1.6538461538461537, 1.0785450888367416, 1.0158572844400398, 1.0914027149321266, 1.2058823529411764, 1.033042431537767, 1.0720757825370675, 1.011201732715151, 1.0782701548318205, 1.6666666666666667, 1.037037037037037, 1.0, 1.0349675558759914, 1.5384615384615385, 1.3333333333333333, 1.3636363636363635, 1.2336601307189543, 1.0235507246376812, 1.09896887711664, 1.0284492924528301, 1.1111111111111112, 1.4264705882352942, 1.0, 1.096774193548387, 1.3243243243243243, 1.3461538461538463, 1.0264797507788161, 1.0045251008016858, 1.0056831114942142, 1.046875, 1.0023649899230864, 1.000765727441069, 5.0, 1.0062093838249804, 1.177142857142857, 1.0, 1.3333333333333333, 1.0801775147928994, 1.0985440722943411, 1.0650970023937976, 1.0186335403726707, 1.0, 1.070539419087137, 1.0153374233128833, 2.0, 1.5, 1.0967027559055118, 1.015840502526287, 1.1851029172219754, 1.25, 1.0038148996148706, 1.064291247095275, 1.0133333333333334, 1.3333333333333333, 1.1451612903225807, 1.0036571182714737, 1.736842105263158, 1.1181934073939173, 1.0376743343597175, 1.0588235294117647, 1.0158730158730158, 1.0396280991735538, 1.178479931682323, 1.115702479338843, 1.1694915254237288, 1.0346603976949647, 1.0233610567514677, 1.0953425750473722, 1.4152542372881356, 1.2439024390243902, 1.164179104477612, 1.0335051546391754, 1.051782945736434, 1.0037130565841876, 1.0137445029757743, 1.0360262008733625, 3.0, 1.25, 1.086772266222037, 1.1649076517150396, 1.3472087142579265, 1.0167585914297836, 1.0210737581535374, 1.101109482939083, 1.2049180327868851, 1.1041666666666667, 1.0453580693341717, 1.0418832569702698, 1.0948733058338245, 1.117338003502627, 2.5, 1.12, 1.041970872673063, 1.0721624850657108, 1.0441574095188455, 1.0118606024808032, 1.1278409090909092, 2.0, 1.0058754406580495, 1.0208380240464718, 1.0356408498971899, 1.129277566539924, 1.0124028512849854, 1.1760299625468165, 1.270687237026648, 1.0898550724637681, 1.002149341014227, 1.0250679553005135, 1.099078341013825, 1.119078104993598, 1.0, 1.0413737877035323, 1.0090630260821438, 1.0647291941875825, 1.0061772799415385, 1.0357348703170028, 1.031201248049922, 1.3846153846153846, 1.0509554140127388, 2.5, 1.5, 1.4166666666666667, 1.0230179028132993, 1.1737756714060033, 1.0668795722084, 1.0442608307280035, 1.0781546811397558, 1.0338912133891214, 1.076086956521739, 1.510204081632653, 1.0153903350940325, 1.6, 1.3333333333333333, 1.0517073170731708, 1.0, 1.1977671451355663, 1.1279127416955874, 1.041881866841957, 1.0163728894644375, 1.0, 1.0312899106002553, 1.3333333333333333, 1.061845386533666, 1.000307347908658, 1.0219354838709678, 1.0514944184371624, 1.0122607478661962, 1.0494635798983625, 1.1271860095389508, 1.5777777777777777, 1.2262569832402235, 1.0, 1.0, 1.0008315153249168, 1.6666666666666667, 1.5714285714285714, 1.255813953488372, 1.0122100122100122, 1.1325301204819278, 1.0078212290502793, 1.1209322779243625, 1.0, 1.2501551831160769, 1.0239234449760766, 1.1345291479820627, 1.0121654501216546, 1.25, 1.0263041556145005, 1.0116407982261642, 1.0706860706860706, 1.0472294533283748, 1.0079331465432984, 1.1885184790712535, 1.0885383129426915, 1.0, 1.0267581773163634, 1.0144665745986905, 1.0132654915500636, 1.2695652173913043, 1.0003363929069153]
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.5789	median: 1.0581	mean: 1.1472

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 20.530860 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=naru', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[7.7486038e-07 5.3644180e-07 1.4901161e-06 5.9604645e-08 2.3841858e-07]
Distance score: 6.19888282926695e-07
SAUCE Drift detection: False
Detection latency: 0.0232s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 2.031219 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 5.0000	99th: 2.5000	95th: 1.7509	median: 1.0657	mean: 1.1651
ReportEsts: [1.1415929203539823, 1.0473480537218303, 1.0418736692689852, 1.0161812297734627, 1.1176470588235294, 1.0, 1.2279349662162162, 1.0195455201379238, 1.6, 1.031973539140022, 1.0441452272180813, 1.002312088610796, 1.0375137918352335, 1.023121387283237, 1.050685748360167, 1.0224719101123596, 1.0846905537459284, 1.3181818181818181, 2.111111111111111, 1.1293436293436294, 1.0497895493275844, 1.0381187681990647, 1.0147783251231528, 1.064102564102564, 1.0170406435224386, 1.0052154016980899, 3.0, 1.04911838790932, 1.2857142857142858, 1.5, 1.251340083382966, 1.0, 1.0083795140798397, 1.00825562196228, 1.397329650092081, 1.0092932257275617, 1.0290390856497813, 1.055299539170507, 1.3333333333333333, 1.1542260208926876, 1.1006500101564087, 1.0044179750947482, 1.1163069544364508, 1.0307390451275342, 1.0124777183600713, 1.0550434112165197, 1.1904761904761905, 1.0009680542110357, 1.632258064516129, 1.1023151605675878, 1.0819672131147542, 1.1223021582733812, 1.0223214285714286, 1.3, 1.0435783098054179, 1.0269500081419964, 1.0355226910250834, 1.1091314031180401, 1.0853658536585367, 1.0385034634008643, 1.0454545454545454, 1.0216453544490856, 1.026536312849162, 1.049429657794677, 1.174757281553398, 1.0, 1.1168546456284074, 1.0065952184666116, 1.2857142857142858, 1.0, 1.0032725572697523, 1.0471887550200802, 1.0764023210831721, 1.115530303030303, 1.0468645391653648, 1.04455205811138, 1.0020872158032055, 1.1855670103092784, 1.0851063829787233, 1.0296223712972037, 1.1505316172355904, 1.8636363636363635, 1.0, 2.0, 1.0254041570438799, 1.0344827586206897, 1.0373831775700935, 1.0625, 2.0, 1.0751300728407909, 1.0920816326530611, 1.0182075931422496, 1.028014137976175, 1.1084175778832268, 1.0201511335012594, 1.2819932049830125, 1.1953867028493894, 1.367801047120419, 1.062992125984252, 1.1240496198479393, 1.3448275862068966, 1.0, 1.0569584837545127, 1.298253089049851, 1.0072254335260116, 1.0110307094952347, 1.0256410256410255, 1.0043368373436148, 1.131118881118881, 1.083117171866894, 1.0535202293724115, 1.0299869621903521, 1.3333333333333333, 3.0, 1.1467379202850145, 1.005946179997342, 1.043189368770764, 1.0208333333333333, 1.0067310883164355, 2.0, 1.1311622348371677, 1.1302931596091206, 1.5, 1.1441441441441442, 1.4285714285714286, 1.1132075471698113, 1.0176032478360526, 1.1153322528363048, 1.062992125984252, 1.8333333333333333, 1.268993839835729, 1.0, 2.0, 1.012163416898793, 1.0, 1.0920245398773005, 1.0730891493096741, 1.0402201236497044, 1.6666666666666667, 1.3333333333333333, 1.0286298568507157, 1.0127157129881925, 1.048832271762208, 1.033649061279206, 1.12, 1.0178571428571428, 1.0518503543231683, 2.0, 1.0007680491551458, 1.0524193548387097, 1.0253292806484295, 1.0346600088118667, 1.3333333333333333, 1.0827029752899646, 1.0568603213844252, 1.026711185308848, 1.1583493282149713, 1.0, 1.107413010590015, 1.0566659553785238, 1.2299646324027391, 1.1600633914421552, 1.084010840108401, 1.0178571428571428, 1.018181818181818, 1.1319727891156464, 1.1111111111111112, 1.0065450010827441, 1.1764705882352942, 1.0525700934579438, 1.0049121923132287, 1.162962962962963, 1.0950426414922243, 1.0069686411149825, 1.060931899641577, 1.218821045794089, 1.0059880239520957, 1.1236863379143087, 1.0446127946127945, 1.042658989793248, 1.025998626666351, 1.000831875773218, 1.1631205673758864, 1.0, 1.0173906226221057, 1.1161024216931432, 1.0149812734082397, 1.0257046499030178, 1.2039106145251397, 2.0, 1.0970149253731343, 1.0131963130474608, 1.0, 1.0285565939771548, 1.1378539731187944, 1.0005857706908965, 1.0459408432976716, 1.0264765784114054, 1.0499890972525077, 1.0554534720427027, 1.0701754385964912, 1.0436458829128987, 1.0516112789526686, 1.0226048527989418, 1.1864229765013055, 1.0389142656359802, 1.3136094674556213, 1.0133333333333334, 1.0520833333333333, 1.0, 1.0888888888888888, 1.0096675936961992, 1.6978851963746224, 1.0727272727272728, 1.0256941566514712, 1.25, 1.0073893239268585, 1.039911308203991, 1.0417776298268975, 1.2666666666666666, 1.1535269709543567, 1.0379320033717336, 1.0095889914025562, 1.0125259950669827, 3.0, 1.038490566037736, 1.0153257962358269, 1.0890087660148349, 1.0159151193633953, 1.2140522875816993, 1.0367074527252502, 1.0942628418945963, 1.0256410256410255, 1.0022640612880458, 1.0036605316973415, 1.1508771929824562, 1.1695501730103806, 1.0378874856486797, 1.875, 1.0701179554390563, 1.0, 1.0272562083585706, 1.0660606060606062, 1.0762745098039215, 1.393939393939394, 1.3076923076923077, 3.3333333333333335, 1.0172761849034524, 1.121212121212121, 1.0723440860215054, 2.0, 1.0451612903225806, 1.0431372549019609, 1.0, 1.004287583347783, 1.1278538812785388, 1.1242603550295858, 1.0104712041884816, 1.0242165242165242, 1.0388097233864209, 1.0434782608695652, 2.0, 1.027809617860229, 1.0907166962191843, 1.1125925925925926, 1.020285106827925, 1.0890692548953125, 1.0101662694750182, 1.1062416998671978, 1.042068258385821, 1.0605302651325663, 1.207639569049951, 1.3419248697559638, 2.0833333333333335, 1.094364167633991, 1.3267504488330342, 1.2407407407407407, 1.103448275862069, 1.0745125348189415, 1.0823170731707317, 1.0407034658056538, 1.0162567296526972, 1.0804597701149425, 1.2291666666666667, 1.0020999825001458, 1.058259587020649, 1.0644501975746015, 1.0130830615072077, 1.7, 1.2832512315270936, 1.1267605633802817, 1.0119470592398612, 1.042544669460645, 1.029184340598422, 1.182543906333156, 1.0122358175750834, 1.0158223254463639, 1.050538673538781, 1.0317443081043907, 1.0442635775950808, 1.1288343558282208, 1.3396226415094339, 1.0, 1.0871175523349437, 1.1666666666666667, 1.0346715328467153, 1.0653829573214542, 1.016626475441046, 1.1142857142857143, 1.4132231404958677, 1.0790835181079084, 1.000861920358559, 1.0669579301621086, 1.2, 1.0788016112789527, 1.015525183968943, 1.1413333333333333, 2.0, 3.4285714285714284, 1.0738871041762277, 1.5, 1.026750311868691, 1.0620272314674735, 1.1363636363636365, 1.023692361638712, 1.1923076923076923, 2.111111111111111, 1.01816230881308, 3.0, 1.0294117647058822, 1.0562874251497005, 1.0719458018658374, 1.1379310344827587, 1.2878787878787878, 1.1226415094339623, 1.0272606382978724, 1.014581544695903, 1.038338658146965, 1.03222695656337, 1.063486170410247, 1.5, 1.0909090909090908, 1.0279021026961912, 1.0, 1.036935704514364, 1.1, 1.5, 1.0740740740740742, 1.1647398843930636, 1.0938251804330392, 1.2735042735042734, 1.043731778425656, 1.1566265060240963, 2.5, 1.069330312047831, 1.7142857142857142, 1.25, 1.045610769010454, 1.2924187725631768, 1.0507533703409992, 1.0326492537313432, 2.25, 1.5, 1.1079972658920028, 1.2125, 1.0348499515972895, 1.0119853326348873, 1.0846325167037862, 1.0248756218905473, 2.0, 1.0085503189497838, 1.3272727272727274, 1.2333333333333334, 2.0, 1.0612244897959184, 1.1, 1.0643776824034334, 1.0080645161290323, 1.0481064050242117, 1.0353019069723448, 1.0417457305502846, 1.0275711159737417, 1.0460461861441568, 1.134020618556701, 1.0256756756756757, 1.0247847335350244, 1.0555555555555556, 1.0555555555555556, 1.00246398429092, 1.0281148100401911, 1.124799511189185, 1.0829268292682928, 1.1162790697674418, 1.0857142857142856, 2.0, 1.962962962962963, 1.08130081300813, 1.0037593984962405, 1.7678571428571428, 1.0535714285714286, 1.0326961770623742, 1.0236406619385343, 1.2135313531353136, 1.1427475057559477, 1.0134136904063973, 1.0288461538461537, 1.098360655737705, 1.0771144278606966, 2.0, 1.0092083607636604, 1.4912280701754386, 1.0027953536689016, 1.0135493372606774, 1.0047607712449418, 1.001071524243236, 1.5714285714285714, 1.3481894150417828, 1.1666666666666667, 1.124911196911197, 1.1818181818181819, 1.0165625091687938, 1.0366300366300367, 1.0435326718512559, 1.173913043478261, 1.0959302325581395, 3.0, 1.1583239595050618, 1.0009261742928433, 1.0665939700030609, 1.0, 1.2758620689655173, 1.0146103896103895, 1.3833333333333333, 1.0817186183656275, 1.0867655966081162, 1.0, 1.0732232591529074, 1.131653316182346, 1.1191053875824313, 1.0076852858303698, 1.095528576364481, 1.0903373356203545, 1.16793893129771, 1.1923076923076923, 1.0245201597965496, 1.4122137404580153, 1.1597855227882037, 2.0, 1.5, 1.0852459016393443, 1.1183673469387756, 1.2375, 1.0202064572809137, 1.1687687687687687, 1.0, 1.072, 1.3448275862068966, 1.0087565121296638, 1.0416666666666667, 1.0, 1.0508871898442007, 1.3333333333333333, 1.0, 1.107089552238806, 1.75, 1.202079272254711, 1.0135542168674698, 1.3713235294117647, 1.2222222222222223, 1.028892235125862, 1.0362438220757826, 1.0357142857142858, 1.0750338486728173, 1.0546875, 1.0031948881789137, 1.1864520456069751, 1.058041958041958, 1.1888543410667305, 1.0, 1.010989010989011, 1.1793893129770991, 1.030785891089109, 1.075780089153046, 1.1666666666666667, 1.0130670151204033, 1.0217069905620566, 1.0406899601946042, 2.0, 1.1194527861194528, 1.072669346142535, 1.0234587146736398, 1.1983157741241661, 1.0192048916097358, 1.0368464453696282, 1.0056377730796335, 1.0254834880960693, 1.5, 1.1340789360048364, 1.063388625592417, 1.0456852791878173, 1.0245398773006136, 1.0075376884422111, 1.0557449647698862, 1.1192660550458715, 1.0617914012738854, 1.1916360294117647, 1.025471960688338, 1.0023148148148149, 1.0143908217982291, 1.1267595031990967, 1.108433734939759, 1.0340909090909092, 1.013029900800903, 1.0380549682875264, 1.0181333907288332, 1.0038846689128083, 1.3333333333333333, 1.2932216298552932, 1.1611111111111112, 1.4615384615384615, 1.2127659574468086, 1.0031115828066959, 1.0830449826989619, 1.0196645459803355, 1.0, 1.0316742081447965, 1.0350047303689687, 1.0029414782638437, 1.0219131097560976, 1.0000127918132395, 1.0494545454545454, 1.0142063001852997, 1.0813890396093326, 1.089117285625369, 1.2554744525547445, 1.0513212051685514, 1.4642857142857142, 1.0783410138248848, 1.0100980214368205, 1.018773466833542, 1.0496821476292668, 1.0, 1.0404551201011378, 1.4521452145214522, 1.2268467810636485, 1.0123203285420945, 1.124095139607032, 1.030252100840336, 1.4328358208955223, 1.003587710604559, 1.0, 1.9074074074074074, 1.5714285714285714, 1.0, 1.0388349514563107, 1.0222222222222221, 1.31993006993007, 1.1598173515981736, 1.0277999467943602, 1.0497002997002998, 1.0884652213059696, 1.001402466691416, 1.0233533635086625, 1.006927537714755, 1.033945656205826, 1.057501306847883, 1.0340261481729802, 1.0060436391598981, 1.1002444987775062, 1.0, 1.149234693877551, 1.1523178807947019, 1.0104239054899236, 1.2274412855377008, 1.016701877466417, 1.0861244019138756, 1.0815483870967741, 1.064516129032258, 1.6666666666666667, 1.015294117647059, 1.0625, 1.1428571428571428, 1.3588235294117648, 1.009734016684748, 1.0104046242774567, 1.16793893129771, 1.0564971751412429, 1.0094315293077405, 1.1882948127100732, 1.0, 1.6, 1.3333333333333333, 1.0451554223958055, 1.4570135746606334, 1.0060386473429952, 1.0132795826416885, 1.0, 1.1609892673821745, 1.1330049261083743, 1.031126284239714, 1.1845238095238095, 1.0021803821751418, 1.0896902636998749, 1.0079989675353067, 1.2727272727272727, 1.0, 1.1197865900579695, 2.0, 1.1156716417910448, 1.2207792207792207, 1.1626409017713366, 1.078844241679827, 1.09375, 1.0793840687000296, 1.1366906474820144, 1.0427083333333333, 1.020066889632107, 1.0699346405228758, 1.028486646884273, 1.0908341915550979, 1.0216411181244365, 1.0108196721311475, 1.4, 1.0338255033557047, 1.0787746170678336, 1.2380952380952381, 1.0489462950373896, 1.0825443068705998, 1.0136986301369864, 1.0827195262853841, 1.0909090909090908, 1.1810526315789474, 1.0353574926542606, 1.2507204610951008, 1.2907801418439717, 1.0241238402823585, 1.3762376237623761, 2.0, 1.1153601019757808, 1.0442415730337078, 1.0767372198830079, 1.0542657342657342, 1.033299900661775, 1.0210398744362545, 1.1352154531946508, 1.004619648906683, 1.1623376623376624, 1.0299602539664872, 1.0880801687763713, 1.0411676646706587, 1.1527593818984547, 1.0794944965348552, 1.3636363636363635, 1.0798800916945865, 1.263157894736842, 1.1428571428571428, 1.0242966751918159, 1.0056230727371667, 1.0519440124416797, 1.0408163265306123, 1.5555555555555556, 1.0425020048115476, 1.1073684210526316, 1.3384615384615384, 1.0193143508441875, 2.0, 1.0063544767574994, 2.0, 1.3866666666666667, 1.2, 1.143060684481405, 1.3333333333333333, 1.290909090909091, 1.1252189141856392, 1.0, 1.088568073864546, 1.0060975609756098, 1.8, 1.5, 1.1125827814569536, 1.1009463722397477, 1.072872473171949, 1.0062056737588652, 1.0254010695187166, 1.1179713340683572, 1.0696378830083566, 1.0426829268292683, 1.620879120879121, 1.4413145539906103, 1.1875, 1.0, 1.0236087689713322, 1.2210144927536233, 1.0446030330062444, 1.1194562283069804, 1.0053678730109021, 1.211207980551597, 1.0127298444130128, 1.0920593080724876, 1.0059347181008902, 1.0220661985957873, 1.5, 1.0, 1.0, 1.005054422460709, 1.142127659574468, 1.0278551532033426, 1.2193211488250653, 1.0942765192149935, 1.0371541410421228, 1.010051850711022, 1.0210526315789474, 1.173913043478261, 1.0723404255319149, 1.0776849443921872, 1.0320825318190203, 1.0250634307777164, 1.2443181818181819, 1.095820213619806, 1.0508478927842462, 1.0028139873061521, 1.0052434456928838, 1.001512586601461, 1.169741697416974, 1.036764705882353, 1.1662174303683737, 1.004002866322473, 2.0, 1.0763555883437845, 1.0, 1.119914346895075, 1.0955343421208181, 1.1323529411764706, 1.0245964015872153, 1.1731289449954914, 1.08, 1.0121290531252527, 1.0086568334690678, 1.1315981172251486, 1.0016038492381716, 1.0291828793774318, 1.0077289919421148, 1.174911660777385, 1.1176470588235294, 1.0, 1.3, 1.0057106088635084, 1.8571428571428572, 1.0185883265878568, 1.0713677130044843, 1.1691257838436002, 1.078333630051629, 1.005338502098442, 1.1242424242424243, 1.1157556270096463, 1.0117924528301887, 1.0124144890463842, 1.0263638003969606, 1.002090787343341, 1.004495793042823, 1.5555555555555556, 1.1766917293233083, 1.3122923588039868, 1.0231314881454825, 1.0817438692098094, 1.008536368486573, 1.2560975609756098, 1.006472491909385, 1.0536880849451107, 1.0228310502283104, 1.0163139461789445, 1.411764705882353, 1.0356836184601628, 1.003073075107747, 1.1659687856870955, 1.002809975412715, 1.3235294117647058, 1.0218978102189782, 1.1076973684210527, 1.0840202651863495, 1.1238493723849372, 1.0040669197631646, 1.075, 1.0754573749335763, 1.2647798742138365, 1.1060025542784164, 1.2215743440233235, 1.0263157894736843, 1.1166207529843895, 1.0758556891766882, 1.0394282897979301, 1.0462873674059787, 1.017275225755791, 1.0110909554913334, 1.0666666666666667, 1.0621976503109882, 1.0926225094238018, 1.0285501621564144, 1.1503067484662577, 1.1704366123093108, 1.2111675126903554, 1.0291970802919708, 1.042362002567394, 1.0109674468472278, 1.2666666666666666, 1.0407319952774499, 1.0216379711493717, 1.0223186608803472, 1.6135265700483092, 1.0136462442637468, 1.0577923990965334, 1.090185676392573, 1.068, 1.016522623284189, 1.0941234785482183, 1.0596026490066226, 1.3209302325581396, 1.0, 1.028862478777589, 1.0404040404040404, 2.25, 1.04764140720942, 1.0167107350608144, 1.032166508987701, 1.2573099415204678, 1.0379669320269442, 1.0199363219110515, 1.018957345971564, 1.1497622820919176, 1.2121212121212122, 1.0717065036131184, 1.5555555555555556, 1.0730478589420656, 1.625, 1.0271021090773949, 1.0157938487115545, 1.2653061224489797, 1.1162790697674418, 1.2, 1.0134939759036146, 1.0693069306930694, 1.1129032258064515, 1.0147965474722564, 1.1428571428571428, 1.0420743639921721, 1.2, 1.0499710072895958, 1.1525679758308156, 1.2020117351215422, 1.047244094488189, 1.0625, 1.1395417156286722, 1.1024038233292717, 1.0031457810695656, 1.0192023633677991, 1.4146341463414633, 1.1875, 1.2727272727272727, 1.303370786516854, 1.2461538461538462, 1.007177033492823, 1.0112045999904355, 1.007690918488719, 1.0062893081761006, 1.0038958890669831, 1.0001125220355653, 5.0, 1.0159112387807079, 1.033166530897242, 1.6666666666666667, 1.2857142857142858, 1.0446115288220552, 1.0957689080666426, 1.0933480338110988, 1.0337662337662337, 1.0, 1.0451612903225806, 1.2935064935064935, 1.2556053811659194, 1.0184886705376852, 1.031037228201186, 1.0006798888867305, 1.1281534999407794, 1.4444444444444444, 1.0143201296030486, 1.0561582641991065, 1.0321459600347525, 1.0560747663551402, 1.0717592592592593, 1.0, 1.0323353293413173, 1.1149797570850202, 1.0244468000530011, 1.109452736318408, 1.0166112956810631, 1.0019495636417848, 1.2267818574514038, 1.1347517730496455, 1.0857142857142856, 1.0518175343687728, 1.1712882431187968, 1.0585896418753113, 1.3873239436619718, 1.3333333333333333, 1.0577540106951873, 1.1, 1.0199364345564865, 1.0687960687960687, 1.010382200518238, 1.0525362318840579, 1.5, 1.011111111111111, 1.0224691459264423, 1.1214103962195565, 1.402609956500725, 1.054985717995326, 1.0133972641376392, 1.0751066370926463, 1.1401515151515151, 1.169811320754717, 1.0225145624713659, 1.0165720344780407, 1.100497512437811, 1.2396449704142012, 3.5, 1.1264367816091954, 1.0347403220164957, 1.2243125904486252, 1.0200869044831264, 1.0014513597467674, 1.1178885630498534, 1.8, 1.029, 1.029410093741123, 1.012822966507177, 1.194267515923567, 1.018449066369945, 1.3228070175438595, 1.1338912133891212, 1.154895275207014, 1.0034698105252942, 1.008645498197339, 1.0875486381322956, 1.1462113127001068, 1.0263157894736843, 1.0633923472301543, 2.0493506493506493, 1.0823294189107107, 1.0695384615384615, 1.0761999010390895, 1.0760430686406461, 1.109271523178808, 1.0718038528896672, 2.5, 1.5, 1.9285714285714286, 1.0390455531453362, 1.145192936559843, 1.0351250501125606, 1.0354835136432448, 1.0681458003169573, 1.008791981712678, 1.0717488789237668, 1.2861356932153392, 1.039058700515514, 1.6666666666666667, 1.5833333333333333, 1.0240626748740906, 1.1111111111111112, 1.1361916771752838, 1.14, 1.0643568061064133, 1.0160746273701289, 1.0, 1.1627242006758514, 1.0576271186440678, 1.073464746019712, 1.0006766287831004, 1.1116279069767443, 1.0333821376281114, 1.030529615906919, 1.0581847496206374, 1.0931758530183726, 1.9545454545454546, 1.2497109826589596, 1.3333333333333333, 2.0, 1.0002531900079308, 1.25, 2.0, 1.4444444444444444, 1.104830421377184, 1.0080963255138053, 1.0707915273132664, 1.05, 1.0, 1.0048820179007323, 1.0164424514200299, 1.4054621848739495, 1.0240480961923848]
origin-bjaq_15.87 	max: 5.0000	99th: 2.5000	95th: 1.7509	median: 1.0657	mean: 1.1651

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 16.303872 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=38.897840