Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='naru', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 49, 'naru': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 5.0000	99th: 2.6667	95th: 1.5714	median: 1.0555	mean: 1.1485
ReportEsts: [1.141304347826087, 1.0267379679144386, 1.0308249821045097, 1.0269230769230768, 1.0, 1.0, 1.1996794279021021, 1.004520799703085, 1.25, 1.0428380187416333, 1.005973508787118, 1.0022922859594234, 1.0470536499560246, 1.0395348837209302, 1.02331331684917, 1.0, 1.5517241379310345, 1.0818278427205101, 3.0, 2.6666666666666665, 1.125, 1.1168859176191503, 1.0164290891519692, 1.065040650406504, 1.0715342871238283, 1.0, 1.0634815232909458, 1.2, 1.4, 1.2302158273381294, 1.0, 1.000219901974466, 1.0155965503666158, 1.3085460599334073, 1.0240637689878178, 1.0265723376887144, 1.016304347826087, 1.0028652599373529, 1.0710448377987465, 1.2380952380952381, 1.041388518024032, 1.0121951219512195, 1.0, 1.115596159224387, 1.1064322073114299, 1.2066115702479339, 1.1650485436893203, 1.2198275862068966, 1.0258345985084836, 1.0285714285714285, 1.07119799571198, 1.1616766467065869, 1.0048925569648206, 2.0, 1.3922077922077922, 1.0938473653576197, 1.0596363636363637, 1.0727969348659003, 1.1366459627329193, 1.25, 1.011950199927299, 1.0410958904109588, 1.059090909090909, 1.0574712643678161, 1.0909090909090908, 1.154788688518916, 1.0192548137034259, 1.1666666666666667, 1.0, 1.0825512160662025, 1.041766109785203, 1.055395268320831, 1.117117117117117, 1.0860653837236263, 1.1858823529411764, 1.0778443113772456, 1.0, 1.0444832097688617, 2.0, 1.0302304226807082, 1.53125, 1.058560349970173, 1.177914110429448, 1.0229357798165137, 1.0515995872033024, 1.08, 1.0060405675604056, 1.0669176963455231, 1.196078431372549, 2.3333333333333335, 1.1321897073662968, 1.013863808812371, 1.1546762589928057, 1.2987377279102383, 1.2882352941176471, 1.0635359116022098, 1.2272727272727273, 1.0371681415929204, 1.0, 1.0059240642671214, 1.1746580273578113, 1.0112749349522983, 1.02317940571181, 1.0588235294117647, 1.0058196352986648, 1.09985401459854, 1.045725074908673, 1.0690178232840348, 1.019375, 1.1666666666666667, 1.0, 1.1172017749934744, 1.0036055164915196, 1.0695945945945946, 1.0, 1.0065257795010956, 1.0, 1.2348130841121496, 1.1617224880382775, 1.0, 1.2087912087912087, 1.1666666666666667, 1.0350877192982457, 1.0084716685472945, 1.1098858429758485, 1.018181818181818, 1.8, 1.2624172185430464, 1.0, 1.25, 1.0010734988907177, 1.1818181818181819, 1.0258807814326265, 1.0005215402402856, 1.047244094488189, 1.1964856230031948, 1.0369318181818181, 1.0178500595001982, 1.00199203187251, 1.0499040307101728, 1.069884515289525, 1.123456790123457, 1.0241356816699283, 1.022586987903828, 2.0, 1.0101289134438305, 1.0186263096623982, 1.0713399503722085, 1.041997529557085, 1.0, 1.0035241220075344, 1.0503703703703704, 1.026, 1.4476190476190476, 1.1883211678832117, 1.0180195640981637, 1.0173491550564178, 1.0753449364234828, 1.1406844106463878, 1.0986842105263157, 1.0208333333333333, 1.1594202898550725, 1.127906976744186, 1.1428571428571428, 1.0035587508425072, 1.0095768934570604, 1.0189982728842832, 1.0387924640261088, 1.0219914477703116, 1.1005539211788715, 1.0063157894736843, 1.1071428571428572, 1.1314031180400892, 1.1264236902050113, 1.159, 1.0198216055500495, 1.0245113248526219, 1.0416885265749223, 1.009061478401625, 1.0, 1.0238095238095237, 1.0471405349490173, 1.0480568324279147, 1.1879393266740659, 1.1515151515151516, 1.0319373918550603, 1.0477245267821185, 1.0115377878973641, 1.1153846153846154, 1.0877272727272727, 1.0378303996330485, 1.0, 1.4545454545454546, 1.036298247814996, 1.3393870601589104, 1.1123076923076922, 1.2962962962962963, 1.017363344051447, 1.0047548736163885, 1.0155555757884769, 1.1798245614035088, 1.0124380731527354, 1.0056818181818181, 1.0625, 1.119047619047619, 1.0, 1.0526315789473684, 1.039189402302476, 1.6236933797909407, 1.1839080459770115, 1.0182896688087, 1.0957683741648108, 1.091254113072091, 1.011596937076906, 1.0081849135673127, 1.0864197530864197, 1.0297619047619047, 1.0507320394960844, 1.0410132689987937, 1.044399487652178, 1.0, 1.0625258799171842, 1.0693084907332637, 1.0066654076796147, 1.0551801801801801, 1.0651455852555027, 1.0052867535104044, 1.0344827586206897, 1.00109254803998, 1.2141515341264872, 1.1697687535250987, 1.0105263157894737, 1.054552997303464, 1.011605415860735, 1.1283464566929133, 1.0, 1.0085795996186844, 1.0088767306833408, 1.018624641833811, 1.3470149253731343, 1.0909090909090908, 2.6666666666666665, 1.0615536131970946, 1.1454545454545455, 1.1087636932707354, 1.5, 1.5, 1.25, 1.010928961748634, 1.6020408163265305, 1.1049723756906078, 1.1152941176470588, 1.0910683012259195, 1.0205655526992288, 1.0290010955084155, 1.0350877192982457, 1.0, 1.0020501303223546, 1.102579936873885, 1.0928196147110332, 1.0338887808251744, 1.0918626504800122, 1.0197691921726042, 1.0977742448330683, 1.025826100734116, 1.0681818181818181, 1.107945796119495, 1.0874732905982907, 1.5454545454545454, 1.0847347684028446, 1.1300639658848615, 1.25, 1.0869565217391304, 1.1090909090909091, 1.0555555555555556, 1.2061855670103092, 1.0572908956328646, 1.2395543175487465, 1.2239263803680982, 1.024562345292416, 1.0885844748858446, 1.0092536726346633, 1.0090624983419023, 1.5, 1.0608948708621317, 1.2, 1.0109377214113646, 1.0215982721382288, 1.0049064676164035, 1.275, 1.6666666666666667, 1.0434782608695652, 1.5211267605633803, 1.0116487785687063, 1.0, 1.0458715596330275, 1.0180995475113122, 1.0372596153846154, 1.0031141939073667, 1.18125, 1.0125786163522013, 1.0054976444944452, 1.086346404119278, 1.025718856392797, 1.1111111111111112, 1.0, 1.2458233890214798, 1.0369458128078817, 1.1869158878504673, 1.041867813569736, 1.0638864241348713, 1.0289855072463767, 1.2040816326530612, 1.0137174211248285, 1.0506912442396312, 1.4285714285714286, 1.0195372049047702, 1.064102564102564, 1.0, 1.0197139867457272, 1.2380952380952381, 1.5555555555555556, 1.0232152819523672, 2.0, 1.0167364016736402, 1.061046511627907, 1.0500410172272354, 1.0184899845916795, 1.1671018276762402, 1.10989010989011, 1.0078193698507827, 1.007294531940962, 1.0124137931034483, 1.007584457645183, 1.0796154423914677, 3.0, 1.2222222222222223, 1.0162921674505023, 1.0, 1.0492610837438423, 1.0, 1.0, 1.0454545454545454, 1.2357320099255582, 1.0863723608445297, 1.316326530612245, 1.0551948051948052, 1.0, 1.059254327563249, 1.0039390772541479, 1.5, 1.070875521143538, 1.0, 1.0116298489334243, 1.0853658536585367, 1.0917869325636316, 1.1658986175115207, 1.0018181818181817, 1.060523938572719, 1.0185185185185186, 1.0144481716030627, 1.0005911468568562, 1.003994673768309, 1.0, 1.1428571428571428, 1.8333333333333333, 1.5, 1.1428571428571428, 1.002423938482113, 1.25, 1.1131447587354408, 1.0594059405940595, 1.0469836048177428, 1.0349560107074036, 1.003099173553719, 1.0773036414301234, 1.0341931613677264, 1.2244897959183674, 1.5, 1.0208333333333333, 1.087962962962963, 1.0128710456544485, 1.380952380952381, 3.142857142857143, 1.0712694877505569, 1.0325581395348837, 1.004171118248813, 1.1476793248945147, 1.342769701606733, 1.0472779369627507, 1.4035087719298245, 1.0808477237048666, 1.0444915254237288, 1.2692307692307692, 1.055306427503737, 1.1388888888888888, 1.023263946964283, 1.0042728028711485, 1.0271074011861094, 1.0886075949367089, 1.0471698113207548, 1.0686567164179104, 1.0, 1.046260485207695, 1.012673985543255, 1.0003157348729168, 1.0133909755422021, 1.0824249378466246, 1.0128741551335694, 1.8333333333333333, 1.1934394597202123, 1.0, 1.0520922288642187, 1.1111111111111112, 1.028066197128032, 1.0144927536231885, 1.0193465176268273, 1.1422924901185771, 1.087260034904014, 3.0, 1.1256181998021761, 1.000154667782701, 1.018450875714152, 1.0, 1.2857142857142858, 1.0028790786948176, 1.3735632183908046, 1.100147758988672, 1.0190677966101696, 1.105263157894737, 1.0247568523430592, 1.071727393834576, 1.0513978574894554, 1.0086599135768788, 1.2359649122807017, 1.3548922056384742, 1.0303030303030303, 1.5, 1.0101522842639594, 1.3, 1.044338335607094, 1.0606060606060606, 1.0513048447520477, 1.0, 1.1120780102450163, 1.0555061764225726, 1.124133148404993, 1.0, 1.0555555555555556, 1.32, 1.0013247613481395, 1.2516411378555798, 1.0, 1.0788891959104725, 1.0243915331485223, 1.1886699507389162, 1.0, 1.5, 1.1755339805825242, 1.0072202166064983, 1.4663461538461537, 1.0, 1.0135068276271522, 1.0372184133202742, 1.0869565217391304, 1.0265536723163842, 1.0272727272727273, 1.0026246719160106, 1.1411290322580645, 1.0883466554480437, 1.0952298949543655, 1.0, 1.0675675675675675, 1.0649461839530332, 1.0259715156107443, 1.0480614888105653, 1.0, 1.0460434983803795, 1.0260896224349192, 1.0282870612886328, 2.0, 1.131578947368421, 1.0749964690927922, 1.1410958443914403, 1.1249399327246516, 1.0304549650061385, 1.1043956043956045, 1.046218487394958, 1.0282597917699554, 2.0, 1.076696470101814, 1.2333333333333334, 1.0, 1.2451612903225806, 1.1555555555555554, 1.0234772223170108, 1.1252390057361377, 1.0364413097081255, 1.1772015126958402, 1.0537495557398413, 1.03182135380321, 1.012251927366876, 1.087378640776699, 4.0, 1.034684911775297, 1.0120876869493955, 1.0053747217271987, 1.00846913035555, 1.0817782656421515, 1.1394160583941606, 1.0346534653465347, 1.4285714285714286, 1.019585453642795, 1.0133909921302517, 1.0346752430594064, 1.0940078937926085, 1.0229553467958676, 1.0103092783505154, 1.0046754381706073, 1.0037899296155928, 1.0680272108843538, 2.0, 1.0833333333333333, 1.0061728395061729, 1.0844529750479845, 1.0134228187919463, 1.0011890606420928, 1.1564625850340136, 1.2134146341463414, 1.0554699537750385, 1.0879120879120878, 1.0007462603446164, 1.4303797468354431, 1.066510107894175, 1.0, 1.0617848970251715, 1.4603174603174602, 1.1914893617021276, 1.009217877094972, 1.128395061728395, 1.0711462450592886, 1.1893644617380026, 1.0433843085106382, 1.0, 1.7446808510638299, 1.5, 1.0, 1.0602409638554218, 1.2127139364303179, 1.4273127753303965, 1.0729166666666667, 1.0281960909964756, 1.1478029294274301, 1.079288136754479, 1.0043876947347663, 1.0909090909090908, 1.0330499190475728, 1.088235294117647, 1.0896196002578982, 1.1291727140783745, 1.0710875331564986, 1.01878612716763, 1.0658424381828637, 1.0447373994070308, 1.018667485416027, 1.012062270586708, 2.0, 1.0824468085106382, 1.0425138632162663, 1.0555555555555556, 1.0, 1.1590909090909092, 1.25, 1.1122047244094488, 1.5925925925925926, 1.5, 1.0389424525459476, 1.0268171316865116, 1.0059559222949377, 1.0084487745471153, 1.0918918918918918, 1.040097205346294, 2.0, 1.1666666666666667, 1.189807976366322, 1.0117713456421833, 1.0078791010074917, 1.0190226677298098, 1.0224924012158054, 1.0694444444444444, 1.0604205745878172, 1.1793960923623446, 1.0004823277360881, 1.031137634368117, 1.393939393939394, 1.1007667031763417, 1.0, 1.0136054421768708, 1.021611855249214, 3.0, 1.0876656472986748, 1.0202178322603404, 1.1428571428571428, 1.1507689756663766, 1.0, 1.1875, 1.0010989400545924, 1.7692307692307692, 1.0012508611000326, 1.0136693720632208, 1.1875, 1.16, 1.350974930362117, 1.0165289256198347, 1.1422087745839637, 1.0310597589762704, 1.013546583933992, 1.0, 1.1628829024549208, 1.0152439024390243, 2.0, 1.0768272712595428, 1.0111533919433144, 1.0823084200567645, 1.0103840289260186, 1.0257395892217827, 1.2417582417582418, 2.0, 1.0509699505515404, 1.0411418975650715, 1.0353452225408515, 1.1064042695130087, 1.0458823461607178, 1.076889609025715, 1.0842490842490842, 1.0143396226415093, 1.1325757575757576, 1.0024812515299197, 1.0630914826498423, 1.0165745856353592, 1.0, 1.0485716038885333, 4.0, 1.0121119966442953, 1.0192500582567552, 1.0522690840749545, 1.1875, 1.0233995278433552, 1.0544747081712063, 1.0, 1.018692248007336, 1.0134426229508198, 1.0700934579439252, 1.0588235294117647, 1.6666666666666667, 1.0119832939191524, 1.5, 1.470790378006873, 1.1538461538461537, 1.0858977042774405, 1.2857142857142858, 1.1909547738693467, 1.1236897274633124, 1.0, 1.3333333333333333, 1.016622340425532, 2.0, 1.0, 1.0390625, 1.0943396226415094, 1.1530915576694412, 1.0203426124197001, 1.0666666666666667, 1.0210843373493976, 1.089150378938971, 1.0467532467532468, 1.6896551724137931, 1.1224489795918366, 1.3846153846153846, 1.0, 1.047418335089568, 1.3145743145743145, 1.1, 1.1533038594814196, 1.004365359587742, 1.2100890801721549, 1.0115095010820265, 1.0296263212743784, 1.1070998796630565, 1.0137231503579953, 1.5714285714285714, 1.0, 1.0303030303030303, 1.0204524158012531, 1.162051282051282, 1.0065359477124183, 1.2303030303030302, 1.047651775486827, 1.046317940678322, 1.00741989674796, 1.064102564102564, 1.1578947368421053, 1.0688378978534419, 1.0843716861081654, 1.0273692489186002, 1.0040608867596512, 1.1842105263157894, 1.0970909627879504, 1.014535453968498, 1.1553254437869822, 1.0218522372528616, 1.3333333333333333, 1.041862652869238, 1.2466216216216217, 1.0384615384615385, 1.248299319727891, 1.0347890451517394, 1.0, 1.106060606060606, 1.0508837525492862, 1.2407407407407407, 1.000613340555352, 1.1440677966101696, 1.0930232558139534, 1.0202934370418832, 1.0134462869502523, 1.1187550362610799, 1.0174757281553397, 1.0510783200908058, 1.0162026600541028, 1.1940298507462686, 1.0, 1.0, 1.1111111111111112, 1.0237132130313673, 1.8333333333333333, 1.0213557453844033, 1.0632168434656184, 1.2126716880815243, 1.0555555555555556, 1.0001564937805578, 1.0794212218649517, 1.0772200772200773, 1.018361581920904, 1.0016859605043793, 1.0660271303305104, 1.0050523691968458, 1.0387811634349031, 1.25, 1.0491803278688525, 1.316205533596838, 1.0020451315470207, 1.0618892508143323, 1.0265654648956357, 1.1787610619469027, 1.037037037037037, 1.042072650873881, 1.0347222222222223, 1.001901913875598, 1.3125, 1.0264396488833456, 1.0184244069592279, 1.1078602620087337, 1.0008428150021071, 1.15625, 1.0064655172413792, 1.064676616915423, 1.5625, 1.021155635185887, 1.4230769230769231, 1.03125, 1.0461538461538462, 1.1011463250168578, 1.007745411685469, 1.0776470588235294, 1.8181818181818181, 1.037037037037037, 1.0069304018530092, 1.0118506583699094, 1.0000560363613722, 1.0748114365900718, 1.031960772729958, 1.0769230769230769, 1.043657331136738, 1.0217564870259481, 1.0650475467654805, 1.025693730729702, 1.1944444444444444, 1.05318138651472, 1.0228614685844057, 1.1973913043478261, 1.050167653040658, 1.0, 1.3333333333333333, 1.002061150776152, 1.0019698888419868, 1.0140998675703046, 1.1398783115730764, 1.0566640063846768, 1.0440835266821347, 1.0014807356294606, 1.1455425017277125, 1.024482109227872, 1.2648648648648648, 1.0021052631578948, 1.0240514406322092, 1.0238095238095237, 2.3333333333333335, 1.0179550597274114, 1.0067288787971092, 1.006310958118187, 1.2753623188405796, 1.0039985459832788, 1.0140313766966331, 1.0096508657394265, 1.035, 1.2307692307692308, 1.0977088948787062, 1.0147368421052632, 1.084375, 1.6538461538461537, 1.050877192982456, 1.0297324083250743, 1.0845323741007193, 1.2058823529411764, 1.0471394656769317, 1.0274324057627788, 1.0130874076083272, 1.0337837837837838, 1.6666666666666667, 1.2142857142857142, 1.3333333333333333, 1.0455207574654042, 1.6153846153846154, 1.3333333333333333, 1.5, 1.3315696649029982, 1.0434782608695652, 1.0334851611984912, 1.0007007150478557, 1.1434511434511434, 1.4705882352941178, 1.0, 1.1290322580645162, 1.3243243243243243, 1.4893617021276595, 1.0186915887850467, 1.007584609254169, 1.0042328988650167, 1.046875, 1.0019597497550312, 1.0009959461488414, 5.0, 1.0079531148991188, 1.0871428571428572, 1.0, 1.3333333333333333, 1.1023668639053255, 1.178440794663989, 1.060130765657937, 1.00625, 1.0, 1.0038910505836576, 1.0582822085889572, 2.0, 1.5, 1.0064388311045072, 1.099630450849963, 1.185981031416716, 1.25, 1.0154790023821603, 1.0712625871417505, 1.0427807486631016, 1.1428571428571428, 1.126984126984127, 1.0025646886407487, 1.75, 1.1142701590950335, 1.0086267605633803, 1.0023529411764707, 1.0, 1.0018044077134987, 1.17933390264731, 1.140495867768595, 1.1896551724137931, 1.057244692659914, 1.0165361183637946, 1.062819276841417, 1.4910714285714286, 1.275, 1.1492537313432836, 1.0321750321750323, 1.0263237518910742, 1.012501263264275, 1.0098215253161618, 1.0010917030567685, 3.0, 1.25, 1.071144891810463, 1.0910290237467017, 1.4032289437852559, 1.0292813561891287, 1.0040140491721024, 1.1013400335008374, 1.1514360313315928, 1.0416666666666667, 1.033555411114722, 1.0260567091809845, 1.0872127283441366, 1.1138353765323994, 2.5, 1.0266666666666666, 1.0511023882020618, 1.1194743130227, 1.0169262984231733, 1.0027800748178775, 1.1221590909090908, 2.0, 1.016355140186916, 1.0231647597770406, 1.0253598355037696, 1.11787072243346, 1.0144292661993992, 1.2170542635658914, 1.385321100917431, 1.0747826086956522, 1.0025577029426318, 1.0455945779420825, 1.1059907834101383, 1.1344430217669654, 1.0, 1.1196172248803828, 1.0184577427088426, 1.0303830911492735, 1.0332499800180408, 1.0152542372881357, 1.0542264752791068, 1.2857142857142858, 1.0912951167728238, 2.5, 1.5, 1.4166666666666667, 1.0255754475703325, 1.1721958925750395, 1.0611608303316127, 1.0331221223609675, 1.1956580732700135, 1.0192468619246862, 1.076086956521739, 1.3877551020408163, 1.0114873206658246, 1.6, 1.25, 1.1489430894308943, 1.0, 1.0931586608442503, 1.1352295409181636, 1.0102748986029744, 1.0155085942445343, 1.25, 1.0670630987776677, 1.2887596899224807, 1.2608478802992518, 1.0000321109755315, 1.1202263083451203, 1.0511159107271417, 1.0227847597044355, 1.0246995258573162, 1.068362480127186, 1.775, 1.2681564245810055, 1.0, 1.0, 1.0006884589249312, 1.6666666666666667, 1.5714285714285714, 1.3170731707317074, 1.0735826296743063, 1.0681818181818181, 1.0134831460674156, 1.0832979175520612, 1.0, 1.1545623836126628, 1.026378896882494, 1.15695067264574, 1.0426065162907268, 1.25, 1.0578028293545534, 1.069353882631891, 1.0864978902953586, 1.0918557084418, 1.0060092284579891, 1.085294689749076, 1.072992700729927, 1.0, 1.0168380082074713, 1.000283555364185, 1.014392037302726, 1.2695652173913043, 1.0123078419926055]
origin-bjaq_15.87 	max: 5.0000	99th: 2.6667	95th: 1.5714	median: 1.0555	mean: 1.1485

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 16.121083 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=naru', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[2.3841858e-07 1.0728836e-06 4.1723251e-07 1.2516975e-06 0.0000000e+00]
Distance score: 5.960464477539062e-07
SAUCE Drift detection: False
Detection latency: 0.0231s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 2.037735 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 6.0000	99th: 3.0000	95th: 1.6667	median: 1.0674	mean: 1.1684
ReportEsts: [1.165137614678899, 1.0323602625028288, 1.017501686392347, 1.0047095761381475, 1.088235294117647, 2.0, 1.2055421315099482, 1.0067945793438784, 1.0, 1.0342541436464088, 1.0831727990753226, 1.0023797228832563, 1.0067256637168143, 1.053231939163498, 1.0374378473237789, 2.643478260869565, 1.1067961165048543, 1.3333333333333333, 1.4444444444444444, 1.1399808245445828, 1.0417391304347825, 1.0466597993208957, 1.0253671562082778, 1.1030640668523677, 1.0090980666608347, 1.0040690873096219, 3.0, 1.0709934069602471, 1.5, 1.3333333333333333, 1.1094493541808295, 1.0, 1.0100959947037405, 1.0066477025191563, 1.1704857928505958, 1.0078817733990149, 1.022895167202391, 1.0781990521327014, 1.0951760104302477, 1.1122457937088515, 1.0150593957534375, 1.0012200401432563, 1.0357142857142858, 1.0111082070047046, 1.0604395604395604, 1.1046858024042336, 1.2608695652173914, 1.0173410404624277, 1.0896860986547086, 1.1655277145026575, 2.4, 1.0318021201413428, 1.0672645739910314, 1.15625, 1.0524608927890118, 1.0289251133717368, 1.0462588825414518, 1.1666666666666667, 1.1686746987951808, 1.0050246434335064, 1.0147058823529411, 1.011250278048697, 1.0711237553342816, 1.10727969348659, 1.1121495327102804, 2.2, 1.1296146513374545, 1.0321158690176322, 1.1428571428571428, 1.0, 1.1231934528991816, 1.0161127895266868, 1.0467920887602509, 1.104089219330855, 1.0759600290975917, 1.059751972942503, 1.0788175130091513, 1.205607476635514, 1.1702127659574468, 1.0231749385335938, 1.1284703320631464, 1.1914893617021276, 2.0, 1.2222222222222223, 1.0103448275862068, 1.0, 1.1409691629955947, 1.1282051282051282, 1.5454545454545454, 1.057686431546614, 1.088475350963108, 1.0602127360479827, 1.0959984285553934, 1.2388856645385955, 1.024390243902439, 1.2974238875878221, 1.0789473684210527, 1.2432432432432432, 1.0833333333333333, 1.1822117276662731, 1.3793103448275863, 3.0, 1.0199663888961452, 1.0373990650233744, 1.0182882223847842, 1.0096321982158205, 1.1794871794871795, 1.016353001288015, 1.0937120660354456, 1.0665473538113153, 1.021379980563654, 1.0272108843537415, 1.3333333333333333, 1.5, 1.1541042272422277, 1.0002638926722964, 1.0761305094447624, 1.0459770114942528, 1.0052929682669238, 1.0, 1.3084560082163643, 1.115873015873016, 1.0, 1.1972477064220184, 1.0, 1.0857740585774058, 1.0099197046499353, 1.0963332469551696, 1.0930232558139534, 2.2, 1.2834372834372834, 1.0, 1.1, 1.0040763387066889, 1.1538461538461537, 1.2070484581497798, 1.0205162890316763, 1.0838980657913313, 1.6666666666666667, 1.6666666666666667, 1.040241448692153, 1.036705461056401, 1.0660934981192907, 1.0503495649933206, 1.2210526315789474, 1.0427257977285018, 1.0266266185006292, 3.0, 1.003073376872839, 1.0297324083250743, 1.0938647089669638, 1.0515721422274464, 2.0, 1.0022267206477733, 1.0135970333745365, 1.0271646859083192, 1.1538461538461537, 1.0, 1.1241895261845387, 1.0888185140073081, 1.0032021096251649, 1.1586538461538463, 1.207282913165266, 1.0727272727272728, 1.2160493827160495, 1.1645390070921986, 1.4285714285714286, 1.0017566350347777, 1.4615384615384615, 1.0836320191158901, 1.002421911172846, 1.0363466915191053, 1.0806669671022984, 1.0302491103202847, 1.0975177304964538, 1.239162201656113, 1.008420208500401, 1.1651602300739523, 1.0830419580419581, 1.0755424591481382, 1.3157894736842106, 1.0033180193976519, 1.0993788819875776, 3.0, 1.0118220107234845, 1.0284100418410043, 1.0288808664259927, 1.0446927374301676, 1.1370967741935485, 1.0, 1.0984848484848484, 1.0026368020177268, 1.2222222222222223, 1.041017653167186, 1.0741060571348007, 1.012287557083, 1.052334208423696, 1.0060240963855422, 1.0381677686964084, 1.0899379738111648, 1.0654735923177652, 1.0162325534010255, 1.0823376623376624, 1.0025662831603122, 1.177023498694517, 1.0067913212206738, 1.1774193548387097, 1.0389610389610389, 1.0396039603960396, 1.0, 1.054054054054054, 1.0118488118090951, 1.6271676300578035, 1.2121212121212122, 1.0073349633251834, 1.0476190476190477, 1.001040658026678, 1.0313199105145414, 1.0521881976327871, 1.6666666666666667, 1.0209876543209877, 1.0361952861952861, 1.0321364903506778, 1.0441273260336266, 3.0, 1.1226415094339623, 1.0166694119584911, 1.0053689800876093, 1.0406504065040652, 1.265, 1.0554335894621296, 1.0804018445322794, 1.0689655172413792, 1.0027777519069394, 1.0165264549154533, 1.1388888888888888, 1.194275802254987, 1.0151162790697674, 1.0416666666666667, 1.0960156760287394, 2.0, 1.0673056886851426, 1.0050768514205868, 1.1209311501282304, 1.3919753086419753, 1.3846153846153846, 2.0, 1.1096449382788534, 1.0410958904109588, 1.1307359569254969, 2.0, 1.0807261490923137, 1.0029382957884427, 1.6666666666666667, 1.0220967016669165, 1.1412037037037037, 1.116600790513834, 1.3043478260869565, 1.026222537207654, 1.0046413502109706, 1.1343283582089552, 2.0, 1.0302079851916601, 1.0841793087715297, 1.1119293078055965, 1.0755154735621, 1.0373784355179705, 1.0334473208229709, 1.1102204408817635, 1.0348726371515302, 1.0520117762512267, 1.1143115474037717, 1.1778694491628245, 1.4705882352941178, 1.0786512354331024, 1.1573236889692586, 1.2452830188679245, 1.037037037037037, 1.0116279069767442, 1.026027397260274, 1.0335526374202026, 1.011559883700564, 1.0233644859813085, 1.17, 1.0145104327552115, 1.0425230333097095, 1.024755231016078, 1.0008933309747037, 1.2142857142857142, 1.44, 1.023311416616856, 1.0007791195948579, 1.0171263938537054, 1.0238271108348265, 1.1320459290187892, 1.0104567969179967, 1.0224775224775224, 1.049294268605646, 1.042504793773734, 1.0377836153039974, 1.100196463654224, 1.24, 1.0666666666666667, 1.0762397027943789, 1.0, 1.0235507246376812, 1.0018898325914194, 1.099205540843349, 1.2, 1.2857142857142858, 1.2043530834340992, 1.1330092029866297, 1.0094649362382002, 1.1818181818181819, 1.171242185376461, 1.0078476298639127, 1.147887323943662, 1.2, 2.5, 1.0358108108108108, 1.3, 1.0214333840009635, 1.0389805097451275, 1.0416666666666667, 1.0429879609893185, 1.0344827586206897, 1.7, 1.0327790179382959, 2.0, 1.3333333333333333, 1.0855745721271393, 1.1465144682450206, 1.0585009140767825, 1.0728476821192052, 1.0608695652173914, 1.0167504565232095, 1.0340109897792258, 1.875, 1.0029399900177083, 1.1476149406223048, 1.5, 1.3333333333333333, 1.0163104503039455, 1.0, 1.0515275877792978, 1.1111111111111112, 4.0, 1.08, 1.1477927063339732, 1.090255591054313, 1.2222222222222223, 1.033726812816189, 1.2151898734177216, 3.0, 1.0336392690322052, 1.03125, 1.15, 1.027134896330137, 1.182456140350877, 1.0612569610182976, 1.0495790458372312, 2.25, 1.0, 1.139747191011236, 1.15625, 1.1157205240174672, 1.011481535603198, 1.1112356751370205, 1.0454545454545454, 1.5, 1.0081526844849453, 1.6875, 1.25, 1.3333333333333333, 1.1201000834028356, 1.1111111111111112, 1.0419426048565121, 1.1578947368421053, 1.0265384047423158, 1.0241390081431923, 1.0501672240802675, 1.0497954731388055, 1.0311975377728035, 1.2744565217391304, 1.0066577896138482, 1.024681286993474, 1.0581222056631894, 1.1428571428571428, 1.0133826116891065, 1.0075386929124865, 1.2201672335600906, 1.0141509433962264, 1.0, 1.0888030888030888, 3.0, 2.037037037037037, 1.0551181102362204, 1.009416195856874, 1.8942307692307692, 1.089655172413793, 1.0577401692384272, 1.2174805088223226, 1.0524012432324044, 1.1034220532319392, 1.1003245378862707, 1.0957446808510638, 1.1517857142857142, 1.0526315789473684, 1.0, 1.0052002675456304, 1.4385964912280702, 1.0074700253413518, 1.0062211210071654, 1.0559731328962099, 1.0213282937365011, 1.5714285714285714, 1.2558326629123089, 1.0, 1.0921560222888984, 1.4545454545454546, 1.017653185997011, 1.0047732696897376, 1.030153459571031, 1.1733333333333333, 1.0734341252699784, 5.0, 1.1638003946997462, 1.0138697392632534, 1.0280709159983115, 1.5, 1.0746268656716418, 1.0039588281868568, 1.3198090692124105, 1.1011727698567375, 1.056443472409152, 1.1666666666666667, 1.065312046444122, 1.0864863811713361, 1.103314779688423, 1.046430789813178, 1.069814852346833, 1.017363344051447, 1.6666666666666667, 1.2227564102564104, 1.036189054107302, 1.4015151515151516, 1.0669205658324266, 1.0, 1.0, 1.1923834537097833, 1.0738007380073802, 1.2183830929218382, 1.0160599883517762, 1.1129976580796253, 1.0, 1.088, 1.4137931034482758, 1.0496048874427253, 1.0, 1.0, 1.04955670872987, 1.0, 1.0, 1.1114018691588785, 1.5, 1.192395190120247, 1.025487256371814, 1.3740458015267176, 1.1, 1.02373430761201, 1.054954204829309, 1.1851851851851851, 1.065203761755486, 1.0384615384615385, 1.0263157894736843, 1.154515050167224, 1.0501754385964912, 1.1299161676646707, 1.0, 1.1176470588235294, 1.2118644067796611, 1.0141310883944679, 1.1132218844984803, 1.1428571428571428, 1.0236518448438978, 1.0038512462984635, 1.0383767093074547, 2.0, 1.118390422347855, 1.053709067700918, 1.075858250276855, 1.1311320067060282, 1.0307252350125813, 1.0408498847657768, 1.040085898353615, 1.0425871706148522, 1.75, 1.008793861539788, 1.0939226519337018, 1.0366143604374702, 1.0146149522203485, 1.0573770491803278, 1.0309754473395913, 1.4273504273504274, 1.0429928570859777, 1.1268947596362062, 1.0254458543702367, 1.0472136222910218, 1.0077109162382825, 1.213307387171619, 1.0843373493975903, 1.1294117647058823, 1.0003297462855982, 1.0938864628820961, 1.005206119847004, 1.010669076064567, 1.0, 1.2444192205826712, 1.1239193083573487, 1.1612903225806452, 1.0869565217391304, 1.0078036409842615, 1.043189368770764, 1.086884154460719, 1.0, 1.0972222222222223, 1.0293352259285544, 1.0038660013284058, 1.041923076923077, 1.0099996168729168, 1.0429200293470287, 1.0865603644646924, 1.0854189336235038, 1.0769911224844406, 1.3609022556390977, 1.0529779200397782, 1.0042689434364995, 1.1428571428571428, 1.0210285380647286, 1.0788643533123028, 1.0697517891237758, 1.5, 1.1430499325236168, 1.3436426116838487, 1.188637675077375, 1.0163934426229508, 1.145397489539749, 1.1475409836065573, 1.0942528735632184, 1.0763487689983113, 1.0, 1.65, 1.125, 1.25, 1.0384615384615385, 1.0042194092827004, 1.3361344537815125, 1.08, 1.0210679740294157, 1.00390625, 1.0270690639269406, 1.0095046908927034, 1.0100404129930087, 1.0063027119383452, 1.04055367417835, 1.077664702731655, 1.0063854489164086, 1.0019091597907084, 1.0674102812803103, 1.0375275938189845, 1.1160493827160494, 1.2681159420289856, 1.0239390642002175, 1.2820838627700126, 1.01315265045835, 1.0446428571428572, 1.1090617481956697, 1.044425817267393, 2.5, 1.014354066985646, 1.0666666666666667, 2.0, 1.2719033232628398, 1.0160476948248425, 1.0165703275529865, 1.0431472081218274, 1.03954802259887, 1.018120307156852, 1.157885883461176, 1.0017985611510791, 1.2, 3.0, 1.000695149991979, 1.4741784037558685, 1.0085365853658537, 1.0073581770709708, 1.0, 1.216279069767442, 1.1094890510948905, 1.0238170797499286, 1.2250755287009063, 1.0055132973255836, 1.0928037536144908, 1.0143105633541394, 1.170731707317073, 1.6666666666666667, 1.0743611124736352, 1.0, 1.1379746835443039, 1.1147540983606556, 1.0977099236641221, 1.0989874194538203, 1.4, 1.1539646793884082, 1.1133333333333333, 1.1497695852534562, 1.0007218131947453, 1.0782552918537525, 1.0855188141391106, 1.0677239178136844, 1.0053859964093357, 1.003567953292248, 1.2, 1.0684847493662606, 1.1191812360601483, 1.1818181818181819, 1.0393646408839778, 1.0499194847020934, 1.9, 1.0805327887369762, 1.1, 1.1970649895178198, 1.045809367296631, 1.1356321839080459, 1.255639097744361, 1.0220038890594616, 1.4130434782608696, 2.0, 1.0487959442332067, 1.0689410092395166, 1.060174356793536, 1.0237241379310345, 1.03127086204992, 1.017642449832412, 1.0575757575757576, 1.001545595054096, 1.1301587301587301, 1.0014301966520396, 1.0628245067497404, 1.0842738901429647, 1.0955302366345312, 1.029658295078885, 1.5, 1.1046742465258979, 1.0434782608695652, 1.3333333333333333, 1.0652709359605912, 1.006934306569343, 1.0352722772277227, 1.0888888888888888, 1.6666666666666667, 1.0297107114933541, 1.088336783988958, 1.625, 1.004390953395234, 2.6666666666666665, 1.0651339485238058, 1.5, 1.388739946380697, 1.1176470588235294, 1.0526911359350066, 1.3636363636363635, 1.1728395061728396, 1.055793991416309, 2.0, 1.0837887067395264, 1.0630422209369579, 2.25, 1.5, 1.0389610389610389, 1.0304878048780488, 1.1096869608084792, 1.0307692307692307, 1.0596205962059622, 1.0045841519318925, 1.1079545454545454, 1.098547062539482, 1.6467391304347827, 1.45, 1.15625, 1.0, 1.2217700915564598, 1.2313253012048193, 1.0114035087719297, 1.2008124153733986, 1.0043415410761551, 1.2184535303500965, 1.0025993476875088, 1.0226840819281469, 1.038038038038038, 1.0164752870693958, 1.3333333333333333, 1.0, 1.1538461538461537, 1.0068868258625923, 1.1199338296112489, 1.002710027100271, 1.0598669623059866, 1.0819755926138905, 1.1021609071141631, 1.0003990564982665, 1.1123595505617978, 1.0869565217391304, 1.1419518377693283, 1.1433918643694612, 1.0187367627759514, 1.059321660610065, 1.1720430107526882, 1.0944081783470871, 1.0186268472906403, 1.0143166780743782, 1.0058910162002945, 1.0003837779413838, 1.0257234726688103, 1.0147783251231528, 1.0737833594976451, 1.0012760976640078, 1.0, 1.0129366106080206, 1.0, 1.0949367088607596, 1.0622012308573063, 1.2686567164179106, 1.0088547736741282, 1.1908931698774081, 1.06, 1.027397398712494, 1.011426331815852, 1.0844582320225817, 1.008, 1.0365168539325842, 1.0025544879306305, 1.1336805555555556, 1.1333333333333333, 1.0, 1.2, 1.0139320760812502, 1.4444444444444444, 1.0379249767489924, 1.0707644628099173, 1.0971993410214167, 1.087848784878488, 1.001736294543175, 1.1082340292088522, 1.065625, 1.0339578454332552, 1.0249093883813594, 1.0232730477277734, 1.00610376804883, 1.0160404587366862, 1.3333333333333333, 1.083617747440273, 1.2418300653594772, 1.0209804644305198, 1.0856353591160222, 1.0316133720930232, 1.1392592592592592, 1.03, 1.0799390139715837, 1.001122334455668, 1.0313326084571108, 1.1904761904761905, 1.0004608543455134, 1.0045091009376723, 1.2011881188118811, 1.0, 1.1025641025641026, 1.1921708185053381, 1.0251696659669431, 1.0456205260194644, 1.0842105263157895, 1.0044403662502646, 1.048780487804878, 1.1794850429130905, 1.1826683291770574, 1.1392081736909323, 1.0193548387096774, 1.1274165202108963, 1.1497227356746764, 1.117403314917127, 1.0385006890503634, 1.0334928229665072, 1.173848439821694, 1.0178373356996284, 1.1333333333333333, 1.0203527815468114, 1.0988007875425094, 1.0315546434068754, 1.0250556792873051, 1.1126388154415654, 1.2357723577235773, 1.2299703264094954, 1.0263819095477387, 1.026616083312977, 1.0555555555555556, 1.0376692171865805, 1.0130925359386822, 1.036502371623015, 1.6196513470681457, 1.020164271867943, 1.0612462479702134, 1.073974445191661, 1.079591836734694, 1.0042083114150446, 1.1332233567507608, 1.0287539936102237, 1.2851063829787235, 1.0405814657783161, 1.0107609452430684, 1.0510204081632653, 2.0, 1.0233353308188515, 1.0065136009086588, 1.0495247623811905, 1.2275449101796407, 1.0238742822605016, 1.0229200879808862, 1.007919366450684, 1.0830324909747293, 1.2727272727272727, 1.0887772194304857, 1.1666666666666667, 1.0925449871465296, 1.5625, 1.0738303821062443, 1.0491109229466553, 1.2139175257731958, 1.0975609756097562, 1.0948660714285714, 1.0018867924528303, 1.0392156862745099, 1.1891891891891893, 1.0048959608323134, 1.1023255813953488, 1.0164551010813352, 1.4, 1.0343207756060715, 1.0256410256410255, 1.2565933265335858, 1.1545454545454545, 1.1240875912408759, 1.0782381918284556, 1.023724983860555, 1.0517496372362987, 1.2351851851851852, 1.524390243902439, 1.0555555555555556, 1.1176470588235294, 1.2444444444444445, 1.296875, 1.0413793103448277, 1.009180975869321, 1.0085499412016083, 1.0125, 1.0095249488717606, 1.0013099325426458, 6.0, 1.006863124857225, 1.3104906937394247, 1.6666666666666667, 1.7142857142857142, 1.0504222553402882, 1.142109064644276, 1.0483488577408764, 1.0585241730279897, 1.5, 1.1258992805755397, 1.0359897172236503, 1.0, 1.0036926690087538, 1.0535861841018013, 1.0150605040222802, 1.1019872087711284, 1.0909090909090908, 1.001109136859763, 1.0571612074502248, 1.0483870967741935, 1.1455737704918032, 1.0843091334894615, 1.0, 1.0704387990762125, 1.0367381410406793, 1.0189735819223928, 1.1204188481675392, 1.0430463576158941, 1.001136728976255, 1.2465353756382203, 1.1114982578397212, 1.0277777777777777, 1.062828213862882, 1.0041986687147977, 1.0293161113882883, 1.4558823529411764, 1.16, 1.1623376623376624, 1.2, 1.0233849751534638, 1.0414634146341464, 1.002851856798698, 1.0426884650317894, 2.0, 1.12625250501002, 1.0729283677525274, 1.1598975484815222, 1.3915300989777706, 1.0656273239137364, 1.0055959709009512, 1.096769716526144, 1.123404255319149, 1.0327868852459017, 1.0069814924586709, 1.025675107837168, 1.0491071428571428, 1.0894428152492668, 3.0, 1.0555555555555556, 1.0401375466888005, 1.2011412268188302, 1.0433082625105217, 1.0043481698157957, 1.1310592459605027, 1.6666666666666667, 1.0251937984496124, 1.0298617546381224, 1.0341603053435116, 1.1290322580645162, 1.0175656538050635, 1.102102102102102, 1.3337408312958434, 1.1059053196681308, 1.0027276478512568, 1.0202002991234547, 1.0861742424242424, 1.0876451953537487, 1.0263157894736843, 1.0521948797957592, 1.0545465811142016, 1.0724223150552608, 1.049131723845828, 1.0414457831325301, 1.0232708468002585, 1.221105527638191, 1.0567375886524824, 3.0, 1.0, 1.2, 1.0189473684210526, 1.1408912188728701, 1.0584972889233153, 1.045040985285519, 1.1952808988764045, 1.0613485630066324, 1.0762331838565022, 1.091373801916933, 1.0540753703201637, 1.5, 1.3571428571428572, 1.1145662847790507, 1.1111111111111112, 1.180263157894737, 1.10829307568438, 1.0130312902492613, 1.027568769816321, 1.5, 1.0599065677383896, 1.121212121212121, 1.0908606650939807, 1.0005467907588539, 1.0348204570184985, 1.0347078018392168, 1.0161375226188518, 1.0249312557286894, 1.0903054448871181, 1.328125, 1.2564102564102564, 1.3333333333333333, 2.0, 1.001304485566799, 2.0, 1.625, 1.4545454545454546, 1.036, 1.0015105346771884, 1.0677777777777777, 1.0, 1.2857142857142858, 1.4115226337448559, 1.0312185297079557, 1.17921146953405, 1.032520325203252]
origin-bjaq_15.87 	max: 6.0000	99th: 3.0000	95th: 1.6667	median: 1.0674	mean: 1.1684

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 18.172999 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=36.364211