Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='naru', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 89, 'naru': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.5714	median: 1.0572	mean: 1.1479
ReportEsts: [1.2115384615384615, 1.0372771474878444, 1.0376336015371683, 1.0097087378640777, 1.0344827586206897, 1.0, 1.1856455248888076, 1.0179850875356196, 1.25, 1.0317880794701986, 1.0086861166421377, 1.0028876546261007, 1.0289541918755403, 1.058139534883721, 1.03108442246556, 1.0, 1.2857142857142858, 1.073326248671626, 3.0, 2.6666666666666665, 1.5, 1.0731938753504422, 1.0132466281310213, 1.0730938878386893, 1.0069067587567835, 1.0, 1.0632344154550886, 1.2, 1.4, 1.20863309352518, 1.0, 1.0015601151694775, 1.011555164608041, 1.3817980022197558, 1.0285498489425982, 1.0247782817683297, 1.0535211267605633, 1.0020097128008487, 1.0894345340588194, 1.0357142857142858, 1.0012836970474968, 1.100609756097561, 1.0, 1.099268195596926, 1.0268394261915779, 1.2479338842975207, 1.174757281553398, 1.3671497584541064, 1.0258003703641914, 1.0384615384615385, 1.0565271855652718, 1.0017211703958693, 1.0072035495550953, 2.0, 1.2935064935064935, 1.0649333333333333, 1.0, 1.064638783269962, 1.2608695652173914, 1.25, 1.0277628598781143, 1.0386052303860522, 1.0545454545454545, 1.160919540229885, 1.0909090909090908, 1.0058841853864526, 1.0559585492227979, 1.1666666666666667, 1.0, 1.0856188644874, 1.001194743130227, 1.0572254335260116, 1.114864864864865, 1.0950533009164016, 1.1905882352941177, 1.1538461538461537, 1.0, 1.0504385964912282, 2.0, 1.0241757295761715, 1.59375, 1.0507483962936564, 1.2331288343558282, 1.026376146788991, 1.068694284216046, 1.04, 1.0048481125484812, 1.0710575394590265, 1.1715686274509804, 2.3333333333333335, 1.1891891891891893, 1.0009302161280638, 1.0422077922077921, 1.3183730715287518, 1.254295532646048, 1.0845070422535212, 1.238532110091743, 1.0103448275862068, 1.0, 1.000625, 1.131893448524118, 1.0077787381158168, 1.0094393388900762, 1.0588235294117647, 1.0145522305983352, 1.0572551220881279, 1.0096141892171895, 1.0383010997345468, 1.0190565448297406, 1.1666666666666667, 1.0, 1.1395101171459, 1.0110536482660644, 1.0518272425249169, 1.025974025974026, 1.0061576281552649, 1.0, 1.1460065052403325, 1.199043062200957, 1.0, 1.2087912087912087, 1.1666666666666667, 1.0300751879699248, 1.0237666559370655, 1.058010406150501, 1.108910891089109, 1.8, 1.2417218543046358, 1.0, 1.3214285714285714, 1.0028831113064993, 1.1818181818181819, 1.0323893229166667, 1.0034598369024061, 1.0751094644661503, 1.1776729559748427, 1.0110803324099722, 1.0439381611065908, 1.00199203187251, 1.0539499036608864, 1.0644193233571893, 1.1975308641975309, 1.0574037834311807, 1.0191795158876003, 2.0, 1.0204651162790697, 1.0257913247362251, 1.0471464019851116, 1.0398800070584084, 1.0, 1.0338007010515773, 1.0118518518518518, 1.022, 1.4476190476190476, 1.0995184590690208, 1.156786271450858, 1.0698214791725702, 1.0101451889259627, 1.1064638783269962, 1.0230263157894737, 1.0208333333333333, 1.210144927536232, 1.1297836938435941, 1.1428571428571428, 1.045804457763626, 1.001795071573705, 1.035693724812896, 1.0397178916109875, 1.0519242516799023, 1.1126394741724313, 1.0237068965517242, 1.1134453781512605, 1.1682966979761789, 1.0988888888888888, 1.1707070707070708, 1.0489296636085628, 1.041969075418113, 1.0497376875838789, 1.0825558430945246, 1.0, 1.5180722891566265, 1.0326435441562227, 1.0480568324279147, 1.146503884572697, 1.0704225352112675, 1.0406681519514154, 1.044589659811647, 1.0462162039762692, 1.1153846153846154, 1.354090909090909, 1.0167421592798578, 1.0, 1.6363636363636365, 1.0335321349626725, 1.3246311010215663, 1.088855421686747, 1.3461538461538463, 1.0302250803858521, 1.009906637138585, 1.0055630017796227, 1.1798245614035088, 1.1046695478022557, 1.0993788819875776, 1.046875, 1.0238095238095237, 1.0, 1.0526315789473684, 1.066866424854124, 1.6167247386759582, 1.0919540229885059, 1.0192782995551162, 1.0957683741648108, 1.055459115402698, 1.0076573077349906, 1.1182048450996946, 1.0414201183431953, 1.157190635451505, 1.0338358458961474, 1.0171175828594405, 1.044587054907689, 1.0, 1.0968944099378881, 1.0534142162172808, 1.0017429746974562, 1.090803259604191, 1.0076147463501732, 1.0054559296227372, 1.0344827586206897, 1.0003073664562603, 1.032490974729242, 1.206993795826283, 1.0971428571428572, 1.0999792574154739, 1.0205029013539653, 1.0874015748031496, 1.0, 1.0257561436672968, 1.0710138454667262, 1.0677449601500235, 1.3395522388059702, 1.0909090909090908, 2.6666666666666665, 1.151351541478342, 1.0909090909090908, 1.0848035633503845, 1.5, 1.0, 1.2903225806451613, 1.061748860339826, 1.6428571428571428, 1.0966850828729282, 1.1139835487661576, 1.0559322033898304, 1.0114649681528662, 1.0675966108700146, 1.1929824561403508, 1.0, 1.0094380359015482, 1.1146562371346234, 1.1120840630472855, 1.1031755182990106, 1.1100726367653782, 1.0558470569899736, 1.100953895071542, 1.0343643821629138, 1.0663875598086126, 1.1339637509850276, 1.1938132238674681, 1.9090909090909092, 1.0622357293868923, 1.183368869936034, 1.2727272727272727, 1.1363636363636365, 1.1469090909090909, 1.0, 1.125, 1.024695511742144, 1.0584958217270195, 1.1700879765395895, 1.0339860468196018, 1.043782837127846, 1.0026984625039221, 1.000456308464522, 1.6, 1.0681156784285195, 1.0, 1.0072223668362328, 1.0220750551876379, 1.0228574029402393, 1.25, 1.4285714285714286, 1.0, 1.4929577464788732, 1.0415946734514339, 1.0, 1.073394495412844, 1.009049773755656, 1.0400641025641026, 1.0007086101946936, 1.2115384615384615, 1.0188679245283019, 1.0040298481226269, 1.0757087081989476, 1.0482937872055, 1.1452991452991452, 1.0, 1.2613365155131264, 1.0175438596491229, 1.2024922118380061, 1.062667860340197, 1.0195578231292517, 1.1163522012578617, 1.3111111111111111, 1.0123456790123457, 1.0498374864572049, 1.4285714285714286, 1.0240689250048953, 1.0604395604395604, 1.0, 1.0160001112084185, 1.1428571428571428, 1.75, 1.0369015010408678, 2.0, 1.0150891632373114, 1.0319767441860466, 1.0254306808859721, 1.0196683378326263, 1.3080939947780679, 1.1318681318681318, 1.0178844410773955, 1.0026032556966555, 1.005449591280654, 1.0137591734656226, 1.0867987297746862, 2.0, 1.1111111111111112, 1.032064057359167, 1.3333333333333333, 1.048687089715536, 1.0, 1.0, 1.0, 1.2623574144486691, 1.0863723608445297, 1.29, 1.04004329004329, 1.0, 1.0013333333333334, 1.0249953803510934, 1.5, 1.1155449672424063, 1.0, 1.0086996128444545, 1.2027027027027026, 1.0980057727630543, 1.1774193548387097, 1.0018181818181817, 1.0951492537313432, 1.0093457943925233, 1.0115570955016575, 1.0019843362059875, 1.0080536912751679, 1.0, 1.1428571428571428, 1.8333333333333333, 1.5, 1.0666666666666667, 1.0021597577985897, 1.25, 1.0100840336134453, 1.00990099009901, 1.0063237881530969, 1.034973449475529, 1.0178197064989518, 1.121251121711614, 1.0341931613677264, 1.2612612612612613, 1.5, 1.0084033613445378, 1.0585585585585586, 1.0030215235003068, 1.4761904761904763, 3.6666666666666665, 1.066815144766147, 1.0191860465116278, 1.0065502109188311, 1.175792507204611, 1.342769701606733, 1.05635838150289, 1.4545454545454546, 1.0808477237048666, 1.0254237288135593, 1.3269230769230769, 1.055306427503737, 1.0982142857142858, 1.06452276250435, 1.009308744611595, 1.0808809603261214, 1.2647058823529411, 1.027027027027027, 1.0623145400593472, 1.0, 1.0421166306695464, 1.028385834234105, 1.0579101772127746, 1.0057546476398773, 1.0116657104608913, 1.0096246390760346, 1.8333333333333333, 1.087047718930257, 1.2, 1.0700256191289497, 1.1111111111111112, 1.0216126812157271, 1.0057971014492753, 1.013542562338779, 1.134387351778656, 1.0863121185701832, 3.0, 1.1041397153945667, 1.0017803270819345, 1.0703972779106126, 1.0, 1.125, 1.0326295585412668, 1.4683908045977012, 1.0948004737981456, 1.0103950103950103, 1.105263157894737, 1.0517241379310345, 1.1337322083810504, 1.0559516255458923, 1.001830550837389, 1.1781798245614035, 1.2023217247097844, 1.1136363636363635, 1.0714285714285714, 1.0862944162436547, 1.3, 1.0429740791268758, 1.1, 1.0394099096238916, 1.1904761904761905, 1.1148646558391337, 1.0176816258001329, 1.1729377713458755, 1.0, 1.1067961165048543, 1.28, 1.0021401610957625, 1.4660831509846828, 1.0, 1.0966427189831445, 1.004222992898766, 1.2580813347236706, 1.0, 1.5, 1.1984466019417477, 1.0054054054054054, 1.412037037037037, 1.0, 1.0083448776304507, 1.059, 1.0869565217391304, 1.088587570621469, 1.0272727272727273, 1.0627615062761506, 1.1725806451612903, 1.0361800588977703, 1.0680213535388325, 1.0, 1.0675675675675675, 1.0505912365980625, 1.0067605699584714, 1.0448491622003777, 1.0, 1.0261007716749886, 1.005792353696836, 1.0282870612886328, 2.0, 1.121212121212121, 1.0387458217598042, 1.132686407896492, 1.187846751998602, 1.0451785600668975, 1.1763558330081936, 1.0621848739495798, 1.0959498553519769, 2.0, 1.0998501214533052, 1.0422535211267605, 1.0, 1.261437908496732, 1.1063829787234043, 1.0280861565883568, 1.073905109489051, 1.027935470306019, 1.0376190476190477, 1.0088926193527896, 1.048965237386717, 1.010136736132783, 1.1067961165048543, 4.0, 1.0511535229864362, 1.0036437246963563, 1.0068365054566604, 1.0152981459989834, 1.094695917800611, 1.1728024042073628, 1.1675977653631284, 1.4285714285714286, 1.0333471703334718, 1.0020612124385815, 1.0106003474917749, 1.101119537739256, 1.0291724548521533, 1.0363247863247864, 1.0027576831577414, 1.0271468144044322, 1.0782967032967032, 2.0, 1.2, 1.0550161812297734, 1.0761904761904761, 1.0170648464163823, 1.0157004830917875, 1.0669456066945606, 1.1705882352941177, 1.0554699537750385, 1.1263736263736264, 1.0054425251535928, 1.3452380952380953, 1.0129300932713603, 1.0, 1.0691244239631337, 1.3611111111111112, 1.1418439716312057, 1.0293271995399655, 1.1214723926380368, 1.0395256916996047, 1.00390625, 1.039798632218845, 1.0, 1.702127659574468, 1.6666666666666667, 1.0, 1.0731707317073171, 1.1428571428571428, 1.3875802997858673, 1.138121546961326, 1.0294777314963153, 1.1447543160690572, 1.0341201055119729, 1.0101557878130547, 1.0971428571428572, 1.0216584098422639, 1.1490683229813665, 1.0608913998744507, 1.1344944363812288, 1.078237650200267, 1.2196531791907514, 1.0300083356487912, 1.0001520295950945, 1.0046267735965453, 1.0074002384127847, 2.0, 1.0122850122850122, 1.044362292051756, 1.0410958904109588, 1.0, 1.2439024390243902, 1.25, 1.1143984220907297, 1.5185185185185186, 1.5, 1.0323758358005388, 1.0234227830104852, 1.0071587469929382, 1.00664201071779, 1.1189189189189188, 1.0449574726609963, 2.0, 1.1755725190839694, 1.1460754090585725, 1.0059049858387217, 1.0064491164710434, 1.0529103542544709, 1.0140532808868228, 1.0968660968660968, 1.0471464503675396, 1.1882770870337478, 1.0007623831199408, 1.0114459986069015, 1.3636363636363635, 1.109271523178808, 1.0, 1.0113378684807257, 1.0220202301087977, 3.0, 1.0823649337410806, 1.0603588533192787, 1.2857142857142858, 1.1318139193541812, 1.2, 1.1875, 1.0106444759206799, 1.6923076923076923, 1.0141039121134114, 1.0166595472020503, 1.1875, 1.2608695652173914, 1.2404092071611252, 1.0057720057720059, 1.0775451950523312, 1.032246027550608, 1.011477072545775, 1.0, 1.2035628937649359, 1.0061349693251533, 2.0, 1.093249071660862, 1.0209274158664243, 1.1173131504257332, 1.007350913091168, 1.0353248465790943, 1.2417582417582418, 2.142857142857143, 1.109927729174591, 1.0680447889750215, 1.054553475981199, 1.042361574382922, 1.052539061374338, 1.0493852429058055, 1.0164835164835164, 1.0310701956271577, 1.15, 1.0366791285577586, 1.0675078864353311, 1.0137741046831956, 1.0829831932773109, 1.0536645657833608, 4.0, 1.004014055775634, 1.016361666385026, 1.031190414283238, 1.1875, 1.0105540897097625, 1.3284313725490196, 1.0, 1.003773717993934, 1.0134426229508198, 1.1036144578313254, 1.1470588235294117, 1.6666666666666667, 1.0302925771570173, 1.0, 1.3587301587301588, 1.0769230769230769, 1.0722908380434024, 1.2857142857142858, 1.196969696969697, 1.0775681341719077, 1.0, 1.2949735449735449, 1.0380176510522743, 1.75, 1.0, 1.08130081300813, 1.0583941605839415, 1.0805588585017836, 1.0159914712153517, 1.0684474123539232, 1.0058997050147493, 1.089150378938971, 1.0545454545454545, 1.5030674846625767, 1.0337552742616034, 1.3076923076923077, 1.0, 1.170789163722026, 1.2554112554112553, 1.0364025695931478, 1.1966278204810314, 1.0310427823575425, 1.1994642591398383, 1.0265541161473928, 1.073079906904577, 1.0649819494584838, 1.0143198090692125, 1.5714285714285714, 1.0, 1.0303030303030303, 1.0104518929198587, 1.1296111665004984, 1.0065359477124183, 1.3096774193548386, 1.0274150439098892, 1.0726534360784652, 1.0056458767113683, 1.0769230769230769, 1.1578947368421053, 1.0614359733530718, 1.087685577942736, 1.0317184513560902, 1.0396780290514016, 1.1578947368421053, 1.1156969875959835, 1.0020738235695545, 1.0455153949129852, 1.0087313816127375, 1.1111111111111112, 1.054259876249405, 1.5283993115318417, 1.0192307692307692, 1.1577287066246056, 1.0347890451517394, 1.0, 1.106060606060606, 1.0536414136250554, 1.2777777777777777, 1.0278273249439527, 1.1440677966101696, 1.0232558139534884, 1.066477665103769, 1.0109228550829128, 1.1089846897663176, 1.0047709923664123, 1.0056753688989784, 1.0009025270758123, 1.1764705882352942, 1.0, 1.0, 1.1111111111111112, 1.0019619716604093, 1.8333333333333333, 1.0876388326813256, 1.0712670292391362, 1.2660611431103235, 1.0742479197781096, 1.006984220308766, 1.1030010718113612, 1.073076923076923, 1.0097087378640777, 1.0140747176368374, 1.0316715826120593, 1.0068307648059822, 1.0079790437191376, 1.25, 1.0847457627118644, 1.3675889328063242, 1.0436654366543665, 1.0032679738562091, 1.022198275862069, 1.1699115044247788, 1.0058479532163742, 1.0657288325600225, 1.0149863760217983, 1.0120215311004785, 1.3125, 1.0038418092391688, 1.003680166147456, 1.11125711782742, 1.0008428150021071, 1.032258064516129, 1.1038543897216273, 1.154228855721393, 1.5, 1.0370564770102877, 1.4615384615384615, 1.0171370967741935, 1.0175824175824175, 1.145650708024275, 1.0654825977753857, 1.076470588235294, 1.0909090909090908, 1.0666666666666667, 1.0062134637302842, 1.015475579276377, 1.0104365878208355, 1.0791081837874013, 1.0304562538976252, 1.0833333333333333, 1.0584795321637428, 1.0720418848167539, 1.0396669494173847, 1.0050352467270895, 1.2013888888888888, 1.0403377110694183, 1.021624073794042, 1.226179875333927, 1.0558943276652972, 1.0, 1.6666666666666667, 1.0064393807445595, 1.0151406941865448, 1.0310878777078136, 1.0752077479524123, 1.0518754988028731, 1.076555023923445, 1.0047707760396645, 1.1021643006748894, 1.0401529636711282, 1.308108108108108, 1.007703081232493, 1.013229223653454, 1.0119047619047619, 1.75, 1.0381242688018546, 1.0008175481868444, 1.0156340474811811, 1.3233082706766917, 1.0018102824040551, 1.0113479122483746, 1.0209529276693456, 1.0362694300518134, 1.1923076923076923, 1.1044474393530996, 1.0259179265658747, 1.096875, 1.8695652173913044, 1.0666554922337692, 1.0059464816650148, 1.0884476534296028, 1.2424242424242424, 1.0167318687932592, 1.0893492362418915, 1.0121951219512195, 1.1113801452784504, 1.6666666666666667, 1.0769230769230769, 1.0, 1.018807665010646, 1.5384615384615385, 1.3333333333333333, 1.3636363636363635, 1.2356792144026187, 1.0091407678244972, 1.1127799383129946, 1.0139514605435256, 1.2359550561797752, 1.5441176470588236, 1.0, 1.1612903225806452, 1.4054054054054055, 1.3725490196078431, 1.0155763239875388, 1.0115761533941634, 1.0059909296205745, 1.0625, 1.0136845776656203, 1.001291226665332, 5.0, 1.00480589296043, 1.0357142857142858, 1.0, 1.3333333333333333, 1.0068513553768246, 1.1388510363623323, 1.0349422987602273, 1.0683229813664596, 1.0, 1.1727272727272726, 1.205521472392638, 2.0, 1.5, 1.0605314960629921, 1.0267770876466529, 1.1337299900835813, 1.25, 1.004436675185526, 1.0720371804802478, 1.1430246189917936, 1.1428571428571428, 1.07035175879397, 1.0043159373718495, 1.4342105263157894, 1.0494530537830447, 1.0854033344560459, 1.0216346153846154, 1.0118577075098814, 1.053085399449036, 1.1596925704526047, 1.1694214876033058, 1.1896551724137931, 1.055907775987805, 1.077064945329996, 1.071307469831455, 1.403361344537815, 1.186046511627907, 1.1343283582089552, 1.055263157894737, 1.0443349753694582, 1.0209411812660498, 1.0074573673117455, 1.046943231441048, 3.0, 1.25, 1.0734602847829817, 1.1350043975373791, 1.3174479673215327, 1.0184552118943309, 1.005853821709316, 1.1095641901868962, 1.0317460317460319, 1.0416666666666667, 1.0078434479480272, 1.0198680939368412, 1.0860341779611078, 1.2399299474605954, 2.5, 1.0533333333333332, 1.032185997197925, 1.0986857825567502, 1.000593129068007, 1.0007560543414058, 1.1235795454545454, 1.6, 1.0058754406580495, 1.0515579882411605, 1.0383824537354351, 1.0874524714828897, 1.0225766461641157, 1.2816326530612245, 1.2998565279770444, 1.0968115942028986, 1.0026598454305966, 1.0497525627430186, 1.087557603686636, 1.1037131882202305, 1.03125, 1.0127306903622693, 1.011676030612009, 1.0871862615587846, 1.0479681202114661, 1.0297994269340973, 1.0500397140587767, 1.3846153846153846, 1.048832271762208, 2.5, 1.5, 1.4166666666666667, 1.0383631713554988, 1.1524486571879937, 1.071372869397304, 1.0358729891499383, 1.0182370820668694, 1.0014665828619318, 1.125, 1.5714285714285714, 1.0386893702594593, 1.6, 1.3333333333333333, 1.0094308943089432, 1.0, 1.1276276276276276, 1.1279127416955874, 1.1032897701667417, 1.0359432568859457, 1.25, 1.069182389937107, 1.3682170542635659, 1.266084788029925, 1.0004635302648548, 1.0227272727272727, 1.0354609929078014, 1.0113835548990644, 1.0536281179138323, 1.1017488076311606, 1.3653846153846154, 1.1997206703910615, 1.0, 1.0, 1.0006795178999321, 1.6666666666666667, 1.5714285714285714, 1.4594594594594594, 1.040150564617315, 1.0681818181818181, 1.032036613272311, 1.1189640035118524, 1.0, 1.22284295468653, 1.0307043949428056, 1.201793721973094, 1.0348258706467661, 1.25, 1.0193780982424516, 1.0992239467849223, 1.0842105263157895, 1.1245816288583117, 1.00511369358774, 1.009588672820145, 1.062205466540999, 1.0, 1.0159896840747904, 1.0197806121645252, 1.008090395480226, 1.2695652173913043, 1.0340903443820504]
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.5714	median: 1.0572	mean: 1.1479

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 15.858003 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=naru', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[ 8.9406967e-07  2.9802322e-07 -2.9802322e-08  5.9604645e-07
  9.5367432e-07]
Distance score: 5.424022901934222e-07
SAUCE Drift detection: False
Detection latency: 0.0231s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 2.037500 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 8.0000	99th: 3.0000	95th: 1.7514	median: 1.0663	mean: 1.1715
ReportEsts: [1.1145251396648044, 1.0468574003153863, 1.0320863926588622, 1.0, 1.0571428571428572, 1.0, 1.156225218080888, 1.0065586318423827, 1.0, 1.0354767184035476, 1.0131196403703795, 1.0019243753001195, 1.0783803863298662, 1.0271844660194174, 1.0406599882144962, 1.1333333333333333, 1.1140065146579805, 1.4444444444444444, 1.3, 1.071301247771836, 1.0845301600328272, 1.1619360236853962, 1.1061359867330016, 1.0750670241286864, 1.0440894453088252, 1.0036742674675407, 2.0, 1.0506752129728545, 1.2, 1.6, 1.033210332103321, 1.0, 1.007664440971729, 1.0156751545979428, 1.5173691523853636, 1.0111903590752582, 1.0200779396814639, 1.0182648401826484, 2.0, 1.1301651452860428, 1.0560875512995895, 1.0337467026469787, 1.0574052812858783, 1.0626816106268162, 1.0518518518518518, 1.1110405867625799, 1.3157894736842106, 1.0082013574660633, 1.6578947368421053, 1.096041055718475, 3.0, 1.0520833333333333, 1.062780269058296, 1.096774193548387, 1.0568803845970773, 1.0012325390304027, 1.0114206128133705, 1.1685649202733486, 1.1686746987951808, 1.0139175794608295, 1.1290322580645162, 1.0092683010399, 1.0717360114777619, 1.0632411067193677, 1.1764705882352942, 1.5, 1.1429148629148629, 1.0632556131260795, 1.0, 2.0, 1.0378886010362693, 1.0019588638589618, 1.068433734939759, 1.0977443609022557, 1.0908879139651357, 1.3007205157375805, 1.0477648499693815, 1.0698689956331877, 1.0212765957446808, 1.0044547496029066, 1.1724336793540946, 1.1750972762645915, 1.0, 1.25, 1.0195852534562213, 1.206896551724138, 1.0762331838565022, 4.0, 1.1428571428571428, 1.0418633679527596, 1.0802741067058248, 1.0938059088051835, 1.0070964079273328, 1.2541977611940298, 1.0214477211796247, 1.3717948717948718, 1.4, 1.2941935483870968, 1.125, 1.1590177133655395, 1.5357142857142858, 3.0, 1.0410575124342822, 1.2072538860103628, 1.0201583873290136, 1.0112182816441608, 1.0232558139534884, 1.0039098139748899, 1.0956165703275529, 1.060964326102601, 1.1193072482360487, 1.0224719101123596, 1.0, 1.5, 1.140711287828584, 1.0041826034363792, 1.0827195467422097, 1.1494252873563218, 1.0065461994438452, 1.0, 1.1396598030438676, 1.162291169451074, 1.0, 1.2155963302752293, 1.0, 1.0368852459016393, 1.0240066737609768, 1.0497778350183529, 1.007936507936508, 1.8, 1.286593707250342, 2.0, 2.0, 1.0055463117027177, 1.0769230769230769, 1.0276195408251338, 1.0572208041589584, 1.047920155860136, 2.0, 1.3333333333333333, 1.0141414141414142, 1.0075757575757576, 1.0442666666666667, 1.0323820387986935, 1.2210526315789474, 1.0215285252960171, 1.0110888443553774, 1.5, 1.0227360308285163, 1.0700507614213197, 1.0385208012326657, 1.0300630590995747, 1.6666666666666667, 1.0343198992443325, 1.0340909090909092, 1.0033112582781456, 1.0577830188679245, 1.0, 1.1577879249112126, 1.0465400526513726, 1.1690278456277479, 1.1639871382636655, 1.1331521739130435, 1.0344827586206897, 1.1197604790419162, 1.128133704735376, 1.0, 1.021845779697262, 1.0277777777777777, 1.1539408866995073, 1.002019058401736, 1.1936017650303365, 1.045793211624766, 1.0545454545454545, 1.18342151675485, 1.2270977057596664, 1.1142857142857143, 1.177310924369748, 1.062127659574468, 1.0450970110120608, 1.1530655391120508, 1.0064577031172899, 1.05, 1.1521739130434783, 1.0187634445909375, 1.0963023493360573, 1.0074349442379182, 1.068397622121799, 1.1685082872928176, 2.0, 1.1271820448877805, 1.009152278333117, 1.1, 1.0212876427829698, 1.1010064177362895, 1.0043323425494926, 1.0074036095159966, 1.059375, 1.0080263377745322, 1.0059047369111664, 1.0734658599827138, 1.0898208403631398, 1.1332794830371566, 1.0065314566754175, 1.1953002610966057, 1.1148535748834756, 1.1366120218579234, 1.0128205128205128, 1.0842105263157895, 2.0, 1.0494505494505495, 1.0709647799567128, 1.588235294117647, 1.009090909090909, 1.010229132569558, 2.1538461538461537, 1.000075824156887, 1.0663615560640731, 1.0147815170291177, 2.0, 1.031017369727047, 1.0609267734553776, 1.0057494076185665, 1.036610920017396, 1.1666666666666667, 1.1176470588235294, 1.00754840827043, 1.016952994399373, 1.0218579234972678, 1.2180327868852459, 1.0066042927903136, 1.0712187479600497, 1.0263157894736843, 1.0029621280747798, 1.010085536394059, 1.1508771929824562, 1.1704152249134947, 1.0056625141562854, 2.0, 1.1603650586701435, 1.0, 1.0031539522964714, 1.0312933987593742, 1.051524507912003, 1.39937106918239, 1.0, 2.0, 1.0919803696846808, 1.1044776119402986, 1.093204963127707, 1.75, 1.065269175797999, 1.007992007992008, 1.3333333333333333, 1.014701945035042, 1.1283783783783783, 1.1256181998021761, 1.016304347826087, 1.0070596540769503, 1.0091668562883984, 1.2238805970149254, 2.0, 1.0228128557667047, 1.1784655722754218, 1.0474137931034482, 1.0003661790092242, 1.073942764945652, 1.0076291726341302, 1.0940397350993378, 1.026121705403579, 1.056930693069307, 1.1417969785316724, 1.163849154746424, 2.090909090909091, 1.0635885095503084, 1.0177935943060499, 1.1403508771929824, 1.0, 1.016832703538303, 1.0922053231939164, 1.0226535828858658, 1.0094256673583513, 1.0066225165562914, 1.1748768472906403, 1.039399577465499, 1.053584359160029, 1.1735067045916294, 1.0014480046761252, 1.6363636363636365, 1.0623441396508728, 1.0685748360166964, 1.0198463686373977, 1.0076206971205888, 1.0008219980986826, 1.1340096102509343, 1.0229178311906093, 1.0206611570247934, 1.0861166408611664, 1.0120188403443235, 1.062217320900106, 1.0811339198435972, 1.05, 1.0769230769230769, 1.0714285714285714, 1.5, 1.0161290322580645, 1.0084116091242703, 1.0644325444809122, 1.1388888888888888, 1.2734375, 1.2931570762052877, 1.1118626430801248, 1.0099488918665733, 1.1363636363636365, 1.0051228315286995, 1.0083236405931957, 1.171830985915493, 2.6666666666666665, 2.5, 1.0571299025164362, 1.8571428571428572, 1.003820491260826, 1.0404191616766467, 1.0416666666666667, 1.070186342973444, 1.0344827586206897, 1.8888888888888888, 1.0394966897106697, 2.0, 1.0344827586206897, 1.0933660933660934, 1.1721224920802535, 1.0367718841522942, 1.1842105263157894, 1.1714285714285715, 1.0140623064884766, 1.0038136968516715, 1.0224146714212938, 1.0477238776633384, 1.0728415028614082, 3.0, 1.2, 1.010446800126861, 1.25, 1.041932543299909, 1.0526315789473684, 4.0, 1.08, 1.2065217391304348, 1.074818986323411, 1.216, 1.0814285714285714, 1.1566265060240963, 3.0, 1.0078448240547295, 1.2777777777777777, 1.103448275862069, 1.0054711574319417, 1.3074074074074074, 1.0773569701853345, 1.0093808630393997, 1.8, 1.75, 1.1398305084745763, 1.070063694267516, 1.0059464816650148, 1.015813300358393, 1.073387694588584, 1.0668380462724936, 1.0, 1.0040996899664252, 1.0040322580645162, 1.4642857142857142, 3.0, 1.21875, 1.1111111111111112, 1.0722100656455142, 1.048780487804878, 1.0916703190237826, 1.0237124564884055, 1.141025641025641, 1.0434283841363488, 1.0478455512031337, 1.1202830188679245, 1.0204081632653061, 1.0379787760069985, 1.0605143721633887, 1.0, 1.00532434869264, 1.0156775346308287, 1.1807192085371276, 1.1504854368932038, 1.0434782608695652, 1.0350553505535056, 3.0, 1.7777777777777777, 1.12, 1.082514734774067, 1.3178807947019868, 1.1398601398601398, 1.0382133995037222, 1.0866873065015479, 1.0127821065831042, 1.1188943581976525, 1.0413518383863931, 1.2142857142857142, 1.1637931034482758, 1.1025, 1.0, 1.007976653696498, 1.3666666666666667, 1.0065104659525341, 1.0285749101322124, 1.0433098869833242, 1.0188628402047966, 2.5714285714285716, 1.1686023227873448, 1.5, 1.0819798917246712, 1.0, 1.0294279933787014, 1.0690505548705302, 1.0311970763882699, 1.1217105263157894, 1.140898705255141, 3.0, 1.020472824762369, 1.0006467962111891, 1.0660625491965365, 1.5, 1.2413793103448276, 1.0745192307692308, 1.3567961165048543, 1.0999417149518291, 1.037645718292576, 1.0833333333333333, 1.1587417702999268, 1.0739545436764073, 1.0605158111395248, 1.0102991868746922, 1.1096227610023062, 1.0361230329041489, 1.1272727272727272, 1.18894256575416, 1.021077163680224, 1.6048387096774193, 1.1470911086717892, 1.0, 2.0, 1.171636845593108, 1.1422764227642277, 1.2314751869476546, 1.0505027731433467, 1.149679673849738, 1.0, 1.0234375, 1.2333333333333334, 1.375, 1.0, 1.0, 1.015757991552859, 1.0, 1.0, 1.1047040971168438, 1.5, 1.172971225347559, 1.0247376311844079, 1.3676470588235294, 1.1, 1.0221568775634993, 1.0215654952076678, 1.0714285714285714, 1.0273133014835303, 1.054263565891473, 1.01, 1.1907356948228882, 1.0189274447949528, 1.0916999086845773, 1.0, 1.0333333333333334, 1.0474537037037037, 1.0100794135613929, 1.115909090909091, 1.2, 1.0506841395259203, 1.024926871268191, 1.0243478260869565, 2.0, 1.1096301232922359, 1.034227785370842, 1.1069253876755702, 1.1704989154013015, 1.0296422499925437, 1.0023705931854399, 1.014512785072564, 1.0643327776454712, 1.5, 1.0114176145029852, 1.0568181818181819, 1.0272792534099067, 1.0688705234159779, 1.0558510638297873, 1.016882195320857, 1.130153121319199, 1.0676092729491136, 1.0159223300970874, 1.0397117194433338, 1.187007874015748, 1.0206833620602251, 1.1632407198253143, 1.0952380952380953, 1.108695652173913, 1.017003586049316, 1.0041152263374487, 1.0229513496040084, 1.008302721343429, 1.0, 1.1889733840304182, 1.0859598853868195, 1.1111111111111112, 1.2790697674418605, 1.0154268598443101, 1.0942028985507246, 1.0351648351648353, 1.0, 1.105263157894737, 1.0402081362346263, 1.0361301460355488, 1.022099447513812, 1.0126116114693302, 1.0439399487367265, 1.1114427860696516, 1.1058374249863612, 1.0916698730280878, 1.2714285714285714, 1.0196127187393156, 1.1322934719815136, 1.0220264317180616, 1.0770837942137994, 1.0346420323325636, 1.066881293239263, 1.0, 1.1288135593220339, 1.3509933774834437, 1.0346329288234788, 1.0735930735930737, 1.1226993865030674, 1.0731292517006803, 1.0087412587412588, 1.0098361630049328, 1.0, 1.6923076923076923, 1.75, 1.0, 1.1030927835051547, 1.0968819599109132, 1.3506044905008636, 1.1018518518518519, 1.0285026093938177, 1.0473764645950077, 1.0740524282639374, 1.0246592317224288, 1.0076176769807201, 1.0463504987799173, 1.021571363997796, 1.0704375667022412, 1.0875387137912187, 1.001926437521993, 1.0555280118988597, 1.0032786885245901, 1.1543367346938775, 1.0548780487804879, 1.0033704215057258, 1.1892551892551892, 1.012630236866745, 1.144859813084112, 1.2242744063324538, 1.0982019363762103, 2.5, 1.014002333722287, 1.0666666666666667, 1.0, 1.151685393258427, 1.0205100606930368, 1.033140655105973, 1.0798004987531171, 1.0650887573964498, 1.0593997804074662, 1.1518949167308916, 1.0017985611510791, 1.2, 1.0, 1.0040864609097753, 1.3657407407407407, 1.0080873433077233, 1.0122699386503067, 2.0, 1.0924801494628678, 1.1151079136690647, 1.0138704999684762, 1.1708766716196137, 1.0010002617507385, 1.0286340802653238, 1.0180086690667582, 1.0952380952380953, 2.0, 1.0864792370355654, 1.0, 1.1040391676866586, 1.1223628691983123, 1.071695294996266, 1.0541284403669724, 1.4193548387096775, 1.0129795762550104, 1.0469798657718121, 1.2604722010662606, 1.2453208556149733, 1.072762395363812, 1.0322766570605186, 1.107183818162861, 1.0198915009041591, 1.011482939632546, 1.4, 1.0656960947321465, 1.0960651002219326, 1.0869565217391304, 1.010231923601637, 1.1139107186259418, 1.3025302530253025, 1.0484160028964518, 1.0909090909090908, 1.0671785028790788, 1.0191425722831506, 1.4859154929577465, 1.372093023255814, 1.0305087299328723, 1.3333333333333333, 1.7, 1.0614805520702635, 1.0420527441197434, 1.0616997495790947, 1.0861495844875346, 1.0335368491899428, 1.0132301311169947, 1.05446293494705, 1.0204669011832428, 1.110410094637224, 1.0235541769252525, 1.1093161012385568, 1.0120572720422005, 1.0471158080140908, 1.025257525083612, 1.1649484536082475, 1.1318540253071703, 1.3157894736842106, 1.6, 1.0474967907573813, 1.018151815181518, 1.0452876376988984, 1.317445185891325, 1.3333333333333333, 1.0208, 1.0947368421052632, 1.3070866141732282, 1.0359165826720234, 3.3333333333333335, 1.1179796145751661, 2.0, 1.3272251308900525, 1.0625, 1.12691949744067, 1.303030303030303, 1.139917695473251, 1.1105354058721935, 1.0, 1.1416216216216217, 1.0935637663885578, 1.8, 1.25, 1.0743243243243243, 1.0, 1.107394366197183, 1.0097604259094943, 1.0147849462365592, 1.0363812757700703, 1.1282051282051282, 1.0093390804597702, 1.576086956521739, 1.1022727272727273, 1.2903225806451613, 1.5, 1.0, 1.2007211538461537, 1.0138528138528138, 1.2933599822340662, 1.0222389128747935, 1.2764493073325687, 1.0110900479786598, 1.036445332001997, 1.050098231827112, 1.0108803165182987, 1.0909090909090908, 1.0, 1.0, 1.0013072968637506, 1.1120401337792643, 1.0, 1.1804878048780487, 1.1158247455269648, 1.0519759299011155, 1.008841735244986, 1.0879120879120878, 1.1304347826086956, 1.0013966480446927, 1.0227573286312541, 1.024100644080222, 1.073880137287688, 1.2166666666666666, 1.0741876149601473, 1.0605870771433685, 1.0017489003126823, 1.0214180206794683, 1.0170158942293923, 1.0031847133757963, 1.0946601941747574, 1.1532663316582914, 1.0022390584773815, 2.0, 1.0816326530612246, 2.0, 1.05668016194332, 1.047499364604219, 1.1594202898550725, 1.003016741256423, 1.1524663677130045, 1.0392156862745099, 1.0208461437658136, 1.0018364090676461, 1.1417614833544036, 1.0055292259083728, 1.0267430754536773, 1.0190565815786379, 1.1416526138279932, 1.0, 1.0, 1.2, 1.0191087948935482, 1.625, 1.0343564701778862, 1.0395306575729701, 1.1048043034687443, 1.0856423173803527, 1.0463114557901287, 1.0570202877826436, 1.0093167701863355, 1.0244186046511627, 1.0166914701966006, 1.0510498822083376, 1.003144553569288, 1.0354022295872252, 1.3333333333333333, 1.0303398058252426, 1.31438127090301, 1.0437839709712875, 1.0133333333333334, 1.0052465897166842, 1.2526158445440956, 1.0, 1.0652275228170107, 1.0206422018348624, 1.019819837774279, 1.1904761904761905, 1.0068024543725862, 1.0008081394144097, 1.1229689807976366, 1.0059711977520196, 1.054054054054054, 1.0238095238095237, 1.0932544378698226, 1.109631708652793, 1.2671232876712328, 1.0066367372497973, 1.0256410256410255, 1.0543446026097272, 1.2507896399241947, 1.1367088607594937, 1.1290035587188612, 1.0700179533213645, 1.167953667953668, 1.1047708138447148, 1.0462755231886611, 1.0544747081712063, 1.1145597544600039, 1.027534189921421, 1.0, 1.048999309868875, 1.0883753748456517, 1.2450299401197604, 1.1778202676864244, 1.4113695090439276, 1.2112112112112112, 1.1023720349563046, 1.063225806451613, 1.0194086218688976, 1.0666666666666667, 1.020845396641575, 1.027929041526075, 1.0183316168898042, 1.5375191424196017, 1.007947400755526, 1.076870737009808, 1.0654642618570473, 1.1413276231263383, 1.000288072956534, 1.085314914412078, 1.0381558028616853, 1.2139737991266375, 1.0118623962040332, 1.005660685821719, 1.0833333333333333, 2.0, 1.0467029992420689, 1.0037249782419495, 1.0213903743315509, 1.2470588235294118, 1.0096124962451187, 1.037029919406176, 1.011795234725171, 1.040983606557377, 1.1764705882352942, 1.079685746352413, 1.062780269058296, 1.1367292225201073, 1.7096774193548387, 1.0662177642424073, 1.0187908496732025, 1.1573033707865168, 1.2894736842105263, 1.3374233128834356, 1.048743718592965, 1.01, 2.0, 1.0198019801980198, 1.117117117117117, 1.0873253493013972, 1.2, 1.0381319977648544, 1.0369426751592357, 1.1554026709834075, 1.165137614678899, 2.3333333333333335, 1.070619006102877, 1.2157036573494646, 1.0121547109566804, 1.2518796992481203, 1.6111111111111112, 1.1875, 1.0789473684210527, 1.1914893617021276, 1.1216216216216217, 1.0589959692194943, 1.0153367846491475, 1.001854810741181, 1.1180555555555556, 1.0040568875923055, 1.0017938791175784, 8.0, 1.0049114333917508, 1.0008555365436325, 1.0, 1.2857142857142858, 1.0707920792079209, 1.1329679494817109, 1.0522737438497092, 1.0129198966408268, 1.0, 1.2490272373540856, 1.4691358024691359, 1.5909090909090908, 1.004679906053066, 1.0365474980077491, 1.016967191371803, 1.1505221462009363, 1.2, 1.0150580663215336, 1.093853271645737, 1.1798994974874373, 1.058011049723757, 1.087456846950518, 1.0, 1.204724409448819, 1.063477549448963, 1.0869359585201794, 1.434782608695652, 1.040677966101695, 1.0054904032804586, 1.2320169252468265, 1.11986301369863, 1.3709677419354838, 1.0496898414108276, 1.158786586088399, 1.0167083217624733, 1.6446280991735538, 1.2, 1.0742530755711774, 1.25, 1.0223512336719884, 1.0286396181384247, 1.0185019547149332, 1.0498640072529466, 3.0, 1.1600199401794615, 1.0566037735849056, 1.1699011351153423, 1.237754271765663, 1.0545549749642735, 1.083854818523154, 1.1065176123180764, 1.0058252427184466, 1.0333333333333334, 1.0389955083707636, 1.0018435787722624, 1.0773780187284376, 1.0933333333333333, 3.0, 1.021978021978022, 1.033881196114291, 1.2466567607726597, 1.0070327716702179, 1.0068498132169659, 1.1310993533215756, 1.6666666666666667, 1.030938123752495, 1.05470898036634, 1.044907318937512, 1.01875, 1.025794221856112, 1.2417218543046358, 1.1587473002159827, 1.0377448638318203, 1.0042715062903773, 1.0156362996696833, 1.1026392961876832, 1.1353944562899787, 1.0256410256410255, 1.0815993182302392, 1.4182716049382715, 1.0576887358997535, 1.007214858956357, 1.0664352999504214, 1.0755102040816327, 1.0, 1.074468085106383, 1.6666666666666667, 1.5, 1.4, 1.0125786163522013, 1.123046875, 1.0355768036756487, 1.0530377169596958, 1.078745487364621, 1.010480349344978, 1.094170403587444, 1.1794212218649518, 1.0163540448964818, 1.5, 1.1176470588235294, 1.0971957527906344, 1.6666666666666667, 1.0973557692307692, 1.10357432981316, 1.0181081907090463, 1.019923283519487, 1.25, 1.16430935901294, 1.0689655172413792, 1.0788938515632425, 1.0003097952673992, 1.1883519206939281, 1.0546268656716418, 1.0146100951470078, 1.0241628003123708, 1.0647291941875825, 1.3225806451612903, 1.2354312354312353, 1.0, 2.0, 1.0008346281247322, 1.5, 1.8571428571428572, 1.34, 1.004995004995005, 1.007165762698444, 1.0876979293544458, 1.0188679245283019, 1.1666666666666667, 1.0147169419880189, 1.0079562406762805, 1.165067178502879, 1.0040080160320641]
origin-bjaq_15.87 	max: 8.0000	99th: 3.0000	95th: 1.7514	median: 1.0663	mean: 1.1715

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 20.123551 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=38.051285