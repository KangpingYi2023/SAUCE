Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='naru', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 86, 'naru': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 5.0000	99th: 2.6667	95th: 1.5714	median: 1.0602	mean: 1.1482
ReportEsts: [1.1130742049469964, 1.0593103448275862, 1.059632394646881, 1.0134615384615384, 1.0344827586206897, 1.0, 1.154690559544295, 1.0044894984192851, 1.25, 1.0372836218375499, 1.0855337200242403, 1.0021489816166753, 1.024526678141136, 1.044186046511628, 1.03108442246556, 1.0, 1.5, 1.004626334519573, 3.0, 2.6666666666666665, 1.0, 1.0943282294587018, 1.0493626998578234, 1.0377818403412553, 1.0039467192895906, 1.0, 1.0883792048929664, 1.0, 1.2, 1.143884892086331, 1.0, 1.001475556081701, 1.0006089759362236, 1.2613762486126525, 1.077202974212941, 1.0293141967368493, 1.0108108108108107, 1.0055362649636985, 1.1486328259522005, 1.2857142857142858, 1.095505617977528, 1.0945121951219512, 1.0, 1.103491731726809, 1.0732685485114917, 1.2066115702479339, 1.087378640776699, 1.2094017094017093, 1.0322236771420896, 1.0188679245283019, 1.0350148153501482, 1.1389432485322897, 1.0073742537545742, 2.0, 1.348051948051948, 1.0103918868160762, 1.1003636363636364, 1.064638783269962, 1.1180124223602483, 1.25, 1.0333607230895645, 1.0554171855541719, 1.0136363636363637, 1.0919540229885059, 1.1818181818181819, 1.0909971963587277, 1.0945220193340495, 1.1666666666666667, 1.0, 1.0988526941200574, 1.0214797136038185, 1.0615206035983749, 1.1081081081081081, 1.0918881118881119, 1.2423529411764707, 1.1134020618556701, 1.0, 1.0449389179755673, 1.6, 1.0571035036873369, 1.1875, 1.0155797907856665, 1.1840490797546013, 1.036697247706422, 1.0731964191679833, 1.04, 1.004251818968072, 1.0162225072443114, 1.2549019607843137, 2.3333333333333335, 1.064516129032258, 1.0256277534983032, 1.019047619047619, 1.2636746143057505, 1.2275784753363228, 1.1290322580645162, 1.1946902654867257, 1.0209059233449478, 1.0, 1.0049076470063354, 1.106695464362851, 1.0077186963979416, 1.014353210680793, 1.1470588235294117, 1.0103308474533224, 1.1191325014854427, 1.0158445565608973, 1.0219946909366704, 1.0280491648282382, 1.1666666666666667, 1.3333333333333333, 1.1483767104910116, 1.0084102035557847, 1.0518272425249169, 1.0129870129870129, 1.0051481809166969, 1.0, 1.233852140077821, 1.1770334928229664, 1.0, 1.2472527472527473, 1.1666666666666667, 1.06265664160401, 1.0238267888662114, 1.0632911392405062, 1.087378640776699, 1.8, 1.3394039735099337, 1.0, 1.1785714285714286, 1.0070135260860231, 1.1818181818181819, 1.0291457286432162, 1.000772482053923, 1.050129539005634, 1.1795275590551182, 1.0488505747126438, 1.044788273615635, 1.00199203187251, 1.051923076923077, 1.0257482108002602, 1.2098765432098766, 1.065883887801696, 1.024703828407532, 2.0, 1.0078089113458888, 1.0644768856447688, 1.043424317617866, 1.0155284983236281, 1.0, 1.0095664809881326, 1.0340740740740741, 1.012, 1.4476190476190476, 1.072992700729927, 1.02714093054619, 1.0572092632522192, 1.1183605374695644, 1.1007604562737643, 1.167763157894737, 1.0, 1.1956521739130435, 1.1131147540983606, 1.1428571428571428, 1.0043981939522584, 1.0060008082410083, 1.0374208405296488, 1.0522163786626597, 1.013439218081857, 1.0155574991386394, 1.0378947368421052, 1.01890756302521, 1.16665052774281, 1.0844298245614035, 1.134050880626223, 1.014792899408284, 1.0637886597938144, 1.0510199926707113, 1.106384089366811, 1.0, 1.2233009708737863, 1.030541012216405, 1.0476190476190477, 1.1191268960414353, 1.1692307692307693, 1.026135733915384, 1.029889152810768, 1.0097692105953318, 1.0175438596491229, 1.0664081434803685, 1.038977122871395, 1.0, 1.2727272727272727, 1.0889396669156743, 1.2769580022701477, 1.0823353293413174, 1.3461538461538463, 1.0032258064516129, 1.0017707041122543, 1.0269156761832863, 1.1798245614035088, 1.1661220617687362, 1.0993788819875776, 1.109375, 1.0238095238095237, 1.0, 1.0457516339869282, 1.0311465068601167, 1.6341463414634145, 1.160919540229885, 1.0192782995551162, 1.0957683741648108, 1.107108986760745, 1.009405171457108, 1.1259336234331363, 1.1210191082802548, 1.0712074303405572, 1.0201652892561983, 1.0035741050325704, 1.086351807348931, 1.0, 1.1130434782608696, 1.0068015070394607, 1.003295542786147, 1.0647727272727272, 1.012533312224597, 1.0042294028083234, 1.0344827586206897, 1.0016625731043174, 1.081277011013523, 1.1787930062041738, 1.0104166666666667, 1.0871188550093343, 1.0169158143194335, 1.1031496062992125, 1.0, 1.0722067392956676, 1.131308619919607, 1.0206282231598687, 1.4365671641791045, 1.0909090909090908, 2.6666666666666665, 1.07669580204358, 1.1272727272727272, 1.1181492109038738, 1.5, 1.5, 1.1428571428571428, 1.0304449648711944, 1.6734693877551021, 1.1160220994475138, 1.1258907363420427, 1.072289156626506, 1.014480408858603, 1.030663953395579, 1.0175438596491229, 1.0, 1.0382792485055508, 1.1169205434335117, 1.1330998248686515, 1.0800126430812995, 1.0741606136028852, 1.0155737295334544, 1.0922098569157392, 1.0243120961921026, 1.0723684210526316, 1.1077752117013087, 1.2415002286933985, 1.7272727272727273, 1.0502354410916779, 1.1769722814498933, 1.2727272727272727, 1.1904761904761905, 1.1752727272727272, 1.0, 1.125, 1.055245272861853, 1.2033426183844012, 1.2164634146341464, 1.00308915932821, 1.0428696412948382, 1.0106484185930067, 1.012988873501743, 1.5, 1.057366315023645, 1.2, 1.0270421039845603, 1.041036717062635, 1.0048571219494347, 1.275, 1.6666666666666667, 1.0454545454545454, 1.4929577464788732, 1.013162187952104, 1.0, 1.0198776758409787, 1.0045454545454546, 1.0372596153846154, 1.0008952759659098, 1.1666666666666667, 1.0063291139240507, 1.002356651704498, 1.0616477111978724, 1.0846237258729126, 1.188034188034188, 1.0, 1.2684964200477327, 1.0124688279301746, 1.190031152647975, 1.0118920762115853, 1.0125104253544621, 1.0845070422535212, 1.2040816326530612, 1.010973936899863, 1.0371956114530372, 1.4285714285714286, 1.0168650523606018, 1.0677655677655677, 1.0555555555555556, 1.020112495987271, 1.0952380952380953, 1.75, 1.0216202912067982, 2.0, 1.0123456790123457, 1.0494186046511629, 1.003281378178835, 1.025340393343419, 1.0757180156657964, 1.2197802197802199, 1.0026109660574412, 1.0024401551938704, 1.0177111716621254, 1.0253044155631175, 1.0939949767866657, 2.0, 1.2222222222222223, 1.0285586686724333, 1.3333333333333333, 1.048687089715536, 1.0, 1.0, 1.0454545454545454, 1.216117216117216, 1.0791229742612012, 1.2285714285714286, 1.025974025974026, 1.0, 1.0845539280958723, 1.010569429574484, 1.5, 1.1911852293031566, 1.0, 1.0146815455856677, 1.0, 1.1616373655208607, 1.163594470046083, 1.0018181818181817, 1.1255992329817832, 1.1018518518518519, 1.0168802774427022, 1.0001885279165108, 1.0107671601615074, 1.0, 1.1428571428571428, 1.8333333333333333, 3.0, 1.0666666666666667, 1.0026495688019705, 1.25, 1.0067001675041876, 1.099009900990099, 1.1490421009724567, 1.047206745315511, 1.0104058272632674, 1.0883436452085202, 1.030484160191273, 1.2556053811659194, 1.5, 1.00418410041841, 1.0491071428571428, 1.0083018099512073, 1.2857142857142858, 3.142857142857143, 1.1091314031180401, 1.0156976744186046, 1.0074896747282553, 1.175792507204611, 1.342769701606733, 1.0371736662883086, 1.4545454545454546, 1.0808477237048666, 1.0296610169491525, 1.3653846153846154, 1.0568862275449102, 1.0423728813559323, 1.044368229926441, 1.0243020183586196, 1.0129912940579833, 1.1944444444444444, 1.072072072072072, 1.0529411764705883, 1.0, 1.0143025767240947, 1.0114752334748953, 1.0034386806325362, 1.002149513233499, 1.026869382291069, 1.0025485823510671, 1.8333333333333333, 1.1616015436565363, 1.2, 1.0922288642186166, 1.1111111111111112, 1.0257344746110293, 1.0304347826086957, 1.0092200889467404, 1.134387351778656, 1.064957264957265, 3.0, 1.106645056726094, 1.0085097607501692, 1.0149209122677947, 1.0, 1.2115384615384615, 1.0403071017274472, 1.206896551724138, 1.1433202525166355, 1.0931818181818183, 1.1666666666666667, 1.092320966350302, 1.097880197256176, 1.0854391400097048, 1.0081670729668124, 1.11875, 1.2902155887230513, 1.0193050193050193, 1.0714285714285714, 1.0203045685279188, 1.3, 1.0450204638472034, 1.03125, 1.083348619645969, 1.1363636363636365, 1.082807523586323, 1.0344895020355918, 1.1163911845730028, 1.0, 1.0857142857142856, 1.28, 1.0015564807969182, 1.4945295404814005, 1.0, 1.0455927051671732, 1.044397826113626, 1.1840039254170756, 1.0, 2.0, 1.178252427184466, 1.0017921146953406, 1.4186046511627908, 1.0, 1.0250263869648393, 1.0281553398058252, 1.0869565217391304, 1.0726177024482109, 1.0272727272727273, 1.0039525691699605, 1.157258064516129, 1.1102229701304165, 1.1686470351874174, 1.0, 1.0675675675675675, 1.0688306677890012, 1.0100205669042943, 1.0574373827130872, 1.0, 1.051150895140665, 1.0152436382060974, 1.0288108957569408, 2.0, 1.1076555023923444, 1.043041758862577, 1.1027888704912179, 1.2086846358830983, 1.0303995627122593, 1.1706789438650986, 1.0144927536231885, 1.0277502477700693, 2.0, 1.0592278670732338, 1.0675675675675675, 1.0, 1.3402777777777777, 1.1304347826086956, 1.0372054621612625, 1.0397526501766785, 1.0450140489706978, 1.239476678043231, 1.0566663102747782, 1.0630325984038955, 1.015222441832241, 1.116504854368932, 4.0, 1.037042371864122, 1.0151821862348178, 1.0087979387686314, 1.0220312485013572, 1.0802959714990408, 1.1710427606901725, 1.1058201058201058, 1.5714285714285714, 1.0074935305444155, 1.0201407121992248, 1.0287604894458615, 1.097552195824334, 1.0529147526838059, 1.0288659793814432, 1.0032293102524512, 1.0043149946062568, 1.0680272108843538, 2.0, 1.0909090909090908, 1.0107361963190185, 1.0521415270018621, 1.016778523489933, 1.0369913686806411, 1.0874200426439233, 1.3178807947019868, 1.0554699537750385, 1.1428571428571428, 1.0038097578960306, 1.4125, 1.0087292834842578, 1.0, 1.1198712791633145, 1.5, 1.0780141843971631, 1.0013966480446927, 1.1839378238341969, 1.0039525691699605, 1.0194552529182879, 1.0502113411854104, 1.0, 1.553191489361702, 1.1666666666666667, 1.0, 1.0114942528735633, 1.1837708830548925, 1.3787234042553191, 1.1318681318681318, 1.0259532201217558, 1.0856423173803527, 1.0409030180535097, 1.0090711891145732, 1.0980392156862746, 1.0064277196622295, 1.1077844311377245, 1.0723350253807107, 1.1190130624092889, 1.101172620670848, 1.0534682080924855, 1.0314412910406232, 1.0120525182069955, 1.1497458345100253, 1.0080139742939087, 2.0, 1.0940860215053763, 1.0304990757855823, 1.062937062937063, 1.0, 1.1590909090909092, 1.1538461538461537, 1.101364522417154, 1.4444444444444444, 1.5, 1.0429840112249098, 1.0219477519104319, 1.0087366460591325, 1.019938414164742, 1.1027027027027028, 1.0498177399756987, 2.0, 1.2419354838709677, 1.1967808501857202, 1.0312551361420041, 1.0065708319560116, 1.0131563762261973, 1.0116931879134632, 1.0754189944134078, 1.0501564333202973, 1.1545293072824157, 1.0184541561091554, 1.0207929366140176, 1.303030303030303, 1.0935799782372144, 1.0, 1.0090702947845804, 1.0178277801817395, 3.0, 1.0159021406727828, 1.0196558030893987, 1.2857142857142858, 1.1953151911815363, 1.3, 1.1875, 1.0058781869688385, 1.7692307692307692, 1.0000060428437623, 1.0008550662676357, 1.2258064516129032, 1.3181818181818181, 1.3324175824175823, 1.028529267092966, 1.1003157639057566, 1.0104229425231956, 1.0103713973391633, 1.0, 1.149684988051271, 1.0060975609756098, 2.0, 1.0581221025439953, 1.0392728057398717, 1.096499526963103, 1.012922346597524, 1.0282195610290508, 1.3950617283950617, 2.0, 1.0273868391023202, 1.0607356715141145, 1.0607299815044202, 1.1000667111407605, 1.0200565964877903, 1.0750509225976517, 1.098901098901099, 1.005952380952381, 1.1074074074074074, 1.0338484899029696, 1.0738170347003155, 1.1488033298647242, 1.1890756302521008, 1.056206663803154, 4.0, 1.0056889681208054, 1.0286505996993833, 1.0202423508352583, 1.0555555555555556, 1.0123717137635315, 1.278301886792453, 1.0, 1.003421034069267, 1.0134426229508198, 1.0930787589498807, 1.1470588235294117, 1.6666666666666667, 1.024852593100937, 1.5, 1.5070422535211268, 1.1538461538461537, 1.1148907961761216, 1.2857142857142858, 1.161764705882353, 1.1142557651991614, 1.0, 1.1997354497354498, 1.0152722443559097, 2.0, 1.0, 1.08130081300813, 1.0545454545454545, 1.0716409036860879, 1.0236305048335124, 1.0738255033557047, 1.0303951367781155, 1.089150378938971, 1.0467532467532468, 1.467065868263473, 1.2760416666666667, 1.2692307692307692, 1.0, 1.1069042316258353, 1.204906204906205, 1.110091743119266, 1.4078179696616102, 1.0151247659897153, 1.1858172723260263, 1.0271025405389382, 1.0221226142278774, 1.0661853188929, 1.0280429594272076, 1.375, 1.0, 1.0303030303030303, 1.0511662784390057, 1.1680412371134021, 1.0065359477124183, 1.0738916256157636, 1.0835433371515846, 1.0429310898106678, 1.004167339883607, 1.0769230769230769, 1.1578947368421053, 1.0407105847520355, 1.0680010604453871, 1.0356610534995085, 1.0278882882406588, 1.144736842105263, 1.080256940342587, 1.0031681315630336, 1.0469168900804289, 1.0325972660357519, 1.1111111111111112, 1.0567748091603053, 1.1458064516129032, 1.0576923076923077, 1.180064308681672, 1.0347890451517394, 1.0, 1.0631067961165048, 1.0475190160768435, 1.1851851851851851, 1.0137399597194692, 1.1790254237288136, 1.069767441860465, 1.0480257817516567, 1.0005767844268205, 1.1426940639269407, 1.0365974282888228, 1.130533484676504, 1.0094116321009918, 1.161825726141079, 1.0714285714285714, 1.0, 1.25, 1.0264018408622986, 1.8333333333333333, 1.0235622105310491, 1.0621129718378117, 1.0968099246787772, 1.0703656462585034, 1.0015030535219815, 1.1636655948553054, 1.0528301886792453, 1.0069832402234637, 1.0309108413365582, 1.0609383158051764, 1.0072621815305707, 1.0311723795330352, 1.25, 1.0625, 1.2648221343873518, 1.0469226302801569, 1.0488599348534202, 1.0021128248468203, 1.1221238938053097, 1.0331384015594542, 1.0309600554283649, 1.0612535612535612, 1.0013277511961722, 1.3125, 1.0054956431203894, 1.0124153685709083, 1.0258794985847148, 1.0008428150021071, 1.032258064516129, 1.038932146829811, 1.2139303482587065, 1.625, 1.0374194903388407, 1.3076923076923077, 1.0756048387096775, 1.0417582417582418, 1.24409979770735, 1.0173429870348543, 1.0752941176470587, 1.375, 1.103448275862069, 1.0163425125923746, 1.0272991375915346, 1.0051062871160117, 1.0762650835192245, 1.029371900965594, 1.0769230769230769, 1.069198312236287, 1.130271583130934, 1.1417027545872585, 1.027806385169928, 1.2083333333333333, 1.0427832628114715, 1.0287802649611695, 1.1532663316582914, 1.0049201779638839, 1.0, 1.3333333333333333, 1.005577393755099, 1.012804277472914, 1.0136655635584972, 1.0784313725490196, 1.0790103750997606, 1.113861386138614, 1.0031939719958864, 1.0812785388127855, 1.0275735294117647, 1.2756756756756757, 1.0217086834733893, 1.008289822078147, 1.0, 1.75, 1.017483878433394, 1.0032675213911888, 1.0138728323699422, 1.2846715328467153, 1.0166545981173063, 1.0123681876416675, 1.0076487252124646, 1.0256410256410255, 1.1923076923076923, 1.1543126684636118, 1.0042105263157894, 1.109375, 1.5357142857142858, 1.042049390993407, 1.0188305252725471, 1.0874661857529306, 1.1714285714285715, 1.0411743070184238, 1.112868747327918, 1.014945652173913, 1.0088136264606853, 1.6666666666666667, 1.12, 1.3333333333333333, 1.0501097293343087, 1.4230769230769231, 1.3333333333333333, 1.3636363636363635, 1.329225352112676, 1.0147058823529411, 1.0336322869955157, 1.0288537160833662, 1.1802575107296138, 1.3970588235294117, 1.0, 1.032258064516129, 1.2972972972972974, 1.627906976744186, 1.0482866043613708, 1.0068653208431546, 1.0078154214344477, 1.0390625, 1.0205644802801201, 1.0010760222211101, 5.0, 1.00735769453234, 1.1828571428571428, 1.0, 1.3333333333333333, 1.06301775147929, 1.1339740371512588, 1.076946895804304, 1.062111801242236, 1.0, 1.1072961373390557, 1.1932515337423313, 2.0, 1.5, 1.0907972440944882, 1.0394019840715383, 1.1654288626765692, 1.25, 1.0185246967874124, 1.0728117738187453, 1.1142857142857143, 1.1428571428571428, 1.109375, 1.0022453630563828, 1.5394736842105263, 1.1222127452174973, 1.0470301553457204, 1.068235294117647, 1.0078740157480315, 1.0217906336088154, 1.1818958155422716, 1.128099173553719, 1.2105263157894737, 1.0476775662785203, 1.0735294117647058, 1.066697694003967, 1.2748091603053435, 1.186046511627907, 1.164179104477612, 1.0580474934036939, 1.0379436964504285, 1.0122148356200367, 1.0314963119905765, 1.0709606986899562, 3.0, 1.25, 1.0253787636642588, 1.1372031662269129, 1.3524606107761137, 1.004846586424625, 1.044990801137314, 1.0827946807196673, 1.0839002267573696, 1.125, 1.0077636061158204, 1.0379050401441565, 1.0813199764289922, 1.052539404553415, 2.5, 1.04, 1.025606221798305, 1.0640382317801673, 1.064743302273822, 1.0424277750868176, 1.1342329545454546, 1.6, 1.009433962264151, 1.0316389451409589, 1.0319853781128627, 1.0115384615384615, 1.033447766175559, 1.162962962962963, 1.4358161648177497, 1.0817391304347825, 1.0031781743518053, 1.0562866797083408, 1.1370967741935485, 1.1113956466069141, 1.03125, 1.072453861927546, 1.0120270145249328, 1.0330250990752972, 1.0577193162744494, 1.0339470655926353, 1.046714172604909, 1.2857142857142858, 1.070063694267516, 2.5, 1.5, 1.4166666666666667, 1.0383631713554988, 1.1350710900473933, 1.0460470125143897, 1.0418551179277862, 1.2103120759837178, 1.0242677824267783, 1.125, 1.6326530612244898, 1.001725625539258, 1.6, 1.25, 1.0526829268292683, 1.0, 1.0488826815642458, 1.1484098939929328, 1.0940735627650133, 1.0016094420600858, 1.25, 1.0524600847181493, 1.253875968992248, 1.281296758104738, 1.0008126087495466, 1.076086956521739, 1.0365637202697906, 1.0228051306564692, 1.0968427264679848, 1.1033386327503976, 1.7317073170731707, 1.2569832402234637, 1.0, 1.0, 1.0007823396874218, 1.6666666666666667, 1.5714285714285714, 1.4594594594594594, 1.0265379975874547, 1.0444444444444445, 1.0261660978384528, 1.0893162393162392, 1.0, 1.2209807572936064, 1.0251497005988024, 1.1659192825112108, 1.0240384615384615, 1.25, 1.0194518125552607, 1.0349223946784922, 1.0864978902953586, 1.0319821494979546, 1.001152032722907, 1.1684816753926701, 1.0422318125770653, 1.0, 1.1465922871695367, 1.0009504355725456, 1.0013019079685745, 1.2695652173913043, 1.0478900191358647]
origin-bjaq_15.87 	max: 5.0000	99th: 2.6667	95th: 1.5714	median: 1.0602	mean: 1.1482

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 19.746815 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=naru', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[0.0000000e+00 1.1920929e-07 0.0000000e+00 0.0000000e+00 0.0000000e+00]
Distance score: 2.3841858265427618e-08
SAUCE Drift detection: False
Detection latency: 0.0233s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 2.046085 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 7.0000	99th: 2.5000	95th: 1.6667	median: 1.0680	mean: 1.1669
ReportEsts: [1.1597633136094674, 1.0672365988909427, 1.0505496731074726, 1.0396039603960396, 1.0588235294117647, 1.0, 1.2321541710665258, 1.0196859219630448, 1.2, 1.0377777777777777, 1.1128250647730544, 1.0016647166731667, 1.0474788369525212, 1.0174081237911026, 1.029023746701847, 1.509090909090909, 1.0974025974025974, 1.2352941176470589, 1.5555555555555556, 1.095367847411444, 1.0503737073820005, 1.0615556974881422, 1.3617021276595744, 1.0604982206405693, 1.0318916400903, 1.0083211047305607, 2.0, 1.0381516906910953, 1.4, 1.6, 1.0181311018131103, 1.0, 1.0020487749738605, 1.0116291289559416, 1.4700776610324349, 1.0213483146067415, 1.0290448233036016, 1.040767386091127, 1.0, 1.0298075787982528, 1.1042262147815436, 1.0205371527716305, 1.0884955752212389, 1.0068230277185501, 1.0697247706422017, 1.0540169911030839, 1.173913043478261, 2.1785714285714284, 1.116591928251121, 1.1462480857580397, 1.1818181818181819, 1.0142348754448398, 1.1121076233183858, 1.0, 1.0506518002101042, 1.0413728062981795, 1.0434022720652492, 1.1133333333333333, 1.072289156626506, 1.0139443182657106, 1.0769230769230769, 1.0182625400213448, 1.0842857142857143, 1.0566037735849056, 1.0636363636363637, 1.2, 1.1993833208460607, 1.037099140641375, 1.2857142857142858, 1.0, 1.1405199858507251, 1.0265225933202358, 1.0706337687469762, 1.150093808630394, 1.054130092279991, 1.0874940561103186, 1.0244645987348526, 1.0909090909090908, 1.1205673758865249, 1.0052133616528287, 1.2421875, 1.6153846153846154, 1.0, 1.125, 1.0526932084309133, 1.0819672131147542, 1.0911016949152543, 1.3333333333333333, 2.5, 1.02109846483856, 1.0882113158323823, 1.013957597173145, 1.0363887487051449, 1.154819341696151, 1.0102564102564102, 1.283062645011601, 1.0714285714285714, 1.2718954248366012, 2.0, 1.1858161648177497, 1.2666666666666666, 2.0, 1.0152747110014289, 1.100511073253833, 1.0475836431226766, 1.018642447418738, 1.1282051282051282, 1.0115315211498521, 1.0927536231884059, 1.0030138018425288, 1.1104815864022664, 1.0363157894736843, 1.125, 1.3333333333333333, 1.1231237763758972, 1.0128723168465381, 1.0467185761957731, 1.021978021978022, 1.0029095083524662, 2.0, 1.1973518284993694, 1.1583531274742676, 1.0, 1.242152466367713, 1.2857142857142858, 1.0105263157894737, 1.0234281031107757, 1.0762256330548539, 1.0078740157480315, 1.8333333333333333, 1.2325741890959283, 1.0, 1.3333333333333333, 1.008828175820091, 1.0769230769230769, 1.052511415525114, 1.062701532233389, 1.067541624489511, 3.0, 1.3333333333333333, 1.090721649484536, 1.1267291387773315, 1.0528281750266808, 1.0647757372118387, 1.350785340314136, 1.082573726541555, 1.0553240592345663, 1.5, 1.0165321030372934, 1.0404738400789733, 1.0486656200941915, 1.0292825768667642, 1.6666666666666667, 1.010989010989011, 1.0756620428751575, 1.0, 1.305084745762712, 1.0, 1.0394605394605394, 1.042710692851972, 1.116860748118471, 1.163751987281399, 1.1355932203389831, 1.0363636363636364, 1.1341463414634145, 1.1268965517241378, 1.5714285714285714, 1.0150113854652507, 1.3255813953488371, 1.0608591885441527, 1.0036080772923668, 1.2702702702702702, 1.0752480581870425, 1.0, 1.0086206896551724, 1.162212655348875, 1.0313331362695832, 1.1528239202657806, 1.0048309178743962, 1.0135480572597138, 1.0179446950382427, 1.0112742695168475, 1.0245398773006136, 1.3142857142857143, 1.0121795701110763, 1.037420511984347, 1.0592592592592593, 1.3514421730607673, 1.2492753623188406, 3.0, 1.1044776119402986, 1.0217728726029456, 1.0333333333333334, 1.0264797507788161, 1.0217495909922047, 1.0093071982752075, 1.0131549603180503, 1.0198807157057654, 1.01406691134952, 1.0531088982403511, 1.0680537494581708, 1.063038953315492, 1.0681240467717337, 1.0041402815992073, 1.1738903394255875, 1.1194187582562747, 1.3376623376623376, 1.0389610389610389, 1.05, 1.0, 1.0217391304347827, 1.009656162327918, 1.6598837209302326, 1.0909090909090908, 1.0044733631557543, 1.0833333333333333, 1.005571510824108, 1.045045045045045, 1.038185662755504, 1.6666666666666667, 1.0244798041615668, 1.0578465063001146, 1.0281631038162264, 1.0603951253665616, 1.5, 1.151702786377709, 1.0163249934503538, 1.0282029337420138, 1.032171581769437, 1.2409240924092408, 1.0482352941176472, 1.0742801047120418, 1.0598290598290598, 1.0022919913072037, 1.0406799956945267, 1.1514084507042253, 1.2606800348735832, 1.0079455164585698, 1.5, 1.1658831430490262, 1.0, 1.0498969072164948, 1.0550241456166418, 1.0761737775180207, 1.3671641791044775, 1.0769230769230769, 2.0, 1.1429409091575413, 1.1194029850746268, 1.1083113729902585, 1.5, 1.055591054313099, 1.1081349206349207, 1.4285714285714286, 1.0190924009088613, 1.087248322147651, 1.147, 1.2278481012658229, 1.0107028184088476, 1.0680969024948777, 1.2461538461538462, 2.0, 1.0158049732517818, 1.1386053936940532, 1.1197080291970802, 1.0453824703373613, 1.0802241962774957, 1.041039886039886, 1.1127418278852568, 1.0398727589896946, 1.0753768844221105, 1.1854241010156465, 1.2668481078278901, 1.2, 1.0581754870470987, 1.1393298059964727, 1.2692307692307692, 1.037037037037037, 1.0987454471873734, 1.1441281138790036, 1.058771990104453, 1.0044847762867455, 1.02, 1.233502538071066, 1.0344083539489068, 1.0514492753623188, 1.0893462165892835, 1.0075968745298964, 1.5833333333333333, 1.1758241758241759, 1.020310633213859, 1.0448257515296622, 1.0033369433159431, 1.0462345056469897, 1.0996329313057158, 1.0060941828254848, 1.006294256490952, 1.1240041169519308, 1.0176970354302242, 1.0281368923915684, 1.0775193798449612, 1.375, 1.25, 1.0820859488169967, 1.3636363636363635, 1.0652985074626866, 1.0150234077428333, 1.005498446091322, 1.2058823529411764, 1.2222222222222223, 1.1779179810725553, 1.0987997912680467, 1.0443873825753307, 1.0909090909090908, 1.001649193073389, 1.0075584617820945, 1.1915492957746479, 1.7692307692307692, 2.4, 1.0771184483952898, 1.5, 1.0206974406355631, 1.0885093167701863, 1.2, 1.0454686419046255, 1.1538461538461537, 2.111111111111111, 1.0411754348639468, 2.0, 1.2780082987551866, 1.0443645083932853, 1.1803603311150788, 1.0745501285347043, 1.055187637969095, 1.125, 1.0089313800386466, 1.0141598787649175, 1.1063829787234043, 1.0069476003580526, 1.1422780435938331, 3.0, 1.4166666666666667, 1.028200563424368, 1.25, 1.0560875512995895, 1.1, 1.0, 1.0384615384615385, 1.1298578199052132, 1.1112006446414182, 1.2619047619047619, 1.1186868686868687, 1.2025316455696202, 2.0, 1.0336814639244267, 1.4761904761904763, 1.11864406779661, 1.0203353638762915, 1.206405693950178, 1.058540497193264, 1.037313432835821, 1.5, 1.0, 1.137214137214137, 1.079268292682927, 1.165903890160183, 1.0146035069353572, 1.0686833622613439, 1.0527638190954773, 1.0, 1.0059935818605577, 1.3614457831325302, 1.3, 1.3333333333333333, 1.1042724196277496, 1.1111111111111112, 1.3785310734463276, 1.0731707317073171, 1.0845708532595015, 1.000290906975222, 1.0293983591613491, 1.051622418879056, 1.0472991883571228, 1.0684931506849316, 1.0, 1.0182971872336395, 1.0645645645645645, 1.0, 1.0008928487070228, 1.0147870101802878, 1.0325274725274725, 1.0432692307692308, 1.1395348837209303, 1.0071428571428571, 2.0, 1.9259259259259258, 1.0357142857142858, 1.041015625, 1.736842105263158, 1.1337579617834395, 1.0737913486005088, 1.074973600844773, 1.0234895962421366, 1.1254811393379522, 1.0627072084872597, 1.0303030303030303, 1.0852713178294573, 1.0248756218905473, 1.0, 1.003078033667873, 1.4210526315789473, 1.0043781019418392, 1.000901725390972, 1.0040875210387112, 1.0147137506688069, 1.8571428571428572, 1.2259771986970684, 1.0, 1.0694227769110765, 1.0, 1.1076397567274847, 1.0265700483091786, 1.0157890015250741, 1.1885521885521886, 1.0381944444444444, 3.0, 1.116698551516808, 1.0047860680668381, 1.1044793239910529, 1.5, 1.2857142857142858, 1.0080192461908581, 1.1850961538461537, 1.08648393194707, 1.0174337066045267, 1.16, 1.071377072819034, 1.0718624664148593, 1.0131464445549478, 1.000282748904348, 1.0821063675055735, 1.054951690821256, 2.0, 1.1910896403650026, 1.0118778619848428, 1.6535433070866141, 1.0123655913978495, 1.0, 2.0, 1.2434036939313984, 1.1153846153846154, 1.1915540540540541, 1.0196204567385012, 1.119515011547344, 1.0, 1.0625, 1.121212121212121, 1.0120639461384537, 1.125, 2.0, 1.1901850276478094, 1.0, 2.0, 1.107865168539326, 1.75, 1.186936936936937, 1.0045283018867925, 1.349809885931559, 1.0909090909090908, 1.017881440961007, 1.0504549214226633, 1.1111111111111112, 1.0689165746727645, 1.0518518518518518, 1.0451541850220265, 1.1428571428571428, 1.1031652989449003, 1.1788551737340864, 1.0, 1.1176470588235294, 1.1306492467670977, 1.1045296167247387, 1.087313432835821, 1.0, 1.0500386398763524, 1.0306480674714287, 1.0283718900043648, 2.0, 1.1157299634186897, 1.0792083092223346, 1.025666213289003, 1.185227024269368, 1.0477858488845664, 1.0269197370053342, 1.0035663338088445, 1.0381727158948686, 1.5, 1.1079606943422362, 1.006896551724138, 1.0409002904162634, 1.0976017847183492, 1.0502645502645502, 1.0419434194341943, 1.4285714285714286, 1.0112451803495102, 1.297029702970297, 1.0158002378121285, 1.0957161981258368, 1.0017655103816985, 1.1861897963783905, 1.130952380952381, 1.2125, 1.0136099425158163, 1.041407867494824, 1.0275331593824744, 1.0080258475369919, 1.3333333333333333, 1.2441993153290225, 1.0342857142857143, 1.0, 1.1063829787234043, 1.0056264860329656, 1.103942652329749, 1.1160666308436324, 2.0, 1.0344827586206897, 1.0359678182678655, 1.034511353811952, 1.036241610738255, 1.0050508925374662, 1.0408609996351696, 1.0396039603960396, 1.0787187839305103, 1.0713399990582178, 1.2411347517730495, 1.0186873821367872, 1.1352739726027397, 1.0495495495495495, 1.0089046373321153, 1.0815888352120235, 1.0541364178134143, 1.5, 1.0242990654205608, 1.4104234527687296, 1.0071119691880337, 1.0121951219512195, 1.0960960960960962, 1.2287145242070117, 1.117117117117117, 1.0035377007917712, 1.0, 1.8181818181818181, 1.8333333333333333, 1.0, 1.0285714285714285, 1.5, 1.3519163763066202, 1.0126050420168067, 1.0274666666666668, 1.125674633770239, 1.0082254817371297, 1.0087603849633955, 1.009783876590781, 1.00215017698532, 1.0279136212624584, 1.0678947368421052, 1.1561482892752242, 1.0082277033452505, 1.0545808966861598, 1.022099447513812, 1.1684073107049608, 1.0168539325842696, 1.052714620924023, 1.263959390862944, 1.0176227297248697, 1.051643192488263, 1.1954779622209502, 1.3742331288343559, 1.6666666666666667, 1.050647820965842, 1.0625, 1.5, 1.459214501510574, 1.0226028884380123, 1.0188824662813103, 1.009478672985782, 1.1235294117647059, 1.0441065655460755, 1.1187565036420395, 1.0126811594202898, 1.0, 2.0, 1.1088027541995606, 1.2599118942731278, 1.0097284150790433, 1.0009350163627864, 1.0, 1.1024917724494594, 1.1073170731707318, 1.0526066195709052, 1.213967310549777, 1.0102843543710867, 1.0232493171095107, 1.0109367155502709, 1.3157894736842106, 3.0, 1.0699019607843137, 1.0, 1.1061173533083646, 1.1483050847457628, 1.075357950263753, 1.278688524590164, 1.3103448275862069, 1.0253618377373523, 1.1231884057971016, 1.0359848484848484, 1.137257963772642, 1.0737327188940091, 1.0276497695852536, 1.0616520351157224, 1.0263157894736843, 1.0022705157314304, 1.1666666666666667, 1.101620526671168, 1.1092091627059286, 1.2, 1.0363147276395428, 1.0341755749919015, 1.1818181818181819, 1.085020864569973, 1.2, 1.1864754098360655, 1.016220519454672, 1.6839622641509433, 1.1942446043165467, 1.041052246731315, 1.2616822429906542, 2.142857142857143, 1.0438095238095237, 1.0562364816149965, 1.01908913908406, 1.0223017621145374, 1.0352803895392948, 1.1534090909090908, 1.2283105022831051, 1.0319488817891374, 1.0869565217391304, 1.0176120524511691, 1.0881427072402938, 1.0327868852459017, 1.19573727707699, 1.0085146407267147, 1.4883720930232558, 1.1034171035979028, 1.1304347826086956, 1.6, 1.058139534883721, 1.0165410770079029, 1.0294847920546244, 1.070446735395189, 1.5555555555555556, 1.0197160883280758, 1.0927871148459383, 1.5135135135135136, 1.0308382513197187, 2.3333333333333335, 1.0841478963025923, 1.5, 1.3922651933701657, 1.3076923076923077, 1.0715660542432195, 1.2121212121212122, 1.0980392156862746, 1.1149122807017544, 1.0, 1.0472143531633618, 1.081823495032145, 1.8, 1.0, 1.0268456375838926, 1.0634441087613293, 1.0148184736972092, 1.005323868677906, 1.0118577075098814, 1.0776495278069256, 1.1253481894150419, 1.0317145688800793, 1.4572864321608041, 1.2801724137931034, 1.3448275862068966, 1.0, 1.0375, 1.2019002375296912, 1.094569288389513, 1.1440434997528424, 1.0119274503720557, 1.236490809058728, 1.024195093017652, 1.0412180771156736, 1.0838383838383838, 1.003463631865413, 1.2, 1.5, 1.0512820512820513, 1.0679755347548407, 1.14419795221843, 1.010958904109589, 1.4045584045584045, 1.0871548011147707, 1.0072670849054497, 1.0065365998424052, 1.065934065934066, 1.0434782608695652, 1.060077519379845, 1.0921546961325967, 1.0289155361968985, 1.0462920110192837, 1.1933701657458564, 1.0869805414032288, 1.0380708810102763, 1.0102375834816273, 1.0454545454545454, 1.0215042576349318, 1.2529182879377432, 1.0464662241311988, 1.2035928143712575, 1.0083986313341529, 3.0, 1.0350801212646168, 1.0, 1.0714285714285714, 1.0373884006538778, 1.2131147540983607, 1.001580198387932, 1.159330985915493, 1.1, 1.0275154294487823, 1.0112781954887218, 1.1121374986003807, 1.002388535031847, 1.0405539070227499, 1.0084071108188715, 1.1827586206896552, 1.1176470588235294, 1.0, 1.0, 1.0151200532225872, 2.1666666666666665, 1.1238745731139397, 1.05762901600806, 1.1534781008465218, 1.0836018617973506, 1.0178212565881772, 1.0746791131855309, 1.060702875399361, 1.0093567251461988, 1.0021414703978977, 1.0862979698338955, 1.005913755074641, 1.0601296026523332, 1.3, 1.2714570858283434, 1.3933333333333333, 1.015580920966972, 1.02710027100271, 1.0024385995471172, 1.1114285714285714, 1.0459016393442624, 1.0442471121062542, 1.0817535545023698, 1.014771183519536, 1.3157894736842106, 1.0219941780117028, 1.003462522675385, 1.208187134502924, 1.0028178936245156, 1.1081081081081081, 1.6451612903225807, 1.0372832433141632, 1.0963320561078946, 1.2857142857142858, 1.0047606505401887, 1.0263157894736843, 1.1480911080489584, 1.2495238095238095, 1.1411917098445596, 1.185501066098081, 1.1569343065693432, 1.1725118483412322, 1.0867537313432836, 1.0557549943430722, 1.0415458937198068, 1.1727824778118026, 1.0315669531700593, 1.0714285714285714, 1.0356164383561643, 1.1226691042047532, 1.0252659574468086, 1.0333041191936898, 1.1026970954356847, 1.3090349075975358, 1.0142938822184104, 1.0835443037974684, 1.0048889953603435, 1.0677966101694916, 1.044431279620853, 1.0261348919071498, 1.0245851259987708, 1.578369905956113, 1.0050212578800761, 1.0059755376427748, 1.0419397116644824, 1.0938775510204082, 1.0075588599752168, 1.0837873174983657, 1.0363924050632911, 1.1946902654867257, 1.0011702750146285, 1.0026250472406362, 1.0515463917525774, 2.25, 1.0327022987687708, 1.0080871315700672, 1.0174334140435835, 1.2621951219512195, 1.014362657091562, 1.0058400116567099, 1.005885122410546, 1.1164095371669005, 1.21875, 1.130459444129325, 1.2857142857142858, 1.1367292225201073, 1.6666666666666667, 1.04009796344064, 1.0198675496688743, 1.4, 1.1395348837209303, 1.0835030549898168, 1.0512697652132248, 1.06, 1.2692307692307692, 1.0269423558897244, 1.1076233183856503, 1.0444976076555024, 1.3, 1.051393015767841, 1.004040404040404, 1.185938566552901, 1.0495867768595042, 1.174721189591078, 1.0566637756577046, 1.0572573545037798, 1.0133917927252496, 1.035658914728682, 1.3875, 1.0555555555555556, 1.0526315789473684, 1.2988505747126438, 1.4655172413793103, 1.077172503242542, 1.018323649302975, 1.0028676657510804, 1.1232876712328768, 1.0097552833924215, 1.0012886436712582, 7.0, 1.011436176923271, 1.2603734439834025, 1.0, 1.1428571428571428, 1.05813097866078, 1.1243887895050686, 1.0731716987490831, 1.0155844155844156, 1.5, 1.0511945392491469, 1.5276381909547738, 1.5, 1.0154378915646727, 1.0242795645855611, 1.0229259020597692, 1.136987923277291, 1.7, 1.0165846597507813, 1.0656370656370657, 1.0970695970695972, 1.4318181818181819, 1.0736842105263158, 1.0, 1.1758241758241759, 1.093398144933287, 1.0994728969299807, 1.0787486515641855, 1.0536912751677852, 1.0102755453501722, 1.1657263751763047, 1.1371841155234657, 1.082191780821918, 1.0291318811936898, 1.013583903584925, 1.042497807726035, 1.3846153846153846, 1.2323232323232323, 1.1304347826086956, 1.1111111111111112, 1.0312317571511966, 1.0142857142857142, 1.0012300700250707, 1.018018018018018, 1.5, 1.1381195335276968, 1.0081844333697987, 1.1321441572624682, 1.2435959400676655, 1.04015542170415, 1.0220516399162596, 1.099108821276892, 1.0875, 1.1481481481481481, 1.0607822776047076, 1.0102982433423973, 1.0778967867575462, 1.181159420289855, 2.5, 1.0224719101123596, 1.0364300162810203, 1.2712609970674487, 1.004226652621175, 1.0233991139750303, 1.0950974601299468, 2.0, 1.0243190661478598, 1.037245316885944, 1.0358090185676392, 1.3941368078175895, 1.0520620296646348, 1.1415384615384616, 1.284198113207547, 1.1259578544061302, 1.0025582036802974, 1.0139558924879393, 1.0798076923076922, 1.1194029850746268, 1.0256410256410255, 1.0517229129662522, 1.0669251964486173, 1.0186970458905824, 1.0654932460090054, 1.0248091603053435, 1.0408432147562583, 1.1380753138075315, 1.1377459749552772, 2.5, 1.0, 1.1875, 1.0339702760084926, 1.1412541254125412, 1.0323349955090284, 1.0450806235283598, 1.0175600739371533, 1.0108521615370931, 1.0863636363636364, 1.1528998242530755, 1.0085757227477676, 1.8, 1.3571428571428572, 1.162948857453754, 1.0, 1.116851168511685, 1.1183673469387756, 1.0432656132430398, 1.0102202107538503, 1.0, 1.0850180005538632, 4.0, 1.0148082137236685, 1.000370890097999, 1.091743119266055, 1.0461997019374067, 1.0302609568417531, 1.1208057062487442, 1.0273794002607561, 1.2769230769230768, 1.2777777777777777, 1.0, 3.0, 1.0004208958003538, 1.25, 1.625, 1.5227272727272727, 1.0151362260343089, 1.047459559609492, 1.1236593059936908, 1.0241935483870968, 1.1428571428571428, 1.0269793791969575, 1.026946107784431, 1.368421052631579, 1.028688524590164]
origin-bjaq_15.87 	max: 7.0000	99th: 2.5000	95th: 1.6667	median: 1.0680	mean: 1.1669

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 16.123993 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=37.949859