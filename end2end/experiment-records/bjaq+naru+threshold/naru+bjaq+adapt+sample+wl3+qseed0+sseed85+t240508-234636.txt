Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='naru', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 85, 'naru': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.5458	median: 1.0581	mean: 1.1499
ReportEsts: [1.1623616236162362, 1.0672595886603669, 1.0364356079348658, 1.001923076923077, 1.0, 1.0, 1.1567496879272425, 1.0238153009417161, 1.25, 1.0345285524568393, 1.047008916976885, 1.0023617816067047, 1.0093259855871133, 1.0023255813953489, 1.0307311903920875, 1.0, 1.5517241379310345, 1.0219624512929508, 3.0, 2.6666666666666665, 1.125, 1.0668104377830494, 1.0779440401762836, 1.1022653721682847, 1.0305870744943266, 1.0, 1.0451934999673693, 1.5, 1.4, 1.2949640287769784, 1.0, 1.0031836496547875, 1.0035774144460872, 1.3590455049944505, 1.016889411073579, 1.018820662108185, 1.0685714285714285, 1.0115591318615458, 1.094978993043598, 1.1547619047619047, 1.1386861313868613, 1.1158536585365855, 1.0, 1.1923281301893058, 1.0780502853617153, 1.1983471074380165, 1.087378640776699, 1.2304347826086957, 1.026069978848649, 1.0188679245283019, 1.102141601021416, 1.1757575757575758, 1.0056385590425845, 1.0, 1.174025974025974, 1.0991298359834731, 1.0072727272727273, 1.0687022900763359, 1.391304347826087, 1.25, 1.0201290439840058, 1.0473225404732254, 1.0772727272727274, 1.103448275862069, 1.0, 1.1012772143574123, 1.155656365182875, 1.1666666666666667, 1.0, 1.040547094771559, 1.005966587112172, 1.0572254335260116, 1.1036036036036037, 1.0620805369127517, 1.1929411764705882, 1.1587982832618027, 1.0, 1.0495179666958807, 2.0, 1.0710780797153434, 1.1875, 1.0427557838379002, 1.2147239263803682, 1.0309633027522935, 1.0703781512605042, 1.04, 1.009503505095035, 1.0448872933304028, 1.1911764705882353, 2.3333333333333335, 1.1402439024390243, 1.016310709307045, 1.0456026058631922, 1.343618513323983, 1.2372881355932204, 1.0519125683060109, 1.1842105263157894, 1.0008539709649873, 1.0, 1.0034799678772195, 1.1650107991360692, 1.0147954743255005, 1.0041101229493676, 1.1176470588235294, 1.0044621393758661, 1.1184679334916865, 1.0338217789270616, 1.0341296928327646, 1.0283732660781841, 1.1666666666666667, 1.3333333333333333, 1.1382978723404256, 1.0053249660162917, 1.0805460750853242, 1.0649350649350648, 1.0069117446217244, 1.0, 1.2734939759036144, 1.141626794258373, 1.0, 1.1868131868131868, 1.0, 1.1152882205513786, 1.0248207508126788, 1.053195620097849, 1.0566037735849056, 1.8, 1.2044701986754967, 1.0, 1.1785714285714286, 1.0133522814407379, 1.1818181818181819, 1.0101940151266031, 1.001482160688828, 1.1012592720372607, 1.1452599388379205, 1.0252808988764044, 1.074089577228966, 1.00199203187251, 1.0532734274711169, 1.0434206245933637, 1.1604938271604939, 1.0567514677103718, 1.0742992364815396, 2.0, 1.0157407407407408, 1.0670731707317074, 1.0527295285359801, 1.0277042526910183, 1.0, 1.0514652458222329, 1.0207407407407407, 1.02, 1.4476190476190476, 1.3343065693430658, 1.0703717069649945, 1.0265655164912852, 1.0773288844801154, 1.1577946768060836, 1.180921052631579, 1.0425531914893618, 1.2246376811594204, 1.1411764705882352, 1.1428571428571428, 1.0138590669529572, 1.0208312682521408, 1.0132412204951065, 1.0214426372985195, 1.0024434941967013, 1.1285415175850098, 1.0273684210526315, 1.0525210084033614, 1.2105161227849326, 1.1124859392575928, 1.1718907987866531, 1.0446700507614213, 1.0620778385332905, 1.032116844878351, 1.0466838960312104, 1.1666666666666667, 1.2352941176470589, 1.016934557979334, 1.0482758620689656, 1.1659267480577136, 1.1515151515151516, 1.0414145640840053, 1.0661885245901639, 1.017812696145272, 1.0740740740740742, 1.0586363636363636, 1.1014047359669743, 1.0, 1.4545454545454546, 1.036514974067258, 1.282633371169126, 1.1004566210045663, 1.4583333333333333, 1.0006430868167202, 1.0014284466413519, 1.0075379834877964, 1.1798245614035088, 1.0813745124907768, 1.3208955223880596, 1.0, 1.0357142857142858, 1.0, 1.0596026490066226, 1.045812963255007, 1.6341463414634145, 1.160919540229885, 1.0182896688087, 1.0957683741648108, 1.0946308347242277, 1.0154255909444012, 1.0428654932779113, 1.0, 1.0130057803468209, 1.0457472043375127, 1.0188839106209433, 1.0290870488322719, 1.0, 1.1026915113871636, 1.0260571563626337, 1.002393107355477, 1.0545863815419245, 1.0497606346601012, 1.0054136355946541, 1.0344827586206897, 1.0034341215885816, 1.1567486950037285, 1.1900733220530175, 1.0607734806629834, 1.0114084214893175, 1.0237623762376238, 1.1196850393700788, 1.0, 1.04820415879017, 1.0804488610987049, 1.0178152836380685, 1.3246268656716418, 1.0909090909090908, 2.6666666666666665, 1.1010886196162573, 1.1454545454545455, 1.0691405446189726, 2.0, 1.5, 1.2903225806451613, 1.0106508875739646, 1.530612244897959, 1.1657458563535912, 1.1394230769230769, 1.087260034904014, 1.012324691882703, 1.0752851552743319, 1.0175438596491229, 1.0, 1.005119980260317, 1.0838479484012624, 1.0805604203152364, 1.016451700566507, 1.045486869507797, 1.0336865304738492, 1.102543720190779, 1.0186961956234706, 1.0645933014354068, 1.1205419716555054, 1.2853985793212312, 1.6363636363636365, 1.08577983855468, 1.004264392324094, 1.2727272727272727, 1.0416666666666667, 1.1116363636363635, 1.0555555555555556, 1.1359223300970873, 1.0436713545521836, 1.1977715877437325, 1.2164634146341464, 1.0133024221616584, 1.0511463844797178, 1.0015647122649625, 1.0156789710774716, 1.5, 1.0517824663514006, 1.2, 1.0262387787302714, 1.0043383947939262, 1.0211232988939967, 1.3, 1.1111111111111112, 1.0, 1.5774647887323943, 1.015920342728743, 1.0, 1.1024464831804281, 1.025522041763341, 1.0376602564102564, 1.0018271323332597, 1.1666666666666667, 1.050314465408805, 1.0046002384000707, 1.0786510496237198, 1.0801727861771058, 1.1282051282051282, 1.0, 1.3007159904534606, 1.0099502487562189, 1.2087227414330217, 1.0108149535893725, 1.0363007778738116, 1.2456140350877194, 1.1016949152542372, 1.008298755186722, 1.02161307327359, 1.5714285714285714, 1.0214527898001593, 1.054945054945055, 1.2105263157894737, 1.0004654091493963, 1.1428571428571428, 1.75, 1.022419373657668, 2.0, 1.0195804195804197, 1.0392441860465116, 1.0065627563576702, 1.0291942390035034, 1.3159268929503916, 1.164835164835165, 1.0166127788525279, 1.0186704315863782, 1.0245231607629428, 1.015776310934361, 1.0998546177978423, 2.0, 1.2222222222222223, 1.0243331499666428, 1.3333333333333333, 1.0492610837438423, 1.0, 1.0, 1.0454545454545454, 1.2266009852216748, 1.0874159462055715, 1.3298969072164948, 1.0844155844155845, 1.0, 1.09254327563249, 1.0368278410840777, 1.5, 1.4877903513996427, 1.0, 1.0165186366051773, 1.2027027027027026, 1.0470742587247441, 1.163594470046083, 1.0018181818181817, 1.195519348268839, 1.0833333333333333, 1.0240759862726638, 1.0050646906384706, 1.0159786950732357, 1.0, 1.1428571428571428, 1.8333333333333333, 1.5, 1.1428571428571428, 1.0023788246034757, 1.25, 1.1913477537437605, 1.0, 1.0134042822754339, 1.007723534373682, 1.0114583333333333, 1.089465356822368, 1.0298685782556751, 1.2708018154311649, 1.5, 1.0300429184549356, 1.0585585585585586, 1.0022849446669704, 1.380952380952381, 3.142857142857143, 1.0846325167037862, 1.0232558139534884, 1.0020904928464354, 1.1333333333333333, 1.342769701606733, 1.0439874321622393, 1.4285714285714286, 1.0808477237048666, 1.016146393972013, 1.25, 1.055306427503737, 1.0982142857142858, 1.030976637303715, 1.0166426672574214, 1.0184489615554573, 1.0465116279069768, 1.121212121212121, 1.056047197640118, 1.0, 1.0271610829273192, 1.0158604119813732, 1.006650884905873, 1.011904332455539, 1.0098489194874738, 1.009300833867864, 1.8333333333333333, 1.0424505547515677, 1.2, 1.0828351836037575, 1.1111111111111112, 1.015026938199304, 1.0144927536231885, 1.0959802235597593, 1.1857707509881423, 1.0229885057471264, 3.0, 1.013959013959014, 1.0040620575204398, 1.0215844235150433, 1.0, 1.3404255319148937, 1.001923076923077, 1.3017241379310345, 1.086237639811963, 1.0769230769230769, 1.105263157894737, 1.088869715271786, 1.1155724869703414, 1.0978686872457168, 1.0003608297323698, 1.1327850877192982, 1.2039800995024876, 1.1704545454545454, 1.3636363636363635, 1.0609137055837563, 1.3448275862068966, 1.03956343792633, 1.03125, 1.0359387897644294, 1.25, 1.0755685548856921, 1.044442051226823, 1.1678674351585014, 1.0, 1.1067961165048543, 1.32, 1.0000778240398458, 1.3391684901531729, 1.0, 1.1142580823431887, 1.0142660809096462, 1.2065, 1.0, 2.0, 1.2166990291262136, 1.0017921146953406, 1.4186046511627908, 1.0, 1.020845702223102, 1.0037914691943128, 1.0869565217391304, 1.03954802259887, 1.0272727272727273, 1.0918635170603674, 1.189516129032258, 1.0164072360117795, 1.064806842316744, 1.0, 1.0675675675675675, 1.0771229124326236, 1.007380116597337, 1.04032169683277, 1.0, 1.057543859649123, 1.020512992343648, 1.029334730225249, 2.0, 1.1100478468899522, 1.0665458311755567, 1.1442479366683511, 1.176401205714036, 1.0196500064288152, 1.193384223918575, 1.0697478991596638, 1.0149253731343284, 2.0, 1.1041397488242286, 1.2131147540983607, 1.2, 1.3310344827586207, 1.1304347826086956, 1.0343974306468648, 1.0729261622607111, 1.080193818452893, 1.104969574036511, 1.0519674050595484, 1.0505883944271608, 1.0061375221054822, 1.0776699029126213, 4.0, 1.0493818269115351, 1.0364372469635628, 1.007600613983532, 1.0192338711648345, 1.105440269209198, 1.1295224312590448, 1.1, 1.4285714285714286, 1.0186372372744745, 1.0335682535295607, 1.0016265572437248, 1.07929203539823, 1.0519536499404143, 1.024742268041237, 1.0006558651346953, 1.0374930050363738, 1.094839609483961, 2.0, 1.0833333333333333, 1.0736196319018405, 1.0680529300567108, 1.011744966442953, 1.033293697978597, 1.096774193548387, 1.24375, 1.0554699537750385, 1.0494505494505495, 1.001426660722247, 1.3780487804878048, 1.0172297667716117, 1.0, 1.0807453416149069, 1.3293650793650793, 1.2836879432624113, 1.0036445192038128, 1.13681592039801, 1.0434782608695652, 1.0791180285343709, 1.0038617401668652, 1.0, 1.851063829787234, 1.3333333333333333, 1.0, 1.0114942528735633, 1.024793388429752, 1.3278688524590163, 1.1256830601092895, 1.0264338353091957, 1.1447543160690572, 1.0443972457264226, 1.011831985801617, 1.0989370400654128, 1.0071645321725304, 1.0451977401129944, 1.075063613231552, 1.1098209966134494, 1.119800332778702, 1.1401734104046244, 1.018966465090709, 1.0142372532894737, 1.1149524101934296, 1.009831576711084, 2.0, 1.0226130653266332, 1.0360443622920517, 1.062937062937063, 1.0, 1.1590909090909092, 1.25, 1.00177304964539, 1.4814814814814814, 1.5, 1.04448025039861, 1.0284343344588591, 1.000924752321581, 1.0437214432015125, 1.0810810810810811, 1.0291616038882139, 2.0, 1.1666666666666667, 1.0883500975829454, 1.0230997092154253, 1.0066114103267003, 1.027394919694726, 1.0066869300911854, 1.0875706214689265, 1.0360959987652891, 1.2060390763765543, 1.0049914930535995, 1.0098458178806078, 1.4242424242424243, 1.1056105610561056, 1.0, 1.0068027210884354, 1.0201762603657056, 3.0, 1.092150866462793, 1.0229920633166052, 1.2857142857142858, 1.1611661856360063, 1.3, 1.1176470588235294, 1.0178328611898018, 1.7692307692307692, 1.0287698053007506, 1.028193079880393, 1.2258064516129032, 1.380952380952381, 1.3547486033519553, 1.0167384026781445, 1.149454453184471, 1.0243782015676108, 1.0096714890896012, 1.0, 1.171301325222681, 1.0182926829268293, 2.0, 1.0784187097815807, 1.0603512414568734, 1.1561021759697256, 1.0101890506300615, 1.0785528418772372, 1.313953488372093, 1.8571428571428572, 1.0631418790414606, 1.0214168039538716, 1.1162676259481106, 1.0250166777851901, 1.01988369479393, 1.1217046147114438, 1.02014652014652, 1.018953752843063, 1.103321033210332, 1.0038776509335292, 1.0555205047318612, 1.0018148820326678, 1.1197478991596639, 1.0465992864593834, 4.0, 1.0024704336399475, 1.0165803520839753, 1.055758906783797, 1.0555555555555556, 1.049402506557855, 1.3349753694581281, 1.0, 1.0086407561543345, 1.0134426229508198, 1.102286401925391, 1.1176470588235294, 1.6666666666666667, 1.0480743064208884, 1.5, 1.4758620689655173, 1.1538461538461537, 1.071453492429, 1.2857142857142858, 1.1560975609756097, 1.1268343815513626, 1.0, 1.2632275132275133, 1.05230557467309, 2.0, 1.0, 1.08130081300813, 1.0661764705882353, 1.0570749108204518, 1.0247311827956989, 1.0578512396694215, 1.0029498525073746, 1.089150378938971, 1.0415584415584416, 1.4848484848484849, 1.09375, 1.1153846153846154, 1.0, 1.0507399577167018, 1.3015873015873016, 1.0254237288135593, 1.1075157773952955, 1.0218383058913332, 1.164123056184103, 1.0206548483680669, 1.0646142005002885, 1.0637785800240673, 1.0011933174224343, 1.1, 1.0, 1.0303030303030303, 1.0499099644638503, 1.1409869083585096, 1.0065359477124183, 1.2848101265822784, 1.0583428789614358, 1.0282546494992848, 1.0066840775942232, 1.064102564102564, 1.1, 1.08660251665433, 1.210432131495228, 1.0323217954796902, 1.0051547073051454, 1.1907894736842106, 1.10875664500886, 1.0183859584095876, 1.1639344262295082, 1.0229166666666667, 1.2222222222222223, 1.0674698795180724, 1.0125427594070695, 1.0576923076923077, 1.2440677966101694, 1.0347890451517394, 1.0, 1.1173469387755102, 1.037552855896369, 1.3148148148148149, 1.0007005309706334, 1.1705508474576272, 1.0465116279069768, 1.0025805982626395, 1.003109857525132, 1.0684595756110664, 1.0076335877862594, 1.0513126491646778, 1.0147373760144274, 1.140529531568228, 1.1428571428571428, 1.0, 1.0, 1.010875620685479, 1.8333333333333333, 1.0207743153918791, 1.0764094556028216, 1.0272485600354453, 1.0715045754415833, 1.0033854265447786, 1.1136120042872455, 1.0488721804511278, 1.0124826629680999, 1.0195646558809026, 1.0497158741482375, 1.0072046593006256, 1.0162168777920568, 1.4285714285714286, 1.078125, 1.33201581027668, 1.0140067837120612, 1.1205211726384365, 1.032883275261324, 1.224778761061947, 1.0019493177387915, 1.0688742445773538, 1.0390516039051605, 1.0114330651503236, 1.3125, 1.0274809968700727, 1.006915360293996, 1.1059285091543156, 1.0008428150021071, 1.15625, 1.1158900836320191, 1.099502487562189, 1.6875, 1.02974184357736, 1.2692307692307692, 1.0598290598290598, 1.043956043956044, 1.177343223196224, 1.0833637358628239, 1.071764705882353, 1.4545454545454546, 1.103448275862069, 1.0060663994999817, 1.0149029867998896, 1.000709754138676, 1.1801810477657935, 1.0281514866137496, 1.0769230769230769, 1.0250809061488673, 1.0156746031746031, 1.1096477521317916, 1.0204498977505112, 1.2013888888888888, 1.0673724735322425, 1.0201302545885138, 1.1305418719211822, 1.0105792118487174, 1.0, 1.3333333333333333, 1.0243912086825384, 1.0457622130665096, 1.0203180212014133, 1.078366710636767, 1.0566640063846768, 1.0112359550561798, 1.0022821576763485, 1.098002848342331, 1.0625, 1.227027027027027, 1.013484740951029, 1.0081401390503997, 1.0238095238095237, 1.75, 1.035634362318375, 1.0046105280646858, 1.040332147093713, 1.2753623188405796, 1.021072088724584, 1.0088725098216458, 1.0122367672168469, 1.08, 1.2307692307692308, 1.1314016172506738, 1.0821052631578947, 1.121875, 1.5357142857142858, 1.0521063806011846, 1.0218037661050545, 1.089430894308943, 1.2058823529411764, 1.0440498879860902, 1.0538461538461539, 1.0107570529734118, 1.0475103734439835, 1.6666666666666667, 1.0, 2.0, 1.0405944182674882, 1.3846153846153846, 1.3333333333333333, 1.5, 1.317626527050611, 1.0018148820326678, 1.0792842676378231, 1.0145576164932464, 1.2222222222222223, 1.3823529411764706, 1.0666666666666667, 1.032258064516129, 1.3513513513513513, 1.2962962962962963, 1.0327102803738317, 1.0154359968391833, 1.0077174457647524, 1.046875, 1.0036519562585913, 1.0009258795856064, 5.0, 1.0080381749515157, 1.247142857142857, 1.0, 1.3333333333333333, 1.1136094674556214, 1.160654091658897, 1.0332868865149405, 1.0372670807453417, 1.0, 1.0310077519379846, 1.2546012269938651, 2.0, 1.5, 1.077509842519685, 1.0383863763260748, 1.1921644570236853, 1.25, 1.0002680024881219, 1.067389620449264, 1.0472610096670247, 1.1428571428571428, 1.097938144329897, 1.0014386457906166, 1.381578947368421, 1.075306479859895, 1.0335765545443611, 1.0167464114832536, 1.0158730158730158, 1.0188186755357218, 1.17933390264731, 1.1115702479338843, 1.3269230769230769, 1.0693841390138856, 1.3390108090402881, 1.078997817005197, 1.8977272727272727, 1.3076923076923077, 1.164179104477612, 1.0268886043533931, 1.0488559059987632, 1.004551488716101, 1.0002529860014413, 1.056768558951965, 3.0, 1.25, 1.0097168062392123, 1.1147757255936674, 1.2639564287103677, 1.02041301924835, 1.024586051179127, 1.0882158225753062, 1.0476190476190477, 1.0833333333333333, 1.0018866441317507, 1.0118962010231967, 1.1084266352386565, 1.381786339754816, 2.5, 1.08, 1.0064932682783667, 1.082437275985663, 1.0179705171203495, 1.0047725930301241, 1.1008522727272727, 2.0, 1.009433962264151, 1.0420597800480356, 1.034726981951108, 1.079847908745247, 1.0040468697849616, 1.2921810699588476, 1.3245614035087718, 1.1020289855072465, 1.0031635662019003, 1.0411042944785276, 1.109447004608295, 1.11651728553137, 1.03125, 1.0417805878332194, 1.007496114818539, 1.0726552179656539, 1.0575023692894416, 1.021603183627061, 1.0200617283950617, 1.2857142857142858, 1.070063694267516, 2.5, 1.5, 1.5454545454545454, 1.0127877237851663, 1.1453396524486572, 1.0417393887630435, 1.0415024076474544, 1.0298507462686568, 1.0131799163179915, 1.0271739130434783, 1.346938775510204, 1.0083322134121757, 1.6, 1.25, 1.1570731707317072, 1.0, 1.1448170731707317, 1.1022286821705427, 1.0074457459366204, 1.0210270893184659, 1.25, 1.066358534169693, 1.2887596899224807, 1.1598503740648378, 1.0006472254226473, 1.0393700787401574, 1.0354609929078014, 1.0267725036989643, 1.0757032063896284, 1.0810810810810811, 1.2456140350877194, 1.2723463687150838, 1.0, 1.0, 1.0007376345624261, 1.6666666666666667, 1.5714285714285714, 1.542857142857143, 1.0217129071170084, 1.0804597701149425, 1.0314465408805031, 1.0750738085196119, 1.0, 1.2160148975791434, 1.020870602265951, 1.2062780269058295, 1.0, 1.1111111111111112, 1.0146910395873052, 1.1094710947109472, 1.079664570230608, 1.0342307692307693, 1.0015377144707025, 1.1276273241713823, 1.076751592356688, 1.0, 1.0152042262595027, 1.001161824853589, 1.00166165177168, 1.2695652173913043, 1.0271517132010188]
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.5458	median: 1.0581	mean: 1.1499

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 17.483920 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=naru', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[5.3644180e-07 4.1723251e-07 1.3113022e-06 1.3113022e-06 2.3841858e-07]
Distance score: 7.629394644936838e-07
SAUCE Drift detection: False
Detection latency: 0.0232s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 2.037000 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 7.0000	99th: 2.8350	95th: 1.6182	median: 1.0655	mean: 1.1656
ReportEsts: [1.096774193548387, 1.0300044782803404, 1.0277156989593457, 1.0031595576619274, 1.0277777777777777, 1.0, 1.1785081278168836, 1.0114456379276577, 1.0, 1.034216335540839, 1.018310546875, 1.0015271419700493, 1.0024552788495265, 1.0386100386100385, 1.0250885478158205, 1.3333333333333333, 1.118032786885246, 1.0714285714285714, 1.7777777777777777, 1.1347992351816443, 1.0807936183268563, 1.0358984573844146, 1.0715760495526496, 1.0886654478976234, 1.0267303442868345, 1.0068120160236234, 2.0, 1.0665540353403866, 1.8, 1.1428571428571428, 1.1116625310173698, 1.0, 1.0003242587867083, 1.000717446505395, 1.3070829450139796, 1.0121477162293488, 1.0224842722938472, 1.028888888888889, 2.0, 1.0560871570209822, 1.025777608674974, 1.0896326451015284, 1.0574443141852286, 1.0532801314399718, 1.0739371534195934, 1.0566953006568973, 1.2380952380952381, 1.051792828685259, 1.4104046242774566, 1.1578947368421053, 1.2857142857142858, 1.1240875912408759, 1.0491071428571428, 1.03125, 1.0782752941738072, 1.0188341180882536, 1.0157259196854815, 1.105603448275862, 1.1686746987951808, 1.0093534681252228, 1.1333333333333333, 1.033458932492588, 1.0865248226950355, 1.0946969696969697, 1.1, 2.0, 1.1189973080151678, 1.1054890444996612, 1.1428571428571428, 1.0, 1.1271691498685363, 1.0168150346191889, 1.044647143542967, 1.138783269961977, 1.0911805771020788, 1.0891410048622365, 1.0259831460674158, 1.0186046511627906, 1.0425531914893618, 1.004155175583747, 1.2265486725663717, 1.22, 1.0, 1.3333333333333333, 1.0235017626321974, 1.11864406779661, 2.0, 1.0526315789473684, 2.8333333333333335, 1.0187628073770492, 1.0791707476330394, 1.0994440109246977, 1.0657352580020192, 1.2060829699206084, 1.123249299719888, 1.3264367816091953, 1.1304347826086956, 1.3914174252275682, 1.3333333333333333, 1.1987356775977875, 1.3870967741935485, 1.1, 1.0675751999562737, 1.0051546391752577, 1.0447427293064877, 1.0032784948459699, 1.024390243902439, 1.003383217460754, 1.0804597701149425, 1.0989331412301464, 1.0831210191082803, 1.019679874048806, 1.0, 1.5, 1.1207877461706783, 1.0375663066402505, 1.0502540937323546, 1.1136363636363635, 1.0072746540949022, 1.0, 1.1453453453453453, 1.1702986279257466, 1.5, 1.2429906542056075, 1.0, 1.022964509394572, 1.0144564964359697, 1.0763920252919543, 1.062015503875969, 1.8333333333333333, 1.1507882111034955, 1.0, 1.0952380952380953, 1.0087695006000184, 1.2307692307692308, 1.1219512195121952, 1.0251771684742002, 1.0101046791929464, 3.0, 1.7333333333333334, 1.062240663900415, 1.0350643586329338, 1.0494155154091391, 1.0407072813956009, 1.2794117647058822, 1.0482384823848239, 1.0239211618257262, 3.0, 1.0442203258339797, 1.0474777448071217, 1.045124481327801, 1.015648066135223, 1.6666666666666667, 1.0287195438050805, 1.002439024390244, 1.023489932885906, 1.1706161137440758, 1.0, 1.1101694915254237, 1.0104850763168622, 1.1408105560791706, 1.1182108626198084, 1.0986301369863014, 1.1228070175438596, 1.2625, 1.1358024691358024, 1.25, 1.0177819497438547, 1.28125, 1.076086956521739, 1.000337128436302, 1.2307692307692308, 1.0422289943404441, 1.0434782608695652, 1.0782608695652174, 1.2055712555510698, 1.0841163310961968, 1.1585160202360878, 1.0324729392173189, 1.0482849604221636, 1.1017857142857144, 1.0090049814791162, 1.0855263157894737, 1.5, 1.0103613790557069, 1.0305885231861005, 1.007168458781362, 1.112178868070311, 1.1356382978723405, 1.5, 1.1173469387755102, 1.016496453799194, 1.0344827586206897, 1.0207684319833852, 1.0208915226088926, 1.0186770401622498, 1.0055853719420869, 1.0127826941986233, 1.0241455291275365, 1.017683615819209, 1.0735358872743286, 1.007808595702149, 1.0841915550978374, 1.0243172035598853, 1.1780678851174935, 1.0747277836318931, 1.0552763819095476, 1.0240963855421688, 1.0, 1.0, 1.048913043478261, 1.001838476690742, 1.7151162790697674, 1.1192660550458715, 1.0269821502698215, 1.0, 1.0009891026392153, 1.0178970917225951, 1.0229500163345313, 1.5, 1.0885416666666667, 1.0396736072031514, 1.0012836816469515, 1.0330866734506368, 1.1, 1.0245231607629428, 1.0366209178158472, 1.0449442805637497, 1.0756302521008403, 1.2475247524752475, 1.0414031052328925, 1.07267271185335, 1.0086206896551724, 1.0032210357155333, 1.0270735021339692, 1.1535714285714285, 1.2627927146574154, 1.0229621125143513, 1.2857142857142858, 1.1410596026490065, 2.0, 1.025832492431887, 1.0801959412176347, 1.0011607661056297, 1.2946708463949843, 1.1538461538461537, 3.3333333333333335, 1.0844623262618873, 1.1384615384615384, 1.1209450140912633, 1.75, 1.001606167683906, 1.095190380761523, 1.2857142857142858, 1.0060996406843654, 1.1264367816091954, 1.1593908629441625, 1.0364025695931478, 1.0095473833097595, 1.0072853565947824, 1.1451612903225807, 1.0, 1.033688948748848, 1.094953442924474, 1.0659971305595408, 1.0481927710843373, 1.0776312726195263, 1.0123772292135762, 1.1128924515698062, 1.0415354647841943, 1.0772704465629703, 1.1113683127572016, 1.207070707070707, 1.5833333333333333, 1.0891343462614953, 1.2708333333333333, 1.25, 1.2692307692307692, 1.051493305870237, 1.470505617977528, 1.0297967738056382, 1.0197201912260967, 1.0134831460674156, 1.1658415841584158, 1.014016967908521, 1.0326241134751772, 1.0842976961460877, 1.0094298294134567, 1.3846153846153846, 1.0407239819004526, 1.0811345646437995, 1.0605492490574588, 1.0025113381962973, 1.0787400448962667, 1.135135135135135, 1.0246085011185682, 1.0034962540135568, 1.1531280643263384, 1.0231532933244425, 1.040950779787045, 1.0897435897435896, 1.2, 1.1538461538461537, 1.0839546191247975, 1.0, 1.0162748643761301, 1.0427575395024546, 1.0244434065078625, 1.105263157894737, 1.3893805309734513, 1.0870165745856353, 1.0280357757137943, 1.0199137385920705, 1.2727272727272727, 1.077491236855283, 1.0197247614532488, 1.0771144278606966, 1.5, 2.6, 1.017474879860201, 1.5, 1.0264235888442461, 1.0740740740740742, 1.2272727272727273, 1.0428049810297457, 1.1153846153846154, 2.0, 1.031387641184423, 2.0, 1.115702479338843, 1.059610705596107, 1.1639384691266685, 1.0965886552955177, 1.1092077087794432, 1.043859649122807, 1.022445463043258, 1.0000067694723873, 1.0754716981132075, 1.0103068810570879, 1.1623827835121097, 3.0, 1.0, 1.0081613841707553, 1.5, 1.0533759124087592, 1.0526315789473684, 1.0, 1.08, 1.1844660194174756, 1.0722795869737887, 1.1923076923076923, 1.2082239720034995, 1.28, 2.0, 1.037493516774493, 2.0, 1.1666666666666667, 1.0384841929947497, 1.096551724137931, 1.0436507936507937, 1.0169014084507042, 1.8, 1.0, 1.1464435146443515, 1.3066666666666666, 1.0701402805611222, 1.0142628087567986, 1.068991006529506, 1.0025, 1.0, 1.0028750310123904, 1.0769230769230769, 1.7826086956521738, 2.0, 1.0012722646310432, 1.0, 1.0533049040511726, 1.1147540983606556, 1.0218651325749384, 1.0006402933707808, 1.0600522193211488, 1.0877327073210679, 1.0471592499300308, 1.2088772845953002, 1.0226969292389854, 1.0486441484300666, 1.0992481203007518, 1.1142857142857143, 1.010648346930013, 1.0211469466011125, 1.1796363636363636, 1.0961538461538463, 1.069767441860465, 1.0268336314847943, 2.0, 2.0, 1.165289256198347, 1.0382409177820269, 1.4275862068965517, 1.0, 1.0348039215686275, 1.0495534428118698, 1.1849492550205138, 1.1003433803891645, 1.2057065217391305, 1.2619047619047619, 1.0895522388059702, 1.0321782178217822, 1.0, 1.0043743562329688, 1.5263157894736843, 1.0002070861101697, 1.0032570258700912, 1.0135490555511277, 1.0005401026194978, 2.4285714285714284, 1.231137724550898, 1.0, 1.0862268518518519, 1.0909090909090908, 1.019090519090519, 1.0455089820359282, 1.11318730442557, 1.1452702702702702, 1.119225037257824, 4.0, 1.087909186906019, 1.0027759609388072, 1.0451781890486387, 1.5, 1.265625, 1.0174050632911393, 1.249400479616307, 1.074827206250626, 1.009753117627233, 1.0, 1.156452775775054, 1.1537307617377752, 1.039178495359214, 1.0185804593968522, 1.090571030142668, 1.0272014753342553, 1.0493827160493827, 1.2150244964616221, 1.0358172727838517, 1.1395348837209303, 1.0569280343716434, 2.0, 2.0, 1.194980694980695, 1.0888030888030888, 1.2032686414708886, 1.0498321869873426, 1.1563055062166963, 1.0, 1.048, 1.15625, 1.0252619512983674, 1.0909090909090908, 1.0, 1.0809436361067948, 1.0, 1.0, 1.119074706105423, 1.75, 1.2122395833333333, 1.0119760479041917, 1.47265625, 1.0, 1.0154515523723768, 1.0049180327868852, 1.1071428571428572, 1.0045752248440976, 1.0148148148148148, 1.0339539978094194, 1.1507936507936507, 1.016072676450035, 1.1503014642549527, 1.0, 1.021505376344086, 1.0237440690736554, 1.0537294563843236, 1.07920059215396, 1.2, 1.011310958650102, 1.0400533779477374, 1.0411140583554377, 1.0, 1.109515859766277, 1.1191496455222052, 1.0561152947286419, 1.1462995465847594, 1.024399120591818, 1.0143249932685736, 1.007665505226481, 1.000006066709538, 1.5, 1.0484424611687977, 1.059317393684979, 1.0501809408926417, 1.0161725067385445, 1.1657754010695187, 1.0501365636999465, 1.2222222222222223, 1.0389211062962018, 1.1734234234234233, 1.03928133455317, 1.0325365205843293, 1.0300035840458759, 1.1867524602573807, 1.0714285714285714, 1.1529411764705881, 1.0299615033937797, 1.1651785714285714, 1.0280876007490027, 1.0012461234318053, 1.3333333333333333, 1.306766917293233, 1.355421686746988, 2.0, 1.0, 1.0025866514816169, 1.145985401459854, 1.0402476780185759, 1.0, 1.40625, 1.031456953642384, 1.0570162002414718, 1.0297369424323295, 1.0358932216419692, 1.0014124293785311, 1.1057884231536925, 1.0727865290602934, 1.0798120575256358, 1.204225352112676, 1.0458391445839144, 1.0860033726812817, 1.0737327188940091, 1.0153513115169381, 1.2692307692307692, 1.0108747904946276, 1.0, 1.0628172588832487, 1.471947194719472, 1.0770064154310235, 1.0378151260504203, 1.1644260599793175, 1.0547008547008547, 1.1476190476190475, 1.0500297147385103, 2.0, 1.7241379310344827, 1.0, 1.3333333333333333, 1.0, 1.0994475138121547, 1.334453781512605, 1.0619469026548674, 1.0275926419621435, 1.0100297176820208, 1.0300548456821892, 1.0226667213181948, 1.0521363085971285, 1.0670299727520436, 1.0347197602627478, 1.043206663196252, 1.0331062886108031, 1.004378472014814, 1.1520987654320987, 1.045964125560538, 1.069988137603796, 1.3076923076923077, 1.0127089207633526, 1.2235872235872236, 1.0190222826739208, 1.1359223300970873, 1.237926972909305, 1.143835616438356, 1.25, 1.0883435582822085, 1.1428571428571428, 1.0, 1.0733137829912023, 1.0263006363901497, 1.0215799614643546, 1.1208226221079691, 1.0454545454545454, 1.0732469743963997, 1.1590219224283305, 1.0338345864661653, 1.2, 7.0, 1.002190170940171, 1.2941176470588236, 1.0341282894736843, 1.0051222351571596, 1.0, 1.0698974836905872, 1.1173708920187793, 1.0338145652871351, 1.1372832369942196, 1.003924145700338, 1.034278752914324, 1.0167489594981156, 1.119047619047619, 4.0, 1.073664103443209, 1.0, 1.1460234680573664, 1.2008547008547008, 1.1872376154492024, 1.0787488908606921, 1.3548387096774193, 1.090823757889626, 1.1126760563380282, 1.006993006993007, 1.0116272500834553, 1.0540192926045016, 1.0098152424942264, 1.0254146861965272, 1.0206093189964158, 1.0081752779594506, 1.0, 1.071187972395662, 1.0829962337843493, 1.2, 1.0341296928327646, 1.065278786411684, 1.5243243243243243, 1.0661484571077768, 1.0, 1.020446096654275, 1.0708653138471245, 1.0096385542168675, 1.174496644295302, 1.0468881993292127, 1.2871287128712872, 1.875, 1.0974912670689108, 1.035014005602241, 1.0341800733841378, 1.0640776699029126, 1.0536930782368406, 1.0074516183662892, 1.0659509202453987, 1.0259117082533589, 1.146417445482866, 1.055644166658939, 1.0713170223841748, 1.0784789644012944, 1.0485564304461943, 1.08445136559655, 1.1088180112570356, 1.0770175438596492, 1.0476190476190477, 1.6, 1.0211180124223602, 1.0144874381074638, 1.0442367601246105, 2.3333333333333335, 1.4444444444444444, 1.0207336523125996, 1.1015817223198594, 1.3658536585365855, 1.012203088298656, 2.6666666666666665, 1.0332499583124897, 1.5, 1.3795811518324608, 1.0625, 1.1493091057813094, 1.2647058823529411, 1.2297872340425533, 1.1302083333333333, 3.0, 1.2875264270613107, 1.040045766590389, 1.8, 1.25, 1.0, 1.0110803324099722, 1.0798017348203222, 1.0115555555555555, 1.033467202141901, 1.0115712545676006, 1.1179775280898876, 1.1775456919060052, 1.6416184971098267, 1.0165016501650166, 1.3548387096774193, 1.0, 1.272240085744909, 1.2915632754342432, 1.0365093499554765, 1.2462165933240312, 1.002022018616181, 1.215502769850596, 1.0061400834852283, 1.026012634708287, 1.0341023069207622, 1.0034965034965035, 1.3333333333333333, 1.5, 1.075, 1.0445000198483585, 1.101401483924155, 1.0336134453781514, 1.32010582010582, 1.0596102407336645, 1.01985730054508, 1.0031202361590505, 1.0103092783505154, 1.0869565217391304, 1.0028776978417266, 1.1444518493835387, 1.0343989110755771, 1.0171255913456767, 1.1842105263157894, 1.1408146915634436, 1.0117450682852807, 1.0397922149669676, 1.0059970014992503, 1.0366490445911598, 1.2896825396825398, 1.0814606741573034, 1.1170212765957446, 1.0093664597746121, 1.5, 1.0235655737704918, 1.0, 1.0375494071146245, 1.0367194156179729, 1.1692307692307693, 1.0198252029497847, 1.18001800180018, 1.173913043478261, 1.04919276523428, 1.0087842902113626, 1.0977452054025216, 1.0047430830039525, 1.0520340586565753, 1.0042794328575795, 1.1371527777777777, 1.3125, 1.0, 1.5, 1.0192544204520253, 1.8571428571428572, 1.009210352021724, 1.0775452590069905, 1.2351416404369562, 1.0741935483870968, 1.058269130077044, 1.0891656958508826, 1.021604938271605, 1.0011520737327189, 1.0063328994124476, 1.0366644528655702, 1.0045920875414147, 1.0137547035492729, 1.7777777777777777, 1.0084745762711864, 1.3108108108108107, 1.033131584846447, 1.0107238605898123, 1.0170970614425645, 1.217201166180758, 1.0213815789473684, 1.0210534831908193, 1.0136830102622576, 1.004253014223524, 1.4705882352941178, 1.0244299754179198, 1.0049480216527633, 1.1679969593310529, 1.006322444678609, 1.0227272727272727, 1.1967213114754098, 1.0785467923660612, 1.0874342568088171, 1.145922746781116, 1.0039579425582075, 1.105263157894737, 1.0310945273631842, 1.1781427668982944, 1.1414141414141414, 1.0220588235294117, 1.1035103510351034, 1.1438095238095238, 1.0921658986175116, 1.0413611603180004, 1.0598039215686275, 1.220384204909285, 1.0457542429059183, 1.0769230769230769, 1.0535465924895688, 1.1123391918825873, 1.0397816575336647, 1.3636363636363635, 1.2963944856839873, 1.188508064516129, 1.1096774193548387, 1.013530135301353, 1.0116785519186193, 1.3333333333333333, 1.03462441314554, 1.0211656034024454, 1.0308744301699129, 1.6169544740973312, 1.042857142857143, 1.021417297979798, 1.0514851485148515, 1.0536779324055665, 1.0045554534112549, 1.1129578331794399, 1.0152905198776758, 1.3139013452914798, 1.0075845974329054, 1.018963737981629, 1.0625, 2.5, 1.0416831221053386, 1.0052787628626243, 1.055916125811283, 1.2395209580838322, 1.0790108564535585, 1.0472343937757171, 1.0312800769971127, 1.1101233151706338, 1.3928571428571428, 1.1027359017308767, 1.3142857142857143, 1.1096605744125327, 1.5454545454545454, 1.0399482737768515, 1.0092127303182579, 1.0557103064066853, 1.119047619047619, 1.078125, 1.0174165457184325, 1.02, 1.1688311688311688, 1.030644152595372, 1.079646017699115, 1.1187308085977483, 1.2, 1.0669775152833902, 1.1238938053097345, 1.1627875507442489, 1.1140350877192982, 1.25, 1.02816091954023, 1.059440612676807, 1.0298342688409459, 1.0741350906095553, 1.3658536585365855, 1.125, 1.024390243902439, 1.3222222222222222, 1.3448275862068966, 1.0015396458814472, 1.0120309721565715, 1.003181661720516, 1.0728476821192052, 1.0480885541481229, 1.0006418993551829, 6.0, 1.0258332580616023, 1.0868953880764904, 1.3333333333333333, 1.2857142857142858, 1.0789345063538611, 1.1086556169429098, 1.0627560281296184, 1.0362694300518134, 1.5, 1.0378006872852235, 1.1546391752577319, 1.24, 1.0159663381174708, 1.0408006369951401, 1.0308612527980625, 1.1738124238733252, 1.2222222222222223, 1.0043865118225221, 1.0581841432225063, 1.0648994515539305, 1.0523771152296535, 1.1210710128055879, 1.0, 1.1264367816091954, 1.0500332288996488, 1.0410550265441982, 1.0512249443207127, 1.0162337662337662, 1.0461107989404035, 1.1979841612670987, 1.0662251655629138, 1.2816901408450705, 1.0352297004768036, 1.0766943504562698, 1.0280062400192, 1.3509933774834437, 1.188118811881188, 1.1497584541062802, 1.0, 1.0289558350394852, 1.0617283950617284, 1.008889087861197, 1.0710332103321034, 1.5, 1.020492803122713, 1.0428092243186582, 1.1740088105726871, 1.352787740462993, 1.0021680946186395, 1.0399443284620737, 1.10287490830335, 1.235981308411215, 1.0, 1.0000655307994757, 1.034963061768931, 1.0603064755313891, 1.2914798206278026, 3.0, 1.1136363636363635, 1.0473774091241765, 1.1900709219858157, 1.0673802738583444, 1.0094259634619716, 1.1243339253996447, 1.6, 1.0155642023346303, 1.000571086445908, 1.0354474037171872, 1.0357142857142858, 1.024122480204266, 1.1723076923076923, 1.317632850241546, 1.073968705547653, 1.0032875582298137, 1.0236233300749429, 1.130392156862745, 1.1482277121374866, 1.0263157894736843, 1.0206024438761012, 1.1344281786430854, 1.0158579432152692, 1.099572015023146, 1.0273119310014374, 1.0554812834224598, 1.1818181818181819, 1.09009009009009, 2.5, 1.0, 1.4, 1.0062111801242235, 1.1289473684210527, 1.0138785855588526, 1.0391971673444595, 1.1237646001796946, 1.0135658914728682, 1.1050228310502284, 1.0220125786163523, 1.0105541989156077, 1.5, 1.4615384615384615, 1.1167623735302161, 1.0, 1.1047381546134662, 1.1591289782244556, 1.1118178774690324, 1.0219405003380662, 1.5, 1.0052029136316336, 1.1481481481481481, 1.0624325194628075, 1.000439662950559, 1.0589543937708565, 1.0554556354916067, 1.0281475782713407, 1.0923506093084716, 1.1133333333333333, 1.5081967213114753, 1.272300469483568, 1.3333333333333333, 1.5, 1.0001116989786991, 1.5, 1.8571428571428572, 1.3541666666666667, 1.0854526958290946, 1.0050127842820615, 1.1710816777041944, 1.0725806451612903, 1.0, 1.0227788541378355, 1.0365731462925851, 1.038888888888889, 1.005813953488372]
origin-bjaq_15.87 	max: 7.0000	99th: 2.8350	95th: 1.6182	median: 1.0655	mean: 1.1656

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 19.376642 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=38.930026