Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='naru', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 3, 'naru': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 5.0000	99th: 2.6667	95th: 1.5706	median: 1.0590	mean: 1.1523
ReportEsts: [1.0824742268041236, 1.033091202582728, 1.0283635714445114, 1.021153846153846, 1.0344827586206897, 1.0, 1.1921097770154374, 1.023932492697087, 1.25, 1.03315649867374, 1.0610048192075723, 1.0031268702674103, 1.0166524338172502, 1.0604651162790697, 1.0501589544330625, 1.0, 1.7307692307692308, 1.0129171151776104, 3.0, 2.6666666666666665, 1.173913043478261, 1.0901013586370498, 1.0103994043759157, 1.0764854614412136, 1.0074000986679823, 1.0, 1.0314613254331164, 1.2, 1.4, 1.1654676258992807, 1.0, 1.005253203561638, 1.004139806111904, 1.3435072142064373, 1.0199735644000587, 1.0288064450612686, 1.0108108108108107, 1.0023893354053857, 1.070149459329155, 1.3333333333333333, 1.0455764075067024, 1.0182926829268293, 1.0, 1.1199114078048475, 1.0525991053524604, 1.2314049586776858, 1.0679611650485437, 1.2922374429223744, 1.0288083057604063, 1.0188679245283019, 1.077003685770037, 1.3167420814479638, 1.0072592833403078, 1.0, 1.2077922077922079, 1.011300686904498, 1.1534545454545455, 1.0727969348659003, 1.2484472049689441, 1.25, 1.0246955652490004, 1.0348692403486923, 1.0227272727272727, 1.1149425287356323, 1.0909090909090908, 1.0988543144924026, 1.0505154639175258, 1.1666666666666667, 1.0, 1.0617638325249925, 1.0405727923627686, 1.0547866205305652, 1.1081081081081081, 1.0382569376717794, 1.2141176470588235, 1.1513859275053304, 1.3333333333333333, 1.0390455531453362, 2.0, 1.0145771758156619, 1.28125, 1.0126926084842849, 1.2760736196319018, 1.036697247706422, 1.0483539094650205, 1.04, 1.0081845775818459, 1.0205736776194168, 1.0980392156862746, 2.3333333333333335, 1.1092436974789917, 1.0074112851521373, 1.0062305295950156, 1.3183730715287518, 1.2414965986394557, 1.0845070422535212, 1.25, 1.0017094017094017, 1.0, 1.0100946372239747, 1.1949604031677465, 1.0255057167985928, 1.0040034011195351, 1.2941176470588236, 1.003139209321472, 1.087785157377996, 1.0352994294627098, 1.0515737580583997, 1.0303221730890715, 1.1666666666666667, 1.3333333333333333, 1.1502284332168773, 1.0004905918786602, 1.0560373582388258, 1.077922077922078, 1.007452095790605, 1.0, 1.1849775784753362, 1.0669856459330143, 1.0, 1.2307692307692308, 1.1666666666666667, 1.0401002506265664, 1.0248313625060574, 1.1225440708239496, 1.0666666666666667, 1.8, 1.1920529801324504, 1.0, 1.3214285714285714, 1.0185050761161833, 1.1818181818181819, 1.0267379679144386, 1.0035986359097389, 1.0674246540985661, 1.1721439749608764, 1.064139941690962, 1.0705047976637463, 1.00199203187251, 1.052597819114817, 1.0660865322055952, 1.2530864197530864, 1.0176125244618395, 1.0031763030752943, 2.0, 1.0101289134438305, 1.0683760683760684, 1.053349875930521, 1.0497617787188989, 1.0, 1.0066602082828773, 1.045925925925926, 1.026, 1.4476190476190476, 1.128500823723229, 1.0750271837622327, 1.0284671334005284, 1.0492830733158987, 1.1482889733840305, 1.1644736842105263, 1.0, 1.3405797101449275, 1.122314049586777, 1.2857142857142858, 1.003787912707865, 1.0002973716917398, 1.0339285714285715, 1.0243563487419545, 1.0354306658521686, 1.1256261429593704, 1.0326086956521738, 1.065126050420168, 1.1956037571414737, 1.0577540106951873, 1.2212855637513171, 1.0564681724845997, 1.0485868529691966, 1.041814659347756, 1.082666439639026, 1.0, 1.024390243902439, 1.055092316855271, 1.0474002923366048, 1.106548279689234, 1.1176470588235294, 1.0290648360720627, 1.0465116279069768, 1.054742609291177, 1.0357142857142858, 1.0821446138711264, 1.032853620778625, 1.0, 2.4545454545454546, 1.106492230755492, 1.2678774120317822, 1.1302761855132881, 1.3461538461538463, 1.017363344051447, 1.0094184988978352, 1.0116728901161463, 1.1798245614035088, 1.1774006535258774, 1.0847457627118644, 1.0625, 1.024390243902439, 1.0, 1.0738255033557047, 1.0260211323135153, 1.637630662020906, 1.1149425287356323, 1.0182896688087, 1.0957683741648108, 1.0929705640026963, 1.012386596635115, 1.0280429992655404, 1.24822695035461, 1.004335260115607, 1.0411605937921729, 1.018367943843229, 1.0457138747722696, 1.0, 1.058385093167702, 1.0486675989206862, 1.0075972644894446, 1.0757749712973594, 1.0307279076013967, 1.0042716968364067, 1.0344827586206897, 1.00040237063365, 1.112928684172765, 1.2086858432036096, 1.1925465838509317, 1.1418792781580585, 1.0189555125725338, 1.1299212598425197, 1.0, 1.0352250489236792, 1.0958575256811076, 1.0405532114392875, 1.3470149253731343, 1.0909090909090908, 2.6666666666666665, 1.1016865690016004, 1.1090909090909091, 1.1110556703970347, 1.5, 1.5, 1.2903225806451613, 1.006679764243615, 1.4489795918367347, 1.1408839779005524, 1.0934256055363323, 1.118491921005386, 1.0192554557124518, 1.0934239210955192, 1.087719298245614, 1.0, 1.0076245726717084, 1.0431590503636614, 1.085814360770578, 1.0161005968690924, 1.0976024787931122, 1.031552946351532, 1.1001589825119238, 1.0515993873563017, 1.0639952153110048, 1.1217648893046461, 1.1654501216545012, 1.7272727272727273, 1.0820320007687871, 1.1364605543710022, 1.25, 1.1904761904761905, 1.1112727272727272, 1.0555555555555556, 1.1584158415841583, 1.0017360877464505, 1.1949860724233983, 1.209090909090909, 1.000588331236311, 1.0945821854912765, 1.0041715521939458, 1.013869654956518, 1.3, 1.0527282648235723, 1.0, 1.0033334209396656, 1.0367170626349893, 1.0001092349005507, 1.3, 1.25, 1.0869565217391304, 1.619718309859155, 1.0054504687889265, 1.0, 1.1452599388379205, 1.002267573696145, 1.0384615384615385, 1.0006044262599962, 1.125, 1.0062893081761006, 1.0201536352130502, 1.0673060600916653, 1.073034672159286, 1.1794871794871795, 1.0, 1.260143198090692, 1.0172413793103448, 1.158878504672897, 1.0816475305266995, 1.0349589987052223, 1.0112676056338028, 1.0535714285714286, 1.0013717421124828, 1.1008236296506675, 1.4285714285714286, 1.0176446322802593, 1.0604395604395604, 1.0526315789473684, 1.0338496357592475, 1.2380952380952381, 1.75, 1.0147584858076637, 2.0, 1.0150891632373114, 1.0843023255813953, 1.0500410172272354, 1.0068545316070068, 1.276762402088773, 1.2197802197802199, 1.0036391184945683, 1.0133881843187849, 1.0027322404371584, 1.0005414762611884, 1.0960805246301661, 3.0, 1.1111111111111112, 1.0305206885994866, 1.3333333333333333, 1.048687089715536, 1.0, 1.0, 1.0454545454545454, 1.192814371257485, 1.0853307766059443, 1.2647058823529411, 1.0551948051948052, 1.0, 1.0319573901464714, 1.0345734524176162, 1.5, 1.1048243001786777, 1.0, 1.0089577165414105, 1.1685393258426966, 1.1048281290999737, 1.1705069124423964, 1.0018181818181817, 1.1453658536585365, 1.1203703703703705, 1.0001186389150472, 1.0023645874274247, 1.0066577896138482, 1.0, 1.1428571428571428, 1.8333333333333333, 1.5, 1.2307692307692308, 1.0019858611825192, 1.25, 1.1131447587354408, 1.0198019801980198, 1.0915494742176612, 1.006548257431095, 1.0010309278350515, 1.060773154489208, 1.0298685782556751, 1.2371134020618557, 1.5, 1.014799154334038, 1.0681818181818181, 1.0168229170780252, 1.3333333333333333, 3.142857142857143, 1.1180400890868596, 1.0284883720930234, 1.003958652556573, 1.1541725601131543, 1.342769701606733, 1.038647342995169, 1.3114754098360655, 1.0808477237048666, 1.0233050847457628, 1.3653846153846154, 1.055306427503737, 1.1181818181818182, 1.0657534246575342, 1.0099362342442466, 1.0410343719326285, 1.162162162162162, 1.018348623853211, 1.0623145400593472, 1.0, 1.0002512057877813, 1.033672638227896, 1.026403480353589, 1.0033503433803892, 1.0278255880665519, 1.0115718418514947, 1.8333333333333333, 1.021225277375784, 1.0, 1.0520922288642187, 1.1111111111111112, 1.0369564972451635, 1.0492753623188407, 1.1317712811693894, 1.1699604743083003, 1.2435129740518962, 3.0, 1.1441018766756033, 1.00211522506177, 1.0441419900680522, 1.0, 1.4, 1.0489443378119, 1.5172413793103448, 1.0894163550642173, 1.2177215189873418, 1.1666666666666667, 1.1138912855910268, 1.1155257438006871, 1.0695009518121756, 1.0083342867452278, 1.061732456140351, 1.3233830845771144, 1.0795454545454546, 1.3636363636363635, 1.0812182741116751, 1.3, 1.044338335607094, 1.03125, 1.052271714922049, 1.1363636363636365, 1.133805254050653, 1.0973052480718097, 1.1504613200851668, 1.0, 1.1067961165048543, 1.24, 1.000817152418382, 1.236323851203501, 1.0, 1.1123238463663996, 1.002531884075038, 1.207103551775888, 1.0, 2.0, 1.1953398058252427, 1.0017921146953406, 1.425233644859813, 1.0, 1.0133831387294676, 1.0505952380952381, 1.0869565217391304, 1.008135593220339, 1.0272727272727273, 1.0583333333333333, 1.1620967741935484, 1.0403870424905344, 1.144825210952299, 1.0, 1.0675675675675675, 1.0841545412501334, 1.0058453306941717, 1.0562155500017119, 1.0, 1.0008855435023245, 1.022026623893048, 1.0288108957569408, 2.0, 1.1311802232854864, 1.075796808059884, 1.149397671900379, 1.2231881525490367, 1.0351767162996706, 1.1933167477100532, 1.0369747899159665, 1.0513500482160076, 2.0, 1.0584009509535377, 1.1935483870967742, 1.0, 1.269736842105263, 1.1304347826086956, 1.0229448930346774, 1.0155306298533218, 1.0539021732897529, 1.1791125541125542, 1.0671377667934399, 1.0164993812732022, 1.0130783545430377, 1.116504854368932, 4.0, 1.039582283039251, 1.0248987854251013, 1.007077677654842, 1.0144397233865012, 1.0892511743575573, 1.3729111697449428, 1.1611111111111112, 1.4285714285714286, 1.0142104028544268, 1.031508696088153, 1.0327621899375254, 1.0995311936530834, 1.0713215927283994, 1.0062240663900415, 1.0055153663154828, 1.0210355987055015, 1.0768175582990398, 2.0, 1.1666666666666667, 1.0300157977883095, 1.0560747663551402, 1.0118845500848896, 1.0193939393939393, 1.1538461538461537, 1.251572327044025, 1.0554699537750385, 1.0714285714285714, 1.0218592907672361, 1.4125, 1.026409786319383, 1.0, 1.0609756097560976, 1.3452380952380953, 1.127659574468085, 1.0275545350172215, 1.1325898389095415, 1.1541501976284585, 1.0791180285343709, 1.052467230243161, 1.0, 1.872340425531915, 1.5, 1.0, 1.035294117647059, 1.1121076233183858, 1.3584905660377358, 1.1573033707865168, 1.0281960909964756, 1.1357048748353096, 1.0352677195025863, 1.0123249852100178, 1.1043549712407559, 1.02747535071306, 1.0818713450292399, 1.1111111111111112, 1.1301402999516208, 1.074221867517957, 1.1286127167630058, 1.052526973310619, 1.0029479034307496, 1.0491222419069093, 1.012416348979664, 2.0, 1.1274238227146813, 1.034195933456562, 1.0410958904109588, 1.0, 1.108695652173913, 1.1538461538461537, 1.0660377358490567, 1.6296296296296295, 1.5, 1.0305545985480236, 1.032113026479474, 1.002017641428904, 1.0232468334877973, 1.0702702702702702, 1.0413122721749697, 2.0, 1.1846153846153846, 1.1873720416018345, 1.0272172880939712, 1.0058733956928432, 1.0086746711093237, 1.0220990523869122, 1.0784313725490196, 1.0025949296195347, 1.2255772646536411, 1.0001009036482276, 1.0411340574935521, 1.393939393939394, 1.1433447098976108, 1.0, 1.0113378684807257, 1.0204949326669444, 3.0, 1.0982670744138634, 1.0005405639162774, 1.2857142857142858, 1.16291734740899, 1.3, 1.1875, 1.013916215478738, 1.7692307692307692, 1.0122548130959719, 1.0401537804357113, 1.1875, 1.16, 1.3108108108108107, 1.0038259206121474, 1.0772889417360285, 1.0368241871505763, 1.0086234429894603, 1.0, 1.205246578318488, 1.0, 2.0, 1.0684549207740388, 1.0311618652132537, 1.10879848628193, 1.0073089146951197, 1.01320263059933, 1.2988505747126438, 2.0, 1.0266260935717002, 1.018898931799507, 1.0803285086454109, 1.0067159167226327, 1.0441763827812967, 1.1424137766389202, 1.26007326007326, 1.0279158699808795, 1.1325757575757576, 1.0407236798184125, 1.0839116719242903, 1.0424929178470255, 1.3088235294117647, 1.0243515458585717, 4.0, 1.0000655411073827, 1.0126937107981033, 1.029873839562009, 1.0555555555555556, 1.0138869601444245, 1.110655737704918, 1.0, 1.0058533470502677, 1.0134426229508198, 1.0904761904761904, 1.088235294117647, 1.6666666666666667, 1.0635278215814372, 1.5, 1.3717948717948718, 1.1538461538461537, 1.055753262158956, 1.2857142857142858, 1.196969696969697, 1.1037735849056605, 1.0, 1.2777777777777777, 1.1055676066522053, 2.0, 1.0, 1.0390625, 1.0283687943262412, 1.0865041617122473, 1.0159914712153517, 1.0223642172523961, 1.0029498525073746, 1.089150378938971, 1.0493506493506493, 1.5705128205128205, 1.2694300518134716, 1.2307692307692308, 1.0, 1.0816104461371054, 1.2582972582972582, 1.1012514220705347, 1.199602286850609, 1.0050266288154284, 1.179915092958571, 1.0031895199363583, 1.0062536148062464, 1.102286401925391, 1.0163735597331716, 1.375, 1.0, 1.0303030303030303, 1.0147784768696428, 1.1467611336032388, 1.0065359477124183, 1.3012820512820513, 1.0496372661321114, 1.0510404949381327, 1.0099571111446368, 1.0512820512820513, 1.1, 1.0503330866025167, 1.091728525980912, 1.0519746166731092, 1.0188741590557633, 1.1973684210526316, 1.118502658003544, 1.0118073084093506, 1.2436305732484076, 1.0519550080342797, 1.3333333333333333, 1.055264411624583, 1.1092342342342343, 1.0192307692307692, 1.3154121863799284, 1.0347890451517394, 1.0, 1.0605326876513317, 1.0464199285847253, 1.2222222222222223, 1.0009880871747878, 1.1408898305084745, 1.0238095238095237, 1.0331843128702796, 1.0007930785868782, 1.0910556003223206, 1.0, 1.0351872871736663, 1.0110459873760145, 1.1789473684210525, 1.0714285714285714, 1.0, 1.25, 1.0134673610270073, 1.8333333333333333, 1.0156649616368287, 1.0577244090248237, 1.0491803278688525, 1.0783893767402013, 1.0006879895994951, 1.0241157556270097, 1.073076923076923, 1.0083916083916085, 1.0221476037288375, 1.0558717276191418, 1.0068355583251445, 1.0295375165602794, 1.4285714285714286, 1.0, 1.316205533596838, 1.0630872977853116, 1.009771986970684, 1.0255135135135136, 1.176991150442478, 1.01364522417154, 1.0686739839810144, 1.0233516483516483, 1.0305622009569377, 1.3125, 1.0200327112700915, 1.0093032495158005, 1.171824480369515, 1.0008428150021071, 1.25, 1.0267665952890792, 1.1492537313432836, 1.5625, 1.0272078192153058, 1.2692307692307692, 1.189516129032258, 1.0307692307692307, 1.131490222521915, 1.0236125473974491, 1.0705882352941176, 1.1818181818181819, 1.087378640776699, 1.0124453104893563, 1.0030650913954524, 1.0008093687546304, 1.099201722127545, 1.0356317068832632, 1.0, 1.0567139282735614, 1.1863267670915412, 1.1224385017188268, 1.0162932790224033, 1.2083333333333333, 1.1731289449954914, 1.0464915580535947, 1.186046511627907, 1.0182997246157945, 1.0, 1.3333333333333333, 1.0143898964770082, 1.0375182481751826, 1.0137445002530856, 1.0488103568929321, 1.0997605746209098, 1.079136690647482, 1.0069294536278597, 1.1042568782892546, 1.048169556840077, 1.345945945945946, 1.002808988764045, 1.035549501791587, 1.0119047619047619, 1.75, 1.0432639413224032, 1.0034315564261798, 1.005157593123209, 1.3134328358208955, 1.0169366715758468, 1.005096825783124, 1.0073633531577457, 1.1775, 1.2307692307692308, 1.1320754716981132, 1.023157894736842, 1.08125, 1.72, 1.0318136104592692, 1.0277502477700693, 1.0914027149321266, 1.2424242424242424, 1.0639181462533855, 1.1013327691982229, 1.0149801284011006, 1.1326977005047671, 1.6666666666666667, 1.1071428571428572, 2.0, 1.011984490659147, 1.5384615384615385, 1.3333333333333333, 1.3636363636363635, 1.25, 1.0222222222222221, 1.1329653396789483, 1.0048890799929928, 1.0638297872340425, 1.411764705882353, 1.0, 1.0, 1.3243243243243243, 1.6666666666666667, 1.0109034267912773, 1.0114647143445696, 1.0068289985878767, 1.046875, 1.0088973690869425, 1.000835794004304, 5.0, 1.0070089483175122, 1.1714285714285715, 1.0, 1.3333333333333333, 1.0340236686390532, 1.1361973750268952, 1.067014422332583, 1.0248447204968945, 1.0, 1.070539419087137, 1.4325153374233128, 2.0, 1.5, 1.062007874015748, 1.0596866096866098, 1.245990969951736, 1.25, 1.0020854953631713, 1.0712625871417505, 1.089385474860335, 1.1428571428571428, 1.1513513513513514, 1.0037814871832795, 1.0921052631578947, 1.0414428676429015, 1.0742546409150573, 1.056470588235294, 1.0078740157480315, 1.0168595041322315, 1.1861656703672074, 1.1239669421487604, 1.4081632653061225, 1.0428203614839147, 1.100660469667319, 1.0490121117427391, 1.4521739130434783, 1.2, 1.1791044776119404, 1.05249343832021, 1.044013542628501, 1.0090341424111189, 1.0281203295650507, 1.0873362445414847, 3.0, 1.25, 1.00166208527776, 1.1635883905013193, 1.2857420735265512, 1.0122869353476123, 1.0297708646930925, 1.0814589415683211, 1.0703883495145632, 1.0208333333333333, 1.0349007484542792, 1.0160748209849482, 1.055391868002357, 1.138353765323993, 2.5, 1.0933333333333333, 1.025386111009208, 1.0702508960573476, 1.0487525562372189, 1.0007245520771806, 1.1022727272727273, 1.6, 1.0166270783847982, 1.0794733521421853, 1.0534612748457848, 1.102661596958175, 1.0221296428741715, 1.2868852459016393, 1.2377049180327868, 1.093913043478261, 1.003985936276028, 1.0532895903528994, 1.1059907834101383, 1.1241997439180538, 1.03125, 1.0431476418318524, 1.0071584762343193, 1.071334214002642, 1.02054145400153, 1.0239316239316238, 1.080948487326247, 1.3846153846153846, 1.1210191082802548, 2.5, 1.5, 1.4166666666666667, 1.0255754475703325, 1.1484992101105844, 1.0258086078205653, 1.0424264581308462, 1.1234735413839891, 1.1135983263598326, 1.0326086956521738, 1.346938775510204, 1.017014810375824, 1.6, 1.3333333333333333, 1.0816260162601625, 1.0, 1.0743919885550788, 1.1386386386386387, 1.0454159992462075, 1.0214003992793494, 1.25, 1.0875420875420876, 1.253875968992248, 1.1359102244389028, 1.000413025919671, 1.0299089726918076, 1.038037682189833, 1.0285410991828232, 1.0422250883194077, 1.0937996820349762, 1.3148148148148149, 1.2067039106145252, 1.0, 1.0, 1.0006437537999355, 1.6666666666666667, 1.5714285714285714, 1.4210526315789473, 1.037394451145959, 1.1058823529411765, 1.0226757369614512, 1.0996548748921484, 1.0, 1.2464307883302297, 1.019047619047619, 1.1390134529147982, 1.0288461538461537, 1.25, 1.0354772259098193, 1.0509977827050998, 1.0729166666666667, 1.060989215321681, 1.0090212616068022, 1.0583270106221547, 1.062539283469516, 1.0, 1.0375296286542006, 1.0177379633373416, 1.0132654915500636, 1.2695652173913043, 1.0207495339939174]
origin-bjaq_15.87 	max: 5.0000	99th: 2.6667	95th: 1.5706	median: 1.0590	mean: 1.1523

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 19.476102 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=naru', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[1.7881393e-07 1.7881393e-07 1.8477440e-06 0.0000000e+00 4.7683716e-07]
Distance score: 5.364418029785156e-07
SAUCE Drift detection: False
Detection latency: 0.0234s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 2.068701 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 6.0000	99th: 2.5000	95th: 1.6787	median: 1.0655	mean: 1.1647
ReportEsts: [1.131578947368421, 1.0259711431742509, 1.0477461278824012, 1.0112721417069244, 1.125, 1.0, 1.1319049701209736, 1.0085150375939849, 1.0, 1.0367483296213809, 1.0604138129911327, 1.002109026561456, 1.0648527767424525, 1.001937984496124, 1.0353535353535352, 1.32, 1.064516129032258, 1.0909090909090908, 1.4, 1.09981684981685, 1.0949367088607596, 1.1028916821210248, 1.0571428571428572, 1.1400189214758751, 1.036187810610546, 1.0038188884417416, 2.0, 1.031672138205694, 1.1666666666666667, 1.6, 1.0719499478623566, 1.0, 1.0028238204629794, 1.0166716650902408, 1.3802367941712204, 1.0029236204166159, 1.0251125392825797, 1.0250569476082005, 1.2234042553191489, 1.027111358301675, 1.0830177396850709, 1.0139018450489123, 1.018348623853211, 1.003004607064165, 1.0177304964539007, 1.063364599500641, 1.2272727272727273, 1.3053892215568863, 1.6802721088435375, 1.0931952662721893, 1.1764705882352942, 1.017667844522968, 1.0986547085201794, 1.1290322580645162, 1.0624203518216357, 1.0147668823627012, 1.073498655512399, 1.1288209606986899, 1.1686746987951808, 1.0058239871374208, 1.1774193548387097, 1.0416848444410227, 1.0513552068473608, 1.0149253731343284, 1.1559633027522935, 1.5, 1.115254433419157, 1.0875111906893464, 1.2857142857142858, 1.0, 1.0613700447835461, 1.0049850448654039, 1.0535455861070913, 1.1009174311926606, 1.1225863312234596, 1.1770546056260343, 1.0169491525423728, 1.083720930232558, 1.0780141843971631, 1.0017011002277278, 1.1043571812802582, 1.157706093189964, 1.0, 1.1333333333333333, 1.03886925795053, 1.0333333333333334, 1.0934497816593887, 1.0344827586206897, 3.0, 1.0296301036733648, 1.0850890086558875, 1.0345208628005658, 1.0767727372825369, 1.2597417840375587, 1.0428954423592494, 1.3290246768507639, 1.3801652892561984, 1.1415701415701416, 1.0608695652173914, 1.2154213036565977, 1.375, 3.0, 1.0675816934054447, 1.1506964964119881, 1.0129032258064516, 1.0159057613537836, 1.1578947368421053, 1.0163873468105165, 1.1161131611316113, 1.1168280250419076, 1.041758937045239, 1.032029404043056, 1.3333333333333333, 2.2, 1.1458703374777974, 1.0144473566451448, 1.0736607142857142, 1.0952380952380953, 1.0060786207921528, 2.0, 1.1402931498653903, 1.1854516386890488, 1.5, 1.2769953051643192, 1.0, 1.0933609958506223, 1.0118620852173144, 1.170817577259095, 1.0381679389312977, 1.8, 1.2720225510923184, 1.0, 1.1111111111111112, 1.0127126565713218, 1.0769230769230769, 1.0811671087533157, 1.0347118209985937, 1.064878201341349, 1.0, 1.3333333333333333, 1.0, 1.0378208014407924, 1.0538379530916844, 1.053391474182479, 1.1219512195121952, 1.0729450190528036, 1.0100012284006223, 1.5, 1.025, 1.0746720484359233, 1.0423901940755873, 1.0121736579642124, 1.6666666666666667, 1.0561049011177988, 1.0385093167701864, 1.0049342105263157, 1.3727272727272728, 2.0, 1.0768079800498753, 1.0076943905410893, 1.0363912349667224, 1.0784615384615384, 1.0846560846560847, 1.103448275862069, 1.215568862275449, 1.113573407202216, 1.25, 1.0018825005882814, 1.3829787234042554, 1.0071942446043165, 1.0123205880184913, 1.0215343203230147, 1.0397090027280995, 1.0415944540727904, 1.0481927710843373, 1.200837831305889, 1.1221749099246643, 1.1292962356792144, 1.0528109028960817, 1.047682119205298, 1.1335149863760219, 1.0037724589185617, 1.0545454545454545, 2.1666666666666665, 1.0069841827443078, 1.062763217074866, 1.0072463768115942, 1.056732456290066, 1.22, 1.6666666666666667, 1.0975, 1.0310968202929618, 1.0689655172413792, 1.017133956386293, 1.0373049931060125, 1.0241211481095585, 1.0101733325166902, 1.0473251028806585, 1.0222330256897099, 1.0474903414755732, 1.0880782918149465, 1.006102710368234, 1.0634562327564585, 1.0159972654247138, 1.177023498694517, 1.1729323308270676, 1.118279569892473, 1.1066666666666667, 1.0396039603960396, 2.0, 1.1160220994475138, 1.0253573075149838, 1.7159763313609468, 1.1037735849056605, 1.0114848236259228, 1.0625, 1.0008338616754417, 1.0201342281879195, 1.0407706650093225, 6.0, 1.0262172284644195, 1.0398530243075184, 1.0036978088388402, 1.04216034460461, 1.6, 1.1338327891791045, 1.0304109499113767, 1.0141239872685186, 1.0106382978723405, 1.342327150084317, 1.073200241984271, 1.0543575920934412, 1.0854700854700854, 1.0035627130642126, 1.0128189214502534, 1.1563636363636363, 1.2846153846153847, 1.0792899408284025, 1.2608695652173914, 1.0879048248512888, 1.0, 1.037381247418422, 1.010182731203794, 1.0836087886447598, 1.5, 1.0, 2.5, 1.1012555987958, 1.1904761904761905, 1.1383375068710682, 2.25, 1.25, 1.014344262295082, 1.2857142857142858, 1.003482069704418, 1.1861575178997614, 1.1744421906693712, 1.0979782270606533, 1.0174688057041, 1.0106042124095307, 1.121212121212121, 2.0, 1.020439702441239, 1.1264919193649705, 1.1054977711738485, 1.0803888753079223, 1.0633371360966748, 1.031769746856853, 1.0897097625329815, 1.0442049864753615, 1.0646123260437377, 1.2056192339949678, 1.1768161112443059, 1.7857142857142858, 1.0797323919717592, 1.1381118881118881, 1.2641509433962264, 1.1666666666666667, 1.0960262220783425, 1.0050556117290192, 1.0029537277933764, 1.0136837684608386, 1.1751152073732718, 1.174563591022444, 1.0148512172685369, 1.06207928197457, 1.0150916145457216, 1.0208231053318295, 1.6363636363636365, 1.0032992411745298, 1.0055418719211822, 1.0338327160152578, 1.0547018841951303, 1.0135971050856798, 1.123338649654439, 1.0231116121758737, 1.0045584045584046, 1.0582301202656614, 1.0069954211788648, 1.1101540258413023, 1.0566762728146013, 1.0425531914893618, 1.0714285714285714, 1.077704336611317, 2.0, 1.0271739130434783, 1.032065355062062, 1.0068318666049096, 1.1666666666666667, 1.4583333333333333, 1.1345202769535114, 1.1601177081530205, 1.0179214763620321, 1.0454545454545454, 1.0237867559168061, 1.0062659037272403, 1.0381861575178997, 1.0, 2.2, 1.1092256214149139, 1.7142857142857142, 1.0257188158948625, 1.0644171779141105, 1.0434782608695652, 1.07376537543602, 1.1481481481481481, 1.7777777777777777, 1.0399633867276887, 2.0, 1.0, 1.0675675675675675, 1.0862745098039215, 1.0802660753880267, 1.0277185501066097, 1.024793388429752, 1.0196405243479436, 1.0242303846049894, 1.1343612334801763, 1.0395137816527051, 1.1376092136616363, 3.0, 1.3, 1.0211776809371755, 1.0, 1.048680618744313, 1.1, 2.0, 1.08, 1.187872763419483, 1.0867469879518072, 1.3392857142857142, 1.0, 1.28, 2.0, 1.0190933398983786, 1.2705882352941176, 1.0338983050847457, 1.0403530959382794, 1.2316176470588236, 1.0947712418300655, 1.037593984962406, 1.2857142857142858, 1.25, 1.071475843812045, 1.5987261146496816, 1.0048780487804878, 1.0195874774434512, 1.067905031369172, 1.0846153846153845, 1.0, 1.0068477897784212, 1.0064102564102564, 1.162162162162162, 2.5, 1.0994152046783625, 1.4285714285714286, 1.3227176220806793, 1.1260504201680672, 1.0026641857318053, 1.0470929810553822, 1.002824858757062, 1.064892572799651, 1.0470390592188157, 1.079245283018868, 1.0163487738419619, 1.0077553437374644, 1.1059907834101383, 1.0, 1.007224025588259, 1.0008159702455501, 1.0270215359609915, 1.0285714285714285, 1.170731707317073, 1.0554493307839388, 3.0, 1.962962962962963, 1.205128205128205, 1.034351145038168, 1.6551724137931034, 1.0216606498194947, 1.0341880341880343, 1.2962962962962963, 1.1509767441860466, 1.0959214501510575, 1.050659282700422, 1.2278481012658229, 1.1982758620689655, 1.0291970802919708, 1.0, 1.0005204230899065, 1.3389830508474576, 1.0043027798222273, 1.027665012780033, 1.017245508982036, 1.0188526797737678, 1.7142857142857142, 1.1536338546458142, 1.5, 1.005857740585774, 1.3636363636363635, 1.0681772608782836, 1.026190476190476, 1.045295855339719, 1.1578947368421053, 1.0875912408759123, 4.0, 1.1552550014088476, 1.0049040024380334, 1.048936725637061, 1.5, 1.3275862068965518, 1.0048115477145148, 1.312958435207824, 1.0697324917342952, 1.0255249911018458, 1.125, 1.1703650680028632, 1.1426375892457639, 1.0810856974270586, 1.0004748806078472, 1.0822587763768445, 1.0298126064735946, 1.1492537313432836, 1.1932681867535289, 1.00659793814433, 1.368421052631579, 1.1834089436163318, 1.0, 2.0, 1.108377659574468, 1.1578947368421053, 1.2005438477226376, 1.0487486104017065, 1.1515689757252812, 2.0, 1.1290322580645162, 1.2258064516129032, 1.0287105358654893, 1.1666666666666667, 1.0, 1.0639662139409585, 1.0, 1.0, 1.1496960486322187, 1.5, 1.1857564817853627, 1.0, 1.2568493150684932, 1.2222222222222223, 1.024917811799337, 1.0525020508613618, 1.1111111111111112, 1.0628729351171409, 1.0, 1.0187845303867404, 1.1505305039787799, 1.0206799859796705, 1.0829954686382066, 1.0, 1.0681818181818181, 1.0853831294269156, 1.0279540646721064, 1.0853749072011878, 1.4, 1.0029493087557604, 1.030266043511842, 1.0221450282240556, 2.0, 1.0904933028422084, 1.0717905488193376, 1.086522551374433, 1.1949687817627415, 1.018211877760843, 1.0321881841676406, 1.0566037735849056, 1.063050847457627, 2.5, 1.0654579906119461, 1.038360941586748, 1.0235626767200754, 1.049771167048055, 1.0291777188328912, 1.0431200936086045, 1.3142857142857143, 1.0480242433908848, 1.10875106202209, 1.0143245268877648, 1.0199714693295292, 1.0081782148412022, 1.1866415094339622, 1.0833333333333333, 1.1555555555555554, 1.01330647970461, 1.065263157894737, 1.031316261621269, 1.0062213352447074, 2.0, 1.1700913242009132, 1.4017341040462428, 1.5714285714285714, 1.0851063829787233, 1.0109088764313041, 1.2007575757575757, 1.046488125315816, 1.0, 1.0461538461538462, 1.0288484275242373, 1.0180479778297393, 1.029490616621984, 1.0466060929983967, 1.0388420666910956, 1.1193284936479129, 1.0919540229885059, 1.0694666541247295, 1.1917808219178083, 1.0359354001755599, 1.0654978498180616, 1.152073732718894, 1.0254637392284012, 1.0140977443609023, 1.0198491108316867, 1.0, 1.1104417670682731, 1.5282392026578073, 1.7814070351758795, 1.002020202020202, 1.105, 1.0415973377703827, 1.0264993026499303, 1.041224340103284, 1.0, 1.8653846153846154, 1.2222222222222223, 1.3333333333333333, 1.0404040404040404, 1.2384105960264902, 1.3600713012477719, 1.152073732718894, 1.0210763520678685, 1.0373393185064272, 1.0190534726490472, 1.007981045018082, 1.0230975309535877, 1.0068155111633372, 1.0454351910677355, 1.1223491027732464, 1.0618119266055046, 1.012686242260062, 1.0776119402985074, 1.0259009009009008, 1.134517766497462, 1.0677966101694916, 1.019971293828173, 1.259923175416133, 1.0124572156332086, 1.180952380952381, 1.143606738470036, 1.2604166666666667, 2.5, 1.0219244823386116, 1.0666666666666667, 1.3333333333333333, 1.0935672514619883, 1.0114402084393999, 1.0192678227360308, 1.0342298288508558, 1.0511363636363635, 1.0121409715210277, 1.1833982825809566, 1.0228136882129277, 1.0, 2.0, 1.1260963594857623, 1.3870967741935485, 1.020712510356255, 1.0035260930888577, 1.0, 1.1069379238393322, 1.1173708920187793, 1.0076926685116563, 1.1925373134328359, 1.0266537255487531, 1.0010676034025554, 1.0111401770379178, 1.131578947368421, 1.125, 1.0926313690298135, 1.0, 1.08560794044665, 1.1594827586206897, 1.1029065200314219, 1.0122399020807833, 1.1935483870967742, 1.0545248231649742, 1.1094890510948905, 1.0522217132386624, 1.1238153469886885, 1.0152317880794701, 1.0304295942720765, 1.0478162279404515, 1.0212014134275618, 1.010379500486539, 1.2, 1.0538015463917525, 1.0963727639114755, 1.0952380952380953, 1.002061855670103, 1.021065473769825, 1.1048951048951048, 1.0774809436075286, 1.2, 1.0972762645914398, 1.066339323025491, 1.2219020172910662, 1.1397058823529411, 1.0238507405270245, 1.308411214953271, 2.142857142857143, 1.0504891132849479, 1.0633549316054716, 1.012732725935148, 1.1154598825831703, 1.0259030726834641, 1.0234354785051565, 1.0061633281972264, 1.0440089945390298, 1.1230283911671923, 1.0017586109293726, 1.0766855378281008, 1.0294339622641508, 1.1399032116146062, 1.0466824912399684, 1.0416666666666667, 1.087287535410765, 1.263157894736842, 1.6, 1.053416149068323, 1.0241341193809874, 1.039030531948379, 1.1578947368421053, 1.4444444444444444, 1.0251177394034536, 1.1096614950634698, 1.3305785123966942, 1.0058908144393452, 2.0, 1.072617896659147, 1.5, 1.4710982658959537, 1.1333333333333333, 1.0364942278054028, 1.2727272727272727, 1.2290748898678414, 1.129547471162378, 2.0, 1.037661050545094, 1.077238150965477, 1.5, 1.0, 1.13013698630137, 1.1650485436893203, 1.0734561752988048, 1.014453477868112, 1.0651872399445215, 1.180385288966725, 1.0637119113573408, 1.0103365850507138, 1.4974093264248705, 1.2317596566523605, 1.6785714285714286, 1.0, 1.0513728963684676, 1.125866050808314, 1.0673431734317342, 1.203331953642384, 1.018592409379972, 1.225240496673306, 1.0070170458052015, 1.0880459995426182, 1.0835850956696877, 1.01001001001001, 1.2, 1.5, 1.0810810810810811, 1.0111221926247618, 1.1550126368997473, 1.0165289256198347, 1.2792553191489362, 1.0975344220300993, 1.0014712438698172, 1.0039124169504061, 1.1818181818181819, 1.0434782608695652, 1.1274509803921569, 1.1663261361753825, 1.0376589587702765, 1.0613304238577002, 1.1758241758241759, 1.061607860100105, 1.0319793914746573, 1.0288638464988968, 1.0226415094339623, 1.0296342189536698, 1.0398671096345515, 1.0584958217270195, 1.0473235065942592, 1.007864998979148, 1.3333333333333333, 1.050476526650194, 1.0, 1.111578947368421, 1.051708964969057, 1.2121212121212122, 1.0020733927883145, 1.1488986784140969, 1.0, 1.0226983067305941, 1.00048020648879, 1.1130705394190872, 1.0007830853563038, 1.0018674136321195, 1.0065397915735492, 1.1597222222222223, 1.0, 1.0, 1.4, 1.0088588437090102, 1.8571428571428572, 1.083322384843787, 1.0536174985978688, 1.192715108715852, 1.0966860888565186, 1.001819225662923, 1.0577781746740489, 1.0578778135048232, 1.023094688221709, 1.0295614361545844, 1.0237819950562157, 1.004081077948189, 1.0139153545281316, 1.2222222222222223, 1.0051413881748072, 1.3311475409836067, 1.0184281683517518, 1.059782608695652, 1.0370776255707763, 1.1693667157584684, 1.0, 1.0487759750409922, 1.0531791907514452, 1.0187449550061287, 1.263157894736842, 1.0368330262280943, 1.0244308832305893, 1.1390134529147982, 1.009834913944503, 1.2857142857142858, 1.0915841584158417, 1.089946777054997, 1.052452039440555, 1.2712765957446808, 1.0046290716522244, 1.1428571428571428, 1.101130604288499, 1.2630257376020089, 1.1410419313850064, 1.0863309352517985, 1.0607142857142857, 1.1323106423777565, 1.0826330532212884, 1.0289846567925576, 1.04642166344294, 1.0382959265327898, 1.0164591949126125, 1.1333333333333333, 1.0417522245037645, 1.042605288932419, 1.0950073082544811, 1.0230125523012552, 1.2950819672131149, 1.1730959446092977, 1.1782178217821782, 1.0616174582798459, 1.0003796507213363, 1.083916083916084, 1.0184864240323512, 1.0105928021580368, 1.0200786586628028, 1.6, 1.0127426285375611, 1.1260553837601195, 1.0862533692722371, 1.0784313725490196, 1.0081291466859357, 1.08466549874083, 1.053627760252366, 1.2532751091703056, 1.0558591378263509, 1.0074945373603708, 1.0098039215686274, 2.25, 1.0283251231527093, 1.012763368780636, 1.0212048192771084, 1.2269938650306749, 1.013930950938825, 1.0011587149850816, 1.0125830959164293, 1.0991831971995332, 1.0285714285714285, 1.1586051743532058, 1.6, 1.1099476439790577, 1.9655172413793103, 1.08911833011556, 1.0082440230832646, 1.072595281306715, 1.1395348837209303, 1.0989690721649485, 1.0364963503649636, 1.0515463917525774, 1.0731707317073171, 1.0103911980440097, 1.1363636363636365, 1.0698254364089776, 1.6, 1.058564941714333, 1.2478632478632479, 1.2012526096033402, 1.1441441441441442, 2.230769230769231, 1.0516540917005224, 1.1083996631873283, 1.002091053467443, 1.1631205673758864, 1.345679012345679, 1.105263157894737, 1.0857142857142856, 1.2340425531914894, 1.2307692307692308, 1.1134554140127388, 1.018029116601413, 1.0061291887454287, 1.0810810810810811, 1.0022661369500194, 1.000004167395961, 5.0, 1.0006451431937393, 1.0237052306106673, 1.0, 1.2857142857142858, 1.0510805500982319, 1.1438995215311005, 1.055162884097303, 1.0925925925925926, 1.0, 1.1865671641791045, 1.1290322580645162, 1.8333333333333333, 1.0218652554353616, 1.068746912563807, 1.0007188374261735, 1.1953424996903257, 1.3333333333333333, 1.000394471876638, 1.0601023017902813, 1.143559488692232, 1.28740581270183, 1.0772727272727274, 1.0, 1.369047619047619, 1.0529075309818876, 1.0687468770998811, 1.6764705882352942, 1.0068027210884354, 1.0370102346738344, 1.2213352685050798, 1.080267558528428, 1.234375, 1.0689171928031824, 1.0020447806972703, 1.083390230850141, 1.5118110236220472, 1.2580645161290323, 1.0148026315789473, 1.1111111111111112, 1.0406046235921755, 1.0272952853598014, 1.0043013788184951, 1.028906955736224, 1.5, 1.191449814126394, 1.0115958481998053, 1.0800724637681158, 1.31051424828038, 1.108775782291585, 1.0100544616673648, 1.0682482496091361, 1.0077071290944124, 1.0555555555555556, 1.0184654356376242, 1.0229547749011825, 1.0039350713231678, 1.1257396449704142, 2.5, 1.0434782608695652, 1.059281390978558, 1.2014388489208634, 1.0057536802819822, 1.0074441523004682, 1.1186032510535822, 1.5, 1.0087976539589443, 1.0555991437344414, 1.036739380022962, 1.0578778135048232, 1.0188345705986046, 1.1487341772151898, 1.3209876543209877, 1.1077669902912621, 1.0043865107962808, 1.0000680920604657, 1.0584958217270195, 1.0904311251314407, 1.0256410256410255, 1.0996299459151722, 1.2588793631353337, 1.0340946146692593, 1.0411840411840412, 1.037754114230397, 1.069690992767916, 1.0392156862745099, 1.054673721340388, 3.0, 1.0, 1.4666666666666666, 1.00625, 1.1342019543973942, 1.05791841166434, 1.0461914502781473, 1.031483208955224, 1.02085868242656, 1.0446428571428572, 1.1424406497292794, 1.030103350628581, 1.3333333333333333, 1.2857142857142858, 1.2001094990418835, 1.1111111111111112, 1.1275, 1.1194331983805668, 1.0038239484141862, 1.0299033195862348, 1.25, 1.0506329113924051, 1.1323529411764706, 1.035897728569798, 1.0000114621062766, 1.0708661417322836, 1.0293599530240751, 1.0411445385825173, 1.0583781724679777, 1.1150793650793651, 1.3859649122807018, 1.220023282887078, 1.3333333333333333, 2.0, 1.0000335089450267, 1.5, 1.4444444444444444, 1.3673469387755102, 1.0214504596527068, 1.0134204137214324, 1.0920454545454545, 1.027237354085603, 1.0, 1.0146007604562737, 1.0227722772277228, 1.449438202247191, 1.0387755102040817]
origin-bjaq_15.87 	max: 6.0000	99th: 2.5000	95th: 1.6787	median: 1.0655	mean: 1.1647

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 19.310847 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=40.887585