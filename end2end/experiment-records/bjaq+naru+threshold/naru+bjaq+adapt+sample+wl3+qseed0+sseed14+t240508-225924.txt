Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='naru', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 14, 'naru': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.5720	median: 1.0624	mean: 1.1494
ReportEsts: [1.1977186311787071, 1.0437618918184288, 1.051116534750576, 1.0153846153846153, 1.0714285714285714, 1.0, 1.188977821225637, 1.0124847406241475, 1.25, 1.0263504611330698, 1.0773093238680633, 1.0021706917617699, 1.008044030482642, 1.0372093023255815, 1.0127163546450018, 1.0, 2.0, 1.0003543586109143, 3.0, 2.6666666666666665, 1.173913043478261, 1.0818201423334053, 1.0482122835430423, 1.0683814303638646, 1.0833744449926, 1.0, 1.0407108973942427, 1.6666666666666667, 1.4, 1.1510791366906474, 1.0, 1.0046126982382113, 1.0172389400127946, 1.3995560488346281, 1.0569834043178146, 1.0226118746191863, 1.0, 1.0036617050724814, 1.1334458296025898, 1.1785714285714286, 1.0833333333333333, 1.0853658536585367, 1.0, 1.1099740291862479, 1.1078204534937528, 1.2148760330578512, 1.1067961165048543, 1.1991525423728813, 1.0357795615150724, 1.0188679245283019, 1.095312085953121, 1.0981132075471698, 1.0041095795955235, 2.0, 1.2467532467532467, 1.003076923076923, 1.1151662611516626, 1.0727969348659003, 1.0993788819875776, 1.25, 1.015221737549982, 1.037359900373599, 1.0909090909090908, 1.1149425287356323, 1.0, 1.0788134713232496, 1.0499742400824317, 1.1666666666666667, 1.0, 1.061658749010293, 1.0274463007159904, 1.0633720930232557, 1.087837837837838, 1.1460096883104174, 1.204705882352941, 1.1065573770491803, 1.3333333333333333, 1.0453950240069838, 2.0, 1.0424402421877241, 1.0666666666666667, 1.0658250375396252, 1.1595092024539877, 1.0275229357798166, 1.0559585492227979, 1.04, 1.0012888150128882, 1.044071353620147, 1.1666666666666667, 2.3333333333333335, 1.1231231231231231, 1.014034386010317, 1.0218068535825544, 1.3281907433380085, 1.23868778280543, 1.0845070422535212, 1.238532110091743, 1.0408525754884548, 1.0, 1.0203951561504143, 1.1065514758819295, 1.029126213592233, 1.0069644316526312, 1.088235294117647, 1.0128647877498562, 1.09985401459854, 1.0256536551327833, 1.0538490709139174, 1.0251414204902578, 1.1666666666666667, 1.3333333333333333, 1.1505376344086022, 1.0287098455657648, 1.0768707482993198, 1.0129870129870129, 1.0040259131044065, 1.0, 1.171840354767184, 1.1521531100478468, 1.0, 1.1978021978021978, 1.1666666666666667, 1.0927318295739348, 1.0190692130014467, 1.0593305894230023, 1.037037037037037, 1.8, 1.2417218543046358, 1.0, 1.25, 1.0024537117502121, 1.1818181818181819, 1.06884765625, 1.0062991829275185, 1.038935676797266, 1.1851265822784811, 1.0735294117647058, 1.0321802091713597, 1.00199203187251, 1.0465561224489797, 1.050227716330514, 1.1604938271604939, 1.0352250489236792, 1.0236093025519952, 2.0, 1.0124596215966775, 1.0330578512396693, 1.055210918114144, 1.039350626433739, 1.0, 1.1318530701754386, 1.0074074074074073, 1.018, 1.4476190476190476, 1.032116788321168, 1.111277632071937, 1.0108436638196472, 1.058932275227703, 1.173003802281369, 1.1282894736842106, 1.0204081632653061, 1.0942028985507246, 1.1567291311754684, 1.1428571428571428, 1.0102361599247327, 1.0033930872519043, 1.0023028209556708, 1.0471028037383177, 1.0348197923029934, 1.0784235774296997, 1.0378947368421052, 1.0588235294117647, 1.2081921177495885, 1.0634408602150538, 1.1263362487852284, 1.0608247422680412, 1.041969075418113, 1.019713190850551, 1.145551832234353, 1.1666666666666667, 1.4, 1.0085397096498718, 1.0476190476190477, 1.1280059193488716, 1.1875, 1.040215780961967, 1.0643859311935422, 1.0067548427864816, 1.1153846153846154, 1.1311053984575836, 1.0503067484662576, 1.0, 1.4545454545454546, 1.1056529692589123, 1.3904653802497162, 1.088855421686747, 1.4, 1.0186495176848875, 1.0048197228402451, 1.0242846385542168, 1.1798245614035088, 1.0612416991672815, 1.10625, 1.015625, 1.0, 1.0, 1.0457516339869282, 1.0186345381526105, 1.5818815331010454, 1.1494252873563218, 1.0192782995551162, 1.0957683741648108, 1.0722696794341875, 1.0119886571019456, 1.0921608105475094, 1.3134328358208955, 1.005813953488372, 1.044331641285956, 1.0180653684875638, 1.0303266491886913, 1.0, 1.0641821946169772, 1.0703523526283654, 1.0088449000188848, 1.064168086314594, 1.0556518390140575, 1.0022838775164946, 1.0344827586206897, 1.00095842449543, 1.1164531452425508, 1.146644106034969, 1.0909090909090908, 1.023349607302059, 1.016116352201258, 1.0905511811023623, 1.0, 1.04031465093412, 1.124720857525681, 1.018987341772152, 1.373134328358209, 1.0909090909090908, 2.6666666666666665, 1.05847593253724, 1.1454545454545455, 1.1371976799328785, 1.5, 1.0, 1.3333333333333333, 1.0183450429352068, 1.6122448979591837, 1.1298342541436464, 1.1179245283018868, 1.0910683012259195, 1.014480408858603, 1.0026978766352237, 1.0175438596491229, 1.0, 1.0191110831709311, 1.108343625634692, 1.043782837127846, 1.075593029792018, 1.103901051455275, 1.019240734858996, 1.102543720190779, 1.0291709944897276, 1.062200956937799, 1.181251026104088, 1.2133810162419907, 2.0, 1.1004108206803767, 1.11727078891258, 1.2727272727272727, 1.1363636363636365, 1.1618181818181819, 1.1111111111111112, 1.1584158415841583, 1.0103896103896104, 1.1114206128133706, 1.173529411764706, 1.0136970941623586, 1.0567375886524824, 1.0003766714796911, 1.0105693774573006, 1.5, 1.0499454347035286, 1.2, 1.011209230203159, 1.0259179265658747, 1.0058258613627054, 1.275, 1.0, 1.0, 1.4647887323943662, 1.0322975210758731, 1.0, 1.0856269113149848, 1.0158371040723981, 1.0388621794871795, 1.002500895256451, 1.0677966101694916, 1.0062893081761006, 1.0314697299957811, 1.0295365812255983, 1.0977172958735733, 1.0683760683760684, 1.0, 1.2350835322195703, 1.002469135802469, 1.2149532710280373, 1.0038903924221922, 1.0101095197978096, 1.0757575757575757, 1.372093023255814, 1.0205761316872428, 1.080568720379147, 1.4285714285714286, 1.0106633376749363, 1.0567765567765568, 1.1875, 1.0279027902790279, 1.2857142857142858, 1.75, 1.0155381478699432, 2.0, 1.0195804195804197, 1.065406976744186, 1.0057424118129614, 1.0303975058456742, 1.156657963446475, 1.10989010989011, 1.0059389331565634, 1.0346388841556924, 1.0068119891008174, 1.0122914189660122, 1.1112485504445304, 2.0, 1.2222222222222223, 1.0217023313370457, 1.3333333333333333, 1.048687089715536, 1.0, 1.0, 1.0454545454545454, 1.1474654377880185, 1.0979631425800194, 1.2285714285714286, 1.0595238095238095, 1.0, 1.1078561917443408, 1.0202350279645573, 1.5, 1.0780226325193567, 1.0, 1.0153799438244895, 1.1125, 1.119627394384676, 1.172811059907834, 1.0018181818181817, 1.1532416502946954, 1.1203703703703705, 1.0082451261810788, 1.0016072803729656, 1.0106524633821572, 1.0, 1.1428571428571428, 1.8333333333333333, 1.5, 1.1428571428571428, 1.0025141784230764, 1.25, 1.0715474209650582, 1.1287128712871286, 1.0165104059344736, 1.0305701577031945, 1.018887722980063, 1.1103055778585935, 1.0366806975345761, 1.2556053811659194, 1.5, 1.0354166666666667, 1.0981308411214954, 1.0126161130730933, 1.1904761904761905, 3.142857142857143, 1.1046770601336302, 1.0127906976744185, 1.0123781797158904, 1.1724137931034482, 1.342769701606733, 1.049684089603676, 1.3559322033898304, 1.0808477237048666, 1.0158898305084745, 1.2115384615384615, 1.0568862275449102, 1.1495327102803738, 1.0422816609103722, 1.0042123690472935, 1.0168934971490633, 1.1025641025641026, 1.0277777777777777, 1.0623145400593472, 1.0, 1.0412376312220604, 1.0109527005220207, 1.0336028709248946, 1.002716711349419, 1.0125262956588257, 1.0135265700483091, 1.8333333333333333, 1.0048473097430926, 1.2, 1.0905209222886423, 1.1111111111111112, 1.0155645672984082, 1.017391304347826, 1.0243981083404987, 1.209486166007905, 1.0939420544337137, 3.0, 1.073247406475951, 1.0079353677138132, 1.0479124517196983, 1.0, 1.125, 1.021113243761996, 1.2729885057471264, 1.115624739865146, 1.0833333333333333, 1.2352941176470589, 1.267471958584987, 1.0563021478486456, 1.0848232615430555, 1.0026138153783872, 1.1283991228070176, 1.2172470978441128, 1.0476190476190477, 1.5, 1.0050761421319796, 1.3, 1.0429740791268758, 1.2424242424242424, 1.0799627489576058, 1.4705882352941178, 1.120305894056205, 1.0149126172951477, 1.1383426966292134, 1.0, 1.0555555555555556, 1.2, 1.001676021203617, 1.4026258205689277, 1.0, 1.0714285714285714, 1.0167382256167108, 1.2193026781202627, 1.0, 2.0, 1.2, 1.012704174228675, 1.337719298245614, 1.0, 1.022536117158124, 1.090628218331617, 1.0869565217391304, 1.0566101694915255, 1.0272727272727273, 1.0144356955380578, 1.1830645161290323, 1.0395456457719814, 1.1079157338843924, 1.0, 1.054054054054054, 1.102131968680494, 1.0087904716591138, 1.0600898555953577, 1.0, 1.0491993501972616, 1.022912223546995, 1.0282870612886328, 2.0, 1.1156299840510366, 1.0474200838001977, 1.0836842776927003, 1.2246734524485605, 1.0285056237561772, 1.1976506639427988, 1.0487394957983194, 1.0925747348119577, 2.0, 1.1106517132668354, 1.3214285714285714, 1.0, 1.2953020134228188, 1.1304347826086956, 1.0430352454313088, 1.1166982922201139, 1.1026817286923944, 1.0712881022615537, 1.0292170974983221, 1.021697070204533, 1.0081775835962874, 1.058252427184466, 4.0, 1.0419013323730644, 1.0266001662510391, 1.005477767211976, 1.0129338870718678, 1.1020408163265305, 1.2890173410404624, 1.066326530612245, 1.4285714285714286, 1.028431212989972, 1.002882842616906, 1.0264870060256552, 1.0963682128730672, 1.0626504789713642, 1.0062240663900415, 1.0151706326518541, 1.0102481121898597, 1.0753424657534247, 2.0, 1.0, 1.0332805071315372, 1.0560747663551402, 1.0016806722689076, 1.0083932853717026, 1.1617312072892938, 1.228395061728395, 1.0554699537750385, 1.0769230769230769, 1.0140904638945776, 1.3780487804878048, 1.0260854452379449, 1.0, 1.1307879772542648, 1.4841269841269842, 1.2198581560283688, 1.0266704903928878, 1.1613722998729352, 1.0675105485232068, 1.1024643320363166, 1.0385519566869301, 1.0, 1.7872340425531914, 1.1666666666666667, 1.0, 1.0232558139534884, 1.2277227722772277, 1.3935483870967742, 1.08994708994709, 1.0289971163088754, 1.1447543160690572, 1.0341201055119729, 1.0106980871622955, 1.108910891089109, 1.003024232758956, 1.088235294117647, 1.1009771986970684, 1.1441702951136914, 1.1029773285987434, 1.1416184971098267, 1.0661489790048893, 1.0323306303949777, 1.0050353085661652, 1.0101266420385473, 2.0, 1.0654450261780104, 1.0591497227356748, 1.0410958904109588, 1.0, 1.0196078431372548, 1.1538461538461537, 1.1345381526104417, 1.6296296296296295, 1.5, 1.0281433505329678, 1.0367513772880754, 1.0035632064978401, 1.053766006521912, 1.0648648648648649, 1.0364520048602672, 2.0, 1.1492537313432836, 1.1315851088738, 1.000929688952639, 1.0065059133673544, 1.0713634810342865, 1.0015018773466833, 1.0906515580736544, 1.0568729705795532, 1.236234458259325, 1.0137228961589344, 1.0434402003049756, 1.393939393939394, 1.0876623376623376, 1.0, 1.0136054421768708, 1.0213989196324667, 3.0, 1.0697247706422017, 1.0240787872081443, 1.2857142857142858, 1.1566666666666667, 1.2, 1.1875, 1.0227407932011332, 1.7692307692307692, 1.0065017607668307, 1.0346005980350277, 1.2258064516129032, 1.2608695652173914, 1.2696335078534031, 1.0091698841698842, 1.1051475969748719, 1.0599655150392746, 1.011126230689186, 1.0, 1.1574516619595916, 1.0091463414634145, 2.0, 1.1000991766035473, 1.0658361449952418, 1.1050141911069062, 1.012817825645325, 1.0101942348138067, 1.3780487804878048, 2.0, 1.0414606314187904, 1.0763888888888888, 1.0316630750173927, 1.071714476317545, 1.040055559077627, 1.0966495042244053, 1.031135531135531, 1.0358381502890173, 1.1544401544401544, 1.0154549702917417, 1.0712933753943217, 1.1253822629969419, 1.069327731092437, 1.0573374591292, 4.0, 1.0157691904362416, 1.0022564388027952, 1.0271509814712896, 1.1176470588235294, 1.0054454063110863, 1.2262443438914028, 1.0, 1.0200381336115407, 1.0134426229508198, 1.1393034825870647, 1.1764705882352942, 1.6666666666666667, 1.0227112319271003, 1.5, 1.4032786885245903, 1.0769230769230769, 1.1470937129300118, 1.2857142857142858, 1.234375, 1.1079664570230607, 1.0, 1.1917989417989419, 1.0537560303239146, 2.0, 1.0, 1.0725806451612903, 1.0902255639097744, 1.047859690844233, 1.0138297872340425, 1.0094637223974763, 1.0303951367781155, 1.089150378938971, 1.051948051948052, 1.5605095541401275, 1.225, 1.1153846153846154, 1.0, 1.0352112676056338, 1.1818181818181819, 1.004149377593361, 1.3089232438296718, 1.0034610384286533, 1.181413983485611, 1.0001260052625727, 1.0619577790630421, 1.0601684717208182, 1.0005970149253731, 1.375, 1.0, 1.0625, 1.003495518273412, 1.1409869083585096, 1.0065359477124183, 1.215568862275449, 1.1016418480336005, 1.0636330003699592, 1.008975451310176, 1.064102564102564, 1.1578947368421053, 1.065877128053294, 1.1014713679745494, 1.0450065597900866, 1.062781691537028, 1.2171052631578947, 1.1192409923213231, 1.0047080692345198, 1.14014598540146, 1.023983315954119, 1.2222222222222223, 1.0457979225684608, 1.2016238159675237, 1.0, 1.0280112044817926, 1.0347890451517394, 1.0, 1.0233644859813085, 1.0434709237571298, 1.1481481481481481, 1.022807059441645, 1.1779661016949152, 1.0238095238095237, 1.0356801027393112, 1.0174477289113193, 1.1536059629331183, 1.031496062992126, 1.0513126491646778, 1.0080308836789902, 1.222707423580786, 1.1428571428571428, 1.0, 1.1111111111111112, 1.0178999636671915, 1.8333333333333333, 1.0476640136696793, 1.0497549943460234, 1.0813026140894992, 1.0555555555555556, 1.0042104464590524, 1.052625937834941, 1.073076923076923, 1.00557880055788, 1.0273933359945524, 1.1064381466020172, 1.00329794118352, 1.026074912682163, 1.25, 1.046875, 1.284584980237154, 1.0068756107776071, 1.01628664495114, 1.0014780405405406, 1.1946902654867257, 1.02729044834308, 1.0462059320285215, 1.0419580419580419, 1.0000956937799044, 1.25, 1.021385875320641, 1.0111738317138175, 1.1240584847142223, 1.0008428150021071, 1.0625, 1.0032119914346895, 1.0945273631840795, 1.6875, 1.0411733708062534, 1.3846153846153846, 1.070118662351672, 1.043956043956044, 1.2252191503708698, 1.0285763768617942, 1.0788235294117647, 1.5714285714285714, 1.051643192488263, 1.0142284642817752, 1.0056262326589676, 1.0134969712266533, 1.0546471600688467, 1.0567361789285374, 1.1538461538461537, 1.0342857142857143, 1.1673888255416192, 1.1228403053707754, 1.0183673469387755, 1.2013888888888888, 1.0699469368065606, 1.015656207718575, 1.1709183673469388, 1.0054959434702957, 1.0, 1.3333333333333333, 1.0027886968775495, 1.0196556671449069, 1.0121287513605972, 1.0874516285069333, 1.0263367916999202, 1.0588235294117647, 1.0041103586953308, 1.112259276655707, 1.005514705882353, 1.372972972972973, 1.0364145658263306, 1.0150465846245826, 1.0238095238095237, 1.75, 1.0335759091249106, 1.0093209798907194, 1.0323719835197174, 1.3037037037037038, 1.0061930783242259, 1.0185270433926585, 1.0093643586833143, 1.015, 1.2307692307692308, 1.091644204851752, 1.0315789473684212, 1.09375, 1.7916666666666667, 1.0682199128394234, 1.0118929633300298, 1.0884476534296028, 1.28125, 1.0245761861771492, 1.0714138711669068, 1.0117495682795516, 1.064468211527035, 1.3333333333333333, 1.0, 1.3333333333333333, 1.02866356144751, 1.4615384615384615, 1.3333333333333333, 1.5, 1.2256493506493507, 1.0, 1.139186883445449, 1.0162817421140369, 1.2557077625570776, 1.6176470588235294, 1.0666666666666667, 1.064516129032258, 1.2567567567567568, 1.2962962962962963, 1.0124610591900312, 1.0100801685768896, 1.0030331788831202, 1.0390625, 1.0010873802342997, 1.0014563835643862, 5.0, 1.0052482052328944, 1.0542857142857143, 1.0, 1.3333333333333333, 1.1511834319526628, 1.0982571899878075, 1.043707647051818, 1.062111801242236, 1.0, 1.0932203389830508, 1.2638036809815951, 2.0, 1.5, 1.0238681102362204, 1.0379517231756663, 1.1854540068138053, 1.25, 1.0043365422638413, 1.0712625871417505, 1.079734219269103, 1.1428571428571428, 1.1210526315789473, 1.0027394773816647, 1.2236842105263157, 1.107570200228489, 1.0454803520012976, 1.0658823529411765, 1.0078740157480315, 1.0075776500957616, 1.1801878736122973, 1.1322314049586777, 1.0454545454545454, 1.0574005811180016, 1.1164823159907142, 1.038052812960562, 1.5462962962962963, 1.2, 1.1492537313432836, 1.0268886043533931, 1.032572298325723, 1.0138332321392431, 1.0164137479745732, 1.0283842794759825, 3.0, 1.25, 1.0155813802506006, 1.1578715919085312, 1.4176230305388058, 1.0087465722474296, 1.0190667335674861, 1.0732065616583695, 1.054421768707483, 1.1041666666666667, 1.0124960203756765, 1.0040373117462145, 1.0630524454920447, 1.1050788091068302, 2.5, 1.0933333333333333, 1.00597967643714, 1.1132616487455198, 1.0023610720205147, 1.0018113801929514, 1.1136363636363635, 1.6, 1.0035046728971964, 1.0506807253345694, 1.0221612976924834, 1.0760456273764258, 1.0229223287083393, 1.2661290322580645, 1.3522388059701493, 1.0707246376811594, 1.002211303104917, 1.0471614950634698, 1.1013824884792627, 1.11651728553137, 1.03125, 1.0799726589200274, 1.0076687469774084, 1.0990752972258917, 1.0719007981365396, 1.046592894583576, 1.0376766091051806, 1.2857142857142858, 1.0445859872611465, 2.5, 1.5, 1.4166666666666667, 1.0281329923273657, 1.127962085308057, 1.0500204240781315, 1.0649413350823496, 1.003527815468114, 1.0376569037656904, 1.0978260869565217, 1.469387755102041, 1.0395073611445322, 1.6, 1.3333333333333333, 1.0734959349593496, 1.0, 1.141337386018237, 1.1437908496732025, 1.1078864353312303, 1.0259288114135463, 1.25, 1.0842105263157895, 1.3313953488372092, 1.124438902743142, 1.0000045873032621, 1.14616497829233, 1.040256501603135, 1.0208735065503052, 1.0265105489892854, 1.152623211446741, 1.4791666666666667, 1.2416201117318435, 1.0, 1.0, 1.0008583383999141, 1.6666666666666667, 1.5714285714285714, 1.588235294117647, 1.0675512665862485, 1.119047619047619, 1.0261660978384528, 1.0949312714776633, 1.0, 1.2594661700806953, 1.0288461538461537, 1.1345291479820627, 1.032258064516129, 1.25, 1.001105216622458, 1.1225055432372506, 1.0957446808510638, 1.001489757914339, 1.0039753366866786, 1.1322037337662338, 1.075381679389313, 1.0, 1.0353935783433352, 1.0208255661917989, 1.0177546628407461, 1.2695652173913043, 1.0380123984814262]
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.5720	median: 1.0624	mean: 1.1494

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 20.228560 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=naru', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[3.5762787e-07 1.3709068e-06 1.7881393e-07 5.9604645e-07 2.3841858e-07]
Distance score: 5.4836272056491e-07
SAUCE Drift detection: False
Detection latency: 0.0230s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 2.034829 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 4.0000	99th: 2.5000	95th: 1.7500	median: 1.0651	mean: 1.1636
ReportEsts: [1.0885714285714285, 1.041932543299909, 1.0293816384934849, 1.0388978930307942, 1.0, 1.0, 1.2495322606510932, 1.0010525019314531, 1.0, 1.0122086570477247, 1.0121062473030638, 1.0027440191214807, 1.0097526994078718, 1.0694444444444444, 1.0126619552414606, 2.375, 1.103559870550162, 1.2121212121212122, 1.4444444444444444, 1.1618773946360152, 1.099264705882353, 1.0280275492634399, 1.0112781954887218, 1.0643699002719855, 1.0351473112128147, 1.009067324531003, 2.0, 1.0658489885395566, 1.0, 1.8, 1.0784574468085106, 1.0, 1.0060895640892946, 1.01376449079333, 1.3005514705882353, 1.0639822778212145, 1.0228450704225351, 1.0089686098654709, 1.5, 1.1047696954442487, 1.0261567516525023, 1.0572628958219872, 1.13530135301353, 1.0233766233766233, 1.0658135283363803, 1.0625440391906855, 1.0434782608695652, 1.7777777777777777, 1.3687150837988826, 1.064673157162726, 1.1333333333333333, 1.1703703703703703, 1.0669642857142858, 1.0294117647058822, 1.0543126042411246, 1.0284824392442933, 1.0322395758704686, 1.182844243792325, 1.1566265060240963, 1.005494074248489, 1.171875, 1.0139506204557716, 1.0977011494252873, 1.1379310344827587, 1.1683168316831682, 1.0, 1.104953747730613, 1.0186590116875127, 1.1428571428571428, 2.0, 1.1009056732740943, 1.03248730964467, 1.0529865125240847, 1.094972067039106, 1.0842056827332336, 1.1574074074074074, 1.0486033519553073, 1.0410958904109588, 1.0851063829787233, 1.0000639450438022, 1.1459977452085681, 1.085561497326203, 1.0, 1.0, 1.0555555555555556, 1.0333333333333334, 3.5, 1.2413793103448276, 1.0, 1.0014408991210515, 1.087630548302872, 1.0040614515274588, 1.0410072711719418, 1.1962025316455696, 1.0670241286863271, 1.3191733639494834, 1.1876712328767123, 1.1556728232189974, 2.5, 1.154923939151321, 1.5, 3.0, 1.0249932178768015, 1.1861656703672074, 1.0227941176470587, 1.0077151335311574, 1.1666666666666667, 1.0046610946629286, 1.1224137931034484, 1.1097060833902939, 1.0656772971266182, 1.0046948356807512, 1.1428571428571428, 1.0, 1.1366954213669542, 1.0102867259951567, 1.1219941348973608, 1.1397849462365592, 1.0040745081168752, 2.0, 1.153379812064262, 1.1220095693779903, 1.0, 1.2580645161290323, 1.25, 1.010438413361169, 1.0101854200711475, 1.1215037788256572, 1.072, 1.5, 1.2294520547945205, 2.0, 1.368421052631579, 1.0136884942656308, 1.2307692307692308, 1.1183252427184467, 1.030926891755879, 1.0149238881703313, 1.1666666666666667, 1.3333333333333333, 1.0806794055201698, 1.1173059768064229, 1.0338445267054468, 1.036837181555649, 1.293193717277487, 1.079734219269103, 1.039173819288825, 1.0, 1.0088597842835132, 1.0088062622309197, 1.0551181102362204, 1.0195791934541203, 1.3333333333333333, 1.0225261464199518, 1.0269607843137254, 1.0165289256198347, 1.1536312849162011, 1.0, 1.0551102204408818, 1.0555804889571276, 1.0808702175543885, 1.057902973395931, 1.1232876712328768, 1.0350877192982457, 1.18562874251497, 1.1597222222222223, 1.1111111111111112, 1.006735450011555, 1.015625, 1.0558312655086848, 1.0193056536812184, 1.92, 1.1203751224746885, 1.0053763440860215, 1.1155963302752294, 1.212648349861811, 1.0702420503084955, 1.1797076526225279, 1.04093567251462, 1.032156862745098, 1.0296447027478077, 1.0113356542413179, 1.0463576158940397, 1.139344262295082, 1.0058555537568512, 1.0362321783987978, 1.041044776119403, 1.0331319787662456, 1.1685082872928176, 1.2, 1.0927318295739348, 1.0141198148782997, 1.0689655172413792, 1.0275181723779854, 1.0565622002747752, 1.0035118525021949, 1.0072040059802978, 1.0510416666666667, 1.0045377318119997, 1.0101924537857685, 1.0842151675485008, 1.0110169491525425, 1.1005194805194805, 1.0050976235968474, 1.1702349869451698, 1.1504146660846792, 1.0432692307692308, 1.0864197530864197, 1.141304347826087, 1.0, 1.1043956043956045, 1.0273324572930356, 1.7088235294117646, 1.2, 1.0098039215686274, 1.3333333333333333, 1.0026308611754633, 1.0365296803652968, 1.0468449644797326, 2.3333333333333335, 1.048602673147023, 1.0442752397067119, 1.0317411402157164, 1.009095896739915, 2.2, 1.0925373134328358, 1.0065361629266205, 1.0335197441554222, 1.056338028169014, 1.2845257903494176, 1.1353006681514477, 1.04556316711805, 1.0344827586206897, 1.0012971104942527, 1.0400702664031676, 1.187279151943463, 1.2981099656357389, 1.0366430260047281, 2.3333333333333335, 1.1040157998683344, 1.0, 1.0220456802383318, 1.089603569270809, 1.0233872539465991, 1.3373493975903614, 1.1538461538461537, 2.5, 1.0744219441432465, 1.0579710144927537, 1.1178640487877436, 1.5, 1.1149425287356323, 1.021978021978022, 1.1428571428571428, 1.0060865662475098, 1.150462962962963, 1.2060988433228181, 1.258953168044077, 1.0031903580290678, 1.0104346691883783, 1.1428571428571428, 1.5, 1.0348431438541796, 1.0858779719278144, 1.0743919885550788, 1.0431147065225277, 1.0456764811566022, 1.0332994407727505, 1.1057124097176625, 1.0134524543027317, 1.0533070088845016, 1.1438401482069604, 1.119399590629975, 1.6923076923076923, 1.1026238892002242, 1.0563636363636364, 1.1818181818181819, 1.0, 1.020511583011583, 1.118811881188119, 1.0116340923520428, 1.0080407303370786, 1.2198067632850242, 1.1935483870967742, 1.0297803213955465, 1.1290322580645162, 1.2951807228915662, 1.0169855507931598, 1.2857142857142858, 1.4, 1.022657685241886, 1.019998423360814, 1.0537929669622867, 1.0068177761913262, 1.0695792880258899, 1.0056148231330713, 1.0027928960183328, 1.0319014529374606, 1.0283506112287741, 1.0036276172075234, 1.0790243902439025, 1.3093525179856116, 1.1538461538461537, 1.078620911873691, 2.0, 1.0162748643761301, 1.0185415454350555, 1.1239550500205564, 1.105263157894737, 1.3706896551724137, 1.0682852807283763, 1.0361660431141992, 1.0157326407873155, 1.0434782608695652, 1.0405736271423576, 1.0074814944491606, 1.0472813238770686, 2.5, 2.090909090909091, 1.030551250830197, 1.3333333333333333, 1.0211098022115341, 1.0296296296296297, 1.0454545454545454, 1.0393183244709199, 1.1111111111111112, 1.8888888888888888, 1.0218464341132716, 3.0, 1.0266666666666666, 1.033457249070632, 1.1508028857342332, 1.0355359765051395, 1.1656050955414012, 1.1531531531531531, 1.0159747648284796, 1.0106079123817497, 1.4, 1.004842763858911, 1.1125917342603322, 3.0, 1.2, 1.036337783395213, 1.25, 1.0611592879963487, 1.1, 2.0, 1.08, 1.2252252252252251, 1.1093247588424437, 1.2, 1.1685214626391096, 1.2179487179487178, 2.75, 1.031516532703776, 1.5, 1.015625, 1.024223359814067, 1.2158273381294964, 1.0830645161290322, 1.0205607476635514, 2.25, 1.25, 1.16206652512385, 1.3780487804878048, 1.0107421875, 1.01274051777297, 1.0422465820913906, 1.064516129032258, 1.0, 1.002347205395069, 1.0198019801980198, 1.121212121212121, 2.0, 1.0015174506828528, 1.1, 1.0126849894291754, 1.0166666666666666, 1.0397295190748035, 1.0128328893598797, 1.0821078431372548, 1.0339047619047619, 1.0464400615470695, 1.1681818181818182, 1.0312925170068028, 1.0626591176805866, 1.086232980332829, 1.0833333333333333, 1.0029309405999196, 1.0019949840401277, 1.097279267169492, 1.058252427184466, 1.1428571428571428, 1.0147058823529411, 2.0, 1.7037037037037037, 1.2110091743119267, 1.0485981308411214, 1.5555555555555556, 1.2678571428571428, 1.0094763092269328, 1.0359558561765754, 1.0588133326729732, 1.1225190839694656, 1.2203782323427248, 1.0978260869565217, 1.0225563909774436, 1.0696517412935322, 1.0, 1.0120661609679324, 1.4210526315789473, 1.005345775326319, 1.0011031968726767, 1.0156035249413857, 1.0188222640494757, 2.2857142857142856, 1.1733758469509765, 1.0, 1.0261930391101544, 1.4, 1.0346251438117602, 1.029593094944513, 1.0976260336089625, 1.2079207920792079, 1.0723065798987708, 4.0, 1.185965925498123, 1.000659542262508, 1.0700734394124847, 1.0, 1.3653846153846154, 1.0575831305758312, 1.2564102564102564, 1.1192911884037868, 1.1398985493198928, 1.2173913043478262, 1.0256035113386979, 1.1298197002809867, 1.036805717392993, 1.0465274240108677, 1.0952449069603882, 1.0208534466113148, 1.4545454545454546, 1.2097902097902098, 1.0077426919500263, 1.6504065040650406, 1.1441784548422198, 2.0, 2.0, 1.1932335718932987, 1.165991902834008, 1.1153975176115398, 1.0426284298951074, 1.1236086701816053, 1.0, 1.0393700787401574, 1.2121212121212122, 1.0177599427867614, 1.0416666666666667, 2.0, 1.1339038803015749, 1.3333333333333333, 1.0, 1.102573807721423, 2.3333333333333335, 1.2060268588273828, 1.0060377358490566, 1.4194756554307115, 1.0, 1.0107244503719184, 1.0972696245733788, 1.1851851851851851, 1.0298470106060131, 1.0793650793650793, 1.0204313280363224, 1.1452589105581708, 1.0726375176304654, 1.0893104601710708, 1.0, 1.043956043956044, 1.0866156430838156, 1.0538485904339563, 1.0927449513836949, 1.1666666666666667, 1.0121268656716418, 1.0135371348663766, 1.0243584167029143, 2.0, 1.1186666666666667, 1.0466875300442446, 1.0726824922706073, 1.2047057104234409, 1.0407534156123954, 1.0221260446073024, 1.031700288184438, 1.0076542816137777, 2.0, 1.1386657502470037, 1.0254681647940076, 1.037726723095526, 1.0252100840336134, 1.0025575447570332, 1.0225645360648983, 1.2774193548387096, 1.0301940074667348, 1.225457961484265, 1.0763957597173144, 1.1, 1.0010675803167983, 1.2043745727956254, 1.072289156626506, 1.2195121951219512, 1.0350881647264927, 1.0924369747899159, 1.0421754830884582, 1.010886258498305, 1.3333333333333333, 1.1308840413318024, 1.2557471264367817, 1.0909090909090908, 1.255813953488372, 1.008591479825436, 1.125448028673835, 1.046415026187466, 1.0, 1.263157894736842, 1.0274361400189216, 1.0007149909774948, 1.0299079754601228, 1.0510626330802297, 1.0269188795925792, 1.194915254237288, 1.0897646414887794, 1.085016768123083, 1.2661870503597121, 1.0350441351147823, 1.0203110704483074, 1.1045454545454545, 1.0369285455682453, 1.0978886756238004, 1.0552382241472658, 1.0, 1.0929927963326784, 1.4594594594594594, 1.1109138291474556, 1.0395010395010396, 1.1066398390342052, 1.0049019607843137, 1.1419098143236075, 1.0353458498023715, 1.0, 1.5254237288135593, 1.4285714285714286, 1.0, 1.0594059405940595, 1.0408921933085502, 1.3055091819699498, 1.0432900432900434, 1.0314549591754785, 1.1203007518796992, 1.0171401226780354, 1.014208500532307, 1.021139198866368, 1.0043282912536975, 1.0467197390813037, 1.0583289542827115, 1.0409532392109742, 1.001941724370732, 1.0800589390962672, 1.0121951219512195, 1.0770142180094786, 1.1635220125786163, 1.0431070915391767, 1.2528160200250313, 1.0149792564225306, 1.1477832512315271, 1.13210111443327, 1.0327225130890052, 2.5, 1.0011890606420928, 1.2, 1.0, 1.4864864864864864, 1.013284590771807, 1.0184971098265896, 1.129973474801061, 1.0892857142857142, 1.0109188623955838, 1.16357805907173, 1.010909090909091, 1.6, 1.75, 1.0558649789029535, 1.4636363636363636, 1.0523889354568314, 1.0159866380338822, 2.0, 1.1790209790209791, 1.087378640776699, 1.0335969012100648, 1.1844802342606149, 1.0070611495551476, 1.0244320213827245, 1.0111135790325396, 1.1265822784810127, 1.25, 1.1240008198401312, 1.0, 1.0804020100502512, 1.1906779661016949, 1.0849772382397571, 1.0373514431239388, 1.3448275862068966, 1.0253871494666142, 1.1804511278195489, 1.1904761904761905, 1.2344552196235026, 1.0701754385964912, 1.0306004618937645, 1.0237705706861708, 1.0344202898550725, 1.0016244314489928, 1.4, 1.1335517523817735, 1.1215574890342992, 1.3, 1.0296819787985865, 1.0651892591394372, 1.016304347826087, 1.063637759849669, 1.0, 1.1715481171548117, 1.0080692777012399, 1.144893111638955, 1.36, 1.0131094542100052, 1.2452830188679245, 2.125, 1.039240506329114, 1.0520393811533053, 1.1075856627592426, 1.1036955322669608, 1.0489946068473348, 1.0043096648357164, 1.0122137404580154, 1.0472620599739244, 1.1806853582554517, 1.0148067794095832, 1.1068783068783068, 1.003725782414307, 1.1716054842989827, 1.027027027027027, 1.0282131661442007, 1.0748275252078543, 1.0, 1.6, 1.0122850122850122, 1.0230372281607076, 1.0494249300590612, 1.0082191780821919, 1.4444444444444444, 1.0274725274725274, 1.1014441704825644, 1.4513274336283186, 1.0130560088891976, 2.3333333333333335, 1.0082598348033038, 1.5, 1.5, 1.0588235294117647, 1.055815576034187, 1.2727272727272727, 1.2300884955752212, 1.142608695652174, 1.0, 1.0186183741987995, 1.0268006700167505, 2.25, 1.0, 1.0460526315789473, 1.076219512195122, 1.0198216055500495, 1.0079295154185022, 1.073816155988858, 1.0128205128205128, 1.0686813186813187, 1.1063204311611954, 1.4444444444444444, 1.5706806282722514, 1.5925925925925926, 1.0, 1.11864406779661, 1.1795481569560047, 1.0328767123287672, 1.2748493150684932, 1.027739036107237, 1.1894495224822723, 1.001427953266984, 1.0300561289154444, 1.0269192422731805, 1.0503778337531486, 1.625, 1.0, 1.0512820512820513, 1.0009735251725795, 1.1548936170212767, 1.029810298102981, 1.173170731707317, 1.0883765003158559, 1.0061933720839074, 1.0074478268213904, 1.0208333333333333, 1.173913043478261, 1.2386363636363635, 1.0774581792083033, 1.032477261973608, 1.0705269176636172, 1.1481481481481481, 1.1194258725387964, 1.0717389582618337, 1.0311982727599855, 1.0244274809160305, 1.0126755765406767, 1.2903225806451613, 1.0194730813287514, 1.120253164556962, 1.0098757159968217, 2.0, 1.080194410692588, 1.0, 1.0610997963340123, 1.0113336776017177, 1.25, 1.0257239103065774, 1.1265486725663716, 1.0172413793103448, 1.0803727196635842, 1.0055767715342183, 1.1067190349277598, 1.0186385737439223, 1.0075685903500473, 1.0137707383559713, 1.1857142857142857, 1.0555555555555556, 1.0, 1.1818181818181819, 1.0065796112781804, 1.625, 1.1207391254447376, 1.0896714872344224, 1.1474958723170061, 1.0715677590788308, 1.003669616557834, 1.080495632019968, 1.0454545454545454, 1.013095238095238, 1.0147918224198467, 1.0481831573778542, 1.0081524235585468, 1.0120994446991696, 1.5555555555555556, 1.0915841584158417, 1.3627450980392157, 1.0072773847989986, 1.0465753424657533, 1.0192891587783532, 1.178837555886736, 1.0146341463414634, 1.022759929089043, 1.0306469920544836, 1.0236610345102415, 1.0454545454545454, 1.0136558586378452, 1.0018211606449945, 1.1381359079093947, 1.0099326002128415, 1.3243243243243243, 1.1333333333333333, 1.009958071278826, 1.0744888184190533, 1.027027027027027, 1.0031325857714268, 1.2, 1.1976597356679854, 1.1950912523599748, 1.1454081632653061, 1.0444444444444445, 1.1371841155234657, 1.1633616619452314, 1.1145395044413278, 1.0282373790442734, 1.0323809523809524, 1.0521847495910897, 1.0474001539382536, 1.25, 1.0627177700348431, 1.0173754757570743, 1.0649798734905118, 1.224, 1.3917634635691658, 1.2701325178389398, 1.242540168324407, 1.0150375939849625, 1.0043686026816876, 1.3478260869565217, 1.0291885580852307, 1.024399162317588, 1.031044407894737, 1.524031007751938, 1.00665283203125, 1.0540698714092955, 1.0672043010752688, 1.1097308488612836, 1.0122898598380534, 1.1114360516934045, 1.0248833592534992, 1.2735426008968609, 1.0354609929078014, 1.0120851481504203, 1.0204081632653061, 2.0, 1.0132652794592854, 1.0087289041796457, 1.0240963855421688, 1.188235294117647, 1.0213085234093637, 1.020496894409938, 1.0160188457008246, 1.1242397914856646, 1.21875, 1.0755136035535813, 1.75, 1.1296296296296295, 1.8064516129032258, 1.0662251655629138, 1.023121387283237, 1.1142857142857143, 1.25, 1.0057053941908713, 1.0753554502369669, 1.02, 1.4090909090909092, 1.02652683528686, 1.12, 1.0018630647414997, 1.5, 1.0369104225585564, 1.0193298969072164, 1.2056270996640537, 1.1043478260869566, 1.1578947368421053, 1.0965942454492072, 1.1047042649684748, 1.0102692016823447, 1.1643598615916955, 1.3604651162790697, 1.1176470588235294, 1.09375, 1.3928571428571428, 1.3278688524590163, 1.0339715873996294, 1.0125188260961362, 1.0070344028698122, 1.0733333333333333, 1.0038736064985445, 1.0021498104827264, 3.0, 1.003389494277877, 1.1029367545354314, 1.3333333333333333, 1.1428571428571428, 1.066699604743083, 1.1304295942720763, 1.0571488070446837, 1.0618556701030928, 1.0, 1.01628664495114, 1.0248756218905473, 1.2222222222222223, 1.0040148497299102, 1.0063821026626407, 1.0033905433604555, 1.1822085889570553, 1.2, 1.01299096863613, 1.092885375494071, 1.1178743961352657, 1.3340471092077089, 1.1143523920653442, 1.0, 2.0, 1.0696820334396444, 1.0407519830954737, 1.7727272727272727, 1.0031746031746032, 1.0353355673889093, 1.1946647440519107, 1.1288135593220339, 1.360655737704918, 1.0412981871519915, 1.1307049714751427, 1.0484006539630344, 1.3661971830985915, 1.268041237113402, 1.0106382978723405, 1.1111111111111112, 1.0259022118742724, 1.0794044665012408, 1.013786532560774, 1.0384615384615385, 1.5, 1.0499663903204122, 1.0592174981984654, 1.1226927252985885, 1.3118764081107177, 1.0163014628311864, 1.0011068068622024, 1.099021241149521, 1.1122661122661122, 1.0344827586206897, 1.020746887966805, 1.0133998904034522, 1.095609756097561, 1.0882800608828007, 2.5, 1.1797752808988764, 1.1419878296146044, 1.2341040462427746, 1.0110625796219743, 1.010708909945693, 1.1302521008403361, 1.8, 1.044204322200393, 1.0171154169547263, 1.0334600760456274, 1.039877300613497, 1.0007450417471726, 1.2983050847457627, 1.193118756936737, 1.0709426627793974, 1.0034077495197895, 1.0247730711043872, 1.0936902485659656, 1.148068669527897, 1.0, 1.0506634499396863, 1.11649011537683, 1.1101921232077576, 1.0513860716700474, 1.0152598950882212, 1.0486202365308803, 1.08, 1.0264084507042253, 3.0, 1.5, 1.5714285714285714, 1.0104821802935011, 1.1271186440677967, 1.0381650919940328, 1.025633993381237, 1.1690492398457, 1.0564205898516212, 1.1085972850678734, 1.1300613496932514, 1.0078044470622882, 1.5, 1.2666666666666666, 1.133587786259542, 1.0, 1.137888198757764, 1.1348360655737706, 1.0059672180678298, 1.016840123778634, 1.5, 1.1047569534702366, 1.0455341506129596, 1.0007197242319785, 1.0004897534397528, 1.064659977703456, 1.0610482430017867, 1.0206882832703401, 1.0084239614904618, 1.1100671140939598, 1.4516129032258065, 1.246189917936694, 1.0, 2.0, 1.0016105220775735, 1.25, 1.625, 1.5121951219512195, 1.0725229826353422, 1.0053942245295262, 1.132258064516129, 1.0307692307692307, 1.0, 1.095473396276361, 1.0224215246636772, 1.0443974630021142, 1.0040485829959513]
origin-bjaq_15.87 	max: 4.0000	99th: 2.5000	95th: 1.7500	median: 1.0651	mean: 1.1636

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 20.466106 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=42.762171