Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='naru', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 96, 'naru': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.5007	median: 1.0595	mean: 1.1466
ReportEsts: [1.1623616236162362, 1.0486073184052431, 1.0349303787992215, 1.0176125244618395, 1.0333333333333334, 1.0, 1.1619991640293783, 1.0251199845979657, 1.25, 1.0345285524568393, 1.0561856116353563, 1.0020143997088868, 1.0710751237067027, 1.083720930232558, 1.0466266336983399, 1.0, 1.6363636363636365, 1.0517180304640454, 3.0, 2.6666666666666665, 1.2857142857142858, 1.1133491481561355, 1.0582050508099405, 1.0564516129032258, 1.017059708981435, 1.0, 1.0105691569914186, 1.3333333333333333, 1.4, 1.1942446043165467, 1.0, 1.0041990048061409, 1.0078674769942424, 1.4134295227524973, 1.003524746658834, 1.0301265994177782, 1.0106951871657754, 1.0029516484908114, 1.1170879537158207, 1.2619047619047619, 1.0848400556328233, 1.0091463414634145, 1.0, 1.1420346100012724, 1.103192966219343, 1.2314049586776858, 1.1650485436893203, 1.3737864077669903, 1.0402876176377287, 1.0, 1.024174315241743, 1.3227272727272728, 1.0073359273670557, 1.0, 1.187012987012987, 1.0157130336797295, 1.1272727272727272, 1.064638783269962, 1.1925465838509317, 1.25, 1.0320338058887677, 1.0311332503113324, 1.018181818181818, 1.1149425287356323, 1.1, 1.0541345055553633, 1.0411238825031928, 1.1666666666666667, 1.0, 1.1173958333333334, 1.009546539379475, 1.0560046189376444, 1.0968468468468469, 1.0666271973768102, 1.1811764705882353, 1.1320754716981132, 1.3333333333333333, 1.0449389179755673, 1.6, 1.0491405779218916, 1.15625, 1.0406381338169655, 1.1533742331288344, 1.0321100917431192, 1.0636743215031315, 1.04, 1.0019853362701023, 1.05592438115452, 1.1911764705882353, 2.3333333333333335, 1.0741981809478218, 1.02669239049238, 1.0467289719626167, 1.370266479663394, 1.234498308906426, 1.0814606741573034, 1.25, 1.006872852233677, 1.0, 1.0113708149084017, 1.1087113030957523, 1.0034423407917383, 1.0131202631202632, 1.0588235294117647, 1.0074945087404512, 1.075363973736797, 1.0753601773180643, 1.0413348502085704, 1.0235331032318795, 1.1666666666666667, 1.3333333333333333, 1.129287598944591, 1.0085240338917223, 1.0448844884488449, 1.013157894736842, 1.0063773313777766, 1.0, 1.211692777990065, 1.1550239234449762, 1.0, 1.2142857142857142, 1.1666666666666667, 1.0802005012531328, 1.0132327816431854, 1.0768036033237556, 1.037037037037037, 1.8, 1.244205298013245, 1.0, 1.2142857142857142, 1.0016487455197132, 1.1818181818181819, 1.0232747395833333, 1.0049991521538433, 1.1359935940210864, 1.1540832049306626, 1.0082191780821919, 1.0705047976637463, 1.00199203187251, 1.051249199231262, 1.0516916070266753, 1.1975308641975309, 1.010437051532942, 1.0195811174258558, 2.0, 1.0157407407407408, 1.0416666666666667, 1.0465260545905708, 1.0236456679018882, 1.0, 1.0621215790748366, 1.048888888888889, 1.026, 1.4476190476190476, 1.0855784469096672, 1.0726943942133815, 1.038253169430465, 1.0610514924700154, 1.1140684410646389, 1.1546052631578947, 1.0208333333333333, 1.4492753623188406, 1.137353433835846, 1.1428571428571428, 1.0049475691988072, 1.0009463842778097, 1.0132412204951065, 1.0430475906755046, 1.0146609651802077, 1.001061261309066, 1.0326086956521738, 1.0546218487394958, 1.1649075239663018, 1.062298603651987, 1.1285296981499513, 1.0372983870967742, 1.045598480050665, 1.0623971024036878, 1.0756153260593757, 1.1666666666666667, 1.2115384615384615, 1.0132990132990134, 1.0474002923366048, 1.126711061783204, 1.1692307692307693, 1.0409848116440292, 1.050050454086781, 1.023158669350475, 1.0175438596491229, 1.0904545454545456, 1.017854480821054, 1.0, 1.9090909090909092, 1.0878879669871373, 1.2769580022701477, 1.101574403250381, 1.4583333333333333, 1.0192926045016077, 1.004801561281862, 1.004208943667678, 1.1798245614035088, 1.0508063666069358, 1.0662650602409638, 1.140625, 1.0238095238095237, 1.0, 1.019108280254777, 1.0566945276770225, 1.6167247386759582, 1.1494252873563218, 1.0182896688087, 1.0957683741648108, 1.073137099887849, 1.0058322868703782, 1.10566993570176, 1.1578947368421053, 1.108974358974359, 1.070412764481443, 1.0077833304612556, 1.0690601641955644, 1.0, 1.0795031055900621, 1.0120733460697615, 1.0120057830847866, 1.0733104238258877, 1.0117266899463178, 1.0000845880561664, 1.0344827586206897, 1.0013943260152174, 1.0522317188983856, 1.2115059221658206, 1.0260416666666667, 1.055175274839245, 1.0153181461115475, 1.1039370078740158, 1.0, 1.0061436672967863, 1.108642251004913, 1.1122831692451947, 1.5149253731343284, 1.0909090909090908, 2.6666666666666665, 1.0284025958038023, 1.1090909090909091, 1.0760044180588153, 1.5, 1.5, 1.2903225806451613, 1.0788446526151445, 1.6428571428571428, 1.1546961325966851, 1.0934256055363323, 1.0778546712802768, 1.016211604095563, 1.00195505313486, 1.1578947368421053, 1.0, 1.0282215779409043, 1.0769177988198162, 1.1085814360770578, 1.032683548129439, 1.102504190582618, 1.027710355987055, 1.0993640699523053, 1.0177983557206485, 1.0705741626794258, 1.0829319686935581, 1.1190050845128487, 1.5454545454545454, 1.087990101864309, 1.0788912579957357, 1.2727272727272727, 1.0, 1.1545454545454545, 1.0555555555555556, 1.0833333333333333, 1.00435235121582, 1.075208913649025, 1.180473372781065, 1.0114944559271233, 1.007607776838546, 1.001796692497568, 1.0233672381134298, 1.4, 1.0965805747544561, 1.2, 1.0094581150096174, 1.0357941834451903, 1.0166219107004688, 1.3, 1.25, 1.0, 1.4225352112676057, 1.0194634240015858, 1.0, 1.0565749235474007, 1.002262443438914, 1.0400641025641026, 1.0041702390742653, 1.1666666666666667, 1.0314465408805031, 1.01476146111658, 1.1041984948791943, 1.1028490782393932, 1.0769230769230769, 1.0, 1.2291169451073987, 1.0049261083743843, 1.190031152647975, 1.0313667564514728, 1.0204255319148936, 1.0816901408450703, 1.2040816326530612, 1.01920438957476, 1.0949152542372882, 1.4285714285714286, 1.0232634581746891, 1.064102564102564, 1.0526315789473684, 1.0265312715066224, 1.0476190476190477, 2.0, 1.0480445096102309, 2.0, 1.0, 1.072674418604651, 1.0188679245283019, 1.004160363086233, 1.2010443864229765, 1.164835164835165, 1.0124189991747723, 1.0311092719261945, 1.0096286107290233, 1.0022023716584352, 1.1153010552451894, 2.0, 1.1111111111111112, 1.0329045202407647, 1.3333333333333333, 1.0475409836065575, 1.0, 1.0, 1.0, 1.1857142857142857, 1.077069457659372, 1.29, 1.0389610389610389, 1.0, 1.073901464713715, 1.0256051740067755, 1.5, 1.072066706372841, 1.0, 1.0112654672436043, 1.0595238095238095, 1.0767252689582787, 1.1682027649769586, 1.0018181818181817, 1.0692167577413478, 1.0833333333333333, 1.0378660798104002, 1.0079131963902683, 1.0346205059920106, 1.0, 1.1428571428571428, 1.8333333333333333, 1.5, 1.0, 1.001721911321567, 1.25, 1.1747088186356074, 1.0693069306930694, 1.0346889649056126, 1.0035877735677345, 1.0020597322348095, 1.093869550843055, 1.0354354354354354, 1.2765957446808511, 1.5, 1.054945054945055, 1.053811659192825, 1.0098915925385545, 1.2857142857142858, 3.142857142857143, 1.046770601336303, 1.0226744186046512, 1.0023885133293355, 1.1380753138075315, 1.342769701606733, 1.0442857142857143, 1.4285714285714286, 1.0808477237048666, 1.048728813559322, 1.3076923076923077, 1.055306427503737, 1.1388888888888888, 1.0312452113150878, 1.0163387112848394, 1.0352342616267016, 1.2463768115942029, 1.168421052631579, 1.0591715976331362, 1.0, 1.0096353770475177, 1.0230734158798789, 1.000338294993234, 1.0152983048802557, 1.0629183400267737, 1.0138530927835052, 1.8333333333333333, 1.3863965267727931, 1.2, 1.089666951323655, 1.1111111111111112, 1.0297340993896538, 1.0159420289855072, 1.113177128116939, 1.1778656126482214, 1.1105169340463459, 3.0, 1.1464069845533915, 1.0139357393906034, 1.0625574765495678, 1.0, 1.2857142857142858, 1.0508637236084453, 1.2471264367816093, 1.0713886002078503, 1.0479302832244008, 1.2352941176470589, 1.0229479258605472, 1.0880407600439386, 1.0376619013847934, 1.0095311853696745, 1.0583333333333333, 1.207296849087894, 1.0340909090909092, 1.5, 1.0368421052631578, 1.3, 1.0463847203274215, 1.0, 1.035219167354541, 1.3157894736842106, 1.110672789472062, 1.0221687424245085, 1.1504613200851668, 1.0, 1.0754716981132075, 1.28, 1.0009347614410906, 1.336980306345733, 1.0, 1.0353688864327162, 1.0117934501714985, 1.2406169665809768, 1.0, 1.5, 1.1693203883495145, 1.0090415913200723, 1.3090128755364807, 1.0, 1.0114041163665148, 1.0382352941176471, 1.0869565217391304, 1.1060263653483993, 1.0272727272727273, 1.0511811023622046, 1.163709677419355, 1.0166809238665526, 1.2046380804775845, 1.0, 1.0675675675675675, 1.061496394858755, 1.0004793789722732, 1.0528722687211514, 1.0, 1.0310148232611174, 1.0096433709697736, 1.0272393923520167, 2.0, 1.1283891547049443, 1.0814815686643755, 1.077701630814138, 1.2112183827705212, 1.028703446918528, 1.1931818181818181, 1.017094017094017, 1.1494696239151398, 2.0, 1.0054266370355056, 1.3962264150943395, 1.25, 1.2866666666666666, 1.1304347826086956, 1.0313030546589244, 1.0225890529973936, 1.100722518493033, 1.0808531746031746, 1.0539368445997985, 1.0236710401731368, 1.0003757898814238, 1.087378640776699, 4.0, 1.0484551674468852, 1.028744939271255, 1.0058099464003964, 1.0437603706083771, 1.0913621262458473, 1.2868920032976092, 1.1176470588235294, 1.4285714285714286, 1.0210428189671246, 1.011030271968625, 1.019980777050756, 1.0823571175008875, 1.0435920010061628, 1.0329896907216496, 1.0097004418119144, 1.0652642934196332, 1.0917941585535467, 2.0, 1.0833333333333333, 1.0219435736677116, 1.0970873786407767, 1.0188034188034187, 1.0181598062953996, 1.0714285714285714, 1.1371428571428572, 1.0554699537750385, 1.032967032967033, 1.0112950154483396, 1.4303797468354431, 1.016195155536083, 1.0, 1.0561456752655538, 1.2301587301587302, 1.0638297872340425, 1.0202336848104874, 1.0985576923076923, 1.0434782608695652, 1.0843060959792477, 1.031962386018237, 1.0, 1.7446808510638299, 1.5, 1.0, 1.0232558139534884, 1.1534883720930234, 1.3416149068322982, 1.1256830601092895, 1.0275552707465556, 1.1727891156462584, 1.0522935151245247, 1.0299250640899231, 1.105263157894737, 1.040030248092528, 1.1419753086419753, 1.0702976567447753, 1.1446540880503144, 1.0756526371870005, 1.1878612716763006, 1.006243213897937, 1.0476771967082559, 1.0305495855081364, 1.0107049700803759, 2.0, 1.0571428571428572, 1.0277264325323474, 1.0410958904109588, 1.0, 1.0851063829787233, 1.1538461538461537, 1.0482374768089053, 1.5925925925925926, 1.5, 1.0243721298691653, 1.0350097743024702, 1.007197547789648, 1.0291284759981358, 1.0648648648648649, 1.037667071688943, 2.0, 1.1492537313432836, 1.0786341318256212, 1.0204374813650285, 1.008318661260883, 1.0165166875498348, 1.0055735346997483, 1.0784313725490196, 1.0690540648140776, 1.1563055062166963, 1.0167455115417499, 1.0628494512321391, 1.3636363636363635, 1.0947712418300655, 1.0, 1.0113378684807257, 1.0225356031229895, 3.0, 1.0744138634046891, 1.0212761261559513, 1.2857142857142858, 1.1257096512570965, 1.2, 1.1875, 1.0102903682719546, 1.7692307692307692, 1.0295855842790327, 1.0068346860316104, 1.1875, 1.2608695652173914, 1.1975308641975309, 1.0009573958831977, 1.184313725490196, 1.021069791762788, 1.0118957023270718, 1.0, 1.153812730827721, 1.0, 2.0, 1.1069492815462325, 1.0056925339562246, 1.1040681173131504, 1.0093774504132762, 1.0102138290836946, 1.3614457831325302, 1.8571428571428572, 1.099657664511221, 1.0089503661513426, 1.0488690546892234, 1.076717811874583, 1.0378654709553972, 1.0592810129571146, 1.1153846153846154, 1.0011173184357542, 1.0952380952380953, 1.0106649309032645, 1.0744479495268138, 1.005464480874317, 1.0919117647058822, 1.030101946896449, 4.0, 1.0002621644295302, 1.0172463494398665, 1.021315178145102, 1.0555555555555556, 1.0144396703528915, 1.3686868686868687, 1.0, 1.0306422885391298, 1.0134426229508198, 1.1103030303030303, 1.1176470588235294, 1.6666666666666667, 1.0310619830635048, 1.5, 1.445945945945946, 1.1538461538461537, 1.112134533528714, 1.2857142857142858, 1.2030456852791878, 1.110062893081761, 1.0, 1.208994708994709, 1.0313930673642904, 2.0, 1.0, 1.1083333333333334, 1.070110701107011, 1.0802615933412605, 1.017075773745998, 1.0702341137123745, 1.0462962962962963, 1.089150378938971, 1.0467532467532468, 1.5705128205128205, 1.4583333333333333, 1.1923076923076923, 1.0, 1.069967707212056, 1.204906204906205, 1.0590809628008753, 1.2819763580820827, 1.0078404385469604, 1.2223851170314948, 1.0226188005810335, 1.0631506651243494, 1.0433212996389891, 1.0072115384615385, 1.2222222222222223, 1.0, 1.0, 1.0154431823436032, 1.1765316718587746, 1.0065359477124183, 1.4817518248175183, 1.0941580756013747, 1.0220964257390543, 1.0033892187361395, 1.0769230769230769, 1.1578947368421053, 1.0555144337527758, 1.1449496288441146, 1.0211372199552866, 1.0515602902496728, 1.230263157894737, 1.0479917306556408, 1.0009980986789424, 1.0413333333333334, 1.0402542372881356, 1.0, 1.0695316272332207, 1.122629582806574, 1.0576923076923077, 1.287719298245614, 1.0347890451517394, 1.0, 1.1347150259067358, 1.0302060945335798, 1.2407407407407407, 1.0033386314805792, 1.138771186440678, 1.0238095238095237, 1.0533687105489526, 1.001624842029247, 1.1415525114155252, 1.0, 1.0280046674445742, 1.001662533814247, 1.1789473684210525, 1.0, 1.0, 1.0, 1.0220903475838683, 1.8333333333333333, 1.0589055263276226, 1.0603898551505035, 1.2066902968542312, 1.063133445945946, 1.0069036149148427, 1.0765273311897106, 1.08984375, 1.0198019801980198, 1.0117970272618404, 1.0512416239653133, 1.0038060542147018, 1.0133024164022455, 1.25, 1.1228070175438596, 1.209486166007905, 1.0205532757888778, 1.0814332247557004, 1.0093636944030644, 1.1415929203539823, 1.0058479532163742, 1.0421440479906212, 1.0552407932011332, 1.0020016060791295, 1.3125, 1.0160673522697856, 1.0177167309506863, 1.1605672461116194, 1.0008428150021071, 1.09375, 1.157387580299786, 1.109452736318408, 1.6875, 1.042675204052913, 1.1923076923076923, 1.0786290322580645, 1.0175824175824175, 1.1523937963587323, 1.0252028310029346, 1.0729411764705883, 1.0909090909090908, 1.0821256038647342, 1.0115077760211773, 1.020646558812355, 1.0071609072154606, 1.0762650835192245, 1.0547217334299417, 1.0769230769230769, 1.069198312236287, 1.3705488621151272, 1.1132193401491137, 1.0142276422764227, 1.2083333333333333, 1.0442561205273069, 1.0167698658410733, 1.2100175746924429, 1.0300793858501265, 1.0, 1.3333333333333333, 1.010815619674032, 1.011096884336321, 1.0014616508962229, 1.0867069486404834, 1.0399042298483638, 1.1221945137157108, 1.0092517981317337, 1.088950203652608, 1.0461538461538462, 1.2486486486486486, 1.0063424947145878, 1.0221984980120749, 1.0120481927710843, 1.75, 1.0244783391589873, 1.0028463920245485, 1.0496009122006842, 1.3333333333333333, 1.0394641564083997, 1.0273233802414459, 1.0162857142857142, 1.0695187165775402, 1.3461538461538463, 1.1064690026954178, 1.0694736842105264, 1.11875, 1.7916666666666667, 1.0470108391999107, 1.0128840436075321, 1.089430894308943, 1.1388888888888888, 1.0499013608854115, 1.0681165367254821, 1.0065011621248359, 1.0287286063569683, 1.6666666666666667, 1.12, 1.3333333333333333, 1.0253571428571429, 1.5, 1.3333333333333333, 1.3636363636363635, 1.196513470681458, 1.0126811594202898, 1.0424436029504136, 1.009825936011976, 1.0476190476190477, 1.4411764705882353, 1.0, 1.032258064516129, 1.3513513513513513, 1.3725490196078431, 1.0186915887850467, 1.012302195686971, 1.0027271678752274, 1.0546875, 1.0043823196071024, 1.0008007607226865, 5.0, 1.0092375216903133, 1.1142857142857143, 1.0, 1.3333333333333333, 1.0529585798816568, 1.1496808434339811, 1.034108637917277, 1.0745341614906831, 1.0, 1.162162162162162, 1.2395437262357414, 2.0, 1.5, 1.0733267716535433, 1.068207926479035, 1.2040018053257109, 1.25, 1.0187993622307094, 1.0635166537567777, 1.0992108229988726, 1.1428571428571428, 1.0597014925373134, 1.0037176220664064, 1.2236842105263157, 1.0686934323508934, 1.0445061178186532, 1.096470588235294, 1.0364372469635628, 1.0023829201101928, 1.178479931682323, 1.1198347107438016, 1.1896551724137931, 1.0431594349228623, 1.0452544031311155, 1.02349212681316, 1.2651515151515151, 1.2289156626506024, 1.164179104477612, 1.059445178335535, 1.0395341710082746, 1.0184193138500635, 1.016141023184518, 1.084061135371179, 3.0, 1.25, 1.098448142686609, 1.1512752858399296, 1.4121766193347598, 1.0232964107201166, 1.0687405920722528, 1.0824827132038195, 1.0090702947845804, 1.0833333333333333, 1.0270466655901824, 1.0313122804133878, 1.01060695344726, 1.0683012259194395, 2.5, 1.0666666666666667, 1.1093216919182656, 1.0836320191158901, 1.0012182360566635, 1.0149068819438893, 1.1370738636363635, 1.6, 1.0070093457943925, 1.003708049234039, 1.0395247886680374, 1.026615969581749, 1.017611929623802, 1.2030651340996168, 1.2583333333333333, 1.0927536231884059, 1.0048829407045439, 1.062807551221258, 1.096774193548387, 1.1434058898847632, 1.03125, 1.0752734107997266, 1.0088303783459756, 1.108322324966975, 1.0807385332100161, 1.0490367775831875, 1.0434096290449881, 1.2857142857142858, 1.0445859872611465, 2.5, 1.5, 1.4166666666666667, 1.030690537084399, 1.146129541864139, 1.02516369727425, 1.0331723397391992, 1.198100407055631, 1.0665271966527197, 1.048913043478261, 1.3877551020408163, 1.0159855752098863, 1.6, 1.4166666666666667, 1.2159349593495934, 1.0, 1.1044117647058824, 1.1284722222222223, 1.068409193330329, 1.031771923844768, 1.25, 1.1089783281733747, 1.315891472868217, 1.1566084788029924, 1.0003212128999102, 1.0894085281980743, 1.0450966356478169, 1.0238247139040633, 1.066750846582104, 1.0747217806041336, 1.290909090909091, 1.303072625698324, 1.0, 1.0, 1.0006795178999321, 1.6666666666666667, 1.5714285714285714, 1.4210526315789473, 1.0122100122100122, 1.0804597701149425, 1.0232558139534884, 1.1131004366812227, 1.0, 1.2451893234016138, 1.022700119474313, 1.251121076233184, 1.0097087378640777, 1.25, 1.0118541713263252, 1.027920227920228, 1.0842105263157895, 1.0866493120119003, 1.0111021053801255, 1.0269648444689858, 1.043196544276458, 1.0, 1.0013115031518383, 1.0231360173073794, 1.02178981348637, 1.2695652173913043, 1.048787863514944]
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.5007	median: 1.0595	mean: 1.1466

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 21.082099 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=naru', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[1.1920929e-06 1.7881393e-07 2.9802322e-07 4.7683716e-07 6.5565109e-07]
Distance score: 5.602836381513043e-07
SAUCE Drift detection: False
Detection latency: 0.0232s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 2.041818 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 5.0000	99th: 3.0000	95th: 1.7500	median: 1.0674	mean: 1.1800
ReportEsts: [1.0730994152046784, 1.0559778852798893, 1.03809559578357, 1.020967741935484, 1.0857142857142856, 1.0, 1.1480550214465315, 1.004055641606992, 1.0, 1.0320441988950275, 1.06791844977641, 1.002628880125955, 1.034833091436865, 1.0057581573896353, 1.0406407594185703, 1.0140845070422535, 1.0649350649350648, 1.0, 1.4444444444444444, 1.0184563758389262, 1.053248355263158, 1.0660827250608274, 1.2942430703624734, 1.0703971119133573, 1.039233708189158, 1.002387852222216, 2.0, 1.054559925350605, 1.6, 1.3333333333333333, 1.1765339074273413, 2.0, 1.0039874177947326, 1.007744232813721, 1.5246575342465754, 1.0547409579667644, 1.0300804971049287, 1.0360360360360361, 2.0, 1.1859054415700268, 1.001675197766403, 1.0845473014473124, 1.0862470862470863, 1.1177439275421985, 1.095505617977528, 1.0924869565217392, 1.3, 1.0098231827111985, 1.984732824427481, 1.1587057010785824, 1.0, 1.0207612456747406, 1.09375, 1.0, 1.0630377607730663, 1.0787675436801833, 1.0107374964679288, 1.1261061946902655, 1.1204819277108433, 1.0091825513999448, 1.1833333333333333, 1.0090589087897297, 1.042758620689655, 1.1153846153846154, 1.1333333333333333, 1.6, 1.0543956043956044, 1.035972754363559, 1.1428571428571428, 1.0, 1.0246531906460563, 1.0068027210884354, 1.0568948891031822, 1.091760299625468, 1.0933452956779528, 1.0242537313432836, 1.0231539296169672, 1.0728155339805825, 1.049645390070922, 1.0287815106296954, 1.1877527440785673, 1.0945945945945945, 1.0, 1.5, 1.050351288056206, 1.0476190476190477, 1.1940700808625337, 2.0, 3.0, 1.017927009171958, 1.0764206401045069, 1.0275020489937163, 1.0119279644499883, 1.2267734553775744, 1.08355091383812, 1.34624145785877, 1.1391304347826088, 1.4084880636604775, 2.0, 1.1909127142287763, 1.3846153846153846, 2.0, 1.0078130377916983, 1.1552768166089966, 1.0310880829015545, 1.0057483184686953, 1.1666666666666667, 1.0109826816593144, 1.1677887105126876, 1.0716459502071647, 1.0783075465740448, 1.037765538945712, 1.3333333333333333, 2.4, 1.1474530831099197, 1.0028105725366911, 1.070548712206047, 1.0217391304347827, 1.0058080858053153, 1.0, 1.1831340465701699, 1.1883589329021826, 1.0, 1.224770642201835, 1.5714285714285714, 1.0606060606060606, 1.015444720745778, 1.0872583365771378, 1.0238095238095237, 2.0, 1.1670117322291236, 1.0, 1.1111111111111112, 1.0190351777549687, 1.1538461538461537, 1.1260504201680672, 1.0564897806551132, 1.0582406541246578, 4.0, 1.6428571428571428, 1.0303643724696356, 1.0981539846915804, 1.049040511727079, 1.0682125930941098, 1.193069306930693, 1.075027382256298, 1.0354496021498605, 3.0, 1.005744925315971, 1.0134874759152215, 1.0479666319082377, 1.0276796230859835, 1.0, 1.0115724291950057, 1.0361596009975063, 1.0082508250825082, 1.0284005979073243, 1.0, 1.0789738430583502, 1.057747880051163, 1.1310399159663866, 1.1458333333333333, 1.1353591160220995, 1.0526315789473684, 1.1183431952662721, 1.1278600269179004, 1.375, 1.021071723880398, 1.6666666666666667, 1.1086186540731995, 1.0021055187771986, 1.4464285714285714, 1.0525223992585073, 1.0017857142857143, 1.080701754385965, 1.1786552310057448, 1.6666666666666667, 1.1481481481481481, 1.0837696335078535, 1.0712748789671867, 1.1319272125723738, 1.003494789779871, 1.0529801324503312, 1.0, 1.0105851844332265, 1.0284053700065487, 1.044776119402985, 1.1082737487231868, 1.1527777777777777, 1.1428571428571428, 1.1281407035175879, 1.003570917418062, 1.0285714285714285, 1.041017653167186, 1.0449399983673024, 1.0019551791071113, 1.0083588041322948, 1.0418794688457609, 1.034283074510975, 1.002774988107194, 1.0522648083623694, 1.2934579439252336, 1.0763103802672147, 1.0063616463328078, 1.187467362924282, 1.0270033315798703, 1.1311475409836065, 1.0128205128205128, 1.0510204081632653, 1.0, 1.016304347826087, 1.098509824607675, 1.6783625730994152, 1.1568627450980393, 1.0202145214521452, 1.4, 1.0043135654195263, 1.0770975056689343, 1.0212791927740255, 1.4, 1.0983182406209573, 1.0506756756756757, 1.0237003149662878, 1.0347772730421703, 1.0, 1.0384615384615385, 1.071369854004998, 1.0808954258930015, 1.0078534031413613, 1.2032258064516128, 1.0016787912702854, 1.0480194379615717, 1.017391304347826, 1.0034834118808562, 1.0069904957985205, 1.1079136690647482, 1.0558375634517767, 1.0688836104513064, 4.0, 1.1462450592885376, 1.0, 1.0335570469798658, 1.106628242074928, 1.0497848801475107, 1.2870090634441087, 1.2307692307692308, 2.5, 1.1183022011751294, 1.042857142857143, 1.1003247711839386, 2.0, 1.0381991814461118, 1.127789046653144, 1.4285714285714286, 1.0277090588216755, 1.1359447004608294, 1.1415752741774676, 1.1780415430267062, 1.0127163546450018, 1.1121636438804308, 1.0579710144927537, 2.0, 1.016278664225303, 1.1794562973158982, 1.089820359281437, 1.0248953001395997, 1.077622570320283, 1.0306579837618404, 1.0805280528052805, 1.029822065100996, 1.0704295704295703, 1.0950334891949955, 1.3191230207064555, 1.6923076923076923, 1.043194057939098, 1.0554561717352415, 1.2264150943396226, 1.25, 1.1113165680473374, 1.182648401826484, 1.0132668987873694, 1.0273279707752292, 1.146282973621103, 1.2188295165394403, 1.007654469340602, 1.1935749588138385, 1.0441698110541118, 1.0079338755257188, 1.3571428571428572, 1.011957205789805, 1.0018315018315018, 1.0104396295487195, 1.0429629629629629, 1.000528718714499, 1.0908136482939632, 1.0241708825182687, 1.0087426256308196, 1.0795467088561022, 1.0188880454036078, 1.0590960955110902, 1.1051587301587302, 1.1101694915254237, 1.0714285714285714, 1.0774329130294213, 1.0, 1.008896797153025, 1.0165941017004847, 1.05593419506463, 1.048780487804878, 1.2032520325203253, 1.089058524173028, 1.0295627544698176, 1.0205217391304349, 1.15, 1.05594751825721, 1.0108741707824107, 1.047945205479452, 1.1176470588235294, 3.125, 1.0962402459210214, 1.3333333333333333, 1.0263912737738965, 1.0542168674698795, 1.0454545454545454, 1.0082023790350414, 1.2727272727272727, 1.6666666666666667, 1.0426907674785995, 2.0, 1.1613691931540342, 1.0716019417475728, 1.1762295081967213, 1.0162049137480398, 1.0459290187891441, 1.1759259259259258, 1.0162913056704108, 1.0229046384600287, 1.1038107752956636, 1.0041764927030998, 1.0885867846980715, 3.0, 1.2, 1.0316090541855458, 1.0, 1.0492027334851937, 1.15, 2.0, 1.08, 1.18762278978389, 1.1086261980830672, 1.3114754098360655, 1.2425925925925927, 1.1294117647058823, 2.5, 1.053763734202683, 1.6666666666666667, 1.0677966101694916, 1.0342750711111561, 1.3243243243243243, 1.0508744038155804, 1.0205223880597014, 1.8, 1.5, 1.1620469083155651, 1.5769230769230769, 1.030214424951267, 1.0175194107107306, 1.0788268778616508, 1.0323383084577114, 1.5, 1.0073107814973326, 1.0476190476190477, 1.0, 1.0, 1.2351274787535411, 1.1111111111111112, 1.0252631578947369, 1.0512820512820513, 1.0427591681919421, 1.0473019150514025, 1.2564102564102564, 1.0645196566242003, 1.0370629370629372, 1.3578947368421053, 1.0613915416098227, 1.1059113300492611, 1.1009316770186335, 1.0833333333333333, 1.0073221707971824, 1.0124030419693149, 1.0024038461538463, 1.0344827586206897, 1.1428571428571428, 1.0410714285714286, 3.0, 1.9259259259259258, 1.094488188976378, 1.1091954022988506, 1.4133333333333333, 1.0138248847926268, 1.0447834645669292, 1.05, 1.169743821703195, 1.1389417586600685, 1.0434741972094266, 1.0729166666666667, 1.0298507462686568, 1.095, 1.0, 1.0248845439685135, 1.4310344827586208, 1.0020170791939225, 1.0087535775854855, 1.050289521694297, 1.0132325141776937, 1.7142857142857142, 1.3715430861723448, 1.4, 1.12639942217407, 1.0909090909090908, 1.0034572394073304, 1.002433090024331, 1.009226594301221, 1.1229235880398671, 1.2011173184357542, 3.0, 1.0359052711993888, 1.001607639828013, 1.0178554323045386, 1.0, 1.3333333333333333, 1.0556881463802705, 1.3394495412844036, 1.07679892400807, 1.1106377903113125, 1.0, 1.1260806916426513, 1.070955939592091, 1.0261474529579306, 1.0255607627088328, 1.0914836278648254, 1.005499541704858, 1.5238095238095237, 1.1916846652267818, 1.0480631879673976, 1.5488721804511278, 1.0275080906148868, 2.0, 1.3333333333333333, 1.0911492734478203, 1.1810699588477367, 1.2244001351808043, 1.0252153875508196, 1.1401869158878504, 2.0, 1.0743801652892562, 1.3928571428571428, 1.0056340120319578, 1.125, 1.0, 1.0235163005910817, 1.6666666666666667, 1.0, 1.1349693251533743, 2.0, 1.1838594207614708, 1.0111524163568772, 1.407843137254902, 1.0, 1.0156656887062752, 1.0119617224880382, 1.1071428571428572, 1.0571276027762948, 1.0296296296296297, 1.1252796420581654, 1.1549966009517336, 1.0931786216596344, 1.168247010053843, 1.0, 1.1219512195121952, 1.1228837471783295, 1.0402333233622494, 1.1031626506024097, 1.4, 1.0029668088262562, 1.0202542597580206, 1.0243584167029143, 2.0, 1.1224557891224558, 1.0824008238120923, 1.118272754829287, 1.162621182301917, 1.0237884939396864, 1.04877544266093, 1.041029207232267, 1.051556285585095, 1.75, 1.0455877283695278, 1.0120240480961924, 1.041219512195122, 1.0644628099173554, 1.0555555555555556, 1.0335742522000453, 1.1388888888888888, 1.0773731343283581, 1.280684596577017, 1.0503065431965124, 1.071859296482412, 1.0386926344141718, 1.1393004889056035, 1.0120481927710843, 1.0459770114942528, 1.0205826572876562, 1.0765957446808512, 1.0567066521264994, 1.008188815641621, 1.3333333333333333, 1.0609662576687116, 1.1061946902654867, 1.2307692307692308, 1.108695652173913, 1.0141451809940205, 1.124113475177305, 1.08648056923919, 1.0, 3.0, 1.0184528034066713, 1.0850753703942877, 1.0237184391736802, 1.0233887468030691, 1.013275923932544, 1.0129870129870129, 1.0811848601206802, 1.0743612779170015, 1.2746478873239437, 1.0149548642051838, 1.1790613718411553, 1.1069767441860465, 1.0007423639080901, 1.0279441117764472, 1.0248666256283985, 1.0, 1.056436271401395, 1.4304635761589404, 1.0116290992361194, 1.0291666666666666, 1.118006103763988, 1.1337792642140467, 1.032069970845481, 1.0034886494652726, 1.0, 1.7321428571428572, 1.5714285714285714, 1.0, 1.1111111111111112, 1.3367285799880169, 1.4351851851851851, 1.1345291479820627, 1.0156394963552022, 1.0437121721587088, 1.064366404364405, 1.01632199975332, 1.0142914448501166, 1.001516321238395, 1.01446941646798, 1.0693121693121692, 1.1500817229112585, 1.009201959742918, 1.0291970802919708, 1.048587570621469, 1.1687817258883249, 1.0327868852459017, 1.0095596045428548, 1.2068126520681266, 1.0156137688683013, 1.136150234741784, 1.103054448871182, 1.0562189054726367, 1.6666666666666667, 1.0177725118483412, 1.0666666666666667, 2.5, 1.3352601156069364, 1.020399010322841, 1.014258188824663, 1.1348600508905853, 1.0, 1.018783629148102, 1.1506808069318524, 1.0472589792060492, 1.2, 3.0, 1.05329976430255, 1.3302752293577982, 1.0133118192819686, 1.009116409537167, 1.0, 1.0253045923149016, 1.105263157894737, 1.0233984083363779, 1.1508620689655173, 1.043226240035843, 1.019994423865854, 1.0112662730650712, 1.1219512195121952, 3.0, 1.0703914451093888, 1.0, 1.1270648030495554, 1.2083333333333333, 1.1468253968253967, 1.0768704067193136, 1.3793103448275863, 1.025538052546735, 1.1884057971014492, 1.1607142857142858, 1.2425399028452464, 1.0925313945803041, 1.0144425187752744, 1.1419347896266008, 1.003577817531306, 1.0068115471942913, 1.2, 1.0818415302641162, 1.1286515626138267, 1.2857142857142858, 1.0126939351198871, 1.0726725260416667, 1.027027027027027, 1.0540606410730888, 1.0909090909090908, 1.1652542372881356, 1.1164090759618546, 1.1546666666666667, 1.1506849315068493, 1.0094714380898564, 1.309278350515464, 2.25, 1.085246932997798, 1.0670511896178803, 1.041195110909914, 1.0708379272326352, 1.0307961714683234, 1.084428771587349, 1.117829457364341, 1.0347043701799485, 1.185897435897436, 1.0209535364012707, 1.0809248554913296, 1.030421216848674, 1.2188193519751442, 1.0109272243511438, 1.0130718954248366, 1.0783932047425235, 1.0909090909090908, 1.1428571428571428, 1.02875, 1.0192201071890594, 1.0654981549815499, 1.1161048689138577, 1.5555555555555556, 1.0077399380804954, 1.087227414330218, 1.6666666666666667, 1.0111742319017722, 2.0, 1.0115430211518064, 1.5, 1.31328320802005, 1.2142857142857142, 1.1673942145393166, 1.2727272727272727, 1.3087557603686637, 1.1078260869565217, 1.0, 1.0236884173811946, 1.0043668122270741, 1.8, 1.5, 1.047945205479452, 1.0, 1.0485221674876848, 1.0158730158730158, 1.025503355704698, 1.0634328358208955, 1.1294765840220387, 1.0806451612903225, 1.43, 1.2347826086956522, 1.4642857142857142, 1.0, 1.111214953271028, 1.187041564792176, 1.0556552962298025, 1.1702883834281073, 1.0181795684022965, 1.2368690750704585, 1.0159050839800983, 1.0194227463280756, 1.0139303482587065, 1.0278468423669815, 1.375, 1.5, 1.025, 1.0570203314310946, 1.1726495726495727, 1.0221606648199446, 1.2049382716049384, 1.0653282345442958, 1.0048388180738816, 1.0019158937873205, 1.0638297872340425, 1.173913043478261, 1.123134328358209, 1.1251929437706725, 1.0573158044074529, 1.060125012402024, 1.1263157894736842, 1.11625621814162, 1.0985017246335154, 1.0349921359629768, 1.0038022813688212, 1.0025482801069494, 1.3442622950819672, 1.0510083036773428, 1.1615008156606852, 1.0024750508400753, 1.125, 1.0397067806963958, 1.0, 1.0864978902953586, 1.0646137951815873, 1.109375, 1.0041197309238545, 1.1810035842293907, 1.0192307692307692, 1.007902581981709, 1.0261770419017666, 1.1440630433563295, 1.0313001605136436, 1.0495145631067961, 1.0144546031447577, 1.254646840148699, 1.0588235294117647, 4.0, 1.1, 1.0042763489662128, 2.1666666666666665, 1.040132195327863, 1.0771268832655994, 1.1791758646063282, 1.0629948970614111, 1.0030906929585344, 1.0909090909090908, 1.05625, 1.0116144018583042, 1.0250208213586083, 1.0588454607593363, 1.0070185950825894, 1.0742687693759267, 1.1, 1.0950920245398772, 1.2159468438538206, 1.0069253679553538, 1.0578512396694215, 1.0302371899330074, 1.2154531946508171, 1.0015847860538827, 1.0179393337882265, 1.052325581395349, 1.0050988335545157, 1.25, 1.0104210521102135, 1.0047262742762568, 1.1430728576821443, 1.0031712473572938, 1.2432432432432432, 1.165165165165165, 1.1339622641509435, 1.0499231329395582, 1.1764705882352942, 1.002974677170151, 1.088235294117647, 1.0227173755262011, 1.2654978083907327, 1.1111111111111112, 1.0424354243542435, 1.0866425992779782, 1.1746031746031746, 1.0970287836583101, 1.0375440228586617, 1.0577864838393731, 1.06323440470019, 1.0486226791446527, 1.1333333333333333, 1.0298611111111111, 1.1094482509917056, 1.0618882222923902, 1.0273109243697478, 1.3792921288959323, 1.140159045725646, 1.1869918699186992, 1.062111801242236, 1.0054727851101153, 1.0264900662251655, 1.0238095238095237, 1.0358668954611219, 1.0132869991823386, 1.559748427672956, 1.0614713993416955, 1.074062401512764, 1.0234833659491194, 1.0892494929006085, 1.0074406363026907, 1.1300273441950552, 1.0015797788309637, 1.2217391304347827, 1.0191415313225058, 1.0171996048458378, 1.0196078431372548, 1.75, 1.021931407147949, 1.0102349247843896, 1.0062711046792088, 1.3148148148148149, 1.0651247717589776, 1.04500366154051, 1.0261641862698032, 1.158041958041958, 1.2903225806451613, 1.1063590320765335, 1.65, 1.0784810126582278, 1.7, 1.0163762158945078, 1.0008250825082508, 1.0925925925925926, 1.119047619047619, 1.0742240215924426, 1.0681818181818181, 1.0, 2.7333333333333334, 1.0054844606946984, 1.1502347417840375, 1.1003086419753085, 1.3, 1.0432586305056675, 1.2483130904183535, 1.1965646211386618, 1.0854700854700854, 1.2, 1.0744525547445256, 1.0272099794558005, 1.01146147223418, 1.1103565365025467, 1.4430379746835442, 1.1875, 1.1111111111111112, 1.3085106382978724, 1.2857142857142858, 1.0757737459978656, 1.0115133938492091, 1.0023725894676851, 1.0529801324503312, 1.0111457614750032, 1.000342052901401, 5.0, 1.0030107362549192, 1.0, 1.3333333333333333, 1.4285714285714286, 1.0878411910669976, 1.1269907795473595, 1.036147563731515, 1.0859375, 1.0, 1.0501672240802675, 1.1369863013698631, 1.0142857142857142, 1.0007234812214065, 1.0184744807488764, 1.0116241461395157, 1.1391160090058063, 1.3333333333333333, 1.0010184254976209, 1.0537084398976981, 1.2131822863027806, 1.0888888888888888, 1.0822857142857143, 1.0, 1.2542372881355932, 1.0666957279860505, 1.0556011629895674, 1.7755102040816326, 1.0032894736842106, 1.0058309704564163, 1.2132564841498559, 1.1284722222222223, 1.2878787878787878, 1.0633323145439462, 1.4215128989943158, 1.0703752237869364, 1.771186440677966, 1.3595505617977528, 1.3227848101265822, 1.1111111111111112, 1.0290275761973875, 1.037037037037037, 1.0037078932582184, 1.049689440993789, 3.5, 1.0140402347024309, 1.037450996747018, 1.181082075818918, 1.306092843326886, 1.0122102994520923, 1.009198606271777, 1.0805874664648827, 1.0831643002028397, 1.1111111111111112, 1.0059730882835576, 1.0058697972251867, 1.02306182531894, 1.0255255255255256, 3.5, 1.1627906976744187, 1.07493181375414, 1.239193083573487, 1.0222956674707144, 1.014159763116745, 1.1130846654825342, 2.0, 1.0086372360844529, 1.0538448105244775, 1.0397477546340532, 1.0648464163822526, 1.0054904141142365, 1.2108626198083068, 1.231651376146789, 1.0883341334613539, 1.003908217573628, 1.006808071374149, 1.1329479768786128, 1.1346765641569458, 1.0263157894736843, 1.006476217888753, 1.0107670963739142, 1.023475077173419, 1.1052978386926726, 1.0192307692307692, 1.0343234323432344, 3.5, 1.0155979202772965, 3.5, 1.5, 1.4666666666666666, 1.056768558951965, 1.1334635416666667, 1.0159033877038897, 1.0513233921132654, 1.169634703196347, 1.0209814461591815, 1.1538461538461537, 1.2749003984063745, 1.0115850447604002, 2.0, 1.0, 1.1463282937365011, 1.0, 1.263157894736842, 1.1335286730849727, 1.0078506097560975, 1.0279555633736113, 1.0, 1.0998189811223171, 1.0885167464114833, 1.0633963556130406, 1.0005583750521085, 1.0384193194291986, 1.0541276081040218, 1.0180001323539143, 1.0097048119692682, 1.1336898395721926, 1.5925925925925926, 1.2241579558652729, 1.6666666666666667, 2.0, 1.0006295704392465, 1.75, 1.5, 1.2448979591836735, 1.0501022494887526, 1.0005110542090105, 1.0354691075514875, 1.0160642570281124, 1.0, 1.0931558935361216, 1.0353233830845772, 1.1475409836065573, 1.0492813141683779]
origin-bjaq_15.87 	max: 5.0000	99th: 3.0000	95th: 1.7500	median: 1.0674	mean: 1.1800

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 17.969150 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=41.125711