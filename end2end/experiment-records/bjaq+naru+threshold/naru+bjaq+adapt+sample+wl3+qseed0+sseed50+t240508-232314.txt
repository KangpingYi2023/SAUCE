Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='naru', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 50, 'naru': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 5.0000	99th: 2.6667	95th: 1.6025	median: 1.0575	mean: 1.1518
ReportEsts: [1.1130742049469964, 1.0660744031093836, 1.0273624446360097, 1.0038610038610039, 1.0344827586206897, 1.0, 1.142018779342723, 1.0012654661879061, 1.25, 1.0372836218375499, 1.0097616411212775, 1.0027137512625879, 1.0175213675213675, 1.044186046511628, 1.0060049452490285, 1.0, 1.6981132075471699, 1.0187743535246192, 3.0, 2.6666666666666665, 1.173913043478261, 1.1354755229674358, 1.0484735202492212, 1.0011757789535567, 1.0355204736063148, 1.0, 1.0489242558208076, 1.2, 1.4, 1.2014388489208634, 1.0, 1.003120230338955, 1.0067725505634566, 1.3645948945615982, 1.0640328976354825, 1.0270462392525896, 1.0106951871657754, 1.001481193696428, 1.116812452648254, 1.119047619047619, 1.0554803788903924, 1.0335365853658536, 1.0, 1.127791914051456, 1.0556840968687335, 1.1900826446280992, 1.116504854368932, 1.298165137614679, 1.0212852539613992, 1.0093457943925233, 1.0337139553371395, 1.1616766467065869, 1.0086092256545227, 2.0, 1.2, 1.0149955521667302, 1.0177646188008882, 1.0687022900763359, 1.3043478260869565, 1.6666666666666667, 1.0134696415003108, 1.0523038605230386, 1.0363636363636364, 1.1264367816091954, 1.1, 1.1117649094873836, 1.0068694798822375, 1.1666666666666667, 1.0, 1.0690651783934622, 1.0274463007159904, 1.0505456634118322, 1.0990990990990992, 1.092805151175812, 1.2094117647058824, 1.1020408163265305, 1.0, 1.0458515283842795, 2.0, 1.0435880513070677, 1.1875, 1.0469140928011886, 1.165644171779141, 1.0298165137614679, 1.0698162729658793, 1.04, 1.0029329575293295, 1.0499901835672916, 1.1911764705882353, 2.3333333333333335, 1.10107948969578, 1.0148335183792367, 1.0354838709677419, 1.2650771388499298, 1.2139689578713968, 1.1159420289855073, 1.238532110091743, 1.0060085836909871, 1.0, 1.0063757183908046, 1.1974082073434125, 1.0317324185248713, 1.009906988346816, 1.088235294117647, 1.0019608274440426, 1.1188001188001189, 1.0510353753235548, 1.0462646947288585, 1.0219298245614035, 1.1666666666666667, 1.0, 1.157695428725994, 1.014963925787227, 1.065993265993266, 1.0129870129870129, 1.002096087501262, 1.0, 1.2186779400461183, 1.0889952153110047, 1.0, 1.2087912087912087, 1.0, 1.0150375939849625, 1.011124591891959, 1.0500116486759339, 1.0267857142857142, 1.8, 1.1448675496688743, 1.0, 1.0, 1.0129535532813283, 1.1818181818181819, 1.009032681885367, 1.0007856595140225, 1.0441182483542544, 1.190779014308426, 1.0164383561643835, 1.0313504823151125, 1.00199203187251, 1.0499040307101728, 1.041135328562134, 1.271604938271605, 1.0671885192433137, 1.0614214115945024, 2.0, 1.015270708005553, 1.0466507177033493, 1.0576923076923077, 1.0432327510146462, 1.0, 1.0199806248486316, 1.045925925925926, 1.02, 1.4476190476190476, 1.07007299270073, 1.0091867982306908, 1.0162584118438762, 1.0930651997474976, 1.155893536121673, 1.2039473684210527, 1.0208333333333333, 1.181159420289855, 1.1316666666666666, 1.2857142857142858, 1.0298665068129942, 1.0115593714019933, 1.0097869890616005, 1.0209958445724283, 1.030543677458766, 1.1127454877951817, 1.0084925690021231, 1.1239495798319328, 1.2024789387043673, 1.1025641025641026, 1.159, 1.0707596253902185, 1.0509229789942711, 1.0935897979070457, 1.0622107883262892, 1.0, 1.4157303370786516, 1.033396529094356, 1.0476190476190477, 1.0632630410654829, 1.1014492753623188, 1.0435633262838855, 1.0322890640015376, 1.0089974012360508, 1.1372549019607843, 1.1536444677503932, 1.055501404735967, 1.0, 1.3636363636363635, 1.089035376840255, 1.2179341657207718, 1.1226708074534162, 1.3461538461538463, 1.0257234726688103, 1.0023434039616403, 1.0179142615956742, 1.1798245614035088, 1.1881522082850215, 1.416, 1.0625, 1.0119047619047619, 1.0, 1.032258064516129, 1.0410818482889135, 1.6829268292682926, 1.160919540229885, 1.0148294611962432, 1.0957683741648108, 1.0762635295853078, 1.025959239439827, 1.1387932714165097, 1.2222222222222223, 1.164983164983165, 1.0572113737581363, 1.0083721063817566, 1.055544129211784, 1.0, 1.0579710144927537, 1.0239694325724302, 1.0113370752079651, 1.0510375771172182, 1.0614920749080248, 1.004863813229572, 1.0344827586206897, 1.0014082972177747, 1.1928637342356199, 1.1415679639029892, 1.032258064516129, 1.056419829910807, 1.0173160173160174, 1.0692913385826772, 1.0, 1.0276833414278777, 1.0591223760607413, 1.0255508673230191, 1.3880597014925373, 1.0909090909090908, 2.6666666666666665, 1.0539913121471658, 1.1090909090909091, 1.1022558517785164, 1.5, 1.0, 1.1428571428571428, 1.0692821368948247, 1.4795918367346939, 1.1546961325966851, 1.161764705882353, 1.064957264957265, 1.0140485312899106, 1.021877163485313, 1.0350877192982457, 1.0, 1.0043575234397588, 1.07986825854261, 1.043782837127846, 1.0598413683091104, 1.0719764311474578, 1.0315005921163931, 1.1049284578696343, 1.014858370156506, 1.0663875598086126, 1.1286274509803922, 1.19171666910581, 1.5454545454545454, 1.060986450124928, 1.1897654584221748, 1.2727272727272727, 1.0869565217391304, 1.1785454545454546, 1.0555555555555556, 1.1142857142857143, 1.0139736084387494, 1.0167130919220055, 1.2201834862385321, 1.00439533570468, 1.0016778523489933, 1.006867309610908, 1.0082599973251305, 1.5, 1.0712259003273918, 1.2, 1.003503342901225, 1.038876889848812, 1.0162122798234037, 1.3, 1.6666666666666667, 1.0434782608695652, 1.591549295774648, 1.0165101914762198, 1.0, 1.120795107033639, 1.004524886877828, 1.0368589743589745, 1.0003136471353562, 1.1886792452830188, 1.0062893081761006, 1.0109601321895654, 1.0892887455440503, 1.0526182859067184, 1.188034188034188, 1.0, 1.2267303102625298, 1.0123152709359606, 1.1526479750778815, 1.0160909856781803, 1.0629432624113475, 1.1126760563380282, 1.0727272727272728, 1.0068587105624143, 1.0636663007683864, 1.4285714285714286, 1.0231673677002837, 1.0769230769230769, 1.0, 1.0237561631555356, 1.1904761904761905, 1.75, 1.0318412169529076, 2.0, 1.0167364016736402, 1.059593023255814, 1.0467596390484004, 1.0200617283950617, 1.1174934725848564, 1.098901098901099, 1.007481161812254, 1.0002190793797618, 1.0013642564802183, 1.0390225902997008, 1.1143499496084968, 3.0, 1.1111111111111112, 1.0268811526863553, 1.3333333333333333, 1.048687089715536, 1.0, 1.0, 1.0, 1.1690140845070423, 1.0874159462055715, 1.29, 1.0151515151515151, 1.0, 1.0579227696404794, 1.0002341170092168, 1.5, 1.072066706372841, 1.0, 1.0084263265770894, 1.0449438202247192, 1.01835769446597, 1.1682027649769586, 1.0018181818181817, 1.1075471698113208, 1.1296296296296295, 1.0270313487500857, 1.007604905518225, 1.0159786950732357, 1.0, 1.2142857142857142, 1.8333333333333333, 1.5, 1.1428571428571428, 1.0024432742446747, 1.25, 1.1480865224625625, 1.0891089108910892, 1.0797537619699042, 1.0049700489157445, 1.0010298661174046, 1.0901029613186606, 1.0317175344105327, 1.2903225806451613, 1.5, 1.0105263157894737, 1.0398230088495575, 1.0084439744644187, 1.2857142857142858, 3.142857142857143, 1.0579064587973275, 1.0267441860465116, 1.0103334930945753, 1.1558073654390935, 1.342769701606733, 1.048780487804878, 1.4035087719298245, 1.0808477237048666, 1.0317796610169492, 1.1923076923076923, 1.0568862275449102, 1.0982142857142858, 1.0587781815893393, 1.0239642633399613, 1.0073260073260073, 1.2112676056338028, 1.0776699029126213, 1.0783132530120483, 1.0, 1.0570721784117736, 1.002940528577942, 1.000970391767467, 1.0121233988814722, 1.0450372920252438, 1.0141798259748631, 1.8333333333333333, 1.2175590931017848, 1.2, 1.0785653287788215, 1.1111111111111112, 1.0246609810951035, 1.0434782608695652, 1.094153052450559, 1.225296442687747, 1.1265822784810127, 3.0, 1.1891327063740857, 1.005350870774184, 1.0175931124836235, 1.0, 1.05, 1.053742802303263, 1.2701149425287357, 1.081984418520163, 1.0582120582120582, 1.1666666666666667, 1.0267471958584986, 1.1161801481758478, 1.0613452278750326, 1.0081670729668124, 1.0824561403508772, 1.208955223880597, 1.0227272727272727, 1.25, 1.0180878552971577, 1.3448275862068966, 1.0368349249658937, 1.121212121212121, 1.0127838804580185, 1.16, 1.0791435843689174, 1.0820827522082752, 1.1171605789110959, 1.0, 1.1067961165048543, 1.24, 1.0026849293746838, 1.275711159737418, 1.0, 1.1465183752417796, 1.0115526476530565, 1.2199191102123357, 1.0, 2.0, 1.181747572815534, 1.0017953321364452, 1.3677130044843049, 1.0, 1.017555577544693, 1.0773143438453714, 1.0869565217391304, 1.0822598870056497, 1.0272727272727273, 1.0091863517060367, 1.1483870967741936, 1.0429112326461927, 1.1145169622868951, 1.0, 1.0675675675675675, 1.0923542906301527, 1.0113543229158612, 1.026271362634621, 1.0, 1.0491993501972616, 1.0268541682119474, 1.0288108957569408, 2.0, 1.1180223285486444, 1.0795631090814934, 1.117703191839421, 1.1772312262461229, 1.0317030935974734, 1.1453923803321393, 1.0050675675675675, 1.0036293249455601, 2.0, 1.137371440384516, 1.7209302325581395, 1.2, 1.2781456953642385, 1.1304347826086956, 1.0342235478698643, 1.0827966881324746, 1.0538257163063631, 1.138453500522466, 1.0506502557318183, 1.0309580253800028, 1.0028202549787903, 1.0679611650485437, 4.0, 1.0521762093386149, 1.0196078431372548, 1.0069628193430658, 1.0296611388726369, 1.0755798090040927, 1.2468051118210863, 1.066326530612245, 1.4285714285714286, 1.0101323102651123, 1.006526785614157, 1.0163487486599387, 1.1176686217008798, 1.0390182819934886, 1.0061855670103093, 1.0034296961016438, 1.007061379684954, 1.0902777777777777, 2.0, 1.0833333333333333, 1.0465489566613162, 1.0580524344569289, 1.0222984562607205, 1.1213333333333333, 1.0625, 1.3006535947712419, 1.0554699537750385, 1.0494505494505495, 1.0219174031232583, 1.3780487804878048, 1.021469690773538, 1.0, 1.091235632183908, 1.4087301587301588, 1.2340425531914894, 1.0025203024362923, 1.2105960264900661, 1.0454545454545454, 1.1180285343709468, 1.0337789703647415, 1.0, 1.6382978723404256, 1.5, 1.0, 1.0602409638554218, 1.2068126520681266, 1.35, 1.1195652173913044, 1.0281960909964756, 1.048661800486618, 1.0025692850536123, 1.0211989745612304, 1.0953545232273838, 1.018100381009627, 1.069364161849711, 1.0959792477302206, 1.1475568456700531, 1.08929053142703, 1.0534682080924855, 1.0008099352051836, 1.0251441633331602, 1.0381332514583972, 1.0072704096687006, 2.0, 1.0853333333333333, 1.0194085027726432, 1.0780141843971631, 1.0, 1.0408163265306123, 1.25, 1.1649484536082475, 1.5925925925925926, 1.5, 1.0210902091747345, 1.0320597121023636, 1.0041128844512275, 1.0410151646106702, 1.1189189189189188, 1.0534629404617255, 2.0, 1.1846153846153846, 1.1571428571428573, 1.0260134904953329, 1.006936155111785, 1.0732429661692675, 1.0084391203289826, 1.1063218390804597, 1.0145982683176613, 1.1616341030195383, 1.0237684149158015, 1.0206517441969916, 1.3636363636363635, 1.1420454545454546, 1.0, 1.0090702947845804, 1.0196632622982087, 3.0, 1.0605504587155963, 1.061940606783862, 1.2857142857142858, 1.1986700634742433, 1.2, 1.1875, 1.0233515487976343, 1.7692307692307692, 1.002714526351507, 1.0064488392089423, 1.2258064516129032, 1.2608695652173914, 1.283068783068783, 1.0062171209947393, 1.109750122488976, 1.0183446837229277, 1.010843036050094, 1.0, 1.1647838366282859, 1.0061349693251533, 2.0, 1.075973891182508, 1.0240245695994463, 1.131504257332072, 1.0129386799450462, 1.0417974431600705, 1.3294117647058823, 2.0, 1.0859642449600608, 1.0393964794635373, 1.0136743610031305, 1.0470313542361573, 1.0330126967477191, 1.1245163008569503, 1.2014652014652014, 1.0154892330940688, 1.103321033210332, 1.0152825066203797, 1.0946372239747635, 1.0415094339622641, 1.08140756302521, 1.0415764514064814, 4.0, 1.0085135635344509, 1.001978111549587, 1.045214708094723, 1.1875, 1.0036936371872605, 1.1630901287553648, 1.0, 1.0249792141127136, 1.0134426229508198, 1.106280193236715, 1.1764705882352942, 1.6666666666666667, 1.042326648054242, 1.5, 1.4172185430463575, 1.0769230769230769, 1.0573232851859604, 1.2857142857142858, 1.2950819672131149, 1.119496855345912, 1.0, 1.343915343915344, 1.092142857142857, 2.0, 1.0, 1.08130081300813, 1.0740740740740742, 1.0416171224732462, 1.0159914712153517, 1.0126582278481013, 1.008849557522124, 1.089150378938971, 1.0467532467532468, 1.5123456790123457, 1.6013071895424837, 1.2692307692307692, 1.0, 1.2743589743589743, 1.1962481962481963, 1.1037628278221208, 1.0431211498973305, 1.0175118764845605, 1.2494186947760038, 1.0010683443629997, 1.0803295973757177, 1.0649819494584838, 1.0202863961813842, 1.2222222222222223, 1.0, 1.0303030303030303, 1.0441362916006338, 1.1386934673366833, 1.0065359477124183, 1.1372549019607843, 1.0380297823596794, 1.0539302079661614, 1.0019640544437114, 1.0384615384615385, 1.1, 1.0429311621021466, 1.1115455991516436, 1.0503843556012995, 1.07009080215176, 1.1973684210526316, 1.0400177200236267, 1.0023675519968382, 1.2165109034267914, 1.0181441161223432, 1.1111111111111112, 1.055767397521449, 1.3614864864864864, 1.0192307692307692, 1.2274247491638797, 1.0347890451517394, 1.0, 1.0841584158415842, 1.0815055794591948, 1.3333333333333333, 1.0080322244246491, 1.2076271186440677, 1.0465116279069768, 1.0633639855098802, 1.0079941860465116, 1.0990464679022294, 1.024437927663734, 1.0665859564164648, 1.0135256988277728, 1.206896551724138, 1.0714285714285714, 1.0, 1.1111111111111112, 1.0146542327721932, 1.8333333333333333, 1.110561797752809, 1.0438856281298798, 1.0954807266282676, 1.0617882749894558, 1.0052203846299739, 1.1336548767416934, 1.0813953488372092, 1.0263522884882108, 1.0057244607340723, 1.0406535788318498, 1.001706492821705, 1.014478587574073, 1.25, 1.046875, 1.256916996047431, 1.0169378007296825, 1.0651465798045603, 1.0033848106621537, 1.1486725663716815, 1.023391812865497, 1.0660358992329557, 1.0122282608695652, 1.002758786134101, 1.3125, 1.0307462405572683, 1.0034887185684251, 1.1412505623031939, 1.0008428150021071, 1.21875, 1.02863436123348, 1.0746268656716418, 1.625, 1.0381826461624688, 1.3461538461538463, 1.0184804928131417, 1.0483516483516484, 1.1995954146999326, 1.030182133564614, 1.068235294117647, 1.4545454545454546, 1.0275229357798166, 1.0033824772969595, 1.0159508861603423, 1.0089703563643673, 1.0869758035904349, 1.0156994999418536, 1.0, 1.0682967959527825, 1.0289447236180904, 1.0224563596589133, 1.0131979695431472, 1.2013888888888888, 1.100744416873449, 1.0602636534839924, 1.1590909090909092, 1.0087411672337085, 1.0, 1.3333333333333333, 1.0115335177229055, 1.0774711946634323, 1.0023484119345525, 1.0684158415841585, 1.0391061452513966, 1.1421319796954315, 1.0024839577727178, 1.1060990257573735, 1.0264150943396226, 1.3135135135135134, 1.0105042016806722, 1.036518922102783, 1.0119047619047619, 2.3333333333333335, 1.018019345535686, 1.0066181153601197, 1.0471641791044777, 1.2571428571428571, 1.0537962609690958, 1.0052011264471716, 1.0467922307239552, 1.0525, 1.1538461538461537, 1.1212938005390836, 1.0821052631578947, 1.09375, 1.72, 1.0448988713822773, 1.0089197224975224, 1.0884476534296028, 1.2058823529411764, 1.03086233992042, 1.0861673273523889, 1.0189605783658437, 1.0462467815408991, 1.6666666666666667, 1.0, 2.0, 1.0268240343347639, 1.5384615384615385, 1.3333333333333333, 1.5, 1.2397372742200328, 1.0203327171903882, 1.035530280070597, 1.0225184335833613, 1.08, 1.4264705882352942, 1.0, 1.0, 1.4054054054054055, 1.2962962962962963, 1.0218068535825544, 1.0156656288201644, 1.0037354705836348, 1.0390625, 1.0066815754019545, 1.0009809318852911, 5.0, 1.0085060052396992, 1.1257142857142857, 1.0, 1.3333333333333333, 1.0198224852071005, 1.1015563365129455, 1.0475663058106162, 1.031055900621118, 1.0, 1.0278884462151394, 1.2484662576687116, 2.0, 1.5, 1.1304133858267718, 1.1290028835938686, 1.1455768680217577, 1.25, 1.000086032891036, 1.0720371804802478, 1.1732851985559567, 1.3333333333333333, 1.1639344262295082, 1.0034184644136845, 1.868421052631579, 1.0057330057330058, 1.0661469748976469, 1.1411764705882352, 1.0, 1.0624931129476585, 1.1596925704526047, 1.078512396694215, 1.2321428571428572, 1.044508987474083, 1.0865116279069766, 1.025785933535011, 1.7578947368421052, 1.2142857142857142, 1.208955223880597, 1.0794078061911172, 1.0495049504950495, 1.0028628342058639, 1.033260740447436, 1.064410480349345, 3.0, 1.25, 1.0230535299695889, 1.1688654353562005, 1.3829994164559425, 1.0286511428264835, 1.0538551597257066, 1.1023094010645877, 1.1951219512195121, 1.0416666666666667, 1.0705209122275519, 1.007660296888263, 1.0559811431938715, 1.1724845995893223, 2.5, 1.08, 1.0115782832968419, 1.082437275985663, 1.0001559940722253, 1.0020476471746407, 1.0909090909090908, 2.0, 1.027611044417767, 1.0386342290335142, 1.043865661411926, 1.02734375, 1.0219270013827302, 1.1335740072202165, 1.2293080054274084, 1.0742028985507246, 1.0015083011077837, 1.0507275220025651, 1.1059907834101383, 1.1370038412291934, 1.0, 1.0422077922077921, 1.0158568012443991, 1.0515191545574636, 1.0498521335023236, 1.0576809888169512, 1.048374306106265, 1.3846153846153846, 1.0743099787685775, 2.5, 1.5, 1.4166666666666667, 1.0358056265984654, 1.1263823064770933, 1.0201270006312897, 1.0516444172573856, 1.2797829036635007, 1.0497907949790795, 1.059782608695652, 1.3061224489795917, 1.0212038940664914, 1.6, 1.3333333333333333, 1.1684552845528455, 1.0, 1.2132471728594507, 1.0969141755062681, 1.0008111762054979, 1.0325915826719254, 1.25, 1.0459844559585492, 1.2887596899224807, 1.1867830423940149, 1.0009182989430379, 1.0588235294117647, 1.0406272273699215, 1.0189693830982003, 1.0152955315197203, 1.0906200317965025, 1.5106382978723405, 1.2458100558659218, 1.0, 1.0, 1.0006705768749329, 1.6666666666666667, 1.5714285714285714, 1.3846153846153846, 1.0422195416164053, 1.0561797752808988, 1.0433776749566224, 1.1006044905008636, 1.0, 1.2253258845437616, 1.0257639304973039, 1.1121076233183858, 1.0452261306532664, 1.25, 1.0244252873563218, 1.014052838673412, 1.059670781893004, 1.0412792859799183, 1.0006630656273248, 1.2550894162636375, 1.0853932584269663, 1.0, 1.0724288192240978, 1.0158475942427758, 1.033850430416069, 1.2695652173913043, 1.0526608660461352]
origin-bjaq_15.87 	max: 5.0000	99th: 2.6667	95th: 1.6025	median: 1.0575	mean: 1.1518

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 20.579534 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=naru', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[2.9802322e-07 5.9604645e-08 2.3841858e-07 1.2516975e-06 4.7683716e-07]
Distance score: 4.6491624061673065e-07
SAUCE Drift detection: False
Detection latency: 0.0232s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 2.041182 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 6.0000	99th: 2.5025	95th: 1.7007	median: 1.0656	mean: 1.1640
ReportEsts: [1.1815384615384616, 1.0538689796850034, 1.027849604711297, 1.040518638573744, 1.0, 1.0, 1.1797190784155214, 1.0124275406074512, 1.4, 1.0099118942731278, 1.0521193771626298, 1.0028998801045834, 1.0664150943396227, 1.015267175572519, 1.0344622697563874, 1.6428571428571428, 1.0576923076923077, 1.25, 1.4444444444444444, 1.1568247821878026, 1.0457881136950904, 1.0978824259070572, 1.0126903553299493, 1.1003649635036497, 1.067890179280294, 1.001160785633175, 2.0, 1.0432200862232586, 1.75, 1.0, 1.034957627118644, 1.0, 1.0026678320076405, 1.0000128131206356, 1.3180129990714948, 1.0436563820253488, 1.0157847179081718, 1.0225225225225225, 2.0, 1.0023522987419402, 1.0402122312203295, 1.0069987749111506, 1.0088105726872247, 1.031573012591618, 1.055855855855856, 1.1437304417436869, 1.1363636363636365, 1.0049382716049382, 1.131578947368421, 1.0853391684901532, 1.0444444444444445, 1.0074074074074073, 1.0762331838565022, 1.2666666666666666, 1.08178872635441, 1.0464076156087152, 1.0712681539152569, 1.1552511415525115, 1.108433734939759, 1.0127142286013031, 1.1044776119402986, 1.057819986310746, 1.0822510822510822, 1.0606060606060606, 1.116504854368932, 1.0909090909090908, 1.2244962761965243, 1.0575803321112789, 1.7142857142857142, 1.0, 1.0529622980251347, 1.012012012012012, 1.0510105871029836, 1.0942698706099816, 1.076672417097949, 1.0198845413726747, 1.0145137244584759, 1.2, 1.0780141843971631, 1.0171575689416401, 1.3107594936708862, 1.0, 1.0, 1.9285714285714286, 1.0079635949943118, 1.1090909090909091, 1.2, 1.5555555555555556, 1.5, 1.0597036397640627, 1.0916666666666666, 1.0276568734131302, 1.0142651888341543, 1.234974572353213, 1.0248618784530388, 1.3137724550898204, 1.311377245508982, 1.1692307692307693, 1.9166666666666667, 1.1200157915515199, 1.5333333333333334, 2.0, 1.0728099385245902, 1.1875536480686695, 1.004982206405694, 1.007346189164371, 1.175, 1.023171794865082, 1.1231193580742227, 1.1628073770491802, 1.0653282345442958, 1.0339563042906028, 1.1428571428571428, 1.5, 1.1180844084845833, 1.0287805023490375, 1.0557432432432432, 1.0227272727272727, 1.0048761912297794, 1.0, 1.1708371949335805, 1.1610576923076923, 1.0, 1.294392523364486, 1.4285714285714286, 1.004201680672269, 1.0301881899463072, 1.1231476088785348, 1.09375, 1.8, 1.2076242341729067, 2.0, 1.5, 1.0140226231653735, 1.0769230769230769, 1.044871794871795, 1.0422104169072641, 1.0289460413514877, 3.0, 1.4666666666666666, 1.0406504065040652, 1.0338983050847457, 1.0538666666666667, 1.0554873707408035, 1.1846153846153846, 1.0472569255839217, 1.032356455568832, 2.0, 1.0007680491551458, 1.0746720484359233, 1.0333846944016436, 1.0299970734562482, 1.3333333333333333, 1.0518586042742835, 1.0436408977556109, 1.018032786885246, 1.0930232558139534, 1.0, 1.0710327455919395, 1.0693472634908463, 1.1091893517822229, 1.179650238473768, 1.1333333333333333, 1.0535714285714286, 1.0621468926553672, 1.0924137931034483, 1.1111111111111112, 1.019081008503655, 1.125, 1.080335731414868, 1.0203132648066568, 1.1893830703012913, 1.034590377113134, 1.0299295774647887, 1.0696864111498259, 1.2156799483787708, 1.0311710193765795, 1.146523178807947, 1.0373514431239388, 1.0867305061559507, 1.0388159731918458, 1.0041084809264305, 1.0833333333333333, 1.05, 1.0074921007198931, 1.0786480072018987, 1.0857142857142856, 1.083009708737864, 1.2885714285714285, 1.0, 1.0852130325814537, 1.0220529153092084, 1.0357142857142858, 1.0327102803738317, 1.0152467356549955, 1.0293070716658757, 1.0032209905466618, 1.0139442231075697, 1.0358928657449782, 1.0920785888861522, 1.0938194753223656, 1.0169411764705882, 1.089096089096089, 1.017896581479243, 1.1827676240208878, 1.1838635964141326, 1.2485207100591715, 1.037037037037037, 1.0294117647058822, 2.0, 1.0491803278688525, 1.0368675643875016, 1.6411764705882352, 1.2912621359223302, 1.0185567010309278, 1.5333333333333334, 1.0043295137170485, 1.0892448512585813, 1.0510204081632653, 1.3333333333333333, 1.1608391608391608, 1.017000274197971, 1.0056396379136932, 1.0953690152623876, 2.0, 1.076326002587322, 1.0071938909281595, 1.0201950461724347, 1.0134408602150538, 1.1980360065466449, 1.021523178807947, 1.0887054161162484, 1.0085470085470085, 1.0015043266857309, 1.0388099401063948, 1.1088435374149659, 1.371009490940466, 1.0378440366972477, 2.5, 1.1085120207927226, 1.0, 1.0126126126126127, 1.101470177724016, 1.004334121355398, 1.5612903225806452, 1.0769230769230769, 3.3333333333333335, 1.1082159039253927, 1.1029411764705883, 1.05530904671735, 1.5, 1.0699815837937385, 1.006, 1.5714285714285714, 1.0159849219680301, 1.1204545454545454, 1.0581613508442778, 1.0119047619047619, 1.015010721944246, 1.0104581914430044, 1.0307692307692307, 2.0, 1.0066050425964888, 1.1374863889048084, 1.0986937590711177, 1.038506904748943, 1.0691317645059892, 1.0195404707032614, 1.1268357810413885, 1.039784033711811, 1.057942057942058, 1.1547174840085288, 1.1174646916982431, 1.7142857142857142, 1.093181157167357, 1.08994708994709, 1.2452830188679245, 1.0689655172413792, 1.0746268656716418, 1.119871794871795, 1.0230994227288712, 1.0029980248306998, 1.278301886792453, 1.2188295165394403, 1.018331307501507, 1.1018237082066868, 1.0467584686223221, 1.010618341415071, 1.2142857142857142, 1.048780487804878, 1.0012187690432663, 1.0025524802659667, 1.0772407092543115, 1.0110671823725808, 1.0679205851619644, 1.0150501672240804, 1.0093397514189237, 1.017117915842597, 1.0420726555899746, 1.0840767235728332, 1.062439024390244, 1.2307692307692308, 1.0, 1.0769354838709677, 1.2222222222222223, 1.0326678765880217, 1.0099364115381244, 1.0613414524939555, 1.0810810810810811, 1.4035087719298245, 1.0347003154574133, 1.127770083102493, 1.014287852385585, 1.0869565217391304, 1.0916040259905722, 1.010145061810096, 1.0808080808080809, 1.6666666666666667, 1.8461538461538463, 1.0854341736694677, 1.2, 1.0105674491664816, 1.0387481371087928, 1.1904761904761905, 1.0260754668444008, 1.2608695652173914, 1.7, 1.025942118004119, 3.0, 1.0965250965250966, 1.0454545454545454, 1.3766666666666667, 1.0179455445544554, 1.485042735042735, 1.1826923076923077, 1.0076787101568394, 1.012688176404183, 1.1337099811676083, 1.023391240518718, 1.1115263191804652, 3.0, 1.0, 1.0286123313460935, 1.25, 1.0588503649635037, 1.0526315789473684, 4.0, 1.037037037037037, 1.1414821944177094, 1.1038338658146964, 1.3064516129032258, 1.137537239324727, 1.2, 2.75, 1.0887496416431175, 1.5, 1.1551724137931034, 1.019663831207985, 1.2116788321167884, 1.0624499599679744, 1.0037071362372567, 1.8, 1.25, 1.1351724137931034, 1.3846153846153846, 1.066, 1.0144912361527025, 1.0831471829238024, 1.053030303030303, 1.5, 1.003018431699955, 1.1578947368421053, 1.088235294117647, 2.0, 1.0947136563876652, 1.1111111111111112, 1.0042283298097252, 1.115702479338843, 1.0462270133164235, 1.0248476085993068, 1.0939890710382514, 1.08705173829729, 1.0411649397927751, 1.070967741935484, 1.0520547945205478, 1.0190064127327514, 1.080547112462006, 1.1515151515151516, 1.007438181714351, 1.0112693100383838, 1.1545773370419639, 1.0514018691588785, 1.1395348837209303, 1.0560747663551402, 2.0, 1.7407407407407407, 1.2457627118644068, 1.0694980694980696, 1.2468354430379747, 1.0225409836065573, 1.0405608412618927, 1.1832460732984293, 1.069501461174506, 1.1334850208570346, 1.0019545216189158, 1.2839506172839505, 1.0416666666666667, 1.0676691729323309, 1.0, 1.0101260508968788, 1.3559322033898304, 1.0064814814814815, 1.028381161402823, 1.0417031436530044, 1.0258064516129033, 1.7142857142857142, 1.029602595296026, 1.0, 1.101027397260274, 1.1818181818181819, 1.0323343848580442, 1.0314389359129383, 1.0097304052847706, 1.1587837837837838, 1.051532033426184, 4.0, 1.0926174496644296, 1.0054946999145717, 1.0418398023859219, 1.0, 1.3888888888888888, 1.0071485305798253, 1.3616504854368932, 1.089297840554122, 1.1851851851851851, 1.1304347826086956, 1.2041251778093884, 1.1092368066537808, 1.118387006266172, 1.028650363245677, 1.0951009334401032, 1.0405139957439842, 1.0810810810810811, 1.225576289791438, 1.0081298349794987, 1.2481751824817517, 1.029723991507431, 1.0, 1.5, 1.1334648257725182, 1.1510204081632653, 1.219824679703304, 1.0046853890597602, 1.1463990554899646, 1.0, 1.0078740157480315, 1.4444444444444444, 1.010853008377761, 1.1666666666666667, 2.0, 1.0958835545094219, 1.0, 1.0, 1.1349507202426081, 1.5, 1.2124352331606219, 1.0164547494390426, 1.3272727272727274, 1.0, 1.0192903513894136, 1.037313432835821, 1.0, 1.015343499449772, 1.0305343511450382, 1.0378197997775307, 1.1651877133105801, 1.0206185567010309, 1.1668502466356976, 2.0, 1.0795454545454546, 1.21243411853286, 1.0507347254447021, 1.086410635155096, 1.0, 1.0101561030656385, 1.0168040821434035, 1.0319474835886215, 1.0, 1.0916557161629434, 1.0817657632879187, 1.088837842891103, 1.1873839093855847, 1.044913104388323, 1.025533383709757, 1.0493562231759657, 1.0845860341102376, 1.5, 1.0185097499031466, 1.537313432835821, 1.0411877394636015, 1.035222894881673, 1.0157068062827226, 1.048934094417101, 1.061056105610561, 1.0573171410620412, 1.3264064875823618, 1.0530894798692514, 1.0948275862068966, 1.0096988386262467, 1.1612100181050091, 1.0843373493975903, 1.3466666666666667, 1.0304903953620612, 1.0622317596566524, 1.0557109296341873, 1.002471829106724, 2.0, 1.0680091185410334, 1.1038575667655786, 1.1, 1.2857142857142858, 1.004338563370091, 1.099290780141844, 1.5192307692307692, 1.0, 1.0769230769230769, 1.0312056737588653, 1.014936971162148, 1.0307486631016043, 1.018429164119705, 1.022588741484403, 1.1928429423459244, 1.0631067961165048, 1.0284084908649276, 1.2444444444444445, 1.0159643788010426, 1.0643863179074446, 1.0495495495495495, 1.0004223874639113, 1.0063424947145878, 1.0555502968181634, 1.5, 1.118279569892473, 1.5064935064935066, 1.072052351436669, 1.0368852459016393, 1.1282316442605997, 1.0147058823529411, 1.0271646859083192, 1.0429732062257582, 1.0, 1.95, 1.5714285714285714, 1.0, 1.0480769230769231, 1.4878048780487805, 1.3982142857142856, 1.1822429906542056, 1.0292311799252536, 1.00046904315197, 1.0235131199497474, 1.0006583007611602, 1.0019733308909546, 1.0032986911644735, 1.0243980738362761, 1.0944924406047516, 1.1637572734829593, 1.005021559307478, 1.1040350024307244, 1.0055005500550056, 1.149439601494396, 1.2266666666666666, 1.0238259528351665, 1.21007371007371, 1.0110576349389444, 1.0972222222222223, 1.1377147532042542, 1.031437125748503, 1.6666666666666667, 1.0096038415366146, 1.0666666666666667, 6.0, 1.0433526011560694, 1.0179933590594992, 1.031984585741811, 1.099236641221374, 1.0340909090909092, 1.0100909415340693, 1.2111573453699132, 1.0163636363636364, 1.0, 1.6, 1.0571396243494002, 1.4259259259259258, 1.0311720698254363, 1.0365733922434954, 1.0, 1.0916833667334669, 1.0919811320754718, 1.02504816955684, 1.1485884101040118, 1.0162576572538473, 1.023165335910085, 1.0116075275781216, 1.1842105263157894, 1.1818181818181819, 1.085886837285283, 1.0, 1.12453300124533, 1.2456896551724137, 1.033236994219653, 1.2272727272727273, 1.2424242424242424, 1.082822608103507, 1.103448275862069, 1.0465116279069768, 1.0648064178583885, 1.0215123859191655, 1.0806451612903225, 1.0201303680981595, 1.0089605734767024, 1.0185001651800463, 1.0, 1.0308436409768476, 1.1287533291984384, 1.263157894736842, 1.0, 1.014188422247446, 1.123003194888179, 1.0710188201230546, 1.1, 1.1970649895178198, 1.1690076510220395, 1.4612676056338028, 1.1884057971014492, 1.0491271486857066, 1.391304347826087, 1.4444444444444444, 1.0398329585608737, 1.0712742980561556, 1.030471969739739, 1.1008120974516942, 1.0443626650268079, 1.0183561598825908, 1.0924242424242425, 1.010585305105853, 1.1207430340557276, 1.0199331780139598, 1.0856072766185125, 1.0591016548463357, 1.1050788091068302, 1.0155797790312018, 1.0909090909090908, 1.0754189944134078, 1.0833333333333333, 1.1428571428571428, 1.0576671035386631, 1.0368166604685756, 1.0383177570093458, 1.0155440414507773, 1.6666666666666667, 1.035799522673031, 1.1042837078651686, 1.6095238095238096, 1.0124836837281639, 2.0, 1.1258061501074867, 1.3333333333333333, 1.3234501347708896, 1.0, 1.0811612753083546, 1.2727272727272727, 1.3302752293577982, 1.1451187335092348, 1.0, 1.046651230597719, 1.0972972972972972, 1.5, 1.0, 1.0472972972972974, 1.1067961165048543, 1.103259517292859, 1.0017421602787457, 1.0157687253613665, 1.2254901960784315, 1.1067415730337078, 1.1751313485113835, 1.5935828877005347, 1.530612244897959, 1.1666666666666667, 1.0, 1.132183908045977, 1.2553444180522566, 1.0601640838650865, 1.137511049995089, 1.0017464827103078, 1.2418726174669121, 1.002902112367321, 1.0231779085559076, 1.0361809045226131, 1.0100300902708124, 1.8888888888888888, 1.0, 1.0263157894736843, 1.0997968017146595, 1.1046606704824202, 1.018970189701897, 1.2842105263157895, 1.0765814351881227, 1.0092661313901445, 1.0049415148220038, 1.010204081632653, 1.173913043478261, 1.0041109969167523, 1.0923885967340161, 1.0420440791136294, 1.0381631438584118, 1.1931818181818181, 1.0990367992096814, 1.0100693764815902, 1.0052351665329649, 1.0067466266866567, 1.0051748974415182, 1.3728813559322033, 1.0127771514468245, 1.0499139414802066, 1.0004907708629045, 1.5, 1.0271966527196652, 1.0, 1.135306553911205, 1.0680990688905838, 1.2131147540983607, 1.0006232099289276, 1.1364023870417732, 1.0377358490566038, 1.0071404043872583, 1.010403041825095, 1.138560267857143, 1.0023980815347722, 1.0271028037383179, 1.0168885543585642, 1.175531914893617, 1.1111111111111112, 2.0, 1.1, 1.0135394176637946, 2.1666666666666665, 1.0659803462798316, 1.0561634333534715, 1.2099447513812154, 1.1136903673917018, 1.0651429931851322, 1.0723654454997738, 1.0970873786407767, 1.0175233644859814, 1.006200488997555, 1.0245201064873195, 1.0074838050458808, 1.0360654093097914, 1.3333333333333333, 1.0546448087431695, 1.2393442622950819, 1.0108216900504623, 1.0697050938337802, 1.0201294033069734, 1.2074074074074075, 1.0047318611987381, 1.0328718744697831, 1.004509582863585, 1.012302816830334, 1.1904761904761905, 1.011337524068966, 1.0152970068224305, 1.1795747911921033, 1.0140498770635757, 1.2564102564102564, 1.0479859595051582, 1.035923141186299, 1.0566693310278452, 1.4133333333333333, 1.00479117655744, 1.027027027027027, 1.108838226108682, 1.2118912080961417, 1.1517067003792667, 1.0812807881773399, 1.0424978317432785, 1.216446124763705, 1.093561834182492, 1.03555698113798, 1.0236294896030245, 1.0271604938271606, 1.0200422968291292, 1.125, 1.0700416088765603, 1.0444143075097474, 1.000756238971515, 1.0071556350626119, 1.1648936170212767, 1.3150147203140334, 1.1851851851851851, 1.028894472361809, 1.0080138416445286, 1.0, 1.0297897196261683, 1.0113984516554109, 1.023107076542191, 1.567353407290016, 1.0023118714599468, 1.0890899307190423, 1.0775919732441472, 1.1104417670682731, 1.01273811109631, 1.0844712693904304, 1.0314465408805031, 1.2657657657657657, 1.0325829383886256, 1.0317204520419403, 1.0198019801980198, 2.5, 1.0265722034257647, 1.003983557721174, 1.0191754554170662, 1.2023121387283238, 1.03163169433135, 1.0099288539399471, 1.0058809691837214, 1.0223463687150838, 1.3793103448275863, 1.115795390668915, 1.3, 1.0892857142857142, 1.606060606060606, 1.039269474330243, 1.0132122213047068, 1.008849557522124, 1.1219512195121952, 1.0993788819875776, 1.0380952380952382, 1.0784313725490196, 1.0434782608695652, 1.0279329608938548, 1.1076233183856503, 1.001392757660167, 1.4, 1.002597996425157, 1.2247838616714697, 1.169693683925183, 1.1339285714285714, 1.0, 1.1066473988439307, 1.0726995424504322, 1.0040967746240175, 1.0998278829604131, 1.7236842105263157, 1.0, 1.0, 1.451219512195122, 1.3389830508474576, 1.0514285714285714, 1.0123776302464274, 1.0018153767991127, 1.0063291139240507, 1.0418691290651507, 1.0012181080945786, 2.5, 1.0034120866041067, 1.1985, 1.3333333333333333, 1.2857142857142858, 1.0068409479599316, 1.0685765443151298, 1.0930945530310547, 1.105263157894737, 1.0, 1.0912408759124088, 1.1804511278195489, 2.0, 1.016295374602187, 1.040402238928826, 1.0027348375480543, 1.1829057720769611, 1.2, 1.008266278756053, 1.0665387076135637, 1.1019830028328612, 1.0801232665639446, 1.0947368421052632, 2.0, 1.0861801242236024, 1.070720263145165, 1.0578567519496511, 1.0373001776198933, 1.0204081632653061, 1.000585406168574, 1.2147458840372227, 1.1206896551724137, 1.2191780821917808, 1.038269774962943, 1.0367743896261776, 1.0403174338910626, 1.5151515151515151, 1.2395833333333333, 1.0456989247311828, 1.25, 1.0189449140192364, 1.0537897310513447, 1.0024402002595958, 1.0145852324521423, 2.0, 1.0523882896764252, 1.0697604662124522, 1.2351851851851852, 1.3865546218487395, 1.128826530612245, 1.0317947287686515, 1.0782379337512418, 1.052930056710775, 1.0166666666666666, 1.004302925989673, 1.0085384615384616, 1.050639134709931, 1.0071942446043165, 3.0, 1.0736842105263158, 1.0189845803492568, 1.2582972582972582, 1.0034622793773103, 1.0080496338970943, 1.1112433075550268, 1.6, 1.0019120458891013, 1.0006256670715101, 1.0525812619502868, 1.12012987012987, 1.0179850935254657, 1.1174698795180722, 1.1933333333333334, 1.079885877318117, 1.0024373755165024, 1.0378940829321324, 1.1416184971098267, 1.1075156576200418, 1.0263157894736843, 1.0658609839816933, 1.7572765072765073, 1.0676820430806138, 1.0096793708408953, 1.0439826002899952, 1.0291639662994168, 1.2894736842105263, 1.060931899641577, 3.5, 1.5, 1.4, 1.0278969957081545, 1.1590013140604467, 1.0188177034973693, 1.0459271903278224, 1.0307237141556669, 1.0156626506024096, 1.0044444444444445, 1.0260223048327137, 1.017164831115417, 1.8, 1.4166666666666667, 1.2172972972972973, 1.1111111111111112, 1.1505944517833553, 1.1430955360867752, 1.0127461456266218, 1.0239236714518518, 1.2, 1.0030975735673722, 1.2817337461300309, 1.0706256989593799, 1.0000038230683947, 1.0063694267515924, 1.042476817230033, 1.0044850336377522, 1.006639566395664, 1.1066666666666667, 1.5471698113207548, 1.2270081490104774, 1.0, 2.0, 1.0011104238241804, 2.0, 1.75, 1.3617021276595744, 1.0039447731755424, 1.001925118032427, 1.0677458033573142, 1.0348837209302326, 1.1428571428571428, 1.024543983934847, 1.021792966815255, 1.2416974169741697, 1.0480961923847696]
origin-bjaq_15.87 	max: 6.0000	99th: 2.5025	95th: 1.7007	median: 1.0656	mean: 1.1640

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 20.224265 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=42.877379