Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='naru', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 10, 'naru': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 5.0000	99th: 2.6667	95th: 1.5714	median: 1.0594	mean: 1.1514
ReportEsts: [1.1371841155234657, 1.05234310770074, 1.0257235919542362, 1.0096153846153846, 1.0, 1.0, 1.1366822429906542, 1.012422138056548, 1.25, 1.0359042553191489, 1.0119141480508103, 1.0017366675039627, 1.0285097192224621, 1.0651162790697675, 1.0243730130695867, 1.0, 1.5517241379310345, 1.0039118065433854, 3.0, 2.6666666666666665, 1.0, 1.0705628639206384, 1.0338133385757113, 1.0409535452322738, 1.028411973617453, 1.0, 1.0495772986434235, 1.2, 1.4, 1.2805755395683454, 1.0, 1.004938250726151, 1.0124655528763349, 1.2913429522752498, 1.06390625, 1.0269446889174734, 1.0240641711229947, 1.0010403449667236, 1.0603691714305392, 1.1904761904761905, 1.0554803788903924, 1.0, 1.0, 1.1246123484634902, 1.0843745179700757, 1.2396694214876034, 1.1650485436893203, 1.2922374429223744, 1.0156675861841127, 1.1134020618556701, 1.0640071306400714, 1.304932735426009, 1.0032794339531648, 2.0, 1.3298701298701299, 1.0752785776887441, 1.0618181818181818, 1.0687022900763359, 1.2608695652173914, 1.25, 1.021287713558706, 1.0379825653798256, 1.05, 1.103448275862069, 1.1, 1.1701221833789068, 1.0475456180930351, 1.1666666666666667, 1.0, 1.045720413335933, 1.0405727923627686, 1.062754212667054, 1.1058558558558558, 1.0773724642347855, 1.1741176470588235, 1.139240506329114, 1.0, 1.0495179666958807, 2.0, 1.034061235616517, 1.28125, 1.0445062132112493, 1.2331288343558282, 1.061926605504587, 1.0570539419087137, 1.04, 1.007522102575221, 1.040250914793518, 1.1323529411764706, 2.3333333333333335, 1.122, 1.033439012769762, 1.0093457943925233, 1.305750350631136, 1.2703016241299303, 1.1224489795918366, 1.25, 1.0164787510841284, 1.0, 1.02910927456382, 1.0865370770338374, 1.0034423407917383, 1.011926441706838, 1.1176470588235294, 1.0077678933360148, 1.0605292792792793, 1.0453967081229734, 1.0489192263936291, 1.0274015748031495, 1.0, 1.3333333333333333, 1.1349774595597986, 1.0050281711118987, 1.0842465753424657, 1.1168831168831168, 1.008871259849533, 1.0, 1.2362573099415204, 1.1559808612440192, 1.0, 1.2142857142857142, 1.1666666666666667, 1.1152882205513786, 1.0066110849749033, 1.0994796924749553, 1.0446428571428572, 1.8, 1.240066225165563, 1.0, 1.25, 1.0063387553547147, 1.1818181818181819, 1.0383640358289674, 1.000602912822574, 1.0586186883343007, 1.1212574850299402, 1.0735294117647058, 1.0384459732901659, 1.00199203187251, 1.0532734274711169, 1.0378090435914118, 1.0987654320987654, 1.0834964122635355, 1.0681685234053064, 2.0, 1.0091996320147194, 1.05294825511432, 1.0595533498759304, 1.0137638962413975, 1.0, 1.090308951676789, 1.045925925925926, 1.024, 1.4476190476190476, 1.0014598540145985, 1.06998556998557, 1.021786787193158, 1.1382451077644513, 1.1539923954372624, 1.082236842105263, 1.0425531914893618, 1.173913043478261, 1.0794912559618441, 1.1428571428571428, 1.0204648570110069, 1.0002211714460036, 1.0293609671848014, 1.0519792683842861, 1.0586438607208308, 1.0132782062495032, 1.0126315789473683, 1.084033613445378, 1.2129369613634162, 1.0657327586206897, 1.1730769230769231, 1.0393939393939393, 1.0613950498232079, 1.0322322642565784, 1.1095696785676892, 1.1666666666666667, 1.4157303370786516, 1.046058458813109, 1.0476190476190477, 1.1609322974472809, 1.2666666666666666, 1.004501091345012, 1.060541995002883, 1.0187866588749648, 1.1153846153846154, 1.089090909090909, 1.0777937044894215, 1.0, 2.0, 1.0756109206128739, 1.185017026106697, 1.1338212232096183, 1.1666666666666667, 1.0045219638242895, 1.0014489998304361, 1.0277199351343382, 1.1798245614035088, 1.1190049541477811, 1.1493506493506493, 1.0625, 1.0833333333333333, 1.0, 1.032258064516129, 1.0959211890770826, 1.6689895470383276, 1.0804597701149425, 1.0177953534354918, 1.0957683741648108, 1.0689509926012746, 1.0508148450482493, 1.020276986283215, 1.1578947368421053, 1.0057803468208093, 1.0362659503022162, 1.0209805273134585, 1.0484785848194973, 1.0, 1.0910973084886129, 1.0049041813562327, 1.0073372114262362, 1.0788716177317215, 1.007270547766717, 1.0055405176789038, 1.0344827586206897, 1.0033475001327263, 1.091011394007596, 1.1714608009024252, 1.0971428571428572, 1.0105787181082764, 1.0249801744647105, 1.1543307086614174, 1.0, 1.0472655283345707, 1.0532603841000447, 1.043131739334271, 1.4477611940298507, 1.0909090909090908, 2.6666666666666665, 1.04827561949315, 1.1636363636363636, 1.0263721068053864, 1.5, 1.5, 1.3333333333333333, 1.0410402275497765, 1.5714285714285714, 1.0718232044198894, 1.1421686746987951, 1.0686106346483706, 1.0236355822948002, 1.011790281830823, 1.1228070175438596, 1.0, 1.0124597945226868, 1.1041580897488679, 1.0683012259194395, 1.0110792900892613, 1.0978310560268196, 1.0314656922452294, 1.0834658187599364, 1.0202102001654842, 1.069377990430622, 1.1247459746756292, 1.2426369601709142, 1.7272727272727273, 1.0599173553719008, 1.1194029850746268, 1.2272727272727273, 1.16, 1.1141818181818182, 1.0555555555555556, 1.1359223300970873, 1.0070520153421707, 1.0779944289693593, 1.2201834862385321, 1.0200599780278512, 1.075812274368231, 1.0021183285064128, 1.0133921228424834, 1.5, 1.0360312841033104, 1.2, 1.006698269209569, 1.1101511879049677, 1.0113467752947067, 1.275, 1.4285714285714286, 1.0434782608695652, 1.5070422535211268, 1.0191035866442089, 1.0, 1.0489296636085628, 1.0184331797235022, 1.0396634615384615, 1.0012998380291316, 1.2038216560509554, 1.0188679245283019, 1.005009843903811, 1.0528206869235557, 1.0923466713262275, 1.1111111111111112, 1.0, 1.2517899761336515, 1.0, 1.1806853582554517, 1.0006744225257123, 1.0376460406750325, 1.0113960113960114, 1.0169491525423728, 1.0123456790123457, 1.082077051926298, 1.4285714285714286, 1.020671350507416, 1.0586080586080586, 1.1875, 1.0219382262056236, 1.2380952380952381, 1.75, 1.017114189171761, 2.0, 1.0205761316872428, 1.066860465116279, 1.0032921810699589, 1.0212437234453458, 1.1932114882506528, 1.1978021978021978, 1.008766352358663, 1.0124631824931234, 1.0013623978201636, 1.0040752736665164, 1.1318110236220473, 3.0, 1.1111111111111112, 1.0427002168370387, 1.3333333333333333, 1.050986842105263, 1.0, 1.0, 1.0454545454545454, 1.2028985507246377, 1.0884615384615384, 1.1944444444444444, 1.0487012987012987, 1.0, 1.0372836218375499, 1.019531875577456, 1.5, 1.1191185229303158, 1.0, 1.0172625825552266, 1.0348837209302326, 1.0496457622671216, 1.172811059907834, 1.0018181818181817, 1.101313320825516, 1.0188679245283019, 1.0177550065647496, 1.0068722552000386, 1.0319573901464714, 1.0, 1.1428571428571428, 1.8333333333333333, 1.5, 1.1428571428571428, 1.0027334002212447, 1.25, 1.0499168053244592, 1.099009900990099, 1.0070427926203782, 1.0277450800875425, 1.0093555093555093, 1.091189250460492, 1.0335731414868106, 1.2481426448736999, 1.5, 1.023454157782516, 1.113744075829384, 1.004760678357644, 1.4285714285714286, 3.142857142857143, 1.0913140311804008, 1.0226744186046512, 1.0003774508803787, 1.1623931623931625, 1.342769701606733, 1.0342388228636106, 1.509433962264151, 1.0808477237048666, 1.0317796610169492, 1.2307692307692308, 1.061654135338346, 1.1495327102803738, 1.0335416890636278, 1.0218342276577779, 1.0543136892665805, 1.4333333333333333, 1.0277777777777777, 1.0591715976331362, 1.0, 1.0213973579788036, 1.0145643253433605, 1.0167061210686508, 1.0170284250217538, 1.0067385444743935, 1.0181171142025234, 1.8333333333333333, 1.150506512301013, 1.2, 1.1067463706233989, 1.1111111111111112, 1.0248036033427796, 1.0318840579710145, 1.0084909716251076, 1.2015810276679841, 1.0686106346483706, 3.0, 1.103425985778927, 1.0003488823629347, 1.0241631414382932, 1.0, 1.2115384615384615, 1.0153550863723608, 1.2672413793103448, 1.072245779662373, 1.0833333333333333, 1.1666666666666667, 1.1009490940465918, 1.0357351532007386, 1.0644619461759546, 1.0121097978473426, 1.2085526315789474, 1.2155887230514095, 1.0909090909090908, 1.1538461538461537, 1.00253807106599, 1.3448275862068966, 1.0450204638472034, 1.2692307692307692, 1.060253130469907, 1.3157894736842106, 1.1047823421213978, 1.00232542115961, 1.1439661256175018, 1.0, 1.0857142857142856, 1.28, 1.0014786567570721, 1.2056892778993435, 1.0, 1.038339320254214, 1.0070361321242307, 1.2653382275825904, 1.0, 2.0, 1.1871844660194175, 1.0045004500450045, 1.431924882629108, 1.0, 1.0111649844976582, 1.0292728989612843, 1.0869565217391304, 1.0896421845574389, 1.0272727272727273, 1.0236220472440944, 1.1508064516129033, 1.0416301489921123, 1.0464956087480626, 1.0, 1.054054054054054, 1.1207568680813504, 1.0074728996242288, 1.044530780494824, 1.0, 1.0345056403450563, 1.0247363020036, 1.0288108957569408, 2.0, 1.1331738437001595, 1.0735370274469187, 1.0621325828642902, 1.123192521078153, 1.0269487014610796, 1.1401328939549458, 1.0243697478991596, 1.0749758919961427, 2.0, 1.1204713421882269, 1.574468085106383, 1.25, 1.2953020134228188, 1.1304347826086956, 1.0338759576356633, 1.014655172413793, 1.0928283349580443, 1.256632064590542, 1.0483716983133553, 1.0377384011903152, 1.023423142272617, 1.0970873786407767, 4.0, 1.054783339335014, 1.0188259109311741, 1.0099461227851432, 1.0281025503304209, 1.0922693266832917, 1.2379064234734338, 1.1176470588235294, 1.4285714285714286, 1.0296558120879395, 1.0223601776967763, 1.0031335175124692, 1.0846673781572393, 1.0099318403115871, 1.0556701030927835, 1.0033123873544743, 1.0198019801980198, 1.0872576177285318, 2.0, 1.1666666666666667, 1.0155763239875388, 1.0721062618595825, 1.0067114093959733, 1.0594530321046374, 1.0515463917525774, 1.0994475138121547, 1.0554699537750385, 1.1318681318681318, 1.0275186982459263, 1.3780487804878048, 1.0151309105119186, 1.0, 1.0014367816091954, 1.3968253968253967, 1.0921985815602837, 1.0240274599542334, 1.0702576112412179, 1.2015810276679841, 1.1456166419019316, 1.0193056610942248, 1.0, 1.702127659574468, 1.1666666666666667, 1.0, 1.0731707317073171, 1.0735930735930737, 1.3170731707317074, 1.1907514450867052, 1.0270746555591157, 1.169606512890095, 1.0339488198417321, 1.0072963912443305, 1.0989370400654128, 1.012254355434477, 1.088235294117647, 1.0757479312539784, 1.161586840832124, 1.045031055900621, 1.1213872832369942, 1.0498442367601246, 1.02461186977517, 1.0540111970486392, 1.0080139742939087, 2.0, 1.113022113022113, 1.044362292051756, 1.0482758620689656, 1.0, 1.1590909090909092, 1.25, 1.018018018018018, 1.4814814814814814, 1.5, 1.0257348840091718, 1.0314021681180026, 1.0063956646576477, 1.030409083838855, 1.1081081081081081, 1.037667071688943, 2.0, 1.1407407407407408, 1.1255239869585467, 1.013610112677194, 1.0061976643912347, 1.0248059300764607, 1.0212765957446808, 1.0754189944134078, 1.0284767704622928, 1.1651865008880995, 1.0347669125725947, 1.0402304260245863, 1.3636363636363635, 1.1317567567567568, 1.0, 1.0090702947845804, 1.0227490129919823, 3.0, 1.0407747196738022, 1.0189148720658827, 1.2857142857142858, 1.1751259365872244, 1.2, 1.1875, 1.0271883852691217, 1.7692307692307692, 1.0088768838451592, 1.0192225544639044, 1.1875, 1.3181818181818181, 1.279683377308707, 1.0023969319271333, 1.0399449035812671, 1.009519219183034, 1.009523555816029, 1.0, 1.2410927655876602, 1.0123456790123457, 2.0, 1.0924648845630462, 1.0343068828519275, 1.098391674550615, 1.017163768256744, 1.0165959089154766, 1.3294117647058823, 2.2857142857142856, 1.0505895777862304, 1.0402684563758389, 1.0333599171941017, 1.0256837891927952, 1.0579508843921641, 1.069142201766537, 1.054054054054054, 1.0326546292739147, 1.16796875, 1.0158008951580089, 1.0694006309148265, 1.1174089068825912, 1.039390756302521, 1.0654458752268166, 4.0, 1.0020973154362416, 1.0266001331994712, 1.0187354507264603, 1.0, 1.0070624431857913, 1.231818181818182, 1.0, 1.0119559850462017, 1.0134426229508198, 1.0725995316159251, 1.088235294117647, 1.6666666666666667, 1.0321090565452262, 1.5, 1.470790378006873, 1.0769230769230769, 1.0080540217353076, 1.2857142857142858, 1.1504854368932038, 1.1373165618448637, 1.0, 1.3280423280423281, 1.0937052932761087, 2.0, 1.0, 1.08130081300813, 1.0283687943262412, 1.0713436385255648, 1.0269396551724137, 1.0613598673300166, 1.0210843373493976, 1.089150378938971, 1.051948051948052, 1.6225165562913908, 1.7253521126760563, 1.3076923076923077, 1.0, 1.0205338809034907, 1.1933621933621934, 1.0157397691500525, 1.2036413517895, 1.0088848327837965, 1.210694972962147, 1.0121987371416714, 1.097429387496033, 1.0469314079422383, 1.0214797136038185, 1.375, 1.0, 1.0303030303030303, 1.001581003633268, 1.0831739961759081, 1.0065359477124183, 1.2492307692307691, 1.132569683085147, 1.0830664908645695, 1.0008207274879637, 1.064102564102564, 1.1, 1.0606957809030348, 1.0554745493107105, 1.03821271319801, 1.0636672438176555, 1.2105263157894737, 1.0838009450679267, 1.0032940532069472, 1.2108527131782947, 1.0430164630908125, 1.2222222222222223, 1.0527566539923954, 1.3918495297805642, 1.0192307692307692, 1.1257668711656441, 1.0347890451517394, 1.0, 1.1618037135278514, 1.041958748988946, 1.0740740740740742, 1.0005413193863986, 1.1875, 1.162162162162162, 1.034105089715165, 1.0148161697457472, 1.0883024442653775, 1.0264446620959844, 1.2202043132803633, 1.0041422452660054, 1.1940298507462686, 1.0, 1.0, 1.1111111111111112, 1.0137095797505147, 1.8333333333333333, 1.0232474481766267, 1.0564859189058209, 1.206468763845813, 1.0825628897011395, 1.0010952850586048, 1.0331189710610933, 1.08984375, 1.0069348127600555, 1.0257543381783174, 1.0371906636670416, 1.0073244972796778, 1.0369143683006143, 1.25, 1.046875, 1.316205533596838, 1.0770781608766264, 1.022801302931596, 1.0301911381407471, 1.1823008849557521, 1.0331384015594542, 1.0621319450371256, 1.0361613351877608, 1.0110765550239234, 1.25, 1.0000706048481995, 1.0045731200319288, 1.0632858340318525, 1.0008428150021071, 1.25, 1.1027837259100643, 1.044776119402985, 1.9375, 1.0345224797542585, 1.4230769230769231, 1.0110887096774193, 1.0395604395604396, 1.140930546190155, 1.0200370432732784, 1.0788235294117647, 1.0909090909090908, 1.0980392156862746, 1.0145042097135923, 1.011998470672904, 1.0017930630871814, 1.0229036943057943, 1.0630754383982055, 1.0769230769230769, 1.0351307189542485, 1.0935697500534074, 1.1168132505915442, 1.0100200400801602, 1.2083333333333333, 1.0045289855072463, 1.0278188298704685, 1.1789383561643836, 1.0310307609282245, 1.0, 1.3333333333333333, 1.0056086755470697, 1.0397951719092904, 1.0171107117743574, 1.0660094045125854, 1.0622505985634478, 1.0975609756097562, 1.0020798217858868, 1.1234538615337692, 1.0220588235294117, 1.2216216216216216, 1.0252100840336134, 1.0259902812546018, 1.0238095238095237, 1.75, 1.0295601635016605, 1.0005122808960762, 1.0068886337543055, 1.2307692307692308, 1.0492396813902969, 1.032649280523882, 1.015995429877178, 1.0875, 1.3076923076923077, 1.126010781671159, 1.0147368421052632, 1.090625, 1.4333333333333333, 1.0759749692703096, 1.0099108027750248, 1.082585278276481, 1.2058823529411764, 1.0395225198114153, 1.053632867840518, 1.0133279072133483, 1.0943968787254796, 1.6666666666666667, 1.037037037037037, 1.3333333333333333, 1.0349675558759914, 1.4615384615384615, 1.3333333333333333, 1.5, 1.2003179650238474, 1.1017964071856288, 1.0719545278387805, 1.0035035752392782, 1.198257080610022, 1.4558823529411764, 1.0, 1.096774193548387, 1.2837837837837838, 1.5217391304347827, 1.014018691588785, 1.0106812640565166, 1.0071074108397358, 1.046875, 1.0274785772416104, 1.0011560982933787, 5.0, 1.0060647817359056, 1.16, 1.0, 1.3333333333333333, 1.0269230769230768, 1.131750699275622, 1.0794240594519275, 1.0559006211180124, 1.0, 1.1168831168831168, 1.0550161812297734, 2.0, 1.5, 1.0826771653543308, 1.0468618069237263, 1.1211824040347436, 1.25, 1.0131166554372275, 1.067389620449264, 1.1168384879725086, 1.3333333333333333, 1.109375, 1.0009781446847417, 1.486842105263158, 1.0614267604010603, 1.0944810019104225, 1.016470588235294, 1.00390625, 1.0234159779614325, 1.1810418445772843, 1.1198347107438016, 1.2105263157894737, 1.0223741037360057, 1.2685802948021723, 1.049510765377924, 1.815217391304348, 1.275, 1.1343283582089552, 1.059445178335535, 1.0411295273173726, 1.0158068702599667, 1.0164782525388005, 1.044759825327511, 3.0, 1.25, 1.010562356665267, 1.183377308707124, 1.3365104065356934, 1.0100094826677906, 1.060712493728048, 1.0981210855949897, 1.078239608801956, 1.0208333333333333, 1.0143529224144805, 1.0452425468965092, 1.1066588096641132, 1.1208406304728546, 2.5, 1.1066666666666667, 1.04629663597344, 1.0712066905615292, 1.0131333565129437, 1.0123660543436663, 1.0965909090909092, 2.0, 1.0058411214953271, 1.010498571885442, 1.0312999771533014, 1.1144067796610169, 1.0357245029323416, 1.2030651340996168, 1.2293080054274084, 1.111304347826087, 1.00487194728378, 1.048640536723164, 1.1232718894009217, 1.1408450704225352, 1.0, 1.1163704716336296, 1.0098781388478582, 1.11889035667107, 1.0153918176731864, 1.0250998288648032, 1.065269943593876, 1.2857142857142858, 1.0912951167728238, 2.5, 1.5, 1.3076923076923077, 1.0332480818414322, 1.1658767772511849, 1.0197927884436853, 1.0416184044050822, 1.051831750339213, 1.102092050209205, 1.0706521739130435, 1.3877551020408163, 1.0410103621267552, 1.6, 1.4166666666666667, 1.0019550342130987, 1.0, 1.180817610062893, 1.1251236399604352, 1.0689854513922343, 1.0071496972943144, 1.25, 1.0456458400776951, 1.2887596899224807, 1.0376558603491273, 1.0001009202088131, 1.1107994389901823, 1.0518731988472623, 1.007474691987758, 1.0607236616824562, 1.09697933227345, 1.5106382978723405, 1.2695530726256983, 1.0, 1.0, 1.0006884589249312, 1.6666666666666667, 1.5714285714285714, 1.35, 1.037394451145959, 1.0561797752808988, 1.0361860999425618, 1.0723601177955406, 1.0, 1.2060831781502173, 1.019047619047619, 1.1838565022421526, 1.032258064516129, 1.25, 1.0153625110521662, 1.024390243902439, 1.079664570230608, 1.0539233915953887, 1.0066016801910551, 1.087833885747709, 1.021450151057402, 1.0, 1.034170458522926, 1.0015910606545928, 1.0043489956958394, 1.2695652173913043, 1.030275361622375]
origin-bjaq_15.87 	max: 5.0000	99th: 2.6667	95th: 1.5714	median: 1.0594	mean: 1.1514

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 18.624913 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=naru', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[3.5762787e-07 5.9604645e-08 5.9604645e-08 3.5762787e-07 5.3644180e-07]
Distance score: 2.74181360282455e-07
SAUCE Drift detection: False
Detection latency: 0.0234s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 2.045254 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 6.0000	99th: 2.6700	95th: 1.6744	median: 1.0645	mean: 1.1716
ReportEsts: [1.0405797101449274, 1.0188087774294672, 1.0257250228694341, 1.0064935064935066, 1.09375, 1.0, 1.2552814062248026, 1.008022374052106, 1.2, 1.0528052805280528, 1.0936401713928072, 1.0028323392448781, 1.0298245614035089, 1.0135922330097087, 1.036927621861152, 1.2, 1.0401234567901234, 1.2, 1.3333333333333333, 1.132183908045977, 1.0332239540607056, 1.0544200512996587, 1.0009871668311945, 1.1268796992481203, 1.035663030998852, 1.0087060000734922, 2.0, 1.0330269805439105, 1.2, 1.3333333333333333, 1.0180460485376477, 1.0, 1.0020404921186874, 1.0102887674759062, 1.325668700140779, 1.007210069656605, 1.0230699723273282, 1.061611374407583, 3.0, 1.0499441244734806, 1.0849403122130394, 1.1839493221433182, 1.0110741971207087, 1.0135166225698837, 1.0576208178438662, 1.1412417170844138, 1.1363636363636365, 1.068062827225131, 1.0429184549356223, 1.1446153846153846, 1.2352941176470589, 1.010752688172043, 1.0448430493273542, 1.1875, 1.0587245318150893, 1.014494559348783, 1.0243587906576874, 1.02863436123348, 1.0853658536585367, 1.0088006056707235, 1.03125, 1.050955359437923, 1.0405594405594405, 1.0148698884758365, 1.1238095238095238, 1.3846153846153846, 1.0217378752886837, 1.035136286201022, 1.5714285714285714, 1.0, 1.0459816722082556, 1.00587084148728, 1.0628019323671498, 1.1547388781431334, 1.10666823936463, 1.0557377049180328, 1.03839590443686, 1.259433962264151, 1.099290780141844, 1.0128757352600621, 1.1778791334093501, 1.6, 2.0, 1.3, 1.0227531285551763, 1.0161290322580645, 1.3381502890173411, 2.0, 1.3333333333333333, 1.0373717948717949, 1.0876877857609406, 1.0334932602238975, 1.0534496024621698, 1.1455979535280325, 1.1002865329512894, 1.367298578199052, 1.0793650793650793, 1.2337662337662338, 3.0, 1.1654223968565816, 1.1612903225806452, 2.0, 1.0208034370896062, 1.1408510638297873, 1.0072358900144718, 1.0006479736098022, 1.075, 1.0094775314434123, 1.0885644768856448, 1.066730611126336, 1.0629128656810318, 1.0201676270298585, 1.1428571428571428, 1.5, 1.1295528898582334, 1.0179515784274484, 1.0715896279594137, 1.035294117647059, 1.006853752008901, 1.0, 1.2104761904761905, 1.1735668789808917, 1.0, 1.262672811059908, 1.1428571428571428, 1.076271186440678, 1.0237134118673132, 1.1061546418412205, 1.064516129032258, 2.0, 1.25, 1.0, 1.2142857142857142, 1.0159654395191586, 1.3076923076923077, 1.0997830802603037, 1.0448679402377539, 1.0637847222222223, 1.1428571428571428, 1.4, 1.0871369294605808, 1.04118689105403, 1.0475935828877005, 1.0586839822145104, 1.221105527638191, 1.0595303113052976, 1.0038970528537794, 3.0, 1.0265180630284396, 1.0685483870967742, 1.0413650465356774, 1.0405485107637864, 1.0, 1.0469276094276094, 1.0357583230579532, 1.046075085324232, 1.0, 2.0, 1.1337642963699652, 1.0249718836787625, 1.1275208262655962, 1.1940993788819876, 1.122282608695652, 1.0363636363636364, 1.1637426900584795, 1.1695652173913043, 1.0, 1.0199670575883568, 1.4, 1.031063321385902, 1.1157455683003128, 1.2403100775193798, 1.0477476692515466, 1.03886925795053, 1.03125, 1.1586073500967118, 1.0041666666666667, 1.2125107112253641, 1.0629194630872483, 1.0585885486018642, 1.0126984126984127, 1.0154020095142606, 1.0389610389610389, 1.0, 1.0211602043883379, 1.038264267687047, 1.1636363636363636, 1.1121140786153403, 1.1675675675675676, 2.0, 1.1075794621026895, 1.0067211508898375, 1.1071428571428572, 1.0275181723779854, 1.0360399478940512, 1.004822706868056, 1.0032512772875057, 1.0070140280561122, 1.01130354989898, 1.0360041316216615, 1.0797895659798333, 1.0333781286746178, 1.0942353250855488, 1.005407928890217, 1.1796344647519583, 1.0544050544050545, 1.277456647398844, 1.082191780821918, 1.02020202020202, 1.0, 1.1111111111111112, 1.013039449298385, 1.672463768115942, 1.017391304347826, 1.034786253143336, 2.0625, 1.002862161603637, 1.006726457399103, 1.0212211315221376, 2.0, 1.188953488372093, 1.0526915408715465, 1.0191391568716635, 1.0479744988708355, 1.125, 1.1485189820609094, 1.024455515535059, 1.0098896224199567, 1.0267379679144386, 1.3126050420168067, 1.1201529219006008, 1.0642868680342432, 1.0084745762711864, 1.0023516153967944, 1.021692977399121, 1.1418181818181818, 1.1211340206185567, 1.0533175355450237, 1.5, 1.1021080368906455, 1.0, 1.0272801302931596, 1.0799143109952032, 1.0338950222738719, 1.3186119873817035, 1.1538461538461537, 3.3333333333333335, 1.1094354555047485, 1.3214285714285714, 1.0364775341630401, 1.5, 1.1395139513951396, 1.01314459049545, 1.2857142857142858, 1.0040345457983988, 1.1359447004608294, 1.1272189349112427, 1.1454545454545455, 1.0227758007117438, 1.0442442173211404, 1.0606060606060606, 2.0, 1.0667623636546497, 1.1426521239954075, 1.1291727140783745, 1.1006176262500718, 1.1020334521990152, 1.0385313554755085, 1.1092604930046635, 1.0278651421181035, 1.082828282828283, 1.0605875152998776, 1.1817852834740652, 1.6470588235294117, 1.061983098252684, 1.1438721136767318, 1.3137254901960784, 1.037037037037037, 1.095890410958904, 1.042175360710322, 1.0225664513804904, 1.0172401685393258, 1.232394366197183, 1.236503856041131, 1.0192527272637402, 1.0762331838565022, 1.0237330410793244, 1.0025716857400027, 1.3846153846153846, 1.4189189189189189, 1.0736906211936663, 1.0023607261021192, 1.0071600362733115, 1.0888336298741665, 1.0069481560662747, 1.0463538722442058, 1.0106002005443346, 1.0189971435454452, 1.04525117517132, 1.087592492072108, 1.0719144800777454, 1.0, 1.0714285714285714, 1.076588897827836, 2.6666666666666665, 1.0106571936056838, 1.074977132236846, 1.0383359363907425, 1.0512820512820513, 1.2992125984251968, 1.0851197982345524, 1.0856697819314642, 1.00549665793404, 1.125, 1.017778308077795, 1.0090782007515045, 1.0270935960591132, 2.0, 2.1818181818181817, 1.0206820682068207, 1.8571428571428572, 1.017623557696981, 1.0421052631578946, 1.1428571428571428, 1.0269238873410906, 1.12, 1.5555555555555556, 1.0376410076567888, 2.0, 1.0, 1.0783353733170136, 1.0042826552462527, 1.1559786239144956, 1.224890829694323, 1.2403846153846154, 1.0220449699335492, 1.0236525811429036, 1.0091743119266054, 1.008459255721936, 1.1294470918467263, 1.5, 1.0833333333333333, 1.0163320231572017, 1.0, 1.0474885844748858, 1.1111111111111112, 3.0, 1.0, 1.1966236345580934, 1.0601926163723916, 1.4017094017094016, 1.1618435155412647, 1.144578313253012, 2.5, 1.0783618782266655, 2.3333333333333335, 1.1228070175438596, 1.0027920236293368, 1.2517985611510791, 1.0674248578391552, 1.018674136321195, 2.25, 1.25, 1.1925287356321839, 1.3757575757575757, 1.069182389937107, 1.0121078816444096, 1.0377127464185136, 1.0176322418136021, 1.0, 1.0020276814993756, 1.0294117647058822, 1.088235294117647, 2.0, 1.187757909215956, 1.4285714285714286, 1.091549295774648, 1.2566371681415929, 1.0057012785329844, 1.0354896642987501, 1.124261811023622, 1.055148666375164, 1.0377939529675253, 1.0018639328984156, 1.0117493472584855, 1.094462046329849, 1.020679468242245, 1.1612903225806452, 1.0070841786676423, 1.0326363325869985, 1.0, 1.0336538461538463, 1.170731707317073, 1.0807692307692307, 3.0, 1.8518518518518519, 1.5274725274725274, 1.118811881188119, 1.7118644067796611, 1.0048309178743962, 1.0088626292466765, 1.472, 1.0939496514156337, 1.107359635811836, 1.0505577041645648, 1.065934065934066, 1.1637931034482758, 1.1108312342569269, 1.0, 1.0094595575857994, 1.4210526315789473, 1.0081234614656316, 1.0209381340568835, 1.0703068951773616, 1.0042723631508679, 1.8571428571428572, 1.0243499793644242, 1.0, 1.0016460905349793, 1.1818181818181819, 1.0402427870624429, 1.031363088057901, 1.1064972257025236, 1.2108843537414966, 1.1351963746223566, 4.0, 1.1741733181299887, 1.0068362581285553, 1.0126302858130027, 1.0, 1.2063492063492063, 1.0071827613727056, 1.3415233415233416, 1.1122484265855177, 1.060695088972724, 1.12, 1.2144388849177985, 1.0602505894503012, 1.0324143302180686, 1.0056974705735036, 1.057731343283582, 1.0752556237218813, 1.2777777777777777, 1.2197260273972603, 1.0077648308268794, 1.5873015873015872, 1.1827676240208878, 1.0, 1.5, 1.1179589131875414, 1.1494252873563218, 1.1611940298507464, 1.0389065706891936, 1.1407274895646988, 1.0, 1.0476190476190477, 1.3928571428571428, 1.0195619591652056, 1.0416666666666667, 1.0, 1.0528412035900374, 1.3333333333333333, 1.0, 1.1028636021100227, 2.3333333333333335, 1.1620220349967596, 1.0105740181268883, 1.3444444444444446, 1.2222222222222223, 1.0151540142674529, 1.0687606112054329, 1.2222222222222223, 1.0602176088044022, 1.0305343511450382, 1.0309734513274336, 1.168813559322034, 1.074779541446208, 1.08990000478446, 1.0, 1.1071428571428572, 1.104390549864102, 1.0294425347481693, 1.1153262518968134, 1.2, 1.0238587262821717, 1.023836063002711, 1.0181582360570687, 2.0, 1.1180371352785146, 1.0548509953276533, 1.0151139742319129, 1.1876045074518358, 1.0487687236046548, 1.05035363055452, 1.040112596762843, 1.0385712141677923, 1.5, 1.0667640488056367, 1.064053537284895, 1.048433734939759, 1.0252608456891819, 1.0804289544235925, 1.0352847754458205, 1.0655430711610487, 1.035039636696809, 1.2048357664233578, 1.0434493547125538, 1.0502183406113537, 1.0169366902461905, 1.1701488050503532, 1.0120481927710843, 1.2307692307692308, 1.0225613630175174, 1.0422832980972516, 1.0645432624908877, 1.012577173857078, 1.0, 1.156060606060606, 1.393063583815029, 1.0555555555555556, 1.255813953488372, 1.0135358026942871, 1.0924657534246576, 1.1484098939929328, 1.0, 1.6363636363636365, 1.0241305890702626, 1.0403727806465304, 1.0187642153146323, 1.0118452829706488, 1.0459558823529411, 1.048596112311015, 1.0815334773218142, 1.1027076893197598, 1.2302158273381294, 1.0300554511424178, 1.0577389616690926, 1.0495495495495495, 1.0078786511121358, 1.0841346153846154, 1.070039709708339, 1.0, 1.1133603238866396, 1.3033333333333332, 1.323017408123791, 1.0165289256198347, 1.0928355196770938, 1.0608552631578947, 1.0393518518518519, 1.0140729459234938, 1.0, 1.5806451612903225, 1.0, 1.0, 1.088235294117647, 1.0267379679144386, 1.3166089965397925, 1.1059907834101383, 1.0321629589922272, 1.36, 1.0371162843774964, 1.0382259854494635, 1.0148363104499907, 1.035465958474167, 1.0472020402917022, 1.1072008662696264, 1.0222222222222221, 1.0081301790081543, 1.0715695952615991, 1.0067114093959733, 1.1708860759493671, 1.0718562874251496, 1.0204982265115896, 1.2807692307692307, 1.0116429753384237, 1.1069767441860465, 1.2177816391543586, 1.0707070707070707, 2.5, 1.0211019929660023, 1.1875, 2.0, 1.1570996978851964, 1.0178920946077186, 1.0181117533718689, 1.053030303030303, 1.0578034682080926, 1.0277016742770166, 1.168107979787703, 1.0375234521575984, 1.4, 1.6666666666666667, 1.1090326028861572, 1.356164383561644, 1.0205314009661837, 1.0068347867075182, 1.0, 1.2702064896755163, 1.0934579439252337, 1.0244285963881257, 1.2090225563909776, 1.0057396587987848, 1.0385706356345819, 1.0142192909440824, 1.2375, 2.4, 1.144112110437147, 1.0, 1.1251596424010217, 1.1518987341772151, 1.1390205371248026, 1.0382165605095541, 1.375, 1.0328515111695138, 1.1590909090909092, 1.0912863070539418, 1.0046520800946657, 1.0246433203631646, 1.0132183908045977, 1.0626185958254268, 1.0044883303411132, 1.0058727569331158, 1.0, 1.11247989162645, 1.1162239770279971, 1.263157894736842, 1.0400543109300746, 1.0623068163331706, 1.309090909090909, 1.092707325235386, 1.0, 1.1189516129032258, 1.1068487212830516, 1.0364963503649636, 1.198581560283688, 1.0088582014146177, 1.3627450980392157, 1.8888888888888888, 1.0421152628245725, 1.0655619596541788, 1.004691698537043, 1.1393396754336877, 1.0130761027257094, 1.0006679908254712, 1.1931993817619784, 1.046299315291816, 1.2756183745583038, 1.0030336587226993, 1.0351784790481118, 1.0397196261682242, 1.3577981651376148, 1.0577352868140055, 1.0627737226277372, 1.169517293804637, 1.1904761904761905, 1.6, 1.0644753476611883, 1.0127690623859904, 1.042473454091193, 1.3636363636363635, 1.5555555555555556, 1.0165354330708662, 1.0917655268667132, 1.3739837398373984, 1.0216627757797547, 2.0, 1.0252525252525253, 1.5, 1.3446475195822454, 1.125, 1.1089318921431892, 1.3333333333333333, 1.1914893617021276, 1.1024305555555556, 2.0, 1.1196606383968732, 1.0587550901687028, 2.25, 1.25, 1.110344827586207, 1.0864197530864197, 1.0614894659480647, 1.0125, 1.0053191489361701, 1.0338289962825278, 1.15625, 1.0698371893744645, 1.6054054054054054, 1.4950980392156863, 1.4827586206896552, 2.5, 1.1272114574557708, 1.2668269230769231, 1.0454545454545454, 1.1042915596155676, 1.0202853653450894, 1.1772845317318616, 1.0223231948565776, 1.0582515530746377, 1.0773930753564154, 1.0154613466334164, 1.5, 2.0, 1.0810810810810811, 1.0652541175045265, 1.1277823577906019, 1.010958904109589, 1.14519906323185, 1.0868179500254973, 1.019709296388331, 1.004211466105478, 1.032258064516129, 1.173913043478261, 1.1544554455445544, 1.1032533392451367, 1.020612239576543, 1.1014571025482762, 1.23463687150838, 1.077542242703533, 1.0372019025023005, 1.0380325966954211, 1.0066273932253313, 1.0223766482262804, 1.2567049808429118, 1.0580286168521462, 1.0344086021505376, 1.0060707526138783, 1.3333333333333333, 1.0329617062530296, 1.0, 1.0718685831622177, 1.0298744106479742, 1.1290322580645162, 1.026022051662728, 1.1638618246235606, 1.0943396226415094, 1.0120142271083, 1.0158174904942965, 1.1260501848325306, 1.012924071082391, 1.0148221343873518, 1.007776342065077, 1.1573426573426573, 1.1176470588235294, 1.0, 1.0, 1.019342711617754, 1.8571428571428572, 1.0306137740575025, 1.0821434193069641, 1.1004549590536852, 1.0661582121319617, 1.0710311103616896, 1.1457425037814752, 1.0961538461538463, 1.0046565774155995, 1.0076660754626856, 1.0199956271988233, 1.006342536934893, 1.014447700343993, 1.3333333333333333, 1.2169934640522875, 1.3559322033898304, 1.0316500022351696, 1.1159029649595686, 1.002670464660851, 1.1943620178041543, 1.0358306188925082, 1.0411402430524754, 1.0368239355581128, 1.0098439136288835, 1.1904761904761905, 1.000573737532242, 1.0098731871558873, 1.105072463768116, 1.007074637424832, 1.1578947368421053, 1.1736111111111112, 1.0416900617630545, 1.1180855642592753, 1.4171779141104295, 1.0061593042449926, 1.4193548387096775, 1.1206773759594841, 1.2253609541745134, 1.1327319587628866, 1.1277683134582623, 1.0434782608695652, 1.1440598690364827, 1.1063327032136105, 1.027026074286453, 1.0453667953667953, 1.0113930281842909, 1.059657468389205, 1.0, 1.0325484764542936, 1.041295407813571, 1.1888888888888889, 1.184257602862254, 1.1542887029288702, 1.3363821138211383, 1.1451612903225807, 1.0162094763092269, 1.0070999026271108, 1.064516129032258, 1.039504716981132, 1.0163858452778973, 1.017934446505875, 1.4754601226993864, 1.0012455865963643, 1.054496578690127, 1.0755968169761274, 1.1198347107438016, 1.0035191580332181, 1.1074106072851928, 1.0404984423676011, 1.2916666666666667, 1.0122950819672132, 1.029080896277113, 1.0404040404040404, 2.25, 1.0238476989216998, 1.000219371673344, 1.0217076700434153, 1.2754491017964071, 1.0021270130659374, 1.0039333132516162, 1.000708048147274, 1.0078534031413613, 1.21875, 1.1163575042158516, 1.3333333333333333, 1.0631313131313131, 1.78125, 1.073083413356206, 1.0217209690893903, 1.066759388038943, 1.1794871794871795, 1.0321888412017168, 1.0099952403617325, 1.041237113402062, 1.075, 1.0216450216450217, 1.1203703703703705, 1.147074327886136, 1.3, 1.0517364230614332, 1.1703932151117964, 1.1801259238981658, 1.040983606557377, 1.0, 1.0556195965417867, 1.0541245664304026, 1.0104124896409763, 1.1971326164874552, 1.5875, 1.0, 1.1142857142857143, 1.3, 1.537037037037037, 1.1083115183246073, 1.011672341503222, 1.0083102320316568, 1.0460526315789473, 1.0206440722428474, 1.0027043494954384, 6.0, 1.0110159258162266, 1.0320022392237358, 1.0, 1.5714285714285714, 1.0409023301933564, 1.1031883711192199, 1.0059259700425836, 1.0595854922279793, 1.5, 1.158273381294964, 1.3139240506329113, 2.25, 1.0019154314732117, 1.015695437053326, 1.012763163427359, 1.130281690140845, 1.5555555555555556, 1.0043890984210322, 1.057618437900128, 1.12776176753122, 1.0101522842639594, 1.1005847953216374, 1.0, 1.1635627530364372, 1.0863316434512968, 1.0796022499695244, 1.0342555994729907, 1.0905923344947734, 1.002708596350281, 1.1763046544428772, 1.1107266435986158, 1.3636363636363635, 1.0597455603317267, 1.250158972402391, 1.0650554528650646, 1.8785046728971964, 1.1553398058252426, 1.1267387944358578, 1.1111111111111112, 1.0213996529786002, 1.0812182741116751, 1.0112496570986809, 1.0106951871657754, 2.0, 1.1267857142857143, 1.0229256324659133, 1.1597222222222223, 1.373443312307941, 1.009815680610971, 1.0041835169432436, 1.0950678560272118, 1.0387755102040817, 1.0338983050847457, 1.0253164556962024, 1.0022013790740503, 1.1136811023622046, 1.0523076923076924, 4.0, 1.1046511627906976, 1.1078978676672462, 1.1829787234042553, 1.006299825004861, 1.0100107399992044, 1.0875955320399764, 1.6666666666666667, 1.0098039215686274, 1.0257016609981062, 1.0220448498669708, 1.0915254237288134, 1.0224975173783515, 1.1253731343283582, 1.4602739726027398, 1.0855231724796943, 1.0017300199361316, 1.0161917098445596, 1.1060311284046693, 1.09447983014862, 1.0256410256410255, 1.0201477020147702, 1.0992011407645066, 1.0335678367662702, 1.0753516409912927, 1.0456532297231667, 1.047872340425532, 1.023076923076923, 1.0671256454388984, 2.5, 1.5, 1.25, 1.0344086021505376, 1.127284595300261, 1.0717688547918085, 1.0563729641632509, 1.153516681695221, 1.0272312016865777, 1.0506912442396312, 1.0284742881427964, 1.0089567935497064, 1.5, 1.0588235294117647, 1.075880758807588, 1.125, 1.0960384153661464, 1.1440431714404318, 1.046480743691899, 1.0195766299745979, 1.2, 1.109815078236131, 1.0893939393939394, 1.0345399439583691, 1.0003097893432467, 1.0558035714285714, 1.0442793462109956, 1.0312515717998156, 1.1116862432809078, 1.1347150259067358, 1.4727272727272727, 1.2097334878331403, 1.0, 5.0, 1.001278657968313, 1.25, 1.4444444444444444, 1.3409090909090908, 1.1024096385542168, 1.00548128972756, 1.140625, 1.0271317829457365, 1.0, 1.0659805441985055, 1.0129740518962076, 1.1091954022988506, 1.0059642147117296]
origin-bjaq_15.87 	max: 6.0000	99th: 2.6700	95th: 1.6744	median: 1.0645	mean: 1.1716

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 16.588286 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=37.290522