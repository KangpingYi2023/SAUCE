Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='naru', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 7, 'naru': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.5525	median: 1.0556	mean: 1.1470
ReportEsts: [1.0430463576158941, 1.0625345877144439, 1.0421547785969514, 1.0176125244618395, 1.0344827586206897, 1.0, 1.2129900891354486, 1.0149404786217726, 1.25, 1.03315649867374, 1.0070123798805297, 1.0026485530490872, 1.0063398140321218, 1.0238095238095237, 1.030024726245143, 1.0, 1.5517241379310345, 1.0237336167198017, 3.0, 2.6666666666666665, 1.08, 1.0980806555962908, 1.054227434471007, 1.0584213797389683, 1.0, 1.0, 1.0146667511403953, 1.2, 1.4, 1.2158273381294964, 1.0, 1.003036407200865, 1.0004554014302067, 1.325749167591565, 1.0142458510794536, 1.0180759596506668, 1.0588235294117647, 1.0059895744275462, 1.1318961360975275, 1.0833333333333333, 1.0818307905686546, 1.100609756097561, 1.0, 1.1381966901274492, 1.081906524757057, 1.2148760330578512, 1.116504854368932, 1.298165137614679, 1.0277077875137368, 1.0485436893203883, 1.0544795355447953, 1.1001890359168243, 1.0043727455186255, 2.0, 1.1922077922077923, 1.0775635407537247, 1.1187957689178194, 1.0727969348659003, 1.1614906832298137, 1.25, 1.0006137898110892, 1.0236612702366128, 1.0185185185185186, 1.1264367816091954, 1.1818181818181819, 1.0421584576511715, 1.0298130368873168, 1.1666666666666667, 1.0, 1.152944969905417, 1.0477326968973748, 1.0584490740740742, 1.1081081081081081, 1.1699970026975721, 1.1976470588235295, 1.0997963340122199, 1.0, 1.048140043763676, 2.0, 1.0404028810008896, 1.09375, 1.019111735052007, 1.116564417177914, 1.0458715596330275, 1.0857751731486414, 1.08, 1.0078111825781118, 1.0546099902636217, 1.107843137254902, 2.3333333333333335, 1.059990552668871, 1.0054170732428516, 1.0467289719626167, 1.2608695652173914, 1.2644341801385681, 1.1063218390804597, 1.1946902654867257, 1.006872852233677, 1.0, 1.0058337820858014, 1.1467242620590352, 1.0552036199095023, 1.0035412018839194, 1.0588235294117647, 1.0023441943481664, 1.1366928183464091, 1.0442474243730246, 1.0462646947288585, 1.029346797096876, 1.1666666666666667, 1.3333333333333333, 1.164625850340136, 1.0084154002339616, 1.0602813127930342, 1.103896103896104, 1.0047384640963368, 1.0, 1.2357755261106782, 1.1818181818181819, 1.0, 1.2307692307692308, 1.0, 1.0576441102756893, 1.0209934667341098, 1.1291449871864565, 1.037037037037037, 1.8, 1.3137417218543046, 1.0, 1.3214285714285714, 1.009457014037276, 1.1818181818181819, 1.02099609375, 1.0047981812129851, 1.0082122552116235, 1.117910447761194, 1.0766961651917404, 1.0007794232268121, 1.00199203187251, 1.0472239948947033, 1.0327748861418347, 1.117283950617284, 1.0326157860404437, 1.0187961068749614, 2.0, 1.016211208893006, 1.0441527446300716, 1.0452853598014888, 1.0123522145756132, 1.0, 1.0161055945749575, 1.0562962962962963, 1.022, 1.4476190476190476, 1.183941605839416, 1.0269723533378288, 1.0368275066597095, 1.074984218595004, 1.1596958174904943, 1.0789473684210527, 1.0, 1.0942028985507246, 1.1297836938435941, 1.1428571428571428, 1.0095876973705027, 1.0035074609794965, 1.0132412204951065, 1.0109723525590124, 1.0329871716554673, 1.0484482255969891, 1.0126315789473683, 1.1029411764705883, 1.1521254962719085, 1.0133196721311475, 1.130731707317073, 1.0372983870967742, 1.0529336734693877, 1.0607380619709048, 1.0831644038635164, 1.0, 1.3548387096774193, 1.0346035917652212, 1.0474002923366048, 1.1032186459489457, 1.2459016393442623, 1.0310552684256358, 1.0112730806608357, 1.0050862498106183, 1.0545454545454545, 1.0695454545454546, 1.0660627257611375, 1.0, 1.4545454545454546, 1.0897058176861176, 1.3995459704880817, 1.090497737556561, 1.25, 1.0141479099678457, 1.001926861476644, 1.0084632936018756, 1.1798245614035088, 1.0761041425108042, 1.462809917355372, 1.0, 1.0120481927710843, 1.0, 1.019108280254777, 1.0468380381643274, 1.588850174216028, 1.0, 1.0168067226890756, 1.0957683741648108, 1.0683444678319758, 1.0167846765776185, 1.0025979086835097, 1.2137931034482758, 1.3081285444234405, 1.0696707105719236, 1.015412881494335, 1.0760881631042096, 1.0, 1.0815734989648034, 1.0611742461544522, 1.0079780564748568, 1.0807381776239908, 1.065382159415864, 1.0080358653358146, 1.0344827586206897, 1.0037722246904681, 1.0166470048499148, 1.1827411167512691, 1.0786516853932584, 1.0373366521468574, 1.0257936507936507, 1.0866141732283465, 1.0, 1.007797731568998, 1.1293546225993747, 1.0486725663716814, 1.4477611940298507, 1.0909090909090908, 2.6666666666666665, 1.1246372733508028, 1.1454545454545455, 1.10069910317068, 2.0, 1.0, 1.3333333333333333, 1.0401948842874542, 1.683673469387755, 1.1022099447513811, 1.1689272503082615, 1.0910683012259195, 1.008894536213469, 1.049103425867636, 1.0175438596491229, 1.0, 1.00901480336525, 1.0852888705914643, 1.0980735551663747, 1.0698917516550366, 1.0913293036013614, 1.0017415305753623, 1.0858505564387917, 1.0151752548280901, 1.0645933014354068, 1.0842374924653406, 1.3219155844155843, 1.5454545454545454, 1.0882783970786085, 1.0277185501066097, 1.2272727272727273, 1.1363636363636365, 1.1738181818181819, 1.0, 1.1470588235294117, 1.0583675391965548, 1.0891364902506964, 1.209090909090909, 1.0265093792765496, 1.0093141405588484, 1.0121045382825662, 1.0119913619746483, 1.5, 1.0924881775190978, 1.2, 1.0117307121300083, 1.0021598272138228, 1.0002412852765903, 1.325, 1.6666666666666667, 1.0, 1.4366197183098592, 1.0093902184713142, 1.0, 1.0428134556574924, 1.011441647597254, 1.0368589743589745, 1.0031814103087018, 1.1524390243902438, 1.0817610062893082, 1.0156667486991984, 1.0710122786170995, 1.0731267702343146, 1.1623931623931625, 1.0, 1.2673031026252983, 1.0073891625615763, 1.205607476635514, 1.0568239258635215, 1.0309544282029235, 1.1690140845070423, 1.0925925925925926, 1.01920438957476, 1.0394207562349156, 1.4285714285714286, 1.0265251885262956, 1.0604395604395604, 1.1875, 1.0571168226326675, 1.0476190476190477, 1.75, 1.0210735740919763, 2.0, 1.0068587105624143, 1.0319767441860466, 1.0188679245283019, 1.0648409182440597, 1.0443864229765014, 1.1538461538461537, 1.0081169929246878, 1.0247559699130986, 1.0041039671682626, 1.003009306711492, 1.1754988550866863, 2.0, 1.2222222222222223, 1.0052030092459656, 1.3333333333333333, 1.048687089715536, 1.0, 1.0, 1.0454545454545454, 1.1279728199320498, 1.0842911877394636, 1.29, 1.0162337662337662, 1.0, 1.0792276964047935, 1.0198056496039498, 1.5, 1.2179868969624776, 1.0, 1.0183101799134593, 1.0112359550561798, 1.076882707950669, 1.1589861751152073, 1.0018181818181817, 1.0093696763202726, 1.0740740740740742, 1.0349910603979466, 1.00887172428022, 1.0652463382157125, 1.0, 1.1428571428571428, 1.8333333333333333, 1.5, 1.1428571428571428, 1.0022306218742367, 1.25, 1.0499168053244592, 1.1485148514851484, 1.029747877866464, 1.0283554369719323, 1.0231822971548998, 1.0355995843763284, 1.0391802290536467, 1.2298682284040996, 1.5, 1.0, 1.030701754385965, 1.0129148751194912, 1.2380952380952381, 3.142857142857143, 1.0579064587973275, 1.0395348837209302, 1.0097165686200482, 1.1808972503617945, 1.342769701606733, 1.039237986920671, 1.4035087719298245, 1.0808477237048666, 1.0519067796610169, 1.2115384615384615, 1.055306427503737, 1.1714285714285715, 1.040203412884877, 1.0020306452757475, 1.042437895762299, 1.2647058823529411, 1.162162162162162, 1.075075075075075, 1.0, 1.026256969209905, 1.0188368006639241, 1.034900236726412, 1.0070304132686336, 1.0145343277873398, 1.0207590009730783, 1.8333333333333333, 1.026745913818722, 1.2, 1.0563620836891545, 1.1111111111111112, 1.013105099485373, 1.0347826086956522, 1.1430567497850388, 1.2490118577075098, 1.087260034904014, 3.0, 1.2496339677891655, 1.0044535559908248, 1.0629713077064558, 1.0, 1.05, 1.023992322456814, 1.3189655172413792, 1.081678773204197, 1.134433962264151, 1.105263157894737, 1.0552200172562554, 1.0959870988851754, 1.0929789854801986, 1.0098304100257862, 1.1458333333333333, 1.4378109452736318, 1.0454545454545454, 1.0, 1.0154639175257731, 1.3, 1.0416098226466575, 1.1785714285714286, 1.1057879092845273, 1.1363636363636365, 1.1147611977233358, 1.040873640526617, 1.124133148404993, 1.0, 1.0555555555555556, 1.32, 1.0048091961213639, 1.4332603938730852, 1.0, 1.0852445426913513, 1.0067703806195638, 1.298708288482239, 1.0, 2.0, 1.218252427184466, 1.0008960573476702, 1.425233644859813, 1.0, 1.0122039712382083, 1.0675403225806452, 1.0869565217391304, 1.1405273069679849, 1.0272727272727273, 1.031496062992126, 1.1911290322580645, 1.0127822752449935, 1.1284082429252051, 1.0, 1.054054054054054, 1.1022316261574074, 1.0249431703960288, 1.0887755642215595, 1.0, 1.0563084112149532, 1.0098576231622645, 1.0277632268203247, 2.0, 1.1120414673046253, 1.036356574549221, 1.1175560965980127, 1.1642566947708706, 1.034724940497883, 1.1823529411764706, 1.0722689075630252, 1.0072850898494414, 2.0, 1.022636828776681, 1.1384615384615384, 1.25, 1.3129251700680271, 1.1304347826086956, 1.038646673823458, 1.02615518744551, 1.042892367681633, 1.3661442006269593, 1.00828647864333, 1.0017584201271472, 1.0166614653767467, 1.0679611650485437, 4.0, 1.019445444724523, 1.0180161943319839, 1.0086884496743973, 1.0189044801028189, 1.0898534697262925, 1.2497998398718975, 1.1058201058201058, 1.4285714285714286, 1.0214236866645943, 1.0398790420687978, 1.0118295072270895, 1.129677658391997, 1.0583133513596246, 1.0020661157024793, 1.0013205806670875, 1.0161812297734627, 1.0842541436464088, 2.0, 1.0, 1.0659509202453987, 1.0620300751879699, 1.0205479452054795, 1.004756242568371, 1.103896103896104, 1.3006535947712419, 1.0554699537750385, 1.0714285714285714, 1.0004563262398718, 1.4125, 1.0034921272617705, 1.0, 1.0, 1.5674603174603174, 1.0763358778625953, 1.0011185682326622, 1.1525851197982346, 1.0217391304347827, 1.0211920529801324, 1.0364622910334347, 1.0, 1.7659574468085106, 1.5, 1.0, 1.035294117647059, 1.0080645161290323, 1.319755600814664, 1.1135135135135135, 1.0289971163088754, 1.1238591916558018, 1.0205037668898251, 1.0165154801814238, 1.1070840197693574, 1.011536932727079, 1.0571428571428572, 1.1334674714956405, 1.1223996129656506, 1.0372463395838685, 1.0260115606936415, 1.0092567383610127, 1.0244522894818815, 1.0069251221171087, 1.012522572497551, 2.0, 1.0294840294840295, 1.0277264325323474, 1.034013605442177, 1.0, 1.1333333333333333, 1.1538461538461537, 1.0424778761061948, 1.6666666666666667, 1.5, 1.0354327753171684, 1.0441087613293052, 1.0020111746294524, 1.0457810403346752, 1.0972972972972972, 1.0534629404617255, 2.0, 1.1846153846153846, 1.1256987577639752, 1.0078168919823316, 1.007513093441578, 1.055188518054448, 1.0229572680135883, 1.0784313725490196, 1.040855088474136, 1.1598579040852575, 1.0200798259972643, 1.0349498296278168, 1.3333333333333333, 1.1368778280542986, 1.0, 1.0136054421768708, 1.0202824623499203, 3.0, 1.165137614678899, 1.0205553472574491, 1.2857142857142858, 1.188254430271381, 1.4, 1.1875, 1.0345396600566572, 1.7692307692307692, 1.0035229566247297, 1.0099223468507335, 1.1875, 1.2608695652173914, 1.2696335078534031, 1.0191296030607364, 1.0801144492131616, 1.0712879594668732, 1.0106678045658204, 1.0, 1.2082880729958723, 1.0061349693251533, 2.0, 1.0861913877805198, 1.0304957176226317, 1.1012298959318827, 1.0129648143967491, 1.0422894780510843, 1.313953488372093, 2.142857142857143, 1.0661848611639406, 1.0607356715141145, 1.0444742334515467, 1.057371581054036, 1.019428387000098, 1.0486034009232748, 1.0705882352941176, 1.0402476780185759, 1.1156716417910448, 1.0020139306139706, 1.1009463722397477, 1.006340579710145, 1.112920168067227, 1.0535330779547507, 4.0, 1.0048762583892616, 1.016550531306846, 1.0229396497525485, 1.0555555555555556, 1.0840855436744896, 1.3969072164948453, 1.0, 1.0599626168224299, 1.0134426229508198, 1.0878859857482186, 1.1176470588235294, 1.6666666666666667, 1.0013734104994159, 1.5, 1.5123674911660778, 1.1538461538461537, 1.087851510711046, 1.3333333333333333, 1.161764705882353, 1.10167714884696, 1.0, 1.380952380952381, 1.089031339031339, 2.0, 1.0, 1.064, 1.0507246376811594, 1.0704518430439953, 1.0313852813852813, 1.0389610389610389, 1.0324483775811208, 1.089150378938971, 1.0493506493506493, 1.6442953020134228, 1.3387978142076502, 1.3076923076923077, 1.0, 1.1425287356321838, 1.189033189033189, 1.001034126163392, 1.2650065530799475, 1.009949251743182, 1.180894705997265, 1.0214181958319746, 1.0555555555555556, 1.0782190132370637, 1.0184964200477327, 1.2222222222222223, 1.0, 1.0303030303030303, 1.0560863014137787, 1.150253807106599, 1.0065359477124183, 1.1941176470588235, 1.058266513936617, 1.053707358330984, 1.0062647282083488, 1.0512820512820513, 1.1578947368421053, 1.0510732790525537, 1.1428287380699893, 1.044021035469382, 1.0988514254748278, 1.236842105263158, 1.1024069698759598, 1.0013762302664504, 1.0469168900804289, 1.031512605042017, 1.1111111111111112, 1.0433349034385304, 1.0584028605482718, 1.0, 1.2832167832167831, 1.0347890451517394, 1.0, 1.0305882352941176, 1.034203616049775, 1.037037037037037, 1.014594708105838, 1.1567796610169492, 1.0930232558139534, 1.0586389464374417, 1.0208363374188898, 1.0718506580714477, 1.0106075216972035, 1.0849753694581281, 1.0067628494138863, 1.1451942740286298, 1.2142857142857142, 1.0, 1.1111111111111112, 1.0114327237495457, 1.8333333333333333, 1.0078401160155896, 1.078886435840827, 1.1484271156402304, 1.050490298351763, 1.0028923111937185, 1.1932475884244373, 1.08984375, 1.001386962552011, 1.0190903327306455, 1.026065211118592, 1.0053351868274094, 1.0151607776011737, 1.25, 1.0158730158730158, 1.3043478260869565, 1.0344592656339644, 1.0488599348534202, 1.0117320819112627, 1.1362831858407079, 1.0097465886939572, 1.0733411216785191, 1.0081190798376185, 1.0066985645933015, 1.3125, 1.0097310145200387, 1.0036343095434892, 1.17835578262889, 1.0008428150021071, 1.032258064516129, 1.0174291938997821, 1.109452736318408, 1.625, 1.0304220846950838, 1.3846153846153846, 1.0541976620616365, 1.0307692307692307, 1.1867835468644639, 1.0203738003030813, 1.071764705882353, 1.1, 1.0769230769230769, 1.0174087282620685, 1.0027223734651924, 1.0058049244796232, 1.0770407087112424, 1.0511674289054709, 1.1818181818181819, 1.0497100248550124, 1.0704726056043496, 1.0758069556676637, 1.0162932790224033, 1.2013888888888888, 1.0118613138686132, 1.0128501670521717, 1.18809318377912, 1.0041699380615894, 1.0, 1.3333333333333333, 1.018551756532918, 1.0077992058990357, 1.023830121903264, 1.0613750368840367, 1.0766161213088588, 1.079136690647482, 1.0009076648348938, 1.1090592800749364, 1.0165441176470589, 1.335135135135135, 1.031512605042017, 1.0303956216561134, 1.0119047619047619, 1.75, 1.0156888277484326, 1.0072377871058613, 1.0102622576966933, 1.2753623188405796, 1.0101375814627083, 1.0003754823905713, 1.03071573456969, 1.1142061281337048, 1.2692307692307692, 1.105121293800539, 1.0021052631578948, 1.1125, 1.3870967741935485, 1.0826461057101353, 1.0148662041625371, 1.0835579514824798, 1.1388888888888888, 1.0317584511987161, 1.019584802193498, 1.0166031573217202, 1.024761518165212, 1.3333333333333333, 1.0357142857142858, 1.3333333333333333, 1.0379609544468547, 1.5384615384615385, 1.3333333333333333, 1.3636363636363635, 1.1778471138845554, 1.047438330170778, 1.0600021898609437, 1.0205265724037056, 1.3959390862944163, 1.5294117647058822, 1.0, 1.1290322580645162, 1.337837837837838, 1.5217391304347827, 1.0233644859813085, 1.0223891181456541, 1.004933125020974, 1.0390625, 1.0036377863040777, 1.00067063710525, 5.0, 1.006643190092205, 1.0671428571428572, 1.0, 1.3333333333333333, 1.0931952662721893, 1.1093021587893566, 1.0809841961723057, 1.0062111801242235, 1.0, 1.1415929203539823, 1.034920634920635, 2.0, 1.5, 1.009438648782911, 1.0244656539857508, 1.1224403927068725, 1.25, 1.0372287122324872, 1.0720371804802478, 1.1403508771929824, 1.1428571428571428, 1.0812182741116751, 1.0035798078668379, 1.0555555555555556, 1.0844863114512806, 1.1154836336888563, 1.051764705882353, 1.0158730158730158, 1.0324232081911262, 1.1912894961571308, 1.1487603305785123, 1.2777777777777777, 1.009146745248659, 1.1158268101761253, 1.023126447480691, 1.7578947368421052, 1.275, 1.1343283582089552, 1.020356234096692, 1.0350930729325603, 1.0224936978863681, 1.0375167656639204, 1.0425764192139737, 3.0, 1.25, 1.0810642709053213, 1.0919085312225154, 1.3863061661155418, 1.0134767872135328, 1.0319451413279812, 1.1023094010645877, 1.1383219954648527, 1.1041666666666667, 1.0243691533684458, 1.0296788642107209, 1.0312315851502651, 1.0875656742556918, 2.5, 1.12, 1.0560915660882644, 1.063321385902031, 1.0009515638405742, 1.0037408938767474, 1.1321022727272727, 1.6, 1.0288461538461537, 1.0319676795265733, 1.0431802604523646, 1.0304182509505704, 1.0221117627425738, 1.193916349809886, 1.2496551724137932, 1.0944927536231883, 1.0039530155861758, 1.0602936582318025, 1.119815668202765, 1.1267605633802817, 1.03125, 1.0596377306903624, 1.0082956954558024, 1.0898282694848085, 1.045182064193471, 1.0441603718768158, 1.0450592885375494, 1.3846153846153846, 1.0382165605095541, 2.5, 1.5, 1.4166666666666667, 1.030690537084399, 1.1421800947867298, 1.0375431690742323, 1.0545995805236688, 1.0401628222523744, 1.0008375209380234, 1.048913043478261, 1.510204081632653, 1.0090673575129534, 1.6, 1.25, 1.0455284552845527, 1.0, 1.0836940836940836, 1.0969141755062681, 1.0040558810274898, 1.0217250166366396, 1.25, 1.1568767908309456, 1.308139534883721, 1.11072319201995, 1.000362526673244, 1.0731707317073171, 1.0477215644061715, 1.0270394592108159, 1.0076401592596578, 1.1319554848966613, 1.42, 1.2276536312849162, 1.0, 1.0, 1.0006661063624334, 1.6666666666666667, 1.5714285714285714, 1.4210526315789473, 1.0386007237635706, 1.1058823529411765, 1.0518950437317784, 1.1058568329718004, 1.0, 1.185599006828057, 1.026378896882494, 1.1748878923766817, 1.0374064837905237, 1.1111111111111112, 1.0511152416356877, 1.084811529933481, 1.0819327731092436, 1.0152473038304202, 1.0092977734279422, 1.1271717171717173, 1.0706143128562382, 1.0, 1.069112126283414, 1.0020626476608419, 1.045417862266858, 1.2695652173913043, 1.0203491222908698]
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.5525	median: 1.0556	mean: 1.1470

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 19.920680 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=naru', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[5.9604645e-08 8.3446503e-07 3.5762787e-07 5.3644180e-07 5.9604645e-08]
Distance score: 3.695487862387381e-07
SAUCE Drift detection: False
Detection latency: 0.0234s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 2.041043 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.6683	median: 1.0690	mean: 1.1633
ReportEsts: [1.02710027100271, 1.0580142169227242, 1.0217898593110242, 1.0207006369426752, 1.1714285714285715, 2.0, 1.192059048103843, 1.0056496963335082, 1.0, 1.0328947368421053, 1.034283929558177, 1.0028023039560876, 1.0390368478657424, 1.0385395537525355, 1.0215593620791494, 2.2142857142857144, 1.108974358974359, 1.3076923076923077, 1.4444444444444444, 1.0705574912891986, 1.1384599547045502, 1.1576576576576576, 1.0588235294117647, 1.0974930362116992, 1.0354579385587137, 1.001067789199915, 2.0, 1.0804309908287852, 1.1666666666666667, 1.3333333333333333, 1.1764705882352942, 1.0, 1.0045932798624835, 1.0113428720069912, 1.1987867475501632, 1.037328593194515, 1.0191487558957268, 1.0754716981132075, 1.5714285714285714, 1.053392801897494, 1.2048861743475847, 1.0749445342759372, 1.0202702702702702, 1.0393546810070888, 1.0346715328467153, 1.0999337263246014, 1.2380952380952381, 1.0316593886462881, 1.3297297297297297, 1.16548463356974, 1.207112970711297, 1.0142857142857142, 1.1345291479820627, 1.03125, 1.038167303184971, 1.0401425470036456, 1.060404666962044, 1.1435185185185186, 1.072289156626506, 1.005932710231415, 1.1014492753623188, 1.0313387875261013, 1.0979827089337175, 1.0449438202247192, 1.1428571428571428, 2.0, 1.1135813148788927, 1.071892594196622, 1.4285714285714286, 1.0, 1.1013722126929675, 1.0258964143426295, 1.0626204238921002, 1.12890625, 1.1460270843530755, 1.060747663551402, 1.0665490151428896, 1.1777777777777778, 1.0354609929078014, 1.0075365786325572, 1.2483621203097082, 1.1448763250883391, 1.0, 1.0, 1.0125570776255708, 1.03125, 1.1905940594059405, 1.0379746835443038, 1.0, 1.0068817273296011, 1.0731189815570426, 1.0500642417261088, 1.1028671605496805, 1.2002017711018944, 1.0666666666666667, 1.325986078886311, 1.264808362369338, 1.2754182754182755, 3.0, 1.1250493096646943, 1.7307692307692308, 4.0, 1.0438269020020137, 1.1782006920415224, 1.013728323699422, 1.0075827137821747, 1.2105263157894737, 1.0027147449658105, 1.104594330400782, 1.0009247208712926, 1.013977128335451, 1.0223449001051526, 1.0, 1.0, 1.1136860515959772, 1.006230636390516, 1.0845629965947787, 1.011111111111111, 1.0079099904466322, 2.0, 1.2080706179066836, 1.1103230890464932, 1.0, 1.1473214285714286, 1.0, 1.0425531914893618, 1.0120739118000006, 1.0838180173193743, 1.0238095238095237, 2.0, 1.2694938440492476, 1.0, 1.3846153846153846, 1.018040755281361, 1.0769230769230769, 1.0876466528640443, 1.022841547381772, 1.0516016067566176, 1.25, 1.2666666666666666, 1.100418410041841, 1.026857654431513, 1.047644539614561, 1.0761964138080589, 1.0989583333333333, 1.0404371584699454, 1.0187117072362974, 1.0, 1.0111324376199615, 1.042957042957043, 1.0598159509202454, 1.0374300029472443, 1.0, 1.014565596471433, 1.0846824408468243, 1.0201680672268907, 1.0092165898617511, 1.0, 1.1208291203235592, 1.0243606998654105, 1.0944603341863617, 1.113564668769716, 1.1836158192090396, 1.0178571428571428, 1.1490683229813665, 1.1082191780821917, 1.375, 1.004908488029033, 1.0465116279069768, 1.133492252681764, 1.0011073098980283, 1.1138098542678696, 1.0220975547085778, 1.0771992818671454, 1.1114982578397212, 1.2004834810636584, 1.0121739130434784, 1.1524193548387096, 1.046351931330472, 1.0333508403361344, 1.0287412078583555, 1.0013391433733658, 1.0254777070063694, 1.8571428571428572, 1.0019581067006134, 1.0522558537978297, 1.0666666666666667, 1.0527802338147165, 1.2124645892351276, 1.5, 1.0982367758186398, 1.0278637107318154, 1.2333333333333334, 1.0207684319833852, 1.0210221094599492, 1.0086228434883437, 1.0046138415245738, 1.0069513406156902, 1.0588272690669436, 1.0312092416620087, 1.0754716981132075, 1.1412474210442787, 1.10106521174331, 1.0186002989741307, 1.1843342036553526, 1.0320613347273044, 1.0101522842639594, 1.1794871794871795, 1.0294117647058822, 1.0, 1.100558659217877, 1.0453422966113322, 1.6101694915254237, 1.2828282828282829, 1.030025020850709, 1.263157894736842, 1.0000413240216537, 1.0436681222707425, 1.0595861486486486, 1.3333333333333333, 1.045398773006135, 1.0422814982973894, 1.0233858728774063, 1.0712125237579448, 1.0, 1.1595059076262084, 1.021952581111257, 1.0020909632370645, 1.0054347826086956, 1.2166666666666666, 1.0628825820812464, 1.0779946119981603, 1.0086206896551724, 1.0022354225996568, 1.0134328358208955, 1.1157894736842104, 1.211304347826087, 1.017103762827822, 1.5, 1.1410842586544743, 1.0, 1.0086427028088785, 1.0898337447026498, 1.0509865208048448, 1.5075528700906344, 1.1538461538461537, 2.5, 1.048747639472413, 1.0136986301369864, 1.1045141861769656, 2.0, 1.0125335720680393, 1.0830670926517572, 1.125, 1.0099690832229162, 1.1252900232018561, 1.079731027857829, 1.1408450704225352, 1.0149094781682642, 1.02817835239516, 1.1176470588235294, 1.0, 1.026226080233355, 1.1962547245447257, 1.1187410586552218, 1.0637280344034996, 1.0669995134231738, 1.0495320932368815, 1.0963302752293578, 1.0224722397430068, 1.0507317073170732, 1.1214470284237725, 1.107742960944596, 1.9166666666666667, 1.0992019042285075, 1.10801393728223, 1.2941176470588236, 1.0714285714285714, 1.0044642857142858, 1.0622448979591836, 1.010729705834385, 1.0398258059984546, 1.1799065420560748, 1.2430379746835443, 1.0158981885521223, 1.0386297376093294, 1.064119170984456, 1.007507925769695, 1.3846153846153846, 1.0994082840236687, 1.0102657004830917, 1.0668210683601045, 1.001286143780498, 1.02771920544949, 1.1204496788008564, 1.024103139013453, 1.0364709227925495, 1.0039679848063487, 1.0015887917960569, 1.0418067514008473, 1.0551330798479088, 1.150943396226415, 1.1428571428571428, 1.0821497740477728, 1.6666666666666667, 1.0106951871657754, 1.0498689870668516, 1.0615263261684087, 1.0769230769230769, 1.2265625, 1.0130164119977363, 1.158146691742178, 1.017403935119934, 1.1304347826086956, 1.0452856479331165, 1.0102384560911202, 1.018348623853211, 1.0714285714285714, 2.3333333333333335, 1.049449314452686, 1.5, 1.0203887188925707, 1.0562310030395137, 1.3888888888888888, 1.0344257845231493, 1.0357142857142858, 1.7, 1.0250737516384238, 3.0, 1.1296043656207366, 1.0770171149144254, 1.099382080329557, 1.1993006993006994, 1.3522012578616351, 1.1775700934579438, 1.0297455218156386, 1.0135929811279945, 1.3783783783783783, 1.029380006014051, 1.0980218108039563, 3.0, 1.0909090909090908, 1.0029621702196783, 1.25, 1.0350957155879672, 1.0, 1.6363636363636365, 1.1111111111111112, 1.1898238747553815, 1.0779014308426074, 1.2333333333333334, 1.0718294051627384, 1.2337662337662338, 2.75, 1.019458070863452, 2.360655737704918, 1.1754385964912282, 1.0027231141455004, 1.1745454545454546, 1.0615384615384615, 1.0046904315196998, 2.25, 2.25, 1.0956521739130434, 1.4834437086092715, 1.1297029702970296, 1.0128990378071636, 1.0702341137123745, 1.0439276485788114, 1.5, 1.0141634195300508, 1.0892857142857142, 1.3666666666666667, 4.666666666666667, 1.0209895052473763, 1.25, 1.1414392059553349, 1.0169491525423728, 1.0653037926514735, 1.0255565821238042, 1.0888368129527055, 1.0366615519508988, 1.0425531914893618, 1.1657303370786516, 1.0147453083109919, 1.0340745511023561, 1.0909090909090908, 1.2258064516129032, 1.0198686971756417, 1.0400121594406657, 1.0253353204172877, 1.037914691943128, 1.170731707317073, 1.0749063670411985, 2.0, 1.7407407407407407, 1.1666666666666667, 1.1352941176470588, 1.7241379310344827, 1.0386363636363636, 1.017570281124498, 1.1180722891566266, 1.0120354335123283, 1.1156930126002291, 1.1346786021342234, 1.1397849462365592, 1.1, 1.0909090909090908, 1.0, 1.008329094125597, 1.2586206896551724, 1.0017373241431404, 1.023635340461452, 1.0442520060379756, 1.0096644295302013, 1.7142857142857142, 1.0976895014187271, 1.4, 1.0124645892351274, 1.4545454545454546, 1.0321602759289699, 1.0228365384615385, 1.022841726618705, 1.1503267973856208, 1.2236842105263157, 3.0, 1.111260053619303, 1.0009005863930502, 1.0423587562503591, 2.0, 1.1343283582089552, 1.038709677419355, 1.3853658536585365, 1.0755328389122736, 1.043885811674478, 1.2272727272727273, 1.1059413027916964, 1.0676419664221932, 1.0670871915977875, 1.0129480224086118, 1.0959199732926364, 1.0358608385370205, 1.0212765957446808, 1.1835443037974684, 1.0474896100079762, 1.5625, 1.0093715545755237, 1.0, 1.0, 1.1888667992047715, 1.0923076923076922, 1.2454175152749491, 1.0835375500201632, 1.1106674272675414, 1.0, 1.0743801652892562, 1.2666666666666666, 1.001054187056056, 1.12, 1.0, 1.0606673014515846, 1.3333333333333333, 1.0, 1.093093093093093, 2.3333333333333335, 1.1612066169315602, 1.0022321428571428, 1.3220973782771535, 1.0, 1.0140894391002533, 1.035449299258038, 1.1071428571428572, 1.1208580068035783, 1.088, 1.0273522975929978, 1.1285140562248996, 1.0266760266760266, 1.11915564258083, 1.0, 1.0941176470588236, 1.0110323723626993, 1.0248854961832061, 1.0814814814814815, 1.2, 1.0374064837905237, 1.0099635003218934, 1.0333187198597107, 2.0, 1.1203305785123967, 1.1004940401505645, 1.0890967397113842, 1.1679241844359396, 1.020967950733268, 1.0393686375000974, 1.0514809590973202, 1.036250406655203, 1.75, 1.0882936507936507, 1.0208816705336428, 1.020778600429902, 1.037465564738292, 1.0756756756756756, 1.0447743317060778, 1.0511363636363635, 1.0392537955425276, 1.1720142602495545, 1.1047653541677447, 1.222972972972973, 1.0072226526378927, 1.223938223938224, 1.130952380952381, 1.25, 1.0038522272877772, 1.1257995735607675, 1.0347364678209021, 1.0056508019738013, 1.3333333333333333, 1.1735505873436909, 1.2324929971988796, 1.0769230769230769, 1.108695652173913, 1.0106952445029391, 1.1660516605166051, 1.0526315789473684, 1.0, 1.048780487804878, 1.0333491012298959, 1.0347948582496918, 1.035829998094149, 1.0571255142645175, 1.0232808022922637, 1.203931203931204, 1.0712358337830545, 1.111935552257791, 1.1726618705035972, 1.0284440308634795, 1.2404692082111437, 1.08, 1.014181260410099, 1.0487200660611065, 1.0203443084375206, 1.5, 1.1348773841961852, 1.5620915032679739, 1.0393785764481478, 1.0061728395061729, 1.1288343558282208, 1.014657980456026, 1.0782312925170068, 1.0181571439892225, 1.0, 1.4915254237288136, 1.0, 1.3333333333333333, 1.03, 1.0687830687830688, 1.367132867132867, 1.1627906976744187, 1.0345844504021449, 1.225531914893617, 1.0304320493770716, 1.0197608972515508, 1.0055026923360626, 1.0080106020744901, 1.0247548865304392, 1.0932338838572189, 1.1755485893416928, 1.0106738422252186, 1.1268025857782198, 1.0362400906002265, 1.1452229299363057, 1.4508196721311475, 1.0131950609313212, 1.2292441140024783, 1.0087308516548932, 1.07981220657277, 1.1650512323456106, 1.0924548352816152, 1.6666666666666667, 1.018757327080891, 1.3125, 1.5, 1.3128654970760234, 1.0114697909899415, 1.0223506743737958, 1.0984455958549222, 1.0760233918128654, 1.0037978238835497, 1.177865206979131, 1.0342205323193916, 1.2, 3.0, 1.1456567145841012, 1.4768518518518519, 1.0040733197556009, 1.030207829869502, 1.0, 1.1232686980609419, 1.1113744075829384, 1.0407928988342576, 1.1632047477744807, 1.0025759244395498, 1.0038352912016593, 1.0141651094058552, 1.225, 1.5, 1.0736625715823993, 1.0, 1.1041931385006354, 1.1591836734693877, 1.123561013046815, 1.0756756756756756, 1.5862068965517242, 1.009245598504967, 1.095890410958904, 1.0469798657718121, 1.0980281158599867, 1.0166559897501601, 1.0433996383363473, 1.0213516347345344, 1.0319343065693432, 1.0222148541114058, 1.4, 1.1019446081319977, 1.1090727032149625, 1.263157894736842, 1.0235947258848022, 1.0928085519922255, 1.1202185792349726, 1.066405051871899, 1.0909090909090908, 1.2455752212389382, 1.0659674882013634, 1.1497584541062802, 1.2164179104477613, 1.0475331137430794, 1.3627450980392157, 1.8888888888888888, 1.0729996812240994, 1.0203081232492996, 1.1004169316656067, 1.0074792243767312, 1.0043634336570668, 1.1279527559055118, 1.0316742081447965, 1.015713387806411, 1.1955128205128205, 1.0079024599970092, 1.0713907985193019, 1.0466034755134281, 1.0991626267078007, 1.1182019977802442, 1.1393728222996515, 1.0565165268025347, 1.15, 1.6, 1.0402010050251256, 1.0027282648235722, 1.005499541704858, 1.2230652503793626, 1.5555555555555556, 1.0466613032984715, 1.1043936731107205, 1.5327102803738317, 1.0375649971902718, 2.6666666666666665, 1.0270906949352179, 2.0, 1.4078212290502794, 1.0, 1.0850235369326438, 1.393939393939394, 1.280701754385965, 1.1336283185840708, 1.0, 1.0319528250137135, 1.0226269315673289, 1.5, 1.75, 1.087248322147651, 1.0662460567823344, 1.0894710825506673, 1.0231729055258467, 1.0723226703755215, 1.1332250203086922, 1.1295774647887324, 1.0625, 1.6063829787234043, 1.3185840707964602, 1.3666666666666667, 1.0, 1.0307429547395388, 1.1736596736596736, 1.0575868372943327, 1.178247117641057, 1.0190024576842271, 1.239392128404337, 1.0070786230555537, 1.0123549796594846, 1.0626262626262626, 1.0165330661322645, 1.875, 1.0, 1.0789473684210527, 1.0070122922106872, 1.0919354838709678, 1.002710027100271, 1.0614035087719298, 1.0599885736050276, 1.059594994633738, 1.0036289355972314, 1.041237113402062, 1.0869565217391304, 1.011891891891892, 1.1405050002762585, 1.0404411764705883, 1.000848438102584, 1.2797619047619047, 1.0494397241719, 1.092572650122155, 1.0563322674202424, 1.068635275339186, 1.043921568627451, 1.130281690140845, 1.0354914196567864, 1.032934131736527, 1.0084712401102267, 1.3333333333333333, 1.1226533166458073, 1.0, 1.0938775510204082, 1.038848659378757, 1.2769230769230768, 1.0077050045775613, 1.1694616063548102, 1.1304347826086956, 1.0206757998243365, 1.004516167881014, 1.133010713586394, 1.0127084988085782, 1.032319391634981, 1.006780694962577, 1.1505190311418685, 1.0, 2.0, 1.3636363636363635, 1.0111245709670906, 2.1666666666666665, 1.0378945819332368, 1.0586374750443033, 1.119060824551673, 1.0703874866690366, 1.1379270491424345, 1.0806852476477897, 1.0741935483870968, 1.001150747986191, 1.0187073831962163, 1.0982343981292773, 1.0044432734110207, 1.0602424822927432, 1.3333333333333333, 1.1991150442477876, 1.388704318936877, 1.0555132384753665, 1.0082417582417582, 1.0093096785526086, 1.1947291361639825, 1.0095541401273886, 1.0459805928959316, 1.0810157194679564, 1.021139669256824, 1.25, 1.0070330725950323, 1.0105299838876065, 1.122396784800877, 1.0122936424306288, 1.2222222222222223, 1.0495495495495495, 1.1488016606906963, 1.0720426381532266, 1.183168316831683, 1.0056273996488108, 1.1142857142857143, 1.1128892392589673, 1.2548262548262548, 1.1156289707750953, 1.149749373433584, 1.0696202531645569, 1.1492537313432836, 1.1109022556390977, 1.0490788417487322, 1.0495145631067961, 1.0049047172758514, 1.0354945675179907, 1.1428571428571428, 1.037037037037037, 1.041075794621027, 1.0669527896995707, 1.0313961255845023, 1.2300469483568075, 1.2230997038499507, 1.0476190476190477, 1.016089108910891, 1.0394215410744252, 1.1363636363636365, 1.0238095238095237, 1.0133619267568459, 1.004909983633388, 1.4557926829268293, 1.0010537666029506, 1.035387616732762, 1.0379746835443038, 1.0953346855983772, 1.0004771541866166, 1.1121192663111756, 1.0261136712749617, 1.2198275862068966, 1.0218934911242603, 1.0044188496670519, 1.03, 1.75, 1.0617082963681097, 1.00288560314877, 1.0223409422049539, 1.2411764705882353, 1.0451535219747141, 1.0068639343115071, 1.041696794408291, 1.0357458075904677, 1.25, 1.060879368658399, 1.1666666666666667, 1.103896103896104, 2.0, 1.0566971930608293, 1.0032493907392364, 2.0555555555555554, 1.175, 1.0504555010511563, 1.0338345864661653, 1.0, 1.0909090909090908, 1.0300375469336671, 1.0986547085201794, 1.0438382854359474, 1.5, 1.027541451903372, 1.2560386473429952, 1.263380487093481, 1.1043478260869566, 1.0666666666666667, 1.0701804640504153, 1.0748099356705347, 1.003755693471486, 1.1221238938053097, 1.619047619047619, 1.0555555555555556, 1.088235294117647, 1.3855421686746987, 1.2769230769230768, 1.082191780821918, 1.0108091370987038, 1.005817532818845, 1.0522875816993464, 1.00653647236907, 1.0010341089150196, 5.0, 1.0018187443668698, 1.1609977324263039, 1.0, 1.5714285714285714, 1.0437793717536483, 1.1034379671150971, 1.0700126068354858, 1.0205655526992288, 1.0, 1.0777385159010602, 1.4524421593830334, 1.627906976744186, 1.037095884777509, 1.044596322831722, 1.0237967430249253, 1.1204439252336449, 1.1111111111111112, 1.0077748570348841, 1.077373211963589, 1.1912955465587045, 1.209563994374121, 1.0817031070195626, 1.0, 1.2503322995126274, 1.0763292061179899, 1.0340201885375824, 1.0905349794238683, 1.019543973941368, 1.0247486110473392, 1.1776034236804565, 1.1241610738255035, 1.1875, 1.0417583826640737, 1.0511618426416633, 1.036880362800063, 1.0368421052631578, 1.3434343434343434, 1.0864100549882167, 1.1111111111111112, 1.041371158392435, 1.0024509803921569, 1.0082003490991551, 1.075091575091575, 2.0, 1.0560547710740265, 1.1162301320796955, 1.188314104949758, 1.2428571428571429, 1.0087636575506207, 1.0643896976483762, 1.0860314841548087, 1.0199600798403194, 1.1132075471698113, 1.026928773394372, 1.0037768490288101, 1.033563672260612, 1.2002967359050445, 2.5, 1.127906976744186, 1.080945509516938, 1.2381635581061694, 1.019179570049141, 1.0021508205347454, 1.104886769964243, 1.6, 1.0192492781520692, 1.0841310476038688, 1.0317760544732362, 1.022950819672131, 1.0295088640775254, 1.2282958199356913, 1.1964679911699778, 1.0692974013474494, 1.0037052547248826, 1.0137759811803944, 1.1527093596059113, 1.108649789029536, 1.0263157894736843, 1.0946722584653619, 1.2125220458553791, 1.0434904738641915, 1.0412788344799677, 1.0109471680152309, 1.0445317616240994, 2.0, 1.0472027972027973, 2.5, 1.0, 1.5333333333333334, 1.0319148936170213, 1.1504950495049504, 1.028998948865393, 1.0441203838108637, 1.1382058287795993, 1.0095552466990967, 1.0730593607305936, 1.020718232044199, 1.0272134986639445, 2.2, 1.2142857142857142, 1.1810766721044046, 1.125, 1.15, 1.1398601398601398, 1.0116061400224634, 1.0158362929139184, 1.2, 1.1116856256463288, 1.029940119760479, 1.022126414950999, 1.0002141991057187, 1.0010570824524312, 1.0535554894376673, 1.0371125336927223, 1.0630442023124138, 1.0845070422535212, 1.3432835820895523, 1.1896162528216705, 1.0, 2.0, 1.0006744017944305, 1.5, 1.75, 1.3877551020408163, 1.0350877192982457, 1.0118090101817843, 1.0219594594594594, 1.0938775510204082, 1.1666666666666667, 1.0264227642276422, 1.0273768043802887, 1.2861538461538462, 1.0265848670756645]
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.6683	median: 1.0690	mean: 1.1633

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 20.712760 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=42.706088