Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='naru', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 4, 'naru': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 5.0000	99th: 2.6700	95th: 1.5509	median: 1.0591	mean: 1.1503
ReportEsts: [1.1209964412811388, 1.022636484687084, 1.0483824488495896, 1.0196078431372548, 1.0, 1.0, 1.2114797982942165, 1.0162595714707687, 1.25, 1.0386666666666666, 1.0002597852441981, 1.0020708328820536, 1.060106856634016, 1.011764705882353, 1.0438007771105617, 1.0, 1.4516129032258065, 1.016294721927028, 3.0, 2.6666666666666665, 1.2272727272727273, 1.1210265257709726, 1.0075440067057837, 1.0492914356130623, 1.0227043390514632, 1.0, 1.0626347742427762, 1.3333333333333333, 1.2, 1.223021582733813, 1.0, 1.0049932141332059, 1.0172020323802962, 1.2491675915649278, 1.018548990276739, 1.0347640647214136, 1.016304347826087, 1.005459064341763, 1.0997658240925683, 1.0595238095238095, 1.0863509749303621, 1.0853658536585367, 1.0, 1.1145225381845274, 1.0510566095943237, 1.2314049586776858, 1.0970873786407767, 1.2304347826086957, 1.0344508514924777, 1.0, 1.0582496205824963, 1.1170825335892514, 1.0069946027805534, 2.0, 1.2181818181818183, 1.063916364091649, 1.1643636363636363, 1.0687022900763359, 1.2173913043478262, 1.25, 1.0014105655913, 1.0348692403486923, 1.1045454545454545, 1.103448275862069, 1.0, 1.1511889515766156, 1.0366225839267549, 1.1666666666666667, 1.0, 1.0594567901234568, 1.0023866348448687, 1.054178674351585, 1.1193693693693694, 1.1509656494176619, 1.2117647058823529, 1.1226611226611227, 1.0, 1.0463084316295326, 1.6, 1.0804470716519843, 1.375, 1.0662401246244575, 1.1901840490797546, 1.0435779816513762, 1.0462012320328542, 1.04, 1.0105755101057552, 1.0406810580723624, 1.1519607843137254, 2.3333333333333335, 1.103244837758112, 1.0037016483256977, 1.0664451827242525, 1.361851332398317, 1.257175660160735, 1.0906515580736544, 1.25, 1.0191304347826087, 1.0, 1.0320471498296344, 1.120086393088553, 1.0255057167985928, 1.0080454497335827, 1.2647058823529411, 1.0129559159483774, 1.0787514318442153, 1.1121372573164225, 1.0656048540007583, 1.0299968424376382, 1.1666666666666667, 1.0, 1.1617806731813247, 1.018339075136086, 1.0761386811692726, 1.0909090909090908, 1.0053203807397466, 1.0, 1.2593328038125498, 1.1770334928229664, 1.0, 1.1868131868131868, 1.1666666666666667, 1.1228070175438596, 1.0170176189482396, 1.1349693251533743, 1.0275229357798166, 1.8, 1.2607615894039734, 1.0, 1.0357142857142858, 1.0018914028074553, 1.1818181818181819, 1.0338541666666667, 1.0021981196656347, 1.066354866997954, 1.1776729559748427, 1.0356164383561643, 1.001170503316426, 1.00199203187251, 1.052597819114817, 1.034124918672739, 1.2098765432098766, 1.060665362035225, 1.000462664215358, 2.0, 1.0176252319109462, 1.0709914320685434, 1.0558312655086848, 1.0322922181048173, 1.0, 1.077379510777428, 1.0192592592592593, 1.014, 1.4476190476190476, 1.0821484992101107, 1.0010124873439081, 1.0166962891150966, 1.177202633240148, 1.138783269961977, 1.0625, 1.0425531914893618, 1.1231884057971016, 1.1297836938435941, 1.1428571428571428, 1.0006313187846443, 1.0153837816075935, 1.0296384113811499, 1.0500862262877708, 1.0061087354917533, 1.0269009567729452, 1.0315789473684212, 1.0798319327731092, 1.2268809915754817, 1.1872749099639857, 1.144126357354393, 1.0404448938321538, 1.0321975617380432, 1.0432884685340125, 1.137660804065055, 1.1666666666666667, 1.1559633027522935, 1.0557210965435042, 1.0471816283924844, 1.0671476137624862, 1.1014492753623188, 1.019859086436787, 1.0616951758600808, 1.0532000086574465, 1.0357142857142858, 1.1972727272727273, 1.072277965712975, 1.0, 1.1818181818181819, 1.0784663591261205, 1.2656072644721907, 1.1123076923076922, 1.3461538461538463, 1.0237942122186494, 1.0013274404581214, 1.0014882486630416, 1.1798245614035088, 1.1198482133445768, 1.2733812949640289, 1.09375, 1.0476190476190477, 1.0, 1.0596026490066226, 1.0913893707617095, 1.6829268292682926, 1.0804597701149425, 1.0177953534354918, 1.0957683741648108, 1.0745199830636403, 1.0170902230607035, 1.02591413911801, 1.2846715328467153, 1.1400329489291599, 1.0408094435075885, 1.0169402418365558, 1.0457264086490632, 1.0, 1.1532091097308488, 1.01770626120182, 1.0080987953970608, 1.0593555681175806, 1.0377802417719122, 1.0007618725133327, 1.0344827586206897, 1.0025287876628692, 1.0982724440668366, 1.1567963902989284, 1.0267379679144386, 1.1951877203899606, 1.013328106624853, 1.1283464566929133, 1.0, 1.0572070946789907, 1.0542652970075927, 1.1436997319034852, 1.4328358208955223, 1.0909090909090908, 3.0, 1.1137159036949755, 1.1454545454545455, 1.0381989542744863, 1.5, 1.0, 1.2121212121212122, 1.009367681498829, 1.5408163265306123, 1.1215469613259668, 1.1791044776119404, 1.0853658536585367, 1.005912162162162, 1.0343370840507748, 1.0350877192982457, 1.0, 1.0152391290733358, 1.134760532455057, 1.1085814360770578, 1.0541892547049232, 1.0415756590643572, 1.0178964941569282, 1.1248012718600955, 1.0140661584775452, 1.0669856459330143, 1.165748541801685, 1.2399878178772652, 2.0, 1.0450581395348837, 1.1620469083155651, 1.2727272727272727, 1.0, 1.1781818181818182, 1.0555555555555556, 1.0263157894736843, 1.0287463831505281, 1.192200557103064, 1.2239263803680982, 1.0177753550627173, 1.0483729111697448, 1.0054195322332657, 1.0044675782224133, 1.4, 1.1182429974536194, 1.2, 1.0221768506454256, 1.0691144708423326, 1.0070228938145738, 1.275, 1.6666666666666667, 1.0952380952380953, 1.5070422535211268, 1.0094521320967662, 1.0, 1.084097859327217, 1.0158371040723981, 1.0372596153846154, 1.002375407545412, 1.1886792452830188, 1.0188679245283019, 1.0215862747855435, 1.0577151587166864, 1.0029680731589925, 1.1282051282051282, 1.0, 1.220763723150358, 1.0099502487562189, 1.2242990654205608, 1.0849099716662096, 1.058719646799117, 1.1070422535211268, 1.1346153846153846, 1.0068587105624143, 1.0995744680851063, 1.4285714285714286, 1.0308511057673355, 1.064102564102564, 1.0, 1.0491200872735624, 1.2857142857142858, 1.75, 1.023764295573835, 2.0, 1.0301783264746227, 1.0857558139534884, 1.002467105263158, 1.0118637581324148, 1.156657963446475, 1.10989010989011, 1.0095509950080495, 1.0199281095072337, 1.0265734265734265, 1.0012381616169899, 1.1473499361430395, 3.0, 1.1111111111111112, 1.0281116005873716, 1.3333333333333333, 1.048687089715536, 1.0, 1.0, 1.0454545454545454, 1.21760391198044, 1.0811843361986628, 1.1517857142857142, 1.0497835497835497, 1.0, 1.0366178428761652, 1.0169879889128426, 1.5, 1.2042882668254913, 1.0, 1.015516586958172, 1.1125, 1.0672002099186566, 1.1774193548387097, 1.0018181818181817, 1.1906693711967546, 1.1574074074074074, 1.0116709044950984, 1.0026174655756823, 1.0148648648648648, 1.0, 1.1428571428571428, 1.8333333333333333, 1.5, 1.2307692307692308, 1.0023788246034757, 1.25, 1.0067001675041876, 1.1485148514851484, 1.0544808421952654, 1.0471805871633229, 1.023686920700309, 1.054184574694186, 1.0323353293413173, 1.25, 1.5, 1.0457516339869282, 1.0398230088495575, 1.0033081745812178, 1.2380952380952381, 3.142857142857143, 1.1224944320712695, 1.0354651162790698, 1.0029776776154105, 1.1444600280504909, 1.342769701606733, 1.0295774647887324, 1.3793103448275863, 1.0808477237048666, 1.0286016949152543, 1.2692307692307692, 1.0568862275449102, 1.0603448275862069, 1.0349722405917905, 1.023313245959762, 1.0429822118564416, 1.4333333333333333, 1.045045045045045, 1.0498533724340176, 1.0, 1.0347581495805918, 1.0270743789798313, 1.0548909553594787, 1.004709969734415, 1.0730541212468923, 1.0204280155642023, 1.8333333333333333, 1.0574047274481428, 1.2, 1.072587532023911, 1.1111111111111112, 1.0121135140187945, 1.0449275362318842, 1.0074161650902838, 1.1778656126482214, 1.096830985915493, 3.0, 1.1171465968586387, 1.0039734010486125, 1.0261633253632518, 1.0, 1.1666666666666667, 1.021113243761996, 1.25, 1.0716456101071485, 1.0366379310344827, 1.2352941176470589, 1.192407247627265, 1.0795568747516768, 1.0734948303534768, 1.0134475080746654, 1.1518640350877194, 1.2570480928689884, 1.1098484848484849, 1.1538461538461537, 1.0, 1.3, 1.0470668485675307, 1.03125, 1.068850932334328, 1.3888888888888888, 1.1376708652965875, 1.0386812323729964, 1.124913254684247, 1.0, 1.0961538461538463, 1.24, 1.0021790731156854, 1.4551422319474836, 1.0, 1.1416827852998066, 1.0154054879481276, 1.1945544554455445, 1.0, 2.0, 1.1615533980582524, 1.0054054054054054, 1.4878048780487805, 1.0, 1.0338660201860281, 1.0047438330170777, 1.0869565217391304, 1.0703954802259887, 1.0272727272727273, 1.0288713910761156, 1.1451612903225807, 1.0546907867059319, 1.1293840766890535, 1.0, 1.054054054054054, 1.138850480212265, 1.0199947422951428, 1.0234625751606883, 1.0, 1.078740157480315, 1.014462486468482, 1.0277632268203247, 2.0, 1.1140350877192982, 1.0564709759427522, 1.0666017710230484, 1.2305272814643309, 1.029380301233131, 1.1791820315119008, 1.0310924369747898, 1.1239151398264224, 2.0, 1.1414543387255156, 1.1384615384615384, 1.0, 1.2451612903225806, 1.1304347826086956, 1.038412934720515, 1.120952380952381, 1.0472982013494658, 1.2085413200221853, 1.0643922169303306, 1.032192614635466, 1.0023752557300878, 1.0970873786407767, 4.0, 1.0416084503661025, 1.0038461538461538, 1.0039171764491848, 1.0027575028054594, 1.0764609503003824, 1.1571534469977762, 1.094240837696335, 1.4285714285714286, 1.0134346587053875, 1.0041170218716786, 1.0070052863110421, 1.0979474252790782, 1.0423858697017663, 1.025369978858351, 1.0046365975627518, 1.035175879396985, 1.1025280898876404, 2.0, 1.0, 1.0046012269938651, 1.0600375234521575, 1.0222984562607205, 1.0273483947681332, 1.120879120879121, 1.1436781609195403, 1.0554699537750385, 1.120879120879121, 1.0156152613302467, 1.527027027027027, 1.030612244897959, 1.0, 1.0765661252900232, 1.5277777777777777, 1.148936170212766, 1.0115851935575022, 1.076560659599529, 1.033596837944664, 1.0103761348897535, 1.0375546162613982, 1.0, 1.9361702127659575, 2.0, 1.0, 1.0114942528735633, 1.0530785562632696, 1.3816631130063965, 1.1573033707865168, 1.030759371996155, 1.1108247422680413, 1.0018189306060814, 1.031946361664366, 1.0953545232273838, 1.021037936149379, 1.0755813953488371, 1.0642317380352644, 1.1335268505079825, 1.1179401993355482, 1.1473988439306357, 1.017264634475317, 1.0084321340964841, 1.0484494933988333, 1.0131953214441678, 2.0, 1.0516795865633075, 1.0138632162661738, 1.0410958904109588, 1.0, 1.0408163265306123, 1.1538461538461537, 1.1894736842105262, 1.5555555555555556, 1.5, 1.0343026162306281, 1.0351519459747645, 1.006913008613777, 1.0717521436660735, 1.1027027027027028, 1.0595382746051032, 2.0, 1.1666666666666667, 1.2131024096385543, 1.0052469259422439, 1.006936155111785, 1.063389907734366, 1.021455390666905, 1.0845070422535212, 1.0221152199151171, 1.2078152753108349, 1.0017602080857457, 1.0278619702931155, 1.3333333333333333, 1.1068281938325992, 1.0, 1.0090702947845804, 1.0173699416965105, 3.0, 1.0943934760448522, 1.0366976587879466, 1.1428571428571428, 1.1735858628561766, 1.1111111111111112, 1.1875, 1.0129886685552407, 1.7692307692307692, 1.0154514581293885, 1.0200768902178556, 1.1875, 1.16, 1.2597402597402598, 1.0157819225251077, 1.1043393466601659, 1.0304836406531321, 1.011436578367919, 1.0, 1.2053552031283945, 1.0061349693251533, 2.0, 1.043153354706276, 1.0259364996972056, 1.1154210028382214, 1.0083178437169942, 1.1060930345967326, 1.2282608695652173, 2.142857142857143, 1.0623811335108406, 1.0763888888888888, 1.0534844654098723, 1.0533689126084056, 1.0530058959477606, 1.0434814211781125, 1.05, 1.0314658480429777, 1.1455938697318007, 1.0047681600939098, 1.0813880126182964, 1.0424929178470255, 1.059873949579832, 1.042952690679266, 4.0, 1.0071687900191433, 1.0026011560693642, 1.0256733530530546, 1.0555555555555556, 1.021663657825302, 1.231818181818182, 1.0, 1.016858291599069, 1.0134426229508198, 1.0751173708920188, 1.1764705882352942, 1.6666666666666667, 1.0047646182469774, 1.0, 1.341692789968652, 1.1538461538461537, 1.1112622985137115, 1.2857142857142858, 1.3021978021978022, 1.10062893081761, 1.0, 1.1719576719576719, 1.020694259012016, 2.0, 1.0, 1.064, 1.0661764705882353, 1.1566587395957193, 1.006335797254488, 1.0389610389610389, 1.0206489675516224, 1.089150378938971, 1.0493506493506493, 1.5506329113924051, 1.303191489361702, 1.3846153846153846, 1.0, 1.096579476861167, 1.2698412698412698, 1.0950226244343892, 1.2160766032505985, 1.0047142982790467, 1.1971482324982672, 1.0090184406921616, 1.0000361480624638, 1.0577617328519855, 1.0041766109785202, 1.375, 1.0, 1.0303030303030303, 1.019024050730802, 1.1240079365079365, 1.0065359477124183, 1.1123287671232878, 1.0360442917143948, 1.0398408591380797, 1.003125334475008, 1.0769230769230769, 1.1, 1.0547742413027388, 1.1632423117709438, 1.0023172303725985, 1.0422289483075378, 1.1776315789473684, 1.038245717660957, 1.0115938805174483, 1.1, 1.0092497430626928, 1.2222222222222223, 1.0287970274036229, 1.2117117117117118, 1.0192307692307692, 1.2112211221122111, 1.0347890451517394, 1.0, 1.0922693266832917, 1.0512053313386147, 1.1666666666666667, 1.0409954256165472, 1.1302966101694916, 1.0238095238095237, 1.0354135620736864, 1.0082912761355443, 1.1375570776255708, 1.0086621751684313, 1.0839954597048809, 1.0115532010820558, 1.1864406779661016, 1.0, 1.0, 1.1111111111111112, 1.0116264987283516, 1.8333333333333333, 1.0377508166122258, 1.040358623660546, 1.1276030128489145, 1.0651576052464564, 1.000128036722829, 1.097534833869239, 1.0856031128404668, 1.0013888888888889, 1.014088806443281, 1.0375665621124808, 1.0084318002061212, 1.0138504155124655, 1.25, 1.032258064516129, 1.2371541501976284, 1.021583243329379, 1.0199335548172757, 1.0108695652173914, 1.1752212389380532, 1.0175438596491229, 1.024203202154721, 1.0347222222222223, 1.0369856459330145, 1.4375, 1.0356764643588356, 1.013996258835604, 1.1250554323725055, 1.0008428150021071, 1.21875, 1.1605995717344755, 1.0696517412935322, 1.5, 1.0713201272411799, 1.4615384615384615, 1.1118951612903225, 1.0317460317460319, 1.1092380310182064, 1.0390132960111966, 1.071764705882353, 1.1818181818181819, 1.0717703349282297, 1.014982168462076, 1.0047392835810898, 1.002726950111755, 1.0832861890955379, 1.0468656358623996, 1.1538461538461537, 1.0593645484949832, 1.110412147505423, 1.0907629804902004, 1.03205791106515, 1.2083333333333333, 1.1397738951695786, 1.053485108373616, 1.185025817555938, 1.0168018843234756, 1.0, 1.3333333333333333, 1.0071893001063068, 1.072754716981132, 1.0050957381099443, 1.0373368196412436, 1.059856344772546, 1.0273972602739727, 1.0042167780252413, 1.106800654358495, 1.005514705882353, 1.3675675675675676, 1.0273109243697478, 1.0326044274284591, 1.0, 1.75, 1.0434440201091764, 1.00031854632079, 1.0293427230046948, 1.2661870503597121, 1.0601013758146272, 1.0301269975431384, 1.0310144927536231, 1.025, 1.3076923076923077, 1.1071428571428572, 1.01931330472103, 1.096875, 1.5925925925925926, 1.0281260476030842, 1.0178394449950445, 1.0855085508550855, 1.28125, 1.0240478817668104, 1.0841316118284048, 1.008233229855581, 1.0837089504185446, 1.3333333333333333, 1.0769230769230769, 2.0, 1.0268240343347639, 1.3461538461538463, 1.3333333333333333, 1.5, 1.2562396006655574, 1.0253623188405796, 1.0801874511845873, 1.0469862442684452, 1.0745454545454545, 1.4852941176470589, 1.0, 1.0689655172413792, 1.3513513513513513, 1.5909090909090908, 1.0109034267912773, 1.016732742143547, 1.0017246121481085, 1.0546875, 1.0105728920894799, 1.0016916070266753, 5.0, 1.0049930250757035, 1.062857142857143, 1.0, 1.3333333333333333, 1.100887573964497, 1.1148963637667646, 1.0856646063334405, 1.0186335403726707, 1.0, 1.0077519379844961, 1.00920245398773, 2.0, 1.5, 1.1446850393700787, 1.0654540246347752, 1.227077583563324, 1.25, 1.008909526082646, 1.0712625871417505, 1.0263157894736843, 1.3333333333333333, 1.217142857142857, 1.0027630066352495, 1.3289473684210527, 1.0561321025170576, 1.0632010887495875, 1.0216346153846154, 1.032258064516129, 1.0361432506887052, 1.1673783091374894, 1.1115702479338843, 1.2105263157894737, 1.0311773114432405, 1.077788649706458, 1.038263355606529, 1.7578947368421052, 1.2289156626506024, 1.0597014925373134, 1.0151898734177216, 1.0424093423478795, 1.0208683601830058, 1.0282041987139074, 1.0622270742358078, 3.0, 1.25, 1.0196893179057724, 1.1253298153034301, 1.3096673798871814, 1.0100220025411386, 1.0377989630372972, 1.085117795106655, 1.1108312342569269, 1.1041666666666667, 1.0222466787202265, 1.008485545807565, 1.0559811431938715, 1.0400728597449909, 2.5, 1.1333333333333333, 1.0332000440221578, 1.086021505376344, 1.0197572498926237, 1.0074182799111393, 1.1463068181818181, 2.0, 1.0154211150652432, 1.034748949591416, 1.0258167694768106, 1.0076628352490422, 1.0111750822486054, 1.3083333333333333, 1.141057934508816, 1.0759420289855073, 1.0021857883749519, 1.0627124709250313, 1.096774193548387, 1.1254801536491676, 1.03125, 1.087576896787423, 1.0078544281930208, 1.0726552179656539, 1.057479532764704, 1.0256849315068493, 1.0500397140587767, 1.2857142857142858, 1.0934182590233545, 2.5, 1.5, 1.4166666666666667, 1.0153452685421995, 1.1516587677725119, 1.0613465037691707, 1.0470479704797049, 1.1004070556309362, 1.0675732217573222, 1.0434782608695652, 1.489795918367347, 1.0037034168596997, 1.6, 1.3333333333333333, 1.2360975609756097, 1.0, 1.1996805111821087, 1.1245674740484428, 1.0616493916178458, 1.017464413822207, 1.25, 1.1548087236324633, 1.310077519379845, 1.153366583541147, 1.0009596620520238, 1.076086956521739, 1.0328970640254687, 1.0188278708039045, 1.0094503584618726, 1.0588235294117647, 1.5434782608695652, 1.2695530726256983, 1.0, 1.0, 1.0007376345624261, 1.6666666666666667, 1.5714285714285714, 1.35, 1.057901085645356, 1.0561797752808988, 1.030857142857143, 1.0925846549507072, 1.0, 1.2377405338299192, 1.0325693606755126, 1.188340807174888, 1.0558375634517767, 1.25, 1.0270778072502211, 1.0106442577030812, 1.0774058577405858, 1.039047973224247, 1.0123726251169853, 1.1610654458433045, 1.0513059701492538, 1.0, 1.0385325131810192, 1.0285660275452335, 1.0299224233468784, 1.2695652173913043, 1.0129484495935355]
origin-bjaq_15.87 	max: 5.0000	99th: 2.6700	95th: 1.5509	median: 1.0591	mean: 1.1503

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 16.358212 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=naru', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[8.3446503e-07 2.0861626e-06 1.1920929e-07 5.9604645e-07 4.7683716e-07]
Distance score: 8.225441092690744e-07
SAUCE Drift detection: False
Detection latency: 0.0392s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 2.106680 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 6.0000	99th: 3.0000	95th: 1.6679	median: 1.0648	mean: 1.1642
ReportEsts: [1.0988372093023255, 1.0441776166742185, 1.017446071871432, 1.0, 1.0285714285714285, 2.0, 1.2061978545887961, 1.0119188656892115, 1.6, 1.046875, 1.007127669855997, 1.001704100310854, 1.039344262295082, 1.0431372549019609, 1.0301685891748003, 1.0, 1.096774193548387, 2.0, 1.4444444444444444, 1.091237579042457, 1.0647131911368812, 1.0213268998793728, 1.0864100549882167, 1.1295097132284921, 1.0459948974976025, 1.0005019742450756, 2.0, 1.0734734958622232, 1.0, 1.0, 1.0, 1.0, 1.0069893609525822, 1.0065762485898881, 1.3357865685372585, 1.0711559768558414, 1.0165770862800565, 1.027027027027027, 1.3333333333333333, 1.1973980309423347, 1.1625929861849096, 1.0696962689916891, 1.1407035175879396, 1.0254309126871999, 1.0233393177737882, 1.0525719993341103, 1.3157894736842106, 1.158008658008658, 1.3473684210526315, 1.1095690284879474, 1.375, 1.0446096654275092, 1.0896860986547086, 1.0909090909090908, 1.0525157083015995, 1.0081953778069168, 1.0575227431770469, 1.037037037037037, 1.1219512195121952, 1.022074930704064, 1.0144927536231885, 1.0132889227581365, 1.042817679558011, 1.036231884057971, 1.1941747572815533, 5.0, 1.1339867396944365, 1.0476190476190477, 1.0, 1.0, 1.0704131681769058, 1.003960396039604, 1.0644850818094322, 1.0787545787545787, 1.125589575505636, 1.053585500394011, 1.07365754186492, 1.0657894736842106, 1.099290780141844, 1.0347325864772448, 1.0252100840336134, 1.0289855072463767, 2.0, 1.125, 1.0530759951749096, 1.0535714285714286, 1.0782122905027933, 1.0909090909090908, 1.0, 1.0306467917141344, 1.085564990202482, 1.1117850098619328, 1.0323458682381543, 1.2603571011786674, 1.0852272727272727, 1.309495896834701, 1.0036496350364963, 1.28125, 1.375, 1.109105180533752, 1.4545454545454546, 3.0, 1.0508860464490914, 1.1273584905660377, 1.0500736377025037, 1.0087727045247137, 1.2380952380952381, 1.0072819666548793, 1.126897238118935, 1.0144549845373363, 1.0786696514230891, 1.0052192066805845, 1.0, 4.0, 1.1492170022371364, 1.0123983480223102, 1.061936936936937, 1.0941176470588236, 1.005813924720808, 1.0, 1.1800683017696367, 1.1766109785202863, 1.0, 1.2262443438914028, 1.0, 1.088937093275488, 1.015542667185345, 1.0813546126897626, 1.04, 1.8333333333333333, 1.2959545777146912, 1.0, 1.25, 1.0303173403853418, 1.0769230769230769, 1.0598544081962793, 1.027531194803715, 1.0362818692094407, 1.2, 1.4666666666666666, 1.0447154471544715, 1.0885466794995187, 1.0415114422565195, 1.0438853844121174, 1.0784313725490196, 1.066271551724138, 1.00679688058954, 1.0, 1.0049980776624374, 1.072375127420999, 1.0504945340968246, 1.0330676114555655, 1.3333333333333333, 1.0405391709739535, 1.0169082125603865, 1.037037037037037, 1.1724137931034482, 1.0, 1.0747241725175527, 1.0146328366223654, 1.0702269391441797, 1.1847649918962724, 1.110512129380054, 1.0689655172413792, 1.3373493975903614, 1.1375515818431912, 1.2857142857142858, 1.0189529348746917, 1.6153846153846154, 1.0336538461538463, 1.053258775934578, 1.0096533567354102, 1.0691037000756936, 1.0018050541516246, 1.104129263913824, 1.1946503383822107, 1.0208643815201193, 1.220053238686779, 1.0398642917726888, 1.0189266269121078, 1.0034665160230074, 1.0069529389042684, 1.0516129032258064, 1.0133333333333334, 1.0033730490136035, 1.0144230769230769, 1.0036496350364963, 1.1718528995756718, 1.2402234636871508, 2.0, 1.0972568578553616, 1.0128524046434495, 1.064516129032258, 1.0181723779854621, 1.0133347367057453, 1.0034499889600352, 1.0067236221201, 1.011066398390342, 1.061412836032499, 1.0446276225036648, 1.0763888888888888, 1.0708322111500135, 1.053817271589487, 1.0074028999357894, 1.181201044386423, 1.1824264835358338, 1.0869565217391304, 1.0649350649350648, 1.0097087378640777, 1.0, 1.048913043478261, 1.0447282252783234, 1.6904761904761905, 1.1428571428571428, 1.0131255127153405, 1.3529411764705883, 1.0001894604854322, 1.0760095011876485, 1.0432738318145882, 3.0, 1.053593179049939, 1.02734375, 1.0026296601761873, 1.073965557866268, 2.8, 1.1844431349440188, 1.0172865803703097, 1.0130999454889984, 1.016, 1.1658291457286432, 1.0550611790878754, 1.0224261275272162, 1.0, 1.0054220108486798, 1.0036749250776344, 1.15, 1.0946643717728055, 1.0125, 2.0, 1.1642287234042554, 1.0, 1.0013784954706577, 1.0185745542572506, 1.047267068663684, 1.3885350318471337, 1.1538461538461537, 3.3333333333333335, 1.1160030515536516, 1.2096774193548387, 1.1175257731958763, 2.0, 1.0551219512195122, 1.007121057985758, 1.5714285714285714, 1.0142159643921655, 1.1038374717832957, 1.0922190201729107, 1.3773584905660377, 1.0170879316482735, 1.029578821497376, 1.0136986301369864, 2.0, 1.0239055077673642, 1.1803484718651813, 1.1103047895500726, 1.0360535405872193, 1.052624875283928, 1.0679529466709479, 1.103448275862069, 1.038013884608046, 1.0551724137931036, 1.1721611721611722, 1.1671421778411792, 1.5384615384615385, 1.056008014024543, 1.2641843971631206, 1.36, 1.0333333333333334, 1.010133843212237, 1.2182952182952183, 1.0275610132574133, 1.0453761784233888, 1.1441860465116278, 1.2262210796915167, 1.0009852647110213, 1.1185127807900852, 1.0104681125187889, 1.0129164585386985, 1.4615384615384615, 1.0068493150684932, 1.0, 1.0259996223386678, 1.0551888179169897, 1.0455873424050859, 1.0957165520888419, 1.0162283156127587, 1.0095662806588506, 1.0078026936255386, 1.0057735253000235, 1.0591870824053453, 1.0824544582933844, 1.1176470588235294, 1.0, 1.0809155383623468, 1.2857142857142858, 1.0480591497227356, 1.0071223379217202, 1.1117015734083568, 1.105263157894737, 1.2941176470588236, 1.0686274509803921, 1.0903583174658127, 1.012008161938641, 1.1363636363636365, 1.0216398172637653, 1.001434912938787, 1.0071942446043165, 1.25, 2.6666666666666665, 1.076109450448379, 1.5, 1.022466344477431, 1.0631741140215716, 1.0909090909090908, 1.0828629877011806, 1.3043478260869565, 1.7777777777777777, 1.0262187450288507, 3.0, 1.2702702702702702, 1.0296912114014252, 1.161824429865667, 1.0554128440366972, 1.1010989010989012, 1.2264150943396226, 1.015573059283549, 1.0044610268472707, 1.0833333333333333, 1.0045096292234938, 1.0139175561714926, 3.0, 1.1818181818181819, 1.0167197529310394, 1.0, 1.0543627227044312, 1.0526315789473684, 2.0, 1.1111111111111112, 1.1405197305101058, 1.0811244979919679, 1.2265625, 1.170731707317073, 1.170731707317073, 2.0, 1.0191165721048419, 1.0346534653465347, 1.0333333333333334, 1.0506502571261407, 1.2107142857142856, 1.0769847634322374, 1.006585136406397, 2.25, 1.25, 1.2094744633604737, 1.0974025974025974, 1.0670103092783505, 1.016960509234055, 1.0629147210616858, 1.0024630541871922, 1.5, 1.0031004311993297, 1.3333333333333333, 1.4074074074074074, 1.5, 1.1955128205128205, 1.4285714285714286, 1.1291866028708133, 1.191304347826087, 1.055488718630617, 1.0229714709151538, 1.1974043715846994, 1.0104263333151373, 1.0471262760453084, 1.0517241379310345, 1.0173333333333334, 1.0260087137715477, 1.0547945205479452, 1.125, 1.0062766936454377, 1.0150211739683626, 1.0472271914132378, 1.0285714285714285, 1.170731707317073, 1.015929203539823, 2.0, 1.7407407407407407, 1.1491228070175439, 1.114119922630561, 1.5384615384615385, 1.117910447761194, 1.0715725806451613, 1.3024691358024691, 1.0151589259385279, 1.1372696502444528, 1.0408897612037946, 1.3461538461538463, 1.037313432835821, 1.0913580246913581, 1.0, 1.0151815817358636, 1.4285714285714286, 1.0045136921624174, 1.0438176904081355, 1.0474675995865468, 1.017741935483871, 1.7142857142857142, 1.0128669079211903, 1.0, 1.0731551144549383, 1.1818181818181819, 1.0221357700775053, 1.0422885572139304, 1.0247882300490414, 1.0428134556574924, 1.1204730229120472, 3.0, 1.05313386639154, 1.0044837015164865, 1.129389912297499, 1.0, 1.510204081632653, 1.0023640661938533, 1.2904761904761906, 1.0920301671422747, 1.0608441158348736, 1.2083333333333333, 1.0021186440677967, 1.1315266133749269, 1.0738640788797333, 1.0287108346085343, 1.1319060114503816, 1.0671111111111111, 1.0909090909090908, 1.2168545356951155, 1.0413160982360432, 1.204724409448819, 1.094143404488232, 1.0, 1.0, 1.1452658884565499, 1.08984375, 1.1987788331071914, 1.0720339632473523, 1.1194460473167918, 1.0, 1.0390625, 1.09375, 1.0355354007561641, 1.3333333333333333, 1.0, 1.028607821984221, 1.3333333333333333, 1.0, 1.1445131375579598, 1.5, 1.165374677002584, 1.0067164179104477, 1.44140625, 1.1, 1.024309901385011, 1.039279869067103, 1.0, 1.1143529411764705, 1.0149253731343284, 1.0209481808158765, 1.190217391304348, 1.0098730606488011, 1.1837555672621043, 1.0, 1.0106382978723405, 1.216963960684383, 1.0374865570748195, 1.0956263899184582, 1.2, 1.0434865900383141, 1.007239906297368, 1.0239234449760766, 2.0, 1.0939641109298532, 1.0493895017863453, 1.1323839077912004, 1.1519709355131698, 1.0305269370708783, 1.0202295273293134, 1.0535838552540013, 1.0445982558631783, 1.75, 1.1573357413140695, 1.0015503875968992, 1.0238883632923368, 1.08268156424581, 1.0077519379844961, 1.0334943685529083, 1.1517094017094016, 1.0475309872065681, 1.1495820501539815, 1.0479056024031335, 1.158102766798419, 1.0303411453654028, 1.1849475352910093, 1.072289156626506, 1.1686746987951808, 1.0269299820466786, 1.1152173913043477, 1.038342423328857, 1.0021506383975636, 1.6666666666666667, 1.1133709981167608, 1.182825484764543, 1.2169811320754718, 1.08, 1.0122516618444797, 1.1241379310344828, 1.1591009255178493, 2.0, 1.0526315789473684, 1.0264775413711584, 1.0021970535638252, 1.0261151353412123, 1.0138073691014868, 1.0315789473684212, 1.060965283657917, 1.0827436037016875, 1.1018925203462084, 1.186206896551724, 1.0303714392105754, 1.2111237230419978, 1.1324200913242009, 1.0150269684622089, 1.0, 1.0008721079361822, 1.0, 1.068254990341275, 1.4758842443729903, 1.0862651424671559, 1.0147368421052632, 1.1129196337741607, 1.0097560975609756, 1.0673758865248226, 1.040791895047193, 1.0, 1.9454545454545455, 2.0, 1.0, 1.1041666666666667, 1.2, 1.3511586452762923, 1.1308411214953271, 1.028403787171623, 1.064021164021164, 1.0571029250274533, 1.02071237389335, 1.0006994034499985, 1.0422599028698698, 1.013896718539009, 1.119087367835281, 1.0601104502973662, 1.0031330410750023, 1.1032608695652173, 1.0305084745762711, 1.1067146282973621, 1.1485714285714286, 1.0089181227553368, 1.2127921279212792, 1.0139943783266552, 1.0506912442396312, 1.21042026482441, 1.0532212885154062, 2.5, 1.0023121387283238, 1.125, 1.1666666666666667, 1.3791044776119403, 1.0063191743942566, 1.0123314065510598, 1.116580310880829, 1.0402298850574712, 1.0115668101875501, 1.1484923447215352, 1.050751879699248, 1.2, 1.0, 1.0086663456909004, 1.4227272727272726, 1.0448013524936601, 1.0046849379245726, 1.0, 1.0283517539644402, 1.0683371298405466, 1.016067233250816, 1.1937869822485208, 1.0087126432441618, 1.0179274563394636, 1.0040702785687106, 1.1341463414634145, 2.5, 1.0936862530474154, 2.0, 1.1046077210460772, 1.1551724137931034, 1.0789473684210527, 1.0, 1.4666666666666666, 1.1466025692817323, 1.255813953488372, 1.3067484662576687, 1.0064685668081665, 1.027617212588311, 1.04292343387471, 1.0455888144938952, 1.0142475512021372, 1.0094957432874918, 1.1666666666666667, 1.1051899321219276, 1.120378393991912, 1.0869565217391304, 1.0537102473498232, 1.0373946485557646, 1.1025641025641026, 1.0709873756072892, 1.2, 1.1475409836065573, 1.0625841881670293, 1.1850961538461537, 1.2962962962962963, 1.0282331120823638, 1.29, 2.25, 1.0196078431372548, 1.0626801152737753, 1.0497473107654085, 1.070927950658817, 1.0080596742508297, 1.0042918454935623, 1.1420029895366217, 1.019447929736512, 1.1396825396825396, 1.0199148691507316, 1.0402298850574712, 1.0497237569060773, 1.0374727668845316, 1.1374951127329598, 1.2348284960422165, 1.1675562333206253, 1.1428571428571428, 1.3333333333333333, 1.0226130653266332, 1.0252255569876634, 1.0261618959679901, 1.0373665480427046, 1.5555555555555556, 1.041335453100159, 1.0894535328924468, 1.4, 1.015210271729449, 3.0, 1.1138196480938416, 1.5, 1.5281899109792285, 1.125, 1.028475420758379, 1.28125, 1.2863636363636364, 1.1095652173913044, 1.0, 1.123921568627451, 1.0944741532976827, 2.25, 1.0, 1.0526315789473684, 1.049079754601227, 1.0320512820512822, 1.0276046304541406, 1.0388219544846051, 1.0188679245283019, 1.1253561253561253, 1.1019777503090236, 1.6256983240223464, 1.1221374045801527, 1.1142857142857143, 1.0, 1.0467937608318891, 1.279126213592233, 1.0699115044247787, 1.2657471763683754, 1.0042954948615326, 1.2316622018114556, 1.0160712963191547, 1.0837873992626186, 1.0595238095238095, 1.0083702609551946, 1.2, 1.0, 1.0256410256410255, 1.0469242719730274, 1.1125611745513866, 1.0081967213114753, 1.237851662404092, 1.1081665077851923, 1.0264768049838693, 1.0117514885390209, 1.053191489361702, 1.1304347826086956, 1.001108647450111, 1.1511756264488353, 1.0466209807771945, 1.0657160774994223, 1.1675675675675676, 1.018295739348371, 1.0123602118893467, 1.0480001625058402, 1.025875190258752, 1.0139851269285045, 1.2014652014652014, 1.064334539605951, 1.0546218487394958, 1.0029411418342833, 1.0344827586206897, 1.0652931854199683, 1.0, 1.0717213114754098, 1.0415118154407124, 1.2352941176470589, 1.0118917985764369, 1.1662245800176834, 1.1176470588235294, 1.0746065237801985, 1.003676138246904, 1.1180584815033285, 1.0207296849087895, 1.0283822138126775, 1.0095607235142119, 1.208185053380783, 1.1176470588235294, 1.0, 1.5, 1.0209267563527653, 1.8571428571428572, 1.076027858326429, 1.0511747594540166, 1.0716786438179473, 1.0487931932627192, 1.0557810548563742, 1.0954242558862728, 1.08125, 1.013986013986014, 1.021397846516343, 1.0224526078184615, 1.0058574630712125, 1.0359313011600462, 1.5555555555555556, 1.1326530612244898, 1.280130293159609, 1.014014658337844, 1.03125, 1.0229324665944384, 1.2023988005997002, 1.0097087378640777, 1.0586636612461762, 1.0301624129930393, 1.013777233196856, 1.4705882352941178, 1.0147234634681719, 1.005258145986006, 1.141947565543071, 1.0092165898617511, 1.0833333333333333, 1.2277676950998184, 1.0200878334417698, 1.0831802238182728, 1.0807560137457044, 1.002738232354364, 1.054054054054054, 1.1108507147879072, 1.17665418227216, 1.2215108834827144, 1.155002891844997, 1.099644128113879, 1.1669776119402986, 1.0882079851439184, 1.0399862157007866, 1.030389363722697, 1.1068740685543965, 1.041556006873926, 1.0, 1.0638445523941706, 1.1480384900074019, 1.0182511858115075, 1.0268481059212946, 1.3949313621964097, 1.257085020242915, 1.1957345971563982, 1.043312101910828, 1.025185856483441, 1.2727272727272727, 1.0431952662721893, 1.0192109890839112, 1.0163798465685259, 1.5357142857142858, 1.0003278004589207, 1.0573267084792701, 1.0680592991913747, 1.0224719101123596, 1.0021857923497268, 1.1161120152646051, 1.0198170731707317, 1.3925233644859814, 1.0352870813397128, 1.0088928458129944, 1.0515463917525774, 2.0, 1.0289237529123074, 1.0021509355413187, 1.0115606936416186, 1.2261904761904763, 1.0008960573476702, 1.0545194738577657, 1.0300120048019208, 1.0407292474786656, 1.1612903225806452, 1.125984251968504, 1.3, 1.0812182741116751, 1.5, 1.0474384892723054, 1.0173267326732673, 1.0360360360360361, 1.2093023255813953, 1.119904076738609, 1.086181993259509, 1.1, 1.2222222222222223, 1.0253555967841683, 1.1953488372093024, 1.0477568740955137, 1.6, 1.0453234956753572, 1.1863636363636363, 1.199022346368715, 1.1140350877192982, 1.3333333333333333, 1.1044386422976502, 1.0745717888003936, 1.0052785923753667, 1.1, 1.3529411764705883, 1.1875, 1.105263157894737, 1.3333333333333333, 1.6538461538461537, 1.0862944162436547, 1.0126531347247936, 1.0060752358703327, 1.0733333333333333, 1.0592899785808687, 1.0019156128709152, 6.0, 1.006528151296955, 1.1868131868131868, 1.0, 1.1428571428571428, 1.054100790513834, 1.1198681450404555, 1.078318399459599, 1.0073349633251834, 1.0, 1.1423487544483986, 1.0919220055710306, 1.0454545454545454, 1.0075716003329531, 1.0329996700033, 1.0067757298568627, 1.1754860940191976, 1.2, 1.0136369861673613, 1.0677419354838709, 1.15, 1.1149425287356323, 1.0746791131855309, 2.0, 1.4545454545454546, 1.0748035315804794, 1.0078213925656119, 1.0901639344262295, 1.0272108843537415, 1.0005858769198956, 1.2425992779783392, 1.1092150170648465, 1.2794117647058822, 1.0412110180458185, 1.073320201356971, 1.0556407225444202, 1.7130434782608697, 1.316326530612245, 1.0384615384615385, 1.1111111111111112, 1.0264304385710137, 1.0, 1.0001676780778175, 1.0727272727272728, 2.0, 1.081275720164609, 1.0397381369360355, 1.0593220338983051, 1.306568144499179, 1.0303098417425876, 1.0688697584004443, 1.0847037776095783, 1.0651769087523277, 1.0178571428571428, 1.0015015015015014, 1.0207851798585785, 1.1222986247544204, 1.0028943560057888, 3.0, 1.021978021978022, 1.0580115746739225, 1.2097701149425288, 1.041411312688556, 1.0060422167054157, 1.1115702479338843, 1.5, 1.0469667318982387, 1.0361998688823646, 1.062811183454615, 1.0605095541401275, 1.0184864269009042, 1.156441717791411, 1.3408521303258145, 1.0942940038684719, 1.0042245735944408, 1.0066810582062353, 1.079611650485437, 1.1118143459915613, 1.054054054054054, 1.0519592364001722, 1.1058519793459554, 1.0889957754364534, 1.0238198354265915, 1.0596352883193692, 1.058360655737705, 1.1875, 1.0827338129496402, 3.0, 1.3333333333333333, 1.7142857142857142, 1.0637362637362637, 1.1511780104712042, 1.0957223218149224, 1.045464199877033, 1.1282805429864253, 1.0251924422673198, 1.125, 1.2258064516129032, 1.002301947576512, 1.5, 1.4285714285714286, 1.0411332062108418, 1.2, 1.105721393034826, 1.1031648170982327, 1.0954478707782673, 1.0346783978525964, 1.2, 1.082871396895787, 1.0659898477157361, 1.018485130287905, 1.0, 1.011764705882353, 1.0537795040334628, 1.024369566301511, 1.0772874474358354, 1.0655307994757537, 1.7, 1.2670588235294118, 1.0, 2.0, 1.0007934822695828, 1.75, 1.4444444444444444, 1.2916666666666667, 1.0653728294177733, 1.0010667982500339, 1.092739475289811, 1.007380073800738, 1.0, 1.0244194229415904, 1.032258064516129, 1.072289156626506, 1.1078224101479917]
origin-bjaq_15.87 	max: 6.0000	99th: 3.0000	95th: 1.6679	median: 1.0648	mean: 1.1642

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 20.806752 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=39.303766