Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='naru', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 55, 'naru': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.6000	median: 1.0552	mean: 1.1491
ReportEsts: [1.0899653979238755, 1.0164107993647433, 1.0513643415569007, 1.0153846153846153, 1.0714285714285714, 1.0, 1.1848514369215781, 1.0021642601941574, 1.25, 1.0345285524568393, 1.034686751507806, 1.002344406791413, 1.0764014466546112, 1.041860465116279, 1.02331331684917, 1.0, 1.4754098360655739, 1.0170031880977684, 3.0, 2.6666666666666665, 1.2272727272727273, 1.117877938322191, 1.0325193275248497, 1.103694102397926, 1.0498273310310804, 1.0, 1.0752626808553494, 1.0, 1.4, 1.20863309352518, 1.0, 1.0009132381479868, 1.0118811820284435, 1.3768035516093229, 1.0229867788461537, 1.021934872385079, 1.0190735694822888, 1.0068454636579225, 1.036779392520146, 1.2142857142857142, 1.1079545454545454, 1.0152439024390243, 1.0, 1.1286428369329435, 1.0464291223199136, 1.2231404958677685, 1.145631067961165, 1.2922374429223744, 1.03002332681411, 1.0909090909090908, 1.0283057502830575, 1.0878504672897196, 1.0034902991734227, 1.0, 1.2675324675324675, 1.0246024790284212, 1.0284218399401646, 1.0606060606060606, 1.173913043478261, 1.6666666666666667, 1.0261041439476555, 1.0404732254047322, 1.0454545454545454, 1.160919540229885, 1.1, 1.0341628880966391, 1.0791633571617687, 1.1666666666666667, 1.0, 1.0681071393010058, 1.0214797136038185, 1.059675550405562, 1.1058558558558558, 1.1042953463152436, 1.1905882352941177, 1.1612903225806452, 1.0, 1.0458515283842795, 2.0, 1.0482079830124251, 1.1875, 1.0172616962323642, 1.1840490797546013, 1.0309633027522935, 1.0620114643043252, 1.08, 1.0000903456625048, 1.0369356050507743, 1.196078431372549, 2.3333333333333335, 1.0925024342745862, 1.0228808724141378, 1.0, 1.3183730715287518, 1.218020022246941, 1.0784313725490196, 1.2272727272727273, 1.0034129692832765, 1.0, 1.0000892299455697, 1.164722822174226, 1.0174520069808028, 1.0025053812766858, 1.088235294117647, 1.0031522571737492, 1.073525220860644, 1.0539342445511637, 1.0485400075843763, 1.017467248908297, 1.0, 1.0, 1.151466236211999, 1.0173701914828353, 1.0710419485791611, 1.1, 1.002885831517318, 1.0, 1.32125, 1.1626794258373205, 1.0, 1.2032967032967032, 1.1666666666666667, 1.0526315789473684, 1.0127977022146604, 1.0986254562398075, 1.0769230769230769, 1.8, 1.2582781456953642, 1.0, 1.0357142857142858, 1.0116449070145486, 1.1818181818181819, 1.0947265625, 1.0035735145421316, 1.011669799498747, 1.1400304414003044, 1.0579710144927537, 1.00234375, 1.00199203187251, 1.0478927203065134, 1.0539118412491868, 1.1790123456790123, 1.0782778864970646, 1.0419725846743004, 2.0, 1.0157407407407408, 1.0391923990498813, 1.0496277915632755, 1.011822833950944, 1.0, 1.0082344393315572, 1.0340740740740741, 1.02, 1.4476190476190476, 1.1751824817518248, 1.0797233345467783, 1.0440818584070797, 1.0152854179817838, 1.150190114068441, 1.1480263157894737, 1.0, 1.144927536231884, 1.122314049586777, 1.2857142857142858, 1.0299044992783262, 1.031376525936149, 1.0287852619458837, 1.0221881614480695, 1.0500916310323762, 1.0286501815483289, 1.0508849557522124, 1.0630252100840336, 1.2245569865401376, 1.155373831775701, 1.1826530612244899, 1.0820189274447949, 1.0495867768595042, 1.042445781672792, 1.0102639063219943, 1.1666666666666667, 1.0956521739130434, 1.0920018492834027, 1.0478378942970545, 1.1185719570847208, 1.1014492753623188, 1.0353075557264513, 1.0019219680953295, 1.020316675131948, 1.0, 1.0140909090909092, 1.00334813723911, 1.0, 2.0, 1.1007906894100925, 1.2690124858115777, 1.1021341463414633, 1.3461538461538463, 1.0405144694533761, 1.0019679678548123, 1.021007730295527, 1.1798245614035088, 1.1716032465479076, 1.0056818181818181, 1.078125, 1.0119047619047619, 1.0, 1.0596026490066226, 1.0228670556694528, 1.6864111498257839, 1.103448275862069, 1.0202669303015324, 1.0957683741648108, 1.0831539489311164, 1.0363167240039952, 1.0448788725076315, 1.2307692307692308, 1.1233766233766234, 1.0432724814063556, 1.0071884175356889, 1.062757326966648, 1.0, 1.0923395445134576, 1.0195182478876568, 1.0068449681280205, 1.070857142857143, 1.0364348413234301, 1.007570631026899, 1.0344827586206897, 1.0048424188063563, 1.0407944176060118, 1.1866892272983645, 1.1228070175438596, 1.0288321924911843, 1.0170212765957447, 1.1244094488188976, 1.0, 1.0205576559546314, 1.07358195623046, 1.06437125748503, 1.2313432835820894, 1.0909090909090908, 2.6666666666666665, 1.0326761752343434, 1.1636363636363636, 1.1141927874477286, 2.0, 1.5, 1.2903225806451613, 1.0690866510538641, 1.4795918367346939, 1.0883977900552486, 1.1660516605166051, 1.0667808219178083, 1.011894647408666, 1.0041617467722266, 1.1228070175438596, 1.0, 1.0378028872315226, 1.1079319335803486, 1.096322241681261, 1.0224858394784653, 1.0552902930868087, 1.0181514569591716, 1.1017488076311606, 1.0220939034910128, 1.0675837320574162, 1.1720149861540967, 1.2512292562999385, 1.4545454545454546, 1.0780319046703826, 1.1300639658848615, 1.25, 1.1363636363636365, 1.1570909090909092, 1.1111111111111112, 1.1037735849056605, 1.0107529775923558, 1.075208913649025, 1.1981981981981982, 1.015560981666184, 1.099630996309963, 1.0111276980159167, 1.017541346322207, 1.5, 1.1214077846489632, 1.0, 1.007052309740948, 1.0109170305676856, 1.0003414756300226, 1.325, 1.25, 1.0, 1.5633802816901408, 1.0225863375958444, 1.0, 1.0266875981161696, 1.0158371040723981, 1.0364583333333333, 1.0006829390208107, 1.1454545454545455, 1.0125786163522013, 1.0113117001828154, 1.0453799581282182, 1.0829327443592742, 1.1623931623931625, 1.0, 1.2541766109785202, 1.0049261083743843, 1.1090342679127725, 1.0805152246142642, 1.0620017714791852, 1.1378205128205128, 1.0727272727272728, 1.0164609053497942, 1.0078003120124805, 1.4285714285714286, 1.0164421260485257, 1.0586080586080586, 1.0, 1.0350502032203701, 1.1904761904761905, 1.75, 1.0212498705065782, 2.0, 1.0068587105624143, 1.0741279069767442, 1.0393765381460214, 1.0143721633888048, 1.227154046997389, 1.1978021978021978, 1.000582056418864, 1.0134936669831147, 1.0208623087621698, 1.0477061211102456, 1.1303869141239384, 2.0, 1.2222222222222223, 1.0223109989720587, 1.0, 1.0498357064622126, 1.0, 1.0, 1.0454545454545454, 1.1266968325791855, 1.078095238095238, 1.29, 1.077922077922078, 1.0, 1.0199733688415447, 1.02261919009316, 1.5, 1.2829064919594997, 1.0, 1.0088666211189554, 1.1125, 1.0908160587772238, 1.1682027649769586, 1.0018181818181817, 1.1509803921568627, 1.0925925925925926, 1.0165737111848054, 1.0076276152513668, 1.0266311584553929, 1.0, 1.1428571428571428, 1.8333333333333333, 1.5, 1.1428571428571428, 1.0022048519599398, 1.25, 1.0915141430948418, 1.0792079207920793, 1.061725579627518, 1.012826213956246, 1.0020639834881322, 1.0677041515137202, 1.0311004784688995, 1.2316715542521994, 1.5, 1.0104166666666667, 1.0170212765957447, 1.0011146237076967, 1.2380952380952381, 3.142857142857143, 1.042316258351893, 1.0168604651162791, 1.0000407917682212, 1.1428571428571428, 1.342769701606733, 1.0321942953967806, 1.3333333333333333, 1.0808477237048666, 1.0391949152542372, 1.25, 1.0584707646176912, 1.128440366972477, 1.0356571252693136, 1.0051691755055552, 1.000400671124133, 1.4098360655737705, 1.0471698113207548, 1.0654761904761905, 1.0, 1.0156587473002159, 1.0256246061792083, 1.0049847060156338, 1.0035776895281028, 1.0342321667622874, 1.0197666882696046, 1.8333333333333333, 1.216594307766522, 1.2, 1.0683176771989753, 1.1111111111111112, 1.0193439772280464, 1.055072463768116, 1.01268271711092, 1.1383399209486167, 1.1245487364620939, 3.0, 1.1182443498198493, 1.0038939292455702, 1.0231704735244995, 1.0, 1.3695652173913044, 1.0470249520153552, 1.2586206896551724, 1.096816433423357, 1.0548245614035088, 1.1666666666666667, 1.1406384814495254, 1.113819618108304, 1.0885931842783023, 1.012453026129353, 1.1875, 1.175787728026534, 1.0757575757575757, 1.25, 1.0203045685279188, 1.3448275862068966, 1.043656207366985, 1.1785714285714286, 1.029864330010371, 1.1363636363636365, 1.0954798309876281, 1.060643068061682, 1.142353770260747, 1.0, 1.1176470588235294, 1.28, 1.0031518736137592, 1.3282275711159737, 1.0, 1.0549875656258636, 1.0170722674217172, 1.2317508933129147, 1.0, 2.0, 1.185631067961165, 1.0017921146953406, 1.4386792452830188, 1.0, 1.0203674384853882, 1.0495540138751238, 1.0869565217391304, 1.0500188323917137, 1.0272727272727273, 1.020997375328084, 1.1758064516129032, 1.0119199659429545, 1.1152057861201998, 1.0, 1.054054054054054, 1.103608742100784, 1.0209457683207819, 1.0559805582653043, 1.0, 1.0307797537619698, 1.0259824694967896, 1.029334730225249, 2.0, 1.1008771929824561, 1.0537168683207006, 1.0495952042519003, 1.1628587654536717, 1.0227834703098873, 1.1686046511627908, 1.0563025210084034, 1.0400192864030857, 2.0, 1.0594345961031577, 1.15625, 1.0, 1.269736842105263, 1.1304347826086956, 1.0482023502686646, 1.02081526452732, 1.0338226580270276, 1.2750146284376829, 1.0869198621599825, 1.0121736778033275, 1.0145173780875434, 1.2135922330097086, 4.0, 1.0451038290721402, 1.006519967400163, 1.0034037572024412, 1.0186503102790114, 1.0794085432639648, 1.1270758122743683, 1.0295566502463054, 1.4285714285714286, 1.0113261436942926, 1.0335699085267345, 1.0056005323278252, 1.1172590692561377, 1.0321168246386547, 1.0125260960334028, 1.0013612718168117, 1.0372168284789645, 1.056527590847914, 2.0, 1.0, 1.0383435582822085, 1.064030131826742, 1.0205479452054795, 1.0408415841584158, 1.1697247706422018, 1.3916083916083917, 1.0554699537750385, 1.1318681318681318, 1.004485353040691, 1.4675324675324675, 1.015241995997999, 1.0, 1.0280649926144756, 1.4841269841269842, 1.0681818181818181, 1.0379820237750073, 1.188556566970091, 1.007905138339921, 1.0026007802340702, 1.0588549582066868, 1.0, 1.7659574468085106, 2.1666666666666665, 1.0, 1.0602409638554218, 1.0376569037656904, 1.3787234042553191, 1.1135135135135135, 1.024991989746876, 1.0925221799746514, 1.050073743659844, 1.0257345691185171, 1.0953545232273838, 1.0357451016510417, 1.0335195530726258, 1.1038536903984324, 1.1185292694726656, 1.0750798722044728, 1.0130057803468209, 1.0323711896412193, 1.010653008962868, 1.0258590821758165, 1.0109410223423465, 2.0, 1.2014742014742015, 1.043438077634011, 1.027027027027027, 1.0, 1.1333333333333333, 1.1538461538461537, 1.1577868852459017, 1.5925925925925926, 1.5, 1.0176748837933776, 1.0439310467389373, 1.0051346387645825, 1.0249091049740853, 1.0756756756756756, 1.0437424058323208, 2.0, 1.1407407407407408, 1.1086557577611256, 1.0336477080845106, 1.0080988332189431, 1.0239207198997609, 1.002681923833363, 1.1159420289855073, 1.029798086326245, 1.1847246891651866, 1.0346491584210098, 1.0252922683032437, 1.4242424242424243, 1.1129568106312293, 1.0, 1.0113378684807257, 1.0237282824414191, 3.0, 1.090519877675841, 1.0027521345295367, 1.1428571428571428, 1.117102615694165, 1.1, 1.1875, 1.015658640226629, 1.7692307692307692, 1.0283045091427674, 1.0132422041862452, 1.1875, 1.3181818181818181, 1.1975308641975309, 1.0067404910929225, 1.1232333250681874, 1.0318930680758471, 1.008650288786564, 1.0, 1.1975885292200739, 1.0152439024390243, 2.0, 1.0580990382175888, 1.0020849554459728, 1.0804162724692525, 1.0109726697158823, 1.072799653147294, 1.4125, 2.0, 1.0395413206801107, 1.0341951626355297, 1.0021040842991193, 1.0937291527685122, 1.0554092294924182, 1.1455862872464369, 1.1465201465201464, 1.039041360649401, 1.1325757575757576, 1.0000166903112744, 1.0820189274447949, 1.0952380952380953, 1.069327731092437, 1.0510698726321233, 4.0, 1.010919148489933, 1.0259639566207095, 1.040433299811989, 1.1176470588235294, 1.0213164838216915, 1.272300469483568, 1.0, 1.0091828018223234, 1.0134426229508198, 1.1009615384615385, 1.1764705882352942, 1.6666666666666667, 1.0261964029029205, 1.5, 1.3587301587301588, 1.0769230769230769, 1.1256367315609517, 1.2857142857142858, 1.2091836734693877, 1.10167714884696, 1.0, 1.1706349206349207, 1.0415531335149864, 2.0, 1.0, 1.0901639344262295, 1.039426523297491, 1.0448870392390013, 1.0095338983050848, 1.064891846921797, 1.0029498525073746, 1.089150378938971, 1.0415584415584416, 1.5605095541401275, 1.384180790960452, 1.3846153846153846, 1.0, 1.155813953488372, 1.2380952380952381, 1.0308839190628327, 1.2616993464052288, 1.0189156082013224, 1.2109981469424551, 1.0411170070850502, 1.0749562852146881, 1.0240673886883274, 1.0011933174224343, 1.5714285714285714, 1.0, 1.0303030303030303, 1.0245943066862613, 1.1839080459770115, 1.0065359477124183, 1.264797507788162, 1.0158839251622758, 1.0589768654284784, 1.0008901706261986, 1.064102564102564, 1.1, 1.0584752035529237, 1.0676033934252387, 1.0484453504984188, 1.0471060944500985, 1.2236842105263157, 1.1227849970466628, 1.0059342201610935, 1.1, 1.0035769034236075, 1.3333333333333333, 1.0443187175860442, 1.1254752851711027, 1.0192307692307692, 1.1877022653721683, 1.0347890451517394, 1.0, 1.0656934306569343, 1.001084721615102, 1.3148148148148149, 1.0027145575112044, 1.1896186440677967, 1.0232558139534884, 1.0406111050533686, 1.0134443957328656, 1.0610059092130002, 1.0076923076923077, 1.0513126491646778, 1.0111587015329124, 1.161825726141079, 1.0714285714285714, 1.0, 1.0, 1.0086714303015623, 1.8333333333333333, 1.0152884572148029, 1.0449625760594474, 1.1805494018608773, 1.0834947277813642, 1.0078471721731215, 1.0860664523043944, 1.029520295202952, 1.0314735336194563, 1.0169535304200812, 1.0327146606674165, 1.0037389449464325, 1.034899663467531, 1.4285714285714286, 1.103448275862069, 1.3122529644268774, 1.0339772768001148, 1.0749185667752443, 1.0286271958360442, 1.1345132743362831, 1.0311890838206628, 1.0396983321687883, 1.0205479452054795, 1.0002033906416377, 1.375, 1.008442567011037, 1.0107227399890746, 1.0818763326226013, 1.0008428150021071, 1.0625, 1.0053821313240043, 1.0597014925373134, 1.8125, 1.0360776088096486, 1.3846153846153846, 1.0689655172413792, 1.0593406593406594, 1.1645313553607552, 1.019745879120879, 1.0658823529411765, 1.4545454545454546, 1.0821256038647342, 1.0045589911393802, 1.0131149386468536, 1.00113934216998, 1.0764352469959946, 1.0452816317458689, 1.0769230769230769, 1.0402298850574712, 1.063356875778978, 1.1323273360417876, 1.0225409836065573, 1.1875, 1.1289449954914337, 1.0353342965979246, 1.1809605488850772, 1.0110605419136325, 1.0, 1.3333333333333333, 1.0004649989364387, 1.0221487127858477, 1.018901890189019, 1.0694959265793178, 1.0215482841181165, 1.1056511056511056, 1.0059493708540321, 1.0992042440318301, 1.0128676470588236, 1.2540540540540541, 1.0091036414565826, 1.0053665938783818, 1.0, 1.75, 1.0278533475026568, 1.0106344275599586, 1.0108323831242874, 1.3037037037037038, 1.053584359160029, 1.0175325640136694, 1.0262550490478939, 1.075268817204301, 1.3461538461538463, 1.103099730458221, 1.0021097046413503, 1.11875, 1.6538461538461537, 1.0443624986031959, 1.0138751238850348, 1.0855085508550855, 1.2058823529411764, 1.0462166048082389, 1.0973861720067453, 1.0144976742606866, 1.026044761338879, 1.6666666666666667, 1.037037037037037, 2.0, 1.0383363471971068, 1.4615384615384615, 1.3333333333333333, 1.5, 1.2377049180327868, 1.0543478260869565, 1.0930337586090098, 1.0108013264222016, 1.2761020881670533, 1.6470588235294117, 1.0, 1.0, 1.2972972972972974, 1.4583333333333333, 1.014018691588785, 1.0059096465693658, 1.002712245285195, 1.0546875, 1.0274443828946198, 1.001556478654722, 5.0, 1.0071705624170664, 1.0771428571428572, 1.0, 1.3333333333333333, 1.0618343195266273, 1.1099476439790577, 1.0519132516345708, 1.0031055900621118, 1.0, 1.2463768115942029, 1.1993865030674846, 2.0, 1.5, 1.126722440944882, 1.1220211161387632, 1.1672987164527422, 1.25, 1.0150595126145248, 1.0712625871417505, 1.0632497273718649, 1.1428571428571428, 1.1576086956521738, 1.0037882098271609, 1.6578947368421053, 1.101740534720976, 1.0435125781708527, 1.0141176470588236, 1.05078125, 1.0073958954861448, 1.1964133219470539, 1.0702479338842976, 1.2545454545454546, 1.050367460173865, 1.1468649179408053, 1.062564409427878, 1.403361344537815, 1.2289156626506024, 1.1791044776119404, 1.0348387096774194, 1.0344617261360172, 1.0071170799867308, 1.0177377711562312, 1.0491266375545851, 3.0, 1.25, 1.0209169521944852, 1.1165347405452946, 1.2676522077416845, 1.0214363615850373, 1.047844374342797, 1.1008790288823775, 1.1635883905013193, 1.0212765957446808, 1.0423631596197969, 1.0017977851287214, 1.084855627578079, 1.0577933450087567, 2.5, 1.04, 1.025569536666789, 1.1244922341696535, 1.0034122747976897, 1.00537901161646, 1.1036931818181819, 1.6, 1.010625737898465, 1.0478760284736988, 1.042266392506283, 1.1368821292775666, 1.0215276784437133, 1.1804511278195489, 1.336283185840708, 1.111304347826087, 1.0023498343112185, 1.0466079295154185, 1.118663594470046, 1.1075544174135723, 1.03125, 1.0064080656185919, 1.0104145017896318, 1.084544253632761, 1.0621267655488187, 1.032165422171166, 1.046714172604909, 1.3846153846153846, 1.0382165605095541, 2.5, 1.5, 1.3076923076923077, 1.0358056265984654, 1.1682464454976302, 1.00809536187753, 1.0318546109306594, 1.0531886024423338, 1.0339606316244863, 1.059782608695652, 1.7551020408163265, 1.028601733132265, 1.6, 1.25, 1.0507317073170732, 1.0, 1.1977671451355663, 1.1279127416955874, 1.0562642802741813, 1.0201262761519858, 1.25, 1.0089783281733746, 1.310077519379845, 1.1932668329177056, 1.000752880686774, 1.0232558139534884, 1.0560578661844484, 1.037161957465716, 1.0879185202528683, 1.0874403815580287, 1.5106382978723405, 1.2877094972067038, 1.0, 1.0, 1.0005856371374415, 1.6666666666666667, 1.5714285714285714, 1.255813953488372, 1.0533672172808133, 1.1058823529411765, 1.030857142857143, 1.0832979175520612, 1.0, 1.1464928615766605, 1.023311416616856, 1.15695067264574, 1.0452261306532664, 1.1111111111111112, 1.0169720130381028, 1.057649667405765, 1.0957446808510638, 1.0587579025660097, 1.0141547317386588, 1.169093766369827, 1.0208333333333333, 1.0, 1.047832254632503, 1.0247638351388109, 1.045642037302726, 1.2695652173913043, 1.0179034388299173]
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.6000	median: 1.0552	mean: 1.1491

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 17.011153 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=naru', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[4.8875809e-06 6.4373016e-06 6.5565109e-07 1.4901161e-06 5.3644180e-07]
Distance score: 2.8014183044433594e-06
SAUCE Drift detection: False
Detection latency: 0.0233s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 2.035585 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 5.0000	99th: 3.0000	95th: 1.6667	median: 1.0649	mean: 1.1646
ReportEsts: [1.1164179104477612, 1.0452272727272727, 1.0453695483822223, 1.0064, 1.0857142857142856, 1.0, 1.137378640776699, 1.0337118469100042, 1.4, 1.0154696132596686, 1.006238558627999, 1.001661777668598, 1.0546528803545052, 1.0327552986512525, 1.0589280426413976, 1.3636363636363635, 1.070063694267516, 2.0, 1.6666666666666667, 1.0951492537313432, 1.0628782439224536, 1.0222257134407806, 1.1102514506769825, 1.0586176727909011, 1.041904693036373, 1.008843352784186, 3.0, 1.0241314028211077, 1.0, 1.8, 1.0613786591123702, 1.0, 1.0011063233071316, 1.0158128690929122, 1.3858670385867038, 1.1136890951276102, 1.021582937316135, 1.072289156626506, 2.3333333333333335, 1.060485347985348, 1.0042502078906033, 1.0134752952919648, 1.008714596949891, 1.0334712297856337, 1.0457038391224862, 1.1044881031877132, 1.1304347826086956, 1.027332361516035, 1.3988439306358382, 1.1391634980988594, 1.5833333333333333, 1.1875, 1.0360360360360361, 1.064516129032258, 1.0465194069791057, 1.0368582532215176, 1.012404181184669, 1.1076233183856503, 1.1566265060240963, 1.0093513961942902, 1.096774193548387, 1.0410042842849692, 1.0911722141823443, 1.092, 1.108910891089109, 2.0, 1.146509880966139, 1.0361216730038023, 1.1428571428571428, 2.0, 1.0839219643457787, 1.002967359050445, 1.0477568740955137, 1.123134328358209, 1.0376084148366858, 1.077662129703763, 1.0556374494462712, 1.0, 1.1063829787234043, 1.018371483292735, 1.1306256860592756, 1.105263157894737, 1.0, 4.0, 1.0290023201856149, 1.1475409836065573, 1.018450184501845, 1.1071428571428572, 1.2, 1.0400917298779608, 1.0874816386486046, 1.0589806365457377, 1.0837445251427622, 1.170617149098853, 1.096774193548387, 1.3271676300578035, 1.4656084656084656, 1.1716129032258065, 1.0, 1.1233094669848847, 1.3333333333333333, 3.0, 1.0382267738020359, 1.0617021276595744, 1.0410557184750733, 1.0302174441205054, 1.0465116279069768, 1.0004607498704141, 1.16156202143951, 1.0170031137389357, 1.0182907600126143, 1.0200991908117985, 1.3333333333333333, 2.0, 1.1492070582979674, 1.0163361653898269, 1.0873015873015872, 1.032258064516129, 1.008635210653561, 1.0, 1.2379110251450678, 1.1392712550607287, 1.0, 1.280373831775701, 1.0, 1.0712742980561556, 1.0201509182678283, 1.098545101842871, 1.015748031496063, 2.2, 1.2412162162162161, 1.0, 2.25, 1.010166013803395, 1.3076923076923077, 1.0766509433962264, 1.0583504769029362, 1.0463095481496627, 1.0, 1.5714285714285714, 1.0308641975308641, 1.0328767123287672, 1.0626673808248528, 1.052000787684953, 1.2, 1.0586001085187196, 1.031796469149481, 1.0, 1.0227272727272727, 1.007729468599034, 1.0383403361344539, 1.0395864106351551, 1.3333333333333333, 1.0733160060645441, 1.0472636815920398, 1.023372287145242, 1.0574162679425838, 1.0, 1.1008064516129032, 1.060492033627855, 1.0024887816282666, 1.1344262295081968, 1.14010989010989, 1.0727272727272728, 1.3227848101265822, 1.1418732782369145, 1.25, 1.0048494939577322, 1.3, 1.063197026022305, 1.0011877172653534, 1.0125333333333333, 1.06405031892275, 1.0539568345323742, 1.1284246575342465, 1.2167758634635606, 1.138959390862944, 1.1356209150326797, 1.0427135678391959, 1.0294500912170967, 1.1232951445717403, 1.0044748449785847, 1.0748299319727892, 1.3535353535353536, 1.0130834561013795, 1.0263782103713397, 1.032258064516129, 1.039751273599041, 1.1307901907356948, 1.3333333333333333, 1.0515970515970516, 1.0287074159037797, 1.1785714285714286, 1.0269989615784008, 1.0707862625264934, 1.0050736961451248, 1.0264559985302224, 1.042051282051282, 1.0857374757631781, 1.0295262639803324, 1.0770593445527015, 1.0361716991383993, 1.0714285714285714, 1.0297719383317554, 1.1906005221932114, 1.1523784401653039, 1.1691542288557213, 1.0266666666666666, 1.1630434782608696, 1.0, 1.0494505494505495, 1.1058874899934503, 1.6405797101449275, 1.174757281553398, 1.038542103058232, 1.6666666666666667, 1.0, 1.075, 1.0433770982217052, 1.5, 1.0535031847133758, 1.0218413049488526, 1.005032021957914, 1.0283019795651447, 2.0, 1.1169451073985681, 1.0682665615401041, 1.0072513996267662, 1.0362116991643453, 1.2651006711409396, 1.027639579878386, 1.071580393054511, 1.0, 1.0031344823330237, 1.0226724120325934, 1.129692832764505, 1.2540494458653026, 1.044496487119438, 3.0, 1.1081258191349934, 1.0, 1.073782691898788, 1.0265803928870683, 1.0707154742096505, 1.3300970873786409, 1.1538461538461537, 3.3333333333333335, 1.0439934303144063, 1.1343283582089552, 1.0626897863041689, 1.5, 1.0150693188667872, 1.0255102040816326, 1.4285714285714286, 1.001465975188764, 1.0952380952380953, 1.1112185686653773, 1.0681818181818181, 1.0318767908309456, 1.0469615585377763, 1.0140845070422535, 1.0, 1.0284413205087553, 1.0566296762384166, 1.1227810650887573, 1.046570456241242, 1.0834005176730173, 1.0465069831804499, 1.1262660364618502, 1.0317667600839289, 1.0612951062778053, 1.137844611528822, 1.2507676560900716, 1.7272727272727273, 1.05235150871356, 1.0994764397905759, 1.3958333333333333, 1.0, 1.0650842266462481, 1.1031833150384194, 1.021980852616666, 1.0152468280200448, 1.2528473804100229, 1.225063938618926, 1.0166882704032094, 1.1041666666666667, 1.0166543549795177, 1.009933394071807, 1.7, 1.0759493670886076, 1.0262008733624455, 1.0072227768788515, 1.061034245903248, 1.0341628005061156, 1.0616509926854754, 1.0117713004484306, 1.0454772613693153, 1.043407506986946, 1.0217965414948267, 1.0768317335557471, 1.078895463510848, 2.5, 1.0769230769230769, 1.0728178749397204, 3.0, 1.0329067641681902, 1.0046768186881614, 1.0074911122397157, 1.2285714285714286, 1.3644067796610169, 1.6687306501547987, 1.0837805089146615, 1.002432693392855, 1.0, 1.049864898059445, 1.0030047583550343, 1.0492957746478873, 1.5, 2.090909090909091, 1.091166077738516, 1.0909090909090908, 1.0255999843205403, 1.0570987654320987, 1.0869565217391304, 1.0083517139968752, 1.2608695652173914, 1.5, 1.0403899925339266, 2.0, 1.1513513513513514, 1.0542822677925212, 1.0703560703560704, 1.0975761342448727, 1.255863539445629, 1.0625, 1.0235164141414141, 1.0508500940040306, 1.010204081632653, 1.0103183860525788, 1.2110923660902573, 3.0, 1.0909090909090908, 1.042221760674124, 1.0, 1.0593065693430657, 1.0526315789473684, 1.25, 1.0769230769230769, 1.1619786614936953, 1.0820063694267517, 1.3392857142857142, 1.1358024691358024, 1.2, 2.5, 1.0431507130258821, 3.0, 1.0666666666666667, 1.0363650163179599, 1.1913357400722022, 1.0751211631663975, 1.004655493482309, 1.2857142857142858, 1.5, 1.0869858395144976, 1.1454545454545455, 1.0385756676557865, 1.0140279931274359, 1.0639930684490655, 1.0639386189258313, 1.5, 1.0052905101291774, 1.2075471698113207, 1.5, 1.0, 1.01840490797546, 1.4285714285714286, 1.0260303687635575, 1.0683760683760684, 1.0465500444745648, 1.0293698773469744, 1.0202702702702702, 1.0490104709171646, 1.042973124300112, 1.1174603174603175, 1.033921302578019, 1.0909073630592618, 1.0566318926974665, 1.088235294117647, 1.013482190222664, 1.0001518602885346, 1.1437189054726369, 1.0297029702970297, 1.1162790697674418, 1.0053475935828877, 3.0, 1.7777777777777777, 1.3009708737864079, 1.0018552875695732, 1.1555555555555554, 1.0212765957446808, 1.0337804272230502, 1.253125, 1.3073496659242763, 1.120274914089347, 1.0017803839568464, 1.3461538461538463, 1.0846153846153845, 1.1294416243654823, 1.0, 1.001480378177591, 1.3103448275862069, 1.0050278801625556, 1.043968432919955, 1.012149983907306, 1.01647312989468, 1.7142857142857142, 1.1188314251875247, 1.1666666666666667, 1.1312335958005248, 1.3636363636363635, 1.0436128199286094, 1.0036407766990292, 1.0441229010360844, 1.1291390728476822, 1.1304675716440422, 3.0, 1.0511699665723837, 1.0011095328841284, 1.0203134291139968, 1.0, 1.2380952380952381, 1.0173638516179953, 1.4261083743842364, 1.069449048597759, 1.008457600712219, 1.0, 1.1956363636363636, 1.0900323422826637, 1.0573007471980074, 1.0554534443475094, 1.0847498118661683, 1.076801890508074, 1.0287769784172662, 1.264904386951631, 1.0376869309107501, 1.0151515151515151, 1.4063684609552691, 1.0, 2.0, 1.2774834437086093, 1.069767441860465, 1.1896551724137931, 1.0815396067241487, 1.132622853759621, 1.0, 1.0714285714285714, 1.3703703703703705, 1.1239669421487604, 1.1666666666666667, 1.0, 1.0167450058754406, 1.6666666666666667, 1.0, 1.124205013093902, 2.0, 1.1974543080939948, 1.0015026296018033, 1.3703703703703705, 1.0, 1.0251259393839294, 1.067937033968517, 1.1071428571428572, 1.1150147696562127, 1.0225563909774436, 1.0011098779134295, 1.1566913248150639, 1.0728360309641098, 1.1787319498900257, 1.0, 1.0434782608695652, 1.1862172534623727, 1.0586832061068703, 1.0991735537190082, 1.2, 1.0807317558162657, 1.0119789157793908, 1.040636042402827, 2.0, 1.1249173826834105, 1.0772648194926333, 1.1121980544321783, 1.1760655737704917, 1.0353112268036986, 1.0252009380090579, 1.0286512928022362, 1.0363443640984944, 2.6666666666666665, 1.0850750789735601, 1.0918181818181818, 1.0406445406445406, 1.0799112097669257, 1.0712328767123287, 1.0401390678984934, 1.2227602905569008, 1.0378492087523308, 1.0421806605650616, 1.0130158218548257, 1.026309820821048, 1.006277306282328, 1.1849614978106597, 1.2048192771084338, 1.3866666666666667, 1.025988120459065, 1.1113490364025695, 1.0380055310643193, 1.0106672038527484, 1.3333333333333333, 1.0268735806207419, 1.1, 1.5, 1.02, 1.010385816325163, 1.047945205479452, 1.0869198312236288, 1.0, 1.155844155844156, 1.042573320719016, 1.0644517066085692, 1.0265622014141027, 1.0367698640653333, 1.0348583877995643, 1.028482972136223, 1.1119648737650933, 1.1205796243297477, 1.1756756756756757, 1.0451872052459423, 1.4067796610169492, 1.1261682242990654, 1.0132680588545082, 1.08203125, 1.0102355871516786, 1.0, 1.046816479400749, 1.34006734006734, 1.0510137344669719, 1.0122199592668024, 1.11088504577823, 1.0249584026622296, 1.0227606461086638, 1.0157097569566749, 1.0, 1.7924528301886793, 1.5, 1.25, 1.101010101010101, 1.1636363636363636, 1.3664921465968587, 1.1614349775784754, 1.0284455128205128, 1.0519409513395297, 1.0609579930489008, 1.007360197368421, 1.0020720297866441, 1.009958571740062, 1.0103229342712283, 1.1216141514648976, 1.04911838790932, 1.0015463055834168, 1.1482572410407461, 1.0110864745011086, 1.1428571428571428, 1.0903954802259888, 1.034983658152766, 1.2308641975308643, 1.0142198998823317, 1.0648148148148149, 1.2219282774838331, 1.0786233028102306, 1.25, 1.0773739742086752, 1.0714285714285714, 3.0, 1.1970149253731344, 1.009783828259406, 1.0169556840077072, 1.0816326530612246, 1.2037037037037037, 1.0255990819976317, 1.2063126287489963, 1.037593984962406, 1.0, 1.0344827586206897, 1.0288425454350507, 1.3364928909952607, 1.037174721189591, 1.020707921984108, 1.0, 1.0140121438580103, 1.106024096385542, 1.0291747059189644, 1.1568047337278107, 1.029433555600458, 1.0420411571140906, 1.017068393173706, 1.1604938271604939, 1.6666666666666667, 1.0453787120453788, 1.0, 1.1382428940568476, 1.1398305084745763, 1.2310344827586206, 1.0089748015188125, 1.3333333333333333, 1.0653888437455188, 1.1240875912408759, 1.2727272727272727, 1.0009407337723424, 1.0598568640208197, 1.0300707547169812, 1.0796873413866612, 1.039090909090909, 1.001299123091913, 1.2, 1.0013451708366963, 1.0810612927968761, 1.25, 1.0345762711864406, 1.090931392591381, 1.1129476584022038, 1.0673060393576115, 1.0, 1.0871212121212122, 1.1970845481049563, 1.2423529411764707, 1.2348484848484849, 1.0096697560812393, 1.3592233009708738, 2.4285714285714284, 1.0251272264631044, 1.0407303370786516, 1.027253045803795, 1.1218627997769102, 1.0273116821283779, 1.0072737932115807, 1.0644171779141105, 1.0231598984771573, 1.180952380952381, 1.0187251846079632, 1.0949632738719832, 1.1536480686695278, 1.1446623093681918, 1.0082207115786415, 1.2666666666666666, 1.1219645791491692, 1.1818181818181819, 1.3333333333333333, 1.0248447204968945, 1.0251200591060214, 1.0479023168440826, 1.1372549019607843, 1.3333333333333333, 1.0339652448657188, 1.078485370051635, 1.4862385321100917, 1.0141368064585665, 2.3333333333333335, 1.0428930185836263, 1.5, 1.3946666666666667, 1.3846153846153846, 1.1619761261653743, 1.3636363636363635, 1.3031674208144797, 1.1354895104895104, 1.0, 1.1666666666666667, 1.0011135857461024, 1.8, 1.0, 1.0466666666666666, 1.0492307692307692, 1.050610820244328, 1.0186832740213523, 1.0147058823529411, 1.027027027027027, 1.0743801652892562, 1.1701570680628273, 1.572192513368984, 1.1865079365079365, 1.3548387096774193, 1.0, 1.1674925668979188, 1.1503579952267302, 1.0286707211120765, 1.132688927943761, 1.0281445778313325, 1.220670273897907, 1.004466271312083, 1.0428880458977334, 1.0425963488843812, 1.0214785214785216, 1.1666666666666667, 1.0, 1.0769230769230769, 1.063547241870848, 1.1519524617996604, 1.0307262569832403, 1.2651515151515151, 1.0547919053073693, 1.0596759133405038, 1.000180412764076, 1.0777777777777777, 1.1304347826086956, 1.320916905444126, 1.1033473265576668, 1.068279621306302, 1.0683604096768498, 1.1967213114754098, 1.1227269925414536, 1.0776118906143373, 1.019963851203225, 1.0577211394302848, 1.0081414979725145, 1.1369863013698631, 1.01027788351732, 1.03125, 1.0019692491907295, 5.0, 1.25, 2.0, 1.149789029535865, 1.0453885309005795, 1.2903225806451613, 1.0391787958981145, 1.1929515418502203, 1.0, 1.0879844608334093, 1.0003906484764709, 1.1867852249531639, 1.0056089743589745, 1.012464046021093, 1.0068169530570508, 1.1569965870307166, 1.125, 1.0, 1.3333333333333333, 1.020208341745064, 2.1666666666666665, 1.0125758564960987, 1.0665933227059432, 1.1323855243722305, 1.065405692062931, 1.003619612636962, 1.0679067283730865, 1.088328075709779, 1.0435308343409915, 1.0299994915340418, 1.0587604192456879, 1.003335853222458, 1.0154756137980268, 1.3333333333333333, 1.0989583333333333, 1.263843648208469, 1.0101528033423905, 1.0026666666666666, 1.0101749375223135, 1.139402560455192, 1.034257748776509, 1.0513873431323637, 1.0148063781321184, 1.0657852755842705, 1.0869565217391304, 1.0217139718718737, 1.0170757958355756, 1.1032374100719424, 1.00814447592068, 1.0526315789473684, 1.0938144329896908, 1.3150800336983994, 1.0879884759049263, 1.0788381742738589, 1.0041357570869713, 1.0, 1.0306985562199213, 1.2908067542213884, 1.12875, 1.0784810126582278, 1.1056466302367942, 1.1475563909774436, 1.068024062933827, 1.03088813665447, 1.037463976945245, 1.0588053515596596, 1.003284836374088, 1.1333333333333333, 1.0224184782608696, 1.0360019727108334, 1.0511481674869185, 1.0083786231884058, 1.1660555264536407, 1.2284011916583912, 1.0929174788823912, 1.0207792207792208, 1.0074032727165898, 1.15625, 1.033411488862837, 1.0169300225733635, 1.0104230533415082, 1.4654377880184333, 1.011802400774695, 1.059570632579482, 1.0659195781147002, 1.0843373493975903, 1.0007391225793736, 1.1541693225937302, 1.0168195718654434, 1.2744186046511627, 1.0287253141831239, 1.002618657937807, 1.00990099009901, 2.0, 1.039721154449253, 1.0082985617380358, 1.0086413826212195, 1.251497005988024, 1.0151057401812689, 1.0012501953430224, 1.0193179108037205, 1.0562218890554722, 1.1875, 1.0967204002223458, 1.2962962962962963, 1.103896103896104, 1.5588235294117647, 1.0360284057593327, 1.0057660626029654, 1.007600434310532, 1.3076923076923077, 1.0063694267515924, 1.169927333705981, 1.030612244897959, 1.1428571428571428, 1.0297766749379653, 1.1061946902654867, 1.1495327102803738, 1.2727272727272727, 1.0460779446444086, 1.1772908366533865, 1.168294314381271, 1.1140350877192982, 1.069767441860465, 1.0996168582375478, 1.1956779006946232, 1.0003844114528102, 1.2730844793713163, 1.5903614457831325, 1.0555555555555556, 1.0857142857142856, 1.2934782608695652, 1.1081081081081081, 1.1141418380193033, 1.015130499857923, 1.0058419745874105, 1.018987341772152, 1.021968751246929, 1.0000583338194484, 3.0, 1.0054781355117732, 1.3170731707317074, 1.0, 1.1428571428571428, 1.0701583434835567, 1.085391377145249, 1.0606609415581185, 1.0304568527918783, 1.5, 1.0688524590163935, 1.2015306122448979, 1.0597014925373134, 1.0085616691996173, 1.0448155382541473, 1.002216441139736, 1.1240961045019828, 1.2222222222222223, 1.0014856050941343, 1.0805194805194804, 1.118042226487524, 1.0227272727272727, 1.0615563298490127, 1.0, 1.089962121212121, 1.0975755166931638, 1.0833333333333333, 1.0769230769230769, 1.043189368770764, 1.0167096737198233, 1.1973125884016973, 1.0409556313993173, 1.208955223880597, 1.0371511545544694, 1.2516109235961952, 1.0353695666256397, 1.864864864864865, 1.28125, 1.036697247706422, 1.1, 1.047535724701079, 1.0073170731707317, 1.0073020982355747, 1.016289592760181, 2.0, 1.0338504936530324, 1.0205274994888571, 1.0684382963232617, 1.3685230024213075, 1.0751529987760098, 1.0033486814566763, 1.0850450944754981, 1.1812227074235808, 1.1311475409836065, 1.0086905384213278, 1.0028163692878365, 1.0549828178694158, 1.096820809248555, 2.5, 1.1494252873563218, 1.0106660095747677, 1.2233576642335766, 1.0581546859784114, 1.0129033953537265, 1.1157957244655583, 2.2, 1.0089730807577268, 1.0175235174206578, 1.048291658713495, 1.013029315960912, 1.0133889551052842, 1.1789137380191694, 1.3216444981862152, 1.0924574209245743, 1.0023991857309034, 1.0051204819277109, 1.1135707410972089, 1.095596133190118, 1.0512820512820513, 1.0557814394749983, 1.0127183222064873, 1.0032606528343049, 1.0284028580746538, 1.0654527559055118, 1.060120240480962, 1.0223642172523961, 1.0910714285714285, 2.5, 1.0, 1.3125, 1.0166320166320166, 1.1231463571889104, 1.0079421932911825, 1.0510997256767327, 1.1070869662418958, 1.0694566555301566, 1.1612903225806452, 1.0251046025104602, 1.0230068595965576, 1.3333333333333333, 1.2857142857142858, 1.336962438758846, 1.1111111111111112, 1.1292346298619824, 1.1172161172161172, 1.0206374684705344, 1.0221609642722016, 1.4, 1.0959286112660345, 1.0737217598097504, 1.0875365289005274, 1.0010550821702582, 1.0222693531283138, 1.0525530008957897, 1.013829436944353, 1.0609233698238933, 1.163563829787234, 1.5614035087719298, 1.260321100917431, 1.3333333333333333, 2.0, 1.000271783645326, 1.75, 1.3333333333333333, 1.3043478260869565, 1.0233739837398375, 1.0237186477644493, 1.0525700934579438, 1.0511811023622046, 1.1666666666666667, 1.0123270440251573, 1.0280983442047165, 1.1183673469387756, 1.040169133192389]
origin-bjaq_15.87 	max: 5.0000	99th: 3.0000	95th: 1.6667	median: 1.0649	mean: 1.1646

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 20.859165 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=39.938267