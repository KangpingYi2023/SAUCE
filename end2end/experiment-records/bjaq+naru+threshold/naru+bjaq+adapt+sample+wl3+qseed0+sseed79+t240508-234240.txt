Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='naru', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 79, 'naru': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.6256	median: 1.0560	mean: 1.1521
ReportEsts: [1.1580882352941178, 1.0578512396694215, 1.0105110812233202, 1.0, 1.0714285714285714, 1.0, 1.1451100388372366, 1.0110722294560186, 1.25, 1.0345285524568393, 1.0230283092372954, 1.0026007464142208, 1.0720396217919856, 1.0209302325581395, 1.0187212998940305, 1.0, 1.3432835820895523, 1.0077931278781438, 3.0, 2.6666666666666665, 1.2857142857142858, 1.0901013586370498, 1.0580453699512098, 1.0577639751552794, 1.0054563492063493, 1.0, 1.0397649808478868, 2.0, 1.4, 1.2158273381294964, 1.0, 1.0029555940023067, 1.0128899906500664, 1.4517203107658159, 1.0230577177265383, 1.0209870692573286, 1.0026737967914439, 1.0158512007381686, 1.1500792065569254, 1.0238095238095237, 1.0077519379844961, 1.076219512195122, 1.0, 1.1244010147514798, 1.0501311121394417, 1.2148760330578512, 1.1553398058252426, 1.2304347826086957, 1.0175332627258886, 1.0, 1.0477102454771026, 1.185336048879837, 1.0072627669066838, 2.0, 1.212987012987013, 1.0353566451696536, 1.069090909090909, 1.064638783269962, 1.3229813664596273, 1.6666666666666667, 1.0085650672482733, 1.026774595267746, 1.0363636363636364, 1.0689655172413792, 1.1, 1.091343324910872, 1.0661783939314675, 1.1666666666666667, 1.0, 1.0748496993987975, 1.0190930787589498, 1.0572254335260116, 1.0968468468468469, 1.1220178212129923, 1.188235294117647, 1.148936170212766, 1.0, 1.0472234368167905, 2.0, 1.0443771700766162, 1.25, 1.0816335745165988, 1.177914110429448, 1.0573394495412844, 1.0658995815899581, 1.04, 1.0053419575534195, 1.0333417865207888, 1.1470588235294117, 2.3333333333333335, 1.1282051282051282, 1.0072348259818482, 1.0186915887850467, 1.329593267882188, 1.2443181818181819, 1.1095100864553313, 1.2272727272727273, 1.0025597269624573, 1.0, 1.0110058637798827, 1.084521238300936, 1.0069084628670122, 1.0082900448302854, 1.1470588235294117, 1.01091024500916, 1.0852780178622876, 1.0270492139720067, 1.0401971937808114, 1.0251414204902578, 1.0, 1.3333333333333333, 1.1242448121880746, 1.032851608272018, 1.0455746367239103, 1.0405405405405406, 1.0027492592438647, 1.0, 1.2252704791344669, 1.1263157894736842, 1.0, 1.2362637362637363, 1.1666666666666667, 1.0350877192982457, 1.0223340773309468, 1.090782014444358, 1.009009009009009, 1.8, 1.2483443708609272, 1.0, 1.3928571428571428, 1.0026888591262741, 1.1818181818181819, 1.0301810865191148, 1.0180873846772218, 1.0756529064869418, 1.2673434856175974, 1.022408963585434, 1.0058800470403764, 1.00199203187251, 1.0532734274711169, 1.0543103448275861, 1.2345679012345678, 1.0424005218525767, 1.0072567695117616, 2.0, 1.00966405890474, 1.0580411124546554, 1.0570719602977667, 1.0289394741485796, 1.0, 1.0099297650762897, 1.0148148148148148, 1.0, 1.4476190476190476, 1.0719874804381846, 1.0055941685031362, 1.0438509179385091, 1.213860582559293, 1.0760456273764258, 1.1217105263157894, 1.0208333333333333, 1.1521739130434783, 1.1260364842454396, 1.1428571428571428, 1.044923739122298, 1.0134274756193338, 1.0345443716497915, 1.0251811726813558, 1.0445937690897984, 1.053642893111765, 1.0063157894736843, 1.111344537815126, 1.1324682870146219, 1.062298603651987, 1.1463897131552918, 1.0923566878980893, 1.021342406433653, 1.0156206964391108, 1.0387499387385033, 1.1666666666666667, 1.5949367088607596, 1.0081092616303884, 1.0474002923366048, 1.036440991490936, 1.1515151515151516, 1.0466846861110797, 1.036133000192197, 1.013570547367054, 1.0943396226415094, 1.027557216254087, 1.03912619689238, 1.0, 1.6363636363636365, 1.0103971295767757, 1.2973893303064699, 1.0894023103967856, 1.25, 1.0057877813504823, 1.0203476571933592, 1.0027523634912878, 1.1798245614035088, 1.097712659428692, 1.0282485875706215, 1.03125, 1.0357142857142858, 1.0, 1.0457516339869282, 1.0396625137990854, 1.6202090592334495, 1.1149425287356323, 1.0143351458230352, 1.0957683741648108, 1.092152533493002, 1.0158962795941375, 1.1463921543157758, 1.1733333333333333, 1.1233766233766234, 1.0362659503022162, 1.005443335884145, 1.0165569472764346, 1.0, 1.0857142857142856, 1.0492978551592382, 1.0084207658562712, 1.0801152737752162, 1.0698076386952886, 1.0042294028083234, 1.0344827586206897, 1.0029702776636795, 1.2141515341264872, 1.1957134799774394, 1.0434782608695652, 1.0035387177352206, 1.0169158143194335, 1.1149606299212598, 1.0, 1.0063799621928167, 1.086478338543993, 1.0324298160696999, 1.3544776119402986, 1.0909090909090908, 2.6666666666666665, 1.0704700937373595, 1.1272727272727272, 1.0783120027672086, 2.0, 1.0, 1.2903225806451613, 1.0671350507416082, 1.2040816326530612, 1.1187845303867403, 1.0772727272727274, 1.0741379310344827, 1.0149126544524925, 1.0181312942196645, 1.0, 1.0, 1.0425020048115476, 1.1533552902428983, 1.1085814360770578, 1.0272284137516374, 1.1128409610402803, 1.0380156284580944, 1.0818759936406994, 1.0325158882453391, 1.0717703349282297, 1.140976847446876, 1.2272795779954786, 1.7272727272727273, 1.0258024216798, 1.0767590618336886, 1.2272727272727273, 1.25, 1.1676363636363636, 1.0555555555555556, 1.0833333333333333, 1.052271045017159, 1.1532033426183843, 1.176991150442478, 1.0116850914959155, 1.1119402985074627, 1.0036364480156994, 1.0107816139524273, 1.4, 1.0743543106584212, 1.0, 1.0173723356724225, 1.0669546436285098, 1.0099380366631732, 1.275, 1.4285714285714286, 1.0454545454545454, 1.5352112676056338, 1.023071828307195, 1.0, 1.0382262996941896, 1.0207852193995381, 1.0392628205128205, 1.003429896928246, 1.1886792452830188, 1.0062893081761006, 1.0150822669104205, 1.010058867234383, 1.0416562526035158, 1.1111111111111112, 1.0, 1.2505966587112172, 1.022167487684729, 1.1744548286604362, 1.0849595539509163, 1.003767266638761, 1.0260115606936415, 1.0, 1.008230452674897, 1.038306991695687, 1.5714285714285714, 1.0194616848080342, 1.0604395604395604, 1.0526315789473684, 1.0441142857142858, 1.1904761904761905, 1.75, 1.0264247041266095, 2.0, 1.027434842249657, 1.068313953488372, 1.0254306808859721, 1.0584467574059246, 1.1070496083550914, 1.164835164835165, 1.0091992586479794, 1.006986197999075, 1.0231607629427792, 1.0271575581156984, 1.0673498180738101, 2.0, 1.1111111111111112, 1.0364150965740204, 1.0, 1.048687089715536, 1.0, 1.0, 1.0454545454545454, 1.219094247246022, 1.0905587668593448, 1.2524271844660195, 1.0551948051948052, 1.0, 1.0692410119840212, 1.0167477671696952, 1.5, 1.0851697438951757, 1.0, 1.0119031352007894, 1.0470588235294118, 1.038992390448701, 1.1705069124423964, 1.0018181818181817, 1.174, 1.0740740740740742, 1.0179086230057506, 1.000169384272191, 1.0266311584553929, 1.0, 1.1428571428571428, 1.8333333333333333, 1.5, 1.0666666666666667, 1.001844212257907, 1.25, 1.264559068219634, 1.1222222222222222, 1.0959331052831622, 1.010983683148068, 1.0114583333333333, 1.0924408444717328, 1.0366806975345761, 1.2688821752265862, 1.5, 1.014799154334038, 1.087962962962963, 1.0046783488823077, 1.2857142857142858, 3.142857142857143, 1.0846325167037862, 1.0186046511627906, 1.0074203998110058, 1.1492957746478873, 1.342769701606733, 1.0240963855421688, 1.3793103448275863, 1.0808477237048666, 1.055084745762712, 1.3076923076923077, 1.055306427503737, 1.0982142857142858, 1.0444168541941492, 1.0100362603925366, 1.0112561491144432, 1.323076923076923, 1.11, 1.0623145400593472, 1.0, 1.0297855241348135, 1.0220129813578684, 1.0232305988742272, 1.0025434985912474, 1.0109963664180532, 1.0102728731942214, 1.8333333333333333, 1.3892908827785817, 1.2, 1.0973526900085397, 1.1111111111111112, 1.0078077091546211, 1.0231884057971015, 1.0971625107480654, 1.2134387351778657, 1.1368613138686132, 3.0, 1.0810639645345155, 1.0054428364953623, 1.0669256943167187, 1.0, 1.5365853658536586, 1.0422264875239924, 1.2988505747126438, 1.0950241032764114, 1.108294930875576, 1.1666666666666667, 1.3088869715271787, 1.0816836889709491, 1.0664588854466053, 1.0024466015999718, 1.0902412280701754, 1.2056384742951907, 1.5227272727272727, 1.0714285714285714, 1.0180878552971577, 1.3448275862068966, 1.0429740791268758, 1.375, 1.0280017778906598, 1.2, 1.08420830951593, 1.0251400584898347, 1.1562054208273895, 1.0, 1.0857142857142856, 1.24, 1.0006225923187673, 1.323851203501094, 1.0, 1.0095543622288863, 1.0306935112531128, 1.2554630593132154, 1.0, 2.0, 1.177864077669903, 1.0, 1.3863636363636365, 1.0, 1.0234266772214526, 1.0251694094869312, 1.0869565217391304, 1.0822222222222222, 1.0272727272727273, 1.0380577427821522, 1.1580645161290322, 1.0166809238665526, 1.1256529475919868, 1.0, 1.0675675675675675, 1.0861638806714902, 1.001291230457575, 1.0912402949967281, 1.0, 1.049686556768052, 1.011588359162742, 1.0282870612886328, 2.0, 1.1132376395534291, 1.0648039169530625, 1.117078304337817, 1.1836529640470053, 1.028280290090944, 1.230971128608924, 1.0445378151260505, 1.0262777242044359, 2.0, 1.1023825520698745, 1.7209302325581395, 1.2, 1.304054054054054, 1.1063829787234043, 1.0413332176026386, 1.0628717077315208, 1.0580786360074164, 1.0900450225112557, 1.0338707240245022, 1.0217773569592858, 1.0010286995619357, 1.1262135922330097, 4.0, 1.0275933261313168, 1.0112589559877174, 1.003426564684222, 1.0233548498479776, 1.0974387527839644, 1.1000704721634955, 1.094240837696335, 1.4285714285714286, 1.027607860797338, 1.0110191302797678, 1.0180769657313962, 1.1095342066957787, 1.079320481802336, 1.0543478260869565, 1.0115808498516787, 1.0456852791878173, 1.0994397759103642, 2.0, 1.0833333333333333, 1.0230061349693251, 1.0721062618595825, 1.011744966442953, 1.0083932853717026, 1.0, 1.3819444444444444, 1.0554699537750385, 1.0824175824175823, 1.0052023315395544, 1.4303797468354431, 1.064831363032678, 1.0, 1.1475680131904369, 1.5515873015873016, 1.0780141843971631, 1.022564981433876, 1.0752941176470587, 1.033596837944664, 1.0700389105058365, 1.022644762563897, 1.0, 1.7446808510638299, 2.0, 1.0, 1.0731707317073171, 1.1753554502369667, 1.3728813559322033, 1.1135135135135135, 1.0285165011214354, 1.1180285343709468, 1.0241684080709808, 1.0199664760402287, 1.0971428571428572, 1.0183524484473616, 1.0486486486486486, 1.038721573448064, 1.165940977261732, 1.0629112924453803, 1.1690751445086704, 1.0459932279909707, 1.026690946930281, 1.0353816320691738, 1.0090998146989743, 2.0, 1.0626631853785902, 1.0415896487985212, 1.0482758620689656, 1.0, 1.1333333333333333, 1.1538461538461537, 1.0865384615384615, 1.5925925925925926, 1.5, 1.0309525786894775, 1.0368224631242224, 1.010321011924778, 1.0479316617891323, 1.1297297297297297, 1.014580801944107, 2.0, 1.232, 1.1146217712177122, 1.010698417385935, 1.0083512365322176, 1.0276796901697232, 1.009726443768997, 1.1127167630057804, 1.0540105587502209, 1.1847246891651866, 1.0112927730787546, 1.0328507690280313, 1.4242424242424243, 1.0841423948220066, 1.0, 1.0090702947845804, 1.020264760483717, 3.0, 1.0689092762487258, 1.029776343607433, 1.2857142857142858, 1.170715249662618, 1.4, 1.1176470588235294, 1.0288456090651559, 1.6923076923076923, 1.0124965253858333, 1.0149508756941479, 1.1515151515151516, 1.2083333333333333, 1.2564766839378239, 1.0106331561140647, 1.0673892554194155, 1.0199722858175684, 1.0114635741262195, 1.0, 1.212144253747556, 1.0091463414634145, 2.0, 1.0796411190811173, 1.016195172592785, 1.1078524124881741, 1.0109108464757, 1.0335164417892313, 1.2150537634408602, 2.2857142857142856, 1.0867249904906808, 1.0264900662251655, 1.112483667894049, 1.0807204803202135, 1.033329683186463, 1.1218273318329581, 1.0224719101123596, 1.0298850574712644, 1.1412213740458015, 1.0109106451903176, 1.0750788643533122, 1.0514285714285714, 1.1964285714285714, 1.0370269725365755, 4.0, 1.0010486577181208, 1.0140616494970063, 1.0192754569889595, 1.0, 1.0332902855502941, 1.138655462184874, 1.0, 1.005149185300134, 1.0134426229508198, 1.0930787589498807, 1.0294117647058822, 1.6666666666666667, 1.0565409799377703, 1.5, 1.436241610738255, 1.1538461538461537, 1.0832461098318331, 1.2857142857142858, 1.2606382978723405, 1.1069182389937107, 1.0, 1.310846560846561, 1.0552104899930987, 2.0, 1.0, 1.0901639344262295, 1.0740740740740742, 1.0885850178359096, 1.0159914712153517, 1.0207336523125996, 1.0117994100294985, 1.089150378938971, 1.0493506493506493, 1.678082191780822, 1.047008547008547, 1.4230769230769231, 1.0, 1.0518518518518518, 1.3073593073593073, 1.0498915401301518, 1.1780788477968998, 1.008688844018767, 1.2192416296893909, 1.0200026680105534, 1.070546805464185, 1.0048134777376654, 1.0071599045346062, 1.375, 1.0, 1.0303030303030303, 1.0479894381879493, 1.1240079365079365, 1.0065359477124183, 1.3856655290102389, 1.0462772050400917, 1.0338293870325292, 1.0019242693121806, 1.0512820512820513, 1.1578947368421053, 1.0451517394522576, 1.07237539766702, 1.0427709304553292, 1.0050621869176173, 1.2105263157894737, 1.0468842291789722, 1.002638722494351, 1.157037037037037, 1.0380549682875264, 1.1111111111111112, 1.033115671641791, 1.2850940665701882, 1.0576923076923077, 1.1613924050632911, 1.0347890451517394, 1.0, 1.095, 1.0533183428727173, 1.1296296296296295, 1.0043225945119767, 1.1557203389830508, 1.0465116279069768, 1.040247640509335, 1.0101297764960346, 1.1483346763362878, 1.022439024390244, 1.0022753128555177, 1.0051284941388638, 1.1594202898550725, 1.0, 1.0, 1.1111111111111112, 1.011868717451859, 1.8333333333333333, 1.0215434083601287, 1.0733940014000323, 1.1076650420912717, 1.0807040137368533, 1.002662305556612, 1.0930332261521971, 1.0648854961832062, 1.0097087378640777, 1.012341794444314, 1.0529796421961752, 1.0081729501713683, 1.0137600867156449, 1.25, 1.03125, 1.359683794466403, 1.0029290443342924, 1.1009771986970684, 1.02, 1.1787610619469027, 1.0155945419103314, 1.0586493028435322, 1.0219478737997256, 1.0041626794258374, 1.25, 1.0394064904807852, 1.0027180566102722, 1.1626947754353805, 1.0008428150021071, 1.09375, 1.0331905781584583, 1.1691542288557213, 1.625, 1.0645474137931035, 1.2692307692307692, 1.023735810113519, 1.0527472527472528, 1.0728253540121375, 1.0087556827748778, 1.0705882352941176, 1.1818181818181819, 1.087378640776699, 1.0157542556711643, 1.0123798435223776, 1.0072998651657208, 1.0000652837394526, 1.0796711786884232, 1.0769230769230769, 1.048841059602649, 1.1403430608153264, 1.108576275726595, 1.0428422152560084, 1.1944444444444444, 1.085662759242561, 1.0220214812093444, 1.1789383561643836, 1.0042397278199424, 1.0, 1.3333333333333333, 1.0051175554401839, 1.000563142334225, 1.0196201292343843, 1.0463289764573556, 1.0526735833998404, 1.0514018691588785, 1.0026416693773348, 1.1000431363440288, 1.0729783037475344, 1.308108108108108, 1.0295602018745493, 1.0064668924557012, 1.0119047619047619, 2.3333333333333335, 1.0216971067003284, 1.0074344775640578, 1.0415676959619953, 1.2941176470588236, 1.0807385952208544, 1.0280063189346447, 1.00508618253744, 1.0443864229765014, 1.1923076923076923, 1.105121293800539, 1.0042283298097252, 1.096875, 1.72, 1.048027712593586, 1.0089197224975224, 1.089430894308943, 1.1388888888888888, 1.0347945297087637, 1.0857142857142856, 1.0124695039306044, 1.018716577540107, 1.6666666666666667, 1.0357142857142858, 2.0, 1.038712011577424, 1.3846153846153846, 1.3333333333333333, 1.5, 1.2397372742200328, 1.0036231884057971, 1.097473879116519, 1.0043505382191584, 1.3784461152882206, 1.4558823529411764, 1.0, 1.2580645161290323, 1.2972972972972974, 1.1666666666666667, 1.0, 1.0062540945408374, 1.0040159146450498, 1.0390625, 1.0073791400805618, 1.0010259746759422, 5.0, 1.008990847538362, 1.2142857142857142, 1.0, 1.3333333333333333, 1.120414201183432, 1.1052858064978843, 1.025379017947527, 1.0372670807453417, 1.0, 1.1025641025641026, 1.1625766871165644, 2.0, 1.5, 1.124753937007874, 1.0628661237319617, 1.1821270310192025, 1.25, 1.018861182371958, 1.0666150271107668, 1.0906040268456376, 1.1428571428571428, 1.0142857142857142, 1.0022789762757898, 1.4605263157894737, 1.0484972677595628, 1.057141099766269, 1.0897435897435896, 1.0078125, 1.020275482093664, 1.2083689154568744, 1.0702479338842976, 1.3529411764705883, 1.041466269146328, 1.064334637964775, 1.055405959465, 1.255639097744361, 1.2142857142857142, 1.1791044776119404, 1.0693333333333332, 1.0344617261360172, 1.0311229583277586, 1.0125234719294884, 1.037117903930131, 3.0, 1.25, 1.0899905933177716, 1.1512752858399296, 1.3168644232639564, 1.0141705821949778, 1.0411440040140492, 1.1111111111111112, 1.0249433106575965, 1.0625, 1.0421350522757644, 1.0297096833843562, 1.00592768227623, 1.34037558685446, 2.5, 1.0933333333333333, 1.017126865671642, 1.0604540023894862, 1.0347026067306917, 1.0183989541309422, 1.1264204545454546, 2.0, 1.0082449941107186, 1.0439552848804412, 1.0424948594928032, 1.0778688524590163, 1.0399799742526106, 1.2076923076923076, 1.2513812154696133, 1.107246376811594, 1.0031160926527922, 1.0533362890711593, 1.0933179723502304, 1.1280409731113956, 1.0, 1.1078263841421736, 1.0277151446824502, 1.1003963011889035, 1.0517018920060746, 1.032758620689655, 1.0417651694247438, 1.3846153846153846, 1.0445859872611465, 2.5, 1.5, 1.4166666666666667, 1.0255754475703325, 1.1437598736176935, 1.015299491254781, 1.032100574738013, 1.0276797829036635, 1.0728033472803347, 1.0869565217391304, 1.183673469387755, 1.0189338708294022, 1.6, 1.3333333333333333, 1.054959349593496, 1.0, 1.0852601156069364, 1.1262376237623761, 1.013159080666967, 1.0198990440018827, 1.25, 1.1796932067202337, 1.3313953488372092, 1.2344139650872819, 1.0007069408740359, 1.0126262626262625, 1.0492274523895078, 1.0255831602492411, 1.0972312415136667, 1.1399046104928459, 1.5434782608695652, 1.2779329608938548, 1.0, 1.0, 1.0008315153249168, 1.6666666666666667, 1.5714285714285714, 1.3846153846153846, 1.025990099009901, 1.119047619047619, 1.03737780333525, 1.07145859604876, 1.0, 1.239602731222843, 1.0214797136038185, 1.1973094170403586, 1.0072639225181599, 1.25, 1.0161361626878869, 1.1915455746367238, 1.0842105263157895, 1.0107846783190777, 1.0090870840114943, 1.1678702250130821, 1.0065495683239059, 1.0, 1.0446369381712113, 1.0028565577428994, 1.015618596603069, 1.2695652173913043, 1.0107645730212889]
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.6256	median: 1.0560	mean: 1.1521

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 20.041327 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=naru', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[4.1723251e-07 1.4305115e-06 2.9802322e-07 5.9604645e-08 0.0000000e+00]
Distance score: 4.410743770222325e-07
SAUCE Drift detection: False
Detection latency: 0.0233s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 2.036634 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 8.0000	99th: 3.0000	95th: 1.7156	median: 1.0660	mean: 1.1721
ReportEsts: [1.0706214689265536, 1.0354082092918357, 1.0409858712715856, 1.026272577996716, 1.0, 1.0, 1.1992111463989346, 1.0093774332238736, 1.2, 1.0494505494505495, 1.023416608446361, 1.0025447588795842, 1.030550621669627, 1.0623781676413255, 1.0401416765053129, 2.189189189189189, 1.0961538461538463, 1.4166666666666667, 1.7777777777777777, 1.0691244239631337, 1.0813583666769262, 1.0070317859592957, 1.0980392156862746, 1.0796380090497737, 1.0160478620446947, 1.0045289982474745, 3.0, 1.056514094180999, 1.0, 1.1428571428571428, 1.029535864978903, 1.0, 1.0046589920659794, 1.009209241032399, 1.2889505316689782, 1.011576354679803, 1.0197177544294527, 1.070615034168565, 1.3557692307692308, 1.0557561717880584, 1.1737715587373903, 1.031742883285238, 1.0512223515715948, 1.0811816058035166, 1.03584229390681, 1.1310545402319485, 1.15, 1.0349473684210526, 1.2760416666666667, 1.0279134682484299, 1.0, 1.1003584229390682, 1.0675675675675675, 1.0909090909090908, 1.0541257659587127, 1.007500515145271, 1.0238532110091743, 1.1681614349775784, 1.0843373493975903, 1.0050215488244716, 1.0298507462686568, 1.0000256778964667, 1.0440165061898212, 1.0766129032258065, 1.0272727272727273, 2.25, 1.1738641929071476, 1.0814569536423841, 1.1428571428571428, 1.0, 1.1274279243968295, 1.0098231827111985, 1.0626506024096385, 1.1102661596958174, 1.0429306960032596, 1.035171862509992, 1.0614977269321078, 1.041860465116279, 1.0780141843971631, 1.053316282379185, 1.2097819681791397, 1.1595744680851063, 1.0, 3.0, 1.0267753201396974, 1.0526315789473684, 1.5, 1.2142857142857142, 1.1428571428571428, 1.0131885308627904, 1.0859566139292123, 1.0817784835252084, 1.1150922909880565, 1.278978622327791, 1.1300813008130082, 1.383529411764706, 1.3705882352941177, 1.3594771241830066, 1.0476190476190477, 1.163928012519562, 1.5, 1.0, 1.0554243156490064, 1.231785257775884, 1.0565055762081785, 1.006912646598328, 1.225, 1.0040195685383602, 1.1561062851303014, 1.0150414407039803, 1.010585305105853, 1.0274079874706343, 1.3333333333333333, 1.0, 1.1155801104972376, 1.0157223464281913, 1.0573816155988858, 1.041237113402062, 1.0045853407595737, 1.0, 1.200188264825855, 1.127861089187056, 1.5, 1.2790697674418605, 1.0, 1.0539956803455723, 1.009109460981781, 1.052272283986737, 1.1031746031746033, 2.0, 1.330110497237569, 1.0, 1.0555555555555556, 1.0077080237741456, 1.0769230769230769, 1.0119868145040456, 1.030853097828561, 1.035206270905835, 1.6666666666666667, 1.2, 1.0, 1.079350766456267, 1.0445040214477213, 1.0673239703671602, 1.1782178217821782, 1.0506738544474394, 1.0140829362263004, 2.0, 1.0137562094000765, 1.0941658137154555, 1.0806871421134825, 1.0258493353028064, 1.3333333333333333, 1.1750909826122118, 1.0248138957816377, 1.026890756302521, 1.3666666666666667, 1.0, 1.05446293494705, 1.0640030387199393, 1.0326902867437322, 1.0939490445859872, 1.1494565217391304, 1.0357142857142858, 1.1676646706586826, 1.1304347826086956, 1.25, 1.006176037724515, 1.3142857142857143, 1.0773809523809523, 1.006329156403321, 1.0959110042092604, 1.0998942674573622, 1.0017211703958693, 1.0754039497307002, 1.1469473344624566, 1.057591623036649, 1.181740614334471, 1.052901023890785, 1.03239289446186, 1.140809174896464, 1.013405681455474, 1.025, 1.2191011235955056, 1.013268714570176, 1.0079006312360008, 1.0145985401459854, 1.339350180505415, 1.1938202247191012, 3.0, 1.0796019900497513, 1.0003641816623823, 1.0, 1.0373831775700935, 1.0290861880466473, 1.0027724734138177, 1.0124706860898998, 1.0251509054325956, 1.0013711930230973, 1.0125491943268732, 1.09849157054126, 1.0210741426655598, 1.082735655737705, 1.0160458256938196, 1.1796344647519583, 1.169180559230837, 1.2045454545454546, 1.05, 1.0096153846153846, 1.0, 1.011049723756906, 1.006335797254488, 1.59375, 1.0792079207920793, 1.0274656679151062, 1.5, 1.0042368360368545, 1.0419580419580419, 1.0473771856786012, 1.3333333333333333, 1.050995024875622, 1.0738816738816739, 1.008030496767486, 1.0591964890637167, 1.2222222222222223, 1.0346820809248556, 1.0108765405690028, 1.0034662045060658, 1.015748031496063, 1.2107843137254901, 1.0455049944506105, 1.086072091174132, 1.0862068965517242, 1.0013498605919837, 1.1006456843385355, 1.1857142857142857, 1.2344290657439447, 1.0459905660377358, 1.5, 1.1196298744216788, 2.0, 1.0314671025745812, 1.0582194963293374, 1.029908720139833, 1.4398734177215189, 1.6153846153846154, 3.3333333333333335, 1.093464243845252, 1.1692307692307693, 1.1022653721682847, 1.5, 1.0526315789473684, 1.0020429009193055, 1.2857142857142858, 1.0104373444244887, 1.0823798627002288, 1.1308691308691308, 1.206896551724138, 1.0153133903133904, 1.0532744415187294, 1.028169014084507, 2.0, 1.0060886319845856, 1.1504951628599234, 1.075912408759124, 1.0116346610810907, 1.0533135718822781, 1.0279515768457461, 1.0915075707702435, 1.0175186337226363, 1.0753012048192772, 1.2428119608970674, 1.2163169005339625, 2.0, 1.0567366649300685, 1.1875, 1.2941176470588236, 1.2142857142857142, 1.0825498877903803, 1.1657754010695187, 1.0159757833536283, 1.0154108979606364, 1.0763888888888888, 1.2659846547314577, 1.0169474795929447, 1.016185784658691, 1.0747296957505657, 1.003618801804079, 1.3076923076923077, 1.1293634496919918, 1.0779537149817295, 1.0111811418336094, 1.0076834528383007, 1.0602125485095162, 1.0646506777893638, 1.0111172873818788, 1.0375984107129719, 1.0557684730828467, 1.0494670882002157, 1.0446928140427867, 1.077294685990338, 1.0673076923076923, 1.25, 1.0659571036929527, 1.5, 1.007168458781362, 1.044391724373771, 1.0624417520969245, 1.1714285714285715, 1.1951219512195121, 1.2142857142857142, 1.0369531113822554, 1.000039693565673, 1.2380952380952381, 1.0415245981490502, 1.0148352068517243, 1.1580188679245282, 1.5, 2.6666666666666665, 1.116523400191022, 1.3333333333333333, 1.034439023426047, 1.0659509202453987, 1.3333333333333333, 1.0136916659926747, 1.1666666666666667, 1.8888888888888888, 1.0157069561421712, 2.0, 1.9166666666666667, 1.075812274368231, 1.1789358351023762, 1.0265486725663717, 1.054176072234763, 1.201834862385321, 1.0204726185776325, 1.005528147597486, 1.2020117351215422, 1.0053697327430726, 1.136070959264126, 3.0, 1.0833333333333333, 1.0407633209417595, 1.25, 1.0520785746916401, 1.0, 3.0, 1.0, 1.2099898063200816, 1.0979133226324238, 1.4821428571428572, 1.1012385568120624, 1.2, 2.25, 1.037834111447839, 1.1483516483516483, 1.1, 1.0077683581030823, 1.1594202898550725, 1.081385979049154, 1.0169172932330828, 1.8, 1.25, 1.177874186550976, 1.169811320754717, 1.037948717948718, 1.0161835319224612, 1.0982630272952854, 1.053030303030303, 1.0, 1.000661171467684, 1.2444444444444445, 1.2258064516129032, 3.0, 1.106100795755968, 1.1111111111111112, 1.3554913294797688, 1.1610169491525424, 1.0532863225119744, 1.0001088723725466, 1.1171597633136094, 1.1107019064124783, 1.030103612433492, 1.4229828850855746, 1.0258855585831064, 1.0229367386884063, 1.0562962962962963, 1.088235294117647, 1.0200835491043498, 1.0077327441718726, 1.1204068241469816, 1.0526315789473684, 1.0212765957446808, 1.0254545454545454, 2.0, 1.7407407407407407, 1.2035398230088497, 1.0340264650283555, 1.2422360248447204, 1.205020920502092, 1.057934508816121, 1.422872340425532, 1.004411793669864, 1.1027318199307425, 1.1591773563127934, 1.2298850574712643, 1.0387596899224807, 1.0660146699266504, 1.0, 1.0009571459647597, 1.396551724137931, 1.007496308635899, 1.0155553434203617, 1.0002378498374693, 1.0300487276664863, 2.142857142857143, 1.1310483870967742, 1.6, 1.1291415662650603, 1.0909090909090908, 1.031378563256165, 1.0412621359223302, 1.0585305105853051, 1.174757281553398, 1.1058475203552924, 5.0, 1.025143141647996, 1.0030868953461642, 1.0802425312278143, 1.0, 1.0757575757575757, 1.0039184952978057, 1.2914691943127963, 1.0922497965825875, 1.0131150609990744, 1.0, 1.1263460157932519, 1.057019766852509, 1.0794350317677837, 1.0157976295944493, 1.066197149530483, 1.0060851926977687, 1.4, 1.143227815256876, 1.0018527049492258, 1.5, 1.0959071472205253, 1.0, 1.5, 1.1755075311067453, 1.116, 1.2, 1.0698211635840715, 1.1285545023696681, 1.0, 1.1333333333333333, 1.5384615384615385, 1.0219974219581909, 1.1666666666666667, 2.0, 1.0006940395880182, 1.0, 1.0, 1.1160136934195513, 2.0, 1.2097654995181497, 1.0251524390243902, 1.3970037453183521, 1.1, 1.0085845162796767, 1.0217216411906678, 1.0, 1.0654545454545454, 1.0227272727272727, 1.0484048404840485, 1.1722745625841184, 1.104384133611691, 1.0952973257427163, 1.0, 1.0689655172413792, 1.0472279260780288, 1.0011915400655347, 1.141855027279813, 1.2, 1.0432525951557095, 1.0250266389994953, 1.0356043956043957, 2.0, 1.111515552614163, 1.0580725563503979, 1.1588275391956373, 1.1163542574832896, 1.0402908871681833, 1.0658389950632974, 1.0145027624309393, 1.0825489416235803, 2.0, 1.0478620748809881, 1.2142857142857142, 1.0442839951865222, 1.071862907683803, 1.0474934036939314, 1.0379255905824003, 1.1001589825119238, 1.048833894688229, 1.2945581627558662, 1.0808209741470136, 1.0595238095238095, 1.0022273387056408, 1.1309425769259565, 1.0240963855421688, 1.1071428571428572, 1.0509058441774775, 1.079664570230608, 1.0211875843454792, 1.0065406258093377, 1.3333333333333333, 1.1800075159714394, 1.393162393162393, 1.0, 1.0196078431372548, 1.0013589323669814, 1.1172413793103448, 1.0829042224510814, 1.0, 1.008695652173913, 1.0335856196783348, 1.0376410437235544, 1.0302566066641135, 1.010233377142055, 1.0171551107934238, 1.0236220472440944, 1.085465432770822, 1.1140289239316938, 1.3106060606060606, 1.0241547393585644, 1.0320284697508897, 1.1132075471698113, 1.0119773276756414, 1.1458923512747876, 1.0279763550429848, 1.0, 1.0335230866540164, 1.3879598662207357, 1.0970762667776506, 1.0, 1.0699029126213593, 1.133884297520661, 1.115112160566706, 1.0799881381900855, 1.0, 1.7647058823529411, 1.5, 1.3333333333333333, 1.1122448979591837, 1.0602258469259724, 1.3282828282828283, 1.0950226244343892, 1.0246436659118157, 1.0110849848841115, 1.0635210784873756, 1.029226785053644, 1.0140535283032424, 1.003571489383439, 1.0302462250486957, 1.0863192182410424, 1.1060181945416374, 1.0048237454684221, 1.082439024390244, 1.0154185022026432, 1.1054502369668247, 1.1787709497206704, 1.0177283532777308, 1.2706766917293233, 1.0075474696115039, 1.1148325358851674, 1.2554788351846293, 1.0, 2.5, 1.0243055555555556, 1.0, 1.5, 1.0502958579881656, 1.0170223577235773, 1.010019267822736, 1.1354166666666667, 1.106508875739645, 1.0101495077184879, 1.2085644085644085, 1.0128676470588236, 1.2, 2.0, 1.0260522138908652, 1.2920353982300885, 1.0155038759689923, 1.01735615786971, 1.0, 1.1455992509363295, 1.1376811594202898, 1.044944183789031, 1.234678624813154, 1.0051794024921183, 1.0091076629824314, 1.011647030205601, 1.1756756756756757, 1.5, 1.0754355828220858, 1.0, 1.1040100250626566, 1.152542372881356, 1.164119066773934, 1.0239877769289534, 1.3103448275862069, 1.0511782753443437, 1.0743243243243243, 1.0909090909090908, 1.094385848351466, 1.0032278889606197, 1.0, 1.0552568697729987, 1.025339366515837, 1.014478446857519, 1.0, 1.013574309649395, 1.1279289082335873, 1.2380952380952381, 1.0027472527472527, 1.0498736859261675, 1.1616766467065869, 1.0648926743702418, 1.0, 1.1217564870259482, 1.0709041325781414, 1.1627358490566038, 1.1956521739130435, 1.0157864839888426, 1.3557692307692308, 1.7777777777777777, 1.107403876707976, 1.0603448275862069, 1.040944212093287, 1.1350823332403015, 1.0408900503439529, 1.0345783235269037, 1.2526799387442573, 1.0186945500633713, 1.1198738170347002, 1.0276473995134947, 1.0627943485086342, 1.0571428571428572, 1.0635686102586586, 1.0518979607423815, 1.2035087719298245, 1.0095376656967345, 1.2, 1.3333333333333333, 1.018359853121175, 1.0131099781500363, 1.0788394828129928, 1.2057142857142857, 1.6666666666666667, 1.0354889589905363, 1.0839112343966713, 1.7142857142857142, 1.0210314070879483, 3.0, 1.0297327917322943, 2.5, 1.5172413793103448, 1.2142857142857142, 1.111169102296451, 1.2941176470588236, 1.1787234042553192, 1.0935064935064935, 1.0, 1.0390588633574542, 1.0310208685843203, 1.8, 1.0, 1.0402684563758389, 1.0391566265060241, 1.140574282147316, 1.004428697962799, 1.005390835579515, 1.0028301886792452, 1.0583554376657824, 1.1281632653061224, 1.4583333333333333, 1.1934156378600822, 1.0625, 1.5, 1.0825688073394495, 1.1886792452830188, 1.0545950864422202, 1.256149095243255, 1.001507613447912, 1.1891615123090158, 1.0146121934958146, 1.0268056141196313, 1.043390514631685, 1.0249617931737136, 1.8888888888888888, 1.0, 1.0, 1.0194978167347124, 1.1476510067114094, 1.029810298102981, 1.324022346368715, 1.018901774844621, 1.0712981417608516, 1.0056874773343685, 1.02020202020202, 1.2173913043478262, 1.4594594594594594, 1.0986311954961916, 1.0328358995297868, 1.0352509746052023, 1.1978609625668448, 1.0822667979325622, 1.0376561458423905, 1.132012362928151, 1.0615141955835963, 1.0237715750270313, 1.3620689655172413, 1.0271844660194174, 1.0820135746606334, 1.0131048087607029, 1.25, 1.0873069173942242, 1.0, 1.056910569105691, 1.0361252304083115, 1.0416666666666667, 1.0022818140088745, 1.1454058876003568, 1.2127659574468086, 1.0560088047012257, 1.0047709064722297, 1.1099991637164441, 1.0281576830249397, 1.1025163094128612, 1.011338028169014, 1.2245989304812834, 1.0625, 1.0, 1.0, 1.009728177331931, 1.8571428571428572, 1.0831763122476448, 1.0874533267353457, 1.267717996289425, 1.0828699551569507, 1.0131978591844695, 1.0909819996435572, 1.0404984423676011, 1.013840830449827, 1.032111527596272, 1.047486490912068, 1.0066450754958847, 1.0266355374805443, 1.2222222222222223, 1.0749542961608776, 1.4123376623376624, 1.0013570871711952, 1.0490463215258856, 1.017250577983283, 1.1388059701492537, 1.0260586319218241, 1.0113011738201785, 1.0078299776286352, 1.0114151570717553, 1.1363636363636365, 1.0286224174617338, 1.0053191122394773, 1.1332586786114223, 1.007074637424832, 1.236842105263158, 1.130801687763713, 1.1015875561257216, 1.089376675603217, 1.1987951807228916, 1.0028911460188403, 1.0526315789473684, 1.082077051926298, 1.2253968253968255, 1.112258064516129, 1.028423772609819, 1.1624548736462095, 1.1489554950045413, 1.0909943714821764, 1.0290684017664193, 1.055609756097561, 1.1086131291314876, 1.0551622418879056, 1.0625, 1.0592694693314955, 1.1910569105691058, 1.06372650278868, 1.1193415637860082, 1.1571354971664092, 1.2405566600397615, 1.075, 1.058227848101266, 1.0349831797130746, 1.0307692307692307, 1.033411488862837, 1.0097287735849056, 1.02564632885212, 1.6126984126984127, 1.010182460489159, 1.1216368392785987, 1.0690571049136786, 1.0823293172690762, 1.0137409796176857, 1.107077384589745, 1.028616852146264, 1.3669724770642202, 1.005190311418685, 1.0212119973012206, 1.0784313725490196, 2.25, 1.044526834887153, 1.0056512909776618, 1.0259295499021526, 1.3006134969325154, 1.007701421800948, 1.00851603551368, 1.0077501174260215, 1.031450041747843, 1.3333333333333333, 1.0829621380846326, 1.5, 1.1486486486486487, 1.53125, 1.0597928743568032, 1.0281456953642385, 1.067369654364382, 1.1428571428571428, 1.045392022008253, 1.0350544765513974, 1.01, 1.0296296296296297, 1.0285536933581627, 1.1290322580645162, 1.1261879619852164, 1.5, 1.0474333647073426, 1.0933734939759037, 1.1721755621782715, 1.1339285714285714, 1.2666666666666666, 1.0357039187227866, 1.086148279841552, 1.0120804106533365, 1.143103448275862, 1.4069767441860466, 1.1875, 1.0857142857142856, 1.2608695652173914, 1.4655172413793103, 1.0058944886531094, 1.0156896964237963, 1.006946001843961, 1.0377358490566038, 1.0107420413332566, 1.0008177808931336, 8.0, 1.0272026493014972, 1.027407546461423, 2.0, 1.2857142857142858, 1.0857072691552063, 1.1267867867867867, 1.0715206696818218, 1.012853470437018, 1.5, 1.1592592592592592, 1.3189873417721518, 1.1071428571428572, 1.0108311382226536, 1.0794245198595718, 1.018446925458504, 1.1792163124923227, 1.2, 1.002703075057864, 1.0746753246753247, 1.2761276127612762, 1.32, 1.065909090909091, 2.0, 1.2272727272727273, 1.0490191421650121, 1.0461585283376167, 1.128691983122363, 1.0267558528428093, 1.0066932859417914, 1.1237623762376239, 1.1472602739726028, 1.1066666666666667, 1.0492267041946093, 1.0056185514352844, 1.0593239888900168, 2.0412371134020617, 1.2843137254901962, 1.1449487554904831, 1.0, 1.0249854735618826, 1.0379746835443038, 1.004348203114354, 1.0550964187327823, 3.5, 1.0733374766935986, 1.0427268162035488, 1.1983865053171985, 1.3008706868752016, 1.0776588228900603, 1.0569332355099046, 1.1175388967468176, 1.0340264650283555, 1.0508474576271187, 1.047766097240473, 1.0149952416471617, 1.0437776684702411, 1.325626204238921, 2.5, 1.1724137931034482, 1.0535998044248869, 1.2175182481751825, 1.0135531665723647, 1.015860317206344, 1.1091445427728615, 1.8, 1.013013013013013, 1.0483684666474156, 1.0045523520485584, 1.0258064516129033, 1.0199880816407607, 1.0424929178470255, 1.4299065420560748, 1.0813786500718048, 1.0041877598369842, 1.007166050834173, 1.0854126679462572, 1.09853249475891, 1.0833333333333333, 1.0644055694394858, 1.5691326530612244, 1.0642445227745463, 1.1091954022988506, 1.0273119310014374, 1.020077720207254, 1.0357142857142858, 1.0242214532871972, 2.5, 1.5, 1.3333333333333333, 1.0827740492170022, 1.1359159553512803, 1.0280411352336247, 1.032797811269898, 1.1193724420190996, 1.006867406233492, 1.008695652173913, 1.1382978723404256, 1.000263162511623, 1.6666666666666667, 1.4285714285714286, 1.079191698525396, 1.1111111111111112, 1.1897905759162304, 1.1466275659824048, 1.0291142173140784, 1.023585863371188, 1.25, 1.0863975314991001, 1.1437632135306555, 1.0958666996366957, 1.0006808653875578, 1.0247844827586208, 1.0196136701337295, 1.0297794915452285, 1.103137022787807, 1.1456953642384107, 1.45, 1.260143198090692, 1.0, 3.0, 1.0009577687342546, 2.0, 1.8571428571428572, 1.3829787234042554, 1.0059820538384845, 1.020223752151463, 1.0232828870779977, 1.0192307692307692, 1.0, 1.3255747942094807, 1.036963036963037, 1.3671875, 1.0520833333333333]
origin-bjaq_15.87 	max: 8.0000	99th: 3.0000	95th: 1.7156	median: 1.0660	mean: 1.1721

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.178579 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=36.288892