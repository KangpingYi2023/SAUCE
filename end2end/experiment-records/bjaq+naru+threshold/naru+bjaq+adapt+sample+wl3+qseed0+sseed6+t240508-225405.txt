Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='naru', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 6, 'naru': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.5919	median: 1.0528	mean: 1.1471
ReportEsts: [1.1209964412811388, 1.0762331838565022, 1.0308019237221788, 1.0216110019646365, 1.0, 1.0, 1.2090711401056229, 1.015309110555205, 1.25, 1.0290620871862615, 1.0421608518742966, 1.002466043149254, 1.0046413502109706, 1.0209302325581395, 1.0017661603673613, 1.0, 1.40625, 1.0655331207934822, 3.0, 2.6666666666666665, 1.2857142857142858, 1.0367910286823376, 1.0074233716475096, 1.060398505603985, 1.0034533793783917, 1.0, 1.0475178232716331, 1.0, 1.4, 1.2158273381294964, 1.0, 1.0047310809610985, 1.0133636386004625, 1.3451720310765816, 1.0198266999559407, 1.0210209193690338, 1.0625, 1.0119078260447272, 1.1069977271161926, 1.1666666666666667, 1.04, 1.021341463414634, 1.0, 1.159967689822294, 1.066635816751504, 1.2066115702479339, 1.116504854368932, 1.2358078602620088, 1.027218470302757, 1.0188679245283019, 1.073691310736913, 1.304932735426009, 1.0041892073605925, 2.0, 1.2571428571428571, 1.0811944409665706, 1.16, 1.0526315789473684, 1.2546583850931676, 1.25, 1.0185387131952017, 1.0454545454545454, 1.0272727272727273, 1.103448275862069, 1.0909090909090908, 1.0904087778200824, 1.1121418826739426, 1.1666666666666667, 1.0, 1.0571597516507343, 1.0525059665871122, 1.0584490740740742, 1.1238738738738738, 1.1989863827173135, 1.16, 1.134453781512605, 1.0, 1.048140043763676, 2.0, 1.0544204998708715, 1.1428571428571428, 1.0846822575898214, 1.1288343558282208, 1.0493119266055047, 1.0681341719077568, 1.04, 1.0056009250560092, 1.0591919592018617, 1.1127450980392157, 2.3333333333333335, 1.1103414151410194, 1.0029821599778839, 1.02803738317757, 1.3225806451612903, 1.1876355748373102, 1.09375, 1.2616822429906542, 1.0147186147186147, 1.0, 1.0204880713895466, 1.0947444204463643, 1.0112749349522983, 1.0050003546350805, 1.0, 1.011950363412971, 1.0710833096388968, 1.0401428395517793, 1.0815320439893819, 1.0257861635220127, 1.0, 1.0, 1.1517761033369214, 1.011747065818727, 1.038713910761155, 1.1159420289855073, 1.0061932557048614, 1.0, 1.1208907741251326, 1.0956937799043063, 1.0, 1.2252747252747254, 1.1666666666666667, 1.025706940874036, 1.0117966658059405, 1.030597188786208, 1.12, 1.8, 1.2433774834437086, 1.0, 1.1428571428571428, 1.0039668339961763, 1.1818181818181819, 1.0408266982890055, 1.0023928102645907, 1.0244724384177164, 1.1348484848484848, 1.042857142857143, 1.0443630443630443, 1.00199203187251, 1.051249199231262, 1.0307661027976578, 1.1851851851851851, 1.106327462491846, 1.0724764415672556, 2.0, 1.0105941962229388, 1.0466507177033493, 1.0397022332506203, 1.0337038997706016, 1.0, 1.0335432308064907, 1.0150375939849625, 1.012, 1.4476190476190476, 1.119281045751634, 1.0515865981209005, 1.0188913477627246, 1.0452249977455135, 1.1653992395437263, 1.194078947368421, 1.0425531914893618, 1.3478260869565217, 1.139261744966443, 1.1428571428571428, 1.0165575664227955, 1.0098895149791458, 1.0134189031505252, 1.034037212049616, 1.0354306658521686, 1.0714796851395405, 1.0252631578947369, 1.0777310924369747, 1.2014137697298344, 1.1213151927437641, 1.1636546184738956, 1.0741127348643007, 1.0549520766773164, 1.031242508989213, 1.0559135142316252, 1.0, 1.3404255319148937, 1.0256187581415546, 1.0471816283924844, 1.0682574916759155, 1.0410958904109588, 1.025276229035432, 1.0160124975590705, 1.0321840573122958, 1.0175438596491229, 1.12, 1.0224184393096727, 1.0, 1.8181818181818181, 1.0, 1.3575482406356414, 1.1151670951156811, 1.2962962962962963, 1.019935691318328, 1.0031857443080512, 1.0178858800166755, 1.1798245614035088, 1.168862654158322, 1.195945945945946, 1.0847457627118644, 1.0238095238095237, 1.0, 1.0526315789473684, 1.0133439872153416, 1.6341463414634145, 1.0689655172413792, 1.0182896688087, 1.0957683741648108, 1.0818490167367893, 1.0054655421151926, 1.076248619861012, 1.1972789115646258, 1.08125, 1.026955074875208, 1.005211115120895, 1.0273783869714206, 1.0, 1.0575569358178054, 1.0239382083652644, 1.0103959307887347, 1.0782508630609897, 1.0305341461449633, 1.0062595161563188, 1.0344827586206897, 1.0004722266464363, 1.2019215868588253, 1.194585448392555, 1.0267379679144386, 1.027795063264883, 1.004642166344294, 1.0913385826771653, 1.0, 1.006899833452296, 1.0901071907101385, 1.0696202531645569, 1.3432835820895523, 1.0909090909090908, 2.6666666666666665, 1.0708745889097975, 1.1272727272727272, 1.138859460051876, 1.5, 1.5, 1.1764705882352942, 1.0062843676355067, 1.5714285714285714, 1.1353591160220995, 1.1192443919716648, 1.1026548672566372, 1.019691780821918, 1.0523088831401626, 1.0178571428571428, 1.0, 1.0500145736400635, 1.1143131604226706, 1.0718038528896672, 1.0142693579849038, 1.0568141413115253, 1.003406566279931, 1.09697933227345, 1.0399802827315459, 1.075956937799043, 1.0692524892257393, 1.3865145581474545, 1.6363636363636365, 1.039027964635787, 1.2473347547974414, 1.25, 1.0416666666666667, 1.0727272727272728, 1.0, 1.2061855670103092, 1.0146936323041418, 1.0167130919220055, 1.2239263803680982, 1.025436983619084, 1.0176174496644295, 1.001173902979399, 1.008526601191708, 1.4, 1.048999636231357, 1.2, 1.0017464106434515, 1.0381165919282511, 1.0124118155750763, 1.275, 1.0, 1.1304347826086956, 1.4929577464788732, 1.023533629453191, 1.0, 1.0489296636085628, 1.0207852193995381, 1.0440705128205128, 1.0007934593373888, 1.1666666666666667, 1.0628930817610063, 1.017516875263676, 1.0854410682962712, 1.0717928935750718, 1.1452991452991452, 1.0, 1.2386634844868736, 1.0098522167487685, 1.1682242990654206, 1.0262839356735258, 1.043970396168916, 1.0450704225352112, 1.2291666666666667, 1.0219478737997256, 1.0388635754489413, 1.4285714285714286, 1.0277153322538555, 1.064102564102564, 1.0, 1.009331217162872, 1.1904761904761905, 2.0, 1.0410533958154577, 2.0, 1.0069060773480663, 1.056686046511628, 1.0123051681706317, 1.0094553706505296, 1.0887728459530026, 1.0879120879120878, 1.0176274029681138, 1.018655050997636, 1.0040871934604905, 1.01338198515846, 1.0988456540019875, 2.0, 1.2222222222222223, 1.0129632630384962, 1.3333333333333333, 1.0498357064622126, 1.0, 1.0, 1.0454545454545454, 1.1745283018867925, 1.0853307766059443, 1.3298969072164948, 1.0562770562770563, 1.0, 1.003328894806924, 1.0003695719125347, 1.5, 1.0476474091721262, 1.0, 1.009458741364913, 1.0595238095238095, 1.078667016531094, 1.1705069124423964, 1.0018181818181817, 1.2229166666666667, 1.1481481481481481, 1.005929119059694, 1.0062373981869366, 1.0386151797603196, 1.0, 1.1428571428571428, 1.8333333333333333, 1.5, 1.1428571428571428, 1.0026431208118431, 1.25, 1.0682196339434276, 1.0693069306930694, 1.0440136830102622, 1.0116614475367176, 1.0092687950566426, 1.086855901383838, 1.0354354354354354, 1.263157894736842, 1.5, 1.1059907834101383, 1.0981308411214954, 1.001083554057308, 1.3333333333333333, 3.142857142857143, 1.1135857461024499, 1.044186046511628, 1.0085154522548465, 1.2, 1.342769701606733, 1.0240963855421688, 1.4035087719298245, 1.0808477237048666, 1.0572033898305084, 1.2884615384615385, 1.0537313432835822, 1.128440366972477, 1.0323367439291906, 1.0054367662680794, 1.0320605559574247, 1.0813953488372092, 1.0, 1.0654761904761905, 1.0, 1.0690893565724044, 1.037197174223757, 1.0165933942058392, 1.0141237150673046, 1.0240963855421688, 1.0234146341463415, 1.8333333333333333, 1.0684997588036662, 1.2, 1.111870196413322, 1.1111111111111112, 1.006160523453173, 1.017391304347826, 1.1269346517626828, 1.1699604743083003, 1.0987654320987654, 3.0, 1.1780538302277432, 1.0004004769316186, 1.0632701857642082, 1.0, 1.1886792452830188, 1.0547024952015356, 1.2988505747126438, 1.105319587628866, 1.0212314225053079, 1.105263157894737, 1.2476272648835203, 1.1048449295346718, 1.061681161584114, 1.0021519980949525, 1.0856359649122806, 1.197346600331675, 1.0378787878787878, 1.1538461538461537, 1.0456852791878173, 1.3, 1.049113233287858, 1.121212121212121, 1.0364679238893475, 1.0, 1.081410352588147, 1.0995446042213866, 1.13277428371768, 1.0, 1.1067961165048543, 1.2, 1.003346433713374, 1.175054704595186, 1.0, 1.0303951367781155, 1.036198544268361, 1.182263596276335, 1.0, 2.0, 1.185242718446602, 1.0026954177897573, 1.2923728813559323, 1.0, 1.0331898542120193, 1.0402750491159136, 1.0869565217391304, 1.0286710577295621, 1.0272727272727273, 1.0183727034120735, 1.157258064516129, 1.0004206983592765, 1.1375925607026003, 1.0, 1.054054054054054, 1.081231151321625, 1.0045772959933197, 1.0426509851634054, 1.0, 1.026566757493188, 1.0062908251091147, 1.0282870612886328, 2.0, 1.1228070175438596, 1.0478673320465137, 1.1011800557608766, 1.1827355729325937, 1.0310370489921814, 1.136388111135042, 1.0899159663865545, 1.0954676952748312, 2.0, 1.0245490723034782, 1.2758620689655173, 1.0, 1.2781456953642385, 1.1304347826086956, 1.042260495623656, 1.0379188712522045, 1.0741441596421812, 1.0106679035250463, 1.072710388576666, 1.0223184093061004, 1.0118127073291954, 1.1067961165048543, 4.0, 1.0679342215820429, 1.0012145748987855, 1.0023614225300144, 1.00633985862403, 1.071778140293638, 1.1008462623413258, 1.1546961325966851, 1.4285714285714286, 1.0190542351014737, 1.0213697592281037, 1.009713134449743, 1.1127737226277372, 1.0454591271041225, 1.045360824742268, 1.0019506832255836, 1.0010799136069115, 1.0680272108843538, 2.0, 1.0, 1.0107361963190185, 1.0541044776119404, 1.0067567567567568, 1.02937576499388, 1.0828025477707006, 1.0994475138121547, 1.0554699537750385, 1.0714285714285714, 1.0001391432117592, 1.3950617283950617, 1.0214054292095247, 1.0, 1.1100478468899522, 1.4484126984126984, 1.3617021276595744, 1.0150269350722994, 1.1584283903675539, 1.007905138339921, 1.012970168612192, 1.0654792025098674, 1.0, 1.702127659574468, 1.8333333333333333, 1.0, 1.035294117647059, 1.1121076233183858, 1.336082474226804, 1.0564102564102564, 1.0259532201217558, 1.0641975308641975, 1.0350107909972253, 1.0116347860382569, 1.103448275862069, 1.0345332389696258, 1.0755813953488371, 1.062225015713388, 1.1340106434446058, 1.0399175894926602, 1.1026011560693643, 1.0573302909298345, 1.0367782272894446, 1.0185753761129874, 1.0133015449620546, 2.0, 1.0626631853785902, 1.0462107208872458, 1.062937062937063, 1.0, 1.0, 1.1538461538461537, 1.050185873605948, 1.5555555555555556, 1.5, 1.0325905222968084, 1.0290030211480363, 1.0045655604128405, 1.063151982025357, 1.135135135135135, 1.0291616038882139, 2.0, 1.1492537313432836, 1.1956952003958436, 1.0292111486255586, 1.0067899940325469, 1.0055815013099443, 1.0044899425287357, 1.0875706214689265, 1.0185829997206963, 1.1492007104795736, 1.019231867993738, 1.0675841036164084, 1.3333333333333333, 1.1080485115766263, 1.0, 1.0090702947845804, 1.0223933793487143, 3.0, 1.0658511722731907, 1.039422256166045, 1.2857142857142858, 1.1743802352144852, 1.1, 1.1875, 1.0054036827195467, 1.7692307692307692, 1.0184547333309162, 1.0170867150790261, 1.1875, 1.380952380952381, 1.2630208333333333, 1.0043041606886658, 1.0934105720492397, 1.009088974678542, 1.011828157957974, 1.0, 1.2095372583097979, 1.0, 2.0, 1.1123463339253177, 1.0187559477463448, 1.1059602649006623, 1.0185161164796679, 1.0484995569937208, 1.3294117647058823, 1.8571428571428572, 1.0220616203879802, 1.0180623973727423, 1.0470534335601445, 1.062374916611074, 1.0416001475427787, 1.0898724567263893, 1.0293040293040292, 1.0508209538702111, 1.1115241635687731, 1.0017023833366714, 1.0599369085173502, 1.0833333333333333, 1.353466386554622, 1.0520954776952813, 4.0, 1.011666317114094, 1.0148308664923809, 1.0059607478413426, 1.2666666666666666, 1.0037494792389945, 1.1885964912280702, 1.0, 1.0206256074295381, 1.0134426229508198, 1.0713450292397662, 1.1470588235294117, 1.6666666666666667, 1.016200777582661, 1.5, 1.2852852852852852, 1.0769230769230769, 1.06430116530598, 1.2857142857142858, 1.253968253968254, 1.1174004192872118, 1.0, 1.253968253968254, 1.0486968449931413, 2.0, 1.0, 1.08130081300813, 1.0740740740740742, 1.0817479191438764, 1.0449561403508771, 1.0125, 1.0059347181008902, 1.089150378938971, 1.0467532467532468, 1.5217391304347827, 1.1722488038277512, 1.3076923076923077, 1.0, 1.1168539325842697, 1.2698412698412698, 1.004149377593361, 1.2426934466331918, 1.0057251574272392, 1.208516593362655, 1.0177200367592565, 1.0281593406593406, 1.0385078219013237, 1.020706455542022, 1.375, 1.0, 1.0303030303030303, 1.0400404113751707, 1.1262425447316102, 1.0065359477124183, 1.313915857605178, 1.0372661321114929, 1.0206589565383617, 1.002794141474047, 1.0512820512820513, 1.1578947368421053, 1.0458919319022946, 1.1200954400848355, 1.0240349941989904, 1.0268441295814112, 1.2105263157894737, 1.0506497341996457, 1.001907007779682, 1.1468428781204112, 1.0015274949083504, 1.0, 1.0502607871028924, 1.4072900158478605, 1.0384615384615385, 1.2832167832167831, 1.0347890451517394, 1.0, 1.086848635235732, 1.0131642785522528, 1.2592592592592593, 1.0067399701870523, 1.1408898305084745, 1.048780487804878, 1.047068658452368, 1.0012271710098894, 1.1363147998925598, 1.0143129770992367, 1.0256111757857975, 1.0081717763751128, 1.1475409836065573, 1.0714285714285714, 1.0, 1.1111111111111112, 1.0193532760082353, 1.8333333333333333, 1.0046076704160456, 1.062301437725486, 1.1355782011519717, 1.0862998921251348, 1.0056992754997534, 1.10021436227224, 1.041044776119403, 1.0110957004160888, 1.0195599596120881, 1.0331703065226865, 1.0056180044579728, 1.0138901608816435, 1.25, 1.103448275862069, 1.300395256916996, 1.0015101282741143, 1.0293159609120521, 1.0239637305699483, 1.1752212389380532, 1.0058479532163742, 1.0416841047961831, 1.002691790040377, 1.0031197504199665, 1.3125, 1.0496258207234133, 1.0124774454137628, 1.1579187585577362, 1.0008428150021071, 1.21875, 1.0278372591006424, 1.099502487562189, 1.625, 1.0466890340808759, 1.3076923076923077, 1.1441753171856979, 1.0483516483516484, 1.2339851652056641, 1.0005053908355794, 1.0729411764705883, 1.1, 1.051643192488263, 1.002481708886356, 1.0131947806311428, 1.0088499466113938, 1.0105716264801927, 1.040992329368897, 1.0, 1.0593645484949832, 1.0375073256495408, 1.1340238403500156, 1.0162932790224033, 1.1944444444444444, 1.1001984126984128, 1.0125248892029033, 1.1380165289256199, 1.020169240164006, 1.0, 1.3333333333333333, 1.0018937427377685, 1.0193631669535284, 1.0085218469166408, 1.052965398801741, 1.0734237829209896, 1.056338028169014, 1.0070083094301683, 1.0842490842490842, 1.020637898686679, 1.281081081081081, 1.0063424947145878, 1.006061944730771, 1.0119047619047619, 2.3333333333333335, 1.025880081882882, 1.003598871705087, 1.0269320843091334, 1.24822695035461, 1.0499637943519189, 1.0206811875004436, 1.0162857142857142, 1.105, 1.3076923076923077, 1.0855795148247978, 1.0126315789473683, 1.09375, 1.5925925925925926, 1.018516035311208, 1.009, 1.0855085508550855, 1.2058823529411764, 1.0430534657438058, 1.0237954768928221, 1.0095958913366672, 1.0124323240425106, 1.6666666666666667, 1.037037037037037, 2.0, 1.0402173913043478, 1.6923076923076923, 1.3333333333333333, 1.5, 1.2197092084006462, 1.0615384615384615, 1.0750495086154246, 1.0182026659022503, 1.3157894736842106, 1.5735294117647058, 1.0, 1.032258064516129, 1.2567567567567568, 1.3725490196078431, 1.014018691588785, 1.016351147822211, 1.0047046017118488, 1.03125, 1.0300773476128926, 1.0006756418597669, 5.0, 1.0058606376101529, 1.11, 1.0, 1.3333333333333333, 1.0094674556213017, 1.1265150971813813, 1.0531994712208368, 1.046583850931677, 1.0, 1.075, 1.5828220858895705, 2.0, 1.5, 1.0991633858267718, 1.0189015203396794, 1.1092169092169093, 1.25, 1.0221311364527954, 1.0635166537567777, 1.0230849947534102, 1.1428571428571428, 1.065, 1.0015092335513711, 1.5921052631578947, 1.0809224810750542, 1.0538568450312717, 1.0340632603406326, 1.003921568627451, 1.0133884297520661, 1.1673783091374894, 1.0867768595041323, 1.2545454545454546, 1.0244015158517423, 1.093779264214047, 1.00930820119012, 1.31496062992126, 1.3076923076923077, 1.164179104477612, 1.038860103626943, 1.0417690417690417, 1.0093187725413553, 1.020348725809542, 1.0764192139737991, 3.0, 1.25, 1.025314837307422, 1.1297273526824978, 1.172340011670881, 1.01771105254612, 1.0140491721023583, 1.1049955884206546, 1.1424870466321244, 1.0833333333333333, 1.0273563399103844, 1.0161800661584928, 1.1019446081319977, 1.0035026269702276, 2.5, 1.0, 1.019039583256906, 1.1077658303464755, 1.041884408392481, 1.017869659381768, 1.1214488636363635, 2.0, 1.022196261682243, 1.011703670645989, 1.0283299063285356, 1.11787072243346, 1.000697325132313, 1.3083333333333333, 1.26890756302521, 1.0968115942028986, 1.0032658321864691, 1.0576032763532763, 1.0933179723502304, 1.1382842509603073, 1.03125, 1.0558783321941216, 1.0070194011645301, 1.0673712021136064, 1.0330672878201395, 1.044767441860465, 1.0584467574059246, 1.3846153846153846, 1.0445859872611465, 2.5, 1.5, 1.4166666666666667, 1.0383631713554988, 1.1311216429699842, 1.0377288425117903, 1.0360428224534288, 1.008955223880597, 1.0981171548117155, 1.0706521739130435, 1.5918367346938775, 1.0449247954965257, 1.6, 1.3333333333333333, 1.1232520325203252, 1.0, 1.1625386996904026, 1.1162904808635918, 1.0232537178909418, 1.0204265472074792, 1.25, 1.0343653250773994, 1.375968992248062, 1.1458852867830425, 1.0000871583621567, 1.0126262626262625, 1.0314376545390322, 1.0261364771705466, 1.0633331426282968, 1.109697933227345, 1.4791666666666667, 1.282122905027933, 1.0, 1.0, 1.000849397374915, 1.6666666666666667, 1.5714285714285714, 1.3846153846153846, 1.0036188178528347, 1.0930232558139534, 1.0302684180468304, 1.0996548748921484, 1.1666666666666667, 1.1663563004345128, 1.020870602265951, 1.1390134529147982, 1.0531645569620254, 1.25, 1.0508399646330682, 1.2699556541019956, 1.0864978902953586, 1.1175158051320193, 1.01249521365899, 1.0954157259251989, 1.0323664122137404, 1.0, 1.04013201320132, 1.0083713689650424, 1.0275735294117647, 1.2695652173913043, 1.0255658609255611]
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.5919	median: 1.0528	mean: 1.1471

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 16.154020 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=naru', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[4.7683716e-07 1.2516975e-06 0.0000000e+00 1.7881393e-07 8.9406967e-07]
Distance score: 5.602836381513043e-07
SAUCE Drift detection: False
Detection latency: 0.0232s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 2.031810 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 6.0000	99th: 2.6700	95th: 1.6670	median: 1.0650	mean: 1.1658
ReportEsts: [1.0589887640449438, 1.0484862280901435, 1.0319078783656, 1.004823151125402, 1.0588235294117647, 1.0, 1.1154655947937602, 1.0048056230280664, 1.6, 1.0264900662251655, 1.0543613115584252, 1.0020156774916014, 1.028860028860029, 1.0329457364341086, 1.0388378298250815, 1.0526315789473684, 1.0620915032679739, 1.0666666666666667, 1.6666666666666667, 1.0991810737033667, 1.0826293014630126, 1.0126433294275192, 1.2, 1.118628359592215, 1.0396571366570824, 1.0007853080090199, 2.0, 1.0308385401303264, 1.1666666666666667, 1.6, 1.025974025974026, 1.0, 1.0018149971629655, 1.0025008712051329, 1.463855421686747, 1.018746195982958, 1.0153121651345103, 1.0, 1.4, 1.0490867858275013, 1.0080975428145942, 1.1384751511576463, 1.0912364945978392, 1.0028463276504593, 1.005281690140845, 1.0194288694745077, 1.3, 1.6341463414634145, 1.3815028901734103, 1.1252847380410023, 1.0227272727272727, 1.0211267605633803, 1.0675675675675675, 1.0625, 1.0411123682486751, 1.0155209737368787, 1.06036784336992, 1.128440366972477, 1.0843373493975903, 1.016872006080639, 1.0147058823529411, 1.027801740704994, 1.0813124108416547, 1.037174721189591, 1.16, 1.75, 1.1319665030320532, 1.0323672519568436, 1.5714285714285714, 2.0, 1.0288033099936347, 1.0110552763819096, 1.0617760617760619, 1.1366223908918407, 1.0539401918375024, 1.6724137931034482, 1.074787720444154, 1.031390134529148, 1.1134751773049645, 1.0106584448734253, 1.2334723049434186, 1.0774647887323943, 2.0, 3.0, 1.016184971098266, 1.1694915254237288, 1.1212898497618176, 1.024390243902439, 1.25, 1.0513890449212795, 1.0894255874673628, 1.0411933701657459, 1.0132518894295475, 1.1166718798873945, 1.0, 1.2760233918128654, 1.178030303030303, 1.38996138996139, 1.2258064516129032, 1.2077972709551656, 1.4838709677419355, 3.0, 1.0344571605320136, 1.1788756388415673, 1.0507726269315674, 1.0110210890027405, 1.0769230769230769, 1.0103157817587871, 1.1215277777777777, 1.0346941571340502, 1.0377777777777777, 1.0211212516297261, 1.1428571428571428, 2.0, 1.1397399162442143, 1.0238768591239757, 1.0834292289988492, 1.1318681318681318, 1.0070105728356404, 2.0, 1.1763978992894655, 1.1931540342298288, 1.0, 1.1814159292035398, 1.5, 1.0269709543568464, 1.003842481818932, 1.0982062201574396, 1.0227272727272727, 2.0, 1.1614654002713705, 1.0, 1.2727272727272727, 1.0052797332345313, 1.1538461538461537, 1.0048899755501222, 1.035131213654903, 1.0113467691394267, 1.0, 1.2666666666666666, 1.026530612244898, 1.0379981464318813, 1.0614644575093533, 1.06186341456812, 1.2606382978723405, 1.0551351351351352, 1.0306913644664752, 3.0, 1.0092201306185171, 1.0406342913776017, 1.0353000504286434, 1.0190546528803546, 1.0, 1.0882794515063556, 1.025735294117647, 1.0453781512605043, 1.0624327233584498, 1.0, 1.0887991927346115, 1.0360566270961122, 1.0385394016645422, 1.226537216828479, 1.1185983827493262, 1.0178571428571428, 1.1235294117647059, 1.0986486486486486, 1.4285714285714286, 1.008277964953227, 1.6, 1.0119904076738608, 1.001630395590407, 1.0666666666666667, 1.0625220926122305, 1.0417422867513613, 1.0650263620386644, 1.1679149553032133, 1.0, 1.1251008878127522, 1.0139802631578947, 1.0487997889738856, 1.0014914243102162, 1.0044028383346157, 1.018987341772152, 1.45, 1.0054064087987562, 1.0255624974478337, 1.0905797101449275, 1.0366923978396005, 1.1917808219178083, 3.0, 1.0804020100502512, 1.0023101956156348, 1.1333333333333333, 1.0155763239875388, 1.0108344496099597, 1.0039171078402025, 1.003722533200412, 1.0461538461538462, 1.004701664683152, 1.021419102165305, 1.088, 1.0164240678757686, 1.1020461699895068, 1.001977207913317, 1.1702349869451698, 1.0713404967412365, 1.2372881355932204, 1.0384615384615385, 1.07, 2.0, 1.0648648648648649, 1.0101043238632637, 1.6842105263157894, 1.1470588235294117, 1.0194134655101197, 1.1, 1.003153014551577, 1.0483870967741935, 1.0530156866034728, 1.0, 1.0327868852459017, 1.0663425793537318, 1.0047360406699999, 1.0434387150296356, 2.1666666666666665, 1.0264416315049227, 1.029414659754577, 1.0520723295842913, 1.018716577540107, 1.2092257001647446, 1.017435320584927, 1.056301652892562, 1.0862068965517242, 1.0007643834594877, 1.0387308039747065, 1.177304964539007, 1.0745393634840872, 1.0011454753722795, 3.0, 1.1511318242343542, 1.0, 1.010886777513856, 1.1033630299920705, 1.0883274578926754, 1.2140672782874617, 1.0769230769230769, 3.3333333333333335, 1.0843906584229495, 1.1194029850746268, 1.1059967969630464, 2.25, 1.0593915982617093, 1.0711206896551724, 1.4285714285714286, 1.0212784415789267, 1.173396674584323, 1.1395582329317269, 1.0455840455840455, 1.0233545647558386, 1.0722479441641906, 1.1515151515151516, 2.0, 1.0076502826714615, 1.1326892293619941, 1.1030927835051547, 1.0718861209964412, 1.0642681102942726, 1.0532785117669892, 1.0931923331130204, 1.018797378337561, 1.0725075528700907, 1.1227638060668914, 1.1966491378256083, 1.3571428571428572, 1.0881211878812118, 1.214527027027027, 1.2641509433962264, 1.0714285714285714, 1.0247106255689946, 1.168724279835391, 1.0254190711733993, 1.015971978984238, 1.3102625298329356, 1.2461538461538462, 1.002891620133452, 1.0319602272727273, 1.0853973376361437, 1.010733863837312, 1.3846153846153846, 1.95, 1.0736196319018405, 1.0601114699317964, 1.0715267525327088, 1.0323415080317841, 1.0721485411140583, 1.015, 1.0057126535275636, 1.0233149787412001, 1.0036889640007995, 1.0607970549683465, 1.0824230387288978, 1.5, 1.25, 1.0756721944936403, 1.4, 1.0619136960600375, 1.113700966458215, 1.0133478346845957, 1.2058823529411764, 1.5739130434782609, 1.0641114982578397, 1.0578325807572073, 1.0090646174186084, 1.0869565217391304, 1.1270259586243248, 1.0073961228884118, 1.1521739130434783, 1.4375, 3.2857142857142856, 1.0394353573829263, 1.3333333333333333, 1.0150506109557833, 1.1009463722397477, 1.0454545454545454, 1.0499484325906028, 1.1111111111111112, 1.8888888888888888, 1.0252545147685423, 2.0, 1.0831295843520783, 1.056470588235294, 1.1524967896687908, 1.1655722326454034, 1.1893095768374164, 1.1962616822429906, 1.0142311892725655, 1.0000812171747253, 1.0159574468085106, 1.0070092179764216, 1.0799096782286897, 3.0, 1.0909090909090908, 1.0262836722937678, 1.25, 1.046967624259006, 1.0, 2.0, 1.0384615384615385, 1.224821973550356, 1.081059390048154, 1.2357723577235773, 1.1037735849056605, 1.3150684931506849, 2.25, 1.010281935021989, 1.0625, 1.1428571428571428, 1.051045921779662, 1.2116788321167884, 1.067253803042434, 1.019736842105263, 1.8, 1.0, 1.1653543307086613, 1.1666666666666667, 1.005893909626719, 1.0121847815846496, 1.0704503392967304, 1.01, 1.5, 1.0082772375966094, 1.0943396226415094, 1.7391304347826086, 1.5, 1.0954907161803713, 1.0, 1.2010309278350515, 1.0743801652892562, 1.0150109521968818, 1.0309781501847488, 1.2692307692307692, 1.0929696504033808, 1.0452893486161587, 1.0847240051347882, 1.02710027100271, 1.019350929677737, 1.0674662668665666, 1.0256410256410255, 1.015458238326084, 1.0104309165526675, 1.1248673505482845, 1.0445544554455446, 1.0909090909090908, 1.0779467680608366, 2.0, 1.8148148148148149, 1.287037037037037, 1.0113207547169811, 1.6451612903225807, 1.2955974842767295, 1.0236299648064353, 1.1025641025641026, 1.0311856519232354, 1.1713505074160813, 1.182247403210576, 1.1612903225806452, 1.1209677419354838, 1.0767326732673268, 1.0, 1.0134929105046502, 1.4, 1.0007915716466576, 1.0082405055045274, 1.0016701129314458, 1.0016034206306788, 2.0, 1.0016044925792218, 1.5, 1.0221313447197498, 1.0909090909090908, 1.0912987569652808, 1.008433734939759, 1.0119895429550168, 1.0744336569579287, 1.0541871921182266, 4.0, 1.0607012035583465, 1.010557892101, 1.074091091838493, 1.5, 1.2333333333333334, 1.011208967173739, 1.2860520094562649, 1.1057092650656375, 1.2201073694485114, 1.04, 1.003556187766714, 1.140031507089095, 1.0519472459270753, 1.0118400911951442, 1.0639483649701098, 1.1374438021836866, 1.0756302521008403, 1.230093355299286, 1.0007609511889863, 1.3208955223880596, 1.113870381586917, 2.0, 1.0, 1.223841059602649, 1.1004016064257027, 1.1949095780308105, 1.0928504233301977, 1.143768115942029, 1.0, 1.115702479338843, 1.15625, 1.018455590375115, 1.0833333333333333, 1.0, 1.0499612545372976, 1.0, 1.0, 1.1096919609316303, 1.75, 1.1737012987012987, 1.0181132075471697, 1.3639846743295019, 1.0909090909090908, 1.019070780349402, 1.0571192052980132, 1.0740740740740742, 1.0343522286363207, 1.0887096774193548, 1.0033444816053512, 1.1528619528619528, 1.0611888111888113, 1.1650337677161609, 1.0, 1.043956043956044, 1.035014005602241, 1.0518867924528301, 1.120152091254753, 1.1666666666666667, 1.0199248120300752, 1.0068249985540256, 1.029296020988194, 2.0, 1.1362725450901803, 1.089217365767706, 1.1253189836902253, 1.1778707916287534, 1.0289455907983176, 1.0447515716273814, 1.0275229357798166, 1.3683333333333334, 1.5, 1.1385461315322336, 1.193798449612403, 1.0485436893203883, 1.0278396436525612, 1.0541237113402062, 1.0440954021946132, 1.1855670103092784, 1.0633444198666433, 1.0517448856799037, 1.0256860824643275, 1.0969945355191257, 1.0034858821771824, 1.1661524569192565, 1.1411764705882352, 1.1162790697674418, 1.0437892510081312, 1.0762886597938144, 1.064625564247063, 1.0090843533719809, 1.3333333333333333, 1.2475209763539283, 1.2908011869436202, 1.1272727272727272, 1.2340425531914894, 1.0092664030604044, 1.1470588235294117, 1.1159682080924855, 1.0, 1.0869565217391304, 1.0281456953642385, 1.033356204148414, 1.0301459293394777, 1.0252053428503949, 1.041955490696826, 1.1578947368421053, 1.0895765472312704, 1.0696309777833564, 1.3037037037037038, 1.0384537903675697, 1.079512893982808, 1.0803571428571428, 1.0517089141326454, 1.0643642072213502, 1.0121120560540744, 1.0, 1.1808585503166784, 1.6620209059233448, 1.0351473740189838, 1.040084388185654, 1.0768482490272373, 1.1537190082644628, 1.4831460674157304, 1.01403095325326, 1.0, 1.625, 2.0, 1.0, 1.0495049504950495, 1.2686084142394822, 1.3611111111111112, 1.2253521126760563, 1.0327384945659466, 1.1297786720321932, 1.0063686991289447, 1.0164373403641758, 1.0635233585951127, 1.00448353031949, 1.0246979429976113, 1.0395277207392197, 1.0210069797384291, 1.0034363642905977, 1.051935325820676, 1.0264026402640265, 1.1533586818757922, 1.0754716981132075, 1.0123770359619417, 1.233910891089109, 1.0148944230654198, 1.1148325358851674, 1.1366594360086768, 1.0354984894259818, 2.5, 1.0224852071005917, 1.0625, 2.0, 1.5366568914956011, 1.005897850428118, 1.043159922928709, 1.12565445026178, 1.0909090909090908, 1.0227982548883785, 1.1315295125729163, 1.0482374768089053, 1.2, 2.0, 1.1057554814108674, 1.3800904977375565, 1.0395002015316406, 1.0177263058378634, 1.0, 1.2024197301070265, 1.126491646778043, 1.0680808584976291, 1.2059259259259258, 1.0276882549113022, 1.0332112127349424, 1.0110798419807894, 1.24, 1.0, 1.112344673049501, 1.0, 1.0593939393939393, 1.1853448275862069, 1.1280632411067193, 1.0947322255250718, 1.4137931034482758, 1.0585870093317027, 1.1597222222222223, 1.0674603174603174, 1.011232411450752, 1.0450980392156863, 1.0276941601444913, 1.0725352112676056, 1.020627802690583, 1.0098264002620374, 1.4, 1.0249970429365611, 1.0695514038056428, 1.4736842105263157, 1.027359781121751, 1.0222402597402598, 1.1444759206798867, 1.0563157942213843, 1.0909090909090908, 1.0628683693516698, 1.0036217697729053, 1.1797752808988764, 1.1702127659574468, 1.030518679536613, 1.2432432432432432, 1.875, 1.0086124401913876, 1.0377622377622377, 1.0511316247049012, 1.0747301411569332, 1.0442652750931687, 1.0354883281215912, 1.1705069124423964, 1.0153556878721404, 1.168284789644013, 1.0056856884687566, 1.0610727562400424, 1.0225505443234837, 1.123963334788302, 1.0543130990415335, 1.0740740740740742, 1.1109087597887453, 1.263157894736842, 1.6, 1.0372670807453417, 1.0360193093204604, 1.013622291021672, 1.0010626992561105, 1.4444444444444444, 1.0334661354581673, 1.0974412898703119, 1.481818181818182, 1.069289916058957, 2.6666666666666665, 1.2105263157894737, 1.5, 1.4150943396226414, 1.0588235294117647, 1.0943648853184305, 1.303030303030303, 1.1687763713080168, 1.1097453906935908, 1.0, 1.054024255788313, 1.0768779342723005, 2.25, 1.5, 1.0324675324675325, 1.1037735849056605, 1.0635624538063562, 1.0366726296958855, 1.0625, 1.2281167108753315, 1.1229050279329609, 1.0405286343612334, 1.5128205128205128, 1.1135531135531136, 1.4074074074074074, 1.0, 1.0661896243291593, 1.2326968973747017, 1.0278776978417266, 1.2647540089451292, 1.0137101066451142, 1.2212638842140693, 1.0040129008249086, 1.0878792848942103, 1.0601805416248746, 1.0009886307464162, 1.5, 1.0, 1.0512820512820513, 1.0350473568642873, 1.1596638655462186, 1.0193370165745856, 1.1738095238095239, 1.1218781855249744, 1.045492848950165, 1.0021189192493116, 1.064516129032258, 1.0434782608695652, 1.0454545454545454, 1.0503019223311727, 1.0526570502910455, 1.0381694534151906, 1.252808988764045, 1.0881425125255149, 1.043827631047935, 1.0073773196099323, 1.0029476787030214, 1.0291720084177935, 1.0357142857142858, 1.0397794407246947, 1.0649953574744662, 1.0071579146549507, 1.0, 1.0555555555555556, 2.0, 1.0855949895615866, 1.024354151684461, 1.1428571428571428, 1.001127874421135, 1.1447484554280671, 1.1304347826086956, 1.0595993052470007, 1.0051158591634066, 1.1118005478226842, 1.0200642054574638, 1.0361681329423265, 1.015956571804573, 1.1646859083191852, 1.0588235294117647, 1.0, 1.2, 1.0122349431589133, 1.3, 1.0091346005730306, 1.038984912681866, 1.0974097044874134, 1.073100983020554, 1.0874553270834413, 1.122778675282714, 1.0438871473354232, 1.0214541120381406, 1.0012550338194472, 1.030566105986616, 1.006133423961936, 1.0378171253975808, 1.4444444444444444, 1.1187150837988826, 1.260586319218241, 1.0102435026925778, 1.0842391304347827, 1.00747463961559, 1.1457431457431457, 1.014657980456026, 1.054148280608766, 1.032258064516129, 1.0102449399382907, 1.3888888888888888, 1.0260023156779245, 1.008961994250536, 1.0687925474740236, 1.0207959842237362, 1.1282051282051282, 1.0071942446043165, 1.0416337163325116, 1.046896952667022, 1.1, 1.004493757440403, 1.0, 1.0272138543258387, 1.177024482109228, 1.1224489795918366, 1.0769230769230769, 1.145175834084761, 1.1156716417910448, 1.0690759377859103, 1.0345287133511025, 1.034416826003824, 1.0401421722275928, 1.0253009775218878, 1.0666666666666667, 1.067595818815331, 1.0478550675098275, 1.0023322899404652, 1.1042109740535941, 1.231506120276743, 1.2189349112426036, 1.2244897959183674, 1.021656050955414, 1.0159552659787296, 1.05, 1.0220289855072464, 1.015823099076434, 1.0254763877381938, 1.5832012678288432, 1.0389397513293088, 1.0912226129294023, 1.043218085106383, 1.0950413223140496, 1.0085579487179488, 1.1087163144358716, 1.0410742496050553, 1.3105022831050228, 1.0362663495838287, 1.0183304180603718, 1.0392156862745099, 1.75, 1.0204182345321078, 1.0042696863868938, 1.0014299332697807, 1.255813953488372, 1.065389294403893, 1.022341608879843, 1.0004671805652885, 1.0632075471698113, 1.2258064516129032, 1.09695603156708, 1.125, 1.082687338501292, 1.4848484848484849, 1.0649298709029353, 1.0064882400648825, 1.036379769299024, 1.1627906976744187, 1.0165745856353592, 1.0053191489361701, 1.0303030303030303, 1.0588235294117647, 1.0166051660516606, 1.114678899082569, 1.094272681196148, 1.4, 1.0752850765900595, 1.03125, 1.2357746882614304, 1.1545454545454545, 1.1304347826086956, 1.0704512372634643, 1.130629530092027, 1.0032490878585316, 1.0909090909090908, 1.3181818181818181, 1.2105263157894737, 1.2352941176470589, 1.2727272727272727, 1.5660377358490567, 1.00544805560774, 1.0063300220284768, 1.0056150098192755, 1.08, 1.0048932663408292, 1.0009667270871097, 6.0, 1.0360179612114264, 1.1307703301414893, 1.6666666666666667, 1.2857142857142858, 1.066093366093366, 1.0956837963514963, 1.0525142211563236, 1.0508021390374331, 1.0, 1.3106382978723403, 1.070528967254408, 1.1764705882352942, 1.012460178706257, 1.027196192257958, 1.0031106665760332, 1.1642260680140384, 1.4444444444444444, 1.0163191652119334, 1.0742671009771987, 1.0288461538461537, 1.0834733893557422, 1.1028901734104046, 1.0, 1.051948051948052, 1.0884387351778657, 1.0736864140674063, 1.4183813443072701, 1.0304054054054055, 1.0158093250942941, 1.2211948790896159, 1.1180555555555556, 1.082191780821918, 1.0225391338422891, 1.0827350049707278, 1.0361004839824843, 1.9611650485436893, 1.1238095238095238, 1.014510278113664, 1.2, 1.029146021568056, 1.0443349753694582, 1.012193204646694, 1.0919324577861163, 1.5, 1.0155807365439093, 1.0111183513887758, 1.0873538011695907, 1.3875567077122488, 1.0037540087862231, 1.008927325986888, 1.087934489668993, 1.0741482965931863, 1.0172413793103448, 1.016922158072865, 1.0155672009864365, 1.0259042033235581, 1.4603399433427762, 2.5, 1.021505376344086, 1.087961423345527, 1.2130681818181819, 1.015621695918799, 1.011356546441704, 1.1175428233904312, 2.0, 1.0191339375629407, 1.0533004773177073, 1.0401836969001148, 1.0133779264214047, 1.0079020723547576, 1.1323076923076922, 1.4758064516129032, 1.0172579098753596, 1.0036310468153262, 1.0175214772092462, 1.127783155856728, 1.144396551724138, 1.054054054054054, 1.078911758421765, 1.073476838822545, 1.0498190517082746, 1.0304655800839007, 1.0444659255679072, 1.09404600811908, 1.0769230769230769, 1.0427807486631016, 2.5, 1.5, 1.4666666666666666, 1.052060737527115, 1.1337247227658187, 1.0656660993346743, 1.0645092725437058, 1.033288043478261, 1.0489498350980733, 1.1421800947867298, 1.1238938053097345, 1.0289118204518788, 1.6, 1.3571428571428572, 1.1849555136155299, 1.1111111111111112, 1.1636828644501278, 1.1293823038397328, 1.013487769564886, 1.011472740417424, 1.2, 1.2254189061018022, 1.0535331905781584, 1.0489046795736514, 1.0006229934260817, 1.1483715319662244, 1.0506253722453842, 1.0136977269355663, 1.0302271673620769, 1.160427807486631, 1.5084745762711864, 1.2284730195177955, 1.3333333333333333, 2.0, 1.000245736838186, 1.25, 1.625, 1.3404255319148937, 1.0575757575757576, 1.0152850513049771, 1.1325098259404829, 1.0358565737051793, 1.2857142857142858, 1.0118339844855897, 1.038, 1.1395348837209303, 1.0060240963855422]
origin-bjaq_15.87 	max: 6.0000	99th: 2.6700	95th: 1.6670	median: 1.0650	mean: 1.1658

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 17.293375 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=35.511501