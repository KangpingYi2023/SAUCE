Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='naru', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 70, 'naru': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.5767	median: 1.0560	mean: 1.1497
ReportEsts: [1.105263157894737, 1.0491803278688525, 1.0470088382977756, 1.0096153846153846, 1.0344827586206897, 1.0, 1.1177484204480184, 1.0256277373936573, 1.25, 1.03315649867374, 1.0815513808328283, 1.0022314851725393, 1.0793291024478695, 1.0604651162790697, 1.0360296714941717, 1.0, 1.6981132075471699, 1.0031880977683316, 3.0, 2.6666666666666665, 1.08, 1.1102868233771834, 1.0350596629351705, 1.0860969387755102, 1.005426739023187, 1.0, 1.0609101748807632, 1.0, 1.4, 1.223021582733813, 1.0, 1.007056455874954, 1.0108846759509866, 1.3662597114317425, 1.052070457354759, 1.0240335793108117, 1.0331491712707181, 1.0073622611271642, 1.1167435773813623, 1.0833333333333333, 1.1126961483594864, 1.0121951219512195, 1.0, 1.1353530881376301, 1.034243405830634, 1.2231404958677685, 1.1650485436893203, 1.2304347826086957, 1.0297516370517994, 1.0093457943925233, 1.0250415552504155, 1.0837988826815643, 1.0044974512143807, 2.0, 1.4805194805194806, 1.0829830508474576, 1.189446366782007, 1.0727969348659003, 1.2546583850931676, 1.6666666666666667, 1.0477553616866595, 1.0323785803237857, 1.0318181818181817, 1.1149425287356323, 1.1818181818181819, 1.1315288498148213, 1.0760295670538542, 1.1666666666666667, 1.0, 1.1276148428466308, 1.0047961630695443, 1.0560046189376444, 1.1013513513513513, 1.0746535743782692, 1.188235294117647, 1.134453781512605, 1.0, 1.0449389179755673, 2.0, 1.0557404803581165, 1.1875, 1.0542280018483068, 1.2699386503067485, 1.0435779816513762, 1.067574646411734, 1.0, 1.0052094625520946, 1.0176970100616065, 1.1176470588235294, 2.3333333333333335, 1.101620029455081, 1.0171871231861467, 1.0321543408360128, 1.3548387096774193, 1.2732558139534884, 1.1031518624641834, 1.3235294117647058, 1.0051194539249146, 1.0, 1.0142999366458503, 1.0460763138948883, 1.042933810375671, 1.0058921662584743, 1.1470588235294117, 1.0015931722982845, 1.143247344461305, 1.0291471296413637, 1.0265453166477057, 1.019375, 1.1666666666666667, 1.3333333333333333, 1.1257233035244607, 1.0134237920140867, 1.0602813127930342, 1.1168831168831168, 1.0095363074420014, 1.0, 1.32125, 1.1511961722488038, 1.0, 1.2142857142857142, 1.1666666666666667, 1.1027568922305764, 1.0267733023943517, 1.1411042944785277, 1.0769230769230769, 1.8, 1.2591059602649006, 1.0, 1.0357142857142858, 1.0064716647411844, 1.1818181818181819, 1.0584309895833333, 1.0068769743824855, 1.0486202365308803, 1.1435114503816795, 1.0993975903614457, 1.041396103896104, 1.00199203187251, 1.051923076923077, 1.0423389720234222, 1.2777777777777777, 1.075668623613829, 1.042250126839168, 2.0, 1.0176252319109462, 1.0736196319018405, 1.0620347394540943, 1.0328215987294864, 1.0, 1.018877236273905, 1.0548148148148149, 1.016, 1.4476190476190476, 1.0262773722627738, 1.0532670454545454, 1.0317273795534665, 1.0577148525565876, 1.1140684410646389, 1.1414473684210527, 1.0208333333333333, 1.210144927536232, 1.1058631921824105, 1.2857142857142858, 1.0141306815601872, 1.016195319827067, 1.0052083333333333, 1.0048790988017506, 1.0195479535736103, 1.045665367999788, 1.0421052631578946, 1.1029411764705883, 1.1545463348503922, 1.108744394618834, 1.1659959758551308, 1.066321243523316, 1.040983606557377, 1.0575221238938053, 1.027403900531597, 1.0, 1.4823529411764707, 1.0101211689237348, 1.0474002923366048, 1.1037735849056605, 1.0, 1.0411996878640173, 1.0194118777628292, 1.0440648091654803, 1.16, 1.104090909090909, 1.0376125222177628, 1.0, 2.3636363636363638, 1.081903514516481, 1.2656072644721907, 1.1055045871559632, 1.4, 1.0212218649517686, 1.004799169651161, 1.024326967669653, 1.1798245614035088, 1.114999472963002, 1.0350877192982457, 1.109375, 1.0, 1.0, 1.0526315789473684, 1.0116464582003828, 1.6724738675958188, 1.1149425287356323, 1.0177953534354918, 1.0957683741648108, 1.0686965596792208, 1.0298579959427412, 1.0416751234693187, 1.2661870503597121, 1.128874388254486, 1.0188180917794651, 1.0090126640971397, 1.0701222877749021, 1.0, 1.0844720496894409, 1.0119748685324876, 1.0114701976093694, 1.049272116461366, 1.021394694324282, 1.0045254610049061, 1.0344827586206897, 1.0015619804459048, 1.068761196086537, 1.1816130851663846, 1.0434782608695652, 1.1157436216552583, 1.0270162892332142, 1.1299212598425197, 1.0, 1.0321951219512195, 1.0245087092451988, 1.0161744022503516, 1.1753731343283582, 1.0909090909090908, 2.6666666666666665, 1.0534461230017058, 1.1090909090909091, 1.1193536804308797, 2.0, 1.5, 1.3333333333333333, 1.0546448087431695, 1.6122448979591837, 1.1353591160220995, 1.1504854368932038, 1.0815972222222223, 1.014480408858603, 1.0185327576349046, 1.0701754385964912, 1.0, 1.0048348106365834, 1.021133525456292, 1.0612959719789843, 1.0554219525648096, 1.0180322039924823, 1.0038214262284326, 1.0866454689984102, 1.0224459975705509, 1.0610047846889952, 1.0777411623726783, 1.2155545603821465, 1.6363636363636365, 1.0838098212569671, 1.2579957356076759, 1.25, 1.08, 1.1207272727272728, 1.0, 1.1818181818181819, 1.0204207750830838, 1.2033426183844012, 1.2314814814814814, 1.000291081834747, 1.0671441360787826, 1.0021216454171136, 1.023404379500077, 1.6, 1.0468352128046563, 1.2, 1.0074728201354395, 1.0367170626349893, 1.0024304765372536, 1.275, 1.1111111111111112, 1.0869565217391304, 1.6056338028169015, 1.0354410469359507, 1.0, 1.114678899082569, 1.01131221719457, 1.0380608974358974, 1.0015765254774662, 1.0988372093023255, 1.0062893081761006, 1.0318828223878498, 1.0435409947377354, 1.1129111219902978, 1.1452991452991452, 1.0, 1.233890214797136, 1.0344827586206897, 1.1214953271028036, 1.0868968043219485, 1.0252244548952545, 1.1024844720496894, 1.3111111111111111, 1.0054869684499315, 1.0422156493681096, 1.5714285714285714, 1.0315586833717296, 1.0531135531135531, 1.3571428571428572, 1.0645692229262254, 1.3333333333333333, 1.75, 1.0377383317762543, 2.0, 1.0068587105624143, 1.0508720930232558, 1.0508613617719442, 1.0783034257748776, 1.112271540469974, 1.120879120879121, 1.0163286841001637, 1.0133070438077618, 1.0208623087621698, 1.0023012122457367, 1.0592483419307295, 2.0, 1.1111111111111112, 1.0052607397197335, 1.3333333333333333, 1.0492610837438423, 1.0, 1.0, 1.0454545454545454, 1.1662763466042154, 1.0853307766059443, 1.2169811320754718, 1.066017316017316, 1.0, 1.0346205059920106, 1.0168737786240416, 1.5, 1.0238237045860632, 1.0, 1.0088969862597739, 1.1125, 1.0704539490947258, 1.152073732718894, 1.0018181818181817, 1.1600790513833992, 1.0740740740740742, 1.0249086253143973, 1.0073746217729995, 1.0359520639147803, 1.0, 1.1428571428571428, 1.8333333333333333, 1.5, 1.2307692307692308, 1.001966543061509, 1.25, 1.0465890183028286, 1.0594059405940595, 1.01270207852194, 1.0079782364173795, 1.0010309278350515, 1.0938459358617107, 1.0335731414868106, 1.2804878048780488, 1.5, 1.0, 1.0779816513761469, 1.0122339547280776, 1.2857142857142858, 3.142857142857143, 1.0846325167037862, 1.0343023255813955, 1.0026686570826773, 1.175792507204611, 1.342769701606733, 1.0345315595810927, 1.3333333333333333, 1.0808477237048666, 1.0529661016949152, 1.2692307692307692, 1.0568862275449102, 1.128440366972477, 1.0333353806467462, 1.0187345082123498, 1.0350196904794804, 1.34375, 1.3875, 1.075075075075075, 1.0, 1.0863177457431312, 1.0165417539689452, 1.0086183372748772, 1.0062980523570164, 1.0312679288582902, 1.0138530927835052, 1.8333333333333333, 1.0802501302761855, 1.2, 1.1033304867634501, 1.1111111111111112, 1.0186726584464172, 1.0057971014492753, 1.0820077386070508, 1.1897233201581028, 1.0577249575551784, 3.0, 1.0869149952244508, 1.0030449780676405, 1.0236279770309706, 1.0, 1.4, 1.0095969289827256, 1.2327586206896552, 1.0998317672643716, 1.0145530145530146, 1.1666666666666667, 1.0761374187558033, 1.0627293336761165, 1.0922324661266842, 1.0090911491106866, 1.1274122807017544, 1.252072968490879, 1.1666666666666667, 1.0714285714285714, 1.0450928381962865, 1.3, 1.048431105047749, 1.0303030303030303, 1.0284674159205875, 1.0, 1.09724759469005, 1.0081114987368747, 1.1687094448449893, 1.0, 1.0754716981132075, 1.24, 1.0008178207025469, 1.2844638949671772, 1.0, 1.087386018237082, 1.0335504470762489, 1.1463182897862232, 1.0, 2.0, 1.2128155339805826, 1.013623978201635, 1.3677130044843049, 1.0, 1.0268239989445214, 1.0261627906976745, 1.0869565217391304, 1.0608662900188324, 1.0272727272727273, 1.007936507936508, 1.1435483870967742, 1.0012620950778293, 1.1497617817576489, 1.0, 1.0675675675675675, 1.0911808937267258, 1.0166622852459524, 1.0402427716429234, 1.0, 1.0460434983803795, 1.0199832551908907, 1.0282870612886328, 2.0, 1.1084529505582137, 1.029188832917471, 1.0013560920963416, 1.1589707745402122, 1.0402618080496477, 1.1530266608391608, 1.061344537815126, 1.0380906460945034, 2.0, 1.1567522869398936, 1.121212121212121, 1.2, 1.321917808219178, 1.1304347826086956, 1.0500877465546896, 1.0155306298533218, 1.086730890532714, 1.2387720295622513, 1.0243573797678276, 1.0017615176151762, 1.0217934047643815, 1.1359223300970873, 4.0, 1.0331532829192174, 1.002834008097166, 1.0067676203290876, 1.0007726973857871, 1.0817782656421515, 1.1745673438675697, 1.1236559139784945, 1.4285714285714286, 1.0296945311422805, 1.0008028456417748, 1.0270230305718828, 1.1023138105567607, 1.034639267812165, 1.0385438972162742, 1.0042433364082148, 1.0, 1.094839609483961, 2.0, 1.0, 1.0550161812297734, 1.0680529300567108, 1.0329289428076256, 1.0809768637532133, 1.1062906724511932, 1.052910052910053, 1.0554699537750385, 1.120879120879121, 1.0179576946172235, 1.4303797468354431, 1.0143223065629587, 1.0, 1.0969267139479906, 1.3611111111111112, 1.1702127659574468, 1.0588583259390714, 1.143929912390488, 1.1561264822134387, 1.0311284046692606, 1.004496284899877, 1.0, 1.4893617021276595, 1.3333333333333333, 1.0, 1.0731707317073171, 1.1196388261851016, 1.361344537815126, 1.1318681318681318, 1.0275552707465556, 1.1759890859481583, 1.0193895378712616, 1.001085776330076, 1.1043549712407559, 1.0335249692186879, 1.0511363636363635, 1.0483870967741935, 1.1533623609095307, 1.046927663987555, 1.0751445086705202, 1.0537237066515066, 1.0175320992110555, 1.0584985375365616, 1.0097725636455912, 2.0, 1.0147420147420148, 1.045286506469501, 1.0704225352112675, 1.0, 1.02, 1.3636363636363635, 1.121031746031746, 1.5185185185185186, 1.5, 1.0301270055972085, 1.03987915407855, 1.0029876613466464, 1.0533471140085864, 1.0972972972972972, 1.0510328068043742, 2.0, 1.1407407407407408, 1.1332655932468345, 1.0347841622802798, 1.0068955505552732, 1.0568401868094317, 1.0037688442211055, 1.0185185185185186, 1.0391231159181935, 1.1900532859680284, 1.0469147974693944, 1.0110971524288108, 1.4242424242424243, 1.1317567567567568, 1.0, 1.0136054421768708, 1.0218426357127963, 3.0, 1.0307849133537208, 1.0439481105470954, 1.2857142857142858, 1.1797705057373566, 1.5, 1.1875, 1.0142949500754257, 1.7692307692307692, 1.0069613139480076, 1.0346005980350277, 1.1875, 1.2083333333333333, 1.3108108108108107, 1.0066953610712577, 1.0737141502725764, 1.0165080130136162, 1.0104926338244118, 1.0, 1.1980230284597002, 1.0123456790123457, 2.0, 1.106049772816385, 1.0289025573466972, 1.1059602649006623, 1.013644783806985, 1.036297179988324, 1.2840909090909092, 1.8571428571428572, 1.0566755420311906, 1.0526315789473684, 1.0313067381602836, 1.056704469646431, 1.0471099481871258, 1.0629044438850306, 1.0238095238095237, 1.0434782608695652, 1.1325757575757576, 1.0127846111370922, 1.105993690851735, 1.1299897645854657, 1.2746848739495797, 1.0674006609454851, 4.0, 1.005374370805369, 1.0154947206912563, 1.0326615856139305, 1.0526315789473684, 1.0018053048187752, 1.2262443438914028, 1.0, 1.0224289629309102, 1.0134426229508198, 1.0840236686390532, 1.1470588235294117, 1.6666666666666667, 1.0069630312579556, 1.5, 1.329192546583851, 1.1538461538461537, 1.0749075430884096, 1.2857142857142858, 1.1732673267326732, 1.1079664570230607, 1.0, 1.1812169312169312, 1.0544827586206897, 2.0, 1.0, 1.0901639344262295, 1.0507246376811594, 1.05410225921522, 1.0236305048335124, 1.0289389067524115, 1.0235988200589972, 1.089150378938971, 1.0415584415584416, 1.5605095541401275, 1.25, 1.2307692307692308, 1.0, 1.032191069574247, 1.2842712842712842, 1.0114942528735633, 1.1753531417437897, 1.0056046574409898, 1.2820784729586425, 1.0073987800598772, 1.0304728166570272, 1.0024067388688327, 1.0107398568019093, 1.5714285714285714, 1.0, 1.0303030303030303, 1.023853923853924, 1.1692466460268318, 1.0065359477124183, 1.1871345029239766, 1.058877434135166, 1.0866720939698784, 1.0017100959791367, 1.0769230769230769, 1.1578947368421053, 1.0340488527017024, 1.1073038176033934, 1.0390219846648214, 1.0058684360089347, 1.2171052631578947, 1.067336089781453, 1.0182955313193707, 1.2536115569823434, 1.0015274949083504, 1.1111111111111112, 1.017922794117647, 1.2869565217391303, 1.0, 1.3201438848920863, 1.0347890451517394, 1.0, 1.0605326876513317, 1.051044517346297, 1.2777777777777777, 1.015989712233707, 1.1504237288135593, 1.0930232558139534, 1.037630695792292, 1.0032804614275415, 1.0956889605157132, 1.0096339113680155, 1.1112372304199774, 1.0057484220018034, 1.1691022964509394, 1.0, 1.0, 1.1111111111111112, 1.0084776553227564, 1.8333333333333333, 1.0450110166824047, 1.1032523827472942, 1.1251661497563137, 1.099825251201398, 1.0010431286272428, 1.0682743837084674, 1.0608365019011408, 1.001386962552011, 1.0279662807899124, 1.0997087854031904, 1.003815641253026, 1.0142719498976274, 1.25, 1.015625, 1.1976284584980237, 1.018769312262735, 1.0716612377850163, 1.0193423597678917, 1.168141592920354, 1.0214424951267056, 1.015006932550363, 1.0081190798376185, 1.0311363636363637, 1.3125, 1.0190031299272821, 1.0053055008359681, 1.1805490926012099, 1.0008428150021071, 1.125, 1.0163220892274212, 1.0746268656716418, 1.5, 1.0535352458142262, 1.4230769230769231, 1.0030333670374114, 1.0351648351648353, 1.1989211058664868, 1.006061626536454, 1.0705882352941176, 1.0909090909090908, 1.0566037735849056, 1.0121695650575389, 1.0282146345922045, 1.0008786251074913, 1.031166383386904, 1.0406999506357772, 1.0, 1.0682967959527825, 1.1724690792487402, 1.0592883610875485, 1.0152594099694812, 1.2083333333333333, 1.1018380526577247, 1.0078660238518142, 1.2026200873362445, 1.0172904126319462, 1.0, 1.3333333333333333, 1.0168310712254938, 1.0503990540939994, 1.0137445002530856, 1.0553338809998827, 1.0710295291300878, 1.0089686098654709, 1.0068678728451057, 1.1438034777808446, 1.0421455938697317, 1.281081081081081, 1.0469208211143695, 1.0061233004466696, 1.0238095238095237, 1.75, 1.0216971067003284, 1.0005953534738183, 1.0221445221445222, 1.2394366197183098, 1.0278783490224475, 1.0205146036161334, 1.0039514535704206, 1.0625, 1.3076923076923077, 1.1273584905660377, 1.0189473684210526, 1.125, 1.4333333333333333, 1.0413454017208628, 1.00396432111001, 1.0835579514824798, 1.1714285714285715, 1.0623666700103656, 1.1081311196253725, 1.013706065951961, 1.006578947368421, 1.6666666666666667, 1.1666666666666667, 1.0, 1.0198934280639431, 1.5, 1.3333333333333333, 1.3636363636363635, 1.266778523489933, 1.108695652173913, 1.1079616983939267, 1.0353383338907203, 1.3513513513513513, 1.411764705882353, 1.0, 1.1612903225806452, 1.2837837837837838, 1.4583333333333333, 1.0109034267912773, 1.0131396770293726, 1.0028353699376367, 1.046875, 1.0123509981329886, 1.0010660127120765, 5.0, 1.0087696914021298, 1.0928571428571427, 1.0, 1.3333333333333333, 1.0171597633136096, 1.1701212077745105, 1.053640120523539, 1.0186335403726707, 1.0, 1.075, 1.0618892508143323, 2.0, 1.5, 1.0578248031496063, 1.0475989297282073, 1.140353377030493, 1.25, 1.0129333024998575, 1.0689388071262587, 1.0833333333333333, 1.3333333333333333, 1.1329787234042554, 1.0023226734610187, 1.4078947368421053, 1.0936943355895974, 1.072266356111966, 1.0211764705882354, 1.0, 1.0230251106163515, 1.157130657557643, 1.1611570247933884, 1.2321428571428572, 1.0275789988283983, 1.005503913894325, 1.0367673947009741, 1.5754716981132075, 1.1724137931034482, 1.1492537313432836, 1.0255754475703325, 1.048531684698609, 1.006617625041173, 1.045947499520981, 1.0207423580786026, 3.0, 1.25, 1.0014703062072492, 1.1152154793315743, 1.278934059521494, 1.018461576921154, 1.0207392540558622, 1.1035582410204767, 1.1080402010050252, 1.0208333333333333, 1.0354531876424808, 1.0047769719134598, 1.0866234531526222, 1.0124113475177305, 2.5, 1.1466666666666667, 1.0436186213727576, 1.1407407407407408, 1.0276530939403654, 1.006507918892782, 1.1122159090909092, 1.6, 1.001169590643275, 1.0378734119262905, 1.0221612976924834, 1.155893536121673, 1.0057003110895326, 1.2661290322580645, 1.2887624466571834, 1.1020289855072465, 1.0015083011077837, 1.0436195914781463, 1.1232718894009217, 1.12291933418694, 1.03125, 1.0400717703349283, 1.0141615482674702, 1.07001321003963, 1.0237271492024345, 1.029209621993127, 1.0352388410336726, 1.3846153846153846, 1.0679405520169851, 2.5, 1.5, 1.4166666666666667, 1.020460358056266, 1.1342812006319116, 1.0456756656392736, 1.0245567601202423, 1.0016308779559664, 1.0288702928870292, 1.0869565217391304, 1.2857142857142858, 1.0433019774546322, 1.6, 1.3333333333333333, 1.166178861788618, 1.0, 1.1826771653543307, 1.1173870333988212, 1.0177965324282177, 1.0336952816867118, 1.25, 1.01671826625387, 1.313953488372093, 1.214713216957606, 1.0000917456443756, 1.0588235294117647, 1.0526315789473684, 1.011124675120107, 1.0693285771819803, 1.1001589825119238, 1.7317073170731707, 1.2639664804469273, 1.0, 1.0, 1.0007331640499266, 1.6666666666666667, 1.5714285714285714, 1.4594594594594594, 1.0560509554140127, 1.119047619047619, 1.0273348519362187, 1.109225413402959, 1.0, 1.2209807572936064, 1.026378896882494, 1.1838565022421526, 1.0456730769230769, 1.25, 1.0319407603890363, 1.1080931263858094, 1.0819327731092436, 1.043882484194868, 1.0139087801632742, 1.2518510208660534, 1.053927680798005, 1.0, 1.0367105263157894, 1.0187041519856752, 1.0321018651362983, 1.2695652173913043, 1.0326534663292144]
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.5767	median: 1.0560	mean: 1.1497

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 19.980380 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=naru', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[5.9008598e-06 2.8014183e-06 2.1457672e-06 8.3446503e-07 2.3841858e-07]
Distance score: 2.384185791015625e-06
SAUCE Drift detection: False
Detection latency: 0.0233s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 2.043352 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 8.0000	99th: 2.5000	95th: 1.6012	median: 1.0665	mean: 1.1663
ReportEsts: [1.0825958702064897, 1.050870760769936, 1.0454605640640862, 1.0127388535031847, 1.1470588235294117, 1.0, 1.2010187281333609, 1.00436583621409, 1.2, 1.041387024608501, 1.0207125502177103, 1.0032078491154934, 1.0216707444949318, 1.0255402750491158, 1.0185462159736762, 1.1873065015479876, 1.0726072607260726, 1.2222222222222223, 1.2, 1.112962962962963, 1.1180555555555556, 1.0161586666229208, 1.1948051948051948, 1.105849582172702, 1.0374669330022135, 1.007409193230526, 3.0, 1.0780483703724462, 1.1666666666666667, 1.3333333333333333, 1.387999130371766, 1.0, 1.0029202891403288, 1.0056201227559873, 1.367741935483871, 1.077377824487651, 1.0224845418774593, 1.0184757505773672, 1.3333333333333333, 1.040920716112532, 1.1083316105023775, 1.0253607053794087, 1.0705882352941176, 1.0557308096740274, 1.0790441176470589, 1.1313510805782168, 1.4, 1.0091781393408428, 1.2884615384615385, 1.0961115187087307, 1.25, 1.006872852233677, 1.0803571428571428, 1.0294117647058822, 1.0759081012266654, 1.036156391714671, 1.003061508488728, 1.1837209302325582, 1.0963855421686748, 1.0018812100568708, 1.126984126984127, 1.0167155952309628, 1.0943396226415094, 1.0679245283018868, 1.1386138613861385, 1.3076923076923077, 1.107153100441691, 1.0004056795131846, 1.0, 1.0, 1.105585772252439, 1.0465116279069768, 1.0625601539942253, 1.1264150943396227, 1.0808589098451964, 1.001056338028169, 1.0634761337264003, 1.0892857142857142, 1.127659574468085, 1.0559642415817114, 1.1761687571265678, 1.1153846153846154, 1.0, 1.375, 1.0081018518518519, 1.125, 1.2412060301507537, 1.5, 1.5, 1.013515674984005, 1.0795102040816327, 1.0274040632054176, 1.045343367826905, 1.2902603664416585, 1.0157068062827226, 1.328654970760234, 1.1568627450980393, 1.2400513478819, 2.0, 1.150771666007123, 1.4137931034482758, 3.0, 1.0586831111995225, 1.0816852966466035, 1.047832585949178, 1.012785144314912, 1.0, 1.0025418032098143, 1.1432548721842573, 1.084016393442623, 1.0577651515151516, 1.0139473684210527, 1.3333333333333333, 1.0, 1.1688487584650114, 1.0117239031448146, 1.0775669642857142, 1.0103092783505154, 1.0061857505228962, 2.0, 1.219093851132686, 1.1454545454545455, 1.0, 1.2036199095022624, 1.0, 1.1446540880503144, 1.0250020645800644, 1.0616910296863933, 1.078740157480315, 1.8333333333333333, 1.156081081081081, 1.0, 1.391304347826087, 1.0100689912362484, 1.0, 1.213292117465224, 1.009457720073871, 1.0546292158008732, 1.5, 1.3333333333333333, 1.0390143737166324, 1.034054302807179, 1.0512820512820513, 1.0401668709662126, 1.2564102564102564, 1.0736263736263736, 1.0411430083344357, 2.0, 1.0188316679477325, 1.0445986124876114, 1.0459948320413437, 1.0346541892089487, 1.0, 1.1935055528730083, 1.0221130221130221, 1.034013605442177, 1.4261603375527425, 3.0, 1.0969849246231156, 1.0391679421177125, 1.1176404410110252, 1.1246056782334384, 1.1524064171122994, 1.0714285714285714, 1.1079545454545454, 1.1634349030470914, 1.1111111111111112, 1.0070572504892001, 1.280701754385965, 1.0341047503045067, 1.0172074219964755, 1.063030303030303, 1.0481208289427468, 1.0, 1.0338078291814947, 1.1738709677419354, 1.1055238095238096, 1.1780936454849498, 1.0155865463494669, 1.0439905734485468, 1.0723492723492722, 1.006572629692068, 1.0604026845637584, 1.0909090909090908, 1.031903531119814, 1.071448904070595, 1.0072992700729928, 1.0441044403791784, 1.1424657534246576, 1.0, 1.0714285714285714, 1.0197887389416922, 1.0689655172413792, 1.0275181723779854, 1.0759186351706036, 1.0007094859384345, 1.0065846886156287, 1.0098231827111985, 1.0252208697884355, 1.0622415219189412, 1.0422231796639378, 1.0075673475429248, 1.125531914893617, 1.0204713789319677, 1.1759791122715404, 1.1307006814607723, 1.0679611650485437, 1.0933333333333333, 1.0097087378640777, 1.0, 1.0588235294117647, 1.0062429434814373, 1.710144927536232, 1.1650485436893203, 1.013098649201801, 1.2758620689655173, 1.0026097312598168, 1.0520361990950227, 1.0461236096010704, 2.0, 1.0315258511979823, 1.0534133104827192, 1.0450406192336266, 1.047285253650037, 1.5, 1.05318588730911, 1.0129725784243793, 1.0243302418263671, 1.021505376344086, 1.2763157894736843, 1.0884315906562847, 1.1048043718778289, 1.0423728813559323, 1.0001560145955146, 1.0609382129176703, 1.1870503597122302, 1.1339055793991417, 1.0216894977168949, 2.1666666666666665, 1.0696774193548386, 1.0, 1.0438434746978078, 1.0470375185735512, 1.0282542885973764, 1.3516819571865444, 1.0769230769230769, 2.0, 1.0826448702173785, 1.0434782608695652, 1.0982694503821264, 1.5, 1.0348918353105374, 1.1295180722891567, 1.7142857142857142, 1.0175045379212375, 1.1244239631336406, 1.1391650099403579, 1.0731707317073171, 1.0138740661686232, 1.04044902280404, 1.0724637681159421, 2.0, 1.0112402901383817, 1.1448291597741145, 1.0949640287769784, 1.0499147203174493, 1.0677657615711837, 1.0412269693685472, 1.106425702811245, 1.0322996281003836, 1.063373253493014, 1.1049398515485027, 1.1918932157727162, 1.2, 1.056935051422626, 1.096830985915493, 1.2884615384615385, 1.24, 1.0477057538237435, 1.3308823529411764, 1.0341034980900978, 1.0064136448532262, 1.1724137931034482, 1.2741514360313315, 1.0158004117624209, 1.0773085182534001, 1.0428160314452166, 1.0013130321759198, 1.2857142857142858, 1.0144300144300145, 1.0205351586807716, 1.000089587386096, 1.0176034211192087, 1.0563140053523639, 1.0386243386243386, 1.0128062360801782, 1.0096684093676145, 1.0654076629743963, 1.0613618065406587, 1.0668308174428853, 1.0349907918968693, 1.1868131868131868, 1.25, 1.0836033700583279, 1.1666666666666667, 1.08206106870229, 1.0195265008737031, 1.049474493719559, 1.135135135135135, 1.3278688524590163, 1.067906976744186, 1.0472468299461526, 1.008445831927101, 1.1818181818181819, 1.0028355387523629, 1.0111156625321558, 1.0543735224586288, 1.5833333333333333, 2.3333333333333335, 1.0724336793540945, 1.5, 1.0268402548171038, 1.0453857791225416, 1.1818181818181819, 1.0526942649871873, 1.1153846153846154, 1.5555555555555556, 1.031358809034012, 2.0, 1.3928571428571428, 1.077294685990338, 1.0854657113613102, 1.0396939263510283, 1.043196544276458, 1.1666666666666667, 1.0112067217804608, 1.031181078923512, 1.2974537037037037, 1.0279829710466792, 1.0774189510577044, 3.0, 1.0909090909090908, 1.014693948527707, 1.0, 1.03551912568306, 1.0, 1.5714285714285714, 1.0384615384615385, 1.1771653543307086, 1.1026677445432498, 1.3109243697478992, 1.028061224489796, 1.1875, 2.0, 1.0363842316799388, 1.375, 1.1666666666666667, 1.0250718163906811, 1.211320754716981, 1.078588612670409, 1.0301318267419963, 1.8, 1.25, 1.1197231833910035, 1.1180124223602483, 1.0924369747899159, 1.008938629062539, 1.0650043418930655, 1.0767263427109974, 1.0, 1.0026971506050326, 1.0740740740740742, 1.4137931034482758, 1.5, 1.0088770528184643, 1.25, 1.0021645021645023, 1.0166666666666666, 1.044086234612759, 1.0397789251690785, 1.0108695652173914, 1.0439871522674071, 1.0449579831932774, 1.088809946714032, 1.0197109067017083, 1.0462764443601176, 1.0739064856711915, 1.088235294117647, 1.0020409419586414, 1.003806097330051, 1.0796519410977243, 1.0935960591133005, 1.1162790697674418, 1.0326086956521738, 2.0, 2.037037037037037, 1.2884615384615385, 1.0635838150289016, 1.2699386503067485, 1.079913606911447, 1.0173869846000994, 1.001230012300123, 1.0598419585403174, 1.134941575574821, 1.0267805610065797, 1.2179487179487178, 1.04, 1.066997518610422, 1.0, 1.0061536030965499, 1.2950819672131149, 1.0052201543349977, 1.0328803379650837, 1.0059803843393669, 1.008553862603582, 1.7142857142857142, 1.2810590631364562, 1.3333333333333333, 1.0801189296333003, 1.0909090909090908, 1.0256823254004546, 1.014388489208633, 1.0731685393258428, 1.208469055374593, 1.0885529157667386, 6.0, 1.1483960948396095, 1.0070223228499664, 1.0053557031519944, 1.0, 1.3454545454545455, 1.0373983739837398, 1.3086124401913874, 1.1256021783145989, 1.1771569326505478, 1.2727272727272727, 1.1992619926199262, 1.0888508186189576, 1.0921797263681592, 1.0173313669501187, 1.0904273056402438, 1.2223291626564003, 1.3333333333333333, 1.2226477024070022, 1.024122739455929, 1.3053435114503817, 1.1048532055122828, 1.0, 1.5, 1.1553653719552337, 1.1645569620253164, 1.2450685389501839, 1.0402712571726656, 1.1566626650660263, 1.0, 1.1475409836065573, 1.2333333333333334, 1.0135851257453719, 1.0833333333333333, 2.0, 1.0832326677562234, 1.0, 1.0, 1.1128970531955606, 2.3333333333333335, 1.179569547060713, 1.0074906367041199, 1.3261648745519714, 1.0909090909090908, 1.015788136931198, 1.02859477124183, 1.1111111111111112, 1.0835054773082942, 1.0461538461538462, 1.082039911308204, 1.1633764465622873, 1.0273780273780273, 1.0264078600527198, 1.0, 1.0315789473684212, 1.1489208633093526, 1.048075412411626, 1.1169324221716022, 1.2, 1.0492686682063126, 1.0133550831987839, 1.0207792207792208, 2.0, 1.1246630727762803, 1.0933727857030882, 1.1086352492508853, 1.182, 1.0265063558691316, 1.0172772871006432, 1.045165843330981, 1.0599163610977436, 2.0, 1.065727296159464, 1.079245283018868, 1.0291193181818181, 1.003865267807841, 1.037037037037037, 1.0524958859023588, 1.4453781512605042, 1.0441643390866338, 1.276668290306868, 1.069333119589612, 1.0605042016806723, 1.0009715994020927, 1.2010414308354087, 1.119047619047619, 1.1927710843373494, 1.0569971520452628, 1.044967880085653, 1.0293964975548453, 1.00019654547922, 1.0, 1.1402228198232809, 1.2886297376093294, 1.5, 1.0612244897959184, 1.0159984564303344, 1.016778523489933, 1.1019946535060663, 1.0, 1.0, 1.0250709555345316, 1.004470249717398, 1.022086824067022, 1.0294879039146374, 1.00821722043587, 1.1140684410646389, 1.0904139433551199, 1.0928010534260435, 1.2592592592592593, 1.026365026745441, 1.2375690607734806, 1.08, 1.0027055143967267, 1.0068027210884354, 1.0107561718395646, 1.0, 1.1102204408817635, 1.528428093645485, 1.0856655089185847, 1.0418410041841004, 1.0772277227722773, 1.0434782608695652, 1.0396039603960396, 1.05192000166144, 3.0, 1.5, 1.4285714285714286, 1.0, 1.0095238095238095, 1.3263888888888888, 1.3649122807017544, 1.2341463414634146, 1.0313127258129264, 1.2, 1.0357163193258172, 1.00891360346731, 1.0131092894100977, 1.027514378983367, 1.03576332835411, 1.1053775122216187, 1.0616602687140115, 1.009633725863034, 1.1075581395348837, 1.0251916757940853, 1.1123321123321124, 1.3333333333333333, 1.0557943394696294, 1.2630906768837804, 1.0121145812611896, 1.099526066350711, 1.1607886698139405, 1.0741935483870968, 1.6666666666666667, 1.0396732788798133, 1.0666666666666667, 1.0, 1.2672672672672673, 1.012682256051536, 1.0138728323699422, 1.051980198019802, 1.0289017341040463, 1.007367248785383, 1.2008175243685149, 1.0467836257309941, 1.2, 1.0857142857142856, 1.0528683914510686, 1.2412280701754386, 1.0342052313883299, 1.0185581727337616, 2.0, 1.1319089642359499, 1.1009389671361502, 1.0285104824973337, 1.2355623100303952, 1.002347286125762, 1.009319645104586, 1.0039831641079366, 1.1125, 2.5, 1.0534120357040022, 1.0, 1.0969773299748111, 1.170124481327801, 1.0872226472838562, 1.288888888888889, 1.4482758620689655, 1.085279633331708, 1.1159420289855073, 1.0494590417310665, 1.0517694843026932, 1.0117340286831813, 1.0126655152561888, 1.0887392900856794, 1.029011786038078, 1.0104883644706653, 1.0, 1.0575812067184451, 1.1274809160305344, 1.0909090909090908, 1.009608785175017, 1.0194057492551736, 1.005181347150259, 1.0707613159438603, 1.3, 1.1067193675889329, 1.0180144115292233, 1.3036529680365296, 1.0855263157894737, 1.0112359550561798, 1.2788461538461537, 2.4285714285714284, 1.0437244416483171, 1.0178817056396148, 1.024619554476411, 1.0467918184365368, 1.0318491834774255, 1.0760534429599178, 1.1646341463414633, 1.0118527760449159, 1.1683168316831682, 1.0194340781331193, 1.04149377593361, 1.0575709779179812, 1.1193832599118942, 1.0226013902828892, 1.162162162162162, 1.1818355640535372, 1.1904761904761905, 1.6, 1.0761290322580646, 1.0352422907488987, 1.0747430706944876, 1.5, 1.4444444444444444, 1.0287081339712918, 1.095852213314744, 1.5980392156862746, 1.0122327097992105, 2.6666666666666665, 1.0098209127671867, 1.0, 1.3739837398373984, 1.1111111111111112, 1.0895978131270538, 1.303030303030303, 1.2544642857142858, 1.118942731277533, 2.0, 1.0417142857142858, 1.05218377765173, 2.25, 1.5, 1.0268456375838926, 1.0990712074303406, 1.0764488286066585, 1.0044563279857397, 1.0635135135135134, 1.0996677740863787, 1.1581920903954803, 1.0330512351326624, 1.6850828729281768, 1.7730061349693251, 1.4482758620689655, 1.5, 1.2032355915065722, 1.2326968973747017, 1.024866785079929, 1.1739395788831248, 1.0200016858138763, 1.2375773085945831, 1.0019948085417454, 1.0478916901274793, 1.0277502477700693, 1.0035496957403651, 1.3, 1.5, 1.0, 1.022692095975132, 1.141548709408826, 1.0193370165745856, 1.2591623036649215, 1.0616273165778116, 1.0186631075519965, 1.0062955212661133, 1.1333333333333333, 1.173913043478261, 1.216867469879518, 1.1404661953159523, 1.023812628778592, 1.0156743260039818, 1.2640449438202248, 1.075810504381933, 1.0580410422145474, 1.0478268140287934, 1.0776071139854486, 1.019719659757997, 1.3225806451612903, 1.083640836408364, 1.471947194719472, 1.002785056083846, 1.275229357798165, 1.0352133691435392, 2.0, 1.0548780487804879, 1.063080495356037, 1.2173913043478262, 1.0070505209956955, 1.1963636363636363, 1.0851063829787233, 1.041531904603573, 1.0069749263423726, 1.0827979216716017, 1.0039904229848364, 1.0204280155642023, 1.006088992974239, 1.2613430127041743, 1.0555555555555556, 1.0, 1.3, 1.0133077544426494, 1.8571428571428572, 1.0016184694756658, 1.0573302590047233, 1.1721793458287395, 1.0934664246823957, 1.0952786342091942, 1.0556299669613358, 1.0605095541401275, 1.0206185567010309, 1.0082949561188996, 1.008289582757668, 1.0032142785841203, 1.0341698088675075, 1.4444444444444444, 1.1481140754369825, 1.304635761589404, 1.0128597135458575, 1.0359116022099448, 1.0110516934046345, 1.1814159292035398, 1.0128410914927768, 1.0307583292050493, 1.014857142857143, 1.0013863124089921, 1.4444444444444444, 1.0065197356810918, 1.000172438766994, 1.1750095529231945, 1.0014049877063576, 1.0810810810810811, 1.0600706713780919, 1.0594463579538207, 1.0865341203618548, 1.48, 1.002200209216323, 1.0, 1.032717446870664, 1.1918419375398344, 1.1125158027812896, 1.0594633792603336, 1.123885918003565, 1.123048668503214, 1.078594544613962, 1.0380412233938454, 1.0493707647628268, 1.095881830993267, 1.04242553342564, 1.2307692307692308, 1.0589868147120056, 1.099027409372237, 1.0103150540469286, 1.0553359683794465, 1.2391534391534391, 1.2231237322515214, 1.019434628975265, 1.1311475409836065, 1.0139534431457964, 1.0909090909090908, 1.0413467217956291, 1.0225147556203993, 1.004885993485342, 1.5641838351822503, 1.0247656289166291, 1.096658690967096, 1.086635325721961, 1.0797546012269938, 1.0134329832416948, 1.0884134694100311, 1.0631911532385465, 1.2995391705069124, 1.004653868528214, 1.037454533886173, 1.0384615384615385, 2.0, 1.0191411948745892, 1.0002186245066564, 1.0358370152184586, 1.3515151515151516, 1.000900900900901, 1.0238153271783652, 1.0, 1.0083577099874634, 1.4074074074074074, 1.129556926528323, 1.5, 1.0918367346938775, 1.696969696969697, 1.0451273455324301, 1.0121753246753247, 1.0, 1.1666666666666667, 1.0382059800664452, 1.030392156862745, 1.0303030303030303, 1.75, 1.022867737948084, 1.079295154185022, 1.0193637621023512, 1.4, 1.0716511548455891, 1.069767441860465, 1.14438714795716, 1.1545454545454545, 2.0, 1.175233644859813, 1.0692294712298087, 1.0327026619720239, 1.0737704918032787, 1.5657894736842106, 1.0555555555555556, 1.075, 1.404494382022472, 1.4, 1.0929829627490615, 1.0141837582173172, 1.0038604638151454, 1.018987341772152, 1.0368659652724317, 1.0009595167373093, 8.0, 1.0142940818671293, 1.0470353867911617, 1.3333333333333333, 1.2857142857142858, 1.0662414131501472, 1.122066570881226, 1.0541183467142432, 1.0285714285714285, 1.5, 1.0702341137123745, 1.0, 1.0416666666666667, 1.0105877126591858, 1.0397244672530428, 1.0149935024874315, 1.148992322456814, 1.0, 1.01191487249625, 1.0516581632653061, 1.2089704383282365, 1.087378640776699, 1.0982248520710058, 1.0, 1.178082191780822, 1.0615612742753278, 1.0882207810517412, 1.0309278350515463, 1.055944055944056, 1.0520411092610669, 1.1717100633356792, 1.1228668941979523, 1.0129870129870129, 1.0549762964780247, 1.1356205387980658, 1.0471643278252927, 1.9901960784313726, 1.303030303030303, 1.0285215366705471, 1.1, 1.02291847983754, 1.0829145728643217, 1.0098235156323982, 1.0329067641681902, 1.5, 1.0626246509772637, 1.0477075850412, 1.1889821233126596, 1.303986981285598, 1.0090238332568602, 1.0019533975163946, 1.0953370028040295, 1.1152173913043477, 1.0166666666666666, 1.033794466403162, 1.00663011821141, 1.0814524043179587, 1.250733137829912, 3.5, 1.1264367816091954, 1.025929336499782, 1.2323529411764707, 1.0083559667840574, 1.006101502618699, 1.1103327495621715, 2.2, 1.0434353405725567, 1.0505553353761685, 1.0491268470543083, 1.075, 1.0150137617869457, 1.106508875739645, 1.275943396226415, 1.0925747348119577, 1.001998689781509, 1.0088288573488806, 1.1112185686653773, 1.1158342189160468, 1.0512820512820513, 1.0633962799943206, 1.0938089133549507, 1.0699765784496686, 1.066414686825054, 1.039301310043668, 1.0522141440846002, 1.0, 1.0547703180212014, 2.5, 1.5, 1.4285714285714286, 1.0105932203389831, 1.144736842105263, 1.0376611731238985, 1.0420732296396484, 1.1906392694063928, 1.1111884461458152, 1.0299145299145298, 1.0049261083743843, 1.0584472680437906, 1.6666666666666667, 1.3571428571428572, 1.1028540656973613, 1.0, 1.1696428571428572, 1.0974919093851132, 1.014246947082768, 1.0308611485137795, 1.0, 1.0765590200445434, 1.0377358490566038, 1.1149556111996357, 1.001036717393134, 1.0128205128205128, 1.0500297796307325, 1.0357376663924933, 1.0447154471544715, 1.0543046357615895, 1.4126984126984128, 1.2327981651376148, 1.3333333333333333, 2.0, 1.0012337488072518, 1.5, 1.625, 1.5, 1.0162107396149949, 1.0093738623953403, 1.0986622073578596, 1.0265151515151516, 1.0, 1.029658552795547, 1.0190095047523762, 1.2463768115942029, 1.0080160320641283]
origin-bjaq_15.87 	max: 8.0000	99th: 2.5000	95th: 1.6012	median: 1.0665	mean: 1.1663

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 16.956367 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=39.012881