Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='naru', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 54, 'naru': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.5885	median: 1.0568	mean: 1.1488
ReportEsts: [1.0570469798657718, 1.0514786418400877, 1.0201226396298675, 1.023076923076923, 1.0344827586206897, 1.0, 1.158126525025293, 1.0201630377760442, 1.25, 1.0372836218375499, 1.0452486076241596, 1.0022358278412562, 1.0050654284508231, 1.0023255813953489, 1.0353232073472272, 1.0, 1.7307692307692308, 1.0074388947927737, 3.0, 2.6666666666666665, 1.2272727272727273, 1.1287470347207247, 1.0024065381591174, 1.0365185636031649, 1.0019772614928324, 1.0, 1.073604826546003, 1.5, 1.4, 1.1366906474820144, 1.0, 1.002445495541315, 1.0113737020815905, 1.253607103218646, 1.0441650053672749, 1.0258614853429016, 1.002680965147453, 1.0013743534953743, 1.0260004132516014, 1.2857142857142858, 1.0153846153846153, 1.0823170731707317, 1.0, 1.1308470091662204, 1.060620083294771, 1.2066115702479339, 1.0679611650485437, 1.3224299065420562, 1.0299241218740054, 1.0, 1.0601406856014068, 1.416058394160584, 1.001864439429798, 2.0, 1.2051948051948052, 1.0127111928234063, 1.0088041085840058, 1.0526315789473684, 1.391304347826087, 1.6666666666666667, 1.046846601235914, 1.0224159402241595, 1.0727272727272728, 1.206896551724138, 1.1, 1.1114533937904538, 1.0036800785083415, 1.1666666666666667, 1.0, 1.0935875216637783, 1.0286396181384247, 1.0584490740740742, 1.1193693693693694, 1.0867204899777283, 1.223529411764706, 1.0714285714285714, 1.0, 1.041304347826087, 2.0, 1.0355390398576716, 1.28125, 1.0159458857706294, 1.1840490797546013, 1.0068807339449541, 1.0664573521716378, 1.04, 1.0090939750909398, 1.0242261748019055, 1.2107843137254901, 2.3333333333333335, 1.0701001430615165, 1.0302448188098412, 1.009433962264151, 1.3744740532959328, 1.2331081081081081, 1.1031518624641834, 1.2162162162162162, 1.0025662959794697, 1.0, 1.0100036049026677, 1.1046796256299496, 1.0438675022381378, 1.0044814566498466, 1.0588235294117647, 1.000348801035719, 1.133955448524985, 1.0172442588726514, 1.0633295411452408, 1.0225705329153605, 1.1666666666666667, 1.3333333333333333, 1.1180773249738767, 1.0244171666274875, 1.053226879574185, 1.0389610389610389, 1.0069651859461193, 1.0, 1.1212871287128714, 1.1665071770334927, 1.0, 1.2032967032967032, 1.0, 1.1027568922305764, 1.0142196691274004, 1.0886075949367089, 1.0666666666666667, 1.8, 1.2359271523178808, 1.0, 1.3214285714285714, 1.0097535042070933, 1.1818181818181819, 1.08056640625, 1.007260075238496, 1.0607294176289772, 1.1739811912225706, 1.0027397260273974, 1.0074597565763643, 1.00199203187251, 1.0546272493573265, 1.0419811320754717, 1.2469135802469136, 1.0437051532941943, 1.0420254384518812, 2.0, 1.0133949191685911, 1.0567632850241546, 1.0725806451612903, 1.0285865537321335, 1.0, 1.116493097602325, 1.0148148148148148, 1.004, 1.4476190476190476, 1.0671532846715328, 1.0136705399863295, 1.029196085380149, 1.0909459825051853, 1.11787072243346, 1.180921052631579, 1.0, 1.2753623188405796, 1.0916398713826367, 1.2857142857142858, 1.01532627092083, 1.0042928272422968, 1.0115141047783536, 1.032208136792453, 1.0390959071472206, 1.0719567464419177, 1.0442105263157895, 1.0987394957983194, 1.173622542848843, 1.100111234705228, 1.1838610827374871, 1.0404448938321538, 1.04, 1.0758586195398465, 1.0567558584011967, 1.1666666666666667, 1.26, 1.0008474576271187, 1.0476190476190477, 1.0808361080281168, 1.3571428571428572, 1.0447621094059238, 1.0201960784313726, 1.0305578480137398, 1.16, 1.0501193317422435, 1.0333925807006479, 1.0, 2.1818181818181817, 1.0358650670902478, 1.2406356413166857, 1.1661290322580644, 1.3461538461538463, 1.0147909967845659, 1.0004420889215602, 1.0048502561849733, 1.1798245614035088, 1.2260988721408244, 1.1419354838709677, 1.03125, 1.0, 1.0, 1.0526315789473684, 1.1077917540181692, 1.6550522648083623, 1.103448275862069, 1.0192782995551162, 1.0957683741648108, 1.0757478022079285, 1.0383728969808712, 1.0128596479833734, 1.2571428571428571, 1.1533333333333333, 1.0464564259070872, 1.0038773048423228, 1.0413329673084037, 1.0, 1.1200828157349896, 1.0233391763338782, 1.0054146762803744, 1.049272116461366, 1.034060900026947, 1.0008035865335814, 1.0344827586206897, 1.0029507179800994, 1.1797992090051719, 1.1663846587704456, 1.037837837837838, 1.0095415888819748, 1.0327606871753896, 1.0559055118110237, 1.0, 1.0324469382776287, 1.098537293434569, 1.153539615564932, 1.414179104477612, 1.0909090909090908, 2.6666666666666665, 1.1115351471131356, 1.1636363636363636, 1.1101061177978777, 1.5, 1.0, 1.1428571428571428, 1.0370804059328649, 1.6224489795918366, 1.1160220994475138, 1.1245551601423487, 1.061328790459966, 1.0210030004286326, 1.0682809818234456, 1.087719298245614, 1.0, 1.0459047066034388, 1.0920817894881296, 1.0718038528896672, 1.023952223982191, 1.0688017473459643, 1.0156413972315226, 1.1041335453100158, 1.0020816794566463, 1.0747607655502391, 1.1493610223642172, 1.2508448540706605, 1.4545454545454546, 1.0633648856428983, 1.0767590618336886, 1.2727272727272727, 1.0416666666666667, 1.0552727272727274, 1.0555555555555556, 1.1584158415841583, 1.0305497611197092, 1.1671309192200556, 1.2054380664652569, 1.0212364968103638, 1.033824804856895, 1.005964049573047, 1.01640588107328, 1.4, 1.05516551473263, 1.0, 1.0231526298806066, 1.0064794816414686, 1.0009202398090276, 1.275, 2.5, 1.0454545454545454, 1.4788732394366197, 1.026150555870781, 1.0, 1.0795107033639144, 1.0137614678899083, 1.032852564102564, 1.0054369090792294, 1.125, 1.0, 1.0036741517032097, 1.0558479035817347, 1.1012948119439796, 1.1452991452991452, 1.0, 1.1957040572792363, 1.0123152709359606, 1.1557632398753894, 1.035172704296546, 1.0787224471434997, 1.047197640117994, 1.1346153846153846, 1.0246913580246915, 1.1071122536418165, 1.5714285714285714, 1.0273438727724173, 1.0586080586080586, 1.0, 1.0603528319405757, 1.1904761904761905, 1.75, 1.0495974092229887, 2.0, 1.0041322314049588, 1.065406976744186, 1.0377358490566038, 1.0095456281023292, 1.2532637075718016, 1.1758241758241759, 1.0094021834710967, 1.0101669060311742, 1.0013642564802183, 1.0086261082440122, 1.109190523960182, 2.0, 1.2222222222222223, 1.0269052508066883, 1.3333333333333333, 1.0498357064622126, 1.0, 1.0, 1.0, 1.1814946619217082, 1.0842911877394636, 1.29, 1.0703463203463204, 1.0, 1.0432756324900132, 1.0195878943170613, 1.5, 1.0232281119714115, 1.0, 1.0127078114324755, 1.0674157303370786, 1.0770401469430595, 1.1705069124423964, 1.0018181818181817, 1.1255992329817832, 1.0, 1.0001112107889294, 1.0051162969957412, 1.0292942743009321, 1.0, 1.1428571428571428, 1.8333333333333333, 1.5, 1.2307692307692308, 1.0026431208118431, 1.25, 1.0332778702163061, 1.0198019801980198, 1.0241986570378816, 1.0442944710385658, 1.015447991761071, 1.0640084069333586, 1.0292537313432837, 1.222707423580786, 1.5, 1.0020833333333334, 1.0173160173160174, 1.0157759569524276, 1.380952380952381, 3.142857142857143, 1.1002227171492205, 1.0011641443538999, 1.002784860177522, 1.169054441260745, 1.342769701606733, 1.0307388606880992, 1.4285714285714286, 1.0808477237048666, 1.0455508474576272, 1.25, 1.055306427503737, 1.1081081081081081, 1.0354181090853143, 1.003410935766176, 1.0423200354841236, 1.2647058823529411, 1.072072072072072, 1.056047197640118, 1.0, 1.0403837460445025, 1.0182835304785274, 1.0407085875175974, 1.0134153831332267, 1.071619812583668, 1.0141798259748631, 1.8333333333333333, 1.2001929570670526, 1.2, 1.0700256191289497, 1.1111111111111112, 1.0140539349365065, 1.0434782608695652, 1.0581470335339638, 1.2015810276679841, 1.1765816808309726, 3.0, 1.0977491961414791, 1.001348335079488, 1.0551544969652382, 1.0, 1.125, 1.0009596928982725, 1.2586206896551724, 1.1081069907809336, 1.2333333333333334, 1.1666666666666667, 1.2536669542709231, 1.095519667188632, 1.0930163114478744, 1.0081670729668124, 1.1354166666666667, 1.3233830845771144, 1.0795454545454546, 1.3636363636363635, 1.017766497461929, 1.3, 1.0422919508867667, 1.1, 1.0373240828155532, 1.08, 1.076886299118482, 1.020949206070708, 1.1407459535538353, 1.0, 1.0654205607476634, 1.28, 1.0013230086773803, 1.299781181619256, 1.0, 1.137883393202542, 1.0049223868264179, 1.2028913260219343, 1.0, 2.0, 1.1879611650485438, 1.0045004500450045, 1.3677130044843049, 1.0, 1.0175143479121314, 1.0402750491159136, 1.0869565217391304, 1.0088512241054615, 1.0272727272727273, 1.0393700787401574, 1.1741935483870967, 1.0694152292806058, 1.130474714425119, 1.0, 1.054054054054054, 1.0652439876957494, 1.0127190066030587, 1.0343139720056995, 1.0, 1.0293715846994536, 1.0252675376437836, 1.0277632268203247, 2.0, 1.1399521531100478, 1.0494680099806977, 1.1127235798991024, 1.1457778166091477, 1.0177593089225814, 1.1522083310585796, 1.0621848739495798, 1.0255544840887174, 2.0, 1.0576773993488036, 1.1384615384615384, 1.0, 1.304054054054054, 1.1304347826086956, 1.0376854214418545, 1.0632339656729901, 1.0556893552764877, 1.0797819623389495, 1.0177933906993775, 1.046395238739348, 1.0096570616179479, 1.1650485436893203, 4.0, 1.032605929660305, 1.0145820497021976, 1.0068365054566604, 1.010056492840084, 1.1001953670108848, 1.180786686838124, 1.0829015544041452, 1.5714285714285714, 1.0253888209301745, 1.026305527391842, 1.0140198144246053, 1.1087272727272728, 1.0578546112853464, 1.0041407867494825, 1.0178696739377526, 1.0192413413963717, 1.094839609483961, 2.0, 1.0, 1.0107361963190185, 1.0405156537753222, 1.0016806722689076, 1.0261593341260404, 1.103896103896104, 1.3178807947019868, 1.0554699537750385, 1.10989010989011, 1.0237400943816224, 1.3614457831325302, 1.0198015137715524, 1.0, 1.1658291457286432, 1.2182539682539681, 1.1134751773049645, 1.0325930199019324, 1.1132764920828258, 1.007905138339921, 1.0259403372243838, 1.0549487082066868, 1.0, 1.6382978723404256, 1.3333333333333333, 1.0, 1.0476190476190477, 1.161592505854801, 1.375796178343949, 1.1016042780748663, 1.030278756808715, 1.072139303482587, 1.0003769705277588, 1.0113882863340564, 1.0909090909090908, 1.0165104171716095, 1.0632183908045978, 1.0764331210191083, 1.1630382196419933, 1.0529335071707953, 1.166184971098266, 1.0456981664315939, 1.0081589216034055, 1.1161372125698228, 1.0095365113836203, 2.0, 1.068241469816273, 1.0258780036968578, 1.0410958904109588, 1.0, 1.108695652173913, 1.1538461538461537, 1.153061224489796, 1.5925925925925926, 1.5, 1.0288506166290943, 1.0380486937977609, 1.0061111254817765, 1.0013585931013662, 1.0648648648648649, 1.0437424058323208, 2.0, 1.1846153846153846, 1.1424631628713262, 1.0024835976306212, 1.0076431990056578, 1.0297300375897027, 1.0064723761845165, 1.0968660968660968, 1.0227725537659436, 1.1580817051509769, 1.0166064488186284, 1.0119354656525914, 1.393939393939394, 1.0876623376623376, 1.0, 1.0090702947845804, 1.0200346921075456, 3.0, 1.0220183486238532, 1.0263957589335226, 1.2857142857142858, 1.24836983406035, 1.1, 1.1875, 1.025771954674221, 1.7692307692307692, 1.003843225408796, 1.0230670653566851, 1.1875, 1.2083333333333333, 1.2898936170212767, 1.0043041606886658, 1.104878048780488, 1.0004819857814196, 1.0107217154744759, 1.0, 1.1955246578318488, 1.0, 2.0, 1.1228406024402058, 1.015042545904792, 1.1343424787133396, 1.0161206313671318, 1.065172584726969, 1.3452380952380953, 2.2857142857142856, 1.00570559147965, 1.0589239965841162, 1.049191454702798, 1.0603735823882587, 1.0451042885383468, 1.0971188383645396, 1.1941391941391941, 1.0022371364653244, 1.1240601503759398, 1.0120613303068742, 1.0769716088328076, 1.0715579710144927, 1.2258403361344539, 1.0622551039192139, 4.0, 1.0015992030201342, 1.0083796922768506, 1.0284439306108557, 1.1176470588235294, 1.0389554176886453, 1.3284313725490196, 1.0, 1.0163088282734147, 1.0134426229508198, 1.0917759237187128, 1.1470588235294117, 1.6666666666666667, 1.0152899470679237, 1.5, 1.5285714285714285, 1.1538461538461537, 1.048949829041937, 1.3333333333333333, 1.1732673267326732, 1.1268343815513626, 1.0, 1.373015873015873, 1.071478626489138, 1.75, 1.0, 1.064, 1.0820895522388059, 1.1090963139120096, 1.003157894736842, 1.0256410256410255, 1.043076923076923, 1.089150378938971, 1.051948051948052, 1.5408805031446542, 1.1666666666666667, 1.1923076923076923, 1.0, 1.155813953488372, 1.266955266955267, 1.0175619834710743, 1.1640135069946937, 1.0042136224897724, 1.2441471571906355, 1.040983606557377, 1.0712930333423691, 1.0746089049338148, 1.0066066066066066, 1.375, 1.0, 1.0, 1.0234960580993437, 1.1086105675146771, 1.0065359477124183, 1.0124688279301746, 1.1137838869797632, 1.0276044101069532, 1.0048830847371437, 1.064102564102564, 1.1, 1.0488527017024427, 1.1101537645811241, 1.0245329485027685, 1.0401934997819162, 1.1907894736842106, 1.0858682811577083, 1.017772941603192, 1.1368267831149927, 1.0397035468501852, 1.2222222222222223, 1.049265750828991, 1.6629213483146068, 1.0384615384615385, 1.139751552795031, 1.0347890451517394, 1.0, 1.0579710144927537, 1.0476255019229792, 1.2777777777777777, 1.0015761946839252, 1.1546610169491525, 1.0930232558139534, 1.0372551157634573, 1.0014059120403749, 1.1358447488584476, 1.0, 1.0488081725312146, 1.007326420198377, 1.140529531568228, 1.0, 1.0, 1.1111111111111112, 1.0141213515804772, 1.8333333333333333, 1.0527901434417015, 1.0586667384631954, 1.17257421355782, 1.0874730021598271, 1.0021573796608885, 1.1633440514469453, 1.0813953488372092, 1.03, 1.0110127503698312, 1.0495093337268502, 1.0059535507993194, 1.034957244369505, 1.25, 1.015625, 1.233201581027668, 1.0398659121219767, 1.0132013201320131, 1.0033848106621537, 1.143362831858407, 1.01364522417154, 1.0677487539876296, 1.0247592847317744, 1.0039234449760766, 1.3125, 1.0359529804909045, 1.0107628533064505, 1.1589767016902695, 1.0008428150021071, 1.0625, 1.0785219399538106, 1.0746268656716418, 1.6875, 1.023165090105641, 1.3076923076923077, 1.0060483870967742, 1.0483516483516484, 1.2022926500337154, 1.061673221308545, 1.0752941176470587, 1.0909090909090908, 1.032258064516129, 1.0016756587548568, 1.013222956830935, 1.0012016013049514, 1.0540847396397792, 1.0475472473998937, 1.0, 1.0584795321637428, 1.0387581168831168, 1.0788428054823875, 1.0225409836065573, 1.2013888888888888, 1.0486997635933806, 1.0140881312319074, 1.1719148936170212, 1.0236100941189077, 1.0, 1.3333333333333333, 1.0077233058913693, 1.0085142613878246, 1.0148113501715, 1.033977233528803, 1.0622505985634478, 1.048951048951049, 1.004276423247112, 1.1041465445462115, 1.003690036900369, 1.2702702702702702, 1.003501400560224, 1.0002699651499534, 1.0238095238095237, 1.75, 1.0493419981990388, 1.0071675591253904, 1.0062713797035348, 1.2307692307692308, 1.0148443157132512, 1.0083011407057372, 1.0224202356999137, 1.0638297872340425, 1.2307692307692308, 1.1179245283018868, 1.0673684210526315, 1.1125, 1.4827586206896552, 1.0569337356129176, 1.0089197224975224, 1.082585278276481, 1.2058823529411764, 1.0436152071421407, 1.0882107023411371, 1.013843648208469, 1.0720883320947021, 1.3333333333333333, 1.0714285714285714, 1.3333333333333333, 1.0342219020172911, 1.7307692307692308, 1.3333333333333333, 1.3636363636363635, 1.217741935483871, 1.0203327171903882, 1.0185522901031072, 1.0296128683161985, 1.1802575107296138, 1.588235294117647, 1.0, 1.0333333333333334, 1.2567567567567568, 1.320754716981132, 1.0373831775700935, 1.0124777966136036, 1.004453720440527, 1.0390625, 1.0232384782147814, 1.001030979430459, 5.0, 1.010122146235242, 1.1914285714285715, 1.0, 1.3333333333333333, 1.0798816568047338, 1.100623969016711, 1.0587492705467625, 1.0962732919254659, 1.0, 1.0387596899224807, 1.0382165605095541, 2.0, 1.5, 1.1350885826771653, 1.035639704858694, 1.230852045524454, 1.25, 1.0070303805734924, 1.0689388071262587, 1.0881696428571428, 1.1428571428571428, 1.07035175879397, 1.0027898972107752, 1.5789473684210527, 1.0566773749426341, 1.0669411910772668, 1.0493827160493827, 1.00390625, 1.0216804407713498, 1.233134073441503, 1.140495867768595, 1.1311475409836065, 1.039929370820254, 1.0292318982387476, 1.0308832818057911, 1.5045045045045045, 1.186046511627907, 1.1940298507462686, 1.055263157894737, 1.047883843064566, 1.0269901797978556, 1.0279823721019352, 1.0589519650655022, 3.0, 1.25, 1.0583539122492474, 1.1200527704485488, 1.25559229721844, 1.019149468417761, 1.0608797457768857, 1.0886662803212186, 1.2016348773841963, 1.0208333333333333, 1.0212748876043674, 1.0010386565337666, 1.0707130229817325, 1.059369202226345, 2.5, 1.08, 1.0426281228218204, 1.0790919952210274, 1.0292535683894481, 1.0021546621205664, 1.1122159090909092, 1.6, 1.0, 1.060114336485965, 1.0360977838702308, 1.0190114068441065, 1.0045117532065035, 1.2921810699588476, 1.3092485549132948, 1.0579710144927537, 1.0030503674637177, 1.0500773480662984, 1.0829493087557605, 1.1293213828425097, 1.03125, 1.132347915242652, 1.0043381458443317, 1.0554821664464993, 1.024515009305884, 1.0095505617977527, 1.0916597853014038, 1.3846153846153846, 1.040339702760085, 2.5, 1.5, 1.3076923076923077, 1.0281329923273657, 1.1413902053712481, 1.0017856478553626, 1.0585625353706847, 1.2672998643147897, 1.047907949790795, 1.1195652173913044, 1.4489795918367347, 1.008340523439747, 1.6, 1.3333333333333333, 1.160650406504065, 1.0, 1.160741885625966, 1.1624936126724579, 1.0574132492113564, 1.0224878674262712, 1.25, 1.0289901242433896, 1.313953488372093, 1.1254364089775561, 1.000312032524802, 1.0834473324213407, 1.0373001776198933, 1.0081273680284262, 1.054405173880978, 1.041335453100159, 1.290909090909091, 1.2486033519553073, 1.0, 1.0, 1.0008941024999105, 1.6666666666666667, 1.5714285714285714, 1.2857142857142858, 1.0587484035759898, 1.119047619047619, 1.0273348519362187, 1.0883859948761743, 1.0, 1.22284295468653, 1.0251497005988024, 1.1300448430493273, 1.0297029702970297, 1.25, 1.019341290893015, 1.0909090909090908, 1.0887949260042282, 1.0238006693938266, 1.0070472966374793, 1.089320577899258, 1.0150842945874001, 1.0, 1.0337181842036212, 1.0008987323144196, 1.0659971305595408, 1.2695652173913043, 1.0471430630976981]
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.5885	median: 1.0568	mean: 1.1488

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 20.429481 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=naru', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[6.5565109e-07 1.1920929e-06 5.3644180e-07 7.7486038e-07 1.1920929e-07]
Distance score: 6.556510925292969e-07
SAUCE Drift detection: False
Detection latency: 0.0237s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 2.064480 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 6.0000	99th: 3.0000	95th: 1.6785	median: 1.0680	mean: 1.1729
ReportEsts: [1.1713395638629283, 1.0379689957312963, 1.0036133967135583, 1.0552845528455284, 1.0277777777777777, 1.0, 1.1950720785195788, 1.0156140609803632, 1.0, 1.0198456449834619, 1.0372669313124023, 1.0018919494661742, 1.0956754688097972, 1.1456692913385826, 1.0143652887716212, 1.3519417475728155, 1.0833333333333333, 1.0, 1.7777777777777777, 1.1443396226415095, 1.105165862175208, 1.054653270433457, 1.0680110715697904, 1.1278195488721805, 1.0356290273365283, 1.014679274912095, 2.0, 1.0623859804300957, 1.2, 1.125, 1.0490883590462834, 1.0, 1.0032175984662663, 1.0081648871399822, 1.359375, 1.0223926007058537, 1.0254864963811992, 1.009090909090909, 1.3636363636363635, 1.147983486821213, 1.048695652173913, 1.0049740525299256, 1.0509049773755657, 1.037632, 1.0850277264325323, 1.1241932608308076, 1.3, 1.00198544010589, 1.5297619047619047, 1.0530410183875532, 1.127659574468085, 1.0390070921985815, 1.0892857142857142, 1.1290322580645162, 1.0646186819074834, 1.0300948642459928, 1.013408609738885, 1.10250569476082, 1.108433734939759, 1.003229799586795, 1.1384615384615384, 1.0604482080232658, 1.077922077922078, 1.1196911196911197, 1.1553398058252426, 1.5, 1.2352416570771, 1.0183998346082281, 1.1428571428571428, 1.0, 1.048493217447811, 1.002970297029703, 1.0563855421686748, 1.1450676982591876, 1.0697266592962524, 1.0289184499710815, 1.1138130920401528, 1.0613207547169812, 1.1134751773049645, 1.026146121721177, 1.2064590542099192, 1.0, 1.0, 1.5333333333333334, 1.0, 1.0483870967741935, 1.1846808510638298, 2.1176470588235294, 1.1578947368421053, 1.0018446337199045, 1.0779284430648586, 1.1109426950909447, 1.0032349165596919, 1.1296881584492204, 1.0299727520435968, 1.303886925795053, 1.0617283950617284, 1.3359477124183006, 1.1111111111111112, 1.084251968503937, 1.4482758620689655, 4.0, 1.0533171411865245, 1.1310845431255336, 1.0064981949458485, 1.0027783524960836, 1.4054054054054055, 1.0149769283548162, 1.0808735301175907, 1.028963727030535, 1.0509229789942711, 1.0377556371263765, 1.1428571428571428, 1.25, 1.1318221830985915, 1.011615381012599, 1.0831918505942275, 1.0425531914893618, 1.0076646943777388, 2.0, 1.2299482535575679, 1.1621835443037976, 1.5, 1.2830188679245282, 1.125, 1.0270833333333333, 1.0186430984570212, 1.0818553888130968, 1.0692307692307692, 1.6666666666666667, 1.1758934828311143, 1.0, 1.625, 1.023954337045008, 1.1538461538461537, 1.1314387211367674, 1.042680186668203, 1.0766343995510663, 2.2, 1.2666666666666666, 1.0279441117764472, 1.06072695035461, 1.053981827899519, 1.0525663093124433, 1.2108108108108109, 1.0487276664861938, 1.0160141265298666, 2.0, 1.0138621486330381, 1.065856129685917, 1.0208757637474541, 1.0143576080521017, 1.3333333333333333, 1.0269206875129426, 1.026993865030675, 1.0427350427350428, 1.0661577608142494, 1.0, 1.0721034311287916, 1.1265248512954935, 1.0836027366363432, 1.171334431630972, 1.1132075471698113, 1.0172413793103448, 1.367741935483871, 1.1091405184174625, 1.5714285714285714, 1.0040468297344922, 1.3773584905660377, 1.1228915662650603, 1.0254516448928557, 1.4793103448275862, 1.0743409568992526, 1.0833333333333333, 1.147887323943662, 1.2128840276660768, 1.2286689419795223, 1.1244947453516572, 1.000821692686935, 1.0590250329380764, 1.0009066452638933, 1.008301404853129, 1.037037037037037, 1.2857142857142858, 1.0224748688003549, 1.0462009803921568, 1.0938628158844765, 1.0640683156918194, 1.2428571428571429, 1.0, 1.1012345679012345, 1.00997309981685, 1.2142857142857142, 1.0166147455867083, 1.0170394036208732, 1.0263561047996106, 1.0127217553688141, 1.0353892821031345, 1.1846846846846846, 1.068263734167297, 1.0942641173855048, 1.0284276387377584, 1.0991649269311066, 1.0058202271693317, 1.1864229765013055, 1.2086804033318719, 1.3522012578616351, 1.08, 1.0495049504950495, 3.0, 1.0641711229946524, 1.0112202894701898, 1.641399416909621, 1.1650485436893203, 1.0198347107438017, 1.0, 1.0086766251442945, 1.0112359550561798, 1.013255841726046, 1.0, 1.0645569620253164, 1.0530542013191855, 1.011459979882167, 1.058505422971566, 1.3333333333333333, 1.0503472222222223, 1.0700251144925395, 1.0164319408151492, 1.0188172043010753, 1.1245901639344262, 1.0386313465783665, 1.0834490052217596, 1.0, 1.0034658412001873, 1.0124175276982448, 1.1713286713286712, 1.0922165820642977, 1.015819209039548, 5.0, 1.1311475409836065, 1.0, 1.0437359493153484, 1.0657532969849481, 1.105003220957698, 1.2345679012345678, 1.1538461538461537, 3.3333333333333335, 1.0867594596175214, 1.15625, 1.0680019429126546, 1.5, 1.1650485436893203, 1.1093439363817097, 1.375, 1.0132812808076028, 1.1185682326621924, 1.0677966101694916, 1.1504854368932038, 1.0106875667972925, 1.0028146230993207, 1.044776119402985, 1.0, 1.0109510036989675, 1.058588396528095, 1.1231231231231231, 1.0518707171387738, 1.0910357640501627, 1.0430587229190422, 1.0887573964497042, 1.0128528299674648, 1.072283150548355, 1.039530426449449, 1.2559302474676242, 1.2857142857142858, 1.07911, 1.1036363636363635, 1.2941176470588236, 1.0, 1.0251352211263125, 1.3031055900621118, 1.0153762942358213, 1.0139712851476113, 1.1238317757009346, 1.2284263959390862, 1.0142083763964762, 1.0444763271162123, 1.0244175313959667, 1.008710108146825, 1.3846153846153846, 1.5, 1.0881294964028776, 1.0628802544247788, 1.01538182038394, 1.017674079683381, 1.0491118077324975, 1.026508742244783, 1.006386337543054, 1.0524284335799292, 1.0125277943489344, 1.045007610976262, 1.0549763033175354, 1.5, 1.1538461538461537, 1.0798454603992274, 1.25, 1.0389610389610389, 1.007102714704425, 1.0286601666928763, 1.3225806451612903, 1.2741935483870968, 1.2984496124031009, 1.0550474547023296, 1.021981031944397, 1.0909090909090908, 1.0179018976011458, 1.0168439775369222, 1.0574712643678161, 1.3, 2.1666666666666665, 1.0159423454902816, 1.2, 1.0134806258423372, 1.0943396226415094, 1.0476190476190477, 1.034721157135947, 1.2083333333333333, 1.7, 1.040534645262282, 2.0, 1.0142857142857142, 1.0598290598290598, 1.1971168912566594, 1.042702956358517, 1.1943844492440605, 1.0508474576271187, 1.0136742308949689, 1.0075326380476053, 1.0316742081447965, 1.0131219245489338, 1.0825797538306958, 3.0, 1.3333333333333333, 1.0354748575772834, 1.25, 1.0387773722627738, 1.05, 1.3333333333333333, 1.125, 1.1766467065868262, 1.0784627702161729, 1.3025210084033614, 1.010204081632653, 1.2666666666666666, 2.25, 1.0249353061266293, 1.6666666666666667, 1.152542372881356, 1.0167233729282317, 1.1236749116607774, 1.0519276160503541, 1.031015037593985, 1.8, 1.25, 1.1918899348298335, 1.0443037974683544, 1.0108161258603736, 1.017651549216242, 1.0788888888888888, 1.0300751879699248, 1.5, 1.0015428543096383, 1.4285714285714286, 1.2758620689655173, 2.0, 1.0, 1.1111111111111112, 1.0350109409190371, 1.0677966101694916, 1.066242582269376, 1.016886508981644, 1.0470059880239522, 1.0684886759581882, 1.0414449733968076, 1.0495626822157433, 1.042407660738714, 1.0644416695046732, 1.0796992481203007, 1.0294117647058822, 1.0099259725640586, 1.005280890369473, 1.0549586776859503, 1.0555555555555556, 1.175, 1.0877862595419847, 2.0, 1.7777777777777777, 1.275229357798165, 1.0242085661080074, 1.4507042253521127, 1.0505050505050506, 1.071285140562249, 1.0604914933837428, 1.0120843126006256, 1.138142747505756, 1.0271993877746246, 1.3461538461538463, 1.0875912408759123, 1.0565110565110565, 1.0, 1.0183068459657703, 1.3389830508474576, 1.0006986932547774, 1.0234396466087545, 1.010087262829237, 1.0271296798697775, 1.5714285714285714, 1.1983673469387754, 1.0, 1.0943485457554978, 1.4545454545454546, 1.0685119748723988, 1.0204572803850782, 1.0501609442060085, 1.2119205298013245, 1.1326908821349146, 4.0, 1.1977926227127504, 1.0031725260763384, 1.0290389354361755, 1.0, 1.2258064516129032, 1.036220472440945, 1.2379862700228832, 1.0928343191243457, 1.0281464896849513, 1.0869565217391304, 1.0107758620689655, 1.1193053500506192, 1.070004348096155, 1.0325721138347668, 1.0818289064455011, 1.035754610462928, 1.0588235294117647, 1.1908847184986595, 1.0079423548527082, 1.413533834586466, 1.1763736263736264, 1.0, 2.0, 1.2314211212516297, 1.157676348547718, 1.2537517053206002, 1.105670062261371, 1.1205230244457078, 1.0, 1.1209677419354838, 1.2857142857142858, 1.2037351443123938, 1.125, 1.0, 1.0735906167234204, 1.3333333333333333, 1.0, 1.1149981391886863, 2.6666666666666665, 1.2066408768536427, 1.0044709388971684, 1.3615384615384616, 1.1, 1.0193780858467083, 1.0906801007556675, 1.1428571428571428, 1.1063549348815314, 1.0, 1.0414394765539803, 1.1111111111111112, 1.0390707497360085, 1.0835911838910839, 1.0, 1.0909090909090908, 1.0606843810299351, 1.0034827377347062, 1.1164383561643836, 1.0, 1.054990215264188, 1.0151198224400055, 1.029733275032794, 2.0, 1.1324815063887022, 1.0592413806636447, 1.1144214751904749, 1.256121485141321, 1.0250158810352576, 1.0012895448747599, 1.0335899230230932, 1.0610503370605093, 2.25, 1.1230716342228524, 1.0623980424143555, 1.0297053231939164, 1.0274423710208562, 1.078125, 1.0405261788053615, 1.092840283241542, 1.0656420134356395, 1.3126858275520317, 1.049283515445971, 1.085, 1.020933014354067, 1.1912041569395286, 1.0963855421686748, 1.0, 1.0397356029735159, 1.10239651416122, 1.0322404966779217, 1.0075762542025266, 1.3333333333333333, 1.198256254738438, 1.0812324929971988, 2.0, 1.2045454545454546, 1.006557631856102, 1.0957446808510638, 1.0427191679049035, 1.0, 1.105263157894737, 1.0309765902104517, 1.0243162154619034, 1.0371718720061314, 1.031348086408356, 1.0393671817512877, 1.2770083102493075, 1.0819224467504096, 1.069756841294541, 1.286764705882353, 1.0549003187010026, 1.1768990634755463, 1.1, 1.0058611337130459, 1.2259152215799614, 1.0310460328598097, 1.0, 1.075875486381323, 1.2980769230769231, 1.001637187875777, 1.0357894736842106, 1.0596285434995112, 1.106060606060606, 1.0799418604651163, 1.039524049731462, 1.0, 1.8421052631578947, 2.0, 1.0, 1.0842105263157895, 1.1620689655172414, 1.3550087873462215, 1.0977777777777777, 1.019503781345363, 1.6774193548387097, 1.0958892377961746, 1.009386399967209, 1.012226086585444, 1.090260761438028, 1.0352008994298256, 1.0910560344827587, 1.169316375198728, 1.002638853983413, 1.142577168054875, 1.029966703662597, 1.1109741060419236, 1.25, 1.0236044392910386, 1.251548946716233, 1.0102881884446564, 1.2010050251256281, 1.176750700280112, 1.0113560454241817, 2.5, 1.039855072463768, 1.0666666666666667, 3.0, 1.2598187311178248, 1.034967704271419, 1.0296724470134875, 1.0683544303797468, 1.122093023255814, 1.0462111710483055, 1.1486883385621787, 1.0036563071297988, 1.2, 2.0, 1.1455723278127483, 1.2026431718061674, 1.0165056360708535, 1.0340963280877444, 2.0, 1.228544776119403, 1.0702576112412179, 1.0583413543639582, 1.226865671641791, 1.0034364261168385, 1.0407274837960723, 1.0106837155236184, 1.119047619047619, 4.0, 1.0328510156949615, 1.0, 1.1174968071519795, 1.195744680851064, 1.150597609561753, 1.0, 1.3103448275862069, 1.097828272672431, 1.0337837837837838, 1.3428571428571427, 1.1123384743643185, 1.0651465798045603, 1.0957116221255438, 1.0969903112760255, 1.0287769784172662, 1.000973078170613, 1.2, 1.0168145726296123, 1.1564770314071755, 1.1428571428571428, 1.0123711340206185, 1.0679431248990143, 1.1305637982195846, 1.102198219027148, 1.1818181818181819, 1.2660753880266076, 1.006229605458321, 1.1657458563535912, 1.1643835616438356, 1.0359421984630806, 1.205607476635514, 2.0, 1.1002255881405092, 1.0041407867494825, 1.023220295839579, 1.0386003887808941, 1.0250145293685369, 1.0076407468949784, 1.1171875, 1.0107357120303126, 1.089820359281437, 1.0366660331616688, 1.0989417989417989, 1.0282574568288854, 1.0017667844522968, 1.0390952864778902, 1.1278350515463917, 1.0938390313390314, 1.0476190476190477, 1.6, 1.097378277153558, 1.0438790560471976, 1.0379395434916718, 1.1631644004944375, 1.8888888888888888, 1.031496062992126, 1.1217081850533808, 1.7052631578947368, 1.0101635786784602, 2.3333333333333335, 1.0104290116141266, 2.0, 1.4943502824858756, 1.125, 1.0265453276734313, 1.3235294117647058, 1.145748987854251, 1.0976863753213368, 1.0, 1.0647773279352226, 1.1036948748510131, 2.25, 1.25, 1.1081081081081081, 1.0642201834862386, 1.0510229233423711, 1.0167548500881833, 1.0350404312668464, 1.21875, 1.1211267605633803, 1.0073917634635692, 1.5238095238095237, 1.2543859649122806, 1.3333333333333333, 1.0, 1.0685714285714285, 1.2885747938751473, 1.0599455040871935, 1.3686815129020855, 1.0165024825430735, 1.2378090366581416, 1.00807966001186, 1.019364179284551, 1.1099899091826437, 1.0015, 1.625, 1.5, 1.0, 1.001266367803865, 1.1395730706075533, 1.0081967213114753, 1.0147368421052632, 1.10255597133253, 1.0554116732983307, 1.001646750404052, 1.1123595505617978, 1.173913043478261, 3.75, 1.0673018670485213, 1.0568189486470072, 1.0033486076841733, 1.2021857923497268, 1.0629586236665227, 1.030249589732285, 1.0096111839231106, 1.0184774575018478, 1.005700530063043, 1.198501872659176, 1.0333333333333334, 1.4126984126984128, 1.010408939581862, 1.375, 1.1264604810996564, 2.0, 1.111578947368421, 1.027593665936382, 1.1451612903225807, 1.0275009620360664, 1.1657986111111112, 1.037037037037037, 1.0678546188793538, 1.0127185526954832, 1.1484968199265921, 1.0182539682539682, 1.0751503006012024, 1.0077083969824445, 1.1762589928057554, 1.0, 1.0, 1.1, 1.0151274045724645, 1.8571428571428572, 1.0637726560751846, 1.0639661237201175, 1.1918853526893727, 1.0862533692722371, 1.0083853716464573, 1.090155163188871, 1.080128205128205, 1.0047281323877069, 1.0214445848608509, 1.0704136935277992, 1.0049187074707615, 1.014375109949486, 1.3333333333333333, 1.1280487804878048, 1.1993670886075949, 1.0242087038873022, 1.028169014084507, 1.0099378881987577, 1.1951219512195121, 1.0210696920583469, 1.0476582072711278, 1.0459363957597174, 1.010219545753654, 1.4210526315789473, 1.0065231121462124, 1.008764459461789, 1.1321602396106327, 1.0193185809624166, 1.2432432432432432, 1.0074906367041199, 1.3017031630170317, 1.053992173164672, 1.1281050390347764, 1.004568333111928, 1.4666666666666666, 1.0551522861632867, 1.1692987997473152, 1.1722365038560412, 1.0317040951122853, 1.075812274368231, 1.1849765258215963, 1.10752688172043, 1.049539202066253, 1.0504364694471386, 1.0077925196614037, 1.0782237127580552, 1.2352941176470589, 1.0447966919365954, 1.2237261146496816, 1.003377698565556, 1.0327552986512525, 1.3097768331562167, 1.2368681863230921, 1.3917525773195876, 1.015228426395939, 1.0008217606099505, 1.1111111111111112, 1.044431279620853, 1.0162101362974725, 1.0343106674984404, 1.5303514376996805, 1.0408060874655072, 1.057408768062699, 1.0641282565130261, 1.0680933852140078, 1.000065720294427, 1.092879512114719, 1.0565428109854604, 1.2941176470588236, 1.0099706744868036, 1.0129140529865026, 1.1304347826086956, 1.75, 1.0402090692295278, 1.0017208125931145, 1.0163934426229508, 1.303030303030303, 1.0372148859543817, 1.0373873359268369, 1.0192857142857144, 1.0558347292015633, 1.15625, 1.0864265927977839, 1.1333333333333333, 1.1044386422976502, 1.75, 1.0442284641758732, 1.0268006700167505, 1.2262703739213807, 1.3076923076923077, 1.0389805097451275, 1.0882978723404255, 1.121212121212121, 1.0564102564102564, 1.0247371675943104, 1.151376146788991, 1.1251319957761352, 1.4, 1.0529845185859756, 1.0980735551663747, 1.1918130272438114, 1.0672268907563025, 2.0, 1.1680623736644529, 1.0511556379754852, 1.0033072560400589, 1.0945273631840795, 1.3975903614457832, 1.1111111111111112, 1.1142857142857143, 1.4047619047619047, 1.5172413793103448, 1.0430563978168588, 1.0135047290471273, 1.0049521263367323, 1.019108280254777, 1.0042514147636932, 1.0010091532703655, 6.0, 1.0054013794484709, 1.0638812814470415, 1.3333333333333333, 1.2857142857142858, 1.0242825607064017, 1.0906004288777698, 1.0582232952795414, 1.0860759493670886, 1.0, 1.083916083916084, 1.4857881136950903, 1.1428571428571428, 1.001065934065934, 1.0392514896070733, 1.0015561961518926, 1.194275802254987, 1.2222222222222223, 1.0016216365545059, 1.0802872062663185, 1.115606936416185, 1.0, 1.0850815850815851, 1.0, 1.2314049586776858, 1.1212920237310482, 1.0736198444455993, 1.4097222222222223, 1.0468227424749164, 1.0242382509898433, 1.1665485471296952, 1.09, 1.1733333333333333, 1.054100630200597, 1.0364625302175665, 1.060302204149531, 1.8878504672897196, 1.1009174311926606, 1.110759493670886, 1.1, 1.0276967930029155, 1.0215311004784688, 1.000404726414815, 1.0127157129881925, 1.5, 1.0771182141045155, 1.01663261136085, 1.2074917370547191, 1.348270823185582, 1.0040296876422912, 1.0569452619187758, 1.0954398638557983, 1.0393996247654784, 1.1090909090909091, 1.0042864679504089, 1.0095167998904542, 1.0500992063492063, 1.1374819102749638, 3.5, 1.1931818181818181, 1.0388940393739434, 1.2319884726224783, 1.0032225369682164, 1.0102798400913764, 1.1065332548557976, 2.2, 1.0029154518950438, 1.0378983141455218, 1.0545245838913335, 1.0222222222222221, 1.0051860281712637, 1.2026143790849673, 1.4046094750320102, 1.1015625, 1.0031039504824322, 1.0051576513630935, 1.0826291079812207, 1.0972515856236786, 1.0833333333333333, 1.0837301869358162, 1.0343965466726566, 1.0578676179151802, 1.0142227816236626, 1.063019052271617, 1.0571049136786188, 1.1090909090909091, 1.0174825174825175, 2.5, 1.5, 1.2, 1.004149377593361, 1.1492338441039307, 1.0048839293994003, 1.0354062675369937, 1.159322033898305, 1.012108631724615, 1.0524017467248907, 1.0838509316770186, 1.0246664988673546, 1.5, 1.3571428571428572, 1.157027027027027, 1.0, 1.135204081632653, 1.1352357320099256, 1.0921591095105583, 1.0192129582682647, 1.0, 1.0275064267352185, 1.0074349442379182, 1.0636722606120435, 1.0007496108525293, 1.0401267159450898, 1.0483437779767233, 1.0212568704059335, 1.08450498662126, 1.0844155844155845, 1.4745762711864407, 1.2652582159624413, 1.0, 2.0, 1.0006443538955476, 1.25, 1.3, 1.2708333333333333, 1.0133196721311475, 1.00612565878425, 1.0814859197124027, 1.0116731517509727, 1.0, 1.020102501164786, 1.014992503748126, 1.0234375, 1.0313807531380754]
origin-bjaq_15.87 	max: 6.0000	99th: 3.0000	95th: 1.6785	median: 1.0680	mean: 1.1729

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 20.545918 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=43.072690