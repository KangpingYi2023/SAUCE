Input arguments = Namespace(data_update='tupleskew', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='naru', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 46, 'naru': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=tupleskew', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.5717	median: 1.0566	mean: 1.1475
ReportEsts: [1.0294117647058822, 1.0657785179017485, 1.022068445449908, 1.0077519379844961, 1.0, 1.0, 1.1623461951977063, 1.0103961469647407, 1.25, 1.0290620871862615, 1.0668340403428274, 1.0020057182464044, 1.0106112054329373, 1.0093023255813953, 1.044154009184034, 1.0, 1.6981132075471699, 1.0598653914275593, 3.0, 2.6666666666666665, 1.35, 1.1064912659046797, 1.041259312427295, 1.1072821846553966, 1.042920572274297, 1.0, 1.0358644330897095, 1.2, 1.4, 1.1942446043165467, 1.0, 1.0010020251901524, 1.004779538408543, 1.1387347391786904, 1.0675760426465977, 1.0160449529483446, 1.0561497326203209, 1.0087098370212162, 1.134410083339073, 1.1666666666666667, 1.0128205128205128, 1.0396341463414633, 1.0, 1.1491629589321726, 1.0626253277803486, 1.2231404958677685, 1.116504854368932, 1.2412280701754386, 1.0436690302513378, 1.0285714285714285, 1.0696682806966828, 1.1781376518218623, 1.0074857652845906, 2.0, 1.277922077922078, 1.0082368163600215, 1.0858181818181818, 1.0606060606060606, 1.2111801242236024, 1.6666666666666667, 1.0106779352962558, 1.0367372353673723, 1.0818181818181818, 1.103448275862069, 1.0, 1.0553113426326537, 1.036095577020844, 1.1666666666666667, 1.0, 1.0834259165740834, 1.0119331742243436, 1.0566146735990756, 1.117117117117117, 1.1004557628153926, 1.2, 1.120331950207469, 1.0, 1.041304347826087, 2.0, 1.0429711039054206, 1.25, 1.0490688737806682, 1.1533742331288344, 1.011467889908257, 1.0726315789473684, 1.08, 1.000843861510271, 1.0594148890071933, 1.2205882352941178, 2.3333333333333335, 1.0701001430615165, 1.0361623659645551, 1.0155763239875388, 1.3085553997194952, 1.2059471365638768, 1.1159420289855073, 1.25, 1.0191304347826087, 1.0, 1.0085493160547156, 1.1618430525557955, 1.0346051464063886, 1.0011658305659576, 1.0, 1.006674617158511, 1.100496640373941, 1.080255398394892, 1.0329920364050056, 1.0303221730890715, 1.1666666666666667, 1.0, 1.141029058917622, 1.002907778947476, 1.065993265993266, 1.0266666666666666, 1.002476114696958, 1.0, 1.220554272517321, 1.1636363636363636, 1.0, 1.2142857142857142, 1.0, 1.025706940874036, 1.0152773012341398, 1.1080997126659937, 1.0566037735849056, 1.8, 1.2218543046357615, 1.0, 1.0, 1.0030773634867245, 1.1818181818181819, 1.0140287176101668, 1.013910957312516, 1.062185433218252, 1.141768292682927, 1.1370716510903427, 1.0019523623584536, 1.00199203187251, 1.051249199231262, 1.0688516590761223, 1.0617283950617284, 1.0463144161774298, 1.003137436823986, 2.0, 1.015270708005553, 1.0379596678529064, 1.0769230769230769, 1.0121757543673902, 1.0, 1.0107774279486559, 1.0148148148148148, 1.018, 1.4476190476190476, 1.3751824817518248, 1.0309350017379215, 1.051040949303385, 1.0537469564433222, 1.1806083650190113, 1.1348684210526316, 1.0208333333333333, 1.1594202898550725, 1.1316666666666666, 1.1428571428571428, 1.0357553609853825, 1.0043462016485067, 1.0201496833621186, 1.0152965057271277, 1.0452046426389738, 1.0556571519440248, 1.0063157894736843, 1.0672268907563025, 1.1957005906846132, 1.1354764638346728, 1.1532338308457712, 1.0478615071283095, 1.0293017456359101, 1.0194312796208531, 1.0945945945945945, 1.1666666666666667, 1.3263157894736841, 1.0235447060522895, 1.0476190476190477, 1.1550129485756566, 1.1014492753623188, 1.0010868703793856, 1.0108801243442782, 1.0190247386533342, 1.0175438596491229, 1.1005502751375689, 1.1041568717390058, 1.0, 1.6363636363636365, 1.111255605381166, 1.257661748013621, 1.1320459290187892, 1.4583333333333333, 1.0147909967845659, 1.000107915887274, 1.0003093046920177, 1.1798245614035088, 1.0512279962053337, 1.0172413793103448, 1.09375, 1.0238095238095237, 1.0, 1.0666666666666667, 1.0104873048415077, 1.6794425087108014, 1.103448275862069, 1.0182896688087, 1.0957683741648108, 1.0962549770866201, 1.008628343136167, 1.1664609988958887, 1.0057142857142858, 1.033236994219653, 1.0503744043567051, 1.0104475013059377, 1.0710024305811299, 1.0, 1.1109730848861283, 1.031296161345597, 1.000743008752024, 1.064168086314594, 1.000886016573722, 1.0044831669768228, 1.0344827586206897, 1.004205331969744, 1.1121307714367652, 1.1443880428652002, 1.0786516853932584, 1.1227961003941092, 1.0108317214700193, 1.0881889763779529, 1.0, 1.0342130987292277, 1.0536511835640912, 1.0458445697474872, 1.3432835820895523, 1.0909090909090908, 2.6666666666666665, 1.1032693761980972, 1.1454545454545455, 1.049700316519631, 2.0, 1.0, 1.3793103448275863, 1.0690866510538641, 1.5612244897959184, 1.1104972375690607, 1.080957810718358, 1.0366056572379367, 1.0101781170483461, 1.0646264811952602, 1.1228070175438596, 1.0, 1.0126560154627515, 1.122341155482366, 1.0823117338003503, 1.0246321245742926, 1.0999898410118352, 1.0388822627364116, 1.1104928457869634, 1.0317764906783093, 1.0669856459330143, 1.1512, 1.1996169711255156, 2.0, 1.1172280415145108, 1.0660980810234542, 1.2727272727272727, 1.0869565217391304, 1.1552727272727272, 1.0, 1.17, 1.0254895363703653, 1.0473537604456824, 1.2164634146341464, 1.000197974833905, 1.0041946308724832, 1.0015912188537932, 1.0038573982989245, 1.5, 1.1025463805020008, 1.0, 1.0061280629363891, 1.043196544276458, 1.008246410264647, 1.3, 1.4285714285714286, 1.0434782608695652, 1.4929577464788732, 1.0215263337574874, 1.0, 1.018348623853211, 1.002267573696145, 1.0384615384615385, 1.0048530231445139, 1.1183431952662721, 1.0, 1.0146515961186893, 1.0767837944887682, 1.0873119401687104, 1.1538461538461537, 1.0, 1.2052505966587113, 1.019704433497537, 1.146417445482866, 1.0559089089534315, 1.0772686433063792, 1.0502958579881656, 1.0677966101694916, 1.0054869684499315, 1.0259396506087877, 1.4285714285714286, 1.023599917014722, 1.064102564102564, 1.0, 1.0589240955651178, 1.1428571428571428, 1.75, 1.0234410146381978, 2.0, 1.0027434842249656, 1.0406976744186047, 1.0041186161449753, 1.0026475037821483, 1.0966057441253263, 1.10989010989011, 1.0202789539901784, 1.0075054972696218, 1.0152143845089903, 1.010454675905047, 1.1741545499101453, 2.0, 1.1111111111111112, 1.01774583682203, 1.3333333333333333, 1.048687089715536, 1.0, 1.0, 1.0454545454545454, 1.2028985507246377, 1.0884615384615384, 1.2169811320754718, 1.0465367965367964, 1.0, 1.0246338215712383, 1.0200554357868803, 1.5, 1.3365098272781417, 1.0, 1.0113110149548319, 1.0113636363636365, 1.0516399895040671, 1.172811059907834, 1.0018181818181817, 1.1798994974874373, 1.0740740740740742, 1.0085768552029433, 1.0040843434570295, 1.0, 1.0, 1.1428571428571428, 1.8333333333333333, 1.5, 1.2307692307692308, 1.0016897318273519, 1.25, 1.0580985915492958, 1.108910891089109, 1.0967946281515266, 1.0180927219301228, 1.0286016949152543, 1.0890757096301893, 1.034813925570228, 1.2727272727272727, 1.5, 1.0412147505422993, 1.0398230088495575, 1.0105098741012841, 1.3333333333333333, 3.142857142857143, 1.1269487750556793, 1.0284883720930234, 1.006638174980924, 1.12707182320442, 1.342769701606733, 1.0252454417952315, 1.3333333333333333, 1.0808477237048666, 1.0476694915254237, 1.2692307692307692, 1.0584707646176912, 1.1495327102803738, 1.0402194914599274, 1.022210116307575, 1.0716700050075112, 1.323076923076923, 1.018348623853211, 1.0498533724340176, 1.0, 1.055389522326586, 1.0293694256748103, 1.0060104332048083, 1.0100945842135587, 1.0123350545037293, 1.0099486521181, 1.8333333333333333, 1.1794500723589, 1.2, 1.0546541417591802, 1.1111111111111112, 1.0417808064114464, 1.0014492753623188, 1.065133276010318, 1.0909090909090908, 1.1215121512151216, 3.0, 1.047239263803681, 1.0017953593599787, 1.0030117711973514, 1.0, 1.125, 1.0431861804222649, 1.2528735632183907, 1.084304207119741, 1.236503856041131, 1.2352941176470589, 1.0229479258605472, 1.0896066562273587, 1.046769437497667, 1.0049460075510221, 1.05625, 1.243781094527363, 1.1363636363636365, 1.25, 1.0076726342710998, 1.3448275862068966, 1.0409276944065484, 1.1785714285714286, 1.044489597223104, 1.1363636363636365, 1.1114606464347396, 1.024797027174583, 1.1133241758241759, 1.0, 1.1176470588235294, 1.36, 1.0029184014942216, 1.3391684901531729, 1.0, 1.062102790826195, 1.0043461917962693, 1.2089178356713426, 1.0, 1.5, 1.1836893203883496, 1.0099547511312217, 1.412037037037037, 1.0, 1.0078501220397125, 1.0271580989330746, 1.0869565217391304, 1.030659133709981, 1.0272727272727273, 1.0603674540682415, 1.196774193548387, 1.0319730753050063, 1.174042821881637, 1.0, 1.0810810810810811, 1.0830179291717754, 1.0188194906211823, 1.0451146285898185, 1.0, 1.025170068027211, 1.0180194935422628, 1.0277632268203247, 2.0, 1.1391547049441786, 1.0712654771432606, 1.1423238607701363, 1.1359049408064306, 1.0453590909090908, 1.1642853202405252, 1.0260504201680671, 1.0706364513018323, 2.0, 1.0646545041087394, 1.3454545454545455, 1.0, 1.2953020134228188, 1.1304347826086956, 1.0456033013914128, 1.0370044052863436, 1.0341476002064338, 1.3417487684729064, 1.0293242914839202, 1.0098347220325092, 1.00706219586902, 1.0970873786407767, 4.0, 1.059786340175249, 1.0180161943319839, 1.0040427588559733, 1.031958258601011, 1.080592105263158, 1.2157320872274144, 1.066326530612245, 1.4285714285714286, 1.0221989945746852, 1.020367007230956, 1.0018760859117963, 1.1031114327062228, 1.0391744314196973, 1.0407725321888412, 1.0104890301817182, 1.0388349514563107, 1.079779917469051, 2.0, 1.0833333333333333, 1.0584415584415585, 1.044362292051756, 1.0016778523489933, 1.0618686868686869, 1.1564625850340136, 1.0050251256281406, 1.0554699537750385, 1.0714285714285714, 1.0353096340486154, 1.4303797468354431, 1.0199616786028396, 1.0, 1.1118210862619808, 1.4484126984126984, 1.0921985815602837, 1.0275545350172215, 1.1598984771573604, 1.0434782608695652, 1.073816155988858, 1.0034550956704078, 1.0, 1.9148936170212767, 1.1666666666666667, 1.0, 1.1, 1.2493702770780857, 1.3875802997858673, 1.0564102564102564, 1.0273950656840756, 1.1180285343709468, 1.0168545099516975, 1.0093176888187734, 1.0989370400654128, 1.0624157755436416, 1.0277777777777777, 1.0861182519280206, 1.1451378809869377, 1.0990745781164943, 1.2413294797687862, 1.0788707799767172, 1.016588532275514, 1.018799461978792, 1.0099614054551678, 2.0, 1.0462724935732648, 1.0138632162661738, 1.0555555555555556, 1.0, 1.0625, 1.25, 1.1844863731656186, 1.5555555555555556, 1.5, 1.0417149186848598, 1.0230673538297494, 1.0008802588996764, 1.0675207477237934, 1.135135135135135, 1.0388821385176186, 2.0, 1.2727272727272727, 1.1257861635220126, 1.0052737686751492, 1.0069848849026473, 1.0034863119391895, 1.0095476488467727, 1.1095100864553313, 1.0347385457207814, 1.211367673179396, 1.0225687826535417, 1.0434872644439843, 1.3333333333333333, 1.1343115124153498, 1.0, 1.0113378684807257, 1.0215586130220276, 3.0, 1.0788990825688074, 1.0092037251095942, 1.1428571428571428, 1.1914674449547191, 1.1, 1.1875, 1.0318838526912182, 1.7692307692307692, 1.002519850621805, 1.0217855617257583, 1.2258064516129032, 1.1153846153846154, 1.2309644670050761, 1.0157819225251077, 1.115488795863088, 1.0490456326633801, 1.009819465725135, 1.0, 1.2231153595481208, 1.0152439024390243, 2.0, 1.0841617270567614, 1.0214032355740117, 1.096499526963103, 1.0092542013431445, 1.0352329635499207, 1.3614457831325302, 2.0, 1.00152149106124, 1.0385259631490786, 1.0344628646089626, 1.0980653769179454, 1.0401131929755805, 1.11082051440775, 1.2197802197802199, 1.047953216374269, 1.1368821292775666, 1.0202728264014065, 1.061198738170347, 1.0534420289855073, 1.138655462184874, 1.0578897080093619, 4.0, 1.0027603249296775, 1.021967972485363, 1.0325327605658248, 1.0555555555555556, 1.0081933064852104, 1.3482587064676617, 1.0, 1.0384178721845816, 1.0134426229508198, 1.0904761904761904, 1.2352941176470589, 1.6666666666666667, 1.01450872741893, 1.0, 1.3674121405750799, 1.1538461538461537, 1.0898053171446516, 1.3333333333333333, 1.2950819672131149, 1.1572327044025157, 1.0, 1.2632275132275133, 1.0215827338129497, 2.0, 1.0, 1.08130081300813, 1.1068702290076335, 1.0725326991676576, 1.0138297872340425, 1.0810810810810811, 1.0412979351032448, 1.089150378938971, 1.044155844155844, 1.5806451612903225, 1.4, 1.1923076923076923, 1.0, 1.0745945945945945, 1.2813852813852813, 1.0308839190628327, 1.2876200640341515, 1.0119294391391906, 1.2183815378413787, 1.0115762013458631, 1.0060733898243446, 1.0348977135980746, 1.0035928143712576, 1.375, 1.0, 1.0, 1.0324779627815868, 1.1021400778210118, 1.0065359477124183, 1.2415902140672783, 1.0294768995799923, 1.0460690195639397, 1.0068540243221176, 1.0897435897435896, 1.1, 1.0614359733530718, 1.08834835630965, 1.0355953702235612, 1.0712142640003173, 1.1776315789473684, 1.117616656822209, 1.0087310359070065, 1.2089783281733746, 1.031512605042017, 1.1111111111111112, 1.0221504383940931, 1.3155555555555556, 1.0192307692307692, 1.112121212121212, 1.0347890451517394, 1.0, 1.0841584158415842, 1.0870765281904327, 1.1481481481481481, 1.0091785478311401, 1.117584745762712, 1.1162790697674418, 1.0215049855219958, 1.0076646445566493, 1.1280217566478645, 1.0057581573896353, 1.0126436781609196, 1.0086508115419297, 1.1594202898550725, 1.0714285714285714, 1.0, 1.1111111111111112, 1.0233014412014048, 1.8333333333333333, 1.1523899455910787, 1.0665823057455173, 1.2146654851572884, 1.0606698967769117, 1.0072781929218981, 1.0180032733224222, 1.0568181818181819, 1.0069832402234637, 1.004442670298448, 1.0032208769248854, 1.007022505572466, 1.025834035890642, 1.25, 1.0158730158730158, 1.2885375494071147, 1.0424586254245862, 1.0846905537459284, 1.031086956521739, 1.1699115044247788, 1.0019493177387915, 1.0432797829532985, 1.0332871012482663, 1.021904948171328, 1.25, 1.0075071188195703, 1.0012638243739926, 1.1521344232515895, 1.0008428150021071, 1.0666666666666667, 1.0949589683470105, 1.1791044776119404, 1.5625, 1.0274214795812244, 1.4615384615384615, 1.1139112903225807, 1.0681318681318681, 1.153068105192178, 1.0337684943429069, 1.0847058823529412, 1.2222222222222223, 1.0566037735849056, 1.005312695319681, 1.0056655640979797, 1.0035300586052207, 1.1266479121848971, 1.057448998123373, 1.0833333333333333, 1.0410846343467544, 1.104707950771635, 1.013795258716907, 1.0162932790224033, 1.2083333333333333, 1.0311483031148303, 1.047604279733292, 1.1571428571428573, 1.0043793073366483, 1.0, 1.3333333333333333, 1.0103686123266336, 1.055547304321996, 1.0115389098255565, 1.0081920118617367, 1.0750199521149242, 1.0869565217391304, 1.008122147637776, 1.095788986580287, 1.0128676470588236, 1.2972972972972974, 1.038515406162465, 1.0028223629313306, 1.0119047619047619, 2.3333333333333335, 1.0315696291635115, 1.0125329445410194, 1.039715471250741, 1.2054794520547945, 1.053394355453852, 1.0131955305688238, 1.0053702656868286, 1.0175, 1.1923076923076923, 1.1132075471698113, 1.014957264957265, 1.121875, 1.7916666666666667, 1.0613588110403398, 1.0109018830525272, 1.089430894308943, 1.2058823529411764, 1.047861704617648, 1.0, 1.0186132133360606, 1.0200039611804317, 1.3333333333333333, 1.037037037037037, 1.3333333333333333, 1.0319913731128685, 1.5769230769230769, 1.3333333333333333, 1.3636363636363635, 1.196513470681458, 1.018450184501845, 1.0612416413929184, 1.0108338699291695, 1.1224489795918366, 1.6176470588235294, 1.0, 1.064516129032258, 1.364864864864865, 1.6666666666666667, 1.014018691588785, 1.0126702822447202, 1.0077174457647524, 1.0546875, 1.0007665405068749, 1.000430408888444, 5.0, 1.0060392637201865, 1.1885714285714286, 1.0, 1.3333333333333333, 1.03698224852071, 1.1120275407014273, 1.0158514654566675, 1.0807453416149069, 1.0, 1.1266375545851528, 1.0828220858895705, 2.0, 1.5, 1.092027559055118, 1.079367382472432, 1.1926974664679584, 1.25, 1.0129808320736822, 1.0704879938032532, 1.1416861826697893, 1.3333333333333333, 1.086734693877551, 1.0027764519230122, 1.2105263157894737, 1.0740524781341108, 1.0277052480516633, 1.0094117647058825, 1.04296875, 1.0311432506887053, 1.178479931682323, 1.0743801652892562, 1.2321428571428572, 1.0316135965543212, 1.2335546167773084, 1.025553228505258, 1.3253968253968254, 1.2289156626506024, 1.2238805970149254, 1.0268886043533931, 1.0395341710082746, 1.0079750865880803, 1.0197980334839225, 1.0403930131004366, 3.0, 1.25, 1.0121460077990154, 1.1007036059806508, 1.3055825714841471, 1.0167966556436014, 1.070747616658304, 1.0726812953748266, 1.1136363636363635, 1.0625, 1.0324660011005424, 1.02200488997555, 1.022981732469063, 1.0175131348511384, 2.5, 1.0533333333333332, 1.0865035401151912, 1.070967741935484, 1.0106699945402076, 1.0231750457296191, 1.140625, 1.6, 1.0093457943925233, 1.0422035008677464, 1.0303861092072195, 1.0190114068441065, 1.0166940828684499, 1.3593073593073592, 1.3482142857142858, 1.0857971014492753, 1.0037701621716133, 1.0399649813963667, 1.108294930875576, 1.1395646606914211, 1.0, 1.0049555707450444, 1.0074367416480556, 1.0977542932628799, 1.0343461332054489, 1.021603183627061, 1.0765472312703583, 1.3846153846153846, 1.0552016985138004, 2.5, 1.5, 1.4166666666666667, 1.0179028132992327, 1.1753554502369667, 1.0662482825207027, 1.025540929965305, 1.1725915875169606, 1.0223849372384937, 1.1141304347826086, 1.5510204081632653, 1.0237560054291233, 1.6, 1.25, 1.1320325203252033, 1.0, 1.1158989598811293, 1.1507334344967122, 1.042371288989102, 1.0253850773400854, 1.25, 1.3341594382486577, 1.2945736434108528, 1.0653366583541146, 1.0006058881310187, 1.03125, 1.0373001776198933, 1.0288501993468635, 1.0476888387824126, 1.1303656597774245, 1.392156862745098, 1.2681564245810055, 1.0, 1.0, 1.0008136332749187, 1.6666666666666667, 1.5714285714285714, 1.4210526315789473, 1.0156815440289506, 1.119047619047619, 1.0209394453876628, 1.0902480752780155, 1.0, 1.1949099937926753, 1.031946955997589, 1.1524663677130045, 1.0297029702970297, 1.25, 1.0102785145888593, 1.030857142857143, 1.0957446808510638, 1.0476013387876535, 1.0069882953376645, 1.027059364933272, 1.062205466540999, 1.0, 1.112538830838746, 1.000967123071667, 1.0402170014347203, 1.2695652173913043, 1.0317170455091547]
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.5717	median: 1.0566	mean: 1.1475

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 20.252006 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=naru', '--data_update=tupleskew', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
TupleSkewSample - START
0.001
TupleSkewSample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[1.5735626e-05 1.0728836e-05 9.5367432e-07 2.8610229e-06 1.0132790e-06]
Distance score: 6.258487701416016e-06
SAUCE Drift detection: False
Detection latency: 0.0230s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 2.005718 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=tupleskew', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 210.0000	99th: 55.5050	95th: 3.0000	median: 1.1021	mean: 3.2284
ReportEsts: [1.0571428571428572, 1.0419514494461466, 1.0502720716988947, 1.198076923076923, 1.1666666666666667, 1.0, 1.102394756743131, 1.0128510503153214, 1.0, 1.076158940397351, 1.0034653465346535, 1.0020410452757402, 1.0677842565597668, 1.2720930232558139, 1.0067389393495458, 209.0, 1.323076923076923, 10.333333333333334, 1.3333333333333333, 1.1322645290581161, 1.0553797468354431, 1.0044197117250124, 1.3233480176211454, 1.2737327188940093, 1.0632022216978563, 1.007578579086959, 2.0, 1.0445532501961208, 1.0, 1.6, 1.1617528812650764, 1.0, 1.0007039662662196, 1.002292279755456, 1.2742305925585669, 1.0107182456572625, 1.0067007195034876, 1.1229946524064172, 109.5, 1.1231439570201784, 1.0028954734099025, 1.0057284618854307, 1.089848308051342, 1.00382913599141, 1.2241992882562278, 1.0890492981172244, 1.3333333333333333, 1.2171837708830548, 1.2380952380952381, 1.0435103244837758, 17.692307692307693, 1.0256410256410255, 1.7276785714285714, 1.1379310344827587, 1.069457205661716, 1.0237732520846696, 1.0154981549815498, 1.2764578833693305, 1.064102564102564, 1.0294319203282278, 1.3148148148148149, 1.0045827972721846, 1.044295302013423, 1.2954545454545454, 1.3563218390804597, 56.0, 1.0987194347850087, 1.029100529100529, 1.0, 1.0, 1.1184333759046403, 1.1849642004773269, 1.1334062329141608, 1.3355855855855856, 1.063065160864672, 2.1372549019607843, 1.0704621841570983, 1.7190476190476192, 1.0930232558139534, 1.0063640220619432, 1.0893271461716938, 4.285714285714286, 1.0, 55.5, 1.100702576112412, 1.0980392156862746, 9.909090909090908, 22.88888888888889, 19.0, 1.0427632638598074, 1.1026938775510204, 1.0173289234639213, 1.016594110115237, 1.0083273362804566, 1.205607476635514, 1.206140350877193, 1.9479166666666667, 1.43944099378882, 6.378378378378378, 1.0041075429424944, 1.64, 17.166666666666668, 1.080767906648064, 1.1419887103777682, 1.1818181818181819, 1.0215799728405266, 1.3529411764705883, 1.005804370441997, 1.1344099378881987, 1.0122417750573833, 1.1006979062811566, 1.046415819829717, 1.3333333333333333, 20.88888888888889, 1.1301840762918607, 1.0243519582782934, 1.0028328611898016, 1.2077922077922079, 1.001032174348993, 2.0, 1.0984918436441982, 1.30622009569378, 1.0, 1.456043956043956, 1.0, 1.2910284463894968, 1.0161602627952553, 1.15008308408109, 1.1607142857142858, 1.8, 1.2814245810055866, 1.0, 30.571428571428573, 1.0343012874729818, 1.0, 1.3100436681222707, 1.0638563438327937, 1.0233132199670871, 194.0, 1.1333333333333333, 1.2078239608801955, 1.0649854510184287, 1.4138115631691648, 1.0518463158609912, 1.5123456790123457, 1.2550554468362687, 1.0323812290549164, 3.0, 1.095298068849706, 1.25440313111546, 1.0114885114885115, 1.0172914850334205, 1.0, 1.0235081374321882, 1.2622222222222221, 1.228, 1.3942414174972315, 1.0, 1.0360097323600974, 1.0322420073760663, 1.012904876800468, 1.0137741046831956, 1.3223684210526316, 1.183673469387755, 1.4710144927536233, 1.2335164835164836, 1.4285714285714286, 1.0078907095666456, 40.4, 1.271551724137931, 1.0010209582855987, 1.0051457975986278, 1.1063685022226255, 1.2419928825622777, 1.1151919866444073, 1.2764420959929546, 1.1568950631818538, 1.0060396893874028, 1.0424448217317488, 1.1796359799525191, 1.080140752144271, 1.013036632728036, 1.164179104477612, 1.7586206896551724, 1.0400632799156269, 1.0596849250736455, 1.4798657718120805, 1.081507048696303, 1.036723163841808, 33.833333333333336, 1.0901639344262295, 1.038005359260832, 1.2, 1.0726895119418485, 1.010125006641215, 1.0193247137507513, 1.0243465807375582, 1.079107505070994, 1.047059915533485, 1.0703260208615932, 1.0870141342756183, 1.0543922787502045, 1.0008079719903042, 1.0165419187258622, 1.0169941582580988, 1.0227402396283316, 1.0282485875706215, 1.234375, 1.2380952380952381, 1.0, 1.9722222222222223, 1.0840683186336273, 2.1045296167247387, 1.2988505747126438, 1.016474464579901, 17.416666666666668, 1.0075565177567758, 1.1691648822269807, 1.014003977461054, 63.666666666666664, 1.0057803468208093, 1.0928067700987305, 1.0334953012850554, 1.0457929597082076, 35.166666666666664, 26.875, 1.030598470076496, 1.0827095808383234, 1.1898734177215189, 1.1545226130653266, 1.1561040693795863, 1.1239056143205859, 1.1485148514851484, 1.0001140943816667, 1.020746972283183, 1.7198581560283688, 1.3919753086419753, 1.5997652582159625, 8.72, 1.0479251899473991, 1.0, 1.1630532971996386, 1.0870714892813296, 1.0323108384458077, 1.7276119402985075, 1.0833333333333333, 3.3333333333333335, 1.0827653799758745, 1.4, 1.07755525886367, 1.5, 1.0596245859403755, 1.0578093306288032, 1.1428571428571428, 1.0486231604652658, 1.328729281767956, 1.0914231856738925, 1.8416988416988418, 1.1369089625970359, 1.0151175072616847, 1.2456140350877194, 2.0, 1.0458423588700765, 1.0061997951372041, 1.0229419703103915, 1.0073535973726953, 1.0419670918838972, 1.013870372996738, 1.0949820788530467, 1.0410526004902685, 1.2828947368421053, 1.0955987984850464, 1.013847144697295, 2.0, 1.057911541271732, 1.275053304904051, 1.5227272727272727, 1.24, 1.2723577235772359, 1.2629558541266794, 1.0508941326311079, 1.0749855658198615, 1.3955431754874652, 1.0300751879699248, 1.0055593402385843, 1.4636296840558414, 1.0017587411771114, 1.0168303758620383, 1.7, 1.1090909090909091, 1.1634860050890585, 1.0226353494078626, 1.0035708064797073, 1.01704966641957, 1.0382848392036754, 1.0773774365032487, 1.067976710334789, 1.0599814893919977, 1.0635676436802906, 1.0400894270558503, 1.132034632034632, 20.5, 1.2727272727272727, 1.0613496932515338, 35.833333333333336, 1.7787610619469028, 1.0275725564573042, 1.0892741317294652, 1.3870967741935485, 1.6534653465346534, 2.8877551020408165, 1.0541464292138873, 1.007592119150258, 1.2, 1.0608945103664102, 1.018052734932277, 1.2140845070422535, 16.307692307692307, 1.6666666666666667, 1.0166777851901267, 1.7142857142857142, 1.0041406071819778, 1.102158273381295, 1.3157894736842106, 1.0800542576511767, 1.380952380952381, 1.5555555555555556, 1.0335530606964956, 2.0, 15.6, 1.0080091533180777, 1.0379939209726443, 1.5079872204472844, 1.122715404699739, 1.4395604395604396, 1.0123969681568072, 1.0174284929045925, 2.3834586466165413, 1.0440122824974412, 1.023120656980417, 3.0, 1.4444444444444444, 1.055330688094431, 1.0, 1.0300893276915843, 1.1764705882352942, 201.0, 1.2272727272727273, 1.0281124497991967, 1.1086572438162545, 1.0155038759689923, 1.5486725663716814, 1.4545454545454546, 2.0, 1.0444076915686462, 1.4112554112554112, 1.0714285714285714, 1.0383423565510583, 1.434782608695652, 1.0270700636942676, 1.2459943449575872, 2.25, 1.0, 1.0919117647058822, 1.2424242424242424, 1.4784688995215312, 1.0033991046260984, 1.1674883411059294, 1.308641975308642, 1.0, 1.0017336276674025, 2.1013513513513513, 1.0, 96.0, 1.2942675159235668, 1.4285714285714286, 1.400473933649289, 1.2079207920792079, 1.0562860249020534, 1.0332625671783604, 1.0690099967752338, 1.0642982502792107, 1.002376625192227, 1.2787524366471734, 1.234248788368336, 1.0050460687386698, 1.3, 1.2333333333333334, 1.0067844489131477, 1.036569598023891, 1.1339016294508146, 1.1428571428571428, 1.3714285714285714, 1.1595744680851063, 2.0, 1.5555555555555556, 1.0526315789473684, 1.2844036697247707, 1.0368098159509203, 5.738095238095238, 1.0906652360515021, 1.0775862068965518, 1.0518476478748897, 1.2529661016949152, 1.0756767077160736, 1.036144578313253, 1.0990990990990992, 1.1396648044692737, 1.0, 1.0082146100771305, 1.1551724137931034, 1.0044144719540145, 1.0345301813856675, 1.0186601407158153, 1.1783871843605755, 1.5714285714285714, 1.0671550671550671, 1.2, 1.2155309033280508, 1.0, 1.382640586797066, 1.2159420289855072, 1.0741958414785855, 1.4387351778656126, 1.0117160578911095, 3.0, 1.0068746694870438, 1.0076022127551345, 1.026282403287194, 1.0, 1.2857142857142858, 1.3275862068965518, 1.4885057471264367, 1.076250211900322, 1.2455795677799608, 1.4285714285714286, 1.2670080468178493, 1.0356083086053411, 1.007861849579641, 1.0177854152146966, 1.0610987344172158, 1.0357190996091117, 9.681818181818182, 1.3874207188160677, 1.0145258937655508, 1.7592592592592593, 1.2154046997389034, 1.0, 1.5, 1.0434265318262939, 1.0555555555555556, 1.2950536146662055, 1.0526754585417615, 1.0604565083281925, 1.0, 1.1228070175438596, 1.6, 1.0674303566779484, 1.0909090909090908, 1.0, 1.0877263209754895, 1.0, 1.0, 1.2179916317991633, 1.5, 1.1317042208822596, 1.1306607275426874, 1.2055335968379446, 1.2222222222222223, 1.0054992488665022, 1.236040609137056, 1.12, 1.018088010318865, 1.2363636363636363, 1.2315010570824525, 1.1688764829030007, 1.1842658813630627, 1.1313700624677094, 1.0, 1.2702702702702702, 1.2037295224817008, 1.0867655966081162, 1.0383824537354351, 1.2, 1.0164059519267454, 1.005832484837753, 1.1056338028169015, 2.0, 1.0702033036848793, 1.0241195765325162, 1.064133997470772, 1.1901413608730682, 1.0279062787251205, 1.0110112918680552, 1.0562678062678064, 1.2391656646975795, 1.5, 1.05372460496614, 1.1165730337078652, 1.0627413127413128, 1.1461133839859732, 1.2507936507936508, 1.0462164349404706, 1.0891364902506964, 1.0300255791159667, 1.6353364149974319, 1.0491535814578965, 27.571428571428573, 1.0232124352331606, 1.2164276401564538, 1.12, 1.0493827160493827, 1.0176431080801818, 1.3520408163265305, 1.0740453146232563, 1.0037366723013312, 1.0, 1.3129675810473815, 1.4914089347079038, 4.719298245614035, 1.2941176470588236, 1.0118923508485325, 1.0651340996168583, 2.5042735042735043, 1.0, 4.366666666666666, 1.0955958549222797, 1.0023841786590282, 1.024582104228122, 1.005418460306337, 1.174169741697417, 1.0110041265474552, 1.0870967741935484, 1.0706559079651674, 1.0507246376811594, 1.0449205252246025, 1.226152874289324, 1.6991150442477876, 1.0818171794023597, 1.0586407766990291, 1.0746450139832742, 1.0, 1.06187624750499, 1.5277777777777777, 1.014244912531239, 1.1767554479418887, 1.0284463894967177, 1.3201581027667983, 1.3605313092979128, 1.0166930363902185, 1.0, 2.0, 1.6666666666666667, 1.0, 2.97, 2.5289256198347108, 2.225130890052356, 1.0194174757281553, 1.0187236286919832, 1.2233096085409252, 1.0090906567479043, 1.0340181597556384, 1.012042609703032, 1.008726718987935, 1.0295846525857346, 1.1005917159763314, 1.0107437903177876, 1.0154980664888036, 1.1102902374670185, 1.163849154746424, 1.0989445910290236, 1.1133333333333333, 1.0085840418574232, 1.2595797280593326, 1.0161672946195404, 1.1134020618556701, 1.1005411563657077, 1.013779527559055, 2.5, 1.209563994374121, 1.1428571428571428, 105.5, 1.0931818181818183, 1.0070181369234839, 1.0875943000838224, 1.3180428134556574, 1.0649350649350648, 1.012003760214043, 1.2380969364100003, 1.1462882096069869, 1.0, 29.25, 1.092077327075651, 1.6702702702702703, 1.14616497829233, 1.1234393404004712, 1.0, 1.2933630786391523, 1.3719806763285025, 1.0747086820942064, 1.4564831261101243, 1.006906975854284, 1.0708514605344934, 1.0049862693112517, 1.0845070422535212, 34.166666666666664, 1.0480816406633304, 1.0, 1.1683168316831682, 1.8808510638297873, 1.057427258805513, 3.1538461538461537, 1.064516129032258, 1.0247272335902922, 1.0601503759398496, 1.502377179080824, 1.0554053741826668, 1.2109375, 1.176511466296039, 1.1251068376068376, 1.037837837837838, 1.0950373013298735, 1.4, 1.1000899133562203, 1.0529615748362464, 1.3333333333333333, 1.0741002117148906, 1.0596602133544053, 1.135497595264521, 1.0435719093560691, 1.0, 1.0149892933618843, 1.2029480880153813, 1.2847222222222223, 1.0357142857142858, 1.0329428800455098, 1.118811881188119, 2.0, 1.0014710208884967, 1.1709585121602288, 1.0790803292648312, 1.0953965612867442, 1.0473834562560518, 1.0732511589988196, 1.0334224598930482, 1.1007451564828614, 1.5705128205128205, 1.0461036995646202, 1.2820189274447948, 1.1403641881638846, 1.028838342810723, 1.0101199837724588, 1.2842242503259453, 1.1280928816140083, 1.3888888888888888, 1.6, 1.3179791976225854, 1.0390879478827362, 1.1570735090152566, 1.2191673212882954, 1.3333333333333333, 1.0367705835331735, 1.3095936321742774, 1.0606060606060606, 1.049030080328149, 2.0, 1.1033062003818712, 1.5, 1.2193732193732194, 1.3076923076923077, 1.1742110009017133, 1.0909090909090908, 1.0042194092827004, 1.351153039832285, 1.0, 1.1143255489717672, 1.0724233983286908, 2.25, 1.0, 1.112781954887218, 1.5777777777777777, 1.1731382978723404, 1.0352622061482821, 1.190625, 8.161290322580646, 1.518624641833811, 1.1065468549422337, 1.3101604278074865, 1.0698689956331877, 1.4615384615384615, 1.0, 1.0208695652173914, 1.4834054834054835, 1.177685950413223, 1.1626683501683501, 1.0128572138561702, 1.1819397180359748, 1.0315408416598384, 1.035678735846709, 1.1508903467666354, 1.192124105011933, 1.0, 1.0, 1.2058823529411764, 1.0708531029914703, 1.0889621087314663, 1.2058823529411764, 1.0689655172413792, 1.172006155567991, 1.073586129621985, 1.0046374809755847, 2.92, 1.0454545454545454, 2.0259067357512954, 1.2004455648707275, 1.0465293771088855, 1.057396577864414, 1.5825688073394495, 1.0649358773850486, 1.0033129133876573, 1.0067884472969637, 1.0265553869499242, 1.0537468962429275, 1.0387596899224807, 1.0415169660678643, 1.1334850208570346, 1.0025795078004316, 2.683333333333333, 1.1715085001075962, 1.0, 1.095890410958904, 1.0492883239994921, 1.3703703703703705, 1.0183133394444224, 1.3898305084745763, 4.777777777777778, 1.0589485235434957, 1.0004193751310548, 1.1081795679567956, 1.1927480916030535, 1.1963677639046537, 1.007456562009051, 1.0303571428571427, 1.2142857142857142, 1.0, 1.0, 1.0186904520575715, 2.1666666666666665, 1.0000088731144632, 1.0786719266640823, 1.1816947837890246, 1.1022443890274314, 1.0031006942291185, 1.05738426333392, 1.1290322580645162, 1.2875143184421536, 1.0095547659848758, 1.044877606527652, 1.0036462463587348, 1.0303834217639403, 1.1111111111111112, 1.1488643339472069, 1.112219451371571, 1.0030908568142611, 1.3159609120521172, 1.00968567251462, 1.0138713745271122, 1.2378167641325537, 1.043668538326685, 1.0758776896942241, 1.0071594272458204, 1.5625, 1.0127982234429558, 1.019082504072802, 1.1504782928623989, 1.198736842105263, 1.21875, 1.0526968381897086, 1.0049627791563276, 1.0508781075885438, 2.4461206896551726, 1.0039746273172003, 1.2424242424242424, 1.1518056887184405, 1.2657569850552306, 1.1552863436123348, 1.3083798882681563, 1.2778702163061564, 1.388076490438695, 1.2028112449799198, 1.0353440758886852, 1.0101569713758078, 1.013723500827682, 1.0333244411995957, 1.3846153846153846, 1.1952908587257618, 1.0454232622161046, 1.0135884096420502, 1.51953125, 1.3476070528967254, 1.1326129666011788, 1.1380013596193066, 1.1795212765957446, 1.0049046835016167, 4.894736842105263, 1.241549295774648, 1.0347380598248224, 1.0561729642351991, 1.3450134770889488, 1.0434577231931979, 1.0609960002622778, 1.0793758480325644, 1.3346693386773547, 1.0162493098987302, 1.1014945537448282, 1.1468315301391037, 1.491891891891892, 1.0582464745554874, 1.0013952359768674, 1.2261904761904763, 1.75, 1.0492678958785249, 1.018609229343987, 1.0454777721001534, 1.1069182389937107, 1.183201267828843, 1.0081522702300358, 1.0550202839756593, 1.1255766273705792, 1.4615384615384615, 1.3676695563488017, 21.5, 1.25, 1.3870967741935485, 1.0895536340266418, 1.218037661050545, 1.1545961002785516, 1.0, 7.407407407407407, 1.0070159027128158, 1.1647058823529413, 11.647058823529411, 1.2279138827023015, 1.9431279620853081, 1.0616273471352913, 1.2, 1.044008891548754, 1.014840182648402, 1.1097089878959567, 1.3368421052631578, 185.0, 1.0373555495834452, 1.1042235299686036, 1.0092886758925206, 1.1310751104565537, 1.7941176470588236, 1.1875, 1.2580645161290323, 1.5810810810810811, 1.2962962962962963, 1.0642432556012802, 1.0151927520609285, 1.0034809436255414, 1.234375, 1.0066580571100587, 1.0058046210651166, 5.0, 1.0041051545101964, 1.1130054644808742, 1.0, 1.1428571428571428, 1.241715976331361, 1.1877755511022043, 1.047597203801394, 1.2515527950310559, 1.0, 2.096774193548387, 1.4141104294478528, 3.6153846153846154, 1.0476010811478902, 1.066281739130435, 1.0149405473747324, 1.1339748334566988, 1.0, 1.0182987668161434, 1.2796281951975212, 1.382172131147541, 1.1873111782477341, 1.0153677277716795, 1.0, 6.4, 1.0261891007124977, 1.0797476119533784, 2.371212121212121, 1.4721311475409835, 1.0318392508960992, 1.215843023255814, 1.3677685950413223, 1.0, 1.0535711725146617, 1.1149199489244672, 1.0367744549204478, 1.6372549019607843, 1.0408163265306123, 1.6602739726027398, 1.25, 1.0193977996525767, 1.2514792899408285, 1.002671253017824, 1.2663755458515285, 1.5, 1.0950902934537246, 1.0279765514453203, 1.2482869810560258, 1.327203893996755, 1.1118210862619808, 1.0309063065571489, 1.093339866307353, 1.1746031746031746, 1.1875, 1.0085699332722753, 1.046005905698224, 1.2999410724808484, 1.4956217162872154, 2.5, 1.2266666666666666, 1.0551499549853702, 1.1155844155844157, 1.0073564709698346, 1.018842548116739, 1.1536539662710805, 1.3333333333333333, 1.0009624639076036, 1.0625851414582141, 1.0671336835960303, 1.167300380228137, 1.02173505344928, 1.0363036303630364, 1.198019801980198, 1.0600858369098713, 1.002362233450685, 1.3109756097560976, 1.292832167832168, 1.0786516853932584, 1.21875, 1.1468360071301247, 1.0500027116437984, 1.0036044450831059, 1.1092436974789917, 1.0158259149357072, 1.1269736842105262, 1.3856382978723405, 1.1293532338308458, 2.5, 1.5, 1.1333333333333333, 1.6535269709543567, 1.1668918918918918, 1.0415558205669204, 1.0373981093835525, 1.2275067418484922, 1.1876506582607083, 1.3043478260869565, 1.0437665782493368, 1.0329121784613915, 1.3333333333333333, 1.5, 1.321078431372549, 1.125, 1.5205843293492696, 1.0781692993114622, 1.036616264814058, 1.0044087470625283, 1.25, 1.0152350932492777, 1.257336343115124, 1.051426260135981, 1.0091466002114018, 1.143020594965675, 1.1111444878341845, 1.0338236022383995, 1.0062082588655819, 1.2066115702479339, 1.2241379310344827, 1.1546162402669633, 1.0, 210.0, 1.0103959018181545, 1.25, 1.8571428571428572, 1.1020408163265305, 1.8912248628884827, 1.0001103963527431, 1.238735709482179, 1.2175925925925926, 1.1666666666666667, 1.3632923368022707, 1.2160555004955402, 1.3829113924050633, 1.1514423076923077]
origin-bjaq_15.87 	max: 210.0000	99th: 55.5050	95th: 3.0000	median: 1.1021	mean: 3.2284

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 16.357878 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=38.648273