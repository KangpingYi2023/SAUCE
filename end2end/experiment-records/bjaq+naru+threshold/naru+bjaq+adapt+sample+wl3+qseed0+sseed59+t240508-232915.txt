Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='naru', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 59, 'naru': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 5.0000	99th: 2.6700	95th: 1.6157	median: 1.0595	mean: 1.1502
ReportEsts: [1.1371841155234657, 1.0417797069994574, 1.0220533331361865, 1.0307692307692307, 1.0344827586206897, 1.0, 1.1783940898631464, 1.0039280295208253, 1.25, 1.0317880794701986, 1.0326955819121, 1.0024790773671506, 1.015119697606048, 1.0255813953488373, 1.0240197809961145, 1.0, 1.6363636363636365, 1.057031526744598, 3.0, 2.6666666666666665, 1.0384615384615385, 1.0859607504852276, 1.0397152954551072, 1.0703959773727216, 1.00838677849038, 1.0, 1.0271943045890388, 1.0, 1.4, 1.1726618705035972, 1.0, 1.001796880615252, 1.0118104423994883, 1.490566037735849, 1.0788662064914085, 1.0341886128224222, 1.0274725274725274, 1.0175363620911542, 1.1489083270197673, 1.1428571428571428, 1.1572700296735905, 1.076219512195122, 1.0, 1.1828995057660625, 1.0590775875366343, 1.1900826446280992, 1.0970873786407767, 1.1991525423728813, 1.026708188618755, 1.0093457943925233, 1.0339789453397894, 1.0817843866171004, 1.0091579089614453, 2.0, 1.3766233766233766, 1.0028250360976834, 1.0283636363636364, 1.064638783269962, 1.2919254658385093, 1.25, 1.0019538349691022, 1.0423412204234122, 1.1181818181818182, 1.0689655172413792, 1.0, 1.0821709182790489, 1.0731964191679833, 1.1666666666666667, 1.0, 1.0126498631171528, 1.0047961630695443, 1.062754212667054, 1.1396396396396395, 1.1378807753971725, 1.2023529411764706, 1.108829568788501, 1.0, 1.048140043763676, 1.6, 1.0296278228930529, 1.03125, 1.0502877185290733, 1.177914110429448, 1.0068807339449541, 1.0670157068062827, 1.04, 1.0084917250849172, 1.0703742619833885, 1.107843137254902, 2.3333333333333335, 1.0393700787401574, 1.0426678273758756, 1.0498442367601246, 1.2748948106591866, 1.2193763919821827, 1.1, 1.2857142857142858, 1.0164787510841284, 1.0, 1.0116447012096046, 1.1635709143268538, 1.0246045694200352, 1.002866444900559, 1.1764705882352942, 1.002896184851598, 1.1174725600711954, 1.0177116838631521, 1.1130072051573758, 1.0225705329153605, 1.1666666666666667, 1.3333333333333333, 1.1248357424441524, 1.00455350496676, 1.0776038121170866, 1.1323529411764706, 1.0057122837853083, 1.0, 1.2186779400461183, 1.1894736842105262, 1.0, 1.1978021978021978, 1.0, 1.012531328320802, 1.0156274871156357, 1.0769589190028734, 1.037037037037037, 1.8, 1.2384105960264902, 1.0, 1.0714285714285714, 1.0042633241659935, 1.1818181818181819, 1.009861932938856, 1.000037682051411, 1.0485341217048534, 1.1870047543581617, 1.0082191780821919, 1.0284569138276554, 1.00199203187251, 1.0505761843790014, 1.022763500325309, 1.3703703703703705, 1.0404435746901501, 1.0328699281009603, 2.0, 1.0148011100832564, 1.0355029585798816, 1.0589330024813897, 1.0252338097758955, 1.0, 1.0923952530879149, 1.0296296296296297, 1.022, 1.4476190476190476, 1.0598540145985402, 1.0278981112458847, 1.0947313480441905, 1.0232064590542098, 1.1140684410646389, 1.0986842105263157, 1.0204081632653061, 1.1594202898550725, 1.1626712328767124, 1.1428571428571428, 1.0004569073642717, 1.0152879549215015, 1.0011527377521614, 1.0215916551170763, 1.0543677458766036, 1.0633696429991253, 1.0021052631578948, 1.0357142857142858, 1.2226203156773507, 1.0566239316239316, 1.140748031496063, 1.0188118811881188, 1.0380383527192707, 1.042445781672792, 1.2149148785753865, 1.1666666666666667, 1.6153846153846154, 1.065884476534296, 1.0476190476190477, 1.211431742508324, 1.3818181818181818, 1.0262827544869548, 1.0574668460503556, 1.0151158958585083, 1.1153846153846154, 1.0674429888403687, 1.0384496301817556, 1.0, 1.7272727272727273, 1.1009374028166512, 1.2905788876276958, 1.0711111111111111, 1.25, 1.0102893890675242, 1.0034066910907065, 1.0072484882172843, 1.1798245614035088, 1.1106777695794245, 1.2826086956521738, 1.078125, 1.0120481927710843, 1.0, 1.0666666666666667, 1.0079478620251152, 1.627177700348432, 1.0229885057471264, 1.0173010380622838, 1.0957683741648108, 1.0846635571330348, 1.023250532292406, 1.0404784430328422, 1.1069182389937107, 1.1552587646076795, 1.0489462950373896, 1.0138434143259234, 1.068510263067653, 1.0, 1.0563146997929607, 1.0000590900137876, 1.0078480299432526, 1.056369785794814, 1.0131860113618596, 1.0043985789206564, 1.0344827586206897, 1.001721252155058, 1.0493843864159111, 1.1923293852227863, 1.0786516853932584, 1.09085252022402, 1.0101602188354826, 1.1519685039370078, 1.0, 1.0217391304347827, 1.1667038856632426, 1.0269573370839193, 1.3507462686567164, 1.0909090909090908, 3.0, 1.1288580925414609, 1.1454545454545455, 1.0846525868967676, 1.5, 1.0, 1.3333333333333333, 1.0530835284933646, 1.6224489795918366, 1.149171270718232, 1.1192443919716648, 1.0910683012259195, 1.0127551020408163, 1.0591913724525361, 1.0701754385964912, 1.0, 1.0192071924805886, 1.1180183889117608, 1.1103327495621715, 1.0215905693418186, 1.0410169147152943, 1.0163185704998916, 1.1041335453100158, 1.039945073323592, 1.061602870813397, 1.1293360539946633, 1.2418789080372121, 1.4545454545454546, 1.0866807610993658, 1.0895522388059702, 1.2727272727272727, 1.0869565217391304, 1.1185454545454545, 1.0555555555555556, 1.0636363636363637, 1.0456900612341027, 1.15041782729805, 1.2547169811320755, 1.0221480383931068, 1.0188034188034187, 1.005340775849256, 1.0014750436411293, 1.5, 1.144343397599127, 1.2, 1.0123543288929884, 1.062634989200864, 1.0190630797773654, 1.325, 1.25, 1.0869565217391304, 1.4647887323943662, 1.0065502846761012, 1.0, 1.0382262996941896, 1.009049773755656, 1.0384615384615385, 1.0003136471353562, 1.2516556291390728, 1.0062893081761006, 1.0208611657994655, 1.0920330447575397, 1.0628639435542142, 1.0598290598290598, 1.0, 1.2112171837708832, 1.0147783251231528, 1.1401869158878504, 1.0278836162105993, 1.065304309195913, 1.2283737024221453, 1.0350877192982457, 1.00960219478738, 1.088458298230834, 1.5714285714285714, 1.0325851747721564, 1.0714285714285714, 1.1578947368421053, 1.0521406155529325, 1.1904761904761905, 1.75, 1.0194544984488108, 2.0, 1.008298755186722, 1.066860465116279, 1.0164068908941755, 1.0348336594911938, 1.0704960835509139, 1.1428571428571428, 1.0007981709709277, 1.0646933294385887, 1.008174386920981, 1.032065061015859, 1.1237588929716207, 2.0, 1.1111111111111112, 1.019845015440191, 1.3333333333333333, 1.0498357064622126, 1.0, 1.0, 1.0454545454545454, 1.1843043995243758, 1.093719806763285, 1.303030303030303, 1.0476190476190477, 1.0, 1.048601864181092, 1.041192352831774, 1.5, 1.1387730792138178, 1.0, 1.0118272223487437, 1.141025641025641, 1.0974809761217528, 1.1751152073732718, 1.0018181818181817, 1.250266240681576, 1.1018518518518519, 1.0076049035940267, 1.0043137743608423, 1.014647137150466, 1.0, 1.1428571428571428, 1.8333333333333333, 3.0, 1.0666666666666667, 1.00248194800769, 1.25, 1.0831946755407653, 1.0978260869565217, 1.0107827066898882, 1.0241439744696434, 1.003099173553719, 1.1004581306380767, 1.0298685782556751, 1.2708018154311649, 1.5, 1.0020876826722338, 1.0779816513761469, 1.011053476838745, 1.2857142857142858, 3.142857142857143, 1.0356347438752784, 1.0459302325581394, 1.0022264598608377, 1.131761442441054, 1.342769701606733, 1.0362914658349873, 1.5686274509803921, 1.0808477237048666, 1.0709745762711864, 1.2307692307692308, 1.0568862275449102, 1.1495327102803738, 1.0137533140515786, 1.012268133903522, 1.0016380974667993, 1.2835820895522387, 1.1326530612244898, 1.0406976744186047, 1.0, 1.0029383695815963, 1.018626762908357, 1.0441875794528932, 1.0050399493616462, 1.0362401988908012, 1.0035076530612246, 1.8333333333333333, 1.0024177949709865, 1.2, 1.0794192997438088, 1.1111111111111112, 1.02636362622534, 1.0144927536231885, 1.1057609630266552, 1.1778656126482214, 1.0958663148636762, 3.0, 1.1467920725562646, 1.0080586237362543, 1.021608417888012, 1.0, 1.3404255319148937, 1.0038535645472062, 1.4195402298850575, 1.0611243072050673, 1.131764705882353, 1.1666666666666667, 1.1276962899050906, 1.0641316287657465, 1.0870068306520846, 1.001365975747321, 1.0961622807017544, 1.2504145936981759, 1.0833333333333333, 1.3636363636363635, 1.0025445292620865, 1.3, 1.044338335607094, 1.0606060606060606, 1.0138188528635494, 1.0416666666666667, 1.1153131963357266, 1.0812784539626499, 1.149645390070922, 1.0, 1.0654205607476634, 1.32, 1.0010506245379198, 1.4354485776805253, 1.0, 1.182992539375518, 1.0063003108783792, 1.2022919780767314, 1.0, 2.0, 1.1864077669902913, 1.0017953321364452, 1.3495575221238938, 1.0, 1.025504650702553, 1.0292728989612843, 1.0869565217391304, 1.0832015065913372, 1.0272727272727273, 1.0393700787401574, 1.1846774193548386, 1.029448885149348, 1.1645140921875896, 1.0, 1.0675675675675675, 1.0775037567400336, 1.0246145638424544, 1.0266555740432612, 1.0, 1.0393103448275862, 1.010739021209235, 1.0277632268203247, 2.0, 1.108054226475279, 1.0564592062520597, 1.152439438148877, 1.2067624830719497, 1.0231565928443682, 1.1697057030427314, 1.030252100840336, 1.0672613307618128, 2.0, 1.0519923510258928, 1.0571428571428572, 1.25, 1.2953020134228188, 1.1304347826086956, 1.039100967888617, 1.018166089965398, 1.0521914482864079, 1.0862412761714855, 1.029252826346058, 1.0376031381036115, 1.0253880740201349, 1.058252427184466, 4.0, 1.0449981994958588, 1.0044733631557543, 1.0067733603963671, 1.0018160504266278, 1.0691619202603744, 1.1736842105263159, 1.0829015544041452, 1.4285714285714286, 1.030999774090715, 1.0232861297115416, 1.0078332386390096, 1.0683251576734407, 1.070078151195481, 1.0103092783505154, 1.002874204981308, 1.0431499460625675, 1.0768175582990398, 2.0, 1.0, 1.0690184049079754, 1.064030131826742, 1.0033557046979866, 1.0249702734839476, 1.1888111888111887, 1.3006535947712419, 1.0554699537750385, 1.1318681318681318, 1.0204607792473295, 1.3452380952380953, 1.0197214502174698, 1.0, 1.0403587443946187, 1.380952380952381, 1.4042553191489362, 1.0170391061452515, 1.0933014354066986, 1.0494071146245059, 1.0131406044678055, 1.0111488411854104, 1.0, 1.7234042553191489, 1.5, 1.0, 1.0, 1.1298405466970387, 1.3642105263157895, 1.0957446808510638, 1.0285165011214354, 1.1759890859481583, 1.0565927854475694, 1.007592190889371, 1.0944625407166124, 1.0056424326446722, 1.0511363636363635, 1.047087980173482, 1.1722302854378326, 1.0710875331564986, 1.0997109826589595, 1.0804430195278345, 1.0294225050863373, 1.0509502758865477, 1.0101030368123503, 2.0, 1.0073710073710074, 1.0231053604436229, 1.0482758620689656, 1.0, 1.1590909090909092, 1.1538461538461537, 1.107843137254902, 1.6296296296296295, 1.5, 1.028658791748323, 1.0393104673893727, 1.00336273571484, 1.0396264908976773, 1.135135135135135, 1.0364520048602672, 2.0, 1.1, 1.158437200383509, 1.0011035619789659, 1.0062544329099232, 1.0258571591297414, 1.016699445735741, 1.1095100864553313, 1.0083173744883782, 1.2024866785079928, 1.0096443367820516, 1.0218095220166041, 1.4242424242424243, 1.1304836895388077, 1.0, 1.0045351473922903, 1.020654343486939, 3.0, 1.0876656472986748, 1.0247364691292409, 1.2857142857142858, 1.1054035758372158, 1.1111111111111112, 1.1875, 1.019256373937677, 1.7692307692307692, 1.0025808796801163, 1.0060163300386764, 1.1875, 1.380952380952381, 1.2967914438502675, 1.0190058479532165, 1.0596491228070175, 1.0143616696204854, 1.0097521982414068, 1.0, 1.1737453834455789, 1.0123456790123457, 2.0, 1.0763890490578223, 1.04865472791764, 1.096499526963103, 1.009306092019769, 1.0018860068092195, 1.2417582417582418, 1.8571428571428572, 1.111449220235831, 1.0281923714759535, 1.007332831943115, 1.1440960640426951, 1.0290359577889332, 1.0678379624808463, 1.0148698884758365, 1.0374372829023544, 1.1412213740458015, 1.0403564990987382, 1.0706624605678234, 1.0534351145038168, 1.1433823529411764, 1.06101911833028, 4.0, 1.0020710989932886, 1.0074154332461904, 1.0344797604621212, 1.1176470588235294, 1.018261352589918, 1.3482587064676617, 1.0, 1.0119561725971662, 1.0134426229508198, 1.1350681536555143, 1.1176470588235294, 1.6666666666666667, 1.079881940601365, 1.5, 1.312883435582822, 1.1538461538461537, 1.0817458656060288, 1.2857142857142858, 1.2880434782608696, 1.1415094339622642, 1.0, 1.3082010582010581, 1.005921052631579, 2.0, 1.0, 1.0901639344262295, 1.102661596958175, 1.0746135552913199, 1.017075773745998, 1.0578512396694215, 1.0058997050147493, 1.089150378938971, 1.051948051948052, 1.678082191780822, 1.7253521126760563, 1.3461538461538463, 1.0, 1.1143497757847534, 1.2063492063492063, 1.1321637426900584, 1.3302094818081587, 1.0046436088814883, 1.271895218557677, 1.0212625618830227, 1.0231904427266338, 1.02647412755716, 1.0029832935560858, 1.375, 2.0, 1.0, 1.0044547317295287, 1.1140609636184857, 1.0065359477124183, 1.3355263157894737, 1.0198549064528446, 1.0484900340846928, 1.000942883820846, 1.1025641025641026, 1.1, 1.0288675055514434, 1.0794671261930011, 1.037338796772759, 1.0706591416751476, 1.1842105263157894, 1.1221943295924395, 1.004784580154987, 1.1078014184397162, 1.0170895908855515, 1.2222222222222223, 1.0059037238873751, 1.0033783783783783, 1.0576923076923077, 1.1762820512820513, 1.0347890451517394, 1.0, 1.0895522388059702, 1.0451464597806062, 1.2592592592592593, 1.0059465526711724, 1.2055084745762712, 1.1162790697674418, 1.0467415403627376, 1.0090843547224224, 1.1083467633628794, 1.003831417624521, 1.090805902383655, 1.009580703336339, 1.1522633744855968, 1.0714285714285714, 1.0, 1.25, 1.016228654474991, 1.8333333333333333, 1.0948700275699095, 1.0684938883204997, 1.1081081081081081, 1.0816326530612246, 1.0003650950195349, 1.0704180064308682, 1.0568181818181819, 1.0069832402234637, 1.0003052574729379, 1.0856634016028495, 1.005306425712437, 1.034294833192822, 1.25, 1.0491803278688525, 1.2648221343873518, 1.0016118409650248, 1.0260586319218241, 1.0141116100064145, 1.1946902654867257, 1.01364522417154, 1.0586902386586856, 1.0347222222222223, 1.0315311004784689, 1.25, 1.023968653660603, 1.0083596815044116, 1.1049651567944252, 1.0008428150021071, 1.032258064516129, 1.1477516059957173, 1.1243781094527363, 1.625, 1.0061789169920217, 1.2692307692307692, 1.117117117117117, 1.0133630289532294, 1.2360080917060015, 1.0332289491997217, 1.0847058823529412, 1.3636363636363635, 1.103448275862069, 1.0094856428545167, 1.0006778154341909, 1.003060032848516, 1.1086685121858546, 1.0298313878080414, 1.0833333333333333, 1.067396798652064, 1.124066754501537, 1.0721237555248002, 1.0299277605779154, 1.2083333333333333, 1.0725338491295937, 1.041698384504779, 1.176923076923077, 1.0213207711768297, 1.0, 1.3333333333333333, 1.0196197681030434, 1.007942135867253, 1.012719281185577, 1.0617300956354048, 1.0407023144453311, 1.089588377723971, 1.0095711230051947, 1.086701412790507, 1.0055452865064696, 1.2648648648648648, 1.0245098039215685, 1.02239483630295, 1.0119047619047619, 1.75, 1.0475236372694485, 1.007575017786644, 1.0182440136830102, 1.2571428571428571, 1.0422641509433963, 1.0073688560761542, 1.0230083405234398, 1.0175, 1.1923076923076923, 1.099056603773585, 1.1098130841121496, 1.0875, 1.6538461538461537, 1.0204827355011734, 1.0208126858275521, 1.082585278276481, 1.1714285714285715, 1.0210653024375564, 1.0964616680707666, 1.0135685210312075, 1.0318875024757377, 1.6666666666666667, 1.0769230769230769, 1.3333333333333333, 1.033105433609212, 1.2692307692307692, 1.3333333333333333, 1.5, 1.2604340567612689, 1.0241187384044528, 1.0750296120817293, 1.0275573156163575, 1.0672727272727274, 1.661764705882353, 1.0, 1.0333333333333334, 1.4054054054054055, 1.1290322580645162, 1.0233644859813085, 1.0066491966257607, 1.0088717526390656, 1.046875, 1.0141427819152937, 1.0016815975176419, 5.0, 1.0067452621550814, 1.1371428571428572, 1.0, 1.3333333333333333, 1.0390532544378699, 1.1684716345119415, 1.0433622732740244, 1.0559006211180124, 1.0, 1.131578947368421, 1.2484662576687116, 2.0, 1.5, 1.1031003937007875, 1.1006065986092617, 1.1996702143606657, 1.1111111111111112, 1.0140650373770317, 1.0704879938032532, 1.0020512820512821, 1.1428571428571428, 1.1451612903225807, 1.0030352737124457, 1.5657894736842106, 1.0748672463091555, 1.049523693209575, 1.035294117647059, 1.003921568627451, 1.0469283746556475, 1.1947053800170795, 1.103305785123967, 1.2105263157894737, 1.0727245530057723, 1.1414211922378892, 1.060082222443846, 1.4152542372881356, 1.36, 1.1343283582089552, 1.059445178335535, 1.0430504305043051, 1.0264745960677437, 1.011324352395864, 1.0655021834061136, 3.0, 1.25, 1.0885115858325796, 1.1767810026385224, 1.325228554755884, 1.0197298024516768, 1.019568489713999, 1.1096110032908615, 1.2086167800453516, 1.0212765957446808, 1.0131278987500982, 1.0302812205628644, 1.090159104301709, 1.0124113475177305, 2.5, 1.0533333333333332, 1.0510290179390294, 1.070489844683393, 1.0070060792660895, 1.004315810198858, 1.1051136363636365, 1.6, 1.0035046728971964, 1.0432706689063256, 1.0230751656385653, 1.0570342205323193, 1.0124684117675107, 1.171641791044776, 1.3187772925764192, 1.098550724637681, 1.0038140409162442, 1.0433446049800184, 1.1002304147465438, 1.11651728553137, 1.03125, 1.0776657552973343, 1.0093423450439436, 1.0554821664464993, 1.0360131995112984, 1.0375288683602772, 1.0695792880258899, 1.2857142857142858, 1.0233545647558386, 2.5, 1.5, 1.3076923076923077, 1.0434782608695652, 1.1169036334913112, 1.0697389431467934, 1.0259729432053042, 1.005427408412483, 1.0029288702928871, 1.0869565217391304, 1.2244897959183674, 1.0283865475898486, 1.6, 1.25, 1.0927505330490406, 1.0, 1.134441087613293, 1.1124694376528117, 1.07332881880623, 1.0362354125075068, 1.0, 1.0882749326145553, 1.3372093023255813, 1.1316708229426433, 1.0008447729672652, 1.0717185385656292, 1.0447227191413238, 1.0222757494923758, 1.0584282460136674, 1.1112877583465819, 1.392156862745098, 1.2374301675977655, 1.0, 1.0, 1.000590107649941, 1.6666666666666667, 1.5714285714285714, 1.2857142857142858, 1.0310945273631842, 1.0681818181818181, 1.012914093206064, 1.0911815068493151, 1.0, 1.2749844816883924, 1.0325693606755126, 1.1076233183856503, 1.0426065162907268, 1.25, 1.0192632646164244, 1.0083845723868083, 1.1027837259100643, 1.0290070658237263, 1.010309648681658, 1.0778518303873272, 1.0572232645403377, 1.0, 1.0343514790827937, 1.016356943693256, 1.0322812051649928, 1.2695652173913043, 1.0173560183827124]
origin-bjaq_15.87 	max: 5.0000	99th: 2.6700	95th: 1.6157	median: 1.0595	mean: 1.1502

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 15.895633 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=naru', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[7.1525574e-07 1.7881393e-07 9.5367432e-07 2.3841858e-07 1.1920929e-07]
Distance score: 4.410743770222325e-07
SAUCE Drift detection: False
Detection latency: 0.0232s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 2.039163 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 9.0000	99th: 2.7525	95th: 1.8157	median: 1.0659	mean: 1.1761
ReportEsts: [1.0939226519337018, 1.0622130394857667, 1.0323206567368388, 1.0176, 1.0294117647058822, 1.0, 1.139377603528547, 1.0126308001268365, 1.6, 1.0365448504983388, 1.0187597457118869, 1.002002995470704, 1.0106609808102345, 1.0058027079303675, 1.026939017169923, 1.52, 1.086092715231788, 1.3333333333333333, 1.3333333333333333, 1.1078066914498141, 1.0671497091539952, 1.0500364736714127, 1.0217845419277827, 1.0987884436160298, 1.0500318152895192, 1.0072646266608694, 3.0, 1.0433694972401228, 1.1666666666666667, 1.2857142857142858, 1.0557377049180328, 1.0, 1.0008710862833887, 1.0060716080530856, 1.4771573604060915, 1.0833663627956136, 1.0247819971870604, 1.0, 2.0, 1.1291940589237885, 1.069503415174451, 1.0039307911977153, 1.1632911392405063, 1.018962283809127, 1.0292504570383911, 1.1495327102803738, 1.1904761904761905, 1.0193687230989956, 1.7019867549668874, 1.0928677563150073, 1.2586206896551724, 1.0769230769230769, 1.0403587443946187, 1.121212121212121, 1.0562592257511547, 1.0026274735199934, 1.0239596469104666, 1.1409395973154361, 1.1566265060240963, 1.0141521676968084, 1.056338028169014, 1.0795862233915332, 1.1050359712230216, 1.105058365758755, 1.2135922330097086, 1.0, 1.1014901329037454, 1.0752028064021049, 1.1428571428571428, 1.0, 1.1050275482093663, 1.0238805970149254, 1.0674049109292247, 1.0927272727272728, 1.0974935782672997, 1.0753931544865865, 1.018491796269574, 1.0276497695852536, 1.049645390070922, 1.0366698202459792, 1.200464846019756, 1.6, 1.0, 1.2, 1.001123595505618, 1.0701754385964912, 1.026829268292683, 1.3333333333333333, 1.5, 1.0282785436550017, 1.0825179386823223, 1.0735320049374009, 1.0266382104181488, 1.1370558375634519, 1.015748031496063, 1.2630966239813737, 1.0618556701030928, 1.3396704689480354, 1.5, 1.161624203821656, 1.3870967741935485, 8.0, 1.0145232527929333, 1.1745625266752027, 1.0383480825958702, 1.016647771346739, 1.025, 1.0036937392429668, 1.0762812872467222, 1.0282799859303553, 1.0782581255916692, 1.0240522875816993, 1.0, 3.5, 1.1609712230215827, 1.0229294537282176, 1.0763052208835342, 1.058139534883721, 1.0072498863344337, 1.0, 1.2360208062418725, 1.0840602696272799, 1.0, 1.221698113207547, 1.4285714285714286, 1.070362473347548, 1.01146992497826, 1.1545413172095442, 1.007936507936508, 2.6, 1.1594202898550725, 2.0, 1.5, 1.0177690947995162, 1.0769230769230769, 1.0048309178743962, 1.0148145648432492, 1.0794573643410852, 1.625, 1.3333333333333333, 1.041501976284585, 1.058453237410072, 1.0714669532509404, 1.0519580865109597, 1.106060606060606, 1.042646254784035, 1.029646724658264, 1.0, 1.0223938223938225, 1.0115830115830116, 1.0486147412441191, 1.0366407738531438, 1.0, 1.0106415634912513, 1.0224438902743143, 1.0016528925619834, 1.3885350318471337, 1.0, 1.0382728164867516, 1.1014457059823166, 1.1589657110736369, 1.141004862236629, 1.1168831168831168, 1.1785714285714286, 1.3312101910828025, 1.1210453920220083, 1.0, 1.0077448302037104, 1.1755725190839694, 1.028117359413203, 1.0053187885358086, 1.1099148723084626, 1.0469834021252304, 1.0070671378091873, 1.0952380952380953, 1.2583805668016195, 1.0224111282843895, 1.178391959798995, 1.0265560165975103, 1.023407022106632, 1.053578154425612, 1.0063414113376747, 1.0609756097560976, 1.2173913043478262, 1.0309740448975626, 1.021008574098907, 1.0588235294117647, 1.0812170995545787, 1.1707988980716253, 2.0, 1.0835380835380835, 1.008765475314507, 1.0357142857142858, 1.0404984423676011, 1.0626066552901023, 1.002897520706339, 1.0049922249221572, 1.0895833333333333, 1.0133503275593565, 1.0759154808600795, 1.051716644936984, 1.0242701774470522, 1.0633071663712332, 1.0137196999958935, 1.1838120104438643, 1.1271082220660575, 1.0432692307692308, 1.0128205128205128, 1.030612244897959, 2.0, 1.0268817204301075, 1.0354941407572986, 1.6124260355029585, 1.121212121212121, 1.0312239800166527, 1.1111111111111112, 1.0044042956586723, 1.0504385964912282, 1.0339360911567996, 2.0, 1.0150187734668334, 1.0475247524752476, 1.0002509980159204, 1.0337804468501215, 2.0, 1.0170454545454546, 1.0203230678311117, 1.0067772573244151, 1.0108991825613078, 1.1474036850921272, 1.0610771793448084, 1.0837950138504155, 1.0593220338983051, 1.0014623968404777, 1.0109631431668642, 1.1184668989547037, 1.1915444348576358, 1.0850546780072905, 1.5, 1.0979247730220494, 2.0, 1.011153156741685, 1.0447082830906225, 1.1240904621435595, 1.5880503144654088, 1.0769230769230769, 3.3333333333333335, 1.090514968656629, 1.1076923076923078, 1.1164120432413116, 2.25, 1.0911542610571736, 1.0564516129032258, 1.5714285714285714, 1.0067118857954098, 1.1441860465116278, 1.0877531340405016, 1.5263157894736843, 1.0170575692963753, 1.0327088476868214, 1.0571428571428572, 2.0, 1.0172095614477967, 1.1099817268158976, 1.0754716981132075, 1.1248482712713888, 1.096415747763826, 1.0273648648648648, 1.106100795755968, 1.0199953055775606, 1.066231811339689, 1.1222780569514237, 1.2344515642668676, 1.3125, 1.0645836672543676, 1.1285211267605635, 1.2, 1.103448275862069, 1.085, 1.128440366972477, 1.0092648091380816, 1.0145426443726289, 1.1830985915492958, 1.2213740458015268, 1.0171617031361087, 1.0141542816702052, 1.0742851605856134, 1.0050510630211809, 1.5454545454545454, 1.1121306661772803, 1.051660516605166, 1.0341566595413696, 1.00777, 1.0225373421922168, 1.130085653104925, 1.0230207748455924, 1.0013581129378126, 1.162071549717982, 1.0244294557885985, 1.0421199556632046, 1.0773694390715667, 1.2, 1.0, 1.077838533290447, 1.3333333333333333, 1.0478821362799264, 1.0010547209564158, 1.0261995878716514, 1.025, 1.415929203539823, 1.1428571428571428, 1.1008461405629424, 1.0132313417407484, 1.0416666666666667, 1.03014590618594, 1.0055310719006385, 1.0294840294840295, 2.5, 2.3636363636363638, 1.05578231292517, 1.7142857142857142, 1.02099533437014, 1.0655487804878048, 1.1363636363636365, 1.0727219376214987, 1.2608695652173914, 1.7777777777777777, 1.0294890807369188, 3.0, 1.0428849902534114, 1.0338573155985489, 1.0621761658031088, 1.1641221374045803, 1.1368653421633554, 1.1801801801801801, 1.0194546396163113, 1.0136855764162038, 1.0393374741200827, 1.006279974165533, 1.0783034257748776, 3.0, 1.1818181818181819, 1.012387094286513, 1.5, 1.0529680365296803, 1.0, 1.625, 1.037037037037037, 1.2288049029622063, 1.086607858861267, 1.2868852459016393, 1.2483801295896328, 1.25, 2.25, 1.0238383010686607, 1.375, 1.1639344262295082, 1.0348617264469664, 1.210144927536232, 1.0514820592823713, 1.0186393289841567, 2.25, 1.25, 1.2296686746987953, 1.0748299319727892, 1.012108980827447, 1.0134571783807504, 1.0854127870887647, 1.074468085106383, 1.0, 1.0117685200194522, 1.1965317919075145, 1.375, 2.0, 1.0534788790533414, 1.4285714285714286, 1.0330396475770924, 1.1196581196581197, 1.0533282665146622, 1.0059111011059714, 1.2173913043478262, 1.075350308052996, 1.0384400335476656, 1.1202475685234305, 1.0212765957446808, 1.0100530417632079, 1.115506329113924, 1.0571428571428572, 1.0105548127394794, 1.0299052619563978, 1.0034858387799563, 1.0541871921182266, 1.1666666666666667, 1.1017274472168905, 2.0, 1.8148148148148149, 1.028169014084507, 1.0623781676413255, 1.2422360248447204, 1.028301886792453, 1.006516290726817, 1.2817570241392957, 1.1273946360153257, 1.111282248748556, 1.1204367238209583, 1.3205128205128205, 1.0, 1.0592592592592593, 2.0, 1.007111486730522, 1.3928571428571428, 1.0033565273142124, 1.0418520715910216, 1.0532076376128465, 1.0155080213903744, 1.8571428571428572, 1.120467365028203, 1.3333333333333333, 1.0729451265676948, 1.0909090909090908, 1.029602686666452, 1.0047904191616766, 1.005543138131426, 1.1286173633440515, 1.1375186846038865, 3.0, 1.0697314049586777, 1.0054926891290528, 1.0112147032975431, 1.0, 1.423728813559322, 1.0532687651331718, 1.2620192307692308, 1.1017587079997262, 1.039027149321267, 1.0909090909090908, 1.0881435257410297, 1.0638929582967087, 1.053748518680222, 1.011199646632841, 1.069800195746103, 1.4765625, 1.0072463768115942, 1.209011943539631, 1.0040335965397575, 1.4, 1.0005449591280653, 2.0, 1.3333333333333333, 1.1705577172503243, 1.1354581673306774, 1.254317643074839, 1.0189020213649678, 1.1344586728754364, 2.0, 1.0873015873015872, 1.3, 1.04772928912055, 1.04, 1.0, 1.121872848290108, 1.3333333333333333, 1.0, 1.1332828474062855, 2.3333333333333335, 1.1711001642036125, 1.0189825360668185, 1.3800738007380073, 1.1, 1.025016123941652, 1.1286343612334802, 1.037037037037037, 1.0763120035028462, 1.0384615384615385, 1.0202558635394456, 1.1810048176187198, 1.051255230125523, 1.0939266213238816, 2.0, 1.0106382978723405, 1.100894161051472, 1.0334831809021856, 1.0803834808259587, 1.3333333333333333, 1.014700409378489, 1.022111241676459, 1.0310858143607706, 2.0, 1.1043214044564484, 1.104717795745349, 1.0775105708245243, 1.2086773102520274, 1.0211292626779278, 1.0274140293344713, 1.008450704225352, 1.0130625722579412, 2.0, 1.0837360475559168, 1.070945945945946, 1.0568237008256436, 1.0684326710816776, 1.0804289544235925, 1.0600972339876984, 1.2079207920792079, 1.0699871838755641, 1.2915451895043732, 1.0365593284782546, 1.0874617737003058, 1.0834592552617377, 1.161239377303151, 1.0963855421686748, 1.2911392405063291, 1.0076055033650706, 1.0593047034764826, 1.0182092853867113, 1.0020966715339399, 1.0, 1.1224027200604458, 1.2309859154929577, 1.25, 1.2222222222222223, 1.0092730855327534, 1.1316725978647686, 1.12260778128286, 1.0, 1.6, 1.0286187322611164, 1.0141623312591383, 1.0360567702339853, 1.0179109517871987, 1.0154620640057532, 1.06, 1.08, 1.1122198593162114, 1.1724137931034482, 1.0429204227541187, 1.0255281690140845, 1.0535714285714286, 1.00501794752565, 1.0543657331136738, 1.0450760876851914, 1.5, 1.1403269754768393, 1.4368600682593857, 1.0572480551101608, 1.0714285714285714, 1.145769622833843, 1.0287648054145515, 1.1455604075691412, 1.019558695823794, 1.0, 1.8571428571428572, 1.4285714285714286, 1.3333333333333333, 1.01, 1.0114503816793894, 1.3493150684931507, 1.1294642857142858, 1.0281445911698013, 1.0866322432587492, 1.0369220692306598, 1.008075425292068, 1.050085919336905, 1.0153368058176695, 1.0288427331274168, 1.0594423987375066, 1.1094019360827476, 1.005184852566981, 1.0845771144278606, 1.0388026607538803, 1.0920897284533648, 1.21875, 1.0210753401924992, 1.2249690976514216, 1.0103197126356942, 1.0358744394618835, 1.1315290933694182, 1.0945945945945945, 2.5, 1.005938242280285, 1.1875, 1.75, 1.1647058823529413, 1.0153380649981323, 1.0227360308285163, 1.0865139949109415, 1.0397727272727273, 1.001695866477966, 1.1649683469311758, 1.0112359550561798, 1.4, 1.0, 1.0428921568627452, 1.4305555555555556, 1.0353182751540042, 1.0137603795966785, 1.0, 1.1453622519612368, 1.0778301886792452, 1.008148216996623, 1.2050898203592815, 1.0190656967067493, 1.0061462722179435, 1.0064454153068745, 1.146341463414634, 1.5, 1.0732303480641376, 1.0, 1.078048780487805, 1.1772151898734178, 1.0992307692307692, 1.0027972027972027, 1.2666666666666666, 1.0538522155543433, 1.1319444444444444, 1.11864406779661, 1.0390847100455258, 1.0439344262295083, 1.0225787284610814, 1.0371588929746467, 1.0316455696202531, 1.009165302782324, 1.0, 1.0445483239442248, 1.157855547282204, 1.0454545454545454, 1.0576131687242798, 1.07654140231007, 1.0891472868217054, 1.0854801254190423, 1.0909090909090908, 1.0177935943060499, 1.0661793372319688, 1.0045871559633028, 1.1849315068493151, 1.007433976211276, 1.3673469387755102, 2.4285714285714284, 1.0591979630808401, 1.0096153846153846, 1.0147821540113904, 1.0708462187236436, 1.0286553192307322, 1.0603146853146854, 1.1035548686244203, 1.0573770491803278, 1.1293375394321767, 1.0114722487461643, 1.0727367870225013, 1.1379605826906598, 1.3324549846288978, 1.1024947400060114, 1.0926829268292684, 1.1502824858757061, 1.0909090909090908, 1.3333333333333333, 1.06125, 1.011231884057971, 1.0336108541473943, 1.1992687385740401, 1.4444444444444444, 1.026835043409629, 1.1007697690692793, 1.213235294117647, 1.0151983083621996, 3.3333333333333335, 1.0112107623318385, 1.0, 1.4178272980501392, 1.125, 1.1163920208152645, 1.2058823529411764, 1.2813852813852813, 1.1304347826086956, 2.0, 1.0136549840691853, 1.0165745856353592, 2.25, 1.25, 1.0463576158940397, 1.1065830721003134, 1.0860505025741602, 1.0223413762287756, 1.0534246575342465, 1.8857142857142857, 1.110803324099723, 1.0651041666666667, 1.5532994923857868, 1.0780669144981412, 1.2666666666666666, 1.0, 1.023057216054654, 1.1107099879663056, 1.0187713310580204, 1.1478415138971023, 1.0150517868437698, 1.1908032739686587, 1.0192374157553015, 1.0068082542551589, 1.0467196819085487, 1.0109181141439205, 1.3, 1.0, 1.1025641025641026, 1.0387501230839926, 1.1414225941422593, 1.070460704607046, 1.191542288557214, 1.0802528251292856, 1.0066998103403773, 1.0046017753353014, 1.0101010101010102, 1.1304347826086956, 1.0937790157845868, 1.0822295805739515, 1.0026700052378092, 1.0118808139857964, 1.2541436464088398, 1.07839177528915, 1.0079796295300087, 1.0062089971883785, 1.0346954510408635, 1.0359403236655078, 1.0339506172839505, 1.0503768345894486, 1.135693215339233, 1.004579803068468, 2.0, 1.0409459936463112, 1.0, 1.1139240506329113, 1.001897252348018, 1.3225806451612903, 1.0213302084250597, 1.1625222024866786, 1.148936170212766, 1.0617961683353814, 1.003992315543015, 1.1001145923586462, 1.0170178282009725, 1.0115718418514947, 1.0040285747745639, 1.1718213058419245, 1.1666666666666667, 1.0, 1.1, 1.0087638004674027, 2.1666666666666665, 1.0044722396109211, 1.0628881465372284, 1.077279466271312, 1.0824334053275737, 1.0329202947086402, 1.0746921292164913, 1.088328075709779, 1.0345649582836711, 1.0182791952299484, 1.0103755720372416, 1.0033182925368367, 1.0203110610866672, 1.2222222222222223, 1.0770416024653313, 1.272108843537415, 1.0171287666407363, 1.010928961748634, 1.0001764290755117, 1.1318518518518519, 1.02555910543131, 1.0306614571247594, 1.050351288056206, 1.0249843100923464, 1.1904761904761905, 1.0152914782591393, 1.0036386735067284, 1.1482602118003025, 1.0052966101694916, 1.1578947368421053, 1.2008781558726673, 1.1419776353813293, 1.0762371971228746, 1.118440779610195, 1.0028617680076444, 1.3333333333333333, 1.0235362067720741, 1.225108225108225, 1.1509677419354838, 1.5, 1.103056768558952, 1.1228733459357279, 1.1161806208842897, 1.0523237835023702, 1.0475266731328807, 1.009395815259745, 1.0524189497553065, 1.0, 1.0297498309668696, 1.00876196657472, 1.0585074626865671, 1.0240793201133145, 1.2435830277632267, 1.251004016064257, 1.4166666666666667, 1.018796992481203, 1.0133514436586795, 1.125, 1.0388921626399528, 1.0029631076812868, 1.0186528497409326, 1.6346153846153846, 1.0008051896753414, 1.0869222248330033, 1.0655957161981258, 1.1099585062240664, 1.0082050018479733, 1.1186726185462814, 1.0030721966205838, 1.3796296296296295, 1.0041200706297821, 1.0135662687637685, 1.0, 2.75, 1.0310199369477377, 1.0003342515646432, 1.0139289145052834, 1.165680473372781, 1.014268366727383, 1.0280969254447188, 1.021165279429251, 1.2341772151898733, 1.21875, 1.1422879908935686, 1.0826446280991735, 1.1088082901554404, 1.606060606060606, 1.0429043518734, 1.0091438071487946, 1.1428571428571428, 1.3, 1.0893129770992367, 1.024317617866005, 1.00990099009901, 1.0, 1.0261682242990655, 1.1674418604651162, 1.013090229079009, 1.6, 1.0750142111518786, 1.0606060606060606, 1.1088636949239887, 1.076271186440678, 1.0212765957446808, 1.065631409317316, 1.1032202960900923, 1.0491072048912666, 1.035548686244204, 1.3975903614457832, 1.1578947368421053, 1.0555555555555556, 1.3595505617977528, 1.234375, 1.0458372310570627, 1.01362089494262, 1.0039057523622499, 1.0952380952380953, 1.0289564514108012, 1.0014530210729808, 9.0, 1.000087389670541, 1.1091943127962085, 1.0, 1.1428571428571428, 1.0971089696071163, 1.1554594074875308, 1.0649400888747818, 1.119047619047619, 1.5, 1.0471380471380471, 1.125, 1.1166666666666667, 1.0130442798758565, 1.0222635018919848, 1.0052465692381254, 1.1928651059085842, 1.4444444444444444, 1.0153524739831297, 1.0822454308093994, 1.1223908918406071, 1.0677966101694916, 1.0724137931034483, 2.0, 1.0, 1.0908061817107984, 1.082009656427122, 1.307125307125307, 1.0166112956810631, 1.0503149714916313, 1.1780330222541278, 1.1514084507042253, 1.1408450704225352, 1.0442330745518895, 1.030271289410286, 1.055962734641441, 1.3819444444444444, 1.2135922330097086, 1.110091743119266, 1.2, 1.0253866355412897, 1.0121654501216546, 1.0107242416233226, 1.047229791099001, 2.0, 1.1657622101628022, 1.0591663122075712, 1.2022099447513812, 1.3069274653626732, 1.0105401982436493, 1.0331283198210792, 1.1137228643924444, 1.0275590551181102, 1.0701754385964912, 1.0447065277015908, 1.00952389101862, 1.05419921875, 1.1426491994177583, 3.0, 1.0105263157894737, 1.0365250042669398, 1.281524926686217, 1.0081891082244288, 1.005587513523498, 1.1355728854229155, 2.2, 1.0524233432245302, 1.0544380989255637, 1.0466488956587967, 1.0295081967213116, 1.0362896421658643, 1.1345565749235473, 1.2063492063492063, 1.129485935984481, 1.0019166325493942, 1.0140712646608874, 1.1252408477842004, 1.1267605633802817, 1.0256410256410255, 1.0375677216994583, 1.069643822451799, 1.0258383330728258, 1.0033199306503375, 1.07451564828614, 1.0456953642384106, 2.0, 1.0626118067978534, 2.0, 1.0, 1.2, 1.0210526315789474, 1.14603798297315, 1.0255781468260128, 1.0676050655267835, 1.0212815174647236, 1.019429371608612, 1.0857142857142856, 1.1232051875868458, 1.0133237839309601, 1.8333333333333333, 1.1875, 1.0497725448220498, 1.0, 1.1743725231175695, 1.125, 1.0098466626578473, 1.032782229435034, 1.25, 1.0545010845986984, 1.0407830342577489, 1.1104093167937483, 1.000677211266959, 1.0652654867256637, 1.0426610978520285, 1.0292706493852664, 1.1021473601260836, 1.0582781456953643, 1.6981132075471699, 1.2458823529411764, 1.0, 2.0, 1.0015586895075586, 1.25, 1.625, 1.4545454545454546, 1.024083769633508, 1.0060503213178613, 1.0657015590200445, 1.0963855421686748, 1.0, 1.057526705908001, 1.028301886792453, 1.0522388059701493, 1.0078895463510849]
origin-bjaq_15.87 	max: 9.0000	99th: 2.7525	95th: 1.8157	median: 1.0659	mean: 1.1761

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 20.232651 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=38.201487