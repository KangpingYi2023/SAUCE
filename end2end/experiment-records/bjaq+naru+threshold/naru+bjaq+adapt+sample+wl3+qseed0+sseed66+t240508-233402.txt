Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='naru', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 66, 'naru': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.5920	median: 1.0600	mean: 1.1479
ReportEsts: [1.0641891891891893, 1.0457516339869282, 1.0137195233730523, 1.001926782273603, 1.0344827586206897, 1.0, 1.1781087298704445, 1.0068524296410353, 1.25, 1.0359042553191489, 1.016962582538518, 1.0027702632400375, 1.0447564721369023, 1.0255813953488373, 1.0021193924408336, 1.0, 1.1842105263157894, 1.016294721927028, 3.0, 2.6666666666666665, 1.173913043478261, 1.160750485227518, 1.004105207885818, 1.0670426065162908, 1.0069547938400398, 1.0, 1.0153743739301337, 1.3333333333333333, 1.4, 1.2302158273381294, 1.0, 1.0015498295610934, 1.0122164263569706, 1.1337402885682575, 1.1316270566727604, 1.0134384943470314, 1.0108108108108107, 1.0022436442221305, 1.0024510650050058, 1.2261904761904763, 1.0103626943005182, 1.0365853658536586, 1.0, 1.1233103879849813, 1.0913157488816905, 1.1983471074380165, 1.1262135922330097, 1.2466960352422907, 1.028700729438533, 1.0093457943925233, 1.0753535207535352, 1.0192644483362523, 1.0038396316159541, 2.0, 1.1090909090909091, 1.0444618804760037, 1.0661818181818181, 1.0526315789473684, 1.0807453416149069, 1.25, 1.009518130318112, 1.0423412204234122, 1.0727272727272728, 1.1494252873563218, 1.0, 1.0930393548163788, 1.0912985274431057, 1.1666666666666667, 1.0, 1.0740963252227895, 1.0083532219570406, 1.059675550405562, 1.0990990990990992, 1.0062337218735322, 1.2211764705882353, 1.1416490486257929, 1.0, 1.0453950240069838, 1.6, 1.0586100031564751, 1.1875, 1.046296801808196, 1.1717791411042944, 1.0389908256880733, 1.0642297650130548, 1.08, 1.008106285081063, 1.0472786909322334, 1.1568627450980393, 2.3333333333333335, 1.0973105134474328, 1.0007234825981848, 1.0993150684931507, 1.3660589060308554, 1.2275784753363228, 1.09375, 1.2162162162162162, 1.0025662959794697, 1.0, 1.0215112569501412, 1.1144708423326133, 1.0111492281303602, 1.0046440726035166, 1.0, 1.000402382861005, 1.113179669030733, 1.0446359660406483, 1.0041888804265042, 1.0286975717439293, 1.0, 1.3333333333333333, 1.1617806731813247, 1.0127707198413753, 1.0581550802139037, 1.1323529411764706, 1.0058726077584927, 1.0, 1.2112299465240641, 1.1330143540669857, 1.0, 1.2362637362637363, 1.1666666666666667, 1.0, 1.0186164474172907, 1.1527529704123631, 1.0566037735849056, 1.8, 1.1837748344370862, 1.0, 1.1071428571428572, 1.0088844812955597, 1.1818181818181819, 1.052415210688592, 1.0086605914826003, 1.0715005035246727, 1.1297134238310709, 1.0252808988764044, 1.005485893416928, 1.00199203187251, 1.0539499036608864, 1.0373292127521145, 1.3518518518518519, 1.0143509458577953, 1.000559808204841, 2.0, 1.0091996320147194, 1.0342789598108748, 1.032258064516129, 1.011469913534498, 1.0, 1.0288205376604505, 1.0533333333333332, 1.02, 1.4476190476190476, 1.0262773722627738, 1.0312934631432544, 1.0606843850087093, 1.0854901253494453, 1.11787072243346, 1.105263157894737, 1.0, 1.2681159420289856, 1.145025295109612, 1.1428571428571428, 1.0245632259046664, 1.038604945519981, 1.0087108013937283, 1.0124340345550495, 1.0256566890653636, 1.0890779465161273, 1.0105263157894737, 1.0987394957983194, 1.1701365352958264, 1.1225879682179343, 1.0944287063267233, 1.0752351097178683, 1.04, 1.0739785304152452, 1.0700582275924742, 1.1666666666666667, 1.0161290322580645, 1.0603022594643123, 1.0474002923366048, 1.1228264890862005, 1.0704225352112675, 1.024473270529161, 1.029790505477609, 1.0167913732394367, 1.0357142857142858, 1.0416666666666667, 1.0061808382546873, 1.0, 1.6363636363636365, 1.0828490277474327, 1.3496027241770716, 1.1261682242990654, 1.4583333333333333, 1.0180064308681671, 1.0040291793062177, 1.0069513092384705, 1.1798245614035088, 1.1853062084958363, 1.0225988700564972, 1.015625, 1.0595238095238095, 1.0, 1.032258064516129, 1.0612679388109132, 1.6620209059233448, 1.0344827586206897, 1.0197726149283242, 1.0957683741648108, 1.0772169419581066, 1.0068804794140496, 1.095278300967721, 1.0454545454545454, 1.0144508670520231, 1.0355704697986576, 1.0070718903206213, 1.0098851745531994, 1.0, 1.1461697722567288, 1.0323597187481535, 1.0058233310939875, 1.0763928776565193, 1.0692412716988493, 1.0031297580781593, 1.0344827586206897, 1.0021739191179142, 1.045564842275546, 1.1658206429780034, 1.1098265895953756, 1.0663762704833022, 1.0058027079303675, 1.1440944881889763, 1.0, 1.048822800495663, 1.0774341223760608, 1.0042372881355932, 1.5485074626865671, 1.0909090909090908, 2.6666666666666665, 1.12497142153673, 1.1272727272727272, 1.1313783842636278, 1.5, 1.0, 1.25, 1.0819672131147542, 1.530612244897959, 1.1243093922651934, 1.1909547738693467, 1.0741379310344827, 1.0101781170483461, 1.019075235728094, 1.105263157894737, 1.0, 1.0139162523063452, 1.1404556058734734, 1.084063047285464, 1.031992924019502, 1.088586376796871, 1.025566843840409, 1.0914149443561207, 1.0167596781860113, 1.0705741626794258, 1.1275662121924463, 1.2521912963247732, 1.7272727272727273, 1.0938160676532769, 1.0405117270788913, 1.2727272727272727, 1.1363636363636365, 1.1327272727272728, 1.1111111111111112, 1.0934579439252337, 1.0298499428033108, 1.0316091954022988, 1.1946107784431137, 1.0152728605287578, 1.077757685352622, 1.0082420327017216, 1.0052528532543814, 1.5, 1.0888686795198255, 1.2, 1.0045511489570467, 1.0198237885462555, 1.014041236174958, 1.25, 1.4285714285714286, 1.0, 1.591549295774648, 1.0031513629492368, 1.0, 1.1116207951070336, 1.0160919540229885, 1.0356570512820513, 1.0016289676998975, 1.1385542168674698, 1.0314465408805031, 1.0014765855716496, 1.017371131103944, 1.0706456585031683, 1.1111111111111112, 1.0, 1.2494033412887828, 1.0, 1.1744548286604362, 1.0171440606571187, 1.077752808988764, 1.1059190031152648, 1.1132075471698113, 1.027434842249657, 1.086932136848009, 1.4285714285714286, 1.0279173250941454, 1.065934065934066, 1.2105263157894737, 1.003270030647986, 1.1904761904761905, 1.75, 1.0304839805571526, 2.0, 1.0301783264746227, 1.063953488372093, 1.0090237899917966, 1.0177059276366436, 1.0496083550913837, 1.164835164835165, 1.011837281348503, 1.0114735934999384, 1.0204359673024523, 1.0354966996023123, 1.1159937888198759, 2.0, 1.1111111111111112, 1.0197024246449253, 1.3333333333333333, 1.050986842105263, 1.0, 1.0, 1.0454545454545454, 1.1594877764842841, 1.0947775628626693, 1.205607476635514, 1.0465367965367964, 1.0, 1.025965379494008, 1.014869109947644, 1.5, 1.2412150089338891, 1.0, 1.0079101191831776, 1.141025641025641, 1.0640251902387825, 1.163594470046083, 1.0018181818181817, 1.0653357531760435, 1.1203703703703705, 1.0057790968203781, 1.0068107092531704, 1.0213049267643142, 1.0, 1.1428571428571428, 1.8333333333333333, 1.5, 1.2307692307692308, 1.0022757224132943, 1.25, 1.0366056572379367, 1.0693069306930694, 1.0124682521357655, 1.0043684114154177, 1.0041365046535677, 1.0688258631275682, 1.0286396181384247, 1.2371134020618557, 1.5, 1.0105263157894737, 1.0981308411214954, 1.006421907185266, 1.1904761904761905, 3.142857142857143, 1.0801781737193763, 1.0511627906976744, 1.0063867926464651, 1.1774891774891776, 1.342769701606733, 1.0410139561378524, 1.4545454545454546, 1.0808477237048666, 1.0635593220338984, 1.3653846153846154, 1.06006006006006, 1.1603773584905661, 1.0284714368676835, 1.0032354500390768, 1.0255780519947286, 1.0617283950617284, 1.063063063063063, 1.075075075075075, 1.0, 1.0113767642774625, 1.005235575272921, 1.001916356667794, 1.0084000383453962, 1.0134825014343087, 1.0118971061093247, 1.8333333333333333, 1.1315502183406114, 1.2, 1.0913748932536294, 1.1111111111111112, 1.0210742953507852, 1.0217391304347827, 1.0711521926053311, 1.2055335968379446, 1.0470588235294118, 3.0, 1.124135660190978, 1.0026698209881986, 1.0434198531881207, 1.0, 1.1886792452830188, 1.0220729366602688, 1.3189655172413792, 1.069635659842771, 1.0105042016806722, 1.2352941176470589, 1.2398619499568593, 1.0826652955336902, 1.0999589414355566, 1.0030632062146894, 1.1950657894736842, 1.2139303482587065, 1.143939393939394, 1.25, 1.0634517766497462, 1.3, 1.0450204638472034, 1.2222222222222223, 1.0009736067898491, 1.0, 1.1021132144713905, 1.0243640524601707, 1.126476719944406, 1.0, 1.1287128712871286, 1.4, 1.0001945600996147, 1.1706783369803064, 1.0, 1.0464907432992538, 1.0162923460038529, 1.2089178356713426, 1.0, 2.0, 1.1930097087378642, 1.0054054054054054, 1.326086956521739, 1.0, 1.0094333399300746, 1.0372184133202742, 1.0869565217391304, 1.0636911487758944, 1.018181818181818, 1.0554016620498614, 1.1604838709677419, 1.0046276819520403, 1.1731817920900063, 1.0, 1.054054054054054, 1.0849071717189698, 1.0030634641186917, 1.0518940297998567, 1.0, 1.0223880597014925, 1.0170608232206186, 1.0282870612886328, 2.0, 1.1291866028708133, 1.0884021467915823, 1.0906434626252248, 1.1581407540081254, 1.0319206694635765, 1.2210715112242536, 1.0067226890756302, 1.0636451301832208, 2.0, 1.077109928161662, 1.4509803921568627, 1.25, 1.2866666666666666, 1.1304347826086956, 1.0317731289372407, 1.0661231884057971, 1.0482730278876846, 1.3270401948842874, 1.041277905901359, 1.0616025272831706, 1.0119918628708808, 1.0970873786407767, 4.0, 1.0529444244388428, 1.0133333333333334, 1.0040713046939413, 1.0243475508579432, 1.0898534697262925, 1.0900837988826815, 1.0829015544041452, 1.2857142857142858, 1.0288820420330151, 1.0088130758860427, 1.0509962663117816, 1.0967625899280575, 1.075069316680055, 1.0123711340206185, 1.0114268597496598, 1.0880281690140845, 1.069482288828338, 2.0, 1.0909090909090908, 1.0567260940032415, 1.0600375234521575, 1.011744966442953, 1.0630202140309155, 1.007905138339921, 1.005050505050505, 1.0554699537750385, 1.1263736263736264, 1.0117364882913364, 1.4487179487179487, 1.0244506491252978, 1.0, 1.1198712791633145, 1.380952380952381, 1.0846153846153845, 1.0167566032377167, 1.128395061728395, 1.0849802371541502, 1.0492866407263295, 1.0524434840425532, 1.0, 1.8936170212765957, 1.6666666666666667, 1.0, 1.0602409638554218, 1.0354906054279749, 1.3642105263157895, 1.0957446808510638, 1.030919577058635, 1.1462765957446808, 1.0417251892706656, 1.0073949911260107, 1.105263157894737, 1.0012619276430104, 1.0632183908045978, 1.114040870138431, 1.1456216739235607, 1.0499219968798752, 1.0534682080924855, 1.0785568810008728, 1.020109594706369, 1.026128338962235, 1.0138444651645875, 2.0, 1.088235294117647, 1.0388170055452866, 1.034013605442177, 1.0, 1.0625, 1.25, 1.0560747663551402, 1.6666666666666667, 1.5, 1.019107705064055, 1.0470765949884486, 1.0101852091362942, 1.0726198186528497, 1.135135135135135, 1.0182260024301337, 2.0, 1.2222222222222223, 1.128502490660025, 1.0026366251198466, 1.0082290901162085, 1.0210160610547898, 1.0040050062578223, 1.119186046511628, 1.0034941515004299, 1.1438721136767318, 1.0182195940546588, 1.0245674805625107, 1.4242424242424243, 1.0818083961248655, 1.0, 1.0068027210884354, 1.0196986249111308, 3.0, 1.070948012232416, 1.0132699761315611, 1.2857142857142858, 1.1274469986191211, 1.3, 1.1875, 1.0158640226628894, 1.7692307692307692, 1.003831139794303, 1.0021358393848783, 1.1875, 1.2608695652173914, 1.2630208333333333, 1.0150485436893204, 1.1100220534182799, 1.0613889244148869, 1.0104926338244118, 1.0, 1.2179013686726048, 1.0092307692307692, 2.0, 1.0774038794197016, 1.0100095163941518, 1.086092715231788, 1.006047366768951, 1.0735048578152322, 1.2840909090909092, 2.0, 1.0654241156333206, 1.0490693739424704, 1.0478339809614308, 1.124082721814543, 1.0281829760992225, 1.088649255315922, 1.15018315018315, 1.0131926121372032, 1.0833333333333333, 1.040445512606538, 1.0769716088328076, 1.0063810391978123, 1.2415966386554622, 1.080102385189211, 4.0, 1.00044587824901, 1.0057951710221569, 1.0576300189451813, 1.0555555555555556, 1.0113053858577348, 1.1991150442477876, 1.0, 1.0021914322069843, 1.0134426229508198, 1.1280788177339902, 1.1470588235294117, 1.6666666666666667, 1.0314107714209197, 1.5, 1.3851132686084142, 1.1538461538461537, 1.0441350917591237, 1.2857142857142858, 1.1791044776119404, 1.0974842767295598, 1.0, 1.2195767195767195, 1.0324105334233626, 2.0, 1.0, 1.08130081300813, 1.0211267605633803, 1.0294292508917955, 1.0095338983050848, 1.0509031198686372, 1.0660377358490567, 1.089150378938971, 1.044155844155844, 1.611842105263158, 1.3535911602209945, 1.2692307692307692, 1.0, 1.0887185104052575, 1.2380952380952381, 1.026511134676564, 1.289512358049432, 1.0271182376742094, 1.2100285242456088, 1.0182832834316544, 1.0392186326070623, 1.0481347773766547, 1.009030704394943, 1.5714285714285714, 1.0, 1.0303030303030303, 1.0157623131213478, 1.1444444444444444, 1.0065359477124183, 1.2047477744807122, 1.080336006109202, 1.0461422193609786, 1.002731482469431, 1.064102564102564, 1.1, 1.0636565507031828, 1.1105514316012726, 1.0348242153461034, 1.0524194081338638, 1.2105263157894737, 1.0637920850561133, 1.02218656869698, 1.1109530583214793, 1.0015274949083504, 1.0, 1.0567748091603053, 1.385135135135135, 1.0384615384615385, 1.261168384879725, 1.0347890451517394, 1.0, 1.0735294117647058, 1.0117481510570063, 1.2777777777777777, 1.0078384493188492, 1.1694915254237288, 1.048780487804878, 1.0842753122766207, 1.005655452436195, 1.1354754230459307, 1.028459273797841, 1.0614457831325301, 1.0088762398557258, 1.1570247933884297, 1.0, 1.0, 1.1111111111111112, 1.0197166040934964, 1.8333333333333333, 1.116282206933765, 1.0509665607667869, 1.1016836508639787, 1.0665113323448423, 1.007003186283807, 1.1084673097534834, 1.0608365019011408, 1.0169252468265162, 1.0220348932772911, 1.0109931766489766, 1.0047791386046065, 1.0015681544028951, 1.4285714285714286, 1.032258064516129, 1.233201581027668, 1.0311316034026736, 1.0488599348534202, 1.0230802415875755, 1.1716814159292035, 1.0039138943248533, 1.0640886125145743, 1.0434173669467788, 1.026877990430622, 1.25, 1.0203562939778317, 1.0112690162061944, 1.1521344232515895, 1.0008428150021071, 1.25, 1.0163220892274212, 1.0945273631840795, 1.5625, 1.0387284452544512, 1.3461538461538463, 1.029233870967742, 1.0351648351648353, 1.1975724881995955, 1.0072402761407644, 1.0752941176470587, 1.1818181818181819, 1.0769230769230769, 1.0117099893378434, 1.0119301954258213, 1.0095474544311753, 1.0440094050296462, 1.0313079855605412, 1.0, 1.0960207612456747, 1.0486423129517484, 1.0500915219429439, 1.0299277605779154, 1.2083333333333333, 1.3186682520808561, 1.0076921437855575, 1.1901469317199653, 1.0126668411410626, 1.0, 1.3333333333333333, 1.000504593282973, 1.0100909607731665, 1.0126011200995644, 1.0609784874346166, 1.0454908220271348, 1.089588377723971, 1.0082207173906614, 1.0939448935819172, 1.0, 1.2918918918918918, 1.0105042016806722, 1.0155399090286, 1.0119047619047619, 2.3333333333333335, 1.0213087230605156, 1.0045340751043115, 1.0239346176298891, 1.2846715328467153, 1.0061930783242259, 1.0152339806716224, 1.017157563625965, 1.1299435028248588, 1.1923076923076923, 1.1475741239892183, 1.082004555808656, 1.13125, 1.72, 1.037858978656833, 1.0188305252725471, 1.089430894308943, 1.2058823529411764, 1.0318253251747083, 1.0544865302815476, 1.0102786042737355, 1.0594900849858357, 1.6666666666666667, 1.037037037037037, 2.0, 1.0345945945945947, 1.4615384615384615, 1.3333333333333333, 1.5, 1.1815336463223787, 1.0739299610894941, 1.0814745857382237, 1.0062745847467074, 1.0223048327137547, 1.3529411764705883, 1.0, 1.064516129032258, 1.2972972972972974, 1.2962962962962963, 1.0389408099688473, 1.0124676657909133, 1.0024884597215455, 1.046875, 1.0097043556759198, 1.000880836794955, 5.0, 1.0087867034126092, 1.1128571428571428, 1.0, 1.3333333333333333, 1.0887573964497042, 1.1287384350570178, 1.059428108661736, 1.0341614906832297, 1.0, 1.0617283950617284, 1.1134969325153374, 2.0, 1.5, 1.1272145669291338, 1.1310627945871978, 1.1350163097432988, 1.1111111111111112, 1.0136909114081984, 1.0720371804802478, 1.1789600967351874, 1.3333333333333333, 1.086734693877551, 1.0038924108073224, 1.5657894736842106, 1.0712416400116314, 1.0952249458345724, 1.0588235294117647, 1.0546875, 1.0056887052341599, 1.1827497865072587, 1.115702479338843, 1.2105263157894737, 1.055267986981511, 1.222358121330724, 1.073867225158738, 1.7040816326530612, 1.2592592592592593, 1.1492537313432836, 1.0402075226977952, 1.0363580812710051, 1.0316750934497636, 1.0010741550619557, 1.044759825327511, 3.0, 1.25, 1.0157792207792207, 1.1512752858399296, 1.246644621668936, 1.0153901752112255, 1.0158889446395718, 1.0754446943365366, 1.078239608801956, 1.0416666666666667, 1.0078434479480272, 1.0111668588405165, 1.0489098408956983, 1.106830122591944, 2.5, 1.1466666666666667, 1.026706775743791, 1.063321385902031, 1.0388105655485336, 1.0021264028352037, 1.1384943181818181, 2.0, 1.0070093457943925, 1.033108131202078, 1.0461503312771305, 1.064638783269962, 1.0069678255702994, 1.3305084745762712, 1.411214953271028, 1.0684057971014493, 1.002612419544391, 1.0563806136060472, 1.0841013824884793, 1.1434058898847632, 1.03125, 1.0386192754613808, 1.0086675887505763, 1.1043593130779392, 1.0515877093823862, 1.036930178880554, 1.073923639317628, 1.3846153846153846, 1.0530785562632696, 2.5, 1.5, 1.4166666666666667, 1.0281329923273657, 1.1532385466034756, 1.0261428200081697, 1.040140221632034, 1.0947082767978291, 1.0267782426778242, 1.059782608695652, 1.3877551020408163, 1.0030514110145416, 1.6, 1.4166666666666667, 1.2211382113821139, 1.0, 1.1734375, 1.1312779711586276, 1.066786840919333, 1.0135121974972001, 1.25, 1.0721362229102167, 1.306201550387597, 1.182294264339152, 1.000344164574911, 1.1202263083451203, 1.0450966356478169, 1.018726814656113, 1.098853021165898, 1.095389507154213, 1.3148148148148149, 1.2206703910614525, 1.0, 1.0, 1.000639283287436, 1.6666666666666667, 1.5714285714285714, 1.3170731707317074, 1.014475271411339, 1.1325301204819278, 1.026750142287991, 1.1020319930825768, 1.0, 1.2098075729360644, 1.0313253012048194, 1.1076233183856503, 1.0072639225181599, 1.25, 1.034885050897861, 1.041019955654102, 1.0887949260042282, 1.0491611392898947, 1.0009512069651645, 1.0435799120920228, 1.069259962049336, 1.0, 1.042287679689567, 1.0087954673149933, 1.050260043041607, 1.2695652173913043, 1.0011546788549435]
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.5920	median: 1.0600	mean: 1.1479

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 19.342021 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=naru', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[1.1324883e-06 2.9802322e-07 0.0000000e+00 2.9802322e-07 3.5762787e-07]
Distance score: 4.172325134277344e-07
SAUCE Drift detection: False
Detection latency: 0.0233s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 2.039702 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 7.0000	99th: 3.0000	95th: 1.7525	median: 1.0659	mean: 1.1729
ReportEsts: [1.2173913043478262, 1.0227272727272727, 1.016580710759393, 1.006472491909385, 1.0285714285714285, 1.0, 1.19836998308473, 1.0052396807502593, 1.0, 1.032079646017699, 1.006019020103527, 1.002520601766588, 1.025179856115108, 1.0274509803921568, 1.0354924578527063, 1.6666666666666667, 1.0917721518987342, 1.0, 1.3333333333333333, 1.1746641074856046, 1.0989179256839525, 1.0455016527212628, 1.036144578313253, 1.123730378578024, 1.070925795576631, 1.0054692541132115, 2.0, 1.089184597961495, 1.5, 1.1428571428571428, 1.08130081300813, 1.0, 1.000701151085727, 1.0056227575602255, 1.3637218045112782, 1.03706983805668, 1.0142736248236954, 1.0179372197309418, 1.6666666666666667, 1.135277121092724, 1.0277136258660509, 1.0147251335507004, 1.1421254801536491, 1.065812759545128, 1.030195381882771, 1.041467199313282, 1.1304347826086956, 1.1375, 1.1923076923076923, 1.0746376811594203, 1.0714285714285714, 1.0141342756183747, 1.1081081081081081, 1.0303030303030303, 1.070954891343241, 1.0006936510527176, 1.028320874065555, 1.0792291220556745, 1.1566265060240963, 1.0291008624247822, 1.1694915254237288, 1.039076072538062, 1.0429362880886426, 1.0150375939849625, 1.1442307692307692, 2.0, 1.1456837126128465, 1.0568306010928963, 1.2857142857142858, 1.0, 1.0668486804004302, 1.006066734074823, 1.0587102983638113, 1.133587786259542, 1.0789322507755352, 1.0358347386172007, 1.0406362979031092, 1.2616822429906542, 1.070921985815603, 1.0361575720880951, 1.0771637122002085, 1.1785714285714286, 1.0, 1.5, 1.036214953271028, 1.0, 1.0480549199084668, 1.4, 1.4, 1.0334516372512808, 1.0791190864600326, 1.0346268391341067, 1.0060035405495549, 1.1305578859060403, 1.0434782608695652, 1.2907801418439717, 1.3257918552036199, 1.1505791505791505, 1.3214285714285714, 1.1973217802284364, 1.3214285714285714, 4.0, 1.0269612136925825, 1.1355785837651122, 1.035179640718563, 1.0071630703926424, 1.0, 1.0017911935170858, 1.1117332035053553, 1.0606580437094726, 1.1215452261306533, 1.0247108307045216, 1.5, 1.25, 1.0932565087494666, 1.0061877973059872, 1.062604807154835, 1.1219512195121952, 1.0047632237577533, 2.0, 1.2005658597925182, 1.172077922077922, 1.0, 1.2744186046511627, 1.0, 1.0146137787056368, 1.0163008701857439, 1.0664130504868141, 1.0238095238095237, 1.8333333333333333, 1.2202090592334496, 1.0, 1.2, 1.0162593984962407, 1.0769230769230769, 1.05019305019305, 1.0187716769514887, 1.0678651059085842, 2.0, 1.3333333333333333, 1.0178926441351888, 1.058849557522124, 1.0426894343649946, 1.0457099530173173, 1.0816326530612246, 1.0413223140495869, 1.024582247193345, 2.0, 1.0088291746641074, 1.1010526315789473, 1.0625325690463783, 1.0011790714812085, 1.0, 1.0098129408157006, 1.003708281829419, 1.0132890365448506, 1.0728205128205128, 1.0, 1.1201395812562314, 1.046397882030917, 1.2013238557298132, 1.160453808752026, 1.161473087818697, 1.0847457627118644, 1.23125, 1.0728476821192052, 1.1, 1.005106788539181, 2.3333333333333335, 1.0466507177033493, 1.0112223999102208, 1.1148176881303336, 1.1023546151374672, 1.0270758122743682, 1.0730434782608695, 1.1821119819019148, 1.0477242598320813, 1.1782426778242678, 1.0724020442930153, 1.0440366972477064, 1.0311713008171866, 1.0142428306827618, 1.018181818181818, 1.013986013986014, 1.0201751750595087, 1.0383881057805582, 1.0210526315789474, 1.0872283380901195, 1.2586206896551724, 1.3333333333333333, 1.0671641791044777, 1.0111927771944487, 1.0303030303030303, 1.0269989615784008, 1.068737908273586, 1.0121795238913387, 1.0115336905170367, 1.0239043824701195, 1.0114432338455863, 1.0712941117413783, 1.0914002701485817, 1.0031887547587284, 1.1139072847682119, 1.0085174060352982, 1.1629242819843342, 1.209298245614035, 1.2150537634408602, 1.0384615384615385, 1.0, 1.0, 1.0494505494505495, 1.1273011850637251, 1.656160458452722, 1.1538461538461537, 1.018151815181518, 1.1578947368421053, 1.0013968648145275, 1.0739910313901346, 1.0609848804797704, 1.4285714285714286, 1.0427672955974843, 1.0362054448498457, 1.0154298485699602, 1.0224535997970297, 1.3333333333333333, 1.0042971147943525, 1.0285808093244686, 1.031175934366454, 1.0557103064066853, 1.2262295081967214, 1.0381165919282511, 1.0478030399795633, 1.0683760683760684, 1.00335994747026, 1.0266817228585257, 1.127659574468085, 1.2767402376910018, 1.0396732788798133, 3.25, 1.1108897742363877, 1.0, 1.05720871751886, 1.1028154618100725, 1.0886772486772487, 1.4229607250755287, 1.0, 3.3333333333333335, 1.0998358060165367, 1.15625, 1.113478971615396, 2.0, 1.0893719806763285, 1.0627705627705628, 1.1428571428571428, 1.0586649641767751, 1.106818181818182, 1.0576744186046512, 1.3038309114927344, 1.0056497175141244, 1.0586368135431243, 1.0144927536231885, 2.0, 1.0631346015499075, 1.0846074261409357, 1.1046337817638265, 1.047744922886207, 1.058910723361003, 1.0157848055655645, 1.0855826201448322, 1.022682170314728, 1.0673652694610778, 1.1296008294453084, 1.2578034682080925, 1.2857142857142858, 1.085417937766931, 1.1190893169877407, 1.1785714285714286, 1.037037037037037, 1.0838135149292822, 1.1690590111642742, 1.0171320722343757, 1.0102815177478581, 1.176605504587156, 1.2278481012658229, 1.0148288094148672, 1.0028070175438597, 1.052514079861992, 1.0096095618234298, 1.5454545454545454, 1.0505019774870703, 1.0024038461538463, 1.0022820428258463, 1.0533295998370837, 1.0102523772074068, 1.0892762810353935, 1.0016844469399213, 1.0119124506637962, 1.0235306421250785, 1.023342998023971, 1.0355515782622844, 1.0614203454894433, 1.1397849462365592, 1.0714285714285714, 1.0819007460265975, 1.125, 1.0017667844522968, 1.0275846706934242, 1.044814552326955, 1.2352941176470589, 1.2619047619047619, 1.0240963855421688, 1.0397248495270852, 1.0191999937700285, 1.0, 1.027767803710353, 1.0174123547025362, 1.0469135802469136, 2.4, 2.0, 1.11239943208708, 1.5, 1.0317467626656491, 1.0674846625766872, 1.2380952380952381, 1.0654848573092603, 1.3043478260869565, 2.0, 1.0245987722267735, 3.0, 1.059090909090909, 1.0987654320987654, 1.1505507955936352, 1.1603802248361474, 1.2121212121212122, 1.117117117117117, 1.0303639154776956, 1.0169955311103471, 1.0906593406593406, 1.0423308306698331, 1.1574845471647406, 3.0, 1.25, 1.0176722633681026, 1.0, 1.0625, 1.15, 2.0, 1.0740740740740742, 1.2039800995024876, 1.073482428115016, 1.3057851239669422, 1.0587219343696028, 1.130952380952381, 2.75, 1.043194244407888, 1.0, 1.0338983050847457, 1.0163443338814564, 1.2619926199261993, 1.0518341307814991, 1.0101010101010102, 1.8, 1.25, 1.2600619195046439, 1.0320512820512822, 1.047337278106509, 1.0128095018643428, 1.0526896213699302, 1.0074257425742574, 1.0, 1.0075405181869908, 1.0185185185185186, 1.3333333333333333, 1.25, 1.0732984293193717, 1.25, 1.1475770925110131, 1.0158730158730158, 1.0797432964798577, 1.0118083621133074, 1.0954128440366973, 1.097067191945721, 1.0380313199105144, 1.2065009560229445, 1.0201884253028264, 1.0527661508740696, 1.0091185410334347, 1.027027027027027, 1.0050617418653967, 1.0182605886712144, 1.0804306523115896, 1.0255102040816326, 1.2307692307692308, 1.0309653916211294, 3.0, 1.9259259259259258, 1.2105263157894737, 1.0592734225621414, 1.1557788944723617, 1.1793721973094171, 1.0268256333830104, 1.068041237113402, 1.0286505150814713, 1.1304678585013312, 1.1404240282685512, 1.1235955056179776, 1.0461538461538462, 1.1321695760598505, 2.0, 1.0058976240194142, 1.3559322033898304, 1.0029401786723962, 1.0010652463382157, 1.0197917494634767, 1.0307609282245007, 1.8571428571428572, 1.0841307814992025, 1.4, 1.0625730994152047, 1.4545454545454546, 1.07301920637004, 1.0231425091352009, 1.0580333154218162, 1.1546052631578947, 1.0053547523427042, 5.0, 1.0574622984919397, 1.0019619344268926, 1.0942933741861356, 1.5, 1.3220338983050848, 1.0561347233360063, 1.3554502369668247, 1.1059643580675067, 1.074509992313605, 1.0434782608695652, 1.1106259097525473, 1.1333073854237619, 1.124084412857876, 1.022501109209609, 1.058187190240183, 1.0711811023622047, 1.3333333333333333, 1.184949655537891, 1.0784131746220174, 1.2109375, 1.0605898123324398, 1.0, 1.0, 1.1903204708960105, 1.0859375, 1.2246080436264486, 1.0394723158973749, 1.1365227537922986, 1.0, 1.048, 1.0, 1.0747429841622673, 1.0, 1.0, 1.000983992128063, 1.0, 2.0, 1.1006505931879067, 2.0, 1.1775850995504176, 1.0233962264150944, 1.4393939393939394, 1.1, 1.0020554207425638, 1.0437654830718415, 1.1111111111111112, 1.0495678857715431, 1.0149253731343284, 1.0099889012208656, 1.2062750333778371, 1.0303241547577553, 1.0976553173200898, 2.0, 1.1604938271604939, 1.2894356005788712, 1.0012071827372868, 1.0959821428571428, 1.0, 1.0331997710360619, 1.0149663756538068, 1.0168248490077654, 2.0, 1.1148626282687852, 1.0843931089256473, 1.1864893894969082, 1.2098037780055646, 1.037203969626344, 1.0189212086981079, 1.0722460658082975, 1.0626656407625887, 1.75, 1.042244451122655, 1.1214859437751004, 1.0464500601684716, 1.0847741215839375, 1.1029023746701847, 1.0296368069906967, 3.0, 1.0432972589302092, 1.1457687195392114, 1.0207057924645433, 1.0271336951159349, 1.0080280983442047, 1.1333082706766917, 1.072289156626506, 1.053763440860215, 1.021924737112324, 1.0974025974025974, 1.0507170145617628, 1.0048950160264707, 1.0, 1.2826585179526355, 1.0778097982708934, 1.5, 1.1818181818181819, 1.0017619488873668, 1.0865051903114187, 1.0370757180156658, 1.0, 1.4426229508196722, 1.0340586565752128, 1.0296652390525303, 1.0271044092384043, 1.0210573009080472, 1.043207616257781, 1.0573122529644268, 1.0737749057619816, 1.1199678598953806, 1.2932330827067668, 1.064361042183623, 1.0755813953488371, 1.1227272727272728, 1.031032910930805, 1.0454545454545454, 1.0685637525015763, 1.0, 1.112761647535449, 1.6452702702702702, 1.0593622072708055, 1.020746887966805, 1.1698513800424628, 1.0336134453781514, 1.0948275862068966, 1.0409555300360354, 1.0, 1.7118644067796611, 1.1428571428571428, 1.0, 1.0095238095238095, 1.2380952380952381, 1.3557858376511227, 1.0950226244343892, 1.0273552175073393, 1.0382409177820269, 1.0572117648737744, 1.0050826446280992, 1.0083859820587107, 1.000425030017745, 1.0443343603103203, 1.0789194915254237, 1.0669945725915875, 1.0056790417734343, 1.1018886679920477, 1.0323624595469256, 1.1925545571245186, 1.2569444444444444, 1.0256430932989276, 1.2187886279357232, 1.011679355841671, 1.080568720379147, 1.2619047619047619, 1.0, 1.25, 1.0094562647754137, 1.0666666666666667, 4.0, 1.5282485875706215, 1.0052582047413472, 1.0192678227360308, 1.1278772378516624, 1.1352941176470588, 1.0222318768619663, 1.1371643465065646, 1.007380073800738, 1.4, 3.0, 1.1439329203161717, 1.330316742081448, 1.0188225871045253, 1.0288825757575757, 2.0, 1.2295390404515523, 1.131578947368421, 1.0206591244466305, 1.1991150442477876, 1.0263016794010074, 1.0190964735078043, 1.0063590369623956, 1.236842105263158, 1.1, 1.053484446587895, 1.0, 1.1210592686002523, 1.1297071129707112, 1.0578078078078077, 1.0937477412359957, 1.3, 1.1363950276243093, 1.1231884057971016, 1.0219047619047619, 1.112540192926045, 1.0415314730694354, 1.0380952380952382, 1.006805293005671, 1.03770197486535, 1.01247947454844, 1.4, 1.0803689609530112, 1.1415623968003523, 1.0434782608695652, 1.0166782487838777, 1.0276580167575042, 1.1117549668874172, 1.0515936794582392, 1.0, 1.1995708154506437, 1.0214250124564026, 1.1712962962962963, 1.1798561151079137, 1.0096977898060442, 1.2342342342342343, 2.0, 1.0898513251454427, 1.0131306150656532, 1.0753636710632342, 1.084593837535014, 1.048966090058429, 1.011672523122905, 1.0184899845916795, 1.0287338174928955, 1.2364864864864864, 1.0179006191017228, 1.0541535226077814, 1.0221205186880244, 1.0324134910205869, 1.0398112177737824, 1.125, 1.1421668834789072, 1.15, 1.1428571428571428, 1.0231362467866323, 1.0185286103542235, 1.086001255492781, 1.0258333333333334, 1.4444444444444444, 1.02421875, 1.08986013986014, 1.7, 1.0015508237893624, 2.0, 1.0621600621600622, 1.0, 1.4157303370786516, 1.0588235294117647, 1.0974090247452692, 1.1764705882352942, 1.1027667984189724, 1.143362831858407, 2.0, 1.0623446759701778, 1.0286532951289398, 2.25, 2.0, 1.0897435897435896, 1.043613707165109, 1.0217870257037944, 1.0053050397877985, 1.0162381596752368, 1.0285573609059577, 1.115492957746479, 1.0023009664058904, 1.6555555555555554, 1.8012048192771084, 1.2580645161290323, 1.0, 1.1714568880079286, 1.2383233532934133, 1.0330062444246209, 1.2428265524625268, 1.0014854788355794, 1.2164948453608246, 1.0345021332296047, 1.0607809540986564, 1.022794846382557, 1.0004933399111988, 1.2, 1.0, 1.048780487804878, 1.0632699558441034, 1.1366723259762308, 1.005449591280654, 1.2617801047120418, 1.0429252782193958, 1.0136919702417295, 1.006788221808282, 1.053191489361702, 1.0869565217391304, 1.0878122634367904, 1.1080363072835953, 1.0591434857135145, 1.0596447539502392, 1.25, 1.0548339664256832, 1.068750602370932, 1.0074692096743334, 1.000752445447705, 1.0047010051233916, 1.0836120401337792, 1.0336068776865963, 1.2200614124872058, 1.0065960878375584, 4.0, 1.0151574038087836, 1.0, 1.0684647302904564, 1.0123757054555227, 1.208955223880597, 1.014490925746452, 1.1449912126537785, 1.0192307692307692, 1.0386223613776386, 1.0147014701470147, 1.1280940939822317, 1.0063694267515924, 1.0555023923444975, 1.0106362951807228, 1.2163120567375887, 1.1666666666666667, 1.0, 1.5, 1.0156294115274473, 1.8571428571428572, 1.127120926474549, 1.0544666711569115, 1.1416728076639646, 1.069688888888889, 1.0305241564990706, 1.0452846975088967, 1.1372549019607843, 1.0140350877192983, 1.0200726072090822, 1.0258665598076537, 1.006110662907078, 1.0184526790185278, 1.1, 1.0087209302325582, 1.3516129032258064, 1.023841136061883, 1.0405405405405406, 1.0270172257479602, 1.1919642857142858, 1.0193236714975846, 1.0424882047765098, 1.0392156862745099, 1.0075572769906305, 1.1363636363636365, 1.0087824684081224, 1.000465917287602, 1.121616611049314, 1.0087811731647347, 1.2352941176470589, 1.1671001300390118, 1.0715294782444904, 1.141859649122807, 1.1297440423654015, 1.0032570089555466, 1.411764705882353, 1.0525338088869074, 1.1944792973651193, 1.1145038167938932, 1.070945945945946, 1.1181818181818182, 1.1385485391140433, 1.1100094428706326, 1.043782034201163, 1.0333016175071361, 1.083190697421686, 1.0259282277605917, 1.0714285714285714, 1.053109713487072, 1.2497967479674796, 1.0379571481344663, 1.0610655737704917, 1.0798296966471528, 1.1919597989949748, 1.1160862354892205, 1.0231065468549423, 1.031465078625101, 1.0344827586206897, 1.0340175953079178, 1.0082731797356537, 1.031121187139324, 1.608, 1.0039181837798548, 1.101954452753229, 1.09670920080591, 1.05078125, 1.0079074426854102, 1.0868154047567096, 1.0078247261345852, 1.3018018018018018, 1.0128654970760234, 1.0238412087462125, 1.0303030303030303, 2.25, 1.033774763710151, 1.0095935281569468, 1.0272952853598014, 1.303030303030303, 1.0218824940047961, 1.0147833035630347, 1.0092111478507322, 1.1507016473459426, 1.2413793103448276, 1.1041189931350115, 1.1090909090909091, 1.1367292225201073, 1.8928571428571428, 1.0660419622190698, 1.0477386934673367, 1.1094890510948905, 1.0952380952380953, 1.092896174863388, 1.0576923076923077, 1.0392156862745099, 1.5, 1.025909932140654, 1.2535211267605635, 1.0428296438883542, 1.3, 1.081532161924014, 1.0386740331491713, 1.1541633413141794, 1.1140350877192982, 1.0606060606060606, 1.0773240660295396, 1.1474260895316124, 1.0060717669509054, 1.0045385779122542, 1.5921052631578947, 1.0, 1.1, 1.4096385542168675, 1.3333333333333333, 1.0391849529780564, 1.010145482388974, 1.002321163494823, 1.0125, 1.0109171550407041, 1.0013266417191273, 7.0, 1.001153777619387, 1.112333791838606, 1.6666666666666667, 2.0, 1.095686663361428, 1.1192135835567472, 1.0694647020886046, 1.0675675675675675, 1.0, 1.2256809338521402, 1.0934065934065933, 1.4127906976744187, 1.0083068601356573, 1.0422736911679655, 1.0027792337209378, 1.190499691548427, 1.3, 1.008688636332021, 1.0508905852417303, 1.1663346613545817, 1.2437137330754353, 1.1140142517814726, 1.0, 1.1147540983606556, 1.0679893539801597, 1.059263816261663, 1.0, 1.0397350993377483, 1.0164565544663686, 1.1832979476291579, 1.1546762589928057, 1.0810810810810811, 1.0361292241031415, 1.2972292191435768, 1.0282577609668342, 1.462686567164179, 1.3666666666666667, 1.217032967032967, 1.25, 1.0272859216255443, 1.0364077669902914, 1.0052107089737234, 1.0712328767123287, 2.0, 1.0104712041884816, 1.0316225165562913, 1.145947928126146, 1.3882083945778214, 1.0221937553375409, 1.0126143609647906, 1.0797349002459689, 1.0884773662551441, 1.1320754716981132, 1.0261850409560898, 1.0010789795935844, 1.0191938579654511, 1.1711840228245365, 3.5, 1.043010752688172, 1.0616250269222485, 1.1839080459770115, 1.0037706308304521, 1.0031216248254788, 1.1001757469244289, 2.0, 1.0251937984496124, 1.010761274268577, 1.0364288410721028, 1.0771704180064308, 1.0342275349225103, 1.1993769470404985, 1.1505376344086022, 1.09126213592233, 1.003456228189956, 1.004076335528723, 1.16015625, 1.0981404958677685, 1.0769230769230769, 1.1270824434002562, 1.0862300081563177, 1.0404518950437318, 1.0658212560386473, 1.0301291248206599, 1.052456839309429, 1.1891891891891893, 1.0964285714285715, 3.5, 1.5, 1.5333333333333334, 1.0544662309368191, 1.1222076215505914, 1.09165429349171, 1.0266082203008426, 1.1210004506534474, 1.0234782608695652, 1.128440366972477, 1.2163323782234956, 1.0231159927493314, 1.5, 1.3571428571428572, 1.0989696312364425, 1.0, 1.187910643889619, 1.1074785451573355, 1.002793717909997, 1.0525318682508322, 1.2, 1.072482526533782, 1.1022727272727273, 1.0937683994605991, 1.0006537097070156, 1.1041902604756513, 1.052064631956912, 1.0250241739188424, 1.0841778596712408, 1.0704787234042554, 1.5660377358490567, 1.2175398633257404, 1.0, 2.0, 1.0009092026963076, 1.5, 1.4444444444444444, 1.25, 1.0180541624874624, 1.0073294629898404, 1.0277296360485269, 1.0274509803921568, 1.1428571428571428, 1.719656283566058, 1.0203777335984094, 1.2621359223300972, 1.0436590436590436]
origin-bjaq_15.87 	max: 7.0000	99th: 3.0000	95th: 1.7525	median: 1.0659	mean: 1.1729

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 15.549991 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=36.965204