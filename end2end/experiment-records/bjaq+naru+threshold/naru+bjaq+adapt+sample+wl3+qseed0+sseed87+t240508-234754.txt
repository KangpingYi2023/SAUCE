Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='naru', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 87, 'naru': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 5.0000	99th: 2.6667	95th: 1.6000	median: 1.0619	mean: 1.1526
ReportEsts: [1.1977186311787071, 1.0500410172272354, 1.0430275457775966, 1.0216110019646365, 1.0333333333333334, 1.0, 1.1720773354213094, 1.00046526401496, 1.25, 1.0484522207267832, 1.0117664233576642, 1.00213595598111, 1.0271786022433131, 1.027906976744186, 1.027552101730837, 1.0, 1.6363636363636365, 1.00035423308537, 3.0, 2.6666666666666665, 1.0, 1.0650851843864568, 1.0172893241446017, 1.090268886043534, 1.0118401578687717, 1.0, 1.0545532363205372, 1.5, 1.4, 1.2517985611510791, 1.0, 1.0022492717348566, 1.0081442842379804, 1.255826859045505, 1.007196357761786, 1.0239658790874009, 1.0374331550802138, 1.0040259330306194, 1.1090639851229422, 1.2261904761904763, 1.0209424083769634, 1.0884146341463414, 1.0, 1.1282881297338068, 1.0320839117692426, 1.2314049586776858, 1.0679611650485437, 1.2747747747747749, 1.0216416050510924, 1.08, 1.061453590614536, 1.2024793388429753, 1.003227595424186, 2.0, 1.2883116883116883, 1.0545887066483035, 1.1083636363636364, 1.0687022900763359, 1.15527950310559, 1.25, 1.0116062604858542, 1.0292652552926524, 1.05, 1.160919540229885, 1.0, 1.1286559828320237, 1.0480843404474158, 1.1666666666666667, 1.0, 1.0972790507364976, 1.0011933174224343, 1.0560046189376444, 1.1013513513513513, 1.1290493636714232, 1.2211764705882353, 1.1297071129707112, 1.0, 1.0463084316295326, 1.6, 1.0501018680593417, 1.09375, 1.0286735657849537, 1.2147239263803682, 1.0057670126874279, 1.0664573521716378, 1.04, 1.0033786225337862, 1.0344035588221072, 1.1225490196078431, 2.3333333333333335, 1.1225612806403202, 1.0164695225603049, 1.0222929936305734, 1.2987377279102383, 1.280701754385965, 1.135693215339233, 1.238532110091743, 1.0316901408450705, 1.0, 1.0394175477647931, 1.1552195824334053, 1.0017182130584192, 1.0033990723365083, 1.0588235294117647, 1.0086069012327445, 1.1053403755868545, 1.0115004566968364, 1.049677664012135, 1.017149984409105, 1.1666666666666667, 1.3333333333333333, 1.1295856426497757, 1.0212436504124038, 1.0652759084791386, 1.051948051948052, 1.009589748766396, 2.0, 1.1858638743455496, 1.1531100478468899, 1.0, 1.2142857142857142, 1.1666666666666667, 1.0175438596491229, 1.021771657581878, 1.111050710569232, 1.0769230769230769, 1.8, 1.2864238410596027, 1.0, 1.2142857142857142, 1.0090071668830705, 1.1818181818181819, 1.0081380208333333, 1.0004521846169305, 1.0200934766108736, 1.1776729559748427, 1.0703812316715542, 1.0280448717948718, 1.00199203187251, 1.052597819114817, 1.0330107351984386, 1.2345679012345678, 1.0841487279843445, 1.004167175852377, 2.0, 1.0105941962229388, 1.0479041916167664, 1.0775434243176178, 1.0261161108170107, 1.0, 1.0772584160813756, 1.005925925925926, 1.008, 1.4476190476190476, 1.1576642335766423, 1.00708024275118, 1.015336123324681, 1.0189754192510911, 1.1007604562737643, 1.105263157894737, 1.0, 1.2318840579710144, 1.1186161449752883, 1.1428571428571428, 1.0022257523132567, 1.0170035608353858, 1.0172711571675301, 1.0333505496937947, 1.0598656078191815, 1.0144105390509477, 1.0736842105263158, 1.0903361344537814, 1.2235886511087442, 1.101336302895323, 1.154382470119522, 1.0436105476673427, 1.0426270918850646, 1.049908480780964, 1.0668982180610087, 1.0, 1.2727272727272727, 1.0516473731077471, 1.0474002923366048, 1.0863854975952645, 1.1515151515151516, 1.0417877701503002, 1.0187977286077932, 1.010237430469883, 1.1153846153846154, 1.0777272727272726, 1.0282781950576227, 1.0, 1.4545454545454546, 1.0587456207809964, 1.23950056753689, 1.1197728446050594, 1.5909090909090908, 1.0321543408360128, 1.0029115907076454, 1.0411744664168132, 1.1798245614035088, 1.1229050279329609, 1.023121387283237, 1.09375, 1.024390243902439, 1.0, 1.0457516339869282, 1.0082684051518525, 1.602787456445993, 1.0919540229885059, 1.0182896688087, 1.0957683741648108, 1.0658863059476635, 1.0011374986128065, 1.0365655647204002, 1.2571428571428571, 1.0984126984126985, 1.0300400534045393, 1.0335458670802458, 1.0096279485592463, 1.0, 1.075776397515528, 1.0267661946310047, 1.0129840779416182, 1.0690245293782088, 1.0681103348456593, 1.005963457959736, 1.0344827586206897, 1.0014082972177747, 1.1248730964467004, 1.161872532430908, 1.0158730158730158, 1.0155887929218455, 1.025386751289171, 1.0929133858267717, 1.0, 1.1046724092926128, 1.1258374274229568, 1.0486725663716814, 1.4776119402985075, 1.2, 2.6666666666666665, 1.1146655880128735, 1.1454545454545455, 1.1239544274588982, 1.5, 1.5, 1.1764705882352942, 1.0117096018735363, 1.469387755102041, 1.1243093922651934, 1.089655172413793, 1.0453020134228188, 1.0071881606765327, 1.0117506511819196, 1.087719298245614, 2.0, 1.0085649108253836, 1.191779881981611, 1.094570928196147, 1.0487120464759399, 1.069487479047087, 1.051894279207784, 1.1120826709062004, 1.0255796348784396, 1.061602870813397, 1.1208911045334164, 1.1967960023515578, 1.5454545454545454, 1.0262228522006536, 1.1471215351812367, 1.2727272727272727, 1.1363636363636365, 1.192, 1.0555555555555556, 1.1584158415841583, 1.0721754929008815, 1.2033426183844012, 1.191044776119403, 1.0219230403122175, 1.175542406311637, 1.0094757654464646, 1.0121452334336152, 1.4, 1.058985085485631, 1.0, 1.0119714052931745, 1.0755939524838012, 1.0112193345773974, 1.3, 1.6666666666666667, 1.0434782608695652, 1.5070422535211268, 1.0123021657962885, 1.0, 1.0244648318042813, 1.0135746606334841, 1.0356570512820513, 1.0065361005553932, 1.0988372093023255, 1.0314465408805031, 1.0196922022219097, 1.03386521812935, 1.0720685959271168, 1.1538461538461537, 1.0, 1.2219570405727924, 1.0, 1.1682242990654206, 1.040269926821787, 1.03719723183391, 1.1414790996784565, 1.0847457627118644, 1.0329218106995885, 1.078164116828929, 1.4285714285714286, 1.0253418185097616, 1.0586080586080586, 1.0555555555555556, 1.0035562756594214, 1.2380952380952381, 1.75, 1.0202281978749828, 2.0, 1.0233196159122084, 1.0392441860465116, 1.0344544708777688, 1.0252035672741373, 1.195822454308094, 1.164835164835165, 1.0251762063880734, 1.0239039945473576, 1.0110192837465564, 1.0070020725474167, 1.1483582328033874, 3.0, 1.2222222222222223, 1.0170125735003603, 1.3333333333333333, 1.048687089715536, 1.0, 1.0, 1.0454545454545454, 1.189964157706093, 1.0895091434071222, 1.449438202247191, 1.1233766233766234, 1.0, 1.014647137150466, 1.003653583417306, 1.5, 1.0946992257296009, 1.0, 1.0078038411903134, 1.0987654320987654, 1.0892416688533193, 1.1658986175115207, 1.0018181818181817, 1.123444976076555, 1.1203703703703705, 1.009354256935246, 1.0049226441631505, 1.0094086021505377, 1.0, 1.1428571428571428, 1.8333333333333333, 1.5, 1.0666666666666667, 1.0019536647279972, 1.25, 1.0732113144758735, 1.0594059405940595, 1.0681516767261212, 1.011572216097023, 1.0125130344108446, 1.0901147688093327, 1.0360576923076923, 1.282442748091603, 1.5, 1.0434782608695652, 1.0398230088495575, 1.0123453877788524, 1.3333333333333333, 3.142857142857143, 1.1069042316258353, 1.0197674418604652, 1.0083806350773281, 1.1623931623931625, 1.342769701606733, 1.043093607305936, 1.3793103448275863, 1.0808477237048666, 1.0254237288135593, 1.2884615384615385, 1.0584707646176912, 1.1081081081081081, 1.0368059407160906, 1.0054609789229219, 1.03314598024172, 1.1025641025641026, 1.2333333333333334, 1.0654761904761905, 1.0, 1.0224898287206792, 1.0318130356603126, 1.003733876442634, 1.0138243851311057, 1.0309810671256454, 1.0115718418514947, 1.8333333333333333, 1.1616015436565363, 1.2, 1.072587532023911, 1.1111111111111112, 1.028410836904476, 1.027536231884058, 1.046109200343938, 1.1620553359683794, 1.0815972222222223, 3.0, 1.0284124194493263, 1.0059827078083337, 1.017059039911716, 1.0, 1.26, 1.0038387715930903, 1.235632183908046, 1.094845192386243, 1.178921568627451, 1.2352941176470589, 1.0138050043140638, 1.1064575688877463, 1.0618864544063304, 1.0206112983709859, 1.013048245614035, 1.230514096185738, 1.0731707317073171, 1.25, 1.0761421319796953, 1.3448275862068966, 1.0463847203274215, 1.2222222222222223, 1.0701631849641247, 1.25, 1.1082818218162807, 1.0023887676364949, 1.1447740112994351, 1.0, 1.0961538461538463, 1.32, 1.0013619206973035, 1.37417943107221, 1.0, 1.1104586902459244, 1.0086610348218623, 1.1975186104218363, 1.0, 2.0, 1.1790291262135921, 1.0035971223021583, 1.4523809523809523, 1.0, 1.022841216439079, 1.004721435316336, 1.0869565217391304, 1.0440677966101695, 1.0272727272727273, 1.0132978723404256, 1.189516129032258, 1.066470340765671, 1.146662074507778, 1.0, 1.0405405405405406, 1.0873265065829378, 1.0050120833948513, 1.0623256774904446, 1.0, 1.0407458563535912, 1.0117933538637354, 1.0282870612886328, 2.0, 1.1072567783094098, 1.1029259451061626, 1.1015014430716348, 1.2012144510943166, 1.0261605597101502, 1.1747843028110214, 1.0025210084033613, 1.0749758919961427, 2.0, 1.0716316088686755, 1.3962264150943395, 1.0, 1.3129251700680271, 1.1304347826086956, 1.0345133849848451, 1.0315512708150745, 1.038199820326089, 1.1535203811540498, 1.0696144688424445, 1.0, 1.0113388120253823, 1.0970873786407767, 4.0, 1.0521089905173449, 1.0010131712259371, 1.0059531947862548, 1.0220024745590393, 1.1001953670108848, 1.2538152610441766, 1.0885416666666667, 1.4285714285714286, 1.0058281908120286, 1.0125121165866322, 1.0169032568112084, 1.1019154318756776, 1.0305785329259507, 1.0041237113402062, 1.0039714521532261, 1.0925162050677666, 1.0768175582990398, 2.0, 1.0, 1.0199386503067485, 1.0741444866920151, 1.0293609671848014, 1.079667063020214, 1.1434977578475336, 1.0364583333333333, 1.0554699537750385, 1.120879120879121, 1.011073100468131, 1.4303797468354431, 1.0739350443180316, 1.0, 1.1021377672209025, 1.3452380952380953, 1.1702127659574468, 1.0282122905027933, 1.1092233009708738, 1.0019762845849802, 1.06198347107438, 1.0149793326183103, 1.0, 1.6808510638297873, 1.1666666666666667, 1.0, 1.0602409638554218, 1.2216748768472907, 1.3305954825462012, 1.1638418079096045, 1.0305991669336751, 1.1601615074024225, 1.0593504847384467, 1.024304870834155, 1.0971428571428572, 1.0362492365265108, 1.0451977401129944, 1.0723350253807107, 1.1490082244799227, 1.1032786885245902, 1.0997109826589595, 1.0401234567901234, 1.0236551330601236, 1.0082654861777545, 1.0074828567044745, 2.0, 1.1305555555555555, 1.0526802218114601, 1.0555555555555556, 1.0, 1.108695652173913, 1.1538461538461537, 1.1232604373757455, 2.074074074074074, 1.5, 1.041129553059975, 1.0209880931224453, 1.0053933107426472, 1.0086023142509135, 1.1081081081081081, 1.023086269744836, 2.0, 1.2222222222222223, 1.099908966772872, 1.000863282598879, 1.0055331384251094, 1.0768310741542317, 1.0035758984444842, 1.1127167630057804, 1.0295809209769564, 1.1438721136767318, 1.0326965381498205, 1.0251134245750109, 1.4545454545454546, 1.1141906873614191, 1.0, 1.0113378684807257, 1.0186388123819916, 3.0, 1.0978593272171253, 1.0428423330027945, 1.2857142857142858, 1.179269328802039, 1.1, 1.1875, 1.0215934844192636, 1.6923076923076923, 1.0150103332003915, 1.0170867150790261, 1.1875, 1.3181818181818181, 1.2372448979591837, 1.0310856049736967, 1.0829548171169017, 1.015571939914951, 1.0110587890025746, 1.0, 1.162176841190528, 1.0152439024390243, 2.0, 1.053993588117259, 1.0119500984898226, 1.10879848628193, 1.0160778985507246, 1.017990051239855, 1.3294117647058823, 2.142857142857143, 1.0258653480410802, 1.0689655172413792, 1.0082636214005736, 1.0943962641761174, 1.056296791520901, 1.0609876871683444, 1.1868131868131868, 1.034243939976914, 1.1412213740458015, 1.0045491633786758, 1.1028391167192428, 1.037593984962406, 1.2221638655462186, 1.024369077569053, 4.0, 1.0149695889261745, 1.0217989880816294, 1.037055196007932, 1.105263157894737, 1.1104942555324235, 1.2904761904761906, 1.0, 1.0174758675135465, 1.0134426229508198, 1.1308641975308642, 1.1470588235294117, 1.6666666666666667, 1.0505645803872024, 1.5, 1.4125412541254125, 1.1538461538461537, 1.1017374921498848, 1.2857142857142858, 1.185, 1.1048218029350105, 1.0, 1.2804232804232805, 1.0813295615275813, 2.0, 1.0, 1.08130081300813, 1.0943396226415094, 1.1117717003567182, 1.029157667386609, 1.035598705501618, 1.0412979351032448, 1.089150378938971, 1.0493506493506493, 1.6896551724137931, 1.3172043010752688, 1.3846153846153846, 1.0, 1.0174002047082906, 1.2626262626262625, 1.1388235294117648, 1.1351287780783252, 1.0213571283811975, 1.2151975072871646, 1.0127323392523642, 1.004611976613284, 1.0336943441636584, 1.0173031026252983, 1.5714285714285714, 1.0, 1.0303030303030303, 1.017678269398599, 1.150253807106599, 1.0065359477124183, 1.2192192192192193, 1.0284077892325314, 1.021649399994533, 1.0031948589597808, 1.0769230769230769, 1.1578947368421053, 1.0458919319022946, 1.0941145281018028, 1.0303350580514892, 1.0501592672385307, 1.1644736842105263, 1.0763437684583579, 1.0317387052610991, 1.0204865556978233, 1.046908315565032, 1.2222222222222223, 1.023094688221709, 1.2164383561643837, 1.0192307692307692, 1.1650793650793652, 1.0347890451517394, 1.0, 1.106060606060606, 1.0468628314089323, 1.2777777777777777, 1.002913571991498, 1.1652542372881356, 1.0232558139534884, 1.0587116393462483, 1.0094246934245479, 1.1155989793177545, 1.0057581573896353, 1.0256111757857975, 1.005945671776375, 1.2147505422993492, 1.0714285714285714, 1.0, 1.25, 1.0170521981349159, 1.8333333333333333, 1.0789154188587617, 1.074363254536643, 1.1517501107665042, 1.0793140407288317, 1.0006875165952283, 1.1186495176848874, 1.0528301886792453, 1.022695035460993, 1.0061333270716415, 1.0504394062476923, 1.0073101167221916, 1.0330005287549375, 1.25, 1.078125, 1.308300395256917, 1.0180248882110299, 1.0749185667752443, 1.0349116299367227, 1.1309734513274337, 1.0253411306042886, 1.0589441113904468, 1.0390516039051605, 1.017799043062201, 1.3125, 1.0175970159791023, 1.0141576586270258, 1.1707429626211352, 1.0008428150021071, 1.032258064516129, 1.04389721627409, 1.1343283582089552, 1.625, 1.0516660161101452, 1.4230769230769231, 1.1071428571428572, 1.0461538461538462, 1.2171274443695212, 1.0525340966492676, 1.0788235294117647, 1.5714285714285714, 1.0821256038647342, 1.0112504136181477, 1.01848079491184, 1.004226505692653, 1.108347653070453, 1.045755435061492, 1.2307692307692308, 1.0540765391014975, 1.271485345255837, 1.1252734497075763, 1.0080808080808081, 1.1944444444444444, 1.1304791029561672, 1.0152855302705024, 1.1870689655172413, 1.026451520469931, 1.0, 1.3333333333333333, 1.009770328067443, 1.0075981426762346, 1.0107927634133085, 1.1172195303764443, 1.0710295291300878, 1.066350710900474, 1.0000690035881865, 1.0980755854393693, 1.0583657587548638, 1.2216216216216216, 1.0251256281407035, 1.0027855495017917, 1.0119047619047619, 1.75, 1.0138363329524849, 1.0070552147239265, 1.0045610034207526, 1.2222222222222223, 1.0622737146994932, 1.0060581046387174, 1.0230083405234398, 1.0075566750629723, 1.1923076923076923, 1.0828840970350404, 1.0294736842105263, 1.096875, 1.3870967741935485, 1.0368532796960555, 1.0138751238850348, 1.0845323741007193, 1.1714285714285715, 1.0226769652589696, 1.0745098039215686, 1.0119894330420647, 1.0875605815831988, 1.6666666666666667, 1.0769230769230769, 1.3333333333333333, 1.0349675558759914, 1.6153846153846154, 1.3333333333333333, 1.3636363636363635, 1.252072968490879, 1.0260223048327137, 1.1019502200637425, 1.0135683913812048, 1.0848126232741617, 1.3235294117647058, 1.0, 1.1071428571428572, 1.4054054054054055, 1.6666666666666667, 1.0233644859813085, 1.0100193836407476, 1.0012445435125847, 1.046875, 1.0419633026268098, 1.0010409889394924, 5.0, 1.0045507128032392, 1.1185714285714285, 1.0, 1.3333333333333333, 1.0446745562130177, 1.1088718353295561, 1.0652160967999333, 1.0248447204968945, 1.0, 1.0617283950617284, 1.0582822085889572, 2.0, 1.5, 1.0802165354330708, 1.1545863728076984, 1.141654778887304, 1.25, 1.0063597557321045, 1.0658404337722696, 1.1376896149358227, 1.1428571428571428, 1.126984126984127, 1.0037277060322283, 1.381578947368421, 1.1228968544257498, 1.0966925449324683, 1.1294117647058823, 1.0703125, 1.0280440771349861, 1.1861656703672074, 1.0867768595041323, 1.1129032258064515, 1.0277262611275964, 1.0779109589041096, 1.0470396595857852, 1.336, 1.146067415730337, 1.164179104477612, 1.0511140235910879, 1.0465905584696082, 1.0112589457714074, 1.0406897873155776, 1.0207423580786026, 3.0, 1.25, 1.0378159623167253, 1.1306068601583112, 1.4209297801984049, 1.01947462918129, 1.0140491721023583, 1.080969995889848, 1.027972027972028, 1.0416666666666667, 1.0238229376257546, 1.017721024840254, 1.0259281084266352, 1.0332749562171628, 2.5, 1.0133333333333334, 1.068344400014674, 1.0530465949820789, 1.0359901742137756, 1.001724748966332, 1.1079545454545454, 1.6, 1.0268691588785046, 1.0554747244305285, 1.0427233264793236, 1.2775665399239544, 1.0296988985838935, 1.2411067193675889, 1.2513812154696133, 1.0927536231884059, 1.0023170208277257, 1.0589703588143526, 1.096774193548387, 1.1267605633802817, 1.03125, 1.127904989747095, 1.0101812305206048, 1.0184940554821664, 1.0618184724648603, 1.0490367775831875, 1.0053231939163498, 1.3846153846153846, 1.0658174097664543, 2.5, 1.5, 1.4166666666666667, 1.020460358056266, 1.1500789889415481, 1.0285194400089124, 1.047155826066705, 1.0461329715061058, 1.0073221757322175, 1.1467391304347827, 1.4285714285714286, 1.0064675884032352, 1.6, 1.25, 1.0848780487804879, 1.0, 1.207395498392283, 1.1251236399604352, 1.1006944444444444, 1.022828715651426, 1.25, 1.096774193548387, 1.321705426356589, 1.0897755610972568, 1.0007574749000363, 1.1030640668523677, 1.0395158419366322, 1.0240901385980656, 1.1269706524375456, 1.0810810810810811, 1.3653846153846154, 1.2053072625698324, 1.0, 1.0, 1.0005409320124459, 1.6666666666666667, 1.5714285714285714, 1.4210526315789473, 1.01468788249694, 1.119047619047619, 1.0574443141852286, 1.1044194107452339, 1.0, 1.227808814400993, 1.0184414039262344, 1.1748878923766817, 1.0558375634517767, 1.1111111111111112, 1.0004420866489832, 1.04490022172949, 1.0819327731092436, 1.074748977314987, 1.0100787494123178, 1.0866686142759763, 1.0464252553389044, 1.0, 1.0391758683420063, 1.0084751547739697, 1.0261388091822095, 1.2695652173913043, 1.029554519678985]
origin-bjaq_15.87 	max: 5.0000	99th: 2.6667	95th: 1.6000	median: 1.0619	mean: 1.1526

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 20.061239 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=naru', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[9.5367432e-07 5.3644180e-07 1.7881393e-07 5.9604645e-08 4.1723251e-07]
Distance score: 4.2915343101412873e-07
SAUCE Drift detection: False
Detection latency: 0.0232s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 2.072592 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 6.0000	99th: 3.0000	95th: 1.7161	median: 1.0636	mean: 1.1630
ReportEsts: [1.0953757225433527, 1.053186611646034, 1.032668102536011, 1.0305958132045088, 1.1176470588235294, 1.0, 1.16123439667129, 1.0186185251668873, 1.0, 1.0246085011185682, 1.0437779902380113, 1.0031418036842161, 1.0245115452930729, 1.0949612403100775, 1.0792196275495123, 1.103448275862069, 1.1013071895424837, 1.0, 1.5555555555555556, 1.2002002002002001, 1.0556811177316623, 1.0180378354597448, 1.1085972850678734, 1.1107954545454546, 1.0120211684715943, 1.0038018747660764, 3.0, 1.0789539994960382, 1.3333333333333333, 1.5, 1.0681818181818181, 1.0, 1.0011907529927357, 1.0068888427410774, 1.253683241252302, 1.0620518837178985, 1.0306223061103754, 1.0379464285714286, 1.8, 1.3297560975609757, 1.075906607054148, 1.1617615093683433, 1.0229885057471264, 1.0053627290332192, 1.0090579710144927, 1.1209076059938925, 1.3, 1.0, 1.117391304347826, 1.1185682326621924, 1.0, 1.0212765957446808, 1.0582959641255605, 1.2121212121212122, 1.0817274481312975, 1.0076427332066429, 1.0375485541648684, 1.2358276643990929, 1.1325301204819278, 1.0340603244096749, 1.0298507462686568, 1.025738945782101, 1.0680851063829788, 1.16015625, 1.1428571428571428, 1.4285714285714286, 1.10367363390338, 1.0289126335637964, 1.1428571428571428, 1.0, 1.0186864306552077, 1.041372351160444, 1.0620490620490621, 1.1428571428571428, 1.0703962881265687, 1.321078431372549, 1.0239876243440118, 1.0271493212669682, 1.0780141843971631, 1.0065855338691159, 1.2323901264298616, 1.0625, 3.0, 1.2222222222222223, 1.0011350737797957, 1.0714285714285714, 1.0192307692307692, 1.4615384615384615, 1.5, 1.0412730382518902, 1.0827755102040817, 1.1096413874191653, 1.004597760197267, 1.1671719359029884, 1.0229591836734695, 1.2485549132947977, 1.01171875, 1.1173469387755102, 1.0544412607449856, 1.2062378167641326, 1.2424242424242424, 1.0, 1.060274912847931, 1.202020202020202, 1.0316875460574797, 1.0060984591815691, 1.25, 1.0042250901728018, 1.12142152023692, 1.003624303347352, 1.052880075542965, 1.0259942812581233, 1.1428571428571428, 1.5, 1.1077492381367, 1.0211035504722323, 1.0367074527252502, 1.0957446808510638, 1.0040202148070494, 2.0, 1.224569385765356, 1.1223694466095089, 1.0, 1.2102803738317758, 1.0, 1.0268595041322315, 1.0086138027197449, 1.0846594935893306, 1.0526315789473684, 1.8333333333333333, 1.2020338983050847, 1.0, 1.6666666666666667, 1.0101522842639594, 1.1538461538461537, 1.0048622366288493, 1.0536124823489597, 1.0403800475059382, 1.0, 1.5333333333333334, 1.0100401606425702, 1.0678623364032962, 1.066595631326585, 1.01478502812811, 1.2254901960784315, 1.0660888407367282, 1.020434200836039, 3.0, 1.021186440677966, 1.053053053053053, 1.0681227249089964, 1.0204111817778436, 1.0, 1.0156902699949057, 1.0024271844660195, 1.0201680672268907, 1.2962962962962963, 1.0, 1.0723014256619146, 1.000537321452559, 1.0932324065052836, 1.1507064364207222, 1.1155913978494623, 1.0508474576271187, 1.1875, 1.1069012178619757, 1.1111111111111112, 1.0042279101990377, 1.5, 1.1124694376528117, 1.0007013917088117, 1.2611600875961593, 1.0424260922647597, 1.0439367311072056, 1.0929432013769362, 1.177428456267634, 1.0252897787144362, 1.1395918367346938, 1.0545609548167092, 1.0390810668074992, 1.0539801399967443, 1.0042887473460722, 1.0318471337579618, 1.0555555555555556, 1.036644058863507, 1.0276087400449254, 1.1428571428571428, 1.3419983753046303, 1.2263610315186246, 1.5, 1.1125, 1.0126641014841413, 1.0714285714285714, 1.0119418483904465, 1.110454878943507, 1.0098359685840643, 1.0183830461178778, 1.0019704433497536, 1.016684887598403, 1.0388461392668966, 1.1003584229390682, 1.0178063642518618, 1.0825404988428902, 1.0008667680386758, 1.1796344647519583, 1.1684638500972246, 1.3642384105960266, 1.135135135135135, 1.029126213592233, 1.0, 1.0446927374301676, 1.0470295408397197, 1.5830903790087463, 1.0934579439252337, 1.0231692180388912, 1.7142857142857142, 1.004556809610474, 1.0458715596330275, 1.0074719800747198, 1.0, 1.1576011157601116, 1.0216126350789692, 1.0246770473584206, 1.0608922504449119, 1.0, 1.0351533283470455, 1.0322352863899107, 1.065708123652049, 1.013550135501355, 1.2428810720268006, 1.1207865168539326, 1.0754297666514152, 1.0344827586206897, 1.0019438857227996, 1.0090614723360065, 1.1648745519713262, 1.1606694560669457, 1.0136830102622576, 1.0714285714285714, 1.1400523560209423, 1.0, 1.0159362549800797, 1.1019179616407673, 1.0482051282051281, 1.2536023054755043, 1.0769230769230769, 3.3333333333333335, 1.1358778625954198, 1.056338028169014, 1.0769473714433375, 1.75, 1.0037922987164527, 1.021978021978022, 1.1428571428571428, 1.046490902925102, 1.0657596371882085, 1.1008814887365328, 1.1554404145077721, 1.016375934496262, 1.0269428334714168, 1.0434782608695652, 1.0, 1.003985911863242, 1.0406675400125307, 1.1074626865671642, 1.0637357352913976, 1.0670042194092828, 1.0344359050571101, 1.1025299600532623, 1.0042891346817668, 1.0648379052369077, 1.1225477373790218, 1.376701754385965, 1.8571428571428572, 1.092543728135932, 1.1093189964157706, 1.2, 1.0344827586206897, 1.0769230769230769, 1.0939226519337018, 1.016508219190041, 1.0288933834151979, 1.1646489104116222, 1.1691919191919191, 1.0210418359460156, 1.0460189919649379, 1.032979774555867, 1.0131251934727812, 1.9, 1.01318781264211, 1.130778588807786, 1.030692139054181, 1.0646249017569658, 1.0363403774825444, 1.1277602523659307, 1.0011191941801902, 1.0062437203961534, 1.0342246740925543, 1.0004333772729734, 1.0633496807366112, 1.012797074954296, 2.2, 1.1666666666666667, 1.0653080872913991, 3.0, 1.0160427807486632, 1.0055852082066528, 1.0173764342453664, 1.1714285714285715, 1.330708661417323, 1.0616570327552985, 1.062857142857143, 1.0335603786654353, 1.2727272727272727, 1.0178805578734056, 1.0025291176992255, 1.1012658227848102, 2.5, 1.5714285714285714, 1.06795669200645, 1.625, 1.0266489617436296, 1.0468277945619335, 1.0454545454545454, 1.0663260972442998, 1.0769230769230769, 1.7777777777777777, 1.010390710654839, 4.0, 1.2857142857142858, 1.0551558752997603, 1.0635386119257086, 1.153975599495162, 1.028322440087146, 1.1327433628318584, 1.0192370615247486, 1.0142439011015374, 1.0187421907538525, 1.0386159542623672, 1.1635504556193048, 3.0, 1.0, 1.014012234129937, 1.5, 1.050661798265632, 1.0, 1.2857142857142858, 1.0384615384615385, 1.192079207920792, 1.092147435897436, 1.1278195488721805, 1.142711518858308, 1.263157894736842, 2.0, 1.01929326306016, 3.0, 1.1929824561403508, 1.011262040009879, 1.211111111111111, 1.0501174628034455, 1.0320754716981133, 1.8, 1.0, 1.2083946980854197, 1.5279503105590062, 1.0314033366045143, 1.0109006077978053, 1.0704015865146257, 1.038560411311054, 1.0, 1.0068258685470777, 1.079268292682927, 1.1142857142857143, 2.5, 1.0714285714285714, 1.25, 1.063157894736842, 1.0932203389830508, 1.0983803618878907, 1.0155120448633392, 1.1378326996197718, 1.025799398742826, 1.0405821438567031, 1.8333333333333333, 1.0013071895424837, 1.046636941466654, 1.1080246913580247, 1.0606060606060606, 1.0102151872147862, 1.0378483792790063, 1.05229793977813, 1.0528846153846154, 1.263157894736842, 1.1091617933723197, 2.0, 1.8888888888888888, 1.2321428571428572, 1.0825335892514396, 1.4444444444444444, 1.1734693877551021, 1.0353356890459364, 1.0555555555555556, 1.023245520315028, 1.0813469542186909, 1.013553523258109, 1.188235294117647, 1.170940170940171, 1.1017369727047146, 2.0, 1.0001692355759217, 1.4385964912280702, 1.0068185692368885, 1.0200276243093922, 1.0427241626223247, 1.0064429530201342, 1.7142857142857142, 1.201761409127302, 1.1666666666666667, 1.0148148148148148, 1.4545454545454546, 1.0475918051797448, 1.059850374064838, 1.011769991015274, 1.1666666666666667, 1.1196709050112192, 3.0, 1.1164439596400326, 1.0068290896327552, 1.0627408870395583, 1.0, 1.2203389830508475, 1.0609851446442533, 1.3649289099526067, 1.1211089494163424, 1.0701530612244898, 1.0, 1.197724039829303, 1.1219915559273888, 1.0399590163934427, 1.0555477596771656, 1.0496377113350546, 1.0043227665706052, 1.5, 1.2375415282392026, 1.0289823693164244, 1.3360655737704918, 1.0909580193756727, 2.0, 2.0, 1.130952380952381, 1.1733870967741935, 1.2138728323699421, 1.032268059490085, 1.1525821596244132, 1.0, 1.126984126984127, 1.1666666666666667, 1.025080336001804, 1.0833333333333333, 1.0, 1.0334172334386547, 2.0, 1.0, 1.107750472589792, 1.75, 1.1730769230769231, 1.0172026925953628, 1.3418181818181818, 1.1, 1.0189955567154032, 1.058970099667774, 1.037037037037037, 1.1097895699908509, 1.0, 1.0437636761487965, 1.20285908781484, 1.0367102012001412, 1.1197533224973706, 1.0, 1.0, 1.0387537993920972, 1.0170257646527046, 1.1122062168309326, 1.1666666666666667, 1.0364263803680982, 1.0133540372670808, 1.0252503265128428, 2.0, 1.1279573475508164, 1.073894182277539, 1.0662642732094798, 1.1703280715792537, 1.0209192485936096, 1.0143535015098064, 1.0511363636363635, 1.054462973288053, 1.5, 1.0395619616500023, 1.086734693877551, 1.0396539293439078, 1.099780701754386, 1.0078125, 1.0451089895020267, 1.1854103343465046, 1.0851735770509845, 1.1354075372480281, 1.041813036690086, 1.1597938144329898, 1.017407738983388, 1.205656108597285, 1.072289156626506, 1.043010752688172, 1.031864477783887, 1.103225806451613, 1.0169154228855721, 1.00707208282434, 1.0, 1.2949502677888294, 1.1875, 1.2727272727272727, 1.275, 1.0029058701794455, 1.1933085501858736, 1.0147058823529411, 1.0, 1.2307692307692308, 1.0326627218934912, 1.083038543739406, 1.0200114351057747, 1.0146205646205646, 1.0129171151776104, 1.0364842454394694, 1.0858862144420132, 1.0658246447720132, 1.2446043165467626, 1.030757177321139, 1.0685645549318363, 1.162037037037037, 1.0037395562453766, 1.1467505241090146, 1.0668869269576662, 1.0, 1.1264367816091954, 1.4019933554817277, 1.023330385286981, 1.0204498977505112, 1.0943952802359882, 1.227347611202636, 1.1313672922252012, 1.0271776244816357, 1.0, 1.8392857142857142, 1.4285714285714286, 1.3333333333333333, 1.0, 1.1368421052631579, 1.3466898954703832, 1.0762331838565022, 1.0304004285522967, 1.0894736842105264, 1.0581058519670656, 1.010551814747906, 1.0646969790572682, 1.0001977385895846, 1.0266908344869483, 1.1167484997272232, 1.0857630493528658, 1.0048293548077845, 1.0520884520884521, 1.0288568257491675, 1.1093366093366093, 1.3587786259541985, 1.0242246055737299, 1.2728426395939085, 1.0085034352285174, 1.1126760563380282, 1.085133744855967, 1.213381555153707, 2.5, 1.0272835112692764, 1.1333333333333333, 2.0, 1.1, 1.023416718969485, 1.033140655105973, 1.141025641025641, 1.1566265060240963, 1.0349300018833574, 1.1981655215708158, 1.005514705882353, 1.0, 2.0, 1.0674169289028748, 1.3394495412844036, 1.0224719101123596, 1.0463414634146342, 1.0, 1.0831792975970425, 1.1053921568627452, 1.0070892084758203, 1.1681681681681682, 1.0342286733857355, 1.0245784781492957, 1.0172502711554412, 1.1294117647058823, 1.6666666666666667, 1.080119860490249, 2.0, 1.1353767560664112, 1.1908713692946058, 1.0749625187406298, 1.145528658776415, 1.1142857142857143, 1.0127627627627627, 1.1594202898550725, 1.0040281973816716, 1.0235045954497515, 1.0783055198973042, 1.0382746051032807, 1.1005978148835291, 1.026102610261026, 1.00718719372754, 1.1666666666666667, 1.0565702995846942, 1.0836798155200726, 1.25, 1.0235294117647058, 1.0870548332391181, 1.1914893617021276, 1.0721496946020805, 1.2727272727272727, 1.1517671517671517, 1.0316545307443366, 1.1813186813186813, 1.1486486486486487, 1.001237292669877, 1.3368421052631578, 2.142857142857143, 1.0181182453909727, 1.0040871934604905, 1.000722318216582, 1.07543466068424, 1.0271885902105697, 1.0138447571493419, 1.0941358024691359, 1.0478036175710594, 1.0886075949367089, 1.0019515277674522, 1.0787110406761753, 1.0878489326765188, 1.0914581535806729, 1.0522911359798506, 1.1875, 1.1635434412265757, 1.2, 1.6, 1.036340852130326, 1.017402454662026, 1.053155113459745, 1.25, 1.5555555555555556, 1.0304, 1.073984022229941, 1.5398230088495575, 1.0053345463567942, 2.3333333333333335, 1.0062602025452874, 1.0, 1.3789473684210527, 1.0, 1.113963517687511, 1.4545454545454546, 1.1882845188284519, 1.1637478108581436, 1.0, 1.043282161625357, 1.0994671403197158, 2.25, 1.0, 1.1056338028169015, 1.0955414012738853, 1.1011546184738956, 1.0223214285714286, 1.0213618157543392, 1.1129032258064515, 1.1060171919770774, 1.0413793103448277, 1.4816753926701571, 1.1123595505617978, 1.4516129032258065, 1.0, 1.027661357921207, 1.2404306220095693, 1.0084317032040473, 1.164895749799519, 1.0064888353861738, 1.2023420366615634, 1.0083373286924902, 1.08047883933509, 1.065856129685917, 1.0034825870646766, 1.0833333333333333, 1.0, 1.125, 1.0088449896447347, 1.1519933554817277, 1.005420054200542, 1.1551312649164678, 1.0357984585005415, 1.0333812784074565, 1.0006172196667014, 1.0303030303030303, 1.0833333333333333, 1.0511860174781522, 1.0790097590560732, 1.011966010341315, 1.0637225713970668, 1.1675675675675676, 1.0014762871378484, 1.016624023041539, 1.0586423819247743, 1.0159453302961277, 1.0203899223507067, 1.0714285714285714, 1.0432074737251849, 1.235042735042735, 1.0065811054011164, 2.4285714285714284, 1.0201397451705714, 1.0, 1.0649087221095335, 1.016785846635282, 1.2698412698412698, 1.033253180426249, 1.1777777777777778, 1.0196078431372548, 1.050335807705903, 1.0143226815911417, 1.098233809924306, 1.0031645569620253, 1.0009451795841209, 1.004642656162071, 1.1775043936731107, 1.105263157894737, 1.0, 1.0, 1.016747331969786, 1.8571428571428572, 1.0173757157116396, 1.040614955833764, 1.1345407503234153, 1.0911881545684363, 1.0206051824645348, 1.128230261985386, 1.0705128205128205, 1.005787037037037, 1.018207892045655, 1.0014279007902356, 1.0030697499890224, 1.0143773220011196, 1.3333333333333333, 1.0172910662824208, 1.376271186440678, 1.0782022961326654, 1.0134048257372654, 1.0189116859946477, 1.1166180758017492, 1.0112721417069244, 1.0511854585457268, 1.0789473684210527, 1.0064530906121474, 1.3333333333333333, 1.000932400932401, 1.0006659995168916, 1.1633888048411498, 1.0084299262381453, 1.0833333333333333, 1.0533980582524272, 1.0943324937027707, 1.1265915130881867, 1.0387323943661972, 1.0027146875652568, 1.2121212121212122, 1.0892295898811806, 1.1552715654952077, 1.1165413533834587, 1.441095890410959, 1.0512129380053907, 1.16351606805293, 1.0915002322340919, 1.0545320011901593, 1.0373205741626794, 1.0070969095231437, 1.023855873959489, 1.1333333333333333, 1.0418956043956045, 1.0549787234042554, 1.0357939837543515, 1.1717171717171717, 1.3242819843342037, 1.1243731193580742, 1.0084745762711864, 1.011124845488257, 1.0052481242724525, 1.0163934426229508, 1.0238095238095237, 1.020825069416898, 1.0244503801109512, 1.5397815912636506, 1.0433389607028871, 1.045862830788086, 1.052456839309429, 1.0634615384615385, 1.0150501534638394, 1.0798472910405328, 1.0105740181268883, 1.4046511627906977, 1.025462962962963, 1.0046840080413908, 1.0, 2.25, 1.0162292546079024, 1.006765852752762, 1.0124879923150816, 1.281437125748503, 1.003627569528416, 1.0363729169794325, 1.0232558139534884, 1.09297052154195, 1.1935483870967742, 1.089535534415221, 1.2, 1.123324396782842, 1.5806451612903225, 1.0518162741897878, 1.0016366612111294, 1.0, 1.0714285714285714, 1.5584415584415585, 1.0326894502228827, 1.0714285714285714, 1.75, 1.0417721518987342, 1.1428571428571428, 1.0752634219769193, 1.2727272727272727, 1.0451972138562011, 1.0848, 1.2490227305631967, 1.0948275862068966, 1.5, 1.0128918839730443, 1.1015668144595043, 1.015756825490803, 1.20863309352518, 1.3132530120481927, 1.0526315789473684, 1.0833333333333333, 1.2608695652173914, 1.4193548387096775, 1.1271867612293145, 1.0113676661807005, 1.006825864204832, 1.0666666666666667, 1.011949319200226, 1.0018324039135806, 6.0, 1.0191432922831756, 1.245272206303725, 1.0, 1.1428571428571428, 1.0594422700587085, 1.1363934426229507, 1.0611621704688539, 1.108179419525066, 1.0, 1.0477815699658704, 1.1286089238845145, 1.1666666666666667, 1.008075181340921, 1.034803484463955, 1.006296610114678, 1.1423777564717161, 1.3333333333333333, 1.0366742297383025, 1.0665804783451842, 1.09478672985782, 1.2556894243641232, 1.0779976717112922, 1.0, 1.0, 1.0501420454545454, 1.1116484854998478, 1.1096774193548387, 1.0198019801980198, 1.039011852718782, 1.1641168289290682, 1.0505050505050506, 1.3387096774193548, 1.0297561318434183, 1.0487257900101936, 1.033350242102836, 2.0297029702970297, 1.2551020408163265, 1.0198019801980198, 1.2, 1.0339918651946542, 1.0341463414634147, 1.0075511842533698, 1.0253164556962024, 2.5, 1.0396825396825398, 1.0209409064830752, 1.1125273124544792, 1.2766060215746258, 1.0079604521827632, 1.022857142857143, 1.0877735408292968, 1.0058479532163742, 1.0727272727272728, 1.0492633517495396, 1.0049785894856318, 1.047945205479452, 1.0301724137931034, 2.5, 1.021505376344086, 1.0904649330181244, 1.2418207681365576, 1.038907619689818, 1.000557406290166, 1.1086186540731995, 1.8, 1.022373540856031, 1.0251399538975396, 1.023034456501047, 1.0317460317460319, 1.0059735364835616, 1.2258064516129032, 1.1876379690949228, 1.1021505376344085, 1.0037930783153752, 1.0009461590448299, 1.1046511627906976, 1.1086729362591432, 1.1025641025641026, 1.0252958265429037, 1.058010872219295, 1.054551737756714, 1.0764338038234769, 1.0018823529411764, 1.0560747663551402, 1.0, 1.0756756756756756, 3.0, 1.5, 1.2857142857142858, 1.041036717062635, 1.1382488479262673, 1.049492111519343, 1.020575292905837, 1.0755827110205929, 1.0582779138956948, 1.0675675675675675, 1.0648464163822526, 1.0024074648984589, 1.8333333333333333, 1.0588235294117647, 1.2216186854970126, 1.1111111111111112, 1.2184210526315788, 1.134575569358178, 1.0645910036817672, 1.0173111815202969, 1.5, 1.026431718061674, 1.2542372881355932, 1.0231228150174798, 1.00045531765102, 1.0248648648648648, 1.0473604826546004, 1.0279882506091658, 1.0192728266812465, 1.055263157894737, 1.5555555555555556, 1.246260069044879, 1.3333333333333333, 3.0, 1.0016964635260341, 1.25, 1.625, 1.3555555555555556, 1.075742067553736, 1.0007890999000473, 1.0011229646266142, 1.0597609561752988, 1.0, 1.161029411764706, 1.030922693266833, 1.217741935483871, 1.0329218106995885]
origin-bjaq_15.87 	max: 6.0000	99th: 3.0000	95th: 1.7161	median: 1.0636	mean: 1.1630

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 16.495076 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=38.661798