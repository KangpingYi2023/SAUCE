Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='naru', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 56, 'naru': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.5784	median: 1.0590	mean: 1.1489
ReportEsts: [1.1013986013986015, 1.055234954657873, 1.0311479078093533, 1.0153846153846153, 1.0333333333333334, 1.0, 1.164223751121747, 1.0039350185348317, 1.25, 1.0304232804232805, 1.045537182927885, 1.002792000312149, 1.0249677141627207, 1.0372093023255815, 1.039208760155422, 1.0, 1.4516129032258065, 1.0297555791710946, 3.0, 2.6666666666666665, 1.35, 1.0953633814966572, 1.0487610310614748, 1.0874840357598978, 1.0004935834155972, 1.0, 1.0361660142981917, 1.0, 1.4, 1.1798561151079137, 1.0, 1.0030525830687338, 1.001879213621377, 1.5244173140954496, 1.0065040650406505, 1.027181639699411, 1.0747126436781609, 1.0022824952043319, 1.0904332254287485, 1.0952380952380953, 1.0423076923076924, 1.076219512195122, 1.0, 1.1139692193123991, 1.0609285824463983, 1.2231404958677685, 1.0776699029126213, 1.2922374429223744, 1.0293637573555878, 1.0285714285714285, 1.030957791603025, 1.2435897435897436, 1.00555175771135, 2.0, 1.3220779220779222, 1.0240400025642669, 1.069090909090909, 1.064638783269962, 1.2298136645962734, 1.25, 1.0160195743502147, 1.0280199252801991, 1.1090909090909091, 1.1839080459770115, 1.1, 1.1052576927070714, 1.0233492342455435, 1.1666666666666667, 1.0, 1.050430865648257, 1.0310262529832936, 1.0633720930232557, 1.1013513513513513, 1.047263459130746, 1.2117647058823529, 1.1538461538461537, 1.0, 1.0453950240069838, 2.0, 1.0618238686906367, 1.1875, 1.0221992276674277, 1.196319018404908, 1.026376146788991, 1.0505154639175258, 1.04, 1.0149538676495387, 1.068182953013432, 1.1862745098039216, 2.3333333333333335, 1.0432357043235705, 1.0392033456658687, 1.1145833333333333, 1.3394109396914446, 1.2514285714285713, 1.0968660968660968, 1.2735849056603774, 1.0, 1.0, 1.016600145137881, 1.1987041036717063, 1.002579535683577, 1.0091158352027918, 1.2647058823529411, 1.003161205783184, 1.1244776119402986, 1.0515535853548414, 1.0640879787637467, 1.0312993993044577, 1.0, 1.3333333333333333, 1.1386006916733173, 1.0001277746260038, 1.0667115902964959, 1.0129870129870129, 1.0076302335385876, 1.0, 1.2266924564796906, 1.1368421052631579, 1.0, 1.2197802197802199, 1.4, 1.0175438596491229, 1.0068834517716223, 1.1039061893298128, 1.0275229357798166, 1.8, 1.1986754966887416, 1.0, 1.1785714285714286, 1.008608438723661, 1.1818181818181819, 1.0524088541666667, 1.0107519453359042, 1.0377113133940181, 1.1382978723404256, 1.0252808988764044, 1.0371867421180274, 1.00199203187251, 1.051923076923077, 1.0659320104098895, 1.2469135802469136, 1.0802348336594911, 1.0099913594820558, 2.0, 1.0148011100832564, 1.0379596678529064, 1.0366004962779156, 1.0097053114522676, 1.0, 1.035965124727537, 1.0118518518518518, 1.002, 1.4476190476190476, 1.1531986531986531, 1.014017094017094, 1.0627744623353226, 1.0664622598971953, 1.1596958174904943, 1.0986842105263157, 1.0, 1.1159420289855073, 1.1204620462046204, 1.1428571428571428, 1.0073064468117734, 1.0086314039756308, 1.0326991676575505, 1.030006619107156, 1.045815516188149, 1.0335533116005406, 1.0127931769722816, 1.1428571428571428, 1.1893095768374164, 1.0808743169398907, 1.1778455284552845, 1.0228628230616301, 1.047256581033936, 1.0199952580415712, 1.1095890410958904, 1.0, 1.3548387096774193, 1.0062482249360978, 1.0478378942970545, 1.0625231224565297, 1.0555555555555556, 1.0214536941745926, 1.0274841437632136, 1.0360366209986365, 1.0740740740740742, 1.0695187165775402, 1.0332320394472794, 1.0, 1.3636363636363635, 1.0269788644840447, 1.3087400681044268, 1.1203512396694215, 1.5909090909090908, 1.0115755627009646, 1.000838244520555, 1.0171206332126606, 1.1798245614035088, 1.1767682091282807, 1.1419354838709677, 1.078125, 1.0119047619047619, 1.0, 1.0457516339869282, 1.050617181675089, 1.6202090592334495, 1.0459770114942528, 1.018783984181908, 1.0957683741648108, 1.071915229647586, 1.033320386194651, 1.0339676560368902, 1.2661870503597121, 1.0282317979197622, 1.044685172647258, 1.0047180019910833, 1.071239133637837, 1.0, 1.1308488612836438, 1.0219801863195006, 1.0071669385872308, 1.0870069605568446, 1.0166375245059078, 1.0056251057350702, 1.0344827586206897, 1.0010813710779343, 1.0084514367442465, 1.1861252115059222, 1.103448275862069, 1.1431238332296203, 1.0332688588007737, 1.1007874015748031, 1.0, 1.0378071833648392, 1.0528137561411344, 1.0715900527505653, 1.5597014925373134, 1.0909090909090908, 2.6666666666666665, 1.064385079404161, 1.1090909090909091, 1.0862777893929891, 1.5, 1.5, 1.2121212121212122, 1.0050741608118656, 1.4591836734693877, 1.1049723756906078, 1.1421686746987951, 1.0853658536585367, 1.0166453265044815, 1.015669235608682, 1.0, 2.0, 1.0048012666296549, 1.1122547001509537, 1.0700525394045535, 1.0359486324360612, 1.0491949001879413, 1.0012480294272201, 1.1049284578696343, 1.0382022076298787, 1.0675837320574162, 1.1189735614307932, 1.1752056573820175, 1.6363636363636365, 1.0685301748990967, 1.1428571428571428, 1.25, 1.04, 1.2443636363636363, 1.0555555555555556, 1.1938775510204083, 1.0492968171724648, 1.068452380952381, 1.2626582278481013, 1.023609894464606, 1.0595555555555556, 1.0074100446532552, 1.0017031978733903, 1.5, 1.039432520916697, 1.0, 1.0123992230529761, 1.1274298056155507, 1.001504239219619, 1.3, 1.6666666666666667, 1.0, 1.5070422535211268, 1.0063740710809186, 1.0, 1.0061162079510704, 1.0091324200913243, 1.0352564102564104, 1.0043899180645857, 1.18125, 1.0377358490566038, 1.0084815778371536, 1.1046228710462287, 1.0807329933442822, 1.2307692307692308, 1.0, 1.2649164677804297, 1.0, 1.1869158878504673, 1.0173995028713465, 1.0559225011008366, 1.056547619047619, 1.2826086956521738, 1.0164609053497942, 1.0713101160862355, 1.5714285714285714, 1.0258325454766566, 1.0586080586080586, 1.1578947368421053, 1.0440993700089998, 1.1904761904761905, 1.75, 1.0297170611967776, 2.0, 1.0267605633802817, 1.0784883720930232, 1.0082034454470878, 1.0155068078668683, 1.1488250652741514, 1.1538461538461537, 1.0061418579796804, 1.0132096751945343, 1.0082417582417582, 1.004780451805994, 1.1387150439673612, 2.0, 1.1111111111111112, 1.0227052293309962, 1.0, 1.0481137233460907, 1.0, 1.0, 1.0454545454545454, 1.1608391608391608, 1.0832535885167465, 1.2772277227722773, 1.0227272727272727, 1.0, 1.0412782956058588, 1.007096510055457, 1.5, 1.0625372245384157, 1.0, 1.0108251727017383, 1.0112359550561798, 1.0807662030963001, 1.1705069124423964, 1.0018181818181817, 1.2140641158221304, 1.0188679245283019, 1.0153110768188491, 1.0033632358881956, 1.0239680426098536, 1.0, 1.2142857142857142, 1.8333333333333333, 1.5, 1.1428571428571428, 1.0022757224132943, 1.25, 1.086522462562396, 1.01, 1.0739067729734142, 1.0128174945721835, 1.0210304942166142, 1.0747059934822651, 1.030484160191273, 1.2650602409638554, 1.5, 1.0835214446952597, 1.146341463414634, 1.003026773506188, 1.2857142857142858, 3.142857142857143, 1.1202672605790647, 1.030813953488372, 1.0025012352830929, 1.182608695652174, 1.342769701606733, 1.0362914658349873, 1.2698412698412698, 1.0808477237048666, 1.0010593220338984, 1.2115384615384615, 1.055306427503737, 1.0423728813559323, 1.0809373895724244, 1.0142160979490806, 1.0200960114396609, 1.4576271186440677, 1.063063063063063, 1.0783132530120483, 1.0, 1.0312170375207192, 1.0131555355194337, 1.0316086123323187, 1.015463699824427, 1.0367183017785429, 1.0181171142025234, 1.8333333333333333, 1.306319343945972, 1.2, 1.0589239965841162, 1.1111111111111112, 1.0299761064076236, 1.0304347826086957, 1.082115219260533, 1.1620553359683794, 1.1923444976076556, 3.0, 1.1639959086259801, 1.009623510392044, 1.0147369873091778, 1.0, 1.3695652173913044, 1.0719769673704416, 1.396551724137931, 1.0709605242128817, 1.090702947845805, 1.05, 1.0690250215703192, 1.0986748311402996, 1.110540853271621, 1.0101648375826169, 1.0391447368421052, 1.2056384742951907, 1.0946969696969697, 1.1538461538461537, 1.0, 1.3, 1.0402455661664394, 1.2222222222222223, 1.0307321099752365, 1.0416666666666667, 1.1155894006934126, 1.08387661587751, 1.1140893470790378, 1.0, 1.0857142857142856, 1.36, 1.0030835284933646, 1.3282275711159737, 1.0, 1.107971815418624, 1.0139469515608437, 1.1742092457420925, 1.0, 2.0, 1.1689320388349516, 1.0099547511312217, 1.3990825688073394, 1.0, 1.0203262088528267, 1.0740365111561867, 1.0869565217391304, 1.0305461393596986, 1.018181818181818, 1.0627615062761506, 1.1556451612903227, 1.1354648716870004, 1.1161242178979394, 1.0, 1.054054054054054, 1.0849457963223383, 1.0113697867536766, 1.0831943542299387, 1.0, 1.012541993281075, 1.0195735136582753, 1.0272393923520167, 2.0, 1.1076555023923444, 1.0126053387316982, 1.0181344044122056, 1.1286531824734611, 1.0322587884663723, 1.1559316464015774, 1.0487394957983194, 1.1284956605593057, 2.0, 1.098299653728875, 1.3454545454545455, 1.25, 1.3310344827586207, 1.1304347826086956, 1.0524967540442853, 1.0979477611940298, 1.0886232008716097, 1.0465898174831891, 1.090451029190011, 1.0339510347626133, 1.0253302819099137, 1.0, 4.0, 1.0426599447845397, 1.0580971659919027, 1.0073821789408228, 1.0092604137692904, 1.0856513357201873, 1.1597325408618129, 1.066326530612245, 1.4285714285714286, 1.0188646483188013, 1.0004902343097166, 1.057068130568186, 1.086600142551675, 1.014968183571153, 1.0329896907216496, 1.0072097878331796, 1.0282861896838602, 1.0665760869565217, 2.0, 1.0909090909090908, 1.0230061349693251, 1.064030131826742, 1.0136054421768708, 1.0907911802853436, 1.191588785046729, 1.24375, 1.0554699537750385, 1.0769230769230769, 1.0071454011218948, 1.3452380952380953, 1.068721510030115, 1.0, 1.08835027365129, 1.2619047619047619, 1.24822695035461, 1.0480093676814988, 1.1025331724969842, 1.0630252100840336, 1.0428015564202335, 1.0408553381458967, 1.0, 1.6382978723404256, 1.8333333333333333, 1.0, 1.0602409638554218, 1.099778270509978, 1.375796178343949, 1.138121546961326, 1.0297981416212751, 1.1462765957446808, 1.0125216788067986, 1.0153815815421021, 1.1070840197693574, 1.037916759576139, 1.088235294117647, 1.0974025974025974, 1.146589259796807, 1.0990745781164943, 1.0072254335260116, 1.0083625573239816, 1.0067857142857144, 1.0047507403751235, 1.0105987465624888, 2.0, 1.113022113022113, 1.021256931608133, 1.0482758620689656, 1.0, 1.275, 1.1538461538461537, 1.0216998191681737, 1.8148148148148149, 1.5, 1.0280496894409938, 1.0279011906877555, 1.0048824335859696, 1.0341893685114354, 1.0972972972972972, 1.048602673147023, 2.0, 1.0845070422535212, 1.1563123056065077, 1.004120824164833, 1.0062949857738157, 1.0591183506094088, 1.0186661898802074, 1.09375, 1.0174099192967831, 1.1243339253996447, 1.0165485172437374, 1.0353734068788945, 1.4242424242424243, 1.0403726708074534, 1.0, 1.0090702947845804, 1.0179511148040437, 3.0, 1.107849133537207, 1.0492981700265311, 1.2857142857142858, 1.1932086825703847, 1.0, 1.1875, 1.0154390934844193, 1.6923076923076923, 1.0001390038860651, 1.0205040580948312, 1.1875, 1.16, 1.2467866323907455, 1.0019129603060737, 1.100048567265663, 1.0104712041884816, 1.0110048421305375, 1.0, 1.1854225505105367, 1.0060975609756098, 2.0, 1.0946790598980556, 1.0228660425110172, 1.1002838221381268, 1.0097149176385871, 1.0919959879638916, 1.2555555555555555, 2.142857142857143, 1.00836820083682, 1.0411418975650715, 1.0642933500755094, 1.0013360053440215, 1.0440956953241618, 1.0824599236929016, 1.2252747252747254, 1.042264443582784, 1.1412213740458015, 1.0098656119376153, 1.0807570977917982, 1.0909090909090908, 1.1307773109243697, 1.070345988306349, 4.0, 1.008992239932886, 1.0082988383630842, 1.0389342472930492, 1.0555555555555556, 1.0117316473480857, 1.3826530612244898, 1.0, 1.0524479417987453, 1.0134426229508198, 1.1103030303030303, 1.1470588235294117, 1.6666666666666667, 1.003490078303918, 1.0, 1.3986928104575163, 1.1538461538461537, 1.0544972437373525, 1.2857142857142858, 1.253968253968254, 1.1519916142557651, 1.0, 1.2380952380952381, 1.0625434329395413, 2.0, 1.0, 1.0725806451612903, 1.0820895522388059, 1.1058263971462545, 1.018162393162393, 1.0158730158730158, 1.0241691842900302, 1.089150378938971, 1.0493506493506493, 1.5605095541401275, 1.09375, 1.1538461538461537, 1.0, 1.0835010060362174, 1.2496392496392497, 1.0556161395856052, 1.2494498381877022, 1.0014962622667205, 1.1632829789281247, 1.0055583553197165, 1.0089285714285714, 1.0794223826714802, 1.0047732696897376, 1.375, 1.0, 1.0303030303030303, 1.0397367715056733, 1.098933074684772, 1.0065359477124183, 1.288888888888889, 1.038106147384498, 1.0207286432160805, 1.007531290793212, 1.0512820512820513, 1.1578947368421053, 1.0606957809030348, 1.1597958642629904, 1.0611008220424343, 1.076012106953568, 1.2236842105263157, 1.1116361488481985, 1.0176904764660717, 1.1078014184397162, 1.0056323604710702, 1.1111111111111112, 1.044811320754717, 1.1891891891891893, 1.0192307692307692, 1.2525597269624573, 1.0347890451517394, 1.0, 1.0895522388059702, 1.032597441635216, 1.3148148148148149, 1.0034628519571085, 1.2023305084745763, 1.0, 1.016586098692739, 1.022314347512617, 1.052914316411496, 1.0028708133971291, 1.0268065268065267, 1.006311992786294, 1.2043010752688172, 1.1428571428571428, 1.0, 1.1111111111111112, 1.0160591013685358, 1.8333333333333333, 1.0654256036692298, 1.0442087125087502, 1.0832964111652637, 1.0809360240446544, 1.0052772825550962, 1.027759914255091, 1.0488721804511278, 1.035919540229885, 1.0112992227675113, 1.0069375619425174, 1.0008005177000696, 1.0198679563949025, 1.25, 1.1228070175438596, 1.316205533596838, 1.0227240499149177, 1.0032679738562091, 1.004427577482606, 1.1716814159292035, 1.037037037037037, 1.0451116913257905, 1.0191518467852256, 1.0227153110047846, 1.375, 1.0236803708846163, 1.0084548659967885, 1.1675103543488266, 1.0008428150021071, 1.0625, 1.006423982869379, 1.0696517412935322, 1.5, 1.0498777852562968, 1.4230769230769231, 1.0574596774193548, 1.0637362637362637, 1.1753202966958867, 1.0093473827328348, 1.0694117647058823, 1.1, 1.0717703349282297, 1.0107173057833008, 1.0077150471412895, 1.010824485994248, 1.0208756789177302, 1.0846513443268608, 1.0769230769230769, 1.0419407894736843, 1.1148661848017192, 1.095897138265101, 1.0040241448692153, 1.2013888888888888, 1.0546837850689492, 1.0054554681552905, 1.1932409012131715, 1.0059498736310026, 1.0, 1.3333333333333333, 1.0147741600534006, 1.047920967266293, 1.02069938842716, 1.038834764526936, 1.0510774142059058, 1.0817307692307692, 1.0044852373314324, 1.0931513173080094, 1.0018416206261511, 1.3567567567567567, 1.0084033613445378, 1.0182226476218526, 1.0119047619047619, 1.75, 1.0520127475826364, 1.0192630643089993, 1.0515587529976018, 1.24822695035461, 1.0434454098979977, 1.0167556293965851, 1.011085844229676, 1.0638297872340425, 1.1923076923076923, 1.0977088948787062, 1.0526315789473684, 1.09375, 1.5925925925925926, 1.0632025924684323, 1.0237859266600595, 1.0864864864864865, 1.2424242424242424, 1.0175945430835591, 1.0095016482451038, 1.0124351980483177, 1.048920578332343, 1.6666666666666667, 1.0769230769230769, 2.0, 1.016283185840708, 1.5, 1.3333333333333333, 1.3636363636363635, 1.2138263665594855, 1.0108695652173914, 1.0527784826186246, 1.0411360923199364, 1.0223048327137547, 1.5735294117647058, 1.0, 1.064516129032258, 1.3108108108108107, 1.4583333333333333, 1.0498442367601246, 1.0092629488798688, 1.006520667453429, 1.046875, 1.0228623403978854, 1.0008207797407538, 5.0, 1.0098754720832908, 1.1928571428571428, 1.0, 1.3333333333333333, 1.0236686390532543, 1.1426522269239046, 1.1034454011695072, 1.046583850931677, 1.0, 1.1072961373390557, 1.187116564417178, 2.0, 1.5, 1.0821850393700787, 1.0700517836593786, 1.1633958424189563, 1.25, 1.0093643965908787, 1.067389620449264, 1.0328205128205128, 1.1428571428571428, 1.1576086956521738, 1.0026352764015032, 1.3026315789473684, 1.0987831066571223, 1.056188291204064, 1.1552941176470588, 1.0078125, 1.0514462809917355, 1.1929974380871051, 1.1487603305785123, 1.2321428571428572, 1.0629691954904918, 1.0463271051958023, 1.064370643706437, 1.176056338028169, 1.2439024390243902, 1.2238805970149254, 1.0321750321750323, 1.0417690417690417, 1.0098274402290046, 1.0034840257802526, 1.074235807860262, 3.0, 1.25, 1.027995005585858, 1.1416007036059808, 1.3283407897296247, 1.0108301905518062, 1.0160561966884094, 1.0861933671994384, 1.0634920634920635, 1.0625, 1.002521869335645, 1.0299870559470732, 1.0836770771950501, 1.0035149384885764, 2.5, 1.08, 1.0095381341942111, 1.081242532855436, 1.0006556046391832, 1.0122207872961209, 1.0973011363636365, 1.6, 1.0058754406580495, 1.0686221363250683, 1.0573452136166324, 1.0436507936507937, 1.012444571592047, 1.1376811594202898, 1.2293080054274084, 1.1020289855072465, 1.0040773939658942, 1.0332260589719058, 1.1002304147465438, 1.1344430217669654, 1.0, 1.0365686944634314, 1.0007998903007587, 1.1321003963011889, 1.0402836296372417, 1.046592894583576, 1.0500397140587767, 1.2857142857142858, 1.040339702760085, 2.5, 1.5, 1.3076923076923077, 1.0281329923273657, 1.1532385466034756, 1.0703330981469792, 1.0312856997931341, 1.2236092265943013, 1.0056485355648535, 1.059782608695652, 1.489795918367347, 1.0199763889385756, 1.6, 1.25, 1.1622764227642277, 1.0, 1.1789638932496076, 1.1102977061981454, 1.0010827393305062, 1.021773709240233, 1.25, 1.040257648953301, 1.2945736434108528, 1.1206982543640898, 1.0006747855146043, 1.1528384279475983, 1.0339943342776203, 1.0194953445434873, 1.0873456970689757, 1.1271860095389508, 1.5777777777777777, 1.2639664804469273, 1.0, 1.0, 1.0006124602124387, 1.6666666666666667, 1.5714285714285714, 1.35, 1.0699638118214716, 1.146341463414634, 1.0518950437317784, 1.0911815068493151, 1.0, 1.2054624456859093, 1.022700119474313, 1.1434977578475336, 1.0121654501216546, 1.25, 1.06209649019838, 1.1879157427937916, 1.1123110151187905, 1.0725176645593157, 1.0152030241975178, 1.0766039556198745, 1.0361630401471038, 1.0, 1.025466377440347, 1.001176229658841, 1.0037803780378038, 1.2695652173913043, 1.0368590513720024]
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.5784	median: 1.0590	mean: 1.1489

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 16.507760 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=naru', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[2.3841858e-07 2.3841858e-07 0.0000000e+00 5.9604645e-08 2.9802322e-07]
Distance score: 1.668930025289228e-07
SAUCE Drift detection: False
Detection latency: 0.0233s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 2.038190 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 6.0000	99th: 2.5000	95th: 1.8343	median: 1.0735	mean: 1.1733
ReportEsts: [1.0539772727272727, 1.05475372279496, 1.046850848248929, 1.0287081339712918, 1.0277777777777777, 1.0, 1.161521609241187, 1.0086246113473418, 1.0, 1.0398671096345515, 1.0222008418520745, 1.0020507488121544, 1.0939648586707411, 1.0399201596806387, 1.0138357374153666, 1.8907563025210083, 1.078125, 1.8, 1.4444444444444444, 1.249740932642487, 1.0687242798353909, 1.0166195778627223, 1.1481481481481481, 1.1042435424354244, 1.049675790544345, 1.011520515248241, 3.0, 1.0695932967736548, 1.1666666666666667, 1.3333333333333333, 1.2478825522303783, 1.0, 1.004567095066762, 1.015348651225739, 1.4432705558107488, 1.0055059341734982, 1.022195239036512, 1.0464037122969838, 1.8333333333333333, 1.2585197934595524, 1.0107456550177536, 1.0237829068451691, 1.1387856257744733, 1.031720430107527, 1.0, 1.0799917605053557, 1.037037037037037, 1.1054131054131053, 1.1435406698564594, 1.0786838340486409, 1.1538461538461537, 1.0957854406130267, 1.0896860986547086, 1.09375, 1.091799644861818, 1.0276580901965613, 1.0970961887477313, 1.1333333333333333, 1.1341463414634145, 1.0179715580559463, 1.0289855072463767, 1.053802260225338, 1.0716332378223496, 1.0218978102189782, 1.17, 1.0, 1.1838515778522714, 1.0439371096273962, 1.1428571428571428, 2.0, 1.0429526956241437, 1.0199600798403194, 1.04642166344294, 1.0953271028037384, 1.108995923536629, 1.007656967840735, 1.0244587305106037, 1.0613207547169812, 1.148936170212766, 1.0257317826844206, 1.013235294117647, 1.3333333333333333, 2.0, 2.0, 1.0470588235294118, 1.126984126984127, 1.18014329580348, 1.7777777777777777, 1.6666666666666667, 1.0239762801506531, 1.0832381263260975, 1.079203666571183, 1.0103343932711046, 1.1527508090614886, 1.1145251396648044, 1.3242924528301887, 1.0130434782608695, 1.2886866059817945, 1.25, 1.1456770627714172, 1.5925925925925926, 2.0, 1.0544679166516717, 1.0975609756097562, 1.0159651669085632, 1.0071059047392519, 1.0731707317073171, 1.0025472204405932, 1.1123818995524615, 1.0262417672886937, 1.0491283676703644, 1.033929510783798, 1.1428571428571428, 1.0, 1.1422845691382766, 1.0083675538220993, 1.0667040358744395, 1.0416666666666667, 1.007115411277704, 1.0, 1.2313889784079923, 1.1865912762520194, 1.5, 1.2293577981651376, 1.2857142857142858, 1.0863157894736841, 1.018781363698012, 1.09788842544317, 1.08, 2.4, 1.2524682651622003, 2.0, 1.1578947368421053, 1.013106525376464, 1.2307692307692308, 1.136896046852123, 1.020374337580336, 1.0890228763965242, 1.1666666666666667, 1.4666666666666666, 1.0669546436285098, 1.0369850187265917, 1.0474413646055436, 1.0590741343753391, 1.1909547738693467, 1.0787486515641855, 1.0379831523887724, 2.0, 1.0054074932406334, 1.0740365111561867, 1.0342886386898669, 1.0432784941455462, 1.3333333333333333, 1.0320623040356023, 1.02203182374541, 1.00326264274062, 1.0183696900114811, 1.0, 1.0794369029663147, 1.038136284216657, 1.1056947265478072, 1.1282051282051282, 1.1490514905149052, 1.105263157894737, 1.1428571428571428, 1.1043360433604337, 1.25, 1.0481522036682178, 1.0833333333333333, 1.0471014492753623, 1.0392828338432782, 1.153387773118517, 1.070008488585087, 1.0210896309314588, 1.0729166666666667, 1.1602967263344621, 1.0314685314685315, 1.0823529411764705, 1.0325542570951587, 1.0368130423349986, 1.1059875426964034, 1.0254512096258053, 1.0124223602484472, 2.142857142857143, 1.0168286345689743, 1.0290578701808955, 1.036101083032491, 2.0436363636363635, 1.1732954545454546, 1.6666666666666667, 1.0997506234413965, 1.00909220769945, 1.1851851851851851, 1.0249221183800623, 1.0914909986151715, 1.0041562058271272, 1.004799242185968, 1.052685950413223, 1.002115309765962, 1.0380961749248194, 1.0716783216783217, 1.0036847028145461, 1.090980187695516, 1.0005232138786218, 1.1754569190600521, 1.1091898534187659, 1.0526315789473684, 1.1232876712328768, 1.0707070707070707, 2.0, 1.0604395604395604, 1.0174758557256423, 1.6696165191740413, 1.1226415094339623, 1.0139687756778966, 1.5238095238095237, 1.0008895723501605, 1.0573394495412844, 1.0075918859208677, 1.25, 1.0260545905707197, 1.0436879432624113, 1.0103023056390932, 1.046002835859645, 1.0, 1.115009746588694, 1.015920479750267, 1.027131391651103, 1.0108991825613078, 1.2672, 1.138702460850112, 1.0873892704289838, 1.0341880341880343, 1.0034276639492183, 1.021335760655377, 1.113879003558719, 1.1491901108269396, 1.005599104143337, 1.6666666666666667, 1.1742323097463285, 1.0, 1.023228346456693, 1.0934683638390783, 1.025690930323083, 1.1755485893416928, 1.0769230769230769, 2.0, 1.0797582904328185, 1.1538461538461537, 1.087862819878308, 1.75, 1.014, 1.0030272452068618, 1.125, 1.0099172902717606, 1.090293453724605, 1.1415571284125379, 1.1625, 1.0174812700677844, 1.013267484882565, 1.056338028169014, 2.0, 1.0091022742841484, 1.169631584987949, 1.057909604519774, 1.0311708377499507, 1.0922415436426407, 1.0607766793556137, 1.0843853820598006, 1.0361585571825112, 1.0528151469855507, 1.0854359230577066, 1.2470033154807447, 2.0, 1.0570229053525981, 1.1734513274336282, 1.2941176470588236, 1.1153846153846154, 1.0121004866500065, 1.1555555555555554, 1.0067724740560167, 1.0087050762131171, 1.1861575178997614, 1.255813953488372, 1.0110289792557154, 1.0062630480167014, 1.0564801041279286, 1.005366931918656, 1.8, 1.0232315322370138, 1.0602706027060271, 1.0043229283629014, 1.0857598607888632, 1.0081119828250737, 1.1049840933191941, 1.0220588235294117, 1.027331189710611, 1.003877551020408, 1.0514515121101369, 1.1103225148286868, 1.0878048780487806, 1.1578947368421053, 1.0666666666666667, 1.069004342930674, 1.4166666666666667, 1.0402930402930404, 1.0115530175242746, 1.0152248437184916, 1.025, 1.3728813559322033, 1.2142857142857142, 1.07568688439606, 1.0165773315214657, 1.0416666666666667, 1.049218368343918, 1.0026606986627695, 1.0320987654320988, 2.0, 2.75, 1.0935822637106185, 1.7142857142857142, 1.0269374697423685, 1.0727554179566563, 1.3, 1.0445327275106158, 1.1111111111111112, 1.6666666666666667, 1.0352855424760377, 2.0, 1.125, 1.06479217603912, 1.016474464579901, 1.0725146198830409, 1.1995661605206074, 1.0336134453781514, 1.0098183049317233, 1.0008916629514044, 1.014621409921671, 1.0283042726876765, 1.1011954228728504, 3.0, 1.3333333333333333, 1.0386269914261133, 1.25, 1.049703602371181, 1.1, 2.0, 1.125, 1.18562874251497, 1.1152296535052377, 1.125925925925926, 1.180115273775216, 1.25, 2.25, 1.0834580761580577, 1.0, 1.1166666666666667, 1.0391381384887977, 1.189964157706093, 1.0500397140587767, 1.0056022408963585, 1.8, 1.25, 1.1519434628975265, 1.4267515923566878, 1.0148957298907646, 1.0247089520176882, 1.091749907510174, 1.0120192307692308, 1.5, 1.0088401292560731, 1.3103448275862069, 1.2058823529411764, 5.0, 1.1047083626141954, 1.1111111111111112, 1.0, 1.056, 1.0182917803294635, 1.0097527322900404, 1.1077774541217593, 1.0730030554343082, 1.0355344152210408, 1.0222222222222221, 1.0281879194630872, 1.0355402150619204, 1.1047765793528506, 1.1111111111111112, 1.0145387524534444, 1.027042413891261, 1.0203503348789285, 1.066350710900474, 1.2, 1.125, 2.0, 1.8518518518518519, 1.2568807339449541, 1.0690978886756237, 1.5303030303030303, 1.1969026548672566, 1.0568527918781725, 1.078448275862069, 1.2402234636871508, 1.111324376199616, 1.0557553956834533, 1.52, 1.083969465648855, 1.064516129032258, 1.0, 1.0068787224793905, 1.3728813559322033, 1.0059762463121265, 1.0411919866799677, 1.0266138613861386, 1.022672064777328, 1.7142857142857142, 1.1488409922732818, 1.1666666666666667, 1.1176875430144528, 1.0, 1.0423162095200509, 1.0341047503045067, 1.0625727329692956, 1.1563517915309447, 1.16328125, 3.0, 1.057997399219766, 1.0066893266448491, 1.0064411003546438, 2.0, 1.25, 1.0039463299131808, 1.2523364485981308, 1.084754347459058, 1.0804669994889737, 1.1666666666666667, 1.0327402135231316, 1.056774520702904, 1.0716608323609491, 1.0187496608237911, 1.0743718832764668, 2.0, 1.0714285714285714, 1.2212534059945503, 1.0912210528616548, 1.196969696969697, 1.1483695652173913, 2.0, 1.5, 1.2194148936170213, 1.1264822134387351, 1.2366283006093433, 1.0125001808475238, 1.142690058479532, 1.0, 1.0952380952380953, 1.2903225806451613, 1.0020754619622863, 1.04, 1.0, 1.133241138802874, 1.0, 2.0, 1.1056179775280899, 2.3333333333333335, 1.1925708699902249, 1.0120572720422005, 1.3405797101449275, 1.1, 1.0249560004399956, 1.004676539360873, 1.0714285714285714, 1.1053425992893304, 1.0225563909774436, 1.0236486486486487, 1.1906666666666668, 1.0306193458594293, 1.0552979974191081, 1.0, 1.0561797752808988, 1.3122319787625076, 1.0071406867213613, 1.0997749437359339, 1.0, 1.006845513413506, 1.0095886438641792, 1.0283595113438044, 2.0, 1.13107752956636, 1.0985535140867893, 1.182105476791047, 1.1989045097681212, 1.0361992647610474, 1.0280031046067546, 1.0148936170212766, 1.0515427769985974, 2.0, 1.112736846648539, 1.11096256684492, 1.0537170263788969, 1.0251396648044693, 1.0933333333333333, 1.0374523605397579, 1.1136363636363635, 1.102289565508341, 1.2360717658168083, 1.0554863582443654, 1.1202082347373403, 1.013335020242915, 1.203681351840676, 1.0481927710843373, 1.0777777777777777, 1.0271347801835606, 1.1030042918454936, 1.0187051910948197, 1.00484092432131, 1.3333333333333333, 1.0916319575918212, 1.1331360946745561, 1.3333333333333333, 1.3658536585365855, 1.005985696517413, 1.1554770318021201, 1.0383111806098515, 1.0, 1.0, 1.0269694819020583, 1.0335331650539896, 1.0373849693251533, 1.0165245271752534, 1.0291997116077867, 1.1383647798742138, 1.0770059235325795, 1.1227443949138882, 1.2127659574468086, 1.0262833005924419, 1.0459770114942528, 1.1111111111111112, 1.0068373118079712, 1.1745894554883318, 1.083196550285158, 1.0, 1.1088254810882547, 1.5921052631578947, 1.04490595385546, 1.0314465408805031, 1.1703470031545742, 1.0549273021001615, 1.191869918699187, 1.0013079278261645, 1.0, 1.9454545454545455, 1.7142857142857142, 1.3333333333333333, 1.11, 1.3157894736842106, 1.3449477351916377, 1.079646017699115, 1.0332261521972133, 1.0952380952380953, 1.0179800634086429, 1.0160911971686077, 1.0099320948110186, 1.0066677101267805, 1.0286699877370749, 1.0906637884511603, 1.0343146625884152, 1.0112793077838091, 1.0378937007874016, 1.0391498881431767, 1.0823529411764705, 1.185897435897436, 1.025451625853071, 1.2781289506953224, 1.0097828680505845, 1.1069767441860465, 1.2137649460484106, 1.01640838650866, 2.5, 1.0636792452830188, 1.2941176470588236, 1.1428571428571428, 1.0147058823529411, 1.0123749420508756, 1.0285163776493256, 1.0145985401459854, 1.084848484848485, 1.0261557101637542, 1.1877909984480082, 1.0377358490566038, 1.6, 2.0, 1.0152173913043478, 1.2260869565217392, 1.0072609923356193, 1.0581973030518097, 1.0, 1.2365393465255408, 1.1119221411192215, 1.0213883379611266, 1.1708029197080292, 1.0420948347870005, 1.0516012221342084, 1.0054420231397663, 1.144578313253012, 2.5, 1.0173779351472232, 2.0, 1.085, 1.2362869198312236, 1.0961098398169336, 1.7431192660550459, 1.1724137931034482, 1.0404803303629646, 1.1532846715328466, 1.2100840336134453, 1.1755555555555555, 1.05359477124183, 1.0484554815263476, 1.1501132319637657, 1.0, 1.011482939632546, 1.2, 1.0375262802967193, 1.125967091642149, 1.1363636363636365, 1.0191912268677177, 1.0693350653568239, 1.172192513368984, 1.0732214734747412, 1.0909090909090908, 1.1604166666666667, 1.0402874784897256, 1.0166270783847982, 1.1666666666666667, 1.031502517859234, 1.3142857142857143, 2.4285714285714284, 1.0622605363984674, 1.02, 1.004419748173834, 1.0818515382444256, 1.0713125312415888, 1.0040198805394562, 1.0287009063444108, 1.0399613277473412, 1.139240506329114, 1.0204451657778808, 1.0884065643197458, 1.0606776989755713, 1.2192676547515258, 1.0199606835021926, 1.18, 1.0770044052863437, 1.1428571428571428, 1.3333333333333333, 1.0188442211055277, 1.0188403146149625, 1.0295566502463054, 1.0249376558603491, 1.4444444444444444, 1.0450522928399035, 1.1023484051875219, 1.5754716981132075, 1.0005898046100774, 2.0, 1.051968503937008, 1.5, 1.447887323943662, 1.0588235294117647, 1.150548587060912, 1.4242424242424243, 1.2599118942731278, 1.12784588441331, 2.0, 1.0174863387978141, 1.0415704387990763, 1.5, 1.75, 1.0748299319727892, 1.0516717325227964, 1.0672435105067986, 1.0124444444444445, 1.0542740841248304, 1.0274809160305343, 1.0941828254847645, 1.1491053677932406, 1.5181347150259068, 1.1123595505617978, 1.2, 1.5, 1.1009174311926606, 1.17827626918536, 1.0844811753902663, 1.1298751950078003, 1.005929375850024, 1.255411068388992, 1.0146364931628518, 1.0006921873119057, 1.0352250489236792, 1.0204081632653061, 1.4545454545454546, 1.5, 1.0263157894736843, 1.0278511919063358, 1.1295379537953796, 1.005420054200542, 1.0459518599562363, 1.0949314631813836, 1.0009267633626995, 1.0002921050358908, 1.0526315789473684, 1.2173913043478262, 1.197674418604651, 1.1475057813016187, 1.0300926838887794, 1.0979910025140034, 1.201086956521739, 1.0345505963359154, 1.0806234647327173, 1.0104419402958251, 1.03672532517215, 1.006643263070069, 1.070063694267516, 1.044876886417792, 1.2394736842105263, 1.0029849340311916, 2.0, 1.0435621725944306, 1.0, 1.1153846153846154, 1.0593847601933855, 1.2413793103448276, 1.0033214441984115, 1.1603942652329748, 1.0588235294117647, 1.0612046926629144, 1.0139715161348477, 1.142122905027933, 1.0198570293884035, 1.044007490636704, 1.014291095729152, 1.1364421416234887, 1.0588235294117647, 1.0, 1.0, 1.0127717281301867, 2.1666666666666665, 1.039367730390695, 1.0604999775593555, 1.2400147928994083, 1.0935799782372144, 1.0011605234834422, 1.1548854688618468, 1.064724919093851, 1.0319148936170213, 1.007278903311901, 1.0077537502435223, 1.0044076276333878, 1.028110693894347, 1.1111111111111112, 1.0169779286926994, 1.2905405405405406, 1.0282191131135878, 1.0340909090909092, 1.0246376811594202, 1.1547445255474453, 1.0385852090032155, 1.0412697608431294, 1.0439814814814814, 1.0148492665000148, 1.411764705882353, 1.0374707719155487, 1.0127423918294114, 1.1391597899474868, 1.001054852320675, 1.119047619047619, 1.0025575447570332, 1.0290977718937495, 1.0834613329771605, 1.0485436893203883, 1.004575206806727, 1.1578947368421053, 1.0523540769345017, 1.207070707070707, 1.1435832274459974, 1.087281795511222, 1.089430894308943, 1.1000935453695042, 1.0824455766558592, 1.0560588502435129, 1.034351145038168, 1.0882709339415864, 1.0625882148570105, 1.2142857142857142, 1.049792531120332, 1.0642026722193303, 1.083389093342255, 1.0816901408450703, 1.283097854526426, 1.288, 1.421875, 1.020278833967047, 1.010382543182834, 1.1403508771929824, 1.045050385299348, 1.0095012657395535, 1.0256357246227, 1.4689863842662632, 1.0203506574827803, 1.080102541907346, 1.0403973509933775, 1.0818363273453093, 1.0010678933749537, 1.0867568675686756, 1.0352564102564104, 1.2863436123348018, 1.0519951632406288, 1.0308439400909881, 1.1195652173913044, 2.5, 1.0363865388566784, 1.00459860880471, 1.0076701821668264, 1.2275449101796407, 1.0116941529235381, 1.0153922191626068, 1.0007029053420806, 1.0184672206832872, 1.3448275862068966, 1.1142857142857143, 1.10828025477707, 1.12565445026178, 1.5625, 1.0372608914302743, 1.0066390041493776, 1.1225806451612903, 1.0714285714285714, 1.0178571428571428, 1.0980290456431536, 1.0736842105263158, 2.4, 1.0141104294478527, 1.162162162162162, 1.035304906006419, 1.3, 1.01281719450455, 1.0207373271889402, 1.1619188390217683, 1.1140350877192982, 1.2307692307692308, 1.0698816055443257, 1.0883294051539794, 1.0049759825906956, 1.0221870047543582, 1.8571428571428572, 1.105263157894737, 1.0810810810810811, 1.2696629213483146, 1.435483870967742, 1.0567833026396563, 1.0066928114872165, 1.0066000852225896, 1.00625, 1.0117340587394532, 1.001125468945394, 6.0, 1.0065469796941333, 1.0222758492667532, 1.3333333333333333, 1.5714285714285714, 1.0705765407554673, 1.1365351218635846, 1.0894499746417525, 1.0447368421052632, 1.0, 1.0397350993377483, 1.3736842105263158, 1.1666666666666667, 1.0150887006273877, 1.061461428414218, 1.008533704051796, 1.1592664092664093, 1.2, 1.0013331272460295, 1.0828981723237598, 1.0467205750224617, 1.2433628318584071, 1.0849825378346916, 1.0, 1.0512820512820513, 1.0473088626854317, 1.1073205655987113, 1.1564245810055866, 1.0328947368421053, 1.0162145414486368, 1.2020057306590257, 1.104026845637584, 1.1884057971014492, 1.0508462400505734, 1.2994305390014567, 1.0757770523337002, 1.6890756302521008, 1.3020833333333333, 1.1305841924398625, 1.2, 1.0338135842399294, 1.0145278450363195, 1.0051006751330933, 1.058983666061706, 1.5, 1.1092870544090057, 1.0403813330002913, 1.1941783345615329, 1.29384040305542, 1.0581743469327853, 1.0138773244518458, 1.0791987673343606, 1.098814229249012, 1.0161290322580645, 1.0047462096242583, 1.0111646329335051, 1.0968858131487889, 1.0989660265878878, 3.5, 1.101123595505618, 1.0844111768920397, 1.2782608695652173, 1.0208855472013367, 1.0132811986593941, 1.1354415274463008, 2.0, 1.087719298245614, 1.0913335804967985, 1.0476099426386234, 1.046204620462046, 1.0015784927875786, 1.2012987012987013, 1.1067073170731707, 1.077144226161955, 1.0028281383089976, 1.0180566729239295, 1.0934761441090555, 1.118279569892473, 1.0833333333333333, 1.0319103369503142, 1.0336972318923852, 1.060572632622707, 1.0299264338261553, 1.0451201569396764, 1.0456047587574355, 1.2857142857142858, 1.0761061946902655, 2.5, 1.5, 1.2, 1.0332640332640333, 1.1624668435013263, 1.0228382922032608, 1.0304998256208815, 1.0887533875338753, 1.0116658088866015, 1.146788990825688, 1.099702380952381, 1.0107657764121958, 1.5, 1.3076923076923077, 1.1656788793103448, 1.125, 1.185234899328859, 1.1161369193154034, 1.016260783265898, 1.0131396536216888, 1.1666666666666667, 1.1904616325282789, 1.0693311582381728, 1.0642973825171902, 1.0013698210814699, 1.1180637544273908, 1.0621417797888386, 1.0256431618235138, 1.0499008592200925, 1.0816864295125164, 1.6938775510204083, 1.2388059701492538, 1.3333333333333333, 2.0, 1.0003240199328125, 1.5, 1.75, 1.375, 1.0132113821138211, 1.0005831613217204, 1.1030534351145038, 1.0642570281124497, 1.1428571428571428, 1.0894977797666174, 1.0104270109235352, 1.1428571428571428, 1.001984126984127]
origin-bjaq_15.87 	max: 6.0000	99th: 2.5000	95th: 1.8343	median: 1.0735	mean: 1.1733

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 20.293838 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=38.872076