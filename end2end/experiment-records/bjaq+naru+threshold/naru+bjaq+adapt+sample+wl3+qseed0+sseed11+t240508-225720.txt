Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='naru', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 11, 'naru': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.5717	median: 1.0556	mean: 1.1473
ReportEsts: [1.075085324232082, 1.0440456769983686, 1.0286313784431316, 1.0115384615384615, 1.0, 1.0, 1.1363503649635036, 1.0125692189969075, 1.25, 1.0428380187416333, 1.1002799180446137, 1.0025659808158258, 1.01104033970276, 1.0488372093023255, 1.020840692334864, 1.0, 1.4754098360655739, 1.030818278427205, 3.0, 2.6666666666666665, 1.2857142857142858, 1.1468190640500324, 1.028003127748998, 1.127814569536424, 1.072520966946226, 1.0, 1.0735688430084462, 1.2, 1.4, 1.2014388489208634, 1.0, 1.0003805158949945, 1.0033493676492298, 1.3274139844617092, 1.0790130709355266, 1.0193284137837655, 1.0401069518716577, 1.013356233483103, 1.056202217783594, 1.2261904761904763, 1.0641200545702592, 1.0396341463414633, 1.0, 1.1494941086065573, 1.05090236001851, 1.2148760330578512, 1.087378640776699, 1.3101851851851851, 1.0397466898895784, 1.0285714285714285, 1.1122473561224735, 1.3990384615384615, 1.004296551724138, 2.0, 1.2675324675324675, 1.066326530612245, 1.1035313001605136, 1.0606060606060606, 1.2919254658385093, 1.25, 1.0382815339876408, 1.037359900373599, 1.0545454545454545, 1.1264367816091954, 1.0, 1.1561385898722785, 1.06478578892372, 1.1666666666666667, 1.0, 1.0888144539179863, 1.026252983293556, 1.059061957151129, 1.1373873873873874, 1.1064865120234326, 1.2470588235294118, 1.1297071129707112, 1.0, 1.0490582566798072, 2.0, 1.013874142730064, 1.0625, 1.0579642939948992, 1.2453987730061349, 1.021788990825688, 1.0788777130757015, 1.04, 1.0019974292903997, 1.0200383840551204, 1.1372549019607843, 2.3333333333333335, 1.1265060240963856, 1.007623036156484, 1.02803738317757, 1.3001402524544179, 1.2275784753363228, 1.0405405405405406, 1.2162162162162162, 1.0155979202772965, 1.0, 1.035479996304167, 1.2018718502519798, 1.0051724137931035, 1.008003130113111, 1.088235294117647, 1.0014129093975783, 1.1211309523809523, 1.0650026228361602, 1.0583996966249527, 1.0117866004962779, 1.1666666666666667, 1.3333333333333333, 1.1459170013386881, 1.0255721016751669, 1.0993055555555555, 1.1159420289855073, 1.00187638427875, 1.0, 1.1114616193480547, 1.1712918660287082, 1.0, 1.2582417582417582, 1.1666666666666667, 1.0651629072681705, 1.0150155461307997, 1.0629028500427118, 1.0566037735849056, 1.8, 1.218543046357616, 1.0, 1.0714285714285714, 1.009835294598767, 1.1818181818181819, 1.0192435301924354, 1.011022000037682, 1.0948848775886464, 1.1212574850299402, 1.0054794520547945, 1.0272217774219377, 1.00199203187251, 1.0505761843790014, 1.0486824983734548, 1.2407407407407407, 1.071754729288976, 1.1069633980412497, 2.0, 1.0157407407407408, 1.0580411124546554, 1.031637717121588, 1.0051173460384684, 1.0, 1.0071445870670865, 1.005925925925926, 1.012, 1.4476190476190476, 1.1996497373029773, 1.1075429424943988, 1.0233654992952401, 1.0823789340788168, 1.1577946768060836, 1.1611842105263157, 1.0, 1.3985507246376812, 1.1260364842454396, 1.2857142857142858, 1.0023202064400314, 1.026786327002112, 1.0184225676453655, 1.0164755407170851, 1.0384850335980451, 1.085871034427924, 1.0084210526315789, 1.0735294117647058, 1.1707175365546625, 1.0703463203463204, 1.1486620416253717, 1.0564681724845997, 1.0549520766773164, 1.0193105082336216, 1.1228544183089637, 1.0, 1.3125, 1.047450110864745, 1.0476190476190477, 1.1161672216056233, 1.3333333333333333, 1.035081370231727, 1.0278685373822793, 1.0412310888903318, 1.1372549019607843, 1.019090909090909, 1.016547216329339, 1.0, 1.3636363636363635, 1.0497754808099635, 1.2133938706015892, 1.1004566210045663, 1.2962962962962963, 1.022508038585209, 1.0004318033444197, 1.025697496919427, 1.1798245614035088, 1.100558659217877, 1.0621468926553672, 1.1875, 1.0476190476190477, 1.0, 1.019108280254777, 1.0368238448194291, 1.7735191637630663, 1.1264367816091954, 1.0177953534354918, 1.0957683741648108, 1.1082230534090263, 1.0384327283203687, 1.0148299499077247, 1.0602409638554218, 1.086342229199372, 1.052165018752131, 1.0173413782524214, 1.0491089680382868, 1.0, 1.0538302277432712, 1.014633762038879, 1.0019573174514549, 1.064168086314594, 1.0087271962567688, 1.0000845880561664, 1.0344827586206897, 1.0008354779129258, 1.0546641283655154, 1.1590524534686972, 1.0260416666666667, 1.1184401576436425, 1.0027152831652444, 1.125984251968504, 1.0, 1.0014177693761814, 1.0682224207235373, 1.071026722925457, 1.3656716417910448, 1.0909090909090908, 2.6666666666666665, 1.0697666238722499, 1.1272727272727272, 1.0919854280510017, 2.0, 1.5, 1.1764705882352942, 1.0273224043715847, 1.6224489795918366, 1.1187845303867403, 1.1152941176470588, 1.072289156626506, 1.0192554557124518, 1.0800284322538833, 1.0526315789473684, 1.0, 1.0612650162027693, 1.144092219020173, 1.0595446584938704, 1.00526788887263, 1.0357088433991974, 1.0352837300913507, 1.088235294117647, 1.0281499216590673, 1.061602870813397, 1.0769345906301453, 1.167790047325398, 1.6363636363636365, 1.1019844320584278, 1.0021321961620469, 1.25, 1.0869565217391304, 1.1069090909090908, 1.0555555555555556, 1.1584158415841583, 1.0105107327905256, 1.0668523676880224, 1.180473372781065, 1.0142118252778007, 1.100646352723915, 1.010800253730845, 1.0091021529268775, 1.5, 1.06447799199709, 1.2, 1.0002059172738305, 1.0, 1.0107869464293842, 1.275, 1.4285714285714286, 1.0, 1.6056338028169015, 1.007184866492451, 1.0, 1.010703363914373, 1.011441647597254, 1.0352564102564104, 1.0002411017478425, 1.1524390243902438, 1.0251572327044025, 1.010125158205597, 1.0705596107055961, 1.0921558350803633, 1.1367521367521367, 1.0, 1.2350835322195703, 1.0074441687344913, 1.1370716510903427, 1.030113685672134, 1.0385448245993936, 1.0441176470588236, 1.0169491525423728, 1.010973936899863, 1.0692413793103448, 1.4285714285714286, 1.0188579265631819, 1.0531135531135531, 1.0555555555555556, 1.0150124293471467, 1.1904761904761905, 1.75, 1.0327239871146845, 2.0, 1.023876404494382, 1.068313953488372, 1.0467596390484004, 1.0252035672741373, 1.2428198433420365, 1.2527472527472527, 1.0076435016707477, 1.027279439805912, 1.0208623087621698, 1.0082079455536879, 1.080183362140227, 2.0, 1.2222222222222223, 1.020058976421087, 1.3333333333333333, 1.0492610837438423, 1.0, 1.0, 1.0454545454545454, 1.1745283018867925, 1.0926640926640927, 1.131578947368421, 1.0216450216450217, 1.0, 1.0632490013315579, 1.0080094374767168, 1.5, 1.0726622989874925, 1.0, 1.0114780232293328, 1.141025641025641, 1.0251639989504067, 1.1589861751152073, 1.0018181818181817, 1.1894630192502533, 1.1388888888888888, 1.00637194553255, 1.0045613584566495, 1.0346205059920106, 1.0, 1.1428571428571428, 1.8333333333333333, 1.5, 1.3333333333333333, 1.0023079395692702, 1.25, 1.221297836938436, 1.0297029702970297, 1.058127454706702, 1.0029646342743206, 1.0093555093555093, 1.069392622679828, 1.0329538645895746, 1.2556053811659194, 1.5, 1.0256410256410255, 1.0444444444444445, 1.0048624002858408, 1.2380952380952381, 3.142857142857143, 1.0824053452115814, 1.0220930232558139, 1.0100805828609491, 1.1412587412587412, 1.342769701606733, 1.048780487804878, 1.3793103448275863, 1.0808477237048666, 1.0826271186440677, 1.2884615384615385, 1.0568862275449102, 1.1826923076923077, 1.0327169492825903, 1.0010459510255223, 1.0211825052615435, 1.2112676056338028, 1.0277777777777777, 1.0718562874251496, 1.0, 1.03656637701542, 1.0330169106007592, 1.0473930291867384, 1.0024300468141372, 1.0443679479824057, 1.0132002575660013, 1.8333333333333333, 1.0033767486734202, 1.2, 1.099060631938514, 1.1111111111111112, 1.0153740918694387, 1.0420289855072464, 1.0530954428202923, 1.1304347826086956, 1.181042654028436, 3.0, 1.1055699481865284, 1.0005519516951287, 1.042026853043958, 1.0, 1.3404255319148937, 1.053742802303263, 1.2557471264367817, 1.0855777408772427, 1.1452380952380952, 1.1666666666666667, 1.0258843830888698, 1.0672400495477599, 1.0315404426859767, 1.000281623205752, 1.1, 1.2487562189054726, 1.0151515151515151, 1.25, 1.0482233502538072, 1.3, 1.0422919508867667, 1.064516129032258, 1.0166548318378412, 1.16, 1.1185672605375876, 1.104847437674445, 1.1367461430575034, 1.0, 1.0961538461538463, 1.32, 1.0004282155091873, 1.4923413566739605, 1.0, 1.1921801602652666, 1.0171512548314445, 1.2418939783839424, 1.0, 2.0, 1.1774757281553399, 1.012704174228675, 1.4055299539170507, 1.0, 1.03201068672076, 1.0231884057971015, 1.0869565217391304, 1.107005649717514, 1.018181818181818, 1.036734693877551, 1.2024193548387097, 1.0782498948254102, 1.1366167269387522, 1.0, 1.0675675675675675, 1.098358292335694, 1.0107512332410657, 1.0502378703159974, 1.0, 1.0662735849056604, 1.0117530204731107, 1.0277632268203247, 2.0, 1.13755980861244, 1.0529165293536087, 1.0231948670060547, 1.0965008081778864, 1.0257852434009225, 1.165056582942313, 1.011764705882353, 1.0146771037181996, 2.0, 1.0725618895033335, 1.1044776119402986, 1.0, 1.321917808219178, 1.1304347826086956, 1.026577447675115, 1.0773152081563298, 1.0351606552363477, 1.2430119794637764, 1.0739148807727135, 1.0277289327742458, 1.0122808234219864, 1.1359223300970873, 4.0, 1.032764374024727, 1.0034531789559211, 1.0036718106118736, 1.0052560401300583, 1.0503597122302157, 1.2518043303929431, 1.0609137055837563, 1.4285714285714286, 1.01813224267212, 1.0231078626898265, 1.0043998886104148, 1.0995311936530834, 1.0444589899803636, 1.0363247863247864, 1.0067156738157148, 1.0161812297734627, 1.0709413369713505, 2.0, 1.0833333333333333, 1.063621533442088, 1.036697247706422, 1.0016778523489933, 1.0380499405469679, 1.1062906724511932, 1.228395061728395, 1.0554699537750385, 1.120879120879121, 1.00148247227331, 1.3780487804878048, 1.0437137392925446, 1.0, 1.0724191063174113, 1.4642857142857142, 1.0071428571428571, 1.0464776381175096, 1.1643312101910828, 1.08300395256917, 1.0843881856540085, 1.064910239361702, 1.0, 1.6170212765957446, 1.3333333333333333, 1.0, 1.035294117647059, 1.0486257928118394, 1.2908366533864541, 1.1318681318681318, 1.0277154758090357, 1.1570469798657719, 1.1323524373950875, 1.002760796687044, 1.1116625310173698, 1.0062532924901957, 1.0632183908045978, 1.0743801652892562, 1.1306240928882438, 1.069102462271644, 1.153179190751445, 1.0343191964285714, 1.0200568622383044, 1.0163197803226511, 1.0110708510864306, 2.0, 1.1059782608695652, 1.0397412199630314, 1.034013605442177, 1.0, 1.0851063829787233, 1.25, 1.0235507246376812, 1.5555555555555556, 1.5, 1.03177947611864, 1.023760440732184, 1.0063633306603896, 1.0338665626219274, 1.0756756756756756, 1.0279465370595382, 2.0, 1.203125, 1.1975716527628644, 1.000079687624512, 1.0093702754489082, 1.043911607244561, 1.0032540675844805, 1.0606060606060606, 1.018471108076843, 1.1456483126110124, 1.0094288853510325, 1.033349648901523, 1.3636363636363635, 1.1241610738255035, 1.0, 1.0090702947845804, 1.021505376344086, 3.0, 1.0797145769622833, 1.0262591762957707, 1.2857142857142858, 1.2119095433510871, 1.0, 1.1875, 1.0255594900849858, 1.7692307692307692, 1.0256638023760318, 1.0401537804357113, 1.2258064516129032, 1.16, 1.307277628032345, 1.0106331561140647, 1.0623827392120075, 1.0456750456750457, 1.0110992529348986, 1.0, 1.217358244623072, 1.0154798761609907, 2.0, 1.096824042253846, 1.0283807829181495, 1.1296121097445602, 1.0074090704984284, 1.0202413974061024, 1.2840909090909092, 2.142857142857143, 1.0642829973373906, 1.0517387616624259, 1.0557242970831282, 1.0653769179452968, 1.0492769827501744, 1.069142201766537, 1.0476190476190477, 1.0011173184357542, 1.16796875, 1.0004898140932874, 1.0933753943217666, 1.036619718309859, 1.0210084033613445, 1.0570569517614987, 4.0, 1.0009578167027489, 1.0132205445273903, 1.016369460758142, 1.0555555555555556, 1.0443799854967368, 1.1782608695652175, 1.0, 1.0014107356986668, 1.0134426229508198, 1.1211750305997552, 1.1764705882352942, 1.6666666666666667, 1.0511984370398568, 1.0, 1.3630573248407643, 1.1538461538461537, 1.0613355662549717, 1.3333333333333333, 1.281081081081081, 1.1027253668763102, 1.0, 1.183862433862434, 1.0647632311977715, 2.0, 1.0, 1.0901639344262295, 1.0740740740740742, 1.0237812128418549, 1.0042149631190727, 1.024, 1.0119402985074626, 1.089150378938971, 1.0493506493506493, 1.6896551724137931, 1.3687150837988826, 1.3461538461538463, 1.0, 1.047418335089568, 1.1948051948051948, 1.0533188248095757, 1.3020369620936194, 1.0136474958885957, 1.2020879940343028, 1.0366480894079981, 1.0644093882262409, 1.0830324909747293, 1.0137231503579953, 1.375, 1.0, 1.0303030303030303, 1.0112350927816063, 1.1632443531827514, 1.0065359477124183, 1.45, 1.0217640320733103, 1.0489167040862146, 1.0061745814596919, 1.0512820512820513, 1.1578947368421053, 1.0599555884529979, 1.1454798515376459, 1.0227041415485791, 1.0211769469564043, 1.1776315789473684, 1.0313792085056113, 1.0200085076762442, 1.14014598540146, 1.0255874673629244, 1.0, 1.0183908045977013, 1.1577574967405475, 1.0, 1.098802395209581, 1.0347890451517394, 1.0, 1.1116751269035532, 1.0404859662112136, 1.2962962962962963, 1.0065705654692747, 1.1843220338983051, 1.162162162162162, 1.010244547257105, 1.0065312046444121, 1.0718170829975826, 1.0096339113680155, 1.035252643948296, 1.0044522091974752, 1.1451942740286298, 1.0714285714285714, 1.0, 1.1111111111111112, 1.0147511202615962, 1.8333333333333333, 1.037636584378794, 1.054924344407948, 1.1869738591050067, 1.0788515106063852, 1.0034612904449418, 1.1096463022508039, 1.0488721804511278, 1.0069348127600555, 1.0130650198417357, 1.023088542041286, 1.0025932938666922, 1.0483585858585858, 1.25, 1.046875, 1.33201581027668, 1.0521919906630681, 1.0358306188925082, 1.0018975332068312, 1.1398230088495576, 1.0116959064327486, 1.0548723164886649, 1.0247592847317744, 1.0165550239234449, 1.3125, 1.021791824535806, 1.0055041467331027, 1.0996965756393584, 1.0008428150021071, 1.09375, 1.0043010752688173, 1.099502487562189, 1.5625, 1.0309238903575901, 1.3846153846153846, 1.157258064516129, 1.0307692307692307, 1.171948752528658, 1.0666307471264367, 1.0776470588235294, 1.0, 1.0926829268292684, 1.014449060627229, 1.0117766097979144, 1.0149058511310503, 1.0334620768750737, 1.0673626690177114, 1.1538461538461537, 1.0584795321637428, 1.0003907013088493, 1.089713826510112, 1.0091001011122345, 1.2013888888888888, 1.001806684733514, 1.0268145993008664, 1.16893039049236, 1.028496061155275, 1.0, 1.3333333333333333, 1.0072881900665036, 1.0180489901160292, 1.0264942438101246, 1.1012797746616865, 1.083000798084597, 1.056338028169014, 1.005411479433421, 1.112968744754423, 1.0708661417322836, 1.3405405405405406, 1.003501400560224, 1.0017179600451578, 1.0119047619047619, 1.75, 1.0128701880785824, 1.0013031664171241, 1.031927023945268, 1.2394366197183098, 1.0485155684286749, 1.0159510482216736, 1.0042348955392433, 1.0810810810810811, 1.3846153846153846, 1.0862533692722371, 1.0, 1.096875, 1.7916666666666667, 1.0198122695273215, 1.0079286422200198, 1.0855085508550855, 1.3225806451612903, 1.0073293877687497, 1.0898053171446516, 1.0196212250469203, 1.009110714993068, 1.6666666666666667, 1.037037037037037, 1.3333333333333333, 1.043620501635769, 1.4230769230769231, 1.3333333333333333, 1.3636363636363635, 1.3222416812609457, 1.0514285714285714, 1.0927664377763147, 1.0207920148258933, 1.0036363636363637, 1.411764705882353, 1.0, 1.0333333333333334, 1.2567567567567568, 1.4583333333333333, 1.0218068535825544, 1.005656376002107, 1.0025220211879537, 1.0390625, 1.013595672363445, 1.001821730644112, 5.0, 1.0050270490966622, 1.0542857142857143, 1.0, 1.3333333333333333, 1.0494082840236687, 1.143584594420139, 1.0414210344540118, 1.0217391304347827, 1.0, 1.0661157024793388, 1.0460122699386503, 2.0, 1.5, 1.1195866141732282, 1.0064943850629144, 1.131805968038467, 1.25, 1.0010864236787365, 1.0681642137877614, 1.002055498458376, 1.1428571428571428, 1.1899441340782122, 1.0033714059065149, 1.3157894736842106, 1.0892962743938497, 1.067007429174513, 1.0705882352941176, 1.01171875, 1.0905371900826446, 1.1776259607173356, 1.1487603305785123, 1.2105263157894737, 1.0618489356513257, 1.0041585127201567, 1.0674512150526911, 1.7578947368421052, 1.2289156626506024, 1.1940298507462686, 1.0469973890339426, 1.0449784349969193, 1.0326321105739995, 1.0239279555470397, 1.0283842794759825, 3.0, 1.25, 1.0106602920273937, 1.1613896218117854, 1.371717564676133, 1.0148147686865983, 1.0047050915812468, 1.132010502302759, 1.0525059665871122, 1.0416666666666667, 1.0234934427548474, 1.0003596863534998, 1.0748379493223335, 1.203152364273205, 2.5, 1.0533333333333332, 1.1059099746872592, 1.082915173237754, 1.010753196789808, 1.0091316580039102, 1.0838068181818181, 1.6, 1.0214797136038185, 1.0597798139404422, 1.0408955905871602, 1.0342205323193916, 1.0273148810375243, 1.2170542635658914, 1.2513812154696133, 1.1246376811594203, 1.0029116425667586, 1.0403292901869772, 1.108294930875576, 1.1421254801536491, 1.03125, 1.0474196855775804, 1.003762158194164, 1.107001321003963, 1.017743979721166, 1.038728323699422, 1.0500397140587767, 1.2857142857142858, 1.0573248407643312, 2.5, 1.5, 1.4166666666666667, 1.0255754475703325, 1.1200631911532386, 1.0427420253258568, 1.0336565029598093, 1.0833107191316147, 1.044142259414226, 1.0706521739130435, 1.4081632653061225, 1.0140848076143323, 1.6, 1.25, 1.1739837398373985, 1.0, 1.097953216374269, 1.123456790123457, 1.164218258132214, 1.0324617357290093, 1.25, 1.0604070912672356, 1.3546511627906976, 1.1403990024937656, 1.0007482865156934, 1.053191489361702, 1.0484739676840216, 1.029985157848289, 1.0891297978318195, 1.1255961844197138, 1.5777777777777777, 1.2402234636871508, 1.0, 1.0, 1.0005856371374415, 1.6666666666666667, 1.5714285714285714, 1.4210526315789473, 1.0323785803237857, 1.0444444444444445, 1.0302684180468304, 1.0930531732418525, 1.0, 1.2482929857231533, 1.0251497005988024, 1.1748878923766817, 1.0072639225181599, 1.25, 1.0202254641909814, 1.1879157427937916, 1.0934182590233545, 1.0513201933804388, 1.0163235941472901, 1.0080397470641373, 1.0273473108477666, 1.0, 1.0259559876730762, 1.0068785754316953, 1.0083393113342898, 1.2695652173913043, 1.053406904930647]
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.5717	median: 1.0556	mean: 1.1473

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 20.449063 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=naru', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[ 5.9604645e-08  1.0728836e-06 -2.9802322e-08  2.3841858e-07
  5.9604645e-08]
Distance score: 2.8014181907565217e-07
SAUCE Drift detection: False
Detection latency: 0.0233s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 2.039463 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 5.0000	99th: 2.5039	95th: 1.6385	median: 1.0656	mean: 1.1596
ReportEsts: [1.0423728813559323, 1.0300802139037433, 1.0505744943500142, 1.0064516129032257, 1.0, 2.0, 1.156673592559612, 1.0136587981617078, 1.0, 1.0479375696767002, 1.0683273164861613, 1.0030706206627482, 1.0427381383556682, 1.0371819960861057, 1.0242030696576152, 2.272727272727273, 1.1245901639344262, 1.0638297872340425, 1.3, 1.0372940156114483, 1.0937790157845868, 1.0855059416636659, 1.1153846153846154, 1.0923361034164358, 1.026826962524303, 1.0141366658045594, 3.0, 1.0709672030736679, 1.1428571428571428, 1.6, 1.1775338928340866, 2.0, 1.002501453309141, 1.0094651994184813, 1.3936170212765957, 1.0972073039742212, 1.0042007330138145, 1.0111856823266219, 1.0833333333333333, 1.0204597812253315, 1.0459449046426508, 1.0405922428138645, 1.0645905420991926, 1.0624645088018172, 1.0053475935828877, 1.1635322372067245, 1.0416666666666667, 1.080078125, 1.1126126126126126, 1.0515021459227467, 1.5, 1.055350553505535, 1.0179372197309418, 1.064516129032258, 1.0739055333849545, 1.0401637666325487, 1.099662162162162, 1.0975056689342404, 1.072289156626506, 1.0146052288717102, 1.2096774193548387, 1.0476166024818143, 1.1017441860465116, 1.0074074074074073, 1.1485148514851484, 1.2, 1.0838715257755738, 1.0875699888017918, 1.1428571428571428, 1.0, 1.063586195535788, 1.003968253968254, 1.0730418068236425, 1.1045871559633027, 1.0523462329407365, 1.0274869109947644, 1.0214184773008304, 1.0327102803738317, 1.099290780141844, 1.0066595533316163, 1.0665280665280665, 1.3157894736842106, 1.0, 1.0909090909090908, 1.010392609699769, 1.1166666666666667, 1.0523012552301256, 1.2173913043478262, 1.3333333333333333, 1.0290625951263277, 1.0861478218306413, 1.0963153551143259, 1.017470664928292, 1.2457716085384347, 1.0052083333333333, 1.3088757396449704, 1.1176470588235294, 1.1681643132220796, 1.04, 1.1912414624347127, 1.4137931034482758, 4.0, 1.0640309528350727, 1.0404127257093723, 1.0181950509461426, 1.0079192592813124, 1.0512820512820513, 1.0101124962316141, 1.0613496932515338, 1.006870385561936, 1.067277321541377, 1.023151802157327, 1.1428571428571428, 1.0, 1.1496992648696815, 1.0144139396661944, 1.0657672849915683, 1.0227272727272727, 1.0051076719013705, 1.0, 1.1635413464494313, 1.1922141119221412, 1.0, 1.208888888888889, 1.0, 1.1018711018711018, 1.01212423136559, 1.0770876556016598, 1.1145038167938932, 2.0, 1.2615916955017301, 1.0, 1.6666666666666667, 1.0037948907811922, 1.1538461538461537, 1.0494430861179027, 1.0153708066868619, 1.0674968606111344, 2.0, 1.3571428571428572, 1.0222222222222221, 1.104398045313194, 1.0689102564102564, 1.063303063160748, 1.1538461538461537, 1.0490196078431373, 1.0281656360470088, 1.0, 1.0088563727377744, 1.045731707317073, 1.0197869101978692, 1.0093430223935933, 1.0, 1.0424542605882947, 1.0085261875761267, 1.0350584307178632, 1.1211840888066604, 1.0, 1.117914979757085, 1.045954069412483, 1.0667943949810286, 1.1179321486268174, 1.1, 1.0357142857142858, 1.2546583850931676, 1.10803324099723, 1.25, 1.0147154074292921, 1.0945945945945945, 1.106842737094838, 1.0203945751044825, 1.193980198019802, 1.0674641999466334, 1.0671506352087115, 1.0904255319148937, 1.1364732358141778, 1.0244648318042813, 1.1345514950166113, 1.0579710144927537, 1.0556881463802705, 1.146574614976102, 1.0090399334797349, 1.0372670807453417, 1.1355932203389831, 1.025195329646212, 1.0556891842309104, 1.0422535211267605, 1.0149034363150005, 1.1899441340782122, 1.8333333333333333, 1.1243781094527363, 1.0209606112200078, 1.064516129032258, 1.032191069574247, 1.092893196262905, 1.0051364698786096, 1.0143702228985139, 1.0317948717948717, 1.0380590209495213, 1.0769755401928263, 1.0636720453554296, 1.0695716085678286, 1.0919780506924484, 1.002358217322246, 1.1759791122715404, 1.167942962767362, 1.2383720930232558, 1.173913043478261, 1.0093457943925233, 1.0, 1.0483870967741935, 1.0338111240655647, 1.5994397759103642, 1.0792079207920793, 1.0236514522821576, 1.45, 1.0022146448990839, 1.031390134529148, 1.0565074274139095, 2.5, 1.0166666666666666, 1.0238814164150425, 1.039313262005474, 1.0220493499394838, 1.4, 1.1111111111111112, 1.0211259526345982, 1.0313364575687425, 1.0, 1.2718120805369129, 1.0484679665738161, 1.0440703853374487, 1.0603448275862069, 1.0005681804951088, 1.0140308688257778, 1.1223776223776223, 1.1527896995708153, 1.0888355342136855, 1.1818181818181819, 1.1701846965699207, 2.0, 1.0007920792079208, 1.0558304546727664, 1.070579060245662, 1.4294294294294294, 1.0769230769230769, 3.3333333333333335, 1.0924531348629645, 1.1384615384615384, 1.1009700176366843, 2.0, 1.1154761904761905, 1.0511247443762781, 1.25, 1.0030238672340694, 1.102974828375286, 1.149748743718593, 1.0446009389671362, 1.0202558635394456, 1.0378307895484713, 1.0138888888888888, 1.0, 1.0131726673580104, 1.1614493750716661, 1.0671428571428572, 1.0089991722874805, 1.1312710268508919, 1.0192288948606916, 1.0998650472334683, 1.0534407135208086, 1.0450980392156863, 1.1355578727841502, 1.2148965175362498, 1.6666666666666667, 1.0570293104829023, 1.1753472222222223, 1.3, 1.2307692307692308, 1.0252403846153846, 1.1239388794567062, 1.0056457669696734, 1.0040268926395406, 1.0844444444444445, 1.2069825436408979, 1.0095887930063974, 1.0219236209335218, 1.0042482524234349, 1.0067808597635097, 1.2142857142857142, 1.0114285714285713, 1.0732307692307692, 1.0022825225902603, 1.011277758400186, 1.0044841118947345, 1.1403601694915255, 1.0212290502793295, 1.0225602212357179, 1.0146613436123348, 1.0475768374970604, 1.0531394287926124, 1.0611854684512427, 1.0357142857142858, 1.0769230769230769, 1.0787986436299046, 1.25, 1.0520446096654275, 1.0110752095357065, 1.005839115202308, 1.0769230769230769, 1.2868852459016393, 1.2089093701996927, 1.0708565459610029, 1.039205293541744, 1.0454545454545454, 1.0171152030217185, 1.0052636083533038, 1.1586021505376345, 1.2, 2.888888888888889, 1.0909730363423211, 1.5, 1.0192600727126226, 1.026470588235294, 1.0476190476190477, 1.0531595386833252, 1.2, 2.2222222222222223, 1.031047691665305, 2.0, 1.077319587628866, 1.0446859903381642, 1.056476683937824, 1.0467289719626167, 1.1130434782608696, 1.1016949152542372, 1.0089371100687645, 1.0272843541281795, 1.0763116057233704, 1.0555023399655163, 1.2080860275120453, 3.0, 1.3, 1.0197517203894049, 1.25, 1.059333637608398, 1.0, 3.0, 1.08, 1.1811023622047243, 1.0634538152610442, 1.3063063063063063, 1.011173184357542, 1.103448275862069, 2.0, 1.0366507157436293, 1.5, 1.2982456140350878, 1.0264938219558954, 1.2201492537313432, 1.082314588427058, 1.0341555977229602, 1.8, 1.5, 1.2743569758378799, 1.2039473684210527, 1.0600985221674877, 1.0125527393029512, 1.08113765082492, 1.0671834625322998, 1.5, 1.0084805197472864, 1.0373831775700935, 1.1428571428571428, 1.0, 1.0213032581453634, 1.1111111111111112, 1.1979695431472082, 1.0756302521008403, 1.046400574724787, 1.025410235344583, 1.0808080808080809, 1.1145355191256832, 1.0378045365443853, 1.04093567251462, 1.0529172320217097, 1.0011197145676762, 1.122754491017964, 1.0833333333333333, 1.0090662515625368, 1.0008167762033202, 1.1017583239805462, 1.0462962962962963, 1.175, 1.08984375, 3.0, 1.7037037037037037, 1.2695652173913043, 1.0363288718929253, 1.152046783625731, 1.0566534914361, 1.030408773678963, 1.0754464285714285, 1.2519046448758908, 1.0782972253895857, 1.0198934141435252, 1.4078947368421053, 1.0075187969924813, 1.08, 1.0, 1.004683065670481, 1.4385964912280702, 1.0027156489269415, 1.0157945179221775, 1.056783597629345, 1.0144849785407726, 1.7142857142857142, 1.0988254353989468, 1.1666666666666667, 1.0165037450806145, 1.3636363636363635, 1.0167996816821872, 1.0011862396204034, 1.04670551322277, 1.1683168316831682, 1.2839931153184165, 5.0, 1.1777970511708586, 1.0027641619081307, 1.038940630868882, 1.0, 1.1818181818181819, 1.0507246376811594, 1.3723150357995226, 1.0987983067049023, 1.071384844694046, 1.2173913043478262, 1.1816192560175054, 1.0863923310731822, 1.0634232722866863, 1.033264525224046, 1.1138141576035108, 1.1148738379814076, 1.4166666666666667, 1.1585623678646935, 1.0197467683399257, 1.2403100775193798, 1.1120689655172413, 1.0, 2.0, 1.1815245478036176, 1.1666666666666667, 1.2348947725729804, 1.0297786898557573, 1.123121387283237, 1.0, 1.110236220472441, 1.3793103448275863, 1.016340822877152, 1.0, 3.0, 1.0194874070171303, 1.0, 1.0, 1.1234474971772677, 2.0, 1.223132372214941, 1.0030143180105502, 1.3901515151515151, 1.1, 1.0249186910811163, 1.0578512396694215, 1.1071428571428572, 1.0162336644833745, 1.0588235294117647, 1.0593406593406594, 1.156562291805463, 1.0497003877335214, 1.1480236299889535, 1.0, 1.0212765957446808, 1.0612813370473537, 1.0296662546353523, 1.1092564491654022, 1.2, 1.073228346456693, 1.0185603601746267, 1.0072711719418306, 2.0, 1.1073333333333333, 1.1040598437239582, 1.0793252069065813, 1.2176655001458152, 1.031218236173393, 1.0162462726473493, 1.0063113604488079, 1.0541938555768378, 1.75, 1.0671754408657785, 1.0921228304405874, 1.0323501427212178, 1.0691721132897603, 1.07012987012987, 1.0242657494388856, 1.1004784688995215, 1.0201656578528193, 1.1708201178069777, 1.000431127398146, 1.0206843718079672, 1.0499073856669536, 1.177467972871138, 1.1566265060240963, 1.3026315789473684, 1.0421204782614208, 1.094298245614035, 1.03752052545156, 1.005546065101912, 1.0, 1.3213077790304397, 1.5718390804597702, 1.25, 1.3783783783783783, 1.0035641834402143, 1.178438661710037, 1.002754820936639, 1.0, 1.0555555555555556, 1.0352495859947954, 1.0406205673758866, 1.0264308803955124, 1.0062571616175922, 1.0218102508178843, 1.048, 1.0679871520342612, 1.0731055304829147, 1.3098591549295775, 1.005913600499961, 1.0263695450324977, 1.031390134529148, 1.0110189664439837, 1.152492668621701, 1.0655098859627532, 1.0, 1.105263157894737, 1.5263157894736843, 1.087446020974707, 1.0493827160493827, 1.138110072689512, 1.0206896551724138, 1.021505376344086, 1.0487413915934458, 2.0, 1.6379310344827587, 1.2857142857142858, 1.0, 1.0404040404040404, 1.2087912087912087, 1.3466204506065858, 1.1743119266055047, 1.019493435883835, 1.0305897193314413, 1.0171618669598366, 1.0124341238471672, 1.0018482036393799, 1.0059158945117606, 1.0259578785427248, 1.095572354211663, 1.0444839857651245, 1.0011363296552136, 1.1158206012814194, 1.0486187845303867, 1.0951219512195123, 1.1265822784810127, 1.0057011159631246, 1.1995133819951338, 1.0118366698442962, 1.1374407582938388, 1.1467181467181466, 1.0392111368909513, 1.6666666666666667, 1.0355871886120998, 1.0625, 1.4, 1.4302670623145401, 1.0168529240159778, 1.0123314065510598, 1.1105263157894736, 1.08, 1.0173531307382682, 1.158980745927023, 1.0478011472275335, 1.4, 2.0, 1.0474475150560028, 1.2946428571428572, 1.0060048038430744, 1.008415147265077, 1.0, 1.194328219432822, 1.0651162790697675, 1.003158844765343, 1.1759530791788857, 1.0210348899215358, 1.0088544017516734, 1.015058052265603, 1.131578947368421, 2.0, 1.080765987002034, 1.0, 1.087173100871731, 1.1327800829875518, 1.0589949016751639, 1.4427244582043344, 1.121212121212121, 1.0320590319756535, 1.2030075187969924, 1.0598591549295775, 1.0461043142305215, 1.170957095709571, 1.1227506426735219, 1.0145882352941176, 1.0008833922261484, 1.0111511971138079, 1.0, 1.0158011782607, 1.1413718358499578, 1.1818181818181819, 1.020718232044199, 1.0757100329873683, 1.1367521367521367, 1.0530389235076312, 1.0, 1.1515151515151516, 1.067116060961313, 1.7195402298850575, 1.2868217054263567, 1.001462794857649, 1.2788461538461537, 2.4285714285714284, 1.0208005042546486, 1.0578687367678192, 1.0418309520781222, 1.0697867626696207, 1.0297372592343532, 1.0125223613595706, 1.1484848484848484, 1.0181875195986203, 1.1672131147540983, 1.0279365609194124, 1.0765957446808512, 1.0015015015015014, 1.333622183708839, 1.0532733943057924, 1.2509881422924902, 1.0773422394093866, 1.1428571428571428, 1.6, 1.011166253101737, 1.0147540983606558, 1.0360443622920517, 1.2727272727272727, 1.4444444444444444, 1.0110323089046493, 1.1095019427764041, 1.3846153846153846, 1.013845151109739, 2.0, 1.0064654191139644, 1.0, 1.3061224489795917, 1.1666666666666667, 1.1085553099918577, 1.303030303030303, 1.1152263374485596, 1.123575810692375, 1.0, 1.0275615400799496, 1.0114503816793894, 1.8, 1.5, 1.0608108108108107, 1.045045045045045, 1.1141371626640257, 1.0159574468085106, 1.0326086956521738, 1.085057471264368, 1.072829131652661, 1.0177935943060499, 1.6483516483516483, 1.5257731958762886, 1.25, 1.0, 1.1429951690821256, 1.23855421686747, 1.0680772769089237, 1.2611437268971515, 1.0210151618956838, 1.2403229941040759, 1.0179537872235265, 1.0106799037304453, 1.0305719921104537, 1.0004977600796416, 1.875, 1.5, 1.0512820512820513, 1.0077162462056475, 1.1326616288832914, 1.0307262569832403, 1.1049107142857142, 1.0417782880469448, 1.070344613325686, 1.00017525856989, 1.108695652173913, 1.173913043478261, 1.0982758620689654, 1.0930206835527043, 1.0469415835103328, 1.0685035556240505, 1.1366120218579234, 1.0942198668967218, 1.040339159873582, 1.0120431159352132, 1.0316114109483423, 1.0403708743084807, 1.2567049808429118, 1.0616302186878728, 1.118279569892473, 1.0059568109059551, 1.3333333333333333, 1.0021496130696474, 1.0, 1.0019455252918288, 1.0630345400627481, 1.305084745762712, 1.0317764571671133, 1.149384885764499, 1.125, 1.0426464203862813, 1.0011434761675493, 1.1378875724729014, 1.002413515687852, 1.0321951219512195, 1.0061452250894707, 1.1348122866894197, 1.1176470588235294, 1.0, 1.1, 1.009784735812133, 1.8571428571428572, 1.0128647405490872, 1.0648243917794666, 1.0769372693726937, 1.100201502106613, 1.0087280503429046, 1.052024671493698, 1.0504731861198737, 1.0011574074074074, 1.018806495793387, 1.0891813176300515, 1.0051765044215974, 1.0454374482810502, 1.4444444444444444, 1.0920502092050208, 1.2516129032258065, 1.0437903371735329, 1.0477453580901857, 1.0035505059470975, 1.16255442670537, 1.011290322580645, 1.0614252677544798, 1.0121412803532008, 1.0095760749169267, 1.3157894736842106, 1.0106920857746187, 1.004907573458408, 1.1334833145856769, 1.007787610619469, 1.1142857142857143, 1.2041763341067286, 1.0600426699177081, 1.1053160161369942, 1.15508412582297, 1.00756893356268, 1.1025641025641026, 1.1451245319876282, 1.1282375236891977, 1.163826998689384, 1.08, 1.0521662245800176, 1.098148148148148, 1.0834498834498834, 1.0364716292618752, 1.0245746691871456, 1.0604419828607643, 1.0310188499164876, 1.0625, 1.0376454483230664, 1.153745928338762, 1.0373881740742061, 1.04, 1.2763157894736843, 1.1444557477110886, 1.2081218274111676, 1.0149812734082397, 1.0031025298301415, 1.3333333333333333, 1.0244044160371877, 1.0130839278082777, 1.0243243243243243, 1.5524691358024691, 1.0047499058707678, 1.0206567880193786, 1.0755347593582887, 1.0350194552529184, 1.0011830916485231, 1.101136332218198, 1.0214395099540583, 1.3194444444444444, 1.0128654970760234, 1.0412170800306826, 1.0303030303030303, 2.0, 1.0370737722496246, 1.004701703061331, 1.0091083413231063, 1.2804878048780488, 1.01, 1.0305424662115756, 1.0, 1.2064658339456282, 1.2413793103448276, 1.119774011299435, 1.1988636363636365, 1.1026315789473684, 1.7586206896551724, 1.0641059084387636, 1.0083056478405317, 1.1823255813953488, 1.119047619047619, 1.0255439924314096, 1.0019029495718363, 1.0294117647058822, 1.5106382978723405, 1.0066666666666666, 1.147982062780269, 1.1145077720207255, 1.5, 1.0619574450452691, 1.1232731137088203, 1.2155898876404494, 1.0854700854700854, 1.5, 1.220349009168885, 1.1008588103183767, 1.0757099594308897, 1.2406015037593985, 1.2988505747126438, 1.0, 1.054054054054054, 1.2988505747126438, 1.5636363636363637, 1.1778846153846154, 1.013495337411574, 1.0077455134596212, 1.1258741258741258, 1.0136216487324456, 1.0006465067778936, 5.0, 1.0320003930734838, 1.0029609690444146, 1.3333333333333333, 1.2857142857142858, 1.0044106836559668, 1.0285935545362483, 1.042073315877172, 1.0025974025974025, 1.5, 1.1338289962825279, 1.2759493670886075, 1.1875, 1.0008993848207826, 1.0127045235803658, 1.0036025780747229, 1.163616531329536, 1.4444444444444444, 1.0110249741449722, 1.06963249516441, 1.1880687563195147, 1.1096153846153847, 1.0841983852364476, 1.0, 1.332214765100671, 1.06487847390336, 1.0326988205068317, 1.1702127659574468, 1.0555555555555556, 1.0158719228782922, 1.2028776978417266, 1.1783216783216783, 1.25, 1.0622766754786044, 1.3795146726862302, 1.0433775201240676, 1.2745098039215685, 1.2474226804123711, 1.4202898550724639, 1.25, 1.027191206248192, 1.031941031941032, 1.0052976947466798, 1.0480943738656987, 2.0, 1.0476190476190477, 1.0415139906728847, 1.1557770394979698, 1.3067254325824356, 1.127869970447829, 1.0426566624982632, 1.1134601832276252, 1.2386363636363635, 1.0727272727272728, 1.017928819909018, 1.0005138922196717, 1.0870622568093384, 1.0249632892804699, 2.5, 1.021978021978022, 1.0842727776751062, 1.237741456166419, 1.0157617530398595, 1.0050867585933891, 1.1561181434599157, 1.5, 1.0009551098376313, 1.055643493207221, 1.0213495996950057, 1.0361842105263157, 1.00523024502183, 1.2243589743589745, 1.3415233415233416, 1.077294685990338, 1.0028111524208663, 1.0212922374679738, 1.0744985673352436, 1.137191854233655, 1.0833333333333333, 1.083551653331445, 1.0776314681191566, 1.044825482060044, 1.0898806563898558, 1.0329138431752178, 1.064601186552406, 1.0853658536585367, 1.1215469613259668, 2.5, 1.0, 1.3571428571428572, 1.0365591397849463, 1.1347150259067358, 1.0246370980222228, 1.0351149037273153, 1.11783367323816, 1.009591907917684, 1.0318181818181817, 1.1781674208144797, 1.015894078447419, 1.6666666666666667, 1.4615384615384615, 1.151417004048583, 1.1111111111111112, 1.166882276843467, 1.1184156798693343, 1.0423518810542916, 1.0171335456432518, 1.0, 1.101219166430394, 1.0961538461538463, 1.0609519829813099, 1.000922022174442, 1.0683491062039958, 1.0359263657957245, 1.0180542454781645, 1.0965110565110565, 1.0766233766233766, 1.4098360655737705, 1.2410196987253765, 1.0, 2.0, 1.0005177776536105, 1.25, 2.0, 1.2352941176470589, 1.0585858585858585, 1.01132766900628, 1.0771830985915494, 1.023076923076923, 1.1666666666666667, 1.285063113604488, 1.0284715284715285, 1.0337078651685394, 1.0206185567010309]
origin-bjaq_15.87 	max: 5.0000	99th: 2.5039	95th: 1.6385	median: 1.0656	mean: 1.1596

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 21.710658 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=44.231787