Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='naru', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 64, 'naru': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 5.0000	99th: 2.6667	95th: 1.5004	median: 1.0566	mean: 1.1451
ReportEsts: [1.1170212765957446, 1.0389610389610389, 1.045781200357051, 1.0097087378640777, 1.0344827586206897, 1.0, 1.149778434268833, 1.0028205772093775, 1.25, 1.0359042553191489, 1.0013851614578824, 1.0026442068029806, 1.0162185232607768, 1.0162790697674418, 1.037795831861533, 1.0, 1.5789473684210527, 1.0276301806588735, 3.0, 2.6666666666666665, 1.2272727272727273, 1.0291136510675005, 1.0437134067678873, 1.095176848874598, 1.015022533800701, 1.0, 1.0596116312150583, 1.0, 1.4, 1.2302158273381294, 1.0, 1.0080331133387732, 1.0024635844692682, 1.3956714761376248, 1.009105595535321, 1.0253198835556157, 1.0594900849858357, 1.01853677488284, 1.0700805840622631, 1.1904761904761905, 1.0116731517509727, 1.0304878048780488, 1.0, 1.1137618663522988, 1.0277649236464599, 1.2148760330578512, 1.0970873786407767, 1.1742738589211619, 1.0312714891904131, 1.0093457943925233, 1.0018583771781628, 1.1663326653306614, 1.005694119759528, 2.0, 1.225974025974026, 1.0886753474395894, 1.0369532428355959, 1.0566037735849056, 1.15527950310559, 1.25, 1.030057251908397, 1.0485678704856787, 1.040909090909091, 1.1724137931034482, 1.1, 1.157384652659998, 1.1219377924580236, 1.1666666666666667, 1.0, 1.0534223706176962, 1.022673031026253, 1.0602898550724638, 1.1306306306306306, 1.0684762773722627, 1.171764705882353, 1.1663066954643628, 1.0, 1.0440278988666085, 2.0, 1.0532870383655197, 1.25, 1.05365998482566, 1.2085889570552146, 1.0137614678899083, 1.0636743215031315, 1.04, 1.0165618751656187, 1.0418467607417239, 1.0931372549019607, 2.3333333333333335, 1.0741981809478218, 1.0294157436871731, 1.0218068535825544, 1.3239831697054698, 1.2414965986394557, 1.0784313725490196, 1.2616822429906542, 1.0008532423208192, 1.0, 1.022396716338003, 1.1323254139668826, 1.0188679245283019, 1.0067045414446523, 1.1764705882352942, 1.0040410642516646, 1.0972909991261288, 1.024709600623897, 1.0591581342434584, 1.0283732660781841, 1.1666666666666667, 1.3333333333333333, 1.1542610571736784, 1.0024949409564794, 1.0624161073825504, 1.0405405405405406, 1.005314442814814, 1.0, 1.2623407643312101, 1.1511961722488038, 1.0, 1.2747252747252746, 1.1666666666666667, 1.0927318295739348, 1.017926687347678, 1.1216898345888018, 1.0566037735849056, 1.8, 1.2334437086092715, 1.0, 1.0714285714285714, 1.0050914518816902, 1.1818181818181819, 1.0037434895833333, 1.009916659862963, 1.0494821634062141, 1.0624113475177306, 1.03988603988604, 1.0594549958711807, 1.00199203187251, 1.0485623003194888, 1.0436402081977878, 1.2098765432098766, 1.0724070450097847, 1.006851565637512, 2.0, 1.0157407407407408, 1.0391923990498813, 1.0272952853598014, 1.0328215987294864, 1.0, 1.049527730685396, 1.0222222222222221, 1.022, 1.4476190476190476, 1.0254491017964071, 1.006237356709373, 1.013475786534951, 1.0729551808098114, 1.129277566539924, 1.144736842105263, 1.0208333333333333, 1.3115942028985508, 1.1260364842454396, 1.2857142857142858, 1.0083069227365893, 1.0301489145933251, 1.016119746689695, 1.0481999850310606, 1.0238240684178375, 1.0472555723410457, 1.0650224215246638, 1.1407563025210083, 1.1778832187469739, 1.0761697497279652, 1.18144750254842, 1.0575539568345325, 1.047256581033936, 1.0538951494365507, 1.0654680116625892, 1.1666666666666667, 1.3263157894736841, 1.059034523987446, 1.0476190476190477, 1.1507584165741769, 1.1692307692307693, 1.0359069472874705, 1.0123005958101094, 1.037097158193191, 1.16, 1.0343206393982134, 1.0588957055214725, 1.0, 1.2727272727272727, 1.0645674026978262, 1.2883087400681044, 1.080179282868526, 1.3461538461538463, 1.0308681672025723, 1.004999563244732, 1.0099784383250927, 1.1798245614035088, 1.1318646568989144, 1.0662650602409638, 1.0625, 1.0357142857142858, 1.0, 1.032258064516129, 1.0103569152326322, 1.5958188153310104, 1.0574712643678161, 1.0168067226890756, 1.0957683741648108, 1.103738441465121, 1.003551215181445, 1.0498798467233876, 1.1972789115646258, 1.007278020378457, 1.0681896850121149, 1.0107261564364196, 1.055850709782043, 1.0, 1.0451345755693582, 1.0059637026470123, 1.0071514592382302, 1.0611551528878822, 1.0197172619047619, 1.0020724073760785, 1.0344827586206897, 1.0021040631051277, 1.0847552447552447, 1.1483361534122956, 1.0971428571428572, 1.040862891516283, 1.0088974854932302, 1.0866141732283465, 1.0, 1.0083392899690256, 1.0650960250111656, 1.0684481950304736, 1.455223880597015, 1.0909090909090908, 2.6666666666666665, 1.0437382388631926, 1.1272727272727272, 1.0881736944987435, 1.5, 1.0, 1.2903225806451613, 1.0253708040593286, 1.3775510204081634, 1.0994475138121547, 1.099767981438515, 1.1046099290780143, 1.0240756663800517, 1.0436987353024365, 1.0701754385964912, 1.0, 1.0269225896363867, 1.1138328530259367, 1.0700525394045535, 1.0127876696377534, 1.0370549093310306, 1.033038528006506, 1.1120826709062004, 1.0152984877559283, 1.069377990430622, 1.2205258693808312, 1.1520939445387663, 1.6363636363636365, 1.0985369017874302, 1.068230277185501, 1.2727272727272727, 1.0416666666666667, 1.1443636363636365, 1.1111111111111112, 1.0833333333333333, 1.0064733194266873, 1.0286532951289398, 1.1839762611275964, 1.0184512127877814, 1.0465320456540825, 1.002682518918382, 1.0082931410470688, 1.5, 1.0312477264459803, 1.2, 1.0164480888678633, 1.0842332613390928, 1.0058759273587912, 1.3, 1.4285714285714286, 1.0434782608695652, 1.5070422535211268, 1.0215453563580836, 1.0, 1.0642201834862386, 1.011441647597254, 1.0400641025641026, 1.0021391090247118, 1.173913043478261, 1.0188679245283019, 1.019419737027141, 1.1178634074577039, 1.0565766679342545, 1.0769230769230769, 1.0, 1.2899761336515514, 1.0147783251231528, 1.1806853582554517, 1.0502948609941027, 1.03184165232358, 1.1352112676056338, 1.1568627450980393, 1.01920438957476, 1.1173248774863074, 1.5714285714285714, 1.0274124917982548, 1.0604395604395604, 1.263157894736842, 1.026603365452145, 1.2857142857142858, 1.75, 1.0241587089959916, 2.0, 1.0013736263736264, 1.063953488372093, 1.0133000831255194, 1.0011359333585763, 1.133159268929504, 1.164835164835165, 1.0107550156252114, 1.006846125566766, 1.0166204986149585, 1.028141527612644, 1.0905090660799637, 2.0, 1.1111111111111112, 1.0296962138503893, 1.3333333333333333, 1.0475409836065575, 1.0, 1.0, 1.0454545454545454, 1.1759149940968123, 1.0874159462055715, 1.18348623853211, 1.024891774891775, 1.0, 1.044607190412783, 1.0046037894632625, 1.5, 1.2525312686122692, 1.0, 1.0108251727017383, 1.0987654320987654, 1.034033062188402, 1.1658986175115207, 1.0018181818181817, 1.0435555555555556, 1.0185185185185186, 1.0157469048407988, 1.0004122051055917, 1.047936085219707, 1.0, 1.1428571428571428, 1.8333333333333333, 3.0, 1.1428571428571428, 1.0026495688019705, 1.25, 1.124792013311148, 1.0594059405940595, 1.0508307593992972, 1.0547315737616294, 1.0114583333333333, 1.08686770887451, 1.0323353293413173, 1.2669683257918551, 1.5, 1.0762331838565022, 1.053811659192825, 1.0007146019589415, 1.2380952380952381, 3.142857142857143, 1.1247216035634744, 1.0401162790697673, 1.0066450639356435, 1.1286307053941909, 1.342769701606733, 1.0395335608646188, 1.4035087719298245, 1.0808477237048666, 1.0360169491525424, 1.4038461538461537, 1.055306427503737, 1.0789473684210527, 1.0270744624025152, 1.0080625391550677, 1.0379598836000832, 1.0116279069767442, 1.0776699029126213, 1.0686567164179104, 1.0, 1.0092043799286754, 1.0197281804070635, 1.0030661706684703, 1.003769218841323, 1.0632052017594187, 1.006717850287908, 1.8333333333333333, 1.0950871632329635, 1.5, 1.0640478223740393, 1.1111111111111112, 1.007581521887881, 1.0231884057971015, 1.0678202923473774, 1.150197628458498, 1.0778546712802768, 3.0, 1.1978947368421053, 1.0023711161573328, 1.0437511495309915, 1.0, 1.125, 1.0249520153550864, 1.353448275862069, 1.082202842377261, 1.0433839479392624, 1.1666666666666667, 1.0491803278688525, 1.10444761259261, 1.0732708745474226, 1.0045499749179332, 1.0447368421052632, 1.2023217247097844, 1.0757575757575757, 1.0, 1.0050761421319796, 1.3, 1.0497953615279672, 1.1818181818181819, 1.0538658539166508, 1.25, 1.078852831996168, 1.0073749632117446, 1.16367552045944, 1.0, 1.1067961165048543, 1.2, 1.001634304836764, 1.2078774617067833, 1.0, 1.1671732522796352, 1.023263872574355, 1.193963384463137, 1.0, 2.0, 1.175145631067961, 1.0035971223021583, 1.3616071428571428, 1.0, 1.0237235305758956, 1.0402750491159136, 1.0869565217391304, 1.0731450094161958, 1.0272727272727273, 1.010498687664042, 1.1370967741935485, 1.0635254522507362, 1.139716434188623, 1.0, 1.054054054054054, 1.0903220035778176, 1.0123672042927614, 1.0272025038289938, 1.0, 1.0509065550906556, 1.013770262623573, 1.0288108957569408, 1.0, 1.108054226475279, 1.0689939268396027, 1.095921791314448, 1.1683631121401423, 1.0104303508270909, 1.1806993006993007, 1.0285714285714285, 1.1427193828351012, 2.0, 1.0759729184970799, 1.1935483870967742, 1.0, 1.3310344827586207, 1.1555555555555554, 1.0355536757787887, 1.0603603603603604, 1.0528700040139916, 1.0624085811799122, 1.0494106820514635, 1.0150142026241038, 1.003432851347134, 1.0679611650485437, 4.0, 1.0315736406193734, 1.0115384615384615, 1.0092130605993062, 1.0110779677923671, 1.0850536746490504, 1.1925133689839573, 1.0885416666666667, 1.4285714285714286, 1.0101695748945536, 1.0472964691988011, 1.0313481941517875, 1.0944005743000718, 1.0535564641052337, 1.0125260960334028, 1.0084138466767005, 1.0237324703344122, 1.0902777777777777, 2.0, 1.0, 1.0352760736196318, 1.0216998191681737, 1.0205479452054795, 1.0157004830917875, 1.1564625850340136, 1.3092105263157894, 1.0554699537750385, 1.098901098901099, 1.0264057074169708, 1.3950617283950617, 1.0031201248049921, 1.0, 1.0969267139479906, 1.4642857142857142, 1.0921985815602837, 1.0346820809248556, 1.1482412060301508, 1.1284584980237153, 1.0266311584553929, 1.0256710019971746, 1.0, 1.425531914893617, 1.5, 1.0, 1.0232558139534884, 1.1221719457013575, 1.3528183716075157, 1.0729166666666667, 1.0257930150592758, 1.1136950904392764, 1.0190431306837024, 1.02080457503451, 1.0971428571428572, 1.0119635083909373, 1.0216216216216216, 1.1133069828722002, 1.158684083212385, 1.0999727594660855, 1.0491329479768785, 1.0549231644849175, 1.064519609429789, 1.0533619895609456, 1.0112832981222042, 2.0, 1.0489690721649485, 1.0619223659889094, 1.0482758620689656, 1.0, 1.108695652173913, 1.25, 1.103515625, 1.5555555555555556, 1.5, 1.0407367662100304, 1.036858006042296, 1.003699009286324, 1.052844882390337, 1.0918918918918918, 1.0449574726609963, 2.0, 1.1240875912408759, 1.1370872872715865, 1.0065369961900943, 1.0074805723000944, 1.0284770474997151, 1.0048989808689432, 1.0724233983286908, 1.013034168140769, 1.2131438721136767, 1.0433999344906648, 1.0463111127845026, 1.4242424242424243, 1.1154273029966704, 1.0, 1.0136054421768708, 1.0218603923749283, 3.0, 1.1062181447502548, 1.0112990646035493, 1.2857142857142858, 1.133847976146714, 1.1111111111111112, 1.1875, 1.0283923512747875, 1.7692307692307692, 1.012810751362653, 1.036736437419906, 1.2258064516129032, 1.2608695652173914, 1.2763157894736843, 1.0048053820278713, 1.141920846987648, 1.0467961654894047, 1.0106004240169606, 1.0, 1.1664132087768846, 1.0182926829268293, 2.0, 1.0718223124293655, 1.0353836837096635, 1.1201513718070009, 1.0169595793454471, 1.0391061452513966, 1.3950617283950617, 1.8571428571428572, 1.0661848611639406, 1.0589239965841162, 1.0149831164203418, 1.0750500333555704, 1.0512538254499766, 1.0666478437899367, 1.1282051282051282, 1.0717703349282297, 1.1368821292775666, 1.0331686583439037, 1.1053627760252367, 1.034676663542643, 1.0819327731092436, 1.0440571884395902, 4.0, 1.0058275980275821, 1.0035112569701443, 1.036174613542347, 1.0555555555555556, 1.0490203219462453, 1.0753968253968254, 1.0, 1.0350819552440405, 1.0134426229508198, 1.106280193236715, 1.1470588235294117, 1.6666666666666667, 1.0389893439538829, 1.5, 1.4410774410774412, 1.1538461538461537, 1.1209964412811388, 1.2857142857142858, 1.2030456852791878, 1.09853249475891, 1.0, 1.3187830687830688, 1.0065832784726794, 1.75, 1.0, 1.08130081300813, 1.0740740740740742, 1.1028537455410226, 1.0020986358866737, 1.0305958132045088, 1.0029585798816567, 1.089150378938971, 1.0493506493506493, 1.4583333333333333, 1.25, 1.3076923076923077, 1.0, 1.1168539325842697, 1.2323232323232323, 1.0297872340425531, 1.2650065530799475, 1.0389069434676108, 1.2105131414267836, 1.014473957252542, 1.0194575471698113, 1.0312876052948254, 1.0041941282204914, 1.375, 1.0, 1.0625, 1.0255512230809343, 1.121782178217822, 1.0065359477124183, 1.0098522167487685, 1.0676594119893088, 1.0257852918170465, 1.0053196840503984, 1.0769230769230769, 1.1, 1.0510732790525537, 1.131163838812301, 1.010208027221406, 1.0272142111315243, 1.243421052631579, 1.115327820437094, 1.0090281709537727, 1.0713305898491083, 1.0508293204922419, 1.0, 1.0335977601493234, 1.6754716981132076, 1.0, 1.1838709677419355, 1.0347890451517394, 1.0, 1.0841584158415842, 1.0571721661822533, 1.0925925925925926, 1.0149340466012307, 1.1620762711864407, 1.0465116279069768, 1.0438822859496724, 1.00901225666907, 1.1400080580177276, 1.0, 1.041371158392435, 1.0113841298467088, 1.1740041928721174, 1.0714285714285714, 1.0, 1.25, 1.0243429817124863, 1.8333333333333333, 1.037861414631953, 1.0560012923375155, 1.140230394328755, 1.0905349794238683, 1.0028354132685962, 1.0907824222936764, 1.0772200772200773, 1.0140646976090013, 1.015309836335032, 1.018206113245365, 1.0062076073149102, 1.0214048468446304, 1.25, 1.046875, 1.2766798418972332, 1.0317031738936076, 1.0456026058631922, 1.004660029654734, 1.1628318584070796, 1.0175438596491229, 1.05325721496003, 1.0434173669467788, 1.0047009569377992, 1.25, 1.0071042169067328, 1.005116344849962, 1.1610983981693364, 1.0008428150021071, 1.25, 1.0447427293064877, 1.1791044776119404, 1.5, 1.0732210755024443, 1.4230769230769231, 1.0665322580645162, 1.043956043956044, 1.1274443695212408, 1.0673975557153128, 1.0823529411764705, 1.0909090909090908, 1.103448275862069, 1.0010294496121181, 1.0148343190929132, 1.010303117982652, 1.129201680672269, 1.0476908576814326, 1.0, 1.0479735318444996, 1.0543769309989701, 1.0571900531273717, 1.0246406570841888, 1.1944444444444444, 1.0288548241659152, 1.0374692874692875, 1.144638403990025, 1.0353143063583814, 1.0, 1.3333333333333333, 1.0043264357586097, 1.0189247311827958, 1.0104397097062134, 1.068881492927612, 1.0590582601755787, 1.0066666666666666, 1.0121733644813753, 1.0978210477515067, 1.0187265917602997, 1.2918918918918918, 1.0049019607843137, 1.0295979973494331, 1.0238095238095237, 1.75, 1.0352907175886281, 1.0008175481868444, 1.033588685916323, 1.3233082706766917, 1.0152063721940623, 1.0065932681472356, 1.0253675410781204, 1.0325, 1.3076923076923077, 1.1091644204851752, 1.0610526315789475, 1.109375, 1.6538461538461537, 1.0344731254888815, 1.0237859266600595, 1.0923913043478262, 1.1714285714285715, 1.0149329588390679, 1.0551276854479124, 1.0149801284011006, 1.0198059021588433, 1.6666666666666667, 1.12, 1.3333333333333333, 1.0345945945945947, 1.5384615384615385, 1.3333333333333333, 1.3636363636363635, 1.3107638888888888, 1.0978260869565217, 1.0854964399843023, 1.0320836278167682, 1.1690909090909092, 1.4558823529411764, 1.0, 1.0, 1.2297297297297298, 1.320754716981132, 1.0109034267912773, 1.0114545835218791, 1.0007235353048125, 1.0390625, 1.0198874322097071, 1.0010459936940093, 5.0, 1.003419414106359, 1.1014285714285714, 1.0, 1.3333333333333333, 1.0923076923076922, 1.1109517320519258, 1.0699203258422951, 1.0527950310559007, 1.0, 1.1072961373390557, 1.2791411042944785, 2.0, 1.5, 1.0071358267716535, 1.0362167432790081, 1.1081417889781224, 1.25, 1.0118989426882101, 1.0666150271107668, 1.1271676300578035, 1.3333333333333333, 1.1151832460732984, 1.0033243473993452, 1.2894736842105263, 1.0955808005709868, 1.0130658597925182, 1.12, 1.0118577075098814, 1.0218044077134987, 1.197267292912041, 1.0661157024793388, 1.38, 1.0836036868817052, 1.0340019569471623, 1.0026777182729272, 1.237037037037037, 1.2592592592592593, 1.1044776119402986, 1.021656050955414, 1.031316509577379, 1.0059137733689432, 1.0082686140411885, 1.0665938864628821, 3.0, 1.25, 1.0457249816164182, 1.183377308707124, 1.3225053491538612, 1.0151751118198922, 1.10235825388861, 1.1242198854407113, 1.1278772378516624, 1.1041666666666667, 1.06061364015341, 1.0220665283228205, 1.122569239835003, 1.3117338003502628, 2.5, 1.0933333333333333, 1.008400895117209, 1.0774193548387097, 1.0426289766443302, 1.0031817286867493, 1.0880681818181819, 1.6, 1.003516998827667, 1.062960097528954, 1.0500342700479781, 1.1482889733840305, 1.0164914413770085, 1.2661290322580645, 1.1296758104738154, 1.0805797101449275, 1.0030941832994187, 1.0598206718115715, 1.108294930875576, 1.1241997439180538, 1.0, 1.0503246753246753, 1.0126125292170975, 1.0528401585204756, 1.0240283429212853, 1.0339470655926353, 1.0458860759493671, 1.2857142857142858, 1.0806794055201698, 2.5, 1.5, 1.3076923076923077, 1.0230179028132993, 1.146129541864139, 1.0035776841948347, 1.0327433667407253, 1.0808683853459973, 1.0368200836820083, 1.0380434782608696, 1.2040816326530612, 1.0298336805628625, 1.6, 1.3333333333333333, 1.1957723577235773, 1.0, 1.124251497005988, 1.1229022704837117, 1.0762505633168093, 1.0105906412815893, 1.25, 1.0971467391304348, 1.3449612403100775, 1.2184538653366583, 1.0003671173031563, 1.1092436974789917, 1.0473457675753228, 1.031972187613038, 1.0359410308834607, 1.0922098569157392, 1.3396226415094339, 1.2527932960893855, 1.0, 1.0, 1.0006929294374307, 1.6666666666666667, 1.5714285714285714, 1.35, 1.066344993968637, 1.0444444444444445, 1.0367816091954023, 1.1029857204673301, 1.2, 1.1253879577901924, 1.014819205690575, 1.2197309417040358, 1.0196078431372548, 1.25, 1.0339389784024682, 1.0354767184035476, 1.0887949260042282, 1.0580141316474525, 1.0080119641856404, 1.0281949691329586, 1.05, 1.0, 1.0063459829927657, 1.0120958955798962, 1.0074074074074073, 1.2695652173913043, 1.0184535537507808]
origin-bjaq_15.87 	max: 5.0000	99th: 2.6667	95th: 1.5004	median: 1.0566	mean: 1.1451

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 20.282793 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=naru', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[2.9802322e-07 1.7881393e-07 2.9802322e-07 7.1525574e-07 7.7486038e-07]
Distance score: 4.5299529460862686e-07
SAUCE Drift detection: False
Detection latency: 0.0231s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 2.033608 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 7.0000	99th: 2.5050	95th: 1.6667	median: 1.0640	mean: 1.1648
ReportEsts: [1.0485714285714285, 1.0460735360871538, 1.002157660298446, 1.038647342995169, 1.0588235294117647, 2.0, 1.1812189433120373, 1.0039705409066755, 1.6, 1.0166666666666666, 1.0565246723207402, 1.0024925494445949, 1.0281740370898715, 1.0255402750491158, 1.0137426900584796, 1.723756906077348, 1.0950819672131147, 1.197674418604651, 1.4444444444444444, 1.1255946717411989, 1.0440425097077457, 1.045346973051378, 1.0858369098712446, 1.1293345829428303, 1.0359523510070612, 1.0006670160560294, 2.0, 1.0513766986574795, 1.0, 1.0, 1.1536458333333333, 1.0, 1.000584811803334, 1.0112250440700201, 1.2481785063752278, 1.0344696489671779, 1.0364323379296732, 1.0435779816513762, 1.25, 1.047728966794104, 1.068160770513058, 1.0474353628023352, 1.1105651105651106, 1.003350083752094, 1.0220588235294117, 1.064793130366901, 1.1818181818181819, 1.2173913043478262, 1.3655913978494623, 1.1712749615975422, 1.3255813953488371, 1.0354609929078014, 1.027027027027027, 1.0606060606060606, 1.0372958710689582, 1.0312256049960968, 1.0436173306193661, 1.1487414187643021, 1.072289156626506, 1.0232059550706432, 1.046875, 1.066959892521885, 1.105263157894737, 1.0, 1.045045045045045, 1.2727272727272727, 1.0805500417134144, 1.0657205240174672, 1.2857142857142858, 1.0, 1.0847600573500886, 1.0328685258964143, 1.055019305019305, 1.105263157894737, 1.0745087544919336, 1.1224307417336907, 1.0240235585864848, 1.4386792452830188, 1.0638297872340425, 1.034337440471691, 1.0809968847352025, 1.108695652173913, 1.0, 1.375, 1.010392609699769, 1.087719298245614, 1.2127659574468086, 1.5, 2.2, 1.0223911651728552, 1.0791707476330394, 1.0588001589193485, 1.0135547185281983, 1.2150781073126558, 1.0279898218829517, 1.3368544600938967, 1.1176470588235294, 1.1576227390180878, 1.0, 1.135652853792025, 1.3103448275862069, 2.0, 1.0492402850611806, 1.1037005163511187, 1.0338484179543783, 1.0156128955366188, 1.0526315789473684, 1.012790155535416, 1.1054678007290402, 1.0374897568970227, 1.0371185907518088, 1.0213875847678664, 1.1428571428571428, 1.1666666666666667, 1.096439169139466, 1.003027167873702, 1.0874285714285714, 1.0574712643678161, 1.0051514282606762, 1.0, 1.1688751926040062, 1.0874316939890711, 1.5, 1.1846846846846846, 1.1428571428571428, 1.0475206611570247, 1.0118988275200944, 1.11029792746114, 1.0887096774193548, 1.5, 1.3218390804597702, 2.0, 1.6666666666666667, 1.0011118317427963, 1.3076923076923077, 1.1840873634945397, 1.0520280339014623, 1.1024346257889992, 5.0, 1.3333333333333333, 1.0372670807453417, 1.1726907630522088, 1.041555673947789, 1.0720581067908588, 1.323076923076923, 1.0543183052688756, 1.005915047677324, 2.0, 1.0243996901626646, 1.0568295114656032, 1.042116076014381, 1.016029411764706, 1.3333333333333333, 1.0117635128283136, 1.0301507537688441, 1.0098684210526316, 1.246031746031746, 1.0, 1.110330992978937, 1.0427982004242524, 1.056644063986813, 1.0638629283489096, 1.167123287671233, 1.0344827586206897, 1.2647058823529411, 1.1489655172413793, 1.375, 1.0271542110870115, 1.0689655172413792, 1.0279805352798053, 1.0012181951704178, 1.0285714285714285, 1.023715084965137, 1.0107142857142857, 1.0864197530864197, 1.1726027397260275, 1.0775039745627981, 1.2106620808254513, 1.094209161624892, 1.036245110821382, 1.0934094447327452, 1.0208856182738526, 1.062111801242236, 1.0185185185185186, 1.0385185458810275, 1.0615032305553285, 1.0035714285714286, 1.0622637212480073, 1.1792717086834734, 3.0, 1.048661800486618, 1.0054787635084192, 1.3214285714285714, 1.017133956386293, 1.1122395742756774, 1.0058310802631047, 1.003977635183309, 1.0407747196738022, 1.0253717532118187, 1.0219096341590521, 1.0751879699248121, 1.0128333542005759, 1.1291179596174283, 1.018109455005759, 1.1838120104438643, 1.1040091436609811, 1.1648936170212767, 1.0897435897435896, 1.009433962264151, 1.0, 1.0543478260869565, 1.0131940258522536, 1.6647230320699709, 1.1538461538461537, 1.010229132569558, 1.2380952380952381, 1.0024030659807341, 1.1348837209302325, 1.0427598804383926, 2.0, 1.1105263157894736, 1.0663397750216326, 1.0374044095739399, 1.0128711238712305, 1.8571428571428572, 1.1424923391215527, 1.0397815784726891, 1.0320285117481147, 1.0865921787709498, 1.3401360544217686, 1.0133853876185164, 1.077403040951036, 1.0956521739130434, 1.0049575615038013, 1.003575966180785, 1.1118881118881119, 1.1782094594594594, 1.002267573696145, 1.1904761904761905, 1.0781456953642383, 1.0, 1.0065075921908895, 1.176871694962427, 1.0428068803752932, 1.1602373887240356, 1.0769230769230769, 2.5, 1.0588649775402954, 1.1515151515151516, 1.1025361250368624, 2.0, 1.0132978723404256, 1.086021505376344, 1.4285714285714286, 1.0057050037637179, 1.0911161731207288, 1.1608961303462322, 1.110236220472441, 1.022127052105639, 1.005783633616558, 1.140625, 2.0, 1.0088625653884398, 1.1181714285714286, 1.1005830903790088, 1.0317460317460319, 1.054414871144909, 1.0193763329941314, 1.1387205387205388, 1.0053591354906912, 1.0791979949874686, 1.1464976651100733, 1.2061011904761905, 1.7142857142857142, 1.0766829736786818, 1.1654676258992807, 1.2884615384615385, 1.1111111111111112, 1.0160965794768613, 1.1818181818181819, 1.0248235768244687, 1.0189529394936347, 1.1367924528301887, 1.2155388471177946, 1.0199626967203788, 1.015536723163842, 1.013428247856334, 1.0027042074286168, 1.3846153846153846, 1.1421319796954315, 1.0891640866873065, 1.0042464470812638, 1.0270580760828887, 1.0273870995349899, 1.0874463519313304, 1.0022099447513813, 1.0297457689208, 1.022995714435037, 1.0136306862407907, 1.0692580595403363, 1.119047619047619, 1.6111111111111112, 1.1538461538461537, 1.0895860284605434, 1.0833333333333333, 1.050185873605948, 1.0044728195937873, 1.0178261946026244, 1.025, 1.415929203539823, 1.148320895522388, 1.0335512732278045, 1.0173433188805676, 1.15, 1.0948043617703656, 1.0046741584868892, 1.0023419203747073, 2.0, 2.142857142857143, 1.0757889887122782, 1.5, 1.0179453557588072, 1.0706605222734256, 1.1666666666666667, 1.0340601548188855, 1.24, 1.6666666666666667, 1.0305351830258382, 2.0, 1.2717391304347827, 1.0479041916167664, 1.0832356389214537, 1.1063420884048687, 1.1868131868131868, 1.1308411214953271, 1.0300130884144965, 1.0150843125853606, 1.0830601092896175, 1.019929988650504, 1.1081707552636662, 3.0, 1.3, 1.0272668571204946, 1.5, 1.0474236206110352, 1.05, 2.0, 1.0384615384615385, 1.232533889468196, 1.0625990491283677, 1.065217391304348, 1.0616929698708752, 1.2337662337662338, 2.5, 1.034747033956089, 1.288709677419355, 1.032258064516129, 1.0530941990530118, 1.1123188405797102, 1.0589641434262949, 1.0046296296296295, 2.25, 1.0, 1.100880162491537, 1.35, 1.0717171717171716, 1.0099311814033145, 1.0863848611452445, 1.0510204081632653, 1.0, 1.0060639793766113, 1.0434782608695652, 1.121212121212121, 1.5, 1.144220572640509, 1.1111111111111112, 1.1130434782608696, 1.0158730158730158, 1.0181923622148719, 1.0046417259046256, 1.0464646464646465, 1.0930219840314994, 1.0467459762071378, 1.0095890410958903, 1.022636484687084, 1.0130161324035192, 1.0596330275229358, 1.088235294117647, 1.0096014035020808, 1.0331213566507684, 1.040992077161557, 1.07, 1.0434782608695652, 1.1009345794392524, 2.0, 1.9259259259259258, 1.1583333333333334, 1.0354477611940298, 1.5267175572519085, 1.168421052631579, 1.0454318522216675, 1.0862541073384446, 1.1837394867371145, 1.1355547141234381, 1.1167103564302203, 1.0515463917525774, 1.016, 1.0810810810810811, 1.0, 1.0014225333973377, 1.3620689655172413, 1.0037788610512792, 1.0263117644383999, 1.0505845860176568, 1.0066988210075027, 1.8571428571428572, 1.1218537754694367, 1.0, 1.1184696057486891, 1.0, 1.0388039928523014, 1.0098522167487685, 1.079835317282735, 1.1161290322580646, 1.1715881883479649, 4.0, 1.002200488997555, 1.0058522200048303, 1.0039313175695208, 2.0, 1.2222222222222223, 1.0222752585521082, 1.3294117647058823, 1.0996514250563871, 1.0049998603390966, 1.0, 1.059291395516992, 1.0726070038910507, 1.0994893603811948, 1.0185177662618021, 1.090771594278841, 1.063778841967784, 1.0875, 1.1761603375527425, 1.058940783544505, 1.2835820895522387, 1.0641247833622183, 1.0, 1.0, 1.127839065541856, 1.037313432835821, 1.193494299128102, 1.0930148673232545, 1.1819830713422008, 1.0, 1.1111111111111112, 1.2666666666666666, 1.043500494323799, 1.0416666666666667, 1.0, 1.0369877490312733, 1.0, 1.0, 1.1064073226544622, 1.5, 1.1978926572275272, 1.0037565740045078, 1.4069767441860466, 1.1, 1.0113328625590468, 1.0159108989657917, 1.037037037037037, 1.0872702177050002, 1.08, 1.0841530054644808, 1.1571618037135278, 1.0141592920353983, 1.0537439036052405, 1.0, 1.0804597701149425, 1.002446982055465, 1.0108597285067873, 1.1158213474640424, 1.0, 1.0246379537333083, 1.0126273477025436, 1.0424778761061948, 1.0, 1.1255876427132303, 1.0623089284314493, 1.1167487549184163, 1.1659463189626993, 1.028310852866306, 1.0247160662566306, 1.066480055983205, 1.1017405519761516, 2.0, 1.0934833204034136, 1.0611111111111111, 1.0300662878787878, 1.1112966054535336, 1.0668380462724936, 1.0382306465694515, 1.0991735537190082, 1.0801456905189828, 1.1100213219616204, 1.0540527189377173, 1.11864406779661, 1.0097805580379307, 1.2195705842747064, 1.0952380952380953, 1.3513513513513513, 1.0047400007645162, 1.1242105263157895, 1.038455217748562, 1.0082822904042412, 1.3333333333333333, 1.1596511186954872, 1.0469208211143695, 1.2857142857142858, 1.1333333333333333, 1.0155830587478905, 1.1088435374149659, 1.3293233082706768, 1.0, 1.0125786163522013, 1.0494440501537734, 1.0309680823001846, 1.0230960106890628, 1.0038899516002722, 1.044412085911904, 1.1416861826697893, 1.0775532495903877, 1.1007775698522295, 1.1319444444444444, 1.0490602349800562, 1.104750304506699, 1.0765765765765767, 1.0095750198702185, 1.0748663101604279, 1.0172488085134164, 1.0, 1.0711111111111111, 1.4655737704918033, 1.0166404799314384, 1.0313807531380754, 1.0910891089108912, 1.2135761589403973, 1.1129186602870813, 1.0431280698113394, 1.0, 1.719298245614035, 1.8571428571428572, 1.0, 1.16, 1.3333333333333333, 1.4329159212880143, 1.0711111111111111, 1.0414640734737979, 1.0103171570500573, 1.0437922928983545, 1.0273674708682095, 1.0092770411296978, 1.0183330157606771, 1.0239733283892414, 1.0822351080653663, 1.0567731318722418, 1.0070283356060288, 1.0733628754308222, 1.058890147225368, 1.0844390832328106, 1.0843373493975903, 1.0016544933618499, 1.274936061381074, 1.0128550074738416, 1.0636363636363637, 1.1212771666219479, 1.1954022988505748, 2.5, 1.0578512396694215, 1.0666666666666667, 4.0, 1.2023460410557185, 1.016781305312213, 1.0277456647398844, 1.082687338501292, 1.0710382513661203, 1.038102860746292, 1.1728992670870972, 1.0326678765880217, 1.0, 1.5, 1.0102279991476668, 1.1777777777777778, 1.01875254790053, 1.007020828457758, 1.0, 1.0469330855018588, 1.1366906474820144, 1.0259220432669398, 1.1987860394537178, 1.007046339272346, 1.016719121507401, 1.0116127120840983, 1.1866666666666668, 7.0, 1.0843921491076285, 1.0, 1.065947242206235, 1.140495867768595, 1.0995405819295558, 1.6666666666666667, 1.1333333333333333, 1.039219934994583, 1.0612244897959184, 1.0419618528610355, 1.018987341772152, 1.0558882235528941, 1.0745341614906831, 1.0244422890397673, 1.0190562613430127, 1.0042345276872964, 1.1666666666666667, 1.0813383208645053, 1.1149949705417446, 1.0909090909090908, 1.018646408839779, 1.0502879390055966, 1.0861423220973783, 1.07314122702488, 1.3, 1.184782608695652, 1.018573113207547, 1.037122969837587, 1.1409395973154361, 1.0061593930744386, 1.1818181818181819, 1.8888888888888888, 1.0537190082644627, 1.0485915492957747, 1.04011360103993, 1.0891034482758621, 1.0427917114764174, 1.0096224044830013, 1.158878504672897, 1.0, 1.1012269938650308, 1.01670453336048, 1.0715396578538103, 1.0160060975609757, 1.197460595446585, 1.0713163211853625, 1.6491228070175439, 1.1015752308527973, 1.15, 1.6, 1.0074441687344913, 1.0025436046511629, 1.0725502512562815, 1.2984, 1.3333333333333333, 1.0046656298600312, 1.0949082092137166, 1.4224137931034482, 1.0108124592800012, 2.3333333333333335, 1.036570910612188, 1.0, 1.501457725947522, 1.2142857142857142, 1.0924781713224843, 1.393939393939394, 1.2212389380530972, 1.1145833333333333, 1.0, 1.0007204610951008, 1.0645348837209303, 2.25, 1.0, 1.0933333333333333, 1.0560747663551402, 1.0637132901941264, 1.0412186379928314, 1.084022038567493, 1.0852459016393443, 1.1497175141242937, 1.0357426528991263, 1.6666666666666667, 1.1576923076923078, 1.064516129032258, 1.0, 1.0494699646643109, 1.232810615199035, 1.0279965004374454, 1.263013698630137, 1.0037273201836339, 1.2336910236756942, 1.008994437893931, 1.0525127896479085, 1.0328685258964143, 1.019019019019019, 1.2, 1.5, 1.0, 1.0334887497708045, 1.1915444348576358, 1.002717391304348, 1.2278481012658229, 1.021051962093748, 1.097700938467374, 1.0035660392748629, 1.0103092783505154, 1.3043478260869565, 1.013842746400886, 1.102440096724555, 1.0642221710695572, 1.011984606926883, 1.1818181818181819, 1.0600667408231368, 1.100190994432332, 1.0028863636363636, 1.0758893280632411, 1.004650871451166, 1.1696113074204948, 1.053237981724275, 1.042137718396711, 1.002159166455849, 2.4545454545454546, 1.0283987915407855, 1.0, 1.0662525879917184, 1.0328703124348224, 1.2, 1.0104449676990883, 1.2116071428571429, 1.2040816326530612, 1.073368059403746, 1.0332600247040038, 1.0996395896867204, 1.0, 1.0401913875598086, 1.0079387382324012, 1.2105263157894737, 1.0588235294117647, 1.0, 1.1, 1.0171462078168914, 1.8571428571428572, 1.0278884462151394, 1.0776171664571736, 1.0005508630187294, 1.095617529880478, 1.0039008179134334, 1.0362507870828461, 1.0188679245283019, 1.0023612750885478, 1.0399058830886607, 1.06377710266761, 1.0068477835541394, 1.0276804484933426, 1.3, 1.1788079470198676, 1.260135135135135, 1.0359068847744024, 1.045945945945946, 1.0125044029587884, 1.2138643067846608, 1.0344827586206897, 1.0037625955179228, 1.0323699421965318, 1.0012070066235736, 1.25, 1.0002353494939986, 1.0064964381597676, 1.1451187335092348, 1.0014049877063576, 1.2777777777777777, 1.1040056219255094, 1.0232292081177876, 1.098891615195871, 1.144283121597096, 1.0037520684322205, 1.024390243902439, 1.0856001229445214, 1.1830635118306352, 1.1539456662354464, 1.6956521739130435, 1.0573698146513681, 1.1360225140712945, 1.107633949739213, 1.0335505879959626, 1.0533980582524272, 1.039598160677152, 1.073968195942241, 1.0666666666666667, 1.059556786703601, 1.0403090359422238, 1.0802919708029197, 1.064406779661017, 1.1614745586708204, 1.1988011988011988, 1.0393835616438356, 1.0, 1.015261165194823, 1.2307692307692308, 1.0297897196261683, 1.0131985028563923, 1.030447390223695, 1.6031496062992125, 1.008899871909515, 1.0415213741443885, 1.0558546433378198, 1.1317991631799162, 1.0069373664310373, 1.1042586882240186, 1.0247295208655331, 1.3767441860465117, 1.0261324041811846, 1.0559647493358102, 1.0098039215686274, 1.75, 1.0130860552269967, 1.0088202482220052, 1.0317693059628543, 1.2105263157894737, 1.0036144578313253, 1.0093040391576658, 1.0049739459971578, 1.0935613682092555, 1.2903225806451613, 1.1333711691259931, 1.0476190476190477, 1.0952380952380953, 1.6666666666666667, 1.0641602189882964, 1.0016420361247949, 1.0819140308191404, 1.2380952380952381, 1.3257751937984497, 1.0333333333333334, 1.0198019801980198, 1.35, 1.0222910216718266, 1.094170403587444, 1.0125231910946197, 1.3, 1.0351100619162992, 1.0258064516129033, 1.1534129006302802, 1.0948275862068966, 1.3333333333333333, 1.0985834056085575, 1.0812054469731238, 1.0239869236532044, 1.298, 1.4303797468354431, 1.0555555555555556, 1.2058823529411764, 1.2857142857142858, 1.4482758620689655, 1.0557156580211335, 1.0119428275481597, 1.0051957501189333, 1.0253164556962024, 1.002317722010367, 1.0015564884285726, 5.0, 1.0017955465964874, 1.1204099060631938, 1.0, 1.4285714285714286, 1.0267484662576687, 1.0555390024432394, 1.0700773903306677, 1.0869565217391304, 1.0, 1.125, 1.1505102040816326, 1.2083333333333333, 1.0296176598385214, 1.0712461905938555, 1.0173009373362571, 1.1104166666666666, 1.3333333333333333, 1.0084486517753848, 1.063953488372093, 1.1944728761514842, 1.1140350877192982, 1.0921658986175116, 1.0, 1.3, 1.0830843090187625, 1.069647597730467, 1.2222222222222223, 1.0394736842105263, 1.0296415967734542, 1.2237710931768158, 1.1267605633802817, 1.203125, 1.0415508318720328, 1.093484709010944, 1.0388562576647518, 1.5307692307692307, 1.3225806451612903, 1.0344827586206897, 1.1, 1.0398112651135358, 1.0399002493765586, 1.0114756961772633, 1.055045871559633, 2.0, 1.2608695652173914, 1.0023715732775946, 1.1047619047619048, 1.327123815641561, 1.1042105263157895, 1.0259667736981712, 1.0994675112240282, 1.1366594360086768, 1.1481481481481481, 1.0160788724938794, 1.0286385137451155, 1.0980872976949485, 1.0242057488653555, 3.0, 1.0681818181818181, 1.0466897083409128, 1.2787610619469028, 1.0242358690862476, 1.0036271571090312, 1.109167671893848, 1.8, 1.048951048951049, 1.032509715766212, 1.0180026530225508, 1.0125786163522013, 1.0366521304579155, 1.1574074074074074, 1.2232142857142858, 1.0943579766536966, 1.0015910344451382, 1.044661287295928, 1.0859301227573182, 1.138495092693566, 1.0263157894736843, 1.0355798593849868, 1.0852012808783165, 1.0834452355012796, 1.0298284862043252, 1.0518590998043054, 1.0509259259259258, 1.02, 1.0400696864111498, 3.0, 1.5, 1.6428571428571428, 1.0127659574468084, 1.1518987341772151, 1.0621834115416886, 1.0419512847766785, 1.0088596092685143, 1.0022561610551892, 1.0493273542600896, 1.0, 1.0089613487034397, 1.8333333333333333, 1.1176470588235294, 1.1838014725934005, 1.0, 1.2034120734908136, 1.1165568369028007, 1.096943756101224, 1.026298866136402, 1.0, 1.0099606815203146, 1.2155172413793103, 1.0549066529922322, 1.0004552201123131, 1.0084566596194504, 1.036751630112626, 1.0318424443217376, 1.0742059672762272, 1.0941935483870968, 1.5185185185185186, 1.1968145620022752, 1.0, 4.0, 1.0012934729936258, 1.75, 1.625, 1.5116279069767442, 1.0320962888665999, 1.0089233459793303, 1.0947603121516165, 1.0038167938931297, 1.0, 1.003352490421456, 1.012941762070682, 1.1267605633802817, 1.0182186234817814]
origin-bjaq_15.87 	max: 7.0000	99th: 2.5050	95th: 1.6667	median: 1.0640	mean: 1.1648

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 16.714424 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=39.063262