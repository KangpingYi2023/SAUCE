Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='naru', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 37, 'naru': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 5.0000	99th: 2.6667	95th: 1.5449	median: 1.0555	mean: 1.1483
ReportEsts: [1.0787671232876712, 1.0431947840260798, 1.0434920443223332, 1.0076923076923077, 1.0333333333333334, 1.0, 1.2721448650062104, 1.0221213658572257, 1.25, 1.0290620871862615, 1.0667474677517097, 1.0028354772836647, 1.000419991600168, 1.069767441860465, 1.0166019074531967, 1.0, 1.6666666666666667, 1.0396741055614593, 3.0, 2.6666666666666665, 1.2272727272727273, 1.116756523614406, 1.0246231033390973, 1.0923669018601667, 1.002466699555994, 1.0, 1.0482377196714336, 1.5, 1.4, 1.2158273381294964, 1.0, 1.004502771424102, 1.0045734707937601, 1.3285238623751388, 1.0082926106915444, 1.0120844898788166, 1.0218579234972678, 1.003758335608158, 1.111543494731042, 1.2738095238095237, 1.0, 1.0152439024390243, 1.0, 1.1483542846175991, 1.0822150239086843, 1.2231404958677685, 1.1262135922330097, 1.3162790697674418, 1.031396904341554, 1.0, 1.0599479655994797, 1.0601092896174864, 1.0045598156758322, 2.0, 1.1324675324675324, 1.0137073232643736, 1.056879323597233, 1.064638783269962, 1.15527950310559, 1.25, 1.0388040712468194, 1.0330012453300124, 1.1090909090909091, 1.160919540229885, 1.0, 1.1266830500848015, 1.1118385160938353, 1.1666666666666667, 1.0, 1.096493918021057, 1.035799522673031, 1.0572254335260116, 1.1058558558558558, 1.1524381242926733, 1.2329411764705882, 1.108829568788501, 1.0, 1.0444832097688617, 2.0, 1.049040144623949, 1.15625, 1.038799271497333, 1.1717791411042944, 1.040137614678899, 1.0892570817744522, 1.04, 1.0046771665930503, 1.0909809521381033, 1.1519607843137254, 2.3333333333333335, 1.1054187192118226, 1.0039350394974442, 1.0918367346938775, 1.3394109396914446, 1.2166666666666666, 1.0576923076923077, 1.238532110091743, 1.0244755244755244, 1.0, 1.0033907379316498, 1.065946724262059, 1.0095238095238095, 1.0152617060151183, 1.1470588235294117, 1.0001916834520619, 1.1366928183464091, 1.0803512039377412, 1.050436101630641, 1.0232120451693851, 1.1666666666666667, 1.3333333333333333, 1.0991268618387262, 1.011114972250897, 1.0525265957446808, 1.0, 1.0045781401231526, 1.0, 1.2126195028680689, 1.1789473684210525, 1.0, 1.2362637362637363, 1.1666666666666667, 1.0325814536340852, 1.0153798809368002, 1.1275141725557194, 1.0566037735849056, 1.8, 1.2309602649006623, 1.0, 1.1071428571428572, 1.000889470509452, 1.1818181818181819, 1.0208333333333333, 1.0142249744076068, 1.0416479706302264, 1.1795275590551182, 1.0055096418732783, 1.026810724289716, 1.00199203187251, 1.0478927203065134, 1.0729342875731946, 1.2407407407407407, 1.00587084148728, 1.0453660708606323, 2.0, 1.0176252319109462, 1.0355029585798816, 1.0601736972704714, 1.0187047820716428, 1.0, 1.0094453862920805, 1.0340740740740741, 1.018, 1.4476190476190476, 1.094890510948905, 1.0472016183412003, 1.060178034876864, 1.0661466317972765, 1.129277566539924, 1.105263157894737, 1.0204081632653061, 1.210144927536232, 1.145025295109612, 1.2857142857142858, 1.0003313304259835, 1.0252918436282397, 1.0299366724237191, 1.0266090016126668, 1.0183262064752596, 1.0003710476796268, 1.0127931769722816, 1.0756302521008403, 1.213421129079113, 1.0928176795580111, 1.1285296981499513, 1.079748163693599, 1.0344611528822054, 1.0355452138329455, 1.1280136245099257, 1.0, 1.1150442477876106, 1.0524283380365365, 1.0474002923366048, 1.1309655937846836, 1.1014492753623188, 1.0398086470714634, 1.021197252208047, 1.0111393180723947, 1.1153846153846154, 1.0518181818181818, 1.04349521243048, 1.0, 1.3636363636363635, 1.0774816296360712, 1.2962542565266741, 1.099341104916371, 1.3461538461538463, 1.0064308681672025, 1.0037236648701617, 1.0053567986516108, 1.1798245614035088, 1.0181300727311058, 1.3111111111111111, 1.046875, 1.0238095238095237, 1.0, 1.0738255033557047, 1.093841642228739, 1.6689895470383276, 1.0344827586206897, 1.013840830449827, 1.0957683741648108, 1.076323068412318, 1.0104000224259244, 1.059086531847572, 1.1210191082802548, 1.0146627565982405, 1.031072502505847, 1.0097937848239416, 1.1070282067224118, 1.0, 1.0935817805383024, 1.020207590648573, 1.0064982307104093, 1.0838635049161365, 1.0363788586706997, 1.0043985789206564, 1.0344827586206897, 1.0008075355078112, 1.0147847703781239, 1.1787930062041738, 1.0364583333333333, 1.1126322339763535, 1.0212765957446808, 1.0866141732283465, 1.0, 1.0131673449844385, 1.0510272443054935, 1.0775448345541803, 1.4291044776119404, 1.0909090909090908, 2.6666666666666665, 1.1222806493026856, 1.1454545454545455, 1.1038951841359774, 1.5, 1.5, 1.3333333333333333, 1.020296643247463, 1.530612244897959, 1.1464088397790055, 1.1245551601423487, 1.0631399317406143, 1.014480408858603, 1.0412585157415246, 1.105263157894737, 1.0, 1.0041946826229105, 1.0880334842870867, 1.0980735551663747, 1.0026130401153919, 1.0983898003758825, 1.0473589281113116, 1.0858505564387917, 1.0394521416122389, 1.0639952153110048, 1.1284504391468004, 1.2468228448935845, 1.7272727272727273, 1.1004468575821642, 1.2579957356076759, 1.2727272727272727, 1.0869565217391304, 1.0752727272727274, 1.0555555555555556, 1.1584158415841583, 1.011600834398762, 1.1309192200557103, 1.209090909090909, 1.00049483911907, 1.077757685352622, 1.0001057037059058, 1.0114819943863447, 1.4, 1.0446526009457984, 1.0, 1.0132214899141203, 1.0151187904967602, 1.002271175640617, 1.275, 1.1, 1.0454545454545454, 1.647887323943662, 1.0128753515795692, 1.0, 1.039755351681957, 1.0091324200913243, 1.0404647435897436, 1.0029155198275737, 1.0862068965517242, 1.0377358490566038, 1.0021797215581494, 1.1194477451479659, 1.0732188841201717, 1.1623931623931625, 1.0, 1.2362768496420047, 1.0099502487562189, 1.190031152647975, 1.0432413429425207, 1.0243485689876122, 1.0253521126760563, 1.0535714285714286, 1.0150891632373114, 1.0970846306255306, 1.4285714285714286, 1.0027648355862333, 1.0604395604395604, 1.1176470588235294, 1.0132815749341466, 1.0476190476190477, 1.75, 1.025361549429452, 2.0, 1.0150891632373114, 1.055232558139535, 1.0254306808859721, 1.002269288956127, 1.0052219321148825, 1.10989010989011, 1.0228493350829964, 1.0034277246747325, 1.0208623087621698, 1.0135131810913862, 1.0822980197274301, 3.0, 1.2222222222222223, 1.0322223008515556, 1.3333333333333333, 1.0475409836065575, 1.0, 1.0, 1.0454545454545454, 1.1731448763250882, 1.0863723608445297, 1.18348623853211, 1.0432900432900434, 1.0, 1.0213049267643142, 1.0175854635047736, 1.5, 1.1911852293031566, 1.0, 1.012662263721248, 1.0674157303370786, 1.0514825505116767, 1.1682027649769586, 1.0018181818181817, 1.087037037037037, 1.0555555555555556, 1.0201644316368284, 1.0036077812626272, 1.043941411451398, 1.0, 1.1428571428571428, 1.8333333333333333, 1.5, 1.1428571428571428, 1.0020309396952305, 1.25, 1.0915141430948418, 1.118811881188119, 1.005802609907513, 1.0570770880744984, 1.0156903765690377, 1.0739385065885798, 1.0292537313432837, 1.274658573596358, 1.5, 1.023454157782516, 1.0444444444444445, 1.0122538516879023, 1.3333333333333333, 3.142857142857143, 1.0378619153674833, 1.0372093023255815, 1.0064453225227075, 1.1877729257641922, 1.342769701606733, 1.0463784712281707, 1.2903225806451613, 1.0808477237048666, 1.0625, 1.25, 1.055306427503737, 1.1181818181818182, 1.034733540391771, 1.0150954702693868, 1.010940531421341, 1.323076923076923, 1.099009900990099, 1.081570996978852, 1.0, 1.0419910593199055, 1.008857445838435, 1.0185097508736332, 1.006771387895247, 1.0312679288582902, 1.0115718418514947, 1.8333333333333333, 1.0135069946936806, 1.2, 1.0597779675491033, 1.1111111111111112, 1.0059845549294697, 1.027536231884058, 1.059866723989682, 1.2055335968379446, 1.119496855345912, 3.0, 1.1756198347107438, 1.0029204916615868, 1.0338421923855068, 1.0, 1.1454545454545455, 1.036468330134357, 1.2614942528735633, 1.0838657501010918, 1.103211009174312, 1.1666666666666667, 1.1251078515962036, 1.0899572299997662, 1.0424582882311224, 1.0142571747912028, 1.2575657894736842, 1.3051409618573797, 1.071969696969697, 1.25, 1.0126903553299493, 1.3, 1.0457025920873124, 1.064516129032258, 1.0111964780832645, 1.1904761904761905, 1.1386054153107328, 1.0607590783141316, 1.1504613200851668, 1.0, 1.0857142857142856, 1.24, 1.000155672309788, 1.2560175054704594, 1.0, 1.0688035368886433, 1.0147083363131422, 1.1679574056147144, 1.0, 2.0, 1.1588349514563108, 1.0072202166064983, 1.3495575221238938, 1.0, 1.0308645029355499, 1.059, 1.0869565217391304, 1.0525047080979284, 1.018181818181818, 1.0196850393700787, 1.1548387096774193, 1.0281867900715187, 1.1303599104529016, 1.0, 1.0675675675675675, 1.096638957861024, 1.003684259359488, 1.034530745693088, 1.0, 1.0184726289704888, 1.0064271599553238, 1.0282870612886328, 2.0, 1.1192185007974482, 1.0758085777505768, 1.0959925141972122, 1.1770127997903106, 1.0238671878478127, 1.1726954492415402, 1.0336134453781514, 1.052073288331726, 2.0, 1.1009871311178872, 1.3214285714285714, 1.0, 1.269736842105263, 1.1063829787234043, 1.034633826623892, 1.1188212927756653, 1.0374734789838866, 1.1565817409766455, 1.0335223443563941, 1.0626268091437847, 1.0320861795947618, 1.174757281553398, 4.0, 1.0464962189413036, 1.0497975708502025, 1.0077328706927053, 1.0124735039947823, 1.0904564315352696, 1.1197991391678623, 1.094240837696335, 1.4285714285714286, 1.040836236933798, 1.0127163586306502, 1.0139150479296095, 1.1250922509225092, 1.0187604361064728, 1.0123711340206185, 1.0029761615769286, 1.0433314575126618, 1.0782967032967032, 2.0, 1.0909090909090908, 1.1241379310344828, 1.0680529300567108, 1.0170648464163823, 1.098692033293698, 1.0647181628392484, 1.1242937853107344, 1.0554699537750385, 1.10989010989011, 1.0134950138010863, 1.3294117647058823, 1.054577636322302, 1.0, 1.0021551724137931, 1.4404761904761905, 1.3049645390070923, 1.0654761904761905, 1.1687979539641944, 1.051975051975052, 1.0570687418936446, 1.051992306231003, 1.0, 1.9574468085106382, 1.3333333333333333, 1.0, 1.0232558139534884, 1.2127139364303179, 1.3305954825462012, 1.1195652173913044, 1.0283562960589554, 1.129750982961992, 1.0051131961780149, 1.0115361861565766, 1.0980392156862746, 1.0104801884688843, 1.1280487804878048, 1.091026468689477, 1.1282051282051282, 1.1081229418221734, 1.0086705202312138, 1.0421703682878831, 1.0310899780541332, 1.04868310902183, 1.0141277278789524, 2.0, 1.0049140049140048, 1.0351201478743068, 1.034013605442177, 1.0, 1.02, 1.1538461538461537, 1.0700757575757576, 1.5185185185185186, 1.5, 1.0301270055972085, 1.0200462057934956, 1.005315709149228, 1.017510175869749, 1.1027027027027028, 1.031591737545565, 2.0, 1.1666666666666667, 1.1770579639551875, 1.0203130293380311, 1.00627876423603, 1.0135550746098645, 1.0204898980868944, 1.0606060606060606, 1.0439251466343915, 1.1616341030195383, 1.026134044890912, 1.0209341290310434, 1.4242424242424243, 1.0771704180064308, 1.0, 1.0068027210884354, 1.0214876320177877, 3.0, 1.0974515800203875, 1.043642022644233, 1.2857142857142858, 1.1451672785776164, 1.2, 1.1176470588235294, 1.0030453257790368, 1.7692307692307692, 1.007293668346567, 1.0286202477573687, 1.1875, 1.3181818181818181, 1.3623595505617978, 1.0306073648971783, 1.1005830903790088, 1.0462023321777498, 1.011382591174155, 1.0, 1.233217466869433, 1.003058103975535, 2.0, 1.1078257259496735, 1.0070248291374686, 1.1125827814569536, 1.00468612554978, 1.0030372057706909, 1.3294117647058823, 2.142857142857143, 1.0494484594903004, 1.062553556126821, 1.0794631191352893, 1.043028685790527, 1.033836861488453, 1.1115602013162988, 1.02014652014652, 1.0251716247139588, 1.15, 1.032122749627256, 1.0681388012618296, 1.0288909599254428, 1.1496848739495797, 1.0783842775620402, 4.0, 1.0029712602876601, 1.007228746783608, 1.0267244122517003, 1.1176470588235294, 1.045618664074434, 1.2374429223744292, 1.0, 1.026723638470452, 1.0134426229508198, 1.0878859857482186, 1.0294117647058822, 1.6666666666666667, 1.0125924542139748, 1.5, 1.3806451612903226, 1.1538461538461537, 1.0969925336682715, 1.3333333333333333, 1.1285714285714286, 1.0932914046121593, 1.0, 1.2261904761904763, 1.0019659239842726, 2.0, 1.0, 1.08130081300813, 1.0861423220973783, 1.057372175980975, 1.029157667386609, 1.0, 1.0626959247648904, 1.089150378938971, 1.0467532467532468, 1.5605095541401275, 1.2009803921568627, 1.3461538461538463, 1.0, 1.2456140350877194, 1.1847041847041848, 1.021097046413502, 1.13874469089193, 1.006821867581733, 1.2289083146981095, 1.0097085939584383, 1.0404135338345866, 1.0673886883273165, 1.0143198090692125, 1.375, 1.0, 1.0303030303030303, 1.0383684919740586, 1.1240079365079365, 1.0065359477124183, 1.1340782122905029, 1.0477281405116456, 1.031048704120057, 1.0050636075688892, 1.0897435897435896, 1.1578947368421053, 1.0540340488527018, 1.157807529162248, 1.0329748537086827, 1.0510580367173767, 1.2105263157894737, 1.04555522740697, 1.0028248694971125, 1.0611413043478262, 1.0650759219088937, 1.2222222222222223, 1.0674698795180724, 1.0461711711711712, 1.0384615384615385, 1.1762820512820513, 1.0347890451517394, 1.0, 1.1032745591939546, 1.0345496829460088, 1.1111111111111112, 1.0307707456367083, 1.1875, 1.048780487804878, 1.0173009122960055, 1.0019866353621094, 1.1740867579908676, 1.0174757281553397, 1.0601589103291713, 1.0107642019837693, 1.1642411642411643, 1.0714285714285714, 1.0, 1.25, 1.0113600581324937, 1.8333333333333333, 1.0234238380119651, 1.0368585428894512, 1.188967656180771, 1.0731031543052003, 1.0025526817419081, 1.1060021436227223, 1.08984375, 1.0098039215686274, 1.0264306008875947, 1.112756858245541, 1.001394914076169, 1.0466698783572204, 1.4285714285714286, 1.0491803278688525, 1.2608695652173914, 1.004037169804754, 1.009771986970684, 1.0202194020219402, 1.129203539823009, 1.0311890838206628, 1.0517763299425305, 1.0191518467852256, 1.0039114832535885, 1.3125, 1.0018002965194268, 1.0116290618947508, 1.1161460624725033, 1.0008428150021071, 1.1875, 1.0086393088552916, 1.0895522388059702, 1.5, 1.0469108763997315, 1.3461538461538463, 1.1965725806451613, 1.0285714285714285, 1.1368846931894807, 1.0905251560778553, 1.076470588235294, 1.3636363636363635, 1.0926829268292684, 1.011305562704511, 1.0009787891932775, 1.0060821306875125, 1.0599743980071963, 1.043096976728315, 1.0, 1.043657331136738, 1.1228339548146524, 1.1120362516183757, 1.0162932790224033, 1.1944444444444444, 1.0511848341232228, 1.0199495330730908, 1.208955223880597, 1.0048154933263544, 1.0, 1.3333333333333333, 1.013987984869836, 1.0196556671449069, 1.0141393682078448, 1.0304621848739495, 1.0566640063846768, 1.1166253101736974, 1.0087628510315325, 1.0838237217209363, 1.0522243713733075, 1.2756756756756757, 1.0133053221288515, 1.0107004368526973, 1.0, 1.75, 1.0245000423692907, 1.006914819461871, 1.0057012542759407, 1.2394366197183098, 1.0412744388124549, 1.0021277335465701, 1.0105113636363636, 1.105, 1.3076923076923077, 1.1064690026954178, 1.0532150776053215, 1.0875, 1.4827586206896552, 1.049715051961113, 1.0138751238850348, 1.0855085508550855, 1.2058823529411764, 1.033992041996857, 1.0641864268192969, 1.0083012755618546, 1.0303030303030303, 1.3333333333333333, 1.12, 2.0, 1.0170031880977684, 1.4615384615384615, 1.3333333333333333, 1.5, 1.2336601307189543, 1.0635838150289016, 1.0701770547377343, 1.0160844026602371, 1.1627906976744187, 1.5441176470588236, 1.0, 1.0, 1.2972972972972974, 1.5909090909090908, 1.01743264659271, 1.014595138555885, 1.0009544926147527, 1.0390625, 1.0158661770036177, 1.0015214453731045, 5.0, 1.0049590010547447, 1.1828571428571428, 1.0, 1.3333333333333333, 1.0023668639053254, 1.0880011475292262, 1.0561530124930032, 1.062111801242236, 1.0, 1.1466666666666667, 1.0644171779141105, 2.0, 1.5, 1.0696358267716535, 1.0518947963800904, 1.1560017333525927, 1.25, 1.0023048275358906, 1.0704879938032532, 1.0306553911205074, 1.1428571428571428, 1.0544554455445545, 1.003522665393846, 1.3289473684210527, 1.1060405908490454, 1.0449718292732357, 1.0211764705882354, 1.00390625, 1.0105368651086397, 1.205807002561913, 1.1115702479338843, 1.15, 1.0480107970565986, 1.2711594911937378, 1.0498210387509281, 1.8764044943820224, 1.1333333333333333, 1.1940298507462686, 1.0126262626262625, 1.0332013402375875, 1.0180467630651044, 1.0170147537842498, 1.0534934497816595, 3.0, 1.25, 1.0006073003899507, 1.1578715919085312, 1.3561563898074305, 1.0153775219011303, 1.0371299548419468, 1.0609544556053088, 1.054421768707483, 1.0, 1.0067268122823678, 1.002058841695662, 1.0618738951090159, 1.0507880910683012, 2.5, 1.04, 1.0370159020010652, 1.0427718040621266, 1.0167650044410608, 1.0106792675723568, 1.1008522727272727, 2.0, 1.0166270783847982, 1.0385628550485615, 1.0253598355037696, 1.11787072243346, 1.025872550421971, 1.319327731092437, 1.254847645429363, 1.0405797101449274, 1.0044141017977168, 1.053429698931406, 1.1163594470046083, 1.1216389244558258, 1.0, 1.0430622009569377, 1.000365797896662, 1.105680317040951, 1.0556183559985841, 1.0484247374562428, 1.0492063492063493, 1.3846153846153846, 1.0573248407643312, 2.5, 1.5, 1.4166666666666667, 1.0179028132992327, 1.1856240126382307, 1.0052359909391362, 1.043608284234958, 1.00325644504749, 1.0757322175732218, 1.0869565217391304, 1.2857142857142858, 1.015066825214859, 1.6, 1.3333333333333333, 1.269918699186992, 1.0, 1.209339774557166, 1.1340977068793618, 1.0391167192429023, 1.0222768661440327, 1.25, 1.0352564102564104, 1.3255813953488371, 1.1037406483790524, 1.0005875170976655, 1.0804911323328785, 1.0458452722063036, 1.0262800271793437, 1.0132475603772557, 1.1081081081081081, 1.5777777777777777, 1.2583798882681565, 1.0, 1.0, 1.0006661063624334, 1.6666666666666667, 1.5714285714285714, 1.5, 1.0808202653799759, 1.0804597701149425, 1.0169109357384443, 1.1053772766695578, 1.0, 1.1843575418994414, 1.0288461538461537, 1.1345291479820627, 1.017114914425428, 1.25, 1.0083584085590103, 1.0637472283813747, 1.0842105263157895, 1.0111565637783562, 1.0120679389962248, 1.12478580788227, 1.048697270471464, 1.0, 1.0470895720740676, 1.0166142439311276, 1.03125, 1.2695652173913043, 1.03383346581876]
origin-bjaq_15.87 	max: 5.0000	99th: 2.6667	95th: 1.5449	median: 1.0555	mean: 1.1483

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 16.289965 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=naru', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[3.5762787e-07 5.9604645e-07 3.5762787e-07 1.4305115e-06 1.7881393e-07]
Distance score: 5.841255301675119e-07
SAUCE Drift detection: False
Detection latency: 0.0233s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 2.058690 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 6.1111	99th: 3.0000	95th: 1.6683	median: 1.0722	mean: 1.1698
ReportEsts: [1.0812324929971988, 1.026202846171222, 1.0248541171385346, 1.0032, 1.0588235294117647, 1.0, 1.1574516836023112, 1.0105923182141903, 1.4, 1.0625698324022346, 1.0184497424224273, 1.0012957809516592, 1.0031612223393045, 1.0329457364341086, 1.026564344746163, 6.111111111111111, 1.0371517027863777, 1.2608695652173914, 1.6666666666666667, 1.2301507537688443, 1.162009451407438, 1.0723127750284454, 1.0306469920544836, 1.092153284671533, 1.0360091907804982, 1.007152986908791, 2.0, 1.0410427517361112, 1.2857142857142858, 1.6, 1.043778801843318, 1.0, 1.0112049756015007, 1.011624121782861, 1.4004608294930876, 1.006999017681729, 1.0168290272483411, 1.0129870129870129, 3.0, 1.0592321023863485, 1.009786723294248, 1.0483463917525773, 1.04093567251462, 1.0110367602329018, 1.0405156537753222, 1.080138063016882, 1.037037037037037, 1.026334352221961, 1.2659574468085106, 1.0967032967032968, 1.05, 1.0217391304347827, 1.1071428571428572, 1.15625, 1.0993270621421656, 1.0048890714872638, 1.0219123505976095, 1.167420814479638, 1.0975609756097562, 1.0047191639090918, 1.0597014925373134, 1.003477057401348, 1.0864022662889519, 1.0183150183150182, 1.1553398058252426, 1.2727272727272727, 1.101040161802947, 1.0938482263134262, 1.1428571428571428, 1.0, 1.0845934139784945, 1.0158572844400398, 1.0629202689721422, 1.1043643263757115, 1.1237744607627356, 1.1823056300268096, 1.042796648346698, 1.15, 1.1205673758865249, 1.00150908192943, 1.1917098445595855, 1.0076923076923077, 2.0, 1.1111111111111112, 1.0484633569739952, 1.032258064516129, 1.3068181818181819, 1.2, 1.3333333333333333, 1.0051861574414958, 1.0852384062704115, 1.0928365491239742, 1.0619984221551184, 1.113622162049573, 1.0266666666666666, 1.2843601895734598, 1.1395348837209303, 1.1814671814671815, 2.25, 1.1161776367961935, 1.3125, 2.0, 1.0584772086975367, 1.1620350577169731, 1.0107991360691144, 1.0017136947850496, 1.05, 1.0069055422342754, 1.0509509274477578, 1.0119249835338164, 1.113284947933102, 1.023341201153947, 1.1428571428571428, 1.2, 1.1661024599413226, 1.0164649405906403, 1.0541899441340783, 1.010752688172043, 1.006380185758514, 1.0, 1.2493506493506494, 1.191714053614947, 1.0, 1.1608695652173913, 1.0, 1.1470588235294117, 1.0176609741080398, 1.1635998444991578, 1.0564516129032258, 3.0, 1.2904564315352698, 1.0, 1.2, 1.006697247706422, 1.0769230769230769, 1.0518847006651886, 1.027145309249639, 1.0727298206278026, 1.0, 1.4, 1.1099585062240664, 1.021875, 1.0366047745358091, 1.0005291292432095, 1.2380952380952381, 1.0390879478827362, 1.022668145399517, 2.0, 1.018007662835249, 1.1144957983193278, 1.078686816050026, 1.0086412395709177, 1.0, 1.064332509934486, 1.0074074074074073, 1.033955857385399, 1.3333333333333333, 1.0, 1.0998003992015968, 1.0236359468133884, 1.0578108555104495, 1.0543478260869565, 1.143250688705234, 1.0357142857142858, 1.1091954022988506, 1.1312849162011174, 1.1111111111111112, 1.0048450843126855, 1.1196581196581197, 1.0816568047337278, 1.001696808049267, 1.0328542094455853, 1.040549917599098, 1.0298245614035089, 1.084063047285464, 1.2026043351666127, 1.1190042501517912, 1.1439205955334988, 1.0254237288135593, 1.0452512496711392, 1.0926573426573427, 1.002301594067002, 1.01840490797546, 1.3488372093023255, 1.012175108355659, 1.0663617429656553, 1.0413533834586466, 1.03091345254096, 1.151761517615176, 2.0, 1.0694789081885856, 1.0102201875486547, 1.3214285714285714, 1.035306334371755, 1.058066729565143, 1.0041564519723647, 1.0007605835196762, 1.0381909547738692, 1.0249280620542975, 1.0471343409107774, 1.055190538764783, 1.0108193066140323, 1.1163098070314565, 1.013129185732901, 1.17911227154047, 1.072085486555137, 1.1218274111675126, 1.08, 1.0294117647058822, 1.0, 1.0698924731182795, 1.028490413178504, 1.6175637393767706, 1.0636363636363637, 1.0326770004189358, 1.0555555555555556, 1.0001413047599026, 1.0744186046511628, 1.0339094921826657, 1.5, 1.062015503875969, 1.062446778313937, 1.024600069397083, 1.046161515453639, 2.5, 1.0332480818414322, 1.0185309366873292, 1.0062565172054223, 1.036745406824147, 1.212837837837838, 1.0372460496613995, 1.0703262355928893, 1.017391304347826, 1.0018798919120389, 1.0117485258161945, 1.1846689895470384, 1.0831191088260497, 1.0232288037166086, 1.0, 1.0996068152031455, 1.0, 1.044526901669759, 1.0992540792540793, 1.0658717748240814, 1.284375, 1.0, 2.5, 1.057006187738623, 1.1515151515151516, 1.0751998619658365, 1.5, 1.1470588235294117, 1.0243654822335024, 1.1428571428571428, 1.001222233612213, 1.026258205689278, 1.1446028513238289, 1.1335504885993486, 1.0163294284700035, 1.0546678452437614, 1.109375, 1.0, 1.024178908134181, 1.1716950713956702, 1.125904486251809, 1.0762287422911605, 1.0714997984427046, 1.0284300216529343, 1.0600914435009798, 1.0296847097397466, 1.078391959798995, 1.0720270101287983, 1.1623384323491046, 1.5714285714285714, 1.0814273835642514, 1.1403197158081706, 1.1754385964912282, 1.0357142857142858, 1.2208121827411167, 1.377659574468085, 1.0162565339421665, 1.0195868182143113, 1.0866510538641687, 1.1439024390243901, 1.0063773328576804, 1.0368532955350815, 1.0959640165329443, 1.00962512888822, 1.5454545454545454, 1.5, 1.0466384009691097, 1.0193078200738959, 1.0217590322053294, 1.0280746401488685, 1.1743753322700692, 1.0444069702079821, 1.0075566750629723, 1.0152879870241915, 1.0197028007439188, 1.0780805032515832, 1.0821114369501466, 1.1851851851851851, 1.1538461538461537, 1.082874716736808, 1.2857142857142858, 1.0401459854014599, 1.0199863799579016, 1.0407347628929366, 1.1388888888888888, 1.3109243697478992, 1.0941499085923219, 1.0245632243556477, 1.0007448004496908, 1.15, 1.0047752154670393, 1.0126553320159675, 1.11139896373057, 2.3333333333333335, 2.090909090909091, 1.0362625139043382, 1.7142857142857142, 1.03244077591938, 1.0611620795107033, 1.0869565217391304, 1.069228612868234, 1.24, 1.9, 1.0401426152977993, 2.0, 1.0625, 1.0422195416164053, 1.201641369572891, 1.1864077669902913, 1.3287671232876712, 1.0442477876106195, 1.0279477259435872, 1.0337953768626975, 1.0996677740863787, 1.007342710328011, 1.1139027391050962, 3.0, 1.2, 1.0175380735279853, 1.25, 1.0447080291970803, 1.25, 2.0, 1.08, 1.2084592145015105, 1.080824088748019, 1.1349206349206349, 1.1446700507614214, 1.2179487179487178, 2.75, 1.0317313743194068, 1.0909090909090908, 1.0483870967741935, 1.0301930665163472, 1.2683823529411764, 1.0886581469648562, 1.060377358490566, 1.8, 1.0, 1.0959360426382412, 1.3774834437086092, 1.0198412698412698, 1.0126301005167335, 1.0756085566756823, 1.0073710073710074, 1.5, 1.0098779147342867, 1.0714285714285714, 1.1935483870967742, 3.0, 1.0340991670859188, 1.4285714285714286, 1.0065217391304349, 1.0084745762711864, 1.10143270487213, 1.0076838160532202, 1.1089494163424125, 1.1088962918464311, 1.0488111888111888, 1.0845070422535212, 1.017379679144385, 1.011053906723198, 1.0941915227629513, 1.0, 1.0003919901766318, 1.0114772447024454, 1.1860650705954574, 1.1161616161616161, 1.170731707317073, 1.095330739299611, 3.0, 1.8148148148148149, 1.3725490196078431, 1.0794573643410852, 1.8962264150943395, 1.0857946554149085, 1.0735294117647058, 1.0724766562916852, 1.081725216807005, 1.0720789074355084, 1.0820008801525598, 1.6612903225806452, 1.0491803278688525, 1.071078431372549, 2.0, 1.0111980133298732, 1.3898305084745763, 1.0015627353517096, 1.019085747128715, 1.0442534224769182, 1.0310307609282245, 1.8571428571428572, 1.315492957746479, 1.1666666666666667, 1.123038585834988, 1.0909090909090908, 1.0780787682054522, 1.0341463414634147, 1.035116008241512, 1.1666666666666667, 1.1276435045317221, 3.0, 1.2431865828092243, 1.0073231914549279, 1.0103796985308147, 2.0, 1.180327868852459, 1.0339116719242902, 1.2660098522167487, 1.0797661447483369, 1.035287332214765, 1.1666666666666667, 1.1809116809116809, 1.0845097848310778, 1.0423037399184132, 1.0022716905667446, 1.0422108514927064, 1.0778673672766805, 1.1975308641975309, 1.2065626681011297, 1.005910367812157, 1.2913385826771653, 1.0537459283387622, 1.0, 1.5, 1.1540983606557378, 1.116, 1.2128161888701519, 1.0654085745694393, 1.0936266215454034, 1.0, 1.0495867768595042, 1.3448275862068966, 1.0112434351653228, 1.2083333333333333, 2.0, 1.0657427440094704, 1.0, 2.0, 1.1597248758119985, 1.5, 1.1787109375, 1.0037707390648567, 1.4661654135338347, 1.1, 1.031176612375607, 1.057837384744342, 1.1851851851851851, 1.007485689123734, 1.1147540983606556, 1.030701754385965, 1.1688918558077437, 1.0786041593232287, 1.1963961380365167, 1.0, 1.1325301204819278, 1.112934996717006, 1.013335353841491, 1.1193693693693694, 1.1666666666666667, 1.0444572748267897, 1.0166325600017794, 1.0199220441749675, 2.0, 1.1392701707398727, 1.0540620123082358, 1.0667362379337333, 1.153832110125242, 1.023159737288104, 1.0145794267158144, 1.020138888888889, 1.0202097768888254, 1.75, 1.0844863369076445, 1.0261930391101544, 1.035697172975563, 1.0386954118297402, 1.094871794871795, 1.038147826431715, 1.1701492537313434, 1.0388867223252445, 1.147890387124837, 1.0273564437587388, 1.1408450704225352, 1.0256582382337585, 1.2024771542934825, 1.0705882352941176, 1.1625, 1.053523142489852, 1.079120879120879, 1.0360160800721963, 1.010323246056117, 1.3333333333333333, 1.2704545454545455, 1.4563953488372092, 1.5714285714285714, 1.0, 1.0087704010360388, 1.149812734082397, 1.1938426453819841, 1.0, 1.154867256637168, 1.0359508041627248, 1.0674312761696705, 1.0442528735632184, 1.0491739579006605, 1.0406353897303289, 1.3042394014962593, 1.1013774104683196, 1.1055669969351516, 1.2297297297297298, 1.0200966813318124, 1.027766323024055, 1.05, 1.0021386811108246, 1.0508826583592938, 1.0731241323381853, 1.0, 1.1226415094339623, 1.4870129870129871, 1.1195900377037864, 1.069915254237288, 1.1449579831932772, 1.1423948220064726, 1.0342789598108748, 1.0363931730607312, 2.0, 1.5614035087719298, 1.1428571428571428, 1.3333333333333333, 1.0824742268041236, 2.019230769230769, 1.339527027027027, 1.2027649769585254, 1.0238980350504514, 1.197573656845754, 1.1006664378468052, 1.0190651906519066, 1.012681057318379, 1.1947715496938296, 1.0392000188009682, 1.0514285714285714, 1.0031141234658363, 1.002440392372133, 1.0282238442822385, 1.0362400906002265, 1.120253164556962, 1.092485549132948, 1.0097348376848194, 1.2751256281407035, 1.0161386730424387, 1.1074766355140186, 1.1634938409854423, 1.0574162679425838, 1.6666666666666667, 1.0461361014994233, 1.1333333333333333, 1.0, 1.2941176470588236, 1.017402173587617, 1.0312138728323699, 1.114795918367347, 1.1506024096385543, 1.029194324340783, 1.1877417127071823, 1.010989010989011, 1.0, 2.0, 1.0101476510067113, 1.3116883116883118, 1.0294117647058822, 1.0230294396961064, 1.0, 1.2026532479414456, 1.0066666666666666, 1.0549761791719192, 1.198224852071006, 1.002816690528995, 1.0886965927528394, 1.0098524247149683, 1.1071428571428572, 2.0, 1.0844549622836859, 1.0, 1.1066997518610422, 1.1311475409836065, 1.1872410936205469, 1.030931723877782, 1.3928571428571428, 1.0822880436435909, 1.1857142857142857, 1.0429411764705883, 1.2512820512820513, 1.0754352030947776, 1.0080924855491329, 1.0854353132628154, 1.0262206148282098, 1.001299123091913, 1.1666666666666667, 1.0286276051907197, 1.0951707058199187, 1.1904761904761905, 1.0189830508474575, 1.0375521557719054, 1.1336898395721926, 1.0760445279745554, 1.2, 1.1265060240963856, 1.051789173208278, 1.3699059561128526, 1.1594202898550725, 1.049859180825192, 1.3076923076923077, 1.7, 1.0970290771175726, 1.0543175487465182, 1.0265835987934486, 1.0884486607142858, 1.0430545678205547, 1.0100221327571373, 1.1047904191616766, 1.0238701464035647, 1.1987179487179487, 1.0165934443587863, 1.0609692548202188, 1.0478850758180367, 1.1437908496732025, 1.0074936918875945, 1.1524390243902438, 1.1176043557168784, 1.2, 1.3333333333333333, 1.0363864491844417, 1.0142543859649122, 1.023485784919654, 1.2040816326530612, 1.5555555555555556, 1.031496062992126, 1.0974162011173185, 1.4954128440366972, 1.0293511261738333, 2.3333333333333335, 1.0037956350197272, 1.0, 1.4043715846994536, 1.2, 1.0872383720930232, 1.3333333333333333, 1.2434782608695651, 1.1394527802294792, 1.0, 1.0557883708748035, 1.0044444444444445, 2.25, 1.25, 1.080536912751678, 1.128526645768025, 1.0394414502694758, 1.0106666666666666, 1.0503401360544218, 1.6363636363636365, 1.1724137931034482, 1.1297854892313004, 1.5368421052631578, 1.495, 1.5172413793103448, 1.0, 1.0198105081826012, 1.2485136741973841, 1.0448833034111311, 1.2165917876919863, 1.0102627017974333, 1.2213287302121927, 1.0023379908084267, 1.0032606726646942, 1.036, 1.0280842527582748, 1.3, 1.0, 1.0256410256410255, 1.063230088198349, 1.1486830926083262, 1.0365168539325842, 1.3370473537604457, 1.1117890054019701, 1.044431514023042, 1.001945371721323, 1.0543478260869565, 1.2173913043478262, 1.025, 1.158393351800554, 1.0421345324889575, 1.0726863994005245, 1.2816091954022988, 1.0956543149082851, 1.0311392877121015, 1.0312437254395779, 1.0590551181102361, 1.0226385198937293, 1.0258899676375404, 1.0598019801980199, 1.0504731861198737, 1.002187172512864, 3.0, 1.0300240192153722, 2.0, 1.171306209850107, 1.0485388876328283, 1.109375, 1.0284369230349977, 1.1730941704035875, 1.0363636363636364, 1.0556285633415552, 1.0281571251997226, 1.098050201703272, 1.0095389507154213, 1.0417061611374407, 1.0106237954214263, 1.2481884057971016, 1.3571428571428572, 1.0, 1.2, 1.0131276002746699, 2.0, 1.0216049879324216, 1.0644880076893846, 1.1394877464529205, 1.0960307298335468, 1.0000174334984673, 1.0750243298239406, 1.0751633986928104, 1.0166865315852205, 1.0198426676059646, 1.020998683843178, 1.0057073428082683, 1.090039800745951, 1.1, 1.033457249070632, 1.2532467532467533, 1.0672240389954957, 1.0743801652892562, 1.00392017106201, 1.1612426035502958, 1.013136288998358, 1.0686185883470016, 1.0056497175141244, 1.0186490879897878, 1.3157894736842106, 1.0072328922754474, 1.011108848772643, 1.147364513734224, 1.0007024938531788, 1.131578947368421, 1.0071090047393365, 1.1374069870097112, 1.0730920639121373, 1.2448979591836735, 1.004400063947268, 1.05, 1.0781071401356397, 1.219375, 1.1226053639846743, 1.074742268041237, 1.105966162065895, 1.2119205298013245, 1.1060747663551402, 1.0528282377270697, 1.0353728489483747, 1.0528964416486715, 1.039885635637411, 1.1333333333333333, 1.0528511821974966, 1.078857142857143, 1.1433807979698294, 1.0377099760027426, 1.0468174644923725, 1.1568228105906313, 1.087893864013267, 1.0086206896551724, 1.0244500483419219, 1.0444444444444445, 1.03462441314554, 1.013595564941922, 1.0270326042096574, 1.5574534161490683, 1.003289156626506, 1.0583374162991996, 1.0460526315789473, 1.0056285178236397, 1.0018706464396183, 1.1061887800534282, 1.0451713395638629, 1.2669683257918551, 1.0488656195462478, 1.020840287049399, 1.0, 1.75, 1.0305287927895928, 1.0111806171513935, 1.0218023255813953, 1.2530864197530864, 1.0024293956878227, 1.0382304498109356, 1.0249406175771971, 1.1669642857142857, 1.2413793103448276, 1.1439954467842914, 1.1304347826086956, 1.1105263157894736, 1.5161290322580645, 1.0495344229356005, 1.0049140049140048, 1.0551724137931036, 1.0714285714285714, 1.0131147540983607, 1.0638722554890219, 1.0707070707070707, 1.6, 1.0406504065040652, 1.1342592592592593, 1.022232734153264, 1.4, 1.0509473640592142, 1.1666666666666667, 1.167998916136025, 1.076271186440678, 1.4166666666666667, 1.095664739884393, 1.0934484430472795, 1.0007426267769999, 1.0971524288107202, 1.4487179487179487, 1.1176470588235294, 1.0, 1.3068181818181819, 1.2794117647058822, 1.1353319057815845, 1.0153290974396187, 1.0058134474053995, 1.032258064516129, 1.033692001138628, 1.000850325958284, 5.0, 1.000055919897853, 1.039083236645104, 2.0, 1.2857142857142858, 1.020112828059848, 1.076217696796475, 1.0461919492326208, 1.0401002506265664, 1.5, 1.137546468401487, 1.296875, 1.0789473684210527, 1.0128180954387989, 1.0678187108817394, 1.0116669418303892, 1.1728665207877462, 1.2, 1.0005521521510468, 1.073643410852713, 1.0222222222222221, 1.2524461839530332, 1.0837264150943395, 1.0, 1.0862068965517242, 1.0697124662292552, 1.0391336368505624, 1.1, 1.0098684210526316, 1.0729254077914314, 1.2215743440233235, 1.1748251748251748, 1.1388888888888888, 1.0390539522855478, 1.1814935727402571, 1.0503934386818186, 1.7719298245614035, 1.1308411214953271, 1.031347962382445, 1.1111111111111112, 1.0089029293509477, 1.0072992700729928, 1.0110702578739421, 1.046973803071364, 1.5, 1.1636029411764706, 1.0316615067079464, 1.1647748077627242, 1.355728659526128, 1.140153452685422, 1.0730785384292314, 1.0865954514128187, 1.0941176470588236, 1.05, 1.0573006558508802, 1.0048212545519823, 1.0743476120137863, 1.0331412103746398, 3.0, 1.101123595505618, 1.1622805389554953, 1.2182890855457227, 1.041449655713532, 1.0037460840890355, 1.1206179441473558, 1.8, 1.037810945273632, 1.015076453168942, 1.0400839854934147, 1.0284810126582278, 1.0270534517842076, 1.2880794701986755, 1.2618771726535343, 1.0902474526928676, 1.002747685999539, 1.0151698417498236, 1.1149097815764482, 1.1251325556733829, 1.054054054054054, 1.1515846837802954, 1.2097345132743362, 1.0341771845833938, 1.028144066128715, 1.0566223535204333, 1.0685023505708529, 1.087378640776699, 1.1267857142857143, 3.0, 1.5, 1.5714285714285714, 1.0474137931034482, 1.139654067905189, 1.0676717332755472, 1.0592310827333242, 1.077672266861456, 1.0927348934683898, 1.008695652173913, 1.1883116883116882, 1.0190824980724749, 1.6666666666666667, 1.4615384615384615, 1.1943844492440605, 1.0, 1.0954712362301102, 1.1361169102296451, 1.0151804104050652, 1.0322650351822589, 1.2, 1.081443298969072, 1.4473684210526316, 1.087964541425162, 1.0013236469917635, 1.0816802800466745, 1.041319857312723, 1.0205234387941031, 1.0957880768663686, 1.095364238410596, 1.4745762711864407, 1.2689173457508731, 1.0, 3.0, 1.0002196861095078, 1.5, 1.625, 1.4130434782608696, 1.0315040650406504, 1.0000087230158956, 1.0412314458493679, 1.073643410852713, 1.0, 1.2107795957651588, 1.0229655516724914, 1.3850574712643677, 1.0387755102040817]
origin-bjaq_15.87 	max: 6.1111	99th: 3.0000	95th: 1.6683	median: 1.0722	mean: 1.1698

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 17.910722 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=36.292323