Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='naru', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 24, 'naru': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.6012	median: 1.0526	mean: 1.1462
ReportEsts: [1.0294117647058822, 1.0590182018753447, 1.0340479004293386, 1.0216110019646365, 1.0344827586206897, 1.0, 1.1970964566929134, 1.0166106764736633, 1.25, 1.0359042553191489, 1.0332458703560141, 1.0025138369386668, 1.05121412803532, 1.036144578313253, 1.0219003885552809, 1.0, 1.8, 1.0056677293659229, 3.0, 2.6666666666666665, 1.125, 1.1343541082596507, 1.0460750428923091, 1.0173237753882916, 1.0009866798223976, 1.0, 1.064506480558325, 1.5, 1.2, 1.1726618705035972, 1.0, 1.0089336676235936, 1.0082027213227696, 1.367369589345172, 1.0155676310765165, 1.0304989506465372, 1.0446927374301676, 1.011227933856203, 1.1001790756939183, 1.2023809523809523, 1.0729023383768914, 1.0182926829268293, 1.0, 1.144182044172483, 1.1044269628258523, 1.2314049586776858, 1.116504854368932, 1.3412322274881516, 1.0138965038193744, 1.0093457943925233, 1.0794729107947292, 1.20997920997921, 1.0053990237570853, 1.0, 1.3584415584415583, 1.0071561426184545, 1.2232727272727273, 1.0727969348659003, 1.2236024844720497, 1.25, 1.0579107597237367, 1.046077210460772, 1.0272727272727273, 1.0114942528735633, 1.1818181818181819, 1.1317019140908933, 1.0303336703741153, 1.1666666666666667, 1.0, 1.1251311097126075, 1.0083532219570406, 1.059061957151129, 1.1126126126126126, 1.0469825659365222, 1.2023529411764706, 1.1416490486257929, 1.0, 1.0463084316295326, 2.0, 1.0321386553416168, 1.0625, 1.0431871625152414, 1.2085889570552146, 1.026376146788991, 1.0698162729658793, 1.08, 1.004384380043844, 1.0282631161527553, 1.142156862745098, 2.3333333333333335, 1.1478260869565218, 1.0170988936010024, 1.1382978723404256, 1.2889200561009817, 1.1889250814332248, 1.043360433604336, 1.238532110091743, 1.0316901408450705, 1.0, 1.0316671269446747, 1.2141108711303095, 1.0137221269296741, 1.0099429793300072, 1.088235294117647, 1.0029941723949911, 1.0455176242020539, 1.1640192094569635, 1.0227531285551763, 1.0184202310334063, 1.1666666666666667, 1.3333333333333333, 1.1474530831099197, 1.012535644566184, 1.0588628762541805, 1.1, 1.0054747667879982, 1.0, 1.1801265351693337, 1.0842105263157895, 1.0, 1.2032967032967032, 1.0, 1.0451127819548873, 1.0157336040494223, 1.077114234681991, 1.0566037735849056, 1.8, 1.1655629139072847, 1.0, 1.1785714285714286, 1.0020856549876804, 1.1818181818181819, 1.02099609375, 1.0044778837759927, 1.06187624750499, 1.106351550960118, 1.028169014084507, 1.00234375, 1.00199203187251, 1.051249199231262, 1.0485686402081977, 1.2592592592592593, 1.090671885192433, 1.0236315619004908, 2.0, 1.0110599078341014, 1.0466507177033493, 1.0459057071960298, 1.0088230104111522, 1.0, 1.003511746185517, 1.0651851851851852, 1.0121457489878543, 1.4476190476190476, 1.0671532846715328, 1.0257651737852327, 1.0273476829301478, 1.0376499233474614, 1.150190114068441, 1.138157894736842, 1.0204081632653061, 1.0942028985507246, 1.0969305331179322, 1.1428571428571428, 1.0119637148409166, 1.009910520398577, 1.0189982728842832, 1.0186936281640966, 1.0335980452046427, 1.0817365031406536, 1.0210526315789474, 1.1911764705882353, 1.1927955843904328, 1.0880088008800881, 1.1263362487852284, 1.0117994100294985, 1.0403276622558286, 1.060781654543213, 1.0334655267691708, 1.0, 1.1559633027522935, 1.0335472578763127, 1.0476190476190477, 1.05826859045505, 1.2063492063492063, 1.0115241509561992, 1.0466706900020117, 1.0136787654481312, 1.0862068965517242, 1.1377272727272727, 1.0471991284903388, 1.0, 1.7272727272727273, 1.0303950103950104, 1.312145289443814, 1.1117375704766785, 1.2962962962962963, 1.0308681672025723, 1.0050298745629844, 1.0240636433329202, 1.1798245614035088, 1.0609254769684833, 1.2464788732394365, 1.032258064516129, 1.0120481927710843, 1.0, 1.0389610389610389, 1.088629553698155, 1.6724738675958188, 1.1839080459770115, 1.0148294611962432, 1.0957683741648108, 1.0428808804874126, 1.0043002996337809, 1.101383386373969, 1.2222222222222223, 1.0251851851851852, 1.0656077348066297, 1.0018955712562467, 1.0017651239025285, 1.0, 1.0853002070393374, 1.0439209816240915, 1.0096560179065108, 1.0629608621667612, 1.0326417480692123, 1.0043562848925731, 1.0344827586206897, 1.0032944095630087, 1.1183850036049026, 1.1680767061477721, 1.0434782608695652, 1.0020742584526032, 1.0088974854932302, 1.1448818897637796, 1.0, 1.0124401913875598, 1.095020098258151, 1.0550867323019222, 1.2835820895522387, 1.0909090909090908, 2.6666666666666665, 1.1053094388069151, 1.1090909090909091, 1.1340948777648427, 1.5, 1.0, 1.2121212121212122, 1.0692821368948247, 1.5, 1.143646408839779, 1.1761786600496278, 1.0631399317406143, 1.0183839247541684, 1.0264250660626653, 1.105263157894737, 1.0, 1.000648128144193, 1.109578701797722, 1.1225919439579686, 1.0599822734323068, 1.1074566973129476, 1.0454732510288065, 1.0922098569157392, 1.0295582979772195, 1.0711722488038278, 1.1200186799501868, 1.1976761288424769, 1.7272727272727273, 1.1020925427637902, 1.1023454157782515, 1.2727272727272727, 1.0, 1.1007272727272728, 1.0555555555555556, 1.0636363636363637, 1.0474665231141915, 1.0668523676880224, 1.2201834862385321, 1.0032532006354546, 1.058614564831261, 1.0113751589516622, 1.0030615114422001, 1.5, 1.0314659876318661, 1.0, 1.0048314892200407, 1.0691144708423326, 1.0124345728460242, 1.3, 1.4285714285714286, 1.0, 1.5070422535211268, 1.0238013773196388, 1.0, 1.039755351681957, 1.0375586854460095, 1.0372596153846154, 1.0010815085299625, 1.18125, 1.0188679245283019, 1.0060748613923547, 1.0970689752730154, 1.0322394220846234, 1.0512820512820513, 1.0, 1.2386634844868736, 1.0175438596491229, 1.161993769470405, 1.012089300758214, 1.0672007120605251, 1.1378205128205128, 1.0535714285714286, 1.0178326474622772, 1.1273996509598603, 1.5714285714285714, 1.0192630011615489, 1.0677655677655677, 1.1578947368421053, 1.0327831788378927, 1.2380952380952381, 1.75, 1.0365290002059082, 2.0, 1.0041152263374487, 1.065406976744186, 1.0065627563576702, 1.0188824662813103, 1.0130548302872062, 1.10989010989011, 1.0240127707355349, 1.0087875173437841, 1.0426136363636365, 1.0023697265384772, 1.0788861367559859, 2.0, 1.2222222222222223, 1.0225259960275732, 1.3333333333333333, 1.048687089715536, 1.0, 1.0, 1.0454545454545454, 1.2575757575757576, 1.0811843361986628, 1.2647058823529411, 1.0649350649350648, 1.0, 1.0432756324900132, 1.018462175437716, 1.5, 1.0667063728409767, 1.0, 1.0156228649510362, 1.0470588235294118, 1.07016531094201, 1.1705069124423964, 1.0018181818181817, 1.1623762376237623, 1.0462962962962963, 1.0098227855682915, 1.0028854357391412, 1.0121293800539084, 1.0, 1.1428571428571428, 1.8333333333333333, 1.5, 1.1428571428571428, 1.0018055876834502, 1.25, 1.0465890183028286, 1.0198019801980198, 1.124135309768149, 1.0443293485748166, 1.0, 1.0707386766164455, 1.0298685782556751, 1.238938053097345, 1.5, 1.0619469026548674, 1.0262008733624455, 1.0060168941886178, 1.2380952380952381, 3.142857142857143, 1.1046770601336302, 1.0174418604651163, 1.0033217945875894, 1.1657142857142857, 1.342769701606733, 1.0255331088664421, 1.4035087719298245, 1.0808477237048666, 1.0635593220338984, 1.2884615384615385, 1.0632530120481927, 1.1941747572815533, 1.0287387070639131, 1.0078446326914172, 1.0305873247914696, 1.2112676056338028, 1.0277777777777777, 1.043731778425656, 1.0, 1.0495630117032497, 1.015768200283807, 1.0112628531041243, 1.0013863023805132, 1.0720979154714094, 1.0073623559539053, 1.8333333333333333, 1.286058851905451, 1.2, 1.1280956447480786, 1.1111111111111112, 1.031696476114141, 1.0202898550724637, 1.089853826311264, 1.1778656126482214, 1.0505902192242833, 3.0, 1.1549391069012178, 1.0091909064198619, 1.0832260437741401, 1.0, 1.3125, 1.0681381957773513, 1.2557471264367817, 1.0846552282292004, 1.1186046511627907, 1.105263157894737, 1.089732528041415, 1.087386355668778, 1.0529282221641596, 1.0085191019740027, 1.0828947368421054, 1.2752902155887231, 1.0795454545454546, 1.1538461538461537, 1.0609137055837563, 1.3448275862068966, 1.0409276944065484, 1.1379310344827587, 1.0855504053167397, 1.0869565217391304, 1.1145543390857922, 1.0176994245938051, 1.127260083449235, 1.0, 1.1067961165048543, 1.28, 1.000894976458228, 1.4704595185995624, 1.0, 1.1828543796628903, 1.003594418080158, 1.1987083954297069, 1.0, 2.0, 1.1798058252427184, 1.0, 1.431924882629108, 1.0, 1.0231133320139851, 1.0423228346456692, 1.0869565217391304, 1.0107721280602637, 1.0272727272727273, 1.0311231393775373, 1.210483870967742, 1.1569204880100967, 1.1331152057861202, 1.0, 1.0675675675675675, 1.0986354705553654, 1.0118337018881347, 1.0839459976986658, 1.0, 1.0006635700066357, 1.019024293949766, 1.0282870612886328, 2.0, 1.1228070175438596, 1.06888799962337, 1.0957450240330333, 1.1559128041588398, 1.027210155122897, 1.1561849457653117, 1.0596638655462185, 1.0364030858244937, 2.0, 1.1035712439919376, 1.027027027027027, 1.0, 1.321917808219178, 1.1304347826086956, 1.040597095189151, 1.0748858447488585, 1.0398914310835865, 1.119732785200411, 1.048482919584129, 1.0181252536182877, 1.0274050186668515, 1.087378640776699, 4.0, 1.060012003360941, 1.0036437246963563, 1.004202636457729, 1.0236234066429442, 1.0744071954210956, 1.1692883895131085, 1.0885416666666667, 1.4285714285714286, 1.0052743003291849, 1.0420710171247758, 1.0049628479538648, 1.0889285714285715, 1.0473065078002726, 1.0123711340206185, 1.0023789872311502, 1.0131147540983607, 1.0842541436464088, 2.0, 1.0, 1.0552147239263803, 1.0580524344569289, 1.0016806722689076, 1.0591939546599496, 1.1062906724511932, 1.1179775280898876, 1.0554699537750385, 1.120879120879121, 1.0016806161517229, 1.4487179487179487, 1.0107940809633063, 1.0, 1.0250368188512518, 1.380952380952381, 1.0846153846153845, 1.0464776381175096, 1.0304396843291996, 1.0140280561122244, 1.0321285140562249, 1.0410928001519757, 1.0, 1.7446808510638299, 2.0, 1.0, 1.0232558139534884, 1.1071428571428572, 1.390557939914163, 1.0785340314136125, 1.0277154758090357, 1.1194805194805195, 1.0466753451406254, 1.0044369946756064, 1.1079967023907666, 1.0136601161449195, 1.027027027027027, 1.1002604166666667, 1.1572327044025157, 1.0837359098228663, 1.0014450867052023, 1.0206497797356828, 1.0204261040438516, 1.0320025348542459, 1.0087221310798211, 2.0, 1.0175, 1.0277264325323474, 1.0410958904109588, 1.0, 1.0408163265306123, 1.1538461538461537, 1.0035523978685612, 1.6296296296296295, 1.5, 1.0574255401612498, 1.0270659321130264, 1.0121640497684885, 1.0067174881123104, 1.0648648648648649, 1.034021871202916, 2.0, 1.1159420289855073, 1.172394275086925, 1.0423190331824412, 1.0064166639796215, 1.0128716254698713, 1.0130520293223673, 1.1458333333333333, 1.0199422772553766, 1.1509769094138544, 1.0003363454940915, 1.0222142736120785, 1.4242424242424243, 1.109271523178808, 1.0, 1.0113378684807257, 1.020654343486939, 3.0, 1.037920489296636, 1.016698525695955, 1.2857142857142858, 1.2071139713875723, 1.2, 1.1875, 1.0177620396600566, 1.7692307692307692, 1.0144000096684915, 1.041435284066638, 1.1875, 1.2608695652173914, 1.2663185378590078, 1.0175182481751825, 1.0772889417360285, 1.031238703458248, 1.009832920297386, 1.0, 1.2031283945253095, 1.0091463414634145, 2.0, 1.0360726064995271, 1.0249848602820313, 1.1144749290444655, 1.01758228229493, 1.093136270532953, 1.4303797468354431, 1.7142857142857142, 1.0197793837961202, 1.0350584307178632, 1.0484618125668133, 1.089726484322882, 1.0491732417338582, 1.0581722760308405, 1.0439770554493308, 1.0310701956271577, 1.0912408759124088, 1.0010792887820728, 1.0946372239747635, 1.0434782608695652, 1.0467436974789917, 1.0622200404982511, 4.0, 1.0027207844271238, 1.0028727348634705, 1.0233795835864463, 1.1176470588235294, 1.0106929593112068, 1.034351145038168, 1.0, 1.0199280575539569, 1.0134426229508198, 1.1103030303030303, 1.1470588235294117, 1.6666666666666667, 1.0110255258885703, 1.5, 1.3630573248407643, 1.1538461538461537, 1.1154839159863235, 1.3333333333333333, 1.234375, 1.1415094339622642, 1.0, 1.3716931216931216, 1.0913633119200572, 2.0, 1.0, 1.0725806451612903, 1.0283687943262412, 1.0897740784780023, 1.0236305048335124, 1.035598705501618, 1.0707964601769913, 1.089150378938971, 1.0493506493506493, 1.6666666666666667, 1.3611111111111112, 1.3461538461538463, 1.0, 1.2942708333333333, 1.240981240981241, 1.0072840790842872, 1.0688815060908083, 1.0001050487601328, 1.1825695701080843, 1.0241899623514066, 1.0001807729852852, 1.0385078219013237, 1.0078171978352375, 1.8333333333333333, 1.0, 1.0303030303030303, 1.0110333609550992, 1.1398390342052314, 1.0065359477124183, 1.380952380952381, 1.0457426498663611, 1.0386560693641618, 1.0126227858417352, 1.0512820512820513, 1.1, 1.0636565507031828, 1.1391171792152703, 1.0501479194803525, 1.0512298602942147, 1.236842105263158, 1.1151063201417601, 1.0016681578987277, 1.2617124394184167, 1.051391862955032, 1.0, 1.0287970274036229, 1.049645390070922, 1.0192307692307692, 1.1362229102167183, 1.0347890451517394, 1.0, 1.076167076167076, 1.0393316973140148, 1.1481481481481481, 1.0222151697873691, 1.1493644067796611, 1.048780487804878, 1.001055159365449, 1.007354001441961, 1.127652430835348, 1.0106075216972035, 1.0161476355247983, 1.0064091656740968, 1.206896551724138, 1.0714285714285714, 1.0, 1.0, 1.0194986072423398, 1.8333333333333333, 1.0148307018344438, 1.0598244574874804, 1.1346920691182987, 1.0568849706129304, 1.0019002014213507, 1.1495176848874598, 1.0528301886792453, 1.0256045519203414, 1.0017076566998475, 1.0482460450034392, 1.0026604031349615, 1.0206551848729375, 1.25, 1.015625, 1.316205533596838, 1.004736530491415, 1.0618892508143323, 1.0014780405405406, 1.2070796460176991, 1.0058823529411764, 1.0303935810683666, 1.0261707988980717, 1.0054665071770335, 1.3125, 1.021838891111477, 1.0006331837971163, 1.1595063985374772, 1.0008428150021071, 1.0625, 1.1509635974304069, 1.164179104477612, 1.625, 1.0133000547045952, 1.3846153846153846, 1.0110887096774193, 1.0879120879120878, 1.2022926500337154, 1.0841548010222708, 1.071764705882353, 1.0, 1.0821256038647342, 1.004356777822714, 1.0231064374023022, 1.0001307441834404, 1.043956043956044, 1.0021263371389315, 1.0, 1.0393765381460214, 1.0744285993358078, 1.1404303763560872, 1.0204498977505112, 1.2083333333333333, 1.0135256988277728, 1.0422019966062102, 1.2057793345008756, 1.0120038384367094, 1.0, 1.3333333333333333, 1.0285989764889119, 1.0679188580015027, 1.01734917161613, 1.0091648742167774, 1.0518754988028731, 1.056338028169014, 1.015830302313432, 1.075002431985473, 1.0666666666666667, 1.345945945945946, 1.0378151260504203, 1.001302435308284, 1.0119047619047619, 1.75, 1.025727769234848, 1.0036128171636607, 1.0156340474811811, 1.2753623188405796, 1.0132061628760087, 1.023740034168565, 1.0224202356999137, 1.1396011396011396, 1.2307692307692308, 1.1435309973045822, 1.0547368421052632, 1.125, 1.72, 1.054832942228182, 1.0099108027750248, 1.0845323741007193, 1.2058823529411764, 1.0375363627244458, 1.076509511993383, 1.0094253572514442, 1.0616063919259882, 1.6666666666666667, 1.0769230769230769, 1.3333333333333333, 1.036462093862816, 1.5384615384615385, 1.0, 1.5, 1.2994836488812394, 1.019927536231884, 1.1124389543234703, 1.0047040752652043, 1.3126491646778042, 1.3529411764705883, 1.0, 1.0, 1.3243243243243243, 1.4, 1.0467289719626167, 1.0040827215442076, 1.0023020480417715, 1.0390625, 1.012993851856411, 1.0010960412391772, 5.0, 1.0079701269095982, 1.1028571428571428, 1.0, 1.3333333333333333, 1.0961538461538463, 1.0905830882880299, 1.040206271511427, 1.0714285714285714, 1.0, 1.0197628458498025, 1.6901840490797546, 2.0, 1.5, 1.1348425196850394, 1.0277701022381873, 1.1249648580264269, 1.25, 1.0123904239675483, 1.0712625871417505, 1.169064748201439, 1.3333333333333333, 1.1767955801104972, 1.0033041794677011, 1.381578947368421, 1.1434601775405053, 1.0447177533735867, 1.0340632603406326, 1.0158730158730158, 1.0156749311294766, 1.1673783091374894, 1.1570247933884297, 1.1311475409836065, 1.0528893072744387, 1.2480430528375734, 1.020212094012832, 1.9880952380952381, 1.2439024390243902, 1.1492537313432836, 1.0348387096774194, 1.0420890937019969, 1.0282655773711165, 1.0214217283004408, 1.0971615720524017, 3.0, 1.25, 1.035343172943279, 1.1468777484608619, 1.25559229721844, 1.0134578788293387, 1.0190667335674861, 1.0738638683598056, 1.054421768707483, 1.125, 1.0068861801488047, 1.0025542258018003, 1.047142015321155, 1.1085814360770578, 2.5, 1.1333333333333333, 1.01118896511244, 1.0463560334528077, 1.0273401817336816, 1.0098138236533827, 1.0958806818181819, 1.6, 1.0166270783847982, 1.0098783856022808, 1.03061457619374, 1.0115384615384615, 1.012826014399466, 1.2265625, 1.184313725490196, 1.0747826086956522, 1.004238399976676, 1.05244972091787, 1.099078341013825, 1.1357234314980793, 1.03125, 1.0751025290498974, 1.0167538050424074, 1.0673712021136064, 1.0541796549401112, 1.06520450503853, 1.0517104216388227, 1.3846153846153846, 1.0424628450106157, 2.5, 1.5, 1.3076923076923077, 1.0281329923273657, 1.1413902053712481, 1.0644658175201456, 1.044284151052949, 1.1413839891451831, 1.0085774058577406, 1.0434782608695652, 1.163265306122449, 1.0300286847638385, 1.6, 1.3333333333333333, 1.109268292682927, 1.0, 1.1536098310291858, 1.1262376237623761, 1.0391167192429023, 1.0126357306325169, 1.25, 1.171826625386997, 1.306201550387597, 1.2356608478802993, 1.0002890823242219, 1.1330472103004292, 1.036195883605394, 1.0249895211672422, 1.0200878155872668, 1.0985691573926868, 1.392156862745098, 1.2905027932960893, 1.0, 1.0, 1.0006079896999391, 1.6666666666666667, 1.5714285714285714, 1.4210526315789473, 1.0171779141104293, 1.0804597701149425, 1.027920227920228, 1.0977605512489232, 1.0, 1.1874612042209807, 1.0257639304973039, 1.147982062780269, 1.0196078431372548, 1.25, 1.006675567423231, 1.014052838673412, 1.0684647302904564, 1.0286351803644478, 1.0138855206496733, 1.1131172069825437, 1.05, 1.0, 1.033266305298129, 1.0005937181467588, 1.015961262553802, 1.2695652173913043, 1.0352221282523257]
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.6012	median: 1.0526	mean: 1.1462

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 20.363953 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=naru', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[2.9802322e-07 4.1723251e-07 2.3841858e-07 4.1723251e-07 3.5762787e-07]
Distance score: 3.457069510659494e-07
SAUCE Drift detection: False
Detection latency: 0.0233s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 2.037042 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 9.0000	99th: 3.0000	95th: 1.6667	median: 1.0699	mean: 1.1649
ReportEsts: [1.0443213296398892, 1.0286481647269472, 1.0544143800813008, 1.037953795379538, 1.1176470588235294, 1.0, 1.1423968757627532, 1.0093597114997725, 1.2, 1.0077092511013215, 1.086596204660101, 1.0028419041841352, 1.0966744006187161, 1.0196463654223968, 1.059157454436809, 1.174922600619195, 1.1305732484076434, 1.3, 1.5555555555555556, 1.0896057347670252, 1.0640616966580976, 1.0166935470462066, 1.139963167587477, 1.0025273799494523, 1.038941119151163, 1.0107267553903008, 2.0, 1.0357594510964616, 1.1666666666666667, 1.3333333333333333, 1.2125796565646738, 1.0, 1.0018492311927187, 1.0083672140560993, 1.3752319109461966, 1.01964441128932, 1.0265144020126071, 1.0289532293986636, 2.0, 1.343317109696743, 1.0988452655889145, 1.0903101635946406, 1.1309226932668328, 1.0227471566054243, 1.0512820512820513, 1.0994556113902847, 1.2380952380952381, 1.041900647948164, 1.090128755364807, 1.1279157261098571, 1.1538461538461537, 1.0103806228373702, 1.0582959641255605, 1.0857142857142856, 1.0570997014783363, 1.0297536220021282, 1.0200359264888765, 1.092920353982301, 1.0843373493975903, 1.0165977444424676, 1.1333333333333333, 1.0344317141414747, 1.0859154929577466, 1.0112781954887218, 1.2040816326530612, 2.0, 1.1352098083232602, 1.0983164983164984, 1.1428571428571428, 1.0, 1.0805922436274922, 1.0249500998003993, 1.064796905222437, 1.1312741312741312, 1.0965893587994544, 1.134684147794994, 1.106100795755968, 1.0275229357798166, 1.0921985815602837, 1.0352560463267855, 1.275076923076923, 1.0, 1.0, 3.0, 1.028301886792453, 1.1, 1.113802559414991, 1.2142857142857142, 1.2222222222222223, 1.015304325553101, 1.0769482110766215, 1.0040564373897707, 1.0635462464840657, 1.0911949685534592, 1.0775862068965518, 1.3152941176470587, 1.1302521008403361, 1.2733333333333334, 1.0909090909090908, 1.1286173633440515, 1.3225806451612903, 2.0, 1.0656816838659817, 1.2759061833688699, 1.0253623188405796, 1.0191469024433957, 1.1, 1.0017809858804487, 1.1137650824919971, 1.0726563034992809, 1.0449936628643852, 1.0284584980237155, 1.0, 1.9090909090909092, 1.1455156950672645, 1.0036779468427752, 1.0848896434634974, 1.036144578313253, 1.0040235573592002, 1.0, 1.2474498190194143, 1.1036392405063291, 1.0, 1.1774891774891776, 1.125, 1.0729613733905579, 1.0213617645931774, 1.0178316690442226, 1.104, 1.6666666666666667, 1.2515506547208821, 1.0, 1.2, 1.0000923787528868, 1.0769230769230769, 1.0683760683760684, 1.0095309476133478, 1.0420649447495085, 1.0, 1.4, 1.0510204081632653, 1.0026905829596413, 1.0434083601286173, 1.0475825279617765, 1.3455497382198953, 1.0651465798045603, 1.053453832892525, 3.0, 1.0053619302949062, 1.051948051948052, 1.0814315352697095, 1.0378821120374433, 1.0, 1.0196949803050197, 1.0036855036855037, 1.0198347107438017, 1.1767497034400949, 1.0, 1.1054526748971194, 1.0746544442311383, 1.0903869974850793, 1.2539432176656151, 1.1467391304347827, 1.0701754385964912, 1.1151515151515152, 1.1131034482758622, 1.2222222222222223, 1.0176628268116548, 1.5, 1.020506634499397, 1.0081618223458706, 1.1842082353965353, 1.0872907569141192, 1.0268817204301075, 1.079447322970639, 1.1756042900592285, 1.0502958579881656, 1.127659574468085, 1.0657118786857624, 1.0410564853556485, 1.0629657228017884, 1.00462388149163, 1.0484848484848486, 1.875, 1.0210878753965538, 1.020638660924677, 1.043956043956044, 1.0958351992834752, 1.2057971014492754, 1.0, 1.0792079207920793, 1.0071628219516904, 1.0, 1.0430944963655244, 1.2507670850767085, 1.0083485080314392, 1.0129565615907403, 1.0726315789473684, 1.013878854510235, 1.0061158209962462, 1.057341442224153, 1.0148162627052384, 1.0591923752194632, 1.0253895178710952, 1.187467362924282, 1.0891489923435713, 1.2429378531073447, 1.025, 1.0505050505050506, 1.0, 1.0273224043715847, 1.0253706754530478, 1.6293103448275863, 1.1238095238095238, 1.0122799836266885, 1.0, 1.002697395618024, 1.0823798627002288, 1.0518745282227626, 1.5, 1.0404040404040404, 1.0552375500858615, 1.0146518392607047, 1.0432397997272629, 1.0, 1.008422234699607, 1.0471378265498321, 1.1099053978853646, 1.0271739130434783, 1.284013605442177, 1.1768292682926829, 1.0541903568789952, 1.0344827586206897, 1.001434255898261, 1.0133787914413355, 1.1056338028169015, 1.2489522212908635, 1.035252643948296, 1.3, 1.176509186351706, 1.0, 1.03669178897263, 1.0465202828433198, 1.095686274509804, 1.2613981762917934, 1.0769230769230769, 2.5, 1.0451383793619582, 1.1194029850746268, 1.102737909286493, 2.0, 1.3478260869565217, 1.0525272547076314, 1.2857142857142858, 1.0232561800051942, 1.1336405529953917, 1.090648854961832, 1.0615942028985508, 1.0242165242165242, 1.0055110707686323, 1.1904761904761905, 1.0, 1.0101688461172316, 1.2166676199736888, 1.1294642857142858, 1.0279650258372521, 1.1308680717526822, 1.0088122605363985, 1.0874172185430464, 1.0340082159624413, 1.0820745216515608, 1.1750407387289517, 1.214846182588118, 1.0666666666666667, 1.078284219913229, 1.0188034188034187, 1.1355932203389831, 1.1481481481481481, 1.0209653827401268, 1.1918429003021147, 1.022471043133086, 1.026162372247013, 1.1330166270783848, 1.1903553299492386, 1.0084673218120361, 1.0875190258751903, 1.0655831959829813, 1.0105967405521972, 1.4166666666666667, 1.108433734939759, 1.103831891223733, 1.015513526105821, 1.0523872377224524, 1.0259996285767345, 1.0630296610169492, 1.0368921185019564, 1.012795629358062, 1.0821076628916018, 1.0268393257614121, 1.031150624501008, 1.0433553251649388, 1.375, 1.0714285714285714, 1.0838052095130237, 1.1818181818181819, 1.0197841726618706, 1.0088840912431138, 1.0010688899577789, 1.0, 1.456, 1.0244648318042813, 1.1207403563397336, 1.0528008322214433, 1.0869565217391304, 1.0434732204961743, 1.0029007312602247, 1.0688775510204083, 2.0, 3.0, 1.0657320156285912, 1.8571428571428572, 1.0336764192628591, 1.053680981595092, 1.0909090909090908, 1.0022696685599581, 1.0416666666666667, 2.2222222222222223, 1.0403546405640278, 2.0, 1.0213523131672597, 1.0684596577017116, 1.0800692150385403, 1.0465328467153285, 1.1518987341772151, 1.1217391304347826, 1.0144315262944437, 1.0020287130520635, 1.1589147286821706, 1.0191455156622984, 1.1137886597938145, 3.0, 1.0769230769230769, 1.0321253999725173, 1.0, 1.0479014598540146, 1.0, 2.0, 1.08, 1.1827111984282908, 1.102318145483613, 1.3983050847457628, 1.1919922817173179, 1.2, 3.0, 1.0606637464008406, 1.6470588235294117, 1.015625, 1.02848129878741, 1.1474820143884892, 1.0573899371069182, 1.032166508987701, 1.8, 1.25, 1.1547876169906408, 1.3459119496855345, 1.0762620837808807, 1.0103969457664348, 1.063706801131472, 1.073107049608355, 1.0, 1.0130475055458537, 1.146341463414634, 1.3225806451612903, 3.0, 1.0207020702070206, 1.1111111111111112, 1.1016548463356974, 1.0940170940170941, 1.0619255878810927, 1.011053859403048, 1.0665258711721224, 1.0887290167865706, 1.0431131019036954, 1.0536649214659686, 1.0132802124833997, 1.02409753128685, 1.1267605633802817, 1.0606060606060606, 1.0208190665419226, 1.0089064069280476, 1.1671891611918328, 1.0588235294117647, 1.225, 1.1676767676767676, 2.0, 1.8518518518518519, 1.0153846153846153, 1.0263653483992468, 1.616, 1.0747863247863247, 1.0486835568802781, 1.0689655172413792, 1.0012382342060915, 1.1120787580461946, 1.0012106745432066, 1.2839506172839505, 1.014388489208633, 1.0820895522388059, 2.0, 1.0019316409249246, 1.3333333333333333, 1.0044567824297017, 1.0286628121540164, 1.003917806028624, 1.0136765888978279, 1.8571428571428572, 1.105602579604998, 1.3333333333333333, 1.0477279949157927, 1.2727272727272727, 1.0094156532517164, 1.0526315789473684, 1.0425437031751694, 1.1661237785016287, 1.0456781447645818, 3.0, 1.0667884163840333, 1.0061029258443652, 1.0605445563512428, 1.0, 1.3389830508474576, 1.024330900243309, 1.275779376498801, 1.09454718844726, 1.0352327880639942, 1.0416666666666667, 1.0821220930232558, 1.0936211780795155, 1.0560615260068813, 1.0038610155622567, 1.1175108883718154, 1.0540118638776148, 1.345132743362832, 1.186332087560064, 1.0809271666306461, 1.1450381679389312, 1.1026881720430108, 1.0, 1.5, 1.2374429223744292, 1.144578313253012, 1.2235054347826086, 1.0176114394105202, 1.1453796350794585, 1.0, 1.0403225806451613, 1.4230769230769231, 1.0116434501196003, 1.125, 1.0, 1.005466827423324, 1.3333333333333333, 2.0, 1.120257966616085, 1.75, 1.16958495460441, 1.0022404779686334, 1.3674242424242424, 1.0, 1.0123964954475175, 1.0351837372947614, 1.2222222222222223, 1.0934093471995991, 1.0887096774193548, 1.0562571756601606, 1.1359026369168357, 1.0308385308385308, 1.1776893194571003, 1.0, 1.0681818181818181, 1.1126818783068784, 1.017411402157165, 1.0953090096798213, 1.1666666666666667, 1.0481881264456439, 1.0172196380702647, 1.0347100175746924, 2.0, 1.1120604666447584, 1.0749793769886475, 1.113945485333479, 1.168708422698026, 1.0179612903225805, 1.0255601581623046, 1.0451702571230022, 1.0200151285228343, 1.5, 1.1255601516718372, 1.098901098901099, 1.0257941246716025, 1.047513812154696, 1.1771117166212535, 1.0150307840324793, 1.1818181818181819, 1.0565566003933402, 1.1358671909130624, 1.0672504378283714, 1.0952380952380953, 1.0191582291046257, 1.2158773321247829, 1.0714285714285714, 1.2023809523809523, 1.0102604427590318, 1.1295896328293737, 1.020485277050552, 1.0029313017133599, 1.6666666666666667, 1.1520423600605143, 1.2869565217391303, 1.1428571428571428, 1.0576923076923077, 1.0123650090619538, 1.1003584229390682, 1.1172219991971095, 1.0, 1.2857142857142858, 1.0392434988179668, 1.0097403156137603, 1.0286095746709898, 1.0474399807295989, 1.0304363769710305, 1.0337756332931243, 1.103960396039604, 1.1144247628099038, 1.1956521739130435, 1.040362021911034, 1.086286594761171, 1.127962085308057, 1.0454269102499778, 1.1633333333333333, 1.0617401733631358, 1.0, 1.1117685733070348, 1.3420195439739413, 1.0062923735432874, 1.0433884297520661, 1.1235721703011423, 1.0509337860780985, 1.022875816993464, 1.0165543278448737, 1.0, 1.901639344262295, 1.2857142857142858, 1.0, 1.0194174757281553, 1.1414944356120826, 1.446096654275093, 1.1376146788990826, 1.034279592929834, 1.0697084917617237, 1.022438871204876, 1.0048561669204494, 1.0072384826490952, 1.057311271975181, 1.0378185354077254, 1.0682539682539682, 1.0001968581440215, 1.0084910485933505, 1.0765788165091994, 1.0327510917030567, 1.1180048661800486, 1.3405797101449275, 1.0649110748346078, 1.2223618090452262, 1.0149322260595293, 1.0943396226415094, 1.101159114857745, 1.170731707317073, 2.5, 1.0326086956521738, 1.2666666666666666, 1.0, 1.3119533527696794, 1.0167967259477617, 1.0077071290944124, 1.070528967254408, 1.196319018404908, 1.003924493239113, 1.2222024677310386, 1.0241187384044528, 1.2, 2.0, 1.0018688594617684, 1.2173913043478262, 1.0419609472372247, 1.0076887232059646, 1.0, 1.161455902939804, 1.1572481572481572, 1.0427666655895564, 1.1616766467065869, 1.022383215928832, 1.0003920840297984, 1.0118604571195806, 1.1, 1.6666666666666667, 1.0326184303558803, 1.0, 1.1272493573264781, 1.1451612903225807, 1.091327705295472, 1.0033545790003355, 1.1818181818181819, 1.0945848206994704, 1.1223021582733812, 1.1063063063063063, 1.1191702221568338, 1.1195090439276485, 1.029011249259917, 1.0130565470599286, 1.0070921985815602, 1.024252491694352, 1.0, 1.0772019444673313, 1.1112856021129274, 1.4444444444444444, 1.0451021846370683, 1.0454398447606728, 1.1428571428571428, 1.0981381968191934, 1.0, 1.089866156787763, 1.0931325429883585, 1.2892307692307692, 1.0855263157894737, 1.0202830779508163, 1.3365384615384615, 1.625, 1.0962752525252526, 1.0717875089734386, 1.0027318923662718, 1.1066258351893097, 1.0509721568137476, 1.0055134933311207, 1.0963455149501662, 1.017783423308987, 1.0861538461538462, 1.0167416766705755, 1.0946808510638297, 1.0130068859984698, 1.1629563668744434, 1.0119387430159512, 1.2530120481927711, 1.160865475070555, 1.0416666666666667, 1.1428571428571428, 1.0271604938271606, 1.0197983501374885, 1.05062893081761, 1.0558139534883721, 1.4444444444444444, 1.0570032573289903, 1.077562326869806, 1.6990291262135921, 1.0185830754291223, 2.6666666666666665, 1.000553076248236, 1.3333333333333333, 1.3701657458563536, 1.3076923076923077, 1.110833430198768, 1.2727272727272727, 1.2532751091703056, 1.0943231441048036, 2.0, 1.443207126948775, 1.124537607891492, 1.2857142857142858, 1.25, 1.0335570469798658, 1.027027027027027, 1.1596091205211727, 1.0179372197309418, 1.0674931129476584, 1.109375, 1.1016483516483517, 1.00828056502679, 1.6781609195402298, 1.3824884792626728, 1.3, 1.0, 1.1002759889604417, 1.1883040935672515, 1.0052128583840139, 1.4089581304771177, 1.0253844312810387, 1.209050643489888, 1.002651517498157, 1.0437770664658257, 1.0560560560560561, 1.012531328320802, 1.2, 1.0, 1.1025641025641026, 1.0585309102579532, 1.1273779983457404, 1.024390243902439, 1.2739018087855296, 1.0919241261181247, 1.0802197669795295, 1.0059005869921318, 1.053763440860215, 1.1304347826086956, 1.1466666666666667, 1.0816664824842523, 1.034496420930294, 1.0250842010258217, 1.1837837837837837, 1.0769183585843096, 1.0377137758389927, 1.0323839683724307, 1.0306044376434582, 1.0109964004588425, 1.132890365448505, 1.0470169893322798, 1.2316227461858529, 1.0073625547976406, 4.0, 1.0209653827401268, 1.0, 1.0741482965931863, 1.0483884636027232, 1.171875, 1.006589425067686, 1.144620811287478, 1.0, 1.0291605747416184, 1.0041245183044316, 1.1402619940659464, 1.0142630744849446, 1.0075901328273245, 1.0110132675824821, 1.2103386809269163, 1.0588235294117647, 1.0, 1.0, 1.0150976191438619, 1.8571428571428572, 1.0397751497143457, 1.0621009476443308, 1.1198088937890482, 1.0763740185581727, 1.0075518330358368, 1.0895204262877443, 1.0849673202614378, 1.0046893317702228, 1.025591429846749, 1.1023942177382924, 1.0040930254845744, 1.0183097885983368, 1.5555555555555556, 1.1340579710144927, 1.25, 1.03145976908619, 1.0223463687150838, 1.0007050943063636, 1.1988041853512705, 1.016260162601626, 1.0063844518378275, 1.0104166666666667, 1.0140348038868723, 1.4705882352941178, 1.0047465638898287, 1.0041982167970238, 1.1387240356083086, 1.0105374077976819, 1.4857142857142858, 1.0861423220973783, 1.0459779221465166, 1.1207598605887021, 2.0, 1.0033373309216735, 1.027027027027027, 1.051934523809524, 1.2176395939086295, 1.1456185567010309, 1.0443708609271523, 1.0905797101449275, 1.2005649717514124, 1.0874418604651164, 1.071930057998012, 1.0433108758421559, 1.1379856115107914, 1.0533777669247455, 1.2, 1.046938775510204, 1.0753760055963624, 1.0404398996720046, 1.1547911547911547, 1.2391644908616188, 1.044378698224852, 1.1183178902352102, 1.0400516795865633, 1.002784486570805, 1.0212014134275618, 1.0303915838690825, 1.00792688918733, 1.0158566721581548, 1.5300632911392404, 1.0118735643340127, 1.0724925850441582, 1.0622073578595317, 1.112, 1.0032829615942986, 1.1056023109185347, 1.0125786163522013, 1.3497757847533631, 1.025058275058275, 1.0196776305023727, 1.0098039215686274, 1.75, 1.0204797973133461, 1.0032523901016228, 1.0057803468208093, 1.356687898089172, 1.0247509809840025, 1.011440533852487, 1.0133619661178717, 1.255050505050505, 1.0909090909090908, 1.1146711635750421, 1.3108108108108107, 1.0923076923076922, 1.4285714285714286, 1.0472494502627558, 1.0222588623248146, 1.0845070422535212, 1.3, 1.1176470588235294, 1.0509039010466223, 1.101010101010101, 1.4545454545454546, 1.0135218192993238, 1.1658767772511849, 1.110260336906585, 1.5, 1.0389101437286734, 1.1492063492063491, 1.152217606860512, 1.1238938053097345, 1.0, 1.1540749553837002, 1.1036552532387318, 1.0192995961805977, 1.4646017699115044, 1.3703703703703705, 1.2105263157894737, 1.0512820512820513, 1.2921348314606742, 1.3492063492063493, 1.05318138651472, 1.0151230702112388, 1.0055576289108665, 1.0723684210526316, 1.0158266083071172, 1.0014591906078154, 9.0, 1.0035139285344186, 1.304576538663861, 1.0, 1.5714285714285714, 1.0660189337319381, 1.1713328547499402, 1.0417767011496535, 1.0209424083769634, 1.0, 1.1309090909090909, 1.0586666666666666, 1.1290322580645162, 1.002308147563622, 1.0278071198298924, 1.0083871115009735, 1.1559975889089813, 1.4, 1.0150399937286698, 1.0584082156611039, 1.061482820976492, 1.1224489795918366, 1.074370709382151, 1.0, 1.003968253968254, 1.1169868554095046, 1.0479715423054121, 1.2018779342723005, 1.003257328990228, 1.0324036330650255, 1.1897915168943207, 1.087248322147651, 1.4153846153846155, 1.036007764019155, 1.1219387755102042, 1.0532537269290845, 1.790909090909091, 1.4382022471910112, 1.4241486068111455, 1.25, 1.0304524361948957, 1.0327455919395465, 1.0056039016452003, 1.0663594470046083, 2.0, 1.0792332268370608, 1.0463826569195867, 1.1566044639590194, 1.3184981388574204, 1.0594478447714546, 1.042983915696062, 1.0915858725761773, 1.085551330798479, 1.0689655172413792, 1.0053521871283204, 1.003045025318188, 1.0501704822211397, 1.0087976539589443, 4.0, 1.1235955056179776, 1.0911606511817342, 1.1869688385269122, 1.0137956990642805, 1.0011152660237486, 1.134319526627219, 2.0, 1.0247524752475248, 1.077186420889113, 1.0267704575659768, 1.1433224755700326, 1.0277946069424442, 1.1671732522796352, 1.3046044864226682, 1.095100864553314, 1.0035304153019067, 1.0106675419521602, 1.087890625, 1.0838641188959661, 1.0833333333333333, 1.0539427922492726, 1.0481141446116429, 1.0296974810172352, 1.1176828033218553, 1.037799043062201, 1.0398172323759791, 1.12, 1.0676156583629892, 3.5, 1.0, 1.6, 1.0338983050847457, 1.1388157894736841, 1.075141102772437, 1.0318278511148748, 1.142695356738392, 1.067624386825508, 1.0357142857142858, 1.2017608217168012, 1.017302457174784, 1.3333333333333333, 1.125, 1.1333333333333333, 1.3333333333333333, 1.1133501259445844, 1.1239737274220032, 1.008134980415788, 1.0200881390758916, 1.5, 1.0502307901167527, 1.2598684210526316, 1.0627806088620304, 1.00060780513538, 1.0565410199556542, 1.0364876891130228, 1.0319820498652066, 1.0516347875247338, 1.183673469387755, 1.6938775510204083, 1.259860788863109, 1.6666666666666667, 2.0, 1.00037624094321, 1.25, 1.8571428571428572, 1.5333333333333334, 1.0284510010537409, 1.0588047910295617, 1.21448087431694, 1.0817120622568093, 1.1666666666666667, 1.005651973583167, 1.0254745254745254, 1.208695652173913, 1.042]
origin-bjaq_15.87 	max: 9.0000	99th: 3.0000	95th: 1.6667	median: 1.0699	mean: 1.1649

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 20.227409 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=42.660939