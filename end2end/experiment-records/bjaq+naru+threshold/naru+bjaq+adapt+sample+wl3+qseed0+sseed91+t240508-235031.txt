Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='naru', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 91, 'naru': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 5.0000	99th: 2.6667	95th: 1.5393	median: 1.0562	mean: 1.1469
ReportEsts: [1.0824742268041236, 1.0429114611624117, 1.0435708138955568, 1.0076923076923077, 1.0, 1.0, 1.183338400729705, 1.0297316462224186, 1.25, 1.0414438502673797, 1.0124758955180273, 1.0029485350550464, 1.0619982158786798, 1.0325581395348837, 1.0367361356411162, 1.0, 1.2857142857142858, 1.0136445242369838, 3.0, 2.6666666666666665, 1.125, 1.028078499029545, 1.0622396162100745, 1.0167164179104478, 1.026640355204736, 1.0, 1.0562223834333575, 1.0, 1.4, 1.2517985611510791, 1.0, 1.0040672921220526, 1.0050901776487378, 1.2880133185349611, 1.0042590688794244, 1.0396384808069867, 1.0133689839572193, 1.0046961124735936, 1.051312073834286, 1.0, 1.0788381742738589, 1.0060975609756098, 1.0, 1.1096995548961424, 1.0741940459663737, 1.2066115702479339, 1.1650485436893203, 1.2690582959641257, 1.0370723315258181, 1.0588235294117647, 1.0587916455879165, 1.0104166666666667, 1.0078448606992203, 2.0, 1.3844155844155843, 1.0176536872417679, 1.0464231354642313, 1.0769230769230769, 1.204968944099379, 1.25, 1.0296028716830243, 1.0417185554171855, 1.0636363636363637, 1.0689655172413792, 1.0909090909090908, 1.1957356962375827, 1.022835633626098, 1.1666666666666667, 1.0, 1.1197286012526095, 1.0047961630695443, 1.0602898550724638, 1.087837837837838, 1.0230638186345171, 1.2, 1.0931174089068827, 1.0, 1.0463084316295326, 2.0, 1.0471319119630405, 1.28125, 1.0720375011187684, 1.165644171779141, 1.0424311926605505, 1.0609057782404998, 1.08, 1.0028787550287876, 1.1239541328990057, 1.2205882352941178, 2.3333333333333335, 1.1287726358148893, 1.0021528018775256, 1.0918367346938775, 1.3253856942496494, 1.2747380675203726, 1.1224489795918366, 1.238532110091743, 1.013840830449827, 1.0, 1.0244994972118109, 1.1442764578833693, 1.004306632213609, 1.003069974240446, 1.0, 1.0119974986880682, 1.1305522208883554, 1.0150638262939704, 1.00304298212248, 1.024175824175824, 1.1666666666666667, 1.3333333333333333, 1.152086137281292, 1.0050694676288554, 1.0674308833445718, 1.1688311688311688, 1.0053025669649485, 1.0, 1.2140122511485452, 1.0976076555023924, 1.0, 1.2197802197802199, 1.0, 1.0451127819548873, 1.0218777745156646, 1.1094198959384949, 1.087378640776699, 1.8, 1.2516556291390728, 1.0, 1.2142857142857142, 1.0054186134483851, 1.1818181818181819, 1.0257095158597662, 1.013176157310004, 1.0737984104957738, 1.141768292682927, 1.0575342465753426, 1.0292819895707983, 1.00199203187251, 1.0485623003194888, 1.044396551724138, 1.2839506172839505, 1.0574037834311807, 1.0457785017944867, 2.0, 1.007346189164371, 1.0644768856447688, 1.0359801488833746, 1.0474677960119994, 1.0, 1.0493011435832273, 1.1214814814814815, 1.024, 1.4476190476190476, 1.0102189781021897, 1.1502811712235796, 1.0734106675764812, 1.0588420957705835, 1.096958174904943, 1.1282894736842106, 1.0, 1.2246376811594204, 1.122314049586777, 1.2857142857142858, 1.0056871653780861, 1.0043157019878153, 1.0028868360277137, 1.0407996432818074, 1.030543677458766, 1.005671728817153, 1.0252631578947369, 1.065126050420168, 1.1501888254091217, 1.0543710021321961, 1.0944287063267233, 1.0208333333333333, 1.0264221324215108, 1.072684203964593, 1.032492205767732, 1.0, 1.3125, 1.1058052434456929, 1.0478378942970545, 1.1119126896041436, 1.1176470588235294, 1.0316320414371827, 1.0611870283499898, 1.0269246585719543, 1.0545454545454545, 1.1937059142702116, 1.108629092368557, 1.0, 1.0909090909090908, 1.0768729358595515, 1.3098751418842225, 1.1279251170046802, 1.3461538461538463, 1.0160771704180065, 1.0026842387272277, 1.0025796941219827, 1.1798245614035088, 1.1597976177927691, 1.023121387283237, 1.0625, 1.0119047619047619, 1.0, 1.0389610389610389, 1.0951640759930916, 1.6445993031358885, 1.1839080459770115, 1.0168067226890756, 1.0957683741648108, 1.0864604273695182, 1.031951442968392, 1.0191963990203217, 1.1428571428571428, 1.0161527165932451, 1.0525238744884038, 1.0303927081175461, 1.0189551872744473, 1.0, 1.0554865424430642, 1.0167017903216276, 1.0028420084764915, 1.0751577739529548, 1.0477542662116042, 1.0005921163931653, 1.0344827586206897, 1.0031882284235734, 1.045987862440998, 1.164692611393119, 1.0666666666666667, 1.0935490562124042, 1.0205290169759178, 1.0677165354330709, 1.0, 1.017552296225054, 1.0788298347476553, 1.0555555555555556, 1.3955223880597014, 1.0909090909090908, 2.6666666666666665, 1.0611667047712843, 1.1454545454545455, 1.1053434031840583, 1.5, 1.5, 1.2903225806451613, 1.0050741608118656, 1.3673469387755102, 1.0635359116022098, 1.062780269058296, 1.052364864864865, 1.0140485312899106, 1.069010470554153, 1.0526315789473684, 1.0, 1.0548313631927122, 1.0485796624125154, 1.0910683012259195, 1.0511316194243023, 1.0669223345354804, 1.0177775552105763, 1.1049284578696343, 1.0318821189021707, 1.0610047846889952, 1.0433584686774942, 1.1794611819235226, 1.8181818181818181, 1.068446088794926, 1.0575692963752665, 1.2272727272727273, 1.08, 1.1596363636363636, 1.1111111111111112, 1.231578947368421, 1.0317340690397685, 1.0027932960893855, 1.176991150442478, 1.0214004542913886, 1.0729072907290729, 1.0008661071129874, 1.0067196906164702, 1.5, 1.130847580938523, 1.2, 1.000648286858174, 1.0302375809935205, 1.0059760593509626, 1.275, 1.4285714285714286, 1.0, 1.408450704225352, 1.0191603861802463, 1.0, 1.0902140672782874, 1.0588235294117647, 1.0380608974358974, 1.000691663421467, 1.1183431952662721, 1.0314465408805031, 1.0007344371880291, 1.067532394047417, 1.0842474959892467, 1.1025641025641026, 1.0, 1.279236276849642, 1.0074441687344913, 1.1744548286604362, 1.0334456613310867, 1.0291845493562233, 1.0856269113149848, 1.0677966101694916, 1.0150891632373114, 1.0927544403721454, 1.4285714285714286, 1.0263036021256386, 1.0604395604395604, 1.0, 1.0763272218540607, 1.2857142857142858, 1.75, 1.021457096600108, 2.0, 1.0164609053497942, 1.0377906976744187, 1.022149302707137, 1.0015128593040847, 1.1409921671018277, 1.032967032967033, 1.0288829664903476, 1.0046383096662699, 1.005449591280654, 1.021106145709483, 1.102808040509437, 3.0, 1.1111111111111112, 1.0223826546108736, 1.3333333333333333, 1.0504109589041095, 1.0, 1.0, 1.0454545454545454, 1.2116788321167884, 1.0884615384615384, 1.3298969072164948, 1.0573593073593073, 1.0, 1.0825565912117177, 1.0505020018478595, 1.5, 1.030970815961882, 1.0, 1.0107340772792834, 1.0348837209302326, 1.1189976384151141, 1.163594470046083, 1.0018181818181817, 1.1521099116781157, 1.037037037037037, 1.0069730113106126, 1.0000447354378161, 1.0213049267643142, 1.0, 1.1428571428571428, 1.8333333333333333, 1.5, 1.1428571428571428, 1.0018570877779205, 1.25, 1.1697171381031615, 1.01, 1.008071725970012, 1.0360808112514932, 1.0114583333333333, 1.1045789448826335, 1.0329538645895746, 1.302325581395349, 1.5, 1.0104166666666667, 1.0398230088495575, 1.0114219802241675, 1.3333333333333333, 3.142857142857143, 1.0824053452115814, 1.041279069767442, 1.0048166314852016, 1.1774891774891776, 1.342769701606733, 1.0351175304446332, 1.4035087719298245, 1.0808477237048666, 1.05614406779661, 1.2692307692307692, 1.055306427503737, 1.0982142857142858, 1.0464794426820925, 1.0065480892326968, 1.0459039856179149, 1.0238095238095237, 1.168421052631579, 1.0686567164179104, 1.0, 1.0345572354211663, 1.0167313002361644, 1.0025994575045207, 1.0130493926735606, 1.0379613692866705, 1.0224171539961013, 1.8333333333333333, 1.055475156777617, 1.2, 1.0777113578138344, 1.1111111111111112, 1.0129880136043938, 1.0202898550724637, 1.067390369733448, 1.158102766798419, 1.1235347159603246, 3.0, 1.032043530834341, 1.0004063820172924, 1.0388081662681625, 1.0, 1.105263157894737, 1.0412667946257197, 1.353448275862069, 1.1072372769332453, 1.0956719817767653, 1.105263157894737, 1.2062122519413288, 1.1130249842241802, 1.0883505654884102, 1.0031770617898914, 1.093201754385965, 1.1459369817578773, 1.2954545454545454, 1.25, 1.00253807106599, 1.3448275862068966, 1.0402455661664394, 1.03125, 1.0221178064215717, 1.0869565217391304, 1.109612660878133, 1.0337176458048356, 1.1288300835654597, 1.0, 1.1067961165048543, 1.28, 1.0000778300968984, 1.5798687089715535, 1.0, 1.0843465045592706, 1.0272224310482545, 1.121282527881041, 1.0, 2.0, 1.1770873786407767, 1.0017953321364452, 1.431924882629108, 1.0, 1.0223711986278778, 1.064321608040201, 1.0869565217391304, 1.0332203389830508, 1.0272727272727273, 1.0183727034120735, 1.1201612903225806, 1.0378628523348759, 1.133976235577751, 1.0, 1.0675675675675675, 1.07704677587517, 1.0104844820387524, 1.0395242266999123, 1.0, 1.0400276052449966, 1.0148884201546824, 1.0277632268203247, 2.0, 1.1263955342902712, 1.0796808059884186, 1.0689177707146678, 1.1585776069197502, 1.0272606264181958, 1.1782603841000447, 1.026890756302521, 1.0303760848601735, 2.0, 1.0679104863300428, 1.2131147540983607, 1.0, 1.2292993630573248, 1.1304347826086956, 1.0364706847918583, 1.0186915887850467, 1.08821224458589, 1.2631884057971015, 1.0477172069355447, 1.086433112403625, 1.012980107955662, 1.1262135922330097, 4.0, 1.035654783339335, 1.0072874493927126, 1.0082737592216158, 1.0103730062055802, 1.0611036339165545, 1.0810249307479225, 1.077319587628866, 1.4285714285714286, 1.013972548632369, 1.0490679977270956, 1.0137345650096499, 1.0920487106017192, 1.0437232704402515, 1.0232067510548524, 1.0076855852794095, 1.0447680690399137, 1.0738714090287278, 2.0, 1.0833333333333333, 1.0139968895800933, 1.0949612403100775, 1.0083892617449663, 1.0428061831153388, 1.0920770877944326, 1.259493670886076, 1.0554699537750385, 1.1043956043956045, 1.0101838660849434, 1.313953488372093, 1.017819640786133, 1.0, 1.1118210862619808, 1.4047619047619047, 1.127659574468085, 1.0184921763869133, 1.0829383886255923, 1.051383399209486, 1.0433017591339648, 1.0851420022796352, 1.0, 1.7234042553191489, 1.5, 1.0, 1.0232558139534884, 1.1402298850574712, 1.4086956521739131, 1.177142857142857, 1.0283562960589554, 1.1539491298527442, 1.0103663707318762, 1.0061624926050088, 1.1016393442622952, 1.0167818744122465, 1.0810810810810811, 1.0882163554410818, 1.1717464925012095, 1.1084271205050782, 1.096820809248555, 1.0967455621301776, 1.03661483504938, 1.0424930918022721, 1.0083680526868648, 2.0, 1.0853333333333333, 1.0314232902033271, 1.0410958904109588, 1.0, 1.2439024390243902, 1.25, 1.023008849557522, 1.5555555555555556, 1.5, 1.026905848144303, 1.032930513595166, 1.0037960112780981, 1.0205669388383916, 1.0810810810810811, 1.0328068043742407, 2.0, 1.1578947368421053, 1.1460754090585725, 1.0309021454879035, 1.0080255785037222, 1.0236359494247635, 1.0032898265689254, 1.0547945205479452, 1.0255112757547404, 1.1296625222024868, 1.0007063255375923, 1.0035328345802161, 1.3636363636363635, 1.1031833150384194, 1.0, 1.0113378684807257, 1.0217361086979184, 3.0, 1.072782874617737, 1.0334330891549044, 1.2857142857142858, 1.1553187947394705, 1.4, 1.1875, 1.0135410764872521, 1.6923076923076923, 1.0066242084709576, 1.0008543357539512, 1.1875, 1.0740740740740742, 1.3700564971751412, 1.0143472022955524, 1.0724431818181819, 1.000090380501913, 1.0102367242482406, 1.0, 1.186074299369976, 1.0, 2.0, 1.0392324192171967, 1.004396788432797, 1.1021759697256386, 1.0154964322318032, 1.0185741907316161, 1.2840909090909092, 2.142857142857143, 1.013102119460501, 1.0571184995737426, 1.0416744438599765, 1.0737158105403601, 1.0422398838100617, 1.0961638312818789, 1.1776556776556777, 1.0251716247139588, 1.1912350597609562, 1.023733226517124, 1.0763406940063092, 1.1334702258726899, 1.1197478991596639, 1.0637891285863306, 4.0, 1.0187971895973154, 1.0000795283966082, 1.0109933296511875, 1.105263157894737, 1.011376404494382, 1.4414893617021276, 1.0, 1.0234992600079413, 1.0134426229508198, 1.119804400977995, 1.1176470588235294, 1.6666666666666667, 1.0273634110899736, 1.5, 1.3941368078175895, 1.1538461538461537, 1.0891773079338496, 1.3333333333333333, 1.2408376963350785, 1.1153039832285114, 1.0, 1.3386243386243386, 1.0296296296296297, 1.75, 1.0, 1.08130081300813, 1.0320284697508897, 1.0104042806183116, 1.0095338983050848, 1.003125, 1.018018018018018, 1.089150378938971, 1.0467532467532468, 1.4411764705882353, 1.3920454545454546, 1.2692307692307692, 1.0, 1.1007751937984496, 1.215007215007215, 1.0254237288135593, 1.1049799656554093, 1.0040093610117362, 1.1542317055706717, 1.002104763881066, 1.0312319259687681, 1.0577617328519855, 1.0017931858936042, 1.8333333333333333, 1.0, 1.0, 1.0516696462776145, 1.1118743866535818, 1.0065359477124183, 1.2011834319526626, 1.0174112256586483, 1.0186560553821833, 1.0056131896160592, 1.0897435897435896, 1.1, 1.0399703923019985, 1.1178419936373276, 1.0731831550582476, 1.0411054864589804, 1.1776315789473684, 1.0527909037212049, 1.0201922931105079, 1.1905487804878048, 1.0245174752217006, 1.1111111111111112, 1.0374707259953162, 1.1081081081081081, 1.0192307692307692, 1.0762463343108504, 1.0347890451517394, 1.0, 1.0682926829268293, 1.0333394608867126, 1.0740740740740742, 1.0219989423585405, 1.166313559322034, 1.0232558139534884, 1.0719659797186785, 1.0180937350901016, 1.1935267257587967, 1.0104961832061068, 1.0196759259259258, 1.0207675834084762, 1.2147505422993492, 1.0, 1.0, 1.1111111111111112, 1.0086229865568608, 1.8333333333333333, 1.0523854489860156, 1.0584244251790427, 1.2058041648205582, 1.0687752069624283, 1.0050117589045253, 1.1210075026795283, 1.0608365019011408, 1.001386962552011, 1.0251203418883696, 1.025596654409114, 1.003259593030223, 1.0358906419366494, 1.25, 1.103448275862069, 1.3201581027667983, 1.0269654521830447, 1.019543973941368, 1.0255135135135136, 1.1876106194690266, 1.02729044834308, 1.006714123928167, 1.0434173669467788, 1.0380143540669857, 1.3125, 1.0665933212529122, 1.0193472826896655, 1.1469258589511755, 1.0008428150021071, 1.032258064516129, 1.0053821313240043, 1.1144278606965174, 1.5625, 1.032792026763312, 1.3846153846153846, 1.0497354497354496, 1.0263736263736263, 1.1827376938637897, 1.0100340136054422, 1.08, 1.2222222222222223, 1.0769230769230769, 1.0090812162211846, 1.0095916535786404, 1.0074894150854634, 1.0875931842385516, 1.035105689542788, 1.0, 1.0184887459807075, 1.1357887730197471, 1.1072815750703155, 1.0131979695431472, 1.2152777777777777, 1.0109389243391067, 1.0321932906999585, 1.1759180187873612, 1.0289946140035906, 1.0, 1.3333333333333333, 1.0053895028307251, 1.02141419948261, 1.0004611128189365, 1.0751220484208428, 1.083000798084597, 1.066350710900474, 1.0081517185636415, 1.150671618479053, 1.0018416206261511, 1.3027027027027027, 1.0007007708479327, 1.0001595248613362, 1.0119047619047619, 1.75, 1.0280718537414966, 1.0093491901560994, 1.0040068689181454, 1.2661870503597121, 1.008029197080292, 1.0215657164775998, 1.015705311250714, 1.0781671159029649, 1.2692307692307692, 1.1246630727762803, 1.0463157894736843, 1.090625, 1.5925925925925926, 1.0479606659962006, 1.0049554013875124, 1.0874661857529306, 1.2058823529411764, 1.0534456816130002, 1.0525677315002022, 1.0144632308005703, 1.0367556468172485, 1.3333333333333333, 1.0357142857142858, 2.0, 1.033105433609212, 1.5384615384615385, 1.3333333333333333, 1.3636363636363635, 1.2197092084006462, 1.0579710144927537, 1.0454643628509719, 1.0060078823416323, 1.2820512820512822, 1.338235294117647, 1.0, 1.0333333333333334, 1.2837837837837838, 1.4893617021276595, 1.029595015576324, 1.0144600609200138, 1.005919589137218, 1.0390625, 1.007031583587003, 1.00067063710525, 5.0, 1.0080466809567554, 1.1157142857142857, 1.0, 1.3333333333333333, 1.078698224852071, 1.102775586315714, 1.0476139435730705, 1.031055900621118, 1.0, 1.1120689655172413, 1.312883435582822, 2.0, 1.5, 1.093257874015748, 1.0963890935887988, 1.1279774489076815, 1.25, 1.0023380680593372, 1.0681642137877614, 1.0061919504643964, 1.3333333333333333, 1.1451612903225807, 1.002188220583391, 1.394736842105263, 1.0951899637314941, 1.071686897239774, 1.091764705882353, 1.0448979591836736, 1.0053719008264463, 1.2143467122117848, 1.1074380165289257, 1.2105263157894737, 1.0617564578216718, 1.0331457925636007, 1.044169630885498, 1.6057692307692308, 1.1590909090909092, 1.1940298507462686, 1.0750670241286864, 1.0281903607153684, 1.014295115160719, 1.0142632688254456, 1.0524017467248907, 3.0, 1.25, 1.059680260127354, 1.1591908531222515, 1.290604940673021, 1.0149285336156697, 1.0582037129954842, 1.0955138084725289, 1.1395348837209303, 1.0416666666666667, 1.0296236341562122, 1.0182643625256287, 1.0383028874484383, 1.2329246935201401, 2.5, 1.1066666666666667, 1.000146762062007, 1.114695340501792, 1.0300308503117166, 1.0093404213427841, 1.1193181818181819, 2.0, 1.0058754406580495, 1.074421194815043, 1.0281014393420151, 1.0778688524590163, 1.0045713536451628, 1.236220472440945, 1.031890660592255, 1.047536231884058, 1.0029481453981635, 1.0347560975609755, 1.1059907834101383, 1.1139564660691421, 1.03125, 1.0412679425837321, 1.0012127313914376, 1.0779392338177014, 1.0485047785428014, 1.0351382488479262, 1.0320062451209993, 1.3846153846153846, 1.040339702760085, 2.5, 1.5, 1.3076923076923077, 1.0281329923273657, 1.1492890995260663, 1.0087637862527388, 1.0360979154849688, 1.025237449118046, 1.109205020920502, 1.0923913043478262, 1.346938775510204, 1.0020806826888606, 1.6, 1.3333333333333333, 1.431219512195122, 1.0, 1.0915697674418605, 1.1256803562592776, 1.010381568163191, 1.00385483111782, 1.25, 1.000619578686493, 1.3255813953488371, 1.1800498753117208, 1.0002340061392199, 1.0790190735694822, 1.0391459074733096, 1.0087412587412588, 1.111536391364153, 1.1033386327503976, 1.4791666666666667, 1.2304469273743017, 1.0, 1.0, 1.0007778691749223, 1.6666666666666667, 1.5714285714285714, 1.3846153846153846, 1.0482509047044632, 1.0930232558139534, 1.0027793218454697, 1.0916488222698073, 1.0, 1.2681564245810055, 1.0269946010797841, 1.1031390134529149, 1.04, 1.25, 1.039898320070734, 1.0049889135254988, 1.1004273504273505, 1.0383042023056899, 1.0063102769691155, 1.0728776079223152, 1.0791573571656559, 1.0, 1.0890117484450588, 1.008832224491832, 1.0022865853658536, 1.2695652173913043, 1.031578425540353]
origin-bjaq_15.87 	max: 5.0000	99th: 2.6667	95th: 1.5393	median: 1.0562	mean: 1.1469

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 20.326630 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=naru', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[1.6093254e-06 1.8477440e-06 4.7683716e-07 1.1920929e-07 1.1920929e-07]
Distance score: 8.344650268554688e-07
SAUCE Drift detection: False
Detection latency: 0.0232s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 2.038473 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 6.0000	99th: 2.5000	95th: 1.6159	median: 1.0656	mean: 1.1572
ReportEsts: [1.0422535211267605, 1.040710751237067, 1.0197498556386912, 1.0318471337579618, 1.0285714285714285, 1.0, 1.1872999745999493, 1.0062512187439063, 1.0, 1.03646408839779, 1.0884008467237565, 1.001462521531567, 1.018162393162393, 1.005813953488372, 1.0179359012055278, 1.0718232044198894, 1.0776699029126213, 1.1538461538461537, 1.5555555555555556, 1.1500474833808167, 1.0774299835255354, 1.0059766958256977, 1.1588541666666667, 1.1159153633854646, 1.0384871679423684, 1.0094968589054276, 3.0, 1.0199883202378424, 1.1666666666666667, 1.3333333333333333, 1.147135904155747, 1.0, 1.0011601623522026, 1.0022172607985727, 1.4626038781163435, 1.128194502003039, 1.015299065684365, 1.0455580865603644, 2.75, 1.0041070940715782, 1.0240562546262029, 1.0972464273265947, 1.0853658536585367, 1.0247116968698518, 1.0970695970695972, 1.0794171967986868, 1.0416666666666667, 1.0287746524409958, 1.266990291262136, 1.1268033409263478, 1.6, 1.0533807829181494, 1.0896860986547086, 1.0303030303030303, 1.0609603489577746, 1.0003273054578186, 1.0335308570602688, 1.1161731207289294, 1.0843373493975903, 1.0108060899942646, 1.0294117647058822, 1.0199885437773046, 1.0452616690240453, 1.0214285714285714, 1.116504854368932, 1.3333333333333333, 1.1160549399815327, 1.0730423338451416, 1.0, 1.0, 1.0773734838979507, 1.0265225933202358, 1.0591346153846153, 1.1195445920303606, 1.052637515509268, 1.1869639794168096, 1.114814814814815, 1.2248803827751196, 1.099290780141844, 1.0151915394525854, 1.1536328341652802, 1.1428571428571428, 1.0, 1.4615384615384615, 1.0034642032332564, 1.0655737704918034, 1.0123456790123457, 1.5, 1.0, 1.0570875587830704, 1.08736120182887, 1.0106472277446432, 1.1023120055303788, 1.1826795945350375, 1.0395778364116095, 1.3295063145809414, 1.1311627906976744, 1.4170984455958548, 1.2857142857142858, 1.1331747919143875, 1.4074074074074074, 2.0, 1.058853236657468, 1.214929214929215, 1.0195794053662075, 1.0016479312577247, 1.048780487804878, 1.0086439182271196, 1.1153091265947006, 1.0502991964438366, 1.0779179810725552, 1.0252999478351592, 1.0, 1.1111111111111112, 1.1456419448801254, 1.0103871495628955, 1.0944156591824985, 1.0674157303370786, 1.0043959202688102, 1.0, 1.2593698175787729, 1.107484076433121, 1.0, 1.2592592592592593, 1.0, 1.0271966527196652, 1.0163408134146197, 1.0762607626076262, 1.0606060606060606, 2.0, 1.2062717770034843, 1.0, 1.0, 1.00268046954432, 1.3846153846153846, 1.1187943262411348, 1.0102686408956905, 1.0471640161081155, 2.5, 1.6, 1.0244399185336048, 1.0044523597506678, 1.0539529914529915, 1.0418124135686977, 1.2391304347826086, 1.1180400890868596, 1.000740222472343, 1.5, 1.0265180630284396, 1.0391173520561685, 1.0647332988089073, 1.002802773270394, 1.3333333333333333, 1.0215842197666012, 1.020884520884521, 1.02, 1.125, 1.0, 1.1049445005045408, 1.0540431777293817, 1.014695380914797, 1.187993680884676, 1.1089385474860336, 1.0350877192982457, 1.0467836257309941, 1.0849933598937582, 1.25, 1.0227214558845439, 1.0, 1.0802919708029197, 1.004809362083456, 1.2653508771929824, 1.1263276623742833, 1.0088339222614842, 1.010752688172043, 1.2469325153374233, 1.0580357142857142, 1.1398201144726083, 1.0399320305862363, 1.0367840252233316, 1.1565853658536585, 1.0004054111722784, 1.01840490797546, 1.2258064516129032, 1.0249259339714643, 1.1207864018021707, 1.070921985815603, 1.7731958762886597, 1.2116991643454038, 1.5714285714285714, 1.1203007518796992, 1.0118811031840214, 1.037037037037037, 1.0316718587746625, 1.4489795918367347, 1.002577007367598, 1.008352257418883, 1.005958291956306, 1.00879703805049, 1.0357410527451838, 1.0757042253521127, 1.0283677354335412, 1.1246995994659545, 1.0140349546953786, 1.191644908616188, 1.118027062418158, 1.078125, 1.0810810810810811, 1.02, 1.0, 1.0782122905027933, 1.0411040115934391, 1.6473988439306357, 1.0485436893203883, 1.008603031544449, 1.6842105263157894, 1.002378932996835, 1.1025641025641026, 1.0136575481256331, 1.0, 1.142281879194631, 1.0297387437465257, 1.0139458670717267, 1.06801423719825, 2.5, 1.2801507537688441, 1.012480934183983, 1.009865120945268, 1.0268817204301075, 1.2103559870550162, 1.0870288248337028, 1.05770281124498, 1.0086206896551724, 1.0021652580847944, 1.0341142387066777, 1.1223776223776223, 1.192274678111588, 1.044392523364486, 1.4285714285714286, 1.1354923992068737, 2.0, 1.0353061224489797, 1.134179215467559, 1.0065904245008723, 1.4246153846153846, 1.25, 3.3333333333333335, 1.1131434429230431, 1.1538461538461537, 1.104325474206701, 1.5, 1.2415254237288136, 1.0128458498023716, 1.5714285714285714, 1.0265119216800884, 1.174641148325359, 1.143141153081511, 1.0833333333333333, 1.0021261516654856, 1.029354174963494, 1.042857142857143, 1.0, 1.0092221537196877, 1.208916833380966, 1.0883652430044182, 1.023651777445323, 1.1065928726842562, 1.0937523337266442, 1.1147431621080721, 1.0273914319248827, 1.0834597875569043, 1.0634998168274514, 1.1772623482754476, 1.6923076923076923, 1.0746567191047194, 1.1929824561403508, 1.2692307692307692, 1.1071428571428572, 1.5789473684210527, 1.1066176470588236, 1.0008592837011068, 1.0410494689770822, 1.102974828375286, 1.2248062015503876, 1.0125141201316241, 1.0143061516452074, 1.0072887376054462, 1.0035322394309465, 1.5, 1.2375886524822695, 1.1243110838946724, 1.002800272458942, 1.0030326335367816, 1.0079595521849043, 1.0634666666666666, 1.0201906898485698, 1.0123193049918109, 1.012609950522265, 1.035566846617974, 1.0528097027295833, 1.1180555555555556, 1.625, 1.25, 1.0724355858045698, 1.1666666666666667, 1.031021897810219, 1.1058593150053755, 1.0376843255051884, 1.05, 1.3865546218487395, 1.0, 1.0570046640179651, 1.016560971643714, 1.1904761904761905, 1.0249910319263422, 1.0160898421637743, 1.1550387596899225, 1.0, 1.7142857142857142, 1.0328450954283177, 1.8571428571428572, 1.0202191299824437, 1.0807453416149069, 1.0, 1.0252663764631742, 1.28, 1.7, 1.0280682702575519, 2.0, 1.0573770491803278, 1.0588235294117647, 1.1909696213067, 1.1869436201780414, 1.0884955752212389, 1.0982142857142858, 1.0229866960560499, 1.0157120073525436, 1.0843373493975903, 1.043538463734601, 1.1195156880614503, 3.0, 1.0833333333333333, 1.0154837338690983, 1.0, 1.0387773722627738, 1.15, 4.0, 1.037037037037037, 1.2142142142142143, 1.0776, 1.3650793650793651, 1.342685370741483, 1.263157894736842, 2.5, 1.0671001584612863, 1.1875, 1.03125, 1.0150181587251186, 1.1978021978021978, 1.0441988950276244, 1.0066730219256435, 2.25, 1.25, 1.1494736842105264, 1.2236842105263157, 1.0158730158730158, 1.0124988203713996, 1.0595282203285168, 1.0913838120104438, 2.0, 1.006570875560384, 1.2636363636363637, 1.3793103448275863, 1.0, 1.009029745042493, 1.1111111111111112, 1.0483193277310925, 1.0826446280991735, 1.1055480378890392, 1.000159764130048, 1.0531177829099307, 1.070725841714036, 1.034550286753392, 1.1300639658848615, 1.0334224598930482, 1.02879482034001, 1.08, 1.0285714285714285, 1.0111060202552429, 1.009398993910511, 1.1750587007565876, 1.0288461538461537, 1.2, 1.0503731343283582, 2.0, 1.8148148148148149, 1.125, 1.0866290018832392, 1.4545454545454546, 1.12, 1.0272727272727273, 1.098976109215017, 1.1230702136938508, 1.13574144486692, 1.0769794261077041, 1.1235955056179776, 1.0814814814814815, 1.0570719602977667, 1.0, 1.0036153124499463, 1.4385964912280702, 1.000075389196728, 1.008710727726331, 1.032870186581977, 1.0050993022007515, 1.5714285714285714, 1.035030549898167, 1.1666666666666667, 1.017738359201774, 1.0833333333333333, 1.4285714285714286, 1.0279126213592233, 1.079928154467894, 1.1511254019292605, 1.0454863540937718, 3.0, 1.06301652892562, 1.0079307069127545, 1.0680680488693683, 1.0, 1.3620689655172413, 1.0007936507936508, 1.2908653846153846, 1.103088882773803, 1.1431659249841069, 1.0384615384615385, 1.002939015429831, 1.0674166050367833, 1.0520865677203006, 1.003912170378701, 1.0862167708681334, 1.0958772770853307, 1.1691176470588236, 1.1712328767123288, 1.0400137332625863, 1.5118110236220472, 1.0527509926262053, 1.0, 1.0, 1.1225554106910038, 1.112, 1.221506105834464, 1.0698536734850226, 1.12304120719675, 1.0, 1.048780487804878, 1.0909090909090908, 1.5951972555746141, 1.173913043478261, 1.0, 1.096837032859999, 1.3333333333333333, 1.0, 1.1621826449412656, 2.0, 1.1982125758059368, 1.0144706778370145, 1.4061302681992338, 1.1, 1.0327088970127571, 1.0860585197934596, 1.1071428571428572, 1.0965841053759375, 1.062992125984252, 1.035674470457079, 1.1993265993265994, 1.0230905861456483, 1.1362202466303413, 1.0, 1.054945054945055, 1.0359066427289048, 1.0218040621266429, 1.125574272588055, 1.1666666666666667, 1.0378614916286149, 1.0184538556073581, 1.043921916592724, 2.0, 1.1090970124202753, 1.0354449989704773, 1.0589320514486162, 1.1167872542571073, 1.0261387846766488, 1.0110921256676813, 1.0540350877192983, 1.007318254838463, 2.25, 1.0357684146711124, 1.0881987577639751, 1.0146572104018912, 1.0883002207505519, 1.1229946524064172, 1.0335094659305473, 1.2601626016260163, 1.0488945917082424, 1.2453192510801727, 1.0245239192198419, 1.0757670632435816, 1.0070436557319926, 1.1893637797641403, 1.072289156626506, 1.2531645569620253, 1.0272688700454058, 1.1336206896551724, 1.0280469976717743, 1.0003047765518989, 1.3333333333333333, 1.1324981017463933, 1.262857142857143, 1.1, 1.2222222222222223, 1.0050184438534786, 1.143884892086331, 1.07331136738056, 1.0, 1.0810810810810811, 1.0309985802177, 1.0531362007168459, 1.039908344472026, 1.0511481834409266, 1.047917434574272, 1.3170731707317074, 1.1066156369600875, 1.0818911601247685, 1.3134328358208955, 1.0299295774647887, 1.1050632911392404, 1.1004566210045663, 1.010924529278774, 1.1048387096774193, 1.0273998973305956, 2.0, 1.0718446601941747, 1.43, 1.0999651081646895, 1.0739957716701902, 1.021883920076118, 1.0572450805008944, 1.0267558528428093, 1.0482188408817954, 2.0, 1.6896551724137931, 1.4285714285714286, 1.3333333333333333, 1.0576923076923077, 2.0357142857142856, 1.3555166374781087, 1.1598173515981736, 1.0351886540005353, 1.0004074979625102, 1.0439899451553931, 1.000575515908904, 1.0052322269197325, 1.0359596072721842, 1.0523058297824586, 1.0953401178361006, 1.0686528497409327, 1.0086609086776563, 1.086785009861933, 1.0338427947598254, 1.2416107382550337, 1.0887573964497042, 1.0082778114274178, 1.2406015037593985, 1.0115903931174572, 1.1067961165048543, 1.1892047085845536, 1.023404255319149, 1.25, 1.018957345971564, 1.1875, 1.2, 1.0364741641337385, 1.0225902373622753, 1.0192678227360308, 1.1596858638743455, 1.0342857142857143, 1.028140262993112, 1.262720246162863, 1.014519056261343, 1.0, 2.0, 1.0337538733953076, 1.5205479452054795, 1.0207401382675885, 1.0028375502482856, 1.0, 1.034054302807179, 1.1177884615384615, 1.06672192291753, 1.2059701492537314, 1.014303975814804, 1.0489354105199857, 1.0054230305387035, 1.1341463414634145, 1.125, 1.0873931944236246, 2.0, 1.1240601503759398, 1.2067510548523206, 1.0518134715025906, 1.0114242576748869, 1.3, 1.0323307102919859, 1.1940298507462686, 1.002906976744186, 1.0583574268160463, 1.0343688037012557, 1.03145795523291, 1.06557703807056, 1.0609090909090908, 1.0038923126824522, 1.0, 1.0458820393709782, 1.0464039475463025, 1.0454545454545454, 1.026404874746107, 1.0427412814274128, 1.416289592760181, 1.0390735709579297, 1.1818181818181819, 1.1222879684418146, 1.0405006614429633, 1.2771362586605082, 1.1257861635220126, 1.0204926273458446, 1.3238095238095238, 1.8, 1.0372255806554247, 1.0214088397790055, 1.0315240879623744, 1.073517126148705, 1.0459867264711815, 1.0041733262297994, 1.0030075187969925, 1.0412667946257197, 1.1273291925465838, 1.0109489220486876, 1.0686582809224319, 1.0626865671641792, 1.146341463414634, 1.829268292682927, 1.0733197556008147, 1.1310332171040558, 1.3, 1.0, 1.0125, 1.0140948196961377, 1.0677115987460815, 1.106145251396648, 1.5555555555555556, 1.0038431975403537, 1.1171075837742503, 1.6153846153846154, 1.0039398823545618, 2.3333333333333335, 1.129559407728422, 1.5, 1.4235924932975872, 1.0, 1.1056979391674937, 1.303030303030303, 1.4162679425837321, 1.101113967437875, 1.0, 1.1016889626767983, 1.0175150519978107, 1.8, 1.0, 1.0469798657718121, 1.0266272189349113, 1.0781210751067571, 1.0043630017452008, 1.0719225449515906, 1.0983240223463686, 1.084931506849315, 1.123991195891416, 1.5923913043478262, 1.0214285714285714, 1.1818181818181819, 1.0, 1.0712377560106856, 1.2376470588235293, 1.1142034548944337, 1.15994005994006, 1.0031770590066946, 1.218974122383928, 1.010492511965416, 1.0112079701120797, 1.0638722554890219, 1.0030135610246107, 1.3333333333333333, 1.0, 1.0769230769230769, 1.0880238615589735, 1.1183237469186524, 1.0307262569832403, 1.2352941176470589, 1.0987576064908722, 1.0544827667360939, 1.0131599944405265, 1.02020202020202, 1.0434782608695652, 1.0561143462149285, 1.1636786188579018, 1.0192750699550985, 1.0453137231122038, 1.1443298969072164, 1.1145127510163855, 1.0866143315207013, 1.0185987619583567, 1.017774343122102, 1.0275923632444952, 1.0, 1.0177059276366436, 1.1129770992366412, 1.0076125611697249, 1.3333333333333333, 1.0020408163265306, 1.0, 1.0879345603271984, 1.0784849497841664, 1.1515151515151516, 1.0155571611329484, 1.1987740805604203, 1.2340425531914894, 1.0772847220115866, 1.0056951022120977, 1.103154760232604, 1.022875816993464, 1.0508474576271187, 1.0083423414955115, 1.2163636363636363, 1.0625, 1.0, 1.0, 1.0172459003166792, 1.8571428571428572, 1.0127161626895953, 1.0752806219613291, 1.1996306555863343, 1.1022953189951201, 1.0035602850336265, 1.04318669527897, 1.0062111801242235, 1.0129107981220657, 1.0149060297572436, 1.0282789764174611, 1.0058069315245994, 1.0357291341856356, 1.2, 1.1875, 1.4320557491289199, 1.014174364896074, 1.0619946091644206, 1.0191653233028837, 1.187592319054653, 1.0459183673469388, 1.025665856538608, 1.0022598870056496, 1.0359474843739096, 1.3157894736842106, 1.022093758733801, 1.011034763471794, 1.105471562275018, 1.006322444678609, 1.0731707317073171, 1.0776992936427852, 1.0004885973591313, 1.0524899057873487, 1.0625, 1.0040869723453123, 1.1111111111111112, 1.0511899732432053, 1.1660280970625798, 1.0979899497487438, 1.1467544684854187, 1.1554545454545455, 1.1849710982658959, 1.1203747072599533, 1.0386317702539678, 1.0334608030592733, 1.0033826425001262, 1.0374487342667231, 1.125, 1.0301163586584532, 1.080070237050044, 1.0161457764178778, 1.0616438356164384, 1.2204439855446567, 1.2006079027355623, 1.125, 1.0049566294919454, 1.0045318549806406, 1.180722891566265, 1.049404761904762, 1.0102054210146354, 1.0148026315789473, 1.587227414330218, 1.028932932874127, 1.098340108401084, 1.0065402223675606, 1.0466019417475727, 1.0036685351301222, 1.115734246114135, 1.0156739811912225, 1.1923076923076923, 1.031634446397188, 1.0105599640511862, 1.0618556701030928, 1.75, 1.019501596544778, 1.00016179172782, 1.0105616898703793, 1.3251533742331287, 1.037587147620491, 1.0272881880024738, 1.0277910876856733, 1.131394182547643, 1.0571428571428572, 1.085047248471373, 1.2777777777777777, 1.1108179419525066, 1.9, 1.0722047881999088, 1.012214983713355, 1.0387531592249368, 1.1666666666666667, 1.0155339805825243, 1.038679245283019, 1.0505050505050506, 1.2121212121212122, 1.020496894409938, 1.1474654377880185, 1.0923231309583543, 1.4, 1.0383813878261952, 1.1011118832522586, 1.2029668653819492, 1.1043478260869566, 1.5454545454545454, 1.0318208603417796, 1.039561323777026, 1.0096158997160765, 1.2438563327032137, 1.3333333333333333, 1.263157894736842, 1.0857142857142856, 1.3258426966292134, 1.7307692307692308, 1.117732558139535, 1.0133407245243093, 1.0008280370886462, 1.0662251655629138, 1.023824037097592, 1.000887707131664, 6.0, 1.0471268276096566, 1.00570017100513, 1.6666666666666667, 1.2857142857142858, 1.041126070991432, 1.1327877665611372, 1.0495677233429395, 1.0261780104712042, 1.0, 1.1066176470588236, 1.115979381443299, 1.1818181818181819, 1.0093876152029857, 1.0440142778693027, 1.0029449581796457, 1.1882586078771364, 1.3, 1.016353830283459, 1.0391167192429023, 1.0252613240418118, 1.2857142857142858, 1.04292343387471, 1.0, 1.0769230769230769, 1.0997847093576327, 1.0956415608306507, 1.0459965928449744, 1.0230263157894737, 1.0234999827880986, 1.2009943181818181, 1.0790378006872852, 1.1764705882352942, 1.0634584261671662, 1.1366243342892257, 1.048965905836928, 1.5801526717557253, 1.180952380952381, 1.093603744149766, 1.1, 1.0294203320710749, 1.05679012345679, 1.0004886331105693, 1.0791111111111111, 1.5, 1.0781719783523753, 1.0512389752204956, 1.10917664127675, 1.3126815101645692, 1.0030237642315665, 1.0033080634045486, 1.0987331169511045, 1.091633466135458, 1.0535714285714286, 1.0131073745531576, 1.0003419037199124, 1.0726558664702994, 1.2919020715630884, 3.0, 1.1666666666666667, 1.0361699022040578, 1.2550724637681159, 1.0101427254191504, 1.0050982530599373, 1.1134792626728112, 1.5, 1.0118110236220472, 1.0942020971779585, 1.0252803649496294, 1.0419354838709678, 1.021228440253133, 1.2233009708737863, 1.3349397590361445, 1.0852523272905439, 1.0039903745489966, 1.0032647194220272, 1.0910815939278937, 1.1730558598028478, 1.054054054054054, 1.047730996651706, 1.1728931364031276, 1.0424857710448379, 1.0846094946401226, 1.035902345619914, 1.0757372654155497, 2.1666666666666665, 1.0391459074733096, 3.0, 1.5, 1.4666666666666666, 1.0, 1.132236842105263, 1.0195914577530176, 1.069368634506312, 1.1735066119471045, 1.0302293259207784, 1.0892018779342723, 1.1511111111111112, 1.0030976462581842, 1.8333333333333333, 1.0555555555555556, 1.0868856910127613, 1.1111111111111112, 1.12826899128269, 1.0967611336032388, 1.003844993968637, 1.0210719039029301, 1.0, 1.005136106831022, 1.0349971313826736, 1.031657461709275, 1.0020736965745747, 1.0570469798657718, 1.0417919422730006, 1.0180499436974233, 1.0542142958781957, 1.0994694960212201, 1.3709677419354838, 1.263953488372093, 1.3333333333333333, 2.0, 1.0002791788419663, 1.75, 1.3, 1.5434782608695652, 1.0612449799196788, 1.0203224495325836, 1.0253807106598984, 1.0384615384615385, 1.1666666666666667, 1.010899643015568, 1.0330165082541272, 1.4178272980501392, 1.0185950413223142]
origin-bjaq_15.87 	max: 6.0000	99th: 2.5000	95th: 1.6159	median: 1.0656	mean: 1.1572

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 16.870939 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=39.268685