Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='naru', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 60, 'naru': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 5.0000	99th: 2.6667	95th: 1.5371	median: 1.0561	mean: 1.1487
ReportEsts: [1.1290322580645162, 1.0398050365556457, 1.0505254679058034, 1.001926782273603, 1.0714285714285714, 1.0, 1.1732079339241575, 1.00859443820903, 1.25, 1.0304232804232805, 1.019853980896315, 1.0024921119239971, 1.064371926687528, 1.0232558139534884, 1.024726245143059, 1.0, 1.7307692307692308, 1.02054551895147, 3.0, 2.6666666666666665, 1.2272727272727273, 1.1241751132197542, 1.043118196920483, 1.0930680359435174, 1.0093734583127776, 1.0, 1.0250904086792332, 1.2, 1.4, 1.1510791366906474, 1.0, 1.000710801216824, 1.0038445450519167, 1.423418423973363, 1.003671611102952, 1.0219010222733735, 1.053475935828877, 1.004130337253984, 1.0374681451890626, 1.1428571428571428, 1.0077519379844961, 1.0426829268292683, 1.0, 1.127048408363157, 1.0151164584297394, 1.2231404958677685, 1.087378640776699, 1.1841004184100419, 1.0329172826233033, 1.0093457943925233, 1.0469514104695141, 1.1616766467065869, 1.0059337956950622, 1.0, 1.225974025974026, 1.0905987574247287, 1.1069090909090908, 1.0687022900763359, 1.2732919254658386, 1.25, 1.0001817851299764, 1.0323785803237857, 1.0227272727272727, 1.0804597701149425, 1.0, 1.1281714028590217, 1.0408580183861083, 1.1666666666666667, 1.0, 1.129395662244683, 1.0, 1.059061957151129, 1.114864864864865, 1.0569043321299638, 1.2, 1.1065573770491803, 1.0, 1.0444832097688617, 2.0, 1.0447789032683865, 1.0, 1.0320193861066236, 1.2760736196319018, 1.003440366972477, 1.0748945147679325, 1.04, 1.0132193876321938, 1.0227082586351142, 1.2352941176470589, 2.3333333333333335, 1.120879120879121, 1.0113622167625416, 1.0031152647975077, 1.3169705469845723, 1.2059471365638768, 1.1063218390804597, 1.25, 1.0129645635263613, 1.0, 1.0146672702580353, 1.1552195824334053, 1.0130321459600347, 1.0054694943364269, 1.0, 1.0196585520671961, 1.088728323699422, 1.0577515084349218, 1.1020098596890406, 1.0216097713748826, 1.1666666666666667, 1.3333333333333333, 1.1446910938753678, 1.0142169286665734, 1.053226879574185, 1.0405405405405406, 1.0059913662571478, 1.0, 1.287454323995128, 1.1732057416267943, 1.0, 1.2197802197802199, 1.1666666666666667, 1.0451127819548873, 1.0081745411326921, 1.1113613419274675, 1.037037037037037, 1.8, 1.298841059602649, 1.0, 1.0714285714285714, 1.005980922391142, 1.1818181818181819, 1.0221354166666667, 1.003529552148819, 1.0533349832941468, 1.1112759643916914, 1.0082872928176796, 1.042242079610073, 1.00199203187251, 1.04923273657289, 1.0320429407937541, 1.2407407407407407, 1.0345727332028702, 1.0136683813823817, 2.0, 1.007346189164371, 1.045400238948626, 1.031017369727047, 1.0509970001764601, 1.0, 1.0634900193174501, 1.0289634146341464, 1.016, 1.4476190476190476, 1.0350364963503649, 1.035072413191415, 1.048780487804878, 1.0550094688429976, 1.079847908745247, 1.082236842105263, 1.0, 1.144927536231884, 1.1411764705882352, 1.2857142857142858, 1.019621628531254, 1.0051696924871711, 1.0172711571675301, 1.0576995695189184, 1.0109957238851557, 1.1324110148154038, 1.0442105263157895, 1.134453781512605, 1.2068364481456377, 1.0952380952380953, 1.1887179487179487, 1.0911983032873807, 1.0347853337511752, 1.0454858438980923, 1.0093017349481739, 1.0, 1.0769230769230769, 1.0071063104036384, 1.0476190476190477, 1.0673325934147244, 1.2881355932203389, 1.0469221808805402, 1.0213977228111504, 1.0097612709131443, 1.1153846153846154, 1.042654028436019, 1.0420274066853965, 1.0, 2.0, 1.0586099363492674, 1.23950056753689, 1.088309081786252, 1.4583333333333333, 1.0212218649517686, 1.0023790316364962, 1.001306162754163, 1.1798245614035088, 1.1872035416886266, 1.1568627450980393, 1.03125, 1.024390243902439, 1.0, 1.0457516339869282, 1.0486191499917314, 1.6620209059233448, 1.0574712643678161, 1.0182896688087, 1.0957683741648108, 1.0880603970547116, 1.012386596635115, 1.0243553939079042, 1.1069182389937107, 1.0086705202312138, 1.039757412398922, 1.0218134298351427, 1.037124210976784, 1.0, 1.0761904761904761, 1.0196167254249306, 1.0122472609291944, 1.0838635049161365, 1.029566430564499, 1.0003806462527491, 1.0344827586206897, 1.0011469526028831, 1.192130341223486, 1.1511562323745066, 1.0212765957446808, 1.0966604438913088, 1.0127659574468084, 1.0771653543307087, 1.0, 1.0155954631379962, 1.1438142027690934, 1.0600093764650727, 1.4514925373134329, 1.0909090909090908, 2.6666666666666665, 1.0744974587151124, 1.1454545454545455, 1.1364514600269768, 1.5, 1.5, 1.25, 1.1662763466042154, 1.5714285714285714, 1.0966850828729282, 1.1023255813953488, 1.070446735395189, 1.008894536213469, 1.0266290415532282, 1.087719298245614, 1.0, 1.0111021019148008, 1.152943598188555, 1.1260945709281962, 1.0197127746305161, 1.0533346878650887, 1.0037204095742929, 1.1089030206677266, 1.0313187683749099, 1.0723684210526316, 1.120367486764248, 1.2117559523809525, 1.7272727272727273, 1.0484816452046897, 1.159914712153518, 1.2727272727272727, 1.08, 1.1927272727272726, 1.0, 1.0934579439252337, 1.0889442164053562, 1.181058495821727, 1.1946107784431137, 1.0183148690422825, 1.058724832214765, 1.003999801826499, 1.001268113058381, 1.5, 1.0376864314296108, 1.2, 1.0016426187284817, 1.0198237885462555, 1.0100866143180272, 1.3, 1.6666666666666667, 1.0, 1.5211267605633803, 1.0060888755754172, 1.0, 1.0978593272171253, 1.027906976744186, 1.0360576923076923, 1.0041643822832946, 1.1886792452830188, 1.0314465408805031, 1.0190154338349036, 1.0635998415662309, 1.06968387731531, 1.1025641025641026, 1.0, 1.2828162291169452, 1.0074441687344913, 1.1370716510903427, 1.0194608256107835, 1.0398959236773635, 1.0660660660660661, 1.2291666666666667, 1.0205761316872428, 1.0475675675675675, 1.4285714285714286, 1.0258124244849283, 1.0622710622710623, 1.0555555555555556, 1.0062228096260808, 1.0952380952380953, 1.75, 1.0430452627727251, 2.0, 1.0195804195804197, 1.063953488372093, 1.047579983593109, 1.0177760968229954, 1.248041775456919, 1.1978021978021978, 1.0188990651929815, 1.0070188913583475, 1.0308988764044944, 1.0070681808863926, 1.0646618768980076, 3.0, 1.1111111111111112, 1.0335510233003058, 1.3333333333333333, 1.0481137233460907, 1.0, 1.0, 1.0454545454545454, 1.2043530834340992, 1.0926640926640927, 1.1727272727272726, 1.0497835497835497, 1.0, 1.0752330226364848, 1.0057653218355405, 1.5, 1.2495533055390113, 1.0, 1.0143019813254384, 1.0348837209302326, 1.0132511151928627, 1.1751152073732718, 1.0018181818181817, 1.1716566866267466, 1.1296296296296295, 1.0102236469583714, 1.0052260667343347, 1.0532623169107855, 1.0, 1.1428571428571428, 1.8333333333333333, 1.5, 1.2307692307692308, 1.0017026033769372, 1.25, 1.059900166389351, 1.0792079207920793, 1.0084378563283922, 1.0075509865983068, 1.0307855626326965, 1.0916969725593917, 1.0292537313432837, 1.2444444444444445, 1.5, 1.0256410256410255, 1.113744075829384, 1.0028939445281857, 1.2857142857142858, 3.142857142857143, 1.1024498886414253, 1.0296511627906977, 1.0004863184671786, 1.1590909090909092, 1.342769701606733, 1.0511935576646534, 1.509433962264151, 1.0808477237048666, 1.0370762711864407, 1.2884615384615385, 1.061654135338346, 1.0789473684210527, 1.0180011193973406, 1.0101974553139033, 1.047567851055461, 1.2835820895522387, 1.1443298969072164, 1.0654761904761905, 1.0, 1.0779421367220854, 1.0233807882050994, 1.0050050727088264, 1.0105615832167496, 1.0681774717919297, 1.0164728682170543, 1.8333333333333333, 1.0574047274481428, 1.2, 1.094790777113578, 1.1111111111111112, 1.0314189813906836, 1.0072463768115942, 1.0340713671539123, 1.1422924901185771, 1.04093567251462, 3.0, 1.2307137707281903, 1.0114165825708474, 1.0733860584881367, 1.0, 1.3125, 1.0201535508637236, 1.2413793103448276, 1.079457130200153, 1.0436590436590436, 1.2352941176470589, 1.0966350301984469, 1.0709561315352794, 1.0537307304691874, 1.0146532074242918, 1.0890350877192982, 1.328358208955224, 1.0, 1.3636363636363635, 1.0279187817258884, 1.3448275862068966, 1.0402455661664394, 1.1, 1.0466907951827629, 1.1363636363636365, 1.1280911538220748, 1.0237873216390732, 1.1179310344827587, 1.0, 1.0857142857142856, 1.28, 1.0003112961593836, 1.3457330415754925, 1.0, 1.1479690522243713, 1.0001585772682422, 1.1999005469915465, 1.0, 2.0, 1.1700970873786407, 1.0090415913200723, 1.3555555555555556, 1.0, 1.0207302592519296, 1.0464426877470356, 1.0869565217391304, 1.1070433145009415, 1.0272727272727273, 1.0013123359580052, 1.1653225806451613, 1.0276696930393427, 1.116583433786809, 1.0, 1.054054054054054, 1.06548607590511, 1.0161287828413255, 1.0648097814363249, 1.0, 1.041945148651763, 1.0051351271075968, 1.029334730225249, 2.0, 1.1463317384370015, 1.059272162327574, 1.0801004833375731, 1.2016076187147788, 1.0315087417135373, 1.1773401762802633, 1.0344537815126051, 1.0166345226615237, 2.0, 1.0736988991679157, 1.2982456140350878, 1.25, 1.321917808219178, 1.1304347826086956, 1.0330435830868518, 1.050892857142857, 1.0678364585125293, 1.2105555555555556, 1.0715344119312364, 1.0017615176151762, 1.0177017233607268, 1.0679611650485437, 4.0, 1.0328940103228903, 1.025506072874494, 1.0102928219153002, 1.0023698618942551, 1.0785225718194253, 1.1943381790359602, 1.0717948717948718, 1.4285714285714286, 1.013047231471205, 1.029414058583, 1.0222080514583565, 1.1099381143065161, 1.011039356646765, 1.0210526315789474, 1.000252527705203, 1.0021621621621621, 1.0768175582990398, 2.0, 1.0, 1.0245398773006136, 1.0865384615384615, 1.0050590219224282, 1.0181598062953996, 1.0920770877944326, 1.111731843575419, 1.0554699537750385, 1.0934065934065933, 1.002426320007123, 1.4303797468354431, 1.0118096128378904, 1.0, 1.0650344299923489, 1.25, 1.0283687943262412, 1.0249069567706843, 1.208994708994709, 1.108695652173913, 1.0889830508474576, 1.0249572568389058, 1.0, 1.9361702127659575, 1.3333333333333333, 1.0, 1.0114942528735633, 1.0508474576271187, 1.336082474226804, 1.1318681318681318, 1.031400192246075, 1.0311004784688995, 1.0506663012572368, 1.0026621968053637, 1.0980392156862746, 1.0519452819762087, 1.0632183908045978, 1.0805626598465474, 1.1572327044025157, 1.084026845637584, 1.0809248554913296, 1.0421703682878831, 1.0183197440396325, 1.0103924305878704, 1.0116727843544562, 2.0, 1.040920716112532, 1.0286506469500925, 1.027027027027027, 1.0, 1.1333333333333333, 1.25, 1.0761904761904761, 1.6296296296296295, 1.5, 1.0221748295510689, 1.0247200995201706, 1.003026462143356, 1.0027926635972526, 1.0810810810810811, 1.0425273390036451, 2.0, 1.1578947368421053, 1.1362852664576804, 1.0255802549852893, 1.0056303312954595, 1.0266545164597334, 1.0037688442211055, 1.1290322580645162, 1.079953347141507, 1.1687388987566607, 1.0120156577976966, 1.0036239387036654, 1.393939393939394, 1.127946127946128, 1.0, 1.0113378684807257, 1.0178630155955204, 3.0, 1.1290519877675842, 1.0084119685313924, 1.2857142857142858, 1.179720368875101, 1.4, 1.1875, 1.0214093484419264, 1.7692307692307692, 1.0130766348815006, 1.041435284066638, 1.2258064516129032, 1.2608695652173914, 1.25, 1.0121006776379478, 1.0788282924505834, 1.0093685986263405, 1.0144147761493676, 1.0, 1.2064957636324136, 1.0061349693251533, 2.0, 1.07173005512374, 1.021740635003028, 1.1371807000946075, 1.0062343021169717, 1.1143196364479986, 1.3614457831325302, 2.0, 1.0521110688474706, 1.0562180579216354, 1.0771554137749648, 1.0240160106737826, 1.0270014811911774, 1.043754544132616, 1.0879120879120878, 1.009009009009009, 1.15, 1.0151656763913923, 1.0902208201892745, 1.0288909599254428, 1.1234243697478992, 1.0651040068724305, 4.0, 1.0018744756711409, 1.0136678561843322, 1.016147026011391, 1.0555555555555556, 1.0149400986610289, 1.3091787439613527, 1.0, 1.003006827266617, 1.0134426229508198, 1.0763807285546416, 1.1764705882352942, 1.6666666666666667, 1.0302127989074963, 1.5, 1.3896103896103895, 1.1538461538461537, 1.1432907682646012, 1.2857142857142858, 1.2408376963350785, 1.0870020964360587, 1.0, 1.335978835978836, 1.016622340425532, 2.0, 1.0, 1.0901639344262295, 1.013986013986014, 1.041319857312723, 1.0149094781682642, 1.056105610561056, 1.018018018018018, 1.089150378938971, 1.051948051948052, 1.5217391304347827, 1.3315217391304348, 1.2307692307692308, 1.0, 1.1975903614457832, 1.2106782106782106, 1.001034126163392, 1.170081221966299, 1.0378246438608392, 1.2622018061283082, 1.0383600628464709, 1.0030364372469636, 1.0481347773766547, 1.020706455542022, 1.375, 1.0, 1.0303030303030303, 1.0340579141489445, 1.1668383110195675, 1.0065359477124183, 1.2011834319526626, 1.0675830469644902, 1.0699971371314057, 1.004117153684623, 1.0384615384615385, 1.1578947368421053, 1.0407105847520355, 1.150053022269353, 1.0670467726389048, 1.000330539175503, 1.1776315789473684, 1.0766391021854695, 1.0069518941143685, 1.0698630136986302, 1.026659696811291, 1.0, 1.0582895365504061, 1.239864864864865, 1.0576923076923077, 1.2698961937716262, 1.0347890451517394, 1.0, 1.1173469387755102, 1.0778670664319208, 1.037037037037037, 1.0285679194301154, 1.1472457627118644, 1.0238095238095237, 1.049600794775803, 1.0142966836081757, 1.0882017190437818, 1.0106075216972035, 1.0196759259259258, 1.0140610910730388, 1.1451942740286298, 1.0714285714285714, 1.0, 1.25, 1.0186508417100641, 1.8333333333333333, 1.053284769998651, 1.0821980507242475, 1.0682321665928223, 1.0522466039707419, 1.000037933388969, 1.1384780278670954, 1.0856031128404668, 1.035919540229885, 1.033977504872379, 1.0254487780260977, 1.00753541212281, 1.0043056726484403, 1.25, 1.015625, 1.3438735177865613, 1.0450453713933818, 1.0456026058631922, 1.0277356446370531, 1.1929203539823008, 1.0292397660818713, 1.0604781234506693, 1.0120805369127517, 1.0156847975312542, 1.25, 1.0234038547525475, 1.0116249234385606, 1.0518242122719734, 1.0008428150021071, 1.15625, 1.145610278372591, 1.0945273631840795, 1.5625, 1.0483922317733205, 1.3846153846153846, 1.1851851851851851, 1.0351648351648353, 1.2569116655428185, 1.063003400751745, 1.0647058823529412, 1.1, 1.0926829268292684, 1.0165631089378286, 1.0131776705751228, 1.0098838708054851, 1.0299704161904122, 1.0447814756269491, 1.0833333333333333, 1.0746395250212044, 1.1860518999073215, 1.11069690611188, 1.0288659793814432, 1.2083333333333333, 1.1992786293958522, 1.0193339799547365, 1.184006878761823, 1.0074528484294527, 1.0, 1.3333333333333333, 1.0047219955993967, 1.02701561840439, 1.0200195886385897, 1.085766606966776, 1.031125299281724, 1.053864168618267, 1.0041399296211964, 1.091819259649585, 1.0342205323193916, 1.2864864864864864, 1.002808988764045, 1.0136073036642703, 1.0119047619047619, 1.75, 1.0294505821998, 1.0176689398636083, 1.0372560615020698, 1.2846715328467153, 1.0014503263234227, 1.0263482797256696, 1.028034682080925, 1.075268817204301, 1.2307692307692308, 1.1152291105121295, 1.00635593220339, 1.1125, 1.5357142857142858, 1.0711476142585763, 1.0128840436075321, 1.0816143497757849, 1.1714285714285715, 1.02198147590865, 1.0424509411293552, 1.0106203071095177, 1.0049761146496816, 1.6666666666666667, 1.1666666666666667, 1.3333333333333333, 1.0264569181265641, 1.4230769230769231, 1.3333333333333333, 1.3636363636363635, 1.275337837837838, 1.0165745856353592, 1.0774224662412821, 1.013902823563136, 1.131687242798354, 1.411764705882353, 1.0666666666666667, 1.064516129032258, 1.3243243243243243, 1.3725490196078431, 1.017133956386293, 1.0055145444844424, 1.0045211090694268, 1.0546875, 1.0024611967312016, 1.0012962314198488, 5.0, 1.0082082950563098, 1.1414285714285715, 1.0, 1.3333333333333333, 1.0964497041420118, 1.1528365488058523, 1.0593685614586683, 1.0590062111801242, 1.0, 1.1168831168831168, 1.2760736196319018, 2.0, 1.5, 1.0757874015748032, 1.0523412080916679, 1.1814289932093298, 1.25, 1.0008311671109493, 1.0635166537567777, 1.1029411764705883, 1.3333333333333333, 1.0597014925373134, 1.0025478820310452, 1.644736842105263, 1.0337860590414187, 1.0397459165154266, 1.1105882352941177, 1.0078740157480315, 1.0167906336088155, 1.201537147736977, 1.0909090909090908, 1.2321428571428572, 1.0503222137983321, 1.047578277886497, 1.054585951264918, 1.4521739130434783, 1.2142857142857142, 1.1044776119402986, 1.0469973890339426, 1.0417690417690417, 1.0199953167791658, 1.0032216891185335, 1.0676855895196506, 3.0, 1.25, 1.039747424393486, 1.1253298153034301, 1.2867146469558453, 1.0263189384253981, 1.0006690081953504, 1.08934266661144, 1.1164556962025316, 1.1041666666666667, 1.000550271205094, 1.0114852787080602, 1.0359457866823807, 1.10873786407767, 2.5, 1.0666666666666667, 1.0101984665615027, 1.0774193548387097, 1.0242869697211792, 1.0141530155028233, 1.1384943181818181, 1.6, 1.0151869158878504, 1.061193680514921, 1.0308430431802604, 1.053231939163498, 1.0073844943498784, 1.2170542635658914, 1.4245283018867925, 1.0620289855072464, 1.003459464183621, 1.0445831867745339, 1.1105990783410138, 1.1139564660691421, 1.03125, 1.0032467532467533, 1.0175813953488373, 1.0739762219286657, 1.0612133045593122, 1.029209621993127, 1.068714632174616, 1.2857142857142858, 1.0148619957537155, 2.5, 1.5, 1.4166666666666667, 1.0281329923273657, 1.1208530805687205, 1.0098035575030637, 1.0355747681350707, 1.056176554886787, 1.099581589958159, 1.0217391304347827, 1.346938775510204, 1.034521044992743, 1.6, 1.4166666666666667, 1.136910569105691, 1.0, 1.1310240963855422, 1.1130136986301369, 1.0227129337539431, 1.040780055509568, 1.25, 1.0875420875420876, 1.3817829457364341, 1.1054862842892768, 1.000206427699845, 1.0404040404040404, 1.0409982174688057, 1.0278205872345536, 1.0583679744889243, 1.082670906200318, 1.4791666666666667, 1.2472067039106145, 1.0, 1.0, 1.0007331640499266, 1.6666666666666667, 1.5714285714285714, 1.5, 1.0310945273631842, 1.119047619047619, 1.0355912743972446, 1.1131004366812227, 1.0, 1.2631905648665425, 1.022089552238806, 1.15695067264574, 1.0048076923076923, 1.25, 1.009483431886645, 1.0947893569844789, 1.0819327731092436, 1.0200818148010413, 1.0109501215590935, 1.2188967777170945, 1.038709677419355, 1.0, 1.0391260385984966, 1.0165039724006113, 1.011791606886657, 1.2695652173913043, 1.0056706232880004]
origin-bjaq_15.87 	max: 5.0000	99th: 2.6667	95th: 1.5371	median: 1.0561	mean: 1.1487

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 16.004407 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=naru', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[3.5762787e-07 1.7881393e-07 4.1723251e-07 2.9802322e-07 2.3841858e-07]
Distance score: 2.980232238769531e-07
SAUCE Drift detection: False
Detection latency: 0.0233s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 2.032253 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 7.0000	99th: 2.5050	95th: 1.6373	median: 1.0680	mean: 1.1649
ReportEsts: [1.1492537313432836, 1.0337505587840858, 1.0167925186940785, 1.0178282009724473, 1.0, 1.0, 1.1781675629491883, 1.0127422442206844, 1.4, 1.0231788079470199, 1.0549482301950397, 1.0020222227839508, 1.0056338028169014, 1.057915057915058, 1.0145486935866983, 1.3636363636363635, 1.0668789808917198, 2.5, 1.5555555555555556, 1.211847389558233, 1.089931373553211, 1.0764862772089823, 1.0339685169842585, 1.1455576559546314, 1.0217479710734303, 1.011762605119426, 4.0, 1.0499167144534556, 1.8, 1.1428571428571428, 1.0748596381784155, 1.0, 1.0055321817938363, 1.0101123768315066, 1.3592592592592592, 1.034767161527725, 1.0257416240932569, 1.0565610859728507, 1.1830985915492958, 1.033068783068783, 1.034308103975535, 1.0249807991492546, 1.1159062885326758, 1.0645980641175259, 1.0505415162454874, 1.1034097261039686, 1.2272727272727273, 1.228744939271255, 1.2682926829268293, 1.0971302428256071, 1.2745098039215685, 1.097902097902098, 1.0848214285714286, 1.15625, 1.0297528154227906, 1.0047827331071415, 1.0257947573898494, 1.0777777777777777, 1.1686746987951808, 1.0016655794737988, 1.09375, 1.0263727242408436, 1.0906515580736544, 1.0492424242424243, 1.1142857142857143, 1.6363636363636365, 1.2136012007851287, 1.0733925092011258, 1.0, 1.0, 1.0584935236366637, 1.0, 1.0597014925373134, 1.1125703564727956, 1.087260034904014, 1.0518731988472623, 1.0122372136805773, 1.1957671957671958, 1.0638297872340425, 1.024160420701981, 1.0661498708010335, 1.3076923076923077, 1.0, 1.5384615384615385, 1.0262857142857142, 1.0508474576271187, 1.189964157706093, 1.1764705882352942, 1.2727272727272727, 1.036915333568429, 1.0857422831945125, 1.0357813716956064, 1.085717466325281, 1.274652075651243, 1.0401069518716577, 1.2868949232585596, 1.3316326530612246, 1.2028608582574774, 1.4285714285714286, 1.1822117276662731, 1.4242424242424243, 1.5, 1.0282354178351094, 1.1828097731239093, 1.0101083032490974, 1.0136786267731552, 1.263157894736842, 1.0079720389569589, 1.1088484848484848, 1.0417009112024298, 1.0922118380062305, 1.0195363375879136, 1.0, 1.5, 1.1363636363636365, 1.012063492063492, 1.0702054794520548, 1.1529411764705881, 1.0055880576921172, 1.0, 1.1680876979293544, 1.2278177458033572, 1.5, 1.3051643192488263, 1.2857142857142858, 1.0103950103950103, 1.0170397771653428, 1.1674025974025974, 1.0075187969924813, 1.6666666666666667, 1.2582688247712879, 1.0, 1.3, 1.0126901185033126, 1.1538461538461537, 1.01, 1.0649404221716736, 1.0586266390614216, 2.0, 1.5, 1.063265306122449, 1.0161725067385445, 1.0430622009569377, 1.029363895293639, 1.170854271356784, 1.0483695652173912, 1.0019660103164871, 3.0, 1.0145873320537429, 1.0638085742771686, 1.0552371026576342, 1.0458608058608059, 1.3333333333333333, 1.0727312201476336, 1.0387878787878788, 1.0049668874172186, 1.3564356435643565, 1.0, 1.1810344827586208, 1.0381492940054433, 1.0984894032767172, 1.144904458598726, 1.0819672131147542, 1.0350877192982457, 1.23121387283237, 1.098092643051771, 1.4285714285714286, 1.0053037264867501, 1.0, 1.0518072289156626, 1.0064916027976714, 1.0804490177736201, 1.03250700582022, 1.0226876090750436, 1.0599315068493151, 1.2086885911490053, 1.1115702479338843, 1.146788990825688, 1.075354609929078, 1.05697705091005, 1.0066946161366763, 1.0104770017035776, 1.0245398773006136, 1.1403508771929824, 1.0234301088667064, 1.042108712571171, 1.03971119133574, 1.2056033531877344, 1.205128205128205, 2.0, 1.1388888888888888, 1.0121145533661977, 1.1538461538461537, 1.0259605399792315, 1.0147375129451128, 1.008157585354735, 1.0041742135615097, 1.063894523326572, 1.0237798892083305, 1.0371651516370364, 1.0715825786977144, 1.0035064650449266, 1.1057060215619248, 1.0126160802705582, 1.2015665796344648, 1.1591348689994725, 1.048780487804878, 1.118421052631579, 1.0204081632653061, 2.0, 1.0815217391304348, 1.0036958817317845, 1.7018072289156627, 1.2947368421052632, 1.0020300446609824, 1.2, 1.003221871511075, 1.0247191011235954, 1.05376524326363, 1.0, 1.0988296488946685, 1.0311457174638488, 1.0257731958762886, 1.0684356403358604, 2.0, 1.1325196163905842, 1.0208018402891883, 1.0119573336128838, 1.0263157894736843, 1.2582322357019065, 1.0489349453080024, 1.0689923991424675, 1.0677966101694916, 1.0022334736920555, 1.0077319829324332, 1.1618705035971224, 1.252401746724891, 1.051948051948052, 1.4285714285714286, 1.089561855670103, 2.0, 1.0141688285771304, 1.1041317699609157, 1.047921359819783, 1.4171974522292994, 1.1538461538461537, 2.5, 1.0668972795497185, 1.1746031746031746, 1.0979891384118596, 2.5, 1.0130232558139536, 1.0400801603206413, 1.1428571428571428, 1.0000236976183894, 1.161592505854801, 1.122244488977956, 1.1265822784810127, 1.0120738636363635, 1.0380657056654374, 1.144927536231884, 2.0, 1.012849157228828, 1.1656007309273642, 1.1119186046511629, 1.028248385423189, 1.0441154668869264, 1.02744514480648, 1.1042084168336674, 1.0196365982783147, 1.0563241106719368, 1.1472425249169436, 1.4193971166448232, 1.75, 1.0460957758888254, 1.2935779816513762, 1.2452830188679245, 1.25, 1.0251457725947521, 1.0560224089635855, 1.00840401727637, 1.0353595983848085, 1.09478672985782, 1.1551724137931034, 1.0204112967934305, 1.0266187050359712, 1.107545688178184, 1.0193608914418222, 1.3076923076923077, 1.0717948717948718, 1.147112462006079, 1.0106304407359152, 1.0220939029473977, 1.0480846255078102, 1.114179500796601, 1.0105908584169454, 1.013184584178499, 1.0423008849557522, 1.0124786170883227, 1.0552253487953227, 1.065238558909445, 1.3043478260869565, 1.1538461538461537, 1.088363812914711, 1.25, 1.0180505415162455, 1.0113177316811264, 1.17195988299206, 1.0769230769230769, 1.3983050847457628, 1.124236252545825, 1.1061655697956356, 1.0093287040516234, 1.0952380952380953, 1.032470588235294, 1.020401812184088, 1.187335092348285, 1.625, 1.8461538461538463, 1.0663136081049966, 1.7142857142857142, 1.0195604981281199, 1.072085889570552, 1.0952380952380953, 1.0556451030865832, 1.0357142857142858, 1.7777777777777777, 1.0261253903087777, 2.0, 1.0106382978723405, 1.0429594272076372, 1.0899632663305117, 1.0241028387787896, 1.3311111111111111, 1.1495327102803738, 1.0125288456126527, 1.0063567766211132, 1.8571428571428572, 1.029266993903563, 1.0706907280647169, 3.0, 1.3333333333333333, 1.0121422793976043, 1.5, 1.0369525547445255, 1.0526315789473684, 3.0, 1.0384615384615385, 1.2627737226277371, 1.0923694779116466, 1.2338709677419355, 1.1234756097560976, 1.2467532467532467, 2.25, 1.0023105897472706, 1.0909090909090908, 1.05, 1.0527390356290627, 1.1503496503496504, 1.077662129703763, 1.0046641791044777, 1.8, 1.25, 1.1206064782908338, 1.1111111111111112, 1.0426395939086295, 1.0131388848175213, 1.0903306300686213, 1.0844327176781003, 1.0, 1.0058237588278698, 1.0129870129870129, 1.0606060606060606, 1.3333333333333333, 1.0324675324675325, 1.4285714285714286, 1.002169197396963, 1.032258064516129, 1.0156018627808656, 1.0387075694318388, 1.0632603406326033, 1.054864346396273, 1.0446466060181945, 1.187793427230047, 1.0161290322580645, 1.1081900718360849, 1.0512048192771084, 1.0, 1.0144631166579665, 1.008321142922279, 1.0633834929320565, 1.0436893203883495, 1.0212765957446808, 1.0108108108108107, 2.0, 1.6666666666666667, 1.2990654205607477, 1.077972709551657, 1.2254335260115607, 1.1764705882352942, 1.035678391959799, 1.2609713282621415, 1.0231040245720222, 1.1207159177456207, 1.0098820529167996, 1.394736842105263, 1.0236220472440944, 1.0954773869346734, 1.0, 1.0035837204427585, 1.2622950819672132, 1.0021883489284635, 1.0307202745704769, 1.0673397996501828, 1.0002674511901577, 1.7142857142857142, 1.0782459157351676, 1.1666666666666667, 1.0484442693974005, 1.1818181818181819, 1.0148620316515622, 1.0394088669950738, 1.0196588868940755, 1.1067961165048543, 1.1581431943351692, 4.0, 1.0024408103490359, 1.005768035532918, 1.078540162801413, 1.0, 1.3220338983050848, 1.0105949470252649, 1.3480392156862746, 1.096514287665153, 1.0333393404216975, 1.0357142857142858, 1.1374545454545455, 1.1371525410522625, 1.0676493937082638, 1.007024586051179, 1.055616542968284, 1.0625641025641026, 1.0384615384615385, 1.194429566148902, 1.0156713989342228, 1.3129770992366412, 1.1768134715025906, 1.0, 1.5, 1.1681701030927836, 1.0381679389312977, 1.188538487622923, 1.0376367225182173, 1.1512654502648616, 1.0, 1.1382113821138211, 1.3571428571428572, 1.0068544402492732, 1.125, 2.0, 1.068803663423011, 1.3333333333333333, 1.0, 1.1209923664122137, 2.0, 1.170124481327801, 1.0098039215686274, 1.3484848484848484, 1.0, 1.0148528461654776, 1.0292445166531274, 1.1785714285714286, 1.104101838755304, 1.0303030303030303, 1.0011074197120708, 1.123972602739726, 1.059375, 1.1176778491553652, 2.0, 1.1058823529411765, 1.0053041018387554, 1.0383296047725579, 1.1173312883435582, 1.0, 1.028538812785388, 1.0238715350707688, 1.0333479596314172, 2.0, 1.11316319677636, 1.073075527397193, 1.085411239300335, 1.1456692913385826, 1.0409658554989625, 1.0192912751911503, 1.0630824372759857, 1.0195645424372155, 1.75, 1.0933833678398897, 1.02122776821572, 1.0499044890162368, 1.020419426048565, 1.0233766233766233, 1.0407106569638456, 1.0614439324116745, 1.041551555297246, 1.1617190961453256, 1.064710458598472, 1.1036623215394166, 1.015974281655743, 1.259301270417423, 1.0963855421686748, 1.2592592592592593, 1.0074594231463936, 1.1394335511982572, 1.0322905331882481, 1.0100471678228327, 1.3333333333333333, 1.1987057480015226, 1.1514285714285715, 1.0869565217391304, 1.069767441860465, 1.0050562731567123, 1.0886524822695036, 1.1803563667970447, 1.0, 1.1481481481481481, 1.0423468180742843, 1.091675486973799, 1.0192711314634613, 1.05650867238986, 1.0200860832137733, 1.0444444444444445, 1.0904684975767367, 1.060316916754872, 1.1690140845070423, 1.0471014774041782, 1.188782489740082, 1.1255813953488372, 1.0016622653965859, 1.0021953896816684, 1.0590177297737926, 1.0, 1.1438217420661716, 1.5912162162162162, 1.9583333333333333, 1.0341880341880343, 1.0409914204003814, 1.161764705882353, 1.036734693877551, 1.0145287802559124, 1.0, 1.6545454545454545, 1.0, 1.3333333333333333, 1.029126213592233, 1.070737913486005, 1.3173241852487136, 1.048888888888889, 1.0210373114580578, 1.0024902170046246, 1.0203284039339757, 1.0222915554825731, 1.0091959771072956, 1.0457268233695483, 1.021561384919574, 1.071957671957672, 1.0168539325842696, 1.001100017935075, 1.0389294403892944, 1.0426008968609866, 1.096654275092937, 1.1699346405228759, 1.000605155928511, 1.2462871287128714, 1.0143498827364152, 1.0368663594470047, 1.2309958750736594, 1.038338658146965, 1.6666666666666667, 1.003579952267303, 1.125, 1.4285714285714286, 1.029940119760479, 1.019609309001742, 1.0277456647398844, 1.0807291666666667, 1.2125, 1.0342619471617105, 1.1409709123399185, 1.0276243093922652, 1.2, 3.0, 1.0315487043483065, 1.4386792452830188, 1.0445191096178077, 1.0075793462813831, 1.0, 1.1737505838393274, 1.0864485981308412, 1.051188687871465, 1.2193645990922843, 1.043980284027134, 1.0317309297279251, 1.019909116349729, 1.1645569620253164, 1.0, 1.131591107460081, 1.0, 1.0905707196029777, 1.1791666666666667, 1.1086439333862015, 1.073394495412844, 1.4516129032258065, 1.076900412492634, 1.1865671641791045, 1.1871144619602467, 1.0392258331608362, 1.0704041720990873, 1.07002457002457, 1.0338556780808668, 1.0207581227436824, 1.0205230056272758, 1.1666666666666667, 1.0206603516157955, 1.0674145703568603, 1.1904761904761905, 1.023082145281738, 1.0607627666451196, 1.1015625, 1.0799006323396567, 1.2, 1.2258771929824561, 1.2216913521261348, 1.2543859649122806, 1.1567164179104477, 1.0602189619254465, 1.287037037037037, 1.8888888888888888, 1.012982900569981, 1.0891950688905003, 1.055658600818384, 1.095703125, 1.0406327811799994, 1.0226071869824662, 1.0337738619676946, 1.0241884150222789, 1.1230283911671923, 1.0125666841986625, 1.0828092243186582, 1.0121396054628224, 1.169811320754717, 1.0669831007815378, 1.0, 1.1491754122938531, 1.0952380952380953, 1.1428571428571428, 1.0383631713554988, 1.0316875460574797, 1.0571961454771526, 1.1189189189189188, 1.3333333333333333, 1.0191846522781776, 1.1004550227511376, 1.2923076923076924, 1.0302878403851992, 2.3333333333333335, 1.0118699707754515, 1.5, 1.413978494623656, 1.0, 1.099825378346915, 1.303030303030303, 1.263157894736842, 1.1328731665228646, 1.0, 1.0865327158649536, 1.0822637106184365, 1.8, 1.5, 1.1538461538461537, 1.0344827586206897, 1.0773273273273274, 1.0221827861579413, 1.0448979591836736, 1.1083333333333334, 1.111731843575419, 1.0238461538461539, 1.528497409326425, 1.0827067669172932, 1.2857142857142858, 1.0, 1.3022751895991334, 1.2313167259786477, 1.0959548447789276, 1.0808439133681853, 1.0326236643446618, 1.2396264233016334, 1.006291674634065, 1.1970270952844824, 1.0417910447761194, 1.0401831129196337, 1.5, 1.0, 1.025, 1.0667654786768173, 1.1569282136894825, 1.0, 1.1270207852193996, 1.0996504607562758, 1.0333873880090627, 1.0063700942988678, 1.0416666666666667, 1.2608695652173914, 1.0672323759791122, 1.0826760796426012, 1.0466085841039072, 1.069495769582915, 1.2988505747126438, 1.0891590053680509, 1.0251138396135933, 1.0042523722162149, 1.0065264684554025, 1.0222397735359208, 1.0974842767295598, 1.0291488534784299, 1.1982758620689655, 1.0051078939374725, 1.5, 1.0792520035618878, 1.0, 1.1035940803382664, 1.0349162011173185, 1.2419354838709677, 1.002752403366708, 1.1978609625668448, 1.0980392156862746, 1.0450607987223677, 1.007114126193192, 1.0943970937543663, 1.0103585657370517, 1.1013513513513513, 1.0108782294743752, 1.1715265866209263, 1.2142857142857142, 2.0, 1.0, 1.0171496513643141, 1.8571428571428572, 1.0771523987944938, 1.0701250308648904, 1.0801252532694787, 1.0522102332057084, 1.0243692591066624, 1.0477718360071302, 1.0771704180064308, 1.0382830626450117, 1.0311196738836743, 1.0292656435424503, 1.0073723622327269, 1.0729663460243042, 1.3333333333333333, 1.0895104895104895, 1.3215434083601285, 1.0160822142731485, 1.1159029649595686, 1.011166253101737, 1.193313953488372, 1.0242718446601942, 1.0682178603925647, 1.0078563411896746, 1.0184600364618097, 1.263157894736842, 1.0069250574621933, 1.0002622833142947, 1.1481205805731298, 1.0024647887323943, 1.048780487804878, 1.0112994350282485, 1.0454824595071774, 1.0864147909967845, 1.453125, 1.0044971904860311, 1.1219512195121952, 1.1450882019744295, 1.2503160556257902, 1.1632911392405063, 1.1548974943052392, 1.1300448430493273, 1.1064814814814814, 1.0800925925925926, 1.0351421188630492, 1.0475266731328807, 1.1493771297692867, 1.0341392117266603, 1.0, 1.025170068027211, 1.210557299843014, 1.0463162008989642, 1.1574675324675325, 1.224630021141649, 1.1860696517412936, 1.4568880079286421, 1.00253807106599, 1.008768529468049, 1.1475409836065573, 1.0376692171865805, 1.0211524434719184, 1.009047912811022, 1.543581616481775, 1.003154047136967, 1.063130608829754, 1.0465116279069768, 1.0556660039761432, 1.0053395545989994, 1.0992507810124132, 1.01840490797546, 1.2602739726027397, 1.0128429655575015, 1.0206475497013827, 1.0404040404040404, 1.75, 1.023842039877706, 1.0003460926143837, 1.0355204736063148, 1.2586206896551724, 1.0170835875533861, 1.0136146319115695, 1.0144755576649265, 1.2113062568605928, 1.0285714285714285, 1.0975747320924987, 1.04, 1.094240837696335, 1.8275862068965518, 1.0223481359496096, 1.0065412919051513, 1.078883495145631, 1.2439024390243902, 1.4230769230769231, 1.0632075471698113, 1.01, 1.25, 1.0179233621755253, 1.1126126126126126, 1.0098591549295775, 1.4, 1.0494406463642014, 1.0236220472440944, 1.1781764229835447, 1.1441441441441442, 2.0, 1.1145564168819984, 1.1143112729828597, 1.0366190084617628, 1.1818181818181819, 1.4096385542168675, 1.0, 1.0789473684210527, 1.3333333333333333, 1.625, 1.1201923076923077, 1.0137453467006947, 1.0058049692028816, 1.0258064516129033, 1.0051314762818724, 1.0002793540666863, 7.0, 1.0097663647323791, 1.050841036520685, 1.0, 1.4285714285714286, 1.1214303451701018, 1.1159558604235014, 1.073931275711986, 1.0861618798955615, 1.0, 1.0199335548172757, 1.3769633507853403, 1.1159420289855073, 1.0072622999361043, 1.0430822153422772, 1.0153957860360285, 1.1742571846078909, 1.2, 1.0173280723746385, 1.089121887287025, 1.2132505175983437, 1.1787878787878787, 1.0374149659863945, 1.0, 1.0234375, 1.1152284009426867, 1.0348109735697557, 1.0769230769230769, 1.0257234726688103, 1.0192380536966679, 1.219632768361582, 1.096551724137931, 1.1081081081081081, 1.0382101950555682, 1.024705164701098, 1.0756174407968289, 1.5488721804511278, 1.2040816326530612, 1.1473684210526316, 1.1111111111111112, 1.0287221570926144, 1.0966921119592876, 1.0177993283840558, 1.0254777070063694, 1.5, 1.5616438356164384, 1.0226964351794745, 1.1708930540242557, 1.2997741206840916, 1.1082191780821917, 1.0107027179270525, 1.1094733879762197, 1.0177165354330708, 1.1090909090909091, 1.0155178155178155, 1.0148195710800052, 1.065679012345679, 1.25417439703154, 3.0, 1.1395348837209303, 1.0004295248794026, 1.1988555078683834, 1.009613619075099, 1.012193419276772, 1.1109144542772862, 1.8333333333333333, 1.013779527559055, 1.0121823360766011, 1.032312925170068, 1.1344262295081968, 1.0229353698260109, 1.2272727272727273, 1.4827586206896552, 1.0668912415784408, 1.0033034836736923, 1.0284905087831686, 1.1460564751703992, 1.103521878335112, 1.0256410256410255, 1.006960721642162, 1.0846070626092263, 1.0553371411616348, 1.0364132908511607, 1.0502415458937198, 1.026434558349452, 1.4166666666666667, 1.0189003436426116, 3.5, 1.5, 1.3125, 1.0543478260869565, 1.1450230718523402, 1.0056505897610077, 1.0318001323626738, 1.1225720026791695, 1.0121464515009544, 1.091743119266055, 1.2081418253447145, 1.0032165644279614, 1.5, 1.2, 1.0903679653679654, 1.0, 1.1965699208443272, 1.1290587751746815, 1.0553086811617203, 1.0184631818058898, 1.2, 1.1297828335056876, 1.2183406113537119, 1.0401269768856447, 1.0002293262395083, 1.0755148741418765, 1.0465875370919882, 1.0475300989998133, 1.0890832681782643, 1.1214953271028036, 1.4655172413793103, 1.2034682080924854, 1.3333333333333333, 3.0, 1.0005549802963372, 1.25, 1.625, 1.4651162790697674, 1.0528455284552845, 1.0127847171197648, 1.1095384615384616, 1.0318725099601593, 1.1428571428571428, 1.5364154528182394, 1.02997002997003, 1.006611570247934, 1.0376569037656904]
origin-bjaq_15.87 	max: 7.0000	99th: 2.5050	95th: 1.6373	median: 1.0680	mean: 1.1649

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 21.392460 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=39.462089