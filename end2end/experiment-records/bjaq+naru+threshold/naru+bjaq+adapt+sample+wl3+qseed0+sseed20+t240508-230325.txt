Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='naru', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 20, 'naru': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.5714	median: 1.0567	mean: 1.1485
ReportEsts: [1.1623616236162362, 1.066370452652041, 1.0211775829338376, 1.0461538461538462, 1.0344827586206897, 1.0, 1.1672965029092437, 1.0147700768679269, 1.25, 1.0359042553191489, 1.0333881626410413, 1.0020621504416727, 1.0320762895535327, 1.0232558139534884, 1.0166019074531967, 1.0, 1.5517241379310345, 1.0340063761955367, 3.0, 2.6666666666666665, 1.2857142857142858, 1.0855294371360793, 1.0351870078740157, 1.095881595881596, 1.0475452196382429, 1.0, 1.0601376845171113, 1.1666666666666667, 1.4, 1.2661870503597121, 1.0, 1.005382185936978, 1.0147815068156094, 1.3912319644839068, 1.010867968864738, 1.0283325434973936, 1.0053475935828877, 1.0091105553262267, 1.0965286865486603, 1.2023809523809523, 1.0025706940874035, 1.1585365853658536, 1.0, 1.1643315820198483, 1.056918093475243, 1.2231404958677685, 1.116504854368932, 1.3162790697674418, 1.0266739021539488, 1.0384615384615385, 1.0201753752017537, 1.2382978723404254, 1.0029546675482457, 2.0, 1.2727272727272727, 1.009957955299845, 1.216, 1.064638783269962, 1.1987577639751552, 1.6666666666666667, 1.0349191203198838, 1.037359900373599, 1.0681818181818181, 1.0689655172413792, 1.0, 1.016302654805995, 1.145265524023602, 1.1666666666666667, 1.0, 1.0477632350068373, 1.0083532219570406, 1.059675550405562, 1.1126126126126126, 1.0487171450320154, 1.183529411764706, 1.062992125984252, 1.0, 1.047681539807524, 2.0, 1.0102298487761485, 1.3125, 1.0888111172974877, 1.165644171779141, 1.0447247706422018, 1.0576024909185262, 1.04, 1.0070884825708848, 1.0360442168222488, 1.196078431372549, 2.3333333333333335, 1.0941004388103364, 1.0226220656310474, 1.0288461538461537, 1.3225806451612903, 1.234498308906426, 1.1063218390804597, 1.25, 1.0112165660051768, 1.0, 1.0, 1.0969042476601871, 1.0255057167985928, 1.0000352883054555, 1.0294117647058822, 1.0087135956181612, 1.0931514799767847, 1.0996593194598367, 1.1202123625331817, 1.0222500783453463, 1.1666666666666667, 1.0, 1.1453037195611453, 1.0239878987336597, 1.0812841530054644, 1.0649350649350648, 1.0055341460373257, 1.0, 1.1975075528700907, 1.1492822966507177, 1.0, 1.2307692307692308, 1.1666666666666667, 1.0451127819548873, 1.0255458831935538, 1.0900054360487692, 1.0467289719626167, 1.8, 1.1862582781456954, 1.0, 1.1428571428571428, 1.0034760916461338, 1.1818181818181819, 1.0027746042108698, 1.005608345318319, 1.1051674889639054, 1.1229385307346327, 1.0549132947976878, 1.0174464710547184, 1.00199203187251, 1.0505761843790014, 1.035792127521145, 1.1111111111111112, 1.0587084148727985, 1.047725302187994, 2.0, 1.0082720588235294, 1.0479041916167664, 1.0564516129032258, 1.0407623080995236, 1.0, 1.0749804738349389, 1.0325925925925925, 1.026, 1.4476190476190476, 1.4321167883211678, 1.0960827790096084, 1.0455275546939906, 1.0425196140319235, 1.1349809885931559, 1.118421052631579, 1.0208333333333333, 1.1304347826086956, 1.139261744966443, 1.2857142857142858, 1.0063310975991977, 1.0023865984490923, 1.005790387955993, 1.0514264264264264, 1.049480757483201, 1.1200604277649677, 1.0105263157894737, 1.0924369747899159, 1.2102256221555148, 1.0928176795580111, 1.1730769230769231, 1.0467955239064088, 1.0261031696706029, 1.068598633823225, 1.04635663507109, 1.0, 1.1150442477876106, 1.0033984706881902, 1.0474002923366048, 1.10062893081761, 1.2063492063492063, 1.0241905386607557, 1.014799154334038, 1.0336010380080982, 1.0740740740740742, 1.1690909090909092, 1.0138583702463582, 1.0, 1.5454545454545454, 1.0051512939076823, 1.2565266742338252, 1.1004566210045663, 1.4583333333333333, 1.0167202572347267, 1.0043469994913086, 1.0078156412214085, 1.1798245614035088, 1.0868556972699484, 1.1721854304635762, 1.015625, 1.0357142857142858, 1.0, 1.0666666666666667, 1.0011827787415235, 1.6585365853658536, 1.1149425287356323, 1.013346515076619, 1.0957683741648108, 1.089075473458345, 1.0338161479994263, 1.0796908488666623, 1.1733333333333333, 1.0297619047619047, 1.0525238744884038, 1.0248721925440865, 1.0198961937716262, 1.0, 1.0873706004140786, 1.0536899533216473, 1.009194733306296, 1.0889018012783265, 1.030451127819549, 1.0035104043309084, 1.0344827586206897, 1.0016010998130653, 1.0971848917810156, 1.1816130851663846, 1.1162790697674418, 1.0016621649698734, 1.0100580270793036, 1.1181102362204725, 1.0, 1.0219753682685342, 1.1162907548012506, 1.0185185185185186, 1.3619402985074627, 1.0909090909090908, 2.6666666666666665, 1.098450607622096, 1.1272727272727272, 1.1125227507940474, 1.5, 1.0, 1.25, 1.0019554165037152, 1.510204081632653, 1.0994475138121547, 1.1126760563380282, 1.064957264957265, 1.0236355822948002, 1.0012986006124742, 1.0526315789473684, 1.0, 1.0551632115077945, 1.038218745711541, 1.1260945709281962, 1.0468073001006608, 1.0439122263422562, 1.006354498489775, 1.102543720190779, 1.0475327007376372, 1.0681818181818181, 1.090151515151515, 1.1763941057497833, 1.5454545454545454, 1.0658153949644436, 1.1428571428571428, 1.25, 1.0416666666666667, 1.1116363636363635, 1.0555555555555556, 1.0636363636363637, 1.0014669268555279, 1.2089136490250696, 1.2201834862385321, 1.01233498349835, 1.0243288590604027, 1.0029183394946404, 1.013928019992678, 1.5, 1.081957075300109, 1.0, 1.0005741509359536, 1.0172786177105833, 1.0033225615584178, 1.275, 1.1111111111111112, 1.0869565217391304, 1.4366197183098592, 1.003940778517267, 1.0, 1.0749235474006116, 1.0424528301886793, 1.0380608974358974, 1.0035030046570728, 1.0988372093023255, 1.0127388535031847, 1.0050186331036421, 1.0629491314434447, 1.088258334058665, 1.1623931623931625, 1.0, 1.2816229116945108, 1.0246305418719213, 1.1806853582554517, 1.0158757328084214, 1.028301886792453, 1.0140845070422535, 1.0847457627118644, 1.0164609053497942, 1.078764263846368, 1.4285714285714286, 1.0235237938673742, 1.0567765567765568, 1.1578947368421053, 1.0048394192696877, 1.1428571428571428, 1.75, 1.0162578927022035, 2.0, 1.008298755186722, 1.059593023255814, 1.0246103363412633, 1.028393621159082, 1.1357702349869452, 1.164835164835165, 1.0275977759439385, 1.0449842993111171, 1.0013642564802183, 1.0128395717928063, 1.1621927554980596, 2.0, 1.1111111111111112, 1.033563229250319, 1.0, 1.0504109589041095, 1.0, 1.0, 1.0454545454545454, 1.1731448763250882, 1.0832535885167465, 1.162162162162162, 1.04004329004329, 1.0, 1.0366178428761652, 1.0085186325839237, 1.5, 1.3037522334723048, 1.0, 1.0108099901313292, 1.0348837209302326, 1.085961689845185, 1.172811059907834, 1.0018181818181817, 1.184661957618567, 1.0185185185185186, 1.0120048919934874, 1.0006390776830878, 1.0346205059920106, 1.0, 1.1428571428571428, 1.8333333333333333, 1.5, 1.0666666666666667, 1.0026818099966557, 1.25, 1.1447587354409319, 1.01, 1.0340554922082859, 1.0085101188452048, 1.0264270613107822, 1.070797714069806, 1.030484160191273, 1.2612612612612613, 1.5, 1.0457516339869282, 1.0633484162895928, 1.0082386385884674, 1.2857142857142858, 3.142857142857143, 1.0757238307349666, 1.0197674418604652, 1.0049497847919655, 1.152542372881356, 1.342769701606733, 1.0354107648725213, 1.3333333333333333, 1.0808477237048666, 1.0180084745762712, 1.3653846153846154, 1.055306427503737, 1.0884955752212389, 1.0322417363294731, 1.0120800114680164, 1.0376992545002728, 1.303030303030303, 1.0776699029126213, 1.056047197640118, 1.0, 1.0286051534481893, 1.0257014492605134, 1.019186580882353, 1.0103856497934876, 1.0065447545717037, 1.0118971061093247, 1.8333333333333333, 1.0072886297376094, 1.2, 1.1135781383432963, 1.1111111111111112, 1.008774285479407, 1.0159420289855072, 1.0779234737747205, 1.1264822134387351, 1.154772937905468, 3.0, 1.0745986779981114, 1.0049494841747557, 1.06906382196064, 1.0, 1.4, 1.0316831683168317, 1.3132183908045978, 1.0831211864064332, 1.0857787810383748, 1.2352941176470589, 1.2182916307161347, 1.0875499567625682, 1.035011757679818, 1.0046819857956295, 1.1111842105263159, 1.1907131011608623, 1.0227272727272727, 1.3636363636363635, 1.0710659898477157, 1.3448275862068966, 1.0409276944065484, 1.1379310344827587, 1.0376108535991704, 1.1363636363636365, 1.0650156628642355, 1.0208630497173006, 1.128044537230341, 1.0, 1.0857142857142856, 1.36, 1.000038912019923, 1.2472647702407003, 1.0, 1.1511467256148107, 1.0052859089414086, 1.2862473347547974, 1.0, 2.0, 1.1770873786407767, 1.0008960573476702, 1.3863636363636365, 1.0, 1.0233689557358665, 1.0172910662824208, 1.0869565217391304, 1.1549905838041432, 1.0272727272727273, 1.0393700787401574, 1.179032258064516, 1.0757257046697517, 1.0990758280236497, 1.0, 1.0675675675675675, 1.0735939123848444, 1.0038775573321788, 1.0191518354874676, 1.0, 1.012995742773919, 1.0198363932856287, 1.0288108957569408, 1.0, 1.1208133971291867, 1.0620498093310107, 1.0994691525862628, 1.1412345463282514, 1.0306858720398688, 1.1555519053876477, 1.0067226890756302, 1.0126953125, 2.0, 1.0648095508811826, 1.2982456140350878, 1.0, 1.2866666666666666, 1.1304347826086956, 1.0332126201928253, 1.0297462817147855, 1.0470114876617542, 1.0188159706287288, 1.0363884228187918, 1.0167726227512512, 1.0270929412716576, 1.0679611650485437, 4.0, 1.0308294322410274, 1.014574898785425, 1.007376431929168, 1.0189908019297724, 1.0752864157119477, 1.2320441988950277, 1.066326530612245, 1.4285714285714286, 1.010144731502773, 1.001160079867037, 1.0246016783113379, 1.1152158010241404, 1.012173997901876, 1.0682819383259912, 1.010023243725665, 1.0544768069039914, 1.0827586206896551, 2.0, 1.0, 1.034920634920635, 1.0761904761904761, 1.0240549828178693, 1.00238379022646, 1.058091286307054, 1.206060606060606, 1.0554699537750385, 1.054945054945055, 1.009171044430594, 1.3780487804878048, 1.0549373791848735, 1.0, 1.0288248337028825, 1.373015873015873, 1.070921985815603, 1.0312849162011173, 1.0998796630565584, 1.1106719367588933, 1.073816155988858, 1.065681990881459, 1.0, 1.7234042553191489, 1.3333333333333333, 1.0, 1.035294117647059, 1.0735930735930737, 1.2934131736526946, 1.1016042780748663, 1.0269144504966357, 1.1327201051248357, 1.0522935151245247, 1.0150857818970618, 1.1070840197693574, 1.0126809310983353, 1.069364161849711, 1.073697585768742, 1.1373971940009675, 1.1478112563956793, 1.180635838150289, 1.0546230440967284, 1.0279210293274992, 1.0617420784978484, 1.0122747176224816, 2.0, 1.0442260442260443, 1.055452865064695, 1.034013605442177, 1.0, 1.02, 1.1538461538461537, 1.118811881188119, 1.7037037037037037, 1.5, 1.027398790828171, 1.032859427759019, 1.0056713831190667, 1.0253056802352578, 1.054054054054054, 1.046172539489672, 2.0, 1.1846153846153846, 1.1666398455101383, 1.0124652063415225, 1.0072448567970955, 1.0220412347647796, 1.009476130877883, 1.1063218390804597, 1.0380385410827841, 1.147424511545293, 1.029335733739556, 1.011878988685781, 1.393939393939394, 1.1304836895388077, 1.0, 1.0090702947845804, 1.0215231212868707, 3.0, 1.0438328236493375, 1.0305331611064095, 1.2857142857142858, 1.2000691682517723, 1.1, 1.1875, 1.021402266288952, 1.6923076923076923, 1.0017069804605216, 1.0213583938487825, 1.2258064516129032, 1.3181818181818181, 1.2155388471177946, 1.0272596843615496, 1.0845104141728514, 1.0449180018256792, 1.0122200408670219, 1.0, 1.143167499456876, 1.0030487804878048, 2.0, 1.0935258435777384, 1.0045246128557834, 1.1239356669820246, 1.0025631449756933, 1.05449802412377, 1.3780487804878048, 1.5714285714285714, 1.0631418790414606, 1.0708117443868739, 1.0293723380788353, 1.0663775850567045, 1.0291627523644307, 1.0830315649707285, 1.10989010989011, 1.0591016548463357, 1.1455938697318007, 1.0431437345617198, 1.0668769716088329, 1.078804347826087, 1.2788865546218486, 1.0397180900954601, 4.0, 1.0036440855704698, 1.0364932669819389, 1.006295757896128, 1.0, 1.0556329253096826, 1.266355140186916, 1.0, 1.0405137614678899, 1.0134426229508198, 1.0930787589498807, 1.1764705882352942, 1.6666666666666667, 1.0394542458592573, 1.5, 1.3501577287066246, 1.1538461538461537, 1.1127974321401157, 1.2857142857142858, 1.2473684210526317, 1.131027253668763, 1.0, 1.3306878306878307, 1.0501373626373627, 2.0, 1.0, 1.0991735537190082, 1.0469314079422383, 1.081450653983353, 1.0258342303552206, 1.0372771474878444, 1.0206489675516224, 1.089150378938971, 1.051948051948052, 1.5506329113924051, 1.1556603773584906, 1.2692307692307692, 1.0, 1.0507399577167018, 1.2481962481962483, 1.0397422126745435, 1.3698552370139085, 1.0355416152972177, 1.2150143208883977, 1.0191652091423828, 1.0001446131597975, 1.0505415162454874, 1.0125298329355608, 1.5714285714285714, 1.0, 1.0303030303030303, 1.025862605879422, 1.1107843137254902, 1.0065359477124183, 1.2011834319526626, 1.1165330278732342, 1.0581523739418477, 1.0044904840150353, 1.0769230769230769, 1.1578947368421053, 1.0481125092524057, 1.1678154825026512, 1.0592766785598442, 1.0171030544945083, 1.3026315789473684, 1.1332693443591257, 1.0070214282464627, 1.1221264367816093, 1.048025613660619, 1.3333333333333333, 1.054259876249405, 1.1592689295039165, 1.0576923076923077, 1.132716049382716, 1.0347890451517394, 1.0, 1.1376623376623376, 1.0149866220186798, 1.1851851851851851, 1.0097097523530878, 1.132415254237288, 1.069767441860465, 1.091314408946074, 1.0029647841492515, 1.1131815739994628, 1.003831417624521, 1.0244186046511627, 1.009467989179441, 1.1666666666666667, 1.0, 1.0, 1.1111111111111112, 1.0273464938839771, 1.8333333333333333, 1.0174018615944962, 1.07180550320392, 1.0832964111652637, 1.0786203941730934, 1.0007212268448225, 1.0392282958199357, 1.0488721804511278, 1.001386962552011, 1.0282010942306337, 1.0352256186317321, 1.0034944754691657, 1.0413570375944565, 1.25, 1.032258064516129, 1.3754940711462451, 1.0108800392452302, 1.0977198697068404, 1.0252918287937742, 1.1964601769911505, 1.0545808966861598, 1.0351620099058565, 1.014765100671141, 1.0391148325358852, 1.3125, 1.0022944955639752, 1.0014774288599382, 1.1464075915047447, 1.0008428150021071, 1.40625, 1.044967880085653, 1.1691542288557213, 1.5625, 1.0704301657817747, 1.3461538461538463, 1.0735930735930737, 1.021978021978022, 1.1382333108563722, 1.0472579791923824, 1.0705882352941176, 1.2727272727272727, 1.0980392156862746, 1.0018566859075702, 1.0051769488950817, 1.0130942394176974, 1.0674529205790637, 1.0739719289616527, 1.1538461538461537, 1.0479735318444996, 1.113552316728301, 1.109759364257333, 1.0162932790224033, 1.2013888888888888, 1.0834084761045988, 1.01928444557219, 1.1600673967986521, 1.022459683173969, 1.0, 1.3333333333333333, 1.0064093313494926, 1.0149957155098543, 1.0244746989848115, 1.115164417253994, 1.0566640063846768, 1.0204081632653061, 1.002907807710126, 1.0849587642361567, 1.020637898686679, 1.3675675675675676, 1.0091872791519434, 1.0092892553870318, 1.0, 2.3333333333333335, 1.0333992200438058, 1.0086444062731297, 1.0017103762827821, 1.3037037037037038, 1.0278783490224475, 1.0244765955021762, 1.0102243680772507, 1.0230179028132993, 1.2307692307692308, 1.1711590296495957, 1.0, 1.103125, 1.6538461538461537, 1.0633478600961002, 1.0069375619425174, 1.0855085508550855, 1.1388888888888888, 1.0207041829671983, 1.048539778449144, 1.0101078394915655, 1.0307236909257935, 1.6666666666666667, 1.12, 2.0, 1.0268240343347639, 1.3846153846153846, 1.3333333333333333, 1.3636363636363635, 1.2397372742200328, 1.0018148820326678, 1.1186303585872204, 1.0166931122696803, 1.0679611650485437, 1.6911764705882353, 1.0, 1.064516129032258, 1.2837837837837838, 1.6666666666666667, 1.0311526479750779, 1.0140379433079163, 1.0031713181814799, 1.0546875, 1.0278429939126401, 1.0013462789650167, 5.0, 1.0030961859072505, 1.1214285714285714, 1.0, 1.3333333333333333, 1.0068047337278105, 1.1465968586387434, 1.0863672633296415, 1.049689440993789, 1.0, 1.062015503875969, 1.1595092024539877, 2.0, 1.5, 1.140994094488189, 1.050261188761824, 1.1880938242280286, 1.25, 1.008707492982942, 1.0728117738187453, 1.2264150943396226, 1.3333333333333333, 1.126984126984127, 1.0023058668513152, 1.9078947368421053, 1.0729888740024465, 1.0251511054557023, 1.0, 1.032258064516129, 1.0134159779614325, 1.1921434671221178, 1.1115702479338843, 1.1896551724137931, 1.0633864242974025, 1.2977777777777777, 1.031182473986902, 1.8555555555555556, 1.275, 1.1940298507462686, 1.0321750321750323, 1.032572298325723, 1.0094814904379017, 1.0118027498390887, 1.0480349344978166, 3.0, 1.25, 1.0546079687183982, 1.1728232189973615, 1.3096673798871814, 1.009083872565714, 1.001672520488376, 1.0790628974685101, 1.0816326530612246, 1.0416666666666667, 1.0209470304975923, 1.0089344941956881, 1.0583382439599294, 1.2329246935201401, 2.5, 1.1333333333333333, 1.0109688543233428, 1.076941457586619, 1.0148655922489946, 1.0118999803110849, 1.1029829545454546, 2.0, 1.0373831775700935, 1.0163300531259107, 1.04592186429061, 1.0038022813688212, 1.0192747818623944, 1.2123552123552124, 1.2924393723252496, 1.113623188405797, 1.003002904627749, 1.059064770650381, 1.0748847926267282, 1.1267605633802817, 1.03125, 1.0867224880382775, 1.0197156839897459, 1.083223249669749, 1.0346544262894073, 1.020442930153322, 1.0584467574059246, 1.3846153846153846, 1.0615711252653928, 2.5, 1.5, 1.3076923076923077, 1.020460358056266, 1.1311216429699842, 1.0052731256266478, 1.0396823279350427, 1.041248303934871, 1.0688284518828453, 1.0271739130434783, 1.2653061224489797, 1.0089673720716257, 1.6, 1.3333333333333333, 1.286829268292683, 1.0, 1.2392739273927393, 1.1335326357747881, 1.0009021199819577, 1.027146126503384, 1.25, 1.0871760350050488, 1.3449612403100775, 1.1860349127182044, 1.0001743471159317, 1.065948855989233, 1.0387762362148703, 1.033571500452853, 1.1142017864636413, 1.1335453100158983, 1.5106382978723405, 1.25, 1.0, 1.0, 1.0006571653374343, 1.6666666666666667, 1.5714285714285714, 1.4210526315789473, 1.057901085645356, 1.0561797752808988, 1.012914093206064, 1.111644134321849, 1.0, 1.1942892613283675, 1.0245362058647516, 1.1614349775784754, 1.0348258706467661, 1.25, 1.008133704735376, 1.0936807095343681, 1.0819327731092436, 1.078839717367051, 1.0070636871144676, 1.1131172069825437, 1.0017777777777779, 1.0, 1.0224058134002336, 1.0174071487457925, 1.0178443328550932, 1.2695652173913043, 1.0381660347236081]
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.5714	median: 1.0567	mean: 1.1485

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 20.145164 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=naru', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[5.9604645e-08 6.5565109e-07 1.7881393e-06 2.9802322e-07 4.1723251e-07]
Distance score: 6.437301749429025e-07
SAUCE Drift detection: False
Detection latency: 0.0232s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 2.038072 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 5.0000	99th: 3.0000	95th: 1.8017	median: 1.0656	mean: 1.1734
ReportEsts: [1.2190476190476192, 1.0416760531651272, 1.0543006550898129, 1.0098522167487685, 1.0, 1.0, 1.1211379773555938, 1.0181851314720465, 1.2, 1.024390243902439, 1.1016574054028048, 1.0021782478651005, 1.0342940532652316, 1.0489236790606653, 1.010825043885313, 1.3333333333333333, 1.1103896103896105, 1.0454545454545454, 1.4, 1.1242937853107344, 1.0788581989937365, 1.1271277920783858, 1.0498930862437634, 1.1078066914498141, 1.0601997461788888, 1.0077249630698748, 2.0, 1.0415425445485567, 1.6666666666666667, 1.5, 1.0648095508811826, 1.0, 1.0022380905386925, 1.0044930400170187, 1.3334866605335787, 1.0710346638655461, 1.0249688949213889, 1.02, 2.0, 1.068807665852328, 1.0174173611761401, 1.0130651124433614, 1.0528789659224442, 1.1133603238866396, 1.0390763765541742, 1.2018125047597288, 1.25, 1.074264705882353, 1.315, 1.1927710843373494, 1.0, 1.0141843971631206, 1.0986547085201794, 1.0909090909090908, 1.0782216080342144, 1.0300853718601215, 1.0061945656764748, 1.1732101616628174, 1.1686746987951808, 1.002475613039966, 1.1666666666666667, 1.035097769303773, 1.0630252100840336, 1.0919117647058822, 1.054054054054054, 1.1, 1.2577164511556598, 1.0486602357984995, 1.2857142857142858, 1.0, 1.111360110325806, 1.0301507537688441, 1.0705314009661835, 1.0834879406307978, 1.1386540962288687, 1.0172257479601088, 1.0371209668716952, 1.1216931216931216, 1.070921985815603, 1.0061090311387089, 1.1888313183649972, 1.3201754385964912, 1.0, 2.5, 1.0163360560093349, 1.0508474576271187, 1.0923497267759563, 1.087719298245614, 1.625, 1.0017616912235747, 1.0860127305369676, 1.0488077496274217, 1.033766784077968, 1.1276976523844615, 1.0182767624020888, 1.297823596792669, 1.1830985915492958, 1.202319587628866, 4.0, 1.1066666666666667, 1.3793103448275863, 2.0, 1.0450090000178218, 1.182089552238806, 1.007818052594172, 1.0070578507515577, 1.1025641025641026, 1.0229301097796029, 1.0668235294117647, 1.0023633374434855, 1.042526579111945, 1.0324522376341272, 1.3333333333333333, 1.4, 1.1316134674245737, 1.003591846508426, 1.066251415628539, 1.1222222222222222, 1.009388834417803, 1.0, 1.1851506679092887, 1.1861958266452648, 1.0, 1.2798165137614679, 1.0, 1.078723404255319, 1.0132191425675834, 1.1487082954692978, 1.0555555555555556, 2.0, 1.225938566552901, 1.0, 1.375, 1.0167854463615904, 1.1538461538461537, 1.1683467741935485, 1.0264574907983823, 1.0307521304186735, 1.75, 1.2666666666666666, 1.010204081632653, 1.0871313672922251, 1.0482246952835188, 1.0225103938471138, 1.3005181347150259, 1.0598151169113648, 1.0159877531985644, 3.0, 1.0153964588144726, 1.0758974358974358, 1.0185463659147869, 1.01930729550479, 1.0, 1.031650806785271, 1.0406905055487052, 1.0016722408026757, 1.1101928374655647, 2.0, 1.1659877800407332, 1.0227439136005858, 1.1071549168949086, 1.2285251215559156, 1.1988950276243093, 1.1724137931034482, 1.1686046511627908, 1.107482993197279, 1.375, 1.030978796085431, 1.3478260869565217, 1.0360144057623049, 1.0022001236885456, 1.1418655097613883, 1.0774730215827337, 1.024432809773124, 1.0498220640569396, 1.1878381652265202, 1.0996649916247907, 1.1266339869281046, 1.0224066390041493, 1.0329756608217744, 1.0673657849428706, 1.0166996826208277, 1.0389610389610389, 1.1132075471698113, 1.0117090987216673, 1.0080446560499097, 1.0402930402930404, 1.0694595065001138, 1.2022160664819945, 2.5, 1.1069651741293531, 1.0085201083198894, 1.032258064516129, 1.0327102803738317, 1.065032987747408, 1.022378063461597, 1.0150718350446823, 1.0427083333333333, 1.100788481316421, 1.09302570216347, 1.0894736842105264, 1.0138046046231528, 1.1196695095948828, 1.0104952063546626, 1.206266318537859, 1.0538990825688073, 1.1694915254237288, 1.0493827160493827, 1.0, 1.0, 1.032967032967033, 1.0474655326154056, 1.7008797653958945, 1.0792079207920793, 1.0135079819893573, 1.05, 1.0014457698293024, 1.0852534562211982, 1.0339700143766688, 2.0, 1.1329715061058345, 1.0655549166187464, 1.0069416185939633, 1.0598568376717392, 2.0, 1.0407830342577489, 1.0665506884836946, 1.0201457104965523, 1.0217391304347827, 1.3294314381270902, 1.0173572228443448, 1.0798695738093669, 1.087719298245614, 1.0039006646266773, 1.0140962421356912, 1.1794871794871795, 1.1256366723259763, 1.0350058343057176, 5.0, 1.1835106382978724, 1.0, 1.0003923107100823, 1.0470890811316342, 1.0182102995887996, 1.588235294117647, 1.0769230769230769, 3.3333333333333335, 1.0748162894867817, 1.1538461538461537, 1.135714068070325, 1.75, 1.013557133634603, 1.0040080160320641, 1.0, 1.007753160813017, 1.0460829493087558, 1.1765316718587746, 1.1428571428571428, 1.010989010989011, 1.0448886639676114, 1.0144927536231885, 2.0, 1.039496446004967, 1.1669899589228663, 1.0957290132547866, 1.0049007596177408, 1.0624681393372981, 1.0354213009535413, 1.1049180327868853, 1.027275126844004, 1.0635235732009927, 1.1086844145774102, 1.2233762983356276, 2.090909090909091, 1.0851972101972103, 1.0471014492753623, 1.2641509433962264, 1.0, 1.0714985308521057, 1.091633466135458, 1.0190338006645088, 1.0989434718901827, 1.1226415094339623, 1.1970074812967582, 1.0141706480611306, 1.0160055671537926, 1.0366469293251348, 1.0120875863320016, 1.5454545454545454, 1.0446428571428572, 1.0701219512195121, 1.023818412603599, 1.0838023441937317, 1.000708544763568, 1.081578947368421, 1.0270880361173815, 1.0347729789590254, 1.0176153633600442, 1.01647515897887, 1.0330176501759583, 1.0849609375, 1.1111111111111112, 1.1538461538461537, 1.0783997418938538, 1.3, 1.0386740331491713, 1.0522034064934747, 1.034237195288962, 1.2727272727272727, 1.3781512605042017, 1.0661094224924013, 1.0363669259996382, 1.0126796608416917, 1.0869565217391304, 1.126034958601656, 1.0009207620370795, 1.0468384074941453, 2.75, 2.6666666666666665, 1.103562945368171, 1.7142857142857142, 1.013872739018088, 1.0312965722801788, 1.125, 1.0114547801235365, 1.0384615384615385, 1.6666666666666667, 1.0332414003885926, 3.0, 1.0456621004566211, 1.071599045346062, 1.0445675740785354, 1.1445683601817431, 1.1788079470198676, 1.0869565217391304, 1.0156900704589964, 1.008172808201437, 1.032064128256513, 1.017594900672828, 1.095846036585366, 3.0, 1.0909090909090908, 1.020412323102906, 1.0, 1.054619936276741, 1.1111111111111112, 3.0, 1.0769230769230769, 1.166832174776564, 1.0709728867623605, 1.296, 1.1481481481481481, 1.3333333333333333, 2.25, 1.0172882885346313, 1.2142857142857142, 1.0952380952380953, 1.028453773916537, 1.1223776223776223, 1.0851581508515815, 1.000928505106778, 1.8, 1.25, 1.1055139550714772, 1.225609756097561, 1.086739780658026, 1.0153061224489797, 1.0744786494538232, 1.0801033591731266, 1.0, 1.0135005959616223, 1.1549295774647887, 1.4, 1.5, 1.105680317040951, 1.25, 1.0043956043956044, 1.0756302521008403, 1.0379641401078428, 1.0224170619556454, 1.0824829931972788, 1.060616007440232, 1.0339812613620474, 1.1920590951061865, 1.0240320427236316, 1.0375469582833428, 1.0431547619047619, 1.0555555555555556, 1.013181603108526, 1.0083768638997055, 1.0495867768595042, 1.2040816326530612, 1.0208333333333333, 1.0142348754448398, 2.0, 1.9259259259259258, 1.3363636363636364, 1.011342155009452, 1.6923076923076923, 1.0398009950248757, 1.0416258570029382, 1.0142857142857142, 1.0679875369497482, 1.0873712323540634, 1.150261518647988, 1.3544303797468353, 1.0145985401459854, 1.0773067331670823, 1.0, 1.0025449892254195, 1.4482758620689655, 1.0038753095521655, 1.0270055599682288, 1.0036667995217219, 1.0134408602150538, 2.0, 1.1118288251917643, 1.1666666666666667, 1.0651586765698853, 1.25, 1.0030361095799318, 1.0209617755856966, 1.057183959719475, 1.1661237785016287, 1.1151560178306092, 3.0, 1.0345872254481192, 1.0035092434588362, 1.001896878772202, 1.0, 1.3103448275862069, 1.0638467677573822, 1.4444444444444444, 1.084210170179653, 1.0250442313440673, 1.1666666666666667, 1.01231884057971, 1.0889175509565965, 1.086727927984149, 1.0844611262732557, 1.0509028846957165, 1.0612121212121213, 2.0, 1.1858596679164435, 1.0064626496863713, 1.3902439024390243, 1.0650172612197928, 1.0, 1.3333333333333333, 1.2036316472114137, 1.0891472868217054, 1.194264254011608, 1.0536180093786283, 1.159037558685446, 1.0, 1.0846153846153845, 1.3103448275862069, 1.0204261195941506, 1.0434782608695652, 1.0, 1.0916001290426647, 1.3333333333333333, 1.0, 1.1389417586600685, 2.3333333333333335, 1.1644993498049414, 1.0090157776108188, 1.494208494208494, 1.0909090909090908, 1.0320915959101105, 1.0495049504950495, 1.1111111111111112, 1.0023596035865974, 1.0625, 1.0453038674033148, 1.135752688172043, 1.0207235686687741, 1.1234929631586532, 1.0, 1.0, 1.0899165061014773, 1.0163633583116685, 1.0969196093163036, 1.1666666666666667, 1.0526623756582798, 1.0014703707963002, 1.0328947368421053, 2.0, 1.1138265818547037, 1.0560650393731712, 1.1272968784591544, 1.1836779186802806, 1.0387564236646678, 1.0144078852007536, 1.0352858151023288, 1.026924924868343, 2.0, 1.11067977915804, 1.2727272727272727, 1.0439903846153846, 1.0685900925421883, 1.053763440860215, 1.0237190235307492, 1.0077903682719547, 1.042543382008092, 1.189041095890411, 1.0229560049841848, 1.0147579693034239, 1.0060679003059023, 1.2504527618472683, 1.0833333333333333, 1.0851063829787233, 1.0183911397942171, 1.1487068965517242, 1.021584670039832, 1.0059302979201799, 1.0, 1.177870090634441, 1.4069767441860466, 2.25, 1.3170731707317074, 1.0081474473565017, 1.1954887218045114, 1.0162509448223733, 1.0, 1.0, 1.0333333333333334, 1.0476699634678786, 1.0353438340376488, 1.033721958884033, 1.0483930550424825, 1.0956521739130434, 1.0656266810112964, 1.0877543837194419, 1.2536231884057971, 1.0444672322177682, 1.0226262626262625, 1.1516587677725119, 1.0959349298280652, 1.040436716538617, 1.0076886544212973, 1.0, 1.1326530612244898, 1.494949494949495, 1.0338760625424523, 1.0080808080808081, 1.099290780141844, 1.0272873194221508, 1.0232558139534884, 1.046544107450623, 2.0, 1.7592592592592593, 1.8333333333333333, 1.3333333333333333, 1.1067961165048543, 1.0135135135135136, 1.3543859649122807, 1.1069767441860465, 1.0205570291777188, 1.0018337408312958, 1.0003432641560708, 1.0056406455862978, 1.0074778608651207, 1.0658970399248373, 1.032625301036031, 1.1084931506849316, 1.090293071319668, 1.002872290771569, 1.0604448742746615, 1.0461711711711712, 1.1829896907216495, 1.1524390243902438, 1.0296254439780432, 1.2380352644836272, 1.0138720028700696, 1.031390134529148, 1.1713721061547149, 1.0388978930307942, 2.5, 1.008284023668639, 1.0666666666666667, 2.0, 1.8768768768768769, 1.0090600910539151, 1.0285163776493256, 1.0769230769230769, 1.046242774566474, 1.0026555061982207, 1.1913875598086126, 1.023465703971119, 1.4, 2.0, 1.0348526900085397, 1.3846153846153846, 1.0253164556962024, 1.0077922077922077, 1.0, 1.0541749502982107, 1.0941176470588236, 1.0016772790806026, 1.1880597014925374, 1.0325613723464846, 1.0049932782792395, 1.0124882641524404, 1.0864197530864197, 1.6666666666666667, 1.087610443760548, 1.0, 1.0809815950920245, 1.1924686192468619, 1.1138147566718994, 1.0807804522246536, 1.2413793103448276, 1.0919778699861686, 1.2352941176470589, 1.1640625, 1.1383658097265432, 1.0802631578947368, 1.001169590643275, 1.0297913634158176, 1.0181488203266789, 1.0052168242582329, 1.4, 1.101290921363483, 1.1073549402589968, 1.1363636363636365, 1.0142663043478262, 1.0779823989569752, 1.13135593220339, 1.0683330921718999, 1.0, 1.2021505376344086, 1.0854255319148935, 1.6116279069767443, 1.1466666666666667, 1.0115231633130557, 1.1759259259259258, 1.5, 1.0872037914691943, 1.042995839112344, 1.1032228856002944, 1.048202842017275, 1.0532801461046764, 1.0177656600833982, 1.0948795180722892, 1.017981072555205, 1.0914826498422714, 1.0296078867805538, 1.0640083945435468, 1.0097597597597598, 1.0512259194395797, 1.0545466422785472, 1.1032863849765258, 1.0412213740458016, 1.0, 1.6, 1.068922305764411, 1.0065825562260011, 1.0164035902197461, 1.1272727272727272, 1.4444444444444444, 1.0454545454545454, 1.088306312521559, 1.5045045045045045, 1.017254847259032, 2.3333333333333335, 1.0229109818256705, 1.0, 1.3385826771653544, 1.0625, 1.1055608737272649, 1.2727272727272727, 1.2869955156950672, 1.106364428945074, 1.0, 1.0173527037933818, 1.0425068119891008, 1.8, 1.5, 1.0596026490066226, 1.0365853658536586, 1.0452410383189121, 1.0062444246208742, 1.079885877318117, 1.2541436464088398, 1.123249299719888, 1.058990357345434, 1.4619289340101522, 1.9078947368421053, 1.25, 2.0, 1.348623853211009, 1.218487394957983, 1.0498220640569396, 1.0934252786699414, 1.0007843251880433, 1.262870855148342, 1.0015200761273897, 1.0927797715075889, 1.028971028971029, 1.0085, 1.1818181818181819, 1.3333333333333333, 1.05, 1.0663934812937663, 1.126324368378158, 1.025, 1.1761904761904762, 1.0794646859191905, 1.0041307511474309, 1.0079361422156685, 1.10989010989011, 1.173913043478261, 1.062316715542522, 1.121347941567065, 1.0412036359280799, 1.038205448141073, 1.231638418079096, 1.0885887746252014, 1.062053452074748, 1.052260021751159, 1.0319391634980988, 1.0064922786006933, 1.1215277777777777, 1.0572457966373099, 1.2130518234165066, 1.011170034394447, 1.5714285714285714, 1.0043346337234504, 1.0, 1.0546558704453441, 1.0131267366576782, 1.0909090909090908, 1.0264413099539353, 1.109470026064292, 1.0208333333333333, 1.0358787510753504, 1.0087661163995663, 1.0896169665090512, 1.0202922077922079, 1.0141643059490084, 1.0049088688462984, 1.2355072463768115, 1.2, 1.0, 1.1, 1.025382454580361, 2.1666666666666665, 1.0359859811134444, 1.0766067415730336, 1.2246484085862324, 1.0570873100035347, 1.0090475442076603, 1.0905419956927496, 1.0506329113924051, 1.0023068050749713, 1.0283828434519802, 1.0104864032229397, 1.0062906152333602, 1.0202426041560038, 1.6666666666666667, 1.1919431279620853, 1.224025974025974, 1.0007069074961048, 1.005420054200542, 1.0521239102207383, 1.181422351233672, 1.0016366612111294, 1.0454418219988548, 1.001131221719457, 1.0199225842494861, 1.1904761904761905, 1.0267743389717556, 1.003910924723321, 1.1381993330863283, 1.0052687038988408, 1.236842105263158, 1.1735537190082646, 1.2932551319648093, 1.0954458593340437, 1.0234986945169713, 1.0040324563560363, 1.0857142857142856, 1.0283380322417408, 1.182453909726637, 1.1256410256410256, 1.1146828844483059, 1.1335740072202165, 1.1483870967741936, 1.086021505376344, 1.043348169935152, 1.051356589147287, 1.0973154362416107, 1.0622909911282308, 1.0625, 1.0618485059068798, 1.0275781380578306, 1.0335299983380422, 1.1265508684863523, 1.3272537780093798, 1.243048403707518, 1.2733333333333334, 1.0488997555012225, 1.0042647668773026, 1.0503597122302157, 1.0255962769051774, 1.0208450704225351, 1.0071912882679268, 1.5290423861852434, 1.0029386027923257, 1.0994826562632516, 1.061528059499662, 1.1283095723014256, 1.0006981691540655, 1.114903427141612, 1.0, 1.3674418604651162, 1.0347021399652978, 1.0323618973656783, 1.0396039603960396, 2.25, 1.0271585279547062, 1.0017114773055797, 1.0136585365853659, 1.2771084337349397, 1.0520706455542022, 1.0255494407531112, 1.007552513570923, 1.2860013395847287, 1.3448275862068966, 1.132245357343838, 1.0526315789473684, 1.0895140664961638, 1.6875, 1.0665228268248905, 1.0190871369294605, 1.0661157024793388, 1.3, 1.0025641025641026, 1.036259541984733, 1.0, 1.0952380952380953, 1.0261031696706029, 1.1050228310502284, 1.105803800719055, 1.4, 1.0701612986556723, 1.0734341252699784, 1.140763237818566, 1.1140350877192982, 1.1111111111111112, 1.0936132983377078, 1.0374308488489679, 1.008802486668989, 1.1078260869565217, 1.4444444444444444, 1.0, 1.1025641025641026, 1.3855421686746987, 1.4727272727272727, 1.121069182389937, 1.011275784072111, 1.0061734154382036, 1.0522875816993464, 1.002185680378396, 1.0004460433454085, 5.0, 1.0461005421706073, 1.0185422228723988, 1.0, 1.4285714285714286, 1.087490783976407, 1.1588270496708557, 1.0347411308754844, 1.068062827225131, 1.0, 1.0338983050847457, 1.280612244897959, 1.125, 1.024320531973155, 1.0179102013865962, 1.001585232107097, 1.1242666040835485, 1.1111111111111112, 1.0101654036500762, 1.055662188099808, 1.0974930362116992, 1.0880398671096345, 1.0638051044083527, 1.0, 1.0391304347826087, 1.0554096011464056, 1.049734714288136, 2.0, 1.0590163934426229, 1.026586345381526, 1.2166785459729152, 1.1029900332225913, 1.1818181818181819, 1.0564325291469467, 1.279179810725552, 1.0935491923777472, 1.6302521008403361, 1.2604166666666667, 1.0417193426042983, 1.1111111111111112, 1.0383489461358313, 1.0148148148148148, 1.0035853557147947, 1.0584007187780773, 2.0, 1.275177304964539, 1.0201050385688495, 1.1465930018416206, 1.3274863212101706, 1.0195156886441967, 1.0319730753050063, 1.1019099351673383, 1.0758483033932136, 1.1730769230769231, 1.0037303664921466, 1.0016465281410525, 1.1085347804637395, 1.0350609756097562, 3.5, 1.2409638554216869, 1.0043935283327659, 1.2254335260115607, 1.0216849253295843, 1.004033264579529, 1.1450562462995855, 2.0, 1.0348499515972895, 1.0345171588188349, 1.0286630209315482, 1.0364741641337385, 1.0263199682413657, 1.121301775147929, 1.082066869300912, 1.1172480620155039, 1.0040639672697362, 1.0043880309817257, 1.054613935969868, 1.0990516332982085, 1.0833333333333333, 1.0254503860451816, 1.0610243911514632, 1.0638867445277287, 1.0333119795003203, 1.0481049562682216, 1.042763157894737, 1.0506329113924051, 1.0889679715302492, 5.0, 1.5, 1.3571428571428572, 1.0684326710816776, 1.1172680412371134, 1.0060684872128305, 1.0385837578286556, 1.0510571300044984, 1.001735809755251, 1.0825688073394495, 1.1090712742980562, 1.0235417899651476, 1.6666666666666667, 1.3571428571428572, 1.1257174091281772, 1.0, 1.0705882352941176, 1.1085991118288252, 1.0684972616100232, 1.0239273871671406, 1.5, 1.1957196029776676, 1.0064516129032257, 1.0659555488071062, 1.0009597259236884, 1.0085378868729988, 1.0356824264049955, 1.0360336134453783, 1.1310190369540873, 1.151394422310757, 1.4285714285714286, 1.2337962962962963, 1.0, 2.0, 1.0000260587289296, 2.0, 1.8571428571428572, 1.2708333333333333, 1.1263902932254803, 1.0008020682076841, 1.0809667673716012, 1.01171875, 1.0, 1.0060671174872022, 1.023, 1.5, 1.0444444444444445]
origin-bjaq_15.87 	max: 5.0000	99th: 3.0000	95th: 1.8017	median: 1.0656	mean: 1.1734

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 16.388837 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=38.604902