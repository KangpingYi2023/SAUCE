Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='naru', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 39, 'naru': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.5723	median: 1.0563	mean: 1.1457
ReportEsts: [1.0862068965517242, 1.0584343991179714, 1.0322180824454383, 1.0115384615384615, 1.0714285714285714, 1.0, 1.2195274801027762, 1.0294093277604905, 1.25, 1.0345285524568393, 1.102126799988457, 1.0025703263837717, 1.0817810086324398, 1.0209302325581395, 1.049452490286118, 1.0, 1.6981132075471699, 1.0095642933049946, 3.0, 2.6666666666666665, 1.173913043478261, 1.0590899288332973, 1.0413366336633663, 1.0240529164161154, 1.0029688273132114, 1.0, 1.0326251652213159, 1.0, 1.4, 1.1798561151079137, 1.0, 1.0014163647202574, 1.0011318340632842, 1.232519422863485, 1.057864590982523, 1.0170604562995058, 1.0267379679144386, 1.003230175589032, 1.0757283559473794, 1.1428571428571428, 1.0833333333333333, 1.1768292682926829, 1.0, 1.1287847822669392, 1.0908530001542496, 1.1983471074380165, 1.1359223300970873, 1.252212389380531, 1.0251632883586967, 1.037037037037037, 1.0584423405844234, 1.3566433566433567, 1.0081972320495156, 2.0, 1.1688311688311688, 1.0243207712532867, 1.1578181818181819, 1.064638783269962, 1.3478260869565217, 1.6666666666666667, 1.001843632639126, 1.0230386052303861, 1.0227272727272727, 1.0919540229885059, 1.0, 1.117718320584265, 1.0416560184002044, 1.1666666666666667, 1.0, 1.011885671163098, 1.045346062052506, 1.059675550405562, 1.117117117117117, 1.1132712235003328, 1.171764705882353, 1.062992125984252, 1.0, 1.0449389179755673, 2.0, 1.0376194438864816, 1.3125, 1.0407511594313084, 1.196319018404908, 1.0470183486238531, 1.0565059616381545, 1.04, 1.009051817590518, 1.0675965665236051, 1.2352941176470589, 2.3333333333333335, 1.0762589928057553, 1.0184635111845703, 1.0388349514563107, 1.3548387096774193, 1.2457337883959045, 1.0814606741573034, 1.238532110091743, 1.0034246575342465, 1.0, 1.007280244472407, 1.2004319654427646, 1.0174520069808028, 1.0134463398061724, 1.0, 1.0031016646230564, 1.129874025194961, 1.0504009657670088, 1.0451270383010998, 1.0283732660781841, 1.1666666666666667, 1.3333333333333333, 1.1477607937784928, 1.0282090330229658, 1.0761386811692726, 1.1159420289855073, 1.0067870481981367, 1.0, 1.1208907741251326, 1.199043062200957, 1.0, 1.2362637362637363, 1.1666666666666667, 1.050125313283208, 1.0106647518455503, 1.0702803448008076, 1.0566037735849056, 1.8, 1.2086092715231789, 1.0, 1.1071428571428572, 1.0169817300712598, 1.1818181818181819, 1.0109049479166667, 1.0043899589893674, 1.0995521873923528, 1.1540832049306626, 1.0273972602739727, 1.0499181669394435, 1.00199203187251, 1.0539499036608864, 1.0902081977878986, 1.1790123456790123, 1.0456621004566211, 1.022660062552482, 2.0, 1.0110599078341014, 1.0429082240762813, 1.0390818858560793, 1.0102346920769367, 1.0, 1.015619235026442, 1.0148148148148148, 1.018, 1.4476190476190476, 1.3372262773722627, 1.0738595220854454, 1.0625949901491698, 1.0188925962665705, 1.1806083650190113, 1.1644736842105263, 1.0425531914893618, 1.0869565217391304, 1.1354515050167224, 1.1428571428571428, 1.0032327103724332, 1.0224553751839511, 1.0236039147956246, 1.0350306703126155, 1.0036787247087677, 1.0844133471151043, 1.0105263157894737, 1.0546218487394958, 1.22416965236758, 1.0904079382579934, 1.0682027649769585, 1.0383451059535822, 1.0603725112395632, 1.0384615384615385, 1.084513047927682, 1.1666666666666667, 1.0555555555555556, 1.018487157775896, 1.0478378942970545, 1.1022937476877543, 1.1692307692307693, 1.0354998133969668, 1.050050454086781, 1.0017562117861325, 1.1153846153846154, 1.0256410256410255, 1.0004013531334213, 1.0, 1.7272727272727273, 1.0464949324324324, 1.2780930760499432, 1.107197549770291, 1.3461538461538463, 1.0167202572347267, 1.011843775209771, 1.0062155225684812, 1.1798245614035088, 1.1593759881943713, 1.1568627450980393, 1.03125, 1.0120481927710843, 1.0, 1.0389610389610389, 1.0631603847973505, 1.6898954703832754, 1.0459770114942528, 1.0177953534354918, 1.0957683741648108, 1.0855511540106753, 1.0039552114088353, 1.061496035849707, 1.035294117647059, 1.035928143712575, 1.0489462950373896, 1.017620196450112, 1.0568995384559474, 1.0, 1.0438923395445134, 1.0337187087625312, 1.0010649792112343, 1.0587570621468927, 1.0695094760312152, 1.0085433936728134, 1.0344827586206897, 1.0003045722157489, 1.025925925925926, 1.1381838691483361, 1.0607734806629834, 1.0109935697987968, 1.0089773614363777, 1.1307086614173227, 1.0, 1.0490827962320277, 1.1144484144707458, 1.0201593999062353, 1.3320895522388059, 1.0909090909090908, 2.6666666666666665, 1.074040203302791, 1.1272727272727272, 1.075893011216566, 1.5, 1.5, 1.3793103448275863, 1.0211239537664407, 1.6122448979591837, 1.1243093922651934, 1.158924205378973, 1.0741379310344827, 1.014480408858603, 1.066054477919934, 1.0178571428571428, 1.0, 1.008708078876483, 1.0644298065047344, 1.1033274956217163, 1.0105775863871063, 1.057042718545233, 1.0337391068461566, 1.1057233704292528, 1.0339594739714453, 1.062799043062201, 1.1674509167613176, 1.3355748728883057, 1.4545454545454546, 1.0975158562367864, 1.1940298507462686, 1.25, 1.0416666666666667, 1.0978181818181818, 1.0555555555555556, 1.1818181818181819, 1.035165870399031, 1.033426183844011, 1.2314814814814814, 1.0245929018789144, 1.0153321976149914, 1.0018033788581904, 1.0073380768189995, 1.4, 1.053328483084758, 1.0, 1.0044349409994455, 1.062634989200864, 1.0052796868599518, 1.275, 1.25, 1.1304347826086956, 1.295774647887324, 1.002953096802027, 1.0, 1.0795107033639144, 1.0588235294117647, 1.0372596153846154, 1.0019933013435143, 1.0988372093023255, 1.0440251572327044, 1.0006547953874279, 1.1132235613647938, 1.0945460912194696, 1.017391304347826, 1.0, 1.2541766109785202, 1.0357142857142858, 1.0903426791277258, 1.0277946142523162, 1.0336206896551725, 1.0169014084507042, 1.0, 1.0164609053497942, 1.0973952434881087, 1.5714285714285714, 1.0211815426911182, 1.064102564102564, 1.4210526315789473, 1.0180379702756537, 1.2380952380952381, 1.75, 1.0459549071618037, 2.0, 1.01920438957476, 1.0508720930232558, 1.0065627563576702, 1.0458860759493671, 1.114882506527415, 1.120879120879121, 1.0244727336679338, 1.0128607709971358, 1.0352609308885754, 1.0179902423024887, 1.0582345579032615, 2.0, 1.2222222222222223, 1.030387228180887, 1.3333333333333333, 1.048687089715536, 1.0, 1.0, 1.0454545454545454, 1.182897862232779, 1.078095238095238, 1.131578947368421, 1.0876623376623376, 1.0, 1.0106524633821572, 1.0299168463196797, 1.5, 1.159618820726623, 1.0, 1.0084263265770894, 1.0224719101123596, 1.0978220939385988, 1.1543778801843319, 1.0018181818181817, 1.2053388090349075, 1.0925925925925926, 1.0131831976202639, 1.0026688624174191, 1.0239680426098536, 1.0, 1.1428571428571428, 1.8333333333333333, 1.5, 1.2307692307692308, 1.0026624650310298, 1.25, 1.0183028286189684, 1.108910891089109, 1.005708315282485, 1.0173254161326044, 1.0339855818743564, 1.0766542294431587, 1.0335731414868106, 1.2371134020618557, 1.5, 1.0375, 1.0491071428571428, 1.0133733194798653, 1.2857142857142858, 3.6666666666666665, 1.1069042316258353, 1.0372093023255815, 1.0066312861204922, 1.1657142857142857, 1.342769701606733, 1.0287081339712918, 1.2903225806451613, 1.0808477237048666, 1.0582627118644068, 1.3076923076923077, 1.055306427503737, 1.0982142857142858, 1.0257750815474194, 1.003372543017688, 1.0386435331230284, 1.0116279069767442, 1.1531531531531531, 1.0654761904761905, 1.0, 1.0150057762820834, 1.0169720752242537, 1.002795626197723, 1.0098158036839264, 1.0380569898642187, 1.0247476392054706, 1.8333333333333333, 1.2238301977809938, 1.2, 1.1067463706233989, 1.1111111111111112, 1.0213065817362645, 1.0217391304347827, 1.111134995700774, 1.173913043478261, 1.0853658536585367, 3.0, 1.0834655664868296, 1.0093546343091009, 1.010621666360125, 1.0, 1.0327868852459017, 1.0374280230326296, 1.2385057471264367, 1.0702335795567977, 1.0712694877505569, 1.1666666666666667, 1.1484037963761864, 1.0975763666534228, 1.065451084319361, 1.0043299567884394, 1.0482456140350878, 1.1956882255389718, 1.0114942528735633, 1.5, 1.0203045685279188, 1.3, 1.0422919508867667, 1.32, 1.0557919021313522, 1.3157894736842106, 1.1417075875178204, 1.0541485507246378, 1.1179310344827587, 1.0, 1.0961538461538463, 1.24, 1.0008178207025469, 1.2538293216630196, 1.0, 1.133876761536336, 1.0209380726401354, 1.1764992686494393, 1.0, 2.0, 1.163495145631068, 1.011786038077969, 1.4734299516908214, 1.0, 1.0242595157991952, 1.0301556420233462, 1.0869565217391304, 1.0128060263653484, 1.0272727272727273, 1.0013140604467805, 1.1516129032258065, 1.0012620950778293, 1.1495895757993226, 1.0, 1.0675675675675675, 1.119213324274198, 1.0266364606368008, 1.0543295313768208, 1.0, 1.0314852840520192, 1.016426104223331, 1.0277632268203247, 2.0, 1.11244019138756, 1.0612259309825338, 1.1292971607154731, 1.1869293608841902, 1.0249029595661145, 1.1534677816035415, 1.0235294117647058, 1.1002892960462873, 2.0, 1.0721484314434855, 1.088235294117647, 1.0, 1.3310344827586207, 1.1063829787234043, 1.0304128625537872, 1.0199306759098787, 1.0339182292562648, 1.3878980891719745, 1.0170718320488485, 1.0403083998376843, 1.0042425262473667, 1.0776699029126213, 4.0, 1.0323322530308487, 1.0034412955465588, 1.0049169972171161, 1.0134566136906418, 1.1073033707865167, 1.2639676113360323, 1.1, 1.4285714285714286, 1.0167712549354524, 1.0203781489198132, 1.0253872315256367, 1.1015173410404624, 1.047994341719713, 1.0082474226804123, 1.0051337608214017, 1.0125614418350628, 1.0902777777777777, 2.0, 1.25, 1.1145299145299146, 1.0680529300567108, 1.0067567567567568, 1.0632111251580278, 1.1258278145695364, 1.0874316939890711, 1.0554699537750385, 1.098901098901099, 1.0025720422908473, 1.3780487804878048, 1.0385064363956185, 1.0, 1.0849571317225253, 1.3611111111111112, 1.0921985815602837, 1.0290313308421961, 1.107878787878788, 1.0494071146245059, 1.0252659574468086, 1.056171637537994, 1.0, 1.8085106382978724, 1.6666666666666667, 1.0, 1.0476190476190477, 1.0759219088937093, 1.35, 1.1318681318681318, 1.0293175264338352, 1.129750982961992, 1.0369634476379705, 1.0127686846775783, 1.1007371007371007, 1.0040885064296632, 1.0393258426966292, 1.079182630906769, 1.107885824866957, 1.0934199837530463, 1.1271676300578035, 1.067069660333909, 1.0240269849507007, 1.0219321640362713, 1.007695303740248, 2.0, 1.2259036144578312, 1.0517560073937153, 1.062937062937063, 1.0, 1.0625, 1.1538461538461537, 1.1770833333333333, 1.4814814814814814, 1.5, 1.038542625282356, 1.0233339257153011, 1.0083809720892936, 1.0301687271596298, 1.0648648648648649, 1.0267314702308628, 2.0, 1.1, 1.1444470755387166, 1.0121789252795708, 1.005800464037123, 1.042202984394578, 1.0043095708385708, 1.0845070422535212, 1.027414294459749, 1.1953818827708704, 1.0142712562116922, 1.0483254579340726, 1.3636363636363635, 1.127946127946128, 1.0, 1.0090702947845804, 1.0232829275932274, 3.0, 1.0285423037716617, 1.0190270651192495, 1.2857142857142858, 1.1689897671284795, 1.1, 1.1875, 1.013370461542878, 1.7692307692307692, 1.0172824287250886, 1.0106791969243913, 1.2258064516129032, 1.2083333333333333, 1.2864721485411141, 1.0043227665706052, 1.0689004247286455, 1.0039315308776386, 1.00977910415945, 1.0, 1.1731479469910928, 1.0123456790123457, 2.0, 1.1477039463062482, 1.017363093693226, 1.1456953642384107, 1.014600898019834, 1.0626911513984147, 1.2988505747126438, 2.0, 1.0760745530620008, 1.0662080825451419, 1.0312728013167496, 1.1280853902601735, 1.0576223711738295, 1.088649255315922, 1.0036630036630036, 1.0220532319391635, 1.1455938697318007, 1.0138585715010915, 1.064353312302839, 1.0878623188405796, 1.1727941176470589, 1.0463626083678854, 4.0, 1.01089293204698, 1.01542728203497, 1.0264531435349942, 1.1875, 1.02959679725479, 1.0423076923076924, 1.0, 1.02532270579107, 1.0134426229508198, 1.0904761904761904, 1.0588235294117647, 1.6666666666666667, 1.0280417816927627, 1.5, 1.470790378006873, 1.1538461538461537, 1.0677552159653898, 1.3333333333333333, 1.2279792746113989, 1.1048218029350105, 1.0, 1.312169312169312, 1.0603328710124826, 2.0, 1.0, 1.0901639344262295, 1.039426523297491, 1.0419143876337693, 1.0381263616557734, 1.0389610389610389, 1.0117994100294985, 1.089150378938971, 1.0467532467532468, 1.5408805031446542, 1.6333333333333333, 1.1923076923076923, 1.0, 1.107645875251509, 1.3145743145743145, 1.0083333333333333, 1.154683574590262, 1.010217196490897, 1.2467130703789637, 1.022196365576735, 1.0204352637403171, 1.0409145607701564, 1.022673031026253, 1.1, 1.0, 1.096774193548387, 1.0177725942117417, 1.1561224489795918, 1.0065359477124183, 1.16, 1.053455517373043, 1.0179665551839465, 1.0009184501687385, 1.0512820512820513, 1.1, 1.073279052553664, 1.127120890774125, 1.024613309070373, 1.0209492591760398, 1.2171052631578947, 1.009014378305893, 1.007990889392486, 1.0802213001383125, 1.0229166666666667, 1.3333333333333333, 1.0773346303501945, 1.0289687137891077, 1.0384615384615385, 1.0794117647058823, 1.0347890451517394, 1.0, 1.0735294117647058, 1.0071176116096878, 1.0555555555555556, 1.0089069151072203, 1.1546610169491525, 1.0, 1.0254182871127588, 1.0010814708002884, 1.1448764437281762, 1.0234375, 1.011350737797957, 1.0149909828674482, 1.1642411642411643, 1.0714285714285714, 1.0, 1.1111111111111112, 1.0132735860482016, 1.8333333333333333, 1.1564368901479383, 1.059339830919175, 1.0750996898537881, 1.073789720622734, 1.0017306452224708, 1.1018220793140407, 1.073076923076923, 1.0126404494382022, 1.00774414727499, 1.1187960462494428, 1.0051482395800877, 1.0040813858572422, 1.25, 1.0666666666666667, 1.2885375494071147, 1.0395474118516117, 1.0423452768729642, 1.0180296200901482, 1.2017699115044247, 1.0292397660818713, 1.0484093311072649, 1.0347222222222223, 1.0005143540669856, 1.3125, 1.0064422375450075, 1.0088769885281994, 1.1707429626211352, 1.0008428150021071, 1.25, 1.0366259711431742, 1.144278606965174, 1.5, 1.055448717948718, 1.2692307692307692, 1.0110887096774193, 1.0088691796008868, 1.1092380310182064, 1.003548496113552, 1.0788235294117647, 1.0, 1.041860465116279, 1.0114526269348139, 1.0079671092838491, 1.0113209210368905, 1.067694720334553, 1.0297446607828606, 1.0833333333333333, 1.0419407894736843, 1.1345301418439717, 1.1345149337023974, 1.0183673469387755, 1.1875, 1.0349976668222118, 1.0116801437556155, 1.1532663316582914, 1.008933089069179, 1.0, 1.3333333333333333, 1.0285841429948825, 1.0519538188277087, 1.0057228452911353, 1.0773546854096363, 1.0606544293695133, 1.0465116279069768, 1.0102709682506825, 1.1153276813349482, 1.0130353817504656, 1.3675675675675676, 1.0609243697478992, 1.0221616845825356, 1.0119047619047619, 1.75, 1.043939557474366, 1.009716067159693, 1.0096921322690993, 1.2941176470588236, 1.0387400434467777, 1.026040737701994, 1.0099375354911981, 1.2307692307692308, 1.2307692307692308, 1.082210242587601, 1.0084925690021231, 1.109375, 1.5925925925925926, 1.0451000111744329, 1.0109018830525272, 1.0904159132007234, 1.2424242424242424, 1.0390477145818704, 1.030686992674718, 1.0138780496080892, 1.0692503176620076, 1.6666666666666667, 1.037037037037037, 1.3333333333333333, 1.033849477853799, 1.4615384615384615, 1.3333333333333333, 1.5, 1.2157809983896941, 1.056159420289855, 1.07453243798213, 1.0090632984621317, 1.1111111111111112, 1.588235294117647, 1.0, 1.064516129032258, 1.3243243243243243, 1.1290322580645162, 1.0467289719626167, 1.0165267487488434, 1.0040383569400877, 1.0390625, 1.0291267447665553, 1.0017416545718432, 5.0, 1.0069153822598755, 1.0642857142857143, 1.0, 1.3333333333333333, 1.0375739644970414, 1.1046403213081832, 1.0338704491050055, 1.0062111801242235, 1.0, 1.1168831168831168, 1.3711656441717792, 2.0, 1.5, 1.049458661417323, 1.0077214846924953, 1.1457408732999284, 1.25, 1.0095228551864657, 1.067389620449264, 1.1484098939929328, 1.3333333333333333, 1.097938144329897, 1.0028537623276481, 1.131578947368421, 1.1113122171945702, 1.096412699087758, 1.0, 1.00390625, 1.0258874067375086, 1.183603757472246, 1.1446280991735538, 1.3018867924528301, 1.0653005941978329, 1.0190701732519007, 1.0610019613709651, 1.218978102189781, 1.2592592592592593, 1.1940298507462686, 1.0335051546391754, 1.0306897599513825, 1.0203277286105652, 1.0197202529220157, 1.0884279475982532, 3.0, 1.25, 1.0989883377827736, 1.1974494283201407, 1.2814627504376581, 1.0141074706742588, 1.0253815812039102, 1.0785318843551364, 1.0816326530612246, 1.0833333333333333, 1.0455329990959152, 1.0018696965338703, 1.051266941661756, 1.1330998248686515, 2.5, 1.04, 1.0260087323095453, 1.0814814814814815, 1.0159915050082413, 1.0076981072179676, 1.1193181818181819, 1.6, 1.0, 1.0844824493212941, 1.0527758738862234, 1.1711026615969582, 1.016068278262528, 1.0940766550522647, 1.2671328671328672, 1.0834782608695652, 1.003422924123968, 1.0693612999054778, 1.109447004608295, 1.1126760563380282, 1.03125, 1.046907040328093, 1.0175813953488373, 1.0409511228533685, 1.0463353086927232, 1.026857142857143, 1.0827190827190827, 1.3846153846153846, 1.0530785562632696, 2.5, 1.5, 1.3076923076923077, 1.0255754475703325, 1.1453396524486572, 1.0334212187604441, 1.0203093089423798, 1.03202170963365, 1.0094142259414225, 1.0815217391304348, 1.183673469387755, 1.035108763512139, 1.6, 1.25, 1.1629268292682926, 1.0, 1.2054574638844302, 1.1559959349593496, 1.066724353427555, 1.0160604437519274, 1.0, 1.1736918604651163, 1.2926356589147288, 1.12643391521197, 1.0003349837785251, 1.065948855989233, 1.0462199928341096, 1.0191716117252465, 1.0404747242904326, 1.1017488076311606, 1.290909090909091, 1.2486033519553073, 1.0, 1.0, 1.0007331640499266, 1.6666666666666667, 1.5714285714285714, 1.35, 1.031363088057901, 1.146341463414634, 1.032036613272311, 1.109708315193731, 1.0, 1.1887026691495965, 1.023311416616856, 1.1210762331838564, 1.0024038461538463, 1.1111111111111112, 1.0362511052166226, 1.045191193511008, 1.079664570230608, 1.0572703607288956, 1.002589313491652, 1.1401859609686318, 1.0572232645403377, 1.0, 1.0053729322672083, 1.0241023462413354, 1.0479734576757531, 1.2695652173913043, 1.028214250420002]
origin-bjaq_15.87 	max: 5.0000	99th: 2.5017	95th: 1.5723	median: 1.0563	mean: 1.1457

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 15.950620 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=naru', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[ 0.0000000e+00  1.1920929e-07 -2.9802322e-08  2.3841858e-07
  1.7881393e-07]
Distance score: 1.01327898960335e-07
SAUCE Drift detection: False
Detection latency: 0.0231s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 2.054622 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=naru', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-bjaq-3.5MB-model34.414-data18.543-200epochs-seed0.pt
query_seed:0
origin-bjaq_15.87 	max: 8.0000	99th: 2.5000	95th: 1.8000	median: 1.0672	mean: 1.1760
ReportEsts: [1.0738636363636365, 1.0336191335740073, 1.0360826352317947, 1.028391167192429, 1.1470588235294117, 1.0, 1.1759911450996177, 1.0232531552954087, 1.4, 1.010989010989011, 1.0632015734433464, 1.0023112870257347, 1.0305899490167516, 1.0235756385068762, 1.0185076380728555, 1.55, 1.0822784810126582, 1.0571428571428572, 1.4444444444444444, 1.2492431886982847, 1.0822466372317487, 1.0249985155275816, 1.0119904076738608, 1.1198501872659177, 1.0161670952062274, 1.0009930765173873, 2.0, 1.0843556555993248, 1.2, 1.6, 1.0133779264214047, 1.0, 1.0042164218535348, 1.0054687219840062, 1.2898886827458256, 1.0296786853078244, 1.0241808354914987, 1.0, 3.0, 1.16814473217453, 1.0349773295086517, 1.061871145128929, 1.0626477541371158, 1.0057927100971393, 1.0787545787545787, 1.134731078208869, 1.0, 1.113905325443787, 1.3675675675675676, 1.155844155844156, 1.8333333333333333, 1.0070671378091873, 1.1255605381165918, 1.0, 1.078783542039356, 1.034662751814697, 1.0461157986616234, 1.1121076233183858, 1.0963855421686748, 1.023229366112402, 1.0454545454545454, 1.0483629744212082, 1.1202263083451203, 1.0344827586206897, 1.1372549019607843, 1.6666666666666667, 1.1560543550388045, 1.070167792547396, 1.7142857142857142, 1.0, 1.1432252332296757, 1.030241935483871, 1.0510351468464132, 1.118095238095238, 1.0498174230568598, 1.1808155080213905, 1.0566216933433894, 1.009478672985782, 1.0780141843971631, 1.0018051203108105, 1.2152199762187872, 1.1111111111111112, 1.0, 1.2, 1.0173812282734647, 1.0508474576271187, 1.069204152249135, 1.15625, 2.0, 1.0434329506829987, 1.0863955577331375, 1.054172378720205, 1.113617614428356, 1.1507543103448277, 1.080110497237569, 1.341121495327103, 1.0976744186046512, 1.2638522427440633, 1.3333333333333333, 1.1388888888888888, 1.3548387096774193, 1.5, 1.05453775760196, 1.1121019108280255, 1.0131868131868131, 1.0224982705206485, 1.048780487804878, 1.0025383575487918, 1.1058679706601466, 1.090651364552379, 1.075, 1.0133998949027851, 1.1428571428571428, 1.1538461538461537, 1.1579542883005205, 1.0021204663322745, 1.0809739524348811, 1.0459770114942528, 1.0057071014557315, 2.0, 1.21061041866411, 1.1675977653631284, 1.0, 1.2044444444444444, 1.2857142857142858, 1.050709939148073, 1.0189148566207893, 1.1314869936585996, 1.03125, 1.8333333333333333, 1.2367115520907157, 1.0, 1.6666666666666667, 1.015242191883299, 1.0, 1.026745913818722, 1.0369123289240108, 1.0744606332305968, 2.5, 1.2666666666666666, 1.0019646365422397, 1.157079646017699, 1.054255319148936, 1.0471617555368808, 1.323076923076923, 1.0566556655665567, 1.0572603708107067, 3.0, 1.0177059276366436, 1.057942057942058, 1.0531201650335225, 1.0219731603008406, 1.3333333333333333, 1.011843822141925, 1.05, 1.0082508250825082, 1.4515151515151514, 2.0, 1.1002493765586034, 1.0755935880438712, 1.1000263723015484, 1.127591706539075, 1.1548913043478262, 1.0169491525423728, 1.2321428571428572, 1.0692934782608696, 1.1111111111111112, 1.0112088674931525, 1.2727272727272727, 1.1308523409363747, 1.0150890301295425, 1.1731843575418994, 1.0370866652258484, 1.0658135283363803, 1.0684931506849316, 1.1637965882448056, 1.094418052256532, 1.2023809523809523, 1.0281090289608177, 1.0206238721319927, 1.0608227730152815, 1.005448663374766, 1.0258064516129033, 1.0621621621621622, 1.0122698536576356, 1.0812403478826302, 1.0, 1.0329561453824894, 1.1523545706371192, 2.0, 1.064516129032258, 1.0055954663842697, 1.1071428571428572, 1.0451713395638629, 1.1223399558498897, 1.0091591614550681, 1.0015693244341923, 1.0255102040816326, 1.0033501527881632, 1.0672398000076333, 1.0576077396657872, 1.0367072162513287, 1.0293754628486793, 1.0144078782778776, 1.1864229765013055, 1.1292060408019076, 1.3018867924528301, 1.0, 1.0625, 1.0, 1.010989010989011, 1.034189777052746, 1.6264367816091954, 1.2156862745098038, 1.0185490519373455, 1.2307692307692308, 1.0066860254833676, 1.0220264317180616, 1.0181211059982898, 1.5, 1.0644329896907216, 1.059510250569476, 1.0378969610341184, 1.1013614460366559, 2.0, 1.2336065573770492, 1.0571611547177246, 1.0317969020014452, 1.0263852242744063, 1.272419627749577, 1.0143014301430142, 1.0647586944543481, 1.0260869565217392, 1.0019373888097167, 1.0344798509161741, 1.0798611111111112, 1.133276740237691, 1.0532544378698225, 1.5, 1.1031128404669261, 2.0, 1.0174134220309137, 1.0821553533939818, 1.1131594430280447, 1.3808049535603715, 1.1538461538461537, 2.5, 1.0753589217697042, 1.1194029850746268, 1.0359776040800488, 1.75, 1.0769764216366158, 1.1058951965065502, 1.2857142857142858, 1.0022374725257348, 1.1421911421911422, 1.1649590163934427, 1.023489932885906, 1.0305096913137115, 1.0292851563149235, 1.2580645161290323, 2.0, 1.0082081354818062, 1.1273446911030804, 1.1285081240768096, 1.1134394324151433, 1.0477391193795822, 1.0235614525139665, 1.0949284785435631, 1.019953997392209, 1.0626553953257085, 1.1518359689091398, 1.1550332383665718, 2.0, 1.0720589118123787, 1.132007233273056, 1.3265306122448979, 1.1428571428571428, 1.0768950437317784, 1.0793650793650793, 1.0180689715459592, 1.0097959472362699, 1.1291079812206573, 1.1905940594059405, 1.0070482001220256, 1.0148936170212766, 1.1227980410788685, 1.0187851115835629, 1.4166666666666667, 1.0177179305457122, 1.0134146341463415, 1.0181148655340373, 1.062261753494282, 1.0049559116946643, 1.0612353567625132, 1.0054945054945055, 1.0427851104849473, 1.0008184143222507, 1.039434188803842, 1.0942415145290798, 1.0830078125, 1.5454545454545454, 1.1538461538461537, 1.0764886235275133, 2.0, 1.0196779964221825, 1.0556064411286747, 1.0716573933569382, 1.0512820512820513, 1.2222222222222223, 1.1374045801526718, 1.0813756812629205, 1.0061699650756695, 1.0434782608695652, 1.0598460392351627, 1.010034915554615, 1.0142517814726841, 1.6666666666666667, 2.3, 1.0558096980786826, 1.7142857142857142, 1.0207702391911806, 1.0541353383458647, 1.0416666666666667, 1.048031486643299, 1.0384615384615385, 1.8888888888888888, 1.0250718504932048, 2.0, 1.0, 1.0758706467661692, 1.051871306631648, 1.0108080288214103, 1.2635983263598327, 1.0990990990990992, 1.0146606069491277, 1.0235775935014384, 1.1571428571428573, 1.0220249858112866, 1.1789315889888252, 1.5, 1.3333333333333333, 1.0068667222909533, 1.25, 1.0474452554744527, 1.0, 1.0, 1.125, 1.2734952481520592, 1.0966183574879227, 1.3362068965517242, 1.1637700534759359, 1.28, 2.0, 1.0180370446312623, 1.1111111111111112, 1.0806451612903225, 1.0242084822277608, 1.2436363636363637, 1.0445151033386328, 1.0018921475875118, 1.5, 1.0, 1.0563836681788723, 1.5512820512820513, 1.0454995054401583, 1.0105385436507106, 1.0880049720323182, 1.0432569974554708, 1.0, 1.005216378785751, 1.2702702702702702, 1.2352941176470589, 2.3333333333333335, 1.0209059233449478, 1.1111111111111112, 1.0305010893246187, 1.024, 1.0222067569277489, 1.013171962847937, 1.0611111111111111, 1.063621444201313, 1.044226731980406, 1.051605504587156, 1.0474898236092265, 1.0243256535391367, 1.0515933232169954, 1.1142857142857143, 1.0037830902469858, 1.0223710241972304, 1.1687798104208176, 1.0704225352112675, 1.0930232558139534, 1.0711538461538461, 2.0, 1.962962962962963, 1.1864406779661016, 1.0704761904761906, 1.7863247863247864, 1.2047970479704797, 1.0473343298455406, 1.452127659574468, 1.0104175467648997, 1.1496546431312356, 1.0667987060143922, 1.3766233766233766, 1.014388489208633, 1.087719298245614, 1.0, 1.0075589628399824, 1.3898305084745763, 1.0040211440437983, 1.0256235264921205, 1.000320589885389, 1.0063694267515924, 1.8571428571428572, 1.159680638722555, 1.1666666666666667, 1.0723249669749009, 1.2727272727272727, 1.0275698011638266, 1.0195360195360195, 1.110990990990991, 1.1689189189189189, 1.1848937844217151, 3.0, 1.0188445326060005, 1.0138458581587546, 1.0429123760670673, 1.5, 1.21875, 1.0032258064516129, 1.312807881773399, 1.087665406427221, 1.1757040773434215, 1.04, 1.1388690050107373, 1.1110808444401206, 1.0516836091349222, 1.1458011902137977, 1.1036213226529348, 1.0144063027574564, 1.0408163265306123, 1.1860095389507155, 1.0539713363024252, 1.2671755725190839, 1.0940119760479041, 1.0, 1.5, 1.0773620798985415, 1.0948616600790513, 1.2079838980207984, 1.0268180613236724, 1.1251455180442376, 2.0, 1.0393700787401574, 1.2258064516129032, 1.0147367384130423, 1.0, 1.0, 1.0287495464590823, 1.0, 2.0, 1.1097424412094066, 3.6666666666666665, 1.198042414355628, 1.000748502994012, 1.3443223443223444, 1.1, 1.0171295469224533, 1.0612582781456954, 1.1481481481481481, 1.0342319077911444, 1.054263565891473, 1.064410480349345, 1.1734972677595628, 1.0360161705255422, 1.1143828401800249, 1.0, 1.0930232558139534, 1.0896133034182394, 1.0292397660818713, 1.1015037593984962, 1.1666666666666667, 1.0444487577639752, 1.0080996334895163, 1.0429964539007093, 2.0, 1.0979090607368072, 1.0454184594576053, 1.0715000526703886, 1.186661807580175, 1.0365596649073048, 1.0028832960861205, 1.0373702422145328, 1.0130232558139536, 2.0, 1.1020927723840346, 1.0252525252525253, 1.0592233009708738, 1.099337748344371, 1.0693333333333332, 1.0331074026099842, 1.0671641791044777, 1.0801217685123203, 1.2752475247524753, 1.0016500257816527, 1.0675512665862485, 1.0546439465656885, 1.178044908142436, 1.0833333333333333, 1.4507042253521127, 1.0108988684899751, 1.0185567010309278, 1.0342062193126023, 1.01559075326427, 1.3333333333333333, 1.364642993508973, 1.2140762463343109, 1.25, 1.3333333333333333, 1.006092349734096, 1.1685393258426966, 1.0150634818162256, 2.0, 1.0491803278688525, 1.0489593188268684, 1.0455136309407218, 1.0307514895252738, 1.0303158061158615, 1.0565055762081785, 1.25503355704698, 1.101601325234677, 1.0769279423159026, 1.3185185185185184, 1.0387642018997951, 1.0666285387474979, 1.0596330275229358, 1.0129833569049072, 1.0172927847346451, 1.030052512532903, 1.5, 1.0687898089171974, 1.544262295081967, 1.0793960471626092, 1.0161616161616163, 1.1305699481865286, 1.018092105263158, 1.1876430205949657, 1.0297152249683144, 1.0, 1.639344262295082, 1.6666666666666667, 1.0, 1.0096153846153846, 1.0065359477124183, 1.4038461538461537, 1.0769230769230769, 1.0353290183387271, 1.0861801242236024, 1.0693503672582811, 1.0011476350520534, 1.0007369684142897, 1.0151308953480886, 1.0165669777836204, 1.0664225941422594, 1.0588627276765883, 1.0086097380351735, 1.1088335773548073, 1.0153340635268346, 1.02020202020202, 1.0886075949367089, 1.0021880951416184, 1.2465753424657535, 1.0114219763600907, 1.119047619047619, 1.189506880733945, 1.75, 2.5, 1.0703399765533412, 1.1875, 2.3333333333333335, 1.4221556886227544, 1.0175761521021796, 1.0227360308285163, 1.070886075949367, 1.0055555555555555, 1.0235930024469522, 1.147940074906367, 1.0281954887218046, 1.2, 1.6666666666666667, 1.0044351822165223, 1.198237885462555, 1.0308977035490605, 1.0032702639570195, 2.0, 1.165034965034965, 1.096470588235294, 1.0172811788515053, 1.1793721973094171, 1.0112058419789518, 1.0059630842055112, 1.0023446996688603, 1.0632911392405062, 2.0, 1.085469238014972, 2.0, 1.0556227327690448, 1.1666666666666667, 1.090566037735849, 1.1086142322097379, 1.2413793103448276, 1.1700815363409107, 1.0802919708029197, 1.057934508816121, 1.3923705722070845, 1.0573453608247423, 1.0350981558596073, 1.0875101874490627, 1.0204991087344029, 1.0164853280580284, 1.2, 1.0324072244397897, 1.112457984695702, 1.4444444444444444, 1.0303867403314917, 1.0465473973933457, 1.184549356223176, 1.0872296071689633, 1.0909090909090908, 1.15071283095723, 1.060782076548076, 1.0738916256157636, 1.2302158273381294, 1.021921203315956, 1.3232323232323233, 2.5714285714285716, 1.08902170493866, 1.0910404624277457, 1.0609170058796924, 1.050974930362117, 1.0459863409761112, 1.000257919378701, 1.09375, 1.013149655604258, 1.1993355481727574, 1.0021324438084795, 1.0812101910828025, 1.0225330225330225, 1.0044326241134751, 1.0457728653391833, 1.1833333333333333, 1.1399778106508875, 1.2, 1.3333333333333333, 1.0150375939849625, 1.023936659915301, 1.0354587869362364, 1.200527704485488, 1.4444444444444444, 1.0389926888708367, 1.1003521126760563, 1.4827586206896552, 1.0257405242475035, 2.3333333333333335, 1.0012129613585168, 1.3333333333333333, 1.3720316622691293, 1.0588235294117647, 1.1106194690265487, 1.303030303030303, 1.1606425702811245, 1.076256499133449, 1.0, 1.0612244897959184, 1.1176829268292683, 2.25, 1.25, 1.087248322147651, 1.0395136778115501, 1.069406842234802, 1.0106100795755968, 1.0968188105117567, 1.1537162162162162, 1.1666666666666667, 1.316872427983539, 1.5051020408163265, 1.2222222222222223, 1.0303030303030303, 1.0, 1.1897590361445782, 1.2287735849056605, 1.0596330275229358, 1.2357671276937923, 1.0149252258519714, 1.2158690176322418, 1.0081034472101518, 1.0312113627453936, 1.1126903553299492, 1.0089020771513353, 1.4444444444444444, 1.0, 1.0256410256410255, 1.1005249014939504, 1.1289782244556115, 1.018970189701897, 1.1033707865168538, 1.070288559754852, 1.0108867642798245, 1.005723998109785, 1.1222222222222222, 1.0869565217391304, 1.3888888888888888, 1.132540779651645, 1.0445787784775575, 1.0448721479800371, 1.2890173410404624, 1.0559267508042565, 1.0425979520438882, 1.0065245235753257, 1.0194465220643232, 1.0125139859862402, 1.15, 1.0125523012552302, 1.3320561941251596, 1.0073500063566025, 1.0, 1.0530953954615554, 1.0, 1.11088295687885, 1.0558064654005614, 1.1538461538461537, 1.03919932127165, 1.2018018018018017, 1.0588235294117647, 1.0294420861127955, 1.0255616965036645, 1.126349135151804, 1.0065252854812399, 1.008595988538682, 1.0084159692430317, 1.1721739130434783, 1.0625, 2.0, 1.1818181818181819, 1.014338146325724, 1.625, 1.0021810141213126, 1.0709869629496886, 1.0842604413642167, 1.0558286516853932, 1.0248069508919038, 1.1396743020758768, 1.0714285714285714, 1.022196261682243, 1.0101040153772074, 1.0345673008733005, 1.0023931760522584, 1.017403314917127, 1.4, 1.088992974238876, 1.353135313531353, 1.057382058176485, 1.1774647887323944, 1.0015811665495433, 1.1771595900439238, 1.001639344262295, 1.032735981293725, 1.010392609699769, 1.031793695131684, 1.1818181818181819, 1.0091017035641388, 1.0103154272869255, 1.1086797957695114, 1.011727078891258, 1.162162162162162, 1.1963048498845266, 1.0135233386651157, 1.089658993602982, 1.691358024691358, 1.0035301810815727, 1.1714285714285715, 1.0414790759465644, 1.240174672489083, 1.1016109045848823, 1.3189655172413792, 1.1133093525179856, 1.1341911764705883, 1.0642757335817419, 1.0470481906498323, 1.0464666021297193, 1.0800970873786409, 1.0305442181649584, 1.0, 1.0459290187891441, 1.0574357305564595, 1.0120355834641548, 1.0548523206751055, 1.3506631299734748, 1.2606060606060605, 1.0864516129032258, 1.0460947503201024, 1.0436045332900818, 2.4, 1.0315974253949678, 1.0205902766302013, 1.0204081632653061, 1.4606918238993711, 1.0061871869578027, 1.0476252165886677, 1.0192435301924354, 1.046242774566474, 1.0000492174426616, 1.107146829810901, 1.0515297906602254, 1.3150684931506849, 1.01335656213705, 1.0139700539356662, 1.0510204081632653, 2.5, 1.0485794838429843, 1.0026323689011014, 1.026391554702495, 1.3144654088050314, 1.0057821059038345, 1.0041804180418041, 1.0133048229983368, 1.1690590111642742, 1.1818181818181819, 1.0484314804623005, 1.3666666666666667, 1.0712468193384224, 1.65625, 1.0406864204883859, 1.0049180327868852, 1.0943396226415094, 1.3333333333333333, 1.037914691943128, 1.0493519441674974, 1.0101010101010102, 1.3333333333333333, 1.0030637254901962, 1.2019230769230769, 1.0027309968138371, 1.8, 1.053443321135438, 1.0327102803738317, 1.2268379728765169, 1.1140350877192982, 2.0, 1.118436406067678, 1.0762489180165697, 1.001182535675374, 1.3051181102362204, 1.2560975609756098, 1.0, 1.1470588235294117, 1.2087912087912087, 1.360655737704918, 1.088111888111888, 1.0076579936113026, 1.0060462801691963, 1.0457516339869282, 1.0110900933113416, 1.000412780346652, 8.0, 1.0039260661239595, 1.0406788311854025, 1.3333333333333333, 1.2857142857142858, 1.0385470719051149, 1.1074701970886, 1.0586371312208205, 1.1391076115485563, 1.5, 1.2037735849056603, 1.3425692695214106, 1.0116279069767442, 1.0209628408571825, 1.0315269444597346, 1.0035853934189845, 1.1755397448478901, 1.3333333333333333, 1.0057072432360896, 1.052196053469128, 1.1279761904761905, 1.123076923076923, 1.0941446613088404, 2.0, 1.1957390146471372, 1.082847198392078, 1.0701733144221124, 1.2105263157894737, 1.0501672240802675, 1.03434505708876, 1.1794326241134752, 1.1443298969072164, 1.3548387096774193, 1.056136043614832, 1.1129326047358834, 1.0848724835931658, 1.558139534883721, 1.34375, 1.0163934426229508, 1.0, 1.0319767441860466, 1.0320197044334976, 1.0156455871228252, 1.0474452554744527, 3.0, 1.1575532900834105, 1.029503041337361, 1.0871156661786237, 1.3320350535540408, 1.0059140504079644, 1.0473208072373, 1.101411395713539, 1.0113851992409868, 1.0344827586206897, 1.0114821862082541, 1.0189574677688782, 1.0566223535204333, 1.3114992721979621, 2.5, 1.0898876404494382, 1.019894099848714, 1.275256222547584, 1.0088060698981798, 1.001801778105108, 1.1224004753416519, 1.8, 1.0207100591715976, 1.0328823233807731, 1.0657844265439202, 1.0739549839228295, 1.0549450003477847, 1.1234939759036144, 1.3325242718446602, 1.0888676540850455, 1.002874844203459, 1.0055828433068144, 1.0873320537428024, 1.1576086956521738, 1.0, 1.0259388584051878, 1.0253811327727986, 1.0350620272314675, 1.00875, 1.0240847784200386, 1.0235756385068762, 1.263157894736842, 1.0473684210526315, 2.5, 1.5, 1.4285714285714286, 1.0235546038543897, 1.1613114754098361, 1.0105308668663722, 1.0334135031509317, 1.1357415301772493, 1.0317959468902864, 1.0825688073394495, 1.183132530120482, 1.0058719698752647, 1.3333333333333333, 1.2, 1.074171029668412, 1.125, 1.1675392670157068, 1.1247913188647747, 1.0522158148352951, 1.0208570114196027, 1.2, 1.211665098777046, 1.4318181818181819, 1.0293347501043604, 1.0003747351998715, 1.0532150776053215, 1.0298375184638109, 1.0176413207016848, 1.0431778929188256, 1.164, 1.45, 1.186926605504587, 1.0, 4.0, 1.0006295235363578, 1.25, 1.625, 1.5121951219512195, 1.0184426229508197, 1.0091813312930376, 1.0408963585434174, 1.0, 1.1666666666666667, 1.0193045927808004, 1.0224103585657371, 1.0511627906976744, 1.048016701461378]
origin-bjaq_15.87 	max: 8.0000	99th: 2.5000	95th: 1.8000	median: 1.0672	mean: 1.1760

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 20.266120 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=38.303969