Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 91, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 3.0000	95th: 1.6759	median: 1.0793	mean: 1.1775
ReportEsts: [1.0260586319218241, 1.0138020833333334, 1.057578519450834, 1.04, 1.5, 1.0, 1.1115553778488605, 1.0644071184811115, 1.0, 1.02365308804205, 1.102963668369261, 1.042567576704123, 1.013859722805544, 1.1348837209302325, 1.0699399505475098, 1.0, 1.1111111111111112, 1.0913921360255048, 3.0, 2.0, 1.125, 1.123739821636293, 1.1297599226596486, 1.1068702290076335, 1.053774050320671, 1.0, 1.2063952393506836, 1.5, 1.2, 1.0296296296296297, 1.0, 1.0596961428693037, 1.0058898430195364, 1.003899721448468, 1.0819503598178881, 1.2290219245330116, 1.1737967914438503, 1.0005099191413933, 1.087333838418624, 1.0476190476190477, 1.1800302571860817, 1.0731707317073171, 1.0, 1.0908179387457462, 1.1038651455814745, 1.8615384615384616, 1.03, 1.1802120141342756, 1.027111201463712, 1.0462962962962963, 1.0836117782186487, 1.2731958762886597, 1.0372983663294946, 2.0, 1.077922077922078, 1.3341128325051155, 1.3297872340425532, 1.3592233009708738, 1.0592105263157894, 1.25, 1.0657260996001454, 1.0896637608966375, 1.1136363636363635, 1.0235294117647058, 1.0909090909090908, 1.0079545058088826, 1.2765424365800189, 1.75, 1.0, 1.005034026288804, 1.0072115384615385, 1.0664723032069972, 1.034965034965035, 1.077719491993374, 1.0705882352941176, 1.0505836575875487, 1.0, 1.113152400835073, 2.0, 1.0250222388016872, 1.391304347826087, 1.016064384781779, 1.1533742331288344, 1.0982367758186398, 1.1418056918547597, 1.0, 1.075031562591046, 1.0091277890466532, 1.0735294117647058, 1.75, 1.075227599425012, 1.044867685032145, 1.1059190031152648, 1.0168302945301544, 1.0027397260273974, 1.0337662337662337, 1.0227272727272727, 1.1389698736637512, 1.0, 1.2285682964262223, 1.0158387329013678, 1.1054888507718696, 1.2210875560151673, 1.2142857142857142, 1.0176474469963832, 1.0913193522697107, 1.3139359292417214, 1.1205915813424345, 1.0499693439607602, 1.3333333333333333, 2.0, 1.0563084112149532, 1.0787618181317016, 1.0625394819962097, 1.013157894736842, 1.059495948462429, 1.0, 1.1277199621570482, 1.0930962343096233, 1.0, 1.0054945054945055, 1.0, 1.1879699248120301, 1.0267733023943517, 1.082938572648909, 1.0666666666666667, 1.8, 1.1324503311258278, 1.0, 1.0, 1.090112564026541, 1.1818181818181819, 1.10107421875, 1.0377825368813078, 1.0737984104957738, 1.0560747663551402, 1.061046511627907, 1.0023382696804364, 1.039972432804962, 1.0706886045094455, 1.0381364875931882, 1.3278688524590163, 1.0247326203208555, 1.0707792286816518, 2.0, 1.0200546946216955, 1.0171428571428571, 1.0782608695652174, 1.1139932945120876, 1.5, 1.2920804068781788, 1.007462686567164, 1.006, 1.1074561403508771, 1.0613138686131387, 1.0534389750505733, 1.1876435244896033, 1.1542024460057247, 1.0115384615384615, 1.0592105263157894, 1.3265306122448979, 1.3398058252427185, 1.0471281296023565, 1.4285714285714286, 1.0554865052622624, 1.0587728461520867, 1.1816326530612244, 1.3594447680062123, 1.1158827539195637, 1.1404945535501312, 1.2547368421052632, 1.074492099322799, 1.054710951873729, 1.0151668351870575, 1.0129421915444348, 1.0728862973760933, 1.0439456212456528, 1.1185647425897036, 1.0022856242118536, 1.0, 1.0, 1.0122857142857142, 1.0279106858054226, 1.1643334051259961, 1.0921052631578947, 1.1039351794052286, 1.2723428791082068, 1.0745189706296128, 1.1153846153846154, 1.0377272727272728, 1.0954576288219482, 1.0, 1.6363636363636365, 1.0449537952463581, 1.0397275822928491, 1.0097765363128492, 1.5217391304347827, 1.064951768488746, 1.0558327381472328, 1.0391133014104452, 1.0626410835214446, 1.067882365342047, 1.2598870056497176, 1.0, 1.2, 1.0, 1.4545454545454546, 1.1511591231666929, 1.3170731707317074, 1.3448275862068966, 1.013840830449827, 1.0031277926720286, 1.0068655017163755, 1.0855898346465431, 1.2744805893551858, 1.1, 1.0728682170542636, 1.0012978585334198, 1.0483801481992072, 1.003565841538603, 1.0, 1.0443064182194617, 1.141650089614559, 1.01677032670714, 1.1596534653465347, 1.0220201177880857, 1.2819345044458903, 1.0357142857142858, 1.0073125216378023, 1.0146982980917998, 1.0253807106598984, 1.103448275862069, 1.0701442841287458, 1.0011605415860736, 1.1771653543307086, 2.0, 1.2572786690433748, 1.096527467619473, 1.0623534927332396, 1.1452991452991452, 1.0909090909090908, 1.6666666666666667, 1.0572624470199259, 1.1454545454545455, 1.0764502762430939, 1.5, 1.0, 1.0526315789473684, 1.0515222482435598, 1.225, 1.0055555555555555, 1.128691983122363, 1.072289156626506, 1.00335852225021, 1.0647877509146164, 1.0555555555555556, 2.0, 1.1254806407172084, 1.0723272754028401, 1.1295971978984238, 1.0518636202102976, 1.0833700198106977, 1.0354243793091737, 1.1017488076311606, 1.1008045349717444, 1.0227272727272727, 1.0108408617095206, 1.1473862195293787, 1.1818181818181819, 1.0158141351034753, 1.260752688172043, 1.1818181818181819, 1.3888888888888888, 1.073090909090909, 1.0555555555555556, 1.1452991452991452, 1.1462351120382208, 1.1671309192200556, 1.3533834586466165, 1.0305802875038999, 1.0623885918003566, 1.034372608505521, 1.0600533207343412, 1.1111111111111112, 1.026064023281193, 1.6666666666666667, 1.024017275968707, 1.0863930885529158, 1.0389103818670065, 1.0810810810810811, 1.6666666666666667, 1.391304347826087, 1.126984126984127, 1.0825604188867402, 1.0, 1.036697247706422, 1.0203619909502262, 1.0060096153846154, 1.0157055898889458, 1.125, 1.1320754716981132, 1.0130035480410096, 1.1510730452339857, 1.1286842699164974, 1.205128205128205, 1.0, 1.0954653937947494, 1.2929936305732483, 1.1223776223776223, 1.1006739679865207, 1.0350291909924938, 1.064788732394366, 1.2553191489361701, 1.0178326474622772, 1.0467188765865514, 1.2857142857142858, 1.0087879699712212, 1.0321361058601135, 1.1176470588235294, 1.1119061952714535, 1.4285714285714286, 1.4, 1.0244595194319406, 2.0, 1.2016460905349795, 1.0392441860465116, 1.129614438063987, 1.0588706447737284, 1.1748466257668713, 1.1518987341772151, 1.121984875336517, 1.081651696242383, 1.0396600566572238, 1.028262354240618, 1.0826240867665888, 2.0, 1.0, 1.0718595031879157, 1.25, 1.0715483510340973, 1.3529411764705883, 1.0, 1.4666666666666666, 1.3142570281124497, 1.0579439252336449, 1.2524271844660195, 1.0357142857142858, 1.0, 1.159121171770972, 1.0753720913287983, 2.0, 1.2572960095294818, 1.0, 1.097821301146284, 1.155844155844156, 1.0187388061696383, 1.1451612903225807, 1.1363636363636365, 1.2802617230098146, 1.1944444444444444, 1.047212686926801, 1.0269914611815205, 1.0759312320916905, 1.0, 1.0769230769230769, 1.5714285714285714, 3.0, 1.3333333333333333, 1.0693567082998965, 1.3333333333333333, 1.0582362728785357, 1.1477272727272727, 1.20419247551338, 1.1128113910033395, 1.255406797116375, 1.0393425589193785, 1.013921113689095, 1.0726190476190476, 1.5, 1.3043478260869565, 1.0510638297872341, 1.040049117222938, 1.1428571428571428, 1.5714285714285714, 1.0135440180586908, 1.005232558139535, 1.033249977170714, 1.0124069478908189, 1.1464387464387464, 1.013406292749658, 1.0666666666666667, 1.0907770515613653, 1.0614406779661016, 1.2692307692307692, 1.0254957507082152, 1.128440366972477, 1.028880259295499, 1.0521534281751173, 1.049898818231991, 1.1944444444444444, 1.1935483870967742, 1.1293375394321767, 1.0, 1.0193016588163015, 1.0446316285192896, 1.0557949108566804, 1.0613822442456002, 1.0965712488203838, 1.1506196377502382, 1.5714285714285714, 1.1758366420873512, 1.0, 1.2040990606319386, 1.25, 1.0276012996728487, 1.0391304347826087, 1.103396388650043, 1.1106719367588933, 1.0461796809403863, 3.0, 1.3015630956919557, 1.004554538696823, 1.08529519955858, 2.0, 1.2063492063492063, 1.3310940499040307, 1.2747252747252746, 1.1276873238251504, 1.2203742203742203, 1.1666666666666667, 1.1691113028472822, 1.019024470049314, 1.1038048740292112, 1.0920003075326272, 1.1776315789473684, 1.142620232172471, 1.4015151515151516, 1.6666666666666667, 1.100558659217877, 1.5, 1.2278056951423786, 1.0606060606060606, 1.1006359633796912, 2.272727272727273, 1.092226094862858, 1.1059306741824055, 1.0752621838371377, 1.0, 1.2258064516129032, 1.16, 1.2853998899614865, 1.3063457330415755, 1.0, 1.0342955130037153, 1.0855350402937876, 1.0820555325321177, 1.5, 3.0, 1.0124271844660193, 1.0099547511312217, 1.042622950819672, 1.1111111111111112, 1.0732890230195324, 1.0817160367722165, 1.4705882352941178, 1.130809792843691, 1.0454545454545454, 1.0564304461942258, 1.0040322580645162, 1.3487589398401347, 1.015785546179898, 1.0, 1.0571428571428572, 1.0300833206577769, 1.045706292801643, 1.0308904087387767, 1.0, 1.0847157708471578, 1.0145091227874325, 1.0220010476689365, 2.0, 1.0506379585326955, 1.027053163455262, 1.007444536718472, 1.0770608536105892, 1.0140033421074677, 1.0734423122482823, 1.0100840336134453, 1.134522661523626, 2.0, 1.0428962737092355, 1.7619047619047619, 1.0, 1.1191709844559585, 1.1153846153846154, 1.0061764411696061, 1.0670897552130554, 1.0618536995622838, 1.0532354290959156, 1.0868401759530792, 1.0792641688083322, 1.052671729255522, 1.0729166666666667, 4.0, 1.0058672428279918, 1.178744939271255, 1.0449445516196607, 1.0426429825150343, 1.1352105530187722, 1.070644718792867, 2.2717391304347827, 2.4285714285714284, 1.016519619368171, 1.0676857598074716, 1.0116021427970419, 1.1549242424242425, 1.0613430389510219, 1.056644880174292, 1.07964880094352, 1.0199568500539373, 1.2284820031298904, 3.0, 1.0909090909090908, 1.063621533442088, 1.0741444866920151, 1.047451669595782, 1.2014285714285715, 1.0333333333333334, 1.3916083916083917, 1.148905109489051, 1.0963855421686748, 1.1243367704474923, 1.313953488372093, 1.0240629484207704, 2.0, 1.2275132275132274, 1.024390243902439, 1.5161290322580645, 1.1268156424581006, 1.0493685419058554, 1.0140280561122244, 1.1037613488975357, 1.0055684840425532, 1.0, 1.297872340425532, 1.1666666666666667, 1.0, 1.1704545454545454, 1.125, 1.0138888888888888, 1.1262135922330097, 1.0616789490547902, 1.0081206496519721, 1.0911911481599164, 1.1572341396622547, 1.037837837837838, 1.1047006029709439, 1.0216216216216216, 1.0945595854922279, 1.0522496371552976, 1.0399175894926602, 1.1835260115606936, 1.1202780296161983, 1.0434297876653322, 1.1612650194316683, 1.0766815773012144, 2.0, 1.0687960687960687, 1.0766169154228855, 1.4074074074074074, 1.0, 1.186046511627907, 1.3636363636363635, 1.0216998191681737, 1.2592592592592593, 1.1666666666666667, 1.015809500429606, 1.1271132120823653, 1.0316614501151091, 1.031692882728547, 1.2, 1.1243169398907105, 1.0, 1.0921985815602837, 1.045952964940124, 1.023082848566951, 1.0824720815703683, 1.0497209249345028, 1.0186871630482297, 1.1142857142857143, 1.1154149705076015, 1.1438721136767318, 1.005501318963768, 1.0995030026920687, 1.2727272727272727, 1.079484425349087, 1.0, 1.2387640449438202, 1.2062564102564102, 3.0, 1.1449579831932772, 1.034518992152742, 1.4285714285714286, 1.0080615876243737, 1.2, 1.1176470588235294, 1.0659097600193252, 1.6153846153846154, 1.024116843720919, 1.0320375907731738, 1.3571428571428572, 1.0740740740740742, 1.1463917525773195, 1.0167384026781445, 1.0373253950080146, 1.0528051758586787, 1.1541694584881526, 1.0, 1.020312839452531, 1.103658536585366, 2.0, 1.0309753903637244, 1.0950860801107363, 1.174077578051088, 1.0209430418033048, 1.0320533886094188, 1.0761904761904761, 1.5714285714285714, 1.047410358565737, 1.0064516129032257, 1.1095311625065754, 1.1079083518107908, 1.007550040631898, 1.0036918875994372, 1.2032967032967032, 1.0966952264381884, 1.234113712374582, 1.0689550587857486, 1.0750788643533122, 1.0525362318840579, 1.094882116158712, 1.0594359160096212, 3.0, 1.1601678934241741, 1.0635479437572681, 1.0264586781984157, 1.4615384615384615, 1.2937092070545757, 1.3219512195121952, 1.1428571428571428, 1.1038301474218806, 1.0420575865415722, 1.138646288209607, 1.0588235294117647, 1.3333333333333333, 1.0551698281891002, 1.5, 1.014018691588785, 1.0833333333333333, 1.0401228106901124, 1.44, 1.1476793248945147, 1.0157232704402517, 1.0, 1.6719576719576719, 1.3158347676419966, 1.25, 2.0, 1.0991735537190082, 1.186206896551724, 1.0625394819962097, 1.2140127388535031, 1.064891846921797, 1.224188790560472, 1.1014466214978942, 1.0571428571428572, 1.1238532110091743, 1.110204081632653, 1.0, 1.0, 1.1032186459489457, 1.0808080808080809, 1.03862660944206, 1.0095178328626713, 1.1259552769399597, 1.0100672542712728, 1.0812335102125514, 1.2117192018507807, 1.1589958158995817, 1.0053989202159568, 1.5714285714285714, 1.0, 1.2592592592592593, 1.0278515595355544, 1.0370697263901147, 1.107843137254902, 1.100271002710027, 1.0058376219371687, 1.050420168067227, 1.0145551943733937, 1.1304347826086956, 1.2222222222222223, 1.0344563552833077, 1.0402306468716862, 1.0451403334720133, 1.0095428171136283, 1.0, 1.0916272888363852, 1.0250299510168182, 1.2436305732484076, 1.3716904276985744, 1.125, 1.06388088376561, 1.8271604938271604, 1.1304347826086956, 1.1613924050632911, 1.0701001430615165, 1.0, 1.0977443609022557, 1.0428901519623552, 1.0384615384615385, 1.0565758364578606, 1.0260869565217392, 1.2647058823529411, 1.0616221639141843, 1.0336697909156454, 1.0691982272361, 1.041030534351145, 1.0184971098265896, 1.1951638433300777, 1.140529531568228, 1.1428571428571428, 1.0, 1.25, 1.0661983771345525, 1.3333333333333333, 1.2819345169471985, 1.0902482364977653, 1.0334249084249085, 1.0923535253227408, 1.050449508155896, 1.0612004287245445, 1.03584229390681, 1.0097087378640777, 1.0156592830023086, 1.0853018372703411, 1.0428977073897436, 1.2337408165723232, 1.6666666666666667, 1.0158730158730158, 1.0765957446808512, 1.0647509445734689, 1.009771986970684, 1.2857142857142858, 1.029143897996357, 2.1923076923076925, 1.0015778516381169, 1.0671140939597314, 1.0842224880382776, 1.125, 1.0897441931612266, 1.0343209855404978, 1.3345607574960547, 1.0581052631578947, 1.125, 1.2436750998668442, 1.2181818181818183, 1.5625, 1.080498742207153, 1.5769230769230769, 1.0344108446298228, 1.0859188544152745, 1.0451786918408632, 1.0193635292136722, 1.0119047619047619, 2.75, 1.0926829268292684, 1.1023199382330233, 1.0478693260736707, 1.0131927107004775, 1.0360657400831896, 1.0769894746113533, 1.0833333333333333, 1.0894239036973346, 1.0017581558898223, 1.0062443845462714, 1.0300601202404809, 1.0069444444444444, 1.0554553651938683, 1.0457159773323184, 1.4008138351983723, 1.0297526006575757, 1.0, 1.3333333333333333, 1.0527924052510569, 1.0255411255411255, 1.2073826748284178, 1.104438884255398, 1.0726256983240223, 1.1479591836734695, 1.097140491468788, 1.0988763300076236, 1.125, 1.0451977401129944, 1.0617100371747212, 1.0840205173513964, 1.0952380952380953, 1.75, 1.0595265481393845, 1.179932039469385, 1.0372560615020698, 1.0511363636363635, 1.222302679217958, 1.01722308671665, 1.154343547933652, 1.4760147601476015, 1.3461538461538463, 1.047843665768194, 1.0919540229885059, 1.14375, 1.5925925925925926, 1.0404514470890602, 1.2051536174430129, 1.1683250414593698, 1.024390243902439, 1.0374962383388504, 1.0121014214368036, 1.0717202141900937, 1.289859378094672, 1.3333333333333333, 1.0769230769230769, 2.0, 1.130964820619993, 1.3846153846153846, 1.0, 1.25, 1.0609271523178807, 1.0742753623188406, 1.0369167053447106, 1.0186062356032832, 1.0636363636363637, 1.36, 1.0666666666666667, 1.064516129032258, 1.0810810810810811, 1.042857142857143, 1.0789915966386554, 1.0242396817570898, 1.0296092909354013, 1.3333333333333333, 1.0767115980386122, 1.0474100395375607, 2.5, 1.0682862100643054, 1.238938053097345, 3.0, 2.0, 1.1642011834319526, 1.1275909058308828, 1.05484855717893, 1.2515527950310559, 1.0, 1.167420814479638, 1.116564417177914, 3.0, 2.0, 1.03125, 1.1890038983734372, 1.0294889416468824, 2.0, 1.0127228679897735, 1.04570100697134, 1.0295670538542767, 1.1428571428571428, 1.107981220657277, 1.026747011237196, 1.105263157894737, 1.1633929135350218, 1.0255813502453404, 1.3709677419354838, 1.0234375, 1.0265691944401238, 1.094392523364486, 1.0909090909090908, 1.1694915254237288, 1.0441544380008694, 1.4246384387523958, 1.0850426836599736, 1.3046875, 1.1372549019607843, 1.3582089552238805, 1.0852503382949932, 1.0673379483952172, 1.0262537900516266, 1.0676451427476528, 1.0403930131004366, 1.5, 1.6666666666666667, 1.0669308956082593, 1.160510114335972, 1.1593075277183427, 1.0183294264920657, 1.0081953503930423, 1.1276422415641212, 1.0475059382422802, 1.0434782608695652, 1.1021932238031602, 1.111750323601323, 1.2721139430284858, 1.0823117338003503, 2.5, 1.0135135135135136, 1.0179244930729303, 1.1268174474959611, 1.056443638760712, 1.103429996610847, 1.0007102272727273, 2.0, 1.1116883116883116, 1.047609695233254, 1.166780900159927, 1.2623574144486691, 1.093632289133648, 1.0636942675159236, 1.1666666666666667, 1.0139130434782608, 1.0318407310231203, 1.0608216179813115, 1.0368663594470047, 1.0371845949535192, 1.0, 1.260527732902531, 1.0580948898436786, 1.0039787798408488, 1.0781237511275534, 1.141677255400254, 1.0287443267776097, 1.2857142857142858, 1.2170542635658914, 1.6666666666666667, 2.0, 1.1764705882352942, 1.0051413881748072, 1.0576619273301737, 1.0110290021909465, 1.0065694367221247, 1.0281808035714286, 1.0073761854583771, 1.201086956521739, 1.1395348837209303, 1.0577663671373556, 1.6, 1.5833333333333333, 1.100572655690766, 1.0, 1.037292817679558, 1.1162904808635918, 1.0162117603956768, 1.09061693528753, 2.0, 1.0446313065976713, 1.2170542635658914, 1.0009975062344139, 1.0403038615741718, 1.1388888888888888, 1.1345890410958903, 1.1428030977390067, 1.1204485170002412, 1.0429252782193958, 1.0441176470588236, 1.0726256983240223, 1.0, 1.0, 1.0417367046958264, 5.0, 1.5714285714285714, 2.4545454545454546, 1.034981905910736, 1.0930232558139534, 1.079268292682927, 1.103962338171832, 1.0, 1.0720049658597144, 1.0134345794392523, 1.1989247311827957, 1.2836538461538463, 1.4285714285714286, 1.048314216197428, 1.0936807095343681, 1.1469933184855234, 1.0702863518036445, 1.028469703568021, 1.0766039556198745, 1.1821946169772257, 1.0, 1.303930278800186, 1.05068054046002, 1.0305326398852224, 1.1774193548387097, 1.06125050999592]
origin-bjaq_15.71 	max: 5.0000	99th: 3.0000	95th: 1.6759	median: 1.0793	mean: 1.1775

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 13.916674 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[1.6093254e-06 1.8477440e-06 4.7683716e-07 1.1920929e-07 1.1920929e-07]
Distance score: 8.344650268554688e-07
SAUCE Drift detection: False
Detection latency: 0.0231s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.050996 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 7.0000	99th: 2.7280	95th: 1.7525	median: 1.0810	mean: 1.1822
ReportEsts: [1.0837837837837838, 1.0015128593040847, 1.048927416099903, 1.0771869639794167, 1.4583333333333333, 1.0, 1.040142412105029, 1.0704070845882283, 1.2, 1.027382256297919, 1.0810160685076493, 1.042191381338384, 1.0667910447761193, 1.178294573643411, 1.034107615407233, 1.1657458563535912, 1.1779935275080906, 1.0769230769230769, 1.2727272727272727, 1.1048720066061106, 1.0588748364587877, 1.0496806666238583, 1.1566265060240963, 1.0279661016949153, 1.0243373836424359, 1.0363965974062195, 3.0, 1.1315448495199953, 1.2, 1.1666666666666667, 1.0649477806788512, 1.0, 1.0457683372054432, 1.0106966812860625, 1.0346260387811634, 1.0766499326558099, 1.2379704371527414, 1.1328976034858387, 1.3333333333333333, 1.0563154539659412, 1.0479976728401048, 1.1381829733163913, 1.1603650586701435, 1.1430868167202572, 1.0036764705882353, 1.0026932826362485, 1.0434782608695652, 1.0257898130238556, 1.3316326530612246, 1.006064690026954, 1.6, 1.2270742358078603, 1.0534979423868314, 1.0303030303030303, 1.0238554275673566, 1.0102658486707567, 1.0494570002935133, 1.2542857142857142, 1.1111111111111112, 1.0271712934035526, 1.3235294117647058, 1.1310626074020877, 1.0615615615615615, 1.0892857142857142, 1.0404040404040404, 2.0, 1.1963958987813719, 1.3069730162970878, 1.75, 1.0, 1.0184006211180123, 1.0324543610547667, 1.0699368625546382, 1.0075901328273245, 1.0576080386823814, 1.1083815028901733, 1.26578073089701, 1.2981366459627328, 1.5048543689320388, 1.0970345482433717, 1.011181332036947, 1.4285714285714286, 1.0, 1.4615384615384615, 1.1277330264672036, 1.0307692307692307, 1.2222222222222223, 1.1717171717171717, 1.0, 1.0983876643526664, 1.1111277969665114, 1.2459404414597897, 1.1278131960980107, 1.1825041922861934, 1.116094986807388, 1.0235017626321974, 1.1439322671683914, 1.0272020725388602, 1.8, 1.2013476020610385, 1.0, 2.0, 1.0563059993867747, 1.322179322179322, 1.054054054054054, 1.2149880224534306, 1.2424242424242424, 1.0156014737343768, 1.046854377474703, 1.3178766166463882, 1.1362776025236594, 1.0452810989570085, 1.125, 1.25, 1.057500488949736, 1.1018221095144172, 1.049973698053656, 1.0210526315789474, 1.0528738031255707, 2.0, 1.1032393995259415, 1.1522935779816514, 1.0, 1.0277777777777777, 1.1428571428571428, 1.1589958158995817, 1.026847517186892, 1.0761312876286657, 1.1666666666666667, 1.6666666666666667, 1.1644599303135887, 1.0, 1.1428571428571428, 1.127396755162242, 1.3846153846153846, 1.0763358778625953, 1.0181901988780087, 1.071032147718943, 1.25, 1.7142857142857142, 1.0911111111111111, 1.010752688172043, 1.067410035478966, 1.0456936272772384, 1.1719745222929936, 1.0133630289532294, 1.097292587038463, 1.5, 1.0041183077499063, 1.026061776061776, 1.1059564719358534, 1.1242071101932438, 2.0, 1.3637282652648606, 1.0465994962216625, 1.0452961672473868, 1.875, 1.0, 1.0442571127502633, 1.0986996323438696, 1.2443062245709209, 1.085763293310463, 1.0810055865921788, 1.3333333333333333, 1.4491525423728813, 1.008641975308642, 1.5, 1.0644023726980694, 2.5, 1.126027397260274, 1.027094662487644, 1.0679824561403508, 1.0096473859375659, 1.3356890459363957, 1.0846153846153845, 1.070067807555699, 1.0223214285714286, 1.043041606886657, 1.0620915032679739, 1.0201654601861427, 1.0000975609756098, 1.2301254132339823, 1.116564417177914, 1.3932584269662922, 1.0087954853231405, 1.0683498884172757, 1.2943262411347518, 2.9690721649484537, 1.0069444444444444, 1.5714285714285714, 1.2591549295774649, 1.0617002416253234, 1.2727272727272727, 1.136386512330146, 1.1311154598825832, 1.037801614484103, 1.081213194257342, 1.0256663376110562, 1.0290014221678159, 1.0554149317200967, 1.0077741407528642, 1.00052256354746, 1.0764482431149098, 1.0592866591155714, 1.072872590503056, 1.1020515058926232, 1.067632850241546, 1.0724637681159421, 1.2345679012345678, 1.0, 1.4402985074626866, 1.2102628285356696, 1.2745664739884393, 1.1296296296296295, 1.0077836952068824, 1.0666666666666667, 1.0434472908849548, 1.0745920745920745, 1.2073004957620341, 1.0, 1.0253012048192771, 1.0105263157894737, 1.0396488416318816, 1.027693817468106, 2.5, 1.0748945147679325, 1.1706165023863022, 1.0308791875931342, 1.0209424083769634, 1.0231788079470199, 1.0725326991676576, 1.1109948704103672, 1.4188034188034189, 1.0056497704268585, 1.0675479372457872, 1.1214953271028036, 1.2621885157096424, 1.0335570469798658, 1.8181818181818181, 1.177792465300727, 1.0, 1.1773033186354143, 1.0691578360290017, 1.047683659623958, 1.186131386861314, 1.0714285714285714, 2.0, 1.118532620634107, 1.1384615384615384, 1.174085126433171, 1.2, 1.1160409556313993, 1.1618828932261769, 1.5714285714285714, 1.0283672824885521, 1.0956937799043063, 1.08, 1.0226244343891402, 1.0194897236002836, 1.1592378250286137, 1.0895522388059702, 1.0, 1.0831963282641457, 1.1238517376501573, 1.175257731958763, 1.006673088711796, 1.1440344135914353, 1.0221800365712372, 1.1207471647765177, 1.0745011737089203, 1.0328780981284775, 1.0694683660581008, 1.0517500536826283, 1.0769230769230769, 1.0434533064793847, 1.1154598825831703, 1.2307692307692308, 1.2173913043478262, 2.727272727272727, 1.127906976744186, 1.0357238212206974, 1.0480758668668302, 1.1647597254004576, 1.4071729957805907, 1.0278708467951019, 1.0987306064880114, 1.1387882362854975, 1.0482507423904974, 1.3333333333333333, 1.090625, 1.1126760563380282, 1.0550506785275573, 1.0247387235275598, 1.0569558894813378, 1.2549333333333332, 1.1654514862591139, 1.0702841273232215, 1.0223270333548233, 1.0891642765661922, 1.0472114208769012, 1.0264116575591986, 1.8571428571428572, 1.25, 1.0977636748262314, 1.1666666666666667, 1.0364963503649636, 1.0202733835048379, 1.028809393773894, 1.325, 1.0168067226890756, 1.1074380165289257, 1.0179651062359647, 1.0703818090093637, 1.25, 1.2108026131591227, 1.0119838094259375, 1.054245283018868, 2.0, 2.4, 1.0008602150537635, 1.4285714285714286, 1.0029179956917216, 1.0304, 1.0476190476190477, 1.0886377088740153, 1.24, 1.4166666666666667, 1.0220063448693528, 2.0, 1.310077519379845, 1.028811524609844, 1.0572220169929811, 1.0546461242176215, 1.1328320802005012, 1.2043010752688172, 1.0980195904229597, 1.0814794290966103, 1.0112359550561798, 1.0418727285683747, 1.0197450340942782, 3.0, 1.3, 1.0528673749892992, 1.5, 1.0590697674418605, 1.173913043478261, 4.0, 1.5555555555555556, 1.3190436933223413, 1.0482490272373541, 1.2740740740740741, 1.0618066561014263, 1.3421052631578947, 1.6666666666666667, 1.0106094387420532, 1.5833333333333333, 1.1666666666666667, 1.0000733252512612, 1.0748031496062993, 1.0498866213151927, 1.013346043851287, 1.75, 1.25, 1.3072625698324023, 1.1428571428571428, 1.0968443960826986, 1.1311572629905944, 1.220328516734593, 1.0829015544041452, 1.3333333333333333, 1.0249133820701612, 1.4183673469387754, 1.6, 1.0, 1.1487603305785123, 1.2857142857142858, 1.2079831932773109, 1.3444444444444446, 1.1562400684512897, 1.1016736249773098, 1.0259815242494226, 1.1477372103191954, 1.1223634396971336, 1.079429735234216, 1.096774193548387, 1.0981409261292643, 1.1212624584717608, 1.2, 1.0055056409088103, 1.0681947123567457, 1.02008870336551, 1.0594059405940595, 1.1, 1.0932038834951456, 2.0, 1.0208333333333333, 1.3703703703703705, 1.1412429378531073, 1.3942307692307692, 1.1033333333333333, 1.0731707317073171, 1.1559006211180125, 1.078246966989561, 1.076425855513308, 1.019655128259849, 1.25, 1.173913043478261, 1.1007751937984496, 1.0, 1.1123575558786731, 1.64, 1.1049903886020127, 1.0936631034723678, 1.0658373529660659, 1.1636849132176235, 1.375, 1.3065460351250666, 1.1428571428571428, 1.1237541528239203, 1.3, 1.1666666666666667, 1.0316686967113275, 1.1036371800628648, 1.0996784565916398, 1.0671428571428572, 3.0, 1.169318181818182, 1.0168287450380895, 1.1174360843130862, 2.0, 1.1139240506329113, 1.276190476190476, 1.475177304964539, 1.1117698041254984, 1.1217884551217885, 1.0833333333333333, 1.2241758241758243, 1.0180096289105065, 1.0750383870752387, 1.0073216738300934, 1.0882414043835047, 1.0150851581508515, 1.0062893081761006, 1.0127562642369021, 1.0475475926092654, 1.076271186440678, 1.0689655172413792, 1.0, 1.0, 1.2588005215123859, 1.037313432835821, 1.0351123595505618, 1.1719179651695693, 1.0847545219638244, 1.0, 1.075, 1.0303030303030303, 1.2864493996569468, 1.173913043478261, 1.0, 1.040293228071974, 2.0, 1.0, 1.0157813702848344, 1.5, 1.0064246707356248, 1.0045696877380046, 1.0381471389645776, 1.2, 1.0745483598916952, 1.0640809443507588, 1.55, 1.0260603768828387, 1.0866141732283465, 1.0903010033444815, 1.0303030303030303, 1.3744227353463587, 1.0517267380485598, 1.0, 1.0963855421686748, 1.0677770067083043, 1.157676348547718, 1.0356859635210152, 1.4, 1.123006416131989, 1.0175284502124702, 1.038598047914818, 2.0, 1.0459885867740852, 1.0294536241685257, 1.056928324295144, 1.0202075568223343, 1.0248660331324295, 1.0059763455061432, 1.01931330472103, 1.0750050627784529, 2.25, 1.0199627592777032, 1.0127167630057803, 1.0292565947242207, 1.0298013245033113, 1.0561497326203209, 1.0097355798453005, 1.2723577235772359, 1.0898512839313323, 1.0863531225905936, 1.092965390129019, 1.1820873427091043, 1.104858380208074, 1.0778937880267407, 1.0113636363636365, 1.03125, 1.0880950420811986, 1.0754310344827587, 1.012127188890962, 1.0676147854468272, 1.0, 1.0956719817767653, 1.0571428571428572, 1.4285714285714286, 1.1, 1.0192970854897503, 1.1563636363636363, 1.0249424405218726, 1.0, 1.1764705882352942, 1.0144594904750976, 1.1459542244533312, 1.022585383767903, 1.0464759959141983, 1.112284820031299, 1.0975609756097562, 1.030549898167006, 1.0440196797457524, 1.4886363636363635, 1.0341642365204442, 1.079746835443038, 1.2099447513812154, 1.0465400853407987, 1.062015503875969, 1.0490631416837783, 4.0, 1.1151515151515152, 1.0966666666666667, 1.123285230714413, 1.1364653243847875, 1.0170454545454546, 1.0404929577464788, 1.0367892976588629, 1.1290807006533603, 2.0, 1.3448275862068966, 1.1666666666666667, 1.0, 1.1636363636363636, 1.9642857142857142, 1.0051948051948052, 1.0826771653543308, 1.0642226384800642, 1.224847250509165, 1.0707938886934711, 1.1583856843708358, 1.034718492867416, 1.127279928504692, 1.0112461220268874, 1.1482313307130825, 1.198137609932747, 1.0477670681724176, 1.0118343195266273, 1.084061135371179, 1.2602179836512262, 1.5081967213114753, 1.0184938421158893, 1.1314285714285715, 1.1013465627214742, 1.2596685082872927, 1.1822790922259778, 1.1067503924646782, 1.0, 1.013953488372093, 1.105263157894737, 1.1111111111111112, 1.3478260869565217, 1.0407786214315784, 1.0423440453686201, 1.0, 1.0552486187845305, 1.07945670181713, 1.0554177765530754, 1.0490018148820326, 1.0, 2.0, 1.031755674600983, 1.1461187214611872, 1.0641434262948206, 1.107521810893657, 1.0, 1.4019354838709677, 1.075268817204301, 1.1097314915412075, 1.1343283582089552, 1.0133335821522211, 1.0152218442861707, 1.014840734536655, 1.3548387096774193, 1.2857142857142858, 1.1559545309678105, 2.0, 1.0346020761245676, 1.2118644067796611, 1.2617874736101338, 1.138124362895005, 1.6956521739130435, 1.0267998895561539, 1.1347517730496455, 1.1386138613861385, 1.0132905674015178, 1.193654990085922, 1.2454346238130023, 1.048029798078808, 1.0145454545454546, 1.0746527777777777, 1.0, 1.0641587023569279, 1.0409158149542765, 1.0454545454545454, 1.0061307901907357, 1.2831720262254136, 1.2805429864253393, 1.0267079455912484, 1.4444444444444444, 1.0088652482269505, 1.0805867970660146, 1.046189376443418, 1.1284916201117319, 1.1147847202764547, 1.094488188976378, 1.6, 1.084166954122111, 1.008789722785666, 1.1003771026651412, 1.1796977660972405, 1.0063308267769808, 1.1266648907831647, 1.2646616541353384, 1.1485532815808046, 1.1515151515151516, 1.065922920892495, 1.0670859538784068, 1.0022388059701492, 1.0273348519362187, 1.94, 1.0650759219088937, 1.033587538536427, 1.2, 1.0, 1.08, 1.5947035118019575, 1.0664576802507837, 1.028735632183908, 1.0, 1.0491935483870967, 1.0212536023054755, 1.1607142857142858, 1.0703857184022394, 2.3333333333333335, 1.1123811046279275, 1.5, 1.0357815442561205, 1.1333333333333333, 1.0409539377663612, 1.4333333333333333, 1.1317567567567568, 1.0497000856898029, 1.0, 1.0083381623849077, 1.2929936305732483, 1.2, 2.0, 1.1063829787234043, 1.1671469740634006, 1.0030143180105502, 1.2027168234064787, 1.1024182076813656, 1.1026360067302299, 1.047979797979798, 1.0743338008415146, 1.1673306772908367, 1.1013986013986015, 1.1818181818181819, 1.0, 1.2262996941896025, 1.0952941176470588, 1.0166374781085814, 1.0376228775692582, 1.0714989495414997, 1.0863828355698426, 1.091894395553497, 1.1721134206415955, 1.1843971631205674, 1.0132315521628499, 1.3333333333333333, 1.0, 1.2727272727272727, 1.027451773058605, 1.0514327700220427, 1.1368715083798884, 1.0124223602484472, 1.0163539553752536, 1.0596951385357662, 1.0070558558742941, 1.2023809523809523, 1.1428571428571428, 1.0518793012175753, 1.0083554670208057, 1.0304872432532006, 1.0481665954029098, 1.005181347150259, 1.1020697301958853, 1.012453888447737, 1.0584894284106439, 1.0842824601366743, 1.0728378346650806, 1.1149825783972125, 1.0512922465208747, 1.1042524005486969, 1.0313461491871987, 1.0, 1.2661498708010337, 1.0, 1.015267175572519, 1.033324049575268, 1.0153846153846153, 1.1194196058675752, 1.0070546737213404, 1.146341463414634, 1.0255168695435788, 1.0416641688148192, 1.1159648284967834, 1.0159744408945688, 1.0057251908396947, 1.1937275583482945, 1.2141560798548094, 1.25, 1.0, 1.5714285714285714, 1.059402545535228, 1.4285714285714286, 1.1115956628933485, 1.0934286290412922, 1.0204986149584487, 1.0639449090014756, 1.0215570083078713, 1.0040398599515217, 1.0771604938271604, 1.0718424101969872, 1.0105324980422865, 1.0788148495139946, 1.0452510440136944, 1.1604656413858851, 1.5, 1.368421052631579, 1.024390243902439, 1.076804272517321, 1.0161725067385445, 1.2737855383926573, 1.018045112781955, 2.115107913669065, 1.0822400949304503, 1.0700564971751412, 1.0611585736644302, 1.1578947368421053, 1.0904343732992072, 1.0188050648214204, 1.2711092715231789, 1.0523560209424083, 1.2058823529411764, 1.119496855345912, 1.057860952897568, 1.035298996698196, 1.0125, 1.0200186128526645, 1.1111111111111112, 1.0451100154536759, 1.01213282247765, 1.0326633165829147, 1.0844954881050042, 1.0045454545454546, 1.0646153846153845, 1.0527613412228798, 1.0199562880912467, 1.064053537284895, 1.0320593729489573, 1.0715141246238788, 1.2857142857142858, 1.0819554277498202, 1.0455549889512155, 1.088667831697809, 1.0244252873563218, 1.1140939597315436, 1.1479229989868287, 1.0731707317073171, 1.0443896424167693, 1.045726587071361, 1.1326530612244898, 1.1273809523809524, 1.2542269301283357, 1.0348936170212766, 1.0541871921182266, 1.090585107234956, 1.163248311383894, 1.0431654676258992, 1.1443736730360934, 1.1049102563050384, 1.0830677887626985, 1.1157407407407407, 1.17, 1.047239263803681, 1.1087860126433613, 1.1443298969072164, 1.75, 1.0482047571674054, 1.1714266377910125, 1.0333824251350026, 1.0236966824644549, 1.2473476811154895, 1.0085173206925941, 1.1624708624708624, 1.184873949579832, 1.0857142857142856, 1.0316842690383548, 1.0320512820512822, 1.1635883905013193, 1.7272727272727273, 1.0588700891152725, 1.1750814332247557, 1.0093537414965987, 1.0, 1.0414239482200647, 1.0479485912011863, 1.0192307692307692, 1.2121212121212122, 1.0391304347826087, 1.0, 1.0798611111111112, 1.0769230769230769, 1.0074577758280325, 1.1250868658790827, 1.1114384526706802, 1.2695652173913043, 1.4166666666666667, 1.2875662934590453, 1.061774240187499, 1.0275892151249966, 1.1914893617021276, 1.2923076923076924, 1.411764705882353, 1.0, 1.0, 1.0112359550561798, 1.0616658996778647, 1.0316620612418326, 1.0284498713143853, 1.2905982905982907, 1.0707714043193173, 1.0458116981807735, 3.0, 1.0967018021081265, 1.189438202247191, 2.5, 2.25, 1.188249694002448, 1.0533420942596021, 1.0383111322059082, 1.1709183673469388, 1.0, 1.1401515151515151, 1.4768041237113403, 1.2727272727272727, 1.0490058291988154, 1.0911312465678198, 1.0231261737808413, 1.0162059103908485, 1.8571428571428572, 1.0275238197801948, 1.0246056782334385, 1.014443500424809, 1.8571428571428572, 1.025522041763341, 1.0, 2.8, 1.1231209735146743, 1.0418139842753589, 1.161839863713799, 1.1414473684210527, 1.0637266868469877, 1.0515309932785661, 1.0756013745704467, 1.2307692307692308, 1.0559320298904697, 1.5109873104302074, 1.0403817138683606, 1.3529411764705883, 1.0806451612903225, 1.0889235569422777, 1.375, 1.0696125907990315, 1.0465116279069768, 1.0035889593251277, 1.0613333333333332, 1.5, 1.0288634996993384, 1.003116260487415, 1.163220892274211, 1.1903839948370443, 1.0000566131200905, 1.0192334111828547, 1.1032766777641494, 1.0204841713221602, 1.0892857142857142, 1.0330632514375326, 1.1382744119256019, 1.2315598548972189, 1.0441400304414004, 2.0, 1.0227272727272727, 1.0188585607940446, 1.073094867807154, 1.0078137270299985, 1.1052944978178623, 1.0046296296296295, 1.8, 1.036734693877551, 1.0132859229857494, 1.191028321611861, 1.0743034055727554, 1.063452041196178, 1.1031746031746033, 1.3465703971119134, 1.0078392944634982, 1.0305025116515243, 1.052550239099595, 1.0018975332068312, 1.04581901489118, 1.027027027027027, 1.1872621162141588, 1.1058499855198378, 1.0414576535333366, 1.0303691580287324, 1.11088295687885, 1.0018691588785047, 3.25, 1.2190889370932756, 2.0, 2.0, 1.0909090909090908, 1.0278372591006424, 1.0506578947368421, 1.0219509109311742, 1.0294242401559788, 1.1372549019607843, 1.0410562488695967, 1.2394366197183098, 1.076555023923445, 1.0595683705696572, 1.8333333333333333, 1.1578947368421053, 1.2900175131348512, 1.1111111111111112, 1.0202702702702702, 1.1212748344370862, 1.0062726723095525, 1.0990764574339433, 2.5, 1.021511017838405, 1.0706231454005934, 1.1178993717853822, 1.0382649067813112, 1.1968253968253968, 1.1333333333333333, 1.1418859934248407, 1.14655661594016, 1.0148048452220726, 1.0759493670886076, 1.0895348837209302, 1.3333333333333333, 2.0, 1.0402947305745758, 7.0, 1.2, 2.2903225806451615, 1.0573248407643312, 1.065064400478024, 1.0676818950930627, 1.0038461538461538, 1.3333333333333333, 1.1401466870050359, 1.0145278450363195, 1.222841225626741, 1.308316430020284]
origin-bjaq_15.71 	max: 7.0000	99th: 2.7280	95th: 1.7525	median: 1.0810	mean: 1.1822

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.187550 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.206816