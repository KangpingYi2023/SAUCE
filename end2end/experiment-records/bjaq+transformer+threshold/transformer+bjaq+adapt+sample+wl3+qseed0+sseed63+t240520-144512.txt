Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 63, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.5000	95th: 1.7751	median: 1.0811	mean: 1.1754
ReportEsts: [1.0824742268041236, 1.0119791666666667, 1.0243262011197432, 1.04, 1.5, 1.0, 1.0901960784313725, 1.041248009535605, 1.0, 1.0372836218375499, 1.1592647101261073, 1.0427226745286846, 1.0334201388888888, 1.0906976744186045, 1.0105969622041682, 1.0, 1.1538461538461537, 1.0046050301098122, 3.0, 2.0, 1.0384615384615385, 1.0548705582601574, 1.0794652708285224, 1.1344685848502643, 1.0917612234829799, 1.0, 1.1451912763675367, 2.0, 1.2, 1.0220588235294117, 1.0, 1.0423468128613735, 1.0037153683381723, 1.1109877913429522, 1.0008811866647085, 1.2290219245330116, 1.1818181818181819, 1.0176531928458112, 1.104483779874647, 1.0476190476190477, 1.2420382165605095, 1.0426829268292683, 1.0, 1.056471072920958, 1.1381671348314606, 1.8615384615384616, 1.03, 1.2367491166077738, 1.036885545842651, 1.0925925925925926, 1.0436717453612914, 1.1580756013745706, 1.041270953077467, 2.0, 1.0078534031413613, 1.1481348379213685, 1.3095238095238095, 1.3592233009708738, 1.0186335403726707, 1.25, 1.1023491457651764, 1.1257783312577834, 1.1181818181818182, 1.0116279069767442, 1.1818181818181819, 1.071267010271052, 1.293968253968254, 1.75, 1.0, 1.07457816724154, 1.0119331742243436, 1.062137049941928, 1.0068027210884354, 1.044042259171756, 1.0776470588235294, 1.0305343511450382, 1.0, 1.109812108559499, 1.6, 1.0367442394329822, 1.2307692307692308, 1.013603139511514, 1.196319018404908, 1.0859277708592776, 1.1388616290480864, 1.0, 1.072899032062134, 1.03703400724553, 1.107843137254902, 1.75, 1.1454823889739663, 1.0579374275782156, 1.0404984423676011, 1.0252454417952315, 1.0252808988764044, 1.0337662337662337, 1.0227272727272727, 1.1603960396039603, 1.0, 1.2213382737576286, 1.0397408207343413, 1.0994854202401372, 1.225417279252789, 1.36, 1.0231057118526363, 1.0199097425006636, 1.3469150818222027, 1.1513083048919226, 1.0380134886572654, 1.1666666666666667, 1.6666666666666667, 1.0869158878504672, 1.0931222487877907, 1.0751737207833227, 1.103896103896104, 1.0581512246000728, 2.0, 1.119520655944497, 1.1334056399132322, 1.0, 1.0167597765363128, 1.0, 1.2431077694235588, 1.0195679625902436, 1.0195697755688438, 1.087378640776699, 1.8, 1.169701986754967, 1.0, 1.1428571428571428, 1.104139616198587, 1.1818181818181819, 1.0432942708333333, 1.0248513129054746, 1.1104539919986085, 1.0333778371161548, 1.0549132947976878, 1.0452065471551053, 1.039972432804962, 1.0694698354661791, 1.018800076227722, 1.2272727272727273, 1.0397912589693412, 1.1192391476311594, 2.0, 1.0264357338195078, 1.0127314814814814, 1.1124913733609385, 1.092288688900653, 1.5, 1.350205860983289, 1.0514018691588785, 1.0224948875255624, 1.1074561403508771, 1.0072992700729928, 1.0090151386290185, 1.1441299472695314, 1.046132075471698, 1.073469387755102, 1.0460526315789473, 1.2857142857142858, 1.3663366336633664, 1.0132547864506627, 1.4285714285714286, 1.0678198673723567, 1.0360277241915683, 1.1526211015262111, 1.3462462751129483, 1.1313061506565307, 1.1155548487980707, 1.2715789473684211, 1.1442307692307692, 1.0801781737193763, 1.1081900910010112, 1.0479204339963835, 1.0845481049562682, 1.0280199252801991, 1.0919705558845927, 1.07034677990092, 1.0, 1.0161290322580645, 1.027701232777375, 1.028907496012759, 1.1571061643835616, 1.2105263157894737, 1.0932481052410332, 1.3361522198731501, 1.1196242668225007, 1.1372549019607843, 1.1881818181818182, 1.1113022645308457, 1.0, 1.0909090909090908, 1.018038012993826, 1.032825322391559, 1.013078000934143, 1.4, 1.0559485530546624, 1.0487213347240991, 1.06158275435424, 1.0626410835214446, 1.0242437019078738, 1.5932203389830508, 1.1428571428571428, 1.2352941176470589, 1.0, 1.3559322033898304, 1.0607159753982023, 1.3275261324041812, 1.1149425287356323, 1.013346515076619, 1.0031277926720286, 1.0470339211078623, 1.0346243480190878, 1.1516080777860882, 1.0864197530864197, 1.0646153846153845, 1.008101101749838, 1.0582026537997586, 1.0190381220915572, 1.0, 1.1022774327122153, 1.128493490634786, 1.0175690611155657, 1.1518131530424094, 1.025138247001309, 1.2755718601640051, 1.0357142857142858, 1.0024846495159556, 1.1669675090252707, 1.006204173716864, 1.037837837837838, 1.3033252230332522, 1.0649903288201161, 1.1307086614173227, 2.0, 1.2554138237911598, 1.0331621259490844, 1.182372245663385, 1.2181818181818183, 1.0, 1.6666666666666667, 1.041961977453791, 1.1090909090909091, 1.079693831607384, 1.5, 1.0, 1.025, 1.029664324746292, 1.1136363636363635, 1.0168539325842696, 1.141350210970464, 1.0834782608695652, 1.0025188916876575, 1.1157546311530941, 1.0350877192982457, 2.0, 1.0536775440544486, 1.0596190199214774, 1.0910683012259195, 1.0120408888517256, 1.1218303037210098, 1.0285598609963056, 1.0993640699523053, 1.0961040790099115, 1.0257177033492824, 1.0351028628974248, 1.0418372569089047, 1.0909090909090908, 1.030871153488948, 1.0426439232409381, 1.2045454545454546, 1.25, 1.0166358595194085, 1.0555555555555556, 1.1025641025641026, 1.138860103626943, 1.1030640668523677, 1.3533834586466165, 1.0333142839955485, 1.0127442650807137, 1.0245889156985304, 1.0649590615517621, 1.1111111111111112, 1.056020371044016, 2.5, 1.0283932122613824, 1.0302375809935205, 1.0411633516908652, 1.0810810810810811, 2.0, 1.6521739130434783, 1.109375, 1.0760906522990008, 1.0, 1.081039755351682, 1.0203619909502262, 1.0052083333333333, 1.0155487663212677, 1.08, 1.150943396226415, 1.000408697792153, 1.1520860495436767, 1.0789609941318605, 1.1282051282051282, 1.0, 1.0990453460620524, 1.2530864197530864, 1.1758241758241759, 1.179949452401011, 1.042535446205171, 1.056338028169014, 1.2553191489361701, 1.0013736263736264, 1.0183178534571724, 1.2857142857142858, 1.0046139956587719, 1.04, 1.0555555555555556, 1.1010015323992994, 1.1428571428571428, 1.5555555555555556, 1.0133096641940869, 2.0, 1.2277091906721536, 1.0305232558139534, 1.0484003281378178, 1.0943708609271523, 1.0992167101827677, 1.123456790123457, 1.119590362423734, 1.0559950666569298, 1.036723163841808, 1.0522887096078346, 1.0213580075135662, 2.0, 1.0, 1.0548344340592792, 1.25, 1.068561872909699, 1.3529411764705883, 1.0, 1.375, 1.3142570281124497, 1.0609184629803186, 1.2772277227722773, 1.0357142857142858, 1.0, 1.2203728362183754, 1.052689594356261, 2.0, 1.2567004169148304, 1.0, 1.0966370606543687, 1.0987654320987654, 1.0501180792442928, 1.1497695852534562, 1.1363636363636365, 1.4440344403444034, 1.25, 1.0172006020210707, 1.0245806909963562, 1.0622347949080622, 1.0, 1.0769230769230769, 1.5714285714285714, 1.5, 1.3333333333333333, 1.069312702756459, 1.3333333333333333, 1.0506993006993006, 1.160919540229885, 1.1584184572032405, 1.0957911533129299, 1.2657054582904221, 1.0245950030699476, 1.011600928074246, 1.0773809523809523, 1.5, 1.032258064516129, 1.097872340425532, 1.0606257826402161, 1.1428571428571428, 1.5714285714285714, 1.0022321428571428, 1.026865671641791, 1.025724257437825, 1.0, 1.1464387464387464, 1.0224350205198358, 1.0810810810810811, 1.0907770515613653, 1.0317796610169492, 1.0384615384615385, 1.0254957507082152, 1.0423728813559323, 1.07200089204645, 1.0703373721589253, 1.0233449745117964, 1.036144578313253, 1.088235294117647, 1.0914634146341464, 1.0, 1.0743039067558817, 1.0529316575867091, 1.0574309826920325, 1.0565874062719094, 1.0978374973756035, 1.1375913568477916, 1.8333333333333333, 1.0247157686604054, 1.0, 1.1955593509820666, 1.25, 1.0536903146771082, 1.010144927536232, 1.0967325881341359, 1.0395256916996047, 1.0232744783306582, 3.0, 1.1731958762886598, 1.0090982537962947, 1.1301039176016185, 2.0, 1.0952380952380953, 1.2360844529750479, 1.3132075471698113, 1.1082902625594377, 1.0145530145530146, 1.2352941176470589, 1.046028880866426, 1.0117792787528923, 1.054120517007338, 1.1121257499681907, 1.155482456140351, 1.1923714759535655, 1.064516129032258, 2.142857142857143, 1.031413612565445, 1.5, 1.2288348700754401, 1.0606060606060606, 1.1519163253364542, 2.0833333333333335, 1.104173049819229, 1.134595885820344, 1.0777297964219616, 1.0, 1.2, 1.2, 1.2852070414082817, 1.1050328227571116, 1.0, 1.0353311400371907, 1.090073305803643, 1.0625777041027766, 1.5, 2.0, 1.014368932038835, 1.006311992786294, 1.0262295081967212, 1.1111111111111112, 1.0755354529732606, 1.0784114052953158, 1.4705882352941178, 1.0392090395480227, 1.0454545454545454, 1.0918635170603674, 1.0024193548387097, 1.3298275136726967, 1.0068308363469376, 1.0, 1.0422535211267605, 1.0599457410177038, 1.06724429591121, 1.0358011085540177, 1.0, 1.0962176509621766, 1.0049381581064265, 1.0225248821372446, 2.0, 1.0546251993620415, 1.0014947507179512, 1.0098406469259127, 1.037350923943908, 1.0269303588333005, 1.03302534944326, 1.0294117647058822, 1.0636451301832208, 2.0, 1.0489947800919943, 1.85, 1.0, 1.1139896373056994, 1.1346153846153846, 1.0053262427899843, 1.0462222222222222, 1.0669285318347765, 1.2726021110601193, 1.0856330326738353, 1.083863113756256, 1.044881352797716, 1.1839080459770115, 4.0, 1.0008457513010633, 1.178744939271255, 1.047852738892812, 1.04500724144215, 1.1004566210045663, 1.1580118694362018, 2.4302325581395348, 2.4285714285714284, 1.0017529337293665, 1.0698695308234822, 1.0170600344020528, 1.133878765340275, 1.070454107211724, 1.0104166666666667, 1.0851720722429454, 1.0564102564102564, 1.2304075235109717, 3.0, 1.0833333333333333, 1.0108527131782945, 1.0928433268858802, 1.0915750915750915, 1.0993464052287583, 1.119607843137255, 1.1637426900584795, 1.148905109489051, 1.1518987341772151, 1.0983728805271329, 1.2150537634408602, 1.0033875860369863, 2.0, 1.2167832167832169, 1.0327868852459017, 1.6395348837209303, 1.0860335195530726, 1.051783659378596, 1.0948616600790513, 1.046692607003891, 1.0643347276104786, 1.0, 1.2340425531914894, 1.1666666666666667, 1.5, 1.1477272727272727, 1.159274193548387, 1.0109204368174727, 1.1116504854368932, 1.069048381928869, 1.0556844547563806, 1.046853986982015, 1.1741823444283648, 1.037037037037037, 1.0612813943677912, 1.0702702702702702, 1.1016949152542372, 1.02322206095791, 1.0415269538302812, 1.176300578034682, 1.1246966019417475, 1.0314194496528657, 1.290616579489618, 1.0786998241410648, 2.0, 1.058968058968059, 1.0734126984126984, 1.4339622641509433, 1.0, 1.1590909090909092, 1.25, 1.1995753715498938, 1.2962962962962963, 1.1666666666666667, 1.014145661648018, 1.1299877502660802, 1.0298830802659147, 1.0379974929489189, 1.2432432432432432, 1.1197278911564625, 1.0, 1.1407407407407408, 1.0041554124246832, 1.0604696257337902, 1.0834396396865482, 1.1478528306185214, 1.0237214921111395, 1.1844155844155844, 1.1231596118454075, 1.1349911190053286, 1.0302486714352983, 1.0868992262655548, 1.3333333333333333, 1.0947712418300655, 1.0, 1.2422535211267605, 1.2078172818206092, 3.0, 1.101504603637997, 1.0916017928756783, 1.4285714285714286, 1.0137247838616714, 1.2, 1.1176470588235294, 1.0637897131836092, 1.6153846153846154, 1.0309512587167495, 1.0516873131140538, 1.3571428571428572, 1.2083333333333333, 1.0041407867494825, 1.0023969319271333, 1.030242825607064, 1.0650325644069427, 1.1568648401129513, 1.0, 1.0244948946339343, 1.1097560975609757, 2.0, 1.0499079814025571, 1.0534907864002077, 1.1390728476821192, 1.0145722563596422, 1.04314166357934, 1.0560747663551402, 2.0, 1.0499201277955272, 1.0443548387096775, 1.0921894354606079, 1.2507300792657488, 1.0259525442484252, 1.0230986778862898, 1.1556776556776556, 1.1061728395061727, 1.1872909698996656, 1.0472140010719861, 1.0876971608832808, 1.0424929178470255, 1.0138445154419595, 1.03084986219672, 3.0, 1.1386438603561246, 1.0537115205346015, 1.036925272486614, 1.4615384615384615, 1.2889876406054714, 1.3284313725490196, 1.1428571428571428, 1.068032729068209, 1.0420575865415722, 1.1135371179039302, 1.088235294117647, 1.3333333333333333, 1.0663174230777637, 1.5, 1.0724299065420562, 1.0833333333333333, 1.0498516537855755, 1.3846153846153846, 1.2362869198312236, 1.0482180293501049, 1.0, 1.7738095238095237, 1.2990654205607477, 1.25, 2.0, 1.1176470588235294, 1.1758620689655173, 1.0153939028071235, 1.2002518891687657, 1.056105610561056, 1.2625368731563422, 1.1014466214978942, 1.0597402597402596, 1.1951219512195121, 1.079295154185022, 1.1923076923076923, 1.0, 1.4179743223965764, 1.0303030303030303, 1.0702479338842976, 1.2349027635619243, 1.0693406058488, 1.0538243626062322, 1.0879628257196217, 1.1475202429149798, 1.1803977272727273, 1.0108564535585043, 1.5714285714285714, 1.0, 1.3076923076923077, 1.0275404113227593, 1.1023830538393644, 1.107843137254902, 1.1566951566951567, 1.0401938200015888, 1.0920539379684144, 1.0204350179494677, 1.1470588235294117, 1.2222222222222223, 1.0432432432432432, 1.0616383881230116, 1.0664892314223666, 1.0138967060652355, 1.034013605442177, 1.0745717660956882, 1.0186644121259913, 1.2995008319467554, 1.3895112016293278, 1.125, 1.078383641674781, 2.1925925925925926, 1.2380952380952381, 1.1444141689373297, 1.0701001430615165, 1.0, 1.0305882352941176, 1.0209695528696916, 1.0384615384615385, 1.0786664437704487, 1.0042372881355932, 1.2647058823529411, 1.0817693315858454, 1.0565248738284065, 1.097938490464679, 1.0124045801526718, 1.04756242568371, 1.1958484971020353, 1.1740041928721174, 1.3571428571428572, 1.0, 1.4285714285714286, 1.0714545234346615, 1.3333333333333333, 1.208116036505867, 1.1162026816003445, 1.0764288879042978, 1.0266137040714995, 1.0506012573102328, 1.0237942122186494, 1.075268817204301, 1.0319001386962552, 1.0221382111912085, 1.101284214473191, 1.0427725959471754, 1.213356618089847, 1.4285714285714286, 1.032258064516129, 1.0039525691699605, 1.1097611702312038, 1.0879478827361564, 1.2760290556900726, 1.0521415270018621, 2.2017167381974247, 1.080363343645432, 1.018791946308725, 1.0750478468899523, 1.125, 1.0600275339467677, 1.0376076744046239, 1.3669181034482758, 1.0581052631578947, 1.28, 1.0735632183908046, 1.1104972375690607, 1.5, 1.108049500878603, 1.6153846153846154, 1.1980676328502415, 1.0340909090909092, 1.0738595220854454, 1.022731186499053, 1.0265700483091786, 1.5714285714285714, 1.0821256038647342, 1.093845361961837, 1.0552697372076227, 1.0175197205810023, 1.020620617286007, 1.0614328249377165, 1.0, 1.0746395250212044, 1.0134791951553037, 1.0230423165635205, 1.0120240480961924, 1.0, 1.129327902240326, 1.0349107671487778, 1.4022403258655805, 1.0497445008150332, 1.0, 1.3333333333333333, 1.0351652698459788, 1.0026734205712677, 1.2318902294771705, 1.1277175423964414, 1.0383080606544293, 1.0843373493975903, 1.0898660437058285, 1.0434344706030467, 1.1066176470588236, 1.027027027027027, 1.0523212969786293, 1.073369165071418, 1.1071428571428572, 1.75, 1.0455533094792826, 1.169803375336076, 1.0138728323699422, 1.0292397660818713, 1.2425778421433744, 1.0075523515276348, 1.1653078436885016, 1.3745704467353952, 1.3076923076923077, 1.0370619946091644, 1.1336515513126493, 1.121875, 1.5925925925925926, 1.058140574365851, 1.191278493557978, 1.1724709784411278, 1.0731707317073171, 1.0399638880529642, 1.0526315789473684, 1.0686077643908969, 1.2005347593582887, 1.3333333333333333, 1.12, 2.0, 1.148380355276907, 1.1538461538461537, 1.0, 1.1538461538461537, 1.100662251655629, 1.0797101449275361, 1.0130984564402197, 1.0622895907699075, 1.0145454545454546, 1.2830188679245282, 1.1428571428571428, 1.032258064516129, 1.0945945945945945, 1.1571428571428573, 1.1030927835051547, 1.022422887554622, 1.0331713108975549, 1.3195876288659794, 1.0682997886789356, 1.0479305340073068, 2.5, 1.0709911197305297, 1.348747591522158, 3.0, 2.0, 1.0988165680473372, 1.110664849745392, 1.0696705648551554, 1.2142857142857142, 1.0, 1.070539419087137, 1.1595092024539877, 3.0, 2.0, 1.0703186726362919, 1.2265089393735717, 1.0229913782331626, 1.6666666666666667, 1.0235503687999945, 1.048024786986832, 1.0194871794871796, 1.0, 1.0140845070422535, 1.0240785936311345, 1.25, 1.1563088512241055, 1.0019782393669634, 1.3449367088607596, 1.09375, 1.0946428840673672, 1.0964419475655431, 1.0537190082644627, 1.2545454545454546, 1.0311123506106814, 1.9508470532092579, 1.0451444785453703, 1.9161676646706587, 1.1568627450980393, 1.2835820895522387, 1.0566534914361, 1.0636563185951708, 1.0010191337363241, 1.1136309637861659, 1.0731441048034935, 1.5, 1.6666666666666667, 1.0347439749408682, 1.121811785400176, 1.1048434156778837, 1.0229255900148502, 1.0163907007860846, 1.1354315071450158, 1.1574803149606299, 1.0434782608695652, 1.0860781385111233, 1.1222391156951779, 1.239590942293645, 1.2440087145969498, 1.6666666666666667, 1.0714285714285714, 1.030079733968182, 1.151940545004129, 1.031655347774309, 1.0998648718881554, 1.0071022727272727, 2.0, 1.0918367346938775, 1.0139172244951973, 1.1909984007310943, 1.1406844106463878, 1.0915641539121728, 1.1305732484076434, 1.1942604856512142, 1.0105448154657293, 1.033139908331791, 1.0612004377472852, 1.0253456221198156, 1.0713305898491083, 1.0, 1.124303554274736, 1.0682420696590182, 1.0441379310344827, 1.055013188093036, 1.1380620645978468, 1.0007570022710068, 1.2, 1.2661290322580645, 1.6666666666666667, 2.0, 1.1764705882352942, 1.0076726342710998, 1.0458135860979463, 1.0854966139954854, 1.003383088832813, 1.021438263229308, 1.0190376569037658, 1.190217391304348, 1.1395348837209303, 1.0706384113021459, 1.6, 1.4166666666666667, 1.212539432176656, 1.1428571428571428, 1.0134952766531713, 1.1414952333166082, 1.0162117603956768, 1.0893752738958953, 2.0, 1.0109546165884193, 1.184108527131783, 1.050013092432574, 1.0401478939787334, 1.1262626262626263, 1.1202054794520548, 1.1420406529377751, 1.112867492964493, 1.02442996742671, 1.0422535211267605, 1.1131284916201116, 1.0, 1.0, 1.0411331855083867, 5.0, 1.4285714285714286, 1.9285714285714286, 1.0780234070221066, 1.1058823529411765, 1.0875831485587584, 1.090623774029031, 1.0, 1.0769708255741774, 1.019859813084112, 1.1494845360824741, 1.2956730769230769, 1.4285714285714286, 1.0333485609867519, 1.110310421286031, 1.1444444444444444, 1.0539233915953887, 1.031573226277567, 1.0019753973242345, 1.1180124223602483, 1.0, 1.1937640140457757, 1.0384145609998146, 1.0497668579626973, 1.1774193548387097, 1.0718001545197013]
origin-bjaq_15.71 	max: 5.0000	99th: 2.5000	95th: 1.7751	median: 1.0811	mean: 1.1754

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 14.037452 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[1.7881393e-07 1.1920929e-07 1.7881393e-07 4.7683716e-07 1.1920929e-07]
Distance score: 2.1457671550706436e-07
SAUCE Drift detection: False
Detection latency: 0.0230s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.026992 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 7.0000	99th: 3.0000	95th: 1.7518	median: 1.0798	mean: 1.1874
ReportEsts: [1.1031746031746033, 1.008884073672806, 1.0489801330890154, 1.1071428571428572, 1.608695652173913, 1.0, 1.0845547309833024, 1.0590749437625795, 1.3333333333333333, 1.0217864923747277, 1.19923242983929, 1.043897232369699, 1.0626603151337486, 1.091976516634051, 1.070663191427744, 2.0, 1.105095541401274, 1.4444444444444444, 1.3636363636363635, 1.1071428571428572, 1.0393096836049855, 1.0113350125944585, 1.1593776282590411, 1.0457239627434378, 1.0102699581853491, 1.0332863383580322, 2.0, 1.1965476413036704, 1.4, 1.1666666666666667, 1.178173719376392, 1.0, 1.0433458957624782, 1.004903844675716, 1.0558375634517767, 1.0287532117949345, 1.2005692792518043, 1.0615711252653928, 1.4915254237288136, 1.0868121442125238, 1.0198750709823963, 1.0417399847793611, 1.1, 1.002575909242576, 1.0454545454545454, 1.1174302824138054, 1.2272727272727273, 1.0500625782227784, 1.3089005235602094, 1.049655172413793, 1.5, 1.2747747747747749, 1.06198347107438, 1.1, 1.0367369657987506, 1.025485536343522, 1.0707701457032412, 1.0686274509803921, 1.0638297872340425, 1.0542745184108129, 1.380952380952381, 1.0655029307320412, 1.0072463768115942, 1.091254752851711, 1.0095238095238095, 1.8, 1.0308971188511158, 1.2879470198675496, 1.4, 1.0, 1.00233245218473, 1.0536635706914346, 1.055072463768116, 1.0367504835589942, 1.1559840480203922, 1.1153846153846154, 1.0269312009656004, 1.5, 1.5242718446601942, 1.0967140952346162, 1.0530341662417133, 1.3333333333333333, 2.0, 3.0, 1.0435754189944133, 1.125, 1.028301886792453, 3.6, 2.0, 1.1071881980490783, 1.112883804936785, 1.3160591591941306, 1.0937611955576028, 1.101956745623069, 1.050131926121372, 1.0372960372960374, 1.1716535433070867, 1.1045751633986929, 1.0666666666666667, 1.3057948316366483, 1.0714285714285714, 1.0, 1.0585759771910506, 1.3056861906797776, 1.0070472163495419, 1.2215424479072947, 1.5333333333333334, 1.0228856971591163, 1.088307623518891, 1.090814118349377, 1.1606413077648539, 1.0480695474303248, 1.2857142857142858, 1.1666666666666667, 1.0613473112017084, 1.0433986904878243, 1.068928379106085, 1.103448275862069, 1.0641198391477356, 1.0, 1.107455558503582, 1.139765554553652, 1.0, 1.0514018691588785, 1.25, 1.1533742331288344, 1.014875487424952, 1.0117284759533482, 1.0826446280991735, 1.8333333333333333, 1.1367106176266482, 1.0, 1.0, 1.1208750804301866, 1.1666666666666667, 1.1520902795588612, 1.0191544989253982, 1.04919939783769, 3.0, 1.7857142857142858, 1.0467479674796747, 1.0053523639607493, 1.069331983805668, 1.0153317054716786, 1.1772151898734178, 1.0149584487534626, 1.0930083907427888, 3.0, 1.035659509202454, 1.0038350910834133, 1.0819854991634132, 1.1263282172373081, 2.0, 1.2405560592323965, 1.0455136540962289, 1.0357751277683134, 1.0921052631578947, 1.0, 1.0111505321844907, 1.0925595165276112, 1.1411840411840413, 1.0717948717948718, 1.0684931506849316, 1.2881355932203389, 1.322314049586777, 1.0304136253041363, 1.2222222222222223, 1.056122027009464, 1.0655737704918034, 1.1890756302521008, 1.0932805080810652, 1.1741293532338308, 1.016480060384954, 1.1669565217391304, 1.1262135922330097, 1.0723076923076924, 1.021978021978022, 1.021629416005768, 1.075684380032206, 1.0212876427829698, 1.085217391304348, 1.2354769871170008, 1.2327044025157232, 1.053639846743295, 1.0049281657200133, 1.0466652461112296, 1.1935483870967742, 1.2184920388215383, 1.002415458937198, 1.0, 1.2514124293785311, 1.0765486282863228, 1.5217391304347827, 1.145611364789447, 1.2097347994825356, 1.0026372031130288, 1.0984129044353588, 1.0978886756238004, 1.0206136145733462, 1.1388345384942578, 1.0016433853738702, 1.048232716369717, 1.0157932519741566, 1.0454943029621473, 1.0691114245416078, 1.103743876836949, 1.4108910891089108, 1.027027027027027, 1.2142857142857142, 1.0, 1.4253731343283582, 1.1014445173998686, 1.3857566765578635, 1.3269230769230769, 1.0065546907005325, 1.0, 1.0436560847891951, 1.0289532293986636, 1.2050153981522218, 1.1428571428571428, 1.1078561917443408, 1.0108754758020664, 1.0440520734958338, 1.005185419482225, 1.0, 1.0083507306889352, 1.105810628717915, 1.0003079716017764, 1.0371352785145889, 1.0617696160267112, 1.0050055617352613, 1.0884976292317385, 1.509090909090909, 1.0078409376268784, 1.0129313613955253, 1.0656716417910448, 1.0163090128755365, 1.0498866213151927, 1.1568627450980393, 1.16158940397351, 2.0, 1.2488921713441654, 1.0597258485639687, 1.1317460317460317, 1.0618892508143323, 1.2142857142857142, 1.5, 1.0998564691408652, 1.2258064516129032, 1.117440057258738, 1.6, 1.0899742930591259, 1.0987166831194473, 1.4285714285714286, 1.0050816210765159, 1.0681818181818181, 1.1479500891265597, 1.1527093596059113, 1.0010574550581601, 1.124967687734264, 1.0769230769230769, 2.0, 1.0671782398684526, 1.0386727142516115, 1.078125, 1.0157191101208092, 1.1030191234501598, 1.0022586032250116, 1.0928242264647794, 1.0703348230639607, 1.019970044932601, 1.0523687735963951, 1.0566925910765452, 1.4615384615384615, 1.0150287254054604, 1.3154205607476634, 1.1272727272727272, 1.4285714285714286, 1.10693359375, 1.4646464646464648, 1.0390884421751705, 1.0051528199336486, 1.0213776722090262, 1.4267515923566878, 1.0183618682236846, 1.0381569474442045, 1.184675141242938, 1.049551995025776, 1.1, 1.2019867549668874, 1.116970926301555, 1.026694246181216, 1.082947149179901, 1.0668801463860933, 1.0954879328436515, 1.2125140924464488, 1.032859174964438, 1.0156554435139293, 1.1050516337160055, 1.0447327281204575, 1.0284142988084326, 2.142857142857143, 1.25, 1.0935849056603772, 1.3333333333333333, 1.0035650623885919, 1.0532643419572554, 1.0493566280517717, 1.5, 1.0169491525423728, 1.0801963993453356, 1.0302083333333334, 1.1103904126513466, 1.0454545454545454, 1.1443719412724307, 1.0033685746492573, 1.081012658227848, 1.5, 3.2857142857142856, 1.0189288018928802, 1.1111111111111112, 1.0029849696868978, 1.0715421303656598, 1.0909090909090908, 1.1186908427414757, 1.1851851851851851, 1.25, 1.0193439539577265, 2.0, 1.0025974025974025, 1.0011961722488039, 1.0507614213197969, 1.275, 1.0648148148148149, 1.1326530612244898, 1.1011177658218567, 1.116285826250287, 1.0728358208955224, 1.0457562097713262, 1.0748540191328115, 3.0, 1.4, 1.0327787576869905, 1.5, 1.0730572359236854, 1.2857142857142858, 2.6666666666666665, 1.5, 1.3249370277078085, 1.066562255285826, 1.280701754385965, 1.1213235294117647, 1.3, 1.8333333333333333, 1.0624088147551336, 1.0533333333333332, 1.2575757575757576, 1.010740603193839, 1.1300813008130082, 1.0, 1.0169332079021638, 1.75, 1.25, 1.3154906731549068, 1.0542168674698795, 1.0778251599147122, 1.1261691612705378, 1.2496582577358022, 1.0195121951219512, 1.5, 1.0257808020629298, 1.0638297872340425, 1.34375, 2.0, 1.1797333333333333, 1.0, 1.0609243697478992, 1.1727272727272726, 1.2226734261031504, 1.0747700193858956, 1.0199916701374427, 1.0218831450912251, 1.118641774891775, 1.2264705882352942, 1.0784023668639053, 1.092372367823057, 1.0711920529801324, 1.0571428571428572, 1.0049266895383353, 1.0563969860719995, 1.1004934948407357, 1.0, 1.1395348837209303, 1.2292576419213974, 2.0, 1.0625, 1.1384615384615384, 1.1849710982658959, 1.1849710982658959, 1.0066334991708126, 1.091648590021692, 1.465, 1.0373259967971091, 1.1445221445221445, 1.0908075568848672, 1.0510204081632653, 1.40625, 1.1317829457364341, 2.0, 1.017628205128205, 1.653061224489796, 1.1059466591273206, 1.0763160627141521, 1.037089163010183, 1.1615487316421895, 1.75, 1.0819815870232354, 1.0, 1.1400220507166483, 1.0, 1.0545351794292173, 1.0129716981132075, 1.041924213920989, 1.1266666666666667, 1.0553584102200142, 4.0, 1.1219908033540709, 1.00628801233183, 1.1295616249713105, 2.0, 1.077922077922078, 1.286624203821656, 1.2979351032448379, 1.1026273421710684, 1.0589490593821609, 1.0416666666666667, 1.1400862068965518, 1.0167700755248081, 1.0772478263054732, 1.122995646171817, 1.0901004005618269, 1.1332278481012659, 1.25, 1.027039413382218, 1.078476595403313, 1.2053571428571428, 1.052060737527115, 1.0, 1.0, 1.2238126219908914, 1.0833333333333333, 1.0428370786516854, 1.1461757427512909, 1.0782122905027933, 1.0, 1.1965811965811965, 1.1176470588235294, 1.0882666561352237, 1.1666666666666667, 1.0, 1.0760401002506266, 1.0, 1.0, 1.0430830039525691, 1.5, 1.0161655350792111, 1.0135644310474754, 1.0105263157894737, 1.3, 1.0590144370706718, 1.1093613298337708, 1.4, 1.0279334857357592, 1.069767441860465, 1.1218441273326016, 1.016622340425532, 1.2383944153577662, 1.075593395252838, 1.0, 1.0833333333333333, 1.3243494423791822, 1.1290268173385056, 1.0502392344497609, 1.4, 1.066874312935141, 1.000806956788148, 1.0236220472440944, 2.0, 1.06235333556822, 1.0588589586491932, 1.0348784194528875, 1.0809832107977615, 1.0258723265014724, 1.072321279786702, 1.0021052631578948, 1.0216897088745815, 1.75, 1.1120952831405597, 1.0573394495412844, 1.0416766467065868, 1.058692006707658, 1.0159151193633953, 1.0088688794318363, 1.0789855072463768, 1.0504393127125868, 1.0994285714285714, 1.0886946422567927, 1.1620171673819744, 1.1280974170479834, 1.0209801037392583, 1.0, 1.8148148148148149, 1.0800154692770014, 1.0294117647058822, 1.0194290561136587, 1.0593048860322563, 1.0, 1.1151771956856702, 1.5202312138728324, 2.0, 1.2115384615384615, 1.0045339141625587, 1.11660777385159, 1.0260598988720342, 1.0, 1.625, 1.0066014113362167, 1.1780411897756842, 1.0357208957986304, 1.0124128419278215, 1.1606927104309304, 1.0299451708140026, 1.0240409207161125, 1.0004539796441385, 1.6, 1.0386619521726994, 1.0213435969209237, 1.0533980582524272, 1.035648611650287, 1.0227272727272727, 1.0153909401577637, 2.0, 1.1032005225342914, 1.0, 1.2355946990154127, 1.15, 1.0614203454894433, 1.0130932896890343, 1.0555555555555556, 1.088419236575372, 1.0, 1.2413793103448276, 1.1428571428571428, 1.3333333333333333, 1.1634615384615385, 1.2222222222222223, 1.0358056265984654, 1.1260504201680672, 1.0639904610492845, 1.0465116279069768, 1.0396196984327415, 1.1488016606906963, 1.063848502095514, 1.1853877632498253, 1.01785783534339, 1.0696808510638298, 1.0638000942951438, 1.0533765369302839, 1.0024248302618817, 1.047670639219935, 1.193121693121693, 1.1446540880503144, 1.027795759831688, 1.1849148418491484, 1.0982527172310776, 1.423529411764706, 1.1882551957467375, 1.0415584415584416, 2.0, 1.0184971098265896, 1.2666666666666666, 1.5, 1.2321428571428572, 1.0336112377434883, 1.0447139067828723, 1.0315789473684212, 1.0662983425414365, 1.0804544857480625, 1.0597718865598027, 1.0868761552680222, 1.0, 1.0952380952380953, 1.154544331933811, 1.2100456621004567, 1.1092436974789917, 1.1060178655383168, 1.0, 1.2746730083234246, 1.1549893842887473, 1.0926484544468547, 1.1282442748091603, 1.0485964044818032, 1.1472569778633301, 1.0095939301148031, 1.3402061855670102, 2.0, 1.1231360491929285, 1.0, 1.0536130536130537, 1.171806167400881, 1.2958827634333565, 1.0377358490566038, 1.6521739130434783, 1.023950532463071, 1.148936170212766, 1.02829162132753, 1.014163390597232, 1.2292619203135207, 1.0937700706486833, 1.074766355140187, 1.0134408602150538, 1.08125, 1.4, 1.0217673566027647, 1.0440454576020441, 1.1, 1.0048342541436464, 1.2067709871075682, 1.030127462340672, 1.01221451286499, 1.3333333333333333, 1.1046099290780143, 1.1402909303914868, 1.0046511627906978, 1.0526315789473684, 1.04408247350687, 1.0305343511450382, 2.142857142857143, 1.0276134122287968, 1.0483443708609272, 1.0963064605112391, 1.2071500167056466, 1.014777307513079, 1.0410429744084984, 1.2012383900928794, 1.0949948927477018, 1.236619718309859, 1.0875657184374905, 1.0875912408759123, 1.0649738610903658, 1.0206370569762224, 1.0468311286617318, 1.1282051282051282, 1.056196199447783, 1.2380952380952381, 1.6, 1.0623471882640587, 1.6215348701488181, 1.0755184153512845, 1.0226757369614512, 1.1666666666666667, 1.0389610389610389, 1.0364226469527587, 1.251572327044025, 1.0265302203078275, 2.3333333333333335, 1.0602898550724638, 1.5, 1.06640625, 1.1538461538461537, 1.063035584604212, 1.3870967741935485, 1.1783216783216783, 1.054925893635571, 1.0, 1.1311163280773426, 1.2057640750670242, 1.0, 2.0, 1.125, 1.1494252873563218, 1.0327700972862264, 1.1738683127572016, 1.1705882352941177, 1.4, 1.1090909090909091, 1.1201814058956916, 1.1124031007751938, 1.1313131313131313, 1.032258064516129, 1.0, 1.0534283170080143, 1.0326340326340326, 1.0348214285714286, 1.06208670095518, 1.0832736351952128, 1.0651567432640776, 1.083826716138711, 1.1253360722593118, 1.2069795427196148, 1.0469627360898417, 1.6666666666666667, 1.0, 1.15625, 1.0096662641690743, 1.0959821428571428, 1.1181318681318682, 1.0842572062084257, 1.0343002868983104, 1.040549788319898, 1.0184629240468328, 1.0574712643678161, 1.5714285714285714, 1.069767441860465, 1.0005508124483613, 1.071305583645358, 1.0120297269880474, 1.022099447513812, 1.0654626148061395, 1.0594117839929178, 1.0418785351082671, 1.0822021116138762, 1.0680655306764306, 1.0382165605095541, 1.0535643954312721, 1.1683309557774608, 1.0289051553365223, 1.0454545454545454, 1.2055498458376157, 1.0, 1.0494071146245059, 1.021527118667382, 1.0, 1.080707173823697, 1.0044014084507042, 1.2954545454545454, 1.0492375235954103, 1.026401153360966, 1.056373993321548, 1.0023364485981308, 1.0141643059490084, 1.1995263469508586, 1.1646234676007006, 1.4666666666666666, 1.0, 1.75, 1.0689286506767797, 1.4285714285714286, 1.0370686732218775, 1.117295731638862, 1.0174696579624862, 1.0621394428877535, 1.0401169871978435, 1.0471377459749553, 1.0271084337349397, 1.0421052631578946, 1.0159227815549372, 1.1049624295554163, 1.0436905540580512, 1.1646834840552118, 1.8571428571428572, 1.0104166666666667, 1.0196078431372548, 1.1019120237992086, 1.0080428954423593, 1.3044475011462633, 1.0573643410852713, 2.216606498194946, 1.055004653252463, 1.0659217877094973, 1.0290097629009762, 1.2222222222222223, 1.0837113503175342, 1.0317393084055597, 1.2924326635314236, 1.0505226480836236, 1.1612903225806452, 1.0760719225449515, 6.777777777777778, 1.0343838628469455, 1.5, 1.0187184108451202, 1.48, 1.1020328988206083, 1.070835992342055, 1.0302267002518892, 1.0479384003974168, 1.05662100456621, 1.054671968190855, 1.0762376237623763, 1.0101756075033363, 1.0909980430528377, 1.045653211885261, 1.0932935916542474, 1.1333333333333333, 1.0694736842105264, 1.1127093954843408, 1.1053077425756952, 1.1457142857142857, 1.0813893208916536, 1.1085043988269794, 1.083495145631068, 1.0012285012285012, 1.0688814496761516, 1.25, 1.116087212728344, 1.2383892184158496, 1.0331632653061225, 1.0322061191626408, 1.3212974025399353, 1.1203543647363872, 1.0626262626262626, 1.068762278978389, 1.1017694026417821, 1.100792971016495, 1.0795107033639144, 1.0229357798165137, 1.0135773317591499, 1.0785324253021658, 1.0784313725490196, 2.25, 1.0483132703813163, 1.1768391296666258, 1.0, 1.038647342995169, 1.2493932038834952, 1.022632074745093, 1.161599625818522, 1.105263157894737, 1.3666666666666667, 1.054726368159204, 1.236842105263158, 1.1256410256410256, 1.6875, 1.046980178200676, 1.1975103734439834, 1.0375634517766497, 1.0425531914893618, 1.2350230414746544, 1.0425012212994627, 1.0392156862745099, 1.125, 1.0465549348230911, 1.045643153526971, 1.073389915127309, 1.2307692307692308, 1.0033555656820912, 1.1382765531062125, 1.0705911390842897, 1.2695652173913043, 1.0, 1.260806916426513, 1.0145884543219932, 1.0292788796221728, 1.0, 1.3064516129032258, 1.0, 1.1764705882352942, 1.021505376344086, 1.053763440860215, 1.1082446328702868, 1.0269471776791719, 1.0279346532511089, 1.382608695652174, 1.0715006183005567, 1.0477791497029967, 3.0, 1.0983233321567243, 1.0233398740059898, 1.5, 2.75, 1.1657171166707951, 1.0784572870359246, 1.0991749948232832, 1.1979166666666667, 1.0, 1.1717557251908397, 1.0051679586563307, 1.2429906542056075, 1.0228227883243823, 1.1213552135246014, 1.0684596238938053, 1.024359644537376, 1.5714285714285714, 1.027297520029226, 1.0517129928894635, 1.1078524124881741, 1.365606936416185, 1.0142011834319526, 1.0, 1.5416666666666667, 1.1522906134361808, 1.0626582176429804, 1.0666666666666667, 1.1049180327868853, 1.1116722139332034, 1.088855421686747, 1.054421768707483, 1.125, 1.036818871379956, 1.3580520199225234, 1.0236195942565303, 1.2654320987654322, 1.0975609756097562, 1.1545064377682404, 1.125, 1.077726574500768, 1.0228426395939085, 1.0046738076857622, 1.040394973070018, 3.5, 1.5185185185185186, 1.0236879147395939, 1.1677655677655678, 1.0341685649202734, 1.0041603729701196, 1.0828220858895705, 1.0881967890856474, 1.168141592920354, 1.0172413793103448, 1.0581601206478264, 1.1110254631413963, 1.1903358868591631, 1.1061093247588425, 2.0, 1.0941176470588236, 1.0479723046488625, 1.106153846153846, 1.0065650092851726, 1.081228639902435, 1.0029239766081872, 2.6, 1.078781512605042, 1.002298512402773, 1.1632885016101535, 1.084639498432602, 1.0908639251983565, 1.0319148936170213, 1.3593033913840513, 1.0382894082545997, 1.0304039038902848, 1.1082070047046524, 1.0112676056338028, 1.0321151716500554, 1.0555555555555556, 1.173738388149636, 1.181805085356191, 1.0233072413914142, 1.0099412562132852, 1.1144045761830472, 1.03125, 1.1532846715328466, 1.2100656455142231, 2.0, 2.0, 1.0909090909090908, 1.0395604395604396, 1.043506921555702, 1.0085588925967124, 1.0062650121522705, 1.0115961800818554, 1.028494623655914, 1.2119815668202765, 1.0151419558359622, 1.066263932911496, 2.2, 1.375, 1.154885328306629, 1.1111111111111112, 1.1627906976744187, 1.1121991024071807, 1.0295514511873352, 1.0943539168137881, 2.0, 1.0393069562968709, 1.2023411371237458, 1.1449190152865758, 1.0398513318191205, 1.2010695187165776, 1.1332760103181427, 1.1317003252540474, 1.0868887590103253, 1.0170827858081473, 1.3559322033898304, 1.099644128113879, 1.3333333333333333, 3.0, 1.0419311434716005, 7.0, 1.625, 1.8823529411764706, 1.04, 1.078613801733327, 1.2363534046145188, 1.0187265917602997, 1.1666666666666667, 1.1312891589139928, 1.0057803468208093, 1.0917721518987342, 1.3575883575883576]
origin-bjaq_15.71 	max: 7.0000	99th: 3.0000	95th: 1.7518	median: 1.0798	mean: 1.1874

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.191679 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.283543