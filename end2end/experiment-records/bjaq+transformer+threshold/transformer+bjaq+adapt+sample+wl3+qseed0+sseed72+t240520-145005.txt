Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 72, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.6139	95th: 1.6667	median: 1.0800	mean: 1.1713
ReportEsts: [1.0222222222222221, 1.0072916666666667, 1.0368401255732536, 1.0699588477366255, 1.5, 1.0, 1.0757324488667772, 1.0848650667753312, 1.0, 1.0277044854881265, 1.1811675756788733, 1.042374943668319, 1.005489864864865, 1.113953488372093, 1.0808901448251502, 1.0, 1.4777777777777779, 1.0, 3.0, 2.0, 1.1851851851851851, 1.0586274599333363, 1.1082134766345293, 1.1150910158543745, 1.1090281203749384, 1.0, 1.1194561912417433, 1.5, 1.2, 1.0145985401459854, 1.0, 1.0452396104010888, 1.007252280859369, 1.0134983127109112, 1.058011455426641, 1.2269291469391146, 1.1203208556149733, 1.0080234584581644, 1.2096563124182107, 1.0833333333333333, 1.04, 1.0445859872611465, 1.0, 1.031519365590162, 1.120463187003111, 1.8615384615384616, 1.0618556701030928, 1.2190812720848057, 1.0335230737954868, 1.1388888888888888, 1.096593535775139, 1.1701030927835052, 1.0409344677695145, 2.0, 1.1116883116883116, 1.098700048146365, 1.189446366782007, 1.3725490196078431, 1.0683229813664596, 1.25, 1.1478553253362413, 1.0990037359900373, 1.05, 1.0114942528735633, 1.0, 1.1115343182517698, 1.26583850931677, 1.75, 1.0, 1.0487554768341567, 1.0397022332506203, 1.0566146735990756, 1.034965034965035, 1.0750975441817765, 1.08, 1.0, 1.0, 1.1127348643006263, 2.0, 1.014706304341588, 1.1428571428571428, 1.0134852138596269, 1.177914110429448, 1.10941475826972, 1.1295387634936211, 1.0, 1.0786000103933897, 1.0415550903159843, 1.0441176470588236, 1.75, 1.1693590411672745, 1.0618665851033169, 1.102803738317757, 1.02945301542777, 1.0291353383458646, 1.0389610389610389, 1.0714285714285714, 1.140077821011673, 1.0, 1.2399867227262669, 1.0311804008908685, 1.0626072041166381, 1.2476446244606851, 1.2592592592592593, 1.0042547441654386, 1.0135386249004512, 1.162135088723526, 1.155479711793705, 1.04659717964439, 1.1666666666666667, 2.0, 1.0591121495327103, 1.0432089222026155, 1.049273531269741, 1.12987012987013, 1.055630774631113, 2.0, 1.130558183538316, 1.1433260393873086, 1.0, 1.0054945054945055, 1.1666666666666667, 1.1704260651629073, 1.0184077507808438, 1.067562320416246, 1.12, 1.8, 1.2119205298013245, 1.0, 1.1666666666666667, 1.096175276809357, 1.1818181818181819, 1.0646158854166667, 1.0315775590823164, 1.0679603529756179, 1.089452603471295, 1.0960960960960962, 1.059236165237724, 1.039972432804962, 1.0719073735527118, 1.0250083361120375, 1.1911764705882353, 1.0152317880794701, 1.1122537148142289, 2.0, 1.0168641750227894, 1.038857142857143, 1.0826057756883816, 1.0970531145226752, 1.5, 1.1238798740615161, 1.0546875, 1.016260162601626, 1.1074561403508771, 1.1503649635036497, 1.1763317599460552, 1.066677968017178, 1.052986421042636, 1.0981210855949897, 1.0953947368421053, 1.2448979591836735, 1.3663366336633664, 1.0132547864506627, 1.5714285714285714, 1.0731147147147146, 1.0140298439179865, 1.1744421906693712, 1.3479307025986524, 1.1196990424076607, 1.1208820333412843, 1.2694736842105263, 1.0818181818181818, 1.091895032439237, 1.0303336703741153, 1.01725625539258, 1.0855199222546161, 1.0280199252801991, 1.1011945392491467, 1.0048910906660375, 1.0, 1.008, 1.0211846087332468, 1.0285087719298245, 1.1220423412204235, 1.1842105263157894, 1.1134154326584063, 1.3478762252546608, 1.075406358894444, 1.1153846153846154, 1.0709090909090908, 1.0596505297948868, 1.0, 1.1818181818181819, 1.059238933053549, 1.0376914016489989, 1.0269886363636365, 1.3461538461538463, 1.0482315112540193, 1.053607855428868, 1.0767081105083307, 1.0626410835214446, 1.1372404342784863, 1.0677966101694916, 1.0847457627118644, 1.1830985915492958, 1.0, 1.415929203539823, 1.084292698312569, 1.2857142857142858, 1.1494252873563218, 1.013346515076619, 1.0031277926720286, 1.0098967074415628, 1.0629508378648318, 1.1644104968615292, 1.1210191082802548, 1.08125, 1.008749189889825, 1.033962318341088, 1.0290142240464228, 1.0, 1.1118012422360248, 1.1091918933291316, 1.0155381705267004, 1.1539408866995073, 1.0302288007505083, 1.2748840720370969, 1.0357142857142858, 1.0054560217117074, 1.181407942238267, 1.019551466359977, 1.1497005988023952, 1.1735637779941577, 1.0502901353965184, 1.2291338582677165, 2.0, 1.2655502392344498, 1.0276909334524342, 1.2097984060009377, 1.1754385964912282, 1.0, 1.6666666666666667, 1.028895024709379, 1.1090909090909091, 1.1320357324424433, 1.5, 1.0, 1.0810810810810811, 1.1174863387978142, 1.0510204081632653, 1.0140056022408963, 1.1371308016877637, 1.0366056572379367, 1.0041981528127624, 1.1083215578482801, 1.0, 2.0, 1.104682006045278, 1.0753338744189478, 1.1138353765323994, 1.0315700946671555, 1.1530397094998244, 1.045527033283605, 1.1041335453100158, 1.0687639737337817, 1.020933014354067, 1.1084578647357881, 1.1556911722963383, 1.1818181818181819, 1.0285772631174324, 1.1873417721518988, 1.1818181818181819, 1.3157894736842106, 1.0091743119266054, 1.0555555555555556, 1.0086206896551724, 1.1179193863131687, 1.0167130919220055, 1.3533834586466165, 1.028722518670236, 1.0016806722689076, 1.0281133907893754, 1.0434500971647815, 1.25, 1.0104947253546743, 1.6666666666666667, 1.062121650152873, 1.0561555075593954, 1.0471303081334487, 1.0526315789473684, 2.0, 1.434782608695652, 1.0441176470588236, 1.0487500238970706, 1.0, 1.0030674846625767, 1.0701357466063348, 1.0060096153846154, 1.0185603596487152, 1.05, 1.1635220125786163, 1.0133815567430742, 1.1488656308912435, 1.073449238033913, 1.1196581196581197, 1.0, 1.0894988066825775, 1.2530864197530864, 1.1588447653429603, 1.0280539174389216, 1.0266889074228525, 1.2028169014084507, 1.2826086956521738, 1.0153203342618384, 1.0267549668874172, 1.2857142857142858, 1.0076295873857488, 1.030188679245283, 1.0, 1.0918618651488616, 1.2857142857142858, 1.4, 1.0261670787632875, 2.0, 1.1550068587105624, 1.0203488372093024, 1.1132075471698113, 1.0853858784893267, 1.0208877284595301, 1.1375, 1.0965516308391619, 1.1014175247275708, 1.0338028169014084, 1.0030183899726948, 1.0179886685552408, 2.0, 1.0, 1.0410087067803195, 1.25, 1.0697544642857142, 1.3529411764705883, 1.0, 1.375, 1.3323293172690762, 1.054003724394786, 1.303030303030303, 1.0357142857142858, 1.0, 1.1458055925432757, 1.099254524649437, 2.0, 1.0774270399047052, 1.0, 1.0905336673498824, 1.0853658536585367, 1.085013096458262, 1.1474654377880185, 1.1363636363636365, 1.4195888754534463, 1.1388888888888888, 1.0285589305970537, 1.0196932621282668, 1.0134952766531713, 1.0, 1.0769230769230769, 1.5714285714285714, 1.5, 1.3333333333333333, 1.069004765333059, 1.3333333333333333, 1.0615640599001663, 1.3289473684210527, 1.1308346944038512, 1.0613670250333516, 1.2368692070030896, 1.0300028337977614, 1.013921113689095, 1.0345238095238096, 1.5, 1.2868632707774799, 1.0212765957446808, 1.0441104911438397, 1.2380952380952381, 1.5714285714285714, 1.0334075723830736, 1.0093896713615023, 1.037780576338988, 1.0277078085642317, 1.1464387464387464, 1.0238030095759234, 1.0526315789473684, 1.0907770515613653, 1.0593220338983051, 1.2307692307692308, 1.0254957507082152, 1.1941747572815533, 1.0579625844992926, 1.0672383720930232, 1.0388145862406712, 1.162162162162162, 1.1808510638297873, 1.115264797507788, 1.0, 1.0090980511416914, 1.044626038188201, 1.0105025743837426, 1.0640678288355734, 1.0620493551335433, 1.1468064823641564, 1.5714285714285714, 1.233194527067222, 1.0, 1.1742100768573869, 1.25, 1.0260203569716497, 1.0147058823529411, 1.075128976784179, 1.1027667984189724, 1.0179738562091503, 3.0, 1.1780538302277432, 1.0115655169663373, 1.134587088467905, 2.0, 1.0634920634920635, 1.2581573896353166, 1.3333333333333333, 1.074653195413359, 1.2993762993762994, 1.1666666666666667, 1.0441441441441441, 1.0025540090913352, 1.1051252964834486, 1.1011115095016135, 1.2016447368421053, 1.1293532338308458, 1.1401515151515151, 1.875, 1.0735694822888284, 1.5, 1.2298657718120805, 1.0, 1.0655375386211408, 1.6666666666666667, 1.0812156850979568, 1.1456117135541082, 1.0906847624922886, 1.0, 1.163265306122449, 1.2, 1.2861074967470725, 1.1181619256017505, 1.0, 1.0547112462006079, 1.07842565966988, 1.0518027351844177, 1.5, 1.5, 1.0116504854368933, 1.0, 1.0262295081967212, 1.2222222222222223, 1.0756594702950097, 1.0611222444889779, 1.4705882352941178, 1.0722033898305086, 1.0545454545454545, 1.1154855643044619, 1.0225806451612902, 1.3432898611695414, 1.0324167358065663, 1.0, 1.0571428571428572, 1.0483685088669865, 1.0374523723579192, 1.0032763961268607, 1.0, 1.1384649413846495, 1.0069114513391142, 1.0220010476689365, 2.0, 1.062200956937799, 1.0149439155208868, 1.0080077722495364, 1.0059411995980954, 1.0047489645771805, 1.0530206112295664, 1.0303030303030303, 1.1636933461909353, 2.0, 1.114889658380278, 1.2758620689655173, 1.0, 1.1813471502590673, 1.1153846153846154, 1.0009002100490114, 1.1949238578680204, 1.076065141349848, 1.0894905920146856, 1.0676501302349028, 1.0850804815365886, 1.0536021822300818, 1.10752688172043, 4.0, 1.0104189172968432, 1.1275303643724697, 1.0492474434468457, 1.0516204525181996, 1.1004566210045663, 1.109452736318408, 2.6125, 2.4285714285714284, 1.0169450260505428, 1.0655131304803183, 1.0635240463529945, 1.1127737226277372, 1.0672242576166602, 1.0062240663900415, 1.0752581517483322, 1.0587918015102482, 1.213292117465224, 3.0, 1.1666666666666667, 1.0168711656441718, 1.0782442748091603, 1.075812274368231, 1.133423180592992, 1.0274509803921568, 1.236024844720497, 1.148905109489051, 1.0963855421686748, 1.0386151489755224, 1.2840909090909092, 1.041571105515549, 2.0, 1.2960893854748603, 1.0873015873015872, 1.3689320388349515, 1.1153631284916201, 1.1146341463414635, 1.1185770750988142, 1.0376134889753568, 1.100190715050814, 1.0, 1.1914893617021276, 1.5, 1.0, 1.1590909090909092, 1.0423387096774193, 1.0125, 1.0825242718446602, 1.0607177186799104, 1.0904872389791183, 1.0509243425197559, 1.1808126673652346, 1.041860465116279, 1.0982197994080194, 1.0277777777777777, 1.0959792477302206, 1.0353168843734881, 1.1075150850246847, 1.1098265895953756, 1.1523158221945913, 1.0099832767445396, 1.26500174777644, 1.07413221287193, 2.0, 1.0393120393120394, 1.0734126984126984, 1.4476190476190476, 1.0, 1.1333333333333333, 1.25, 1.2203023758099352, 1.4074074074074074, 1.1666666666666667, 1.0052643450381433, 1.1284468063772184, 1.0281823120101399, 1.0295283238790893, 1.2648648648648648, 1.1289437585733881, 1.0, 1.1079136690647482, 1.0570866141732282, 1.0562727441761628, 1.08465387823186, 1.1337282150586627, 1.0368159572890405, 1.1714285714285715, 1.1046320292895635, 1.1278863232682061, 1.0099558266251094, 1.0858355767239594, 1.303030303030303, 1.0490605427974948, 1.0, 1.2387640449438202, 1.2077428630108853, 3.0, 1.1201187485727335, 1.0355840028646242, 1.4285714285714286, 1.0342771982116243, 1.3, 1.0555555555555556, 1.059558917328891, 1.6923076923076923, 1.0311929710066108, 1.0439982913284922, 1.3571428571428572, 1.0, 1.1505154639175257, 1.0449545671927307, 1.008684034736139, 1.0588835725677832, 1.1563882701168717, 1.0, 1.0677818813817075, 1.103658536585366, 2.0, 1.0075291055701439, 1.0503936326671857, 1.128666035950804, 1.012149383934541, 1.047652040030793, 1.0865384615384615, 1.8571428571428572, 1.1125687685146002, 1.0411290322580644, 1.0763578979519115, 1.1557440246723207, 1.0029132106008496, 1.0550996809651847, 1.6043956043956045, 1.0799517878666132, 1.137123745819398, 1.0839489347331859, 1.0996845425867507, 1.141304347826087, 1.0381679389312977, 1.040003281946559, 3.0, 1.1318358505682324, 1.0011444380311685, 1.0317269337495665, 1.4615384615384615, 1.3096792112206639, 1.3349753694581281, 1.1428571428571428, 1.0836918953234111, 1.0420575865415722, 1.1626637554585153, 1.1176470588235294, 1.3333333333333333, 1.0673750847840833, 1.5, 1.1098130841121496, 1.0, 1.0048732601759982, 1.44, 1.0675105485232068, 1.0482180293501049, 1.0, 1.6388888888888888, 1.2261427425821974, 1.25, 2.0, 1.1271186440677967, 1.1896551724137931, 1.0696343402225754, 1.2078580481622307, 1.1573236889692586, 1.2035398230088497, 1.1014466214978942, 1.0623376623376624, 1.1290322580645162, 1.3551020408163266, 1.1538461538461537, 1.0, 1.155813953488372, 1.054834054834055, 1.0681818181818181, 1.1227172269396302, 1.0820971398619506, 1.0673140587066872, 1.0843980671745768, 1.0991902834008098, 1.1541666666666666, 1.0017931858936042, 1.8333333333333333, 1.0, 1.2142857142857142, 1.039500645063368, 1.1023830538393644, 1.107843137254902, 1.0769230769230769, 1.0766704849179076, 1.1055729752115009, 1.0211847258282434, 1.0985915492957747, 1.2222222222222223, 1.032085561497326, 1.0630302226935313, 1.074542642800737, 1.0492746789448868, 1.0066225165562914, 1.0334986646318198, 1.0333100802232298, 1.157037037037037, 1.3737270875763747, 1.2857142857142858, 1.056270863137816, 1.2795389048991355, 1.1304347826086956, 1.057636887608069, 1.0701001430615165, 1.0, 1.0977443609022557, 1.0223199523841016, 1.08, 1.0852100398825018, 1.0272034820457019, 1.1944444444444444, 1.0592379656840727, 1.030389329488104, 1.066915122213269, 1.0190839694656488, 1.0173210161662818, 1.2050254668930391, 1.1864406779661016, 1.2857142857142858, 1.0, 1.4285714285714286, 1.0716240765411167, 1.3333333333333333, 1.0802972894199943, 1.1240105540897098, 1.0006650410108624, 1.0679245283018868, 1.0502036629452949, 1.0481243301178993, 1.053763440860215, 1.0624133148404993, 1.012834902669829, 1.0833802024746906, 1.0470222739728778, 1.198091051427195, 1.4285714285714286, 1.0158730158730158, 1.0284552845528456, 1.06144060452702, 1.0065573770491802, 1.2976744186046512, 1.0521415270018621, 2.2017167381974247, 1.024448468883767, 1.0228187919463088, 1.0707894736842105, 1.1875, 1.069646765349587, 1.0358951055246652, 1.3501862692921767, 1.0581052631578947, 1.125, 1.119904076738609, 1.1166666666666667, 1.75, 1.0564268909959365, 1.5769230769230769, 1.2053462940461726, 1.091127098321343, 1.003382949932341, 1.011112981983499, 1.0107015457788346, 2.75, 1.1144278606965174, 1.0985146512739439, 1.0690705039168842, 1.0039628715192048, 1.0301262545601264, 1.06810856139554, 1.0, 1.0792163543441227, 1.162531744481344, 1.0578040141676506, 1.0300601202404809, 1.006993006993007, 1.0888561610211094, 1.0274042121289013, 1.3811434302908727, 1.0241405189050103, 1.0, 1.3333333333333333, 1.0377710202971644, 1.0329252849303503, 1.2309583471230674, 1.0993235103326846, 1.0422984836392657, 1.0869565217391304, 1.1003538654128595, 1.084284546197874, 1.1066176470588236, 1.0571428571428572, 1.0156472261735419, 1.0724979139056594, 1.0833333333333333, 1.75, 1.0586451845933256, 1.1696707638990105, 1.0299471520845567, 1.0625, 1.2067342505430847, 1.0168634660255957, 1.1613719426482991, 1.342281879194631, 1.2307692307692308, 1.0606469002695418, 1.072234762979684, 1.146875, 1.4827586206896552, 1.0816627556151526, 1.1793855302279486, 1.1708126036484245, 1.048780487804878, 1.0297455445213495, 1.0720322704571648, 1.0688420348058902, 1.1798375916022974, 1.3333333333333333, 1.1666666666666667, 2.0, 1.1431556948798327, 1.4615384615384615, 1.0, 1.1538461538461537, 1.0980132450331126, 1.0815217391304348, 1.0519395849179616, 1.0664753137791063, 1.0254545454545454, 1.2830188679245282, 1.0666666666666667, 1.0, 1.0945945945945945, 1.0, 1.1165217391304347, 1.0189108690219704, 1.0315350079774406, 1.3195876288659794, 1.042284729488521, 1.047570191682098, 2.5, 1.0668401891735566, 1.2131715771230502, 3.0, 2.0, 1.2491124260355029, 1.1265868177580147, 1.0682416701652608, 1.2608695652173914, 1.0, 1.1415929203539823, 1.1042944785276074, 3.0, 1.5, 1.0059055118110236, 1.2349778195994086, 1.0311133325003123, 1.6666666666666667, 1.0291407596074613, 1.0418280402788536, 1.060935799782372, 1.0, 1.0751173708920188, 1.0259043415290183, 1.0921052631578947, 1.1349353049907578, 1.0021140008921472, 1.4261744966442953, 1.10546875, 1.0428487294769955, 1.0597285067873303, 1.06198347107438, 1.2545454545454546, 1.037387317185206, 1.4338828481234656, 1.058978842249786, 1.251497005988024, 1.1666666666666667, 1.3432835820895523, 1.060846560846561, 1.0659962287869265, 1.009715489352267, 1.0645027783100212, 1.0502183406113537, 1.5, 1.6666666666666667, 1.0504698587227514, 1.1534740545294635, 1.1631978214355183, 1.0172678293099005, 1.0381334671349725, 1.1067160410705268, 1.125, 1.0212765957446808, 1.0606084427324896, 1.062182819338004, 1.2598366740905715, 1.0788091068301227, 1.6666666666666667, 1.0416666666666667, 1.077473417921657, 1.1462612982744453, 1.0488898342523356, 1.0839593648625576, 1.0127840909090908, 2.0, 1.0808080808080809, 1.0197703579581876, 1.1784327164724697, 1.1863117870722433, 1.0816883612263386, 1.0328947368421053, 1.390728476821192, 1.05440097799511, 1.0307810668495676, 1.0578331509386312, 1.0195852534562213, 1.0625850340136054, 1.0, 1.215368639667705, 1.058186305878051, 1.0587412587412588, 1.0428184838831227, 1.1031307550644567, 1.0423600605143721, 1.2, 1.2076923076923076, 1.6666666666666667, 2.0, 1.1176470588235294, 1.0025575447570332, 1.0434439178515007, 1.0008548279194232, 1.0194217527051879, 1.0222523744911804, 1.063877142221233, 1.141304347826087, 1.1395348837209303, 1.056286257426854, 1.6, 1.4166666666666667, 1.0104065040650407, 1.1428571428571428, 1.0488826815642458, 1.1184857423795478, 1.0723951285520974, 1.078589862199932, 2.0, 1.073374613003096, 1.2170542635658914, 1.049738219895288, 1.0405607493784232, 1.1818181818181819, 1.1191780821917807, 1.143311960103304, 1.2091601066944246, 1.0177993527508091, 1.1833333333333333, 1.1243016759776536, 1.0, 1.0, 1.0417277636708273, 5.0, 1.4285714285714286, 1.8620689655172413, 1.0048484848484849, 1.0444444444444445, 1.0609756097560976, 1.091800706159278, 1.0, 1.0720049658597144, 1.019859813084112, 1.1925133689839573, 1.2956730769230769, 1.25, 1.013781512605042, 1.0798226164079823, 1.1495535714285714, 1.0067390490453014, 1.0186090615462116, 1.155056412379671, 1.1774622892635316, 1.0, 1.2009561281042433, 1.0410200344384617, 1.0335814203730274, 1.1774193548387097, 1.0787454639709695]
origin-bjaq_15.71 	max: 5.0000	99th: 2.6139	95th: 1.6667	median: 1.0800	mean: 1.1713

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 14.005881 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[0.0000000e+00 5.9604645e-08 5.9604645e-08 0.0000000e+00 1.7881393e-07]
Distance score: 5.960464477539063e-08
SAUCE Drift detection: False
Detection latency: 0.0231s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.026963 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.3939	95th: 1.8601	median: 1.0822	mean: 1.1773
ReportEsts: [1.038888888888889, 1.0038768037906527, 1.05217029638515, 1.1223776223776223, 1.5217391304347827, 1.0, 1.057879552830869, 1.033909144142756, 1.5, 1.0276854928017718, 1.1436122924625771, 1.0428457582774486, 1.026219956300073, 1.1663442940038684, 1.0600468658465143, 1.1415030467163167, 1.205211726384365, 1.6, 1.2727272727272727, 1.1076794657762938, 1.113860252004582, 1.0090437873327738, 1.0175438596491229, 1.0074937552039966, 1.0289377028135362, 1.0396726193077688, 4.0, 1.1759955786177039, 1.3333333333333333, 1.1666666666666667, 1.098736176935229, 1.0, 1.0426755125506488, 1.0100923357720368, 1.163619744058501, 1.0464233219010288, 1.2428771438571928, 1.15990990990991, 1.0, 1.0060010911074742, 1.0264283677155623, 1.0009905635785412, 1.3043478260869565, 1.0401247278931576, 1.0126353790613718, 1.0383930925388873, 1.1428571428571428, 1.1872427983539096, 1.1626794258373205, 1.0136147038801906, 1.0526315789473684, 1.3457943925233644, 1.0940170940170941, 1.09375, 1.0310691066402842, 1.00964789313103, 1.1492774336985867, 1.1381074168797953, 1.074468085106383, 1.0281015708675474, 1.359375, 1.1234901856718513, 1.076804915514593, 1.0795454545454546, 1.0096153846153846, 1.6666666666666667, 1.0195239920960273, 1.3784545967287085, 2.0, 1.0, 1.0195285147436397, 1.051975051975052, 1.0549927641099854, 1.0290697674418605, 1.0952901663672576, 1.2134992819530876, 1.051501086312463, 1.014354066985646, 1.4854368932038835, 1.1112146799722191, 1.0226724553786783, 1.2173913043478262, 1.0, 1.5, 1.0602957906712174, 1.3333333333333333, 2.0, 1.9166666666666667, 2.0, 1.060189193522527, 1.1058770749214895, 1.149746192893401, 1.0826613419348232, 1.0135721017907635, 1.0808080808080809, 1.0070921985815602, 1.0298507462686568, 1.222509702457956, 1.2106918238993711, 1.2273983418870904, 1.0714285714285714, 3.0, 1.0573298965552558, 1.254323070434416, 1.0742857142857143, 1.2211035471157292, 1.3225806451612903, 1.0227911349477163, 1.0281848928974069, 1.314719217129775, 1.138819095477387, 1.0506948018528048, 1.2857142857142858, 1.3333333333333333, 1.0505030959752322, 1.0725864635560791, 1.079660116834838, 1.2352941176470589, 1.0590295803378063, 1.0, 1.0995011814124442, 1.1440291704649044, 1.0, 1.0, 1.0, 1.1662971175166297, 1.0184685601068488, 1.0598732703995861, 1.134453781512605, 1.8333333333333333, 1.1573187414500683, 1.0, 1.4444444444444444, 1.1274911529148817, 1.0833333333333333, 1.0988641144299538, 1.0029600230593556, 1.0718212697412193, 2.0, 1.3571428571428572, 1.0524109014675052, 1.0417602155365964, 1.0735294117647058, 1.010360884749709, 1.2075471698113207, 1.0407166123778502, 1.105646944281049, 3.0, 1.005287009063444, 1.021759697256386, 1.111931818181818, 1.1224609089580593, 1.5, 1.1665146447755144, 1.0863874345549738, 1.0295652173913044, 1.0358381502890173, 1.0, 1.0336787564766838, 1.0652215386082893, 1.2636806508064136, 1.0834724540901504, 1.0982658959537572, 1.4444444444444444, 1.4322033898305084, 1.003671970624235, 1.2222222222222223, 1.0309798686635148, 2.0, 1.0526992287917738, 1.085281388288745, 1.025811209439528, 1.017015873015873, 1.297872340425532, 1.0555555555555556, 1.0712552571983176, 1.0606060606060606, 1.01231884057971, 1.0921696574225122, 1.0617349654071315, 1.0266444629475437, 1.2061215588680503, 1.1585365853658536, 1.0714285714285714, 1.0155511940424653, 1.0636027009366151, 1.249122807017544, 2.087227414330218, 1.0309523809523808, 1.2857142857142858, 1.2203389830508475, 1.086430861737758, 1.2916666666666667, 1.135243841126194, 1.0647617488128378, 1.0477777006547744, 1.0184005757451138, 1.0663414634146342, 1.0505526189332053, 1.0973916306999436, 1.0078028747433265, 1.0017291832934292, 1.0318819890554365, 1.0556896524523955, 1.0446638457921955, 1.174598954178853, 1.4048780487804877, 1.1267605633802817, 1.2771084337349397, 2.0, 1.5112781954887218, 1.0700949885358664, 1.3682634730538923, 1.2952380952380953, 1.0203150912106136, 1.1724137931034482, 1.04033812789806, 1.0134228187919463, 1.2090536942092922, 1.1111111111111112, 1.0301507537688441, 1.0002715915263445, 1.0191541544535503, 1.0092990054694357, 1.2, 1.1666666666666667, 1.0988478659334904, 1.0174964993537268, 1.0657534246575342, 1.0848896434634974, 1.0546056260341974, 1.1056883204308314, 1.3174603174603174, 1.0090994931154842, 1.0349003214021626, 1.108359133126935, 1.0568475452196382, 1.0225225225225225, 1.5, 1.2168112074716477, 2.0, 1.2397360703812317, 1.1546098629626176, 1.0629397967161844, 1.0774193548387097, 1.2142857142857142, 2.0, 1.0244952537690657, 1.0138888888888888, 1.1017856617538906, 1.2, 1.1157137966449846, 1.0784729586426298, 1.0, 1.0041627903309733, 1.0184331797235022, 1.1715817694369972, 1.2253521126760563, 1.0013976240391336, 1.1208338031799217, 1.0144927536231885, 2.0, 1.0617771195219465, 1.1396622546782291, 1.0974212034383954, 1.0088995769629097, 1.069348754207233, 1.0243936515032972, 1.1090548578982156, 1.0752683435384638, 1.0209267563527653, 1.0129491367242185, 1.161420596270341, 1.0, 1.0201765318840283, 1.0193321616871704, 1.1636363636363636, 1.3333333333333333, 1.1195652173913044, 1.0060362173038229, 1.0117820835867581, 1.007072385869373, 1.1662870159453302, 1.3695198329853862, 1.0061747964902183, 1.0928301886792453, 1.0738253815581729, 1.0683752207708799, 1.0, 1.103896103896104, 1.013973268529769, 1.0210310931777031, 1.0551215277777777, 1.0872350681864125, 1.142932768660667, 1.166758392955421, 1.0652251226972047, 1.0498711689720641, 1.0910354538233809, 1.008380877434586, 1.0359168241965973, 1.0818181818181818, 1.0714285714285714, 1.0975351580220778, 1.0, 1.0559701492537314, 1.016405777047479, 1.039146893176992, 1.5142857142857142, 1.0826446280991735, 1.0943025540275049, 1.0150442477876107, 1.0528131652530213, 1.0869565217391304, 1.213901240346361, 1.028116223151684, 1.0570071258907363, 2.0, 3.8333333333333335, 1.0782487191429901, 1.4285714285714286, 1.0009144117019209, 1.0573248407643312, 1.1818181818181819, 1.0890706709352533, 1.1666666666666667, 1.3333333333333333, 1.0184579299366423, 2.0, 1.0557692307692308, 1.0166270783847982, 1.1448741559238798, 1.0849162011173183, 1.1534526854219949, 1.1142857142857143, 1.0996420788781374, 1.0901297998918333, 1.0572792362768497, 1.0577681031552608, 1.1012240756009386, 1.5, 1.1, 1.0767797560766943, 1.2, 1.090190609019061, 1.5555555555555556, 2.0, 1.3333333333333333, 1.3811922753988246, 1.049257232212666, 1.3130434782608695, 1.0346504559270517, 1.186046511627907, 1.3333333333333333, 1.0634564567180649, 1.1111111111111112, 1.2272727272727273, 1.0221865941940436, 1.0901960784313725, 1.018896447467876, 1.0121381886087768, 1.1666666666666667, 1.0, 1.2987951807228915, 1.0875, 1.0217821782178218, 1.133499436435902, 1.2181818181818183, 1.0481012658227848, 2.0, 1.0332658972157132, 1.1045454545454545, 1.2121212121212122, 2.0, 1.0425531914893618, 1.5714285714285714, 1.138095238095238, 1.1862745098039216, 1.2218692699052194, 1.0623098206958657, 1.0100688924218335, 1.0983141469801954, 1.108651911468813, 1.0313199105145414, 1.0973451327433628, 1.1349534839567117, 1.105263157894737, 1.09375, 1.0194821125344544, 1.0456496145228058, 1.0381310418904404, 1.0571428571428572, 1.1282051282051282, 1.092130518234165, 2.0, 1.1041666666666667, 1.4395604395604396, 1.2155339805825243, 1.1848341232227488, 1.0241187384044528, 1.05614406779661, 1.0287769784172662, 1.0522301709479107, 1.0466439135381116, 1.1254579168739542, 1.0505050505050506, 1.1083333333333334, 1.09873417721519, 2.0, 1.2530551617041388, 1.6538461538461537, 1.1104826046652414, 1.0782970231165807, 1.0790378006872852, 1.1510981741201376, 1.5, 1.1457952468007313, 1.0, 1.182207931404073, 1.2727272727272727, 1.154698836807555, 1.0097560975609756, 1.0897951882658081, 1.1308724832214765, 1.185973207249803, 3.0, 1.156940509915014, 1.0134549244665023, 1.1577514997029343, 2.0, 1.054054054054054, 1.3060897435897436, 1.3009404388714734, 1.1290163991993538, 1.0205670040730734, 1.0909090909090908, 1.0561970746728253, 1.0187142403051495, 1.0596537510305029, 1.0252751200078372, 1.0234686779189397, 1.138353115727003, 1.3181818181818181, 1.0598210080075365, 1.0247193933694805, 1.0075757575757576, 1.050660792951542, 1.0, 1.5, 1.3249669749009247, 1.0766283524904214, 1.0413281525962557, 1.1309746920556802, 1.0491886409736308, 1.0, 1.1652173913043478, 1.2222222222222223, 1.01547452594536, 1.0434782608695652, 2.0, 1.0010559662090812, 1.0, 1.0, 1.009908536585366, 1.75, 1.0093307593307594, 1.0285493827160495, 1.005390835579515, 1.0769230769230769, 1.0729187422051998, 1.0914529914529914, 1.55, 1.0482825868142929, 1.104, 1.158868335146899, 1.0006622516556292, 1.3215277777777779, 1.0110436487067935, 1.0, 1.0813953488372092, 1.0876712328767124, 1.1253166694815064, 1.0415335463258786, 1.2, 1.093104079019572, 1.0096663548487683, 1.0390763765541742, 2.0, 1.0438538205980066, 1.00548822544093, 1.0165619786043774, 1.0061755462983264, 1.022141396782127, 1.013130540753662, 1.003486750348675, 1.110561797752809, 2.3333333333333335, 1.055853827502598, 1.0290758047767394, 1.067239263803681, 1.1065934065934067, 1.0769230769230769, 1.006052655324879, 1.1009615384615385, 1.0191641800571256, 1.1755055322396033, 1.0902499464618962, 1.1122448979591837, 1.121391304347826, 1.0288090737240076, 1.0227272727272727, 1.5, 1.0961282470619556, 1.0732758620689655, 1.0115696816360953, 1.0692268012840738, 1.3333333333333333, 1.1659125188536954, 1.8514285714285714, 1.375, 1.087719298245614, 1.0193594411099085, 1.1749049429657794, 1.013316151202749, 1.0, 1.3571428571428572, 1.0079908675799087, 1.1315628400435256, 1.0445729205520329, 1.0350702299247216, 1.115141955835962, 1.0772442588726514, 1.0051124744376279, 1.0078322865884901, 1.6626506024096386, 1.0109534981278063, 1.1232876712328768, 1.085427135678392, 1.0992153175794175, 1.0561797752808988, 1.0015140239677693, 3.0, 1.1335149863760219, 1.0230263157894737, 1.036775655039128, 1.043196544276458, 1.098, 1.0132450331125828, 1.2079722703639515, 1.1415612911982265, 1.0, 1.1206896551724137, 1.0, 1.0, 1.1826923076923077, 1.1397849462365592, 1.0610583446404342, 1.056, 1.0610748099746632, 1.1332191780821919, 1.0347579358042207, 1.2062949194547707, 1.046584536774417, 1.1336848437665876, 1.0194043642049897, 1.1212624584717608, 1.0400095831336846, 1.0506179810527636, 1.1001487357461577, 1.0681818181818181, 1.1161928306551299, 1.2992700729927007, 1.0663600790673282, 1.140552995391705, 1.1023561600692873, 1.3222222222222222, 1.1594064145524174, 1.3404152583293094, 2.0, 1.0432692307692308, 1.1176470588235294, 2.0, 1.2846153846153847, 1.0370824632629774, 1.039200904636261, 1.0181347150259068, 1.03125, 1.055751905306584, 1.0641721119467389, 1.11090573012939, 1.2, 1.5, 1.0646173149309912, 1.1798245614035088, 1.1007081038552322, 1.113065916021581, 1.0, 1.048577036310108, 1.203056768558952, 1.0908213868625494, 1.104874446085672, 1.0162965733252303, 1.0648243901629735, 1.0016305370320044, 1.2142857142857142, 2.0, 1.1892744479495267, 1.0, 1.0392857142857144, 1.2380952380952381, 1.3578947368421053, 1.2173913043478262, 1.5, 1.0134106524541742, 1.1027397260273972, 1.4452554744525548, 1.0912655971479501, 1.1695906432748537, 1.1329479768786128, 1.0020635962855267, 1.0027051397655546, 1.0555555555555556, 2.0, 1.0146828279738462, 1.0034814002965637, 1.0454545454545454, 1.0075394105551747, 1.2386284114765571, 1.0542005420054201, 1.0020110152909631, 1.2222222222222223, 1.1504424778761062, 1.0089067240873055, 1.091549295774648, 1.052325581395349, 1.0643555982871742, 1.0357142857142858, 2.125, 1.070871481858257, 1.050972501676727, 1.111401599728668, 1.2646955297430482, 1.0306380320937831, 1.0375425241672, 1.0672782874617737, 1.103379056540649, 1.1823204419889504, 1.073770981422854, 1.0734522560335782, 1.0015220700152208, 1.1157065484982767, 1.0125195287759152, 1.0689655172413792, 1.002450579970593, 1.2857142857142858, 1.3333333333333333, 1.1361323155216285, 1.591052480642386, 1.0367001254705144, 1.6, 1.2142857142857142, 1.0008071025020178, 1.026034236804565, 1.103030303030303, 1.0648813889250637, 2.3333333333333335, 1.1106161523140514, 2.0, 1.0398481973434535, 1.0, 1.0093078551338186, 1.5161290322580645, 1.1151079136690647, 1.0906713164777682, 1.0, 1.1824145593058935, 1.2780522230063514, 1.1666666666666667, 2.0, 1.1048951048951048, 1.1627906976744187, 1.0007442322004465, 1.1758584807492196, 1.1577380952380953, 1.1175482787573467, 1.0780856423173804, 1.0414012738853504, 1.1923076923076923, 1.3286713286713288, 1.0689655172413792, 1.0, 1.1566731141199227, 1.0387779083431257, 1.014260249554367, 1.0326086956521738, 1.0721019480248613, 1.0380215942700353, 1.09798617929859, 1.0959635338571343, 1.2161835748792271, 1.0125376128385155, 1.5, 1.5, 1.2352941176470589, 1.0299532474096538, 1.0625920471281296, 1.0970350404312668, 1.2313883299798793, 1.003055962309798, 1.0618892508143323, 1.015524112935471, 1.0833333333333333, 1.380952380952381, 1.1419753086419753, 1.0430486536461343, 1.0766829831701683, 1.0171835338262885, 1.0279329608938548, 1.1221449239672474, 1.0440210362962323, 1.0815659606967658, 1.0764662212323681, 1.0863695383508283, 1.2523961661341854, 1.0690750297737197, 1.183673469387755, 1.0341114304705308, 1.1481481481481481, 1.092289321050836, 1.0, 1.0077821011673151, 1.004640842116657, 1.0476190476190477, 1.0577784859288175, 1.0495412844036698, 1.170731707317073, 1.0441791233848492, 1.0167186937207349, 1.071037181996086, 1.0505529225908372, 1.024459078080903, 1.1941153349430063, 1.1786339754816113, 1.411764705882353, 1.0, 1.5, 1.0691950776679444, 1.1111111111111112, 1.1010643794564432, 1.114295975398981, 1.018560606060606, 1.060717264386989, 1.0635125958024771, 1.0609041044070362, 1.0694006309148265, 1.0222222222222221, 1.0022685348718552, 1.105950568115263, 1.041730332868414, 1.176593128027508, 1.375, 1.009433962264151, 1.0256410256410255, 1.0856821069654614, 1.0542005420054201, 1.260524575710822, 1.045241809672387, 2.273381294964029, 1.0491745674784698, 1.081447963800905, 1.0770878584381165, 1.2222222222222223, 1.051028314192403, 1.0143562936059733, 1.3343504795117698, 1.051255230125523, 1.1818181818181819, 1.1258169934640523, 1.2578313253012048, 1.0177541682336717, 1.0803571428571428, 1.0185139828453584, 1.7567567567567568, 1.046360549239628, 1.02652683528686, 1.008816120906801, 1.0411764705882354, 1.0137362637362637, 1.0879120879120878, 1.0449438202247192, 1.0040620948187726, 1.0846303501945525, 1.0650629641588634, 1.0742870100136783, 1.0714285714285714, 1.082679971489665, 1.0021186440677967, 1.140116763969975, 1.0178189593727727, 1.0766871165644172, 1.112112112112112, 1.0816326530612246, 1.0272952853598014, 1.0170554822252214, 1.1935483870967742, 1.105017502917153, 1.2279617072197846, 1.0453763440860215, 1.1030405405405406, 1.0722072272085492, 1.143035728065437, 1.0580774365821095, 1.0977596741344195, 1.1054407526908203, 1.1129785508543304, 1.096969696969697, 1.0276497695852536, 1.0547692307692307, 1.0874225285851622, 1.15625, 2.0, 1.0624181779897648, 1.1752739503092113, 1.0161596958174905, 1.0339805825242718, 1.2217180883242589, 1.0202345260282217, 1.186436672967864, 1.1748044240625843, 1.2580645161290323, 1.0261512222853895, 1.2222222222222223, 1.163978494623656, 1.6875, 1.069258695834772, 1.2262103505843072, 1.0093731693028705, 1.1020408163265305, 1.0360860513532268, 1.0959622443628736, 1.0808080808080809, 1.3488372093023255, 1.0303405572755417, 1.0235294117647058, 1.0353773584905661, 1.3076923076923077, 1.0319826997496016, 1.0440528634361232, 1.0129991802318772, 1.3302752293577982, 1.2533333333333334, 1.131694468832309, 1.0341386479317514, 1.0143033822659568, 1.0390977443609022, 1.3442622950819672, 1.2352941176470589, 1.3142857142857143, 1.0919540229885059, 1.0493827160493827, 1.1759656652360515, 1.0352472996020465, 1.032406949425003, 1.2844827586206897, 1.0809714060995002, 1.046240244146488, 3.0, 1.034693280964231, 1.091934497519875, 2.0, 2.0, 1.1950678175092477, 1.1171338074463635, 1.0965559254182713, 1.117948717948718, 1.0, 1.125, 1.2820512820512822, 1.2173913043478262, 1.088138796572557, 1.131434303460027, 1.044612291106943, 1.0457849625691658, 1.4285714285714286, 1.0359520715214008, 1.0405405405405406, 1.0372294372294373, 1.1139896373056994, 1.0138888888888888, 1.0, 1.2457378012933569, 1.2234674063800277, 1.0069819310211074, 1.397872340425532, 1.160535117056856, 1.1080158387694494, 1.0481125092524057, 1.0451388888888888, 1.1764705882352942, 1.0035592294029239, 1.4008873622441678, 1.0626833168205139, 1.3076923076923077, 1.1219512195121952, 1.0442708333333333, 1.125, 1.066223162987602, 1.0460358056265984, 1.0041408633416447, 1.0780399274047188, 2.0, 1.1886537595677622, 1.0295862864677765, 1.185860058309038, 1.17022643327445, 1.009124686405064, 1.0577672605790647, 1.1369092678706607, 1.4186666666666667, 1.0740740740740742, 1.0880544288891796, 1.0748420457853192, 1.2091346153846154, 1.1945392491467577, 2.3333333333333335, 1.0240963855421688, 1.0080295339178589, 1.0229357798165137, 1.0105169176634323, 1.0902902057353931, 1.0242030696576152, 2.0, 1.1036717062634989, 1.013813903265443, 1.1604844814534443, 1.0161812297734627, 1.0645645496386573, 1.0159151193633953, 1.3016759776536313, 1.0009699321047527, 1.0328234650283155, 1.0447194699796911, 1.0247855100095329, 1.0299334811529934, 1.0555555555555556, 1.108867150520669, 1.1478725082838057, 1.0137370438733495, 1.0055834729201563, 1.0731707317073171, 1.0519563822963438, 1.1224489795918366, 1.1759656652360515, 1.6666666666666667, 2.5, 1.25, 1.021505376344086, 1.018457481872116, 1.043357546408394, 1.013272617787802, 1.0061182868796736, 1.0837959750173491, 1.266355140186916, 1.048780487804878, 1.0358470712030867, 1.5, 1.2777777777777777, 1.2444595976815547, 1.0, 1.1540436456996148, 1.09471987101975, 1.0022586959795212, 1.085479396440896, 2.0, 1.0836993025058124, 2.0, 1.1062014177927286, 1.03930429600654, 1.2016718913270636, 1.1230373965172709, 1.151276683240495, 1.0985331160171878, 1.0204638472032743, 1.0465116279069768, 1.0832369942196531, 1.0, 3.0, 1.0403724164631605, 5.0, 1.8571428571428572, 2.392857142857143, 1.0566844919786096, 1.0624819586952527, 1.0657223796033994, 1.0396825396825398, 1.1428571428571428, 1.0177690029615005, 1.018941233608548, 1.4545454545454546, 1.2544378698224852]
origin-bjaq_15.71 	max: 5.0000	99th: 2.3939	95th: 1.8601	median: 1.0822	mean: 1.1773

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.311424 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.371491