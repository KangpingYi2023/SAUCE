Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 57, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.7525	95th: 1.6667	median: 1.0854	mean: 1.1748
ReportEsts: [1.0294117647058822, 1.01796875, 1.0351764246343476, 1.0833333333333333, 1.5789473684210527, 1.0, 1.0925832350794453, 1.0533671215197147, 1.0, 1.0090673575129534, 1.1536086341730876, 1.0428496070766775, 1.0568131380381713, 1.1325581395348838, 1.0427410808901447, 1.0, 1.5, 1.0276301806588735, 3.0, 2.0, 1.125, 1.0990756103342023, 1.0982900404646914, 1.0851438637698179, 1.0626541687222497, 1.0, 1.147694292163818, 1.5, 1.6, 1.0359712230215827, 1.0, 1.0420299496433623, 1.0051639929137346, 1.1087680355160932, 1.0947275664561609, 1.227744992103732, 1.1016042780748663, 1.0091596992834948, 1.145740064742751, 1.0714285714285714, 1.1659192825112108, 1.0274390243902438, 1.0, 1.0645218680504076, 1.133788037775446, 1.8615384615384616, 1.03, 1.2579505300353357, 1.0264728603374669, 1.0093457943925233, 1.1493479524877481, 1.3470790378006874, 1.038997960487011, 2.0, 1.103896103896104, 1.1979451797967677, 1.1873920552677029, 1.3526570048309179, 1.0248447204968945, 1.25, 1.1204334787350054, 1.1002490660024906, 1.0909090909090908, 1.0116279069767442, 1.0, 1.050352650330837, 1.3523556735235567, 1.75, 1.0, 1.0165936422112427, 1.0083532219570406, 1.0584490740740742, 1.0373831775700935, 1.1331462576805844, 1.0470588235294118, 1.0485436893203883, 1.0, 1.1139874739039666, 2.0, 1.0114352053402988, 1.3333333333333333, 1.0234329107434663, 1.1533742331288344, 1.058252427184466, 1.1359175662414132, 1.04, 1.0723447126748558, 1.0384330667572783, 1.0686274509803921, 1.75, 1.0903790087463556, 1.076036256477522, 1.087227414330218, 1.0156695156695157, 1.0330188679245282, 1.1012987012987012, 1.007462686567164, 1.142300194931774, 1.0, 1.2281643835616438, 1.0047516198704103, 1.0728987993138936, 1.2231957872928176, 1.36, 1.0149418822058052, 1.1229094770374304, 1.1027474765762912, 1.1592718998862344, 1.047516860821582, 1.3333333333333333, 1.6666666666666667, 1.047196261682243, 1.0745971949170228, 1.0726468730259002, 1.12987012987013, 1.0523063272472788, 1.0, 1.151687164932198, 1.1956521739130435, 1.0, 1.011111111111111, 1.0, 1.2230576441102756, 1.0290937260131514, 1.0050477595713287, 1.0980392156862746, 1.8, 1.2516556291390728, 1.0, 1.1071428571428572, 1.0885380989868216, 1.3, 1.0657552083333333, 1.040300953983935, 1.032007759456838, 1.1455273698264352, 1.140625, 1.0265003897116134, 1.039972432804962, 1.076173065204144, 1.0435372994992786, 1.218045112781955, 1.0189171559034573, 1.1006559491791508, 2.0, 1.0186873290793073, 1.0210035005834306, 1.0921409214092141, 1.1256396682548084, 1.5, 1.288689755388714, 1.0, 1.0204081632653061, 1.1074561403508771, 1.0175182481751825, 1.027364045722203, 1.1386090837806864, 1.1151448109412712, 1.0395256916996047, 1.105263157894737, 1.2653061224489797, 1.2545454545454546, 1.027982326951399, 1.5714285714285714, 1.0647146595985069, 1.0151812061090821, 1.1938144329896907, 1.344953423605109, 1.11740614334471, 1.0854734833426096, 1.3136842105263158, 1.1069767441860465, 1.1016752202963107, 1.140546006066734, 1.0721554116558742, 1.0787172011661808, 1.0276999688764394, 1.1036900842348314, 1.078131634819533, 1.0, 1.1349206349206349, 1.020604007902907, 1.0279106858054226, 1.1573538856775851, 1.118421052631579, 1.0802394478040438, 1.3200076878723812, 1.1647944938640349, 1.1153846153846154, 1.135909090909091, 1.16688745266482, 1.0, 1.3636363636363635, 1.098664299261531, 1.0208574739281575, 1.0046317739694304, 1.4583333333333333, 1.0694533762057878, 1.0642081626990447, 1.0641248246978123, 1.0626410835214446, 1.0159563075605054, 1.192090395480226, 1.0847457627118644, 1.1666666666666667, 1.0, 1.3675213675213675, 1.0930452609998422, 1.3414634146341464, 1.2413793103448276, 1.0128521997034108, 1.0031277926720286, 1.0357009776957609, 1.0685828431916546, 1.1279027177496155, 1.1069182389937107, 1.0712074303405572, 1.0055392636037797, 1.0205640760526165, 1.0531995799080143, 1.0, 1.0782608695652174, 1.078013905028263, 1.0087427363154815, 1.1539408866995073, 1.0248918327012446, 1.2840927605496117, 1.0357142857142858, 1.0036795328788137, 1.1084321815368747, 1.0102564102564102, 1.1497005988023952, 1.0845894263217097, 1.0456479690522245, 1.1141732283464567, 2.0, 1.2277342616768203, 1.1218177757927645, 1.1443975621190812, 1.2126696832579185, 1.0, 1.6666666666666667, 1.0853484813844287, 1.1454545454545455, 1.1086059743954482, 1.5, 1.0, 1.1428571428571428, 1.020310633213859, 1.030612244897959, 1.0359116022099448, 1.1128691983122363, 1.0400667779632722, 1.002103491796382, 1.0511410928940594, 1.0363636363636364, 2.0, 1.0621080336397097, 1.064728229105786, 1.117338003502627, 1.0186675585843594, 1.1117260072846373, 1.0044645063508015, 1.089825119236884, 1.0736932908473145, 1.0257177033492824, 1.002787456445993, 1.0370606214977076, 1.0909090909090908, 1.0600789507194703, 1.284931506849315, 1.1590909090909092, 1.4705882352941178, 1.0021818181818183, 1.0555555555555556, 1.017094017094017, 1.1069914541417132, 1.3426183844011141, 1.355889724310777, 1.0350701704699523, 1.0318791946308725, 1.0392438866997102, 1.0522586804683183, 1.25, 1.0116405965805748, 2.5, 1.0465890474563502, 1.0311804008908685, 1.0476127622775477, 1.0810810810810811, 1.6666666666666667, 1.4782608695652173, 1.0923076923076922, 1.0417595077733326, 1.0, 1.0825688073394495, 1.0407239819004526, 1.0052083333333333, 1.017485827796106, 1.1183431952662721, 1.1257861635220126, 1.007123646463226, 1.1508481750398853, 1.0869338433452143, 1.1452991452991452, 1.0, 1.1241050119331741, 1.264797507788162, 1.1223776223776223, 1.122451558550969, 1.0170975813177647, 1.0056657223796035, 1.3409090909090908, 1.0027434842249656, 1.0745772109786527, 1.2857142857142858, 1.010296293720613, 1.0479846449136276, 1.0526315789473684, 1.0794521672504378, 1.2380952380952381, 1.4, 1.0150468099494918, 2.0, 1.2373113854595337, 1.0392441860465116, 1.047579983593109, 1.0827190827190827, 1.2236421725239617, 1.058139534883721, 1.1164653201477293, 1.0778218641221002, 1.063768115942029, 1.0779885443552664, 1.063008430705517, 2.0, 1.0, 1.0528234191823396, 1.25, 1.0697544642857142, 1.3529411764705883, 1.0, 1.375, 1.3504016064257027, 1.0569561157796452, 1.4021739130434783, 1.0108225108225108, 1.0, 1.1098535286284954, 1.0823044718807497, 2.0, 1.1024419297200714, 1.0, 1.0955439155849085, 1.0229885057471264, 1.0050635582045466, 1.140552995391705, 1.1363636363636365, 1.2901098901098902, 1.3703703703703705, 1.0199067312183512, 1.0285711468556291, 1.0759312320916905, 1.0, 1.0769230769230769, 1.5714285714285714, 3.0, 1.1428571428571428, 1.0695621154017658, 1.3333333333333333, 1.0083194675540765, 1.160919540229885, 1.2006388804380894, 1.093114302405678, 1.239958805355304, 1.0057738629386483, 1.0087006960556844, 1.0345238095238096, 1.5, 1.2030075187969924, 1.123404255319149, 1.0358108325555948, 1.0952380952380953, 1.5714285714285714, 1.0111358574610245, 1.011764705882353, 1.030243072214265, 1.0049261083743843, 1.1464387464387464, 1.0213406292749658, 1.0810810810810811, 1.0907770515613653, 1.0635593220338984, 1.1538461538461537, 1.0254957507082152, 1.2058823529411764, 1.090730806009822, 1.0763371758938938, 1.0243858659418432, 1.036144578313253, 1.027027027027027, 1.098159509202454, 1.0, 1.0251393841981014, 1.0540915619971272, 1.0006763611768685, 1.0571280881252005, 1.070419651995906, 1.1471242453129966, 1.5714285714285714, 1.2208480565371025, 1.0, 1.2374039282664389, 1.25, 1.0416157363393543, 1.017391304347826, 1.1262897678417885, 1.1185770750988142, 1.090113735783027, 3.0, 1.21365090650551, 1.0029046425616819, 1.1558993930476367, 2.0, 1.1587301587301588, 1.2571976967370442, 1.183673469387755, 1.089549205316857, 1.2702702702702702, 1.105263157894737, 1.0821661998132586, 1.0169443989996962, 1.0290971248583556, 1.1098662811709432, 1.098793859649123, 1.1525704809286899, 1.0303030303030303, 2.142857142857143, 1.0591397849462365, 1.5, 1.2267782426778242, 1.3636363636363635, 1.104521226856181, 1.5625, 1.1237643830490505, 1.193644846964203, 1.095003084515731, 1.0, 1.2527472527472527, 1.04, 1.2870736715580708, 1.3676148796498906, 1.0, 1.021829234595192, 1.0786784503785358, 1.0891007045171985, 1.5, 2.0, 1.0019417475728156, 1.0099547511312217, 1.0032786885245901, 1.1111111111111112, 1.0732795242141036, 1.0895061728395061, 1.4705882352941178, 1.1131073446327684, 1.0454545454545454, 1.2020997375328084, 1.0564516129032258, 1.3138409760201935, 1.0271816037735848, 1.0, 1.0724637681159421, 1.0643882504977122, 1.0375564068109344, 1.0224303912352921, 1.0, 1.0955540809555409, 1.0099551166081684, 1.0220010476689365, 1.0, 1.0518341307814991, 1.0318177402117945, 1.0428945741454942, 1.0059411995980954, 1.0113723817355855, 1.0492774224117507, 1.0201680672268907, 1.149228543876567, 2.0, 1.0325598222130343, 1.7209302325581395, 1.0, 1.1865284974093264, 1.1346153846153846, 1.004340601154424, 1.1665014866204162, 1.0697574402201961, 1.1353832033042681, 1.0751350763317258, 1.0865683754903286, 1.0571101633205036, 1.10752688172043, 4.0, 1.0172080182451086, 1.1678137651821863, 1.0462075339787418, 1.0414440682517911, 1.0839675291730086, 1.0222658808120497, 2.247311827956989, 2.5714285714285716, 1.0089412920658314, 1.062282040711731, 1.0132978723404256, 1.1087272727272728, 1.0134737755495564, 1.025369978858351, 1.0631313261656146, 1.0158904109589042, 1.2323390894819466, 3.0, 1.1666666666666667, 1.0107361963190185, 1.0782442748091603, 1.0875912408759123, 1.1713091922005572, 1.0392156862745099, 1.5307692307692307, 1.148905109489051, 1.123456790123457, 1.0285917081184424, 1.202127659574468, 1.0194016291209214, 2.0, 1.1826677994902295, 1.008, 1.2935779816513762, 1.1011173184357541, 1.0665110851808635, 1.0411522633744856, 1.0583657587548638, 1.1286146919304263, 1.0, 1.1702127659574468, 1.2, 1.0, 1.1022727272727273, 1.010183299389002, 1.037037037037037, 1.0485436893203883, 1.0648830503043896, 1.0278422273781902, 1.1088067156667236, 1.16554617020054, 1.0386398763523956, 1.0896922573079646, 1.0335195530726258, 1.099544567338972, 1.0488630865989357, 1.0615141955835963, 1.119942196531792, 1.1577139287945035, 1.017534079967567, 1.2926142001031868, 1.0778382333848715, 2.0, 1.0663390663390664, 1.0618253189401374, 1.4205607476635513, 1.0, 1.1333333333333333, 1.25, 1.2472406181015452, 1.2592592592592593, 1.1666666666666667, 1.0056098084564318, 1.1167563061900887, 1.0293140019141727, 1.0461113304382155, 1.2, 1.1197278911564625, 1.0, 1.0921985815602837, 1.023651510872635, 1.0903259223842536, 1.0845690756039716, 1.068401868094316, 1.023346873055952, 1.1428571428571428, 1.1472240616922649, 1.152753108348135, 1.0629526649774648, 1.029612756264237, 1.303030303030303, 1.0612460401267159, 1.0, 1.2387640449438202, 1.2106270844484703, 3.0, 1.1283643892339545, 1.0884691381257057, 1.4285714285714286, 1.0355504159361362, 1.1, 1.1176470588235294, 1.0942089071084833, 1.6923076923076923, 1.0260021995818378, 1.0469884664673217, 1.3103448275862069, 1.2083333333333333, 1.0474226804123712, 1.021999043519847, 1.0082350322724238, 1.0707005547671269, 1.155066522395111, 1.0, 1.012328915924397, 1.1219512195121952, 2.0, 1.0144613326567797, 1.1040228393459641, 1.1078524124881741, 1.022633640039479, 1.0315449044304357, 1.0176991150442478, 2.0, 1.0301724137931034, 1.0467741935483872, 1.1173026996759032, 1.1447117220313097, 1.013652933891057, 1.0153108847991752, 1.1465201465201464, 1.0591016548463357, 1.234113712374582, 1.0999951042788603, 1.0921135646687696, 1.0250696378830084, 1.2200630252100841, 1.0302726525598995, 3.0, 1.1412500373993957, 1.0364612309657744, 1.0211836903286717, 1.5833333333333333, 1.3124566032495486, 1.4041450777202074, 1.1428571428571428, 1.0558651336672074, 1.0420575865415722, 1.1615720524017468, 1.0, 1.3333333333333333, 1.0650835468095017, 1.5, 1.0864485981308412, 1.0833333333333333, 1.0051199326693785, 1.3846153846153846, 1.109704641350211, 1.0450733752620545, 1.0, 1.708994708994709, 1.2532786885245901, 1.5, 2.0, 1.1083333333333334, 1.1793103448275861, 1.0114251352976549, 1.19125, 1.103448275862069, 1.2005899705014749, 1.1014466214978942, 1.0597402597402596, 1.2189054726368158, 1.2571428571428571, 1.0, 1.0, 1.1833333333333333, 1.0880230880230881, 1.024793388429752, 1.067343555739743, 1.0666513116121563, 1.0703851261620185, 1.0584294311208609, 1.0974190283400809, 1.2131386861313869, 1.0084235860409145, 1.5714285714285714, 1.0, 1.2592592592592593, 1.0277604917659557, 1.053839364518976, 1.107843137254902, 1.0985221674876848, 1.0147229755908562, 1.0316178804565341, 1.0027420291627183, 1.0833333333333333, 1.2222222222222223, 1.040030792917629, 1.0159585213116962, 1.0876226000366342, 1.001376480709417, 1.0263157894736843, 1.0961311281748376, 1.0116998528988035, 1.1726726726726726, 1.359979633401222, 1.125, 1.0369850187265917, 2.06993006993007, 1.1304347826086956, 1.1915584415584415, 1.0701001430615165, 1.0, 1.0656934306569343, 1.0433828864552925, 1.0588235294117647, 1.0722581775049953, 1.039647577092511, 1.131578947368421, 1.005972041097393, 1.0198269646719538, 1.0783977974751544, 1.0276717557251909, 1.1040100250626566, 1.1919524401303194, 1.225382932166302, 1.2142857142857142, 1.0, 1.25, 1.0577933874288483, 1.3333333333333333, 1.165016501650165, 1.1237682408055572, 1.0136986301369864, 1.0764647467725919, 1.0536402104242957, 1.0832797427652734, 1.032258064516129, 1.0027739251040222, 1.0043487449221593, 1.1291479190101237, 1.0445791940394167, 1.2425328194628447, 1.4285714285714286, 1.0, 1.0368852459016393, 1.0933134597386391, 1.0781758957654723, 1.2644628099173554, 1.0560747663551402, 2.2401746724890828, 1.0823364774155801, 1.044295302013423, 1.1068301435406698, 1.25, 1.0634280940390182, 1.0316933731261715, 1.3282722513089005, 1.0581052631578947, 1.28, 1.134872417982989, 1.1043956043956045, 1.5625, 1.106725419171739, 1.6538461538461537, 1.2009685230024214, 1.1206896551724137, 1.0115961800818554, 1.0262657681009157, 1.0191846522781776, 2.75, 1.103448275862069, 1.094543917055774, 1.0739207733762988, 1.0130868701710258, 1.002252141982864, 1.0653446713598662, 1.1818181818181819, 1.1104294478527608, 1.0293585360949125, 1.0402696548953079, 1.031062124248497, 1.0138888888888888, 1.0888561610211094, 1.0109320815359892, 1.3240384615384615, 1.0755503011878624, 1.0, 1.3333333333333333, 1.051986452075453, 1.006657223796034, 1.2429464839833866, 1.0982670744138634, 1.0678371907422186, 1.0922330097087378, 1.1042966555282845, 1.0865589459539182, 1.1452205882352942, 1.0571428571428572, 1.0, 1.0806336818337996, 1.0952380952380953, 1.75, 1.0520814071117008, 1.165894526142472, 1.0471641791044777, 1.0173410404624277, 1.2465604634322955, 1.0271252776448574, 1.159122856339612, 1.0025, 1.2307692307692308, 1.0316711590296497, 1.1613691931540342, 1.140625, 1.5357142857142858, 1.0719745222929937, 1.1774033696729436, 1.1525704809286899, 1.048780487804878, 1.0183234694218746, 1.0326546292739147, 1.0589692101740293, 1.2149930679342444, 1.3333333333333333, 1.2727272727272727, 1.3333333333333333, 1.1445489376523859, 1.4230769230769231, 1.0, 1.1538461538461537, 1.0516556291390728, 1.0634057971014492, 1.0432674174255079, 1.0280956824991405, 1.3709090909090909, 1.3333333333333333, 1.1428571428571428, 1.0333333333333334, 1.0810810810810811, 1.1285714285714286, 1.1184668989547037, 1.02662042508932, 1.0342324960112796, 1.3333333333333333, 1.0659335398671892, 1.0475401631549972, 2.5, 1.0688731244258447, 1.1884550084889642, 3.0, 2.0, 1.2494082840236687, 1.1562074159076239, 1.101914673035787, 1.124223602484472, 1.0, 1.167420814479638, 1.147239263803681, 3.0, 2.0, 1.1013550135501355, 1.2220728592552763, 1.0083154844399647, 1.6666666666666667, 1.0396370303357607, 1.0472501936483347, 1.035031847133758, 1.0, 1.0422535211267605, 1.023958752809414, 1.0789473684210527, 1.15529352734571, 1.0033470197902274, 1.257396449704142, 1.10546875, 1.1130872071630076, 1.0782688766114181, 1.115702479338843, 1.2105263157894737, 1.0308662734901117, 1.4074711654329488, 1.0776441647460622, 1.3712574850299402, 1.1568627450980393, 1.3134328358208955, 1.1016483516483517, 1.058016219588272, 1.0082645453002885, 1.1050009580379383, 1.012008733624454, 1.5, 1.6666666666666667, 1.0919900274883334, 1.1996481970096746, 1.206380081696168, 1.020513984855365, 1.0061883258069912, 1.1237395317039822, 1.1635883905013193, 1.0212765957446808, 1.0625736970363966, 1.0691890448110786, 1.2138769670958511, 1.059369202226345, 1.6666666666666667, 1.0273972602739727, 1.088096758741817, 1.136919315403423, 1.0482552245151584, 1.1110090298194035, 1.013678905687545, 2.0, 1.1088082901554404, 1.051228843032692, 1.16335389536212, 1.0950570342205324, 1.0982096028226769, 1.1210191082802548, 1.4834437086092715, 1.0342028985507246, 1.0312056583163678, 1.0557285966832224, 1.054147465437788, 1.0597014925373134, 1.0, 1.1726279931870554, 1.0505530670079533, 1.0039630118890357, 1.0445997328126606, 1.1294783155248271, 1.0491679273827534, 1.2857142857142858, 1.236220472440945, 1.6666666666666667, 2.0, 1.1764705882352942, 1.0051150895140666, 1.042654028436019, 1.023177172384969, 1.0019584063628924, 1.105291723202171, 1.0010460251046025, 1.1304347826086956, 1.1136363636363635, 1.0273925517512292, 1.6, 1.5833333333333333, 1.2617972917521543, 1.1428571428571428, 1.060734463276836, 1.1386386386386387, 1.0350608382154123, 1.0808216065313012, 2.0, 1.0207430340557275, 1.2248062015503876, 1.0024937655860349, 1.0404690037340478, 1.1742424242424243, 1.1184931506849316, 1.1494795747062114, 1.1500525957552132, 1.028616852146264, 1.2033898305084745, 1.0879888268156424, 1.0, 1.0, 1.0418261149458174, 5.0, 1.4285714285714286, 1.9285714285714286, 1.0120627261761157, 1.146341463414634, 1.0909090909090908, 1.1169085916045507, 1.0, 1.127250155183116, 1.0134345794392523, 1.1989247311827957, 1.2884615384615385, 1.4285714285714286, 1.065975494816211, 1.020509977827051, 1.1368653421633554, 1.0037188545927853, 1.0129162164816816, 1.0477934272300469, 1.1369417332150251, 1.0, 1.1928332698735034, 1.0494530625740501, 1.0454626972740315, 1.1774193548387097, 1.0697064720094587]
origin-bjaq_15.71 	max: 5.0000	99th: 2.7525	95th: 1.6667	median: 1.0854	mean: 1.1748

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 13.891558 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[1.5497208e-06 7.7486038e-07 7.7486038e-07 5.3644180e-07 7.1525574e-07]
Distance score: 8.702278364580707e-07
SAUCE Drift detection: False
Detection latency: 0.0231s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.031153 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 3.0000	95th: 1.8000	median: 1.0819	mean: 1.1866
ReportEsts: [1.0364583333333333, 1.0217485863418878, 1.0646842705373465, 1.0751748251748252, 1.3333333333333333, 1.0, 1.0972970440811356, 1.0528697411606012, 1.0, 1.036105032822757, 1.1139140053866872, 1.0428759250215995, 1.0200214515552377, 1.094412331406551, 1.0291691219799646, 1.3333333333333333, 1.200657894736842, 1.2857142857142858, 1.2727272727272727, 1.062809917355372, 1.0820787331325974, 1.0603008502289077, 1.016359918200409, 1.0239076669414675, 1.0247938290914262, 1.0316861398076105, 2.0, 1.1368302712937488, 1.5, 1.4, 1.016602809706258, 1.0, 1.0477279686560392, 1.0053306406763762, 1.1102873030583873, 1.015255905511811, 1.2319505246334514, 1.152808988764045, 3.0, 1.0232458489555436, 1.1688516968851697, 1.0187650360866078, 1.1503184713375796, 1.0690400363967243, 1.0074349442379182, 1.076799507826919, 1.2272727272727273, 1.2083333333333333, 1.6217948717948718, 1.0268997982515131, 1.0571428571428572, 1.221276595744681, 1.0576131687242798, 1.0294117647058822, 1.0438439557709032, 1.0089358911296933, 1.03570912245193, 1.011764705882353, 1.063157894736842, 1.0321012980265338, 1.390625, 1.1027841473014135, 1.0880121396054627, 1.0452830188679245, 1.092783505154639, 5.0, 1.0958990536277602, 1.3031496062992125, 1.8, 2.0, 1.0474676180873341, 1.0183861082737486, 1.0627716079188798, 1.0426356589147288, 1.164534499834929, 1.0294520547945205, 1.0091863517060367, 1.4322580645161291, 1.4660194174757282, 1.1163150427898036, 1.052322738386308, 1.1764705882352942, 2.0, 3.0, 1.0422374429223744, 1.0819672131147542, 1.375497215592681, 1.2692307692307692, 3.0, 1.113722091138184, 1.122665856991043, 1.2525787412433118, 1.0353366278760827, 1.1509859154929578, 1.0693069306930694, 1.043580683156655, 1.154627539503386, 1.0308310991957104, 1.1256038647342994, 1.3411905713144228, 1.037037037037037, 2.0, 1.0663752699830114, 1.224892703862661, 1.1068592057761732, 1.2376215979888512, 1.4482758620689655, 1.0194693508907418, 1.0704660923348797, 1.074093112057571, 1.1188899400819932, 1.0447112927950946, 1.0, 3.0, 1.0905930075333206, 1.0394524354147219, 1.0377260981912144, 1.2197802197802199, 1.0611818444333605, 2.0, 1.084772370486656, 1.1118942731277532, 1.5, 1.023041474654378, 1.0, 1.1827731092436975, 1.0332482855246663, 1.0830042084817093, 1.0873015873015872, 1.6666666666666667, 1.1684136967155836, 1.0, 1.1290322580645162, 1.1336574626181084, 1.1538461538461537, 1.0522466039707419, 1.0008744645288408, 1.047255418963805, 1.0, 1.5714285714285714, 1.0466101694915255, 1.0213713268032056, 1.0773169482846903, 1.0304796024339073, 1.2371794871794872, 1.0290791599353797, 1.145334132393422, 3.0, 1.0181200453001134, 1.0056980056980056, 1.0889014722536807, 1.1180197436275232, 1.5, 1.2142204164550534, 1.0651041666666667, 1.0068493150684932, 1.2926829268292683, 1.0, 1.0015007503751876, 1.1366008911521324, 1.2514581373471307, 1.0702341137123745, 1.1054054054054054, 1.3103448275862069, 1.3529411764705883, 1.0012121212121212, 1.5, 1.0630508125166012, 1.2622950819672132, 1.1715481171548117, 1.0047378807059348, 1.2916666666666667, 1.013406841247964, 1.3173758865248226, 1.1585365853658536, 1.0762180414857694, 1.0060975609756098, 1.0258620689655173, 1.0819140308191404, 1.0180062630480167, 1.4134511359538406, 1.2111225806451613, 1.1455696202531647, 1.2142857142857142, 1.0269715395463899, 1.069305211994966, 1.2907801418439717, 1.184224049331963, 1.0437956204379562, 2.0, 1.21875, 1.0748812317554806, 1.3043478260869565, 1.1318295739348372, 1.1787724615717687, 1.066186365079605, 1.0505963525862032, 1.0886454183266931, 1.0464866102082857, 1.1204855082664664, 1.0325, 1.0642361111111112, 1.0220745312129125, 1.0450208578040185, 1.0695815702867888, 1.0022855133614628, 1.1435185185185186, 1.1176470588235294, 1.2142857142857142, 2.0, 1.525925925925926, 1.1281611092769892, 1.2905982905982907, 1.2115384615384615, 1.0098643649815042, 1.1428571428571428, 1.0490396876140111, 1.054245283018868, 1.2016863810741687, 1.0, 1.092961487383798, 1.0016238159675237, 1.0561567744870353, 1.0017188857800399, 1.2666666666666666, 1.1539313399778517, 1.092468908337172, 1.0435186907197322, 1.0, 1.0774299835255354, 1.1127725856697819, 1.0758158335798087, 1.4224137931034482, 1.0056867287022875, 1.02466529929899, 1.107361963190184, 1.0110450297366185, 1.0528735632183908, 1.0, 1.096981374438022, 2.0, 1.2223282442748091, 1.0543968040135643, 1.1185243328100472, 1.1392857142857142, 1.0769230769230769, 1.25, 1.079909144196952, 1.0294117647058822, 1.122089025739141, 1.8, 1.0711997152011392, 1.0686175580221997, 1.375, 1.0123474492559665, 1.0022271714922049, 1.159369527145359, 1.1238938053097345, 1.0204369274136715, 1.0890660812861155, 1.0142857142857142, 2.0, 1.0702424044878283, 1.0349270137698718, 1.1793721973094171, 1.0255981611116916, 1.1813029039426701, 1.0034397226295377, 1.0797385620915032, 1.0926900799178825, 1.0446247464503042, 1.0257291913682713, 1.0313324190315434, 1.0909090909090908, 1.0120535488759788, 1.099609375, 1.2549019607843137, 1.35, 1.0969432539887438, 1.0065861690450055, 1.0393417514114232, 1.0229154294896425, 1.0895196506550218, 1.3731958762886598, 1.0165360969092192, 1.0479887085391673, 1.1535855448898926, 1.0530190909683244, 1.0909090909090908, 1.0369761709120788, 1.0012217470983507, 1.0267492608756863, 1.0648226606948312, 1.0531022665784886, 1.2813487881981032, 1.1747191011235956, 1.0417999573469823, 1.060815409746801, 1.1683018049758795, 1.0599691610985318, 1.0046511627906978, 3.0, 1.1428571428571428, 1.085230677052127, 1.8333333333333333, 1.0422794117647058, 1.004107731059872, 1.0052241145125902, 1.2682926829268293, 1.024, 1.20863309352518, 1.0243558065654783, 1.0443247493611165, 1.1428571428571428, 1.2016355140186916, 1.0195580077283521, 1.08274231678487, 2.25, 2.0, 1.0327552986512525, 1.25, 1.0037270183213047, 1.0376766091051806, 1.1, 1.0594364493340789, 1.1379310344827587, 1.5833333333333333, 1.0047493626968764, 2.0, 1.0121852152721365, 1.0407407407407407, 1.0354268719384185, 1.0199893390191899, 1.2293333333333334, 1.06, 1.0928352352171755, 1.084307658978126, 1.0061349693251533, 1.04462386316586, 1.00570703868104, 3.0, 1.1, 1.0515217121765588, 1.5, 1.0758492322010238, 1.1666666666666667, 1.0, 1.6111111111111112, 1.3493265993265993, 1.0622568093385214, 1.3247863247863247, 1.0, 1.3246753246753247, 1.5, 1.0626159554730983, 1.5573770491803278, 1.1571428571428573, 1.0285570210224324, 1.0803212851405624, 1.020573108008817, 1.0093808630393997, 1.75, 1.0, 1.3368592351505288, 1.1, 1.169833729216152, 1.1307593124903887, 1.2576694705591291, 1.0216346153846154, 1.0, 1.0246086118495183, 1.0555555555555556, 1.5384615384615385, 2.0, 1.0369525547445255, 1.2857142857142858, 1.1101694915254237, 1.2083333333333333, 1.0850708351452178, 1.0762542925324485, 1.1107410491257286, 1.0099472411519015, 1.1103355704697986, 1.0, 1.0946745562130178, 1.1226936919871189, 1.0771812080536913, 1.1142857142857143, 1.0075819155864219, 1.051158374477782, 1.0220747144180302, 1.0588235294117647, 1.1, 1.2198275862068966, 2.0, 1.0416666666666667, 1.037037037037037, 1.1204588910133844, 1.4213197969543148, 1.005925925925926, 1.094054054054054, 1.1223506743737957, 1.001985946444559, 1.0990403071017274, 1.0860687639965032, 1.202127659574468, 1.1512605042016806, 1.1136950904392764, 1.0, 1.13086700684963, 1.5490196078431373, 1.106937668355718, 1.1295520464067033, 1.0480093676814988, 1.142251655629139, 1.75, 1.0826839826839827, 1.0, 1.0600137174211248, 1.1666666666666667, 1.0706996683949215, 1.0591787439613527, 1.0782507601502413, 1.0629139072847682, 1.0321917808219179, 3.0, 1.1354252683732453, 1.0043135622051722, 1.143894402084371, 2.0, 1.1481481481481481, 1.2940691927512356, 1.2462006079027355, 1.096178690419528, 1.4592297476759628, 1.16, 1.153900709219858, 1.0283024524794628, 1.1019292219886878, 1.028412835399341, 1.038744567364678, 1.5081967213114753, 1.15, 1.026243093922652, 1.0892031492904066, 1.1261261261261262, 1.0830912260313772, 1.0, 1.0, 1.215089344804765, 1.0222222222222221, 1.0474840538625088, 1.1057890813166646, 1.0850409836065573, 1.0, 1.0948275862068966, 1.121212121212121, 1.1315561863786565, 1.0, 1.0, 1.0746492884260106, 1.3333333333333333, 2.0, 1.0329249617151608, 2.0, 1.0242875647668395, 1.0029940119760479, 1.0026109660574412, 1.2, 1.0776775990694987, 1.0764006791171477, 1.4, 1.0258321069605787, 1.078125, 1.0792616720955484, 1.0597716588314305, 1.1941404871161314, 1.00191259443435, 2.0, 1.1046511627906976, 1.1984126984126984, 1.1184475806451613, 1.0646448523543495, 1.0, 1.0844131803035912, 1.0040674996920635, 1.029023746701847, 2.0, 1.0562396006655574, 1.0272151898734176, 1.063629960084527, 1.034780077854986, 1.0217036233199137, 1.0270105605199025, 1.0098107918710582, 1.0364880391690043, 1.5, 1.0341494845360826, 1.0392156862745099, 1.062317429406037, 1.015177065767285, 1.0439276485788114, 1.0034042701161416, 1.1808510638297873, 1.0601522943826496, 1.2363566487317448, 1.0916444808519352, 1.002053388090349, 1.1290820774691743, 1.027246725876863, 1.0574712643678161, 1.0309278350515463, 1.087378887028864, 1.1347826086956523, 1.0037515521386489, 1.0683394981505547, 1.3333333333333333, 1.0696612105062808, 1.2045454545454546, 1.2666666666666666, 1.1521739130434783, 1.0185327215806583, 1.164835164835165, 1.0658292626192138, 1.0, 1.2580645161290323, 1.0059198542805101, 1.1332344517184942, 1.0403628957600444, 1.0390440258256504, 1.131401349741961, 1.0014641288433381, 1.006578947368421, 1.0226855859953925, 1.6287425149700598, 1.0099659020458773, 1.0237741456166418, 1.100502512562814, 1.2296390120329321, 1.0114942528735633, 1.0094801341092143, 2.0, 1.1686411149825784, 1.0243055555555556, 1.007508044333214, 1.119815668202765, 1.0822722820763957, 1.0378006872852235, 1.275229357798165, 1.106596098329105, 1.0, 1.2549019607843137, 1.3333333333333333, 1.3333333333333333, 1.135135135135135, 1.155115511551155, 1.0493333333333332, 1.064, 1.0635660980810235, 1.0204081632653061, 1.0337650868413306, 1.1745863283322882, 1.1459086041119912, 1.187776470110791, 1.0213333850976891, 1.1393258426966293, 1.0717770034843206, 1.0493766866402439, 1.0532486565705912, 1.0699453551912568, 1.2439678284182305, 1.005586592178771, 1.0218374101881005, 1.1706161137440758, 1.0996111394791626, 1.2541436464088398, 1.14140189182634, 1.25, 2.0, 1.023391812865497, 1.1875, 1.25, 1.4008097165991902, 1.0415179615054937, 1.040377358490566, 1.0257731958762886, 1.0101522842639594, 1.1417140479822494, 1.0443434802362563, 1.0598591549295775, 1.0, 1.5, 1.008496907770906, 1.1141552511415524, 1.1093311974369242, 1.0896048918156163, 1.0, 1.2809523809523808, 1.1608695652173913, 1.0244918731511816, 1.121580547112462, 1.0050054938346966, 1.0376965694778666, 1.000944655240089, 1.3863636363636365, 2.6666666666666665, 1.176173324014838, 1.0, 1.0241935483870968, 1.2145922746781115, 1.3864430468204052, 1.0606060606060606, 1.9090909090909092, 1.0227350629063345, 1.1476510067114094, 1.0358476474981329, 1.0099735915025212, 1.2771883289124668, 1.0664596273291926, 1.0616520351157224, 1.0072332730560578, 1.0631944444444446, 1.5, 1.0191236611489776, 1.0867791646328708, 1.2105263157894737, 1.0440867739678097, 1.3059322033898304, 1.4256756756756757, 1.0043261833650103, 1.5, 1.0778985507246377, 1.113117250380683, 1.5649202733485195, 1.1197604790419162, 1.0255240865919397, 1.0833333333333333, 2.25, 1.0705679862306368, 1.0046854082998662, 1.1670065426119467, 1.1962837837837839, 1.0167161658374155, 1.0453682693268256, 1.1145038167938932, 1.0626035110963896, 1.2686980609418284, 1.074707520058969, 1.07426508509541, 1.0909090909090908, 1.0236013986013985, 1.0334098078577574, 1.1367924528301887, 1.0562295081967212, 1.2105263157894737, 1.3333333333333333, 1.0794044665012408, 1.5975056689342404, 1.0716957605985038, 1.1602373887240356, 1.2857142857142858, 1.0040257648953301, 1.023869801084991, 1.03125, 1.09961075603946, 2.6666666666666665, 1.0746961066416114, 1.5, 1.0745697896749522, 1.0714285714285714, 1.038083037326035, 1.4838709677419355, 1.1048951048951048, 1.0780969479353681, 1.0, 1.0685111989459815, 1.31000699790063, 1.2, 3.0, 1.1388888888888888, 1.2485549132947977, 1.0665444066020435, 1.2177589852008457, 1.1039531478770133, 1.0025691699604744, 1.064676616915423, 1.06703146374829, 1.1991869918699187, 1.47766323024055, 1.206896551724138, 2.0, 1.182089552238806, 1.150652431791222, 1.0103448275862068, 1.1485856079404466, 1.0769705883892444, 1.0853389227832466, 1.0846369785934233, 1.170333142736766, 1.1670560747663552, 1.006051437216339, 1.5714285714285714, 1.0, 1.2352941176470589, 1.0747784728063907, 1.0714812085482683, 1.0767195767195767, 1.1471264367816092, 1.015480277220027, 1.0838427736148268, 1.0005592784291395, 1.180722891566265, 1.2857142857142858, 1.2465483234714003, 1.0422885572139304, 1.0729955959187023, 1.0702031018333293, 1.0280898876404494, 1.1018700787401574, 1.0215022156902043, 1.1044601795751514, 1.0716925351071693, 1.0546567110386813, 1.186131386861314, 1.08603031544449, 1.185483870967742, 1.020682052388142, 1.043956043956044, 1.0670821114369502, 1.0, 1.0200400801603207, 1.0379709658471092, 1.1578947368421053, 1.0447386759581883, 1.0161725067385445, 1.1395348837209303, 1.057121843589115, 1.0334941130651008, 1.0569935081359076, 1.0464, 1.0726415094339623, 1.2038941954445261, 1.1290322580645162, 1.1875, 1.0, 1.2222222222222223, 1.0559182686494983, 1.25, 1.069636195877981, 1.1056187846544099, 1.0295622512791358, 1.068541008151722, 1.0735485212329123, 1.0873257061136932, 1.0238095238095237, 1.0600240096038416, 1.0165861564117218, 1.158462681315244, 1.044937865649594, 1.2322449082349387, 1.5, 1.2780082987551866, 1.0818505338078293, 1.0838465319339636, 1.0842391304347827, 1.2734620565783565, 1.0568720379146919, 2.273062730627306, 1.0481528320686748, 1.0629213483146067, 1.052804852499576, 1.0952380952380953, 1.053871475737967, 1.0442805623339884, 1.2463887742468014, 1.061993659739345, 1.2580645161290323, 1.126675603217158, 1.0816572434887386, 1.0466357905570565, 1.1893939393939394, 1.0167069933289579, 1.3333333333333333, 1.0044776119402985, 1.0411392405063291, 1.0338541666666667, 1.0698198198198199, 1.0185356811862836, 1.06158357771261, 1.0689655172413792, 1.0178621780813335, 1.0701248799231509, 1.0057399103139013, 1.0801209650717034, 1.1428571428571428, 1.1085549964054637, 1.0615185365063946, 1.0317748302155099, 1.0410396716826265, 1.0953878406708595, 1.0554455445544555, 1.2260162601626017, 1.0024449877750612, 1.027980067076188, 1.25, 1.1193853427895981, 1.2325207822978996, 1.0375778398110371, 1.1322751322751323, 1.1345139075216886, 1.1220465748767636, 1.0701402805611222, 1.04296875, 1.1086742156556608, 1.0757673841506177, 1.0983358547655069, 1.105, 1.0124407582938388, 1.114359521075939, 1.153061224489796, 1.6, 1.0375532257487388, 1.1754749989828717, 1.0427728613569323, 1.0445544554455446, 1.2469209972964854, 1.0318949792171286, 1.168510237702989, 1.0864440078585462, 1.4444444444444444, 1.0420875420875422, 1.3333333333333333, 1.2010723860589811, 1.4166666666666667, 1.0500293304282242, 1.1939546599496222, 2.0, 1.0204081632653061, 1.017535763728657, 1.147470398277718, 1.08, 1.1923076923076923, 1.046468401486989, 1.045643153526971, 1.0300647548566142, 1.0769230769230769, 1.0384321326656976, 1.4031281533804238, 1.0337950800095534, 1.2478632478632479, 2.0, 1.332057697968796, 1.018277182012097, 1.0331671096254487, 1.156390977443609, 1.3384615384615384, 1.1666666666666667, 1.1470588235294117, 1.0888888888888888, 1.1566265060240963, 1.0905923344947734, 1.0274021582754067, 1.032822682663549, 1.368421052631579, 1.0886935289721547, 1.0471694572447299, 3.0, 1.0975218380055685, 1.3357363542739444, 2.0, 1.8, 1.1446432949252268, 1.1440287339120023, 1.0877680784567303, 1.2213541666666667, 1.5, 1.182170542635659, 1.3619791666666667, 1.4285714285714286, 1.05280400247484, 1.0859194453615055, 1.0434122339887015, 1.0585516178736518, 1.7142857142857142, 1.0206274620146314, 1.0444874274661509, 1.0275862068965518, 1.1281847133757963, 1.0069124423963134, 1.0, 1.1756756756756757, 1.2132930513595166, 1.0362776279888277, 1.1758241758241759, 1.0794701986754967, 1.0811378175268618, 1.0701357466063348, 1.040133779264214, 1.2173913043478262, 1.0143840584668866, 1.5647972116603295, 1.0391619646124517, 1.3265306122448979, 1.0916030534351144, 1.096938775510204, 1.125, 1.0795698924731183, 1.0559796437659033, 1.0132129139211714, 1.0374331550802138, 1.5, 1.0645427080472398, 1.0412130313269095, 1.1322497229405246, 1.1373148744365744, 1.0449862287054983, 1.0605303345828128, 1.116800169377889, 1.2094594594594594, 1.0, 1.0513547366339244, 1.071365510384256, 1.2483302975106254, 1.0426470588235295, 1.6666666666666667, 1.0609756097560976, 1.016782919661509, 1.1054313099041533, 1.0017396271485695, 1.1006439596297954, 1.017825311942959, 2.25, 1.1043663471778489, 1.0366992564949593, 1.1726235741444866, 1.1028938906752412, 1.0724738502819946, 1.0160427807486632, 1.2529572338489536, 1.0368395540475037, 1.0321300447074055, 1.1337253414264037, 1.0270009643201543, 1.0600667408231368, 1.0, 1.2014695830485305, 1.0017174906745623, 1.0516623789066828, 1.0506265664160401, 1.132738719832109, 1.030701754385965, 2.3333333333333335, 1.224890829694323, 2.0, 2.5, 1.15, 1.0108225108225108, 1.0582329317269077, 1.0365732267283179, 1.0175548119662388, 1.0638297872340425, 1.0333754284683385, 1.2190476190476192, 1.114513981358189, 1.0955423703027536, 1.5, 1.6923076923076923, 1.2925383542538353, 1.0, 1.064327485380117, 1.1186931348221671, 1.0629056815449955, 1.1010341492448479, 2.5, 1.0741455347298787, 1.034108527131783, 1.0656809456839864, 1.040847611838735, 1.192584963954686, 1.1157984144960362, 1.1662406513301145, 1.1099266164220547, 1.0200803212851406, 1.2463768115942029, 1.0991831971995332, 1.0, 1.0, 1.0414817960667733, 5.0, 1.625, 2.0625, 1.0221550855991943, 1.0679492468030753, 1.0377464788732393, 1.035294117647059, 1.2857142857142858, 1.7107438016528926, 1.0213903743315509, 1.1095617529880477, 1.265748031496063]
origin-bjaq_15.71 	max: 5.0000	99th: 3.0000	95th: 1.8000	median: 1.0819	mean: 1.1866

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.143461 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.094184