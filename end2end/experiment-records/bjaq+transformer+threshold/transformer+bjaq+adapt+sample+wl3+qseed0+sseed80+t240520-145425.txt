Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 80, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.5000	95th: 1.7729	median: 1.0802	mean: 1.1753
ReportEsts: [1.05, 1.0098958333333334, 1.024434703354889, 1.054766734279919, 1.5789473684210527, 1.0, 1.050755939524838, 1.050196295739725, 1.0, 1.0290620871862615, 1.1230485095085563, 1.0428072927937675, 1.090201465201465, 1.0953488372093023, 1.055810667608619, 1.0, 1.0222222222222221, 1.0297555791710946, 3.0, 2.0, 1.037037037037037, 1.14550395256917, 1.112580329516304, 1.1462125660598943, 1.0518006906758757, 1.0, 1.151324539017289, 1.5, 1.2, 1.0215827338129497, 1.0, 1.048682944564403, 1.0050655725604054, 1.2286348501664817, 1.0519900132178, 1.231994661995913, 1.1764705882352942, 1.0057979367746472, 1.1775604380466975, 1.0595238095238095, 1.1729323308270676, 1.0274390243902438, 1.0, 1.103898899206691, 1.0895798319327732, 1.8615384615384616, 1.0404040404040404, 1.1590106007067138, 1.0473673510876194, 1.0462962962962963, 1.1325712103023027, 1.1941580756013745, 1.0390837985757744, 2.0, 1.096103896103896, 1.2487492182614133, 1.2466001813236627, 1.3592233009708738, 1.1925465838509317, 1.25, 1.1090058160668848, 1.1064757160647571, 1.1090909090909091, 1.0114942528735633, 1.1, 1.059403762238275, 1.303485769107771, 1.75, 1.0, 1.0431621142910412, 1.0108564535585043, 1.0609048723897911, 1.0301624129930393, 1.0681838912706376, 1.0941176470588236, 1.036468330134357, 1.0, 1.1077244258872652, 2.0, 1.0079485781514534, 1.09375, 1.0263377747311597, 1.196319018404908, 1.09, 1.1177625122669284, 1.04, 1.0787331492610037, 1.0116450907371284, 1.0980392156862746, 1.75, 1.0877363063499759, 1.0560081406497226, 1.0685358255451713, 1.0336605890603086, 1.0262417994376758, 1.0077922077922077, 1.0150375939849625, 1.1312741312741312, 1.0, 1.2453605956217357, 1.048380129589633, 1.0334476843910807, 1.2307391644228263, 1.36, 1.0229328825106132, 1.084417308202814, 1.2017461648498002, 1.137277208949564, 1.0524218270999386, 1.3333333333333333, 1.6666666666666667, 1.0570093457943925, 1.0640732141012186, 1.018319646241314, 1.0649350649350648, 1.0600227854953328, 1.0, 1.1043834752444024, 1.1754780652418448, 1.0, 1.0164835164835164, 1.0, 1.2406015037593985, 1.0272260679785077, 1.0640677176360953, 1.0980392156862746, 1.8, 1.1117549668874172, 1.0, 1.12, 1.1026673891484597, 1.1818181818181819, 1.0885416666666667, 1.0141747316723921, 1.0604210788588513, 1.0173564753004005, 1.0, 1.0074045206547155, 1.039972432804962, 1.0786106032906764, 1.0326264959059417, 1.2461538461538462, 1.0136986301369864, 1.1443940076182595, 2.0, 1.0104831358249773, 1.0434285714285714, 1.0826057756883816, 1.0790541732839245, 1.5, 1.272826350205861, 1.0044642857142858, 1.0, 1.1074561403508771, 1.0350364963503649, 1.0646087580760948, 1.1149370976315633, 1.251650770359501, 1.0958333333333334, 1.0625, 1.2653061224489797, 1.3398058252427185, 1.0176730486008836, 1.4285714285714286, 1.0713388017460546, 1.046092612219689, 1.1760324983073798, 1.3470231797633934, 1.123541523678792, 1.0545175054994567, 1.2463157894736843, 1.0769230769230769, 1.0444465963009586, 1.0394337714863497, 1.0733390854184641, 1.0845481049562682, 1.053941908713693, 1.1165325720218011, 1.0175513092710544, 1.0, 1.1559633027522935, 1.003114382785957, 1.0287081339712918, 1.1155592241023524, 1.144736842105263, 1.0984360054162163, 1.2777243897751298, 1.0840421617643876, 1.1372549019607843, 1.14, 1.0441211685823755, 1.0, 1.0909090909090908, 1.0518542431701707, 1.0173210161662818, 1.008298755186722, 1.1666666666666667, 1.0643086816720257, 1.0485723241032388, 1.0474712519544915, 1.0626410835214446, 1.1114156213766206, 1.1638418079096045, 1.0666666666666667, 1.2, 1.0, 1.4285714285714286, 1.1831730011039268, 1.3031358885017421, 1.2528735632183907, 1.0118635689569946, 1.0031277926720286, 1.0010290006688505, 1.0563477971368327, 1.2237323160069942, 1.0454545454545454, 1.0057803468208093, 1.007838014369693, 1.0273996208857488, 1.0010556027262087, 1.0, 1.0993788819875776, 1.1487798633131783, 1.0150521189680848, 1.146177370030581, 1.0035304270509167, 1.2726881257401228, 1.0357142857142858, 1.006137263281004, 1.113460546673543, 1.0022611644997172, 1.2151898734177216, 1.1188210721745184, 1.0077972709551657, 1.2039370078740157, 2.0, 1.2374269005847953, 1.0870924519874945, 1.1568213783403656, 1.072, 1.0909090909090908, 1.6666666666666667, 1.0232496790418741, 1.1090909090909091, 1.100854580125715, 1.5, 1.0, 1.0256410256410255, 1.0219385719984044, 1.0208333333333333, 1.0497237569060773, 1.1276371308016877, 1.0488215488215489, 1.0020990764063813, 1.0915197150655234, 1.0350877192982457, 2.0, 1.0734069459009314, 1.0413719185423365, 1.0998248686514887, 1.0281163116416163, 1.0955786193271932, 1.0464062607262992, 1.0906200317965025, 1.1004524408922065, 1.0227272727272727, 1.044418638409058, 1.1465784286116587, 1.2727272727272727, 1.0394955359930074, 1.0932400932400932, 1.2045454545454546, 1.3888888888888888, 1.024, 1.0555555555555556, 1.0512820512820513, 1.0851759639324405, 1.128930817610063, 1.3358395989974938, 1.030784371380736, 1.0681003584229392, 1.0262385433049515, 1.0430516353976425, 1.25, 1.0394688977810114, 2.5, 1.0511358160967874, 1.0151187904967602, 1.0561285330663146, 1.0526315789473684, 2.0, 1.2608695652173914, 1.0597014925373134, 1.0738998225099186, 1.0, 1.013953488372093, 1.0769230769230769, 1.0072115384615385, 1.0144074392453881, 1.125, 1.0943396226415094, 1.0162291553157852, 1.1780036660556574, 1.100083586291848, 1.1538461538461537, 1.0, 1.0883054892601431, 1.3012820512820513, 1.0422077922077921, 1.0150800336983994, 1.0337781484570476, 1.115492957746479, 1.18, 1.0068587105624143, 1.033324446814183, 1.2857142857142858, 1.0050155462717774, 1.05, 1.105263157894737, 1.114095337127846, 1.2380952380952381, 1.4, 1.0017625055474546, 2.0, 1.1796982167352539, 1.0232558139534884, 1.0746513535684987, 1.1099916036943744, 1.0698324022346368, 1.123456790123457, 1.119022172919006, 1.048765447124786, 1.0470756062767475, 1.0447077165570176, 1.0515765600994953, 2.0, 1.0, 1.053840352841701, 1.25, 1.068561872909699, 1.3529411764705883, 1.0, 1.375, 1.3333333333333333, 1.0599250936329587, 1.2772277227722773, 1.027056277056277, 1.0, 1.1824234354194407, 1.0829758990334264, 2.0, 1.2888624181060155, 1.0, 1.0927503226296211, 1.1235955056179776, 1.013348223782174, 1.1451612903225807, 1.1363636363636365, 1.4823232323232323, 1.2314814814814814, 1.028358751176981, 1.0195803102224859, 1.0774748923959827, 1.0, 1.0769230769230769, 1.5714285714285714, 1.5, 1.2307692307692308, 1.0689974356513035, 1.3333333333333333, 1.0255972696245734, 1.0520833333333333, 1.2010408107367845, 1.079267920514095, 1.2173017507723995, 1.0304515184433005, 1.0104408352668213, 1.0654761904761905, 1.5, 1.273209549071618, 1.0851063829787233, 1.043044640687029, 1.0952380952380953, 1.5714285714285714, 1.0623608017817372, 1.0046511627906978, 1.0272572045128376, 1.0290037831021437, 1.1464387464387464, 1.0005474952094169, 1.0810810810810811, 1.0907770515613653, 1.0444915254237288, 1.1538461538461537, 1.0254957507082152, 1.2551020408163265, 1.0556723348183472, 1.0891932143853134, 1.0364787380328464, 1.075, 1.2758620689655173, 1.0948012232415902, 1.0, 1.0478696807810732, 1.052449117131689, 1.0492016558249557, 1.0559754257126899, 1.0805951642901426, 1.1569748967270417, 1.8333333333333333, 1.6144859813084111, 1.1666666666666667, 1.2322801024765158, 1.25, 1.0360751335438514, 1.010144927536232, 1.041487532244196, 1.150197628458498, 1.1644859813084112, 3.0, 1.3309941520467836, 1.0065876836568666, 1.1393001655324628, 2.0, 1.0327868852459017, 1.2495201535508638, 1.3488372093023255, 1.098614640544307, 1.106029106029106, 1.2352941176470589, 1.0560828300258844, 1.024028911279707, 1.0553038956946468, 1.104708478761776, 1.119956140350877, 1.1243781094527363, 1.0076335877862594, 2.142857142857143, 1.0765027322404372, 1.5, 1.2237061769616027, 1.0, 1.1721494492408455, 2.5, 1.093817343005433, 1.115502930107065, 1.0672424429364589, 1.0, 1.1287128712871286, 1.12, 1.284436225509796, 1.188183807439825, 1.0, 1.0118817352859906, 1.1293786772265668, 1.1060920016576876, 1.5, 2.0, 1.0054368932038835, 1.0008968609865472, 1.009933774834437, 1.1111111111111112, 1.081106138677412, 1.0872689938398357, 1.4705882352941178, 1.052391713747646, 1.0454545454545454, 1.1286089238845145, 1.001615508885299, 1.3832562053007993, 1.043298598634567, 1.0, 1.0571428571428572, 1.053278263574465, 1.0414581412483743, 1.0170983112378853, 1.0, 1.0898031408980313, 1.009387097091937, 1.0220010476689365, 2.0, 1.0450558213716108, 1.0573579739904175, 1.0411575941354845, 1.0428552706303789, 1.0116037142442411, 1.0439706230751007, 1.0134453781512605, 1.142960462873674, 2.0, 1.0274949609798956, 1.5416666666666667, 1.0, 1.2020725388601037, 1.1346153846153846, 1.0177291367985863, 1.1829145728643216, 1.0515128925588242, 1.0197338228545205, 1.0827652529580756, 1.065467333964561, 1.0483084249338281, 1.1318681318681318, 4.0, 1.0219181370783819, 1.1253036437246964, 1.0482570702633391, 1.0570539319592178, 1.0923389142567226, 1.2639676113360323, 2.3222222222222224, 2.4285714285714284, 1.0018170953304308, 1.0393858701101912, 1.0180264940538912, 1.1238481385919645, 1.0778056305437718, 1.02680412371134, 1.0670749081715651, 1.0722761596548005, 1.2304075235109717, 3.0, 1.0, 1.034920634920635, 1.0992217898832686, 1.0719424460431655, 1.2118155619596542, 1.0529411764705883, 1.0585106382978724, 1.148905109489051, 1.1097560975609757, 1.0481690173707112, 1.202127659574468, 1.0063594228785242, 2.0, 1.1317073170731706, 1.0632911392405062, 1.2702702702702702, 1.0966480446927374, 1.0578703703703705, 1.0181086519114688, 1.1109510086455332, 1.087210202922497, 1.0, 1.1702127659574468, 1.0, 1.0, 1.1022727272727273, 1.1350806451612903, 1.0140845070422535, 1.1213592233009708, 1.0587952579301505, 1.0498839907192576, 1.0593337204238642, 1.1762932034330782, 1.0354391371340523, 1.0951647838274017, 1.0162162162162163, 1.1349899261249161, 1.0328979196903725, 1.0913513513513513, 1.073699421965318, 1.1716182048040455, 1.0885825774084021, 1.182214156079855, 1.0750882245329116, 2.0, 1.316953316953317, 1.083083083083083, 1.4205607476635513, 1.0, 1.186046511627907, 1.25, 1.0761904761904761, 1.4074074074074074, 1.1666666666666667, 1.0022032109685266, 1.1228623311316426, 1.0337502263379807, 1.0494257425742575, 1.2108108108108109, 1.1136671177266577, 2.0, 1.193798449612403, 1.0413703943115709, 1.062594629054108, 1.082894588476117, 1.0399248205946008, 1.0248469967383735, 1.135064935064935, 1.1196005670446965, 1.133214920071048, 1.0004148261093795, 1.0756132457312826, 1.3333333333333333, 1.0912052117263844, 1.0, 1.2422535211267605, 1.2073461175214553, 3.0, 1.1484429875907283, 1.0746667285986344, 1.4285714285714286, 1.0278816603102898, 1.3, 1.1176470588235294, 1.084352153345211, 1.6153846153846154, 1.0112456642858005, 1.0384451089278086, 1.3571428571428572, 1.0740740740740742, 1.045360824742268, 1.0296508847441415, 1.0132450331125828, 1.039063478151997, 1.1552954088165355, 1.0, 1.0855420378014338, 1.1219512195121952, 2.0, 1.0109118888293036, 1.069080370274245, 1.1438032166508987, 1.017902512018848, 1.0190063770575681, 1.0089285714285714, 2.142857142857143, 1.0886128364389234, 1.0096774193548388, 1.1028456043303412, 1.2241731318905675, 1.0035803111805195, 1.0301062984995613, 1.173992673992674, 1.0895824888528578, 1.2876254180602007, 1.0518837560421812, 1.0738170347003155, 1.1594202898550725, 1.0929621848739495, 1.0533124047827893, 3.0, 1.1336523315600202, 1.0100400598387567, 1.0284217065989574, 1.5833333333333333, 1.3130120816553257, 1.3482587064676617, 1.0, 1.0378429851167383, 1.0420575865415722, 1.1179039301310043, 1.088235294117647, 1.3333333333333333, 1.0329832436934456, 1.5, 1.0350467289719627, 1.0833333333333333, 1.072535063847603, 1.44, 1.1476793248945147, 1.0681341719077568, 1.0, 1.5873015873015872, 1.2461287693561531, 1.25, 2.0, 1.1271186440677967, 1.3172413793103448, 1.049609984399376, 1.2002518891687657, 1.103448275862069, 1.2035398230088497, 1.1014466214978942, 1.0493506493506493, 1.144859813084112, 1.7714285714285714, 1.0, 1.0, 1.1544715447154472, 1.0937950937950938, 1.0516528925619835, 1.0778336125069794, 1.087350238602904, 1.0355903893100347, 1.0712803486200457, 1.1813186813186813, 1.1622377622377622, 1.016990291262136, 1.8333333333333333, 1.0, 1.2592592592592593, 1.0347802990058435, 1.0847308031774052, 1.107843137254902, 1.0656167979002624, 1.0315387552500954, 1.0988607129731716, 1.0121416141095738, 1.0985915492957747, 1.2941176470588236, 1.0464756003098374, 1.0347712776901448, 1.0719150542399027, 1.0191960557157098, 1.019736842105263, 1.0637920850561133, 1.019763879831971, 1.1726726726726726, 1.3309572301425663, 1.2857142857142858, 1.0360149672591206, 2.176470588235294, 1.1555555555555554, 1.0138121546961325, 1.0701001430615165, 1.0, 1.028169014084507, 1.0261201460338534, 1.0555555555555556, 1.0841990463226103, 1.0105932203389831, 1.2285714285714286, 1.0772232518075748, 1.0141312184571016, 1.1056271823798012, 1.0248091603053435, 1.0704738760631836, 1.2087605163663613, 1.1839323467230445, 1.3571428571428572, 1.0, 1.4285714285714286, 1.0659803802833958, 1.3333333333333333, 1.2305095999557352, 1.1115179581067256, 1.0224235560588901, 1.063157894736842, 1.0506902340967175, 1.0012878300064392, 1.0035971223021583, 1.0457697642163661, 1.016554347570855, 1.13324896887889, 1.0422620356122225, 1.2440382994098518, 1.6666666666666667, 1.0158730158730158, 1.0326530612244897, 1.1236438004783529, 1.0879478827361564, 1.249144061100869, 1.0620300751879699, 2.1829787234042555, 1.058256480028448, 1.0738255033557047, 1.0574282296650717, 1.125, 1.052485115195444, 1.0251889061896742, 1.303030303030303, 1.0581052631578947, 1.391304347826087, 1.068649885583524, 1.1229050279329609, 1.5625, 1.0240489271276045, 1.5769230769230769, 1.0493951612903225, 1.0317460317460319, 1.0040458530006744, 1.0415894931806702, 1.0131108462455305, 2.2, 1.1313131313131313, 1.1016397661678738, 1.0695094171898438, 1.0193812687166524, 1.0457555381097041, 1.0843243147374675, 1.0, 1.1046207497820402, 1.0351631177964447, 1.0110133152787182, 1.0360721442885772, 1.0138888888888888, 1.0709802028005795, 1.0363697877019369, 1.3660714285714286, 1.0080956119689435, 1.0, 1.3333333333333333, 1.0323963509604688, 1.0425407070558896, 1.2216591591591592, 1.1446575850245575, 1.025538707102953, 1.079136690647482, 1.1034390986781797, 1.0916395008067437, 1.1121323529411764, 1.0511363636363635, 1.039301310043668, 1.085382614244343, 1.0952380952380953, 1.75, 1.0546741252030924, 1.1736622304554836, 1.0168115942028986, 1.0056818181818181, 1.1466328747284575, 1.000570502250701, 1.1706494236716334, 1.444043321299639, 1.1923076923076923, 1.0559299191374663, 1.0869565217391304, 1.125, 1.4827586206896552, 1.0483852944463068, 1.1873141724479683, 1.158374792703151, 1.0975609756097562, 1.0161166282141305, 1.0656934306569343, 1.0590696117804552, 1.3027332144979205, 1.3333333333333333, 1.0, 2.0, 1.143504005572971, 1.3461538461538463, 1.0, 1.1538461538461537, 1.0635761589403974, 1.085144927536232, 1.0698616764592122, 1.060405971359092, 1.0072727272727273, 1.36, 1.1428571428571428, 1.1290322580645162, 1.054054054054054, 1.2142857142857142, 1.1403197158081706, 1.0250028703997622, 1.0300805164928946, 1.3195876288659794, 1.0850276632267153, 1.0471497923026876, 2.5, 1.066516960974448, 1.3539651837524178, 1.5, 2.0, 1.2186390532544378, 1.1036362332353151, 1.058211927206735, 1.1211180124223603, 1.0, 1.0530612244897959, 1.2300613496932515, 3.0, 2.0, 1.0482331699767862, 1.0771609087242908, 1.0129097582584483, 1.6666666666666667, 1.0193388240214232, 1.0464756003098374, 1.0307692307692307, 1.0, 1.07981220657277, 1.0235254451875706, 1.0657894736842106, 1.1866262964633125, 1.0142937491514905, 1.221264367816092, 1.12109375, 1.0923699613307052, 1.0923507462686568, 1.0743801652892562, 1.2545454545454546, 1.0335157038215776, 2.084119296456793, 1.083427377722285, 1.9940119760479043, 1.1764705882352942, 1.2985074626865671, 1.0566534914361, 1.048531684698609, 1.0001597268670572, 1.071216708181644, 1.0622270742358078, 1.5, 1.6666666666666667, 1.0840951224189734, 1.1701846965699207, 1.1260455164364909, 1.018243516893509, 1.1436695099514969, 1.132400430570506, 1.4411764705882353, 1.0212765957446808, 1.12035217357126, 1.1060385034209284, 1.2173601147776183, 1.0344202898550725, 1.6666666666666667, 1.0135135135135136, 1.0824365643489655, 1.091549295774648, 1.0262875622368441, 1.1159792228794416, 1.0014204545454546, 2.0, 1.0821744627054362, 1.013150544121919, 1.1674663011194881, 1.167300380228137, 1.0880119677680828, 1.0509554140127388, 1.1037527593818985, 1.0231884057971015, 1.0314233975301115, 1.0530347672362994, 1.043778801843318, 1.0511440107671601, 1.0, 1.159845406798137, 1.067533595392632, 1.0384087791495198, 1.0444627136642346, 1.1099444101297098, 1.0173978819969742, 1.2, 1.2493368700265253, 1.6666666666666667, 2.0, 1.2352941176470589, 1.0025575447570332, 1.0505529225908372, 1.007557900250683, 1.0190496557033488, 1.008683853459973, 1.0275150472914876, 1.1630434782608696, 1.225, 1.0286692340607617, 1.6, 1.5, 1.3007614213197969, 1.1428571428571428, 1.0162381596752368, 1.1601223865374808, 1.0337990085624156, 1.1097450130658486, 2.0, 1.0614525139664805, 1.2383720930232558, 1.0791173304628634, 1.0403497343963595, 1.1792929292929293, 1.1167808219178081, 1.1471685468558026, 1.0703754895185442, 1.02442996742671, 1.3653846153846154, 1.068435754189944, 1.0, 1.0, 1.0417545867458244, 5.0, 1.5714285714285714, 2.076923076923077, 1.0655526992287918, 1.1325301204819278, 1.0681818181818181, 1.0792467634366418, 1.0, 1.0862818125387959, 1.0169392523364487, 1.17989417989418, 1.2884615384615385, 1.4285714285714286, 1.002437403057833, 1.123059866962306, 1.1469933184855234, 1.0684269245072517, 1.0213632041835037, 1.2514298530896042, 1.1603076013013902, 1.0, 1.1874603376062953, 1.023359413623369, 1.0084289813486371, 1.1774193548387097, 1.0723524864725587]
origin-bjaq_15.71 	max: 5.0000	99th: 2.5000	95th: 1.7729	median: 1.0802	mean: 1.1753

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 14.063288 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[3.5762787e-07 4.1723251e-07 3.5762787e-07 6.5565109e-07 2.3841858e-07]
Distance score: 4.0531159584134e-07
SAUCE Drift detection: False
Detection latency: 0.0230s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.044841 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 7.0000	99th: 3.0000	95th: 1.6672	median: 1.0760	mean: 1.1816
ReportEsts: [1.03601108033241, 1.0039387308533916, 1.03040870162252, 1.0910683012259195, 1.4583333333333333, 2.0, 1.0704960835509139, 1.0585931639992736, 1.0, 1.0457589285714286, 1.1834906453394818, 1.0409151843548987, 1.0711060948081264, 1.1473477406679764, 1.0525094284885408, 1.4444444444444444, 1.1768488745980707, 1.9411764705882353, 1.0833333333333333, 1.0331400165700082, 1.04093567251462, 1.0728915662650602, 1.5301724137931034, 1.0175145954962468, 1.0137877668741866, 1.0240940676506058, 2.0, 1.1650874635568513, 1.4, 1.0, 1.1148936170212767, 1.0, 1.0434883370180583, 1.0044106378125697, 1.1328125, 1.0070158461352365, 1.2254586918212915, 1.1543478260869566, 2.2857142857142856, 1.1318587834963845, 1.06947017413857, 1.0386778219722945, 1.2441379310344827, 1.0042621204049014, 1.0391061452513966, 1.0276583268178263, 1.25, 1.0076923076923077, 1.4534883720930232, 1.0121049092131809, 1.375, 1.1003861003861004, 1.1130434782608696, 1.0294117647058822, 1.025470233803058, 1.0204030541995244, 1.059651179832918, 1.0862944162436547, 1.1111111111111112, 1.0641680075459135, 1.46875, 1.1395241671217913, 1.0519083969465648, 1.0555555555555556, 1.029126213592233, 7.0, 1.0524987840466926, 1.2007874015748032, 1.6, 1.0, 1.073843277769123, 1.033033033033033, 1.063891577928364, 1.0077220077220077, 1.0648414985590777, 1.0929802955665024, 1.0360098657166348, 1.1758241758241759, 1.4951456310679612, 1.049626930418185, 1.0461236506378804, 1.2416666666666667, 1.0, 1.0, 1.0628445424476296, 1.123076923076923, 1.0412168792934249, 1.173913043478261, 1.3333333333333333, 1.1087590072057647, 1.108878224355129, 1.1017958227601015, 1.101538933483307, 1.019470840320477, 1.0901408450704226, 1.0817535545023698, 1.0258620689655173, 1.0753701211305517, 1.0353982300884956, 1.3352, 1.1111111111111112, 2.0, 1.0356100558087145, 1.3734204793028322, 1.0987743330930064, 1.2284479654303204, 1.4285714285714286, 1.024039015599954, 1.074822380106572, 1.4553589182740108, 1.1653048397234445, 1.0442185514612452, 1.125, 1.0, 1.0320512820512822, 1.0757368013170023, 1.0688924218335982, 1.1935483870967742, 1.0589095674967235, 2.0, 1.0759293435275508, 1.1086375779162956, 1.5, 1.0469483568075117, 1.125, 1.2373949579831933, 1.0206512707794388, 1.0515530351849465, 1.11864406779661, 1.6666666666666667, 1.176027397260274, 1.0, 1.5384615384615385, 1.1379597116983922, 1.0833333333333333, 1.0176579925650557, 1.0216750437680013, 1.0869596081493575, 1.8333333333333333, 1.5, 1.0280777537796977, 1.0058191584601612, 1.055722891566265, 1.0024836122307723, 1.1734104046242775, 1.0402234636871508, 1.1272215129592478, 3.0, 1.0147727272727274, 1.0019193857965452, 1.1090182648401827, 1.0888008219580214, 1.5, 1.1745439887130908, 1.0338541666666667, 1.053082191780822, 1.4642857142857142, 1.0, 1.0331262939958592, 1.0812862235371148, 1.001918158567775, 1.058139534883721, 1.138586956521739, 1.2459016393442623, 1.253968253968254, 1.0084033613445378, 1.1111111111111112, 1.0491160982948846, 1.0, 1.0824742268041236, 1.340618487016279, 1.0469798657718121, 1.0395882156009375, 1.3421052631578947, 1.079611650485437, 1.141918741383505, 1.0374449339207048, 1.1058823529411765, 1.0547619047619048, 1.0453949094725794, 1.0055532157174722, 1.2159440921444287, 1.1772151898734178, 1.027027027027027, 1.029901580702397, 1.0373895309313392, 1.276978417266187, 1.1062828894913093, 1.0097560975609756, 3.0, 1.2374301675977655, 1.0949055376455534, 1.5263157894736843, 1.14387031408308, 1.0946015424164524, 1.053073926425659, 1.0341911558127774, 1.0740740740740742, 1.088124980626763, 1.22034677990092, 1.0114848236259228, 1.0108836333686315, 1.009628933771724, 1.0626928866769672, 1.074283027738599, 1.0216971187631765, 1.4511627906976745, 1.0555555555555556, 1.2380952380952381, 1.0, 1.4074074074074074, 1.1514671941971646, 1.3162393162393162, 1.176991150442478, 1.0144987572493787, 1.0, 1.0356746217383075, 1.0294117647058822, 1.2148948039528211, 1.6666666666666667, 1.033292231812577, 1.015242242787153, 1.0195937443825274, 1.0169312980023366, 1.0, 1.0177801724137931, 1.0912407564949937, 1.0131820710348431, 1.0, 1.036850921273032, 1.0510737086477075, 1.1004520341536916, 1.3583333333333334, 1.00449155377349, 1.0271456825541718, 1.0518292682926829, 1.1110065851364064, 1.0579710144927537, 1.4444444444444444, 1.170045781556573, 2.0, 1.1857707509881423, 1.1382864605195653, 1.1606728538283062, 1.0629139072847682, 1.1428571428571428, 1.25, 1.165590798392066, 1.1587301587301588, 1.0476284030311536, 1.4, 1.0205859065716547, 1.0468594217347955, 1.1428571428571428, 1.0021993496886892, 1.0502283105022832, 1.0637554585152837, 1.0418679549114331, 1.0045470444211262, 1.0713779552921472, 1.0615384615384615, 2.0, 1.0898589691992842, 1.0610567041470198, 1.1157742402315485, 1.0192478741950404, 1.1152529568686702, 1.019036362372245, 1.1201342281879194, 1.0798762789879504, 1.0329113924050632, 1.0712876171682288, 1.0068252326783869, 1.0833333333333333, 1.0246995324946326, 1.2402597402597402, 1.0677966101694916, 1.1666666666666667, 1.0007933359777865, 1.1598360655737705, 1.048638920134983, 1.0185580727616512, 1.0744186046511628, 1.3186582809224319, 1.013394703160382, 1.1211401425178147, 1.1908177905308466, 1.0496046577492189, 1.0, 1.123076923076923, 1.0747438215792646, 1.105488344644438, 1.1554483199091652, 1.0305997552019583, 1.1832264957264957, 1.184326710816777, 1.0540115739086948, 1.009226037929267, 1.097065585344219, 1.0604124229148646, 1.0518518518518518, 1.0, 1.0, 1.0750674258315853, 1.4545454545454546, 1.0600375234521575, 1.0192233246541127, 1.0862043417055642, 1.5142857142857142, 1.016260162601626, 1.0994623655913978, 1.053936871314603, 1.0141404857788316, 1.0, 1.2535012357302577, 1.0459995617458948, 1.0314009661835748, 1.375, 2.6666666666666665, 1.0100832967996494, 1.4285714285714286, 1.0068305046680996, 1.0363924050632911, 1.15, 1.111663776581181, 1.0, 1.5454545454545454, 1.0145178612299512, 2.0, 1.015918958031838, 1.0351515151515152, 1.102555412458483, 1.0363081099423141, 1.031890660592255, 1.1287128712871286, 1.094515555755517, 1.0681862721909485, 1.0714285714285714, 1.0441674569841486, 1.049004129220306, 3.0, 1.0, 1.0462597957729756, 1.5, 1.0712290502793296, 1.35, 1.3333333333333333, 1.4444444444444444, 1.3816013628620103, 1.0837282780410742, 1.2030075187969924, 1.0674157303370786, 1.3205128205128205, 1.6666666666666667, 1.051617165508129, 1.0096774193548388, 1.013157894736842, 1.0264814561379498, 1.046692607003891, 1.0327245053272451, 1.021555763823805, 1.4, 1.0, 1.386518771331058, 1.1481481481481481, 1.0081466395112015, 1.1273786911742152, 1.2294799112644812, 1.0796915167095116, 1.0, 1.0298330640818525, 1.0514285714285714, 1.4230769230769231, 1.0, 1.026274421738154, 1.2857142857142858, 1.405701754385965, 1.1401869158878504, 1.1753295015360221, 1.1120313862249347, 1.0061130922058075, 1.0480175006836205, 1.1109027591749263, 1.00418410041841, 1.0970588235294119, 1.1366179287326241, 1.139261744966443, 1.0857142857142856, 1.003731167052378, 1.0473150866559333, 1.0366838046272493, 1.0099502487562189, 1.0238095238095237, 1.182952182952183, 2.0, 1.0, 1.4019607843137254, 1.1502890173410405, 1.9746192893401016, 1.2571428571428571, 1.0774193548387097, 2.35, 1.0881186608708915, 1.0537878787878787, 1.076038561307058, 1.223529411764706, 1.2792792792792793, 1.100502512562814, 1.0, 1.2472837265577736, 1.64, 1.0994319250592528, 1.0793964375720815, 1.0532988572858453, 1.1401745569955037, 1.375, 1.1867667761614265, 1.1666666666666667, 1.0882669537136707, 1.0, 1.0542116254785938, 1.027479091995221, 1.0795708538220832, 1.196551724137931, 1.1162613981762919, 4.0, 1.233033033033033, 1.0089743982204262, 1.2374117241775278, 2.0, 1.1891891891891893, 1.3415233415233416, 1.4105960264900663, 1.0956658355818163, 1.0299605235819655, 1.1304347826086956, 1.0552727272727274, 1.032390243902439, 1.0558650038612576, 1.0035493589368927, 1.1169256255761446, 1.1796585003711952, 1.3020833333333333, 1.0287408759124088, 1.097406230641648, 1.0427350427350428, 1.0751757706868577, 1.0, 1.5, 1.1610608020698576, 1.104, 1.024776324845148, 1.1160865448075985, 1.095505617977528, 1.0, 1.2347826086956522, 1.44, 1.0216127401415571, 1.173913043478261, 1.0, 1.0240276144011415, 1.0, 1.0, 1.029434546862897, 2.0, 1.0055033991583036, 1.0113207547169811, 1.0509915014164306, 1.2, 1.076238430211033, 1.0967465753424657, 1.45, 1.0733843778555, 1.104, 1.1379310344827587, 1.0122950819672132, 1.2621291448516578, 1.0697828863346104, 1.0, 1.0357142857142858, 1.3846153846153846, 1.1464217639923757, 1.067246835443038, 1.75, 1.1121599111604663, 1.0075217378223065, 1.0195907705703091, 1.0, 1.0379115397406053, 1.005661328090265, 1.0355535210193028, 1.0523357664233577, 1.0046732883717375, 1.011032320493175, 1.0136592379583034, 1.069852047020673, 2.0, 1.1037723591320543, 1.053763440860215, 1.0335650923040038, 1.0967564595931831, 1.0693333333333332, 1.0095103225179447, 1.0781078107810782, 1.0635434480015908, 1.084528887165568, 1.0774239793239915, 1.1758241758241759, 1.1139375325093503, 1.029290583564312, 1.035294117647059, 1.236842105263158, 1.0711189302416828, 1.0578158458244111, 1.0073046596872446, 1.064986399820328, 1.0, 1.290950744558992, 1.4029411764705881, 1.25, 1.0350877192982457, 1.007264844201353, 1.0921501706484642, 1.0375586854460095, 1.0, 1.2530120481927711, 1.0059198542805101, 1.1773458696653756, 1.049534450651769, 1.0123268928301983, 1.1246019108280254, 1.002717391304348, 1.0126710593005575, 1.0166223306535764, 1.6, 1.0197975969491972, 1.1408268733850129, 1.1472081218274113, 1.072127642443707, 1.6153846153846154, 1.0054694268092423, 3.0, 1.2329881656804733, 1.0909090909090908, 1.0177486705695398, 1.1181818181818182, 1.0839091806515302, 1.0778145695364238, 1.0797101449275361, 1.1839196451620473, 1.0, 1.320754716981132, 1.0, 1.3333333333333333, 1.1415094339622642, 1.1004784688995215, 1.0196335078534031, 1.1295546558704452, 1.0640854472630175, 1.0297072957623417, 1.088547173331675, 1.1907324949845868, 1.0733516784904555, 1.139905177477553, 1.0202445625843792, 1.10917979359044, 1.08141592920354, 1.0507808576880586, 1.0222662048490847, 1.0824053452115814, 1.0973557692307692, 1.196078431372549, 1.0358340403183453, 1.2099056603773586, 1.100017657099135, 1.3125, 1.2099807135969143, 1.082828282828283, 1.3333333333333333, 1.028202115158637, 1.2352941176470589, 2.0, 1.3294573643410852, 1.054717100277848, 1.0372460496613995, 1.0128865979381443, 1.1849710982658959, 1.060989658162803, 1.0486577181208054, 1.1950757575757576, 1.2, 1.5, 1.1780269623283357, 1.0711111111111111, 1.1281843914274161, 1.1433926897844424, 1.0, 1.174342105263158, 1.1440860215053763, 1.1583102542891055, 1.1023738872403561, 1.0207897826522723, 1.0262236538057559, 1.0056567292869647, 1.2637362637362637, 2.0, 1.1035788198475593, 1.0, 1.057919621749409, 1.163265306122449, 1.3213021939136589, 1.1828683522231909, 1.7083333333333333, 1.0859503559612687, 1.0413793103448277, 1.4142857142857144, 1.1493672979902407, 1.248051948051948, 1.1330275229357798, 1.0641, 1.010091743119266, 1.0649305555555555, 1.2, 1.0143222701753045, 1.0620314265174078, 1.1904761904761905, 1.0135593220338983, 1.1972802331228751, 1.018181818181818, 1.03624198746967, 1.5555555555555556, 1.0369718309859155, 1.0988936335403727, 1.007125890736342, 1.215568862275449, 1.0796958119959177, 1.0307692307692307, 2.142857142857143, 1.05349932705249, 1.0040160642570282, 1.097259848741393, 1.178712220762155, 1.0334273076128773, 1.03934361407671, 1.23397913561848, 1.1182456140350878, 1.1735537190082646, 1.079880427217329, 1.037344398340249, 1.0223076923076924, 1.0198532585239535, 1.0297251336156035, 1.2145454545454546, 1.0273348519362187, 1.1818181818181819, 1.6, 1.0942928039702233, 1.6085316308763784, 1.0782907049282595, 1.7647058823529411, 1.0, 1.012, 1.0280575539568346, 1.047337278106509, 1.0570925242997957, 3.3333333333333335, 1.152161493048943, 2.5, 1.1284046692607004, 1.0666666666666667, 1.0626160631383472, 1.4666666666666666, 1.1901408450704225, 1.046207497820401, 1.0, 1.2110216985199023, 1.2182061579651942, 1.5, 1.3333333333333333, 1.0620689655172413, 1.0997150997150997, 1.0412087912087913, 1.202928870292887, 1.1131805157593124, 1.146341463414634, 1.0345679012345679, 1.027190332326284, 1.2457627118644068, 1.2491349480968859, 1.0666666666666667, 2.0, 1.1153846153846154, 1.1167883211678833, 1.048932384341637, 1.0190196247946746, 1.0726660401002506, 1.0676838235294117, 1.021769706241595, 1.2143414341434144, 1.1676300578034682, 1.008611955420466, 1.5555555555555556, 1.0, 1.25, 1.0173024833556945, 1.0584878744650499, 1.1368715083798884, 1.2544987146529563, 1.0480757017655278, 1.0042555567966045, 1.0150455468328763, 1.1071428571428572, 1.2380952380952381, 1.0, 1.0577645239673072, 1.0430767588342051, 1.0825648621529935, 1.0451977401129944, 1.0608889163627373, 1.0803013550692961, 1.0321779326992904, 1.0433186490455213, 1.0492822779364024, 1.0955631399317407, 1.0250578257517349, 1.0176348547717842, 1.0367406839058937, 1.0614035087719298, 1.0150918635170603, 1.0, 1.025390625, 1.0261419808642915, 1.015625, 1.0731681455808189, 1.030054644808743, 1.1111111111111112, 1.0212614361537349, 1.0600565379526043, 1.126595714964105, 1.0285941223193011, 1.0211946050096339, 1.1944740234265538, 1.1860869565217391, 1.0555555555555556, 1.0, 1.5, 1.0832643334612355, 1.6666666666666667, 1.2357308584686775, 1.1050772429519997, 1.000555864369094, 1.0751941827797058, 1.0754847784587562, 1.0443054935238947, 1.0029585798816567, 1.0326340326340326, 1.0169232876176315, 1.1461002297418326, 1.042466341723754, 1.2361326077188077, 2.142857142857143, 1.13135593220339, 1.034013605442177, 1.085102995034814, 1.002710027100271, 1.2955989110707804, 1.0061162079510704, 2.1906474820143886, 1.035940923527666, 1.069042316258352, 1.0550075872534144, 1.1, 1.0446927647983852, 1.029185109985482, 1.2836909871244635, 1.048695652173913, 1.0277777777777777, 1.0520416333066454, 1.0659693397531684, 1.0270188894523327, 1.1166666666666667, 1.019487581443198, 1.358974358974359, 1.0725675005315003, 1.0484886649874054, 1.0229885057471264, 1.0, 1.03125, 1.0653465346534654, 1.0639041437843235, 1.0065964247847163, 1.0681381957773513, 1.0091461517721965, 1.0693176261066952, 1.2666666666666666, 1.1118326118326118, 1.0937052932761087, 1.0397173489278753, 1.005868927290512, 1.056142301278488, 1.1238850346878098, 1.0528109028960817, 1.0574412532637076, 1.0541222313371617, 1.0769230769230769, 1.1240356083086054, 1.2487842437996435, 1.0304263981144204, 1.0793388429752067, 1.2461446324300045, 1.117559661992757, 1.077024358130349, 1.041501976284585, 1.100007381223807, 1.0882804363317438, 1.0750382848392037, 1.167487684729064, 1.0310262529832936, 1.0786764705882352, 1.088235294117647, 2.25, 1.053799743377408, 1.1688519950948024, 1.061, 1.0, 1.236030534351145, 1.007265024596047, 1.1735149096031932, 1.0005595970900951, 1.1818181818181819, 1.0150837988826815, 1.0980392156862746, 1.1091370558375635, 1.6774193548387097, 1.0534904046414757, 1.192085737840066, 1.0365853658536586, 1.0727272727272728, 1.1196213425129087, 1.1315649867374005, 1.0818181818181818, 1.2127659574468086, 1.035141800246609, 1.0489795918367346, 1.0486078338839075, 1.0, 1.0069237456532538, 1.153225806451613, 1.0237925291458483, 1.1983471074380165, 1.1666666666666667, 1.155379654060393, 1.0297604506459355, 1.0265167499285355, 1.15527950310559, 1.2459016393442623, 1.0588235294117647, 1.0, 1.0804597701149425, 1.1358024691358024, 1.0869392616117506, 1.0190519870792019, 1.0335186032421204, 1.3275862068965518, 1.0415741721025011, 1.0465882902068322, 4.0, 1.067727025557368, 1.0391304347826087, 3.0, 3.0, 1.1720509055310817, 1.109916864608076, 1.061536677420035, 1.2233502538071066, 1.5, 1.0376712328767124, 1.1091370558375635, 1.178343949044586, 1.0219918890762973, 1.0954969050658103, 1.0446066860995948, 1.022377770707392, 1.8571428571428572, 1.0235177173581538, 1.0396927016645328, 1.027336860670194, 1.100149476831091, 1.01301775147929, 1.0, 1.2307692307692308, 1.1125737630503858, 1.032226198766012, 1.6229508196721312, 1.0854430379746836, 1.0892447084664536, 1.0608108108108107, 1.1660777385159011, 1.1884057971014492, 1.019118863808866, 1.1631660140026105, 1.0665706875979923, 1.365482233502538, 1.1007751937984496, 1.0625, 1.375, 1.0676783004552353, 1.0452261306532664, 1.0039306586442434, 1.0473637176050046, 1.5, 1.0182049110922946, 1.0422011448627417, 1.1367803447011369, 1.0485104997558197, 1.0521052240369217, 1.072734946539111, 1.097176716626002, 1.2320185614849188, 1.0909090909090908, 1.05083857442348, 1.0852780769691064, 1.2442936458975942, 1.0431547619047619, 2.3333333333333335, 1.0987654320987654, 1.0596765472152583, 1.0472673559822747, 1.0475210833935067, 1.0803532102922582, 1.0578069129916567, 2.75, 1.1223814773980154, 1.060579712976622, 1.174570187039486, 1.2364217252396166, 1.1033739558813305, 1.005249343832021, 1.2764003673094582, 1.0552027357107963, 1.031816683650482, 1.110340479192938, 1.0443159922928709, 1.0633640552995391, 1.0263157894736843, 1.1555719921104537, 1.2944214876033058, 1.00021055586749, 1.0655318202047175, 1.1211326691137913, 1.0313873195229128, 1.3734177215189873, 1.3119469026548674, 2.0, 2.0, 1.15, 1.0169851380042463, 1.0170603674540681, 1.0583929680096722, 1.0212538602096535, 1.1529252315337701, 1.0455960446804615, 1.0948275862068966, 1.0692567567567568, 1.020926171439251, 2.0, 1.7692307692307692, 1.3380332610267534, 1.0, 1.1091811414392059, 1.1606174384647476, 1.0179677345362794, 1.0944364093483463, 3.0, 1.0679464511240213, 1.2, 1.1512949435537425, 1.0390951767972896, 1.1663113006396588, 1.1091011871113623, 1.151862357244159, 1.122293827409123, 1.0404463040446303, 1.0238095238095237, 1.1334120425029517, 1.3333333333333333, 2.0, 1.0411425039928817, 5.0, 1.3333333333333333, 1.9375, 1.0151209677419355, 1.0712210310032082, 1.135678391959799, 1.0419847328244274, 1.0, 1.0913508494809063, 1.0092592592592593, 1.1869031377899044, 1.2912423625254583]
origin-bjaq_15.71 	max: 7.0000	99th: 3.0000	95th: 1.6672	median: 1.0760	mean: 1.1816

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.143587 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.278801