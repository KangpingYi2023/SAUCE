Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 12, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.6675	95th: 1.7146	median: 1.0806	mean: 1.1747
ReportEsts: [1.0294117647058822, 1.0080729166666667, 1.0457011414435138, 1.0276679841897234, 1.5, 1.0, 1.0274008764056808, 1.061063848967798, 1.0, 1.0103761348897535, 1.1535509191123423, 1.042971867630415, 1.0214500214500215, 1.1348837209302325, 1.0618156128576475, 1.0, 1.3846153846153846, 1.0655331207934822, 3.0, 2.0, 1.125, 1.1340180973343115, 1.0839989693377996, 1.1068702290076335, 1.0754810064134188, 1.0, 1.133158807089539, 1.5, 1.2, 1.0, 1.0, 1.0476703032880195, 1.0124501746961272, 1.0277469478357382, 1.1124981641944485, 1.2216524687784303, 1.1283422459893049, 1.0081616466256706, 1.1472208829809216, 1.0952380952380953, 1.164179104477612, 1.0121951219512195, 1.0, 1.044240837696335, 1.1847587719298245, 1.890625, 1.0198019801980198, 1.2367491166077738, 1.0329131937385647, 1.0093457943925233, 1.1375681674933544, 1.104810996563574, 1.0375902158312904, 2.0, 1.1818181818181819, 1.2906718377570396, 1.27669452181987, 1.3592233009708738, 1.038709677419355, 1.0, 1.0565930570701563, 1.0902864259028642, 1.1136363636363635, 1.0481927710843373, 1.0, 1.0376023559833358, 1.2829713566257475, 1.75, 1.0, 1.0771884030949939, 1.0282208588957056, 1.0664723032069972, 1.0254041570438799, 1.0432052024408713, 1.0894117647058823, 1.0693069306930694, 1.0, 1.11482254697286, 2.6666666666666665, 1.010130581602632, 1.2307692307692308, 1.0313196215814795, 1.116564417177914, 1.0886392009987516, 1.1251226692836114, 1.0, 1.072760398495949, 1.0214264398686959, 1.1666666666666667, 1.75, 1.2262295081967214, 1.0371034815394298, 1.1775700934579438, 1.0140252454417953, 1.0027397260273974, 1.010498687664042, 1.0305343511450382, 1.1456500488758554, 1.0, 1.2513398838767307, 1.0083513318934485, 1.0591766723842195, 1.2363231829683274, 1.36, 1.02048184820556, 1.0706132200690204, 1.2622008082064036, 1.1073189230185818, 1.049662783568363, 1.3333333333333333, 2.0, 1.0457943925233646, 1.0808234234930876, 1.038534428300695, 1.1428571428571428, 1.0598893595060828, 1.0, 1.1617786187322612, 1.1458333333333333, 1.0, 1.0054945054945055, 1.0, 1.1879699248120301, 1.0202718715843613, 1.0775025238797857, 1.087378640776699, 1.8, 1.1920529801324504, 1.0, 1.2173913043478262, 1.100367034382636, 1.1818181818181819, 1.0289713541666667, 1.0479441300784416, 1.077877675066481, 1.0720961281708945, 1.0136986301369864, 1.0003898635477584, 1.039972432804962, 1.0719073735527118, 1.0438562235767526, 1.2857142857142858, 1.0179282868525896, 1.0867459322632071, 2.0, 1.0186873290793073, 1.0355029585798816, 1.1025991792065664, 1.0751720487030174, 1.5, 1.236497941390167, 1.0448916408668731, 1.0395010395010396, 1.1074561403508771, 1.0437956204379562, 1.0323668240053945, 1.0921029794619612, 1.0962384459492858, 1.0293542074363993, 1.0855263157894737, 1.2653061224489797, 1.3269230769230769, 1.0014727540500736, 1.4285714285714286, 1.071462153267513, 1.051513926907563, 1.1526211015262111, 1.3594447680062123, 1.1045883940620782, 1.1625188836765525, 1.2947368421052632, 1.1147540983606556, 1.0867628546528518, 1.0273003033367036, 1.002588438308887, 1.1137026239067056, 1.0347853337511752, 1.1385972651080722, 1.0583942753794133, 1.0, 1.0555555555555556, 1.0071063104036384, 1.0283094098883572, 1.181381118881119, 1.2105263157894737, 1.0870789279567248, 1.2675379588698827, 1.0607969179490508, 1.16, 1.230909090909091, 1.1490519547257323, 1.0, 1.4545454545454546, 1.040837738590049, 1.042603550295858, 1.0078996282527881, 1.4583333333333333, 1.0565916398713826, 1.0443537820437063, 1.0615574960146565, 1.0626410835214446, 1.0573416253821017, 1.3672316384180792, 1.0847457627118644, 1.2173913043478262, 1.0, 1.415929203539823, 1.0850812174735847, 1.3275261324041812, 1.2183908045977012, 1.0128521997034108, 1.0031277926720286, 1.020972538044429, 1.0173121740095439, 1.0968867991736126, 1.2054794520547945, 1.0404624277456647, 1.000973078170613, 1.033976678729393, 1.0250441280975633, 1.0, 1.060041407867495, 1.1241407834872865, 1.0209559426768748, 1.15679012345679, 1.0544914951498996, 1.2757095068522715, 1.0357142857142858, 1.0028020701694411, 1.0995358432181537, 1.0084602368866329, 1.0847457627118644, 1.1614068899060468, 1.0344294003868473, 1.2299212598425198, 2.0, 1.2188940092165899, 1.0886556498436801, 1.084857008907642, 1.1806167400881058, 1.0, 1.6666666666666667, 1.0424719931059954, 1.1272727272727272, 1.1216089803554723, 1.5, 1.0, 1.1764705882352942, 1.0039184952978057, 1.1264367816091954, 1.0165745856353592, 1.0516877637130801, 1.0453020134228188, 1.0067170445004199, 1.1680571417510308, 1.0175438596491229, 2.0, 1.0933111261900357, 1.0677705326397537, 1.0823117338003503, 1.0001463516621367, 1.1513875486153755, 1.0085351329892815, 1.0961844197138315, 1.1024065630336426, 1.0239234449760766, 1.1571244773238984, 1.1511167656205825, 1.1818181818181819, 1.0457503203276135, 1.1355932203389831, 1.1590909090909092, 1.3888888888888888, 1.0238272524199554, 1.0555555555555556, 1.0683760683760684, 1.1589933382679496, 1.033426183844011, 1.3433583959899749, 1.0217953827576156, 1.0356211989574282, 1.0287806452709016, 1.0513840386482054, 1.25, 1.0478719534376137, 2.5, 1.0287042147406416, 1.0215982721382288, 1.0367939556688361, 1.0526315789473684, 2.0, 1.3043478260869565, 1.0597014925373134, 1.061569522924891, 1.0, 1.0315457413249212, 1.088235294117647, 1.0064102564102564, 1.0189553227080526, 1.0988372093023255, 1.1383647798742138, 1.0003779355927436, 1.1082682720346158, 1.0658994032395568, 1.1025641025641026, 1.0, 1.0763723150357996, 1.264797507788162, 1.1145833333333333, 1.1418702611625948, 1.031276063386155, 1.0112676056338028, 1.0727272727272728, 1.0027434842249656, 1.0051867219917012, 1.2857142857142858, 1.0114882062152355, 1.038022813688213, 1.105263157894737, 1.0946803852889668, 1.2380952380952381, 1.4, 1.0167290094887889, 2.0, 1.149519890260631, 1.0348837209302326, 1.0541427399507792, 1.0665590964098426, 1.005249343832021, 1.011111111111111, 1.122444838268916, 1.095567293882817, 1.0699708454810495, 1.0390644968901763, 1.1109908795795331, 2.0, 1.0, 1.054537352316095, 1.25, 1.07035175879397, 1.3529411764705883, 1.0, 1.4666666666666666, 1.3283132530120483, 1.054003724394786, 1.1217391304347826, 1.0054406964091405, 1.0, 1.203728362183755, 1.0561891316934806, 2.0, 1.3513996426444312, 1.0, 1.0956501935777727, 1.0595238095238095, 1.0015743899239045, 1.140552995391705, 1.1363636363636365, 1.24364406779661, 1.3055555555555556, 1.0156214088182742, 1.0206510359762442, 1.0622347949080622, 1.0, 1.1666666666666667, 1.5714285714285714, 1.5, 1.0666666666666667, 1.0696868653603382, 1.3333333333333333, 1.0831946755407653, 1.216867469879518, 1.2133743274404305, 1.077035758194041, 1.2255406797116375, 1.008010092955165, 1.0133410672853829, 1.042857142857143, 1.5, 1.2213740458015268, 1.0553191489361702, 1.048348811738888, 1.1428571428571428, 1.5714285714285714, 1.0466200466200466, 1.0153482880755609, 1.0270742998387064, 1.0277078085642317, 1.1464387464387464, 1.009575923392613, 1.0125, 1.0907770515613653, 1.0635593220338984, 1.2307692307692308, 1.0254957507082152, 1.128440366972477, 1.0612660064341135, 1.0682445093634703, 1.0390847848516114, 1.1395348837209303, 1.009090909090909, 1.081570996978852, 1.0, 1.0131677714023994, 1.0428569138961754, 1.047442497520427, 1.060948510451202, 1.0606490872210954, 1.1534795042897998, 1.5714285714285714, 1.3296985246953175, 1.0, 1.1981212638770282, 1.25, 1.0519139111451463, 1.0043478260869565, 1.0880266552020637, 1.173913043478261, 1.2497492477432297, 3.0, 1.1809062608094085, 1.0160446427470944, 1.157025933419165, 2.0, 1.1587301587301588, 1.2543186180422266, 1.2125435540069687, 1.1310659127352518, 1.313929313929314, 1.05, 1.1863675582398618, 1.0180351661947702, 1.0372851169273656, 1.097474284058531, 1.2134868421052631, 1.1359867330016584, 1.263157894736842, 2.142857142857143, 1.0706521739130435, 1.5, 1.2216666666666667, 1.1785714285714286, 1.2087341383544823, 2.0833333333333335, 1.1027202349989291, 1.1158638230593412, 1.0573719925971623, 1.0, 1.2127659574468086, 1.2, 1.2853998899614865, 1.2407002188183807, 1.0, 1.0170729993676666, 1.0845738819137891, 1.086199751346871, 1.5, 2.0, 1.0116504854368933, 1.0163934426229508, 1.0262295081967212, 1.1111111111111112, 1.076365960166152, 1.0751269035532995, 1.4705882352941178, 1.0342749529190207, 1.0454545454545454, 1.0774278215223096, 1.0354838709677419, 1.2410601598653765, 1.0711387112641417, 1.0, 1.0724637681159421, 1.0614224513252761, 1.0331842147307877, 1.0136768003680003, 1.0, 1.070780800707808, 1.0136062015911114, 1.0220010476689365, 2.0, 1.0657894736842106, 1.0430149766756691, 1.025024288279801, 1.036870385741121, 1.0068692263911387, 1.0481402511253257, 1.0008410428931875, 1.1270491803278688, 2.0, 1.054214688097576, 1.4509803921568627, 1.25, 1.150259067357513, 1.1346153846153846, 1.0029548561330976, 1.1584645669291338, 1.0963071277022765, 1.1266636071592473, 1.0392947279865394, 1.1210604625997564, 1.0647849555578672, 1.197674418604651, 4.0, 1.0287600528147882, 1.1536437246963562, 1.0477719100456893, 1.0347589223199471, 1.1009639776763065, 1.1736842105263159, 2.5180722891566263, 2.2857142857142856, 1.0040658324000584, 1.0709725580203446, 1.0443796691311313, 1.1376865671641792, 1.0817826841496336, 1.025369978858351, 1.0711759688793658, 1.012008733624454, 1.2170542635658914, 3.0, 1.3333333333333333, 1.0368098159509203, 1.0700757575757576, 1.0700179533213645, 1.1457765667574933, 1.0059171597633136, 1.5307692307692307, 1.148905109489051, 1.116564417177914, 1.0825321092074507, 1.313953488372093, 1.0387888288173006, 2.0, 1.1806615776081424, 1.1004366812227073, 1.3823529411764706, 1.0860335195530726, 1.0155555555555555, 1.0630252100840336, 1.1102464332036317, 1.1614219917813509, 1.0, 1.297872340425532, 1.2, 1.0, 1.1818181818181819, 1.0786290322580645, 1.0140845070422535, 1.0825242718446602, 1.0607177186799104, 1.0765661252900232, 1.0760865558299848, 1.1995978473002542, 1.0402476780185759, 1.1095370250849792, 1.027027027027027, 1.1111111111111112, 1.0106434446057087, 1.0730799893701835, 1.143063583815029, 1.0785568810008728, 1.038615517154006, 1.1173625167244159, 1.0793607704745831, 2.0, 1.1277641277641277, 1.0670611439842208, 1.3818181818181818, 1.0, 1.108695652173913, 1.25, 1.1894736842105262, 1.4074074074074074, 1.1666666666666667, 1.0059853226676978, 1.1269326283745895, 1.023170542435138, 1.0188403568132882, 1.227027027027027, 1.1182065217391304, 2.0, 1.1079136690647482, 1.0240706255603835, 1.068850107578293, 1.082687988344766, 1.063105137259369, 1.0273318393887072, 1.2051948051948052, 1.0520078354554359, 1.0603907637655416, 1.0137116846424647, 1.1048306632278468, 1.2727272727272727, 1.0725720384204909, 1.0, 1.2422535211267605, 1.2085122998828584, 3.0, 1.1270680147058822, 1.0726240148354196, 1.4285714285714286, 1.0334685975950262, 1.0, 1.0555555555555556, 1.0911816755666495, 1.6923076923076923, 1.0039615853621544, 1.0316104228961982, 1.3571428571428572, 1.0357142857142858, 1.1154639175257732, 1.002391200382592, 1.1209713024282562, 1.0533062571392309, 1.1532211436048811, 1.0, 1.0337823158809472, 1.1219512195121952, 2.0, 1.0218188527804046, 1.1113504628428064, 1.195837275307474, 1.0138877391830368, 1.0507392775797506, 1.0272727272727273, 1.7142857142857142, 1.0726234190126478, 1.0161290322580645, 1.121510868274142, 1.1752254018032144, 1.005919252353787, 1.0204795274383873, 1.2875457875457876, 1.0467289719626167, 1.2207357859531773, 1.0738404186680048, 1.0485804416403786, 1.0878623188405796, 1.0987394957983194, 1.0350869233840234, 3.0, 1.1452419197453951, 1.0518056165443406, 1.0229891234254762, 1.2666666666666666, 1.3328009998611303, 1.168103448275862, 1.1428571428571428, 1.0809762291034775, 1.0420575865415722, 1.1408296943231442, 1.0, 1.3333333333333333, 1.0489607224770643, 1.5, 1.0350467289719627, 1.0833333333333333, 1.077838252738818, 1.3846153846153846, 1.2067510548523206, 1.0524109014675052, 1.0, 1.5833333333333333, 1.239059967585089, 1.25, 2.0, 1.146551724137931, 1.1517241379310346, 1.0083932853717026, 1.1987421383647798, 1.1053540587219344, 1.2123893805309736, 1.1014466214978942, 1.0597402597402596, 1.1290322580645162, 1.4, 1.0384615384615385, 1.0, 1.0608324439701173, 1.0620490620490621, 1.074361820199778, 1.0780743884731374, 1.08267146873914, 1.0502997133176961, 1.0632244389766696, 1.1494360902255638, 1.139917695473251, 1.0011933174224343, 1.5714285714285714, 1.0, 1.2592592592592593, 1.0147681566365636, 1.0741394527802295, 1.107843137254902, 1.0972972972972972, 1.047880870561283, 1.0222781417103157, 1.0103335058150995, 1.0985915492957747, 1.2222222222222223, 1.0344563552833077, 1.0066720042700827, 1.075462688533228, 1.0425197266683408, 1.0526315789473684, 1.0417158889545186, 1.0165261370012586, 1.1960183767228179, 1.3233197556008147, 1.125, 1.0799609946367625, 1.1813063063063063, 1.1304347826086956, 1.1292307692307693, 1.0701001430615165, 1.0, 1.0579710144927537, 1.0363182328590343, 1.08, 1.0850985917735374, 1.0042372881355932, 1.4827586206896552, 1.0192139090920316, 1.0652847873107427, 1.0608380338436745, 1.0372137404580153, 1.0256111757857975, 1.1988784162697206, 1.1570247933884297, 1.2857142857142858, 1.0, 1.6666666666666667, 1.0664648177304106, 1.3333333333333333, 1.1432169845268083, 1.1341877120241237, 1.0166666666666666, 1.0985104270109236, 1.0474028973127598, 1.0912111468381565, 1.021505376344086, 1.044382801664355, 1.01606123934534, 1.0913010873640794, 1.041460735859418, 1.2489160544381548, 1.6666666666666667, 1.0158730158730158, 1.0553359683794465, 1.122655897951402, 1.0098684210526316, 1.2839740119112073, 1.0405156537753222, 2.2017167381974247, 1.034121984015471, 1.018791946308725, 1.0264593301435407, 1.125, 1.0861377168004143, 1.0362727186955887, 1.317922077922078, 1.0581052631578947, 1.09375, 1.2114137483787288, 1.1104972375690607, 1.625, 1.050063775510204, 1.6923076923076923, 1.0782608695652174, 1.0807600950118765, 1.0473163841807909, 1.0067351405960598, 1.0167464114832536, 2.75, 1.0666666666666667, 1.0902422883194236, 1.0505639202177899, 1.0041153288216214, 1.0251627043214937, 1.0677075147133301, 1.0833333333333333, 1.0979202772963605, 1.1113764654798088, 1.0277835134329043, 1.0070140280561122, 1.0208333333333333, 1.0174311926605504, 1.0357651284522218, 1.336893203883495, 1.0625695216907676, 1.0, 1.3333333333333333, 1.0414892828005637, 1.0215610176800345, 1.2481303930968362, 1.1712723565934575, 1.0574620909816441, 1.1421319796954315, 1.0948931011029954, 1.118903776705255, 1.088235294117647, 1.0335195530726258, 1.0295602018745493, 1.1021081823982721, 1.1071428571428572, 1.75, 1.0575108516198162, 1.1784111859816286, 1.0311581422692533, 1.0113636363636365, 1.2671976828385227, 1.0123254307917557, 1.1737419173460781, 1.3745704467353952, 1.1153846153846154, 1.0222371967654986, 1.082004555808656, 1.14375, 1.72, 1.0377360598949603, 1.1684836471754212, 1.1733001658374793, 1.0731707317073171, 1.0275922024943993, 1.0199769496734536, 1.0713186077643908, 1.2345018815607052, 1.3333333333333333, 1.0769230769230769, 2.0, 1.1438523162661094, 1.3076923076923077, 1.0, 1.1538461538461537, 1.0463576158940397, 1.0942028985507246, 1.0584569408506141, 1.0159857616697678, 1.0709090909090908, 1.3076923076923077, 1.0666666666666667, 1.032258064516129, 1.054054054054054, 1.0571428571428572, 1.1049913941480207, 1.0228618898712034, 1.0362287113650699, 1.3195876288659794, 1.0517907579518955, 1.0473249587107751, 2.5, 1.0675376816032118, 1.3157894736842106, 3.0, 2.0, 1.1940828402366863, 1.12106433335724, 1.080475596103612, 1.18944099378882, 1.0, 1.069767441860465, 1.0920245398773005, 3.0, 2.0, 1.0106938572494404, 1.1353676569431375, 1.0074269889224572, 1.6666666666666667, 1.0314552981205998, 1.0472501936483347, 1.0102564102564102, 1.0, 1.0751173708920188, 1.0251972845377166, 1.027027027027027, 1.1394989174141663, 1.017644620759074, 1.3364779874213837, 1.06640625, 1.0677412712886432, 1.0893023255813954, 1.1074380165289257, 1.1129032258064515, 1.0466070066358797, 1.4167388667475307, 1.0427774118625854, 1.1928571428571428, 1.1176470588235294, 1.3582089552238805, 1.1216783216783217, 1.0649921507064364, 1.0197461500096696, 1.0939183751676567, 1.0327510917030567, 1.5, 1.6666666666666667, 1.087611072045004, 1.1838170624450308, 1.0877261233223108, 1.0068052674856716, 1.0767686904164575, 1.0807923070600804, 1.0400943396226414, 1.0212765957446808, 1.137017530068391, 1.0894783341209344, 1.2432234432234432, 1.0306859205776173, 1.6666666666666667, 1.0273972602739727, 1.0637243424646843, 1.1586378737541527, 1.0160049918103111, 1.1060058359827534, 1.0291193181818181, 2.0, 1.0780856423173804, 1.0590990317569697, 1.1560429517934658, 1.1102661596958174, 1.070692080293711, 1.0573248407643312, 1.218543046357616, 1.0005797101449276, 1.0324903196774557, 1.057538513342874, 1.0172811059907834, 1.0455153949129852, 1.0, 1.1877410188755835, 1.053706920193802, 1.035667107001321, 1.062514986469359, 1.0950639853747715, 1.046142208774584, 1.2, 1.262734584450402, 1.6666666666666667, 2.0, 1.1176470588235294, 1.0025641025641026, 1.0150078988941549, 1.0051245868766014, 1.0071939346945809, 1.1540870654556843, 1.0427574171029668, 1.1793478260869565, 1.1951219512195121, 1.0550937519728951, 1.6, 1.4166666666666667, 1.131762973868237, 1.1428571428571428, 1.1361573373676248, 1.1420682730923695, 1.1093285263632267, 1.0975231695638765, 2.0, 1.0996904024767802, 1.2054263565891472, 1.14114968696642, 1.0407029551272053, 1.125, 1.117123287671233, 1.1561824567723342, 1.1405252822778595, 1.02442996742671, 1.3653846153846154, 1.1215083798882681, 1.0, 1.0, 1.0415221200958478, 5.0, 1.5714285714285714, 1.8, 1.0752269779507133, 1.1604938271604939, 1.0875831485587584, 1.0851314240878775, 1.0, 1.0924891371818746, 1.0110981308411215, 1.120603015075377, 1.2740384615384615, 1.4285714285714286, 1.0527050610820243, 1.2621951219512195, 1.15990990990991, 1.0740052063964298, 1.0275439913379079, 1.145687885010267, 1.088139603667554, 1.0, 1.1872064982865846, 1.0182487996321368, 1.048018292682927, 1.1774193548387097, 1.0314250309789343]
origin-bjaq_15.71 	max: 5.0000	99th: 2.6675	95th: 1.7146	median: 1.0806	mean: 1.1747

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 14.115581 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[8.3446503e-07 8.9406967e-07 7.7486038e-07 1.3709068e-06 2.3841858e-07]
Distance score: 8.225441092690744e-07
SAUCE Drift detection: False
Detection latency: 0.0235s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.059062 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.5000	95th: 1.7014	median: 1.0820	mean: 1.1738
ReportEsts: [1.0925925925925926, 1.0383856108795788, 1.054477688452515, 1.1192170818505338, 1.4782608695652173, 1.0, 1.04555421309348, 1.0589888969498156, 1.3333333333333333, 1.016629711751663, 1.1189936864427201, 1.043371755759607, 1.0440702257255463, 1.1381322957198443, 1.028563101136695, 1.1785714285714286, 1.1883116883116882, 1.3333333333333333, 1.3636363636363635, 1.068734283319363, 1.0937078651685392, 1.0554855857342633, 1.0408805031446542, 1.0424088210347753, 1.0083065984566029, 1.031846286816036, 2.0, 1.1802931145727718, 1.75, 1.0, 1.0967169476486247, 1.0, 1.0458229460869692, 1.0040182972819218, 1.099954149472719, 1.0167343423157376, 1.2317314022383148, 1.1488888888888888, 2.0, 1.1437578814627996, 1.0886192314763743, 1.057894841625356, 1.046674445740957, 1.0682926829268293, 1.0145719489981786, 1.0431025921144106, 1.0, 1.042296072507553, 1.1216216216216217, 1.029291553133515, 1.2857142857142858, 1.2145922746781115, 1.1120689655172413, 1.0, 1.015869950881597, 1.0082470038594353, 1.1067528072604216, 1.1618037135278514, 1.10989010989011, 1.0850527108433734, 1.4333333333333333, 1.1444360605696844, 1.0950920245398772, 1.1484375, 1.0188679245283019, 4.0, 1.0750471362779341, 1.265063356607189, 1.4, 1.0, 1.056885296860429, 1.0, 1.0469052224371374, 1.001908396946565, 1.0401920945696344, 1.0631868131868132, 1.0684356208838408, 1.7007299270072993, 1.4757281553398058, 1.0820321432818345, 1.016798418972332, 1.08, 1.0, 1.0588235294117647, 1.0773606370875994, 1.1515151515151516, 1.25, 1.0833333333333333, 1.25, 1.1194424841213833, 1.120115116631324, 1.2607562652472832, 1.0286138031554453, 1.1203462397617274, 1.1171875, 1.0201421800947867, 1.3089430894308942, 1.0323014804845223, 1.3333333333333333, 1.3281684545093364, 1.1, 2.0, 1.0589666120442442, 1.3011632916846188, 1.1164629762760603, 1.235564233286329, 1.4827586206896552, 1.0185099296968554, 1.0902670492165085, 1.324113347170833, 1.1721833227243794, 1.0455242966751919, 1.2857142857142858, 1.5, 1.0427765895391794, 1.0792959635488435, 1.0643799472295514, 1.0795454545454546, 1.0541674703254427, 2.0, 1.0128777923784493, 1.1746031746031746, 1.5, 1.0735294117647058, 1.2857142857142858, 1.1906779661016949, 1.020506997389804, 1.0374138708223324, 1.1570247933884297, 1.5, 1.223901098901099, 1.0, 1.0, 1.1117163696796233, 1.0769230769230769, 1.0074942978168784, 1.0350044598952497, 1.0579860750285774, 1.0, 1.5, 1.030612244897959, 1.1342010771992819, 1.0555, 1.0522933557515566, 1.1575757575757575, 1.0081654872074033, 1.0881729374410372, 1.0, 1.0306513409961686, 1.0087378640776699, 1.1113013698630136, 1.097564532594429, 2.5, 1.2317073170731707, 1.1046195652173914, 1.0221465076660987, 1.0336956521739131, 1.0, 1.04874213836478, 1.0785269559341668, 1.1365455009789733, 1.0296052631578947, 1.0326975476839237, 1.2295081967213115, 1.3174603174603174, 1.0348258706467661, 1.7142857142857142, 1.0683124882958335, 1.2, 1.1162162162162161, 1.0438706381736582, 1.0562333360265008, 1.0273287785369105, 1.2378472222222223, 1.1784232365145229, 1.0577495375211132, 1.0412580317889752, 1.0057845263919016, 1.0687702265372168, 1.0416117987885172, 1.0708465368945224, 1.213217310712355, 1.264516129032258, 1.2, 1.0093531399827085, 1.0870912067973624, 1.2318840579710144, 1.323869104908566, 1.0455635491606714, 1.2, 1.2203389830508475, 1.081842950207736, 1.8, 1.145611364789447, 1.0548464397496087, 1.0090732441650632, 1.0216924910607867, 1.1084093211752786, 1.1206581352833638, 1.377964003428245, 1.0093648208469055, 1.0450551926109484, 1.017473435655254, 1.07181986610805, 1.0658204043253408, 1.0056432413367429, 1.430622009569378, 1.0714285714285714, 1.3875, 1.0, 1.3357142857142856, 1.1604404246952418, 1.2658959537572254, 1.2352941176470589, 1.0127940569541891, 1.04, 1.045676070634138, 1.1037735849056605, 1.2403627212080055, 2.0, 1.010909090909091, 1.0220567962503446, 1.0264645980591829, 1.034062422259219, 2.0, 1.109375, 1.1312124297868147, 1.0200712735018227, 1.0401069518716577, 1.033167495854063, 1.1053936763794172, 1.062526322609907, 1.3801652892561984, 1.0080632860002487, 1.1472863800549218, 1.0906344410876132, 1.0962616822429907, 1.0418552036199096, 1.0, 1.2048271363339857, 2.0, 1.2276422764227641, 1.0532832498608793, 1.1075875486381324, 1.1029900332225913, 1.0714285714285714, 1.2, 1.076488585549541, 1.0714285714285714, 1.113039343872578, 2.0, 1.0432395332875772, 1.052, 1.4285714285714286, 1.0015157974515656, 1.0488372093023255, 1.1259911894273127, 1.187830687830688, 1.0098730606488011, 1.1172244555302626, 1.088235294117647, 2.0, 1.085334818559616, 1.000286024826955, 1.1186685962373373, 1.0046137113185039, 1.172417207068957, 1.0104887394216722, 1.0805812417437253, 1.0843261848027534, 1.0163447251114412, 1.002418797512094, 1.043103448275862, 1.0, 1.0101401850280773, 1.1185770750988142, 1.2307692307692308, 1.1071428571428572, 1.0457023060796646, 1.204225352112676, 1.0269687637483502, 1.0208530473486839, 1.1563981042654028, 1.35625, 1.0190473836418914, 1.0007057163020465, 1.1419851765731726, 1.0585874273738574, 1.1818181818181819, 1.1085972850678734, 1.0224242424242425, 1.083370502527505, 1.0024984384759525, 1.0806270046878854, 1.191544885177453, 1.1901840490797546, 1.057670534956128, 1.084308973615046, 1.1147055102741583, 1.0817864441416893, 1.0759615384615384, 1.5625, 1.1538461538461537, 1.082847315687154, 1.5, 1.0679245283018868, 1.0576880937656734, 1.0579753679783719, 1.457142857142857, 1.0077519379844961, 1.1683760683760684, 1.0796722454672245, 1.0145799455265847, 1.0952380952380953, 1.1425899953249181, 1.0071076044434908, 1.0927318295739348, 1.3, 2.3636363636363638, 1.0310915104740903, 1.1, 1.006619116830781, 1.036050156739812, 1.105263157894737, 1.0801628575338715, 1.434782608695652, 1.1538461538461537, 1.0100037351036315, 2.0, 1.201834862385321, 1.0704738760631836, 1.1010156464452374, 1.1458333333333333, 1.108910891089109, 1.08, 1.0964156207991143, 1.0919928283887554, 1.0578313253012048, 1.042761962447002, 1.0373349339735893, 3.0, 1.1, 1.0484804010330795, 1.5, 1.066449814126394, 1.6470588235294117, 2.0, 1.4444444444444444, 1.2632020117351215, 1.0545886075949367, 1.3135593220338984, 1.0581639803784162, 1.2289156626506024, 2.0, 1.0267530903949267, 1.8, 1.1142857142857143, 1.0091365496204103, 1.0632411067193677, 1.0565184626978146, 1.0298507462686568, 1.75, 1.0, 1.337171052631579, 1.1376811594202898, 1.0987925356750823, 1.1390322197122815, 1.2439175003087564, 1.0330788804071247, 1.0, 1.025992676724276, 1.008, 1.3448275862068966, 2.0, 1.056602485320224, 1.1428571428571428, 1.0735632183908046, 1.16, 1.1593300617690863, 1.1132215419072413, 1.1025267249757045, 1.0497547683923705, 1.1080321285140562, 1.0606060606060606, 1.16793893129771, 1.13687490500076, 1.165202108963093, 1.0303030303030303, 1.0186897463637457, 1.0447091907503467, 1.0292031607006855, 1.0490196078431373, 1.075, 1.3183962264150944, 3.0, 1.0434782608695652, 1.463768115942029, 1.2131782945736433, 1.3396226415094339, 1.2941176470588236, 1.1168403730115195, 1.5977011494252873, 1.0560255110209746, 1.0696421700654097, 1.075626561256142, 1.0404040404040404, 1.3431372549019607, 1.0892857142857142, 1.0, 1.0820179129804106, 1.6862745098039216, 1.1082205248430765, 1.0930407490986433, 1.061714863839474, 1.139782088758969, 2.0, 1.4048165137614679, 1.0, 1.0908471883334279, 1.0909090909090908, 1.03192167461309, 1.0218712029161603, 1.079443447037702, 1.015923566878981, 1.0155091031692516, 3.0, 1.1759792626728112, 1.0118536658938053, 1.0969179068650985, 3.0, 1.0, 1.2637450199203186, 1.2919254658385093, 1.077301640441915, 1.090125072404694, 1.0, 1.0789855072463768, 1.0079436686019143, 1.0189243500688303, 1.1457974509128488, 1.0639944275582573, 1.2974683544303798, 1.6, 1.036439114391144, 1.085924188666386, 1.098360655737705, 1.1206611570247933, 1.0, 1.5, 1.2788079470198674, 1.110655737704918, 1.0321116928446772, 1.051736478941793, 1.0911949685534592, 1.0, 1.184873949579832, 1.0909090909090908, 1.0941293312734495, 1.0833333333333333, 1.0, 1.0265366680796948, 1.0, 1.0, 1.0379992245056224, 1.5, 1.0052168242582329, 1.0007547169811322, 1.0299727520435968, 1.0909090909090908, 1.0867426899711927, 1.0966350301984469, 1.5238095238095237, 1.0371291022938234, 1.0534351145038168, 1.0664488017429194, 1.0256410256410255, 1.3673398328690807, 1.0079635404173664, 1.0, 1.0833333333333333, 1.1190905810176832, 1.1120904706469317, 1.0510366826156299, 1.5, 1.0818131564400222, 1.0083262829621964, 1.0200435729847495, 2.0, 1.0526842280760254, 1.0158360919745906, 1.0459296334461947, 1.009926189870196, 1.0010114449161298, 1.0058324176472593, 1.0140646976090013, 1.2459918264696637, 1.5, 1.0871026104936676, 1.0622171945701357, 1.0496488253814482, 1.0303550973654065, 1.1185567010309279, 1.0115386754156703, 1.0317297850562948, 1.0970235578495584, 1.0170212765957447, 1.0750276799194767, 1.10840108401084, 1.104121529074835, 1.0541073052440133, 1.0689655172413792, 1.2142857142857142, 1.0794259345067696, 1.0254777070063694, 1.0049655318137398, 1.0597956045046386, 1.3333333333333333, 1.0732447817836812, 1.0203488372093024, 2.0, 1.0555555555555556, 1.0131355978231351, 1.1947565543071161, 1.016561964591662, 3.0, 2.0, 1.0128381476386978, 1.1332038768800994, 1.036222509702458, 1.0393944430947846, 1.1000772797527048, 1.1419354838709677, 1.0015282730514519, 1.009594205041023, 1.5459770114942528, 1.0420833592148582, 1.0702143385070215, 1.11, 1.0416009447092067, 1.1095890410958904, 1.0471121147358093, 2.0, 1.1216032608695652, 1.0233333333333334, 1.0126715102022195, 1.1244239631336406, 1.0719211822660097, 1.009933774834437, 1.2366863905325445, 1.082141864888547, 1.0, 1.1481481481481481, 1.1666666666666667, 1.3333333333333333, 1.2019230769230769, 1.047872340425532, 1.0, 1.0470588235294118, 1.0672909698996655, 1.0731350560702098, 1.0264641448809697, 1.1875730994152047, 1.1626088340266885, 1.0478390867083447, 1.0172438322501374, 1.110310421286031, 1.0190645089780537, 1.046508725845599, 1.0495098039215687, 1.0870032223415682, 1.1444723618090453, 1.3692307692307693, 1.0162483327270522, 1.2367447595561036, 1.1036841379038458, 1.2637362637362637, 1.2136690647482014, 1.0968049594659037, 2.0, 1.019024970273484, 1.1176470588235294, 1.5, 1.4821428571428572, 1.0437028828294495, 1.0510865421273352, 1.0076530612244898, 1.1910112359550562, 1.0682012598180264, 1.0089757127771912, 1.021543985637343, 1.0, 1.3333333333333333, 1.035463347164592, 1.1277533039647578, 1.125605815831987, 1.1186839012925969, 1.0, 1.2171945701357465, 1.1600877192982457, 1.068572564348892, 1.0932568149210904, 1.0018923425702133, 1.0217295216368432, 1.0142067071974896, 1.4285714285714286, 2.0, 1.1582051822203496, 1.0, 1.011467889908257, 1.1724137931034482, 1.2841225626740946, 1.0434782608695652, 1.6363636363636365, 1.0465970610982211, 1.099337748344371, 1.1638418079096045, 1.0478232021640381, 1.2898172323759791, 1.1256410256410256, 1.0604604604604604, 1.0017953321364452, 1.0680555555555555, 1.1428571428571428, 1.0274432379072063, 1.055199538873631, 1.05, 1.0368311327310633, 1.2672660400490396, 1.1646090534979423, 1.0097208556539485, 1.4444444444444444, 1.2695035460992907, 1.023535204332841, 1.3206650831353919, 1.2261904761904763, 1.0720205262075686, 1.0393700787401574, 1.625, 1.0668144395186827, 1.0281312793034159, 1.1300345550331388, 1.215194109772423, 1.015475604226293, 1.0124922469183382, 1.2186544342507646, 1.104109589041096, 1.2142857142857142, 1.0678538244074096, 1.0376766091051806, 1.0220364741641337, 1.0408695652173914, 1.0307619729307653, 1.0600169061707523, 1.0775890231950342, 1.380952380952381, 1.6, 1.0611995104039167, 1.602475532527346, 1.0683575626353232, 1.036726128016789, 1.0, 1.031758957654723, 1.0342836521111511, 1.1393939393939394, 1.055447730997922, 2.0, 1.168890236506974, 1.5, 1.0846456692913387, 1.0, 1.0290031967451323, 1.4666666666666666, 1.1549295774647887, 1.025460930640913, 1.0, 1.315527625032731, 1.2796143250688705, 1.0, 2.0, 1.0902777777777777, 1.2173913043478262, 1.0761014686248331, 1.2027310924369747, 1.1107913669064748, 1.0712916282042177, 1.0122549019607843, 1.013317191283293, 1.0978260869565217, 1.1917808219178083, 1.096774193548387, 1.0, 1.0689655172413792, 1.1022167487684729, 1.0276100086281277, 1.0930583027220495, 1.0943748206256576, 1.0638141719569925, 1.1020284552343045, 1.2124299234432456, 1.1571428571428573, 1.0095333667837432, 1.8571428571428572, 1.0, 1.2058823529411764, 1.0199699690186712, 1.0546528803545052, 1.115068493150685, 1.0210084033613445, 1.0340555308469408, 1.0125845737483086, 1.0154548783569812, 1.1097560975609757, 1.2857142857142858, 1.184691011235955, 1.0595369349503858, 1.0654793441197647, 1.0037363869138543, 1.0055555555555555, 1.039322740936139, 1.153989734017732, 1.137092118099106, 1.0940484937545922, 1.0757847287980404, 1.012084592145015, 1.027328714395689, 1.1897018970189701, 1.0358199065673375, 1.0309278350515463, 1.074882471457354, 1.0, 1.065040650406504, 1.0098065885041212, 1.0303030303030303, 1.0657947178233607, 1.0511415525114156, 1.2325581395348837, 1.0583535987030164, 1.034938308757147, 1.1188318227593153, 1.0309033280507132, 1.0358527131782946, 1.2106246285342315, 1.2, 1.4, 1.0, 1.3333333333333333, 1.0708847466526648, 1.6666666666666667, 1.020107884217117, 1.1029771935737558, 1.0077951002227172, 1.0620576131687243, 1.065597110072248, 1.0847351467430209, 1.0606060606060606, 1.0416666666666667, 1.016878380176415, 1.0842843742671773, 1.0434257287964703, 1.2062830903570623, 1.7142857142857142, 1.084375, 1.1277372262773722, 1.136539628420353, 1.0607734806629834, 1.2868146805618486, 1.0438729198184569, 2.1363636363636362, 1.0669031700550324, 1.053631284916201, 1.056824757078154, 1.2777777777777777, 1.0751841304134342, 1.052629478892347, 1.3724444444444444, 1.055672268907563, 1.1515151515151516, 1.1428571428571428, 1.119049511245331, 1.035926138538079, 1.0623342175066313, 1.0181721515513829, 1.088235294117647, 1.0000703185429998, 1.0562851782363978, 1.0163727959697733, 1.0043196544276458, 1.016652059596845, 1.0641925777331995, 1.0660705414803775, 1.0078178828687754, 1.0764023210831721, 1.0064691656590086, 1.0780070568731157, 1.0588235294117647, 1.0813704496788008, 1.1175298804780875, 1.0453453028910724, 1.0619718309859154, 1.1018276762402088, 1.0934959349593496, 1.178294573643411, 1.063660477453581, 1.0330598019324642, 1.0588235294117647, 1.1082504388531305, 1.2429576049829214, 1.0664916885389326, 1.1150442477876106, 1.2913337665812914, 1.0881698841698841, 1.0920698924731183, 1.056, 1.1093332456277392, 1.0722440626851204, 1.1333333333333333, 1.0357142857142858, 1.0294294294294295, 1.1007903519728086, 1.1546391752577319, 2.25, 1.034848146991928, 1.1694477338787814, 1.0698979591836735, 1.0092592592592593, 1.2186836518046709, 1.0120005398775886, 1.1665886757136172, 1.0699619771863118, 1.2258064516129032, 1.1058823529411765, 1.1578947368421053, 1.1246819338422391, 1.4857142857142858, 1.0550935163257313, 1.1925311203319502, 1.0828125, 1.0625, 1.1814345991561181, 1.0587349397590362, 1.05, 1.3725490196078431, 1.049056603773585, 1.028225806451613, 1.0087597971415398, 1.0714285714285714, 1.0204155505683052, 1.2291666666666667, 1.0184528034066713, 1.3272727272727274, 1.0909090909090908, 1.2960602549246814, 1.0279007971656333, 1.0012769523404141, 1.2108433734939759, 1.3709677419354838, 1.2352941176470589, 1.0512820512820513, 1.1136363636363635, 1.0, 1.059142702116115, 1.0305212832453923, 1.031592888041736, 1.2956521739130435, 1.1260232867256537, 1.0482416422189487, 2.5, 1.0371459818229816, 1.1093057607090104, 1.5, 2.25, 1.2396976347232382, 1.143317230273752, 1.058392169616349, 1.1388888888888888, 1.0, 1.1333333333333333, 1.125, 1.375, 1.090806598362277, 1.0731636903534458, 1.0432158125065374, 1.0171030405405406, 1.7142857142857142, 1.0359984009594243, 1.0345047923322683, 1.0128314798973481, 1.0984293193717278, 1.016355140186916, 1.0, 1.380952380952381, 1.1850152089225678, 1.0133788462160676, 1.3571428571428572, 1.125, 1.0818770105948257, 1.0850234009360376, 1.1241379310344828, 1.234375, 1.0530183296044664, 1.441042249374356, 1.047096139755505, 1.412162162162162, 1.125984251968504, 1.129496402877698, 1.0, 1.089790897908979, 1.0075566750629723, 1.004759789769783, 1.1025399811853245, 1.5, 1.1081081081081081, 1.0207370444598962, 1.1749727173517643, 1.2219508223416382, 1.0154080359091748, 1.114980652294085, 1.1091049599550373, 1.4435483870967742, 1.0943396226415094, 1.091648092303658, 1.120261965254412, 1.2621538461538462, 1.075, 2.3333333333333335, 1.0344827586206897, 1.1143810497204352, 1.0819165378670788, 1.0127002167362689, 1.059798426028187, 1.0416914830256105, 2.5, 1.0947368421052632, 1.0378959438153934, 1.2005347593582887, 1.0388349514563107, 1.0779982975673132, 1.010840108401084, 1.1974637681159421, 1.009760858955588, 1.0324034010106207, 1.1619791745379255, 1.0255198487712665, 1.0087719298245614, 1.0526315789473684, 1.2225208044382803, 1.2296744127463946, 1.0280213518862833, 1.1417019638043897, 1.1088957055214723, 1.0319148936170213, 1.1206896551724137, 1.2167381974248928, 2.3333333333333335, 2.0, 1.25, 1.0212314225053079, 1.0453648915187377, 1.0318150098331536, 1.0104432056100698, 1.0333485609867519, 1.0144978783592644, 1.2568807339449541, 1.1115384615384616, 1.0435242857560605, 1.6666666666666667, 1.2941176470588236, 1.2935811995790951, 1.0, 1.0501750291715286, 1.1129827444535743, 1.030012723598533, 1.105459158063247, 3.0, 1.3113477018956115, 1.083623693379791, 1.0496429591545273, 1.0412523386655546, 1.0804953560371517, 1.1202729599090133, 1.1499478118243496, 1.0706810035842294, 1.021505376344086, 1.2941176470588236, 1.092074592074592, 1.0, 2.0, 1.042447853561243, 5.0, 1.3, 1.7428571428571429, 1.0939167556029883, 1.0864376310795965, 1.0906058921623123, 1.0193050193050193, 1.1666666666666667, 1.08900981809879, 1.032114624505929, 1.250238777459408, 1.3387423935091278]
origin-bjaq_15.71 	max: 5.0000	99th: 2.5000	95th: 1.7014	median: 1.0820	mean: 1.1738

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.127660 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.349956