Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 99, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.5000	95th: 1.7111	median: 1.0782	mean: 1.1718
ReportEsts: [1.0327868852459017, 1.0151041666666667, 1.0342143714827192, 1.1304347826086956, 1.5, 1.0, 1.054399653229302, 1.072384889084963, 1.0, 1.0223097112860893, 1.0746255735434163, 1.0426662699807967, 1.031629116117851, 1.072093023255814, 1.043094312963617, 1.0, 1.0444444444444445, 1.0255047821466525, 3.0, 2.0, 1.08, 1.0718908922792418, 1.065359973663552, 1.0692894891368174, 1.0360138135175136, 1.0, 1.1321174848902555, 1.5, 1.2, 1.0431654676258992, 1.0, 1.0461735122654612, 1.0079997293440284, 1.1154273029966704, 1.0875312086943751, 1.2288174368786655, 1.1203208556149733, 1.007775052813054, 1.1634410083339073, 1.0357142857142858, 1.1255411255411256, 1.1768292682926829, 1.0, 1.0377811181129675, 1.1253254643291095, 1.8333333333333333, 1.0198019801980198, 1.2508833922261484, 1.0252978247611304, 1.0833333333333333, 1.0902429415627053, 1.3058419243986255, 1.040306132959766, 2.0, 1.2025974025974027, 1.280686282369919, 1.0385454545454544, 1.3658536585365855, 1.018987341772152, 1.0, 1.0919665576154125, 1.0840597758405977, 1.059090909090909, 1.0, 1.1818181818181819, 1.1608872101900591, 1.3461030383091148, 1.75, 1.0, 1.0743917218234362, 1.0231990231990231, 1.059061957151129, 1.0325581395348837, 1.1150733193677396, 1.056470588235294, 1.036468330134357, 1.0, 1.1089770354906054, 2.0, 1.0145197853596948, 1.103448275862069, 1.0943195833904344, 1.2147239263803682, 1.0647130647130647, 1.126594700686948, 1.04, 1.0751081298075678, 1.0010050251256282, 1.0833333333333333, 1.75, 1.1379310344827587, 1.0727070601314033, 1.102803738317757, 1.0252454417952315, 1.0176579925650557, 1.0493506493506493, 1.0150375939849625, 1.1743486973947896, 1.0, 1.2478565861262665, 1.003177813086812, 1.0771869639794167, 1.2285516105258594, 1.3076923076923077, 1.0143039848161568, 1.0193788160339794, 1.2022205773501111, 1.149791429654911, 1.047516860821582, 1.1666666666666667, 2.0, 1.0738317757009346, 1.0603024605397908, 1.0751737207833227, 1.2207792207792207, 1.0588963921479861, 2.0, 1.1393882056133713, 1.110520722635494, 1.0, 1.0164835164835164, 1.0, 1.2080200501253133, 1.0157548274361794, 1.0471383086122543, 1.12, 1.8, 1.1382450331125828, 1.0, 1.0769230769230769, 1.0923924711944464, 1.3, 1.0050711598233273, 1.0276963077869958, 1.060112919295915, 1.023224043715847, 1.0, 1.0600155884645361, 1.039972432804962, 1.0749542961608776, 1.0540030858906224, 1.148936170212766, 1.0169602087410308, 1.0981124727701987, 2.0, 1.0209662716499543, 1.006904487917146, 1.1010928961748634, 1.1090524086818423, 1.5, 1.1457980140469848, 1.0416666666666667, 1.0183299389002036, 1.1074561403508771, 1.0554744525547446, 1.028658125421443, 1.0968941572968418, 1.2208521413629858, 1.0562248995983936, 1.0921052631578947, 1.3061224489795917, 1.3018867924528301, 1.0103092783505154, 1.4285714285714286, 1.0714467327739639, 1.0416854112497997, 1.1301236174365648, 1.332794061667301, 1.0884308510638299, 1.084148313058228, 1.2715789473684211, 1.1553398058252426, 1.0542267841580324, 1.0212335692618806, 1.0448662640207076, 1.0806608357628766, 1.0442757748260594, 1.1212858384013902, 1.081245576786978, 1.0, 1.2115384615384615, 1.0039671294984416, 1.0281100478468899, 1.1426759670259987, 1.144736842105263, 1.0974407982922108, 1.3597924274457045, 1.1043222301582147, 1.1372549019607843, 1.1163636363636364, 1.0609784288199724, 1.0, 1.5454545454545454, 1.0094830717081635, 1.0488095238095239, 1.0284495021337126, 1.3461538461538463, 1.062379421221865, 1.0428379843487465, 1.0480273233799058, 1.0626410835214446, 1.0749446611152103, 1.0350877192982457, 1.0666666666666667, 1.2352941176470589, 1.0, 1.4285714285714286, 1.0640277558744677, 1.3449477351916377, 1.2873563218390804, 1.0118635689569946, 1.0031277926720286, 1.006344718194514, 1.0032007570486237, 1.1554971857410883, 1.035294117647059, 1.1315028901734103, 1.0201652892561983, 1.0468866678154978, 1.0208150514233565, 1.0, 1.0351966873706004, 1.1141354657002738, 1.0064208339654068, 1.1518131530424094, 1.051649554385782, 1.2805459272097053, 1.0357142857142858, 1.0034487689577147, 1.0854822073233625, 1.030813953488372, 1.1851851851851851, 1.1611271676300579, 1.0607350096711798, 1.162992125984252, 2.0, 1.2766214177978883, 1.0770991514068782, 1.1446319737458979, 1.191111111111111, 1.0, 1.6666666666666667, 1.0829039236031726, 1.0727272727272728, 1.0762273009735552, 1.5, 1.0, 1.0256410256410255, 1.0015612802498048, 1.0204081632653061, 1.002770083102493, 1.149789029535865, 1.0366056572379367, 1.0037926675094817, 1.1139931476355471, 1.0350877192982457, 2.0, 1.0667756461661835, 1.1005059276598959, 1.096322241681261, 1.0249175129622488, 1.1577523596694992, 1.0253066981565309, 1.1081081081081081, 1.0722321004172315, 1.0191387559808613, 1.0506717289719627, 1.0970158418273364, 1.1818181818181819, 1.0073328331840952, 1.2025641025641025, 1.2272727272727273, 1.3157894736842106, 1.018895887365691, 1.0555555555555556, 1.0940170940170941, 1.1052957405289012, 1.041782729805014, 1.3709273182957393, 1.0037573774323614, 1.14066985645933, 1.0295957995252702, 1.054366129420255, 1.1111111111111112, 1.0195263967956683, 2.5, 1.0471935311484315, 1.008714596949891, 1.04381684948341, 1.0526315789473684, 1.6666666666666667, 1.434782608695652, 1.0441176470588236, 1.0961740844845271, 1.0, 1.0299212598425196, 1.0475113122171946, 1.0060096153846154, 1.014793689884299, 1.08, 1.1446540880503144, 1.0001582306299337, 1.2011009922522768, 1.0705081553148679, 1.1025641025641026, 1.0, 1.1336515513126493, 1.288888888888889, 1.07, 1.1160488626790228, 1.024603836530442, 1.0502958579881656, 1.5128205128205128, 1.0282087447108603, 1.0020639834881322, 1.2857142857142858, 1.0066985940651996, 1.0360531309297913, 1.1176470588235294, 1.0834747154115587, 1.2380952380952381, 1.2727272727272727, 1.0193326148058919, 2.0, 1.1646090534979423, 1.055232558139535, 1.1378178835110746, 1.061847389558233, 1.0887728459530026, 1.0963855421686748, 1.0894086770654365, 1.0682229416680866, 1.0082417582417582, 1.0655465562283208, 1.0270077164904259, 2.0, 1.0, 1.0343129413377818, 1.25, 1.068561872909699, 1.3529411764705883, 1.0, 1.4666666666666666, 1.3835341365461848, 1.0669180018850142, 1.2524271844660195, 1.0097402597402598, 1.0, 1.2270306258322237, 1.051108406277516, 2.0, 1.1852293031566408, 1.0, 1.0962726789645487, 1.072289156626506, 1.0392023091052218, 1.1497695852534562, 1.1363636363636365, 1.3747072599531616, 1.1851851851851851, 1.024206881723619, 1.0142043244924943, 1.107669616519174, 1.0, 1.0769230769230769, 1.5714285714285714, 1.5, 1.1428571428571428, 1.0687629388941444, 1.3333333333333333, 1.0782029950083194, 1.2023809523809523, 1.1016050244242848, 1.0783175076512594, 1.2687950566426365, 1.0186912577339065, 1.013921113689095, 1.0214285714285714, 1.5, 1.2213740458015268, 1.0765957446808512, 1.0585328553574953, 1.1428571428571428, 1.5714285714285714, 1.0334075723830736, 1.0087976539589443, 1.009328575839709, 1.0251256281407035, 1.1464387464387464, 1.0120383036935705, 1.1428571428571428, 1.0907770515613653, 1.1228813559322033, 1.2884615384615385, 1.0240793201133145, 1.0603448275862069, 1.0463655445852444, 1.0772720337093158, 1.0051917334854228, 1.1025641025641026, 1.15625, 1.1257861635220126, 1.0, 1.0087657073368463, 1.0339634834287652, 1.02275871610404, 1.0596651337444891, 1.0749306197964847, 1.1487130600571973, 1.5714285714285714, 1.0303907380607815, 1.0, 1.246797608881298, 1.25, 1.0360576381852977, 1.010144927536232, 1.1128546861564919, 1.150197628458498, 1.058623619371283, 3.0, 1.1319628647214854, 1.0071841581980958, 1.1036187235607873, 2.0, 1.1111111111111112, 1.2399232245681382, 1.1877133105802047, 1.108932191469116, 1.2349272349272349, 1.2352941176470589, 1.2942191544434858, 1.0056644572932825, 1.0557821520758213, 1.0955379008465262, 1.0162280701754387, 1.175787728026534, 1.1628787878787878, 1.875, 1.1036414565826331, 1.5, 1.2298657718120805, 1.0606060606060606, 1.1219900261220612, 1.9230769230769231, 1.0897490172361657, 1.0746360996064548, 1.068476249228871, 1.0, 1.1875, 1.2, 1.284757286407039, 1.301969365426696, 1.0, 1.0529531568228105, 1.0726710304985227, 1.0953170327393287, 1.5, 2.0, 1.0166990291262137, 1.0008968609865472, 1.0459016393442624, 1.1111111111111112, 1.059773489932886, 1.0291545189504374, 1.4705882352941178, 1.0175922731976543, 1.0545454545454545, 1.099737532808399, 1.0459677419354838, 1.391249474127051, 1.0461806389622867, 1.0, 1.0571428571428572, 1.0857575487663669, 1.0295448665645088, 1.025436776765745, 2.0, 1.1048440610484407, 1.0084185088995197, 1.0225248821372446, 2.0, 1.0570175438596492, 1.051144377087715, 1.0286748903347367, 1.0676248307194967, 1.0120711506979527, 1.0203743188817815, 1.02233676975945, 1.1622468659594984, 2.0, 1.0295622512791358, 1.8048780487804879, 1.0, 1.2020725388601037, 1.1346153846153846, 1.0059513886573535, 1.0661231884057971, 1.0747175870176042, 1.2847877358490567, 1.0654759765695188, 1.098065737860138, 1.052463677658726, 1.197674418604651, 4.0, 1.0065826431400793, 1.1538461538461537, 1.0439252502202174, 1.0369217636508379, 1.0920852359208524, 1.2166796570537801, 2.348314606741573, 2.4285714285714284, 1.0051614159809126, 1.030216260180718, 1.02512505684402, 1.111962071480671, 1.0690802159660624, 1.0104166666666667, 1.0658104443938485, 1.0075512405609492, 1.213292117465224, 3.0, 1.0909090909090908, 1.053680981595092, 1.0761904761904761, 1.1078066914498141, 1.1273458445040214, 1.0549019607843138, 1.251572327044025, 1.148905109489051, 1.0833333333333333, 1.073106644212739, 1.2282608695652173, 1.0327592513079846, 2.0, 1.1012658227848102, 1.0357142857142858, 1.175, 1.0645251396648046, 1.036281179138322, 1.030549898167006, 1.0894941634241244, 1.029784320438206, 1.0, 1.2553191489361701, 1.2, 1.0, 1.1136363636363635, 1.0866935483870968, 1.0269413629160062, 1.0970873786407767, 1.0610381288048703, 1.177494199535963, 1.017779452570998, 1.1721467783877493, 1.036237471087124, 1.1048070949636897, 1.0702702702702702, 1.073697585768742, 1.0493468795355587, 1.0659978880675818, 1.1719653179190752, 1.1813256851497769, 1.0636497238129023, 1.1521454596908274, 1.0751944480507984, 2.0, 1.199017199017199, 1.0545808966861598, 1.4074074074074074, 1.0, 1.0851063829787233, 1.3636363636363635, 1.0992217898832686, 1.3703703703703705, 1.1666666666666667, 1.0005075038062785, 1.1295794439425875, 1.0283181147986238, 1.0581423209008864, 1.2054054054054053, 1.0987983978638185, 1.0, 1.1407407407407408, 1.0382785019656529, 1.078160278375435, 1.0845879194864088, 1.0613395603143867, 1.0422645447430212, 1.1766233766233767, 1.135268253498499, 1.1012433392539964, 1.006233603157163, 1.0693348895875299, 1.2727272727272727, 1.0923913043478262, 1.0, 1.2387640449438202, 1.2072469718743584, 3.0, 1.109979633401222, 1.0705642829049349, 1.4285714285714286, 1.0328170028818444, 1.3, 1.0555555555555556, 1.052969119368815, 1.6153846153846154, 1.0268119357528733, 1.0457069628363946, 1.3571428571428572, 1.2083333333333333, 1.131958762886598, 1.021999043519847, 1.0483443708609272, 1.0750348133035397, 1.1548729200950814, 1.0, 1.0515424723006734, 1.1219512195121952, 2.0, 1.027285098138709, 1.0959252530495718, 1.109744560075686, 1.0221688051195517, 1.0213899729810867, 1.0970873786407767, 1.7142857142857142, 1.0342250196695515, 1.038709677419355, 1.1188807629002426, 1.196806387225549, 1.0110599450172613, 1.0288385182295658, 1.1666666666666667, 1.0773547094188376, 1.1806020066889633, 1.0508076255283327, 1.085173501577287, 1.0855457227138643, 1.0498949579831933, 1.0647756652572826, 3.0, 1.1269536443407098, 1.0144399963698334, 1.036214094810928, 1.3571428571428572, 1.3540480488820996, 1.3482587064676617, 1.1428571428571428, 1.0179163433730691, 1.0420575865415722, 1.1211790393013101, 1.1764705882352942, 1.3333333333333333, 1.079746499240088, 1.5, 1.105140186915888, 1.0833333333333333, 1.0428790733375202, 1.44, 1.0759493670886076, 1.0408805031446542, 1.0, 1.6137566137566137, 1.2859545836837678, 1.25, 2.0, 1.1367521367521367, 1.2137931034482758, 1.0089179548156957, 1.215561224489796, 1.1327433628318584, 1.2094395280235988, 1.1014466214978942, 1.051948051948052, 1.1666666666666667, 1.1510204081632653, 1.1923076923076923, 1.0, 1.3767313019390581, 1.1183261183261184, 1.0602409638554218, 1.0423746373808538, 1.0654707125979357, 1.021762095922248, 1.082708327157383, 1.1385916714864084, 1.1770538243626063, 1.0029922202274086, 1.375, 1.0, 1.2142857142857142, 1.007724074640563, 1.1050308914386584, 1.107843137254902, 1.041025641025641, 1.0241313478426881, 1.0662577562228086, 1.0051725353083756, 1.0833333333333333, 1.2222222222222223, 1.0456656346749227, 1.034398197242842, 1.0760119273158597, 1.0164165670298373, 1.006578947368421, 1.0530862374483165, 1.0144030269483326, 1.0209150326797385, 1.3421588594704685, 1.125, 1.054259876249405, 1.7109826589595376, 1.1818181818181819, 1.066860465116279, 1.0701001430615165, 1.0, 1.0709046454767726, 1.0031635814987265, 1.08, 1.0798764518106336, 1.007415254237288, 1.2647058823529411, 1.0679683254405714, 1.0311103100216295, 1.0717499328498523, 1.0076335877862594, 1.079455164585698, 1.1989189189189189, 1.2147505422993492, 1.2142857142857142, 1.0, 1.4285714285714286, 1.0715271890517137, 1.3333333333333333, 1.1042204568023832, 1.0979753378924129, 1.0226551880380608, 1.058987090367428, 1.048595435787799, 1.0691318327974277, 1.028673835125448, 1.00557880055788, 1.0062995623859887, 1.1347019122609674, 1.0439257995266142, 1.1927014332169095, 1.6666666666666667, 1.032258064516129, 1.0411522633744856, 1.034732573052792, 1.019543973941368, 1.224948347107438, 1.0386029411764706, 2.211206896551724, 1.0311386627096812, 1.0483221476510067, 1.0760526315789474, 1.1875, 1.0446485303461746, 1.0428605338684966, 1.3595927116827438, 1.0581052631578947, 1.0666666666666667, 1.0354767184035476, 1.1292134831460674, 1.5625, 1.0693101457641796, 1.8461538461538463, 1.1441753171856979, 1.1151960784313726, 1.0234644582470669, 1.0432109608290883, 1.009501187648456, 1.7272727272727273, 1.0821256038647342, 1.1035699841905953, 1.0528918273237402, 1.0031316344890704, 1.0520758215720614, 1.074651526603505, 1.0833333333333333, 1.0856898029134534, 1.1072896387627083, 1.0249118264208223, 1.0360721442885772, 1.0277777777777777, 1.1236068895643363, 1.014421043728326, 1.3867069486404835, 1.0437229121899698, 1.0, 1.3333333333333333, 1.052728126776929, 1.0129449838187703, 1.22811320754717, 1.110703363914373, 1.0750199521149242, 1.125, 1.104513508984633, 1.0922869098217522, 1.0753676470588236, 1.0818713450292399, 1.0777358490566038, 1.1020590978255533, 1.119047619047619, 1.75, 1.075586050442596, 1.1677418311749204, 1.0421865715983363, 1.0056818181818181, 1.2483707458363504, 1.019104443767317, 1.176272139443351, 1.4814814814814814, 1.2692307692307692, 1.0370619946091644, 1.0555555555555556, 1.14375, 1.5925925925925926, 1.0523969158565203, 1.2011892963330029, 1.164179104477612, 1.025, 1.040164509980941, 1.0434114483288512, 1.0654953145917, 1.2913448207565854, 1.3333333333333333, 1.0769230769230769, 1.3333333333333333, 1.1407175200278648, 1.5, 1.0, 1.1538461538461537, 1.0596026490066226, 1.0960144927536233, 1.0141243431045621, 1.011876369730566, 1.1763636363636363, 1.2830188679245282, 1.0666666666666667, 1.032258064516129, 1.1081081081081081, 1.2857142857142858, 1.1088082901554404, 1.0281771948427358, 1.032547957404178, 1.3195876288659794, 1.0778400114893005, 1.047329963465292, 2.5, 1.0687285223367697, 1.1532125205930808, 1.5, 2.0, 1.198224852071006, 1.0906548088646633, 1.0851674270131952, 1.1335403726708075, 1.0, 1.316326530612245, 1.0828220858895705, 3.0, 1.5, 1.0032090841767465, 1.2857911009544294, 1.0217418468074473, 1.6666666666666667, 1.0308888737294495, 1.0449264136328427, 1.0372340425531914, 1.0, 1.0, 1.0253633553110018, 1.0921052631578947, 1.1903069466882068, 1.0069524460501904, 1.3364779874213837, 1.09375, 1.0890435617424696, 1.1089015151515151, 1.0578512396694215, 1.15, 1.0256986539581505, 1.3576884755895051, 1.1279388053545314, 1.3253968253968254, 1.107843137254902, 1.2238805970149254, 1.1016483516483517, 1.0676739062008185, 1.0259385176234461, 1.110028741138149, 1.0491266375545851, 1.5, 1.6666666666666667, 1.0096848430607939, 1.1420404573438874, 1.1083446800233419, 1.0126962113867037, 1.0680715838769026, 1.1050884490944997, 1.5, 1.0434782608695652, 1.0588790189450514, 1.0983234369542438, 1.2069701280227596, 1.038181818181818, 2.5, 1.0273972602739727, 1.0598779112718224, 1.1667131307499303, 1.011151771349254, 1.0967962062382848, 1.0099431818181819, 2.0, 1.0876747141041931, 1.0700723380653994, 1.162668494402559, 1.0608365019011408, 1.0796977065751203, 1.0636942675159236, 1.3344370860927153, 1.0093622001170275, 1.0331979721221227, 1.0681033757050258, 1.021889400921659, 1.0399467376830893, 1.0, 1.1723930682159671, 1.0527699058414846, 1.0426997245179064, 1.040477740097512, 1.108574953732264, 1.006051437216339, 1.2, 1.2297650130548303, 1.6666666666666667, 2.0, 1.2352941176470589, 1.010230179028133, 1.051342812006319, 1.0178989193805934, 1.01050853256918, 1.0930800542740842, 1.0426778242677823, 1.1032608695652173, 1.065217391304348, 1.051551309300841, 1.6, 1.5833333333333333, 1.2690879075526207, 1.1428571428571428, 1.1158989598811293, 1.1403508771929824, 1.0085446777565676, 1.0855529045138044, 2.0, 1.0523219814241487, 1.2306201550387597, 1.0088050314465409, 1.0392029138416654, 1.1717171717171717, 1.1315068493150684, 1.1327201341097584, 1.0757032063896284, 1.0063593004769475, 1.392156862745098, 1.1047486033519553, 1.0, 1.0, 1.0417679982833232, 5.0, 1.5714285714285714, 2.25, 1.025990099009901, 1.1058823529411765, 1.0892461197339247, 1.114162416633974, 1.1666666666666667, 1.0887647423960274, 1.0128504672897196, 1.2185792349726776, 1.28125, 1.4285714285714286, 1.0243405411524964, 1.1363636363636365, 1.1195652173913044, 1.043882484194868, 1.0364078564321775, 1.1729030901828883, 1.0742383910085773, 1.0, 1.1557727291957525, 1.0369049498804863, 1.0346126255380201, 1.1774193548387097, 1.0819424946706182]
origin-bjaq_15.71 	max: 5.0000	99th: 2.5000	95th: 1.7111	median: 1.0782	mean: 1.1718

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 13.953462 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[7.1525574e-07 3.2782555e-06 1.1920929e-07 4.7683716e-07 4.1723251e-07]
Distance score: 1.0013579867518274e-06
SAUCE Drift detection: False
Detection latency: 0.0234s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.030877 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 3.0000	95th: 1.6667	median: 1.0837	mean: 1.1895
ReportEsts: [1.0958549222797926, 1.0015092712376024, 1.0419080888995964, 1.0, 1.608695652173913, 1.0, 1.0196903916151383, 1.063093208579471, 1.2, 1.0260586319218241, 1.1305236823747324, 1.04387498449149, 1.0387310955367024, 1.1199226305609284, 1.0363046044864226, 1.375, 1.1492063492063491, 1.2857142857142858, 1.4545454545454546, 1.0424646128226478, 1.1238425925925926, 1.0405825206160335, 1.126885536823425, 1.0064882400648825, 1.0203232686443515, 1.0230193179928553, 3.0, 1.1621507325177465, 1.5, 1.1666666666666667, 1.0335899230230932, 2.0, 1.0477524047774542, 1.009212287837831, 1.0230308613542147, 1.1027020418144027, 1.2373088045712692, 1.1771300448430493, 1.1185185185185185, 1.052366082152294, 1.0899859239895435, 1.0215682058553481, 1.171206225680934, 1.0783373301358914, 1.0110294117647058, 1.1866736778846154, 1.3043478260869565, 1.0588235294117647, 1.0826086956521739, 1.0123626373626373, 1.0, 1.2352941176470589, 1.032, 1.0, 1.0023782207562504, 1.0525316182500972, 1.0324563911924507, 1.1921052631578948, 1.063157894736842, 1.0699152738982358, 1.2112676056338028, 1.0921977918440415, 1.0385756676557865, 1.1691176470588236, 1.019047619047619, 1.1764705882352942, 1.116159175124859, 1.3563918096292198, 1.8, 2.0, 1.0168591945051515, 1.0395421436004162, 1.058083252662149, 1.0273972602739727, 1.0685364182966741, 1.1490340386384545, 1.0523124143274332, 1.2413793103448276, 1.4854368932038835, 1.083235339696083, 1.069672131147541, 1.1282051282051282, 1.0, 1.5, 1.0808080808080809, 1.0153846153846153, 1.030674846625767, 4.0, 1.25, 1.0784835277528522, 1.121322414316045, 1.1556289707750953, 1.1028135749858807, 1.1408516177017478, 1.0602094240837696, 1.0070671378091873, 1.232, 1.1881638846737481, 2.0, 1.2953637090327739, 1.064516129032258, 2.0, 1.0720862167535603, 1.16796875, 1.067463106113844, 1.2226745442755242, 1.2121212121212122, 1.0199465124380847, 1.080203269995581, 1.1928097929968686, 1.1259118300031716, 1.0485436893203883, 1.5, 4.0, 1.0866019417475727, 1.0832526487593017, 1.0625994694960212, 1.264367816091954, 1.0603760719624453, 1.0, 1.1532536520584329, 1.157313707451702, 1.5, 1.0639269406392695, 1.0, 1.2004089979550103, 1.0032275274192455, 1.0666881859264041, 1.1512605042016806, 2.0, 1.2264150943396226, 1.0, 1.25, 1.1086135421464762, 1.5, 1.022841225626741, 1.0440206448029254, 1.0583603840044202, 5.0, 1.2857142857142858, 1.0456521739130435, 1.0405222872579918, 1.0676767676767678, 1.0397954866008463, 1.0681818181818181, 1.0395387149917628, 1.091793381037567, 3.0, 1.025533536585366, 1.0202312138728324, 1.1042141230068336, 1.097067448680352, 1.5, 1.2122254832506831, 1.0344370860927152, 1.0135135135135136, 1.0073529411764706, 1.0, 1.043274244004171, 1.1094304064274556, 1.2353515171228102, 1.0418060200668897, 1.03601108033241, 1.3333333333333333, 1.2903225806451613, 1.0184956843403206, 1.3333333333333333, 1.084713744240703, 1.6470588235294117, 1.035264483627204, 1.1216918882210443, 1.0850563218728861, 1.0245747481924186, 1.2531418312387792, 1.0938697318007662, 1.1150676162278947, 1.1055900621118013, 1.0036153289949385, 1.0611111111111111, 1.0533122195830034, 1.0370346860122421, 1.2163098562415968, 1.197452229299363, 1.1666666666666667, 1.0245546238686476, 1.063574256994909, 1.3093525179856116, 1.6798029556650247, 1.0460048426150121, 5.0, 1.2247191011235956, 1.0955249016991244, 1.3043478260869565, 1.1150617283950617, 1.0290432567883991, 1.0846731396674398, 1.083110683913851, 1.0836653386454183, 1.0141668974662403, 1.0184120155634269, 1.0040933278755628, 1.1334793100366432, 1.0042816365366318, 1.0779208761320795, 1.0799247766807711, 1.2229949819526367, 1.1031390134529149, 1.0289855072463767, 1.2261904761904763, 1.0, 1.437956204379562, 1.1611924548212638, 1.1740331491712708, 1.4081632653061225, 1.0028536485935589, 1.0740740740740742, 1.0452098178939033, 1.0248306997742664, 1.2450808571656178, 1.5, 1.269183922046285, 1.0138511678435633, 1.0460795909346141, 1.0129643575493552, 3.0, 1.0897015158618535, 1.1421884238880493, 1.0041200362329428, 1.018181818181818, 1.0671140939597314, 1.0608028335301063, 1.097898837867537, 1.371900826446281, 1.0051745685519164, 1.0907907550790177, 1.0609756097560976, 1.1138287864534338, 1.03, 1.1, 1.1676489849377865, 1.0, 1.1975892224060505, 1.131461302039676, 1.1602774031978424, 1.026143790849673, 1.2142857142857142, 1.6666666666666667, 1.1087868563884407, 1.15625, 1.1058161906171378, 1.2, 1.0682492581602374, 1.1077235772357723, 1.7142857142857142, 1.0054617637076853, 1.0206422018348624, 1.0985915492957747, 1.1541609822646657, 1.0059711977520196, 1.1094460754266542, 1.2, 1.0, 1.0369176577208177, 1.0005748117491522, 1.1417910447761195, 1.0176623468467672, 1.113488547459704, 1.0303158548111784, 1.1153588195841717, 1.1031923009213074, 1.0213505461767627, 1.1041719989761967, 1.0709599825060137, 1.0769230769230769, 1.0178099658285307, 1.1551020408163266, 1.0677966101694916, 1.4545454545454546, 1.0212940212940214, 1.2274143302180685, 1.0371109942323293, 1.0484669687071964, 1.0138888888888888, 1.361344537815126, 1.0136733821223725, 1.049264705882353, 1.0491180981595092, 1.0688718379997544, 1.2, 1.050332383665717, 1.0049937578027466, 1.0118222028067494, 1.0995680612118968, 1.1457171176041743, 1.2103281334050564, 1.1619989017023613, 1.0318336162988115, 1.1424057084607544, 1.0937798525621385, 1.0520042587906693, 1.0175438596491229, 1.112, 1.0666666666666667, 1.0870151265538415, 1.25, 1.0558659217877095, 1.046925360889184, 1.1239573419918267, 1.4722222222222223, 1.0695652173913044, 1.2474226804123711, 1.1288695652173912, 1.0487799657534247, 1.0909090909090908, 1.2570558613420775, 1.0159641572050075, 1.075, 1.2727272727272727, 1.5555555555555556, 1.010649858726364, 1.25, 1.0013910557666599, 1.0251572327044025, 1.05, 1.097947633983363, 1.2083333333333333, 1.4285714285714286, 1.029396750514883, 2.0, 1.0456140350877192, 1.0130331753554502, 1.1033623910336239, 1.0615751789976133, 1.0887290167865706, 1.105263157894737, 1.0827516997981665, 1.0611962465402012, 1.5, 1.0286915743509821, 1.0731054237499222, 3.0, 1.2, 1.046124425585356, 1.2, 1.0693023255813954, 1.6470588235294117, 1.5, 1.5, 1.3878424657534247, 1.0408320493066257, 1.246031746031746, 1.1494252873563218, 1.2560975609756098, 1.3333333333333333, 1.0402084250280408, 1.12, 1.056338028169014, 1.0154106912586456, 1.0549019607843138, 1.002262443438914, 1.0196078431372548, 1.4, 1.0, 1.3905982905982905, 1.1748251748251748, 1.2251497005988023, 1.129160756501182, 1.240093526950529, 1.0097560975609756, 1.5, 1.0282791694449864, 1.0952380952380953, 1.4814814814814814, 3.0, 1.0070754716981132, 1.0, 1.387029288702929, 1.2772277227722773, 1.2989280916742056, 1.0846317896935933, 1.0, 1.052439754120655, 1.106334538636668, 1.0017889087656529, 1.099702380952381, 1.1188060495516037, 1.1362068965517242, 1.2058823529411764, 1.0069768649424338, 1.0651114272166904, 1.0409597257926306, 1.0714285714285714, 1.0, 1.1949685534591195, 3.0, 1.1041666666666667, 1.5666666666666667, 1.1528046421663443, 1.5, 1.1793478260869565, 1.0851528384279476, 1.1526717557251909, 1.1454889807162534, 1.1187091817134076, 1.2883949191685913, 1.1931818181818181, 1.2857142857142858, 1.0997442455242967, 1.0, 1.0668646258358079, 1.6666666666666667, 1.1067222767419038, 1.07916219387373, 1.0979075850043591, 1.1422605063951972, 1.5, 1.0705376344086022, 1.2857142857142858, 1.0162889518413598, 1.1818181818181819, 1.2684648105181748, 1.029797377830751, 1.0798421099847493, 1.1428571428571428, 1.1576893052302888, 5.0, 1.1332963065815052, 1.0183328057890904, 1.1185567010309279, 2.0, 1.0666666666666667, 1.283496732026144, 1.353896103896104, 1.1052016364699007, 1.192153758191494, 1.0833333333333333, 1.1483594864479316, 1.0143500948766604, 1.0303069176742248, 1.0079386720860237, 1.0579587399504475, 1.2053264604810996, 1.1666666666666667, 1.050656660412758, 1.0699058901350011, 1.078125, 1.192083062946139, 1.0, 1.5, 1.225471085120208, 1.08203125, 1.0572560316888728, 1.0866127094892182, 1.0603580562659847, 1.0, 1.2695652173913043, 1.125, 1.040573270750163, 1.125, 2.0, 1.0449663468423314, 1.3333333333333333, 1.0, 1.0030406689471685, 1.75, 1.0009711880867596, 1.0180045011252814, 1.0823863636363635, 1.2, 1.0785617397878633, 1.0732323232323233, 1.55, 1.0514648161522278, 1.0298507462686568, 1.0875831485587584, 1.0549597855227881, 1.2862608695652173, 1.014968895800933, 1.0, 1.0952380952380953, 1.0814360473018894, 1.117627345844504, 1.028548770816812, 1.5, 1.125069793411502, 1.0075608988825517, 1.0218340611353711, 2.0, 1.0600945307224847, 1.0140825706092627, 1.0118587706000293, 1.0143586005830905, 1.019333692595026, 1.0066468952629999, 1.028328611898017, 1.0183277346103186, 2.6666666666666665, 1.0394839043755932, 1.1578947368421053, 1.0457500601974477, 1.0055493895671477, 1.0157894736842106, 1.006688324760338, 1.085144927536232, 1.0674268320863114, 1.2777990064959879, 1.0577603377032612, 1.0649017933390266, 1.1051255881108262, 1.0187575941676792, 1.0568181818181819, 1.2717391304347827, 1.094265260271886, 1.0813186813186813, 1.0205705824806324, 1.0699387609874416, 1.3333333333333333, 1.0216970166602093, 1.4797687861271676, 1.8, 1.3265306122448979, 1.0073984635830282, 1.1584905660377358, 1.1277186487737159, 1.0, 1.0348258706467661, 1.0040909090909091, 1.1256308732815608, 1.0368577810871185, 1.012220616321685, 1.13582208101668, 1.0266666666666666, 1.0214176440591536, 1.0319807479832301, 1.5647058823529412, 1.0215023693000855, 1.0199115044247788, 1.1614583333333333, 1.0811561556811207, 1.1283863368669023, 1.0092500064058216, 3.0, 1.1691648822269807, 1.0433333333333332, 1.0842240647320314, 1.1563981042654028, 1.0461538461538462, 1.0337837837837838, 1.6, 1.1505018627596186, 1.0, 1.2241379310344827, 1.2857142857142858, 1.6666666666666667, 1.0909090909090908, 1.013157894736842, 1.023841059602649, 1.1012145748987854, 1.0676812174609531, 1.0895140664961638, 1.0357454486297824, 1.1759014104847638, 1.0837421163279608, 1.0477506369193452, 1.0164856828905695, 1.0970873786407767, 1.1277003217404626, 1.0457970038294104, 1.054787759131293, 1.0657894736842106, 1.118665018541409, 1.3587786259541985, 1.0430684219080124, 1.147024504084014, 1.1032786240012595, 1.4352941176470588, 1.175321581705574, 1.085787451984635, 1.5, 1.0142011834319526, 1.25, 1.2857142857142858, 1.6056338028169015, 1.034769890342901, 1.024907063197026, 1.0307692307692307, 1.072538860103627, 1.0733744673063348, 1.040267846321658, 1.1735849056603773, 1.6, 2.0, 1.139950039602754, 1.081447963800905, 1.1020656136087486, 1.1612060778727444, 1.0, 1.3411042944785276, 1.1584582441113491, 1.1552683861037032, 1.1422287390029326, 1.0289003847159452, 1.0486552040606094, 1.0163035523867272, 1.3191489361702127, 2.6666666666666665, 1.1521545163491314, 1.0, 1.0855421686746989, 1.1391304347826088, 1.397872340425532, 1.0308008213552362, 1.7391304347826086, 1.0210905737087788, 1.1458333333333333, 1.1896722939424031, 1.1059949851834967, 1.2787958115183247, 1.1942544459644322, 1.031947951058458, 1.0669724770642202, 1.0666666666666667, 1.2, 1.0148599363699853, 1.0668618670341026, 1.0454545454545454, 1.0027322404371584, 1.2281597117982588, 1.0619354838709678, 1.0049167961756231, 1.2222222222222223, 1.0265957446808511, 1.0626822157434401, 1.0955882352941178, 1.1042944785276074, 1.0700353262084694, 1.0077519379844961, 1.8888888888888888, 1.0121561100447856, 1.0060362173038229, 1.157698892174479, 1.2198364008179958, 1.0069311594551205, 1.0183069122498285, 1.1109375, 1.0955113061086736, 1.2203856749311295, 1.0442845321112462, 1.0614263404476836, 1.0358231707317074, 1.0052562417871223, 1.0700096123037488, 1.0221130221130221, 1.078310316815597, 1.0434782608695652, 1.1428571428571428, 1.1235955056179776, 1.5950413223140496, 1.066358024691358, 1.09915611814346, 1.2142857142857142, 1.011049723756906, 1.0170273146505853, 1.271186440677966, 1.0447325703248609, 2.0, 1.0906650098741872, 2.0, 1.1706349206349207, 1.0666666666666667, 1.0213248111563045, 1.3666666666666667, 1.0359477124183007, 1.0174825174825175, 2.0, 1.3202614379084967, 1.2379333786539768, 1.4, 1.3333333333333333, 1.147887323943662, 1.1977077363896849, 1.0147943831494484, 1.1922675026123302, 1.064788732394366, 1.3689839572192513, 1.081841432225064, 1.0044052863436124, 1.25, 1.5448275862068965, 1.0666666666666667, 1.5, 1.1694581280788177, 1.1302774427020508, 1.0145797598627788, 1.0679352505596693, 1.079239319335717, 1.0525378126817917, 1.098876085669167, 1.1907726548166861, 1.1613285883748516, 1.0009925558312656, 1.6666666666666667, 1.0, 1.2647058823529411, 1.0396148382004735, 1.102189781021898, 1.1181318681318682, 1.0415754923413567, 1.0051644988523336, 1.0699100815816114, 1.0100567745974083, 1.0348837209302326, 1.0476190476190477, 1.375, 1.0011599005799503, 1.0574524940617578, 1.0386099501917903, 1.016304347826087, 1.1293965198074787, 1.0865465163591106, 1.0715239632567268, 1.0443131462333826, 1.0855477964724813, 1.0496688741721854, 1.0639324487334139, 1.0238095238095237, 1.0225317960014164, 1.0769230769230769, 1.1116255144032923, 2.0, 1.031372549019608, 1.0151779220244548, 1.078125, 1.071271172941114, 1.0151785714285715, 1.170731707317073, 1.0752377329783187, 1.0329402563022683, 1.0073045814558788, 1.0575539568345325, 1.0064338235294117, 1.1998197030734992, 1.1525129982668978, 1.5, 1.0, 1.5714285714285714, 1.0634436202680033, 1.1111111111111112, 1.1446689341252516, 1.111248177638219, 1.02964609968501, 1.0646700674675005, 1.0674290617312088, 1.0610837438423646, 1.0869565217391304, 1.017162471395881, 1.0203992086345028, 1.1386721423682409, 1.0451569806279226, 1.2038519259629814, 1.7142857142857142, 1.1808510638297873, 1.0488599348534202, 1.0836777305781553, 1.0134408602150538, 1.2897302199047835, 1.0200927357032457, 2.1899641577060933, 1.0183757930214117, 1.0870056497175142, 1.0568384189109867, 1.15, 1.066119426377243, 1.02329712396881, 1.3005534269902086, 1.0549335199440169, 1.1388888888888888, 1.0514018691588785, 1.140944433908591, 1.0555799970670185, 1.0909090909090908, 1.0195694716242663, 1.175, 1.0164003958716246, 1.0467581047381547, 1.005044136191677, 1.0080142475512022, 1.0357470210815765, 1.0986908358509566, 1.073536768384192, 1.0316229210386194, 1.1093439363817097, 1.0474113042920383, 1.058417633444131, 1.0769230769230769, 1.0928725701943844, 1.1231527093596059, 1.0789216285609489, 1.003826530612245, 1.0104766893661603, 1.0687250996015936, 1.2278761061946903, 1.0625814863102998, 1.0647942575312974, 1.0909090909090908, 1.1200473092844472, 1.2321908198035678, 1.0553247321233326, 1.0913793103448275, 1.0836522300874296, 1.1141385637846757, 1.0365691489361701, 1.0814663951120163, 1.1030766699572228, 1.0805179261193625, 1.1575663026521061, 1.106280193236715, 1.004756242568371, 1.0700890165258006, 1.11, 2.0, 1.0467424262873286, 1.1725803178897531, 1.0009505703422052, 1.07035175879397, 1.2056159420289856, 1.0090067462982975, 1.1753398968588842, 1.079432624113475, 1.3214285714285714, 1.0439621591541457, 1.25, 1.1406649616368287, 1.6363636363636365, 1.0515125823372122, 1.1855500821018063, 1.1211340206185567, 1.0, 1.023438887244747, 1.0535894843276037, 1.0192307692307692, 1.1290322580645162, 1.0294659300184161, 1.0483870967741935, 1.0984271943176054, 1.0, 1.0213400120050504, 1.3205741626794258, 1.0037326490143474, 1.2586206896551724, 1.5789473684210527, 1.237594862813777, 1.0415149525458127, 1.0164915923893256, 1.2981366459627328, 1.3666666666666667, 1.0625, 1.075, 1.0561797752808988, 1.1927710843373494, 1.0858181818181818, 1.0305006174384883, 1.0314191006858338, 1.293103448275862, 1.0902595923943983, 1.0476559957950593, 3.0, 1.008664640066883, 1.045565981908868, 1.5, 2.5, 1.222852912142152, 1.047327427314347, 1.093066168808614, 1.183206106870229, 1.0, 1.1603053435114503, 1.0925449871465296, 1.15, 1.0961284327895933, 1.0944635252095067, 1.0659873278958654, 1.0399874385009944, 1.5714285714285714, 1.0389459362692446, 1.0433096315449257, 1.024701873935264, 1.0931422722620265, 1.0211515863689777, 1.0, 1.2369477911646587, 1.1638397311348, 1.0192741571585122, 1.0, 1.0668789808917198, 1.063423375103613, 1.1014832162373145, 1.0135135135135136, 1.2463768115942029, 1.0020209468409051, 1.7145829720825385, 1.0732715877989767, 1.285, 1.2295081967213115, 1.0136363636363637, 1.0, 1.0964669738863286, 1.0534351145038168, 1.0106127160216742, 1.0504050405040504, 1.5, 1.0617559523809523, 1.0025311370028123, 1.139628144367481, 1.1893529893529893, 1.0035159031568954, 1.0390766235572244, 1.1006383646701783, 1.0538922155688624, 1.0545454545454545, 1.0693413881410467, 1.1028801300980016, 1.2866282789507357, 1.0089153046062407, 1.6666666666666667, 1.1162790697674418, 1.0188720891733805, 1.0635658914728683, 1.0455533516289433, 1.0928425915298978, 1.004697592483852, 1.8, 1.0780748663101605, 1.0495587824898718, 1.1549269033605467, 1.2211538461538463, 1.082740990767398, 1.0213903743315509, 1.2837465564738293, 1.032194155522536, 1.0324129651860745, 1.1280867963879213, 1.0076045627376427, 1.0658342792281499, 1.0526315789473684, 1.1321074280183885, 1.1103101262760655, 1.038032786885246, 1.0208572083428833, 1.142030510257759, 1.0212102308172177, 1.0962199312714778, 1.1932773109243697, 2.3333333333333335, 2.5, 1.1428571428571428, 1.0129589632829374, 1.0264200792602378, 1.0307913669064748, 1.0080380712938852, 1.0333635950975941, 1.0134919225989703, 1.1541850220264318, 1.0164068908941755, 1.0714815312133295, 1.5, 1.5, 1.2442442442442443, 1.1111111111111112, 1.125615763546798, 1.136006614303431, 1.0311368015414257, 1.093426448495676, 2.5, 1.0356863766605886, 1.016260162601626, 1.124233507356431, 1.0410561672239267, 1.0929250263991552, 1.0954532617904547, 1.1285907710323124, 1.1388463501786625, 1.0454545454545454, 1.1627906976744187, 1.1241299303944317, 1.0, 2.0, 1.0420402062124674, 5.0, 1.625, 2.064516129032258, 1.0300207039337475, 1.0822600034346557, 1.1549295774647887, 1.0114503816793894, 1.1428571428571428, 1.007231946336862, 1.031219028741328, 1.0, 1.3021868787276343]
origin-bjaq_15.71 	max: 5.0000	99th: 3.0000	95th: 1.6667	median: 1.0837	mean: 1.1895

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.159642 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.171139