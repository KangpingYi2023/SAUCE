Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 96, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.5050	95th: 1.6667	median: 1.0826	mean: 1.1757
ReportEsts: [1.0031847133757963, 1.0263020833333334, 1.0305325289700968, 1.0358565737051793, 1.5, 1.0, 1.0110666597391802, 1.0486106552380594, 1.0, 1.0304232804232805, 1.096413008974692, 1.0424876958301033, 1.0155396892062158, 1.0953488372093023, 1.0939597315436242, 1.0, 1.2333333333333334, 1.0439249025859014, 3.0, 2.0, 1.0384615384615385, 1.0487628353010359, 1.1702689921833709, 1.0798590722254844, 1.1134681795757277, 1.0, 1.1618063112078345, 1.5, 1.4, 1.079136690647482, 1.0, 1.038990533506117, 1.008021258796319, 1.0155382907880133, 1.0819503598178881, 1.232560080106809, 1.1550802139037433, 1.003000501707266, 1.1799710723879056, 1.0357142857142858, 1.0729023383768914, 1.0731707317073171, 1.0, 1.0252741603838245, 1.0882994796038274, 1.8615384615384616, 1.0510204081632653, 1.1660777385159011, 1.0207277902012604, 1.1018518518518519, 1.1165023736198711, 1.2405498281786942, 1.0399353124163078, 2.0, 1.3818181818181818, 1.1619989815959846, 1.3832997987927564, 1.3725490196078431, 1.0124223602484472, 1.25, 1.1136859323882224, 1.1033623910336239, 1.0909090909090908, 1.0114942528735633, 1.1818181818181819, 1.0261673185421065, 1.294379167989838, 1.75, 1.0, 1.0028982797307404, 1.0084235860409145, 1.0609048723897911, 1.023041474654378, 1.07307798039036, 1.0941176470588236, 1.0093457943925233, 1.0, 1.1110647181628392, 2.0, 1.0334155929868862, 1.1428571428571428, 1.0461711465816539, 1.1840490797546013, 1.1266149870801034, 1.0947006869479883, 1.0, 1.071452078130747, 1.0152458919143383, 1.0784313725490196, 1.75, 1.1798107255520505, 1.0687249648552153, 1.087227414330218, 1.0070621468926553, 1.067251461988304, 1.0051948051948052, 1.0975609756097562, 1.156959526159921, 1.0, 1.2367027146325313, 1.0122390208783298, 1.1149228130360205, 1.237294795668879, 1.2592592592592593, 1.025679297872942, 1.0284045659676135, 1.2992214163822526, 1.124762988244217, 1.0502759043531575, 1.3333333333333333, 2.0, 1.0677570093457944, 1.0751581017895309, 1.0688566013897662, 1.2077922077922079, 1.0571747823303055, 1.0, 1.1050141911069062, 1.130952380952381, 1.0, 1.021978021978022, 1.1666666666666667, 1.3157894736842106, 1.0227585450660932, 1.1344257202764618, 1.0769230769230769, 1.8, 1.1175496688741722, 1.0, 1.0769230769230769, 1.1009497909233112, 1.1818181818181819, 1.0870768229166667, 1.0352138770434662, 1.0428816466552315, 1.0120160213618157, 1.1550632911392404, 1.044427123928293, 1.039972432804962, 1.0737355271176112, 1.0460140704885539, 1.218045112781955, 1.0300065231572082, 1.1381509291599226, 2.0, 1.023701002734731, 1.0114285714285713, 1.1063829787234043, 1.0794070937003706, 1.5, 1.214458706708646, 1.085209003215434, 1.0266940451745379, 1.1074561403508771, 1.0506134969325154, 1.122049898853675, 1.0551704863051985, 1.0736312146003777, 1.0333988212180747, 1.069078947368421, 1.2653061224489797, 1.3529411764705883, 1.0220913107511045, 1.5714285714285714, 1.0427332869568464, 1.0412202914242579, 1.1736486486486486, 1.3272365428354813, 1.107577807848444, 1.1384007845008084, 1.2610526315789474, 1.1069767441860465, 1.0136535295826474, 1.0353892821031345, 1.000862812769629, 1.1098153547133138, 1.0499205087440382, 1.0897116561827163, 1.0310922387355508, 1.0, 1.008, 1.023849844764324, 1.0277113237639552, 1.1204145077720207, 1.0921052631578947, 1.0866113671274962, 1.276955602536998, 1.0867692574075276, 1.1372549019607843, 1.3363636363636364, 1.0852062022449538, 1.0, 1.5454545454545454, 1.0524998991162584, 1.0488095238095239, 1.0147533425541724, 1.5217391304347827, 1.045016077170418, 1.0526110257582841, 1.0566649930370693, 1.0626410835214446, 1.1192157689469802, 1.4180790960451977, 1.1636363636363636, 1.1830985915492958, 1.0, 1.4953271028037383, 1.0731745781422488, 1.2752613240418118, 1.2528735632183907, 1.0103806228373702, 1.0031277926720286, 1.0049585923107385, 1.070247475307957, 1.2411930673115679, 1.2307692307692308, 1.005813953488372, 1.0025990903183886, 1.0519989660520421, 1.010060548525649, 1.0, 1.0815734989648034, 1.1189017785043232, 1.0111420354105587, 1.1603715170278637, 1.0597800594152291, 1.2772255834053587, 1.0357142857142858, 1.0061033207012493, 1.209128416709644, 1.0276367738296672, 1.1162790697674418, 1.0590949033391917, 1.0313346228239846, 1.1291338582677166, 2.0, 1.2164415061799367, 1.119696292987941, 1.1610407876230662, 1.1806167400881058, 1.0, 1.6666666666666667, 1.0771530574559012, 1.1454545454545455, 1.1125227507940474, 1.5, 1.0, 1.05, 1.0226385636221702, 1.0714285714285714, 1.0138121546961325, 1.1255274261603376, 1.0383333333333333, 1.00335852225021, 1.0921004239174619, 1.0363636363636364, 2.0, 1.0938868669421997, 1.0976877306620472, 1.1138353765323994, 1.016263561678199, 1.1112553623842854, 1.0691402619719792, 1.088235294117647, 1.0793972149358309, 1.0245215311004785, 1.0585552449610123, 1.1612949229891614, 1.1, 1.0472236898382268, 1.1608910891089108, 1.2272727272727273, 1.25, 1.053236307927997, 1.0555555555555556, 1.0769230769230769, 1.120678285445125, 1.1030640668523677, 1.3583959899749374, 1.0054789067941956, 1.0456140350877192, 1.0240690819180853, 1.0447110081317939, 1.25, 1.011786104037832, 2.5, 1.0506233190535013, 1.0475161987041037, 1.0549542578853943, 1.0526315789473684, 2.5, 1.434782608695652, 1.0923076923076922, 1.0699620315710088, 1.0, 1.0123839009287925, 1.0520361990950227, 1.0048076923076923, 1.014514892430649, 1.0862068965517242, 1.1446540880503144, 1.004356365722861, 1.1323402210475733, 1.1007615442179866, 1.1282051282051282, 1.0, 1.1133651551312649, 1.2303030303030302, 1.1845018450184501, 1.156613310867734, 1.0283569641367807, 1.0788732394366196, 1.1346153846153846, 1.008230452674897, 1.0025866528711846, 1.2857142857142858, 1.0077616173761572, 1.04, 1.0, 1.0885507880910683, 1.3333333333333333, 1.4, 1.0090365392337117, 2.0, 1.1646090534979423, 1.0436046511627908, 1.059064807219032, 1.1260647359454856, 1.084985835694051, 1.0833333333333333, 1.089002827419202, 1.0566441907451134, 1.0152143845089903, 1.0234215031385319, 1.0027905678805638, 2.0, 1.0, 1.0330103521561278, 1.25, 1.070949720670391, 1.3529411764705883, 1.0, 1.4666666666666666, 1.3875502008032128, 1.0709555345316935, 1.2285714285714286, 1.0238095238095237, 1.0, 1.2276964047936085, 1.0738357133880558, 2.0, 1.385348421679571, 1.0, 1.0931602520306687, 1.0674157303370786, 1.0718303521205985, 1.152073732718894, 1.1363636363636365, 1.3587962962962963, 1.3425925925925926, 1.0295005152766554, 1.024899458977953, 1.0915697674418605, 1.0, 1.0769230769230769, 1.5714285714285714, 3.0, 1.1428571428571428, 1.0699731664299, 1.3333333333333333, 1.0488656195462478, 1.1477272727272727, 1.2131132423459978, 1.0694760522116717, 1.2657054582904221, 1.0113706135172154, 1.0110208816705337, 1.055952380952381, 1.5, 1.1320754716981132, 1.0808510638297872, 1.0522001373042598, 1.0952380952380953, 1.5714285714285714, 1.0200445434298442, 1.011169900058789, 1.0342161880923588, 1.0024570024570025, 1.1464387464387464, 1.0238030095759234, 1.0666666666666667, 1.0907770515613653, 1.0307203389830508, 1.2115384615384615, 1.0240793201133145, 1.1388888888888888, 1.059094771961852, 1.0786710307503364, 1.0317407024793388, 1.162162162162162, 1.0571428571428572, 1.098159509202454, 1.0, 1.0065548244512532, 1.0517176353957889, 1.0489039184619386, 1.0573776335959502, 1.031055900621118, 1.1280584683825865, 1.5714285714285714, 1.0260492040520983, 1.2, 1.2263023057216054, 1.25, 1.0216296921223962, 1.027536231884058, 1.048151332760103, 1.08300395256917, 1.0479394449116906, 3.0, 1.1460221550855991, 1.0202131148555411, 1.0986527496781313, 2.0, 1.0476190476190477, 1.2456813819577734, 1.3540856031128405, 1.0888410448064345, 1.0873180873180872, 1.1666666666666667, 1.005176876617774, 1.0276252132657115, 1.0668817075841746, 1.1036354983148304, 1.2172149122807017, 1.1343283582089552, 1.2878048780487805, 1.875, 1.0287206266318538, 1.5, 1.2278056951423786, 1.1515151515151516, 1.0968543238537434, 2.272727272727273, 1.0789820359281437, 1.075478183161766, 1.0468846391116595, 1.0, 1.1515151515151516, 1.16, 1.28328173374613, 1.2385120350109409, 1.0, 1.004144791378834, 1.0958473856293283, 1.0704517198508081, 1.5, 2.0, 1.0141788105553367, 1.0099547511312217, 1.0163934426229508, 1.1111111111111112, 1.0714967308711787, 1.1170886075949367, 1.4705882352941178, 1.0417702448210924, 1.0454545454545454, 1.1391076115485563, 1.0298387096774193, 1.3432898611695414, 1.03345791066026, 1.0, 1.0571428571428572, 1.0328938449023861, 1.0531312851663965, 1.0269764351236588, 1.0, 1.1026321610263217, 1.0023246116618019, 1.0220010476689365, 2.0, 1.0566188197767146, 1.04345049492791, 1.009150598651178, 1.0200952339347342, 1.00671937104936, 1.069462212745795, 1.0059171597633136, 1.1422372227579556, 2.0, 1.1099281616621015, 2.0555555555555554, 1.0, 1.1865284974093264, 1.1538461538461537, 1.0065598639682594, 1.1072436500470366, 1.0771642104860752, 1.0977512620468104, 1.1182534793377001, 1.1445962396861897, 1.0576187338904492, 1.197674418604651, 4.0, 1.0020784919386267, 1.2291497975708503, 1.0462199312714777, 1.0346198482654108, 1.1078132927447997, 1.0900837988826815, 2.223404255319149, 2.4285714285714284, 1.0044310269270098, 1.056232103662273, 1.0198399607913364, 1.1343005952380953, 1.086482838411107, 1.029723991507431, 1.0780778108692353, 1.0021621621621621, 1.215170278637771, 3.0, 1.2, 1.0235478806907379, 1.0660377358490567, 1.058614564831261, 1.0964797913950457, 1.0529411764705883, 1.3355704697986577, 1.148905109489051, 1.116564417177914, 1.0808521900224957, 1.2840909090909092, 1.018761667215712, 2.0, 1.0807453416149069, 1.003968253968254, 1.4242424242424243, 1.062849162011173, 1.0088300220750552, 1.0276679841897234, 1.1686121919584955, 1.0814031123208874, 1.0, 1.4042553191489362, 1.5, 1.0, 1.1363636363636365, 1.0745967741935485, 1.0156739811912225, 1.0436893203883495, 1.0648830503043896, 1.0812064965197217, 1.015745428606225, 1.160411899313501, 1.0386398763523956, 1.0887375976356344, 1.162162162162162, 1.1411208642808912, 1.0396710208030964, 1.082573726541555, 1.239884393063584, 1.1132132132132133, 1.0658794912076217, 1.2003390580084028, 1.0835506981245648, 2.0, 1.2481572481572483, 1.0681145113524186, 1.4074074074074074, 1.0, 1.0851063829787233, 1.25, 1.2725225225225225, 1.2962962962962963, 1.1666666666666667, 1.0063478253864682, 1.1214524872448979, 1.0327672728213353, 1.0450386496292792, 1.2, 1.1017402945113788, 1.0, 1.1079136690647482, 1.0015173460238638, 1.057813371583393, 1.08375, 1.1230208451987698, 1.0213286585588546, 1.0935064935064935, 1.0984639299666605, 1.1243339253996447, 1.039229096127542, 1.097243924019654, 1.303030303030303, 1.079484425349087, 1.0, 1.2422535211267605, 1.208189513477975, 3.0, 1.1593004017962656, 1.0733206531824087, 1.4285714285714286, 1.0523522498957505, 1.3, 1.1176470588235294, 1.063477239176935, 1.6923076923076923, 1.008762070507475, 1.0397266125587357, 1.3571428571428572, 1.1153846153846154, 1.1175257731958763, 1.0334768053562888, 1.031890660592255, 1.0568945206787863, 1.1572357773231137, 1.0, 1.1073213121877037, 1.1219512195121952, 2.0, 1.005706200273712, 1.0918678086339648, 1.1267738883632923, 1.0162087299818523, 1.072560094575069, 1.018018018018018, 1.8571428571428572, 1.0792282430213465, 1.0524193548387097, 1.1355437530755264, 1.2671174978867286, 1.0120973551804229, 1.0428398278047897, 1.2106227106227105, 1.0953545232273838, 1.254180602006689, 1.0577891813003155, 1.0649842271293375, 1.013586956521739, 1.088, 1.026915356155875, 3.0, 1.1235015168919913, 1.014143430311095, 1.0357912377304286, 1.4615384615384615, 1.296694903485627, 1.2604651162790699, 1.1428571428571428, 1.0726176200888764, 1.0420575865415722, 1.1462882096069869, 1.088235294117647, 1.3333333333333333, 1.0806234863252406, 1.5, 1.1121495327102804, 1.0833333333333333, 1.0995045705114785, 1.3846153846153846, 1.1181434599156117, 1.0387840670859538, 1.0, 1.6415343915343916, 1.2924767540152156, 1.25, 2.0, 1.1271186440677967, 1.2724137931034483, 1.09185329438494, 1.2032828282828283, 1.0792580101180438, 1.2625368731563422, 1.1014466214978942, 1.0597402597402596, 1.1893203883495145, 1.4489795918367347, 1.0384615384615385, 1.0, 1.0923076923076922, 1.0562770562770563, 1.1022727272727273, 1.1620515290151698, 1.0779175028151204, 1.0616904500548847, 1.075778910858803, 1.1458212839791788, 1.1704225352112676, 1.016990291262136, 1.5714285714285714, 1.0, 1.2142857142857142, 1.016304683161597, 1.0485436893203883, 1.107843137254902, 1.041025641025641, 1.0019894406611065, 1.054346446253015, 1.0091182324657066, 1.1142857142857143, 1.2222222222222223, 1.040030792917629, 1.1169803817603394, 1.0746133596577823, 1.032056091339399, 1.0066225165562914, 1.1238924985233314, 1.0170948271940068, 1.1887366818873668, 1.3421588594704685, 1.125, 1.039906103286385, 1.4701986754966887, 1.0612244897959184, 1.112121212121212, 1.0701001430615165, 1.0, 1.0257611241217799, 1.0030403984862697, 1.0740740740740742, 1.064942405209403, 1.039647577092511, 1.303030303030303, 1.0296652985865944, 1.0259552992069214, 1.0664114961052915, 1.0658396946564885, 1.0147559591373438, 1.1963322545846817, 1.1940298507462686, 1.2857142857142858, 1.0, 1.25, 1.074409591861451, 1.3333333333333333, 1.2744412607449858, 1.0972753217381939, 1.0240471869328494, 1.0609731876861965, 1.0506954684946794, 1.0439442658092175, 1.028673835125448, 1.0332871012482663, 1.025561791156926, 1.1030886764154482, 1.038066329957953, 1.1685535348669156, 1.6666666666666667, 1.0158730158730158, 1.051383399209486, 1.090991022219141, 1.0553745928338762, 1.292018523563062, 1.0462962962962963, 2.220779220779221, 1.0308436057500432, 1.0214765100671142, 1.0480023923444977, 1.25, 1.073488574588756, 1.0358151756894047, 1.2678660669665167, 1.0581052631578947, 1.032258064516129, 1.1225961538461537, 1.0634920634920635, 1.5625, 1.0577842815333, 1.5384615384615385, 1.2669220945083015, 1.0885167464114833, 1.057774607703281, 1.0136542072025942, 1.022864019253911, 1.5714285714285714, 1.103448275862069, 1.0920070590830546, 1.0414800822267904, 1.0092019001487993, 1.0021868625051, 1.0920035008126887, 1.1818181818181819, 1.0701013513513513, 1.2047540597787714, 1.0189700664179784, 1.028056112224449, 1.0347222222222223, 1.1051320378674638, 1.0154571597733233, 1.3486777668952008, 1.0009780121902234, 1.0, 1.3333333333333333, 1.074607530470469, 1.0046433094132545, 1.2191421614534557, 1.0827170790473544, 1.074221867517957, 1.0613207547169812, 1.0991611714029432, 1.1215155615696888, 1.0900735294117647, 1.0486486486486486, 1.0507726269315674, 1.0793083983703922, 1.1071428571428572, 1.75, 1.0319438368879832, 1.1613951020276898, 1.0062713797035348, 1.0511363636363635, 1.1947863866763215, 1.017618963382275, 1.1709305594602193, 1.2269938650306749, 1.3461538461538463, 1.057277628032345, 1.1020881670533642, 1.15625, 1.5925925925925926, 1.0470108391999107, 1.193260654112983, 1.165837479270315, 1.024390243902439, 1.0241481927307987, 1.0339992316557818, 1.0635542168674699, 1.248266983561101, 1.3333333333333333, 1.0357142857142858, 2.0, 1.1734587251828632, 1.3846153846153846, 1.0, 1.1538461538461537, 1.0172185430463576, 1.048913043478261, 1.0411916541191655, 1.0430730897009968, 1.32, 1.3076923076923077, 1.1428571428571428, 1.0333333333333334, 1.0945945945945945, 1.0285714285714285, 1.1342756183745584, 1.0234494775872434, 1.0322919372193982, 1.3195876288659794, 1.0766090149976406, 1.0469546068765327, 2.5, 1.066993297267871, 1.3282732447817838, 3.0, 2.0, 1.1985207100591715, 1.0995481603672093, 1.055312570696026, 1.2422360248447204, 1.0, 1.1120689655172413, 1.0866666666666667, 3.0, 1.5, 1.068911099421357, 1.1377873370076623, 1.01073503409952, 1.6666666666666667, 1.0128993555349262, 1.0449264136328427, 1.1041902604756513, 1.0, 1.0093896713615023, 1.0226282917238132, 1.118421052631579, 1.1250229035607402, 1.0697232404336612, 1.261127596439169, 1.140625, 1.1062857142857143, 1.0842592592592593, 1.1198347107438016, 1.15, 1.0290945182220108, 1.2918312529625533, 1.0479480688389808, 1.341317365269461, 1.1176470588235294, 1.2686567164179106, 1.1216783216783217, 1.062323833385531, 1.0004192160659566, 1.0853726767579996, 1.0993449781659388, 1.5, 1.6666666666666667, 1.0929169596624688, 1.1816182937554969, 1.1925695390001945, 1.0217412648347468, 1.0928248871048671, 1.076236853950976, 1.0970149253731343, 1.0, 1.082619290936247, 1.0848554580756509, 1.1817548746518105, 1.2123142250530785, 2.5, 1.056338028169014, 1.0826085229754954, 1.1013157894736842, 1.0147258404180641, 1.0818628745729209, 1.0340909090909092, 1.6, 1.0862944162436547, 1.0258733822065345, 1.172492574822938, 1.1863117870722433, 1.0945262957135364, 1.0445859872611465, 1.3344370860927153, 1.0278260869565217, 1.0312129162901593, 1.0772792322586076, 1.0368663594470047, 1.0582655826558265, 1.0, 1.1546961325966851, 1.050278818904836, 1.023778071334214, 1.0383767798216468, 1.1541425818882467, 1.0423600605143721, 1.2, 1.2493368700265253, 1.6666666666666667, 2.0, 1.1176470588235294, 1.0025575447570332, 1.0497630331753554, 1.0176864064094326, 1.0005731149223729, 1.0415196743554953, 1.0014644351464435, 1.125, 1.1666666666666667, 1.038440764045259, 1.6, 1.5, 1.1927851047323506, 1.1428571428571428, 1.119225037257824, 1.1437908496732025, 1.0754095182708152, 1.1172761357549787, 2.0, 1.0173228346456693, 1.2790697674418605, 1.0219164118246686, 1.0406112094828297, 1.143939393939394, 1.1202054794520548, 1.1436684334773506, 1.1346764346764346, 1.003189792663477, 1.0422535211267605, 1.0391061452513966, 1.0, 1.0, 1.041620471370838, 5.0, 1.4285714285714286, 1.6363636363636365, 1.037546933667084, 1.0561797752808988, 1.0825942350332594, 1.078462142016477, 1.0, 1.1123525760397268, 1.0210280373831775, 1.1614583333333333, 1.2283653846153846, 1.4285714285714286, 1.023876881294557, 1.1213968957871396, 1.1704545454545454, 1.0003720238095237, 1.0245053398460138, 1.0459274533695755, 1.1644483880508725, 1.0, 1.2461395270127342, 1.04575332084983, 1.0674766857962696, 1.1774193548387097, 1.0394625106149158]
origin-bjaq_15.71 	max: 5.0000	99th: 2.5050	95th: 1.6667	median: 1.0826	mean: 1.1757

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 13.980761 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[1.1920929e-06 1.7881393e-07 2.9802322e-07 4.7683716e-07 6.5565109e-07]
Distance score: 5.602836381513043e-07
SAUCE Drift detection: False
Detection latency: 0.0233s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.035343 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 7.0000	99th: 3.0000	95th: 2.0000	median: 1.0785	mean: 1.1922
ReportEsts: [1.0299727520435968, 1.0327225130890052, 1.0403275406712413, 1.0820244328097732, 1.52, 1.0, 1.0781054678457336, 1.056633934688285, 1.2, 1.0185387131952017, 1.1647352983603405, 1.0435573529577582, 1.0131438721136767, 1.0248091603053435, 1.0714921388312073, 1.2535211267605635, 1.1623376623376624, 1.2, 1.1818181818181819, 1.1031879194630871, 1.083537536199599, 1.0482238442822385, 1.193384223918575, 1.0075885328836425, 1.018420401963901, 1.0379629737371856, 2.0, 1.1583913659521872, 1.6, 1.1666666666666667, 1.0757874015748032, 2.0, 1.0429535527055374, 1.0009350463040054, 1.0940639269406394, 1.0911534701857282, 1.2460845387674655, 1.0891304347826087, 2.0, 1.1209634255129348, 1.0049242776177645, 1.0239537874789049, 1.1563275434243176, 1.1895200783545543, 1.0561797752808988, 1.088662438043742, 1.3, 1.1653696498054475, 1.1555555555555554, 1.0401106500691564, 1.25, 1.262008733624454, 1.0408163265306123, 1.0606060606060606, 1.0466860153710094, 1.0529966823215131, 1.0642665873252009, 1.202127659574468, 1.075268817204301, 1.0132665314794207, 1.5833333333333333, 1.1187349304878675, 1.1018237082066868, 1.1115384615384616, 1.0096153846153846, 2.0, 1.1423474612665587, 1.2862050739957718, 1.6, 1.0, 1.0882717004487081, 1.0228628230616301, 1.066147859922179, 1.0328820116054158, 1.0777482985350098, 1.0670553935860059, 1.0377300550699122, 1.3987341772151898, 1.4368932038834952, 1.0661615515381944, 1.0617704280155642, 1.396551724137931, 1.0, 1.0, 1.0613154960981048, 1.1111111111111112, 1.0, 2.0, 3.0, 1.1153710473991405, 1.1227245145631068, 1.0724775438429732, 1.0603492552645095, 1.07433314680097, 1.174934725848564, 1.0233100233100234, 1.2251908396946565, 1.0649867374005304, 2.0, 1.2889597449182941, 1.1538461538461537, 2.0, 1.075313343123527, 1.1833910034602075, 1.0473797559224696, 1.2314250471629662, 1.3548387096774193, 1.0126189572343016, 1.1022172949002218, 1.2906031970325886, 1.143037574992106, 1.0300732878443266, 1.5, 3.0, 1.0850856697819315, 1.0742986313530432, 1.0339958158995817, 1.065217391304348, 1.0605148007848981, 2.0, 1.133244680851064, 1.1714015151515151, 1.0, 1.0531400966183575, 1.375, 1.2337662337662338, 1.023620817668619, 1.030297132476969, 1.0403225806451613, 1.6666666666666667, 1.1304347826086956, 1.0, 1.1666666666666667, 1.1207764856698104, 1.25, 1.367816091954023, 1.003373916517763, 1.1119443736575776, 4.0, 1.6428571428571428, 1.0313152400835073, 1.0432127759511507, 1.0746951219512195, 1.0510660100765705, 1.286624203821656, 1.0219058050383352, 1.0872981275154858, 3.0, 1.0281797410510283, 1.0009505703422052, 1.1010332950631458, 1.0808303886925794, 1.5, 1.1390721754136637, 1.0518987341772152, 1.0426621160409557, 1.0436817472698907, 1.0, 1.0935093509350935, 1.1540509109704096, 1.1389019440290535, 1.028006589785832, 1.1049723756906078, 1.3157894736842106, 1.3629032258064515, 1.0084235860409145, 1.375, 1.0647512029594193, 1.0, 1.0392638036809816, 1.0272030141969355, 1.0666666666666667, 1.037866398289093, 1.3511586452762923, 1.1332007952286283, 1.0784853143458208, 2.0, 1.0560181680545042, 1.0483091787439613, 1.0294649780304987, 1.0078577336641852, 1.2222164344315667, 1.1257861635220126, 1.3125, 1.0061655601467105, 1.0872680343553913, 1.325, 1.080903799057312, 1.0375, 1.25, 1.2976878612716762, 1.0773293258909402, 1.7142857142857142, 1.1261845386533667, 1.1343992916758896, 1.034296804553652, 1.1119838739715822, 1.0411764705882354, 1.012206958339555, 1.041348698048744, 1.0053807947019868, 1.3034682080924855, 1.0062067319169252, 1.0714005555155328, 1.0691114245416078, 1.100035069261792, 1.3091787439613527, 1.161764705882353, 1.1264367816091954, 1.0, 1.3357142857142856, 1.0449690096267967, 1.3391812865497077, 1.3333333333333333, 1.0148514851485149, 1.05, 1.0403848565746332, 1.002267573696145, 1.2698298872554878, 2.3333333333333335, 1.1354534746760896, 1.0021482277121374, 1.0440833043915643, 1.007224946294566, 1.25, 1.0628930817610063, 1.1071616467184007, 1.0345420560747665, 1.0104712041884816, 1.0316139767054908, 1.0776640577965082, 1.087732687394233, 1.4434782608695653, 1.003664441826986, 1.0974015167724605, 1.1590909090909092, 1.1726190476190477, 1.008888888888889, 2.6666666666666665, 1.1534914361001318, 2.0, 1.2483419307295505, 1.063586501812773, 1.0765027322404372, 1.1533101045296168, 1.1428571428571428, 1.5, 1.0838083545265866, 1.0571428571428572, 1.1052194543297746, 1.6, 1.0138312586445366, 1.1267748478701824, 1.4285714285714286, 1.0306534254695454, 1.023041474654378, 1.1109170305676856, 1.056379821958457, 1.0038515406162465, 1.073586216928224, 1.0579710144927537, 2.0, 1.087364980224268, 1.0754332942700302, 1.1182634730538923, 1.080247495802758, 1.0536224763266036, 1.0364726561392568, 1.106930693069307, 1.0812515585806282, 1.0264735264735265, 1.0369794159885113, 1.0564708432690224, 1.2307692307692308, 1.0045148769721164, 1.1091269841269842, 1.1886792452830188, 1.4, 1.0965125709651258, 1.2283105022831051, 1.0329169988484366, 1.0525132600372336, 1.3237410071942446, 1.3402922755741127, 1.0386123908063338, 1.13469068128426, 1.0016561916086293, 1.0702946021167428, 1.2727272727272727, 1.1803482587064678, 1.0639853747714807, 1.0275098928168978, 1.4589337175792507, 1.071431303988554, 1.1874015748031497, 1.21247892074199, 1.0601322055583198, 1.00293105211138, 1.090373422983769, 1.0403635866593768, 1.0054151624548737, 1.3789473684210527, 1.0714285714285714, 1.0874718679669917, 1.25, 1.00711743772242, 1.1091267559352667, 1.0250881316098708, 1.2926829268292683, 1.089430894308943, 1.0410596026490067, 1.060866574965612, 1.1174733015223812, 1.173913043478261, 1.2194350017582933, 1.0164291824351537, 1.0159817351598173, 1.2666666666666666, 2.5, 1.0079810181190683, 1.1111111111111112, 1.0026999479181644, 1.0407523510971788, 1.0, 1.0762103629662594, 1.5, 1.25, 1.0025044065545512, 2.0, 1.1540342298288508, 1.0436893203883495, 1.039617486338798, 1.064819654992159, 1.4427710843373494, 1.1020408163265305, 1.0976577023175114, 1.090156555640538, 1.0578186596583443, 1.0354382537795142, 1.064095432350578, 3.0, 1.1, 1.0428834116178698, 1.5, 1.0711627906976744, 1.173913043478261, 2.0, 1.3888888888888888, 1.382133995037221, 1.0903377847604085, 1.28, 1.03725782414307, 1.2, 1.6666666666666667, 1.0391350876322634, 1.0, 1.1746031746031746, 1.0466112062637631, 1.0038610038610039, 1.0393343419062027, 1.0291627469426152, 1.4, 1.5, 1.4559216384683882, 1.1923076923076923, 1.1299559471365639, 1.1272574796546306, 1.2406880336592006, 1.0751295336787565, 1.0, 1.0269967465384682, 1.3275862068965518, 1.2857142857142858, 1.0, 1.1218130311614731, 1.2857142857142858, 1.1494736842105264, 1.17, 1.2567373624621272, 1.0762312602695905, 1.1666666666666667, 1.1311170649024003, 1.1166554281861092, 1.1944444444444444, 1.065406976744186, 1.1554376657824934, 1.108433734939759, 1.0256410256410255, 1.0147599532737126, 1.0619014204707087, 1.119904076738609, 1.0246305418719213, 1.0238095238095237, 1.1023622047244095, 3.0, 1.0833333333333333, 1.2990654205607477, 1.132183908045977, 1.070754716981132, 1.0599078341013826, 1.093649085037675, 1.5, 1.0602519945938875, 1.1511229539398553, 1.1282517178283067, 1.0957446808510638, 1.2, 1.1376623376623376, 1.0, 1.13278202247191, 1.5660377358490567, 1.1049635229136425, 1.0701012112161938, 1.0702945920706342, 1.1801242236024845, 1.5, 1.1802270577105014, 1.1666666666666667, 1.0645905420991926, 1.0909090909090908, 1.0963261415821852, 1.0085889570552147, 1.070000896298288, 1.1561461794019934, 1.1453576864535768, 3.0, 1.2172351885098742, 1.0134283203840468, 1.1549514339904592, 2.0, 1.027027027027027, 1.198090692124105, 1.2421652421652423, 1.1019200330328263, 1.0579318809450753, 1.0, 1.0929394812680115, 1.001715533374922, 1.0718682748611181, 1.1241054798549162, 1.056502513322499, 1.4585561497326203, 1.0666666666666667, 1.0303579519710013, 1.0345847029583901, 1.1271186440677967, 1.0053937432578208, 2.0, 1.0, 1.1988110964332892, 1.103846153846154, 1.0386100386100385, 1.1360896765973285, 1.0896516393442623, 2.0, 1.0743801652892562, 1.2857142857142858, 1.005276695038846, 1.125, 1.0, 1.0010379376813743, 1.6666666666666667, 1.0, 1.0207055214723926, 2.0, 1.0110641067360886, 1.027190332326284, 1.0250696378830084, 1.1818181818181819, 1.0825318903640895, 1.0781648258283771, 1.55, 1.0879997487516095, 1.0072463768115942, 1.1756152125279642, 1.052345343303875, 1.3389592123769338, 1.0763116057233704, 1.0, 1.024390243902439, 1.0092553040011392, 1.069588865781475, 1.05229793977813, 1.0, 1.1046404141246071, 1.007522869523351, 1.0182688125271857, 2.0, 1.035035035035035, 1.031846424740432, 1.0223010768586285, 1.0571470223777244, 1.0089606390215713, 1.1207181863312925, 1.0055944055944055, 1.0414114467241167, 1.75, 1.0593329886246121, 1.0891089108910892, 1.0481217775595384, 1.0925619834710745, 1.0132275132275133, 1.0069398777126386, 1.2407407407407407, 1.0690388059701492, 1.0467625899280575, 1.085085400569337, 1.0761856710393543, 1.1407270732558719, 1.0570139150056412, 1.0602409638554218, 1.2638888888888888, 1.094711937941227, 1.0510638297872341, 1.0116429837792067, 1.0791648982396573, 1.0, 1.0463957055214723, 1.3775811209439528, 1.4545454545454546, 1.2745098039215685, 1.0183385622698131, 1.1527272727272728, 1.0722495894909687, 1.0, 3.0, 1.0267131242740999, 1.1154565550076518, 1.0582959641255605, 1.0404859335038363, 1.0907686365392044, 1.0256410256410255, 1.006125574272588, 1.0314277932453697, 1.558011049723757, 1.0016298653420777, 1.1830985915492958, 1.053921568627451, 1.0464756530953672, 1.0019417475728156, 1.0166892667153438, 2.0, 1.029030265596047, 1.0100334448160535, 1.0469783352337514, 1.0977777777777777, 1.063891577928364, 1.0635451505016722, 1.1683168316831682, 1.1230214787048263, 1.0, 1.3392857142857142, 1.0, 1.0, 1.0909090909090908, 1.1539844218094668, 1.0090322580645161, 1.0395256916996047, 1.0588469184890656, 1.1404639175257731, 1.1216820184221066, 1.184811729748161, 1.0678471859208922, 1.0784460232609772, 1.0013674672114983, 1.1043715846994535, 1.048168445341794, 1.053116810477561, 1.0846715328467154, 1.0366379310344827, 1.132841328413284, 1.2352941176470589, 1.003075428941405, 1.1823599523241954, 1.100538670231589, 1.3908045977011494, 1.210691066698772, 1.011066398390342, 1.3333333333333333, 1.0291036088474972, 1.1875, 2.5, 1.4297520661157024, 1.04935327753767, 1.0474924012158056, 1.0025510204081634, 1.1166666666666667, 1.1236560610620194, 1.0589919640383016, 1.1155234657039712, 1.2, 3.0, 1.033493882522283, 1.224770642201835, 1.1008471157724888, 1.069029418577716, 1.0, 1.0455658990690837, 1.199134199134199, 1.064646197574115, 1.0977011494252873, 1.0288050478839583, 1.0960534707850105, 1.0116477502881231, 1.4130434782608696, 3.0, 1.1798961825456904, 1.0, 1.0386416861826697, 1.25, 1.289273356401384, 1.0779036827195467, 1.8181818181818181, 1.069968042082638, 1.1549295774647887, 1.0285714285714285, 1.1012609858616738, 1.2901520158625248, 1.0200353565114908, 1.030791646430306, 1.0126811594202898, 1.0777777777777777, 1.0, 1.0338099436500938, 1.0583734672268335, 1.105263157894737, 1.0034940600978337, 1.2057697968795997, 1.263157894736842, 1.0046886619628896, 1.3333333333333333, 1.0091743119266054, 1.0378988708885617, 1.0554272517321017, 1.2083333333333333, 1.043268308840193, 1.047244094488189, 1.75, 1.058960692871419, 1.05, 1.1089718198279765, 1.1771576898118106, 1.016949566014998, 1.1313109050550212, 1.241860465116279, 1.1126468555632343, 1.2135135135135136, 1.0778514244644533, 1.0966894377299001, 1.0352664576802508, 1.019085663559698, 1.0009435211547375, 1.0196078431372548, 1.0702493853178785, 1.0909090909090908, 1.1428571428571428, 1.0741190765492101, 1.580682143880768, 1.0833333333333333, 1.1104868913857677, 1.0, 1.0441058540497192, 1.0365984930032293, 1.1393939393939394, 1.0469296227361076, 2.0, 1.1639526276831977, 1.5, 1.0553435114503817, 1.0714285714285714, 1.0267446597986147, 1.3548387096774193, 1.1161971830985915, 1.0434782608695652, 1.0, 1.1272447941536736, 1.2068511198945981, 1.2, 3.0, 1.0774647887323943, 1.256797583081571, 1.042362002567394, 1.197465681098205, 1.0929899856938483, 1.0701754385964912, 1.0414634146341464, 1.0997610513739546, 1.1721311475409837, 1.482394366197183, 1.1071428571428572, 1.0, 1.071171171171171, 1.1638141809290954, 1.013793103448276, 1.0659452460229375, 1.0969136921583893, 1.0670866489832007, 1.058998999493571, 1.1619567512139217, 1.1368778280542986, 1.0334018499486126, 1.5714285714285714, 1.5, 1.2058823529411764, 1.0094107575244533, 1.064868804664723, 1.1274238227146813, 1.0471311475409837, 1.0599107711918418, 1.0861695301054568, 1.0023406200733003, 1.0930232558139534, 1.2857142857142858, 1.0033333333333334, 1.1024807056229327, 1.059577809973867, 1.0780832174564126, 1.073446327683616, 1.0254867039243383, 1.003709758551308, 1.0973613044117814, 1.1242424242424243, 1.058492829531822, 1.0670731707317074, 1.0730722648364959, 1.0587219343696028, 1.024084468509204, 1.0, 1.053749597682652, 1.0, 1.0019417475728156, 1.0308731173234036, 1.0, 1.063607053297775, 1.010752688172043, 1.2093023255813953, 1.0281038961038962, 1.0310377982092422, 1.088170957428908, 1.0272873194221508, 1.0111008325624422, 1.1974950745848578, 1.2075134168157424, 1.2352941176470589, 4.0, 1.375, 1.072173474533535, 1.6666666666666667, 1.135823983090864, 1.1091452051103576, 1.0057027225901398, 1.0602549246813442, 1.0428814970175242, 1.0605166711361402, 1.0029585798816567, 1.044776119402985, 1.0165867048293822, 1.107981220657277, 1.0468310919309514, 1.274228356336261, 1.375, 1.138036809815951, 1.0730897009966778, 1.158603938351213, 1.0495867768595042, 1.2800899887514061, 1.0598425196850394, 2.2535714285714286, 1.0290010471729465, 1.03646408839779, 1.04575978606851, 1.1, 1.0690529060847145, 1.0244012652507908, 1.2728036990332072, 1.062367864693446, 1.088235294117647, 1.1623711340206186, 1.1027522935779817, 1.0194045093880115, 1.05, 1.0191078434734053, 1.0810810810810811, 1.0345610673479526, 1.0857858484658736, 1.0315656565656566, 1.1844863731656186, 1.0268767377201111, 1.0357833655705997, 1.0605612998522895, 1.0006175903812253, 1.0940254652301664, 1.0651324829324764, 1.0959151804060163, 1.0, 1.0540156361051884, 1.066008316008316, 1.2469213766971898, 1.0168067226890756, 1.0649762282091917, 1.166003976143141, 1.0503597122302157, 1.0495436766623207, 1.030591853191159, 1.064516129032258, 1.099883855981417, 1.2377180992200691, 1.043960734101579, 1.0176, 1.1975071907957815, 1.1027149740548554, 1.050880626223092, 1.0633663366336634, 1.1021836644156355, 1.0729682217714671, 1.1719242902208202, 1.031390134529148, 1.0005800464037122, 1.0907083490937344, 1.0673076923076923, 1.75, 1.0429319465775695, 1.158620320426164, 1.026366251198466, 1.0187793427230047, 1.226110772976263, 1.0133515658012113, 1.169356725146199, 1.264367816091954, 1.1935483870967742, 1.044456949915588, 1.15, 1.1037974683544305, 1.5, 1.0899529451150334, 1.212046204620462, 1.255813953488372, 1.0425531914893618, 1.120603015075377, 1.1633663366336633, 1.0392156862745099, 2.1333333333333333, 1.0152346130408287, 1.0408163265306123, 1.0429058995611897, 1.0, 1.0070182702758657, 1.1005405405405406, 1.0300995600833527, 1.2478632478632479, 1.1666666666666667, 1.1874452554744526, 1.0241674034777484, 1.0345216637543169, 1.0061162079510704, 1.2950819672131149, 1.0625, 1.0810810810810811, 1.074468085106383, 1.1728395061728396, 1.1268865287870318, 1.0265823532555647, 1.031397935850689, 1.3245614035087718, 1.0648734628256074, 1.0477539221370797, 2.5, 1.0254052420532433, 1.0909090909090908, 2.0, 2.5, 1.2116625310173696, 1.0881930307747576, 1.0674707718351584, 1.2526041666666667, 1.0, 1.1240601503759398, 1.2493150684931507, 1.1451612903225807, 1.1187352484637139, 1.1189844533945483, 1.0329512463208395, 1.060920428208807, 1.7142857142857142, 1.0306442858807248, 1.0326086956521738, 1.0252393385552654, 1.0408163265306123, 1.0269953051643192, 1.0, 1.0508474576271187, 1.209456861991323, 1.039889178723611, 1.3265306122448979, 1.1348684210526316, 1.1184368686222859, 1.0636015325670498, 1.1041666666666667, 1.1805555555555556, 1.031556039173014, 1.6838743093922652, 1.0562833859710687, 1.536764705882353, 1.165289256198347, 1.0526315789473684, 1.25, 1.0636063606360635, 1.0201511335012594, 1.0153094566967775, 1.0, 3.5, 1.077008680169152, 1.0603128596394016, 1.1553183658446817, 1.1618310767246938, 1.0011583185263488, 1.0313588850174216, 1.0737917834438444, 1.302439024390244, 1.037037037037037, 1.097341647522153, 1.0943526995807307, 1.1988235294117646, 1.3440702781844802, 2.3333333333333335, 1.011764705882353, 1.0496932515337423, 1.0175953079178885, 1.0110806935210532, 1.0965042913977798, 1.0112492599171108, 2.5, 1.1252676659528908, 1.0198287516899505, 1.155169119052169, 1.141025641025641, 1.0710378173370003, 1.1108179419525066, 1.2458100558659218, 1.010184287099903, 1.0313586217319026, 1.0302735328581194, 1.0529865125240847, 1.053631284916201, 1.0, 1.1137033203280515, 1.0110807502672137, 1.0019523030161328, 1.047838692672641, 1.0991401112797168, 1.0108487555839183, 2.5, 1.317351598173516, 2.3333333333333335, 2.5, 1.1363636363636365, 1.0262008733624455, 1.029296875, 1.0109564240229743, 1.0170477443836956, 1.008675799086758, 1.0651985434367957, 1.1945701357466063, 1.032258064516129, 1.0673864852692594, 2.0, 1.1578947368421053, 1.0029786081776333, 1.0, 1.0373831775700935, 1.113944878650761, 1.0304771988202375, 1.095402081106315, 2.5, 1.0928368244116886, 1.268131868131868, 1.0295773576292464, 1.040337284371548, 1.0792811839323466, 1.136259323006311, 1.1332277431949611, 1.0428732077593477, 1.0133689839572193, 1.2112676056338028, 1.10801393728223, 1.6666666666666667, 2.0, 1.041685758669632, 7.0, 1.5, 1.7428571428571429, 1.0061349693251533, 1.068339869002836, 1.0389016018306636, 1.0080321285140563, 1.0, 1.1120507399577166, 1.00336376741951, 1.1142857142857143, 1.2152641878669277]
origin-bjaq_15.71 	max: 7.0000	99th: 3.0000	95th: 2.0000	median: 1.0785	mean: 1.1922

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.183574 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.227036