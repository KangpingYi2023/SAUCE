Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 89, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.5000	95th: 1.6690	median: 1.0820	mean: 1.1683
ReportEsts: [1.0, 1.01328125, 1.0363627157386108, 1.0788381742738589, 1.5, 1.0, 1.0309387582114855, 1.0529752992249815, 1.0, 1.0064599483204135, 1.1708077222751276, 1.0426756703150075, 1.0554078014184398, 1.0883720930232559, 1.057223595902508, 1.0, 1.4, 1.0187657885239985, 3.0, 2.0, 1.0740740740740742, 1.0848306195021524, 1.0990934503748988, 1.0792718731650028, 1.0493339911198816, 1.0, 1.1389609927817088, 1.5, 1.2, 1.0220588235294117, 1.0, 1.0464512304111988, 1.0108077850499484, 1.05826859045505, 1.0718167131737406, 1.2426179860351645, 1.0828877005347595, 1.0038072674446947, 1.1607548729251327, 1.1547619047619047, 1.1079545454545454, 1.0884146341463414, 1.0, 1.033866090712743, 1.0956565827277336, 1.890625, 1.0842105263157895, 1.0636042402826855, 1.0284082130514332, 1.0925925925925926, 1.1007955449482896, 1.2439862542955327, 1.0391730701880884, 2.0, 1.3896103896103895, 1.2169739448422978, 1.1506276150627615, 1.3725490196078431, 1.0248447204968945, 1.0, 1.0839467466375863, 1.1058530510585305, 1.1363636363636365, 1.0, 1.0, 1.178791464360031, 1.329853181076672, 1.75, 1.0, 1.008576489232777, 1.0182260024301337, 1.0633720930232557, 1.0206896551724138, 1.13073914932651, 1.091764705882353, 1.0465116279069768, 1.0, 1.1164926931106471, 2.0, 1.0579500129128525, 1.03125, 1.0451327916234934, 1.116564417177914, 1.1354166666666667, 1.1143277723258096, 1.04, 1.0761393684865452, 1.0361822188854715, 1.0490196078431373, 1.75, 1.105963528831937, 1.0825299539441566, 1.2118380062305296, 1.032258064516129, 1.0009140767824498, 1.0415584415584416, 1.0305343511450382, 1.1334622823984526, 1.0, 1.2217377084923144, 1.06508279337653, 1.1037735849056605, 1.214233686104803, 1.2142857142857142, 1.0209877668249365, 1.0602601539686753, 1.222919385603855, 1.0898748577929465, 1.053648068669528, 1.1666666666666667, 2.0, 1.064018691588785, 1.0541109800309205, 1.027163613392293, 1.0649350649350648, 1.0580382104780393, 1.0, 1.1034374014506465, 1.1260775862068966, 1.0, 1.0167597765363128, 1.0, 1.1829573934837092, 1.0305616769305324, 1.0170847247029589, 1.0980392156862746, 1.8, 1.2061258278145695, 1.0, 1.2173913043478262, 1.0885892179816177, 1.3, 1.0719401041666667, 1.0091944205442545, 1.1115657510991164, 1.0600801068090788, 1.0167130919220055, 1.0572876071706936, 1.039972432804962, 1.081048141377209, 1.0031961613532856, 1.255813953488372, 1.0449897750511248, 1.069647442528386, 2.0, 1.020510483135825, 1.006904487917146, 1.1018455228981545, 1.1182283395094406, 1.5, 1.2048922257205135, 1.085209003215434, 1.0245901639344261, 1.1074561403508771, 1.1892361111111112, 1.0087660148347943, 1.1207290646243357, 1.1604227710339055, 1.0374753451676528, 1.180921052631579, 1.3061224489795917, 1.3398058252427185, 1.0058910162002945, 1.4285714285714286, 1.0596077389480876, 1.0068852984010552, 1.1712744436952125, 1.334572136458929, 1.1274104683195592, 1.1019851050860034, 1.2947368421052632, 1.1306413301662708, 1.0605209644620897, 1.0970677451971689, 1.037600716204118, 1.118561710398445, 1.047256581033936, 1.0914626411264747, 1.0304174499254555, 1.0, 1.1454545454545455, 1.0038103302286199, 1.0287081339712918, 1.1304893350062735, 1.1578947368421053, 1.0660180597248845, 1.3025177782048818, 1.1291691015734908, 1.1372549019607843, 1.289090909090909, 1.0451222435282839, 1.0, 1.2727272727272727, 1.0834106775352084, 1.0678787878787879, 1.0202257761053621, 1.5909090909090908, 1.0430868167202572, 1.0570196848168454, 1.041524462268952, 1.0626410835214446, 1.0722040687256245, 1.344632768361582, 1.032258064516129, 1.2173913043478262, 1.0, 1.415929203539823, 1.037927771644851, 1.2961672473867596, 1.1379310344827587, 1.009391992090954, 1.0031277926720286, 1.0175196987657764, 1.023970702474753, 1.2421944332392094, 1.1578947368421053, 1.0102189781021897, 1.0058327932598834, 1.0515825147912, 1.0053870664557687, 1.0, 1.0724637681159421, 1.130640300947354, 1.0168229564937417, 1.1539408866995073, 1.0239485068014802, 1.284581114853852, 1.0357142857142858, 1.0043809181686023, 1.0540226921093347, 1.0005640157924423, 1.136094674556213, 1.0981776765375855, 1.0073500967117988, 1.1283464566929133, 2.0, 1.2454384932313125, 1.0707347029924073, 1.0464135021097047, 1.1858407079646018, 1.0, 1.6666666666666667, 1.079210706811347, 1.1454545454545455, 1.1343837560496344, 1.5, 1.0, 1.05, 1.0288836846213896, 1.0103092783505154, 1.0248618784530388, 1.119198312236287, 1.061328790459966, 1.0046179680940386, 1.160856351986992, 1.0, 2.0, 1.0862377398063043, 1.0355265027710672, 1.1120840630472855, 1.0193700988748722, 1.0887924121339492, 1.000886437506156, 1.1017488076311606, 1.0904881784412794, 1.0233253588516746, 1.0171048911506926, 1.0567090578769789, 1.2727272727272727, 1.0092855083605612, 1.0021367521367521, 1.2272727272727273, 1.1904761904761905, 1.0315078769692423, 1.0555555555555556, 1.0683760683760684, 1.1569611735414844, 1.0278551532033426, 1.3333333333333333, 1.0092420681551115, 1.0188034188034187, 1.0214398974393577, 1.0563399227652073, 1.1111111111111112, 1.1032375409239723, 2.5, 1.0229879015655252, 1.0086393088552916, 1.0422648036047517, 1.0810810810810811, 2.0, 1.2608695652173914, 1.109375, 1.067636736362044, 1.0, 1.0123839009287925, 1.0068337129840548, 1.0044070512820513, 1.0137540077133962, 1.1962025316455696, 1.1383647798742138, 1.004666769685865, 1.0577567632271965, 1.1339561037547614, 1.0854700854700854, 1.0, 1.1109785202863962, 1.264797507788162, 1.1423487544483986, 1.152106149957877, 1.042952460383653, 1.1993243243243243, 1.3409090909090908, 1.0069060773480663, 1.0283797729618163, 1.2857142857142858, 1.0047761216969642, 1.0282485875706215, 1.105263157894737, 1.102465521015762, 1.1428571428571428, 1.2727272727272727, 1.0010365982652845, 2.0, 1.1989026063100137, 1.0290697674418605, 1.0910582444626744, 1.0521289295662555, 1.1467065868263473, 1.1097560975609757, 1.1148013365981682, 1.087063768327613, 1.0222841225626742, 1.0427871501740045, 1.0306159030615902, 2.0, 1.0, 1.0480015539660412, 1.25, 1.068561872909699, 1.3529411764705883, 1.0, 1.4666666666666666, 1.3674698795180722, 1.0609184629803186, 1.1120689655172413, 1.0043290043290043, 1.0, 1.174434087882823, 1.0793543154227665, 2.0, 1.1923764145324598, 1.0, 1.0982767782585592, 1.0470588235294118, 1.0035813977984938, 1.140552995391705, 1.1363636363636365, 1.255614973262032, 1.1851851851851851, 1.024896388614981, 1.0235753557726588, 1.0652482269503547, 1.0, 1.0769230769230769, 1.5714285714285714, 1.5, 1.3333333333333333, 1.0693860473410932, 1.3333333333333333, 1.026622296173045, 1.1222222222222222, 1.156212463012334, 1.0734172138080167, 1.25437693099897, 1.0251381476408634, 1.011600928074246, 1.0738095238095238, 1.5, 1.0666666666666667, 1.0851063829787233, 1.0477345323594638, 1.0476190476190477, 1.5714285714285714, 1.0311804008908685, 1.019561351511559, 1.029543617255824, 1.0225563909774436, 1.1464387464387464, 1.0300957592339262, 1.0389610389610389, 1.0907770515613653, 1.0603813559322033, 1.1153846153846154, 1.0254957507082152, 1.1081081081081081, 1.0482072209588487, 1.080156287696463, 1.012399142239689, 1.1944444444444444, 1.088235294117647, 1.098159509202454, 1.0, 1.0042317544828971, 1.0390212485096235, 1.0461825129136495, 1.057056789419272, 1.0667074663402694, 1.1585637114712424, 1.5714285714285714, 1.2087463556851312, 1.2, 1.1494449188727582, 1.25, 1.0331209833581232, 1.0102489019033676, 1.108555460017197, 1.075098814229249, 1.0939420544337137, 3.0, 1.1226570207168693, 1.0131849020427226, 1.0814327754276256, 2.0, 1.0952380952380953, 1.2677543186180422, 1.2253521126760563, 1.1377392928392547, 1.0166320166320166, 1.3125, 1.1251078515962036, 1.0088180510692477, 1.0239642256535697, 1.0850968333396998, 1.15, 1.0182421227197347, 1.168141592920354, 2.142857142857143, 1.0944444444444446, 1.5, 1.225752508361204, 1.064516129032258, 1.0735514655760054, 2.272727272727273, 1.0944817323169436, 1.1515406691986458, 1.0913016656384948, 1.0, 1.2258064516129032, 1.12, 1.2842436659837089, 1.2472647702407003, 1.0, 1.0215949188426252, 1.1216706742646332, 1.1110650642353916, 1.5, 2.0, 1.0007766990291262, 1.0145454545454546, 1.0163934426229508, 1.1111111111111112, 1.0653126839252616, 1.0271580989330746, 1.4705882352941178, 1.0929566854990584, 1.0454545454545454, 1.1719160104986877, 1.0362903225806452, 1.2818679007151872, 1.0010918285254569, 1.0, 1.0571428571428572, 1.0692056697775594, 1.066949351790362, 1.0089786392661502, 1.0, 1.1079407210794072, 1.013711268784865, 1.0214772132006287, 1.0, 1.0342902711323765, 1.0848730160756923, 1.0108925329603287, 1.0663579572757853, 1.0196138414134024, 1.006149885583524, 1.0110450297366185, 1.1096914175506267, 2.0, 1.0232570158664531, 1.2982456140350878, 1.25, 1.1813471502590673, 1.1346153846153846, 1.0144950488447304, 1.1188212927756653, 1.095886614293633, 1.174391922900413, 1.0553624185759543, 1.0246178817800622, 1.0532438711467111, 1.1444444444444444, 4.0, 1.0023526587444485, 1.1008097165991904, 1.0467532929446217, 1.0437891445506948, 1.1182141045154743, 1.1728024042073628, 2.3222222222222224, 2.2857142857142856, 1.0178168752323131, 1.0566443461499895, 1.054229427697344, 1.1259231905465288, 1.087688006170459, 1.0777777777777777, 1.0513662094769456, 1.0142231947483589, 1.1966463414634145, 3.0, 1.0833333333333333, 1.0644171779141105, 1.0865384615384615, 1.0719424460431655, 1.0823680823680824, 1.0411764705882354, 1.4962406015037595, 1.148905109489051, 1.0833333333333333, 1.0461613697625272, 1.2555555555555555, 1.0018202853837255, 2.0, 1.1144915932746198, 1.0952380952380953, 1.128, 1.100558659217877, 1.0374574347332577, 1.0, 1.0428015564202335, 1.1142067177309467, 1.0, 1.2340425531914894, 1.1666666666666667, 1.0, 1.1477272727272727, 1.092741935483871, 1.001543209876543, 1.0194174757281553, 1.06199935917975, 1.0638051044083527, 1.0900909311574585, 1.1696459462576405, 1.036237471087124, 1.1227739800583445, 1.0972972972972972, 1.121433311214333, 1.0290275761973875, 1.068536649907383, 1.2586705202312138, 1.1642587939698492, 1.026149090356256, 1.1824287529497186, 1.078640811075572, 2.0, 1.1326781326781328, 1.06496062992126, 1.4339622641509433, 1.0, 1.1333333333333333, 1.1538461538461537, 1.1995753715498938, 1.2962962962962963, 1.1666666666666667, 1.0043893538951976, 1.1336986742958457, 1.0278589720375593, 1.009063214013709, 1.2486486486486486, 1.1367403314917126, 1.0, 1.203125, 1.000068970273812, 1.054267272292613, 1.0855026344618917, 1.148194555188518, 1.0263891947441826, 1.1688311688311688, 1.064582631276389, 1.108348134991119, 1.0363925824607036, 1.1064873209209511, 1.303030303030303, 1.0702875399361023, 1.0, 1.2422535211267605, 1.209506571504967, 3.0, 1.1064741709903, 1.0854053293300807, 1.4285714285714286, 1.0124366315328786, 1.2, 1.1176470588235294, 1.0424433928136374, 1.6153846153846154, 1.0027874395549792, 1.0247757368645878, 1.3571428571428572, 1.16, 1.0721649484536082, 1.0119560019129603, 1.0211920529801324, 1.0616944382256053, 1.1563177005461813, 1.0, 1.04736041711927, 1.0945121951219512, 2.0, 1.0069675081868221, 1.10768232546068, 1.1617786187322612, 1.0228023814830145, 1.026887670405956, 1.0865384615384615, 1.7142857142857142, 1.0253510140405617, 1.0459677419354838, 1.1064429097449646, 1.1729264475743348, 1.0208634710591382, 1.050906253918277, 1.0476190476190477, 1.0993865030674848, 1.1839464882943145, 1.0847993626921428, 1.0858044164037854, 1.026268115942029, 1.043859649122807, 1.0368744432931596, 3.0, 1.1524563417729168, 1.033904750159298, 1.0335923205142823, 1.4615384615384615, 1.3252326065824191, 1.0669291338582678, 1.1428571428571428, 1.0798123721520774, 1.0420575865415722, 1.138646288209607, 1.088235294117647, 1.3333333333333333, 1.0696921412700269, 1.5, 1.1285046728971964, 1.0833333333333333, 1.070685925615798, 1.3846153846153846, 1.1350210970464134, 1.0188679245283019, 1.0, 1.5171957671957672, 1.2646815550041357, 1.25, 2.0, 1.1271186440677967, 1.2137931034482758, 1.005079175380938, 1.2002518891687657, 1.0702341137123745, 1.2094395280235988, 1.1014466214978942, 1.0571428571428572, 1.079295154185022, 1.2081632653061225, 1.0769230769230769, 1.0, 1.1544715447154472, 1.124098124098124, 1.012396694214876, 1.0016604400166045, 1.07775478498242, 1.010996362420036, 1.0581403966442355, 1.2129843840370156, 1.1321525885558583, 1.0089498806682577, 1.8333333333333333, 1.0, 1.2142857142857142, 1.0177202701677164, 1.0547219770520742, 1.107843137254902, 1.0304568527918783, 1.0281878140703518, 1.081546430535058, 1.0136460132690175, 1.1142857142857143, 1.2941176470588236, 1.0227100681302044, 1.043279427359491, 1.0925163923457781, 1.0357436206330084, 1.0526315789473684, 1.126550502067336, 1.0122647518235999, 1.1905487804878048, 1.3584521384928716, 1.125, 1.0831295843520783, 1.88135593220339, 1.1063829787234043, 1.0794117647058823, 1.0701001430615165, 1.0, 1.042857142857143, 1.0005013423035871, 1.0185185185185186, 1.089142566013103, 1.0095338983050848, 1.303030303030303, 1.0466124798701546, 1.0228911319394376, 1.0748388396454471, 1.0286259541984732, 1.0463182897862233, 1.1948821548821549, 1.1839323467230445, 1.2857142857142858, 1.0, 1.6666666666666667, 1.0712849703282064, 1.3333333333333333, 1.1213129632430796, 1.0806633999246136, 1.0329519450800915, 1.084607745779543, 1.0529826453378068, 1.0143622722400858, 1.003584229390681, 1.0416088765603329, 1.005147110620612, 1.100581177352831, 1.0468961710242384, 1.2628869083463807, 1.6666666666666667, 1.032258064516129, 1.0079681274900398, 1.0551665568997193, 1.003257328990228, 1.2864117168429618, 1.0928433268858802, 2.220779220779221, 1.0319314935285204, 1.0778523489932885, 1.0710526315789475, 1.125, 1.0813192761160662, 1.012104914846741, 1.3282722513089005, 1.0581052631578947, 1.2307692307692308, 1.1763224181360201, 1.1166666666666667, 1.8125, 1.055448717948718, 1.6153846153846154, 1.074756229685807, 1.091127098321343, 1.0676745860331174, 1.0481821390751853, 1.0059171597633136, 2.75, 1.032258064516129, 1.093293871098202, 1.0887604866937053, 1.0121778868004407, 1.0142684521543377, 1.0660040974674163, 1.0769230769230769, 1.0866209262435678, 1.164997724169322, 1.0245631689689874, 1.0450901803607215, 1.0069444444444444, 1.0249537892791127, 1.0352068003044912, 1.377, 1.0537588939346583, 1.0, 1.3333333333333333, 1.027857301787436, 1.0060872027180068, 1.2203993625199212, 1.108256880733945, 1.0518754988028731, 1.1306532663316582, 1.10645533311648, 1.0746887966804979, 1.1544117647058822, 1.010928961748634, 1.0280777537796977, 1.0764614931527021, 1.1071428571428572, 1.75, 1.0401114086309429, 1.1679684341596728, 1.01270207852194, 1.0113636363636365, 1.1745112237509052, 1.013424001127475, 1.1650267078999157, 1.3201320132013201, 1.2307692307692308, 1.028975741239892, 1.0485651214128036, 1.1375, 1.4827586206896552, 1.07981897418706, 1.182358771060456, 1.1674958540630183, 1.0975609756097562, 1.0280068211455513, 1.0343834037648867, 1.0694109772423026, 1.3295702119231532, 1.3333333333333333, 1.1666666666666667, 2.0, 1.1386276558690351, 1.4230769230769231, 1.0, 1.1538461538461537, 1.0272108843537415, 1.0471014492753623, 1.0014116998932616, 1.011680737255913, 1.1145454545454545, 1.3877551020408163, 1.1428571428571428, 1.1290322580645162, 1.0405405405405406, 1.1285714285714286, 1.1282952548330405, 1.0338538324902238, 1.0304812437386368, 1.3195876288659794, 1.0827161253701538, 1.0469045593313648, 2.5, 1.069434520771665, 1.2567324955116697, 1.5, 2.0, 1.2550295857988165, 1.118052069138636, 1.0795587497910748, 1.1521739130434783, 1.0, 1.0932203389830508, 1.2116564417177915, 3.0, 2.0, 1.0904212503353905, 1.2036564054308374, 1.0367362239160316, 1.6666666666666667, 1.0126244689547959, 1.0433772269558481, 1.025236593059937, 1.0, 1.051643192488263, 1.021311801822214, 1.1875, 1.1770720173813023, 1.005009355995634, 1.283987915407855, 1.07421875, 1.1143001857166976, 1.0684306569343065, 1.0826446280991735, 1.1896551724137931, 1.05936200405207, 1.3202002260616825, 1.0981673481308412, 1.3832335329341316, 1.1372549019607843, 1.2686567164179106, 1.1016483516483517, 1.0521091811414391, 1.0069450028141835, 1.03494922398927, 1.044759825327511, 1.5, 1.6666666666666667, 1.0438215176117114, 1.1983289357959543, 1.0945341373273683, 1.014218038561137, 1.0322796454256564, 1.0861036547594467, 1.2564102564102564, 1.0416666666666667, 1.1046301391400046, 1.0999773992726676, 1.2368804664723032, 1.115234375, 1.6666666666666667, 1.0714285714285714, 1.0233125610030782, 1.120782003213712, 1.008146319216192, 1.1053511268966598, 1.0411931818181819, 2.0, 1.0780856423173804, 1.0127151821259608, 1.1941969385423805, 1.0395256916996047, 1.0937753301864301, 1.0064102564102564, 1.1699779249448123, 1.0417391304347825, 1.032229032620963, 1.0671352807475376, 1.012672811059908, 1.0568335588633289, 1.0, 1.12798766383963, 1.0547582045890849, 1.0299319727891156, 1.0356706516402334, 1.1031307550644567, 1.040090771558245, 1.2857142857142858, 1.2493368700265253, 1.6666666666666667, 2.0, 1.1764705882352942, 1.0025641025641026, 1.0268562401263823, 1.0052635508436614, 1.0047614545642065, 1.058887381275441, 1.0526315789473684, 1.1956521739130435, 1.0, 1.0620243130817848, 1.6, 1.5833333333333333, 1.197896377093884, 1.1428571428571428, 1.0430555555555556, 1.1595310907237513, 1.136818386660658, 1.0764473876418172, 2.0, 1.0857585139318886, 1.2306201550387597, 1.147025171624714, 1.0391019936328523, 1.1477272727272727, 1.1205479452054794, 1.1414821730239175, 1.0911759525626725, 1.0345394736842106, 1.0597014925373134, 1.058659217877095, 1.0, 1.0, 1.0417635277708237, 5.0, 1.5714285714285714, 1.8620689655172413, 1.0012062726176116, 1.0561797752808988, 1.0715077605321508, 1.1176932130247155, 1.0, 1.0229671011793917, 1.014018691588785, 1.17989417989418, 1.2980769230769231, 1.4285714285714286, 1.0111626878868258, 1.0016629711751663, 1.1469933184855234, 1.0216565349544073, 1.0221764801115432, 1.0285740621255415, 1.1168293404318248, 1.0, 1.1988408004399882, 1.0297395357388113, 1.0863522238163559, 1.1774193548387097, 1.0923359580052494]
origin-bjaq_15.71 	max: 5.0000	99th: 2.5000	95th: 1.6690	median: 1.0820	mean: 1.1683

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 13.947628 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[ 8.9406967e-07  2.9802322e-07 -2.9802322e-08  5.9604645e-07
  9.5367432e-07]
Distance score: 5.424022901934222e-07
SAUCE Drift detection: False
Detection latency: 0.0237s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.019109 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 6.0000	99th: 3.0000	95th: 1.8643	median: 1.0827	mean: 1.1918
ReportEsts: [1.0555555555555556, 1.0091205211726384, 1.050630090116139, 1.075043630017452, 1.608695652173913, 1.0, 1.0906030855539972, 1.0574182104848246, 1.2, 1.0130151843817787, 1.1235169287161184, 1.0428165584415585, 1.078781122259383, 1.107750472589792, 1.058043606364172, 1.5, 1.1661237785016287, 1.2222222222222223, 1.1818181818181819, 1.0698835274542429, 1.1186596281845307, 1.0143528351676643, 1.0193581253183903, 1.0186282811176968, 1.0139501379201292, 1.0302623371222623, 2.0, 1.135864254197637, 1.5, 1.6, 1.0159651669085632, 1.0, 1.0522727947067028, 1.0094271415532607, 1.2288096340898564, 1.0694786030496803, 1.2192115682561542, 1.1367713004484306, 1.8, 1.0831300954637308, 1.0718911917098446, 1.0433800668739368, 1.0977353992848629, 1.148236415633937, 1.0314814814814814, 1.1327700880819702, 1.4210526315789473, 1.0661991584852735, 1.0909090909090908, 1.0094530722484807, 1.5, 1.1900826446280992, 1.0886075949367089, 1.096774193548387, 1.013617667989434, 1.0077239112571899, 1.0093314763231198, 1.1801075268817205, 1.0309278350515463, 1.0373518329274167, 1.5806451612903225, 1.1044354216991314, 1.0723076923076924, 1.037174721189591, 1.0490196078431373, 1.6363636363636365, 1.0822375612955617, 1.2554167728778995, 1.75, 2.0, 1.1000780031201247, 1.0333333333333334, 1.0746485700436257, 1.0191570881226053, 1.0815658801339543, 1.061812665908229, 1.0232140915515928, 1.506578947368421, 1.3980582524271845, 1.0720427948076607, 1.000491883915396, 1.126865671641791, 1.0, 2.5, 1.0587570621468927, 1.2758620689655173, 1.03831891223733, 4.0, 1.1428571428571428, 1.110163388756421, 1.116447666515632, 1.2894601835489938, 1.090245214851257, 1.071680922275939, 1.061662198391421, 1.0202140309155767, 1.72, 1.0601915184678523, 1.2272727272727273, 1.3490338164251208, 1.0, 1.5, 1.0565727619566698, 1.2240932642487046, 1.0647948164146868, 1.2529141386284244, 1.3870967741935485, 1.0275921133961217, 1.0819960430863926, 1.161525295545914, 1.146889031430404, 1.054178379759775, 1.125, 1.5, 1.0579008520526723, 1.0484756192866425, 1.0832025117739403, 1.06, 1.0601849666105367, 1.0, 1.1076197957580518, 1.1479452054794521, 1.0, 1.033175355450237, 1.1428571428571428, 1.1987704918032787, 1.0248143639145264, 1.089059179599459, 1.007936507936508, 1.5, 1.1867305061559508, 2.0, 1.5, 1.1110498253355396, 1.0769230769230769, 1.1634731572587607, 1.0136887687860632, 1.0591425709054478, 2.0, 1.4285714285714286, 1.006060606060606, 1.0508021390374331, 1.079673135852911, 1.0342205056179776, 1.2258064516129032, 1.0118406889128095, 1.1202837859814605, 1.5, 1.0162019593067069, 1.0132827324478177, 1.1132075471698113, 1.0903358263675025, 2.5, 1.088787417554541, 1.0089171974522293, 1.0202702702702702, 1.0768307322929171, 1.0, 1.006125574272588, 1.0808370150992863, 1.0823199251637043, 1.0180032733224222, 1.0842391304347827, 1.293103448275862, 1.3688524590163935, 1.0296296296296297, 1.2, 1.068710506906931, 1.44, 1.2415902140672783, 1.1100496472432715, 1.0652227418163918, 1.0077076910257479, 1.3051724137931036, 1.1317365269461077, 1.0794962297449062, 1.188034188034188, 1.0218818380743981, 1.0456730769230769, 1.0450970110120608, 1.1267270128632683, 1.2192535606611914, 1.1785714285714286, 1.1777777777777778, 1.018684800962228, 1.1048165034081163, 1.2656826568265682, 1.0515588013772326, 1.0071428571428571, 2.0, 1.2590529247910864, 1.0899852061490962, 1.2, 1.1479410269445858, 1.0221946713341112, 1.0718131344288038, 1.0669401148482363, 1.087512291052114, 1.051642088456802, 1.5521360599311602, 1.0089358245329, 1.17313408853539, 1.0140175813732477, 1.0776979575410002, 1.076163610719323, 1.0376396095330227, 1.0348258706467661, 1.1142857142857143, 1.1046511627906976, 2.0, 1.3840579710144927, 1.1653440020987735, 1.4147058823529413, 1.209090909090909, 1.0081833060556464, 2.1538461538461537, 1.0442056548979246, 1.034324942791762, 1.2119881874052199, 2.0, 1.034739454094293, 1.0124022647613913, 1.0273508975447576, 1.0056768056461203, 1.2, 1.1653333333333333, 1.085822120118149, 1.011144544745347, 1.0668449197860963, 1.0321489001692048, 1.0190689848569827, 1.0671782532353515, 1.456140350877193, 1.004594614195112, 1.0406774535006804, 1.0823170731707317, 1.1256085686465434, 1.0518018018018018, 2.4, 1.167535853976532, 2.0, 1.2546844181459567, 1.0525877233589482, 1.0542261675028946, 1.0635451505016722, 1.0769230769230769, 1.0, 1.1248346998148637, 1.1044776119402986, 1.0671599154430669, 1.4, 1.1179189028026237, 1.0514705882352942, 1.0, 1.0210961493030948, 1.0045045045045045, 1.1186291739894552, 1.0564971751412429, 1.0112162635821942, 1.1125785150587857, 1.044776119402985, 2.0, 1.1066826490860053, 1.179349287442861, 1.0919540229885059, 1.0134788983694596, 1.123690927741597, 1.0094920118098287, 1.0821192052980133, 1.1022830781888167, 1.0163366336633664, 1.1144741948001553, 1.0827831386490605, 1.5454545454545454, 1.0661143773383217, 1.1285140562248996, 1.1228070175438596, 1.4285714285714286, 1.0853840417598808, 1.032319391634981, 1.0639567780677899, 1.00423833574683, 1.1081677704194262, 1.3668763102725368, 1.0323826217603607, 1.0027567195037905, 1.1446511627906977, 1.06825535532935, 1.2222222222222223, 1.144638403990025, 1.0268336314847943, 1.03618291143113, 1.2224427682942967, 1.0483998981685312, 1.2728243459690336, 1.1704863051984349, 1.0107962213225372, 1.0696490394406355, 1.0828686409326331, 1.0291599605069182, 1.0473484848484849, 1.1111111111111112, 1.1538461538461537, 1.0866366366366367, 1.5, 1.0161290322580645, 1.0152366210506154, 1.0573501468301951, 1.5277777777777777, 1.0390625, 1.008627450980392, 1.0114464099895941, 1.0748502994011977, 1.0, 1.1864936870149427, 1.011736972457901, 1.032258064516129, 1.6, 3.125, 1.03300841825432, 1.4285714285714286, 1.0086478846092068, 1.0388802488335926, 1.0416666666666667, 1.087584840340728, 1.0344827586206897, 1.3076923076923077, 1.0003835489183217, 2.0, 1.0344827586206897, 1.0675675675675675, 1.0021119324181627, 1.0006508298080052, 1.1722365038560412, 1.105263157894737, 1.1150091759646021, 1.075394893432868, 1.1095262353540498, 1.0504116774512544, 1.091305998481397, 3.0, 1.0, 1.0400996785177576, 1.2, 1.062267657992565, 1.4210526315789473, 1.3333333333333333, 1.3888888888888888, 1.3005733005733007, 1.0552922590837284, 1.0935251798561152, 1.0013227513227514, 1.2289156626506024, 2.0, 1.0627262898977659, 1.6428571428571428, 1.1875, 1.0354104952881984, 1.0505836575875487, 1.030665669409125, 1.0009380863039399, 1.4, 1.75, 1.3079416531604537, 1.4537037037037037, 1.085561497326203, 1.1265819795995466, 1.267605633802817, 1.017156862745098, 1.5, 1.029383861429935, 1.0732758620689655, 1.5769230769230769, 3.0, 1.0666666666666667, 1.2857142857142858, 1.4792122538293218, 1.1826923076923077, 1.1002231831496723, 1.1146889329757934, 1.5084745762711864, 1.03649076805419, 1.106275033377837, 1.043956043956044, 1.0921248142644873, 1.1111216766193754, 1.105351170568562, 1.125, 1.002780242811019, 1.0647120022699328, 1.002288275536683, 1.0242718446601942, 1.0454545454545454, 1.1885593220338984, 3.0, 1.0, 1.5384615384615385, 1.243614931237721, 1.3467336683417086, 1.0593047034764826, 1.105927552140505, 1.1938775510204083, 1.0142169817030118, 1.1075350246118894, 1.0860985457967758, 1.096774193548387, 1.2980769230769231, 1.1278772378516624, 1.0, 1.2405570439022036, 1.7083333333333333, 1.1081418675952912, 1.0286695889112665, 1.1348999910305857, 1.151547209732875, 2.25, 1.233695652173913, 1.5, 1.0590461771385313, 1.0, 1.0903954802259888, 1.0382244143033292, 1.0625724217844728, 1.0921052631578947, 1.0571630204657727, 3.0, 1.1438528017842209, 1.0257103318164384, 1.1009848906636972, 3.0, 1.0694444444444444, 1.2860576923076923, 1.3205128205128205, 1.1236340711683945, 1.0807323562951388, 1.1304347826086956, 1.2282370153621067, 1.0083228147680656, 1.0435773098577799, 1.013094782862666, 1.0596912868955213, 1.019330341732827, 1.0909090909090908, 1.0259379342288097, 1.0691439840629473, 1.0161290322580645, 1.1333699231613612, 1.0, 1.5, 1.1822398939695162, 1.1330645161290323, 1.0179930795847751, 1.1101286288649468, 1.0552178318135765, 1.0, 1.032258064516129, 1.1666666666666667, 2.6666666666666665, 1.0434782608695652, 1.0, 1.1151512552794631, 1.0, 1.0, 1.016583108368685, 2.0, 1.0025931928687195, 1.041127189642041, 1.0134408602150538, 1.3, 1.0692205979578344, 1.0737564322469983, 1.5, 1.0184812672868997, 1.069767441860465, 1.1232123212321232, 1.0313351498637602, 1.2344900105152472, 1.0089710018426923, 1.0, 1.0588235294117647, 1.0679851668726823, 1.130211893369788, 1.0543130990415335, 1.25, 1.123624358033749, 1.002732847676668, 1.0169565217391305, 2.0, 1.0619793402199267, 1.0278123073502512, 1.0364529851840987, 1.0078091106290672, 1.015584033536193, 1.025950549627211, 1.0006915629322268, 1.0240701890174353, 2.0, 1.058037830152096, 1.062857142857143, 1.0197149643705463, 1.0038567493112949, 1.125, 1.0015136839108594, 1.3116206357477853, 1.0629121908817596, 1.232033639143731, 1.0984596362887022, 1.1463878326996197, 1.112372106883878, 1.0039153678186883, 1.0454545454545454, 1.457142857142857, 1.1492685094094126, 1.0658436213991769, 1.0037920682572286, 1.0650910016418722, 1.0, 1.2026615969581749, 1.5730659025787965, 1.0, 1.0727272727272728, 1.0081343670927139, 1.1062271062271063, 1.0091827364554637, 1.0, 1.1666666666666667, 1.0050022737608004, 1.1133666564657079, 1.0456663560111836, 1.0207873412875645, 1.1145426114151682, 1.1368778280542986, 1.0232205956587581, 1.0108666607286008, 1.5056179775280898, 1.0253395704472694, 1.075, 1.1761658031088082, 1.1250985218269058, 1.2142857142857142, 1.0028200571737618, 2.0, 1.1700632466619818, 1.0397350993377483, 1.0344219475269103, 1.124716553287982, 1.0691333982473223, 1.1431159420289856, 1.072790294627383, 1.1278012377952051, 1.0, 1.7307692307692308, 1.0, 1.3333333333333333, 1.158878504672897, 1.3775055679287305, 1.0116429495472186, 1.1260504201680672, 1.0695838351398368, 1.0866807610993658, 1.0892477292135703, 1.179652097646543, 1.1031798895935034, 1.0767178300377769, 1.0158320549051272, 1.1070640176600441, 1.0571015888300432, 1.0516587112920324, 1.0694100148735746, 1.0620915032679739, 1.167741935483871, 1.0, 1.0247278319640616, 1.1118721461187215, 1.105211386752179, 1.432748538011696, 1.1046455938697317, 1.0948782535684298, 2.0, 1.0023337222870479, 1.3333333333333333, 1.25, 1.5411255411255411, 1.0392834670747528, 1.0283476314807907, 1.060846560846561, 1.1444444444444444, 1.1156934803321084, 1.0042652643879637, 1.014362657091562, 1.2, 2.0, 1.0817981693894103, 1.2083333333333333, 1.0409145607701564, 1.1373289287399717, 2.0, 1.4292389853137517, 1.1053763440860216, 1.0874173752810508, 1.1485884101040118, 1.0514768761979654, 1.0138377406362775, 1.0008285697109416, 1.3369565217391304, 2.0, 1.182516083689247, 1.0, 1.0815347721822541, 1.1319148936170214, 1.2313588850174215, 1.0043516100957355, 2.2, 1.2206519690974185, 1.1063829787234043, 1.338918507235339, 1.0574866310160427, 1.1088216355441083, 1.111467008327995, 1.002730953950466, 1.003616636528029, 1.0583333333333333, 1.4, 1.0373835465024475, 1.0634719896093243, 1.0952380952380953, 1.0378416257883671, 1.2579494496534855, 1.005912162162162, 1.0246560463432295, 1.2, 1.2014388489208634, 1.0006847974955977, 1.009478672985782, 1.112994350282486, 1.0573013920477172, 1.0461538461538462, 1.4, 1.0517980864401189, 1.0198358413132695, 1.0812948317086628, 1.1705577172503243, 1.0197168460889856, 1.001931751788318, 1.3358547655068078, 1.1565784704603117, 1.2840909090909092, 1.0402903723712136, 1.1071620893914917, 1.031080031080031, 1.0697126707489402, 1.0075727695827088, 1.1649484536082475, 1.0334896182183524, 1.3157894736842106, 1.6, 1.1041666666666667, 1.5952312553863832, 1.0312117503059977, 1.1468064823641564, 1.1666666666666667, 1.0121457489878543, 1.0378732702112163, 1.108433734939759, 1.0840539392361348, 3.3333333333333335, 1.0762586741473499, 2.0, 1.0118343195266273, 1.1428571428571428, 1.0538040949278735, 1.3870967741935485, 1.2310469314079422, 1.049222797927461, 1.0, 1.4508108108108109, 1.247450713800136, 1.2, 2.5, 1.119718309859155, 1.188953488372093, 1.0, 1.1854166666666666, 1.0957910014513788, 1.0122759636631475, 1.0909090909090908, 1.091764705882353, 1.155378486055777, 1.1168384879725086, 1.096774193548387, 1.5, 1.0143824027072759, 1.046875, 1.0406926406926407, 1.0769230769230769, 1.0593993566745021, 1.0766997878754048, 1.070140231063249, 1.2345857418111754, 1.1823461091753775, 1.0093827160493827, 1.7142857142857142, 1.0, 1.1818181818181819, 1.0167927650275985, 1.0917293233082708, 1.102981029810298, 1.122969837587007, 1.012454953531011, 1.0429109684621825, 1.0049127947038796, 1.058139534883721, 1.2380952380952381, 1.0907821229050279, 1.0553229005951068, 1.0495042863467448, 1.014091789140192, 1.05, 1.0835683629675046, 1.0204045104707355, 1.0620732034868106, 1.0406203840472674, 1.0599397708162228, 1.0608108108108107, 1.1004473363155753, 1.0110132158590308, 1.0269152387039202, 2.0, 1.031858407079646, 2.0, 1.0829875518672198, 1.0254191604351253, 1.078125, 1.0771556439582297, 1.0154826958105647, 1.358974358974359, 1.0282128087395446, 1.0241442634795437, 1.077763730861076, 1.0300157977883095, 1.0386904761904763, 1.1961109860423234, 1.2677902621722847, 1.1666666666666667, 1.0, 1.3333333333333333, 1.0699107178927807, 1.25, 1.1006814473557922, 1.097458102438696, 1.064366536820627, 1.0851839575737487, 1.0637680273771695, 1.0745374921798194, 1.0215384615384615, 1.0372093023255815, 1.0274770893710348, 1.1603679809772545, 1.040778814644776, 1.217610726122326, 1.7142857142857142, 1.0507425742574257, 1.060200668896321, 1.1028777497295348, 1.0584958217270195, 1.3322460391425908, 1.0453125, 2.246376811594203, 1.077030308186679, 1.0696629213483146, 1.0283895011658728, 1.0476190476190477, 1.0687302738625002, 1.0148450878833406, 1.25713104588673, 1.0527234636871508, 1.3214285714285714, 1.0067829457364341, 1.1249939110526572, 1.0641391761037255, 1.0471698113207548, 1.0173200461410732, 1.55, 1.0638886810802723, 1.0777005685407455, 1.018987341772152, 1.0575, 1.028624192059095, 1.0, 1.0787083753784057, 1.0038566198782326, 1.083657587548638, 1.0019276444872809, 1.046466968403318, 1.125, 1.099060014461316, 1.1360707052108268, 1.1065794536360138, 1.1854684512428297, 1.0496124031007752, 1.2522522522522523, 1.1140472878998608, 1.0687418936446174, 1.041290766785132, 1.0208333333333333, 1.096699478865084, 1.2453555672481482, 1.0454349698535745, 1.1396160558464223, 1.168430698739977, 1.1356778498666955, 1.023380093520374, 1.1292372881355932, 1.1110489418424776, 1.0906746412795962, 1.1470137825421134, 1.0700934579439252, 1.0162748643761301, 1.0762762087709976, 1.15625, 2.0, 1.040908071245906, 1.1618466828750655, 1.0611111111111111, 1.029126213592233, 1.1829378191649145, 1.0195369927555484, 1.1522499417113545, 1.0502544529262086, 1.088235294117647, 1.0684624017957352, 1.2216494845360826, 1.1447721179624666, 1.7096774193548387, 1.053328117869483, 1.1772875816993464, 1.1486988847583643, 1.1020408163265305, 1.224770642201835, 1.2276470588235293, 1.06, 1.0, 1.0315594059405941, 1.0040322580645162, 1.112870275791624, 1.0833333333333333, 1.016908462509572, 1.0585987261146497, 1.0151712694085575, 1.3302752293577982, 1.5555555555555556, 1.3097936646323742, 1.0137854057344968, 1.040807317174114, 1.0585585585585586, 1.0909090909090908, 1.0625, 1.0, 1.0319148936170213, 1.064102564102564, 1.0101363159734358, 1.033515277699623, 1.0301258256244148, 1.2413793103448276, 1.06705260278968, 1.047875713379835, 4.0, 1.0007024662260204, 1.0795834065740904, 1.5, 2.25, 1.1636138613861386, 1.1348147265578459, 1.0669855444431482, 1.2403100775193798, 1.5, 1.1342756183745584, 1.362962962962963, 1.5, 1.0572339526782666, 1.1136269956857465, 1.0272526377004236, 1.0288993218570683, 1.7142857142857142, 1.0207595805872454, 1.0687376074025117, 1.0262237762237763, 1.2724252491694352, 1.0151869158878504, 1.0, 1.2959183673469388, 1.149381046499532, 1.0290567436463554, 1.434782608695652, 1.0677966101694916, 1.0956995607687177, 1.0865900383141762, 1.1027397260273972, 1.1971830985915493, 1.046948677180077, 1.461297071129707, 1.0965508841023974, 1.271356783919598, 1.2333333333333334, 1.1419156414762741, 1.0, 1.0826928988625883, 1.0798969072164948, 1.0162688467003473, 1.0970081595648231, 3.0, 1.1395690499510285, 1.0330598455598456, 1.1406078359575247, 1.1082180634662326, 1.008192820937209, 1.0426922542066472, 1.1089346110484781, 1.0637065637065637, 1.1071428571428572, 1.1220279033208882, 1.1193210996610634, 1.230442692540934, 1.1637931034482758, 2.0, 1.0224719101123596, 1.0041695861427309, 1.0196969696969698, 1.0128850730373273, 1.1022554540585143, 1.001763668430335, 2.5, 1.1351648351648351, 1.0419583763724702, 1.2067647620867572, 1.0389610389610389, 1.0755664506396452, 1.1093333333333333, 1.2357875116495807, 1.0335802469135802, 1.031638547879528, 1.166272155187345, 1.072336265884653, 1.0563063063063063, 1.0526315789473684, 1.1397927796665048, 1.3271604938271604, 1.0222961571143052, 1.057546627031692, 1.1321052631578947, 1.0284629981024669, 1.3333333333333333, 1.2422907488986785, 1.6666666666666667, 2.5, 1.1428571428571428, 1.0127388535031847, 1.0182291666666667, 1.0208531406477783, 1.001833566393653, 1.1403429602888087, 1.0248836376655925, 1.1121076233183858, 1.0230263157894737, 1.0588812274853017, 1.5, 1.2941176470588236, 1.0597230236583959, 1.6666666666666667, 1.0518433179723503, 1.1117021276595744, 1.0585365853658537, 1.1041828747708315, 2.0, 1.1098680436029833, 1.0862068965517242, 1.06473439133327, 1.0404138500596458, 1.2075078206465069, 1.1135012737050665, 1.139278241709408, 1.1604726212783676, 1.0409511228533685, 1.0789473684210527, 1.1200466200466201, 1.0, 2.0, 1.0420071315992443, 6.0, 1.8571428571428572, 2.4814814814814814, 1.0213197969543146, 1.0267295597484276, 1.0912653975363942, 1.0075471698113208, 1.3333333333333333, 1.0645989471227406, 1.0310804144055254, 1.017274472168906, 1.2794411177644711]
origin-bjaq_15.71 	max: 6.0000	99th: 3.0000	95th: 1.8643	median: 1.0827	mean: 1.1918

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.103592 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.097663