Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 24, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.6700	95th: 1.7150	median: 1.0790	mean: 1.1747
ReportEsts: [1.0158730158730158, 1.0223958333333334, 1.042084400271979, 1.0970464135021096, 1.5, 1.0, 1.0349962769918093, 1.082706366497216, 1.0, 1.0183006535947712, 1.1880933829682856, 1.042412525012168, 1.0214195716085679, 1.172093023255814, 1.068880254327093, 1.0, 1.0465116279069768, 1.0007089684509038, 3.0, 2.0, 1.08, 1.0713460560972228, 1.086406362979031, 1.1015854374633, 1.0310804144055254, 1.0, 1.1011378871738458, 2.0, 1.2, 1.0215827338129497, 1.0, 1.0400504808432236, 1.009319177205846, 1.1170921198668147, 1.0393596710236452, 1.224285122254455, 1.1310160427807487, 1.0154450816883072, 1.1168468902817, 1.0120481927710843, 1.1676646706586826, 1.1067073170731707, 1.0, 1.0744298796911473, 1.0906796769851952, 1.8615384615384616, 1.0618556701030928, 1.226148409893993, 1.0271396625330351, 1.1388888888888888, 1.0756513740072295, 1.0532646048109966, 1.0399078442279035, 2.0, 1.431168831168831, 1.1226368683674186, 1.0552570990023025, 1.3592233009708738, 1.0372670807453417, 1.25, 1.1061432206470374, 1.1039850560398505, 1.0454545454545454, 1.0235294117647058, 1.0, 1.0785455631463023, 1.3144147049338923, 1.75, 1.0, 1.0950871632329635, 1.0567465321563683, 1.0566146735990756, 1.0160183066361557, 1.1390428946600526, 1.068235294117647, 1.0444874274661509, 1.0, 1.113152400835073, 2.6666666666666665, 1.0008178139975321, 1.0666666666666667, 1.045862848037022, 1.1288343558282208, 1.1222651222651223, 1.131992149165849, 1.0, 1.078782208708533, 1.0655890813543702, 1.053921568627451, 1.75, 1.1705790297339593, 1.0797360170812478, 1.1370716510903427, 1.0, 1.040874524714829, 1.051948051948052, 1.08, 1.163853028798411, 1.0, 1.2371122640468042, 1.0446750902527075, 1.0737564322469983, 1.2327736210196625, 1.4166666666666667, 1.0236681928021292, 1.0164587204672153, 1.1948504168710152, 1.081911262798635, 1.0545677498467199, 1.3333333333333333, 1.3333333333333333, 1.0455607476635513, 1.0820725503207256, 1.0682248894504107, 1.0389610389610389, 1.0625173501577287, 1.0, 1.1365499842321034, 1.1272923408845739, 1.0, 1.011111111111111, 1.1666666666666667, 1.1904761904761905, 1.0183087083093096, 1.1159431544614429, 1.12, 1.8, 1.1548013245033113, 1.0, 1.0357142857142858, 1.099804725439879, 1.3, 1.1075846354166667, 1.0246063795713038, 1.0281848928974069, 1.0467289719626167, 1.140625, 1.0581443298969073, 1.039972432804962, 1.0780012187690433, 1.014128184614877, 1.1571428571428573, 1.0006527415143602, 1.1468157865913766, 2.0, 1.01640838650866, 1.0057471264367817, 1.1025991792065664, 1.096347273689783, 1.5, 1.3998546863647372, 1.002962962962963, 1.016260162601626, 1.1074561403508771, 1.0538461538461539, 1.1512137559002023, 1.1795544724591496, 1.2283577956244807, 1.0134874759152215, 1.0526315789473684, 1.3265306122448979, 1.4526315789473685, 1.0073637702503682, 1.4285714285714286, 1.0761136139150547, 1.0221275038315198, 1.2045769764216365, 1.3620890877261234, 1.1143635125936011, 1.0586520367867271, 1.2905263157894737, 1.127962085308057, 1.068751815628934, 1.0333670374115267, 1.0327868852459017, 1.0748299319727892, 1.0525980235894166, 1.0804973000125582, 1.0442557206888416, 1.0, 1.2698412698412698, 1.0803476139655435, 1.0285087719298245, 1.1507024265644956, 1.0657894736842106, 1.0783292682926828, 1.3290409379204304, 1.1359435534489102, 1.1372549019607843, 1.1868181818181818, 1.0755161441503662, 1.0, 1.1, 1.02255760461644, 1.0280046674445742, 1.0343347639484979, 1.25, 1.0527331189710611, 1.0468304413283527, 1.0757112547015142, 1.0626410835214446, 1.0473614484433649, 1.2598870056497176, 1.0491803278688525, 1.1666666666666667, 1.0, 1.4414414414414414, 1.090600851600694, 1.3414634146341464, 1.2758620689655173, 1.0113692535837864, 1.0031277926720286, 1.016067263168889, 1.015314615469981, 1.3014115459386357, 1.1, 1.111271676300578, 1.0152300712896953, 1.045436268596703, 1.023329462683416, 1.0, 1.034368530020704, 1.1018060780336005, 1.011863373073982, 1.1399026763990268, 1.0097461823109397, 1.282282119420793, 1.0357142857142858, 1.00655324582547, 1.1285456420835482, 1.0219966159052454, 1.0158730158730158, 1.0828840970350404, 1.0313346228239846, 1.18503937007874, 2.0, 1.2313063718359034, 1.0646493970522555, 1.0902484763244258, 1.0634920634920635, 1.0, 1.6666666666666667, 1.1053973725400539, 1.1272727272727272, 1.1095924541733404, 1.5, 1.0, 1.0256410256410255, 1.0156128024980484, 1.0714285714285714, 1.0607734806629834, 1.1160337552742616, 1.061328790459966, 1.0079764903442485, 1.1505197344224851, 1.0701754385964912, 2.0, 1.112999403697078, 1.1190110565110565, 1.094570928196147, 1.0250492843061627, 1.0978697300914566, 1.0229858058454415, 1.0977742448330683, 1.0864919106385227, 1.0089712918660287, 1.0485281259108132, 1.0719636497605305, 1.0, 1.01037862771478, 1.0732265446224256, 1.2272727272727273, 1.3888888888888888, 1.0112727272727273, 1.0555555555555556, 1.0085470085470085, 1.1557768656214251, 1.0974930362116992, 1.3458646616541354, 1.0304195510551764, 1.0218120805369129, 1.0210506436262954, 1.0615280633078938, 1.25, 1.0674245180065478, 2.5, 1.0167328094474668, 1.0215982721382288, 1.033084520504301, 1.0526315789473684, 1.4285714285714286, 1.2608695652173914, 1.0757575757575757, 1.0856168449938652, 1.0, 1.0186915887850467, 1.0248868778280542, 1.0084134615384615, 1.0191150504158728, 1.08, 1.1572327044025157, 1.0162427706942367, 1.1487162820929477, 1.0350165562913907, 1.0512820512820513, 1.0, 1.1085918854415275, 1.2971246006389776, 1.1672727272727272, 1.1125105307497893, 1.0333611342785656, 1.0790273556231003, 1.2291666666666667, 1.0041152263374487, 1.009375, 1.2857142857142858, 1.006028569340089, 1.0419847328244274, 1.1176470588235294, 1.09944176882662, 1.3333333333333333, 1.4, 1.0174264037701557, 2.0, 1.1810699588477367, 1.068313953488372, 1.0713699753896637, 1.0989193682460516, 1.1364985163204748, 1.058139534883721, 1.0970657070577254, 1.069253426158078, 1.050071530758226, 1.0247544303372014, 1.0305420131918555, 2.0, 1.0, 1.0615416257227084, 1.25, 1.067966573816156, 1.3529411764705883, 1.0, 1.4666666666666666, 1.3263052208835342, 1.0729857819905213, 1.1120689655172413, 1.0087336244541485, 1.0, 1.1271637816245006, 1.080733847239419, 2.0, 1.2084574151280525, 1.0, 1.0946633265011767, 1.0348837209302326, 1.005589084229861, 1.1497695852534562, 1.1363636363636365, 1.4898477157360406, 1.2962962962962963, 1.0266386909748737, 1.0178062678062678, 1.0547752808988764, 1.0, 1.0769230769230769, 1.5714285714285714, 3.0, 1.3333333333333333, 1.069767601429934, 1.3333333333333333, 1.0169204737732656, 1.160919540229885, 1.2298223745715176, 1.0923993129125358, 1.250257466529351, 1.0003188022481462, 1.0104408352668213, 1.069047619047619, 1.5, 1.2467532467532467, 1.0723404255319149, 1.0512421662890155, 1.0952380952380953, 1.5714285714285714, 1.0334075723830736, 1.0005813953488372, 1.0154672981070596, 1.0303030303030303, 1.1464387464387464, 1.0238030095759234, 1.0, 1.0907770515613653, 1.090042372881356, 1.2307692307692308, 1.028328611898017, 1.128440366972477, 1.068308092834238, 1.079660747789979, 1.011230551149212, 1.075, 1.1935483870967742, 1.0948012232415902, 1.0, 1.0286363812500807, 1.0332574634766039, 1.0755856249090645, 1.0657195821895833, 1.061618109836565, 1.140451223387353, 1.8333333333333333, 1.1175202156334232, 1.0, 1.2040990606319386, 1.25, 1.0325298569000432, 1.0304347826086957, 1.1277944969905418, 1.1304347826086956, 1.0595238095238095, 3.0, 1.4084158415841583, 1.0154157415476714, 1.1286095273128565, 2.0, 1.1111111111111112, 1.2370441458733206, 1.3488372093023255, 1.0895934959349594, 1.1425178147268409, 1.2352941176470589, 1.2502157031924073, 1.026288647429901, 1.0600850727074884, 1.1040108042984007, 1.0804824561403508, 1.1293532338308458, 1.1931818181818181, 2.142857142857143, 1.0794520547945206, 1.5, 1.2237061769616027, 1.0909090909090908, 1.1517197669599981, 1.4705882352941178, 1.0716346010883464, 1.1605114368695115, 1.0771128932757557, 1.0, 1.1515151515151516, 1.24, 1.2836663336663336, 1.3610503282275712, 1.0, 1.0605139541309754, 1.1286225639665914, 1.0721094073767095, 1.5, 2.0, 1.010200078462142, 1.011786038077969, 1.0166666666666666, 1.1111111111111112, 1.078932384341637, 1.1089005235602094, 1.4705882352941178, 1.0470433145009417, 1.0454545454545454, 1.1089238845144358, 1.0620967741935483, 1.2801851072780817, 1.0713363261792017, 1.0, 1.0571428571428572, 1.0709528913566797, 1.023288933899304, 1.0131195099024344, 1.0, 1.1167883211678833, 1.0121286941789491, 1.0220010476689365, 2.0, 1.049043062200957, 1.024909830034138, 1.0039606301539916, 1.0531649993447207, 1.0127352072113331, 1.02705727772641, 1.0303030303030303, 1.2319189971070394, 2.0, 1.0728203007907386, 1.9473684210526316, 1.25, 1.1968911917098446, 1.1346153846153846, 1.0065989570879008, 1.0908248378127896, 1.0281935126249593, 1.1778378378378378, 1.0596623738667366, 1.0761531178141486, 1.0509495243709328, 1.1573033707865168, 4.0, 1.0033993518185091, 1.1599190283400809, 1.0460649862267113, 1.0561139831768351, 1.1118721461187215, 1.1745673438675697, 2.6125, 2.2857142857142856, 1.0024283395770541, 1.034728644167883, 1.0287898379858522, 1.1230202578268877, 1.086555148476668, 1.0167714884696017, 1.0727604166666667, 1.0005396654074474, 1.2039877300613497, 2.0, 1.0, 1.0383435582822085, 1.107843137254902, 1.0681003584229392, 1.0473225404732254, 1.0220440881763526, 1.2922077922077921, 1.148905109489051, 1.116564417177914, 1.0660149019980067, 1.2988505747126438, 1.0067289777189228, 2.0, 1.1609674728940784, 1.024390243902439, 1.036764705882353, 1.0874301675977653, 1.1425, 1.001980198019802, 1.0700389105058365, 1.0991282559899775, 1.0, 1.2553191489361701, 1.2, 1.0, 1.1590909090909092, 1.1794354838709677, 1.0728476821192052, 1.116504854368932, 1.0637616148670297, 1.0440835266821347, 1.107481599514379, 1.1782063197026023, 1.0346420323325636, 1.0783231404526685, 1.1405405405405404, 1.0952689565780946, 1.0483792936623126, 1.0984766050054406, 1.1358381502890174, 1.0951255539143279, 1.0385141640906097, 1.16259146885597, 1.0780978908730392, 2.0, 1.1744471744471745, 1.083083083083083, 1.4339622641509433, 1.0, 1.186046511627907, 1.25, 1.1697722567287785, 1.3333333333333333, 1.1666666666666667, 1.0077535303737, 1.1246802046690119, 1.02373962078688, 1.0396264908976773, 1.2432432432432432, 1.1002673796791445, 1.0, 1.1159420289855073, 1.0423436376707405, 1.0613329083326692, 1.0859369563704684, 1.067604510764324, 1.0276338514680483, 1.1454545454545455, 1.0896603497950736, 1.1403197158081706, 1.0206740363701594, 1.108529904553926, 1.3333333333333333, 1.0172064777327936, 1.0, 1.2422535211267605, 1.2082888140050958, 3.0, 1.0704932343954605, 1.0444429396894186, 1.4285714285714286, 1.0187529817607985, 1.2, 1.1176470588235294, 1.0540145113612613, 1.6153846153846154, 1.041236116650351, 1.0580948312686886, 1.3571428571428572, 1.2083333333333333, 1.1381443298969072, 1.0353897656623625, 1.0094922737306844, 1.0884291288238959, 1.1580845277022278, 1.0, 1.0454051705409515, 1.125, 2.0, 1.0294531448209054, 1.0473656890734493, 1.141911069063387, 1.0162150975834952, 1.0083479463558003, 1.018018018018018, 1.7142857142857142, 1.0243438569798402, 1.0362903225806452, 1.1353231635925543, 1.1539645881447267, 1.00126218236518, 1.0308586076707673, 1.054054054054054, 1.0904665314401623, 1.1906354515050168, 1.0886296740433883, 1.1066246056782334, 1.015639374425023, 1.0595436839176404, 1.0263610108952848, 3.0, 1.1382361278963937, 1.0382047286349705, 1.034232472224486, 1.5833333333333333, 1.3338425218719623, 1.456989247311828, 1.1428571428571428, 1.084785215489878, 1.0420575865415722, 1.1331877729257642, 1.088235294117647, 1.3333333333333333, 1.0345385784469656, 1.5, 1.0397196261682242, 1.0833333333333333, 1.006779303804138, 1.3846153846153846, 1.1983122362869199, 1.0681341719077568, 1.0, 1.6111111111111112, 1.219298245614035, 1.25, 2.0, 1.0725806451612903, 1.2379310344827585, 1.095408661673722, 1.2032828282828283, 1.0921501706484642, 1.2094395280235988, 1.1014466214978942, 1.0545454545454545, 1.225, 1.2489795918367348, 1.0384615384615385, 1.0, 1.143843498273878, 1.0360750360750361, 1.0168067226890756, 1.0753119429590017, 1.09436432613333, 1.0390168442763836, 1.0639062638958883, 1.167943898207056, 1.2329376854599408, 1.0250764525993883, 1.8333333333333333, 1.0, 1.2142857142857142, 1.0508461713591866, 1.0414827890556047, 1.107843137254902, 1.0, 1.0168003054600994, 1.064435742257031, 1.0151297588027406, 1.0985915492957747, 1.2222222222222223, 1.0360429447852761, 1.0370493107104983, 1.0831315710921694, 1.0591899875404236, 1.0, 1.1086089781453041, 1.0116050712000122, 1.1384839650145773, 1.3355397148676171, 1.125, 1.0726392251815982, 1.727626459143969, 1.1555555555555554, 1.0545977011494252, 1.0701001430615165, 1.0, 1.0159817351598173, 1.0108839796875506, 1.0188679245283019, 1.0972623568090814, 1.0477247502774696, 1.2647058823529411, 1.0538418324353311, 1.0181326604181686, 1.0426067687348912, 1.058206106870229, 1.0522133938706015, 1.1964532551161458, 1.1740041928721174, 1.4285714285714286, 1.0, 1.6666666666666667, 1.0636308586653749, 1.3333333333333333, 1.05608319878431, 1.1124602875450973, 1.0166149756313692, 1.077656405163853, 1.0523941637891459, 1.0261521972132905, 1.021505376344086, 1.0235783633841886, 1.0150609340878671, 1.0857002249718786, 1.0417779864069234, 1.2272672528001927, 1.6666666666666667, 1.03125, 1.0, 1.0548372560574024, 1.0488599348534202, 1.3051733626857458, 1.044362292051756, 2.1923076923076925, 1.071568351180412, 1.0563758389261746, 1.0926196172248803, 1.125, 1.0584331536959029, 1.040023758592045, 1.2930682976554537, 1.0581052631578947, 1.125, 1.2273324572930355, 1.1229050279329609, 1.5, 1.0711265314973435, 1.5769230769230769, 1.0724324324324324, 1.1097560975609757, 1.0209035738368173, 1.036655611799616, 1.015531660692951, 3.6666666666666665, 1.0821256038647342, 1.101731681311813, 1.0525973665203623, 1.016367926584028, 1.0234679722562219, 1.0680059393833523, 1.0, 1.0682967959527825, 1.019112084411706, 1.0532836287334255, 1.0230460921843687, 1.0, 1.1224696356275303, 1.0033620908398884, 1.3797595190380763, 1.0219492190286, 1.0, 1.3333333333333333, 1.0293752626764567, 1.0022513015336991, 1.232590067698717, 1.098378278194792, 1.0614525139664805, 1.1083743842364533, 1.1021281209648008, 1.090131860182171, 1.1323529411764706, 1.0451977401129944, 1.0280777537796977, 1.0812226967064251, 1.1071428571428572, 1.75, 1.0735326762564377, 1.1779691424470757, 1.0203606748109366, 1.0114942528735633, 1.2465604634322955, 1.0156426553672315, 1.1608096710711273, 1.2422360248447204, 1.3076923076923077, 1.045822102425876, 1.1124121779859484, 1.13125, 1.4827586206896552, 1.073605989496033, 1.1883052527254707, 1.1625207296849087, 1.0, 1.0211522386063463, 1.083557433730311, 1.0658634538152612, 1.1838978015448605, 1.3333333333333333, 1.12, 2.0, 1.1473354231974922, 1.1153846153846154, 1.0, 1.1538461538461537, 1.0278145695364238, 1.0054347826086956, 1.004878555117293, 1.0602269273629825, 1.3, 1.4166666666666667, 1.1428571428571428, 1.096774193548387, 1.027027027027027, 1.2142857142857142, 1.1049913941480207, 1.0231387990247394, 1.0299246781195504, 1.3473684210526315, 1.1018034098602818, 1.0471497923026876, 2.5, 1.0661597087543806, 1.2773722627737227, 3.0, 2.0, 1.2532544378698225, 1.1009108513232446, 1.078920655316415, 1.1987577639751552, 1.0, 1.2524271844660195, 1.1768953068592058, 3.0, 1.5, 1.0252270433905146, 1.2320204328538782, 1.0174167302313755, 2.0, 1.0420134459575936, 1.0495739736638265, 1.0114107883817427, 1.0, 1.051643192488263, 1.0229166165240324, 1.4342105263157894, 1.2292292292292293, 1.0607823742751303, 1.2142857142857142, 1.046875, 1.0811132786323767, 1.0772769089236431, 1.1239669421487604, 1.1896551724137931, 1.0140181933017807, 1.303987240829346, 1.0238016903965057, 1.2574850299401197, 1.1568627450980393, 1.328358208955224, 1.1077348066298343, 1.058016219588272, 1.0195904825873685, 1.0941789614868749, 1.0316593886462881, 1.5, 1.6666666666666667, 1.0954740139359458, 1.1912928759894459, 1.0851974324061466, 1.022397859623716, 1.0543569158722195, 1.1012478016916507, 1.378125, 1.0208333333333333, 1.1066740036160678, 1.0717367631649237, 1.2001414427157002, 1.0574074074074074, 1.6666666666666667, 1.056338028169014, 1.0730199968508896, 1.1198822584961199, 1.016394222384297, 1.079673483270269, 1.0298295454545454, 2.0, 1.0767295597484277, 1.0264118483882707, 1.1752341786611835, 1.0233463035019454, 1.0748402708243934, 1.0636942675159236, 1.2825607064017661, 1.0105448154657293, 1.030842759626795, 1.0549709571512753, 1.023041474654378, 1.049731182795699, 1.0, 1.1901565995525727, 1.0560151750617057, 1.0587412587412588, 1.035156829833636, 1.1099444101297098, 1.037821482602118, 1.125, 1.2798913043478262, 1.6666666666666667, 2.0, 1.2352941176470589, 1.0, 1.0252764612954186, 1.0116231571911323, 1.0048866864655546, 1.0635006784260517, 1.0268528464017186, 1.2173913043478262, 1.1666666666666667, 1.0489277973021318, 1.6, 1.5833333333333333, 1.1683130699088147, 1.1428571428571428, 1.0759312320916905, 1.1075949367088607, 1.0192879675529518, 1.0934979143334793, 2.0, 1.0724458204334366, 1.2034883720930232, 1.05249343832021, 1.040730478820518, 1.1237373737373737, 1.1342465753424658, 1.1406708129720124, 1.09111189385934, 1.003189792663477, 1.2033898305084745, 1.0656424581005586, 1.0, 1.0, 1.041951289295805, 5.0, 1.5714285714285714, 1.6875, 1.0171779141104293, 1.0681818181818181, 1.0953436807095345, 1.0961161239701844, 1.0, 1.0993171942892612, 1.0105140186915889, 1.0276497695852536, 1.3461538461538463, 1.4285714285714286, 1.0061158678972535, 1.0914634146341464, 1.1393805309734513, 1.0892525102268502, 1.023549495958737, 1.2330386740331492, 1.1082519964507542, 1.0, 1.2898845031095316, 1.0923550803611375, 1.0115225968436155, 1.1774193548387097, 1.0736250128985656]
origin-bjaq_15.71 	max: 5.0000	99th: 2.6700	95th: 1.7150	median: 1.0790	mean: 1.1747

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 14.062228 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[2.9802322e-07 4.1723251e-07 2.3841858e-07 4.1723251e-07 3.5762787e-07]
Distance score: 3.457069510659494e-07
SAUCE Drift detection: False
Detection latency: 0.0234s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.030762 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.6667	95th: 1.7284	median: 1.0796	mean: 1.1786
ReportEsts: [1.0106100795755968, 1.030461270670148, 1.0714789135397904, 1.0977312390924956, 1.7272727272727273, 1.0, 1.0544291249887356, 1.0589780918226042, 1.0, 1.0066006600660067, 1.1511410040835937, 1.0447367035083628, 1.0165726375176305, 1.157170923379175, 1.0866447564983568, 1.078125, 1.143312101910828, 1.3, 1.2727272727272727, 1.064967105263158, 1.092205750224618, 1.0451472760448344, 1.1378676470588236, 1.0059171597633136, 1.0288047459928882, 1.0310731931551087, 2.0, 1.1510675198851743, 1.5, 1.1666666666666667, 1.0586511509385883, 1.0, 1.0479637641569335, 1.002814917261998, 1.1567717996289424, 1.1175466406535788, 1.2276008050523979, 1.1737193763919822, 1.4285714285714286, 1.204043429427181, 1.0440646651270207, 1.0131081174031384, 1.1295143212951433, 1.0971128608923884, 1.0128205128205128, 1.0829036914827799, 1.1904761904761905, 1.0233261339092872, 1.0808510638297872, 1.0326884589726484, 1.1538461538461537, 1.2675438596491229, 1.0847457627118644, 1.1515151515151516, 1.0252155146135369, 1.009085652928058, 1.0877799488952353, 1.2451790633608815, 1.1111111111111112, 1.0728824290728964, 1.4666666666666666, 1.1568251632169353, 1.0823170731707317, 1.063197026022305, 1.0408163265306123, 2.0, 1.0589418505424844, 1.3220751148338288, 1.6, 1.0, 1.0084079408330089, 1.0090634441087614, 1.0612048192771084, 1.01171875, 1.1170981575603558, 1.14390756302521, 1.0145985401459854, 1.103448275862069, 1.4951456310679612, 1.0760807970021022, 1.0357142857142858, 1.0303030303030303, 1.0, 3.0, 1.103211009174312, 1.0606060606060606, 1.007366482504604, 1.0142857142857142, 1.375, 1.07216725898889, 1.1215109223300972, 1.4311857133842367, 1.0423150002567658, 1.1371200148740355, 1.024, 1.015531660692951, 1.029739776951673, 1.056338028169014, 1.0909090909090908, 1.2861736334405145, 1.032258064516129, 2.0, 1.0691243846462302, 1.2639658848614073, 1.096113074204947, 1.2273904597453054, 1.1764705882352942, 1.0314370198868026, 1.0444395312845456, 1.3133965912668075, 1.1013941698352345, 1.0571355367665898, 1.125, 1.5, 1.07809747504404, 1.0913047315154134, 1.0359937402190924, 1.2790697674418605, 1.0591034887621604, 2.0, 1.1938802426800317, 1.1522333637192343, 1.0, 1.0547945205479452, 1.125, 1.293991416309013, 1.021830444125441, 1.0341719621320191, 1.1311475409836065, 1.6666666666666667, 1.129565816678153, 1.0, 1.2, 1.1099205616109367, 1.0, 1.2600806451612903, 1.0039448168873621, 1.0750428366611882, 2.0, 1.5, 1.0381355932203389, 1.0641255605381166, 1.0826913199794557, 1.0439711488047159, 1.2243589743589745, 1.009771986970684, 1.0412986247344507, 3.0, 1.0251428571428571, 1.0085470085470085, 1.0723025583982202, 1.069767441860465, 1.5, 1.1866478133521867, 1.0638020833333333, 1.0359589041095891, 1.0011862396204034, 1.0, 1.006687242798354, 1.1010498365008727, 1.2357252191660095, 1.0673400673400673, 1.0516304347826086, 1.2459016393442623, 1.4601769911504425, 1.0223048327137547, 1.3333333333333333, 1.05184877049502, 1.5, 1.1370967741935485, 1.0886075949367089, 1.0671530556209303, 1.0058988411496466, 1.2831541218637992, 1.0702402957486137, 1.0576276612774131, 1.1070422535211268, 1.0575594781273983, 1.0592885375494072, 1.03081305023304, 1.0035022354694485, 1.2158661070521788, 1.1393939393939394, 2.142857142857143, 1.0206855409317512, 1.074002967100096, 1.3882783882783882, 1.0527450340425208, 1.0072115384615385, 1.5, 1.2386363636363635, 1.0421762969211303, 1.2608695652173914, 1.1239422598307616, 1.0691771269177126, 1.032701716825589, 1.0330801119505062, 1.0745829244357212, 1.0102193602429193, 1.283718663706752, 1.0131470829909615, 1.0174745895230648, 1.014412683161182, 1.0641542882809114, 1.0691114245416078, 1.0630995335738802, 1.259090909090909, 1.0810810810810811, 1.1954022988505748, 1.0, 1.3722627737226278, 1.1694233937397034, 1.2816091954022988, 1.2857142857142858, 1.0069586573884568, 1.0588235294117647, 1.0458618416074883, 1.0434782608695652, 1.2227803691743413, 2.0, 1.1262135922330097, 1.0019021739130434, 1.0510061169034821, 1.0039754004138248, 1.375, 1.0113571834185122, 1.1011710752600115, 1.0912509400852344, 1.0134048257372654, 1.0204081632653061, 1.1706683971447112, 1.0821737123260569, 1.35, 1.0063427869835795, 1.1213949279565651, 1.105095541401274, 1.0855323020928116, 1.05788876276958, 1.2380952380952381, 1.1666666666666667, 2.0, 1.2062200956937799, 1.0668961667286938, 1.163529411764706, 1.0411392405063291, 1.0, 1.25, 1.036729962140111, 1.1343283582089552, 1.1067498816848083, 1.6, 1.1677018633540373, 1.0634291377601586, 1.2857142857142858, 1.004585596483322, 1.043778801843318, 1.1329833770778652, 1.0833333333333333, 1.001392757660167, 1.1336202727536513, 1.0476190476190477, 1.0, 1.1060707309550735, 1.0357841104330825, 1.1577380952380953, 1.0213076829416778, 1.1112105932802412, 1.027746916618617, 1.1033112582781457, 1.0886737089201879, 1.0372608257804632, 1.019799646434885, 1.042751691613697, 1.0, 1.027117981228388, 1.2341772151898733, 1.0677966101694916, 1.3478260869565217, 1.0534155110426298, 1.1434782608695653, 1.0399154793958738, 1.0024899175872348, 1.0658227848101265, 1.4221748400852878, 1.0066355801860307, 1.0178062678062678, 1.174862649734306, 1.0434109027531226, 1.2, 1.0543478260869565, 1.0006184291898577, 1.0265608165167002, 1.2660481733317968, 1.0769633145380277, 1.1742584745762712, 1.1805477920626049, 1.053303996025268, 1.022460837948962, 1.145192794617666, 1.0284784926644261, 1.0404135338345866, 1.8333333333333333, 1.0, 1.0719510374682788, 1.3, 1.014388489208633, 1.0637140873408035, 1.015589130318723, 1.2926829268292683, 1.136, 1.401673640167364, 1.1219512195121952, 1.0432574784442945, 1.0434782608695652, 1.11488523069789, 1.0136463697668163, 1.097852028639618, 1.0, 2.6666666666666665, 1.031820204717401, 1.4285714285714286, 1.0009874435405266, 1.0365659777424483, 1.2, 1.0973676406852346, 1.2083333333333333, 1.6666666666666667, 1.0007952090414565, 2.0, 1.2313167259786477, 1.0452322738386308, 1.0419458199825227, 1.0558766859344895, 1.029535864978903, 1.1616161616161615, 1.096446757694561, 1.130811417597057, 1.0066889632107023, 1.024005817897026, 1.052420091324201, 3.0, 1.4, 1.056259806951643, 1.5, 1.0698649278062413, 1.35, 1.0, 1.3157894736842106, 1.3205980066445182, 1.075663026521061, 1.4601769911504425, 1.0837719298245614, 1.275, 2.0, 1.1117246819840252, 1.3333333333333333, 1.1076923076923078, 1.0003809561021353, 1.098814229249012, 1.00817843866171, 1.0282752120640906, 1.4, 1.25, 1.2105660377358491, 1.1357142857142857, 1.1719298245614036, 1.1224537716466099, 1.2296150534989547, 1.040506329113924, 1.5, 1.0263296594499367, 1.074468085106383, 1.64, 3.0, 1.0486078338839075, 1.2857142857142858, 1.1051502145922747, 1.0934579439252337, 1.0804684289823312, 1.119986337110008, 1.0566248256624826, 1.0662197514715501, 1.1097691894793345, 1.1304347826086956, 1.1089837997054492, 1.0854349728023127, 1.083050847457627, 1.0285714285714285, 1.0012819057349909, 1.0757992078982774, 1.040713643324178, 1.0196078431372548, 1.1, 1.1676767676767676, 2.0, 1.0416666666666667, 1.5903614457831325, 1.1318267419962336, 1.2784810126582278, 1.0, 1.0684713375796178, 1.0064967516241878, 1.0253665372437664, 1.129496402877698, 1.105878821662879, 1.0096153846153846, 1.219298245614035, 1.141732283464567, 2.0, 1.0927008135670906, 1.6, 1.1042811549864975, 1.0736067926333412, 1.0738387567613978, 1.1468253968253967, 1.625, 1.1085790884718498, 1.1428571428571428, 1.0590351384338665, 1.2727272727272727, 1.0473351420561907, 1.0061199510403918, 1.0514627185158758, 1.0944625407166124, 1.111277072442121, 3.0, 1.221326164874552, 1.0129572214555815, 1.1164937004557116, 2.0, 1.0379746835443038, 1.3098134630981346, 1.3583061889250814, 1.0772660230624833, 1.0326340326340326, 1.0, 1.154796511627907, 1.0186677811610643, 1.0450677643460293, 1.020968696445524, 1.0467120464622495, 1.1171956749215208, 1.0555555555555556, 1.00990099009901, 1.0388487338671786, 1.0155038759689923, 1.2725806451612902, 1.0, 1.5, 1.17351598173516, 1.1003861003861004, 1.0123796423658873, 1.108686300937742, 1.064234326824255, 1.0, 1.0403225806451613, 1.2692307692307692, 1.0771854041150393, 1.173913043478261, 1.0, 1.0440046645630403, 1.3333333333333333, 2.0, 1.0197292069632495, 2.3333333333333335, 1.0051880674448768, 1.0075075075075075, 1.0140449438202248, 1.0909090909090908, 1.0821070321155835, 1.0987972508591066, 1.65, 1.0320135321388297, 1.1129032258064515, 1.067391304347826, 1.0669371196754565, 1.1767151767151767, 1.014963311112177, 1.0, 1.0864197530864197, 1.0190972222222223, 1.1062154464734462, 1.0744, 1.75, 1.0877160720853254, 1.009014112257715, 1.0285588752196837, 2.0, 1.0318764377259284, 1.041729327154242, 1.029936743000049, 1.0102511905194664, 1.00965328613949, 1.083283609491899, 1.03544127866574, 1.0169244767970882, 2.0, 1.1313340227507755, 1.06, 1.028249940148432, 1.043646408839779, 1.021798365122616, 1.0104021998777846, 1.4026845637583893, 1.0345088421941062, 1.1946153846153846, 1.1201382251305052, 1.0628019323671498, 1.1632916418503076, 1.044867437117607, 1.0344827586206897, 1.0978260869565217, 1.1001629748942565, 1.118790496760259, 1.0018017063218696, 1.0563238858386506, 1.6666666666666667, 1.1331316187594553, 1.6463768115942028, 1.1428571428571428, 1.0192307692307692, 1.0069734479826136, 1.1204379562043796, 1.1127548980407838, 1.0, 1.5, 1.0063694267515924, 1.1718108223263741, 1.0272575560912294, 1.0230864560309694, 1.0758039816232772, 1.2036516853932584, 1.0172326406487582, 1.0588015506048294, 1.6303030303030304, 1.0285356618018677, 1.0439716312056737, 1.0932642487046633, 1.14386189258312, 1.0804953560371517, 1.0234140330158403, 2.0, 1.2156721782890008, 1.013029315960912, 1.0116974494283202, 1.1123348017621146, 1.0587084148727985, 1.1073345259391771, 1.1635687732342008, 1.080150308516771, 1.0, 1.180327868852459, 1.4285714285714286, 1.3333333333333333, 1.1523809523809523, 1.135379061371841, 1.0064683053040104, 1.028225806451613, 1.065345474022496, 1.0705563093622794, 1.040733863180569, 1.159746086292478, 1.031417884685065, 1.0796507603331622, 1.0186418281268679, 1.132996632996633, 1.1119902377578335, 1.0546898600342363, 1.0795624067628047, 1.0412262156448202, 1.122100122100122, 1.48, 1.068094719432006, 1.1145475372279496, 1.1033811294034341, 1.281767955801105, 1.2555023923444977, 1.0853658536585367, 2.0, 1.008187134502924, 1.0555555555555556, 1.0, 1.3041825095057034, 1.042541906195643, 1.054302103250478, 1.0127551020408163, 1.054054054054054, 1.0546900086055204, 1.0031420924007914, 1.1224489795918366, 1.2, 2.0, 1.0273176083379045, 1.0608695652173914, 1.0606060606060606, 1.0705202312138729, 1.0, 1.0972862263184844, 1.1528662420382165, 1.0470296226598748, 1.1302395209580838, 1.0450093827898161, 1.03683526279948, 1.006710579294047, 1.4318181818181819, 1.6666666666666667, 1.1631006105654367, 1.0, 1.0257309941520467, 1.2678571428571428, 1.3227848101265822, 1.3852230483271375, 1.7727272727272727, 1.0138820839457783, 1.04, 1.1647429171038826, 1.0719129474846238, 1.1795865633074936, 1.0695384615384615, 1.0625810959177562, 1.00355871886121, 1.0451388888888888, 1.2, 1.0148257393464255, 1.032086979581013, 1.2777777777777777, 1.0060687795010115, 1.2061634484103765, 1.1076923076923078, 1.0225080967631042, 1.2222222222222223, 1.0719298245614035, 1.018466047874939, 1.2816229116945108, 1.3696969696969696, 1.0443537486155805, 1.0775193798449612, 1.875, 1.0909090909090908, 1.0115176151761518, 1.0474449463579898, 1.1862615587846763, 1.002273011235307, 1.0512307425713978, 1.2575757575757576, 1.1277269528501055, 1.2407932011331444, 1.0481647921879176, 1.1, 1.0130068859984698, 1.0865989356555394, 1.0034334018469733, 1.2380952380952381, 1.063793103448276, 1.0434782608695652, 1.1428571428571428, 1.0320987654320988, 1.6017852001151742, 1.1154088050314466, 1.194736842105263, 1.0769230769230769, 1.013029315960912, 1.036983842010772, 1.0736196319018405, 1.0350820639090268, 2.6666666666666665, 1.1037683700893963, 2.0, 1.0040322580645162, 1.1538461538461537, 1.0546446412700359, 1.4, 1.1846689895470384, 1.0436681222707425, 2.0, 1.2962138084632517, 1.2135728542914173, 1.1666666666666667, 2.5, 1.0845070422535212, 1.2426900584795322, 1.0472316977171345, 1.1909758656873033, 1.129737609329446, 1.292929292929293, 1.0374064837905237, 1.0166994106090372, 1.2016460905349795, 1.2566666666666666, 1.0666666666666667, 1.0, 1.133649289099526, 1.0853801169590642, 1.0229885057471264, 1.0626032678538646, 1.0870728161754988, 1.0440948291415582, 1.0850443325403936, 1.2283755749977452, 1.1495972382048332, 1.0074257425742574, 1.3333333333333333, 1.0, 1.303030303030303, 1.0348669749109376, 1.0836390315480557, 1.0767195767195767, 1.0081135902636917, 1.0282941064518176, 1.0345769895711339, 1.0075355404139428, 1.1341463414634145, 1.2380952380952381, 1.2209302325581395, 1.0643164990606697, 1.061554724345422, 1.0106764699407842, 1.0054347826086956, 1.0050297491259277, 1.0359093838298716, 1.1131270548843213, 1.0816629547141796, 1.0752063852263392, 1.1366666666666667, 1.0466034755134281, 1.1067961165048543, 1.0339434862207055, 4.0, 1.0062082139446036, 1.0, 1.0741482965931863, 1.0090535874500421, 1.03125, 1.0794380740032914, 1.0053191489361701, 1.2195121951219512, 1.0200775536652849, 1.0301059730250481, 1.0915579689861725, 1.0229793977812995, 1.0009416195856873, 1.2032040233944565, 1.1808695652173913, 1.2941176470588236, 1.0, 1.25, 1.0700917579530296, 1.4285714285714286, 1.0516814722916985, 1.072988776127428, 1.0778371954842543, 1.0659814323607426, 1.3872766802155214, 1.0148312611012433, 1.0542168674698795, 1.0268378063010501, 1.0244794399329673, 1.0902101586434327, 1.0444164553583344, 1.208245666766857, 2.0, 1.0456570155902005, 1.063973063973064, 1.0839081955833225, 1.0921787709497206, 1.2867180417044424, 1.0136363636363637, 2.2282608695652173, 1.0382359262209075, 1.0721649484536082, 1.0225756593707933, 1.3529411764705883, 1.064392434918627, 1.0241567397233173, 1.2953586497890295, 1.0479666319082377, 1.1290322580645162, 1.1123595505617978, 1.109999439493302, 1.020325777924383, 2.0, 1.0186028853454823, 1.0, 1.0260541403585166, 1.0471760797342193, 1.041237113402062, 1.0627774254914395, 1.0507246376811594, 1.0483711747285291, 1.0853104492680465, 1.007626423546484, 1.07218479307026, 1.0075587073761094, 1.0598020088156659, 1.0666666666666667, 1.0868644067796611, 1.1395348837209303, 1.1441483493168123, 1.0425531914893618, 1.0015690376569037, 1.1765285996055226, 1.1667854597291518, 1.0893098782138024, 1.0539462227912932, 1.0318021201413428, 1.1069549970777324, 1.227599138274954, 1.0479067760034528, 1.0877796901893289, 1.1915574402467233, 1.1037913666841763, 1.0334448160535117, 1.0901960784313725, 1.0991367261366438, 1.0766837976737895, 1.1614906832298137, 1.0721153846153846, 1.0514705882352942, 1.1021620847651776, 1.058252427184466, 1.4, 1.0420405853343035, 1.1765687991204137, 1.036228287841191, 1.0375586854460095, 1.2619981889526108, 1.0131277533039647, 1.1669413703790912, 1.1794489947877886, 1.1515151515151516, 1.026981450252951, 1.2432432432432432, 1.1256410256410256, 1.6129032258064515, 1.0248127166337446, 1.192085737840066, 1.109375, 1.0833333333333333, 1.2054380664652569, 1.1362162162162162, 1.0, 1.1818181818181819, 1.0301167793484942, 1.0203252032520325, 1.0594252313687287, 1.1538461538461537, 1.007196492360887, 1.2222222222222223, 1.0066286777532272, 1.2831858407079646, 1.1666666666666667, 1.2364663890541345, 1.0089112746997289, 1.0409500296539453, 1.2477341389728096, 1.208955223880597, 1.3529411764705883, 1.1714285714285715, 1.0898876404494382, 1.1058823529411765, 1.0218423551756886, 1.0328384254893959, 1.0289459278068334, 1.2991452991452992, 1.0524950987097068, 1.0469567537595004, 4.5, 1.0567033132672, 1.024797843665768, 1.5, 2.75, 1.171898355754858, 1.081060062215841, 1.0932673417776475, 1.1701570680628273, 1.5, 1.0950704225352113, 1.2392947103274559, 1.2258064516129032, 1.0388561943564207, 1.109431373893957, 1.0356788800321521, 1.0322244238189593, 2.0, 1.0175726651173755, 1.0385109114249038, 1.0672727272727274, 1.04863813229572, 1.0011441647597255, 1.0, 1.1982872200263504, 1.146668050653934, 1.0737711542502466, 1.1220657276995305, 1.0584415584415585, 1.0501380665854747, 1.0380597014925372, 1.087248322147651, 1.2266666666666666, 1.0507360834752166, 1.9781994348001615, 1.0279701676879958, 2.5431472081218276, 1.1640625, 1.149638802889577, 1.0, 1.0939039408866995, 1.0127551020408163, 1.0055628054300876, 1.0285714285714285, 2.0, 1.0438813349814586, 1.0403508771929824, 1.181485547017929, 1.1115067162971355, 1.0121141435347174, 1.1361619523017195, 1.1190188839982962, 1.0247148288973384, 1.1071428571428572, 1.1455800197173842, 1.1412087724100177, 1.2278708133971292, 1.1821305841924399, 2.6666666666666665, 1.0113636363636365, 1.0283595064181448, 1.0745814307458144, 1.0645914504407417, 1.0787075041752767, 1.0331360946745562, 2.0, 1.0582822085889572, 1.0159293026380867, 1.1697360926523637, 1.1758957654723128, 1.0888017082981576, 1.0158730158730158, 1.0886877828054298, 1.0009606147934678, 1.0325331381244214, 1.1300619538013374, 1.0693359375, 1.0753424657534247, 1.0555555555555556, 1.2081118161550335, 1.0036296798269635, 1.018781526133152, 1.1047194652623051, 1.101574403250381, 1.0332705586942874, 1.14, 1.2516703786191536, 2.3333333333333335, 1.3333333333333333, 1.0, 1.004255319148936, 1.0236842105263158, 1.017641304004797, 1.0155352043468662, 1.0024977293369663, 1.0, 1.2008928571428572, 1.1049156272927365, 1.0619913177098852, 1.3333333333333333, 1.375, 1.1913183279742765, 1.3333333333333333, 1.0267131242740999, 1.1601694915254237, 1.0168111177525403, 1.0991429421147971, 2.0, 1.1003102378490175, 1.1279373368146215, 1.0637846439464262, 1.0405776824657775, 1.180482686253935, 1.127933600457928, 1.1335687616104766, 1.1846308974154858, 1.0136054421768708, 1.0120481927710843, 1.0580046403712298, 1.6666666666666667, 2.0, 1.0417180428020638, 5.0, 1.7142857142857142, 1.725, 1.0502049180327868, 1.0697996269330285, 1.0112485939257594, 1.038910505836576, 1.3333333333333333, 1.0929503916449086, 1.0194836824159765, 1.0648148148148149, 1.2015355086372361]
origin-bjaq_15.71 	max: 5.0000	99th: 2.6667	95th: 1.7284	median: 1.0796	mean: 1.1786

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.247976 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.391215