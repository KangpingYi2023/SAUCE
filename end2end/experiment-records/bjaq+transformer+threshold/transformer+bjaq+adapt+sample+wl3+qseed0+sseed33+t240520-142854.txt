Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 33, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.6700	95th: 1.6671	median: 1.0772	mean: 1.1736
ReportEsts: [1.1091549295774648, 1.0020833333333334, 1.0546055582078324, 1.0483870967741935, 1.5789473684210527, 1.0, 1.0504156320846378, 1.0398342834292729, 1.0, 1.02365308804205, 1.190834848353678, 1.0435836006551076, 1.0420131291028447, 1.1534883720930234, 1.066407629812787, 1.0, 1.0975609756097562, 1.0641161884520014, 3.0, 2.0, 1.125, 1.0499501856715878, 1.074612378349383, 1.099236641221374, 1.1519486926492353, 1.0, 1.176615362010065, 2.0, 1.2, 1.0, 1.0, 1.0483529244898322, 1.0049271689385364, 1.232519422863485, 1.0699074754002056, 1.2313271090363453, 1.1550802139037433, 1.0153950087034562, 1.1500447689234796, 1.1785714285714286, 1.1764705882352942, 1.0640243902439024, 1.0, 1.0083417593528816, 1.2383954154727794, 1.890625, 1.03, 1.176678445229682, 1.0266192315511282, 1.1851851851851851, 1.0885846904256156, 1.2646048109965635, 1.0394786537840863, 2.0, 1.0597402597402596, 1.0657859621030157, 1.2672811059907834, 1.3526570048309179, 1.0248447204968945, 1.25, 1.112799890948746, 1.0902864259028642, 1.1045454545454545, 1.0357142857142858, 1.1818181818181819, 1.0133281891199888, 1.2741481713035323, 1.75, 1.0, 1.0976041763773656, 1.0607594936708862, 1.0609048723897911, 1.018348623853211, 1.0536710455281626, 1.0988235294117648, 1.0975609756097562, 1.0, 1.1102296450939457, 2.0, 1.0238170392263766, 1.03125, 1.0371689270367686, 1.1349693251533743, 1.0792079207920793, 1.1089303238469088, 1.04, 1.0724139712720884, 1.0039616688091622, 1.0588235294117647, 1.75, 1.1153081510934393, 1.065295774979266, 1.0685358255451713, 1.0841514726507715, 1.0388994307400379, 1.0909090909090908, 1.007462686567164, 1.1661691542288557, 1.0, 1.2437021418266563, 1.0287364834839283, 1.072041166380789, 1.235299245891635, 1.096774193548387, 1.0272913242812656, 1.1067162198035572, 1.4712844978561508, 1.0792567311338643, 1.0478234212139792, 1.1666666666666667, 1.6666666666666667, 1.0647196261682244, 1.0544176998970811, 1.0612760581174985, 1.1948051948051948, 1.0600294576766203, 2.0, 1.1005991800693788, 1.1598224195338513, 1.0, 1.0055248618784531, 1.1666666666666667, 1.2456140350877194, 1.0204027491360312, 1.0323833190960627, 1.0980392156862746, 1.8, 1.2102649006622517, 1.0, 1.1428571428571428, 1.102115304004662, 1.3, 1.0032552083333333, 1.0362250120896581, 1.0802487414865265, 1.0507343124165553, 1.0246575342465754, 1.0467653936087296, 1.039972432804962, 1.068860450944546, 1.0266429543537978, 1.2272727272727273, 1.0176125244618395, 1.1248859086539047, 2.0, 1.019598906107566, 1.0057471264367817, 1.0862533692722371, 1.1072878065996117, 1.5, 1.2699200775006054, 1.0613207547169812, 1.037344398340249, 1.1074561403508771, 1.0102189781021897, 1.0944649446494465, 1.094160266628025, 1.0506916808792874, 1.0115384615384615, 1.0032894736842106, 1.2857142857142858, 1.4081632653061225, 1.0250368188512518, 1.2857142857142858, 1.0611331512056064, 1.0439652608864727, 1.145778364116095, 1.3480604485513523, 1.111337406653089, 1.094696668521905, 1.2610526315789474, 1.096774193548387, 1.0341822407281882, 1.038422649140546, 1.0224331320103537, 1.0826044703595723, 1.0341371750704667, 1.0845378151260505, 1.025493433986003, 1.0, 1.0317460317460319, 1.038698328935796, 1.0285087719298245, 1.2250169952413323, 1.0921052631578947, 1.073628868733229, 1.2773399961560639, 1.1003398047745818, 1.1153846153846154, 1.1681818181818182, 1.0976638219671224, 1.0, 1.2727272727272727, 1.0602881239659416, 1.0538277511961722, 1.0343347639484979, 1.3461538461538463, 1.0643086816720257, 1.035233304387592, 1.0633284873328726, 1.0626410835214446, 1.0237166649098768, 1.023121387283237, 1.1228070175438596, 1.1506849315068493, 1.0, 1.4285714285714286, 1.1151237975082795, 1.32404181184669, 1.2413793103448276, 1.0098863074641622, 1.0031277926720286, 1.0001199266734053, 1.0277716124736433, 1.1764211491442542, 1.0, 1.0087463556851313, 1.0071289695398573, 1.0346085358148085, 1.018194125129833, 1.0, 1.061697722567288, 1.1412167884505544, 1.0024643123608794, 1.152521525215252, 1.021837702611143, 1.2761915042910348, 1.0357142857142858, 1.0057951137803984, 1.1181021144920062, 1.0208685843203609, 1.1566265060240963, 1.25188262788886, 1.0174081237911026, 1.1275590551181103, 2.0, 1.2640382317801673, 1.1034502009825815, 1.163384903891233, 1.2641509433962264, 1.0, 1.6666666666666667, 1.1589841895147817, 1.1454545454545455, 1.0435859667916443, 1.5, 1.0, 1.05, 1.0042935206869632, 1.0769230769230769, 1.022099447513812, 1.1128691983122363, 1.0488215488215489, 1.0, 1.118367820986818, 1.0178571428571428, 2.0, 1.0829066683116402, 1.0347912524850895, 1.106830122591944, 1.044338064677969, 1.0976248884924176, 1.0273813335130673, 1.0945945945945945, 1.0672323644877912, 1.0191387559808613, 1.0832580548027702, 1.0277672598763095, 1.1818181818181819, 1.0366477803374634, 1.0042826552462527, 1.2045454545454546, 1.4705882352941178, 1.042851725445582, 1.0555555555555556, 1.0427350427350428, 1.0960366058811655, 1.0807799442896935, 1.3759398496240602, 1.006549341281808, 1.0595555555555556, 1.022913478138947, 1.05227043052477, 1.25, 1.07040742088032, 2.5, 1.0349023627427791, 1.0345572354211663, 1.0231031814664786, 1.0526315789473684, 2.0, 1.2608695652173914, 1.0441176470588236, 1.0566281227327885, 1.0, 1.0825688073394495, 1.0294117647058822, 1.0100160256410255, 1.0129524650341526, 1.105263157894737, 1.1446540880503144, 1.0081430482823397, 1.0730093196927841, 1.0161736020806242, 1.0256410256410255, 1.0, 1.1324582338902147, 1.288888888888889, 1.106896551724138, 1.079401853411963, 1.030025020850709, 1.0441176470588236, 1.18, 1.008230452674897, 1.0122747453643248, 1.2857142857142858, 1.007788804316408, 1.0439770554493308, 1.3571428571428572, 1.1419521672504378, 1.1904761904761905, 1.4, 1.009218284410068, 2.0, 1.1303155006858712, 1.005813953488372, 1.073010664479081, 1.0858316221765913, 1.0234986945169713, 1.0833333333333333, 1.109606461126368, 1.0712657108314467, 1.036723163841808, 1.0328079877372311, 1.0502703492620196, 2.0, 1.0, 1.0523777965675631, 1.25, 1.0715483510340973, 1.3529411764705883, 1.0, 1.375, 1.3815261044176708, 1.0579439252336449, 1.1120689655172413, 1.0162337662337662, 1.0, 1.2003994673768308, 1.0413125605321052, 2.0, 1.3692674210839786, 1.0, 1.0953617247399985, 1.0470588235294118, 1.002077252767479, 1.1566820276497696, 1.1363636363636365, 1.3280542986425339, 1.287037037037037, 1.034312235410998, 1.0248692514008193, 1.0884057971014494, 1.0, 1.0769230769230769, 1.5714285714285714, 3.0, 1.4545454545454546, 1.0694960830852391, 1.3333333333333333, 1.0033277870216306, 1.2469135802469136, 1.215392196113455, 1.0749605447871162, 1.2286302780638516, 1.0025213366635495, 1.0081206496519721, 1.05, 1.5, 1.1401425178147269, 1.0638297872340425, 1.0423099654298598, 1.0476190476190477, 1.5714285714285714, 1.0089887640449438, 1.0105757931844888, 1.0276519266574213, 1.008578431372549, 1.1464387464387464, 1.0013679890560876, 1.0126582278481013, 1.0907770515613653, 1.0646186440677967, 1.2884615384615385, 1.0240793201133145, 1.2178217821782178, 1.071352383984717, 1.0770065712274115, 1.0108972272981385, 1.1944444444444444, 1.2613636363636365, 1.108359133126935, 1.0, 1.011879049676026, 1.0265089765568305, 1.0164539267135688, 1.0637113353059309, 1.0891480941470526, 1.1382268827454718, 1.5714285714285714, 1.2017391304347826, 1.0, 1.1716481639624252, 1.25, 1.0320724883092416, 1.002906976744186, 1.0691100601891659, 1.051383399209486, 1.0040290088638195, 3.0, 1.2700892857142858, 1.0030876966695466, 1.1483354791245173, 2.0, 1.1587301587301588, 1.3032629558541267, 1.303370786516854, 1.0959643455861308, 1.0977130977130978, 1.105263157894737, 1.0785159620362381, 1.0179493771472643, 1.073464890313533, 1.09203179210195, 1.200328947368421, 1.1077943615257049, 1.1838565022421526, 1.6666666666666667, 1.0824175824175823, 1.5, 1.2308984047019311, 1.0303030303030303, 1.0798820625342842, 1.5625, 1.0775302735834953, 1.121294402722164, 1.0351634793337445, 1.0, 1.175257731958763, 1.16, 1.2857214328597157, 1.2691466083150984, 1.0, 1.0087101944115393, 1.1108979754285007, 1.1143804392871943, 1.5, 2.0, 1.022135922330097, 1.006311992786294, 1.0163934426229508, 1.1111111111111112, 1.0701068589127039, 1.1423948220064726, 1.4705882352941178, 1.053446327683616, 1.0545454545454545, 1.1574803149606299, 1.008130081300813, 1.3836769036600758, 1.0221571666379656, 1.0, 1.0571428571428572, 1.1108498733300527, 1.0546685150452582, 1.0255664322064115, 1.0, 1.0955540809555409, 1.0128411810865918, 1.0214772132006287, 2.0, 1.036682615629984, 1.0657534933895285, 1.0322371713722143, 1.0022716351404481, 1.0242547866015241, 1.0284292821606253, 1.0320901994796183, 1.1550144648023144, 2.0, 1.0193291642978966, 1.4230769230769231, 1.25, 1.1813471502590673, 1.1346153846153846, 1.0082019137798819, 1.1241642788920725, 1.1058260221342966, 1.060119320789353, 1.0964866863905325, 1.0549168132016773, 1.0502964735254343, 1.2261904761904763, 4.0, 1.0052958828471972, 1.1720647773279351, 1.046343920360275, 1.0472180393435704, 1.10857432775241, 1.1640566741237883, 2.375, 2.5714285714285716, 1.0133296002337244, 1.0437868372087842, 1.0059702044286718, 1.1754047802621435, 1.0750096413420749, 1.0041407867494825, 1.0673458600640502, 1.0328690807799443, 1.2076923076923076, 3.0, 1.1666666666666667, 1.0203442879499218, 1.0970873786407767, 1.0642857142857143, 1.2153179190751444, 1.0220440881763526, 1.3006535947712419, 1.148905109489051, 1.103030303030303, 1.0771785326787395, 1.2282608695652173, 1.0174050632911393, 2.0, 1.1856899488926746, 1.0277777777777777, 1.128, 1.1044692737430168, 1.0998796630565584, 1.1422924901185771, 1.0765239948119325, 1.1473096308404849, 1.0, 1.2127659574468086, 1.0, 1.0, 1.1704545454545454, 1.0564516129032258, 1.0154320987654322, 1.0825242718446602, 1.0682473566164692, 1.0237529691211402, 1.0314840989399294, 1.1582914572864322, 1.041860465116279, 1.089830418933911, 1.0486486486486486, 1.0938511326860842, 1.0362844702467344, 1.0875302989496365, 1.1965317919075145, 1.1679269061121613, 1.0706430851872497, 1.1716670264047773, 1.0807062683678166, 2.0, 1.240786240786241, 1.063913470993117, 1.4339622641509433, 1.0, 1.275, 1.25, 1.1770833333333333, 1.3333333333333333, 1.1666666666666667, 1.0080637302670046, 1.1178877940241576, 1.0282017124084948, 1.0712322121604139, 1.227027027027027, 1.1166892808683853, 1.0, 1.1666666666666667, 1.0271053176081109, 1.044983664036975, 1.0831106638442587, 1.1173823897938262, 1.0245090855803047, 1.148051948051948, 1.095930944412701, 1.119005328596803, 1.0492634033679396, 1.0780323424763267, 1.2727272727272727, 1.0578947368421052, 1.0, 1.2422535211267605, 1.2084626292102505, 3.0, 1.12992398064962, 1.0191617294011408, 1.4285714285714286, 1.0113112391930836, 1.0, 1.0555555555555556, 1.0464918066806495, 1.6923076923076923, 1.0206482723614083, 1.0311832550192226, 1.3571428571428572, 1.2083333333333333, 1.0865979381443298, 1.0033589251439539, 1.1181015452538632, 1.0406595818050723, 1.1556300983456582, 1.0, 1.0587660221594613, 1.1371951219512195, 2.0, 1.0333510159835781, 1.1035297171035556, 1.1551561021759698, 1.0192237893597376, 1.0267959928478703, 1.0, 2.142857142857143, 1.0917774086378738, 1.0354838709677419, 1.0449832861045594, 1.1859177215189873, 1.0046683457342271, 1.0717201409883113, 1.2014652014652014, 1.0459143968871596, 1.2775919732441472, 1.0532582518355316, 1.0548895899053627, 1.047438330170778, 1.0220588235294117, 1.0397852598574475, 3.0, 1.1207615913498266, 1.0003380830689987, 1.0391951349993995, 1.5833333333333333, 1.3078044716011665, 1.3219512195121952, 1.1428571428571428, 1.0629893489454751, 1.0420575865415722, 1.1746724890829694, 1.0588235294117647, 1.3333333333333333, 1.0284463433659163, 1.5, 1.1191588785046729, 1.0833333333333333, 1.057482290436836, 1.44, 1.2025316455696202, 1.0419287211740043, 1.0, 1.5238095238095237, 1.251227495908347, 1.25, 2.0, 1.1083333333333334, 1.2, 1.0306372549019607, 1.1972361809045227, 1.0940170940170941, 1.2359882005899705, 1.1014466214978942, 1.0545454545454545, 1.1556603773584906, 1.1020408163265305, 1.1538461538461537, 1.0, 1.1069042316258353, 1.0707070707070707, 1.0599173553719008, 1.000622019489944, 1.0893341894632447, 1.045802517192163, 1.079477069931521, 1.2475057836899943, 1.096306068601583, 1.0429371499688862, 1.5714285714285714, 1.0, 1.2142857142857142, 1.0037401259912095, 1.119152691968226, 1.107843137254902, 1.118457300275482, 1.0507101019016287, 1.0797810102994496, 1.0189167445804614, 1.1142857142857143, 1.2941176470588236, 1.019622641509434, 1.0656813361611877, 1.0962203350005035, 1.0222669603167096, 1.0328947368421053, 1.0245126993502658, 1.0150627075719203, 1.078729281767956, 1.3457230142566192, 1.125, 1.054259876249405, 1.6754716981132076, 1.1304347826086956, 1.0922619047619047, 1.0701001430615165, 1.0, 1.0528846153846154, 1.0204977554792711, 1.0, 1.077225578933123, 1.0063965884861408, 1.1944444444444444, 1.0102133536873479, 1.0271088680605625, 1.0759803921568627, 1.032442748091603, 1.1151898734177215, 1.20037883912867, 1.1940298507462686, 1.3571428571428572, 1.0, 1.6666666666666667, 1.071042751604699, 1.3333333333333333, 1.2791326354538135, 1.1004253944321791, 1.0143996455471864, 1.0615690168818273, 1.0488248808967306, 1.0032154340836013, 1.039426523297491, 1.0194174757281553, 1.0101184998244799, 1.1128140232470942, 1.0460195450192291, 1.2513850415512466, 1.6666666666666667, 1.0625, 1.0284552845528456, 1.0547505979410032, 1.022801302931596, 1.32523051131601, 1.0424354243542435, 2.1923076923076925, 1.0697178311049986, 1.0966442953020135, 1.0794856459330144, 1.1875, 1.0565151907372978, 1.0484624696811258, 1.2057984790874525, 1.0581052631578947, 1.032258064516129, 1.0553672316384182, 1.1551724137931034, 1.625, 1.0872372427455153, 1.6153846153846154, 1.0961325966850828, 1.1318407960199004, 1.0115961800818554, 1.037017635760433, 1.0023529411764707, 3.6666666666666665, 1.0980392156862746, 1.0956836648406192, 1.0606422579032169, 1.015820046196278, 1.0415958387162576, 1.0573575573099971, 1.0769230769230769, 1.1192579505300353, 1.0378980269583904, 1.0187508370909415, 1.0380761523046091, 1.0208333333333333, 1.0541825095057034, 1.014209591474245, 1.4123076923076923, 1.0038356452290877, 1.0, 1.3333333333333333, 1.014116541818092, 1.033895839394821, 1.1969474071349762, 1.1287925122787508, 1.0670391061452513, 1.113861386138614, 1.1096884210111286, 1.067938021454112, 1.1121323529411764, 1.010928961748634, 1.0273381294964028, 1.0960953222402199, 1.1071428571428572, 1.75, 1.0273729605710402, 1.1659133466778588, 1.0, 1.0057142857142858, 1.158580738595221, 1.0335472557798586, 1.1568737700309248, 1.36986301369863, 1.3076923076923077, 1.0377358490566038, 1.0869565217391304, 1.115625, 1.3870967741935485, 1.0289976533690914, 1.199207135777998, 1.1650082918739635, 1.024390243902439, 1.022302470993413, 1.042451018056089, 1.0691097724230254, 1.2307387601505249, 1.3333333333333333, 1.0769230769230769, 2.0, 1.1699756182514802, 1.1923076923076923, 1.0, 1.1538461538461537, 1.0039735099337748, 1.1123188405797102, 1.0259462705547804, 1.0181107724236331, 1.4381818181818182, 1.2592592592592593, 1.0666666666666667, 1.0, 1.1216216216216217, 1.042857142857143, 1.1362831858407079, 1.0281636870791488, 1.0281362472635525, 1.3333333333333333, 1.0695923349951786, 1.0478904959711726, 2.5, 1.0669507672416727, 1.2195121951219512, 1.5, 2.0, 1.150887573964497, 1.1020583805493795, 1.0665455746367238, 1.2111801242236024, 1.0, 1.0794979079497908, 1.0920245398773005, 3.0, 1.5, 1.0238681102362204, 1.2115875789756687, 1.0682244158440586, 1.6666666666666667, 1.0339995484060787, 1.048024786986832, 1.0632497273718649, 1.0, 1.0234741784037558, 1.0249606383308585, 1.027027027027027, 1.1232392219037746, 1.0637497333255754, 1.2996941896024465, 1.03125, 1.093884192921394, 1.0842592592592593, 1.1115702479338843, 1.2545454545454546, 1.0564746991707201, 1.2977777777777777, 1.070396640888172, 2.0, 1.0980392156862746, 1.2537313432835822, 1.0823211875843455, 1.055054432348367, 1.0075019358212407, 1.0680360222264802, 1.0731441048034935, 1.5, 1.6666666666666667, 1.078469603017324, 1.121811785400176, 1.0700252869091615, 1.0054061683091764, 1.079946479344372, 1.1202453465093496, 1.3086053412462908, 1.0212765957446808, 1.042292272620077, 1.092108236937807, 1.237782640408461, 1.1465863453815262, 1.6666666666666667, 1.0, 1.0094804281005814, 1.1535281146637266, 1.0048120630740776, 1.0880369491264, 1.0198863636363635, 2.6666666666666665, 1.0673316708229426, 1.00672787627813, 1.1731779757824994, 1.258555133079848, 1.0517987412387355, 1.0923566878980893, 1.0518763796909492, 1.0457971014492753, 1.0319532296168878, 1.0566966916407106, 1.0610599078341014, 1.0455153949129852, 1.0, 1.2191666666666667, 1.0574549776030715, 1.0313351498637602, 1.057136984893639, 1.123827392120075, 1.0166414523449319, 1.2857142857142858, 1.252659574468085, 1.6666666666666667, 2.0, 1.1176470588235294, 1.0025641025641026, 1.037124802527646, 1.0472505250058335, 1.015174714511783, 1.022758812101027, 1.0251046025104602, 1.1630434782608696, 1.0208333333333333, 1.042011265669171, 1.6, 1.6666666666666667, 1.0219341974077767, 1.1428571428571428, 1.1175595238095237, 1.1420682730923695, 1.0414601171698963, 1.0820632679229358, 2.0, 1.0730897009966778, 1.2170542635658914, 1.0412879771487926, 1.041262603557896, 1.1603535353535352, 1.1243150684931507, 1.1485797360769403, 1.0417577490051007, 1.0222575516693164, 1.109375, 1.074022346368715, 1.0, 1.0, 1.041240477808376, 5.0, 1.4285714285714286, 1.8620689655172413, 1.0542822677925212, 1.0681818181818181, 1.0875831485587584, 1.1396626127893292, 1.0, 1.0552451893234016, 1.018107476635514, 1.0825242718446602, 1.3245192307692308, 1.4285714285714286, 1.0305239179954442, 1.1075388026607538, 1.1343612334801763, 1.0591297880252881, 1.026000298472814, 1.0870920603994154, 1.1493640934634723, 1.0, 1.2417396454710834, 1.0632278883839343, 1.0643382352941178, 1.1774193548387097, 1.0543142321528094]
origin-bjaq_15.71 	max: 5.0000	99th: 2.6700	95th: 1.6671	median: 1.0772	mean: 1.1736

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 14.075638 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[1.4901161e-06 1.6093254e-06 2.4437904e-06 1.6689301e-06 1.1920929e-07]
Distance score: 1.466274284211977e-06
SAUCE Drift detection: False
Detection latency: 0.0234s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.019416 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 3.0000	95th: 1.6667	median: 1.0807	mean: 1.1860
ReportEsts: [1.018716577540107, 1.0045652173913044, 1.0450906812993537, 1.035472972972973, 1.7083333333333333, 2.0, 1.0760056878124857, 1.097328556471666, 1.0, 1.0184782608695653, 1.1232488285473987, 1.0430742640290067, 1.000351617440225, 1.1916167664670658, 1.037914691943128, 1.9166666666666667, 1.1844660194174756, 1.0, 1.1666666666666667, 1.0430820215410108, 1.0453119930788364, 1.1400883568476556, 1.2584562012142237, 1.0133444537114262, 1.0312583727784228, 1.0172359225709324, 2.0, 1.1407352284566155, 1.0, 1.1428571428571428, 1.0106788710907704, 1.0, 1.0490999452719394, 1.0059862585243295, 1.0309611829944547, 1.0590243902439025, 1.2339686838176578, 1.1386363636363637, 3.0, 1.153781700368674, 1.050852167469433, 1.0475301729501059, 1.0982800982800982, 1.1507462686567165, 1.014519056261343, 1.0560246615735156, 1.1904761904761905, 1.0375, 1.3945945945945946, 1.0256237356709372, 1.2142857142857142, 1.3127962085308056, 1.0928270042194093, 1.1428571428571428, 1.023819381865121, 1.0075556463140698, 1.0141382723031245, 1.0778588807785887, 1.1494252873563218, 1.050290814279984, 1.4285714285714286, 1.138104657435713, 1.0829562594268476, 1.123076923076923, 1.0297029702970297, 1.25, 1.152094024168184, 1.2438712972420838, 2.25, 1.0, 1.0444461742040942, 1.0040363269424823, 1.0650169820475497, 1.00587084148728, 1.0689420311790525, 1.0502445531347266, 1.0338332861679715, 1.0842105263157895, 1.5048543689320388, 1.089262554116508, 1.0014347202295553, 1.2857142857142858, 1.0, 1.5, 1.091647331786543, 1.2166666666666666, 1.028023598820059, 1.375, 2.0, 1.159045375134234, 1.1099429258035447, 1.2407012944453548, 1.0658150727012083, 1.1180251513740103, 1.0968586387434556, 1.0280701754385966, 1.0604651162790697, 1.0938375350140057, 1.40625, 1.321993670886076, 1.2592592592592593, 3.0, 1.0510067571597774, 1.2588486140724946, 1.0312056737588653, 1.2067750773938726, 1.3666666666666667, 1.012695494108002, 1.052400789300592, 1.1894886363636363, 1.1717713924850015, 1.0605982465188242, 1.125, 1.25, 1.038065643814333, 1.057607176666817, 1.0422094841063054, 1.043956043956044, 1.057926765402099, 1.0, 1.0854139290407359, 1.1708920187793428, 1.0, 1.0467289719626167, 1.125, 1.2024793388429753, 1.024932757644394, 1.0627013790436912, 1.056, 1.5, 1.159322033898305, 1.0, 1.0689655172413792, 1.1183093392395718, 1.1666666666666667, 1.3393939393939394, 1.0651802645371777, 1.104311893639957, 1.3333333333333333, 1.2857142857142858, 1.1042128603104213, 1.04, 1.0793650793650793, 1.0404371276085054, 1.1851851851851851, 1.0224166211044285, 1.0827332649475427, 3.0, 1.0294567712318285, 1.0281007751937985, 1.079400333148251, 1.1084159148055022, 1.5, 1.1524513776337115, 1.0341772151898734, 1.0319327731092438, 1.0898550724637681, 1.0, 1.0307925290257445, 1.088986784140969, 1.1781137764377245, 1.0115321252059308, 1.0588235294117647, 1.203125, 1.3225806451612903, 1.0073529411764706, 1.0909090909090908, 1.0568044257453462, 1.2666666666666666, 1.0657030223390276, 1.243500826749954, 1.0623598026020638, 1.0477938109934106, 1.256140350877193, 1.107485604606526, 1.0998071359691417, 1.0447343895619758, 1.0425055928411633, 1.0887622149837133, 1.0311931375097478, 1.0731294457757998, 1.2025688918455595, 1.206451612903226, 1.2105263157894737, 1.0132225212975552, 1.0772002284810405, 1.2241379310344827, 1.0253440413253159, 1.014354066985646, 2.0, 1.2351274787535411, 1.094591987653527, 1.631578947368421, 1.1329653788258907, 1.2493961352657006, 1.0336793052319424, 1.01651400073319, 1.0511307767944935, 1.006793141189347, 1.107040041873855, 1.0082135523613962, 1.0093275488069415, 1.0260143198090692, 1.060485675696015, 1.0625293841090737, 1.1033336249890628, 1.3472222222222223, 1.0, 1.2976190476190477, 1.0, 1.413533834586466, 1.040302930523543, 1.3244837758112094, 1.3148148148148149, 1.0032746623004503, 1.0, 1.0433495978224523, 1.0091954022988505, 1.22838962702097, 1.0, 1.0547445255474452, 1.0368612119519687, 1.0493174918122923, 1.0067432877104296, 3.0, 1.0768916155419224, 1.1288837178814892, 1.0655023474178404, 1.005089058524173, 1.0413907284768211, 1.0084364454443195, 1.116163167776071, 1.3916666666666666, 1.0035222130810366, 1.0375447481009343, 1.079268292682927, 1.0645454545454545, 1.0316593886462881, 1.3076923076923077, 1.1479013990672884, 2.0, 1.2527770920760306, 1.0419863300320826, 1.0953030598323914, 1.1838235294117647, 1.1666666666666667, 1.5, 1.0180350445382091, 1.1515151515151516, 1.0833285211064272, 1.4, 1.1229508196721312, 1.0616509926854754, 1.4285714285714286, 1.011987759866242, 1.025522041763341, 1.0916230366492146, 1.0740740740740742, 1.0223245924875974, 1.0933395645657744, 1.0588235294117647, 2.0, 1.0889981497978483, 1.016142143769597, 1.1192930780559647, 1.0057482276298142, 1.1160758566941407, 1.0279623049590607, 1.080130293159609, 1.0844126318259824, 1.0330827067669173, 1.0203871263314626, 1.0302455474760248, 1.6363636363636365, 1.0035318266889377, 1.2139737991266375, 1.2857142857142858, 1.25, 1.1670532419609911, 1.0140280561122244, 1.0284781649757389, 1.00779257580051, 1.216279069767442, 1.3116089613034623, 1.0208366360177552, 1.0654627539503385, 1.1734262402477518, 1.0481149229085107, 1.1, 1.0872093023255813, 1.0826719576719577, 1.008849400518758, 1.1075233514454093, 1.1111684312449404, 1.248012718600954, 1.1810055865921787, 1.0385352352565467, 1.0215714916601555, 1.1207556711457882, 1.05858925077365, 1.0384615384615385, 1.6666666666666667, 1.0666666666666667, 1.0833831440526, 1.2222222222222223, 1.0235081374321882, 1.0033019627695068, 1.0146234676007004, 1.7741935483870968, 1.0593220338983051, 1.216, 1.1787757933067453, 1.0559771432730978, 1.1304347826086956, 1.2529391223373298, 1.0391808325160727, 1.042654028436019, 2.0, 3.4285714285714284, 1.0274483970136143, 1.25, 1.0135999070091828, 1.0717703349282297, 1.0, 1.0672970663628596, 1.25, 1.5, 1.0036365428552319, 4.0, 1.1809815950920246, 1.0338164251207729, 1.1135057471264367, 1.1458885941644563, 1.2345013477088949, 1.0396039603960396, 1.1025959087936128, 1.0928554050766361, 1.1376518218623481, 1.0397487012202489, 1.0702729405952822, 3.0, 1.1111111111111112, 1.0384794887180806, 1.5, 1.0622966062296606, 1.4, 2.5, 1.5555555555555556, 1.3122895622895623, 1.0706436420722134, 1.1984126984126984, 1.0707964601769913, 1.3421052631578947, 1.5, 1.05442876774421, 1.457142857142857, 1.1594202898550725, 1.00664313786833, 1.1098039215686275, 1.0172026925953628, 1.0160075329566856, 1.1666666666666667, 1.0, 1.2144992526158445, 1.1407407407407408, 1.015748031496063, 1.130241310342379, 1.2639524811285732, 1.0334128878281623, 1.5, 1.0323586926156998, 1.0357142857142858, 1.5185185185185186, 1.5, 1.0296296296296297, 1.0, 1.1546610169491525, 1.3258426966292134, 1.2389405907041005, 1.1081658145479898, 1.2299168975069252, 1.0627635686510761, 1.1123066577000673, 1.030852994555354, 1.1461187214611872, 1.0510919845302191, 1.103161397670549, 1.3, 1.005712306604736, 1.0473617352065676, 1.0498652291105122, 1.0242718446601942, 1.1282051282051282, 1.2123142250530785, 2.0, 1.0434782608695652, 1.2148760330578512, 1.1946564885496183, 1.4479166666666667, 1.3571428571428572, 1.0873575691806836, 1.2458133971291867, 1.0619530547149751, 1.1118800461361016, 1.0655926352128884, 1.0288461538461537, 1.054263565891473, 1.0763358778625953, 2.0, 1.2558878610748538, 1.6326530612244898, 1.1021954207104494, 1.0750222171258206, 1.0300181428335808, 1.1556616282153276, 1.5, 1.0024559967253377, 1.0, 1.1876441434810343, 1.0833333333333333, 1.0183696003747533, 1.013530135301353, 1.031263997133387, 1.1855670103092784, 1.1139240506329113, 3.0, 1.229721549636804, 1.0130727490160227, 1.115025092901199, 4.0, 1.082191780821918, 1.286970423661071, 1.3067092651757188, 1.0840223163272165, 1.0380647973267472, 1.04, 1.045925925925926, 1.0222977022977022, 1.042753493807723, 1.0108439224421606, 1.0460660263055996, 1.0458567980691875, 1.0, 1.0335786568537257, 1.0838500295493474, 1.0077519379844961, 1.0, 1.0, 1.5, 1.2236929185969556, 1.0544747081712063, 1.0464045341834927, 1.0830216796343264, 1.095435684647303, 1.0, 1.1592920353982301, 1.09375, 1.0198726593702994, 1.2083333333333333, 1.0, 1.0823580313683072, 1.6666666666666667, 1.0, 1.0076190476190476, 2.6666666666666665, 1.0084635416666667, 1.0090157776108188, 1.011049723756906, 1.3, 1.074908499389996, 1.0819672131147542, 1.5, 1.0634356522833062, 1.069767441860465, 1.1373200442967886, 1.0181940700808625, 1.2991452991452992, 1.108732513777024, 1.0, 1.0481927710843373, 1.1839024390243902, 1.142022008253095, 1.0454545454545454, 1.5, 1.111377909124492, 1.0057563290879379, 1.0147441457068518, 2.0, 1.0406040268456376, 1.0227080989876265, 1.047855552565263, 1.0211137311808454, 1.0096287817561465, 1.0036050831672658, 1.0312056737588653, 1.168491128380825, 1.75, 1.019396086224027, 1.0252608456891819, 1.0516443361753958, 1.0505555555555555, 1.013089005235602, 1.0115821534123073, 1.0364583333333333, 1.076864887246783, 1.1727395411605939, 1.107396759831038, 1.046875, 1.1149213617360143, 1.0629338967702988, 1.0232558139534884, 1.0941176470588236, 1.0814855208009688, 1.1130434782608696, 1.0003435517970403, 1.0670903531386773, 1.6666666666666667, 1.2273073989321128, 1.029325513196481, 1.0, 1.0727272727272728, 1.021504433988618, 1.10431654676259, 1.0590933621154883, 1.0, 1.1666666666666667, 1.0098285714285715, 1.1201716007558604, 1.0422404168217343, 1.004992020427705, 1.099768875192604, 1.1046511627906976, 1.0230887634684454, 1.0315156480898942, 1.6506024096385543, 1.0318300739855135, 1.0169172932330828, 1.075, 1.041933611503543, 1.2857142857142858, 1.0437104218095954, 2.0, 1.2040520984081042, 1.0264026402640265, 4.5, 1.111617312072893, 1.0561370123691722, 1.057784911717496, 1.1576354679802956, 1.0401297831796879, 1.0, 1.2181818181818183, 1.6666666666666667, 1.0, 1.1538461538461537, 1.2877358490566038, 1.0183968462549278, 1.0316205533596838, 1.0704338510980183, 1.1448335495028101, 1.0644260678248996, 1.171077277748427, 1.0617123287671233, 1.1247175000226908, 1.0264350916875353, 1.1467116357504217, 1.0239497447978014, 1.057537326630119, 1.0574656188605107, 1.1019522776572668, 1.1837270341207349, 1.0833333333333333, 1.0206172788497294, 1.2084337349397591, 1.10269887202504, 1.2833333333333334, 1.1721350451735615, 1.1325556733828208, 1.0, 1.0406976744186047, 1.1176470588235294, 2.0, 1.3293650793650793, 1.0350703034721307, 1.0368559608875516, 1.020671834625323, 1.0268817204301075, 1.0806131436759698, 1.0313819434047014, 1.1107078039927405, 1.2, 2.0, 1.050924881570043, 1.0990990990990992, 1.08976951071573, 1.1554259043173862, 1.0, 1.1334379905808478, 1.1096774193548387, 1.1064291620727673, 1.150227617602428, 1.0269975176841672, 1.0723407211839089, 1.0184382997968728, 1.2755102040816326, 1.1666666666666667, 1.1490968627865217, 1.0, 1.0860606060606062, 1.1476793248945147, 1.335176226675881, 1.078017645954571, 1.7083333333333333, 1.0952448905167356, 1.114864864864865, 1.0638297872340425, 1.02418797512094, 1.2423651721897335, 1.1171823568136932, 1.1192046049188906, 1.0027223230490019, 1.054861111111111, 1.8, 1.0121284460187894, 1.047860890622898, 1.0476190476190477, 1.0532871972318338, 1.1925345711246496, 1.0225122349102773, 1.0101218832005998, 1.2222222222222223, 1.032967032967033, 1.0193302743336914, 1.1193633952254642, 1.0057803468208093, 1.029051539998622, 1.0222222222222221, 2.2857142857142856, 1.0006371455877667, 1.0328638497652582, 1.1366057677362835, 1.2594519597641345, 1.0103317415948443, 1.0412588283847657, 1.2222222222222223, 1.088334457181389, 1.257703081232493, 1.0302209612243143, 1.0548938373899535, 1.0215384615384615, 1.1577350859453994, 1.02372276344166, 1.2314814814814814, 1.0896708286038592, 1.0434782608695652, 1.1428571428571428, 1.0878712871287128, 1.5965860597439545, 1.0332401366884125, 1.141025641025641, 1.1428571428571428, 1.002390438247012, 1.0136005726556907, 1.0059171597633136, 1.0748856066790606, 2.6666666666666665, 1.3504273504273505, 2.5, 1.0149812734082397, 1.0714285714285714, 1.0319682650799207, 1.4516129032258065, 1.2108843537414966, 1.0424978317432785, 1.0, 1.1685104193465397, 1.2316910785619175, 1.5, 2.5, 1.097902097902098, 1.2551319648093842, 1.0498034076015728, 1.1949947862356622, 1.0469613259668509, 1.1222014925373134, 1.10941475826972, 1.0906735751295338, 1.2195121951219512, 1.4206896551724137, 1.0, 1.0, 1.3837209302325582, 1.0773739742086752, 1.0431266846361187, 1.041382405745063, 1.0858152208351814, 1.0585220457271636, 1.0556540212068253, 1.1140656960654554, 1.1477139507620164, 1.0035335689045937, 1.5, 1.5, 1.1764705882352942, 1.0391906579379724, 1.0433212996389891, 1.186588921282799, 1.0426829268292683, 1.0332930167419951, 1.0547848328048939, 1.0165724161626912, 1.1904761904761905, 1.2857142857142858, 1.0673443456162643, 1.0464642010692828, 1.0571740566482872, 1.0316993389818958, 1.0280898876404494, 1.0841236605493287, 1.0356498619935235, 1.081070401163342, 1.0937734433608401, 1.1310481976762394, 1.2247191011235956, 1.0753036437246963, 1.0438144329896908, 1.0318673194851782, 1.0784313725490196, 1.1176470588235294, 1.0, 1.0598802395209581, 1.0103271845967416, 1.1587301587301588, 1.0890381440496475, 1.0316455696202531, 1.3783783783783783, 1.0063552654287773, 1.055129246787638, 1.0189123308397074, 1.0260047281323876, 1.0213385063045586, 1.1924585387718512, 1.1853146853146854, 1.2352941176470589, 2.0, 1.625, 1.0551742237654944, 1.1, 1.0516694403994176, 1.111848447483466, 1.0125491665105826, 1.0612544919960798, 1.050442581628466, 1.042971203014264, 1.0745341614906831, 1.0124716553287982, 1.0076323526509994, 1.1705204003980565, 1.0435429428678584, 1.1581578815134919, 1.375, 1.5, 1.0201342281879195, 1.1034612164775843, 1.0225352112676056, 1.3032391454169538, 1.0571870170015456, 2.247311827956989, 1.0806108819097626, 1.0792410714285714, 1.068854517549979, 1.0909090909090908, 1.0733476190709694, 1.0313977775326557, 1.331571994715984, 1.0590094836670179, 1.3235294117647058, 1.084033613445378, 1.0860321162644657, 1.0769141531322506, 1.0324324324324323, 1.018531221825879, 1.3, 1.0703758550172766, 1.053627760252366, 1.0237797246558198, 1.008863819500403, 1.003574620196604, 1.0807770961145193, 1.0739614994934144, 1.0035116873344099, 1.0557129367327667, 1.0080870745284847, 1.0992721936024918, 1.1333333333333333, 1.093638313080772, 1.1000539859636496, 1.0243337195828506, 1.1145874850538062, 1.0532915360501567, 1.152, 1.160621761658031, 1.0722733245729303, 1.0411779600931834, 1.4318181818181819, 1.1174041297935102, 1.2362482935838754, 1.0392624728850326, 1.0638655462184874, 1.098105096721595, 1.1288698016437002, 1.0469483568075117, 1.1170431211498972, 1.1065896409759144, 1.0896615821988955, 1.1015384615384616, 1.0273972602739727, 1.04448507007922, 1.094305485991148, 1.0673076923076923, 1.4, 1.054525627044711, 1.1748731033359572, 1.0146127618119825, 1.0046948356807512, 1.2522003034901366, 1.0093701592868625, 1.1505024538443562, 1.0182421227197347, 1.2258064516129032, 1.0425531914893618, 1.1454545454545455, 1.158311345646438, 1.5714285714285714, 1.0870359837005679, 1.2, 1.1473029045643153, 1.08, 1.094054054054054, 1.1142857142857143, 1.0792079207920793, 1.09375, 1.0394088669950738, 1.0743801652892562, 1.0655898188937836, 1.0714285714285714, 1.0024261275272162, 1.0548446069469835, 1.0328554360812425, 1.218487394957983, 1.197080291970803, 1.2822370327441321, 1.0155940948831876, 1.0372183863780156, 1.284848484848485, 1.3870967741935485, 1.0588235294117647, 1.1944444444444444, 1.021505376344086, 1.0123456790123457, 1.1453551912568305, 1.0245375804712724, 1.029508754037056, 1.3130434782608695, 1.068477542556343, 1.0463907426937393, 3.0, 1.0309658915684945, 1.153919905597758, 2.0, 2.75, 1.1561420818944252, 1.0895299528161022, 1.0587691467232576, 1.206266318537859, 1.5, 1.1418181818181818, 1.3779527559055118, 1.2666666666666666, 1.0293459952372654, 1.0787238137130917, 1.062191815654648, 1.0309546068349433, 1.8571428571428572, 1.0107921391073555, 1.0405666452028333, 1.0026178010471205, 1.2727272727272727, 1.050179211469534, 2.0, 1.1428571428571428, 1.1148031655844155, 1.0286414656173397, 1.0757575757575757, 1.0586319218241043, 1.0851350508389994, 1.041759880686055, 1.0721649484536082, 1.318840579710145, 1.0303032372160352, 1.3623568373119912, 1.0267873251607145, 1.566137566137566, 1.1374045801526718, 1.3736263736263736, 1.25, 1.0817821177906621, 1.0146699266503667, 1.013010593000824, 1.030909090909091, 1.5, 1.0600272851296044, 1.0014003921097907, 1.146359312111233, 1.0946055402559534, 1.0404971932638332, 1.0899529476889012, 1.134470647265429, 1.3432835820895523, 1.0555555555555556, 1.0660482132357745, 1.1443003541427863, 1.2180722891566265, 1.0597014925373134, 1.6666666666666667, 1.1428571428571428, 1.0300933966269152, 1.034108527131783, 1.0327747890366117, 1.0877727730228641, 1.0113568439928273, 2.4, 1.085987261146497, 1.0171831089396248, 1.1980444785276074, 1.2044728434504792, 1.07694026182923, 1.1336898395721926, 1.2664199814986123, 1.0253658536585366, 1.0331062579713124, 1.0553237419541668, 1.0370731707317074, 1.0895691609977325, 1.0555555555555556, 1.1381909547738693, 1.2020623425692696, 1.0507288200115432, 1.0224358974358974, 1.1149484536082475, 1.0504413619167718, 1.0668789808917198, 1.1905781584582442, 2.3333333333333335, 2.0, 1.1428571428571428, 1.0, 1.0038784744667097, 1.0772565102864193, 1.001005964441654, 1.0694349897889721, 1.0181500872600349, 1.2744186046511627, 1.1546666666666667, 1.0543218392148381, 1.6, 1.3333333333333333, 1.0341571785615107, 1.125, 1.0267857142857142, 1.1239600665557403, 1.031564707650684, 1.1043149887658699, 2.5, 1.0015523932729624, 1.1770657672849916, 1.0815676157596221, 1.039244913793433, 1.0776397515527951, 1.1293916023993145, 1.1572626118336966, 1.0831962055948117, 1.0067567567567568, 1.082191780821918, 1.1218934911242604, 1.0, 1.2, 1.0412928263630505, 5.0, 1.3333333333333333, 1.605263157894737, 1.0668789808917198, 1.0955984922684237, 1.0315265486725664, 1.0546875, 1.3333333333333333, 3.8793103448275863, 1.0130497825036249, 1.1764705882352942, 1.3177189409368635]
origin-bjaq_15.71 	max: 5.0000	99th: 3.0000	95th: 1.6667	median: 1.0807	mean: 1.1860

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.083251 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.226663