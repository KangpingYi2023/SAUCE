Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 98, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.5844	95th: 1.6823	median: 1.0826	mean: 1.1748
ReportEsts: [1.0, 1.0138020833333334, 1.0517917335763782, 1.056910569105691, 1.5789473684210527, 1.0, 1.088793151681307, 1.0574814282404232, 1.0, 1.0196335078534031, 1.0698063659712003, 1.042830800304775, 1.036118363794604, 1.130232558139535, 1.0830095372659838, 1.0, 1.3432835820895523, 1.0028338646829613, 3.0, 2.0, 1.08, 1.097566748721833, 1.0730226745224067, 1.1579565472695243, 1.122841637888505, 1.0, 1.147694292163818, 1.2, 1.2, 1.0, 1.0, 1.0344599854794831, 1.0081043009694404, 1.0610432852386238, 1.0026435599941255, 1.2190311133118759, 1.1871657754010696, 1.0014617682053275, 1.113403126937117, 1.05, 1.272430668841762, 1.0030487804878048, 1.0, 1.0883048381229539, 1.120463187003111, 1.8333333333333333, 1.0618556701030928, 1.2332155477031803, 1.0370115877210815, 1.0185185185185186, 1.0784178736117425, 1.1890034364261168, 1.037875198285985, 2.0, 1.2025974025974027, 1.2811484942053977, 1.1925411968777104, 1.3461538461538463, 1.0662251655629138, 1.0, 1.1001681206833878, 1.099626400996264, 1.1409090909090909, 1.0114942528735633, 1.0, 1.1964137816796423, 1.3144147049338923, 1.75, 1.0, 1.0157546378297753, 1.016990291262136, 1.059675550405562, 1.049645390070922, 1.1541418223032573, 1.091764705882353, 1.0778443113772456, 1.0, 1.1106471816283925, 2.0, 1.00360125111194, 1.1851851851851851, 1.02600809473842, 1.165644171779141, 1.1136653895274584, 1.1113837095191363, 1.04, 1.0730307671429402, 1.0267085813015935, 1.0294117647058822, 1.75, 1.1, 1.0488909541147338, 1.0809968847352025, 1.0200286123032904, 1.0164383561643835, 1.077922077922078, 1.0305343511450382, 1.156959526159921, 1.0, 1.2357481530488477, 1.0217422606191504, 1.0608919382504287, 1.2347072150575114, 1.2592592592592593, 1.006708920822165, 1.0634457127687815, 1.3046481739316698, 1.1266590822904816, 1.0499693439607602, 1.3333333333333333, 2.0, 1.0735981308411215, 1.0364183341631092, 1.071383449147189, 1.0909090909090908, 1.0611382052348368, 1.0, 1.1043834752444024, 1.1585365853658536, 1.0, 1.011111111111111, 1.0, 1.218045112781955, 1.0243821341530277, 1.0690378193678651, 1.12, 1.8, 1.1523178807947019, 1.0, 1.0, 1.1005919579597387, 1.1818181818181819, 1.0843098958333333, 1.0290528616377876, 1.0878418675981938, 1.0427236315086783, 1.0735294117647058, 1.058067030397506, 1.039972432804962, 1.0615478366849482, 1.0521271862271966, 1.2, 1.0386178861788617, 1.067566416375607, 2.0, 1.01640838650866, 1.0011428571428571, 1.103353867214237, 1.1284630315863773, 1.5, 1.1215790748365222, 1.024279210925645, 1.0395010395010396, 1.1074561403508771, 1.110948905109489, 1.0996291301416048, 1.089267166762839, 1.1707136824324325, 1.0778688524590163, 1.1019736842105263, 1.2857142857142858, 1.4526315789473685, 1.01620029455081, 1.4285714285714286, 1.0303558741845895, 1.045551243242419, 1.1642091152815013, 1.3671417415072238, 1.1227709190672153, 1.0767008560600038, 1.2842105263157895, 1.0942528735632184, 1.0737871598721798, 1.1061678463094033, 1.048868778280543, 1.0942662779397474, 1.047921294827039, 1.0934508175887485, 1.069340253204372, 1.0, 1.0, 1.021773612112473, 1.0285087719298245, 1.1628307162830716, 1.0921052631578947, 1.0848116795485216, 1.2373630597732077, 1.1572625154210765, 1.1153846153846154, 1.2427272727272727, 1.0444212896426177, 1.0, 1.2727272727272727, 1.0349057745853678, 1.0998751560549314, 1.0111888111888112, 1.3461538461538463, 1.0784565916398714, 1.05503630207022, 1.0593042470749126, 1.0626410835214446, 1.062717402761674, 1.5593220338983051, 1.0847457627118644, 1.2, 1.0, 1.3793103448275863, 1.05858697366346, 1.3588850174216027, 1.2528735632183907, 1.0128521997034108, 1.0031277926720286, 1.0075433266588414, 1.0161469315281322, 1.2371042905351117, 1.2222222222222223, 1.0484848484848486, 1.0084967320261438, 1.0457378367511057, 1.0269672179389089, 1.0, 1.0306418219461697, 1.106099698658736, 1.0147456278578748, 1.1399026763990268, 1.0042997863136498, 1.276880704217746, 1.0357142857142858, 1.0047221060255982, 1.1905621454357918, 1.003384094754653, 1.0434782608695652, 1.2055513878469617, 1.0437137330754351, 1.1086614173228346, 2.0, 1.167448275862069, 1.0913354175971415, 1.1223628691983123, 1.112033195020747, 1.0, 1.6666666666666667, 1.1287525720616942, 1.1090909090909091, 1.1301069421787202, 1.5, 1.0, 1.0256410256410255, 1.0288836846213896, 1.030612244897959, 1.0276243093922652, 1.1677215189873418, 1.0686106346483706, 1.0067170445004199, 1.1188711019918314, 1.0350877192982457, 2.0, 1.11186848436247, 1.0974397590361447, 1.1260945709281962, 1.0495014319459832, 1.100570214669052, 1.0050108788817829, 1.089825119236884, 1.0800485889829763, 1.0305023923444976, 1.0591785661710584, 1.1227078450296428, 1.1818181818181819, 1.0494680046392013, 1.053932584269663, 1.1818181818181819, 1.3157894736842106, 1.0, 1.0555555555555556, 1.0085470085470085, 1.0994549491958818, 1.0306406685236769, 1.3859649122807018, 1.0092064909580156, 1.0365217391304349, 1.0305034325721658, 1.0448558028140904, 1.1111111111111112, 1.0527828301200437, 2.5, 1.0431504989180618, 1.0, 1.0177188111601656, 1.0810810810810811, 2.0, 1.4782608695652173, 1.109375, 1.08630476969993, 1.0, 1.007645259938838, 1.0497737556561086, 1.0060096153846154, 1.0181653965893778, 1.1317365269461077, 1.1572327044025157, 1.0059019476866826, 1.1804822657137133, 1.0962255052387007, 1.1282051282051282, 1.0, 1.1336515513126493, 1.2492307692307691, 1.1505376344086022, 1.0157961246840774, 1.0296080066722268, 1.1915492957746479, 1.2040816326530612, 1.0181564245810055, 1.0506912442396312, 1.2857142857142858, 1.0037193841713143, 1.0419847328244274, 1.0, 1.1161202933450087, 1.2380952380952381, 1.2727272727272727, 1.0128658678332172, 2.0, 1.1824417009602195, 1.058139534883721, 1.066447908121411, 1.0813905930470347, 1.0469973890339426, 1.123456790123457, 1.102395865744937, 1.0608553832672039, 1.0237099023709901, 1.0513452702178467, 1.0410661258781777, 2.0, 1.0, 1.0656779176855047, 1.25, 1.0697544642857142, 1.3529411764705883, 1.0, 1.4666666666666666, 1.3534136546184738, 1.0709555345316935, 1.2524271844660195, 1.0735930735930737, 1.0, 1.2430093209054593, 1.057902830631288, 2.0, 1.1798689696247766, 1.0, 1.0969407120625523, 1.0853658536585367, 1.0112240295061958, 1.1474654377880185, 1.1363636363636365, 1.3161434977578474, 1.3425925925925926, 1.0158290022909422, 1.026136140074759, 1.0821325648414986, 1.0, 1.0769230769230769, 1.5714285714285714, 1.5, 1.3333333333333333, 1.0696648485472195, 1.3333333333333333, 1.086522462562396, 1.1477272727272727, 1.163301400147384, 1.0872810344677253, 1.2409886714727085, 1.029813913947008, 1.0104408352668213, 1.0452380952380953, 1.5, 1.3793103448275863, 1.0553191489361702, 1.0434969382337804, 1.1428571428571428, 1.5714285714285714, 1.0356347438752784, 1.0105757931844888, 1.0261034861617342, 1.0277078085642317, 1.1464387464387464, 1.016142270861833, 1.0, 1.0907770515613653, 1.0752118644067796, 1.2884615384615385, 1.0254957507082152, 1.1714285714285715, 1.0539033748336073, 1.0862669909519667, 1.0087112412887587, 1.131578947368421, 1.3875, 1.0914634146341464, 1.0, 1.0058225449952636, 1.0508909825033648, 1.0841827381388869, 1.0665989328960346, 1.0726153846153845, 1.15379726723864, 1.5714285714285714, 1.2045322486926207, 1.2, 1.2621690862510675, 1.25, 1.0406264133876073, 1.027536231884058, 1.0692175408426483, 1.173913043478261, 1.154772937905468, 3.0, 1.241906147690069, 1.0135150088214864, 1.084858377781865, 2.0, 1.0677966101694916, 1.2504798464491362, 1.2936802973977695, 1.0987047056894572, 1.2245322245322245, 1.1666666666666667, 1.0112165660051768, 1.0154258727484158, 1.0990728585493927, 1.0993962497823015, 1.1095394736842106, 1.175787728026534, 1.3068181818181819, 2.142857142857143, 1.0794520547945206, 1.5, 1.232968881412952, 1.2692307692307692, 1.1143948864306437, 2.272727272727273, 1.0963129715259188, 1.1190603034937874, 1.1030228254164096, 1.0, 1.1875, 1.2, 1.2870092147435896, 1.0722100656455142, 1.0, 1.037408628350294, 1.1534876158473795, 1.0733526730211356, 1.5, 2.0, 1.0050741608118656, 1.0090415913200723, 1.0131147540983607, 1.1111111111111112, 1.0811639683332144, 1.0362035225048924, 1.4705882352941178, 1.0039705048213272, 1.0454545454545454, 1.1338582677165354, 1.0169354838709677, 1.3230963399242743, 1.0598649388574557, 1.0, 1.0724637681159421, 1.039411303250452, 1.0410138564132696, 1.032373342841399, 1.0, 1.0982083609820836, 1.0064911825640992, 1.0220010476689365, 2.0, 1.0330940988835726, 1.0089920436890918, 1.0031795566284925, 1.0463064086322136, 1.0035870603996386, 1.0350153991945037, 1.0058823529411764, 1.1159594985535197, 2.0, 1.0556617913070443, 1.6818181818181819, 1.25, 1.2020725388601037, 1.1730769230769231, 1.004363518154236, 1.1051643192488263, 1.0345681136150773, 1.036714089031666, 1.076423177461516, 1.021273656582401, 1.042956875527353, 1.197674418604651, 4.0, 1.004570879846357, 1.1781376518218623, 1.0464741405365683, 1.0440049491180787, 1.1273465246067986, 1.1825757575757576, 2.580246913580247, 2.2857142857142856, 1.01073671909237, 1.0681871358060455, 1.0375498619208345, 1.138536221060493, 1.1068019668337832, 1.0232067510548524, 1.0721908152960407, 1.0, 1.2114197530864197, 3.0, 1.0833333333333333, 1.0076687116564418, 1.0741444866920151, 1.0700179533213645, 1.1036745406824147, 1.0602910602910602, 1.5075757575757576, 1.148905109489051, 1.116564417177914, 1.1018481046809658, 1.2988505747126438, 1.000538934142248, 2.0, 1.0388059701492538, 1.024390243902439, 1.175, 1.0840782122905028, 1.045766590389016, 1.1933962264150944, 1.0674448767833982, 1.074121307963067, 1.0, 1.425531914893617, 1.2, 1.0, 1.1590909090909092, 1.1653225806451613, 1.0093457943925233, 1.087378640776699, 1.0610381288048703, 1.051044083526682, 1.0561143270622286, 1.1927554980595083, 1.0290964777947933, 1.098734527791389, 1.0864864864864865, 1.1473183978275627, 1.03096274794388, 1.1145459563897322, 1.3728323699421965, 1.1631628490743646, 1.0489535296204329, 1.4492302215893922, 1.0755957368961488, 2.0, 1.3341523341523343, 1.0918264379414733, 1.4205607476635513, 1.0, 1.0625, 1.25, 1.1970338983050848, 1.1851851851851851, 1.1666666666666667, 1.0009586183007484, 1.122391989468225, 1.0243410331358804, 1.050007925186242, 1.2540540540540541, 1.1197278911564625, 1.0, 1.1240875912408759, 1.004758948893027, 1.0612797832496614, 1.0850309393033442, 1.0855450506891446, 1.034859194019909, 1.2, 1.1124344926155312, 1.0870337477797514, 1.0174339081104111, 1.1285698149438055, 1.2727272727272727, 1.0725720384204909, 1.0, 1.2422535211267605, 1.2052427701830255, 3.0, 1.1309661056029514, 1.0579587544012072, 1.4285714285714286, 1.0160682259068117, 1.6, 1.1875, 1.0659339000196277, 1.6923076923076923, 1.008852712616173, 1.0286202477573687, 1.3571428571428572, 1.1153846153846154, 1.1030927835051547, 1.0396939263510283, 1.0116997792494482, 1.0882507212168895, 1.1557358300675522, 1.0, 1.0838040408429286, 1.1097560975609757, 2.0, 1.0368767188807844, 1.1105026386365602, 1.130558183538316, 1.0129835397497533, 1.0121602022981666, 1.0176991150442478, 2.0, 1.0309803921568628, 1.0725806451612903, 1.1096160046154107, 1.1579760525299343, 1.0096248609582212, 1.0491647975034482, 1.0934065934065933, 1.118601747815231, 1.2006688963210703, 1.0679135203217738, 1.068769716088328, 1.0009057971014492, 1.065126050420168, 1.0487226394800466, 3.0, 1.1241140499521107, 1.0116897446347453, 1.037880687827803, 1.4615384615384615, 1.3105124288293293, 1.231818181818182, 1.1428571428571428, 1.0810820342808776, 1.0420575865415722, 1.1495633187772927, 1.088235294117647, 1.3333333333333333, 1.0685284561749353, 1.5, 1.016355140186916, 1.0, 1.018561161119252, 1.3846153846153846, 1.2025316455696202, 1.0272536687631026, 1.0, 1.7010582010582012, 1.3483245149911816, 1.25, 2.0, 1.1271186440677967, 1.1206896551724137, 1.0020808561236623, 1.186799501867995, 1.1347517730496455, 1.2094395280235988, 1.1014466214978942, 1.0571428571428572, 1.183574879227053, 1.1061224489795918, 1.1153846153846154, 1.0, 1.0792616720955484, 1.0606060606060606, 1.0361570247933884, 1.0843725424109651, 1.0399915027919397, 1.0530441599163836, 1.0892671864346486, 1.1839574898785425, 1.1905444126074498, 1.0263319044703, 1.375, 1.0, 1.2142857142857142, 1.0400849965849586, 1.0979699911738747, 1.107843137254902, 1.1246537396121883, 1.062237495227186, 1.0086630323311923, 1.0126696776703106, 1.1142857142857143, 1.2222222222222223, 1.0242608036391205, 1.0886134676564156, 1.0719326462285828, 1.0597537573711708, 1.019736842105263, 1.0647519196692263, 1.0294240305727849, 1.038563829787234, 1.375254582484725, 1.125, 1.0674698795180724, 1.4677685950413224, 1.1063829787234043, 1.063768115942029, 1.0701001430615165, 1.0, 1.0186046511627906, 1.0102769381586472, 1.0188679245283019, 1.0740811501444845, 1.0547486033519553, 1.303030303030303, 1.016561867723137, 1.0390771449170872, 1.07232070910556, 1.066793893129771, 1.0022701475595914, 1.1961306414102262, 1.2147505422993492, 1.2142857142857142, 1.0, 1.6666666666666667, 1.074022041903839, 1.3333333333333333, 1.2034742139726176, 1.0955522050508857, 1.02754381971318, 1.0377358490566038, 1.0512820512820513, 1.0737406216505896, 1.050179211469534, 1.0097087378640777, 1.0305398361002185, 1.088324896887889, 1.0393075102752523, 1.2231723473443334, 1.4285714285714286, 1.0491803278688525, 1.0079681274900398, 1.1035911123435822, 1.0, 1.2736305048335124, 1.0216998191681737, 2.1829787234042555, 1.059993650646163, 1.0577181208053692, 1.0569976076555023, 1.125, 1.094933283128986, 1.0274425763876487, 1.2990271377368152, 1.0581052631578947, 1.0666666666666667, 1.0565610859728507, 1.0414507772020725, 1.625, 1.0546224468009395, 1.3846153846153846, 1.312169312169312, 1.0483870967741935, 1.02832097100472, 1.0212156928775888, 1.0119047619047619, 4.090909090909091, 1.0821256038647342, 1.0906283319239678, 1.0677593199622202, 1.0103599200592708, 1.0237753124373454, 1.0708493160282346, 1.0, 1.0894239036973346, 1.0176938369781312, 1.0568105719005312, 1.0360721442885772, 1.0138888888888888, 1.0770964833183048, 1.0027564564691913, 1.410860655737705, 1.0202392395599702, 1.0, 1.3333333333333333, 1.0801008677594006, 1.0439189189189189, 1.2307837761179918, 1.0912241682883885, 1.0678371907422186, 1.1568123393316196, 1.1062384796601314, 1.0829739971253103, 1.1029411764705883, 1.0755813953488371, 1.039301310043668, 1.0917636086977862, 1.0952380952380953, 1.75, 1.0593988915419834, 1.1709412794656464, 1.0085518814139112, 1.0738636363636365, 1.2128892107168718, 1.0164178893506346, 1.186393027832443, 1.2345679012345678, 1.2307692307692308, 1.0747978436657681, 1.1098130841121496, 1.146875, 1.4827586206896552, 1.0524863113197005, 1.1665014866204162, 1.1600331674958542, 1.0975609756097562, 1.0238138228508376, 1.034959661928544, 1.071285140562249, 1.2547039017627253, 1.3333333333333333, 1.0769230769230769, 1.3333333333333333, 1.1281783350748869, 1.4615384615384615, 1.0, 1.25, 1.1125827814569536, 1.0036231884057971, 1.0162001399580125, 1.0487523799979959, 1.1309090909090909, 1.36, 1.1428571428571428, 1.032258064516129, 1.054054054054054, 1.0142857142857142, 1.1403197158081706, 1.0259517907917575, 1.0302623279284628, 1.3617021276595744, 1.094615758122867, 1.046804464241029, 2.5, 1.067903439828519, 1.2544802867383513, 3.0, 2.0, 1.1967455621301775, 1.1137488345406297, 1.0471136938981656, 1.204968944099379, 1.0, 1.0886075949367089, 1.4938650306748467, 3.0, 2.0, 1.042585941508466, 1.2138728323699421, 1.0236161439460203, 1.6666666666666667, 1.0322373521586627, 1.0441518202943454, 1.0072314049586777, 1.0, 1.0328638497652582, 1.0247876378717629, 1.131578947368421, 1.1018064361765763, 1.0192199530653012, 1.3157894736842106, 1.1328125, 1.12668187532008, 1.1120607787274455, 1.1115702479338843, 1.15, 1.0104828853362644, 1.0252037617554859, 1.0601482560530056, 1.218978102189781, 1.1568627450980393, 1.2238805970149254, 1.110803324099723, 1.05243561898852, 1.0189579243920548, 1.074474037171872, 1.0633187772925765, 1.5, 1.6666666666666667, 1.1006840120181551, 1.2132805628847845, 1.1231277961486092, 1.02199285723052, 1.0485030941629034, 1.1128977657413677, 1.0045558086560364, 1.0, 1.0845059350679978, 1.0802120359146103, 1.2477941176470588, 1.2200854700854702, 2.5, 1.0416666666666667, 1.036069935385785, 1.1605657237936773, 1.0237635147004807, 1.0897832020186415, 1.0113636363636365, 2.0, 1.064676616915423, 1.0256297150871478, 1.1798035183915925, 1.015209125475285, 1.0807228341200592, 1.0194805194805194, 1.2538631346578366, 1.001159420289855, 1.0328677343146113, 1.0666722788113479, 1.0483870967741935, 1.0441176470588236, 1.0, 1.1562932226832643, 1.0528156138586708, 1.0752840909090908, 1.0540883088411606, 1.1024539877300614, 1.0317700453857792, 1.2, 1.2265625, 1.6666666666666667, 2.0, 1.1176470588235294, 1.0051150895140666, 1.0347551342812007, 1.0239552834708545, 1.021508917497113, 1.0529172320217097, 1.0985980234428867, 1.184782608695652, 1.3243243243243243, 1.0386021030184418, 1.6, 1.5, 1.1727688787185355, 1.1428571428571428, 1.1044117647058824, 1.1279127416955874, 1.015096065873742, 1.0883527292204314, 2.0, 1.0784641068447411, 1.2054263565891472, 1.0861321776814734, 1.040340559831922, 1.119949494949495, 1.114041095890411, 1.1476556563715192, 1.0878548434299093, 1.0465890183028286, 1.0289855072463767, 1.0907821229050279, 1.0, 1.0, 1.041218125245878, 5.0, 1.4285714285714286, 1.3846153846153846, 1.025990099009901, 1.0681818181818181, 1.0753880266075388, 1.0929776382895253, 1.0, 1.0881440099317194, 1.019859813084112, 1.1494845360824741, 1.2668269230769231, 1.4285714285714286, 1.040119553971721, 1.1801552106430155, 1.1343612334801763, 1.01785050204537, 1.0167611535617451, 1.0947709212204455, 1.1262939958592133, 1.0, 1.2143673054956212, 1.016091941757415, 1.0045283357245338, 1.1774193548387097, 1.0708624948538492]
origin-bjaq_15.71 	max: 5.0000	99th: 2.5844	95th: 1.6823	median: 1.0826	mean: 1.1748

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 13.908149 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[1.1920929e-07 4.1723251e-07 1.1920929e-07 5.9604645e-07 1.7881393e-07]
Distance score: 2.8610230629055877e-07
SAUCE Drift detection: False
Detection latency: 0.0232s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.031030 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.8762	95th: 1.7161	median: 1.0819	mean: 1.1835
ReportEsts: [1.0467532467532468, 1.0104257167680277, 1.0355092045262624, 1.0890410958904109, 1.4782608695652173, 1.0, 1.0622566331612786, 1.0593131373725255, 1.1666666666666667, 1.0252469813391878, 1.1098705423745128, 1.0432163485567618, 1.0450745183569612, 1.1321499013806706, 1.0930780559646538, 1.1824, 1.1257668711656441, 1.5, 1.2727272727272727, 1.0965630114566285, 1.091656482613043, 1.0432348334109478, 1.3231240428790199, 1.0041459369817578, 1.0154206760424378, 1.0301961508710762, 2.0, 1.18976183111661, 1.75, 1.1666666666666667, 1.0913705583756346, 1.0, 1.0432391902024494, 1.000756645010375, 1.1449474165523548, 1.0382432765852454, 1.2314618459933948, 1.0338266384778012, 1.0, 1.0801020408163264, 1.0251158480074143, 1.0274664463531356, 1.0706713780918728, 1.103498441288535, 1.0278810408921932, 1.082014487280717, 1.2380952380952381, 1.0158730158730158, 1.4850299401197604, 1.0580325548478415, 1.5, 1.174468085106383, 1.0836820083682008, 1.0303030303030303, 1.017155499673574, 1.0297488622956346, 1.0291708578818797, 1.1806282722513088, 1.1363636363636365, 1.0570047289890239, 1.328125, 1.0879036194096945, 1.0706605222734256, 1.1434108527131783, 1.1122448979591837, 3.0, 1.1339002452984464, 1.255987638423899, 1.75, 1.0, 1.0159325210871604, 1.0010172939979654, 1.063953488372093, 1.082514734774067, 1.1113662456946038, 1.0819521178637201, 1.0146435452793834, 1.1587301587301588, 1.5436893203883495, 1.1280547409579669, 1.0193892389723704, 1.36, 1.0, 5.0, 1.0559910414333706, 1.2982456140350878, 1.0957264957264958, 1.375, 1.5, 1.12201233616037, 1.113235958439994, 1.1430311643487971, 1.039936632853821, 1.1508515815085159, 1.064676616915423, 1.0298165137614679, 1.0178571428571428, 1.0052356020942408, 1.1788990825688073, 1.2681564245810055, 1.1538461538461537, 2.0, 1.0499496750200448, 1.3034095813552007, 1.0611664295874823, 1.226308957161402, 1.375, 1.016583061923363, 1.045859305431879, 1.2721386981837142, 1.1175914249684742, 1.0414004600051112, 1.0, 1.8, 1.0295823665893271, 1.058007054912084, 1.0416447021613073, 1.0693069306930694, 1.056731911242263, 2.0, 1.0837451235370612, 1.181139122315593, 1.0, 1.0135746606334841, 1.0, 1.2430703624733475, 1.0224248819510355, 1.1221107154418906, 1.1382113821138211, 1.6666666666666667, 1.2004175365344467, 1.0, 2.0, 1.1210079379730478, 1.0833333333333333, 1.0452163788084612, 1.0150214592274678, 1.0890808667327574, 1.5, 1.5, 1.0143149284253579, 1.0662811387900355, 1.0834186284544525, 1.036132908460491, 1.2278481012658229, 1.0251503553854566, 1.1099314894696777, 1.0, 1.0393366756652527, 1.0307692307692307, 1.0859977949283353, 1.111845972957084, 2.0, 1.0892695214105794, 1.0449293966623876, 1.005181347150259, 1.090805902383655, 1.0, 1.004930966469428, 1.188585144685958, 1.0890349444807315, 1.0791738382099827, 1.0767123287671232, 1.2333333333333334, 1.3739837398373984, 1.008515815085158, 1.7142857142857142, 1.05154509754691, 1.0769230769230769, 1.1206896551724137, 2.25686591276252, 1.1200619674670798, 1.0678135543799725, 1.3156966490299824, 1.0909090909090908, 1.076280041797283, 1.021505376344086, 1.028910303928836, 1.0556451612903226, 1.04565730779323, 1.0798687089715535, 1.21353721959171, 1.1840490797546013, 1.1578947368421053, 1.0213745539263723, 1.1108490566037736, 1.337037037037037, 1.1215343915343916, 1.0583756345177664, 2.0, 1.2478632478632479, 1.0802273214668667, 1.0740740740740742, 1.1312625250501003, 1.0160439310161578, 1.081157789141445, 1.0944212641013753, 1.0494186046511629, 1.0660589013344048, 1.0106674894002927, 1.0085679314565483, 1.0779092127498398, 1.0335776779380468, 1.0731598799106945, 1.0695815702867888, 1.0282084975908892, 1.2807881773399015, 1.1014492753623188, 1.1494252873563218, 1.0, 1.35, 1.137687324128002, 1.2973760932944607, 1.44, 1.006570841889117, 1.1, 1.0378680624079397, 1.0446009389671362, 1.2321741904609986, 1.5, 1.0460606060606061, 1.0149782135076253, 1.0492436934565124, 1.049465468353923, 1.5, 1.0443760984182777, 1.1416788525048058, 1.0028177085820718, 1.0566037735849056, 1.0083194675540765, 1.11015911872705, 1.090303331675783, 1.4778761061946903, 1.0084259111440834, 1.0126788540923057, 1.0429447852760736, 1.05742935278031, 1.080681818181818, 1.0526315789473684, 1.091976516634051, 2.0, 1.199193739625326, 1.072351901794848, 1.105921438342779, 1.3265306122448979, 1.0714285714285714, 1.5, 1.0800358259797085, 1.0579710144927537, 1.1235982081116023, 1.4, 1.0392156862745099, 1.0419222903885481, 1.4285714285714286, 1.0017991856317667, 1.0, 1.1463195691202872, 1.0085470085470085, 1.0049174569722514, 1.1484091532147522, 1.0289855072463767, 2.0, 1.1035838823821722, 1.0256831241937376, 1.0902474526928676, 1.0088444730748471, 1.1372398026711588, 1.039522215286841, 1.0792922673656618, 1.0868542876037917, 1.0423387096774193, 1.0593685237108375, 1.1260494537090282, 1.0, 1.03502521774252, 1.2516703786191536, 1.26, 1.2272727272727273, 1.1663644605621033, 1.3028846153846154, 1.0918776213301378, 1.014825085324232, 1.2079439252336448, 1.394572025052192, 1.0203862554787133, 1.1011494252873564, 1.1740180573926045, 1.0410561772934768, 1.1, 2.0, 1.0909090909090908, 1.0585460599334073, 1.0795144016651743, 1.038348891871251, 1.190702588483888, 1.183901621017328, 1.0407521269750482, 1.014883374016816, 1.0752566180443004, 1.0819618636853754, 1.0312796208530806, 1.3157894736842106, 1.1538461538461537, 1.0953026196928637, 1.05, 1.0035398230088495, 1.1420716467647876, 1.0591078441244588, 1.6176470588235294, 1.04, 1.1891891891891893, 1.0125852123754588, 1.0352812019698252, 1.173913043478261, 1.1166705363361968, 1.0181971080847485, 1.0807291666666667, 1.4444444444444444, 4.166666666666667, 1.0410372040586247, 1.25, 1.0035385319251726, 1.0457413249211356, 1.0909090909090908, 1.0868876195688113, 1.5217391304347827, 1.5, 1.021436797193882, 2.0, 1.032258064516129, 1.0166270783847982, 1.1452231252875327, 1.0160427807486632, 1.0953488372093023, 1.2282608695652173, 1.128495842781557, 1.068272684837538, 1.5, 1.0257755426522193, 1.0623618954087897, 3.0, 1.2, 1.0250118832588648, 1.0, 1.0683085501858736, 1.4736842105263157, 1.3333333333333333, 1.6111111111111112, 1.3654008438818566, 1.0543307086614173, 1.15, 1.3615819209039548, 1.2560975609756098, 1.5, 1.0886897197511871, 2.0, 1.1285714285714286, 1.0107742977202139, 1.1612903225806452, 1.053183520599251, 1.028169014084507, 1.4, 1.5, 1.3322528363047001, 1.391304347826087, 1.056544502617801, 1.1317119954533077, 1.2412682685162248, 1.0, 1.3333333333333333, 1.0292512710668231, 1.2923076923076924, 1.2666666666666666, 2.0, 1.1048387096774193, 1.4285714285714286, 1.065359477124183, 1.305263157894737, 1.255393106376204, 1.0690233977619532, 1.155668358714044, 1.0576661034501553, 1.1226095212260951, 1.0790190735694822, 1.0780559646539027, 1.086119765939661, 1.1112984822934233, 1.027027027027027, 1.0010061692820769, 1.0682462651060995, 1.034307992202729, 1.0625, 1.0232558139534884, 1.1649269311064718, 2.0, 1.0833333333333333, 1.6436781609195403, 1.0775047258979207, 1.3421052631578947, 1.10586011342155, 1.0948745910577973, 1.217081850533808, 1.3316558830577523, 1.0862266310568485, 1.0311573636076947, 1.1030927835051547, 1.2376237623762376, 1.1170483460559797, 1.0, 1.1240015298038573, 1.4509803921568627, 1.1035375486601913, 1.0133233257960108, 1.0460362306797408, 1.170751198721364, 2.125, 1.2419678714859437, 1.0, 1.1436643999616896, 1.25, 1.1217394659669702, 1.0181159420289856, 1.0516608469871966, 1.152542372881356, 1.1282820705176293, 4.0, 1.2516010978957, 1.0131732601257912, 1.1294372460323545, 2.0, 1.0769230769230769, 1.2386731391585761, 1.258160237388724, 1.1161005765089949, 1.0805263674752037, 1.0416666666666667, 1.03470715835141, 1.0159163610829367, 1.0695963379109446, 1.0389120037905148, 1.0571486141020312, 1.0036231884057971, 1.0528169014084507, 1.0222617987533393, 1.0691854120991882, 1.112, 1.122325836533187, 1.0, 1.3333333333333333, 1.2657894736842106, 1.0592592592592593, 1.016173434273916, 1.1275466407233605, 1.0625641025641026, 1.0, 1.1074380165289257, 1.1, 1.1134473317146252, 1.0416666666666667, 1.0, 1.0256555619691596, 1.0, 1.0, 1.026366808840636, 1.5, 1.0129533678756477, 1.0045112781954888, 1.0520547945205478, 1.4444444444444444, 1.0772750494213812, 1.1165217391304347, 1.45, 1.0322413233863121, 1.0454545454545454, 1.098233995584989, 1.0328859060402684, 1.4052924791086352, 1.0606691374320962, 1.0, 1.0588235294117647, 1.2337242215932067, 1.110319695212854, 1.0494812450119713, 1.0, 1.0704642130571482, 1.0024086271648154, 1.0285839929639402, 2.0, 1.0376237623762377, 1.0050863902309946, 1.020987931939135, 1.0182610274096933, 1.005951122034467, 1.0778489588129283, 1.0, 1.0120122447397992, 1.75, 1.0755607517104009, 1.0755494505494505, 1.0507651202331796, 1.086522462562396, 1.0052910052910053, 1.0089180291433413, 1.1153846153846154, 1.033538797674771, 1.2204301075268817, 1.1139686711303005, 1.0126984126984127, 1.139060630235341, 1.0081129807692308, 1.0459770114942528, 1.3157894736842106, 1.146243881407086, 1.1106290672451193, 1.0011609192369595, 1.0673953916313306, 1.3333333333333333, 1.036336109008327, 1.0791139240506329, 1.0888888888888888, 1.1956521739130435, 1.0106125014562726, 1.0774647887323943, 1.0516014234875444, 1.0, 1.5, 1.0027143180275955, 1.0969995750106247, 1.0420386904761905, 1.0045939252396412, 1.092206790123457, 1.0159646739130435, 1.0223577235772359, 1.046526968153648, 1.4972375690607735, 1.0138706595941318, 1.121978021978022, 1.1624365482233503, 1.0703370559212375, 1.0512820512820513, 1.02704021094265, 2.0, 1.1954187544738726, 1.01628664495114, 1.0573238654850996, 1.0986547085201794, 1.0571151984511133, 1.0288461538461537, 1.0651310563939635, 1.1492073607902493, 2.0, 1.2363636363636363, 1.5, 1.0, 1.1111111111111112, 1.376543209876543, 1.0492021276595744, 1.1142857142857143, 1.0661157024793388, 1.0470588235294118, 1.028969563623029, 1.1759702286018074, 1.0330803675023421, 1.0812781598292625, 1.0219817863352272, 1.1108683779355544, 1.0305772140114047, 1.0495231291749696, 1.0279548798430602, 1.0890336590662324, 1.14625, 1.564102564102564, 1.0416213384906725, 1.1478463329452853, 1.1026488762939348, 1.3693181818181819, 1.2121504339440694, 1.0868686868686868, 1.0, 1.0244470314318976, 1.1176470588235294, 1.6, 1.3094339622641509, 1.046615271544512, 1.0352985354862936, 1.013089005235602, 1.1483516483516483, 1.0701457133175194, 1.026585904398162, 1.0577617328519855, 1.2, 2.3333333333333335, 1.0575206237992993, 1.091703056768559, 1.1828571428571428, 1.1386792452830188, 1.0, 1.1340694006309149, 1.1773835920177385, 1.056854593555384, 1.1404833836858006, 1.02626809901915, 1.1978551632726835, 1.0025724750399334, 1.4111111111111112, 1.25, 1.1190317452177034, 1.0, 1.0925925925925926, 1.1694915254237288, 1.4501076812634601, 1.1066666666666667, 1.608695652173913, 1.1639928698752229, 1.0748299319727892, 1.3397129186602872, 1.0192061459667094, 1.1941935483870967, 1.1692832764505119, 1.0572870287919265, 1.0081154192966637, 1.0614583333333334, 1.2, 1.0160975796275762, 1.1068500962292394, 1.1, 1.0142954390742, 1.2473476811154895, 1.0192307692307692, 1.0584707104466826, 1.4444444444444444, 1.0327272727272727, 1.06468633965214, 1.0307328605200945, 1.2483660130718954, 1.1045606126389107, 1.015267175572519, 2.0, 1.0554994954591321, 1.0026899798251514, 1.116870796460177, 1.1896325459317585, 1.0194528407971435, 1.048793565683646, 1.3145896656534954, 1.0634340750581202, 1.2102272727272727, 1.0417192082288542, 1.0847096430474161, 1.0275502606105733, 1.1710234824988923, 1.0317773610974046, 1.1666666666666667, 1.0855327468230693, 1.0909090909090908, 1.1428571428571428, 1.0719794344473008, 1.6091854419410745, 1.0742857142857143, 1.2138728323699421, 1.0769230769230769, 1.0024019215372297, 1.0321880650994575, 1.0909090909090908, 1.045325137717896, 2.6666666666666665, 1.160559284116331, 1.5, 1.1462450592885376, 1.0666666666666667, 1.054308093994778, 1.3, 1.106896551724138, 1.0644038294168843, 1.0, 2.65, 1.1813437703848664, 1.2, 2.5, 1.1319444444444444, 1.2307692307692308, 1.0423444358378517, 1.1978947368421053, 1.1111111111111112, 1.198581560283688, 1.0790816326530612, 1.0131147540983607, 1.0929368029739777, 1.3003533568904593, 1.03125, 1.0, 1.1634241245136188, 1.0494117647058823, 1.0225694444444444, 1.116923076923077, 1.0767934256327043, 1.0556383868504309, 1.0663901440925754, 1.114800530312161, 1.1364161849710983, 1.0253036437246963, 2.0, 1.0, 1.1818181818181819, 1.0130063831131897, 1.0827838827838827, 1.1120218579234973, 1.1252900232018561, 1.0064208518753974, 1.0946081305579987, 1.0265674148804649, 1.1428571428571428, 1.1904761904761905, 1.125, 1.0353393379611038, 1.0518198062635193, 1.015007934201998, 1.032967032967033, 1.0480975430427057, 1.0410127243350868, 1.1357614584569147, 1.0708955223880596, 1.0775757480881973, 1.0686274509803921, 1.080983078162772, 1.0080645161290323, 1.0264730330446097, 1.2857142857142858, 1.100531914893617, 1.0, 1.0098425196850394, 1.0164165810208976, 1.0625, 1.062448556939171, 1.0043782837127846, 1.170731707317073, 1.0437586268663006, 1.0387457199495405, 1.0342686099532827, 1.0356012658227849, 1.0173076923076922, 1.191757779646762, 1.2045855379188712, 1.105263157894737, 1.0, 1.2222222222222223, 1.0612018552127445, 1.25, 1.1495860671684848, 1.0959590287293066, 1.0565119760479043, 1.0696599537801255, 1.1127286567235186, 1.01508255243195, 1.0510510510510511, 1.088547815820543, 1.0219859822232664, 1.101014246350472, 1.04191332583989, 1.1643198390746794, 1.875, 1.0722477064220184, 1.0096463022508038, 1.1002181481963045, 1.0407608695652173, 1.2990825688073395, 1.0387596899224807, 2.3284132841328415, 1.0666636371898572, 1.0448933782267116, 1.0700894058547379, 1.0454545454545454, 1.0965050810216974, 1.0160874349108902, 1.2448474855729597, 1.0567823343848581, 1.025, 1.017785998861696, 1.2457002457002457, 1.0274947794722522, 1.3259668508287292, 1.0188033183190905, 1.1590909090909092, 1.0783806407427137, 1.0819672131147542, 1.0075853350189634, 1.0469667318982387, 1.0552952202436738, 1.0694864048338368, 1.0695915279878971, 1.0163419676136185, 1.0450704225352112, 1.0517068560627756, 1.06647621539893, 1.0, 1.0986121256391526, 1.0563623789764869, 1.2082901554404144, 1.0063460253841015, 1.1316744427164334, 1.206896551724138, 1.125, 1.0151898734177216, 1.0672090683758024, 1.173913043478261, 1.1069549970777324, 1.2323268775812983, 1.0475881462253949, 1.007936507936508, 1.133965869700471, 1.1393960890753192, 1.0789648307896482, 1.2181425485961124, 1.0963729718628055, 1.1029232305302863, 1.184251968503937, 1.0504587155963303, 1.005306603773585, 1.0771277139992224, 1.15625, 2.5, 1.0471120502817512, 1.1705969746083198, 1.0071462601238685, 1.0289855072463767, 1.2213486543695191, 1.0008392077878483, 1.168685927306617, 1.12784588441331, 1.1176470588235294, 1.0692737430167598, 2.875, 1.1548556430446195, 1.5, 1.0951359818007216, 1.1489878542510121, 1.0456621004566211, 1.0384615384615385, 1.061923583662714, 1.1541019955654102, 1.0188679245283019, 1.1081081081081081, 1.03343653250774, 1.0576131687242798, 1.016245487364621, 1.0, 1.0065925825635045, 1.0223048327137547, 1.0272415018358403, 1.2372881355932204, 1.2352941176470589, 1.2880211391661773, 1.011602978242605, 1.0338797064673204, 1.249605055292259, 1.2903225806451613, 1.1176470588235294, 1.0769230769230769, 1.0106382978723405, 1.0987654320987654, 1.1059817945383614, 1.0304805113295752, 1.02999295156364, 1.3879310344827587, 1.088521040485484, 1.0471964350475842, 3.0, 1.106312513891976, 1.0842455973346026, 1.5, 3.0, 1.1552993130520117, 1.1279090637152258, 1.0444706930672552, 1.1978891820580475, 1.0, 1.0804195804195804, 1.2185929648241205, 1.2043010752688172, 1.0279582727105787, 1.1001927578135757, 1.0531261072197542, 1.0447452722951327, 1.8571428571428572, 1.0265050216913294, 1.05078125, 1.113699906803355, 1.0283922086497195, 1.035252643948296, 1.0, 1.2834645669291338, 1.1671080508474576, 1.010530612244898, 1.3763837638376384, 1.0754098360655737, 1.072760183224154, 1.0548148148148149, 1.106164383561644, 1.3387096774193548, 1.0624325173917204, 1.5494245625098533, 1.0709004645645943, 1.3131313131313131, 1.1370967741935485, 1.2333333333333334, 1.125, 1.1009660330320972, 1.061381074168798, 1.003640211013858, 1.0297297297297296, 1.5, 1.0441323971915748, 1.033675326824425, 1.1589668970534739, 1.0699210568712745, 1.0381408156026237, 1.0516315572077655, 1.1108293713681987, 1.0406976744186047, 1.0185185185185186, 1.0546548117154813, 1.1287735323604768, 1.2164705882352942, 1.152428810720268, 1.6666666666666667, 1.0114942528735633, 1.028049443086118, 1.0694444444444444, 1.0366851305273657, 1.095135065196452, 1.0087668030391583, 2.75, 1.0818467995802727, 1.0527063324895167, 1.1668564920273348, 1.2532894736842106, 1.079779172443265, 1.0183727034120735, 1.3210671573137074, 1.003898635477583, 1.0306057938661366, 1.135202657807309, 1.0254716981132075, 1.0659955257270695, 1.0526315789473684, 1.165447289657466, 1.0368563850867298, 1.024418883297388, 1.038039974210187, 1.0884146341463414, 1.0752411575562701, 1.5454545454545454, 1.2209821428571428, 2.0, 1.25, 1.2, 1.0172413793103448, 1.0111768573307034, 1.0115301690466518, 1.000185345580399, 1.075124829777576, 1.0467984763286777, 1.2363636363636363, 1.0694997786631253, 1.0782792706951079, 1.8333333333333333, 2.0833333333333335, 1.0113513513513515, 1.1111111111111112, 1.0257558790593504, 1.1263894606834088, 1.0750730501236232, 1.1062896742146366, 3.5, 1.0692130223019738, 1.0051546391752577, 1.1112631879098944, 1.039586215330057, 1.1103092783505155, 1.1572381781259067, 1.1333824477392025, 1.1008906481939633, 1.0864553314121037, 1.3548387096774193, 1.1096849474912485, 1.3333333333333333, 3.0, 1.0411367538237517, 5.0, 1.8571428571428572, 2.1, 1.0651068158697863, 1.078914737646885, 1.1666666666666667, 1.0075757575757576, 1.3333333333333333, 1.3633983124818156, 1.0274240940254653, 1.2786177105831533, 1.2763419483101393]
origin-bjaq_15.71 	max: 5.0000	99th: 2.8762	95th: 1.7161	median: 1.0819	mean: 1.1835

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.051804 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.018427