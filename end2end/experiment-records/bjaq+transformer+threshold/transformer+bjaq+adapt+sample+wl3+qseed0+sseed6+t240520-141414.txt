Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 6, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.5000	95th: 1.6667	median: 1.0833	mean: 1.1700
ReportEsts: [1.053968253968254, 1.0216145833333334, 1.0384314916887287, 1.0855949895615866, 1.5, 1.0, 1.032086979581013, 1.045512347006517, 1.0, 1.0317880794701986, 1.1814850085129716, 1.0423420622152524, 1.0025263157894737, 1.083720930232558, 1.0427410808901447, 1.0, 1.0843373493975903, 1.0332979100247963, 3.0, 2.0, 1.4210526315789473, 1.121673923560716, 1.1422443050690994, 1.064004697592484, 1.0878145041933893, 1.0, 1.1756652596806754, 1.5, 1.2, 1.0287769784172662, 1.0, 1.0461226132609147, 1.0073722995915555, 1.0556531927357937, 1.1163166397415185, 1.2367396491815632, 1.160427807486631, 1.0116038574720096, 1.1395412907225015, 1.037037037037037, 1.1659192825112108, 1.0060975609756098, 1.0, 1.0736266036663775, 1.114108953428424, 1.890625, 1.0404040404040404, 1.2862190812720848, 1.0289936979060785, 1.1481481481481481, 1.0526969796870642, 1.2371134020618557, 1.0392966770359078, 2.0, 1.283116883116883, 1.1781973742439888, 1.1215334420880914, 1.3461538461538463, 1.00625, 1.25, 1.1134814612868047, 1.0921544209215441, 1.0636363636363637, 1.0114942528735633, 1.0, 1.0452226764588834, 1.2906903103229892, 1.75, 1.0, 1.012491843012958, 1.0011933174224343, 1.059675550405562, 1.0068027210884354, 1.083452838044132, 1.0588235294117647, 1.0671936758893281, 1.0, 1.1110647181628392, 2.0, 1.0148210852535224, 1.3333333333333333, 1.0363724853990914, 1.116564417177914, 1.072570725707257, 1.1256133464180569, 1.0, 1.0622329128176258, 1.0185695921467803, 1.0294117647058822, 1.75, 1.1333333333333333, 1.0715777214415538, 1.006269592476489, 1.0210378681626928, 1.0054794520547945, 1.025974025974026, 1.062992125984252, 1.158102766798419, 1.0, 1.2421857681223676, 1.0093592512598992, 1.0789022298456261, 1.2379974662531126, 1.36, 1.0130124782784942, 1.0270772498009026, 1.3835538645011074, 1.1039059537353053, 1.0521152667075413, 1.1666666666666667, 1.6666666666666667, 1.0574766355140186, 1.0602737350859892, 1.0505369551484522, 1.155844155844156, 1.0641420970819802, 1.0, 1.140964995269631, 1.1662946428571428, 1.0, 1.010989010989011, 1.0, 1.1578947368421053, 1.0222633327084225, 1.0481478605265202, 1.1428571428571428, 1.8, 1.1357615894039734, 1.0, 1.1666666666666667, 1.1076463792415987, 1.1818181818181819, 1.0712890625, 1.0440189163898084, 1.0663103390679807, 1.0293724966622162, 1.130030959752322, 1.0089633671083398, 1.039972432804962, 1.076782449725777, 1.0318119645209745, 1.2, 1.009784735812133, 1.0625524820192038, 2.0, 1.015496809480401, 1.0045714285714287, 1.0988411724608043, 1.09617081348156, 1.5, 1.1162509082102203, 1.0273972602739727, 1.0121457489878543, 1.1074561403508771, 1.2145985401459853, 1.0492245448415374, 1.1351172579675286, 1.176551724137931, 1.0415841584158416, 1.118421052631579, 1.2653061224489797, 1.393939393939394, 1.0265095729013254, 1.5714285714285714, 1.054101633479486, 1.0203813982569443, 1.192175703500343, 1.3881455050054514, 1.1008742434431742, 1.0654634120484483, 1.263157894736842, 1.0769230769230769, 1.0141376972983442, 1.0248704663212436, 1.1165703275529866, 1.1030126336248784, 1.0532695374800638, 1.127604735485562, 1.0917983801210978, 1.0, 1.373015873015873, 1.0057860570138302, 1.0277113237639552, 1.145824501907588, 1.118421052631579, 1.0705093282000993, 1.291754756871036, 1.1728242754799472, 1.1372549019607843, 1.1590909090909092, 1.113672353902738, 1.0, 1.1818181818181819, 1.0785682579395504, 1.0080091533180777, 1.0187881634570222, 1.3461538461538463, 1.0533762057877814, 1.0481047390515732, 1.0621893153033044, 1.0626410835214446, 1.0385791082533995, 1.3220338983050848, 1.0491803278688525, 1.2, 1.0, 1.4953271028037383, 1.1747358460810597, 1.2961672473867596, 1.3793103448275863, 1.0118635689569946, 1.0031277926720286, 1.0097394734110645, 1.0271057596271225, 1.0696818118660554, 1.1891891891891893, 1.0202312138728324, 1.000648088139987, 1.02151186168074, 1.0030946977511863, 1.0, 1.0766045548654244, 1.115218718610285, 1.0181232218097835, 1.1468788249694002, 1.0482121882597175, 1.2815176151761518, 1.0357142857142858, 1.0014775388903348, 1.0507993811242908, 1.014664410603497, 1.1098265895953756, 1.2364708899717876, 1.0982591876208898, 1.1724409448818898, 2.0, 1.1814628699050809, 1.1165698972755695, 1.1401781528363806, 1.1652173913043478, 1.0, 1.6666666666666667, 1.1665640773113382, 1.1272727272727272, 1.1232254810117461, 1.5, 1.0, 1.0, 1.0370804059328649, 1.0315789473684212, 1.0359116022099448, 1.1329113924050633, 1.0470588235294118, 1.0054875474883918, 1.129188362594607, 1.0175438596491229, 2.0, 1.0754837250426665, 1.0049403046521201, 1.1348511383537654, 1.0036791604824717, 1.1345993141803303, 1.0109394476152989, 1.0834658187599364, 1.0907170395929793, 1.0233253588516746, 1.098808796579108, 1.1038362477972075, 1.0909090909090908, 1.014415402424907, 1.1113744075829384, 1.2272727272727273, 1.4705882352941178, 1.092570520460866, 1.0555555555555556, 1.017094017094017, 1.1093735280263777, 1.075208913649025, 1.3583959899749374, 1.007495820991818, 1.0558015943312666, 1.0349560229576227, 1.0541066584636036, 1.25, 1.011167697344489, 1.6666666666666667, 1.048634655312886, 1.0334821428571428, 1.0351008147103, 1.0810810810810811, 2.0, 1.3478260869565217, 1.1451612903225807, 1.05185350888406, 1.0, 1.066884176182708, 1.0746606334841629, 1.0056089743589745, 1.0161208819292784, 1.1317365269461077, 1.119496855345912, 1.0088179355656735, 1.1237005245588936, 1.0916313790544374, 1.1367521367521367, 1.0, 1.136038186157518, 1.2727272727272727, 1.0955631399317407, 1.0586352148272957, 1.002927645336679, 1.0338028169014084, 1.3111111111111111, 1.010973936899863, 1.0025866528711846, 1.2857142857142858, 1.0088813784269697, 1.0419847328244274, 1.2666666666666666, 1.0681096760070052, 1.2857142857142858, 1.1666666666666667, 1.014797438661003, 2.0, 1.1563786008230452, 1.0174418604651163, 1.081214109926169, 1.061847389558233, 1.0992167101827677, 1.1097560975609757, 1.1245281997862526, 1.0717038695909706, 1.0440967283072546, 1.001910540773236, 1.044394390757829, 2.0, 1.0, 1.0601933316574876, 1.25, 1.0691578360290017, 1.3529411764705883, 1.0, 1.4666666666666666, 1.2971887550200802, 1.0649106302916276, 1.1944444444444444, 1.0238095238095237, 1.0, 1.162450066577896, 1.109296636921437, 2.0, 1.2960095294818343, 1.0, 1.0981097699840583, 1.0853658536585367, 1.0059921336747353, 1.1497695852534562, 1.1363636363636365, 1.1704885343968097, 1.1666666666666667, 1.014027387510287, 1.0219709166195876, 1.0931586608442503, 1.0, 1.1666666666666667, 1.5714285714285714, 1.5, 1.3333333333333333, 1.0690194249981144, 1.3333333333333333, 1.0615640599001663, 1.216867469879518, 1.1651904340124004, 1.103002083932791, 1.2296601441812565, 1.033403391111321, 1.0104408352668213, 1.0547619047619048, 1.5, 1.0412147505422993, 1.097872340425532, 1.05605387603099, 1.2857142857142858, 1.5714285714285714, 1.0133630289532294, 1.0171496156120639, 1.0263755586489853, 1.0024570024570025, 1.1464387464387464, 1.0238030095759234, 1.0256410256410255, 1.0907770515613653, 1.0815677966101696, 1.1346153846153846, 1.0240793201133145, 1.1181818181818182, 1.0705173072028507, 1.0620700428727645, 1.0004674808625023, 1.0116279069767442, 1.1808510638297873, 1.1049382716049383, 1.0, 1.0086251662339307, 1.0467883610935338, 1.0245068600729894, 1.06280821836417, 1.0686695278969958, 1.1490308230060375, 1.5714285714285714, 1.1003184713375795, 1.2, 1.1639624252775405, 1.25, 1.0369214475641084, 1.0231884057971015, 1.110597592433362, 1.0632411067193677, 1.1235347159603246, 3.0, 1.1612244897959183, 1.0133841860693826, 1.139576052970388, 2.0, 1.105263157894737, 1.2389635316698657, 1.3647058823529412, 1.0974900708348687, 1.1122661122661122, 1.105263157894737, 1.0507706255666365, 1.0021735573889266, 1.0192117476983946, 1.1089131134901968, 1.1325657894736842, 1.0829187396351576, 1.2007575757575757, 1.875, 1.0395778364116095, 1.4444444444444444, 1.225752508361204, 1.0, 1.084119226268328, 1.25, 1.052020084072863, 1.1356785646771728, 1.0542874768661321, 1.0, 1.2127659574468086, 1.12, 1.2869447643847964, 1.262582056892779, 1.0, 1.015859649122807, 1.0855419612743629, 1.0443431413178617, 1.5, 2.0, 1.0248543689320389, 1.0045004500450045, 1.020066889632107, 1.1111111111111112, 1.0757358028633774, 1.0124282982791586, 1.4705882352941178, 1.0525800376647834, 1.0454545454545454, 1.136482939632546, 1.0225806451612902, 1.305006310475389, 1.0091525227364884, 1.0, 1.0571428571428572, 1.0925501021761732, 1.0566632761022399, 1.0500956208874914, 2.0, 1.0975447909754479, 1.0157272455650153, 1.0220010476689365, 2.0, 1.0478468899521531, 1.038413121325821, 1.03425491748371, 1.0294438862435018, 1.003604676948765, 1.0542999289267947, 1.0093299406276506, 1.1714079074252652, 2.0, 1.0039278515685566, 1.3962264150943395, 1.25, 1.1968911917098446, 1.1538461538461537, 1.00044593738539, 1.0480854853072128, 1.0397002886251123, 1.2170720513997246, 1.1016609073681864, 1.021642093872582, 1.0643977484193858, 1.271604938271605, 4.0, 1.0069036534249953, 1.1305668016194332, 1.0460649862267113, 1.0535099413970708, 1.1136478944698123, 1.217628705148206, 2.375, 2.2857142857142856, 1.004229725434586, 1.0263835192138424, 1.0065207482581882, 1.1275887573964498, 1.061294832240648, 1.052060737527115, 1.0833399079552926, 1.0269687162891046, 1.2003058103975535, 3.0, 1.1666666666666667, 1.0107361963190185, 1.0600375234521575, 1.0681003584229392, 1.1183510638297873, 1.0705882352941176, 1.1916167664670658, 1.148905109489051, 1.0833333333333333, 1.0898460717361507, 1.2150537634408602, 1.0047963114817509, 2.0, 1.1466227347611202, 1.1454545454545455, 1.165289256198347, 1.09804469273743, 1.04337899543379, 1.1552511415525115, 1.0103761348897535, 1.095525494276795, 1.0, 1.1914893617021276, 1.0, 1.0, 1.1363636363636365, 1.092741935483871, 1.037037037037037, 1.1213592233009708, 1.0671259211791093, 1.0893271461716938, 1.0867226327643653, 1.1754070811844468, 1.0402476780185759, 1.1321274517336377, 1.037837837837838, 1.0696202531645569, 1.0372520561199807, 1.067124735729387, 1.1647398843930636, 1.1253794778384942, 1.0768762985861247, 1.2392983524219017, 1.082110779326543, 2.0, 1.0933660933660934, 1.0734126984126984, 1.3944954128440368, 1.0, 1.108695652173913, 1.3636363636363635, 1.2124463519313304, 1.3333333333333333, 1.1666666666666667, 1.0095378493116476, 1.1090962846161427, 1.028499185183269, 1.0320947261821298, 1.227027027027027, 1.1289437585733881, 1.0, 1.1846153846153846, 1.0142078764052693, 1.0603368130262703, 1.0852007023277646, 1.1126551999088734, 1.0155058464667006, 1.1168831168831168, 1.0665911979663172, 1.0959147424511546, 1.041818956432047, 1.100152487810388, 1.2727272727272727, 1.0371517027863777, 1.0, 1.2422535211267605, 1.2074700724831113, 3.0, 1.1441567529741077, 1.0646526930952764, 1.4285714285714286, 1.0549918291338882, 1.3, 1.1176470588235294, 1.0678524972018029, 1.6153846153846154, 1.0187931305367222, 1.0388722768047842, 1.3571428571428572, 1.1153846153846154, 1.0989690721649485, 1.0121006776379478, 1.0134657836644592, 1.0805989583333333, 1.1564235581324382, 1.0, 1.027455357142857, 1.0975609756097562, 2.0, 1.0053330860018086, 1.0899039709317415, 1.1494796594134342, 1.0196153968607724, 1.0087216484656816, 1.0660377358490567, 2.0, 1.0469932297889286, 1.0032258064516129, 1.1168275838664246, 1.1720093823299453, 1.0010662271121382, 1.0329483553685619, 1.1043956043956045, 1.0909090909090908, 1.2006688963210703, 1.0565208191286766, 1.061198738170347, 1.0335144927536233, 1.013655462184874, 1.0350681401636816, 3.0, 1.1370994186913101, 1.0041623412920226, 1.0517865331808411, 1.1875, 1.2552423274545201, 1.266355140186916, 1.1428571428571428, 1.0917330888058123, 1.0420575865415722, 1.1375545851528384, 1.088235294117647, 1.3333333333333333, 1.1128422717491313, 1.5, 1.0186915887850467, 1.0833333333333333, 1.0336333821784942, 1.3846153846153846, 1.1856540084388185, 1.0534591194968554, 1.0, 1.6468253968253967, 1.2183266932270915, 1.25, 2.0, 1.0901639344262295, 1.1482758620689655, 1.0802825947334618, 1.194235588972431, 1.0792580101180438, 1.1976401179941003, 1.1014466214978942, 1.0571428571428572, 1.206896551724138, 1.3061224489795917, 1.0384615384615385, 1.0, 1.0332640332640333, 1.049062049062049, 1.0547520661157024, 1.0527923211169286, 1.0936379070450222, 1.036878216123499, 1.074622772952302, 1.1500506072874495, 1.173728813559322, 1.0231990231990231, 1.5714285714285714, 1.0, 1.2592592592592593, 1.0132275935341883, 1.0803177405119153, 1.107843137254902, 1.1330049261083743, 1.0276441389843451, 1.0934117371716108, 1.0190401928561221, 1.1142857142857143, 1.2222222222222223, 1.0352490421455938, 1.0198170731707317, 1.0511958026201436, 1.0210942561001943, 1.013157894736842, 1.1592587123449498, 1.0092848152136, 1.1779788838612368, 1.3167006109979633, 1.125, 1.033115671641791, 1.819672131147541, 1.2093023255813953, 1.0110192837465564, 1.0701001430615165, 1.0, 1.0138888888888888, 1.0044835764644726, 1.1111111111111112, 1.1180713108685787, 1.0042372881355932, 1.2285714285714286, 1.0761558319643276, 1.0475126171593367, 1.0342465753424657, 1.0553435114503817, 1.006810442678774, 1.2014354390954025, 1.1889596602972399, 1.2142857142857142, 1.0, 1.4285714285714286, 1.0594889184933995, 1.3333333333333333, 1.1082926343067876, 1.1454687415863443, 1.036552946389012, 1.086395233366435, 1.0558239425690727, 1.0682743837084674, 1.010752688172043, 1.0097087378640777, 1.0048369590864046, 1.1684945631796027, 1.0462503698725631, 1.1909249668794413, 1.4285714285714286, 1.015625, 1.0411522633744856, 1.1382543589032548, 1.1009771986970684, 1.3058920704845816, 1.0035523978685612, 2.2304347826086954, 1.0600593159308962, 1.07248322147651, 1.060992822966507, 1.125, 1.0687760336996681, 1.0208792787311889, 1.3338590956887486, 1.0581052631578947, 1.1428571428571428, 1.1432068543451652, 1.0806451612903225, 1.625, 1.0672308246308966, 1.5384615384615385, 1.0258531540847984, 1.0859188544152745, 1.0952732644017724, 1.0136542072025942, 1.0131108462455305, 2.2, 1.0566037735849056, 1.0981286076693997, 1.05686982610145, 1.0131179997385116, 1.0001958384332925, 1.0791661518366193, 1.0833333333333333, 1.092241379310345, 1.0668099238132447, 1.0358721371489799, 1.029058116232465, 1.0069444444444444, 1.093688362919132, 1.0163029687896472, 1.3881048387096775, 1.0183359095997015, 1.0, 1.3333333333333333, 1.0364112833444585, 1.0408611599297013, 1.2147056079126621, 1.0761375220090816, 1.0534716679968077, 1.0817307692307692, 1.096825068259554, 1.0928990571635788, 1.1084558823529411, 1.0571428571428572, 1.0185449358059915, 1.0944878024836793, 1.0952380952380953, 1.75, 1.0276240158944339, 1.1776042261099244, 1.0086256469235193, 1.0114942528735633, 1.219768283852281, 1.014317452480869, 1.1723362384031488, 1.2232415902140672, 1.1538461538461537, 1.0498652291105122, 1.0626398210290828, 1.134375, 1.4333333333333333, 1.045189406637613, 1.2160555004955402, 1.1625207296849087, 1.024390243902439, 1.0349617146487444, 1.0263157894736843, 1.0636546184738955, 1.3253119429590017, 1.3333333333333333, 1.0357142857142858, 1.3333333333333333, 1.126088470916057, 1.4230769230769231, 1.3333333333333333, 1.1538461538461537, 1.0225165562913907, 1.0742753623188406, 1.0329154441184316, 1.0334595128373931, 1.1618181818181819, 1.2830188679245282, 1.0666666666666667, 1.0, 1.0675675675675675, 1.09375, 1.1223776223776223, 1.0259315291463769, 1.0282846647619754, 1.3473684210526315, 1.0622747447391998, 1.047500125118863, 2.5, 1.0667551291211594, 1.2522361359570662, 3.0, 2.0, 1.1600591715976332, 1.0933084702001004, 1.0263659699303265, 1.1024844720496894, 1.0, 1.1266375545851528, 1.2760736196319018, 3.0, 2.0, 1.0034448818897639, 1.1470627772550075, 1.0557291015869048, 1.6666666666666667, 1.0223869994384644, 1.0487993803253293, 1.1565836298932384, 1.0, 1.0610328638497653, 1.0249041419629108, 1.131578947368421, 1.1559460307499216, 1.0153022633385698, 1.2536873156342183, 1.09375, 1.0953199963791074, 1.07926267281106, 1.078512396694215, 1.2777777777777777, 1.0459425984103419, 1.479819004524887, 1.070472823895044, 1.3532934131736527, 1.2941176470588236, 1.3134328358208955, 1.0511140235910879, 1.0446566060979365, 1.007289215981983, 1.0791186050967618, 1.0993449781659388, 1.5, 1.6666666666666667, 1.0292143450744742, 1.150395778364116, 1.1365493094728651, 1.010720290619899, 1.1195852149188827, 1.143577702408905, 1.4318181818181819, 1.0208333333333333, 1.0710635956292744, 1.063590228267346, 1.2061122956645345, 1.073555166374781, 2.5, 1.0273972602739727, 1.0204012877143072, 1.151940545004129, 1.0085111069158643, 1.0848762399501028, 1.0205965909090908, 2.0, 1.0946291560102301, 1.0393961623988446, 1.1804889193511539, 1.2699619771863118, 1.0830174510084394, 1.1114649681528663, 1.1037527593818985, 1.0123239436619718, 1.0314742033466517, 1.065072817577237, 1.0299539170506913, 1.049731182795699, 1.0, 1.1271186440677967, 1.0686534418136941, 1.0257452574525745, 1.0438004544468422, 1.1168427594779367, 1.0177059276366436, 1.2857142857142858, 1.2493368700265253, 1.6666666666666667, 2.0, 1.1764705882352942, 1.0153452685421995, 1.042654028436019, 1.0339412555192935, 1.0198024036610924, 1.0712209302325582, 1.038284518828452, 1.1467391304347827, 1.0208333333333333, 1.037016772238473, 1.6, 1.3333333333333333, 1.2275449101796407, 1.1428571428571428, 1.0667613636363635, 1.1466733870967742, 1.0217214961694456, 1.0997386830273814, 2.0, 1.0198926428796968, 1.180232558139535, 1.087015451341827, 1.0400423864877015, 1.0934343434343434, 1.1154109589041097, 1.1371598131048075, 1.0709922784372479, 1.0227642276422764, 1.3653846153846154, 1.0907821229050279, 1.0, 1.0, 1.0416875290583312, 5.0, 1.5714285714285714, 1.588235294117647, 1.049367088607595, 1.175, 1.1080931263858094, 1.102785406041585, 1.1666666666666667, 1.0651769087523277, 1.0110981308411215, 1.1925133689839573, 1.3413461538461537, 1.4285714285714286, 1.0942072802031684, 1.2655210643015522, 1.1393805309734513, 1.0167348456675345, 1.0202819688350235, 1.077019592703407, 1.1079562259686484, 1.0, 1.1875872572661506, 1.0239646847544386, 1.0374820659971307, 1.1774193548387097, 1.093426514634018]
origin-bjaq_15.71 	max: 5.0000	99th: 2.5000	95th: 1.6667	median: 1.0833	mean: 1.1700

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 13.961668 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[4.7683716e-07 1.2516975e-06 0.0000000e+00 1.7881393e-07 8.9406967e-07]
Distance score: 5.602836381513043e-07
SAUCE Drift detection: False
Detection latency: 0.0234s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.035113 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.6667	95th: 1.7448	median: 1.0872	mean: 1.1828
ReportEsts: [1.0291777188328912, 1.0023939064200218, 1.0279792371271996, 1.059625212947189, 1.565217391304348, 1.0, 1.0309127896692023, 1.0505163150872003, 1.3333333333333333, 1.0130718954248366, 1.0715863791364488, 1.0422830518345951, 1.0774461654703438, 1.122093023255814, 1.0720426919656092, 1.4615384615384615, 1.1568627450980393, 1.3333333333333333, 1.3636363636363635, 1.0620860927152318, 1.0903167827454505, 1.0873367927686641, 1.4545454545454546, 1.0281090289608177, 1.0072708796888414, 1.0264857416554236, 2.0, 1.1764291834985923, 1.5, 1.6, 1.0484406104844062, 1.0, 1.0471721440038382, 1.0076666051698338, 1.0160075329566856, 1.0696287279367012, 1.248398225726959, 1.205069124423963, 1.0, 1.1052745061046276, 1.0206813775274675, 1.0182457683007253, 1.1913499344692005, 1.0807291666666667, 1.0538033395176252, 1.0128254955305092, 1.3, 1.3170731707317074, 1.7445255474452555, 1.0206611570247934, 1.1538461538461537, 1.2188841201716738, 1.0886075949367089, 1.0588235294117647, 1.0299168363466868, 1.0245219065154623, 1.139827806122449, 1.1534391534391535, 1.1111111111111112, 1.065437523439996, 1.2205882352941178, 1.1162890014434699, 1.0902021772939348, 1.2230483271375465, 1.0, 1.4, 1.0187091839736424, 1.2532100667693888, 2.2, 2.0, 1.0501949317738792, 1.036045314109166, 1.0653753026634383, 1.0252918287937742, 1.1041100208850534, 1.4264705882352942, 1.0577232114160828, 1.0986547085201794, 1.5242718446601942, 1.0899792320430364, 1.0242334322453017, 1.0, 2.0, 1.5, 1.129692832764505, 1.2033898305084745, 1.0875816993464051, 1.853658536585366, 1.25, 1.112391468327208, 1.1075494307968843, 1.1825118904510532, 1.0302442014917748, 1.1320261437908496, 1.054945054945055, 1.0178571428571428, 1.1028938906752412, 1.0702479338842976, 1.1875, 1.268615984405458, 1.1923076923076923, 2.0, 1.071018504280076, 1.1963373083475297, 1.0259103641456582, 1.2361874931711403, 1.3, 1.0147682417363808, 1.0798319327731092, 1.1440325993260716, 1.2101587301587302, 1.0464759959141983, 1.1428571428571428, 2.6666666666666665, 1.052794430477664, 1.0411884700665188, 1.0647902283590016, 1.0, 1.060909329829172, 2.0, 1.1368172268907564, 1.12259835315645, 1.0, 1.036697247706422, 1.5, 1.2136929460580912, 1.0205531523673697, 1.0744612208026842, 1.125, 1.6666666666666667, 1.1234735413839891, 1.0, 1.2857142857142858, 1.1308393992444485, 1.1538461538461537, 1.0184262948207172, 1.034280430588692, 1.0477378348824495, 1.0, 1.3571428571428572, 1.0863930885529158, 1.046875, 1.066968781470292, 1.0253988521939472, 1.2702702702702702, 1.0308108108108107, 1.1536054917684224, 3.0, 1.0239817282070802, 1.0076775431861804, 1.143598615916955, 1.1062038404726735, 1.5, 1.1623461115003504, 1.0611183355006502, 1.020583190394511, 1.1233373639661426, 1.0, 1.0122574055158324, 1.0614053950732325, 1.1204267652371152, 1.0282861896838602, 1.0404312668463611, 1.3214285714285714, 1.2408759124087592, 1.01230012300123, 1.7142857142857142, 1.0553473839328282, 1.3333333333333333, 1.224669603524229, 1.0313910466265037, 1.2, 1.0363039048529963, 1.2508710801393728, 1.0735849056603775, 1.0953531448820166, 1.1775362318840579, 1.0673813169984685, 1.0875912408759123, 1.068529965063155, 1.0080963033983168, 1.208631243248804, 1.1366459627329193, 1.5675675675675675, 1.0018970690053082, 1.1108137530617799, 1.3731884057971016, 1.0137190461632528, 1.0235294117647058, 3.0, 1.2181303116147308, 1.0932947108679327, 1.5, 1.1543967280163598, 1.1073001520053007, 1.0406763425502255, 1.0236579687892655, 1.0892156862745097, 1.0419024777837897, 1.099215193249138, 1.0124069478908189, 1.043971858010873, 1.0318971673411093, 1.086030322096162, 1.0535966149506346, 1.033996829311256, 1.1141552511415524, 1.1408450704225352, 1.1904761904761905, 2.0, 1.4172661870503598, 1.095466176760055, 1.3099415204678362, 1.2843137254901962, 1.0165220983064849, 1.0, 1.0445377213476512, 1.0691244239631337, 1.2171194136859715, 1.25, 1.010989010989011, 1.001342642320086, 1.0685706749157704, 1.0305665980171463, 2.1666666666666665, 1.1260690528983213, 1.1131799986875779, 1.0114702192484617, 1.0026315789473683, 1.0461285008237233, 1.007936507936508, 1.0637191157347203, 1.3095238095238095, 1.005933487780482, 1.0540553619821913, 1.0993975903614457, 1.0125628140703518, 1.0698739977090492, 2.0, 1.1524633821571237, 2.0, 1.2471306471306471, 1.0779420681934793, 1.1960438699569134, 1.1762589928057554, 1.0, 2.0, 1.071805315439388, 1.1044776119402986, 1.0899313166739735, 1.8, 1.1171376481312671, 1.0887185104052575, 1.4285714285714286, 1.018973913882058, 1.0688836104513064, 1.1030837004405287, 1.1580381471389645, 1.0013831258644537, 1.0918538330164664, 1.0303030303030303, 2.0, 1.0522446318426313, 1.121425823823567, 1.1119293078055965, 1.0107464877332775, 1.118696389857668, 1.008187697812027, 1.1064111037673496, 1.0688113077520858, 1.039778449144008, 1.0357569959339872, 1.0281601344961648, 1.1428571428571428, 1.013231479980548, 1.2813852813852813, 1.2075471698113207, 1.3043478260869565, 1.018880124143282, 1.0704845814977975, 1.0401321959715957, 1.00259867958983, 1.0475, 1.3395061728395061, 1.0240070661558922, 1.0636896046852122, 1.1195411642505533, 1.062865036814976, 1.3, 2.15, 1.0374233128834356, 1.0852981883018915, 1.3527861687769136, 1.0285915886339247, 1.193633952254642, 1.1683333333333332, 1.0564124535846902, 1.0939277321799543, 1.0862000289687137, 1.0439973650985344, 1.0045871559633028, 1.2142857142857142, 1.3333333333333333, 1.0827720401137555, 1.75, 1.0637898686679175, 1.0250838254574144, 1.002146550883013, 1.5, 1.0869565217391304, 1.2799664710813077, 1.1024661340743314, 1.0272934972198793, 1.1904761904761905, 1.1945516193148602, 1.0087465867179994, 1.1584699453551912, 1.0952380952380953, 3.8333333333333335, 1.008259074114323, 1.1111111111111112, 1.011453520054946, 1.0144, 1.0454545454545454, 1.1100615641169147, 1.1481481481481481, 1.4166666666666667, 1.0025555974634373, 2.0, 1.044811320754717, 1.0070588235294118, 1.058173162484428, 1.1127348643006263, 1.0924574209245743, 1.1382978723404256, 1.1028045801011046, 1.0985028967458985, 1.0561797752808988, 1.0020856697393254, 1.060421286031042, 3.0, 1.1, 1.0756709446024755, 1.2, 1.0674105067410506, 1.35, 1.5, 1.368421052631579, 1.31312292358804, 1.05234375, 1.2881355932203389, 1.0566037735849056, 1.4109589041095891, 1.5, 1.0808669634171506, 1.2142857142857142, 1.109375, 1.008620093803999, 1.1561181434599157, 1.0090022505626406, 1.0018467220683287, 1.4, 1.0, 1.3843537414965987, 1.4464285714285714, 1.022977022977023, 1.1359382617691476, 1.2272671190623072, 1.01, 1.0, 1.022251183248632, 1.1153846153846154, 1.5384615384615385, 1.5, 1.1558507920286152, 1.4285714285714286, 1.150214592274678, 1.315217391304348, 1.065775232253991, 1.1052122428791713, 1.2692307692307692, 1.1075681905493662, 1.107381652848355, 1.0254854368932038, 1.1131221719457014, 1.1688378081569282, 1.128595600676819, 1.1818181818181819, 1.0046513163791435, 1.0651504787961696, 1.0225209291357151, 1.0544554455445545, 1.0232558139534884, 1.164271047227926, 2.0, 1.0208333333333333, 1.5444444444444445, 1.1622641509433962, 1.0851063829787233, 1.0125786163522013, 1.06706008583691, 1.3461538461538463, 1.0008386832672704, 1.0815768930523029, 1.2302486622599937, 1.3170731707317074, 1.087719298245614, 1.1125319693094629, 1.0, 1.448099335584359, 1.68, 1.103846661263876, 1.154320788240995, 1.0723179259764626, 1.1696905016008539, 2.0, 1.1391423357664234, 1.5, 1.1940255636938102, 1.0909090909090908, 1.1207315330761538, 1.0011961722488039, 1.1143063193004596, 1.051779935275081, 1.0101146325016859, 4.0, 1.1596109839816933, 1.0127367332097388, 1.1218195393716617, 3.0, 1.0945945945945945, 1.2762209767814252, 1.222543352601156, 1.0802140837484853, 1.317, 1.0, 1.162873399715505, 1.0180979347761518, 1.0911522703416516, 1.0204263640538658, 1.0644576556934426, 1.1431718061674008, 1.109375, 1.0049349484073575, 1.098232790988736, 1.488888888888889, 1.187058183795541, 2.0, 1.0, 1.17682119205298, 1.1004016064257027, 1.0074224021592442, 1.139206909414364, 1.0729853015712114, 1.0, 1.173913043478261, 1.0625, 1.0350961646105277, 1.1304347826086956, 1.0, 1.0149549409571161, 1.0, 1.0, 1.0246343341031563, 2.3333333333333335, 1.025, 1.0266362252663623, 1.0112359550561798, 1.0, 1.0803010174925598, 1.0527617477328937, 1.45, 1.051291757357812, 1.1129032258064515, 1.0544444444444445, 1.032996632996633, 1.2461538461538462, 1.0609011554568848, 1.0, 1.058139534883721, 1.1624457308248914, 1.0961822054727184, 1.0486443381180224, 1.75, 1.1115001842978254, 1.0194936466468794, 1.0231744643637954, 2.0, 1.0564462257849032, 1.0287305391633603, 1.027729849642593, 1.0505914467697908, 1.010689502219648, 1.0072365426613608, 1.0253256150506513, 1.1650485436893203, 1.5, 1.0662423691388492, 1.2403846153846154, 1.0567514677103718, 1.0913140311804008, 1.0257731958762886, 1.0197824417800723, 1.116504854368932, 1.0452823883257212, 1.1151792524790236, 1.0561614443774285, 1.2527322404371584, 1.1003436083860365, 1.0953420121905335, 1.1022727272727273, 1.28125, 1.1065841640594323, 1.0556701030927835, 1.0042399662909511, 1.0585237946536998, 1.0, 1.1022120518688023, 1.7596439169139466, 1.018181818181818, 1.0517241379310345, 1.0143614520691633, 1.1470588235294117, 1.07518273581622, 1.0, 1.069767441860465, 1.0174833218311479, 1.0943868430461208, 1.0406337371854613, 1.0033531707941383, 1.114319157237612, 1.1233766233766234, 1.0255493101686255, 1.0775601814532063, 1.5227272727272727, 1.01964141821112, 1.2052292263610316, 1.0566037735849056, 1.0685246631542122, 1.1785383903792785, 1.0041217665452102, 2.0, 1.1612456747404845, 1.0522648083623694, 1.0835538811221472, 1.0859030837004404, 1.08, 1.0363636363636364, 1.2, 1.0927160199952393, 1.0, 1.2678571428571428, 1.0, 1.3333333333333333, 1.1226415094339623, 1.2233009708737863, 1.0275229357798166, 1.0076628352490422, 1.070441432980008, 1.0312213039485767, 1.1177080839517994, 1.166514488923062, 1.064383508210789, 1.069154022629987, 1.020733781223529, 1.101741022850925, 1.0921882259242053, 1.0506291756668509, 1.0538951494365507, 1.0653804930332262, 1.1895424836601307, 1.0822784810126582, 1.0129414610546685, 1.1660818713450292, 1.099646365422397, 1.3546511627906976, 1.1805820610687023, 1.2151714077315827, 2.0, 1.0405092592592593, 1.3125, 1.3333333333333333, 1.4956140350877194, 1.0465105349729773, 1.018470631695604, 1.0, 1.1722222222222223, 1.1084812888972708, 1.0036833489242283, 1.0649350649350648, 1.2, 2.0, 1.1306122448979592, 1.1945701357466063, 1.0866586054010479, 1.122193334909005, 1.0, 1.140995812005584, 1.1292372881355932, 1.0062541145490453, 1.0562962962962963, 1.0351800098635542, 1.0081979901701519, 1.0022005707893828, 1.4193548387096775, 1.0, 1.1314753418980523, 1.0, 1.0080738177623991, 1.2008733624454149, 1.3314646110721795, 1.1351119195593957, 1.5769230769230769, 1.1721255172644875, 1.1928571428571428, 1.0396825396825398, 1.1061975867803686, 1.2052287581699346, 1.1448692152917506, 1.0190212196520743, 1.0017969451931716, 1.0600694444444445, 1.1428571428571428, 1.121914379423442, 1.097328514739229, 1.263157894736842, 1.033515731874145, 1.1800766283524904, 1.065155807365439, 1.0064550687269624, 1.5, 1.0929292929292929, 1.0923716173023652, 1.2261904761904763, 1.2242424242424241, 1.0501762497912253, 1.078125, 1.625, 1.121244635193133, 1.0390835579514826, 1.132543575679611, 1.1900527009222661, 1.0134844132044196, 1.147043851356265, 1.1597542242703534, 1.0832497492477433, 1.2299168975069252, 1.0604824641149502, 1.0839086563993627, 1.034618410700236, 1.074577861163227, 1.0771001150747985, 1.037037037037037, 1.0246934318830843, 1.263157894736842, 1.6, 1.1267080745341616, 1.6103896103896105, 1.030030959752322, 1.0206073752711498, 1.0769230769230769, 1.0153721682847896, 1.0229472929365364, 1.0552147239263803, 1.0439348360599443, 2.6666666666666665, 1.0183066361556063, 1.5, 1.0914285714285714, 1.2, 1.0178134823611595, 1.3870967741935485, 1.1263537906137184, 1.035996488147498, 1.0, 1.217199558985667, 1.2568493150684932, 1.5, 3.0, 1.1041666666666667, 1.207977207977208, 1.05703125, 1.2187171398527865, 1.0912981455064195, 1.0443213296398892, 1.037313432835821, 1.0256187581415546, 1.15234375, 1.0986842105263157, 1.2962962962962963, 1.0, 1.1181988742964353, 1.1467780429594272, 1.0244969378827646, 1.0668997883500506, 1.06651112148079, 1.0130880915817395, 1.091896934091934, 1.14741888795079, 1.1883194278903457, 1.031584309730005, 1.6666666666666667, 1.0, 1.28125, 1.0380211763513856, 1.0282608695652173, 1.1243093922651934, 1.0101419878296145, 1.0709097859327217, 1.0465830140709758, 1.0032580657458352, 1.0941176470588236, 1.1428571428571428, 1.0343580470162748, 1.0535150407179659, 1.074261568643591, 1.0490853588029878, 1.0280898876404494, 1.0366178016948104, 1.0070353846431732, 1.0826018093474001, 1.077376565954311, 1.0950478294591863, 1.1727941176470589, 1.042654028436019, 1.206047032474804, 1.0354892346788338, 1.125, 1.6379310344827587, 2.0, 1.0655737704918034, 1.0041042811432583, 1.126984126984127, 1.09024322280164, 1.034703196347032, 1.0454545454545454, 1.083647027926114, 1.007694610778443, 1.0991391357817653, 1.0634028892455858, 1.028301886792453, 1.2073143051693809, 1.2141592920353983, 1.1111111111111112, 1.0, 1.2, 1.0675844553737, 1.0, 1.0741610960354755, 1.0918017351536755, 1.0204304998175848, 1.0942704863424384, 1.0376899614366526, 1.0080521125486293, 1.009009009009009, 1.0429082240762813, 1.0109160573953162, 1.1253071253071254, 1.0401149468308526, 1.2286809086127877, 1.625, 1.0224719101123596, 1.0456026058631922, 1.108827278521351, 1.076086956521739, 1.2851305334846765, 1.05, 2.2490974729241877, 1.0503646921587981, 1.0290178571428572, 1.0567665531668446, 1.2222222222222223, 1.062685205172989, 1.040062522630396, 1.3014834205933683, 1.081032628182144, 1.2580645161290323, 1.0287769784172662, 1.1134205161354482, 1.0183256976259891, 2.2, 1.0183231266115071, 1.0, 1.1040118870728084, 1.0740740740740742, 1.0229591836734695, 1.04, 1.030658250676285, 1.0458536585365854, 1.0616804273919378, 1.014886233067838, 1.0650095602294456, 1.0096505886108034, 1.0716356651987526, 1.0666666666666667, 1.109341057204924, 1.0301745229163268, 1.0827962928865156, 1.0177489177489178, 1.0184281842818428, 1.0335305719921104, 1.0285714285714285, 1.0608108108108107, 1.0189955260928374, 1.1666666666666667, 1.0979710144927537, 1.2290039649164965, 1.0539183584370224, 1.0551839464882944, 1.0976391083026154, 1.1243570676086014, 1.0664893617021276, 1.0905349794238683, 1.1016861538461538, 1.0823031791513167, 1.118361153262519, 1.0502283105022832, 1.042464114832536, 1.0954572886938554, 1.0566037735849056, 1.75, 1.0409010823055624, 1.1793310170992575, 1.018941233608548, 1.0046511627906978, 1.2360097323600974, 1.024165584935185, 1.1597011440579033, 1.0150842945874001, 1.3225806451612903, 1.0625704622322436, 1.5517241379310345, 1.1266149870801034, 1.5806451612903225, 1.0673388146880465, 1.1978913219789131, 1.0354609929078014, 1.02, 1.1395027624309393, 1.0048332527791204, 1.0808080808080809, 1.0555555555555556, 1.0239852398523985, 1.0411522633744856, 1.0593719332679097, 1.0769230769230769, 1.0035213820388802, 1.2307692307692308, 1.0319569120287253, 1.3272727272727274, 1.2380952380952381, 1.3173216885007277, 1.014017143268746, 1.036141595841241, 1.2757575757575759, 1.3968253968253967, 1.3529411764705883, 1.1764705882352942, 1.1363636363636365, 1.0963855421686748, 1.033439789592335, 1.0389029087154558, 1.0303810297784768, 1.3157894736842106, 1.0788169473546134, 1.0466404150259392, 3.0, 1.108818190503487, 1.0329426897241676, 2.5, 1.8, 1.1007371007371007, 1.1215571718135209, 1.0779519063337928, 1.2085561497326203, 1.0, 1.096085409252669, 1.269521410579345, 1.4285714285714286, 1.042818687563558, 1.0940655349822543, 1.056928398170354, 1.087006237006237, 1.8571428571428572, 1.0359980805593798, 1.0547231270358306, 1.0148601398601398, 1.2526610644257703, 1.0164512338425382, 1.0, 1.2272727272727273, 1.1476349239424881, 1.010382140768181, 1.149519890260631, 1.0844594594594594, 1.1335542560103964, 1.0865533230293662, 1.1215277777777777, 1.144927536231884, 1.0340797109383555, 1.430740037950664, 1.0501781357704372, 1.463768115942029, 1.1864406779661016, 1.0108827085852479, 1.5, 1.0781679389312977, 1.0383631713554988, 1.007652841092601, 1.1416510318949344, 1.5, 1.0028328611898016, 1.0049382716049382, 1.1889619883040936, 1.1056383668178873, 1.0002237598540398, 1.051471613893151, 1.1089314643938861, 1.167755991285403, 1.0344827586206897, 1.0608848864526232, 1.0853284696533771, 1.2811521603005636, 1.0439093484419264, 1.6666666666666667, 1.0813953488372092, 1.1459926837379448, 1.1051805337519622, 1.0261868197903452, 1.0874154320459022, 1.008860011813349, 2.0, 1.0563674321503131, 1.0442736637586927, 1.2055109070034442, 1.2673267326732673, 1.078669314796425, 1.0543478260869565, 1.1429872495446265, 1.0086289549376797, 1.0310076347875499, 1.0965757250917216, 1.0493707647628268, 1.0415263748597081, 1.027027027027027, 1.2186252386738414, 1.1673892649780686, 1.029200942897003, 1.0099718038649337, 1.1231808731808732, 1.0160791589363019, 1.037037037037037, 1.2169197396963123, 1.6666666666666667, 2.5, 1.2272727272727273, 1.0195227765726682, 1.0065231572080888, 1.0187578814627996, 1.0010207869339272, 1.1419836956521738, 1.057258212516058, 1.2654028436018958, 1.0964028776978416, 1.0754444444444444, 1.3333333333333333, 1.5714285714285714, 1.2085369827305312, 1.0, 1.148989898989899, 1.1336405529953917, 1.0647368421052632, 1.0747755113072033, 2.5, 1.0379256965944272, 1.008130081300813, 1.0710200824577736, 1.0390904611482679, 1.1953781512605042, 1.1215986394557824, 1.1418545062943295, 1.0943024572807407, 1.0588235294117647, 1.1125, 1.0964408725602754, 1.3333333333333333, 2.0, 1.0405068379949822, 5.0, 1.625, 1.96875, 1.0313131313131314, 1.0330808585861844, 1.1443009545199325, 1.0161943319838056, 1.2857142857142858, 1.1372515712587057, 1.004335260115607, 1.2170542635658914, 1.2854291417165669]
origin-bjaq_15.71 	max: 5.0000	99th: 2.6667	95th: 1.7448	median: 1.0872	mean: 1.1828

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.139399 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.163305