Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 20, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.5000	95th: 1.7161	median: 1.0809	mean: 1.1726
ReportEsts: [1.0430463576158941, 1.0028645833333334, 1.0504535393429104, 1.1016949152542372, 1.5, 1.0, 1.0233487589398402, 1.0419708794408853, 1.0, 1.0012853470437018, 1.1377947075289296, 1.0426521697972873, 1.0025263157894737, 1.1465116279069767, 1.0519251148004238, 1.0, 1.3043478260869565, 1.0665958200495926, 3.0, 2.0, 1.0384615384615385, 1.1485683146735362, 1.0763720097223999, 1.0616559013505578, 1.0670942279230389, 1.0, 1.152940753005543, 1.2, 1.2, 1.0215827338129497, 1.0, 1.0504387912810218, 1.004917942030412, 1.1958934517203108, 1.0412689087971803, 1.2474453171184867, 1.106951871657754, 1.0301673462240788, 1.1505268957917212, 1.0238095238095237, 1.2540192926045015, 1.0274390243902438, 1.0, 1.012579325906078, 1.1202695697252463, 1.890625, 1.0510204081632653, 1.11660777385159, 1.0293067696686318, 1.1296296296296295, 1.0688931518842297, 1.274914089347079, 1.0390013940105616, 2.0, 1.2025974025974027, 1.220740514309732, 1.2637867647058822, 1.3526570048309179, 1.0807453416149069, 1.25, 1.1358824063976736, 1.0877957658779576, 1.0909090909090908, 1.0114942528735633, 1.0, 1.0600256833608512, 1.3152629880606648, 1.75, 1.0, 1.0428824461638855, 1.0120772946859904, 1.0602898550724638, 1.0160183066361557, 1.1350683338179703, 1.1011764705882352, 1.0546875, 1.0, 1.1144050104384133, 2.0, 1.0157967230049643, 1.2307692307692308, 1.034872669935417, 1.2269938650306749, 1.055690072639225, 1.1300294406280667, 1.0, 1.0756862160778953, 1.0105293911417552, 1.0637254901960784, 1.75, 1.180431351920042, 1.0721835645928792, 1.1433021806853583, 1.0127840909090908, 1.0233644859813085, 1.0753246753246752, 1.0227272727272727, 1.1501472031403337, 1.0, 1.2260146592276555, 1.0044636429085674, 1.072041166380789, 1.2322911684132714, 1.36, 1.013446122809388, 1.0514998672683833, 1.09862012987013, 1.130451270383011, 1.051808706315144, 1.3333333333333333, 2.0, 1.0696261682242991, 1.039733480691165, 1.067593177511055, 1.103896103896104, 1.0570288031232151, 2.0, 1.1094292021444339, 1.144578313253012, 1.0, 1.0167597765363128, 1.1666666666666667, 1.263157894736842, 1.0211420304414112, 1.0897724625300924, 1.0769230769230769, 1.8, 1.1390728476821192, 1.0, 1.0714285714285714, 1.1050699819038758, 1.3, 1.0517578125, 1.0181313470705344, 1.1190184049079754, 1.0293724966622162, 1.083086053412463, 1.0526110678098208, 1.039972432804962, 1.0731261425959782, 1.0368758801554976, 1.265625, 1.030658838878017, 1.1059984666123084, 2.0, 1.019598906107566, 1.0285714285714285, 1.1079037800687286, 1.0727016057878949, 1.5, 1.2794865584887383, 1.0180995475113122, 1.0060362173038229, 1.1074561403508771, 1.0233576642335767, 1.043492919757249, 1.1260774897843528, 1.2166328377859454, 1.0626262626262626, 1.019736842105263, 1.2653061224489797, 1.3529411764705883, 1.0309278350515463, 1.4285714285714286, 1.0354624396711993, 1.0300802903567698, 1.1946354883081156, 1.3642119618157023, 1.1220013708019192, 1.1065701942699637, 1.3073684210526315, 1.0892448512585813, 1.0843420160743682, 1.0667340748230536, 1.0483175150992234, 1.0767735665694849, 1.0373861137291862, 1.1027941553447833, 1.0408586930879924, 1.0, 1.0677966101694916, 1.039232289020604, 1.0281100478468899, 1.2205915556559042, 1.2105263157894737, 1.095917406177185, 1.2723428791082068, 1.144860723329654, 1.16, 1.1363636363636365, 1.0902805561112223, 1.0, 1.1818181818181819, 1.0451708140025306, 1.0102156640181612, 1.0299145299145298, 1.5909090909090908, 1.0553054662379422, 1.0580370676765134, 1.0669903144804496, 1.0626410835214446, 1.0334141456730261, 1.0172413793103448, 1.0847457627118644, 1.2, 1.0, 1.4285714285714286, 1.150055196341271, 1.362369337979094, 1.1494252873563218, 1.0103806228373702, 1.0031277926720286, 1.035168304188983, 1.0432804350238598, 1.2030786060321925, 1.1069182389937107, 1.0202312138728324, 1.014906027219702, 1.0048250904704463, 1.006544712651583, 1.0, 1.1113871635610766, 1.1077344257774802, 1.0149282841760807, 1.1546518792359828, 1.0027362276541407, 1.2685910505419036, 1.0357142857142858, 1.0063126697672327, 1.1895306859205776, 1.038917089678511, 1.1636363636363636, 1.0567733450241121, 1.0471953578336557, 1.1826771653543307, 2.0, 1.1706777316735824, 1.1155649843680215, 1.0546179090482888, 1.1213389121338913, 1.0, 1.6666666666666667, 1.1009479256432353, 1.1090909090909091, 1.0955158841720551, 1.5, 1.0, 1.0810810810810811, 1.1174863387978142, 1.010204081632653, 1.0254957507082152, 1.1571729957805907, 1.0541455160744502, 1.0029387069689337, 1.1271171676893594, 1.0178571428571428, 2.0, 1.0714638208623775, 1.1506395073424918, 1.1225919439579686, 1.0038401813069207, 1.1132032796154934, 1.0727519045692067, 1.0802861685214626, 1.0924423005827157, 1.0161483253588517, 1.0577771243751837, 1.1125836862959422, 1.0909090909090908, 1.0012132423601767, 1.1495098039215685, 1.2045454545454546, 1.3888888888888888, 1.0257366654233495, 1.0555555555555556, 1.017094017094017, 1.1214857681178925, 1.0558823529411765, 1.368421052631579, 1.0071768230831022, 1.0016806722689076, 1.036337622240706, 1.060817047910663, 1.1111111111111112, 1.0672608221171336, 2.5, 1.023014183465181, 1.0151187904967602, 1.0366938236766647, 1.0810810810810811, 2.0, 1.565217391304348, 1.0597014925373134, 1.0568859775872588, 1.0, 1.0548387096774194, 1.0158371040723981, 1.0104166666666667, 1.0132777287300776, 1.08, 1.1132075471698113, 1.0045425850796608, 1.2007337704249754, 1.0640398280924217, 1.1452991452991452, 1.0, 1.0894988066825775, 1.2727272727272727, 1.1145833333333333, 1.0481465880370682, 1.0262718932443704, 1.1451612903225807, 1.3409090909090908, 1.0110957004160888, 1.043343653250774, 1.2857142857142858, 1.0032380338535671, 1.0459770114942528, 1.0526315789473684, 1.0783165499124343, 1.3333333333333333, 1.2727272727272727, 1.005828525539424, 2.0, 1.159122085048011, 1.0392441860465116, 1.0648072190319935, 1.0813905930470347, 1.2809364548494984, 1.1097560975609757, 1.1148283932412506, 1.0871286807364313, 1.0411347517730496, 1.0472375358510657, 1.0320218265364733, 2.0, 1.0, 1.0714710116775978, 1.25, 1.068561872909699, 1.3529411764705883, 1.0, 1.4666666666666666, 1.288152610441767, 1.0760456273764258, 1.2169811320754718, 1.0238095238095237, 1.0, 1.1857523302263648, 1.0887496982215188, 2.0, 1.289458010720667, 1.0, 1.0930236088969862, 1.0470588235294118, 1.0222251377591183, 1.1543778801843319, 1.1363636363636365, 1.3205849268841394, 1.2037037037037037, 1.036158334507225, 1.0203116187023387, 1.0562587904360057, 1.0, 1.0769230769230769, 1.5714285714285714, 1.5, 1.0666666666666667, 1.0702081946170057, 1.3333333333333333, 1.038269550748752, 1.1744186046511629, 1.2423269430541128, 1.093803133746632, 1.2677651905252316, 1.0091270881490837, 1.0104408352668213, 1.0392857142857144, 1.5, 1.266490765171504, 1.0680851063829788, 1.0456496578610732, 1.1428571428571428, 1.5714285714285714, 1.0089887640449438, 1.001747233546884, 1.0253881946985937, 1.0061652281134401, 1.1464387464387464, 1.0038450975006867, 1.0810810810810811, 1.0907770515613653, 1.0720338983050848, 1.2115384615384615, 1.028328611898017, 1.128440366972477, 1.0418298629924916, 1.059997112747221, 1.0249728463058148, 1.1168831168831168, 1.099009900990099, 1.115264797507788, 1.0, 1.0046298048417415, 1.0431299831135241, 1.014663494532644, 1.0570805556545815, 1.0564703505404587, 1.148395297108357, 1.5714285714285714, 1.0333998005982055, 1.0, 1.1716481639624252, 1.25, 1.0472635825192451, 1.0072463768115942, 1.1240326741186586, 1.1225296442687747, 1.196926032660903, 3.0, 1.124135660190978, 1.0057280371864905, 1.1290003678499172, 2.0, 1.0476190476190477, 1.2754318618042226, 1.2517985611510791, 1.0727178132628967, 1.2972972972972974, 1.1666666666666667, 1.0441441441441441, 1.0843681889604135, 1.100110869297417, 1.0967963011225976, 1.0676535087719299, 1.0580431177446104, 1.1136363636363635, 2.142857142857143, 1.100558659217877, 1.4444444444444444, 1.225752508361204, 1.3333333333333333, 1.1027424436923796, 1.9230769230769231, 1.075311809989855, 1.1360394576294488, 1.0919185687847008, 1.0, 1.1875, 1.2, 1.2864293938028732, 1.2691466083150984, 1.0, 1.0225330225330225, 1.123083823645814, 1.002486531288852, 1.5, 2.0, 1.0372815533980582, 1.0026954177897573, 1.0, 1.1111111111111112, 1.082602058579348, 1.09400826446281, 1.4705882352941178, 1.0625612052730697, 1.0454545454545454, 1.1062992125984252, 1.0169354838709677, 1.3592763988220447, 1.0202635431918008, 1.0, 1.0422535211267605, 1.059908875904285, 1.0570130273459848, 1.040565945998509, 1.0, 1.0847157708471578, 1.011087872290826, 1.0214772132006287, 2.0, 1.04585326953748, 1.055191256830601, 1.0014151360594357, 1.013818149608043, 1.0136815426997245, 1.0535418147358446, 1.0093299406276506, 1.1012536162005786, 2.0, 1.1516357434492739, 1.6444444444444444, 1.25, 1.1347150259067358, 1.1346153846153846, 1.0240264395025507, 1.1852970795568982, 1.0344629852629164, 1.0913262964662689, 1.0804241673347423, 1.0679020695252266, 1.0543477004519344, 1.0842105263157895, 3.0, 1.0082679150162046, 1.1437246963562753, 1.0467657031750173, 1.0302749829754174, 1.0791476407914764, 1.0977496483825597, 2.458823529411765, 2.4285714285714284, 1.0007303890539028, 1.035352578743886, 1.0590066063126988, 1.1326151560178306, 1.000024103355187, 1.027542372881356, 1.0698073027580117, 1.017563117453348, 1.215170278637771, 3.0, 1.0833333333333333, 1.0939597315436242, 1.0620300751879699, 1.0661896243291593, 1.0950520833333333, 1.0059171597633136, 1.4214285714285715, 1.148905109489051, 1.123456790123457, 1.0979366640801138, 1.2150537634408602, 1.0279629829234866, 2.0, 1.14379622021364, 1.0413223140495869, 1.2155172413793103, 1.0930167597765363, 1.0109409190371992, 1.0140280561122244, 1.0051880674448768, 1.1229267772385472, 1.0, 1.4042553191489362, 1.0, 1.0, 1.1363636363636365, 1.0141129032258065, 1.0154320987654322, 1.0728155339805825, 1.0660044857417494, 1.12877030162413, 1.1219755933506295, 1.1775907111756168, 1.037837837837838, 1.0845021553990117, 1.0632183908045978, 1.073697585768742, 1.0532172230285437, 1.0725099601593626, 1.2109826589595376, 1.1336391437308868, 1.017534079967567, 1.2105556587994797, 1.0794787966055686, 2.0, 1.28992628992629, 1.0702274975272008, 1.4205607476635513, 1.0, 1.0408163265306123, 1.25, 1.202127659574468, 1.3703703703703705, 1.1666666666666667, 1.0078582533813447, 1.1287637158733024, 1.0299542150598826, 1.030489227658085, 1.2162162162162162, 1.1258549931600548, 2.0, 1.1755725190839694, 1.0590942293644996, 1.092756394931867, 1.0844748660128731, 1.064699851919353, 1.0133715031163937, 1.1792207792207792, 1.044437961882536, 1.1296625222024868, 1.029665672578873, 1.115495397127205, 1.303030303030303, 1.0360824742268042, 1.0, 1.2422535211267605, 1.206553408018384, 3.0, 1.1505981703026038, 1.0689320612626765, 1.4285714285714286, 1.0454562572967272, 1.3, 1.1176470588235294, 1.0717755647316007, 1.6153846153846154, 1.0261834837992339, 1.0491243058522, 1.3571428571428572, 1.0357142857142858, 1.1731958762886598, 1.0170233463035019, 1.0165562913907285, 1.1088989845002672, 1.1563706269166807, 1.0, 1.0392678687812296, 1.1341463414634145, 2.0, 1.0300532167632805, 1.1175966779133144, 1.0908230842005677, 1.0182782005157758, 1.029905528297365, 1.118811881188119, 2.0, 1.00076074553062, 1.0379032258064516, 1.1395822374560942, 1.192047713717694, 1.00134863321211, 1.1061731146992853, 1.0842490842490842, 1.1418861512319456, 1.2073578595317727, 1.0918964888834892, 1.1047318611987382, 1.127717391304348, 1.0149253731343284, 1.0502481104022243, 3.0, 1.1396814963100181, 1.0322815658509055, 1.0384525166787586, 1.3571428571428572, 1.3278016942091375, 1.2431192660550459, 1.1428571428571428, 1.0670452140791422, 1.0420575865415722, 1.1572052401746724, 1.0588235294117647, 1.3333333333333333, 1.0723963332869255, 1.5, 1.019047619047619, 1.0833333333333333, 1.0251552578326704, 1.3846153846153846, 1.1561181434599157, 1.0628930817610063, 1.0, 1.787037037037037, 1.2115689381933439, 1.5, 2.0, 1.1271186440677967, 1.1620689655172414, 1.00653983353151, 1.194235588972431, 1.1091854419410745, 1.2507374631268438, 1.1014466214978942, 1.0571428571428572, 1.1722488038277512, 1.3142857142857143, 1.04, 1.0, 1.1875746714456392, 1.101010101010101, 1.0320247933884297, 1.0538268369909378, 1.072627341984513, 1.0582056892778993, 1.080759197225269, 1.1358805668016194, 1.1477900552486189, 1.0213284582571602, 1.5714285714285714, 1.0, 1.2592592592592593, 1.0435152159065038, 1.1023830538393644, 1.107843137254902, 1.0074441687344913, 1.0152730049637266, 1.020547477643525, 1.0070085711478953, 1.1142857142857143, 1.2222222222222223, 1.0312977099236642, 1.0798647932131495, 1.1013962429597652, 1.0201442729050092, 1.0, 1.0445215593620791, 1.0149110568538542, 1.1015514809590974, 1.3564154786150713, 1.125, 1.0927479033053773, 1.7142857142857142, 1.1304347826086956, 1.0485714285714285, 1.0701001430615165, 1.0, 1.0354609929078014, 1.0244710638368375, 1.0185185185185186, 1.0863404421305694, 1.0227518959913326, 1.303030303030303, 1.0627840799351043, 1.0343186733958183, 1.1350053720118185, 1.0467557251908397, 1.0170261066969353, 1.2001758598532246, 1.1965811965811965, 1.2142857142857142, 1.0, 1.25, 1.072592951435146, 1.3333333333333333, 1.1667278736687476, 1.1159872920144311, 1.0660168365086398, 1.0711022840119166, 1.0554963341090509, 1.0543408360128617, 1.050179211469534, 1.0527045769764216, 1.0135769131425083, 1.1096972253468316, 1.0455791620932133, 1.22458749849452, 1.6666666666666667, 1.015625, 1.0326530612244897, 1.09745571770252, 1.019543973941368, 1.299808166620992, 1.029143897996357, 2.1923076923076925, 1.0445215931634366, 1.0241610738255034, 1.0536124401913876, 1.125, 1.0582448873932178, 1.0518489498313202, 1.297034764826176, 1.0581052631578947, 1.03125, 1.1293833131801694, 1.1420454545454546, 1.5, 1.0403327716933446, 1.6923076923076923, 1.0584677419354838, 1.0756501182033098, 1.0451021846370683, 1.0382867132867133, 1.0059171597633136, 2.2, 1.0769230769230769, 1.0920438251406301, 1.0539418856603144, 1.0041072254660481, 1.0479016314943395, 1.0888334817453251, 1.0769230769230769, 1.0782978723404255, 1.079957805907173, 1.0427111700765774, 1.0470941883767535, 1.0138888888888888, 1.0982867448151488, 1.0002960331557134, 1.3951367781155015, 1.0604462699822381, 1.0, 1.3333333333333333, 1.0489307523053721, 1.039947322212467, 1.252212389380531, 1.0449263274951348, 1.068635275339186, 1.0739856801909309, 1.1088801490374665, 1.102604183989091, 1.1856617647058822, 1.0, 1.0340333091962346, 1.0889167034800962, 1.0952380952380953, 1.75, 1.049626687502713, 1.1651609989030134, 1.060459492140266, 1.0284090909090908, 1.1976828385228095, 1.0134025776355937, 1.1636210289569862, 1.509433962264151, 1.2692307692307692, 1.0444743935309972, 1.0462555066079295, 1.146875, 1.5925925925925926, 1.0544083137780758, 1.184340931615461, 1.1650082918739635, 1.025, 1.0124452469321563, 1.0624279677295427, 1.0696452476572957, 1.247276688453159, 1.3333333333333333, 1.4736842105263157, 1.3333333333333333, 1.1337513061650992, 1.2692307692307692, 1.0, 1.1538461538461537, 1.0874172185430464, 1.068840579710145, 1.044186380959229, 1.030153391846444, 1.28, 1.3076923076923077, 1.1428571428571428, 1.1071428571428572, 1.0945945945945945, 1.0144927536231885, 1.1609403254972874, 1.0225545882495966, 1.0274980520203332, 1.3333333333333333, 1.0780041443548554, 1.0471347780391371, 2.5, 1.0666700690687625, 1.2704174228675136, 3.0, 2.0, 1.18698224852071, 1.1220684214301082, 1.0836129465207516, 1.2577639751552796, 1.0, 1.070539419087137, 1.0950920245398772, 3.0, 1.5, 1.0441932168550874, 1.1842989649146392, 1.0248431297221154, 1.6666666666666667, 1.0326676347484411, 1.0426026336173508, 1.070252469813392, 1.0, 1.1126760563380282, 1.0240644932549887, 1.0263157894736843, 1.1832723068028521, 1.0366362172960184, 1.210826210826211, 1.12109375, 1.0459135896734042, 1.1120607787274455, 1.1446280991735538, 1.2105263157894737, 1.0186362405978033, 1.1794575879976918, 1.0744237546432993, 1.2014388489208634, 1.1274509803921569, 1.2985074626865671, 1.1046831955922864, 1.06, 1.01190773254015, 1.0515347767771603, 1.019650655021834, 1.5, 1.6666666666666667, 1.1041040721089306, 1.193051890941073, 1.0579653763859171, 1.0233490016077367, 1.1006857334002342, 1.1317669334710387, 1.221606648199446, 1.0, 1.0856850876503419, 1.0783012471492264, 1.2496318114874816, 1.222416812609457, 1.6666666666666667, 1.0714285714285714, 1.0372526636225265, 1.203970080552359, 1.0359064686585977, 1.1017353579175706, 1.0134943181818181, 2.0, 1.0974358974358975, 1.0104185238010341, 1.1784327164724697, 1.064638783269962, 1.1112561388451818, 1.0064102564102564, 1.3178807947019868, 1.032463768115942, 1.0303927652517246, 1.0598535230238235, 1.0414746543778801, 1.0654843110504775, 1.0, 1.0852109411219286, 1.037503428101289, 1.0557880055788005, 1.0114216422219655, 1.0950639853747715, 1.0310136157337368, 1.2857142857142858, 1.2593582887700534, 1.6666666666666667, 2.0, 1.1176470588235294, 1.0129533678756477, 1.0347551342812007, 1.0078595755829185, 1.0088020187331594, 1.0154312482777625, 1.045037166593791, 1.173913043478261, 1.0, 1.0331656810959826, 1.6, 1.5, 1.1185885776646054, 1.1428571428571428, 1.1109467455621302, 1.1284722222222223, 1.0248760703019377, 1.0811299930207268, 2.0, 1.047001620745543, 1.189922480620155, 1.0558188520273828, 1.0407350661027368, 1.1982323232323233, 1.1160958904109588, 1.1447647071936513, 1.1950106088857455, 1.0429252782193958, 1.1451612903225807, 1.0502793296089385, 1.0, 1.0, 1.0416741175208326, 5.0, 1.4285714285714286, 2.0, 1.0310945273631842, 1.146341463414634, 1.1042128603104213, 1.0827775598273832, 1.0, 1.0875232774674115, 1.012266355140187, 1.2252747252747254, 1.3269230769230769, 1.4285714285714286, 1.0378527185134205, 1.098669623059867, 1.1469933184855234, 1.0360728895500186, 1.0243526918747103, 1.104851485148515, 1.1129843241644484, 1.0, 1.2872614968058553, 1.0524631658063732, 1.0677008608321377, 1.1774193548387097, 1.0923933014856424]
origin-bjaq_15.71 	max: 5.0000	99th: 2.5000	95th: 1.7161	median: 1.0809	mean: 1.1726

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 13.904674 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[5.9604645e-08 6.5565109e-07 1.7881393e-06 2.9802322e-07 4.1723251e-07]
Distance score: 6.437301749429025e-07
SAUCE Drift detection: False
Detection latency: 0.0236s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.035215 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 8.0000	99th: 3.0000	95th: 1.8037	median: 1.0795	mean: 1.1933
ReportEsts: [1.0104166666666667, 1.0030368763557485, 1.0484544594374703, 1.026711185308848, 1.4583333333333333, 1.0, 1.0547005461028118, 1.0670571103454312, 1.0, 1.0054406964091405, 1.1293930865266653, 1.0427228035359914, 1.062992125984252, 1.111545988258317, 1.0383265067290814, 1.0108695652173914, 1.1915584415584415, 1.4375, 1.2727272727272727, 1.0795644891122278, 1.0969813020950665, 1.107614381798555, 1.060984393757503, 1.004212299915754, 1.0197070478347015, 1.0301971564199999, 2.0, 1.1401636428317325, 1.0, 1.3333333333333333, 1.100470035252644, 1.0, 1.0482981836454193, 1.0048339266811737, 1.1927322907083717, 1.0306485227412039, 1.2336135626329927, 1.14, 2.0, 1.0401904667916708, 1.0209848136217212, 1.0573945175659236, 1.0834340991535671, 1.0977777777777777, 1.0217785843920144, 1.0052594892592357, 1.3, 1.0495689655172413, 1.308457711442786, 1.03125, 1.1, 1.2380952380952381, 1.0408163265306123, 1.0285714285714285, 1.0354904766604165, 1.0081516117019076, 1.0726399519735854, 1.0509708737864079, 1.041237113402062, 1.0438397649789641, 1.5333333333333334, 1.1198368659102762, 1.0688622754491017, 1.0955882352941178, 1.099009900990099, 1.0, 1.2173040354954574, 1.3585115245765065, 1.8, 1.0, 1.030091515433535, 1.007866273352999, 1.078345498783455, 1.0445736434108528, 1.0825638449947843, 1.213903743315508, 1.0611681572264546, 1.3333333333333333, 1.4660194174757282, 1.0747968222080175, 1.0508905852417303, 1.1107011070110702, 1.0, 3.3333333333333335, 1.058553386911596, 1.1290322580645162, 1.479239619809905, 1.0175438596491229, 1.625, 1.0726937860345933, 1.1112113014727982, 1.248129468491936, 1.0340216221755392, 1.116318147871546, 1.154046997389034, 1.002290950744559, 1.0119047619047619, 1.06155950752394, 4.0, 1.2454901960784315, 1.103448275862069, 2.0, 1.0684727089781962, 1.2251599147121535, 1.0296191819464033, 1.225016164954379, 1.3448275862068966, 1.018980977122266, 1.032862814292016, 1.2410099464422342, 1.0675422138836772, 1.0446134347275031, 1.5, 1.4, 1.0469474497681608, 1.0405346692676007, 1.0536378120021244, 1.2444444444444445, 1.0605863260611534, 1.0, 1.0851900393184797, 1.15263644773358, 1.0, 1.033175355450237, 1.1428571428571428, 1.278723404255319, 1.0155170991538807, 1.0369336622095287, 1.1083333333333334, 1.6666666666666667, 1.1358361774744028, 1.0, 1.625, 1.1364935903347781, 1.25, 1.0394618834080718, 1.0286660822641422, 1.0530626290433587, 1.75, 1.3571428571428572, 1.0492505353319057, 1.0768543342269883, 1.0687563195146612, 1.0546181521669158, 1.2532467532467533, 1.0467645459488852, 1.0785295727812811, 3.0, 1.0170583775587567, 1.0467111534795044, 1.1058758314855877, 1.0723655121591746, 1.5, 1.155103268498095, 1.0265822784810126, 1.020442930153322, 1.2361963190184049, 2.0, 1.0207900207900207, 1.1649205108157414, 1.1149083911988622, 1.0786713286713288, 1.080110497237569, 1.088235294117647, 1.4333333333333333, 1.0221130221130221, 1.5, 1.055694736593321, 1.7222222222222223, 1.0024067388688327, 1.0185830915329448, 1.1449023861171366, 1.019154529900263, 1.2792321116928447, 1.09126213592233, 1.1254946297343131, 1.022848438690023, 1.0797679477882522, 1.0543831168831168, 1.0444562053453295, 1.096507589400566, 1.2136966469326025, 1.1875, 1.5142857142857142, 1.000558909525943, 1.1102807145461173, 1.3223443223443223, 1.1161050193463737, 1.0483091787439613, 2.5, 1.2714285714285714, 1.107340517456849, 1.24, 1.135243841126194, 1.0213708124759338, 1.0169793853238698, 1.0026684560406978, 1.1228771228771228, 1.1673933354095298, 1.1519802880051704, 1.0337078651685394, 1.00100525474069, 1.0211854320399905, 1.055278244344034, 1.0860366713681242, 1.0269046109249027, 1.0241545893719808, 1.1095890410958904, 1.2375, 1.0, 1.3623188405797102, 1.0931176740226574, 1.3753665689149561, 1.0825688073394495, 1.0094146541137945, 1.05, 1.0450340807207181, 1.0276497695852536, 1.1978785952645796, 2.0, 1.0529634300126103, 1.0153804641122504, 1.0277305694520908, 1.0199446577157667, 2.0, 1.0971625107480654, 1.1046429567871856, 1.0054139231245427, 1.0271739130434783, 1.028428093645485, 1.087905935050392, 1.0884735409335369, 1.3387096774193548, 1.0018033739189671, 1.0321210393646216, 1.046583850931677, 1.0594227504244482, 1.04847801578354, 5.0, 1.1628989361702127, 2.0, 1.2873737373737373, 1.0903436988543371, 1.0971215978069317, 1.1788321167883211, 1.0, 2.0, 1.0166730099247592, 1.123076923076923, 1.0994336617308713, 1.4, 1.014407334643091, 1.2104208416833668, 1.1428571428571428, 1.0216583719151018, 1.0345622119815667, 1.090026478375993, 1.125, 1.0145338532435306, 1.0983678016176683, 1.0147058823529411, 2.0, 1.0650937740858097, 1.1189989785495404, 1.1428571428571428, 1.0588009893057442, 1.0944255892882049, 1.0272416749834834, 1.100983606557377, 1.1079713757808605, 1.0218362282878413, 1.0739859789684527, 1.1270463454000461, 1.4545454545454546, 1.020312249478916, 1.0356472795497185, 1.169811320754717, 1.2857142857142858, 1.1352473192666896, 1.4261363636363635, 1.0526425188880455, 1.0060362173038229, 1.1084905660377358, 1.3229166666666667, 1.0133230419798729, 1.1182879377431907, 1.105673996978345, 1.049455345783457, 1.1, 1.110759493670886, 1.079268292682927, 1.05204211155081, 1.1291624078756253, 1.0349825309409606, 1.2994736842105263, 1.2133182844243793, 1.0438070776255708, 1.0654402280904216, 1.1537879061046408, 1.0717084860445447, 1.0325278810408922, 1.1111111111111112, 1.2307692307692308, 1.0747943156320119, 1.25, 1.0386740331491713, 1.1077494039865314, 1.0651876198301835, 1.6363636363636365, 1.134453781512605, 1.197098976109215, 1.0837988826815643, 1.0326275170497816, 1.0869565217391304, 1.261204481792717, 1.024885420371352, 1.199438202247191, 3.6666666666666665, 4.0, 1.0722363258712209, 1.4285714285714286, 1.0184286942556333, 1.063391442155309, 1.0909090909090908, 1.074410390794121, 1.2307692307692308, 1.25, 1.0058174339904358, 3.0, 1.3013100436681222, 1.0178997613365155, 1.0891735744787743, 1.0362752430815259, 1.0176600441501105, 1.1855670103092784, 1.1111248677486887, 1.0903214901457017, 1.0040241448692153, 1.0227720008374626, 1.0736822453170702, 3.0, 1.0, 1.0426618725565733, 1.5, 1.0776744186046512, 1.5555555555555556, 1.5, 1.368421052631579, 1.3787234042553191, 1.0418929402637704, 1.255813953488372, 1.0451612903225806, 1.4305555555555556, 1.5, 1.0322116300566615, 1.2173913043478262, 1.1304347826086956, 1.0207474755366315, 1.144, 1.0829596412556053, 1.0160226201696512, 1.4, 1.25, 1.3786078098471986, 1.3553719008264462, 1.1009879253567507, 1.1310550763105507, 1.282522343594836, 1.0609137055837563, 1.5, 1.0331592552485416, 1.056338028169014, 1.5, 1.5, 1.1646153846153846, 1.1428571428571428, 1.0306345733041575, 1.2395833333333333, 1.2154829436073822, 1.0836826162440163, 1.1098517872711422, 1.1365501395043494, 1.119421152285637, 1.0154918667699457, 1.106351550960118, 1.1186684865028813, 1.0980392156862746, 1.0526315789473684, 1.0050427144804683, 1.054364137145028, 1.1354330708661418, 1.0153061224489797, 1.1136363636363635, 1.1154598825831703, 2.0, 1.0833333333333333, 1.1768707482993197, 1.1233644859813083, 1.0303030303030303, 1.1722488038277512, 1.1128065395095368, 1.0324483775811208, 1.0094897575138448, 1.1358260206028234, 1.1057490174572708, 1.4657534246575343, 1.2232142857142858, 1.1134020618556701, 1.0, 1.0612357196585338, 1.6153846153846154, 1.1110228926822814, 1.0247486465583913, 1.0652118536129744, 1.1676392572944296, 1.75, 1.2689549180327868, 1.0, 1.0047489823609226, 1.25, 1.0593135067503128, 1.0209617755856966, 1.1070850566444883, 1.1205211726384365, 1.131975867269985, 3.0, 1.1586089906700594, 1.0144592828031682, 1.2058017665881091, 2.0, 1.0394736842105263, 1.241021548284118, 1.2897196261682242, 1.104463208685163, 1.043418636360054, 1.0416666666666667, 1.0193271295633501, 1.028004142971605, 1.0539669489435173, 1.0176280642533566, 1.0122992907972792, 1.0096969696969698, 2.0, 1.0283325592196935, 1.0493502335957743, 1.065040650406504, 1.100486223662885, 1.0, 1.0, 1.090142671854734, 1.0766283524904214, 1.0252012600630032, 1.1359245531433806, 1.0622784810126582, 1.0, 1.184873949579832, 1.2413793103448276, 1.0055092790746167, 1.0, 1.0, 1.0549915232768867, 1.3333333333333333, 1.0, 1.0163684811572136, 2.3333333333333335, 1.0006501950585176, 1.01665404996215, 1.015748031496063, 1.0, 1.0803493774391377, 1.1296625222024868, 1.5, 1.0428504011326096, 1.078125, 1.138121546961326, 1.0745967741935485, 1.3979627678257815, 1.0213402668759812, 1.0, 1.0813953488372092, 1.0503035559410234, 1.1637191385046401, 1.0588703261734287, 1.2, 1.1046877895126923, 1.0172002263835231, 1.0267543859649122, 2.0, 1.0508871777703381, 1.0313518987341772, 1.0415111940298507, 1.0250717633806912, 1.0120923549485552, 1.1217277866357442, 1.0296400846859561, 1.080702720058713, 2.6666666666666665, 1.0638371290545203, 1.135135135135135, 1.0662902037809967, 1.0740337506804574, 1.0349462365591398, 1.0069366127537902, 1.2924613987284288, 1.0646258773777633, 1.0226574500768049, 1.060231268999225, 1.1682758620689655, 1.1178596351310937, 1.0180350135828553, 1.0340909090909092, 1.4782608695652173, 1.1429259726510248, 1.0711206896551724, 1.0023237391074729, 1.0680194512817434, 1.0, 1.0592900302114803, 1.180232558139535, 2.25, 1.1481481481481481, 1.0134530244180677, 1.1865671641791045, 1.0925925925925926, 1.0, 1.125, 1.0109814687714482, 1.122605885354652, 1.036734693877551, 1.0448966036964658, 1.0786773090079818, 1.0793650793650793, 1.01226366888094, 1.0178298751459625, 1.5375722543352601, 1.0223346073770236, 1.0438561833267483, 1.0445544554455446, 1.0915811169685679, 1.1818888457054022, 1.0182011885966602, 2.0, 1.1427590940288264, 1.0033783783783783, 1.0413450866830805, 1.1674528301886793, 1.0904522613065326, 1.1347905282331512, 1.2394366197183098, 1.1442722914234549, 2.0, 1.2962962962962963, 1.1666666666666667, 1.0, 1.087719298245614, 1.056338028169014, 1.048913043478261, 1.1050420168067228, 1.0574270557029177, 1.0665039658328248, 1.0522982020612353, 1.171126862433097, 1.0649004898596681, 1.063359189829778, 1.0155436899789714, 1.0841371918542337, 1.0607367475292004, 1.0543686144244804, 1.0536750483558994, 1.0527448869752423, 1.120879120879121, 1.575, 1.0245398773006136, 1.1285878300803673, 1.1002378658908176, 1.329479768786127, 1.2060737527114966, 1.019448946515397, 2.0, 1.0387323943661972, 1.2, 4.0, 1.2857142857142858, 1.0416832292811435, 1.0329711502435368, 1.0025706940874035, 1.1215469613259668, 1.1022708927514395, 1.0424099017109574, 1.1245487364620939, 1.4, 2.0, 1.021829632792485, 1.2081447963800904, 1.0894242547978767, 1.1108247422680413, 1.0, 1.155858310626703, 1.1591397849462366, 1.0821448944666285, 1.1343283582089552, 1.0191656850096296, 1.0347932678638845, 1.0003996478919226, 1.4772727272727273, 1.25, 1.1520584678479415, 1.0, 1.0232288037166086, 1.2076271186440677, 1.4439746300211416, 1.090591265947007, 1.6363636363636365, 1.1699029126213591, 1.1506849315068493, 1.0299539170506913, 1.092291182257199, 1.1993421052631579, 1.0432242990654206, 1.0359969845457973, 1.0009082652134422, 1.0649305555555555, 1.0, 1.0043861336616522, 1.0182230847669484, 1.0, 1.0088315217391304, 1.2663295841502424, 1.0299625468164795, 1.0252043843148604, 1.375, 1.1162790697674418, 1.0958541605410173, 1.0930232558139534, 1.180232558139535, 1.0598227016304012, 1.0236220472440944, 1.5, 1.0827916524119057, 1.0345744680851063, 1.1237514501570414, 1.2125, 1.0384149565050222, 1.0465676453241006, 1.1174698795180722, 1.0859883521754026, 1.2254335260115607, 1.0826229705714028, 1.0634837355718783, 1.027027027027027, 1.1387915936952715, 1.0850523446695162, 1.236842105263158, 1.035190615835777, 1.0416666666666667, 1.6, 1.1065162907268171, 1.585541474654378, 1.0783039306716187, 1.6756756756756757, 1.0769230769230769, 1.0015974440894568, 1.0364676439041831, 1.0119760479041917, 1.031723504326244, 2.3333333333333335, 1.195188242399839, 1.5, 1.0333333333333334, 1.0666666666666667, 1.0681983001189337, 1.4, 1.132404181184669, 1.0531822144725371, 1.0, 1.1803874092009685, 1.2056504599211564, 1.2, 3.0, 1.095890410958904, 1.1970588235294117, 1.0487425460202229, 1.184873949579832, 1.1349325337331335, 1.392638036809816, 1.0374064837905237, 1.0221213840045378, 1.1338582677165354, 1.3172413793103448, 1.0666666666666667, 2.0, 1.1136363636363635, 1.0468187274909964, 1.0573476702508962, 1.0068719554627696, 1.0749182429427309, 1.0484279918864097, 1.0511290720631787, 1.0816486396914826, 1.1902497027348395, 1.0030090270812437, 1.625, 2.0, 1.3125, 1.0102133683891192, 1.0803183791606368, 1.1305555555555555, 1.0227743271221532, 1.0177370813856694, 1.0083612972273939, 1.0149019041751626, 1.0459770114942528, 1.2857142857142858, 1.116632160110421, 1.1182492253209384, 1.0510794943103194, 1.01328097028285, 1.0225988700564972, 1.058357080906951, 1.0252694268514164, 1.092892112420671, 1.0788504053058217, 1.1037856963927857, 1.1269349845201238, 1.075325732899023, 1.0296442687747036, 1.0227090593118848, 1.0454545454545454, 1.1566970091027309, 1.0, 1.0899581589958158, 1.0063631913852178, 1.0909090909090908, 1.0856529203927001, 1.0105355575065846, 1.1951219512195121, 1.001561058681615, 1.0351247138209423, 1.0726616490864833, 1.0548926014319808, 1.0321637426900585, 1.1975697569756976, 1.2332730560578662, 1.4666666666666666, 1.0, 1.2222222222222223, 1.070509063718853, 1.6666666666666667, 1.1022239649610843, 1.1037303370786518, 1.0749444855662473, 1.0713927436883464, 1.0648828441942093, 1.0095118449389806, 1.0210843373493976, 1.0461361014994233, 1.002427222474514, 1.1506996560350218, 1.0447610378548104, 1.2678656532972132, 1.875, 1.0687203791469195, 1.0681818181818181, 1.0706330428761037, 1.0350404312668464, 1.2507166482910694, 1.0455235204855842, 2.1473684210526316, 1.0581989117486075, 1.0429864253393666, 1.0412617969233224, 1.1428571428571428, 1.0526617534643956, 1.0340133871100032, 1.3491436100131753, 1.0534591194968554, 1.52, 1.01067615658363, 1.383219954648526, 1.0289576516186423, 1.060893098782138, 1.0160552480775824, 1.0263157894736843, 1.0452724077328648, 1.0718372536554355, 1.0012836970474968, 1.004676539360873, 1.0118721461187214, 1.0626836434867777, 1.0388538125303546, 1.0065278440514092, 1.0813953488372092, 1.0159716491091801, 1.085770211756332, 1.0, 1.0516173434273917, 1.0598172728839854, 1.0685829145728643, 1.0022075055187638, 1.1016154247003647, 1.1977342945417095, 1.0732984293193717, 1.0073349633251834, 1.043465695917581, 1.158273381294964, 1.1018033740546829, 1.2406460187683757, 1.04173801369863, 1.067001675041876, 1.0842550147312142, 1.089787102746066, 1.0716700473292766, 1.1965442764578833, 1.0918215643917304, 1.0771988917259738, 1.1226993865030674, 1.0436893203883495, 1.0666255397902529, 1.084281948049294, 1.0571428571428572, 2.25, 1.0426544540229885, 1.16561932315145, 1.016361886429259, 1.0141509433962264, 1.1638246041412912, 1.0160175242378058, 1.1593108331366533, 1.1600621600621601, 1.4137931034482758, 1.0664040517726505, 1.1, 1.1125319693094629, 1.5, 1.086090005300994, 1.2, 1.1124031007751938, 1.0, 1.1051282051282052, 1.0548565676899848, 1.1030927835051547, 1.0634920634920635, 1.031696706028589, 1.06198347107438, 1.0786573146292586, 1.0769230769230769, 1.0121423192771084, 1.0100603621730382, 1.003125361731682, 1.280701754385965, 1.2857142857142858, 1.2178477690288714, 1.0401067525458096, 1.030379746835443, 1.0612244897959184, 1.265625, 1.1176470588235294, 1.0238095238095237, 1.1566265060240963, 1.2098765432098766, 1.0952380952380953, 1.0275198901680114, 1.0283254771655976, 1.3304347826086957, 1.065758243259396, 1.0471096808080471, 2.5, 1.1070225530140194, 1.0717701473816243, 1.5, 2.5, 1.1946424182845907, 1.1450628366247755, 1.072803061801047, 1.2722513089005236, 1.5, 1.020066889632107, 1.1862244897959184, 1.337837837837838, 1.0135213798514358, 1.1002806206668867, 1.0496605870028084, 1.0352242031334413, 1.4285714285714286, 1.0447467566882502, 1.035828534868842, 1.0619946091644206, 1.0548172757475083, 1.0092807424593968, 1.0, 1.0486401673640167, 1.153063354555892, 1.023479257835839, 1.6, 1.0557275541795665, 1.077548900813571, 1.0470149253731342, 1.0332225913621262, 1.1304347826086956, 1.051027794850782, 1.2683435422911509, 1.096615565559476, 2.1649484536082473, 1.1818181818181819, 1.0194174757281553, 1.125, 1.0817322354376335, 1.0759162303664922, 1.008077062473958, 1.0619946091644206, 2.0, 1.1153846153846154, 1.0148583557841457, 1.1558011049723758, 1.0864177663340844, 1.0112394081749132, 1.1091011078390127, 1.1037666303928109, 1.3407960199004976, 1.0576923076923077, 1.0723739975223316, 1.0881328070821312, 1.224773413897281, 1.0462249614791987, 2.3333333333333335, 1.072289156626506, 1.0408755634476163, 1.0516717325227964, 1.0134228187919463, 1.0982822431120185, 1.0266429840142095, 2.0, 1.1143473570658036, 1.0928498303791878, 1.1802753158589478, 1.0364741641337385, 1.0906113537117903, 1.0448548812664908, 1.1919475655430711, 1.009784735812133, 1.032114140620277, 1.0123504372328853, 1.0075329566854991, 1.0674915635545557, 1.0555555555555556, 1.196373588778652, 1.0076929807019297, 1.015147914934062, 1.033774834437086, 1.1199376947040498, 1.0176656151419559, 1.2341772151898733, 1.195744680851064, 3.3333333333333335, 2.0, 1.263157894736842, 1.0485651214128036, 1.0438144329896908, 1.0013932751253947, 1.0096196723197974, 1.0791722896986056, 1.0333275473008159, 1.1605504587155964, 1.2451403887688985, 1.0290920772128611, 1.6666666666666667, 1.5714285714285714, 1.175393511082557, 1.125, 1.0630841121495327, 1.1281840591618735, 1.048949397969623, 1.0842219715950916, 2.0, 1.0632944228274968, 1.3913978494623656, 1.0788619583578491, 1.0393301347675947, 1.1502645502645503, 1.1317829457364341, 1.1454160318109183, 1.146661162142636, 1.0292164674634794, 1.3235294117647058, 1.1018518518518519, 1.0, 2.0, 1.0407957383920694, 8.0, 1.7142857142857142, 1.90625, 1.0141557128412537, 1.0238712033390274, 1.004491858506457, 1.0193050193050193, 1.0, 1.064494722871769, 1.0166177908113392, 1.5, 1.3454545454545455]
origin-bjaq_15.71 	max: 8.0000	99th: 3.0000	95th: 1.8037	median: 1.0795	mean: 1.1933

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.131543 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.148796