Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 68, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.5025	95th: 1.6960	median: 1.0804	mean: 1.1715
ReportEsts: [1.0606060606060606, 1.0098958333333334, 1.0436902333521403, 1.04, 1.5, 1.0, 1.0457305604814875, 1.0413158875023283, 1.0, 1.0223097112860893, 1.216777768158601, 1.0431129731265474, 1.0153518123667378, 1.1255813953488372, 1.0657011656658424, 1.0, 1.0465116279069768, 1.0071352122725652, 3.0, 2.0, 1.0, 1.0521896982073973, 1.0752715654952076, 1.1150910158543745, 1.0547607301430686, 1.0, 1.141355473204105, 1.2, 1.2, 1.0220588235294117, 1.0, 1.040787319803566, 1.0098451109689484, 1.0144284128745837, 1.000293728888236, 1.2326629391638153, 1.1042780748663101, 1.0060239786595793, 1.1244231696397824, 1.037037037037037, 1.1223021582733812, 1.045731707317073, 1.0, 1.035386745111611, 1.1108636052090473, 1.8615384615384616, 1.0098039215686274, 1.2296819787985867, 1.0277536084570034, 1.0833333333333333, 1.0088892100888922, 1.140893470790378, 1.037682920967155, 2.0, 1.4207792207792207, 1.2821768270658587, 1.2114537444933922, 1.3461538461538463, 1.018987341772152, 1.25, 1.1095056343147947, 1.0846824408468243, 1.1090909090909091, 1.0116279069767442, 1.0909090909090908, 1.0222906787580908, 1.2642679900744418, 1.75, 1.0, 1.0594760883751282, 1.0035928143712576, 1.0708430913348945, 1.0373831775700935, 1.0977736114366066, 1.096470588235294, 1.0546875, 1.0, 1.1181628392484342, 2.0, 1.0001434967282745, 1.4375, 1.0615154536390827, 1.1042944785276074, 1.0968553459119497, 1.1050049067713446, 1.04, 1.0727257457021584, 1.0162949238699257, 1.1274509803921569, 1.75, 1.1847940865892292, 1.0432148508037715, 1.0809968847352025, 1.0182328190743337, 1.037914691943128, 1.051948051948052, 1.0, 1.1490196078431372, 1.0, 1.2202743902439024, 1.0514761544284632, 1.0643224699828473, 1.2357840572126286, 1.2142857142857142, 1.0170032649033884, 1.0708786833023627, 1.0875853756528726, 1.1463784603716345, 1.044757817290006, 1.1666666666666667, 2.0, 1.0432242990654206, 1.0609520711342442, 1.0284270372710045, 1.1688311688311688, 1.0602563618277743, 1.0, 1.117943866288237, 1.1081654294803818, 1.0, 1.0167597765363128, 1.1666666666666667, 1.2907268170426065, 1.0228328269197438, 1.1003339287101033, 1.108910891089109, 1.8, 1.2036423841059603, 1.0, 1.037037037037037, 1.0999683062232264, 1.1818181818181819, 1.033203125, 1.0375627249147443, 1.1212786510933521, 1.0640854472630175, 1.0054794520547945, 1.0113016367887764, 1.039972432804962, 1.0749542961608776, 1.037444525067076, 1.173913043478261, 1.0143509458577953, 1.1067286512273187, 2.0, 1.0186873290793073, 1.006904487917146, 1.0862533692722371, 1.123698605964355, 1.5, 1.2628965851295713, 1.0289634146341464, 1.0245901639344261, 1.1074561403508771, 1.0671532846715328, 1.1083951449763991, 1.0529633245014642, 1.1378584987943152, 1.0800821355236139, 1.042763157894737, 1.2653061224489797, 1.3269230769230769, 1.014947683109118, 1.5714285714285714, 1.0685657692657324, 1.0427528993739945, 1.1800271739130435, 1.3317801445416508, 1.1196990424076607, 1.1158198828549468, 1.2778947368421052, 1.1121495327102804, 1.039217584971434, 1.0394337714863497, 1.0385304659498207, 1.1107871720116618, 1.0305867665418227, 1.117499350593125, 1.018542108987969, 1.0, 1.0327868852459017, 1.0239884393063583, 1.0273125996810208, 1.184487291849255, 1.0526315789473684, 1.1084882598503178, 1.3092446665385356, 1.073653225980997, 1.0943396226415094, 1.09, 1.0172645086030914, 1.0, 1.2727272727272727, 1.026915782252532, 1.0138089758342923, 1.0144995322731525, 1.3461538461538463, 1.0617363344051447, 1.057487269868511, 1.055505086349657, 1.0626410835214446, 1.0747338463160114, 1.3163841807909604, 1.015625, 1.2727272727272727, 1.0, 1.4035087719298245, 1.0540135625295695, 1.3310104529616724, 1.4022988505747127, 1.0143351458230352, 1.0031277926720286, 1.0371732679424988, 1.0130125628846856, 1.1870326112096214, 1.0056818181818181, 1.0361271676300579, 1.0093972780298122, 1.0584755011775517, 1.0168412955559958, 1.0, 1.0666666666666667, 1.101136430780139, 1.0120367417827876, 1.161090458488228, 1.0050022261215725, 1.2734421285075672, 1.0357142857142858, 1.005453196905079, 1.1705776173285198, 1.0141003948110547, 1.1497005988023952, 1.2211246200607904, 1.0286266924564798, 1.1653543307086613, 2.0, 1.1729490022172948, 1.10786065207682, 1.1211908110642288, 1.1260504201680672, 1.0, 1.6666666666666667, 1.0924359402754085, 1.1272727272727272, 1.0814917606244578, 1.5, 1.0, 1.0256410256410255, 1.0530835284933646, 1.0714285714285714, 1.0414364640883977, 1.0706751054852321, 1.0229885057471264, 1.007136859781696, 1.1174774007471788, 1.0526315789473684, 2.0, 1.0862480208911645, 1.0397374616537063, 1.1190893169877407, 1.0140758484726433, 1.0882808181315644, 1.0179814675682444, 1.0874403815580287, 1.0890445927151735, 1.0227272727272727, 1.0087560806115359, 1.093166868035978, 1.1818181818181819, 1.0548537107667355, 1.0, 1.2045454545454546, 1.4705882352941178, 1.0114012504597278, 1.0555555555555556, 1.0263157894736843, 1.1081084718390417, 1.0473537604456824, 1.363408521303258, 1.0188499065808594, 1.1468120805369129, 1.0341041054716853, 1.0489847941759245, 1.25, 1.0643506729719898, 1.6666666666666667, 1.0370355769315005, 1.0215982721382288, 1.0271721815119932, 1.0810810810810811, 2.0, 1.391304347826087, 1.0441176470588236, 1.0808114639976882, 1.0, 1.0672782874617737, 1.0542986425339367, 1.0100160256410255, 1.0177994749314623, 1.1886792452830188, 1.1383647798742138, 1.0249351398097435, 1.0802237095443292, 1.0746948598934158, 1.1111111111111112, 1.0, 1.1169451073985681, 1.3224755700325732, 1.1184668989547037, 1.0550547598989048, 1.01209341117598, 1.0441176470588236, 1.2553191489361701, 1.0041322314049588, 1.030029231995748, 1.2857142857142858, 1.0101245774987928, 1.0282485875706215, 1.105263157894737, 1.1329219570928195, 1.380952380952381, 1.4, 1.003229146854329, 2.0, 1.196159122085048, 1.0465116279069768, 1.1279737489745694, 1.1246278179498086, 1.010443864229765, 1.123456790123457, 1.1089165167277697, 1.11315855667259, 1.065312046444122, 1.037288106761021, 1.040689255719664, 2.0, 1.0, 1.043750999794328, 1.25, 1.07035175879397, 1.3529411764705883, 1.0, 1.375, 1.3162650602409638, 1.0559701492537314, 1.1025641025641026, 1.0476190476190477, 1.0, 1.1864181091877497, 1.04256972405777, 2.0, 1.3734365693865396, 1.0, 1.0984134213922416, 1.1265822784810127, 1.004959328260299, 1.1451612903225807, 1.1363636363636365, 1.3280542986425339, 1.3518518518518519, 1.0272466432876874, 1.0236255756751098, 1.0518207282913166, 1.0, 1.0769230769230769, 1.5714285714285714, 1.5, 1.2307692307692308, 1.069224702534033, 1.3333333333333333, 1.026622296173045, 1.063157894736842, 1.177391926966795, 1.0996451210686478, 1.259526261585994, 1.0034832097482642, 1.0121809744779582, 1.0392857142857144, 1.5, 1.2244897959183674, 1.0723404255319149, 1.0489809054725152, 1.0952380952380953, 1.5714285714285714, 1.017817371937639, 1.0023255813953489, 1.0330395392934897, 1.0290037831021437, 1.1464387464387464, 1.0196990424076608, 1.1111111111111112, 1.0907770515613653, 1.0540254237288136, 1.1346153846153846, 1.0240793201133145, 1.0695652173913044, 1.0497278073281442, 1.0449660150512905, 1.0379419049763567, 1.1025641025641026, 1.1808510638297873, 1.108359133126935, 1.0, 1.0780560444023284, 1.05349991904582, 1.0707560834298957, 1.0640084132472996, 1.078589108910891, 1.1493485859548778, 1.8333333333333333, 1.1934369602763386, 1.2, 1.2271562766865927, 1.25, 1.0463051386994089, 1.0014513788098693, 1.1432717110920034, 1.1383399209486167, 1.0977973568281938, 3.0, 1.1433355659745479, 1.01577859446671, 1.0866976273680338, 2.0, 1.0317460317460319, 1.2744721689059502, 1.2841328413284132, 1.106049352149872, 1.0083160083160083, 1.2352941176470589, 1.089732528041415, 1.0044406011171618, 1.080783427799181, 1.1043434313982758, 1.082127192982456, 1.0315091210613598, 1.1478260869565218, 2.142857142857143, 1.0395778364116095, 1.5, 1.2237061769616027, 1.1785714285714286, 1.118536931818182, 2.272727272727273, 1.080405324379422, 1.138600079052742, 1.0616903146206045, 1.0, 1.1176470588235294, 1.24, 1.2858500950665466, 1.275711159737418, 1.0, 1.0212345679012345, 1.1109559634344475, 1.0406133443845835, 1.5, 2.0, 1.0100970873786408, 1.0072202166064983, 1.0459016393442624, 1.2222222222222223, 1.0795759037860646, 1.0773143438453714, 1.4705882352941178, 1.0045783041356087, 1.0454545454545454, 1.1391076115485563, 1.0024193548387097, 1.3651661758519142, 1.0439863366692634, 1.0, 1.0571428571428572, 1.0584915162987791, 1.0347506410487197, 1.0106803669248972, 1.0, 1.0825038708250387, 1.0051942593912013, 1.0214772132006287, 2.0, 1.0494417862838916, 1.0102494589902737, 1.04694242386882, 1.0086496876501683, 1.0123206268157408, 1.0308457711442787, 1.0101867572156198, 1.0441176470588236, 2.0, 1.0334384205902114, 2.0, 1.25, 1.1865284974093264, 1.1346153846153846, 1.0108817057313373, 1.0120378331900257, 1.0634784104593153, 1.1468563561266636, 1.1365140615616576, 1.0106857838495875, 1.0657211877434494, 1.2409638554216869, 4.0, 1.0018821269955587, 1.1562753036437248, 1.0452847612338765, 1.0565120227122318, 1.0925925925925926, 1.0721153846153846, 2.4022988505747125, 2.4285714285714284, 1.0120027267858012, 1.0820919634998274, 1.004595716235412, 1.1148080438756856, 1.0450491708445815, 1.0210526315789474, 1.0641749634459492, 1.005968529571351, 1.2284820031298904, 3.0, 1.0, 1.01840490797546, 1.0560747663551402, 1.1352380952380952, 1.1629013079667063, 1.1137254901960785, 1.3092105263157894, 1.148905109489051, 1.1666666666666667, 1.0476923435714451, 1.1894736842105262, 1.0171501065029445, 2.0, 1.281767955801105, 1.0555555555555556, 1.1557377049180328, 1.0824022346368716, 1.0816568047337278, 1.0079681274900398, 1.0363164721141376, 1.1147081011686542, 1.0, 1.2127659574468086, 1.2, 1.0, 1.0227272727272727, 1.1330645161290323, 1.020472440944882, 1.1213592233009708, 1.0650432553668696, 1.0220417633410672, 1.0173206942217885, 1.1732315345017064, 1.0426687354538402, 1.1090240519530787, 1.1135135135135135, 1.0903225806451613, 1.045960328979197, 1.0330007674597084, 1.2947976878612717, 1.1584375, 1.0513860031419449, 1.1658791523482246, 1.0774251419264225, 2.0, 1.1818181818181819, 1.0744786494538232, 1.4476190476190476, 1.0, 1.2142857142857142, 1.25, 1.0907335907335907, 1.2962962962962963, 1.1666666666666667, 1.0124338432538245, 1.1279491651131557, 1.0287319899635272, 1.0616185897435897, 1.1837837837837837, 1.1243169398907105, 2.0, 1.1159420289855073, 1.0221360592174833, 1.0221133158020559, 1.0844466063269809, 1.090784827429092, 1.0203969933591184, 1.2, 1.1716261616998997, 1.0674955595026643, 1.007011165930927, 1.1109301756433667, 1.3333333333333333, 1.0691489361702127, 1.0, 1.2387640449438202, 1.2104775627830382, 3.0, 1.046288395904437, 1.0363493840985443, 1.4285714285714286, 1.0133975833242068, 1.5, 1.1176470588235294, 1.0457477614924864, 1.6153846153846154, 1.0189744147541182, 1.0461341307133702, 1.3571428571428572, 1.3181818181818181, 1.0701030927835051, 1.017216642754663, 1.0481236203090507, 1.1092695315110606, 1.1561236786308098, 1.0, 1.0655007603736693, 1.1158536585365855, 2.0, 1.0154577604983956, 1.135695129336448, 1.1069063386944182, 1.0189054092775955, 1.0262036722844323, 1.0, 1.8571428571428572, 1.087262200165426, 1.0024252223120453, 1.101878404289617, 1.200160128102482, 1.0024379138834296, 1.021399016425417, 1.3278388278388278, 1.0926829268292684, 1.1672240802675586, 1.0752343408844836, 1.0750788643533122, 1.034676663542643, 1.0577731092436975, 1.051380594263806, 3.0, 1.1404993272537, 1.0345852444517576, 1.023511637534746, 1.5833333333333333, 1.3214831273434244, 1.3415841584158417, 1.1428571428571428, 1.1055582986527475, 1.0420575865415722, 1.101528384279476, 1.0303030303030303, 1.3333333333333333, 1.07245920139525, 1.5, 1.105140186915888, 1.0833333333333333, 1.0154908938664433, 1.44, 1.1772151898734178, 1.029350104821803, 1.0, 1.693121693121693, 1.2370550161812297, 1.25, 2.0, 1.0991735537190082, 1.1689655172413793, 1.0157004830917875, 1.2109275730622617, 1.1169284467713787, 1.1858407079646018, 1.1014466214978942, 1.0571428571428572, 1.079295154185022, 1.0816326530612246, 1.1153846153846154, 1.0, 1.2004830917874396, 1.0894660894660895, 1.0103305785123966, 1.0694736842105264, 1.0647821331808804, 1.0147725365116669, 1.096129902469392, 1.097888953152111, 1.1803977272727273, 1.0219512195121951, 1.375, 1.0, 1.2142857142857142, 1.0010852242543826, 1.0732568402471314, 1.107843137254902, 1.1404494382022472, 1.055364642993509, 1.0809364741949012, 1.0148502445649652, 1.1142857142857143, 1.2222222222222223, 1.0165537998495109, 1.0081521739130435, 1.0606700336153558, 1.0534384093788725, 1.0133333333333334, 1.0848346131128175, 1.0226831561547445, 1.1519174041297935, 1.3472505091649694, 1.125, 1.0889872173058013, 1.2963503649635038, 1.1304347826086956, 1.1433021806853583, 1.0701001430615165, 1.0, 1.0478468899521531, 1.0390522601243488, 1.0555555555555556, 1.0907824453307222, 1.0010604453870626, 1.1944444444444444, 1.0333391757223698, 1.025126171593367, 1.088000268600591, 1.041030534351145, 1.0261066969353008, 1.1982307458554209, 1.1359026369168357, 1.2142857142857142, 1.0, 1.4285714285714286, 1.0712123047111541, 1.3333333333333333, 1.127738336713996, 1.10904097786872, 1.0168956972291057, 1.0512413108242304, 1.0503501100630497, 1.037127612272121, 1.014336917562724, 1.0319001386962552, 1.0080165308662268, 1.1942022872140983, 1.0416531434591783, 1.2284114175599181, 1.6666666666666667, 1.03125, 1.0079681274900398, 1.0906617213768242, 1.019543973941368, 1.2709003215434083, 1.0424354243542435, 2.220779220779221, 1.0209263996300963, 1.0778523489932885, 1.039377990430622, 1.125, 1.0834843385969455, 1.0263733556473982, 1.3234220135628587, 1.0581052631578947, 1.125, 1.1559405940594059, 1.1166666666666667, 1.5625, 1.0614971346704871, 1.5769230769230769, 1.1966224366706877, 1.1403508771929824, 1.0262975778546712, 1.0062690613351406, 1.0083036773428233, 2.75, 1.0980392156862746, 1.0950402588330452, 1.0531085060281127, 1.0111755147273984, 1.0088412525931048, 1.0808259378425202, 1.0833333333333333, 1.0682967959527825, 1.2030552291421857, 1.0071654984597527, 1.035070140280561, 1.0138888888888888, 1.0108205590622181, 1.0039698545801932, 1.347358121330724, 1.0109713721270703, 1.0, 1.3333333333333333, 1.0491680882098444, 1.0036583649922612, 1.2156130357643105, 1.045352608655361, 1.0558659217877095, 1.079136690647482, 1.0909700249381475, 1.0766782501380274, 1.068014705882353, 1.0277777777777777, 1.0142045454545454, 1.1029548912776714, 1.1071428571428572, 1.75, 1.0487503388452155, 1.1734715429982616, 1.0323719835197174, 1.0284090909090908, 1.1868211440984793, 1.0017553269296406, 1.174023053134664, 1.3888888888888888, 1.1538461538461537, 1.0862533692722371, 1.0919540229885059, 1.134375, 1.5925925925925926, 1.0573583640630237, 1.2071357779980179, 1.1683250414593698, 1.048780487804878, 1.0269368375296752, 1.0695351517479832, 1.0651271753681393, 1.2129134482075659, 1.3333333333333333, 1.1666666666666667, 2.0, 1.1462904911180773, 1.3076923076923077, 1.0, 1.1538461538461537, 1.023841059602649, 1.0724637681159421, 1.1380262925883113, 1.0371465380549683, 1.0563636363636364, 1.3076923076923077, 1.1428571428571428, 1.032258064516129, 1.054054054054054, 1.0142857142857142, 1.1145833333333333, 1.025914644441893, 1.032232570220029, 1.3195876288659794, 1.0668978204523227, 1.0475351584004804, 2.5, 1.0665594910006464, 1.2152777777777777, 3.0, 2.0, 1.2100591715976332, 1.1424370651940041, 1.0486044333437403, 1.170807453416149, 1.0, 1.048780487804878, 1.0460122699386503, 3.0, 1.5, 1.016, 1.178921898104584, 1.044983131325753, 1.6666666666666667, 1.0346756496763172, 1.0395042602633617, 1.162097735399285, 1.0, 1.0328638497652582, 1.0235923549347141, 1.027027027027027, 1.1241303551812523, 1.0284905257849926, 1.257396449704142, 1.10546875, 1.050848929610491, 1.1457925636007829, 1.0578512396694215, 1.2777777777777777, 1.0355827516343623, 1.2423643823127184, 1.0325994919559696, 1.0774193548387097, 1.2352941176470589, 1.2835820895522387, 1.0808625336927224, 1.070369201640896, 1.016219012455877, 1.062762981414064, 1.0807860262008733, 1.5, 1.6666666666666667, 1.058045132007927, 1.1785400175901495, 1.2499513713285353, 1.0088916434506203, 1.0438200367954507, 1.109704641350211, 1.450657894736842, 1.0434782608695652, 1.1500668186463328, 1.1302315547245794, 1.2279305354558612, 1.254945054945055, 1.6666666666666667, 1.1363636363636365, 1.0426085293555174, 1.1372282608695652, 1.0266820416726725, 1.0834968853997782, 1.0063920454545454, 2.0, 1.052890528905289, 1.0098558923758825, 1.159241489604752, 1.1254752851711027, 1.0597852000190722, 1.0161812297734627, 1.2682119205298013, 1.0139130434782608, 1.0313145279232396, 1.0542554087044365, 1.054147465437788, 1.0582655826558265, 1.0, 1.1519685039370078, 1.0505759210165464, 1.0120320855614973, 1.0639422692654632, 1.085144927536232, 1.0499243570347958, 1.2857142857142858, 1.2297650130548303, 1.6666666666666667, 2.0, 1.1764705882352942, 1.0077319587628866, 1.0300157977883095, 1.09303080732232, 1.0022924596894915, 1.0222523744911804, 1.1072504053741024, 1.0923913043478262, 1.1395348837209303, 1.0528209768724088, 1.6, 1.5833333333333333, 1.1057173678532901, 1.1428571428571428, 1.124251497005988, 1.1501516683518707, 1.1690851735015773, 1.089626852347795, 2.0, 1.068421052631579, 1.1375968992248062, 1.000499001996008, 1.0407855262071433, 1.1313131313131313, 1.1136986301369862, 1.1277698473701547, 1.1107392577541386, 1.0333863275039745, 1.109375, 1.0782122905027933, 1.0, 1.0, 1.0413924752333608, 5.0, 1.4285714285714286, 1.8620689655172413, 1.0265379975874547, 1.0804597701149425, 1.1014412416851442, 1.105923891722244, 1.1666666666666667, 1.1297330850403475, 1.0105140186915889, 1.1554404145077721, 1.2956730769230769, 1.4285714285714286, 1.0529500756429653, 1.1374722838137472, 1.1495535714285714, 1.074748977314987, 1.0290786440610313, 1.0957971144367775, 1.1638568470866608, 1.0, 1.303845665693616, 1.0512547335416276, 1.0468525824964132, 1.1774193548387097, 1.0792490016078005]
origin-bjaq_15.71 	max: 5.0000	99th: 2.5025	95th: 1.6960	median: 1.0804	mean: 1.1715

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 14.006257 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[5.9604645e-08 1.0132790e-06 4.7683716e-07 1.0728836e-06 1.7881393e-07]
Distance score: 5.602836381513043e-07
SAUCE Drift detection: False
Detection latency: 0.0231s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.047163 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 6.0000	99th: 3.0000	95th: 1.8643	median: 1.0814	mean: 1.1898
ReportEsts: [1.0078947368421052, 1.0150490730643402, 1.0313144469770976, 1.046204620462046, 1.625, 1.0, 1.047992120696602, 1.0823130677284414, 1.1666666666666667, 1.0207197382769901, 1.1108832046332047, 1.0426699829800983, 1.005981703026038, 1.1375968992248062, 1.0594467333725721, 1.1870047543581617, 1.2044728434504792, 1.5, 1.3636363636363635, 1.1199309749784296, 1.0610928961748634, 1.0018938277427343, 1.2300469483568075, 1.0058236272878536, 1.015394653311702, 1.0354648397164437, 2.0, 1.1424496345159565, 1.4, 1.4, 1.053932584269663, 2.0, 1.0463046234593383, 1.0025978351373854, 1.1179223210107627, 1.072763028515241, 1.2243248843152152, 1.134703196347032, 1.588235294117647, 1.0549326105521108, 1.0052870791206752, 1.06851513753185, 1.2830725462304409, 1.077186108637578, 1.0054545454545454, 1.0162101910828025, 1.2727272727272727, 1.0909090909090908, 1.0155642023346303, 1.024623803009576, 1.2857142857142858, 1.3554502369668247, 1.0666666666666667, 1.0857142857142856, 1.0033205527884281, 1.0453810820006806, 1.0070841598186455, 1.0641330166270784, 1.0416666666666667, 1.022064142218751, 1.2727272727272727, 1.1646873474839672, 1.0758725341426403, 1.049056603773585, 1.0594059405940595, 1.0, 1.0101278384215748, 1.367148415786548, 1.4, 1.0, 1.0211841390548615, 1.0467479674796747, 1.0697336561743342, 1.0366088631984585, 1.1109308215925282, 1.3333333333333333, 1.031469576917327, 1.1302083333333333, 1.4951456310679612, 1.0932595573440644, 1.0319961795606494, 1.1267605633802817, 1.0, 1.1, 1.0732807215332583, 1.2698412698412698, 1.0, 2.0, 1.2352941176470589, 1.0911658056027982, 1.1110109659005558, 1.2570585287074678, 1.0381576264274062, 1.0630259958855433, 1.0471204188481675, 1.0298685782556751, 1.0212765957446808, 1.0258397932816536, 1.3170731707317074, 1.3176237623762377, 1.2962962962962963, 2.0, 1.057976460941904, 1.3334765792866352, 1.0684931506849316, 1.2132247929163096, 1.1935483870967742, 1.0146443240809337, 1.06631299734748, 1.2870684714077862, 1.1213282247765006, 1.0429151853732859, 1.2857142857142858, 2.6666666666666665, 1.0568425150866265, 1.0595659236530999, 1.0815360336664914, 1.0769230769230769, 1.060768055285697, 2.0, 1.127178153446034, 1.2102759276879163, 2.0, 1.0700934579439252, 1.1428571428571428, 1.2032854209445585, 1.034241931109303, 1.058402239729149, 1.1260504201680672, 1.8333333333333333, 1.1434426229508197, 1.0, 1.8571428571428572, 1.1211394855720476, 1.1538461538461537, 1.0223356732610083, 1.0179504760191982, 1.0875925335600185, 1.5, 1.5, 1.0635964912280702, 1.0468123049487295, 1.0875386199794026, 1.0149992087573363, 1.2733333333333334, 1.0120680197476686, 1.0817027813712807, 3.0, 1.0097414762083177, 1.0190114068441065, 1.0971983990851915, 1.1042689275621003, 2.0, 1.2281514297221103, 1.0254777070063694, 1.0583190394511148, 1.0205423171733772, 2.0, 1.0287769784172662, 1.126141624712222, 1.0327269900497513, 1.070945945945946, 1.123943661971831, 1.2982456140350878, 1.352, 1.0390720390720392, 1.3333333333333333, 1.075879344536061, 1.0303030303030303, 1.053349875930521, 1.0178802706410337, 1.0614250614250613, 1.0123064216394797, 1.2764811490125674, 1.143141153081511, 1.0814000485005255, 1.041085563513004, 1.00362056480811, 1.0639868744872847, 1.018775720164609, 1.1945411502576242, 1.2188707627668127, 1.1455696202531647, 2.5, 1.0065291744892837, 1.0521039497461493, 1.3176895306859207, 2.6315789473684212, 1.0096385542168675, 1.8571428571428572, 1.2693409742120343, 1.088325504579285, 1.6111111111111112, 1.1585428424833248, 1.0927899686520377, 1.0895658859957191, 1.0786450469375697, 1.1317365269461077, 1.0233300360215756, 1.125994623655914, 1.0399012751953929, 1.043153454034101, 1.0172001911132347, 1.039104301434329, 1.0503055947343676, 1.0825486227228724, 1.3681818181818182, 1.1014492753623188, 1.1951219512195121, 1.0, 1.316546762589928, 1.0250493096646942, 1.2797619047619047, 1.46875, 1.0082203041512536, 1.0740740740740742, 1.03970965292997, 1.0593607305936072, 1.2209916033586565, 1.6, 1.0723039215686274, 1.0013451708366963, 1.051893005100697, 1.0115214722740409, 1.5, 1.7222222222222223, 1.13434581363554, 1.0024426520913696, 1.0051948051948052, 1.0202360876897134, 1.0675675675675675, 1.1329531709002938, 1.4102564102564104, 1.0067035125468191, 1.0236494115395656, 1.0757575757575757, 1.017605633802817, 1.0476190476190477, 1.6666666666666667, 1.1486129458388374, 1.0, 1.1796351881782499, 1.0720950745090758, 1.1847847454295262, 1.0512820512820513, 1.1428571428571428, 1.6666666666666667, 1.1083570861861245, 1.0138888888888888, 1.1157476551765337, 1.4, 1.1666666666666667, 1.0219123505976095, 1.2857142857142858, 1.0306752335527611, 1.034965034965035, 1.06974716652136, 1.0352697095435686, 1.0, 1.0773642208652385, 1.0317460317460319, 2.0, 1.1013856119428596, 1.0731960652532535, 1.1198224852071006, 1.0103186223244789, 1.1194192205826712, 1.0043852481342268, 1.0846001321877066, 1.0833908054410188, 1.0330827067669173, 1.0578915295551492, 1.2353386303443057, 1.2, 1.0126464175244663, 1.0412757973733584, 1.2075471698113207, 1.5, 1.1405709342560553, 1.1353092783505154, 1.001598295151838, 1.0222159828729864, 1.0454545454545454, 1.3547717842323652, 1.036329582372997, 1.033637000700771, 1.0631423415884307, 1.0383615860713695, 1.3, 1.0621848739495798, 1.040590405904059, 1.120135790207095, 1.019648432197638, 1.0937067638023623, 1.2516935904116728, 1.1938202247191012, 1.0832977663963579, 1.0526261867358786, 1.1133824964754364, 1.0483584555027876, 1.0671785028790788, 1.0, 1.0666666666666667, 1.0680698611733095, 1.6, 1.0235934664246824, 1.1108870967741935, 1.0844804870292126, 1.394736842105263, 1.0991735537190082, 1.0, 1.1226759339704604, 1.025796945043998, 1.2380952380952381, 1.1640888475404116, 1.0133107285400997, 1.2009456264775413, 2.0, 2.2, 1.0434298440979954, 1.25, 1.0091164501134735, 1.036050156739812, 1.0952380952380953, 1.123087812228869, 1.1923076923076923, 1.3333333333333333, 1.020256918736329, 2.0, 1.030451866404715, 1.0592592592592593, 1.0451491249037261, 1.0359829898593391, 1.1103117505995204, 1.3370786516853932, 1.115219648742607, 1.0800971694985215, 1.1161436428340343, 1.022204033662826, 1.0592565329407435, 3.0, 1.3, 1.0451414361798417, 1.5, 1.06, 1.2727272727272727, 1.3333333333333333, 1.5263157894736843, 1.3325, 1.0569867291178767, 1.2063492063492063, 1.0702479338842976, 1.3376623376623376, 1.5, 1.0373848334514528, 2.0, 1.15625, 1.0221433078492084, 1.078125, 1.067022086824067, 1.0133333333333334, 1.4, 1.25, 1.29874213836478, 1.1304347826086956, 1.3817934782608696, 1.128602816102816, 1.2461269365317342, 1.0428211586901763, 1.5, 1.0243916634171608, 1.1158536585365855, 1.4814814814814814, 3.0, 1.0, 1.1428571428571428, 1.047034764826176, 1.180952380952381, 1.3134125353911064, 1.0970573051109964, 1.0310834813499112, 1.0916918014806691, 1.117186445254489, 1.0560897435897436, 1.1205357142857142, 1.0965448115437715, 1.083743842364532, 1.027027027027027, 1.0013411852488512, 1.0690932578506431, 1.0513248189096454, 1.0348258706467661, 1.0232558139534884, 1.1935483870967742, 2.0, 1.0416666666666667, 1.6404494382022472, 1.1209829867674859, 1.2774193548387096, 1.0923076923076922, 1.0898692810457515, 1.1725021349274125, 1.0388073658466408, 1.1136103698055662, 1.0381248234961875, 1.0192307692307692, 1.423913043478261, 1.1314432989690721, 1.0, 1.0872926798852725, 1.5, 1.1074508028150412, 1.0772912590329042, 1.0553112313937754, 1.1649374833732375, 1.75, 1.1796837565884044, 1.1666666666666667, 1.0871773169699535, 1.0, 1.0289701664155282, 1.006075334143378, 1.0932423943282779, 1.1274509803921569, 1.059151009046625, 3.0, 1.287964713295526, 1.0058562771971207, 1.1244696984239726, 2.0, 1.013157894736842, 1.2312, 1.2344213649851632, 1.0743480735111974, 1.1196065542983238, 1.0, 1.1315605318404478, 1.0545697268432943, 1.0263027691325513, 1.0030435800528446, 1.035626839462815, 1.0378486055776892, 1.087719298245614, 1.016245487364621, 1.0830218177809403, 1.1061946902654867, 1.0933767643865364, 1.0, 1.5, 1.1590470057952351, 1.0, 1.0416225749559083, 1.1145014065101326, 1.0581874356333676, 1.0, 1.18348623853211, 1.0303030303030303, 1.0043289527035084, 1.2173913043478262, 1.0, 1.0215180679135645, 1.0, 1.0, 1.0098709187547457, 2.0, 1.0016144656118824, 1.003787878787879, 1.0381471389645776, 1.0909090909090908, 1.0734365315940146, 1.124780316344464, 1.45, 1.0113689896674098, 1.0866141732283465, 1.1366666666666667, 1.0617529880478087, 1.2891651865008882, 1.0447746310331072, 1.0, 1.0119047619047619, 1.0269764694299497, 1.1556628167557317, 1.0637450199203187, 1.5, 1.086755456899741, 1.0210348857257803, 1.0195993031358885, 2.0, 1.0475552578700602, 1.0205229294455507, 1.02401851060084, 1.0117677343433973, 1.007437684756031, 1.1013250952047875, 1.0294328786791098, 1.0061168604857926, 2.3333333333333335, 1.0462110405049063, 1.0155013725173583, 1.071219512195122, 1.1192307692307693, 1.0287958115183247, 1.0055348630355927, 1.0526315789473684, 1.0773523385868828, 1.004201680672269, 1.1146218312425173, 1.0911458333333333, 1.1218553655911288, 1.0267803258901629, 1.125, 1.3150684931506849, 1.1518052897715032, 1.0584415584415585, 1.0186387654775362, 1.0593787685543143, 1.0, 1.0198700802445548, 1.2732732732732732, 1.5, 1.25, 1.0225360371097978, 1.1407942238267148, 1.0641758241758241, 1.0, 1.0869565217391304, 1.0059198542805101, 1.1917574641499138, 1.0320786204338959, 1.005041930339044, 1.1230221518987342, 1.0355871886120998, 1.0236382322713258, 1.0881268084835767, 1.541899441340782, 1.0347146280741757, 1.0753768844221105, 1.0445544554455446, 1.0869196343351646, 1.0943025540275049, 1.0732164162828588, 2.0, 1.086139896373057, 1.1135531135531136, 1.1315372424722663, 1.0979955456570156, 1.083493282149712, 1.0388513513513513, 1.0397727272727273, 1.059586117200365, 1.0, 1.368421052631579, 1.0, 1.0, 1.128440366972477, 1.0, 1.0064683053040104, 1.0553359683794465, 1.0671931468344265, 1.0676246830092984, 1.0764303816911143, 1.2049306625577811, 1.05328634946045, 1.2045480581968153, 1.013700400672095, 1.113938053097345, 1.0127653945366757, 1.0514101389429291, 1.0544578313253012, 1.075055187637969, 1.2034120734908136, 1.5210084033613445, 1.0253251474270944, 1.1334106728538282, 1.1006611049897685, 1.2849162011173185, 1.1924736337488016, 1.0611068408916218, 1.3333333333333333, 1.0143027413587604, 1.2666666666666666, 2.0, 1.346938775510204, 1.0515913899003562, 1.040377358490566, 1.0546875, 1.0874316939890711, 1.0374681243214583, 1.0115481563983821, 1.1626617375231054, 1.2, 2.0, 1.1353547604608853, 1.1255813953488372, 1.103546677537709, 1.059208986660426, 3.0, 1.3687221869040052, 1.163716814159292, 1.092173559046036, 1.092511013215859, 1.00421870041627, 1.1138253731611374, 1.0097322901336065, 1.4318181818181819, 2.0, 1.1578697350364193, 1.0, 1.0451306413301662, 1.1652542372881356, 1.3654114365411436, 1.139554794520548, 1.75, 1.0226619313377305, 1.2058823529411764, 1.5737704918032787, 1.1233867700677123, 1.2429784454604833, 1.006318207926479, 1.064564414729069, 1.0026978417266188, 1.0576388888888888, 1.2, 1.1093390584266216, 1.114683507966126, 1.2777777777777777, 1.014354066985646, 1.1895367952809206, 1.0034832172260926, 1.0024300787743008, 1.3333333333333333, 1.113879003558719, 1.035139240506329, 1.1666666666666667, 1.1294117647058823, 1.057720708531204, 1.062015503875969, 1.7777777777777777, 1.075516423975618, 1.0561497326203209, 1.1029658010500922, 1.189198144466534, 1.017532071740873, 1.015895048717918, 1.069243156199678, 1.089161418627776, 1.2176308539944904, 1.0685856379316323, 1.1029723991507432, 1.0767477203647415, 1.1404199475065617, 1.1704761904761904, 1.2142857142857142, 1.0308873999019448, 1.1, 1.3333333333333333, 1.0795593635250917, 1.6002314145212613, 1.0401379742866101, 2.3333333333333335, 1.0769230769230769, 1.0112449799196788, 1.0467730239303843, 1.0059171597633136, 1.0800151140423193, 2.6666666666666665, 1.22784139100933, 2.5, 1.128352490421456, 1.0714285714285714, 1.1090215714244127, 1.3, 1.2288732394366197, 1.0399305555555556, 1.0, 1.2216642428649336, 1.3904619970193741, 1.5, 4.0, 1.2, 1.1900584795321638, 1.0594111461619349, 1.1875, 1.1019830028328612, 1.2857142857142858, 1.1020942408376964, 1.0083333333333333, 1.1411764705882352, 1.0924092409240924, 1.103448275862069, 1.5, 1.1508325171400589, 1.14, 1.0292035398230088, 1.007486446949488, 1.0670680793905165, 1.0880394943526068, 1.084778765438204, 1.0773108736340036, 1.1914387633769323, 1.0395421436004162, 1.5, 1.0, 1.125, 1.0386115049625277, 1.0397003745318352, 1.0824468085106382, 1.0611353711790392, 1.007488, 1.058326159506598, 1.0067133489509272, 1.0602409638554218, 1.1428571428571428, 1.1551204819277108, 1.0294393813863574, 1.0955941964160913, 1.0039507422773444, 1.063953488372093, 1.0435291941550033, 1.1474873137993125, 1.0246786545663102, 1.0813782991202345, 1.0665428150377825, 1.0061538461538462, 1.06629392971246, 1.088235294117647, 1.0337189761758871, 1.1343283582089552, 1.0143660212367271, 1.0, 1.0866807610993658, 1.029686763033044, 1.0793650793650793, 1.0946118284712258, 1.0317892824704813, 1.3333333333333333, 1.035262036108325, 1.0399208182118114, 1.1354974115013292, 1.0320256204963971, 1.0251162790697674, 1.1988791573967164, 1.1557093425605536, 1.4, 2.0, 1.625, 1.0771671685833821, 1.6666666666666667, 1.0820557670542237, 1.079084451460142, 1.0081240768094535, 1.0431359685091028, 1.0598763596664462, 1.0745213812846663, 1.0666666666666667, 1.025374855824683, 1.013627674421332, 1.1440359796636683, 1.0404923941647717, 1.2081103489862064, 1.25, 1.14535666218035, 1.0664335664335665, 1.0649298017079172, 1.0268096514745308, 1.3341926411999063, 1.0458715596330275, 2.288808664259928, 1.0681840351162413, 1.0547486033519553, 1.0670847832806534, 1.2941176470588236, 1.0437564398214023, 1.0288511314238709, 1.2719665271966527, 1.0534591194968554, 1.1842105263157894, 1.0963855421686748, 1.1425438596491229, 1.0747645017352503, 1.1626506024096386, 1.019437974100663, 1.1794871794871795, 1.030177729416032, 1.1018867924528302, 1.020356234096692, 1.0354609929078014, 1.0210237659963437, 1.0663366336633664, 1.059753086419753, 1.019211211658338, 1.0741097208854669, 1.0137348955466436, 1.0987308278769397, 1.2307692307692308, 1.1054545454545455, 1.020421716752449, 1.0779613025011798, 1.0580700256191289, 1.1125943122460824, 1.152820512820513, 1.048780487804878, 1.0050377833753148, 1.0288019354580717, 1.2333333333333334, 1.1193853427895981, 1.2474385453367351, 1.0608298935476863, 1.1448763250883391, 1.0598961864726002, 1.1367357360610328, 1.0078895463510849, 1.1973969631236443, 1.0857698525369068, 1.0695102260495155, 1.1971608832807572, 1.116504854368932, 1.0254890337877889, 1.0870397086057482, 1.121212121212121, 2.0, 1.046191145720672, 1.1738034581820154, 1.0263029712615683, 1.0095238095238095, 1.2165390505359877, 1.0284065214804237, 1.181156015037594, 1.0345664038811402, 1.3448275862068966, 1.0953461975028378, 1.2666666666666666, 1.1805929919137466, 1.5483870967741935, 1.031932131416226, 1.2411167512690355, 1.143646408839779, 1.127659574468085, 1.1962962962962962, 1.2006764374295378, 1.0792079207920793, 1.027027027027027, 1.0379825653798256, 1.015748031496063, 1.0995934959349594, 1.0769230769230769, 1.0116910013461737, 1.052, 1.0871640291384075, 1.2586206896551724, 2.0, 1.2634330525704327, 1.0185671821823978, 1.0339329573676916, 1.0784313725490196, 1.2380952380952381, 1.1764705882352942, 1.1714285714285715, 1.0212765957446808, 1.011764705882353, 1.1493743482794578, 1.0217927353795573, 1.0355720109157551, 1.4086956521739131, 1.074544116724371, 1.0467769442788102, 2.5, 1.027609935268844, 1.0843706777316735, 2.0, 3.25, 1.2304832713754648, 1.1014501438159157, 1.071708313822315, 1.189119170984456, 1.5, 1.097902097902098, 1.185378590078329, 1.0470588235294118, 1.0774740031678258, 1.0868667685066677, 1.0116087918997159, 1.0448034464189553, 1.7142857142857142, 1.0169939915702628, 1.0410783055198973, 1.0188034188034187, 1.0609756097560976, 1.0023255813953489, 1.0, 3.0, 1.1661314944464916, 1.0193352302121055, 1.0342105263157895, 1.0380952380952382, 1.0957905996350594, 1.042760690172543, 1.1, 1.1408450704225352, 1.0493607590174363, 1.2955567310235387, 1.0364634123023384, 1.3869346733668342, 1.0769230769230769, 1.0164102564102564, 1.0, 1.0915254237288134, 1.0302267002518892, 1.0015188110302724, 1.0683682771194165, 2.0, 1.1167002012072436, 1.0143074703430586, 1.2179487179487178, 1.0747890979883192, 1.053235647129426, 1.0315114333519242, 1.1134596352325745, 1.0266666666666666, 1.1111111111111112, 1.0347068763811258, 1.068246104263453, 1.1679212507237986, 1.0595419847328245, 2.3333333333333335, 1.0116279069767442, 1.062328467443618, 1.0688575899843507, 1.0130354553842098, 1.0874083696761623, 1.0122448979591836, 1.8, 1.053941908713693, 1.0014916852359994, 1.1767860563110515, 1.4077669902912622, 1.0956015813421518, 1.0961538461538463, 1.2537313432835822, 1.0077556955889482, 1.0324018225080347, 1.0942904965594198, 1.034046692607004, 1.0549828178694158, 1.0526315789473684, 1.1899119837508463, 1.0042691810626485, 1.0604502243704648, 1.018348623853211, 1.0819919517102616, 1.020935960591133, 1.434782608695652, 1.2704545454545455, 3.0, 2.5, 1.2777777777777777, 1.0195227765726682, 1.0019354838709678, 1.0708648416603375, 1.0139717570910232, 1.016029310739638, 1.0251219953009219, 1.1288888888888888, 1.070097244732577, 1.0359715598209323, 1.6666666666666667, 2.0, 1.2498288843258043, 1.0, 1.0224215246636772, 1.1257681278164686, 1.0580367805111057, 1.1103484223851396, 3.0, 1.0240807871569135, 1.0314685314685315, 1.184118341392834, 1.0395912129894938, 1.2091782283884738, 1.114866800343741, 1.1430848500574564, 1.1634379405775155, 1.027063599458728, 1.04, 1.1254396248534584, 1.0, 2.0, 1.041275503934281, 6.0, 1.3333333333333333, 1.7941176470588236, 1.048936170212766, 1.07648760076303, 1.2365887207702888, 1.0275590551181102, 1.1428571428571428, 1.3166953528399312, 1.0145631067961165, 1.3333333333333333, 1.329243353783231]
origin-bjaq_15.71 	max: 6.0000	99th: 3.0000	95th: 1.8643	median: 1.0814	mean: 1.1898

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.135540 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.216176