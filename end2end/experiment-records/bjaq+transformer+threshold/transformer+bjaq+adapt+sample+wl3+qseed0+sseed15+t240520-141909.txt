Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 15, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.7800	95th: 1.7517	median: 1.0772	mean: 1.1746
ReportEsts: [1.0128617363344052, 1.0205729166666666, 1.052276376893364, 1.0612244897959184, 1.5789473684210527, 1.0, 1.099248714907078, 1.0568966983940944, 1.0, 1.0304232804232805, 1.1576486884252446, 1.042971867630415, 1.0710751237067027, 1.1418604651162791, 1.0466266336983399, 1.0, 1.0, 1.034714842366277, 3.0, 2.0, 1.125, 1.0325094633711869, 1.0732416643281717, 1.1086318261890782, 1.0365071534287125, 1.0, 1.1668427379694728, 1.5, 1.2, 1.0575539568345325, 1.0, 1.0457063528205037, 1.0040567639387825, 1.0144284128745837, 1.0434718754589514, 1.225402356064377, 1.2085561497326203, 1.0122304315553, 1.1198429643914871, 1.0714285714285714, 1.1487481590574373, 1.0396341463414633, 1.0, 1.0423005458134944, 1.16141168040129, 1.8615384615384616, 1.0618556701030928, 1.197879858657244, 1.0296605001016468, 1.1388888888888888, 1.0730793092751525, 1.1443298969072164, 1.037645152208099, 2.0, 1.4103896103896103, 1.2377188904385557, 1.3145315487571703, 1.3592233009708738, 1.0522875816993464, 1.25, 1.0622046528535078, 1.0952677459526774, 1.1590909090909092, 1.0, 1.0909090909090908, 1.0217714859298743, 1.2894653590635874, 1.75, 1.0, 1.0577980796121935, 1.0071599045346062, 1.062754212667054, 1.018348623853211, 1.0975164011246485, 1.0705882352941176, 1.0909090909090908, 1.0, 1.1123173277661795, 2.0, 1.002892211174583, 1.0666666666666667, 1.0371127995324372, 1.2208588957055215, 1.0941028858218318, 1.1246319921491659, 1.0, 1.0710374054221414, 1.0129250905691247, 1.1176470588235294, 1.75, 1.154320987654321, 1.0666603925628342, 1.074766355140187, 1.035063113604488, 1.0349716446124764, 1.018181818181818, 1.0384615384615385, 1.154679802955665, 1.0, 1.2414977290351168, 1.0289416846652268, 1.0711835334476845, 1.2383220450076469, 1.2592592592592593, 1.015454085528528, 1.1048579771701619, 1.2920555791260075, 1.1228668941979523, 1.0499693439607602, 1.1666666666666667, 2.0, 1.0766355140186916, 1.06874573308938, 1.0416929879974732, 1.1948051948051948, 1.0614659296469744, 1.0, 1.0712708924629455, 1.1888509670079637, 1.0, 1.0167597765363128, 1.0, 1.205513784461153, 1.033158004577177, 1.1447542129377961, 1.0980392156862746, 1.8, 1.1324503311258278, 1.0, 1.0769230769230769, 1.0928525421476112, 1.3, 1.1064453125, 1.0318224924164872, 1.0343067762971363, 1.002677376171352, 1.0766961651917404, 1.0467653936087296, 1.039972432804962, 1.0725167580743449, 1.0264886840809102, 1.0945945945945945, 1.037212449255751, 1.090080442005087, 2.0, 1.0182315405651778, 1.0114285714285713, 1.0973451327433628, 1.0765837303688017, 1.5, 1.1632356502785177, 1.021180030257186, 1.0309278350515463, 1.1074561403508771, 1.0773722627737226, 1.031018206338503, 1.0874161122152135, 1.194163256515184, 1.052, 1.1019736842105263, 1.3061224489795917, 1.3529411764705883, 1.0058910162002945, 1.1428571428571428, 1.0588742864728529, 1.0470457266162914, 1.211297071129707, 1.353401623502126, 1.1289655172413793, 1.0682462696456494, 1.2336842105263157, 1.1414868105515588, 1.0855040185920404, 1.064711830131446, 1.0655737704918034, 1.120505344995141, 1.0396725440806045, 1.0646757960732551, 1.0200833529920579, 1.0, 1.135135135135135, 1.0192750287686996, 1.0279106858054226, 1.2560408921933086, 1.0, 1.0903497089868797, 1.3226984432058428, 1.095946150682856, 1.1372549019607843, 1.239090909090909, 1.067485188268129, 1.0, 1.5454545454545454, 1.027400024212098, 1.0304093567251462, 1.0027662517289073, 1.5217391304347827, 1.0482315112540193, 1.0569117805741532, 1.0389971496171544, 1.0626410835214446, 1.0803204384947824, 1.3728813559322033, 1.0158730158730158, 1.2352941176470589, 1.0, 1.3445378151260505, 1.197681753666614, 1.2334494773519165, 1.2988505747126438, 1.0103806228373702, 1.0031277926720286, 1.043011329116186, 1.0548496282321607, 1.0759608665269043, 1.0170454545454546, 1.043740573152338, 1.016134343101745, 1.0332873800907576, 1.0255427691511996, 1.0, 1.0910973084886129, 1.1913221594154373, 1.0118819482927826, 1.15679012345679, 1.0096680043779642, 1.2786069651741294, 1.0357142857142858, 1.0057555412541346, 1.0305569881382155, 1.0101522842639594, 1.0971428571428572, 1.0770777479892761, 1.0193423597678917, 1.0811023622047244, 2.0, 1.2291606157420853, 1.0439928539526575, 1.147444913267698, 1.1404255319148937, 1.0, 1.6666666666666667, 1.0070874588909797, 1.0909090909090908, 1.0947080099729607, 1.5, 1.0, 1.0256410256410255, 1.059328649492584, 1.0425531914893618, 1.0248618784530388, 1.110759493670886, 1.0815972222222223, 1.0075566750629723, 1.0535994270339328, 1.0175438596491229, 2.0, 1.0507885592087678, 1.026699542092286, 1.0893169877408055, 1.045388986013986, 1.1412753623188405, 1.0058059437118678, 1.0937996820349762, 1.0896255479464112, 1.027511961722488, 1.0687759952465834, 1.0434729215276926, 1.0, 1.00771189698251, 1.0634920634920635, 1.1818181818181819, 1.1904761904761905, 1.0488176964149505, 1.0, 1.054054054054054, 1.132952022071193, 1.068452380952381, 1.3283208020050126, 1.0081225900733028, 1.076784101174345, 1.023366412936198, 1.0483779453975035, 1.25, 1.0015484106020585, 1.6666666666666667, 1.032024494730479, 1.0151187904967602, 1.0478266806244596, 1.0810810810810811, 2.5, 1.3043478260869565, 1.0, 1.0661773280296454, 1.0, 1.001531393568147, 1.0248868778280542, 1.002003205128205, 1.0179766274801356, 1.0988372093023255, 1.1132075471698113, 1.007625204800071, 1.2149731885054311, 1.0942108257121603, 1.1794871794871795, 1.0, 1.1229116945107398, 1.2530864197530864, 1.1184668989547037, 1.0864785172704297, 1.0713094245204338, 1.087323943661972, 1.4047619047619047, 1.010973936899863, 1.0264830508474576, 1.2857142857142858, 1.0027263838027494, 1.030188679245283, 1.0526315789473684, 1.1054482267950962, 1.2857142857142858, 1.4, 1.027126524229168, 2.0, 1.1454046639231825, 1.0334302325581395, 1.1082854799015587, 1.073487616727568, 1.1536144578313252, 1.0705882352941176, 1.1260839567634844, 1.082674066681272, 1.0396600566572238, 1.0488226491683723, 1.0735678542086788, 2.0, 1.0, 1.049624077332663, 1.25, 1.0697544642857142, 1.3529411764705883, 1.0, 1.375, 1.2971887550200802, 1.0649106302916276, 1.2647058823529411, 1.0173160173160174, 1.0, 1.1498002663115845, 1.0658971985319703, 2.0, 1.0565812983918998, 1.0, 1.0950580733318152, 1.0112359550561798, 1.0173445289950145, 1.1428571428571428, 1.1363636363636365, 1.338654503990878, 1.1574074074074074, 1.033007362154227, 1.0254166202481045, 1.0836940836940836, 1.0, 1.1666666666666667, 1.5714285714285714, 3.0, 1.0666666666666667, 1.0693640429092706, 1.3333333333333333, 1.1114808652246255, 1.2784810126582278, 1.2197873524139209, 1.0733823362717658, 1.2481977342945416, 1.0108373913873772, 1.0145011600928073, 1.0476190476190477, 1.5, 1.1483253588516746, 1.0212765957446808, 1.044635757290534, 1.0476190476190477, 1.5714285714285714, 1.0311804008908685, 1.0099823840281856, 1.0325428107132955, 1.0061652281134401, 1.1464387464387464, 1.011217510259918, 1.0126582278481013, 1.0907770515613653, 1.0868644067796611, 1.1346153846153846, 1.0254957507082152, 1.0982142857142858, 1.0658209404348997, 1.0725387087350278, 1.021852938167184, 1.2285714285714286, 1.247191011235955, 1.098159509202454, 1.0, 1.0244285218107207, 1.0513720949021086, 1.0595275063898908, 1.0584827635378418, 1.0595744680851065, 1.1452176676199555, 1.8333333333333333, 1.0443324937027707, 1.2, 1.246797608881298, 1.25, 1.0499517993942125, 1.0222222222222221, 1.1086629406706794, 1.1225296442687747, 1.1633986928104576, 3.0, 1.1588594704684319, 1.0120653882040958, 1.1207467353319847, 2.0, 1.3015873015873016, 1.2370441458733206, 1.3384615384615384, 1.1238103224183473, 1.155925155925156, 1.1666666666666667, 1.012079378774806, 1.0050266600897282, 1.0429383369666771, 1.0986096608268554, 1.042982456140351, 1.2238805970149254, 1.0340909090909092, 2.142857142857143, 1.0423280423280423, 1.4444444444444444, 1.2278056951423786, 1.0303030303030303, 1.1025365785359251, 2.7777777777777777, 1.0966465826790823, 1.1084569248483391, 1.0475015422578655, 1.0, 1.1515151515151516, 1.16, 1.2861074967470725, 1.4835886214442013, 1.0, 1.0043013736644928, 1.09496646237548, 1.0708661417322836, 1.5, 2.0, 1.0093203883495145, 1.011786038077969, 1.0295081967213116, 1.1111111111111112, 1.0638827967365558, 1.1077405857740585, 1.4705882352941178, 1.0086252354048963, 1.0454545454545454, 1.0866141732283465, 1.060483870967742, 1.321834244846445, 1.1193857225470667, 1.0, 1.0571428571428572, 1.0967178896606327, 1.0204187903365787, 1.0119688178665198, 1.0, 1.0829462508294625, 1.0137047020852554, 1.0220010476689365, 2.0, 1.0526315789473684, 1.0394675671046514, 1.0028557128978126, 1.0508059936219476, 1.0108700429878772, 1.0512200900260602, 1.0042194092827004, 1.1511571841851496, 2.0, 1.1398005064861234, 2.1142857142857143, 1.25, 1.2279792746113989, 1.1346153846153846, 1.0017670789850965, 1.1653465346534653, 1.055173270638607, 1.0266177145479578, 1.0588172273409042, 1.0376031381036115, 1.0714021521781847, 1.10752688172043, 4.0, 1.0122434281598847, 1.1222672064777328, 1.0424338668067747, 1.0338333605087233, 1.119228817858955, 1.1197991391678623, 2.223404255319149, 2.5714285714285716, 1.0037493304767007, 1.0662819070114649, 1.010185505027401, 1.1103423160961399, 1.045410721172387, 1.0753880266075388, 1.0646205057167077, 1.051779935275081, 1.2284820031298904, 3.0, 1.0833333333333333, 1.0848585690515806, 1.0865384615384615, 1.1161048689138577, 1.24962852897474, 1.0, 1.3724137931034484, 1.148905109489051, 1.1097560975609757, 1.0692244528804846, 1.202127659574468, 1.0418718816678163, 2.0, 1.1091633466135458, 1.0543933054393306, 1.2702702702702702, 1.114804469273743, 1.0803782505910164, 1.0079681274900398, 1.1374837872892347, 1.1197766402978129, 1.0, 1.3404255319148937, 1.5, 1.5, 1.1022727272727273, 1.032258064516129, 1.0030959752321982, 1.0533980582524272, 1.0615187439923102, 1.0870069605568446, 1.124265824491132, 1.1812940422805893, 1.0434782608695652, 1.1091313791694446, 1.027027027027027, 1.084028223220013, 1.050798258345428, 1.0612352168199737, 1.033236994219653, 1.1145520144317498, 1.0465210560989207, 1.2676604522632624, 1.0806826631416195, 2.0, 1.0614250614250613, 1.0776892430278884, 1.4205607476635513, 1.0, 1.0625, 1.1538461538461537, 1.1008849557522125, 1.3703703703703705, 1.1666666666666667, 1.0059724473257698, 1.1071105339786724, 1.0198336739181044, 1.0491764333227749, 1.1675675675675676, 1.1383125864453665, 1.0, 1.1666666666666667, 1.0286916339057866, 1.052421175658087, 1.084456026058632, 1.0912404601890875, 1.0442494398805078, 1.0805194805194804, 1.0866618105297237, 1.1456483126110124, 1.0334215305962284, 1.1315348557013498, 1.303030303030303, 1.043613707165109, 1.0, 1.2422535211267605, 1.2087110234116463, 3.0, 1.08302053433429, 1.0712086487487558, 1.4285714285714286, 1.0573626875904625, 1.1, 1.1176470588235294, 1.045105324708007, 1.6153846153846154, 1.0328366145776682, 1.0260572404955148, 1.3571428571428572, 1.2608695652173914, 1.0742268041237113, 1.0028776978417266, 1.0033222591362125, 1.0567263003756286, 1.155277798948251, 1.0, 1.0755485552900284, 1.1189024390243902, 2.0, 1.0101252392923865, 1.041638550047582, 1.1598864711447492, 1.0227418892674074, 1.0403771421290693, 1.0970873786407767, 1.8571428571428572, 1.0863636363636364, 1.0088709677419354, 1.0922742775694432, 1.2054684358665058, 1.0048931179362455, 1.049429498878502, 1.3186813186813187, 1.0962479608482871, 1.1638795986622072, 1.0539746574177773, 1.0473186119873816, 1.0385700846660395, 1.0677521008403361, 1.048539495211309, 3.0, 1.1302093364346137, 1.0254470631504657, 1.044744337670748, 1.5833333333333333, 1.3150951256769894, 1.278301886792453, 1.1428571428571428, 1.0575580165056078, 1.0420575865415722, 1.1353711790393013, 1.0588235294117647, 1.3333333333333333, 1.0780523737615557, 1.5, 1.1308411214953271, 1.0833333333333333, 1.04999651105994, 1.3846153846153846, 1.109704641350211, 1.0723270440251573, 1.0, 1.6111111111111112, 1.2010997643362136, 1.25, 2.0, 1.1367521367521367, 1.1896551724137931, 1.0635472652545053, 1.1987421383647798, 1.124780316344464, 1.247787610619469, 1.1014466214978942, 1.0623376623376624, 1.1342592592592593, 1.2938775510204081, 1.04, 1.0, 1.1032186459489457, 1.0923520923520924, 1.0423553719008265, 1.0471953998047088, 1.0595411822903784, 1.059875515034628, 1.0655811816322296, 1.1481347599768652, 1.1837606837606838, 1.0023866348448687, 1.8333333333333333, 1.0, 1.2142857142857142, 1.0458298550504668, 1.0803177405119153, 1.107843137254902, 1.1059113300492611, 1.0168003054600994, 1.108047612694742, 1.002932685419188, 1.0833333333333333, 1.2222222222222223, 1.0352490421455938, 1.0103120396410874, 1.065028454025144, 1.0250508061238315, 1.034013605442177, 1.0177938570584761, 1.0086630472695288, 1.1015514809590974, 1.3406313645621182, 1.125, 1.0726392251815982, 1.783132530120482, 1.1555555555555554, 1.098092643051771, 1.0701001430615165, 1.0, 1.100502512562814, 1.0349999163081867, 1.0740740740740742, 1.0749090503825058, 1.0127118644067796, 1.1944444444444444, 1.0261322525703345, 1.032083633741889, 1.106835885038947, 1.0381679389312977, 1.0080091533180777, 1.1980284923367768, 1.1991434689507494, 1.2857142857142858, 1.0, 1.4285714285714286, 1.061620443260264, 1.3333333333333333, 1.1597913950456322, 1.0915944214097248, 1.0407620735489589, 1.0667328699106255, 1.0529721309674778, 1.0864951768488746, 1.0465949820788532, 1.0360610263522885, 1.0330382511094935, 1.1494656917885264, 1.0436907775587596, 1.2249488136818019, 1.4285714285714286, 1.0158730158730158, 1.0118577075098814, 1.0920829144857707, 1.0456026058631922, 1.268860353130016, 1.050185873605948, 2.211206896551724, 1.0266226705163297, 1.0550335570469798, 1.0470574162679427, 1.125, 1.0448485632927775, 1.0468408830970783, 1.3632455668995165, 1.0581052631578947, 1.28, 1.0747986191024166, 1.1166666666666667, 1.6875, 1.050249831673695, 1.6153846153846154, 1.0442105263157895, 1.0963855421686748, 1.0721510451786918, 1.0181724669981143, 1.0059171597633136, 2.75, 1.108910891089109, 1.1014375528512077, 1.0556197566531473, 1.014313375129966, 1.0017788657690738, 1.0611380618062847, 1.0, 1.0647058823529412, 1.0094655886412935, 1.0503387962767579, 1.0080160320641283, 1.0, 1.1339044183949505, 1.008648397191914, 1.4373695198329854, 1.0643651692696243, 1.0, 1.3333333333333333, 1.0332913051002497, 1.0182918249613058, 1.2364534359120483, 1.133277731442869, 1.0271348762968875, 1.076555023923445, 1.1052232112054095, 1.076049206400727, 1.1360294117647058, 1.1144578313253013, 1.0056022408963585, 1.0882663328915723, 1.0833333333333333, 1.75, 1.0544786533513584, 1.1786034823191527, 1.02633118782914, 1.0113636363636365, 1.2302679217958001, 1.0173094335351707, 1.1588417205510262, 1.0775, 1.2692307692307692, 1.0424528301886793, 1.0944700460829493, 1.134375, 1.4333333333333333, 1.085484411666108, 1.1754212091179386, 1.169983416252073, 1.025, 1.0188250242418162, 1.0643488282750673, 1.064892904953146, 1.1742919389978212, 1.3333333333333333, 1.1666666666666667, 1.3333333333333333, 1.1462904911180773, 1.1153846153846154, 1.0, 1.1538461538461537, 1.0344370860927152, 1.0326086956521738, 1.0827647914103569, 1.0165943530630748, 1.0709090909090908, 1.3076923076923077, 1.0666666666666667, 1.0333333333333334, 1.0675675675675675, 1.0144927536231885, 1.106896551724138, 1.0234190851191722, 1.0310118362954992, 1.3195876288659794, 1.057672185634271, 1.0469896401581502, 2.5, 1.0713143479296383, 1.263537906137184, 3.0, 2.0, 1.2002958579881657, 1.1198450835544718, 1.0857146551501202, 1.2142857142857142, 1.0, 1.0932203389830508, 1.1411042944785277, 3.0, 2.0, 1.0771269546779751, 1.1798628847963435, 1.0167437211045858, 1.6666666666666667, 1.026034823995899, 1.048024786986832, 1.0, 1.0, 1.0469483568075117, 1.0274136287660067, 1.0704225352112675, 1.137037037037037, 1.037140474389558, 1.32398753894081, 1.03515625, 1.04388336113188, 1.0872794800371401, 1.1115702479338843, 1.2105263157894737, 1.0473124277148458, 1.2977777777777777, 1.0825955517166919, 2.0179640718562872, 1.2254901960784315, 1.2537313432835822, 1.073627844712182, 1.067002201950299, 1.004038723643069, 1.102671009771987, 1.0753275109170306, 1.5, 1.6666666666666667, 1.018538643482708, 1.1596306068601583, 1.1155417234001168, 1.015831911734024, 1.0379662150861348, 1.1083017277707543, 1.0091533180778032, 1.0, 1.0275921704268531, 1.0993918349735983, 1.2423133235724744, 1.3341121495327102, 1.6666666666666667, 1.0416666666666667, 1.0900111964171466, 1.1329182458040066, 1.0352373108538022, 1.1078296223912891, 1.0106534090909092, 2.0, 1.1059431524547803, 1.057666064034525, 1.1697509709846927, 1.0950570342205324, 1.076330281790874, 1.0129032258064516, 1.1059602649006623, 1.0058309037900874, 1.0334302272834492, 1.0675561915986194, 1.055299539170507, 1.0483221476510067, 1.0, 1.136972993977074, 1.0387375445653169, 1.0243572395128553, 1.0192968634033273, 1.123827392120075, 1.0385779122541603, 1.2857142857142858, 1.252659574468085, 1.6666666666666667, 2.0, 1.1764705882352942, 1.010230179028133, 1.0308056872037914, 1.0049634273772206, 1.0021727043325777, 1.0548168249660788, 1.032426778242678, 1.201086956521739, 1.1020408163265305, 1.0588185778320252, 1.6, 1.6666666666666667, 1.0881104033970277, 1.1428571428571428, 1.0213049267643142, 1.1386386386386387, 1.089229382604777, 1.0992923341611076, 2.0, 1.108359133126935, 1.2015503875968991, 1.1582900057770076, 1.0406524950227989, 1.1767676767676767, 1.1345890410958903, 1.1368828868718175, 1.1258783620063, 1.0254372019077902, 1.3396226415094339, 1.1215083798882681, 1.0, 1.0, 1.0417769393083223, 5.0, 1.4285714285714286, 1.9285714285714286, 1.0482509047044632, 1.119047619047619, 1.0931263858093125, 1.1035700274617497, 1.1666666666666667, 1.1284916201117319, 1.0146028037383177, 1.1989247311827957, 1.2860576923076923, 1.4285714285714286, 1.049165120593692, 1.1452328159645233, 1.1343612334801763, 1.0777240609892154, 1.0218489892984541, 1.1684816753926701, 1.1499556344276842, 1.0, 1.2269323518212971, 1.0397639170979929, 1.027080344332855, 1.1774193548387097, 1.0716897563990317]
origin-bjaq_15.71 	max: 5.0000	99th: 2.7800	95th: 1.7517	median: 1.0772	mean: 1.1746

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 13.874554 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[4.7683716e-07 9.5367432e-07 5.9604645e-08 3.8146973e-06 2.9802322e-07]
Distance score: 1.1205672763026087e-06
SAUCE Drift detection: False
Detection latency: 0.0232s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.035105 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 8.0000	99th: 3.0000	95th: 1.7525	median: 1.0851	mean: 1.1868
ReportEsts: [1.06, 1.0034843205574913, 1.0352225597993827, 1.0364842454394694, 1.4166666666666667, 1.0, 1.0446284691136973, 1.053632654023038, 1.0, 1.0184381778741864, 1.1590444834298623, 1.0422560604580933, 1.0465454545454544, 1.0854368932038836, 1.0714702450408402, 1.0526315789473684, 1.121875, 1.2, 1.25, 1.1583333333333334, 1.0610562845678342, 1.092806545207413, 1.215644820295983, 1.0127877237851663, 1.0077718846820354, 1.0326288973163882, 3.0, 1.1423262175179878, 1.8, 1.4, 1.0667910447761193, 1.0, 1.0522453913120857, 1.0111245508920654, 1.0502999538532534, 1.003795763438227, 1.2357415769364362, 1.202247191011236, 1.3529411764705883, 1.1719589643380557, 1.0422483128408986, 1.0092496542185339, 1.0452961672473868, 1.099717659137577, 1.0053763440860215, 1.1001153967199357, 1.380952380952381, 1.1173020527859236, 1.0588235294117647, 1.0387275242047027, 1.21875, 1.242152466367713, 1.066390041493776, 1.0, 1.0382876204595997, 1.0035443455324762, 1.0776844631073785, 1.187830687830688, 1.1235955056179776, 1.043154755169745, 1.3676470588235294, 1.140094017094017, 1.0374251497005988, 1.03125, 1.0098039215686274, 1.25, 1.0550648089123638, 1.2391027275044608, 1.8, 1.0, 1.0227690341136055, 1.0080726538849647, 1.069316529326224, 1.0, 1.172594752186589, 1.0376569037656904, 1.2837729816147083, 1.2678571428571428, 1.3883495145631068, 1.1286824540550424, 1.0538617886178863, 1.0773809523809523, 1.0, 1.1875, 1.0903954802259888, 1.1311475409836065, 1.316301703163017, 1.0, 1.3333333333333333, 1.1149241308662527, 1.112750263435195, 1.2756561901543315, 1.0568764091002254, 1.0694653614457832, 1.2146596858638743, 1.0023419203747073, 1.0179640718562875, 1.0091743119266054, 1.25, 1.2721846398726622, 1.1428571428571428, 2.0, 1.0799549933512906, 1.247969217614365, 1.0670028818443804, 1.2364850076603195, 1.3548387096774193, 1.02406938014538, 1.0834817453250223, 1.16413579265384, 1.1971742543171116, 1.0455470737913486, 1.125, 1.4, 1.0609137055837563, 1.0990539111556135, 1.0559662090813093, 1.2380952380952381, 1.0574679555957982, 1.0, 1.1037834997372569, 1.1506976744186046, 1.0, 1.0566037735849056, 1.0, 1.2894168466522677, 1.0240654798058721, 1.1390273910509616, 1.0793650793650793, 1.6666666666666667, 1.1260504201680672, 1.0, 1.0434782608695652, 1.1352746037596757, 1.3333333333333333, 1.0329232995658466, 1.0162811107610603, 1.0875150826886224, 1.5, 1.3571428571428572, 1.0464135021097047, 1.0470219435736676, 1.0735667174023338, 1.0357756414301842, 1.2671232876712328, 1.0215982721382288, 1.1029653367949213, 1.3333333333333333, 1.0290964777947933, 1.0307692307692307, 1.1025495750708216, 1.1041361102962746, 1.5, 1.2394649502162325, 1.0110974106041923, 1.0293103448275862, 1.0621890547263682, 2.0, 1.03717277486911, 1.108417859984089, 1.2210917090609101, 1.1394148020654045, 1.125340599455041, 1.3166666666666667, 1.4188034188034189, 1.0563204005006257, 1.0, 1.0672180235567696, 1.1875, 1.054945054945055, 1.0604731836607422, 1.0429505652848592, 1.0073185011709602, 1.312280701754386, 1.1013916500994037, 1.1327275677429822, 1.2363112391930835, 1.006517016654598, 1.1146341463414635, 1.0329120589784098, 1.2086498833109887, 1.208938748267187, 1.2075471698113207, 1.0625, 1.000462085855552, 1.1011170427526804, 1.3195488721804511, 2.0955882352941178, 1.0665024630541873, 1.1, 1.2591549295774649, 1.0770814125517272, 1.5263157894736843, 1.1651186790505677, 1.1081620023378944, 1.0863672765354524, 1.0676327106260983, 1.1252525252525252, 1.0134662105210968, 1.2112380823585096, 1.0148087206910736, 1.0418115006455457, 1.0674157303370786, 1.0597055098163395, 1.0606488011283497, 1.1139551192145862, 1.4292682926829268, 1.0285714285714285, 1.3544303797468353, 1.0, 1.4338235294117647, 1.0843215619471926, 1.3255813953488371, 1.2912621359223302, 1.0004061738424046, 2.3333333333333335, 1.0414623208423772, 1.0594965675057209, 1.2132323634914308, 2.0, 1.1143200962695547, 1.0092091007583965, 1.0090352073909192, 1.0015008268886998, 1.6666666666666667, 1.3846153846153846, 1.0794021024967149, 1.048224083164886, 1.0026178010471205, 1.0017035775127767, 1.148457583547558, 1.0979590468849492, 1.3666666666666667, 1.0062347411680357, 1.0848452790267125, 1.1132075471698113, 1.0978363123236123, 1.043968432919955, 1.8333333333333333, 1.1569920844327177, 2.0, 1.2830141129032258, 1.0857741559953433, 1.238235294117647, 1.0779661016949154, 1.0769230769230769, 2.0, 1.162895199063232, 1.1967213114754098, 1.0763481660342646, 1.2, 1.0077821011673151, 1.0060422960725075, 1.0, 1.0029878750610977, 1.0334128878281623, 1.1173333333333333, 1.0138888888888888, 1.0006963788300836, 1.0881049459315724, 1.1194029850746268, 2.0, 1.0926247976081351, 1.0824182603331276, 1.1601164483260553, 1.0131876544069036, 1.096306772077064, 1.014021351325087, 1.096537949400799, 1.0914418836354045, 1.0113524185587364, 1.0602507545855584, 1.0702964182791272, 1.25, 1.0027574080364456, 1.019538188277087, 1.1272727272727272, 1.5714285714285714, 1.1159688236360341, 1.0140449438202248, 1.0397857416600564, 1.0325003509757125, 1.0535279805352797, 1.3626834381551363, 1.03139426591494, 1.0125962211336599, 1.16995383969786, 1.0632571482317532, 1.1, 1.0765687967760507, 1.0224159402241595, 1.0889258855272979, 1.0780493960557294, 1.0428721431603405, 1.2084221748400852, 1.1719887955182073, 1.040499326193347, 1.0637171744588452, 1.1545487364620939, 1.066924283154122, 1.0558183538315988, 1.1111111111111112, 1.0714285714285714, 1.0816234836004193, 1.5, 1.0180831826401446, 1.024388976009565, 1.0536764850559786, 1.6666666666666667, 1.1217391304347826, 1.1432748538011697, 1.0055642496957051, 1.1141415835580384, 1.2857142857142858, 1.084480746791132, 1.0109412668556441, 1.0377358490566038, 1.0, 4.333333333333333, 1.0349462365591398, 1.1111111111111112, 1.003851806314657, 1.0522151898734178, 1.0476190476190477, 1.1061950941243583, 1.2083333333333333, 1.3333333333333333, 1.000384268268607, 3.0, 1.2524271844660195, 1.0426309378806333, 1.0078239098685584, 1.2448330683624802, 1.026258205689278, 1.1720430107526882, 1.1061906048732153, 1.1117705108620712, 1.064, 1.0231959843961913, 1.0105034620349724, 3.0, 1.2, 1.063830192271083, 1.5, 1.087179487179487, 1.35, 3.5, 1.263157894736842, 1.2913188647746243, 1.0550314465408805, 1.0638297872340425, 1.0601503759398496, 1.2409638554216869, 1.8333333333333333, 1.0810298402862306, 1.0, 1.1343283582089552, 1.0046042405935658, 1.1446280991735538, 1.0298850574712644, 1.0161290322580645, 1.75, 1.25, 1.3244813278008298, 1.0723684210526316, 1.1441441441441442, 1.1327343416623203, 1.2192001987083954, 1.002433090024331, 1.3333333333333333, 1.036573471568362, 1.0707964601769913, 1.0857142857142856, 1.5, 1.0654545454545454, 1.2857142857142858, 1.148936170212766, 1.3434343434343434, 1.1702626641651033, 1.1082930230531225, 1.071917808219178, 1.0800412976145193, 1.1077355460385439, 1.0095057034220531, 1.1026785714285714, 1.0647436991523014, 1.0877483443708609, 1.0, 1.0010291368468758, 1.0658314350797267, 1.056338028169014, 1.0233644859813085, 1.075, 1.1635610766045548, 2.0, 1.0, 1.1083333333333334, 1.161904761904762, 1.2121212121212122, 1.0112866817155757, 1.0538379530916844, 1.030872959545777, 1.0323980832002222, 1.107267780800622, 1.022717428967429, 1.15625, 1.0862068965517242, 1.0716112531969308, 1.0, 1.1068302708860955, 1.5098039215686274, 1.1040632607998189, 1.0788537514077834, 1.1561208559096336, 1.1654752449033625, 2.0, 1.2996333158721844, 1.1666666666666667, 1.0529411764705883, 1.2727272727272727, 1.1044697536508992, 1.0227817745803358, 1.0126469540434628, 1.1073825503355705, 1.0630449362843728, 5.0, 1.159317211948791, 1.009938186217211, 1.1341342107276762, 3.0, 1.0897435897435896, 1.2771565495207668, 1.305732484076433, 1.0846114950278105, 1.0238384126757547, 1.04, 1.1923076923076923, 1.0157771064115475, 1.054058037468885, 1.1548941988203685, 1.0911733409462512, 1.3432835820895523, 1.0666666666666667, 1.046986236355007, 1.143246274635475, 1.0403225806451613, 1.0866234531526222, 1.0, 1.5, 1.2156862745098038, 1.136, 1.0315752949340735, 1.1240378964869784, 1.0704008221993833, 1.0, 1.182608695652174, 1.2592592592592593, 1.0211810282273783, 1.0833333333333333, 1.0, 1.0544440611705186, 1.0, 1.0, 1.0309751434034418, 2.3333333333333335, 1.0032488628979856, 1.02854996243426, 1.1083333333333334, 1.1666666666666667, 1.0671413068981699, 1.0879310344827586, 1.45, 1.1054566016398077, 1.078125, 1.1746920492721165, 1.0333778371161548, 1.3011243851018974, 1.0438101891123197, 1.0, 1.0481927710843373, 1.0609756097560976, 1.0369734789391576, 1.060702875399361, 1.2, 1.0918918918918918, 1.0067647445159595, 1.020497165285652, 2.0, 1.0429141716566865, 1.0179251110978258, 1.0092578803673369, 1.0183596306260452, 1.0036614571580396, 1.1211854675169195, 1.007741027445461, 1.2806728835253245, 2.0, 1.1181892578713875, 1.024228439573118, 1.0459742155193383, 1.1523178807947019, 1.0892388451443569, 1.0010613827206893, 1.2154115586690017, 1.0512412602709216, 1.2497131931166348, 1.060905767870838, 1.1727616645649432, 1.1308952589314571, 1.064848484848485, 1.0689655172413792, 1.0625, 1.1223917881348948, 1.0084033613445378, 1.0010841684956502, 1.058029876768237, 1.3333333333333333, 1.173384030418251, 1.3034682080924855, 1.4, 1.1041666666666667, 1.0110316428261812, 1.0777385159010602, 1.0153283400104511, 2.0, 1.173913043478261, 1.0079835766423357, 1.096847346075807, 1.037030179596371, 1.0355286305736697, 1.1153846153846154, 1.0637860082304527, 1.0224489795918368, 1.0117454653583111, 1.5465116279069768, 1.0328008751037634, 1.0893906588308073, 1.102439024390244, 1.0832497534219212, 1.1338028169014085, 1.0021956010939486, 2.0, 1.1691125087351502, 1.0596491228070175, 1.0064214475138789, 1.1160714285714286, 1.0345471521942111, 1.1070780399274047, 1.5, 1.1170792653936734, 1.0, 1.152542372881356, 1.0, 1.0, 1.150943396226415, 1.1542649727767695, 1.0247718383311604, 1.084033613445378, 1.0550106044538705, 1.0884543761638734, 1.1294531262599383, 1.1759957718733485, 1.0915199747022242, 1.0256656494511376, 1.0006792533388535, 1.1033369214208826, 1.1087786259541985, 1.0506980069487124, 1.0857142857142856, 1.056563500533618, 1.1245421245421245, 1.0920245398773005, 1.013969638242894, 1.1841491841491842, 1.0948906541139551, 1.283236994219653, 1.1234925229136516, 1.0346695557963164, 2.0, 1.0174418604651163, 1.4, 3.5, 1.2322097378277153, 1.0269350439826375, 1.0298841987299217, 1.015625, 1.010928961748634, 1.0535853692872774, 1.0285206548971626, 1.081374321880651, 1.4, 2.0, 1.0634983798533342, 1.1267605633802817, 1.099878197320341, 1.1197928924452814, 1.0, 1.3596491228070176, 1.1395833333333334, 1.0757269553889066, 1.1460506706408347, 1.0303514825100284, 1.0449593086445934, 1.0173926910437967, 1.511111111111111, 1.25, 1.18155324086567, 2.0, 1.045774647887324, 1.1333333333333333, 1.334978843441467, 1.1227336122733613, 1.5769230769230769, 1.0153541771164243, 1.0466666666666666, 1.2664399092970522, 1.097181729834791, 1.2085492227979275, 1.119947848761408, 1.0505590185020284, 1.020776874435411, 1.0756944444444445, 1.2, 1.0204958931450065, 1.0917047451669595, 1.0, 1.0166089965397924, 1.1821579149099273, 1.083752093802345, 1.0209875318914923, 1.5, 1.034862385321101, 1.1112848070346848, 1.5851318944844124, 1.1867469879518073, 1.0555060482270004, 1.08, 1.5555555555555556, 1.0378343118069147, 1.0079734219269103, 1.084076865428939, 1.1750908490254377, 1.037972727816431, 1.0137765043594327, 1.2723076923076924, 1.1127975163849604, 1.2342857142857142, 1.0815499042712082, 1.0579331941544885, 1.114630467571644, 1.0088105726872247, 1.0035886974916894, 1.1570247933884297, 1.1403738930796983, 1.0434782608695652, 1.6, 1.112079701120797, 1.568, 1.0611860684028867, 1.875, 1.0769230769230769, 1.0330112721417068, 1.0274071402812839, 1.1349693251533743, 1.0145303189264432, 3.0, 1.2537638481204432, 3.0, 1.1027667984189724, 1.0, 1.0202902757619738, 1.4666666666666666, 1.186131386861314, 1.0311688311688312, 1.0, 1.042741935483871, 1.283717679944095, 1.5, 2.5, 1.127659574468085, 1.2114285714285715, 1.0418073227733056, 1.2044025157232705, 1.1246334310850439, 1.3333333333333333, 1.0609137055837563, 1.1399253731343284, 1.1361867704280155, 1.1700680272108843, 1.1290322580645162, 1.5, 1.220496894409938, 1.0439952437574316, 1.0120171673819742, 1.0650624710782046, 1.071816636599685, 1.1221710704475996, 1.1096491769674368, 1.1208245561239845, 1.1631205673758864, 1.0104633781763828, 1.8571428571428572, 1.5, 1.2647058823529411, 1.040960487706162, 1.056115107913669, 1.121212121212121, 1.0396659707724425, 1.0088838124246462, 1.0398181860346467, 1.0141158587641217, 1.2117647058823529, 1.1428571428571428, 1.1153402537485582, 1.0525532969757065, 1.1140084555798315, 1.0278849308250093, 1.0223463687150838, 1.0569390641333087, 1.0063525941437337, 1.0362808269493127, 1.0377777777777777, 1.0492131683764898, 1.0629139072847682, 1.0799517878666132, 1.0020576131687242, 1.0334212307048074, 1.0175438596491229, 1.068068068068068, 2.0, 1.047713717693837, 1.000766427774267, 1.0151515151515151, 1.092316464340412, 1.0474060822898033, 1.3513513513513513, 1.0611476146651542, 1.0130769922917728, 1.0822774211554562, 1.0583067092651757, 1.0103286384976526, 1.2022989154993222, 1.2145454545454546, 1.411764705882353, 1.0, 1.4444444444444444, 1.0708243322363773, 1.25, 1.0658102861525187, 1.0891122353046514, 1.012530390873387, 1.0589696869305947, 1.2685837748855393, 1.0369708876585104, 1.0453172205438066, 1.012415349887133, 1.0262180493207729, 1.0687158469945355, 1.0417263073799141, 1.256397415994792, 1.5, 1.0070298769771528, 1.0978260869565217, 1.1332117316656534, 1.0794520547945206, 1.2667261373773417, 1.0271493212669682, 2.234657039711191, 1.072787724787542, 1.1097424412094066, 1.0187913304541238, 1.375, 1.096067344158835, 1.0350785770118962, 1.318499127399651, 1.0668789808917198, 1.121212121212121, 1.1552062868369353, 1.0232740293163254, 1.0457527930484127, 1.2137931034482758, 1.0191409005407948, 1.1219512195121952, 1.0423816568047337, 1.0165605095541401, 1.015228426395939, 1.032069970845481, 1.0129032258064516, 1.0245098039215685, 1.0897565922920893, 1.0014558775184332, 1.0784123910939012, 1.0129013511550196, 1.0842704100480236, 1.2, 1.1102941176470589, 1.1028599285017875, 1.0083054159687326, 1.0677444187836798, 1.0474890829694323, 1.0705765407554673, 1.2355769230769231, 1.0884718498659518, 1.028777554308128, 2.3333333333333335, 1.1005229517722255, 1.2376970086844645, 1.0751318101933216, 1.1050847457627118, 1.1224242201430121, 1.1327500656948974, 1.04155672823219, 1.109278350515464, 1.103707476566415, 1.0668937585494729, 1.1128526645768024, 1.1268292682926828, 1.0192192192192193, 1.0839194438765078, 1.1111111111111112, 1.4, 1.052892471946835, 1.1694988459825346, 1.0607429718875503, 1.0610328638497653, 1.2435703479576399, 1.0056470835057374, 1.1701680672268908, 1.043227665706052, 1.3225806451612903, 1.0836120401337792, 1.105263157894737, 1.1237113402061856, 1.4736842105263157, 1.050967801972827, 1.1680327868852458, 1.0375494071146245, 1.0208333333333333, 1.1631578947368422, 1.1034841393655745, 1.0588235294117647, 1.2, 1.0493441599000624, 1.0403225806451613, 1.1003565970453388, 1.0, 1.0049324647755415, 1.037313432835821, 1.0365209034118212, 1.2393162393162394, 1.0666666666666667, 1.3036863662960796, 1.02064334516025, 1.0270373450772399, 1.0319148936170213, 1.360655737704918, 1.0, 1.1764705882352942, 1.1666666666666667, 1.244186046511628, 1.0812454390659207, 1.0310139903429492, 1.0353542537664202, 1.3043478260869565, 1.1093631636204158, 1.046939490206869, 3.0, 1.0750322564738948, 1.1442920137187653, 2.0, 2.25, 1.175171736997056, 1.1085693754117012, 1.0799648976359415, 1.1878172588832487, 1.0, 1.1777777777777778, 1.2349869451697129, 1.1333333333333333, 1.0764296369965192, 1.091294796100508, 1.017669635744804, 1.0124346917450366, 1.5714285714285714, 1.0325182420448171, 1.0498059508408797, 1.0462724935732648, 1.0682926829268293, 1.001169590643275, 1.0, 1.2262773722627738, 1.0821608902397177, 1.0020744534301411, 1.1714285714285715, 1.1270903010033444, 1.1523292747485443, 1.1131928181108508, 1.1065292096219932, 1.2835820895522387, 1.0494767473632438, 1.8385221305326331, 1.0195958589173382, 2.082051282051282, 1.134453781512605, 1.1195445920303606, 1.375, 1.0644768856447688, 1.046875, 1.0119114864814864, 1.0344514959202176, 1.5, 1.1109215017064846, 1.0256853544084958, 1.1464572680788896, 1.175745784695201, 1.0191120607787274, 1.0784559643255296, 1.1357798165137614, 1.3465346534653466, 1.1111111111111112, 1.0224224092582852, 1.088461340956163, 1.3175631885936487, 1.0712166172106825, 1.6666666666666667, 1.058139534883721, 1.038620545292794, 1.06544901065449, 1.031965552857852, 1.0755845568243612, 1.0469121140142519, 2.0, 1.0957446808510638, 1.051253309626423, 1.1686200378071834, 1.0289389067524115, 1.0793211255024564, 1.0978260869565217, 1.2734806629834254, 1.006852667645619, 1.0318703178566895, 1.1011589342276877, 1.0202312138728324, 1.0373216245883645, 1.0857142857142856, 1.2136081407381856, 1.0124716170949395, 1.024030905448045, 1.0721806806043033, 1.1163149768399383, 1.0461149715729627, 1.1285714285714286, 1.2017738359201773, 2.0, 2.5, 1.0, 1.0063965884861408, 1.0604070912672356, 1.0050666749557053, 1.0032635183733938, 1.0435174746335965, 1.0258531540847984, 1.2136363636363636, 1.0657894736842106, 1.0543923026561914, 1.6666666666666667, 1.6153846153846154, 1.0860437610881135, 1.3333333333333333, 1.0146726862302482, 1.1599668462494819, 1.0541758937045238, 1.1034955680466976, 2.5, 1.0467239527389904, 1.1366459627329193, 1.2115030994673086, 1.03947539379858, 1.11482254697286, 1.121030042918455, 1.1260013900574313, 1.091828261612856, 1.0487465181058495, 1.4193548387096775, 1.0925925925925926, 1.0, 2.0, 1.0413135119836743, 8.0, 1.3333333333333333, 1.9393939393939394, 1.026865671641791, 1.0710669077757686, 1.1104260089686098, 1.0426356589147288, 1.0, 1.225286522120415, 1.0077896786757545, 1.0952380952380953, 1.2946954813359528]
origin-bjaq_15.71 	max: 8.0000	99th: 3.0000	95th: 1.7525	median: 1.0851	mean: 1.1868

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.107434 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.044205