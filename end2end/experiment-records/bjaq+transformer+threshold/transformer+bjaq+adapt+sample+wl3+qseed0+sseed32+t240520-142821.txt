Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 32, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.5050	95th: 1.6877	median: 1.0820	mean: 1.1735
ReportEsts: [1.0096153846153846, 1.0005211047420532, 1.0391114390289773, 1.056910569105691, 1.4285714285714286, 1.0, 1.1141646627733883, 1.059124125617455, 1.0, 1.0090673575129534, 1.196548639367443, 1.0427367766191964, 1.0059146599070554, 1.086046511627907, 1.0692334864005653, 1.0, 1.0555555555555556, 1.0279844137442438, 3.0, 2.0, 1.173913043478261, 1.089315918060515, 1.113964942011333, 1.1045214327657076, 1.0947212629501726, 1.0, 1.1844031947936695, 1.2, 1.2, 1.0359712230215827, 1.0, 1.0465438358952575, 1.0045334875252203, 1.034443168771527, 1.0173300044059332, 1.2305064978340554, 1.141711229946524, 1.010372863724908, 1.150354707624492, 1.0, 1.1174785100286533, 1.0061349693251533, 1.0, 1.04427121207714, 1.1179513709260218, 1.8615384615384616, 1.03, 1.1660777385159011, 1.0196909941044927, 1.0462962962962963, 1.0684804571369737, 1.352233676975945, 1.0371129560577657, 2.0, 1.1974025974025975, 1.143900605105804, 1.3736263736263736, 1.3725490196078431, 1.00625, 1.25, 1.102985278080698, 1.1164383561643836, 1.1636363636363636, 1.0, 1.1818181818181819, 1.1114060396230043, 1.2404138770541693, 1.75, 1.0, 1.0753239489139554, 1.0011933174224343, 1.062137049941928, 1.0254041570438799, 1.1116332051829703, 1.0635294117647058, 1.0465116279069768, 1.0, 1.1077244258872652, 2.0, 1.0135011047662774, 1.4545454545454546, 1.0658013280389735, 1.177914110429448, 1.1339401820546164, 1.1118743866535818, 1.04, 1.0738010243675307, 1.0462287104622872, 1.088235294117647, 1.75, 1.1005394801373223, 1.055255248189823, 1.1214953271028036, 1.0308555399719495, 1.001826484018265, 1.0415584415584416, 1.0714285714285714, 1.163853028798411, 1.0, 1.2288377192982456, 1.0066676329902884, 1.0574614065180103, 1.2286581400390202, 1.3076923076923077, 1.0259841059852373, 1.0268117865675603, 1.110690677000228, 1.1645809632157755, 1.0469037400367873, 1.3333333333333333, 1.6666666666666667, 1.0483644859813084, 1.0840687618762708, 1.053063802905875, 1.1168831168831168, 1.0567237041080761, 1.0, 1.1270892462945443, 1.1483516483516483, 1.0, 1.0167597765363128, 1.0, 1.1704260651629073, 1.0273958550725664, 1.1197483885998292, 1.0980392156862746, 1.8, 1.1415562913907285, 1.0, 1.1071428571428572, 1.0980462320188935, 1.3, 1.0712890625, 1.044697193315204, 1.0430946448266003, 1.041388518024032, 1.0735294117647058, 1.0814497272018706, 1.039972432804962, 1.0682510664229128, 1.0200593983839659, 1.132867132867133, 1.0260926288323549, 1.125762130191917, 2.0, 1.0232452142206017, 1.0114285714285713, 1.0840618695359785, 1.0875242632786306, 1.5, 1.2754904335190118, 1.0135135135135136, 1.0204081632653061, 1.1074561403508771, 1.0963503649635036, 1.0460215778826703, 1.0725263486832761, 1.1654230162900683, 1.0756646216768917, 1.1710526315789473, 1.2857142857142858, 1.4375, 1.0058910162002945, 1.4285714285714286, 1.055536388598759, 1.0473735979687226, 1.1905414667580534, 1.3545797465905793, 1.1281874569262578, 1.1155548487980707, 1.2, 1.1018518518518519, 1.1430231432168103, 1.0222446916076846, 1.0348214285714286, 1.0787172011661808, 1.0276999688764394, 1.1184678048357743, 1.0125658567272156, 1.0, 1.2233009708737863, 1.0190516511430991, 1.0285087719298245, 1.1225083056478404, 1.0394736842105263, 1.0864511531325642, 1.2523544109167788, 1.0702335346189642, 1.1372549019607843, 1.2422727272727272, 1.0261464057517387, 1.0, 1.6363636363636365, 1.0787700254227028, 1.0652962515114872, 1.0140252454417953, 1.4583333333333333, 1.0565916398713826, 1.0536849298879338, 1.0734182453337695, 1.0626410835214446, 1.0290924422894487, 1.112994350282486, 1.0491803278688525, 1.1506849315068493, 1.0, 1.4035087719298245, 1.022788203753351, 1.3588850174216027, 1.264367816091954, 1.0113692535837864, 1.0031277926720286, 1.011910127942859, 1.063810897791588, 1.150145663703593, 1.2137931034482758, 1.0712074303405572, 1.0068049254698639, 1.0235366764317306, 1.0232934553131598, 1.0, 1.0401656314699792, 1.1017272960037816, 1.0102101786007287, 1.161810291382517, 1.0083650388283734, 1.279714223857978, 1.0357142857142858, 1.0032884223982776, 1.1498194945848375, 1.0084602368866329, 1.1228070175438596, 1.1322217003287929, 1.0607350096711798, 1.18503937007874, 2.0, 1.1597697999451904, 1.0769874944171505, 1.290436005625879, 1.1551724137931034, 1.0, 1.6666666666666667, 1.0843284500800197, 1.1454545454545455, 1.1099480168055258, 1.5, 1.0, 1.1764705882352942, 1.0663544106167058, 1.0888888888888888, 1.0225988700564972, 1.0770042194092826, 1.0453020134228188, 1.0046179680940386, 1.1130059425872516, 1.0, 2.0, 1.073756502786174, 1.0242462576428422, 1.1523642732049038, 1.0008152685160023, 1.1590815425375331, 1.0434157611020793, 1.0802861685214626, 1.0827245039874656, 1.0245215311004785, 1.0608756080611537, 1.0761199947138893, 1.0909090909090908, 1.0027628291370363, 1.0021321961620469, 1.1818181818181819, 1.3157894736842106, 1.0054844606946984, 1.0555555555555556, 1.1196581196581197, 1.0952964134311285, 1.0445682451253482, 1.3959899749373434, 1.004256189891549, 1.065236818588025, 1.0180944502730476, 1.0681519348915236, 1.1111111111111112, 1.0709712622771916, 1.6666666666666667, 1.014332395945579, 1.0451467268623025, 1.0708661417322836, 1.0810810810810811, 2.0, 1.434782608695652, 1.0, 1.0637584109521747, 1.0, 1.0380952380952382, 1.0610859728506787, 1.0092147435897436, 1.0161412109102737, 1.1595092024539877, 1.1320754716981132, 1.016437964551172, 1.1007100149476832, 1.044833493502695, 1.0854700854700854, 1.0, 1.1157517899761336, 1.2848101265822784, 1.0993150684931507, 1.0905644481887111, 1.0275229357798166, 1.1605633802816901, 1.1568627450980393, 1.0055172413793103, 1.015457165313073, 1.2857142857142858, 1.000455281069107, 1.030188679245283, 1.0555555555555556, 1.0706271891418564, 1.0952380952380953, 1.4, 1.005190304106173, 2.0, 1.168724279835391, 1.0479651162790697, 1.1000820344544708, 1.1118587047939446, 1.2044025157232705, 1.123456790123457, 1.1166817732923877, 1.0844753860259813, 1.0530846484935437, 1.031925335499484, 1.1269306154449235, 2.0, 1.0, 1.056639776960168, 1.25, 1.07035175879397, 1.3529411764705883, 1.0, 1.4666666666666666, 1.3493975903614457, 1.071969696969697, 1.1727272727272726, 1.0746753246753247, 1.0, 1.1511318242343542, 1.0798353143062382, 2.0, 1.1536628945801073, 1.0, 1.0953009944583618, 1.0229885057471264, 1.0184203621096826, 1.140552995391705, 1.1363636363636365, 1.3044444444444445, 1.2962962962962963, 1.0242513660391908, 1.0169793907567122, 1.0637393767705383, 1.0, 1.0769230769230769, 1.5714285714285714, 1.5, 1.2307692307692308, 1.0694887466644716, 1.3333333333333333, 1.1414309484193013, 1.2469135802469136, 1.1740993068158152, 1.0940385571163254, 1.2461380020597321, 1.015219855476314, 1.017401392111369, 1.0392857142857144, 1.5, 1.2598425196850394, 1.123404255319149, 1.0490279158450533, 1.0952380952380953, 1.5714285714285714, 1.0417633410672853, 1.0005817335660268, 1.0267839380137165, 1.003690036900369, 1.1464387464387464, 1.024623803009576, 1.0526315789473684, 1.0907770515613653, 1.132415254237288, 1.1346153846153846, 1.0254957507082152, 1.1495327102803738, 1.050596353190958, 1.0651390573230668, 1.0834900372473149, 1.303030303030303, 1.1443298969072164, 1.1015384615384616, 1.0, 1.0240464984697684, 1.0487229630266368, 1.0087100882379696, 1.0559397763597258, 1.0527481377088785, 1.159517000317763, 1.5714285714285714, 1.23026706231454, 1.0, 1.2203245089666952, 1.25, 1.0272342705345283, 1.0, 1.1646603611349957, 1.0711462450592886, 1.1788079470198676, 3.0, 1.1182443498198493, 1.0116772465506714, 1.1642219974250505, 2.0, 1.0793650793650793, 1.3023032629558542, 1.3700787401574803, 1.1008707080663709, 1.1663201663201663, 1.2352941176470589, 1.2743744607420189, 1.002243672143408, 1.029908122861646, 1.1007594985759401, 1.094517543859649, 1.0746268656716418, 1.0303030303030303, 2.142857142857143, 1.067750677506775, 1.5, 1.232968881412952, 1.0, 1.2426553746613713, 1.9230769230769231, 1.039847649825432, 1.1174448778978845, 1.0586057988895743, 1.0, 1.2127659574468086, 1.24, 1.28862257433686, 1.1838074398249452, 1.0, 1.0441431044431622, 1.0727318548387097, 1.1015333609614588, 1.5, 2.0, 1.0481553398058252, 1.013623978201635, 1.0819672131147542, 1.1111111111111112, 1.0787308421024542, 1.0985477178423237, 1.4705882352941178, 1.0354048964218456, 1.0454545454545454, 1.1496062992125984, 1.0024193548387097, 1.2465292385359696, 1.0230195548769745, 1.0, 1.0422535211267605, 1.0826908729171847, 1.0371653454905594, 1.0320654111698162, 1.0, 1.1251935412519354, 1.0070559187305257, 1.0220010476689365, 2.0, 1.043859649122807, 1.025986571994397, 1.0454853239909323, 1.043816347035953, 1.0028868335099448, 1.0597488746742478, 1.0144927536231885, 1.0785920925747348, 2.0, 1.0556617913070443, 1.3214285714285714, 1.0, 1.1865284974093264, 1.1346153846153846, 1.002442236521855, 1.078826764436297, 1.045310319781333, 1.007801743919229, 1.068907502433514, 1.0308399837684297, 1.0467191419027475, 1.197674418604651, 4.0, 1.0154651302364661, 1.1884615384615385, 1.046846376845962, 1.0414200899665262, 1.1194824961948249, 1.1410818713450293, 2.0693069306930694, 2.4285714285714284, 1.0072551979354336, 1.0337593172373067, 1.0128830727145022, 1.1389615240941353, 1.0499421519475511, 1.0041407867494825, 1.0741478576494639, 1.0194174757281553, 1.2265625, 3.0, 1.0909090909090908, 1.0030674846625767, 1.082375478927203, 1.0836363636363637, 1.1680555555555556, 1.0, 1.7456140350877194, 1.148905109489051, 1.1304347826086956, 1.0827473593511807, 1.2555555555555555, 1.0329057789138167, 2.0, 1.1907613344739094, 1.12, 1.184873949579832, 1.1337988826815641, 1.026258205689278, 1.0434782608695652, 1.0946822308690014, 1.0771985470916252, 1.0, 1.1702127659574468, 1.0, 1.0, 1.125, 1.0504032258064515, 1.037037037037037, 1.1019417475728155, 1.0652034604293497, 1.0823665893271461, 1.0467601391329293, 1.1986762793995982, 1.0410534469403563, 1.1106122273187329, 1.0918918918918918, 1.1031331592689295, 1.0062893081761006, 1.0629112924453803, 1.1618497109826589, 1.1427250308261405, 1.0383114579638169, 1.1603548398589192, 1.0791011129864152, 3.0, 1.1498771498771498, 1.0798403193612773, 1.3944954128440368, 1.0, 1.186046511627907, 1.25, 1.0386029411764706, 1.2962962962962963, 1.1666666666666667, 1.0019613540607293, 1.135689345469958, 1.0293463359114308, 1.0178228470461703, 1.2432432432432432, 1.1289437585733881, 2.0, 1.1666666666666667, 1.0371060073108491, 1.0490477328870826, 1.0834490419327965, 1.0885636177241145, 1.0171310104022695, 1.2493506493506494, 1.1715494862677516, 1.1207815275310835, 1.0341390676502904, 1.1528925619834711, 1.3333333333333333, 1.0545645330535152, 1.0, 1.2422535211267605, 1.2089595197467158, 3.0, 1.0543852106620808, 1.0774693801518185, 1.4285714285714286, 1.065683903412799, 1.4, 1.1176470588235294, 1.0809652131308183, 1.6923076923076923, 1.03122922785009, 1.0346005980350277, 1.3571428571428572, 1.2083333333333333, 1.1154639175257732, 1.0229555236728838, 1.0368653421633554, 1.0745128503916619, 1.156088408914108, 1.0, 1.012260157237891, 1.103658536585366, 2.0, 1.0119500525148792, 1.1012890388441907, 1.1551561021759698, 1.0205291476965201, 1.097396750305751, 1.0, 2.0, 1.0823384108686702, 1.0137096774193548, 1.134932889891911, 1.1868566904196358, 1.031831201839674, 1.0565207093996851, 1.0952380952380953, 1.1107438016528925, 1.1906354515050168, 1.0940231284236153, 1.0668769716088329, 1.0250696378830084, 1.0362394957983194, 1.0614468481042103, 3.0, 1.1467740965666526, 1.0162743711486009, 1.0183376306582932, 1.4615384615384615, 1.2696847660047215, 1.3482587064676617, 1.1428571428571428, 1.089511180080412, 1.0420575865415722, 1.175764192139738, 1.0303030303030303, 1.3333333333333333, 1.0700049716324502, 1.5, 1.0327102803738317, 1.0833333333333333, 1.1013885981438838, 1.3846153846153846, 1.0886075949367089, 1.0943396226415094, 1.0, 1.6772486772486772, 1.3963470319634703, 1.25, 2.0, 1.1367521367521367, 1.2448275862068965, 1.0068841664172403, 1.1957340025094103, 1.1307420494699647, 1.233038348082596, 1.1014466214978942, 1.0571428571428572, 1.0425531914893618, 1.1346938775510205, 1.0769230769230769, 1.0, 1.120631341600902, 1.1370851370851371, 1.0020661157024793, 1.0130542892664733, 1.0769351635367173, 1.0244026436197256, 1.0829010168084665, 1.1363143435511855, 1.1622377622377622, 1.0047732696897376, 1.8333333333333333, 1.0, 1.2142857142857142, 1.0348258328906428, 1.1085613415710502, 1.107843137254902, 1.0545454545454545, 1.0445971744940816, 1.0059482155353394, 1.0136522779032722, 1.0833333333333333, 1.2222222222222223, 1.0416345412490362, 1.0674045599151645, 1.0614974565666087, 1.016270371006754, 1.0263157894736843, 1.004799173065564, 1.0229788750549733, 1.2436305732484076, 1.3268839103869654, 1.2857142857142858, 1.049265750828991, 1.2032520325203253, 1.2380952380952381, 1.1223241590214068, 1.0701001430615165, 1.0, 1.0257611241217799, 1.004463563735162, 1.0588235294117647, 1.0979708483589266, 1.0419426048565121, 1.162162162162162, 1.0155146534117474, 1.0444844989185291, 1.1369527262959978, 1.0400763358778626, 1.052568697729988, 1.1882805960154026, 1.2121212121212122, 1.2142857142857142, 1.0, 1.4285714285714286, 1.066803923943321, 1.3333333333333333, 1.1786622853508586, 1.0706208604813958, 1.0423128046078867, 1.0764647467725919, 1.05571824020263, 1.0143509458577953, 1.03584229390681, 1.0818307905686546, 1.0162215562003665, 1.077966816647919, 1.0448460139937195, 1.2376851740334818, 1.6666666666666667, 1.015625, 1.0201612903225807, 1.1090679053000103, 1.006514657980456, 1.3005209761447765, 1.0329067641681902, 2.2304347826086954, 1.0131139776351916, 1.0120805369127517, 1.057129186602871, 1.1875, 1.0819487915656696, 1.053302413167806, 1.2917515274949083, 1.0581052631578947, 1.0, 1.0412486064659978, 1.1043956043956045, 1.6875, 1.080026238110856, 1.4615384615384615, 1.0171370967741935, 1.09375, 1.0061058344640434, 1.0259112109172568, 1.0179640718562875, 2.2, 1.087378640776699, 1.091437185190632, 1.0722095671981777, 1.0258064114457193, 1.0473821855289471, 1.056380129589633, 1.0, 1.0682967959527825, 1.0966152527849187, 1.02995669449529, 1.0470941883767535, 1.0069444444444444, 1.174166225516146, 1.0442992472299755, 1.3715139442231075, 1.089059056015809, 1.0, 1.3333333333333333, 1.0585675789265494, 1.0095170454545455, 1.2323566999574005, 1.1247521082383467, 1.036711891460495, 1.0714285714285714, 1.0960463672117573, 1.1000796389700027, 1.119485294117647, 1.022099447513812, 1.0, 1.0750993962597555, 1.0952380952380953, 1.75, 1.0626112368438398, 1.1680250986480367, 1.0281359906213365, 1.0227272727272727, 1.2697320782041999, 1.017496568606642, 1.1613719426482991, 1.486988847583643, 1.1923076923076923, 1.0296495956873315, 1.1757425742574257, 1.128125, 1.6538461538461537, 1.070655939211085, 1.2051536174430129, 1.1616915422885572, 1.024390243902439, 1.0067934233736855, 1.0422589320015367, 1.0701807228915663, 1.2597544068132303, 1.3333333333333333, 1.2173913043478262, 2.0, 1.1431556948798327, 1.4230769230769231, 1.0, 1.1538461538461537, 1.0582781456953643, 1.049429657794677, 1.0333748443337485, 1.0014193671855065, 1.4090909090909092, 1.36, 1.0666666666666667, 1.0333333333333334, 1.0, 1.0142857142857142, 1.1088082901554404, 1.0342320498706632, 1.030785499610404, 1.3061224489795917, 1.068881092577775, 1.047450077573695, 2.5, 1.0705658194685448, 1.3232514177693762, 3.0, 2.0, 1.167455621301775, 1.1349064046474933, 1.0438852766761566, 1.2018633540372672, 1.0, 1.167420814479638, 1.0584415584415585, 3.0, 1.5, 1.0583333333333333, 1.2622664336604383, 1.025865300512308, 1.6666666666666667, 1.0244246347829034, 1.0449264136328427, 1.0667396061269148, 1.0, 1.0191387559808613, 1.0246076381833398, 1.1842105263157894, 1.1336779911373707, 1.0263571303892476, 1.295731707317073, 1.10546875, 1.1164421479977855, 1.0723443223443223, 1.140495867768595, 1.4375, 1.0366244781114402, 1.4452890224500619, 1.039450344398627, 1.2014388489208634, 1.2058823529411764, 1.208955223880597, 1.1001371742112482, 1.0690198550267884, 1.0091052848926805, 1.1044567924889825, 1.0731441048034935, 1.5, 1.6666666666666667, 1.1664003068465127, 1.054089709762533, 1.2139661544446605, 1.0206980768522722, 1.0344539220605453, 1.0954681772742418, 1.1164556962025316, 1.0208333333333333, 1.061551764798365, 1.0722093238273305, 1.2323892519970951, 1.0297723292469352, 1.6666666666666667, 1.056338028169014, 1.0189137666803723, 1.1359934853420195, 1.0399227824281359, 1.109387969070814, 1.0134943181818181, 2.0, 1.1174934725848564, 1.0400399137495986, 1.1690655700251313, 1.231939163498099, 1.0712463643732417, 1.0477707006369428, 1.1490066225165563, 1.011137162954279, 1.0313399308315099, 1.0603165249600135, 1.0184331797235022, 1.0483221476510067, 1.0, 1.16794731064764, 1.043674010421428, 1.079885877318117, 1.0460841069206088, 1.1556270096463022, 1.0370650529500756, 1.2, 1.2107969151670952, 1.6666666666666667, 2.0, 1.1764705882352942, 1.0129533678756477, 1.0315955766192733, 1.053271795674111, 1.0081818570634276, 1.0549670770111652, 1.0178875638841567, 1.25, 1.2244897959183674, 1.0729182011405964, 1.6, 1.3333333333333333, 1.179064417177914, 1.1428571428571428, 1.0899854862119014, 1.1495704901465387, 1.1233889139251916, 1.0992355261235818, 2.0, 1.1012383900928793, 1.189922480620155, 1.0502881089575693, 1.0403267979852657, 1.1464646464646464, 1.123972602739726, 1.1438977123382263, 1.0944529501825462, 1.0277777777777777, 1.0140845070422535, 1.079608938547486, 1.0, 1.0, 1.041718822645828, 5.0, 1.5714285714285714, 2.0, 1.0298136645962732, 1.1058823529411765, 1.0864745011086474, 1.1220086308356219, 1.1666666666666667, 1.127250155183116, 1.0204439252336448, 1.2054054054054053, 1.2644230769230769, 1.4285714285714286, 1.075478426245097, 1.1291574279379157, 1.1368653421633554, 1.0769802900706582, 1.0279195406881703, 1.194881678980619, 1.1467021591245194, 1.0, 1.3085839996615476, 1.0465636437576251, 1.062948350071736, 1.1774193548387097, 1.0980423196665083]
origin-bjaq_15.71 	max: 5.0000	99th: 2.5050	95th: 1.6877	median: 1.0820	mean: 1.1735

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 14.054000 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[5.9604645e-07 7.1525574e-07 5.9604645e-07 1.1920929e-07 5.9604645e-08]
Distance score: 4.172325134277344e-07
SAUCE Drift detection: False
Detection latency: 0.0232s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.047623 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 7.0000	99th: 2.5000	95th: 1.6440	median: 1.0826	mean: 1.1701
ReportEsts: [1.0194986072423398, 1.0075317409081128, 1.0651185205264901, 1.0486577181208054, 1.375, 1.0, 1.1248253601194778, 1.0181020192172736, 1.1666666666666667, 1.008714596949891, 1.0986318497679675, 1.0429018479351138, 1.0899810964083176, 1.0998003992015968, 1.0286131386861315, 1.0677966101694916, 1.1335504885993486, 1.1046511627906976, 1.2727272727272727, 1.1021594684385383, 1.0880179171332587, 1.1282726963617817, 1.020880617339991, 1.0025041736227045, 1.0168394696007899, 1.022626340188758, 3.0, 1.19301185378266, 1.5, 1.4, 1.0384812724474088, 1.0, 1.044924585746209, 1.0034613520810418, 1.0023342670401494, 1.0304685603301773, 1.2358595322367965, 1.106837606837607, 1.6666666666666667, 1.0769230769230769, 1.0659718808376757, 1.0625925468904245, 1.2776978417266187, 1.1469420174741858, 1.0056179775280898, 1.0618461928612186, 1.35, 2.4285714285714284, 1.2180094786729858, 1.037914691943128, 1.0769230769230769, 1.1896551724137931, 1.0408163265306123, 1.0571428571428572, 1.0135092755650978, 1.054952656837736, 1.020537347024898, 1.1282051282051282, 1.086021505376344, 1.0511305030441886, 1.2727272727272727, 1.1525814973454052, 1.124401913875598, 1.0381679389312977, 1.058252427184466, 2.0, 1.0496920661755826, 1.307241746538871, 1.8, 1.0, 1.057402978165265, 1.024340770791075, 1.0716360116166506, 1.0403846153846155, 1.1267407793875668, 1.055, 1.054172248049799, 1.1505376344086022, 1.5728155339805825, 1.0766517408388925, 1.0271580989330746, 1.1666666666666667, 1.0, 1.6153846153846154, 1.0914221218961626, 1.171875, 1.3024830699774266, 1.1142857142857143, 1.5, 1.1050813693832635, 1.1066726511071214, 1.2186410682683542, 1.0573292402148886, 1.035055006526198, 1.0025706940874035, 1.0777511961722488, 1.16988416988417, 1.0407055630936228, 1.041237113402062, 1.278830963665087, 1.1785714285714286, 2.0, 1.0801057614397203, 1.2779443254817988, 1.0470420527441198, 1.2344665461121158, 1.3333333333333333, 1.0256541251738962, 1.0943354639629712, 1.4006495987772258, 1.1191144371686934, 1.0442342111991818, 1.1111111111111112, 1.0, 1.0438441965159522, 1.0814646869614104, 1.0907634810464495, 1.125, 1.0600785869046307, 1.0, 1.190463645943098, 1.1205357142857142, 1.5, 1.0325581395348837, 1.4285714285714286, 1.3254817987152034, 1.0288227869007172, 1.003245278120335, 1.125, 1.6666666666666667, 1.143054595715273, 1.0, 1.1111111111111112, 1.1337774077157925, 1.5, 1.0252631578947369, 1.0392237044241333, 1.0978350331007336, 1.0, 1.6428571428571428, 1.0144927536231885, 1.0629153743907842, 1.0835881753312946, 1.0079293467858803, 1.2941176470588236, 1.0005464480874318, 1.1240699310610125, 3.0, 1.0106020446800454, 1.0408357075023742, 1.1094555873925502, 1.1169977924944812, 1.5, 1.211607858861267, 1.0526315789473684, 1.0168350168350169, 1.2535211267605635, 1.0, 1.077422847861397, 1.0647619047619048, 1.0901240126059017, 1.0180623973727423, 1.1043956043956045, 1.375, 1.4453781512605042, 1.013530135301353, 1.375, 1.0609948732160177, 1.0909090909090908, 1.2190760059612518, 1.040219247129645, 1.1462264150943395, 1.0083350873500316, 1.3117338003502628, 1.1456692913385826, 1.1025620432093808, 1.0396975425330812, 1.0233876683203402, 1.0779742765273312, 1.0221932114882506, 1.1288441145281018, 1.2202145534444875, 1.0880503144654088, 1.8125, 1.0281552096384206, 1.1367192925598408, 1.2035714285714285, 1.0794758999101273, 1.0258823529411765, 2.0, 1.1694915254237288, 1.0839293752813484, 1.45, 1.1467750126968004, 1.0029582226515334, 1.0344054131515656, 1.0886349536712763, 1.0562685093780848, 1.0968185148998535, 1.0065786177028526, 1.0141666666666667, 1.03833344896968, 1.0502901353965184, 1.0619865038025, 1.0582980724024447, 1.063532738358222, 1.528301886792453, 1.0714285714285714, 1.1481481481481481, 1.0, 1.3357664233576643, 1.1135576608951323, 1.3208092485549132, 1.2735849056603774, 1.0041050903119868, 1.0, 1.045404471325197, 1.036697247706422, 1.2081869009584665, 2.25, 1.0488431876606683, 1.0125306456006538, 1.0680290014596445, 1.0155870072752284, 5.0, 1.043217286914766, 1.1353359969746297, 1.0445213973632497, 1.0352303523035231, 1.093062605752961, 1.0851829634073185, 1.0991291581862468, 1.4396551724137931, 1.008727265895085, 1.138340429179644, 1.093167701863354, 1.083725305738476, 1.1052023121387282, 1.75, 1.1606792945787068, 1.0, 1.2352225735830697, 1.1335753513916038, 1.1385306760453302, 1.226923076923077, 1.0, 1.5, 1.0173580033160683, 1.106060606060606, 1.0720700043035432, 1.4, 1.1221719457013575, 1.1111111111111112, 1.0, 1.011306036728829, 1.053932584269663, 1.1394527802294792, 1.1036525172754195, 1.0138494318181819, 1.100816208020131, 1.0, 2.0, 1.0682922648382258, 1.036683088977266, 1.132132132132132, 1.0017607168383802, 1.0936871081912605, 1.0292663690266608, 1.090969455511288, 1.0696646699553676, 1.0449268046441191, 1.1041934653974788, 1.0057330057330058, 1.1428571428571428, 1.026977030985047, 1.20125786163522, 1.3617021276595744, 1.2, 1.2212423312883436, 1.0520581113801453, 1.0156877115834293, 1.0207066733423933, 1.0266990291262137, 1.3786610878661087, 1.02018785855123, 1.0177053824362605, 1.0996261046906866, 1.051605221912686, 1.1, 1.1272727272727272, 1.0359756097560975, 1.0888577207107377, 1.023635254650808, 1.069451453563946, 1.1989445910290237, 1.2004530011325028, 1.0618359541011475, 1.0143542297357053, 1.1103220806373124, 1.0392202335479646, 1.0018115942028984, 1.043956043956044, 1.25, 1.0751384523274958, 1.0, 1.00355871886121, 1.0803019783271666, 1.0524942132363362, 1.5714285714285714, 1.0508474576271187, 1.2391857506361323, 1.0315533980582525, 1.0396968622775073, 1.0434782608695652, 1.287466417474594, 1.0126731858224958, 1.2494117647058824, 1.1, 1.5, 1.0188638799571275, 1.25, 1.0079974305444035, 1.0285714285714285, 1.2, 1.1115517418207925, 1.3478260869565217, 1.2857142857142858, 1.0030977952850149, 3.0, 1.0053191489361701, 1.0563035495716033, 1.0485706965338017, 1.0817073170731708, 1.1790281329923273, 1.11, 1.0978117644408907, 1.0995772027735498, 1.1111111111111112, 1.0202881772024772, 1.0656640673350661, 3.0, 1.0, 1.0552233690063602, 1.0, 1.0595348837209302, 1.35, 1.0, 1.263157894736842, 1.3864978902953586, 1.0699135899450118, 1.1142857142857143, 1.0429087624209576, 1.36, 1.5, 1.0828541866824328, 1.1, 1.3114754098360655, 1.0135585598795664, 1.0714285714285714, 1.0928074245939676, 1.0167597765363128, 1.0, 1.0, 1.23271375464684, 1.0625, 1.24, 1.1277077729010336, 1.2489790867466897, 1.0270935960591132, 1.3333333333333333, 1.0279826786374715, 1.066420664206642, 1.2666666666666666, 2.0, 1.0679611650485437, 1.2857142857142858, 1.021551724137931, 1.1730769230769231, 1.0805607391561605, 1.0828720452135001, 1.0061823802163834, 1.0510984807082742, 1.1087888531618435, 1.0427728613569323, 1.0855855855855856, 1.0719017519883074, 1.1163575042158516, 1.0, 1.005169678771741, 1.0574108960819013, 1.000459545624264, 1.0660377358490567, 1.0, 1.1882845188284519, 2.0, 1.1666666666666667, 1.3431372549019607, 1.1431297709923665, 1.1453488372093024, 1.2286902286902286, 1.0622631293990255, 1.1080312722103767, 1.0032563289078273, 1.0936429387133613, 1.029300196206671, 1.1666666666666667, 1.4893617021276595, 1.1550387596899225, 1.0, 1.1332909212561286, 1.4339622641509433, 1.1090256119459407, 1.0928469355350905, 1.0166774611398963, 1.139910076699286, 1.625, 1.1953199617956065, 1.0, 1.0185799601857997, 1.0, 1.2326551244787058, 1.0, 1.158207343412527, 1.1114864864864864, 1.0669992872416252, 3.0, 1.1284025295573274, 1.0078611185408786, 1.1931272135541304, 2.0, 1.21875, 1.2331482950039652, 1.2282282282282282, 1.0890002709292874, 1.0660633248135205, 1.04, 1.0479942693409743, 1.004967080914722, 1.0497797356828193, 1.044123594154744, 1.0927379975780305, 1.112970711297071, 1.2380952380952381, 1.0049683830171634, 1.11421591694116, 1.1043478260869566, 1.1602634467618003, 1.0, 1.5, 1.1174142480211082, 1.0520446096654275, 1.0546293011706278, 1.1106582578975217, 1.0403885480572597, 1.0, 1.1610169491525424, 1.1612903225806452, 1.0624107240962533, 1.391304347826087, 1.0, 1.0178724157253665, 1.3333333333333333, 1.0, 1.001908396946565, 2.0, 1.02144, 1.0037907505686126, 1.0414364640883977, 1.1818181818181819, 1.0671865142823609, 1.0692821368948247, 1.45, 1.0476761051901369, 1.1129032258064515, 1.0913043478260869, 1.0068027210884354, 1.3304195804195804, 1.0111116479056959, 2.0, 1.035294117647059, 1.0429887410440122, 1.1337396309463348, 1.0493237867939538, 1.0, 1.0895411480587034, 1.00795345069189, 1.0165145588874402, 2.0, 1.0619143239625168, 1.029448273774082, 1.019985510504884, 1.0354512137595704, 1.021131112056685, 1.0107718415934794, 1.0196767392832045, 1.0452465279159537, 1.5, 1.087770095073466, 1.1090610906109062, 1.0604355272816246, 1.02728285077951, 1.0618279569892473, 1.0175976712438213, 1.17595818815331, 1.078256988938829, 1.1766561514195584, 1.0968361976811118, 1.1168831168831168, 1.1221002743826392, 1.0881598793363498, 1.0227272727272727, 1.148936170212766, 1.0893522862722225, 1.0827886710239651, 1.0065647840531562, 1.0620328886192647, 1.3333333333333333, 1.2163187855787476, 1.3208092485549132, 2.0, 1.2156862745098038, 1.0136777454683805, 1.1510791366906474, 1.0858059342421813, 1.0, 1.4444444444444444, 1.0231481481481481, 1.1420122365737593, 1.0435588507877664, 1.0062822785785863, 1.1401043757527098, 1.0839598997493733, 1.0309119010819165, 1.056934533043748, 1.4550561797752808, 1.0346756586665837, 1.0044483985765125, 1.0643564356435644, 1.0852071715536367, 1.0532250789354984, 1.0009246298270171, 2.0, 1.042473454091193, 1.0565371024734982, 1.2009577561142466, 1.0798226164079823, 1.0483091787439613, 1.0476190476190477, 1.0380116959064327, 1.0809356750165786, 1.0, 1.3157894736842106, 1.2857142857142858, 1.0, 1.1730769230769231, 1.0454545454545454, 1.0051612903225806, 1.1061224489795918, 1.0556958660109, 1.0843123704215618, 1.016035957662752, 1.1750300697618474, 1.05011683184272, 1.07385053083334, 1.0166624100039119, 1.093681917211329, 1.0925925925925926, 1.054617432514932, 1.032972440944882, 1.068891280947255, 1.096774193548387, 1.0114285714285713, 1.103650402231475, 1.1470588235294117, 1.1021794341740003, 1.2857142857142858, 1.0621563471192923, 1.0435997764114031, 2.0, 1.054022988505747, 1.1176470588235294, 2.0, 1.2900763358778626, 1.0331430162929953, 1.0279642058165548, 1.020997375328084, 1.1263736263736264, 1.088658919556374, 1.0051192553810355, 1.082142857142857, 1.0, 1.0, 1.0555399245962522, 1.1341991341991342, 1.0535496957403652, 1.1016949152542372, 1.0, 1.3278388278388278, 1.2150776053215078, 1.0420682196070834, 1.1277533039647578, 1.0113947990543735, 1.068912316790949, 1.0072019365497626, 1.4222222222222223, 1.9375, 1.1967858314201378, 1.0, 1.0436835891381346, 1.205128205128205, 1.2232330300909726, 1.0664612676056338, 1.5, 1.1060674157303372, 1.1232876712328768, 1.2105263157894737, 1.1393217231897341, 1.2679045092838197, 1.1174934725848564, 1.0555451127819548, 1.0045495905368518, 1.0555555555555556, 1.1666666666666667, 1.0201355127665275, 1.0748209900031132, 1.0454545454545454, 1.0068352699931646, 1.2066381156316917, 1.0359712230215827, 1.0278652144442277, 1.2222222222222223, 1.0905861456483126, 1.0144006356142616, 1.0347222222222223, 1.089820359281437, 1.1256169444679471, 1.0227272727272727, 2.0, 1.1322046109510087, 1.0121457489878543, 1.109387396577128, 1.1846666666666668, 1.0073890797280742, 1.0404806683786032, 1.2046511627906977, 1.1219428177747157, 1.23463687150838, 1.034195082658893, 1.0708577517314863, 1.0316265060240963, 1.0777041942604857, 1.0374825883246803, 1.19377990430622, 1.0664152181042965, 1.1904761904761905, 1.125, 1.0845588235294117, 1.592157985117344, 1.0081453634085213, 1.0141509433962264, 1.0, 1.0192926045016077, 1.0299785867237687, 1.2771084337349397, 1.0882906006368727, 2.6666666666666665, 1.103056554429552, 1.5, 1.0460652591170825, 1.1538461538461537, 1.0602212839399636, 1.4193548387096775, 1.1620689655172414, 1.0812227074235807, 2.0, 1.2271512560128273, 1.3652830188679246, 1.2, 2.5, 1.181159420289855, 1.1952662721893492, 1.0117883120140456, 1.2103594080338267, 1.1194690265486726, 1.1191709844559585, 1.0528967254408061, 1.1375838926174497, 1.1875, 1.4381270903010033, 1.0689655172413792, 1.0, 1.0645454545454545, 1.1147342995169083, 1.0543103448275861, 1.0347352442182338, 1.0665346000663791, 1.088289508332393, 1.0872559070192558, 1.0610526315789475, 1.1787383177570094, 1.005469915464943, 1.625, 1.0, 1.2727272727272727, 1.0125407701448763, 1.088560885608856, 1.0824468085106382, 1.131336405529954, 1.0267236430894828, 1.0275643301306643, 1.0060088535383482, 1.069767441860465, 1.0952380952380953, 1.0, 1.0732165552301487, 1.1300195886385895, 1.0227889127719196, 1.0344827586206897, 1.0975023126734504, 1.1110481586402265, 1.1035768990752823, 1.099776619508563, 1.0606610884556078, 1.0031152647975077, 1.0600322320709106, 1.2002314814814814, 1.0333584049593294, 1.75, 1.147018030513176, 1.0, 1.0628683693516698, 1.0334044362652837, 1.032258064516129, 1.0911890209507125, 1.001763668430335, 1.263157894736842, 1.0734900456264698, 1.0120373156786038, 1.0599433650152803, 1.0496, 1.1109969167523124, 1.204624929498026, 1.1915641476274166, 1.1666666666666667, 1.0, 1.1111111111111112, 1.0660263380451855, 1.25, 1.1056842332214247, 1.1012014579489717, 1.0312731310140637, 1.066622691292876, 1.0425831451590422, 1.0074279577590837, 1.071651090342679, 1.0462085308056872, 1.0186642742128214, 1.1382507368297776, 1.0444942207984516, 1.291165971139826, 1.8571428571428572, 1.3034188034188035, 1.020066889632107, 1.1065058015355307, 1.0815217391304348, 1.328944328944329, 1.0537124802527646, 2.0701754385964914, 1.0705245183659637, 1.0977272727272727, 1.0529179622099976, 1.15, 1.0605528783697, 1.018810517587869, 1.3268566493955094, 1.0593815881939563, 1.2333333333333334, 1.134504875245616, 1.155015197568389, 1.0063901727828273, 1.0301204819277108, 1.0174872973330524, 1.2758620689655173, 1.0356648955528058, 1.1337579617834395, 1.06640625, 1.0769230769230769, 1.0126012601260126, 1.1328374070138152, 1.055393586005831, 1.0041618868264341, 1.079303675048356, 1.0968641114982578, 1.071943654974392, 1.0714285714285714, 1.0696202531645569, 1.0033892834086506, 1.0037511722413255, 1.029843444227006, 1.0498687664041995, 1.1843177189409368, 1.1082474226804124, 1.03242542153048, 1.0426999690579934, 1.087719298245614, 1.130071599045346, 1.2369782268735716, 1.0449902195174963, 1.039344262295082, 1.0730477494512183, 1.104274401444868, 1.1072874493927125, 1.072289156626506, 1.103584479572983, 1.0679090249993286, 1.1482059282371295, 1.0462962962962963, 1.0190703218116806, 1.1163575387006401, 1.1789473684210525, 1.6, 1.0522318393981964, 1.1666554612809101, 1.02722411278561, 1.0193236714975846, 1.171437179873456, 1.004587930482373, 1.1627363997198226, 1.0691864189622038, 1.2333333333333334, 1.0295924064768285, 2.0, 1.0936708860759494, 1.59375, 1.0413187714328314, 1.1598062953995156, 1.0985691573926868, 1.0612244897959184, 1.0193861066235865, 1.1004709576138147, 1.0192307692307692, 1.1666666666666667, 1.0440251572327044, 1.032520325203252, 1.005083179297597, 1.6923076923076923, 1.0197339925416495, 1.5, 1.001624506846136, 1.3035714285714286, 1.6666666666666667, 1.2436998854524628, 1.0175087908720837, 1.0120499731327244, 1.1130030959752322, 1.2272727272727273, 1.1764705882352942, 1.0256410256410255, 1.0105263157894737, 1.1728395061728396, 1.11481922924116, 1.0286672165157396, 1.0340969187519136, 1.3135593220338984, 1.0588201770133416, 1.0472513176329308, 2.5, 1.0924962630792228, 1.2352941176470589, 1.5, 2.75, 1.1517835178351783, 1.0758020989505248, 1.0863059006043891, 1.1949367088607594, 1.0, 1.1791044776119404, 1.0588235294117647, 1.0092592592592593, 1.0902226199798635, 1.1059187887130075, 1.0350900703208494, 1.0085926857382375, 1.8571428571428572, 1.042152164920022, 1.0549019607843138, 1.0546448087431695, 1.0642201834862386, 1.0068807339449541, 2.0, 1.0448296473401075, 1.1577290376744673, 1.0036495758381858, 1.060434372049103, 1.131578947368421, 1.1156696325546809, 1.1174628034455756, 1.1304347826086956, 1.2465753424657535, 1.018034757897038, 1.2982432967903843, 1.0425421330741023, 1.1975308641975309, 1.1300813008130082, 1.0557184750733137, 1.25, 1.073008179339594, 1.0, 1.00415063703148, 1.0357798165137615, 1.5, 1.0980207351555136, 1.005814652925372, 1.2496334310850439, 1.2274269100306898, 1.0029862379734502, 1.0896935933147631, 1.1154702576609055, 1.2209567198177675, 1.0526315789473684, 1.1173613390219888, 1.0835645769099007, 1.2180722891566265, 1.1649484536082475, 1.6666666666666667, 1.0114942528735633, 1.0345871405347833, 1.0566615620214395, 1.0117069834129144, 1.0767720844189315, 1.0180232558139535, 2.0, 1.0197095435684647, 1.0333854981742305, 1.1480431083380602, 1.3584905660377358, 1.082493421379276, 1.0, 1.1537753222836096, 1.0211718365337272, 1.0306089428558467, 1.0996983586006972, 1.0802707930367506, 1.0456100342075256, 1.027027027027027, 1.2164487267721955, 1.2126200274348422, 1.04049696394456, 1.0023081361800346, 1.109907120743034, 1.039092055485498, 1.03125, 1.2260869565217392, 2.0, 1.6666666666666667, 1.3157894736842106, 1.0149253731343284, 1.053735255570118, 1.0048145617195752, 1.0015246291731381, 1.1074977416440832, 1.0043759845965343, 1.1218487394957983, 1.0587002096436058, 1.0538122618797185, 1.6, 1.375, 1.0663615560640731, 1.0, 1.1468005018820577, 1.1248428990364474, 1.0379490376373413, 1.075643773197131, 2.0, 1.1620573791677435, 1.1018276762402088, 1.1532301019631714, 1.039690366972477, 1.1707060063224446, 1.1252893518518519, 1.1646085872889997, 1.0975729828188845, 1.0337381916329285, 1.5, 1.0790378006872852, 1.0, 2.0, 1.0414049753022954, 7.0, 1.3, 1.9411764705882353, 1.0368852459016393, 1.0325018523092122, 1.019818799546999, 1.0607287449392713, 1.1428571428571428, 1.1015285717790808, 1.026483570377636, 1.2401315789473684, 1.2938775510204081]
origin-bjaq_15.71 	max: 7.0000	99th: 2.5000	95th: 1.6440	median: 1.0826	mean: 1.1701

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.259840 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.417663