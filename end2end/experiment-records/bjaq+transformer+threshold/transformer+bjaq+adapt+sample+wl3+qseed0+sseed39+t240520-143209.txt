Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 39, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.6675	95th: 1.6939	median: 1.0838	mean: 1.1768
ReportEsts: [1.034920634920635, 1.0263020833333334, 1.0533396987977952, 1.1016949152542372, 1.5, 1.0, 1.0800910251429205, 1.0783730350081975, 1.0, 1.0064599483204135, 1.0803682220875537, 1.0430330086580086, 1.008044030482642, 1.1162790697674418, 1.0526315789473684, 1.0, 1.0222222222222221, 1.009656652360515, 3.0, 2.0, 1.08, 1.0696161653441594, 1.0951736346123808, 1.1068702290076335, 1.06660088801184, 1.0, 1.1496303208671308, 1.5, 1.2, 1.0145985401459854, 1.0, 1.0484365718946427, 1.0102510949264307, 1.042220936957779, 1.0168757467144565, 1.2209960735689191, 1.1764705882352942, 1.0168943277331675, 1.1664026448102487, 1.130952380952381, 1.236133122028526, 1.0, 1.0, 1.0156731830141172, 1.1194957692971852, 1.8615384615384616, 1.03, 1.2226148409893993, 1.0393331978044318, 1.0833333333333333, 1.0524034073623365, 1.104810996563574, 1.0395679253964003, 2.0, 1.1818181818181819, 1.2434515237613357, 1.0930047694753577, 1.3592233009708738, 1.018987341772152, 1.25, 1.0895810614322066, 1.0946450809464507, 1.0954545454545455, 1.0116279069767442, 1.0, 1.1161290322580646, 1.316112366806587, 1.75, 1.0, 1.0699170317889437, 1.030750307503075, 1.0615206035983749, 1.0398126463700235, 1.0484824066612946, 1.0705882352941176, 1.0285714285714285, 1.0, 1.113152400835073, 2.6666666666666665, 1.0130081537142275, 1.25, 1.0443126954891724, 1.1104294478527608, 1.041816009557945, 1.0986261040235525, 1.0, 1.0619000415694049, 1.0130343676378317, 1.1323529411764706, 1.75, 1.1321897073662968, 1.0493497479574851, 1.1308411214953271, 1.0042075736325387, 1.0138888888888888, 1.0649350649350648, 1.0305343511450382, 1.1389698736637512, 1.0, 1.2471622523926107, 1.0427927927927927, 1.0686106346483706, 1.2158486356615754, 1.3076923076923077, 1.0156143454638582, 1.0448632864348288, 1.31763115197404, 1.0769814182783466, 1.0462906192519927, 1.1666666666666667, 2.0, 1.0670560747663551, 1.0788212917275408, 1.069488313329122, 1.0405405405405406, 1.0584238874259175, 1.0, 1.0529801324503312, 1.1970217640320733, 1.0, 1.0167597765363128, 1.1666666666666667, 1.2105263157894737, 1.02768237079379, 1.0889958841345033, 1.12, 1.8, 1.1978476821192052, 1.0, 1.037037037037037, 1.1038329022298106, 1.3, 1.0236002604166667, 1.0292349915529402, 1.0755169944825844, 1.0173564753004005, 1.0369318181818181, 1.0405300077942323, 1.039972432804962, 1.0712979890310785, 1.014354066985646, 1.1172413793103448, 1.0313111545988258, 1.07615825534556, 2.0, 1.0145852324521423, 1.0137142857142858, 1.0869858395144976, 1.0993470972295747, 1.5, 1.225962702833616, 1.076555023923445, 1.0183299389002036, 1.1074561403508771, 1.0627737226277372, 1.0621307072515667, 1.087102997494889, 1.1552846798979006, 1.0154440154440154, 1.075657894736842, 1.2653061224489797, 1.3018867924528301, 1.0397643593519883, 1.4285714285714286, 1.0500822793737363, 1.0179033008257783, 1.1526211015262111, 1.3371204888294825, 1.1143635125936011, 1.0802523124221461, 1.303157894736842, 1.1497584541062802, 1.0976082114844583, 1.1061678463094033, 1.010462074978204, 1.1078717201166182, 1.0569782330345712, 1.1158568217188312, 1.0390186364708658, 1.0, 1.0793650793650793, 1.04900074019245, 1.0277113237639552, 1.1426759670259987, 1.0394736842105263, 1.085944120356156, 1.3103978473957332, 1.0918338636019307, 1.1372549019607843, 1.3068181818181819, 1.1281809125839295, 1.0, 1.5454545454545454, 1.0470118235745127, 1.0389150943396226, 1.0173545966228894, 1.4583333333333333, 1.0565916398713826, 1.0472671965963918, 1.04411296663796, 1.0626410835214446, 1.1350268788868978, 1.07909604519774, 1.103448275862069, 1.2, 1.0, 1.415929203539823, 1.118435577984545, 1.372822299651568, 1.367816091954023, 1.0108749382105784, 1.0031277926720286, 1.0149012380025038, 1.0287426478748196, 1.148429924666219, 1.1210191082802548, 1.0087463556851313, 1.0042125729099158, 1.0771583663622264, 1.0303388169160457, 1.0, 1.0691511387163561, 1.1405471411970929, 1.0094950326769057, 1.1399026763990268, 1.0077656746755617, 1.2738537794299876, 1.0357142857142858, 1.0063834154928588, 1.1357658586900463, 1.0197405527354766, 1.1566265060240963, 1.0899841736378024, 1.011605415860735, 1.2031496062992126, 2.0, 1.2356204379562044, 1.1255024564537741, 1.093061415846226, 1.112033195020747, 1.0, 1.6666666666666667, 1.0748667803942948, 1.0909090909090908, 1.0339292229113461, 1.5, 1.0, 1.0, 1.1069476971116314, 1.053763440860215, 1.0441988950276244, 1.1255274261603376, 1.0435510887772195, 1.0016792611251049, 1.18745281740578, 1.0175438596491229, 2.0, 1.093084942323114, 1.1317853537314593, 1.0595446584938704, 1.012744786704774, 1.1798513724080066, 1.0503540112663439, 1.0930047694753577, 1.098868017534285, 1.0322966507177034, 1.1288045183558206, 1.0648620374002877, 1.1818181818181819, 1.0051052277532193, 1.07816091954023, 1.2045454545454546, 1.4705882352941178, 1.0456273764258555, 1.0555555555555556, 1.1282051282051282, 1.1543099387658973, 1.0557103064066853, 1.3734335839598997, 1.029061477815986, 1.0492957746478873, 1.020032410324137, 1.0721502281182802, 1.1111111111111112, 1.0302109858130228, 2.5, 1.0319412687149028, 1.013129102844639, 1.036584588776114, 1.0526315789473684, 2.0, 1.4782608695652173, 1.0597014925373134, 1.0772176258051003, 1.0, 1.010819165378671, 1.092760180995475, 1.0072115384615385, 1.0150695831978067, 1.111764705882353, 1.1383647798742138, 1.0165741907238142, 1.0992380656196548, 1.1026059350059527, 1.1111111111111112, 1.0, 1.1205250596658711, 1.2530864197530864, 1.1030927835051547, 1.1465880370682393, 1.0046082949308757, 1.1234177215189873, 1.2553191489361701, 1.0027510316368637, 1.0535471595542267, 1.2857142857142858, 1.0009186391891478, 1.0360531309297913, 1.2666666666666666, 1.0870183887915936, 1.380952380952381, 1.2727272727272727, 1.0082081193600878, 2.0, 1.1755829903978052, 1.0276162790697674, 1.0976210008203446, 1.0970954356846474, 1.0521978021978022, 1.1973684210526316, 1.094157117926379, 1.0752172537182638, 1.0530846484935437, 1.0232841080718242, 1.0980901451489686, 2.0, 1.0, 1.0494869626819625, 1.25, 1.068561872909699, 1.3529411764705883, 1.0, 1.4666666666666666, 1.4096385542168675, 1.0530232558139534, 1.205607476635514, 1.0681818181818181, 1.0, 1.2290279627163783, 1.0921334104699503, 2.0, 1.318046456223943, 1.0, 1.0981249525544674, 1.1125, 1.0587581608556744, 1.1612903225806452, 1.1363636363636365, 1.212809917355372, 1.3981481481481481, 1.0326589016822485, 1.0195271650426607, 1.0622347949080622, 1.0, 1.0769230769230769, 1.5714285714285714, 1.5, 1.4545454545454546, 1.069224702534033, 1.3333333333333333, 1.0100840336134453, 1.2317073170731707, 1.197651128914785, 1.0700515315598107, 1.2523171987641606, 1.014310678694564, 1.009860788863109, 1.069047619047619, 1.5, 1.170731707317073, 1.0851063829787233, 1.0480202533294258, 1.0952380952380953, 1.5714285714285714, 1.0356347438752784, 1.0201660735468565, 1.0262502441883181, 1.0174563591022443, 1.1464387464387464, 1.025718194254446, 1.1111111111111112, 1.0907770515613653, 1.0328389830508475, 1.25, 1.028328611898017, 1.1081081081081081, 1.056451233104661, 1.0505817646957825, 1.0270017824089943, 1.0617283950617284, 1.1808510638297873, 1.0914634146341464, 1.0, 1.0249559185039319, 1.0445086550552478, 1.0099876000450907, 1.0617862702458618, 1.0938186382177597, 1.1477597712106768, 1.8333333333333333, 1.014954172696575, 1.0, 1.1921434671221178, 1.25, 1.0311416359022336, 1.0058309037900874, 1.0984522785898538, 1.1462450592885376, 1.0844212358572671, 3.0, 1.1612244897959183, 1.0067782327132166, 1.0937097664153026, 2.0, 1.0327868852459017, 1.2821497120921306, 1.2747252747252746, 1.1027729778655475, 1.1912681912681913, 1.2352941176470589, 1.2105263157894737, 1.011896136677028, 1.0413775678774804, 1.115597969622888, 1.1210526315789473, 1.0132669983416251, 1.1590909090909092, 2.142857142857143, 1.1225071225071226, 1.4444444444444444, 1.2278056951423786, 1.03125, 1.1626882567181809, 1.6666666666666667, 1.0757290827139487, 1.0958600422760316, 1.0308451573103024, 1.0, 1.175257731958763, 1.12, 1.2854641856742697, 1.135667396061269, 1.0, 1.023400494874514, 1.1068897816957262, 1.0559469539991713, 1.5, 3.0, 1.0097087378640777, 1.0090415913200723, 1.0557377049180328, 1.1111111111111112, 1.0758026027482324, 1.0464426877470356, 1.4705882352941178, 1.044406779661017, 1.0454545454545454, 1.0879265091863517, 1.0193548387096774, 1.326882625157762, 1.0436736161035227, 1.0, 1.0571428571428572, 1.043790245239074, 1.0375439215749194, 1.010518297624064, 1.0, 1.0625967706259678, 1.0157535123634538, 1.0214772132006287, 2.0, 1.0454545454545454, 1.016704958835918, 1.0052679866228655, 1.0006989646585995, 1.0106301634733696, 1.0292347784885099, 1.0110450297366185, 1.18900675024108, 2.0, 1.000981962892139, 1.48, 1.25, 1.1709844559585492, 1.1538461538461537, 1.0124904144300337, 1.136100386100386, 1.0276296423724602, 1.070215695273061, 1.088875830915568, 1.1032057351548763, 1.0514580949408787, 1.197674418604651, 4.0, 1.0026119313407753, 1.1704453441295546, 1.047243720902648, 1.0263281572208207, 1.1070522577371893, 1.1157969978556113, 2.580246913580247, 2.4285714285714284, 1.007425622048011, 1.017882410615801, 1.0012753687479206, 1.129677658391997, 1.0770825298881603, 1.0589519650655022, 1.0778916299467256, 1.0469255663430421, 1.218944099378882, 2.0, 1.1666666666666667, 1.0365659777424483, 1.0700757575757576, 1.1098696461824953, 1.1997146932952925, 1.0274509803921568, 1.3006535947712419, 1.148905109489051, 1.103030303030303, 1.047173384770485, 1.2417582417582418, 1.000523536023898, 2.0, 1.1736930860033727, 1.0, 1.5326086956521738, 1.0868715083798883, 1.0542099192618224, 1.0541666666666667, 1.0311284046692606, 1.11765174234985, 1.0, 1.2553191489361701, 1.2, 1.5, 1.1477272727272727, 1.0806451612903225, 1.0188679245283019, 1.1601941747572815, 1.0648830503043896, 1.060324825986079, 1.0389735193621867, 1.2069498988456504, 1.0442890442890442, 1.1273881869453066, 1.0054054054054054, 1.1388140161725067, 1.0493468795355587, 1.054308093994778, 1.0115606936416186, 1.1332925710791806, 1.0214868494400242, 1.2380735165545291, 1.081131162439364, 2.0, 1.040920716112532, 1.0874371859296483, 1.4205607476635513, 1.0, 1.0851063829787233, 1.3636363636363635, 1.082375478927203, 1.2962962962962963, 1.1666666666666667, 1.0201923076923076, 1.1107163301158682, 1.0295403398949792, 1.029848425961912, 1.2216216216216216, 1.1061827956989247, 1.0, 1.0921985815602837, 1.0306917718463342, 1.05143836162244, 1.0842864959224616, 1.082298667274177, 1.0183162187750345, 1.161038961038961, 1.109286570000413, 1.1296625222024868, 1.0489943269726663, 1.089139479282366, 1.303030303030303, 1.0691489361702127, 1.0, 1.2422535211267605, 1.2072965426623963, 3.0, 1.0858977197254815, 1.1039459872125204, 1.4285714285714286, 1.0278436018957346, 1.3, 1.0555555555555556, 1.0862624724010863, 1.6923076923076923, 1.022158974173042, 1.0324647586501494, 1.3571428571428572, 1.0740740740740742, 1.1257731958762887, 1.0239120038259206, 1.0019867549668875, 1.0666066895864794, 1.155771078274395, 1.0, 1.1290462741690201, 1.1097560975609757, 2.0, 1.0043084478006068, 1.1185742711307207, 1.1239356669820246, 1.025546817791079, 1.0137183577698048, 1.1414141414141414, 1.4285714285714286, 1.0486637415237337, 1.0048387096774194, 1.1316919213343968, 1.2322235922729141, 1.0232836560293936, 1.0896501762353892, 1.1611721611721613, 1.1176715176715177, 1.2073578595317727, 1.0643912029086775, 1.089589905362776, 1.0806159420289856, 1.146533613445378, 1.0637232505011889, 3.0, 1.1375911483574657, 1.007465134541406, 1.0221706750001343, 1.5833333333333333, 1.2656575475628384, 1.2843601895734598, 1.1428571428571428, 1.0700077590463426, 1.0420575865415722, 1.1441048034934498, 1.2352941176470589, 1.3333333333333333, 1.0748694521765314, 1.5, 1.0116822429906542, 1.0833333333333333, 1.0850254692624381, 1.44, 1.248945147679325, 1.039832285115304, 1.0, 1.6402116402116402, 1.2212460063897763, 1.25, 2.0, 1.1083333333333334, 1.193103448275862, 1.0237370663420573, 1.2078580481622307, 1.0921501706484642, 1.3126843657817109, 1.1014466214978942, 1.0597402597402596, 1.1893203883495145, 1.110204081632653, 1.0769230769230769, 1.0, 1.3378196500672948, 1.0187590187590188, 1.003099173553719, 1.0686904268545379, 1.089694425895895, 1.0227128536987693, 1.0917499184774553, 1.1634253903990746, 1.1573816155988859, 1.0023866348448687, 1.5714285714285714, 1.0, 1.2142857142857142, 1.0508234044167868, 1.0767872903795235, 1.107843137254902, 1.3904109589041096, 1.0150439098892707, 1.0751837521395797, 1.0106292189526676, 1.1304347826086956, 1.2222222222222223, 1.0416345412490362, 1.0918610816542949, 1.0765439831220847, 1.023442361280199, 1.0, 1.1119314825753102, 1.0228044767291973, 1.306020066889632, 1.3156822810590632, 1.0, 1.0884520884520885, 1.7242718446601941, 1.1304347826086956, 1.1762820512820513, 1.0701001430615165, 1.0, 1.0115473441108545, 1.0296277129087557, 1.0, 1.0759996497345148, 1.0370762711864407, 1.3870967741935485, 1.0150276080032465, 1.0352919971160779, 1.0829640075208165, 1.041030534351145, 1.0556186152099887, 1.1950431034482758, 1.1839323467230445, 1.2142857142857142, 1.0, 1.4285714285714286, 1.0700012110936175, 1.3333333333333333, 1.1348744641763626, 1.1122448979591837, 1.0066904549509366, 1.0951340615690168, 1.0550105799196627, 1.1658092175777064, 1.025089605734767, 1.0346740638002774, 1.008744452532463, 1.0793025871766029, 1.041237216313207, 1.2075454654943996, 1.6666666666666667, 1.032258064516129, 1.0671936758893281, 1.1079413497868211, 1.0684039087947883, 1.281545528235612, 1.044362292051756, 2.220779220779221, 1.0546285168407754, 1.0818791946308726, 1.0436602870813396, 1.125, 1.0883498458569647, 1.0316493256426569, 1.2615614122327201, 1.0581052631578947, 1.3333333333333333, 1.1748427672955974, 1.0923913043478262, 1.625, 1.0518153103595131, 1.6923076923076923, 1.1508120649651972, 1.0756501182033098, 1.0188806473364802, 1.0532009221493173, 1.0119047619047619, 2.75, 1.061611374407583, 1.1045259016875622, 1.0532974054114117, 1.0023596212154229, 1.043085251259703, 1.0656975021352995, 1.1818181818181819, 1.1143359718557608, 1.0217564870259481, 1.027807094021016, 1.0170340681362726, 1.0208333333333333, 1.0040577096483319, 1.0258183202232936, 1.3728813559322033, 1.0080907571893414, 1.0, 1.3333333333333333, 1.043269302084106, 1.0093736685129953, 1.2337582334265271, 1.1244370308590492, 1.0590582601755787, 1.0613207547169812, 1.118904692905935, 1.0812432732135286, 1.1102941176470589, 1.1144578313253013, 1.0577777777777777, 1.086928778284985, 1.0952380952380953, 1.75, 1.0387263061805294, 1.1746739095078556, 1.0132871172732525, 1.0170454545454546, 1.2165097755249819, 1.0265241008144241, 1.1773966825976947, 1.5037593984962405, 1.3076923076923077, 1.0619946091644206, 1.0894495412844036, 1.14375, 1.5357142857142858, 1.0380712928818863, 1.1744301288404362, 1.1650082918739635, 1.025, 1.025318487310663, 1.047637341529005, 1.0669678714859439, 1.2596553773024362, 1.3333333333333333, 1.0769230769230769, 2.0, 1.1452455590386625, 1.4230769230769231, 1.0, 1.1538461538461537, 1.03841059602649, 1.1123188405797102, 1.0239568459463748, 1.051826663763212, 1.1472727272727272, 1.3333333333333333, 1.1428571428571428, 1.064516129032258, 1.0945945945945945, 1.0714285714285714, 1.1282952548330405, 1.0323612246138467, 1.0291640384401322, 1.3195876288659794, 1.09750176100887, 1.0474801061007957, 2.5, 1.0704382293899493, 1.2477718360071302, 3.0, 2.0, 1.2668639053254438, 1.1709101341174784, 1.0860235914946454, 1.2515527950310559, 1.0, 1.131578947368421, 1.343558282208589, 3.0, 2.0, 1.0019685039370079, 1.152977550746068, 1.0378679808066398, 1.6666666666666667, 1.0278178306172974, 1.053446940356313, 1.1181192660550459, 1.0, 1.0704225352112675, 1.0225825966205162, 1.2236842105263157, 1.1618518985744923, 1.023603110878377, 1.25, 1.1015625, 1.0970247359434262, 1.0782688766114181, 1.0537190082644627, 1.1311475409836065, 1.0470007300287911, 1.411845967881195, 1.0563508878718, 1.2035928143712575, 1.1666666666666667, 1.2985074626865671, 1.0926430517711172, 1.062323833385531, 1.0247108038170827, 1.0546158267867407, 1.0382096069868996, 1.5, 1.6666666666666667, 1.018602569839545, 1.1618293755496922, 1.1104843415677883, 1.0155189553392816, 1.0063962295909779, 1.1524473073046755, 1.3824451410658307, 1.0208333333333333, 1.0730288499331813, 1.0846910891495962, 1.2026931254429483, 1.0959692898272553, 2.5, 1.0273972602739727, 1.0243508323625568, 1.1670384829894032, 1.0049138132750954, 1.0912161291154252, 1.0113636363636365, 2.0, 1.089058524173028, 1.0544928075541034, 1.1814027872972355, 1.0570342205323193, 1.0925177609307204, 1.0222929936305734, 1.3940397350993377, 1.022525192649674, 1.031096788709496, 1.0562757807896288, 1.0138248847926268, 1.0597014925373134, 1.0, 1.2191666666666667, 1.0563579851906024, 1.0528511821974966, 1.067356329713744, 1.1133828996282529, 1.0408472012102874, 1.2857142857142858, 1.2233766233766235, 1.6666666666666667, 2.0, 1.1176470588235294, 1.0, 1.0260663507109005, 1.0660306401171766, 1.0112997733202174, 1.0979647218453188, 1.0868200836820083, 1.1793478260869565, 1.0888888888888888, 1.0491662983929235, 1.6, 1.5, 1.1263736263736264, 1.0, 1.0547752808988764, 1.1363636363636365, 1.0753492564218117, 1.1015808865300027, 2.0, 1.0721362229102167, 1.1356589147286822, 1.0404774260508562, 1.0398864188922632, 1.1590909090909092, 1.1342465753424658, 1.1469891896721165, 1.1080243233575773, 1.0254372019077902, 1.1639344262295082, 1.1047486033519553, 1.0, 1.0, 1.0417277636708273, 5.0, 1.5714285714285714, 2.076923076923077, 1.0530759951749096, 1.0804597701149425, 1.1208425720620843, 1.0831698705374657, 1.0, 1.054003724394786, 1.0157710280373833, 1.1554404145077721, 1.2692307692307692, 1.4285714285714286, 1.018918918918919, 1.2211751662971175, 1.1368653421633554, 1.1126812941613984, 1.0249941192256593, 1.0090509902320997, 1.1097308488612836, 1.0, 1.2087828404619876, 1.0393496662646198, 1.036092180774749, 1.1774193548387097, 1.080369658896215]
origin-bjaq_15.71 	max: 5.0000	99th: 2.6675	95th: 1.6939	median: 1.0838	mean: 1.1768

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 13.953838 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[ 0.0000000e+00  1.1920929e-07 -2.9802322e-08  2.3841858e-07
  1.7881393e-07]
Distance score: 1.01327898960335e-07
SAUCE Drift detection: False
Detection latency: 0.0232s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.050957 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 3.0000	95th: 1.8264	median: 1.0816	mean: 1.1854
ReportEsts: [1.0188679245283019, 1.0139707487448155, 1.0314857132520967, 1.0856164383561644, 1.6956521739130435, 1.0, 1.052314064469656, 1.070466668261296, 1.1666666666666667, 1.001086956521739, 1.1001631008346926, 1.043104711864789, 1.0427413411938098, 1.1080550098231827, 1.0405405405405406, 1.3425196850393701, 1.1360759493670887, 1.121212121212121, 1.0833333333333333, 1.0831987075928917, 1.1055738449313202, 1.0748025651683393, 1.0999131190269331, 1.0025083612040133, 1.0161849914584105, 1.023095648384165, 2.0, 1.1717239282456673, 1.5, 1.4, 1.3060344827586208, 1.0, 1.0404198474681248, 1.0091751579141501, 1.0018552875695732, 1.044150110375276, 1.244186046511628, 1.1345291479820627, 3.0, 1.0300342911197824, 1.0377376608411752, 1.0106494832972843, 1.306686046511628, 1.099016480595428, 1.0293040293040292, 1.0417369448027252, 1.1666666666666667, 1.0180722891566265, 1.1294642857142858, 1.0079312623925976, 1.2222222222222223, 1.2127659574468086, 1.0159362549800797, 1.0303030303030303, 1.0327499353376606, 1.0105913867710694, 1.0153911324484608, 1.2219178082191782, 1.10989010989011, 1.055029818888044, 1.303030303030303, 1.1163053046294793, 1.0647590361445782, 1.0881226053639848, 1.0196078431372548, 1.4285714285714286, 1.0663938713349537, 1.3717877094972066, 3.0, 1.0, 1.0175643118053936, 1.0141129032258065, 1.0617704280155642, 1.0194174757281553, 1.105899438709424, 1.0508625817965496, 1.046622949005285, 1.0751173708920188, 1.4757281553398058, 1.0547877546167144, 1.062922516900676, 1.0465116279069768, 1.0, 1.3333333333333333, 1.100811123986095, 1.1129032258064515, 1.1055363321799307, 1.46875, 2.0, 1.090906175848137, 1.1121467227901383, 1.2723947783029486, 1.076506501136741, 1.1257608390298717, 1.061381074168798, 1.0081775700934579, 1.102803738317757, 1.0013192612137203, 1.1666666666666667, 1.32085346215781, 1.0333333333333334, 1.5, 1.057055492445272, 1.1740976645435244, 1.0824295010845988, 1.2181531515390405, 1.4137931034482758, 1.0155686239598662, 1.0338271059031616, 1.0600311379847207, 1.0943037974683545, 1.0593725693544205, 1.2857142857142858, 1.0714285714285714, 1.0418213797146765, 1.0623560969652008, 1.037716081718177, 1.2183908045977012, 1.0609429483678527, 2.0, 1.1517951425554382, 1.148487626031164, 1.0, 1.0869565217391304, 1.125, 1.1379310344827587, 1.0274203530694646, 1.0367542383848842, 1.0491803278688525, 1.8333333333333333, 1.1708008504606662, 1.0, 1.25, 1.1367781155015197, 1.0833333333333333, 1.0699469368065606, 1.006417194989949, 1.099018413699219, 2.5, 1.3571428571428572, 1.0262096774193548, 1.020316027088036, 1.074167507568113, 1.032690625328061, 1.3265306122448979, 1.020902090209021, 1.133878369753518, 3.0, 1.0192889561270801, 1.0339943342776203, 1.0917792792792793, 1.0967408936734995, 2.0, 1.2839506172839505, 1.034928848641656, 1.040885860306644, 1.1598062953995156, 2.0, 1.0131379484588177, 1.1511828900183174, 1.0800374348958333, 1.0278688524590165, 1.048913043478261, 1.2833333333333334, 1.2173913043478262, 1.062261753494282, 1.2222222222222223, 1.0791129684876741, 1.3181818181818181, 1.0347826086956522, 1.2738287314682335, 1.113861386138614, 1.0108364939774102, 1.2744425385934819, 1.1187739463601531, 1.0563505538038644, 1.1362515413070284, 1.0374174614820248, 1.0936205468102733, 1.0459709379128137, 1.069837868058144, 1.234634082249376, 1.3225806451612903, 1.228125, 1.0033592497521104, 1.1006441223832528, 1.322695035460993, 1.1567502737654483, 1.0121654501216546, 2.0, 1.1983240223463687, 1.0678611293969489, 1.4, 1.1217088922006955, 1.1174619409149915, 1.0617364179880426, 1.0421392433738579, 1.0885572139303483, 1.0111846583573927, 1.043708609271523, 1.004989604989605, 1.0443794022463355, 1.0083932853717026, 1.0627782388893081, 1.0681711330512458, 1.0804557096175924, 1.3526570048309179, 1.1285714285714286, 1.1851851851851851, 1.0, 1.3333333333333333, 1.2126848504765035, 1.2729885057471264, 1.2647058823529411, 1.0156636438582027, 1.1428571428571428, 1.0393385340775243, 1.045045045045045, 1.2313414926805855, 1.5, 1.0299251870324189, 1.0270494065691416, 1.0319625407166124, 1.0209495572114071, 2.0, 1.17578125, 1.1080002627344083, 1.0488748134839672, 1.0263852242744063, 1.0626057529610828, 1.0808561236623069, 1.0924115456238361, 1.4152542372881356, 1.0055305538514852, 1.0391007749323304, 1.1093247588424437, 1.0641373080397472, 1.006741573033708, 2.0, 1.1368352788586251, 1.0, 1.1814609338881183, 1.1529741077676696, 1.2441655226515003, 1.1618705035971224, 1.0714285714285714, 1.5, 1.0730442426018165, 1.0895522388059702, 1.0722051693967125, 1.4, 1.094011590470058, 1.1144114411441144, 1.125, 1.005182818601349, 1.0396270396270397, 1.106420404573439, 1.0352348993288591, 1.0034952813701503, 1.0749083628025642, 1.096774193548387, 2.0, 1.0910128167733302, 1.104332953249715, 1.1004431314623337, 1.0156487604767126, 1.0716897154665395, 1.0555523548898171, 1.0858257477243174, 1.0717435574373324, 1.0129288910989558, 1.1024884556182657, 1.0757324488667772, 1.1538461538461537, 1.0273420636062742, 1.176595744680851, 1.2857142857142858, 1.4, 1.5430809399477807, 1.071097372488408, 1.0657015794000841, 1.0039924353855851, 1.1220657276995305, 1.338877338877339, 1.0099616220555696, 1.1313766596785464, 1.0430970398185389, 1.0595521877795313, 1.3333333333333333, 1.00139470013947, 1.0743374272786037, 1.1018736100982272, 1.0857847912202092, 1.0684388275925303, 1.1719914802981897, 1.1846153846153846, 1.0273056957974827, 1.0840579710144929, 1.0995921019384183, 1.0715089456509508, 1.0653218059558118, 1.0625, 1.1538461538461537, 1.075400989356918, 2.0, 1.0143112701252237, 1.0691091741763923, 1.0193896476142303, 1.2926829268292683, 1.0555555555555556, 1.0926935659760086, 1.0022592978797358, 1.025569825292144, 1.0434782608695652, 1.1971649484536082, 1.0403535061131355, 1.1078947368421053, 1.6666666666666667, 3.2857142857142856, 1.0184142114384749, 1.4285714285714286, 1.0120231691112918, 1.0657051282051282, 1.3157894736842106, 1.1317147227358857, 1.1923076923076923, 1.4166666666666667, 1.0027755470081858, 2.0, 1.0168918918918919, 1.0485074626865671, 1.035456336178595, 1.10138960370561, 1.1168224299065421, 1.11, 1.0953954416789777, 1.1361177864274834, 1.0142857142857142, 1.063322523885003, 1.051985164467684, 1.5, 1.1111111111111112, 1.0439387733719412, 1.2, 1.0684039087947883, 1.4, 1.0, 1.3333333333333333, 1.3051409618573797, 1.062402496099844, 1.3596491228070176, 1.0867665418227217, 1.3466666666666667, 1.3333333333333333, 1.0462297543709107, 1.1428571428571428, 1.1343283582089552, 1.002699762852047, 1.0377358490566038, 1.0136986301369864, 1.0132200188857412, 1.1666666666666667, 1.0, 1.4553571428571428, 1.3928571428571428, 1.0305810397553516, 1.1293998061603197, 1.2413921690490988, 1.0146341463414634, 1.5, 1.025716622379515, 1.0851063829787233, 1.826086956521739, 2.3333333333333335, 1.1621160409556315, 1.2857142857142858, 1.1226215644820297, 1.2755102040816326, 1.1727549279054237, 1.0579828204438173, 1.1277777777777778, 1.1141137855579868, 1.1089666264575795, 1.0211581291759466, 1.1, 1.1188665683047705, 1.076797385620915, 1.0, 1.001500028302421, 1.073733069548014, 1.0357955001471415, 1.0240384615384615, 1.0238095238095237, 1.1117764471057885, 2.0, 1.1041666666666667, 1.0, 1.121904761904762, 1.412162162162162, 1.0627450980392157, 1.120603015075377, 1.1025641025641026, 1.0315882997351828, 1.1151189562547967, 1.0859312074998348, 1.029126213592233, 1.208695652173913, 1.1302083333333333, 1.0, 1.131024046480289, 1.5769230769230769, 1.1049461959599773, 1.0282045853245418, 1.0857117995127046, 1.1476793248945147, 1.8571428571428572, 1.347498655190963, 1.0, 1.04539600772698, 1.2727272727272727, 1.0609838439784325, 1.0390720390720392, 1.168018018018018, 1.1114864864864864, 1.0696022727272727, 3.0, 1.2192878338278932, 1.0147091637962211, 1.0749722466791716, 3.0, 1.0769230769230769, 1.2814516129032258, 1.2530864197530864, 1.0895779791694846, 1.161601716124419, 1.0416666666666667, 1.1617752326413744, 1.0001751143107307, 1.0758344638161752, 1.1622902523376457, 1.0188857986081592, 1.0180729696148199, 1.1333333333333333, 1.0308613542146476, 1.0866143309168101, 1.1101694915254237, 1.2490421455938698, 1.0, 1.5, 1.1261889663918834, 1.1124497991967872, 1.013256288239293, 1.0819528706452677, 1.0781169167097775, 2.0, 1.1478260869565218, 1.096774193548387, 1.1097572799844866, 1.0, 1.0, 1.0387751295612901, 1.0, 2.0, 1.010180995475113, 3.6666666666666665, 1.0182707993474716, 1.0098187311178248, 1.0381471389645776, 1.2, 1.0765520863383855, 1.1070811744386875, 1.55, 1.0585123134093342, 1.069767441860465, 1.0993449781659388, 1.0362021857923498, 1.3391273501241574, 1.1223601483153314, 1.0, 1.0, 1.0259997360432889, 1.118581702625857, 1.0606060606060606, 1.5, 1.0713622003345102, 1.0155247219228223, 1.0381205673758864, 2.0, 1.0421506803849983, 1.0351968344155844, 1.0640745201169908, 1.0400510204081632, 1.020432541179429, 1.013158517273337, 1.0255500354861604, 1.1004591368227732, 2.0, 1.1036461704422869, 1.0445969125214407, 1.0569145071445871, 1.0077262693156732, 1.032, 1.0219084070212485, 1.0070422535211268, 1.0575133084696058, 1.037037037037037, 1.0536276047059752, 1.2953125, 1.121552884855134, 1.0694790957889166, 1.0340909090909092, 1.1704545454545454, 1.0909131219713046, 1.0288659793814432, 1.023685182254576, 1.0614793420064925, 1.3333333333333333, 1.26536846124475, 1.6920821114369502, 1.0, 1.037037037037037, 1.017931166139413, 1.1470588235294117, 1.0117975117975118, 2.0, 1.03125, 1.0029398462234282, 1.196014647023759, 1.0432593697557337, 1.037300836295747, 1.1118935837245696, 1.0939597315436242, 1.0304752066115703, 1.0286983052895509, 1.449438202247191, 1.0129757248401317, 1.0156839965146673, 1.0845771144278606, 1.0950441126818455, 1.0924269528920691, 1.023257953037331, 3.0, 1.2402069475240207, 1.0819672131147542, 1.0409823182711198, 1.1152993348115299, 1.0120593692022264, 1.0403877221324718, 1.245014245014245, 1.099412148922273, 1.0, 1.2622950819672132, 1.0, 1.3333333333333333, 1.2211538461538463, 2.610169491525424, 1.028169014084507, 1.1031746031746033, 1.0795577130528586, 1.0598484848484848, 1.0669980483044645, 1.1618648507071765, 1.0633558719218752, 1.1386287371545536, 1.0053374972924567, 1.1166484118291347, 1.1390811831340466, 1.0591199342479611, 1.0103550295857988, 1.058252427184466, 1.054524361948956, 1.0238095238095237, 1.0152023612178063, 1.1221973094170403, 1.1000826316203667, 1.3352272727272727, 1.1253314051578693, 1.4166666666666667, 2.0, 1.0480656506447832, 1.0, 1.75, 1.4910714285714286, 1.0417894392217388, 1.0388093443858326, 1.0076530612244898, 1.0994475138121547, 1.103108843080642, 1.043562851497188, 1.1517367458866545, 1.2, 1.6666666666666667, 1.0180611467740182, 1.105726872246696, 1.0992304576751721, 1.1117578579743888, 2.0, 1.3007883565797453, 1.150214592274678, 1.0291760641105618, 1.1449925261584455, 1.0419752164128233, 1.0597403866512485, 1.0019640860322059, 1.5, 2.0, 1.1239733059548254, 2.0, 1.0057603686635945, 1.1921397379912664, 1.3183391003460208, 1.0763636363636364, 1.44, 1.0352078125365045, 1.064748201438849, 1.0817438692098094, 1.0326975476839237, 1.2390463917525774, 1.124031007751938, 1.068675543097407, 1.0080862533692723, 1.053125, 1.2, 1.000497893527384, 1.0766542081949058, 1.3333333333333333, 1.0082872928176796, 1.2177641955835963, 1.090128755364807, 1.0019402405898332, 1.3333333333333333, 1.0902654867256638, 1.0642417131123496, 1.353211009174312, 1.1111111111111112, 1.0848461754806165, 1.0916666666666666, 2.0, 1.123321554770318, 1.0161507402422612, 1.0509102216191768, 1.1495357028498239, 1.0075499245968091, 1.019593237092136, 1.0890625, 1.0816119200812733, 1.2437673130193905, 1.0666056815091354, 1.085456475583864, 1.031347962382445, 1.1085613415710502, 1.0910887893823873, 1.0704225352112675, 1.0845093268450932, 1.3, 1.3333333333333333, 1.1303258145363408, 1.615630447414294, 1.052566096423017, 1.1484848484848484, 1.0769230769230769, 1.007311129163282, 1.0304789550072568, 1.0232558139534884, 1.0387712926281678, 2.3333333333333335, 1.1320699203876774, 2.0, 1.0403846153846155, 1.2, 1.0551350721937587, 1.3870967741935485, 1.1038062283737025, 1.0719237435008666, 1.0, 1.0652472527472527, 1.3311546840958606, 1.5, 2.5, 1.1172413793103448, 1.3100303951367782, 1.0081885856079404, 1.1844559585492227, 1.1443001443001444, 1.1857638888888888, 1.0121065375302662, 1.0, 1.1847389558232932, 1.2937062937062938, 1.064516129032258, 1.0, 1.214139344262295, 1.054245283018868, 1.025108225108225, 1.0802249297094657, 1.063680599006138, 1.101635602890833, 1.072776496912531, 1.225716956665963, 1.116780045351474, 1.0024727992087044, 1.625, 1.0, 1.1818181818181819, 1.0327226952418305, 1.1038575667655786, 1.0824468085106382, 1.0650759219088937, 1.0154494382022472, 1.0321578911048237, 1.019979476335593, 1.0465116279069768, 1.1904761904761905, 1.3020833333333333, 1.003981199889411, 1.0776088240546147, 1.0493768642049528, 1.023121387283237, 1.0279015095273447, 1.0184804212141287, 1.0884207397762413, 1.0550256786500367, 1.0622903539295903, 1.1024844720496894, 1.0345899727944035, 1.1397379912663756, 1.032888913141014, 1.0, 1.0627615062761506, 1.0, 1.1040816326530611, 1.0396027103236396, 1.1692307692307693, 1.0482543475375017, 1.0108108108108107, 1.186046511627907, 1.006305939788446, 1.027063558812928, 1.0757197723641052, 1.0725938009787928, 1.0983763132760267, 1.1991397970370787, 1.1950354609929077, 1.0588235294117647, 2.0, 1.4444444444444444, 1.0637855932886988, 1.25, 1.0605854322668482, 1.1152054119439094, 1.0397592558818165, 1.0608579980046557, 1.0564520917198057, 1.0758768790264854, 1.0267857142857142, 1.0091428571428571, 1.0009003965659657, 1.1263048630016255, 1.0435959122578062, 1.1776494224008036, 1.75, 1.0635118306351183, 1.0858085808580857, 1.1234323527711958, 1.0591549295774647, 1.2791115099842945, 1.0824088748019018, 2.1403508771929824, 1.0363775136880882, 1.08, 1.0561252992817238, 1.0, 1.0633046789134872, 1.0247269053036192, 1.2859560067681894, 1.0714285714285714, 1.15625, 1.076222038111019, 1.0254524054730028, 1.0300774553996572, 1.3950617283950617, 1.0180910012885398, 1.048780487804878, 1.008574870668273, 1.024329382407985, 1.0074906367041199, 1.0046685340802988, 1.0314748201438848, 1.0719211822660097, 1.0681592039800996, 1.014840231778363, 1.0774443368828654, 1.0408887229275579, 1.05395541314328, 1.2142857142857142, 1.0644475920679888, 1.0183859420761472, 1.1008273009307135, 1.0792, 1.0981432360742707, 1.2, 1.0836550836550836, 1.0528350515463918, 1.0486699296639046, 1.7142857142857142, 1.1082504388531305, 1.244308337027038, 1.0454741379310344, 1.0853242320819112, 1.3053042850469274, 1.0735616904195133, 1.0583941605839415, 1.0773809523809523, 1.0969043752153158, 1.0570852029843614, 1.119448698315467, 1.0319634703196348, 1.061652281134402, 1.0927550174497744, 1.1428571428571428, 2.0, 1.0315033423410611, 1.1774445698128084, 1.0185714285714285, 1.0430622009569377, 1.1661119515885023, 1.0071258630341482, 1.1751465416178195, 1.092087312414734, 1.1515151515151516, 1.0704457897633461, 1.1714285714285715, 1.1068702290076335, 1.4324324324324325, 1.058079586063133, 1.1778688524590164, 1.0816326530612246, 1.1304347826086956, 1.0730593607305936, 1.159779614325069, 1.06, 1.2380952380952381, 1.03125, 1.016, 1.1711087420042643, 1.3846153846153846, 1.0168289606979677, 1.0046728971962617, 1.0146399055489965, 1.2719298245614035, 1.5, 1.2718786464410734, 1.0751354940320863, 1.0697492830574407, 1.0648567119155354, 1.3015873015873016, 1.1176470588235294, 1.2647058823529411, 1.0, 1.0481927710843373, 1.011703511053316, 1.0277922406878404, 1.0321735958251923, 1.3304347826086957, 1.0517907153164767, 1.0469944170415741, 4.0, 1.094347688965203, 1.1720461012272583, 2.0, 2.25, 1.2263404991351619, 1.136464386269694, 1.0992214712337443, 1.2808398950131235, 1.5, 1.0887372013651877, 1.0528967254408061, 1.1466666666666667, 1.0429858091875541, 1.1242775361919966, 1.0396137866070077, 1.0425753939267453, 1.7142857142857142, 1.0208707449293801, 1.0337364735837047, 1.0026385224274406, 1.1384615384615384, 1.002296211251435, 2.0, 1.0472303206997085, 1.139254216308216, 1.050379014400931, 1.2666666666666666, 1.070063694267516, 1.0809620680245107, 1.0601503759398496, 1.0893470790378006, 1.2727272727272727, 1.0175647310592852, 1.219560878243513, 1.0438892314807677, 1.2721518987341771, 1.1395348837209303, 1.0163934426229508, 1.25, 1.0953409441530393, 1.0304568527918783, 1.0146770120158632, 1.0255474452554745, 3.0, 1.0417052826691382, 1.025281350482315, 1.1650805270863835, 1.080493346316131, 1.0221636510424088, 1.0487125956854557, 1.0930691014733347, 1.4063324538258575, 1.0, 1.0654156551407388, 1.0943333190559814, 1.1933019976498238, 1.068429237947123, 1.6666666666666667, 1.0337078651685394, 1.006631366616238, 1.0087847730600292, 1.0186978959904724, 1.0792051854213154, 1.0279263220439692, 1.8, 1.1057692307692308, 1.0064809289943544, 1.1789413118527043, 1.22508038585209, 1.0661436648548746, 1.1072386058981234, 1.2231329690346084, 1.00625, 1.0302565730787256, 1.029713051315038, 1.0307101727447217, 1.0188261351052048, 1.0263157894736843, 1.1072273946662459, 1.0126262508128236, 1.0403883117199095, 1.0254027261462206, 1.1101827676240208, 1.0281509916826614, 1.263157894736842, 1.25, 1.6666666666666667, 2.5, 1.15, 1.0021413276231264, 1.020983606557377, 1.0591717911814733, 1.0101090466607385, 1.0348270257719991, 1.005621925509487, 1.18348623853211, 1.1204819277108433, 1.0398986885667825, 1.6, 1.3333333333333333, 1.1444065695692593, 1.125, 1.0089686098654709, 1.140982218458933, 1.074540174249758, 1.1057936894517508, 3.0, 1.050983436853002, 1.2352941176470589, 1.1002428750332056, 1.0398752369885633, 1.194736842105263, 1.1394148020654045, 1.1500373692077728, 1.0614105913084777, 1.021798365122616, 1.1153846153846154, 1.0573394495412844, 1.0, 4.0, 1.0416528531571163, 5.0, 1.625, 1.7714285714285714, 1.014344262295082, 1.0994124336618651, 1.080112044817927, 1.0562248995983936, 1.3333333333333333, 1.0912756497003508, 1.0209449585971748, 1.0619469026548674, 1.2569721115537849]
origin-bjaq_15.71 	max: 5.0000	99th: 3.0000	95th: 1.8264	median: 1.0816	mean: 1.1854

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.119627 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.173619