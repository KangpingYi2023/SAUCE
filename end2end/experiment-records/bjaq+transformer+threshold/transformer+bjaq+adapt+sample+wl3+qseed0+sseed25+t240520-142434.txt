Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 25, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.7350	95th: 1.6821	median: 1.0776	mean: 1.1750
ReportEsts: [1.0824742268041236, 1.0182291666666667, 1.0543379193611389, 1.0633946830265848, 1.5, 1.0, 1.0359880749574106, 1.0377738488025132, 1.0, 1.0304232804232805, 1.1307534701180273, 1.0432117696935803, 1.0343179843614247, 1.1418604651162791, 1.0692334864005653, 1.0, 1.1, 1.0279844137442438, 3.0, 2.0, 1.35, 1.1006931257121155, 1.1179612553479843, 1.1450381679389312, 1.0596941292550568, 1.0, 1.1437600428494912, 1.5, 1.2, 1.014388489208633, 1.0, 1.0438695212749525, 1.0044719748043895, 1.0899001109877913, 1.0351006021442208, 1.2338470534185357, 1.1149732620320856, 1.0107745925780482, 1.1304841931262484, 1.0120481927710843, 1.1403508771929824, 1.0609756097560976, 1.0, 1.0343426776916649, 1.0892137096774193, 1.8615384615384616, 1.0618556701030928, 1.2332155477031803, 1.026777800365928, 1.0093457943925233, 1.0196131409272335, 1.1890034364261168, 1.0375421465015828, 2.0, 1.12987012987013, 1.2260812833403691, 1.4565677966101696, 1.3461538461538463, 1.0254777070063694, 1.25, 1.0926026899309342, 1.0983810709838107, 1.1590909090909092, 1.0481927710843373, 1.0909090909090908, 1.0276374759906097, 1.2642679900744418, 1.75, 1.0, 1.112053696280414, 1.0133010882708586, 1.059061957151129, 1.034965034965035, 1.0547624408916911, 1.051764705882353, 1.0821643286573146, 1.0, 1.116910229645094, 2.0, 1.015337599357227, 1.4545454545454546, 1.0305986362365291, 1.1840490797546013, 1.1051964512040557, 1.098135426889107, 1.0, 1.0706920899400958, 1.0052237933855324, 1.0931372549019607, 1.75, 1.0840579710144929, 1.0768067948544506, 1.02803738317757, 1.0364656381486677, 1.0129509713228493, 1.0233766233766233, 1.0227272727272727, 1.1478942213516161, 1.0, 1.2383425414364642, 1.0316774658027357, 1.0445969125214407, 1.2146500364322146, 1.2592592592592593, 1.0233445305797952, 1.0862755508362092, 1.311178085140735, 1.067880166856276, 1.0432250153280196, 1.3333333333333333, 1.6666666666666667, 1.0768691588785047, 1.0831146978402135, 1.0574857864813645, 1.0649350649350648, 1.0619880312021137, 1.0, 1.1356039104383475, 1.1754780652418448, 1.0, 1.0282485875706215, 1.1666666666666667, 1.1453634085213034, 1.0216796895725964, 1.1115166576065854, 1.108910891089109, 1.8, 1.2036423841059603, 1.0, 1.0769230769230769, 1.0964002003864597, 1.3, 1.0807291666666667, 1.03266405823133, 1.0672016048144433, 1.020026702269693, 1.067251461988304, 1.053780202650039, 1.039972432804962, 1.0798293723339427, 1.0286010657431341, 1.208955223880597, 1.037212449255751, 1.0773143809859926, 2.0, 1.0177757520510484, 1.0022857142857142, 1.0789825970548863, 1.0871713428621845, 1.5, 1.2585371760716881, 1.0118518518518518, 1.0121457489878543, 1.1074561403508771, 1.170940170940171, 1.0057316250842887, 1.1156949082419694, 1.2183036695231817, 1.052, 1.0296052631578947, 1.2448979591836735, 1.38, 1.0220913107511045, 1.5714285714285714, 1.0679219841539278, 1.001213833117032, 1.1962809917355373, 1.3443079285851411, 1.106081081081081, 1.1049004797116428, 1.2021052631578948, 1.0818181818181818, 1.0682676479132371, 1.0495449949443882, 1.0184534270650263, 1.098153547133139, 1.0315526398000625, 1.1241670658943426, 1.0821891955649918, 1.0, 1.0873015873015872, 1.0157683486238531, 1.0283094098883572, 1.1957531519575315, 1.1973684210526316, 1.0986816764205216, 1.3140495867768596, 1.1136073415146202, 1.1153846153846154, 1.0068181818181818, 1.1190745065831686, 1.0, 1.1818181818181819, 1.0061337314878334, 1.04756242568371, 1.00836820083682, 1.25, 1.0598070739549839, 1.0556323445536617, 1.0763340731448423, 1.0626410835214446, 1.1279645831137346, 1.3220338983050848, 1.0666666666666667, 1.2352941176470589, 1.0, 1.3793103448275863, 1.099747673868475, 1.3066202090592334, 1.4597701149425288, 1.0098863074641622, 1.0031277926720286, 1.0211154263321787, 1.0331261791144157, 1.1092939481268012, 1.1428571428571428, 1.115606936416185, 1.010809040288241, 1.051137342753748, 1.018018018018018, 1.0, 1.0612836438923396, 1.119689598802513, 1.0083774236790697, 1.1661481020535158, 1.0187697454004832, 1.278952777627522, 1.0357142857142858, 1.0056651014575835, 1.0640794223826715, 1.0203045685279188, 1.054945054945055, 1.1037087912087913, 1.0491295938104448, 1.1779527559055119, 2.0, 1.2606493893357165, 1.0947967842786959, 1.1258790436005626, 1.0307692307692307, 1.0, 1.6666666666666667, 1.0498936001829022, 1.1272727272727272, 1.0972510647284504, 1.5, 1.0, 1.1111111111111112, 1.0655737704918034, 1.0, 1.0248618784530388, 1.109704641350211, 1.072289156626506, 1.012174643157011, 1.0915197150655234, 1.0350877192982457, 2.0, 1.0482285690786093, 1.0212021407986827, 1.0980735551663747, 1.0141313209440392, 1.1193745557924661, 1.0151848151848153, 1.0731319554848966, 1.0955055190746967, 1.0173444976076556, 1.0996484792908452, 1.0238903558405632, 1.1818181818181819, 1.0144772117962466, 1.0756880733944953, 1.1818181818181819, 1.6666666666666667, 1.0654545454545454, 1.0555555555555556, 1.0085470085470085, 1.057331269766503, 1.0257142857142858, 1.3533834586466165, 1.010494796722141, 1.0267011197243756, 1.0196098901468973, 1.0443694517405326, 1.1111111111111112, 1.13992360858494, 2.5, 1.0387570413589495, 1.0153508771929824, 1.032060443311638, 1.0526315789473684, 1.1, 1.3043478260869565, 1.109375, 1.0619051613444401, 1.0, 1.0152905198776758, 1.0407239819004526, 1.0080128205128205, 1.0143493564425445, 1.1595092024539877, 1.0943396226415094, 1.021076501195331, 1.1608644245927482, 1.0413959686823255, 1.0683760683760684, 1.0, 1.1026252983293556, 1.2848101265822784, 1.1801470588235294, 1.1755265374894692, 1.018348623853211, 1.0169014084507042, 1.4390243902439024, 1.0068587105624143, 1.0028379772961817, 1.2857142857142858, 1.0083211870223414, 1.0419847328244274, 1.0555555555555556, 1.0940646891418564, 1.2857142857142858, 1.4, 1.004298484752425, 2.0, 1.1989026063100137, 1.0625, 1.0639868744872847, 1.1265445249254367, 1.0351351351351352, 1.1818181818181819, 1.1112163313897645, 1.075574271966765, 1.0222841225626742, 1.0229150415607726, 1.0109920690134966, 2.0, 1.0, 1.0541831394684522, 1.25, 1.0691578360290017, 1.3529411764705883, 1.0, 1.4666666666666666, 1.3142570281124497, 1.0609184629803186, 1.162162162162162, 1.0086580086580086, 1.0, 1.2103861517976031, 1.103288458794028, 2.0, 1.1995235259082788, 1.0, 1.0918241858346618, 1.0229885057471264, 1.0284989474820532, 1.1566820276497696, 1.1363636363636365, 1.2280334728033473, 1.1759259259259258, 1.0199215593235418, 1.016586269063977, 1.0459610027855153, 1.0, 1.0769230769230769, 1.5714285714285714, 1.5, 1.3333333333333333, 1.0693933823529411, 1.3333333333333333, 1.0362068965517242, 1.216867469879518, 1.1044721817978282, 1.0537811608987941, 1.2203913491246139, 1.0041021506651175, 1.0087006960556844, 1.055952380952381, 1.5, 1.05625, 1.0893617021276596, 1.055006740118249, 1.1428571428571428, 1.5714285714285714, 1.0158371040723981, 1.0324129651860745, 1.0365592837537392, 1.0074074074074073, 1.1464387464387464, 1.024076607387141, 1.0256410256410255, 1.0907770515613653, 1.097457627118644, 1.1730769230769231, 1.0254957507082152, 1.2058823529411764, 1.0570984260626433, 1.0572741776628403, 1.0033319659436244, 1.0116279069767442, 1.0673076923076923, 1.1118012422360248, 1.0, 1.0195887639874017, 1.0668404628005226, 1.017316513761468, 1.0601523415683338, 1.064319153266843, 1.15411503018748, 1.8333333333333333, 1.0864779874213837, 1.0, 1.2613151152860802, 1.25, 1.0387940764820083, 1.0260869565217392, 1.1274720550300945, 1.0948616600790513, 1.0741379310344827, 3.0, 1.1825424315898856, 1.008696955606676, 1.1153899209122677, 2.0, 1.1111111111111112, 1.2754318618042226, 1.3864541832669324, 1.1020022201208732, 1.1413721413721414, 1.2352941176470589, 1.0320569902048085, 1.0173573959150677, 1.057824808007423, 1.0975272867767796, 1.0416666666666667, 1.199004975124378, 1.168141592920354, 2.142857142857143, 1.0648648648648649, 1.4444444444444444, 1.2278056951423786, 1.0, 1.1494781402817313, 1.5625, 1.050793095404712, 1.115502930107065, 1.0863664404688465, 1.0, 1.163265306122449, 1.2, 1.2870092147435896, 1.37636761487965, 1.0, 1.034954407294833, 1.1318787975482962, 1.070037297969333, 1.5, 2.0, 1.014757281553398, 1.006311992786294, 1.0491803278688525, 1.1111111111111112, 1.0835596854896354, 1.0321637426900585, 1.4705882352941178, 1.0667043314500941, 1.0454545454545454, 1.110236220472441, 1.0403225806451613, 1.2932267564156499, 1.010447161471787, 1.0, 1.0571428571428572, 1.109878903760357, 1.0384644722526668, 1.0201695244886713, 1.0, 1.077416500774165, 1.0050760587982284, 1.0220010476689365, 2.0, 1.0430622009569377, 1.0438607268349018, 1.0388023670032678, 1.0853173736402952, 1.005069509087969, 1.0248756218905473, 1.0101867572156198, 1.1041465766634522, 2.0, 1.0336968318776165, 1.6818181818181819, 1.0, 1.2072538860103628, 1.1346153846153846, 1.0187168672690294, 1.1641938674579624, 1.069556740638798, 1.145938503900872, 1.0537245889210065, 1.0454483971324227, 1.0565495798513587, 1.1704545454545454, 4.0, 1.0150762213419757, 1.1562753036437248, 1.047852738892812, 1.0440097447751315, 1.106798579401319, 1.2330173775671407, 2.2967032967032965, 2.4285714285714284, 1.0080375001533874, 1.0572125722817065, 1.0158759963572521, 1.1055112400290066, 1.056811608175858, 1.0082474226804123, 1.0737055011963657, 1.02600996126176, 1.2058371735791091, 3.0, 1.0, 1.0203442879499218, 1.0844529750479845, 1.0456140350877192, 1.236764705882353, 1.0568627450980392, 1.005050505050505, 1.148905109489051, 1.103030303030303, 1.0469598452539095, 1.202127659574468, 1.0178464191675778, 2.0, 1.1381847914963206, 1.05, 1.2935779816513762, 1.1360335195530726, 1.0998796630565584, 1.017786561264822, 1.053177691309987, 1.095012741172188, 1.0, 1.2340425531914894, 1.5, 1.0, 1.2272727272727273, 1.0685483870967742, 1.007716049382716, 1.145631067961165, 1.06183915411727, 1.0591647331786542, 1.0563436346529638, 1.1753389732298065, 1.041860465116279, 1.0838753743498135, 1.1135135135135135, 1.1395819285232636, 1.06192549588776, 1.077662129703763, 1.2124277456647399, 1.1240145542753184, 1.0355242487204175, 1.2002505896226414, 1.07995090112951, 2.0, 1.030379746835443, 1.0852557673019056, 1.4339622641509433, 1.0, 1.1333333333333333, 1.25, 1.034798534798535, 1.3333333333333333, 1.0, 1.0051233717586214, 1.1242532616730934, 1.0307108305957215, 1.054520853231455, 1.227027027027027, 1.1258549931600548, 1.0, 1.2222222222222223, 1.0032416028691633, 1.067030573485271, 1.0842017507294706, 1.0705661237042943, 1.028125, 1.1584415584415584, 1.068394771917958, 1.119005328596803, 1.0633114335044958, 1.0543590805549803, 1.303030303030303, 1.0567823343848581, 1.0, 1.2387640449438202, 1.208437795405039, 3.0, 1.1119927454092042, 1.075341033208617, 1.4285714285714286, 1.0584512143973768, 1.6, 1.0555555555555556, 1.060179449637722, 1.6153846153846154, 1.0196028667077577, 1.0388722768047842, 1.3571428571428572, 1.0740740740740742, 1.0556701030927835, 1.011477761836442, 1.0044150110375276, 1.137238780404248, 1.155912092604737, 1.0, 1.0983054529654572, 1.079268292682927, 2.0, 1.0192356482228937, 1.064711480231854, 1.2005676442762536, 1.0185392721831321, 1.0350754877229456, 1.0176991150442478, 2.142857142857143, 1.0289628180039139, 1.0324729392173189, 1.0877437089576298, 1.2470881863560732, 1.003135284048666, 1.0127613926078658, 1.1703296703296704, 1.1223382045929018, 1.2441471571906355, 1.059191646582559, 1.040378548895899, 1.0337078651685394, 1.043859649122807, 1.0538183699297017, 3.0, 1.1339219358482713, 1.0225653327370123, 1.0277332383158144, 1.5833333333333333, 1.376475489515345, 1.084, 1.1428571428571428, 1.0930732877195457, 1.0420575865415722, 1.1724890829694323, 1.1470588235294117, 1.3333333333333333, 1.0648510601143788, 1.5, 1.088785046728972, 1.0833333333333333, 1.0595910962249668, 1.44, 1.1476793248945147, 1.0429769392033543, 1.0, 1.5992063492063493, 1.2271268057784912, 1.25, 2.0, 1.146551724137931, 1.1724137931034482, 1.0322184719239031, 1.194235588972431, 1.08843537414966, 1.2271386430678466, 1.1014466214978942, 1.0597402597402596, 1.079295154185022, 1.2979591836734694, 1.1923076923076923, 1.0, 1.1990349819059107, 1.075036075036075, 1.0547520661157024, 1.0807300414287313, 1.0761235461099807, 1.0657616361071933, 1.077527939999407, 1.2343117408906883, 1.187142857142857, 1.0029832935560858, 1.375, 1.0, 1.2592592592592593, 1.0209267910962354, 1.120917917034422, 1.107843137254902, 1.019704433497537, 1.0041407867494825, 1.0072902208626986, 1.016504442192618, 1.0985915492957747, 1.2222222222222223, 1.032085561497326, 1.1075689289501591, 1.0926077719600529, 1.0037545107195924, 1.0263157894736843, 1.0383933845245128, 1.0092014073186637, 1.1031073446327684, 1.354378818737271, 1.2857142857142858, 1.0998013902681232, 2.732307692307692, 1.1818181818181819, 1.132716049382716, 1.0701001430615165, 1.0, 1.0354609929078014, 1.0383368877096941, 1.0740740740740742, 1.0786505226120253, 1.048888888888889, 1.2285714285714286, 1.0349328551904005, 1.0469718817591924, 1.0784985226967498, 1.0629770992366412, 1.035252643948296, 1.2069106244048429, 1.2416851441241685, 1.3571428571428572, 1.0, 1.25, 1.0597553590892577, 1.3333333333333333, 1.0999060289826401, 1.1121102794679878, 1.0400921658986175, 1.0560079443892751, 1.0492788521335927, 1.052411575562701, 1.010752688172043, 1.042995839112344, 1.036090825838871, 1.1262654668166479, 1.0413307709586443, 1.2434963266289294, 1.6666666666666667, 1.032258064516129, 1.0326530612244897, 1.0762938056778397, 1.0846905537459284, 1.29838488913222, 1.050185873605948, 2.1923076923076925, 1.0595424219439327, 1.0684563758389263, 1.064354066985646, 1.125, 1.0787953309956935, 1.0333478733140038, 1.3165542293720809, 1.0581052631578947, 1.1851851851851851, 1.1675, 1.098360655737705, 1.6875, 1.0637832017229003, 1.4615384615384615, 1.2369077306733167, 1.0833333333333333, 1.0129781420765027, 1.010776224953696, 1.0059171597633136, 3.6666666666666665, 1.0980392156862746, 1.0843045700209566, 1.0565809211622867, 1.0069356676358339, 1.0693530653915289, 1.0789471362140317, 1.0, 1.096969696969697, 1.0172893481717011, 1.0196660565203803, 1.0260521042084167, 1.0069444444444444, 1.0349976668222118, 1.0130043136259832, 1.4225206611570247, 1.0424699890869407, 1.0, 1.3333333333333333, 1.0372518480061312, 1.012825994014536, 1.2225770097670925, 1.0878880548605319, 1.0335195530726258, 1.1221945137157108, 1.1071946062631222, 1.0752813726444164, 1.1985294117647058, 1.0571428571428572, 1.0196078431372548, 1.0911377803956217, 1.1071428571428572, 1.75, 1.0352796360717154, 1.1639217455764335, 1.0384843102427472, 1.0170454545454546, 1.2440260680666184, 1.011307460251605, 1.176272139443351, 1.2084592145015105, 1.2692307692307692, 1.0552560646900269, 1.1585365853658536, 1.159375, 1.34375, 1.0709688233322159, 1.1863230921704657, 1.1666666666666667, 1.048780487804878, 1.0328351222121912, 1.0351517479830965, 1.073627844712182, 1.2415329768270944, 1.3333333333333333, 1.1666666666666667, 2.0, 1.1529083942877045, 1.2307692307692308, 1.0, 1.25, 1.0119205298013245, 1.065217391304348, 1.0155250183572853, 1.0458179274507844, 1.0781818181818181, 1.3333333333333333, 1.1428571428571428, 1.0689655172413792, 1.0945945945945945, 1.0571428571428572, 1.1715328467153285, 1.023115160438462, 1.0334570145820192, 1.3473684210526315, 1.090915929778489, 1.0472749111656072, 2.5, 1.0680395359123542, 1.2704174228675136, 3.0, 2.0, 1.1689349112426035, 1.0701427239475005, 1.079239608236292, 1.1925465838509317, 1.0, 1.075, 1.0276073619631902, 3.0, 2.0, 1.0996555118110236, 1.2591746202446565, 1.0623516181431962, 1.6666666666666667, 1.0360020978086126, 1.0441518202943454, 1.0942760942760943, 1.0, 1.0657276995305165, 1.02340925430947, 1.1710526315789473, 1.1524024024024024, 1.0509493609511065, 1.4261744966442953, 1.05078125, 1.081274295161074, 1.0933706816059756, 1.0495867768595042, 1.15, 1.0014868728025499, 1.351628368325343, 1.0679265824881956, 1.3916666666666666, 1.1568627450980393, 1.2835820895522387, 1.0837837837837838, 1.045945112550108, 1.0190201084247892, 1.0693696110365971, 1.0655021834061136, 1.5, 1.6666666666666667, 1.0457073451384005, 1.133245382585752, 1.1503598521688387, 1.025815834366294, 1.1026927579862853, 1.1083951449763991, 1.0970149253731343, 1.0212765957446808, 1.1348950554201713, 1.1205748803188758, 1.2826908541194255, 1.1015761821366024, 2.5, 1.0416666666666667, 1.057698277200062, 1.1812023708721422, 1.0197896947232783, 1.0964173768878067, 1.0184659090909092, 2.0, 1.1102464332036317, 1.0142480618445284, 1.190312999771533, 1.053231939163498, 1.0607388070376198, 1.0509554140127388, 1.2560706401766004, 1.0153031194820483, 1.0305524406751367, 1.065283273002778, 1.0587557603686637, 1.0611413043478262, 1.0, 1.212724070044555, 1.051124417222781, 1.0501981505944518, 1.0729170234873657, 1.1380620645978468, 1.061270801815431, 1.2, 1.246031746031746, 1.6666666666666667, 2.0, 1.2352941176470589, 1.0051413881748072, 1.0205371248025277, 1.0009655018753016, 1.012386125486506, 1.1164179104477612, 1.0050462573591252, 1.184782608695652, 1.3243243243243243, 1.0544834697699867, 1.6, 1.5, 1.1913986826811314, 1.1428571428571428, 1.0488826815642458, 1.1081344374086703, 1.0807519968829145, 1.0828666958822288, 2.0, 1.1179566563467491, 1.199612403100775, 1.0544307125953194, 1.039331357743791, 1.2133838383838385, 1.1195205479452055, 1.1507417200734997, 1.0556028852161072, 1.0553691275167785, 1.1833333333333333, 1.0600558659217878, 1.0, 1.0, 1.0417054111083295, 5.0, 1.5714285714285714, 2.25, 1.0109756097560976, 1.119047619047619, 1.0909090909090908, 1.1200470772852098, 1.0, 1.0273122284295468, 1.0251168224299065, 1.1736842105263159, 1.2884615384615385, 1.4285714285714286, 1.0118541713263252, 1.1579822616407982, 1.1521252796420582, 1.0431387132763108, 1.0151130856484747, 1.1736432477913337, 1.10351966873706, 1.0, 1.180860515293819, 1.0371138848952206, 1.0650107604017216, 1.1774193548387097, 1.0893623704324154]
origin-bjaq_15.71 	max: 5.0000	99th: 2.7350	95th: 1.6821	median: 1.0776	mean: 1.1750

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 14.143379 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[2.9802322e-07 1.1920929e-07 0.0000000e+00 0.0000000e+00 5.9604645e-08]
Distance score: 9.536743306171047e-08
SAUCE Drift detection: False
Detection latency: 0.0232s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.090985 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 3.0000	95th: 1.8013	median: 1.0824	mean: 1.1870
ReportEsts: [1.0444444444444445, 1.0150195907705704, 1.0408000868086953, 1.0186440677966102, 1.4166666666666667, 1.0, 1.051144556596972, 1.029780654468441, 1.1666666666666667, 1.019629225736096, 1.0726763825885532, 1.0428184322583312, 1.0138199858256556, 1.0846153846153845, 1.0259778166958553, 1.736842105263158, 1.1782178217821782, 1.2692307692307692, 1.1818181818181819, 1.0737018425460636, 1.1509656146961846, 1.0917155076825598, 1.0570430733410943, 1.038560411311054, 1.0109363479970508, 1.0315280419487434, 2.0, 1.1784881580562032, 1.2, 1.6, 1.045881126173097, 1.0, 1.0385601101299005, 1.004440794554685, 1.1629084215370455, 1.0339189848706687, 1.2129886118805786, 1.2295454545454545, 2.0, 1.3482704402515724, 1.1961726911343256, 1.0082201048655353, 1.2354533152909337, 1.008767484289479, 1.0018281535648994, 1.1060707372866443, 1.2857142857142858, 1.4935064935064934, 1.2843137254901962, 1.0040187541862022, 1.3076923076923077, 1.2, 1.0364372469635628, 1.096774193548387, 1.0248590185498703, 1.0209299410953754, 1.046514997826402, 1.114713216957606, 1.086021505376344, 1.0507848863740075, 1.4029850746268657, 1.0646501607277203, 1.0801186943620178, 1.1467181467181466, 1.0673076923076923, 1.1333333333333333, 1.1026048284625158, 1.2820715036803365, 1.4, 1.0, 1.050187617260788, 1.00396432111001, 1.0352657004830919, 1.0267686424474187, 1.100329851566795, 1.263157894736842, 1.1027699718988357, 1.1865284974093264, 1.4368932038834952, 1.0617772256426183, 1.033099297893681, 1.0555555555555556, 1.0, 1.0, 1.041340782122905, 1.1692307692307693, 1.7142857142857142, 1.625, 2.0, 1.0632326366122404, 1.1146429647484182, 1.1693398178807948, 1.0011040078050784, 1.0064287710798472, 1.074935400516796, 1.010600706713781, 1.176923076923077, 1.0899742930591259, 2.0, 1.2650316455696202, 1.1379310344827587, 1.25, 1.0629346165988345, 1.1824062095730918, 1.1088825214899714, 1.2363063324155918, 1.4193548387096775, 1.0208292395362546, 1.0452127659574468, 1.218277914187024, 1.1638871071199486, 1.047145769622834, 1.125, 3.0, 1.0639671361502347, 1.0829372733229359, 1.0839936608557845, 1.141304347826087, 1.0624010102870374, 2.0, 1.0763338615953513, 1.1352087114337568, 2.5, 1.004524886877828, 1.1428571428571428, 1.3582089552238805, 1.0190386133597276, 1.1351665375677769, 1.024793388429752, 2.0, 1.1367403314917126, 1.0, 2.0, 1.1309918879056047, 1.3333333333333333, 1.1616161616161615, 1.0308356495192965, 1.0535989849456466, 3.0, 1.7142857142857142, 1.0185185185185186, 1.0530035335689045, 1.0803253685815963, 1.0587386896091502, 1.1625, 1.0398428731762066, 1.1302389147600729, 3.0, 1.0132175226586102, 1.0597156398104266, 1.0895184135977336, 1.0927288784221372, 1.5, 1.2110828673106253, 1.0037546933667083, 1.0239316239316238, 1.3037974683544304, 2.0, 1.0223123732251522, 1.073330612048887, 1.0673061550759393, 1.051926298157454, 1.0664819944598338, 1.4339622641509433, 1.5225225225225225, 1.0209617755856966, 1.0, 1.0724924845588206, 1.0606060606060606, 1.0816326530612246, 1.0890366458854592, 1.0196191575302942, 1.0542820159505617, 1.318661971830986, 1.0779467680608366, 1.1092579163645153, 1.0769230769230769, 1.052710843373494, 1.0664505672609401, 1.0680600214362272, 1.0869224233710215, 1.2177874411140446, 1.1677018633540373, 2.0, 1.0239322873352923, 1.115956619228481, 1.2093862815884477, 1.0708319640705444, 1.0095923261390887, 2.0, 1.2305555555555556, 1.0960580393838677, 1.173913043478261, 1.1491094147582697, 1.0528872393843467, 1.041103176511942, 1.0493275320376225, 1.0823529411764705, 1.0240500662288332, 1.0022923161562443, 1.0, 1.0405557699729835, 1.0063694267515924, 1.062114142424098, 1.0700517160319698, 1.083224058047032, 1.1981566820276497, 1.1388888888888888, 1.2098765432098766, 1.0, 1.2733333333333334, 1.1551986251569832, 1.3022598870056497, 1.1682242990654206, 1.013997529847674, 1.105263157894737, 1.0460439279187048, 1.0435779816513762, 1.2206866337422335, 1.3333333333333333, 1.0903465346534653, 1.0075553157042634, 1.060630383477292, 1.0629742881233681, 1.0416666666666667, 1.1079691516709511, 1.114117124965073, 1.0327793167128347, 1.0561797752808988, 1.0198019801980198, 1.0371412492965673, 1.0670022734654108, 1.3414634146341464, 1.005819535842252, 1.034051394011955, 1.1180124223602483, 1.1104868913857677, 1.0274285714285714, 1.0, 1.1727037516170764, 2.0, 1.210224558050645, 1.1083126956684266, 1.1605995717344755, 1.1322033898305084, 1.0769230769230769, 1.6666666666666667, 1.08386210123103, 1.15625, 1.1416768665850674, 1.2, 1.1260815822002472, 1.0551948051948052, 1.125, 1.0230657579199798, 1.013953488372093, 1.1823008849557521, 1.0630975143403443, 1.0073684210526315, 1.112472555856903, 1.0149253731343284, 2.0, 1.0572199614478475, 1.042927641357988, 1.1144927536231883, 1.053813060744227, 1.1517621790491066, 1.0331380162372044, 1.1035856573705178, 1.0803454900063056, 1.018435475834579, 1.058145240431796, 1.0118471206345936, 1.2307692307692308, 1.0087053120581702, 1.0161001788908766, 1.26, 1.619047619047619, 1.0118399242244849, 1.1482758620689655, 1.0290148031106834, 1.0025241901556583, 1.0023310023310024, 1.4093816631130065, 1.0137611292394466, 1.0710227272727273, 1.1676557863501484, 1.0537127674451126, 1.2, 1.2475822050290135, 1.019278606965174, 1.0580887885628292, 1.1002986076161718, 1.0805063486550115, 1.2176724137931034, 1.2204058624577228, 1.0248734944052456, 1.0457222619412385, 1.1009169334273778, 1.002744316757484, 1.0618458610846813, 1.1724137931034482, 1.0666666666666667, 1.0842215883500976, 2.25, 1.0053571428571428, 1.0091983796286719, 1.1201216421692854, 1.4722222222222223, 1.0344827586206897, 1.0266875981161696, 1.0421396628826969, 1.0649099174945278, 1.0833333333333333, 1.2281973345803132, 1.013750361196082, 1.2571428571428571, 1.25, 2.2, 1.0107296137339057, 1.1, 1.0088842729397844, 1.0096153846153846, 1.0909090909090908, 1.084410923632552, 1.3043478260869565, 1.3333333333333333, 1.0033704897247608, 2.0, 1.0240963855421688, 1.0732919254658384, 1.1092396535129934, 1.0278293135435992, 1.0704225352112675, 1.153061224489796, 1.093684151219787, 1.1008499962808436, 1.0277777777777777, 1.0414106065778992, 1.0029139227227695, 3.0, 1.0, 1.0539068673654945, 1.5, 1.0692701069270107, 1.5, 4.0, 1.368421052631579, 1.4291701592623638, 1.0641627543035994, 1.353448275862069, 1.1028938906752412, 1.2911392405063291, 1.8, 1.1596214411192176, 1.0754716981132075, 1.028169014084507, 1.022139372856395, 1.120331950207469, 1.0455580865603644, 1.0345149253731343, 1.4, 1.0, 1.3005640612409348, 1.04, 1.0049751243781095, 1.129510248417871, 1.2517266896891959, 1.0, 1.0, 1.0253041447548497, 1.1358024691358024, 1.027027027027027, 2.0, 1.0442878711625567, 1.0, 1.1458333333333333, 1.145631067961165, 1.201917467725163, 1.0597378249938234, 1.0669068450849202, 1.0977607864554888, 1.1203741358275723, 1.2241379310344827, 1.1099554234769688, 1.147567700733385, 1.1273344651952462, 1.2121212121212122, 1.0107539577587183, 1.0608939181773456, 1.0588235294117647, 1.099502487562189, 1.1538461538461537, 1.1884368308351179, 2.0, 1.0833333333333333, 1.8289473684210527, 1.1648148148148147, 1.3758389261744965, 1.017915309446254, 1.0947482403898214, 1.157209786569495, 1.0295532066193398, 1.1466165413533835, 1.1411507402422612, 1.08, 1.0973451327433628, 1.1099476439790577, 4.0, 1.0687411102234865, 1.509433962264151, 1.1052611686446443, 1.05644523398903, 1.1315624158664632, 1.1507978723404255, 1.75, 1.474705882352941, 1.1428571428571428, 1.213828689370485, 1.1818181818181819, 1.0467521563239448, 1.026993865030675, 1.0983489513609996, 1.0806451612903225, 1.096376811594203, 4.0, 1.2511401641836424, 1.0184412309592425, 1.1097211813762227, 3.0, 1.296875, 1.2080971659919029, 1.2393939393939395, 1.104283502494409, 1.2049518569463549, 1.2173913043478262, 1.1104734576757531, 1.0123802849801449, 1.0958471902447344, 1.0357800751263577, 1.0144450627888408, 1.0190031152647976, 1.0471698113207548, 1.0384435067979372, 1.0413460767812774, 1.1574074074074074, 1.130514705882353, 1.0, 1.0, 1.2014483212639895, 1.0877862595419847, 1.0416666666666667, 1.12321535864496, 1.0977366255144032, 1.0, 1.2416666666666667, 1.1666666666666667, 1.0800304267755625, 1.125, 1.0, 1.0662851196670136, 1.0, 1.0, 1.0191497510532364, 1.75, 1.008735037204788, 1.0022590361445782, 1.0054945054945055, 1.0833333333333333, 1.087954868116267, 1.0500417014178482, 1.4, 1.0507121073977426, 1.0534351145038168, 1.136165577342048, 1.049731182795699, 1.4000707463742483, 1.0835522587956523, 1.0, 1.0941176470588236, 1.3255988023952097, 1.1367521367521367, 1.0604614160700079, 1.5, 1.1191402631091347, 1.0131717943525214, 1.0308234258036106, 2.0, 1.0248673740053051, 1.0316432646785092, 1.0058667583091954, 1.069065688659719, 1.0075062521677225, 1.0313164584507948, 1.0398262128892106, 1.1218487394957983, 2.6666666666666665, 1.117784306947805, 1.026955950032873, 1.0687361419068737, 1.1273637374860956, 1.0561497326203209, 1.0032822757111597, 1.3175355450236967, 1.0401426161143477, 1.003813882532418, 1.0719918033610238, 1.1346396965865992, 1.166674976317495, 1.0416572504708097, 1.0804597701149425, 1.0, 1.1103507271171942, 1.0705128205128205, 1.007662019793551, 1.0640406125797266, 1.0, 1.0728729492560092, 1.036619718309859, 2.0, 1.2884615384615385, 1.0109667421623554, 1.1598513011152416, 1.260176609950463, 1.0, 1.0972222222222223, 1.0158584233509538, 1.1681294009592815, 1.0419541301510349, 1.015845857221293, 1.1079080638878067, 1.0309477756286267, 1.0070175438596491, 1.0011895670563355, 1.5251396648044693, 1.0202455225502065, 1.0207100591715976, 1.117948717948718, 1.1831645830000228, 1.3125, 1.0269296367063772, 3.0, 1.1269946808510638, 1.053191489361702, 1.046859709782943, 1.0432900432900434, 1.129668049792531, 1.0016722408026757, 1.0862619808306708, 1.0767355455484229, 1.0, 1.1607142857142858, 1.1428571428571428, 1.0, 1.0833333333333333, 1.0517241379310345, 1.0038216560509554, 1.0763052208835342, 1.0641625451142895, 1.0035671819262781, 1.0614112158027085, 1.1629463218775393, 1.0370867965086965, 1.1738199442221922, 1.0184666026430749, 1.0934782608695652, 1.0213960208958541, 1.0428821161730215, 1.0161923454367026, 1.0650054171180932, 1.1081081081081081, 1.2916666666666667, 1.0307710921116309, 1.1887456037514654, 1.1018214039578615, 1.2404371584699454, 1.2305848513902204, 1.0220883534136547, 2.0, 1.0126874279123415, 1.0, 1.6666666666666667, 1.2868217054263567, 1.0331254149361577, 1.0356874530428248, 1.0104166666666667, 1.0824175824175823, 1.0945617641562324, 1.026060479417296, 1.0828729281767955, 1.2, 1.375, 1.149478207489257, 1.018018018018018, 1.0802890405459655, 1.0859356656492134, 3.0, 1.3962264150943395, 1.1868131868131868, 1.0811000937960606, 1.0782608695652174, 1.0010461228073453, 1.0044634723993442, 1.0123828490484181, 1.3225806451612903, 1.25, 1.1070958599048486, 1.0, 1.0485781990521328, 1.1872340425531915, 1.3340380549682875, 1.0952804986642921, 1.826086956521739, 1.042177436110534, 1.0620689655172413, 1.0737704918032787, 1.0607594936708862, 1.324853228962818, 1.0930817610062893, 1.0614912367561145, 1.0211786372007365, 1.0743055555555556, 3.8333333333333335, 1.043043043043043, 1.047133714827481, 1.0476190476190477, 1.024623803009576, 1.1595845136921623, 1.1560283687943262, 1.0145746794292938, 1.3333333333333333, 1.1098484848484849, 1.0170488534396809, 1.3402777777777777, 1.2264150943396226, 1.079907400735029, 1.0223880597014925, 1.6666666666666667, 1.07425068119891, 1.0278532608695652, 1.0977754492289828, 1.2229775662814413, 1.000388854750749, 1.0386591478696743, 1.2437106918238994, 1.1043566362715298, 1.1708683473389356, 1.1085402393960107, 1.1025641025641026, 1.0159695817490495, 1.0292638317329674, 1.0342289289657711, 1.3333333333333333, 1.0352921864740643, 1.3636363636363635, 1.6, 1.1094710947109472, 1.5793991416309012, 1.0461248823344838, 1.1666666666666667, 1.0769230769230769, 1.0418342719227676, 1.0322931785195937, 1.0060240963855422, 1.0734376822732608, 2.3333333333333335, 1.0980681639704728, 2.5, 1.1169354838709677, 1.0, 1.0219197248374967, 1.3666666666666667, 1.1366906474820144, 1.082585278276481, 1.0, 1.2773109243697478, 1.310369833212473, 1.0, 2.5, 1.1468531468531469, 1.1994301994301995, 1.0323990743121625, 1.2224554039874083, 1.0716332378223496, 1.2652005174644243, 1.0340632603406326, 1.1135356290487555, 1.0144927536231885, 1.1262798634812288, 1.0625, 1.0, 1.154518950437318, 1.1100478468899522, 1.0702054794520548, 1.0797995731650738, 1.0682768471627062, 1.05704281858633, 1.071903099218243, 1.1697345825927152, 1.1501154734411085, 1.007451564828614, 1.7777777777777777, 1.5, 1.1818181818181819, 1.0230910356171317, 1.0804093567251463, 1.0911528150134049, 1.0866666666666667, 1.0116748989672204, 1.035564128626871, 1.0140460217102976, 1.180722891566265, 1.380952380952381, 1.0362826225334183, 1.0057430007178751, 1.0844504207272274, 1.0108527476930955, 1.0054054054054054, 1.0241790860181808, 1.0914894615781814, 1.123711588478952, 1.0805270863836018, 1.076368390971086, 1.128125, 1.066429418742586, 1.049689440993789, 1.029099817842934, 1.0416666666666667, 1.1428571428571428, 1.0, 1.037328094302554, 1.0088414800283363, 1.0461538461538462, 1.1207018799408914, 1.002680965147453, 1.3333333333333333, 1.0403596865348657, 1.0125462149221165, 1.0839698928341588, 1.0445505171042164, 1.0410830999066294, 1.2133481077395158, 1.1702508960573477, 1.25, 1.0, 1.3333333333333333, 1.0657700475275558, 1.4285714285714286, 1.151448362720403, 1.1056546950150583, 1.050834879406308, 1.0679063589573303, 1.0928961037270395, 1.0043138312213535, 1.0425531914893618, 1.0507497116493656, 1.0181325152702074, 1.0674350459074038, 1.0453897686003601, 1.2188557251334486, 1.7142857142857142, 1.2410501193317423, 1.0716612377850163, 1.107250101056765, 1.0106951871657754, 1.2944757609921083, 1.0741324921135647, 2.1448763250883394, 1.0310425602733102, 1.0404494382022471, 1.0370141457238842, 1.1578947368421053, 1.06003637379714, 1.034827895155792, 1.294392523364486, 1.048695652173913, 1.4, 1.041237113402062, 1.0912962565313864, 1.0222692192358076, 1.015748031496063, 1.019721628877697, 1.0857142857142856, 1.0040319728372356, 1.0520304568527918, 1.0188442211055277, 1.046875, 1.001806684733514, 1.0430528375733856, 1.0910910910910911, 1.0183932040922437, 1.0701248799231509, 1.0160722148833112, 1.103787576508142, 1.4285714285714286, 1.0753521126760563, 1.0777522530482417, 1.0167384026781445, 1.0448430493273542, 1.0839041095890412, 1.1354903943377148, 1.1032745591939546, 1.0775295663600526, 1.060908495417292, 1.121212121212121, 1.116745283018868, 1.235230374056831, 1.0516829533116179, 1.0947546531302876, 1.100209842815853, 1.168548175374114, 1.0492676431424768, 1.0943775100401607, 1.1063254744105808, 1.1019053438506832, 1.1125, 1.0758293838862558, 1.0448833034111311, 1.0988452891886369, 1.1546391752577319, 2.0, 1.0359539317911741, 1.1755022964056847, 1.009143407122233, 1.0095693779904307, 1.2183393070489845, 1.006678887941805, 1.1595769682726205, 1.079864472410455, 1.0, 1.0352272727272727, 1.0476190476190477, 1.16710875331565, 1.793103448275862, 1.047391029455519, 1.179719703215169, 1.5, 1.148936170212766, 1.1306436119116234, 1.1804850535815004, 1.08, 1.1764705882352942, 1.0339087546239212, 1.0551181102362204, 1.090545272636318, 1.3076923076923077, 1.007433702234287, 1.2877697841726619, 1.0147144015757155, 1.1788617886178863, 1.0588235294117647, 1.3400643839625404, 1.0497528184722975, 1.0332605801040509, 1.1325115562403698, 1.35, 1.1764705882352942, 1.0833333333333333, 1.1627906976744187, 1.0595238095238095, 1.0859774820880246, 1.0313304612336898, 1.0307809363565787, 1.2672413793103448, 1.0791327542575748, 1.0466749466524405, 2.5, 1.085522327382693, 1.050773150068132, 1.5, 2.0, 1.2052529182879377, 1.1319118607827998, 1.1087274929794615, 1.206266318537859, 1.0, 1.2123552123552124, 1.4721485411140585, 1.1644736842105263, 1.053101484174211, 1.1261194439865942, 1.049450120365749, 1.0694763196327979, 1.7142857142857142, 1.0235660594568972, 1.0320102432778488, 1.0475763016157988, 1.0804597701149425, 1.0199530516431925, 1.0, 1.3793103448275863, 1.1717530916618013, 1.010237417518437, 1.2083333333333333, 1.1074918566775245, 1.0616179589051113, 1.0647372429550648, 1.102112676056338, 1.2615384615384615, 1.0412542495776074, 1.2334674377671613, 1.0685775198389198, 1.2721518987341771, 1.1056910569105691, 1.0392706872370268, 1.125, 1.0905172413793103, 1.0225563909774436, 1.0047328842971335, 1.0208522212148685, 1.5, 1.0569444444444445, 1.0169768868889344, 1.1732050333086603, 1.1726373804506403, 1.0324235583829264, 1.0739966555183946, 1.1094162821009617, 1.364795918367347, 1.0517241379310345, 1.0248394284965263, 1.0810713582129183, 1.252433090024331, 1.037147102526003, 2.0, 1.1162790697674418, 1.073057248585111, 1.0191176470588235, 1.021725850575018, 1.096728419960816, 1.0351399642644432, 2.75, 1.073015873015873, 1.0812295163372727, 1.1734791786605259, 1.273015873015873, 1.0883338712480448, 1.0373333333333334, 1.1596715328467153, 1.0097134531325886, 1.033711264111903, 1.088031955753572, 1.0737864077669903, 1.0780542986425339, 1.0857142857142856, 1.1375983134679315, 1.399449035812672, 1.0114539532129108, 1.02977988778593, 1.098069105691057, 1.0303030303030303, 1.0327102803738317, 1.1820083682008369, 3.0, 2.5, 1.2105263157894737, 1.0305010893246187, 1.0316205533596838, 1.005673493562767, 1.0126329668763252, 1.0430260047281323, 1.028837542539853, 1.1222707423580787, 1.0633561643835616, 1.0642349337012698, 1.5, 1.6428571428571428, 1.2360557768924303, 1.0, 1.0102739726027397, 1.1359303771239122, 1.0602935641701168, 1.0881832189003622, 2.0, 1.0025866528711846, 1.160919540229885, 1.0980730897009967, 1.0401674119940374, 1.1794333683105982, 1.1312373810210556, 1.1345871019927936, 1.0829922027290448, 1.0094722598105548, 1.2941176470588236, 1.0867052023121386, 1.0, 2.0, 1.0415015198474193, 5.0, 1.5, 1.9696969696969697, 1.0482897384305836, 1.0771955266754052, 1.1783905458638153, 1.0075187969924813, 1.0, 1.009135583313489, 1.0121477162293488, 1.0041899441340782, 1.2620967741935485]
origin-bjaq_15.71 	max: 5.0000	99th: 3.0000	95th: 1.8013	median: 1.0824	mean: 1.1870

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.115674 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.377145