Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 0, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 3.0000	95th: 1.7284	median: 1.0789	mean: 1.1742
ReportEsts: [1.0128617363344052, 1.0234375, 1.0433791936113883, 1.1111111111111112, 1.5789473684210527, 1.0, 1.06193724420191, 1.0575514392588774, 1.0, 1.025, 1.144518512105734, 1.0424501090659986, 1.0487190256194876, 1.113953488372093, 1.0462734016248676, 1.0, 1.0888888888888888, 1.042862203329791, 3.0, 2.0, 1.2222222222222223, 1.0918809456531977, 1.0958012085851219, 1.115678214914856, 1.0641341884558462, 1.0, 1.1465029708640562, 1.5, 1.2, 1.0215827338129497, 1.0, 1.038812564782769, 1.0003722905096688, 1.0088790233074363, 1.0528711998825084, 1.2228155138871641, 1.106951871657754, 1.0028895418012287, 1.1369929058475101, 1.1071428571428572, 1.0773480662983426, 1.0152439024390243, 1.0, 1.0466458703827877, 1.1245446660884648, 1.8615384615384616, 1.0618556701030928, 1.2120141342756183, 1.0318926611099817, 1.0648148148148149, 1.0267121763003635, 1.0549828178694158, 1.0409207336753123, 2.0, 1.1896103896103896, 1.1596370235934663, 1.188418323249784, 1.3592233009708738, 1.0733333333333333, 1.25, 1.009269356597601, 1.0915317559153175, 1.1818181818181819, 1.0740740740740742, 1.0909090909090908, 1.1073166992449504, 1.3165374677002584, 1.75, 1.0, 1.0448401230539759, 1.016990291262136, 1.062754212667054, 1.0160183066361557, 1.1254685247477174, 1.1105882352941177, 1.0444874274661509, 1.0, 1.111482254697286, 2.0, 1.0354816494017045, 1.125, 1.0288281904271082, 1.1411042944785277, 1.0927318295739348, 1.1113837095191363, 1.0, 1.0579689829622927, 1.0029215846675237, 1.1323529411764706, 1.75, 1.1242484969939879, 1.0562434195434414, 1.0218068535825544, 1.026647966339411, 1.0, 1.0545454545454545, 1.0150375939849625, 1.1501472031403337, 1.0, 1.2380689350419796, 1.0092152627789777, 1.0497427101200687, 1.231702016689847, 1.2142857142857142, 1.0194574415601148, 1.0491106981683036, 1.266992563315825, 1.0883579825559349, 1.0462906192519927, 1.1666666666666667, 2.0, 1.0600467289719626, 1.060296715324512, 1.0214782059380922, 1.1948051948051948, 1.0576196038534484, 1.0, 1.1270892462945443, 1.132177681473456, 1.0, 1.0054945054945055, 1.1666666666666667, 1.2355889724310778, 1.0161899068647045, 1.0484584918847557, 1.0980392156862746, 1.8, 1.2160596026490067, 1.0, 1.0769230769230769, 1.1021050802057029, 1.1818181818181819, 1.0625, 1.0292663932624493, 1.1006422136976854, 1.0360480640854473, 1.092814371257485, 1.019485580670304, 1.039972432804962, 1.0798293723339427, 1.030704879418594, 1.2755905511811023, 1.0019607843137255, 1.13557094352022, 2.0, 1.0241567912488605, 1.0115606936416186, 1.1010928961748634, 1.1221104640903476, 1.5, 1.1181884233470574, 1.0266666666666666, 1.016260162601626, 1.1074561403508771, 1.1124087591240877, 1.1410991233985166, 1.1188690987760423, 1.158241069563401, 1.0647773279352226, 1.180921052631579, 1.3061224489795917, 1.1596638655462186, 1.0029455081001473, 1.5714285714285714, 1.0801365755518155, 1.0288679288442917, 1.1420118343195267, 1.3605012628715756, 1.1143635125936011, 1.1364395324799237, 1.2694736842105263, 1.0842824601366743, 1.122688099157548, 1.0434782608695652, 1.0043327556325823, 1.0495626822157433, 1.0499205087440382, 1.0954927425515661, 1.0553432413305024, 1.0, 1.0956521739130434, 1.012277730736664, 1.0285087719298245, 1.1595881595881596, 1.105263157894737, 1.0896778645897518, 1.3505669805881222, 1.1296236175140142, 1.1153846153846154, 1.2004545454545454, 1.087195023126504, 1.0, 1.1818181818181819, 1.0955167265243533, 1.0056753688989784, 1.0183098591549296, 1.3461538461538463, 1.0565916398713826, 1.0492454410457464, 1.05052460066305, 1.0626410835214446, 1.0689364393380416, 1.2203389830508475, 1.1228070175438596, 1.1666666666666667, 1.0, 1.3445378151260505, 1.085712032802397, 1.2682926829268293, 1.2758620689655173, 1.0098863074641622, 1.0031277926720286, 1.0119803044488367, 1.016590833425813, 1.201295154872435, 1.0232558139534884, 1.0664739884393064, 1.0, 1.0694324774541903, 1.0354993768915792, 1.0, 1.0285714285714285, 1.116636795147027, 1.0147765865558758, 1.1357575757575757, 1.0307760462813362, 1.2770876093766879, 1.0357142857142858, 1.0064796456443788, 1.1209386281588447, 1.0022611644997172, 1.1925465838509317, 1.087280108254398, 1.0568665377176016, 1.1866141732283464, 2.0, 1.2341790609507144, 1.063756141134435, 1.2121425222691045, 1.1404255319148937, 1.0, 1.6666666666666667, 1.132041293681082, 1.1272727272727272, 1.1538233770079207, 1.5, 1.0, 1.0810810810810811, 1.020686963309914, 1.0612244897959184, 1.0, 1.1265822784810127, 1.052364864864865, 1.001682085786375, 1.0517411587077292, 1.0, 2.0, 1.073900437974215, 1.080676256858965, 1.1330998248686515, 1.012542592553881, 1.1375494756305435, 1.0351958437324913, 1.1152623211446742, 1.0654014752741932, 1.0227272727272727, 1.0852187028657616, 1.1162440027416038, 1.0909090909090908, 1.0095017297712858, 1.088167053364269, 1.1818181818181819, 1.25, 1.0105454545454546, 1.0555555555555556, 1.0427350427350428, 1.0681649956261354, 1.0911854103343466, 1.3959899749373434, 1.006356627296588, 1.0721476510067114, 1.024242301225647, 1.0566775061673022, 1.25, 1.0289559839941798, 2.5, 1.0233339465776585, 1.0345572354211663, 1.0454098584497746, 1.0526315789473684, 2.0, 1.565217391304348, 1.0757575757575757, 1.0576467034697274, 1.0, 1.0504587155963303, 1.01131221719457, 1.0072115384615385, 1.0155836160029739, 1.0441988950276244, 1.1446540880503144, 1.0096415371440994, 1.0790365418078578, 1.0595762711864407, 1.170940170940171, 1.0, 1.094272076372315, 1.2530864197530864, 1.088135593220339, 1.05, 1.0133444537114262, 1.2157534246575343, 1.3111111111111111, 1.0013736263736264, 1.0007745933384973, 1.2857142857142858, 1.0013766940985713, 1.05, 1.1176470588235294, 1.1296108800350262, 1.1904761904761905, 1.4, 1.0114837591665082, 2.0, 1.1755829903978052, 1.0712209302325582, 1.1214109926168991, 1.0813905930470347, 1.1070496083550914, 1.1375, 1.101922374490997, 1.0692371980558733, 1.0746705710102489, 1.0690023929945742, 1.0411415326669564, 2.0, 1.0, 1.0645238693754429, 1.25, 1.0697544642857142, 1.3529411764705883, 1.0, 1.4666666666666666, 1.3514056224899598, 1.0699432892249527, 1.2403846153846154, 1.0389610389610389, 1.0, 1.2057256990679095, 1.066709593487388, 2.0, 1.2537224538415723, 1.0, 1.0964852349502772, 1.0348837209302326, 1.0437680398845448, 1.1566820276497696, 1.1363636363636365, 1.3635307781649244, 1.2685185185185186, 1.0351055390386938, 1.0174654316452034, 1.072857142857143, 1.0, 1.0769230769230769, 1.5714285714285714, 3.0, 1.2307692307692308, 1.0693787124298668, 1.3333333333333333, 1.0399334442595674, 1.10989010989011, 1.049740657002261, 1.072562714169871, 1.29351184346035, 1.0042926597889246, 1.0127610208816706, 1.0357142857142858, 1.5, 1.348314606741573, 1.0680851063829788, 1.0390292719539655, 1.1428571428571428, 1.5714285714285714, 1.0712694877505569, 1.0256410256410255, 1.0275047674930322, 1.003690036900369, 1.1464387464387464, 1.012311901504788, 1.0256410256410255, 1.0907770515613653, 1.1355932203389831, 1.2115384615384615, 1.0212464589235128, 1.1181818181818182, 1.0322417363294731, 1.0661598150708005, 1.0486311018558216, 1.1466666666666667, 1.0471698113207548, 1.1049382716049383, 1.0, 1.062096559082422, 1.0505346773368924, 1.0116780329813198, 1.065713640630756, 1.0698721227621484, 1.1420400381315539, 1.5714285714285714, 1.0298062593144561, 1.0, 1.2254483347566183, 1.25, 1.0447669699566917, 1.0283159463487332, 1.1332760103181427, 1.1225296442687747, 1.0550381033022862, 3.0, 1.2025361042620641, 1.0020055974401283, 1.123528600331065, 2.0, 1.126984126984127, 1.251439539347409, 1.303370786516854, 1.128494442573257, 1.002079002079002, 1.2352941176470589, 1.0327868852459017, 1.0006544043751606, 1.0768303221527764, 1.1092053885201094, 1.0788377192982457, 1.054726368159204, 1.0476190476190477, 2.142857142857143, 1.0395778364116095, 1.5, 1.2267782426778242, 1.0606060606060606, 1.143635175368528, 1.5625, 1.0869879954153345, 1.1415559641856707, 1.0931523750771128, 1.0, 1.163265306122449, 1.16, 1.28495, 1.1794310722100656, 1.0, 1.0488335023909579, 1.0666766904104097, 1.0368835474513054, 1.5, 2.0, 1.0169826224328593, 1.0090415913200723, 1.0032894736842106, 1.1111111111111112, 1.0657152398193226, 1.0861538461538462, 1.4705882352941178, 1.0046327683615819, 1.0454545454545454, 1.0892388451443569, 1.0056451612903226, 1.3096339924274296, 1.0544122987531777, 1.0, 1.0724637681159421, 1.0860090517087773, 1.0585356271791262, 1.0089462254059836, 1.0, 1.0822826808228267, 1.0159373799525229, 1.0214772132006287, 1.0, 1.049043062200957, 1.0372215101019349, 1.0750411444486645, 1.0004368529116248, 1.0126772346983708, 1.0050478594218772, 1.0067226890756302, 1.1029411764705883, 2.0, 1.0731303943356245, 1.3962264150943395, 1.0, 1.1865284974093264, 1.1538461538461537, 1.0085978394958823, 1.1371980676328501, 1.043265095475658, 1.2469022487379533, 1.0517061981223543, 1.132828351142973, 1.0479847891165899, 1.2117647058823529, 4.0, 1.0198439563077661, 1.1823886639676113, 1.0488361180572467, 1.0396025359434495, 1.1179604261796043, 1.17989417989418, 2.458823529411765, 2.4285714285714284, 1.016044212884063, 1.055441043753412, 1.004796495508484, 1.1205439176773244, 1.0633436174315465, 1.056644880174292, 1.090723265444455, 1.0690399137001079, 1.2095531587057011, 3.0, 1.0833333333333333, 1.0153374233128833, 1.082375478927203, 1.0567375886524824, 1.2048710601719197, 1.0392156862745099, 1.3724137931034484, 1.148905109489051, 1.123456790123457, 1.0968242051357175, 1.2417582417582418, 1.0398041359345889, 2.0, 1.14379622021364, 1.045643153526971, 1.396039603960396, 1.1131284916201116, 1.1051995163240629, 1.0059642147117296, 1.1167315175097277, 1.059607981279722, 1.0, 1.5106382978723405, 1.2, 1.0, 1.1931818181818181, 1.0987903225806452, 1.0, 1.0728155339805825, 1.0653636654918295, 1.0591647331786542, 1.0513974931566057, 1.1663504111321947, 1.0402476780185759, 1.0847302555473761, 1.1837837837837837, 1.077119184193754, 1.0372520561199807, 1.0693855932203389, 1.0852601156069364, 1.174960380348653, 1.0768256220544266, 1.209656453110492, 1.0788296528851489, 3.0, 1.2751842751842752, 1.0863453815261044, 1.4339622641509433, 1.0, 1.0, 1.25, 1.1577868852459017, 1.4444444444444444, 1.1666666666666667, 1.006845481900838, 1.1386539317657534, 1.0264168757598489, 1.0362114813076804, 1.2162162162162162, 1.1151761517615175, 1.0, 1.1240875912408759, 1.0412208258527829, 1.0516110181422158, 1.0856442229932435, 1.1308235562136917, 1.0164655423088107, 1.1662337662337663, 1.137239539217347, 1.1243339253996447, 1.0106509406462318, 1.1264236902050113, 1.303030303030303, 1.0578947368421052, 1.0, 1.2387640449438202, 1.2079909613804438, 3.0, 1.135679555452651, 1.0633560069859362, 1.4285714285714286, 1.055714014071116, 1.5, 1.0555555555555556, 1.004067468782888, 1.6153846153846154, 1.030594733089204, 1.0521144809910294, 1.3571428571428572, 1.1153846153846154, 1.0350515463917527, 1.029172644667623, 1.0589403973509934, 1.1329306167025017, 1.1557358300675522, 1.0, 1.0879317836193787, 1.1280487804878048, 2.0, 1.0219572387388427, 1.1134873258932434, 1.1570482497634815, 1.021029004425483, 1.0174065813573894, 1.0560747663551402, 2.0, 1.0669642857142858, 1.0201612903225807, 1.0795818980876588, 1.1849802371541502, 1.0161317280371622, 1.0442051296340156, 1.2619047619047619, 1.110285006195787, 1.1772575250836121, 1.072219803031478, 1.0599369085173502, 1.039855072463768, 1.00581088219757, 1.06893611439066, 3.0, 1.1285207100591717, 1.011471948522019, 1.0314194845232354, 1.7272727272727273, 1.304124427162894, 1.2044444444444444, 1.1428571428571428, 1.1096141637864145, 1.0420575865415722, 1.2085152838427948, 1.0588235294117647, 1.3333333333333333, 1.0433074795403348, 1.5, 1.1331775700934579, 1.0833333333333333, 1.056416160770358, 1.44, 1.1223628691983123, 1.0744234800838575, 1.0, 1.4246031746031746, 1.2678275290215588, 1.25, 2.0, 1.1176470588235294, 1.1758620689655173, 1.0105136677680986, 1.1957340025094103, 1.0829103214890017, 1.176991150442478, 1.1014466214978942, 1.0597402597402596, 1.1036036036036037, 1.0448979591836736, 1.0833333333333333, 1.0, 1.1791221826809015, 1.0822510822510822, 1.0020661157024793, 1.0722061764052433, 1.067388853243299, 1.036078498585997, 1.1094551329558593, 1.2642061885482938, 1.1169354838709677, 1.0244498777506112, 1.5714285714285714, 1.0, 1.2592592592592593, 1.0271913182059649, 1.082965578111209, 1.107843137254902, 1.1502463054187193, 1.0413134784268805, 1.0051636500551326, 1.0121353681339365, 1.0985915492957747, 1.2222222222222223, 1.0297256097560976, 1.0380434782608696, 1.0735359379365887, 1.0303694725517165, 1.006578947368421, 1.0586975782634376, 1.0181942948999863, 1.1762048192771084, 1.3029531568228105, 1.125, 1.060823754789272, 1.7514792899408285, 1.1555555555555554, 1.0699708454810495, 1.0701001430615165, 1.0, 1.042857142857143, 1.0047223210531422, 1.037037037037037, 1.059139142964042, 1.0031880977683316, 1.162162162162162, 1.0608171501278805, 1.0229992790194664, 1.0660085952189096, 1.0219465648854962, 1.0045610034207526, 1.2071980134027283, 1.1864406779661016, 1.2142857142857142, 1.0, 1.4285714285714286, 1.0624197650478382, 1.3333333333333333, 1.2308501217622316, 1.0936406224759032, 1.0319007532122286, 1.0369414101290964, 1.0504390443128446, 1.0937834941050375, 1.032258064516129, 1.0249653259361997, 1.0029962195036044, 1.1090644919385078, 1.0397892659196937, 1.2325364326147177, 1.6666666666666667, 1.015625, 1.0355731225296443, 1.1157232486394675, 1.01628664495114, 1.3019489431786988, 1.0741444866920151, 2.1829787234042555, 1.0456545318443606, 1.0416107382550335, 1.0339832535885167, 1.125, 1.0552738098039678, 1.040435746732976, 1.335263157894737, 1.0581052631578947, 1.2307692307692308, 1.029768467475193, 1.1043956043956045, 1.5625, 1.0515913848774083, 1.6538461538461537, 1.0530785562632696, 1.0833333333333333, 1.0824817518248175, 1.031076388888889, 1.0059171597633136, 2.2, 1.0566037735849056, 1.101511084966359, 1.0516917606533696, 1.01478654455575, 1.0733053074093537, 1.0679966110873345, 1.1818181818181819, 1.0810580204778157, 1.0402357244462508, 1.0465422563507298, 1.0150300601202404, 1.0138888888888888, 1.0113999088007295, 1.021866897147796, 1.3317214700193423, 1.0661668960898842, 1.0, 1.3333333333333333, 1.0529061287052832, 1.0177289995778809, 1.2480705622932746, 1.0915207117041978, 1.0614525139664805, 1.1335012594458438, 1.100836857201999, 1.062461942761914, 1.0919117647058822, 1.0, 1.0453879941434847, 1.0947086830609138, 1.0833333333333333, 1.75, 1.051864016008352, 1.1655746699803118, 1.007981755986317, 1.0414201183431953, 1.2429398986241853, 1.0231719290257402, 1.1557492268765814, 1.3840830449826989, 1.2692307692307692, 1.017520215633423, 1.0969976905311778, 1.15625, 1.5925925925925926, 1.0578276902447201, 1.1724479682854312, 1.1600331674958542, 1.0731707317073171, 1.0331628046945531, 1.0178640030733768, 1.0670013386880857, 1.215290156466627, 1.3333333333333333, 1.2173913043478262, 2.0, 1.1354928596307907, 1.4230769230769231, 1.0, 1.1538461538461537, 1.0543046357615895, 1.065217391304348, 1.0374167276883786, 1.0579048453399824, 1.0163636363636364, 1.2830188679245282, 1.1428571428571428, 1.1071428571428572, 1.054054054054054, 1.0, 1.1443850267379678, 1.0286499665682851, 1.0287150755074024, 1.3195876288659794, 1.0727313760489117, 1.047184825584305, 2.5, 1.0703786873532715, 1.3333333333333333, 3.0, 2.0, 1.170414201183432, 1.1242200387291115, 1.0996490217135075, 1.173913043478261, 1.0, 1.162162162162162, 1.1687116564417177, 3.0, 2.0, 1.023419793502896, 1.2692566205135098, 1.0073001887979862, 1.6666666666666667, 1.0165001849796522, 1.0449264136328427, 1.0574837310195229, 1.0, 1.0938967136150235, 1.0232086230971886, 1.1710526315789473, 1.2059709309938458, 1.000426679079149, 1.3364779874213837, 1.08984375, 1.1144883485309016, 1.0390417036379769, 1.06198347107438, 1.0, 1.0229507927784567, 1.61198738170347, 1.0611829727187205, 1.31496062992126, 1.1666666666666667, 1.3582089552238805, 1.0794078061911172, 1.0557111733582323, 1.0281917077175697, 1.0891741712971834, 1.019650655021834, 1.5, 1.6666666666666667, 1.1142683628460015, 1.1939313984168864, 1.0832522855475588, 1.0210908064456745, 1.0597089814350227, 1.1081616314835883, 1.172872340425532, 1.0434782608695652, 1.1054948510337237, 1.0843109860080953, 1.2654735272184936, 1.0402802101576183, 2.5, 1.0869565217391304, 1.1244998143640939, 1.1274245689655173, 1.0097183719758065, 1.0992364429669645, 1.0348011363636365, 2.0, 1.0713391739674594, 1.0409592359173927, 1.179118117432031, 1.3193916349809887, 1.0958673055833692, 1.0764331210191083, 1.4183222958057395, 1.0655072463768116, 1.0312092873032634, 1.062884081151612, 1.044930875576037, 1.0427236315086783, 1.0, 1.175218395421227, 1.0534555260992777, 1.0572625698324023, 1.0652667877002477, 1.1031307550644567, 1.0045385779122542, 1.2857142857142858, 1.2329842931937174, 1.6666666666666667, 2.0, 1.1764705882352942, 1.010230179028133, 1.0545023696682465, 1.0879964445880974, 1.0041961405814468, 1.0206241519674355, 1.0056485355648535, 1.0978260869565217, 1.1951219512195121, 1.048247367719579, 1.6, 1.5833333333333333, 1.06622746185853, 1.1428571428571428, 1.0330123796423658, 1.1059795819154108, 1.0298332582244254, 1.0945610361786045, 2.0, 1.1235294117647059, 1.2306201550387597, 1.0062344139650872, 1.0398955934567007, 1.1376262626262625, 1.1321917808219177, 1.1313974751591795, 1.102895798718253, 1.0476947535771066, 1.0597014925373134, 1.0377094972067038, 1.0, 1.0, 1.0417322341833268, 5.0, 1.4285714285714286, 2.0, 1.0310945273631842, 1.0930232558139534, 1.0759423503325942, 1.0768928991761475, 1.0, 1.0235878336436997, 1.0169392523364487, 1.1861702127659575, 1.3100961538461537, 1.4285714285714286, 1.0734369438842093, 1.028270509977827, 1.1521252796420582, 1.0109022556390976, 1.0236680321088472, 1.0814032367477469, 1.1049985211475895, 1.0, 1.2534585607310573, 1.074560586824658, 1.0490943328550932, 1.1774193548387097, 1.0865751135710928]
origin-bjaq_15.71 	max: 5.0000	99th: 3.0000	95th: 1.7284	median: 1.0789	mean: 1.1742

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 14.098628 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[1.6093254e-06 9.5367432e-07 2.9802322e-07 1.7881393e-07 3.5762787e-07]
Distance score: 6.794929277020856e-07
SAUCE Drift detection: False
Detection latency: 0.0233s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.035157 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 6.0000	99th: 3.0000	95th: 2.0000	median: 1.0920	mean: 1.2182
ReportEsts: [1.0779569892473118, 1.0233059991368147, 1.0600214233273557, 1.1509090909090909, 1.5416666666666667, 2.0, 1.1035769975901337, 1.0533036394629967, 1.1666666666666667, 1.0240963855421688, 1.1635022111132474, 1.0424768453286741, 1.0415012630819198, 1.0794573643410852, 1.0814945572227126, 1.698581560283688, 1.1362229102167183, 1.4285714285714286, 1.1818181818181819, 1.0918964076858815, 1.0608705258506408, 1.0077393075356416, 1.2048780487804878, 1.0205423171733772, 1.011481559388585, 1.0288263238505093, 3.0, 1.1543353123775655, 1.6, 1.3333333333333333, 1.0387858347386172, 2.0, 1.0453632635314145, 1.0112586215837784, 1.05724838411819, 1.0414927571814387, 1.224624125268482, 1.219954648526077, 1.24, 1.0349358842447511, 1.1232940302664562, 1.0694483043991132, 1.1953125, 1.209964412811388, 1.0302457466918715, 1.0209670101756432, 1.45, 1.0734557595993321, 1.075098814229249, 1.0582800284292821, 1.0555555555555556, 1.3285714285714285, 1.0283400809716599, 1.15625, 1.0335739094021725, 1.0460980810234541, 1.0332805071315372, 1.1454081632653061, 1.1235955056179776, 1.0216650697327798, 1.4461538461538461, 1.0706122867945187, 1.0652503793626706, 1.144486692015209, 1.0095238095238095, 1.5, 1.0551713632901751, 1.2947672889823822, 2.0, 2.0, 1.067278525316948, 1.0253549695740365, 1.0898058252427185, 1.0191938579654511, 1.0884129811788397, 1.029137529137529, 1.022636484687084, 1.1633663366336633, 1.5436893203883495, 1.0907979267046284, 1.0149686141960406, 1.1527777777777777, 2.0, 5.0, 1.036117381489842, 1.2241379310344827, 1.107843137254902, 1.5384615384615385, 3.0, 1.0900768481091532, 1.1110610159302674, 1.1839296924042686, 1.0742202516722623, 1.0336744186046511, 1.0403022670025188, 1.008274231678487, 1.04857621440536, 1.1108247422680413, 1.375, 1.3514594162335065, 1.1724137931034482, 1.1428571428571428, 1.0505531378543873, 1.1148036253776434, 1.076644974692697, 1.2177326832066542, 1.3125, 1.0218024816130746, 1.0567170818505338, 1.239193083573487, 1.1675078864353312, 1.0582474226804124, 1.1111111111111112, 2.25, 1.0683145192681978, 1.0740362650894726, 1.0640625, 1.1382978723404256, 1.0578132445268278, 2.0, 1.0933121860956911, 1.160482374768089, 1.5, 1.0045045045045045, 1.125, 1.2478813559322033, 1.0248084404102322, 1.0793568799638407, 1.1008403361344539, 2.0, 1.2045143638850888, 2.0, 1.0, 1.1422884650990557, 1.25, 1.4112903225806452, 1.0001550662354348, 1.1586880775640054, 2.0, 1.3571428571428572, 1.072494669509595, 1.1104625056129322, 1.0629405840886204, 1.0097199769844096, 1.1801242236024845, 1.035557986870897, 1.0721272511198465, 1.5, 1.0144212523719165, 1.012310606060606, 1.1367570686670514, 1.0967554197584752, 2.5, 1.143639683505782, 1.0151898734177216, 1.0136286201022147, 1.011764705882353, 3.0, 1.042099792099792, 1.0595721442647863, 1.1387790197764402, 1.1076388888888888, 1.110803324099723, 1.1014492753623188, 1.3333333333333333, 1.0173053152039555, 1.2, 1.044574542308007, 1.15625, 1.2756508422664625, 1.1135298775091984, 1.0335143522110164, 1.0266188251001336, 1.21280276816609, 1.0694183864915572, 1.1274280648021278, 1.0414554670528602, 1.0183150183150182, 1.0804597701149425, 1.038511579495186, 1.2159351582810827, 1.218969190003637, 1.2341772151898733, 1.3823529411764706, 1.0088667930910769, 1.037195690898295, 1.264808362369338, 1.2374768089053803, 1.0272277227722773, 2.0, 1.2605042016806722, 1.1058312867668056, 1.125, 1.1485249237029502, 1.0466897233201582, 1.0324291872527214, 1.1155130454468278, 1.0495540138751238, 1.1127513848336836, 1.020250982926698, 1.002870028700287, 1.0642729955850427, 1.0256898192197907, 1.0555108608205954, 1.07475317348378, 1.0638837840203028, 1.280373831775701, 1.161764705882353, 1.188235294117647, 2.0, 1.4782608695652173, 1.130417599789224, 1.2889518413597734, 1.3714285714285714, 1.002867677181483, 1.4, 1.0448627682600506, 1.0112866817155757, 1.2143680216156076, 2.0, 1.1, 1.021380243572395, 1.0436876957280485, 1.0082763133835686, 1.5, 1.24486301369863, 1.0719469244000328, 1.0023049507011108, 1.0211081794195251, 1.0134453781512605, 1.03737780333525, 1.0889147415655642, 1.3414634146341464, 1.0029756899676738, 1.1802900959431895, 1.0795107033639144, 1.0185840707964602, 1.044296788482835, 1.09375, 1.16776750330251, 1.0, 1.2404505386875613, 1.119503893318413, 1.12697792537605, 1.1902985074626866, 1.0714285714285714, 1.2, 1.0970764178054073, 1.125, 1.143202472384566, 1.4, 1.073394495412844, 1.0940265486725664, 1.5714285714285714, 1.0031331881175616, 1.0115740740740742, 1.1326164874551972, 1.032171581769437, 1.0116156282998945, 1.0490450061949892, 1.1076923076923078, 1.0, 1.0609956236323852, 1.0673985036183, 1.1359649122807018, 1.0454679760145997, 1.1175065623004705, 1.0246318532737386, 1.1001317523056653, 1.0626300518742124, 1.029603612644255, 1.048079246194733, 1.0182470527934393, 1.1333333333333333, 1.0051310428089943, 1.1341463414634145, 1.169811320754717, 1.5, 1.1157755192222714, 1.0921375921375922, 1.0312671809878513, 1.0258311660926407, 1.134433962264151, 1.3632567849686847, 1.0299357199268226, 1.0784034212401996, 1.072170186445171, 1.0568936080641766, 1.2, 1.3061224489795917, 1.1108857336037863, 1.0912045312101024, 1.5470319634703196, 1.0714871315501138, 1.2430299842188322, 1.1686407219402144, 1.0318001135718342, 1.040307296602139, 1.1476502811013407, 1.003801331123563, 1.096836049856184, 1.0705882352941176, 1.0666666666666667, 1.0784636078314154, 1.25, 1.0674157303370786, 1.135254386858093, 1.061387226305023, 1.394736842105263, 1.015267175572519, 1.2072538860103628, 1.049012816072047, 1.0037164499883144, 1.1818181818181819, 1.0866215269670791, 1.0116327240790761, 1.375, 1.4285714285714286, 1.6, 1.0457290767903364, 1.25, 1.0088550227245678, 1.0518053375196232, 1.3, 1.0633864491987124, 1.375, 1.3333333333333333, 1.0129374531347362, 3.0, 1.0241379310344827, 1.046285018270402, 1.0277705003929787, 1.1285714285714286, 1.0, 1.1287128712871286, 1.0991612721643682, 1.10198279238759, 1.12, 1.0053900027464981, 1.0296617725732629, 1.5, 1.1818181818181819, 1.0432744423102525, 1.2, 1.0693023255813954, 1.125, 1.3333333333333333, 1.4736842105263157, 1.3369565217391304, 1.078369905956113, 1.1893939393939394, 1.0192644483362523, 1.3205128205128205, 1.6666666666666667, 1.0363967049765046, 1.75, 1.28125, 1.0287969616496133, 1.1027667984189724, 1.0449438202247192, 1.0459231490159324, 1.4, 1.25, 1.3290529695024078, 1.319327731092437, 1.253071253071253, 1.129953131657435, 1.2327682217547333, 1.0591259640102828, 1.3333333333333333, 1.029284830847581, 1.069767441860465, 1.4333333333333333, 1.5, 1.2029411764705882, 1.4285714285714286, 1.0774487471526195, 1.28, 1.180626184066208, 1.079108962633917, 1.1082897684839432, 1.0651959710970003, 1.1101865521406522, 1.0579710144927537, 1.0884955752212389, 1.1307921562672032, 1.137221269296741, 1.1875, 1.0033578184125902, 1.0425987309404299, 1.0025706940874035, 1.013953488372093, 1.0238095238095237, 1.1635220125786163, 5.0, 1.0666666666666667, 1.1904761904761905, 1.1650485436893203, 1.4137931034482758, 1.1018518518518519, 1.106359649122807, 1.027360988526037, 1.1101934134866702, 1.1051004636785162, 1.1352839931153185, 1.2674418604651163, 1.2571428571428571, 1.1328125, 3.0, 1.2569668157507898, 1.4705882352941178, 1.1040031693329309, 1.0713523043305522, 1.0526536079022266, 1.1484024293636124, 2.0, 1.15270708005553, 1.1428571428571428, 1.0447658402203857, 1.1818181818181819, 1.0506991718070335, 1.0023809523809524, 1.1014922689679971, 1.076158940397351, 1.1054945054945056, 5.0, 1.1909722222222223, 1.0039491305318264, 1.1088110708604066, 4.0, 1.1923076923076923, 1.226475279106858, 1.3006134969325154, 1.097430114141207, 1.036529639849871, 1.0, 1.0725075528700907, 1.0263752976726501, 1.0719039279459595, 1.0278430902607036, 1.033911885801632, 1.100582147477361, 1.0482758620689656, 1.0141681901279707, 1.0936056163369803, 1.084033613445378, 1.1136612021857923, 2.0, 1.0, 1.2293814432989691, 1.050387596899225, 1.0445702157764414, 1.079567555199634, 1.0728105906313645, 3.0, 1.2882882882882882, 1.2333333333333334, 1.0963142637401644, 1.125, 2.0, 1.0701710766641486, 3.0, 2.0, 1.0111026033690658, 3.3333333333333335, 1.0061132561132562, 1.0158850226928895, 1.0112676056338028, 1.0, 1.0676449429624302, 1.1343283582089552, 1.5, 1.0623957185581614, 1.0144927536231885, 1.008611410118407, 1.0402455661664394, 1.327259985984583, 1.0053838388693939, 2.0, 1.0, 1.169279350400361, 1.0480466288594834, 1.0677290836653386, 1.2, 1.0937384898710865, 1.0238007294257345, 1.0209332751853466, 1.0, 1.041708043694141, 1.0297607017260197, 1.0664102362822827, 1.0449454545454546, 1.0018152773743827, 1.0218088203315165, 1.0421909696521094, 1.1577045894226512, 2.25, 1.1321072399948193, 1.072674418604651, 1.0513068731848985, 1.0103542234332425, 1.0107238605898123, 1.0088385898526324, 1.039152759948652, 1.0679858949764784, 1.113821138211382, 1.105228263909751, 1.115702479338843, 1.1003701771384562, 1.1001206272617612, 1.0114942528735633, 1.1764705882352942, 1.0984544970459214, 1.1070663811563168, 1.0088226748025464, 1.0743503780442378, 1.6666666666666667, 1.039528696313189, 1.3333333333333333, 1.1724137931034482, 1.1538461538461537, 1.0189768616178287, 1.1007194244604317, 1.2708237459733087, 2.0, 1.0, 1.01074777040933, 1.163396470228177, 1.0507462686567164, 1.0183516026806587, 1.105078125, 1.015676028739386, 1.0142421159715158, 1.0132900748589884, 1.5, 1.019507688963756, 1.0717761557177616, 1.135678391959799, 1.1402112914767806, 1.4230145867098865, 1.036587400382429, 4.0, 1.161917998610146, 1.0133333333333334, 1.136997700646009, 1.0412147505422993, 1.125748502994012, 1.1762452107279693, 1.1857451403887689, 1.0620332779402175, 2.0, 1.6964285714285714, 1.4, 1.3333333333333333, 1.2, 1.2352941176470589, 1.007741935483871, 1.0699588477366255, 1.0704922418405565, 1.0366598778004072, 1.0534037558685445, 1.1405669691128766, 1.03669579345737, 1.0533087464900883, 1.003340494612887, 1.1067323481116584, 1.070244874715262, 1.0618728036233078, 1.00830078125, 1.0010493179433368, 1.1013268998793728, 1.432, 1.0636934928035677, 1.127039627039627, 1.0991201539730546, 1.2971428571428572, 1.166070150322119, 1.0609007164790174, 1.3333333333333333, 1.0287081339712918, 1.1666666666666667, 1.5, 1.4462809917355373, 1.0439725288892014, 1.0419501133786848, 1.0025773195876289, 1.0765027322404372, 1.0893103814684943, 1.0320662943613763, 1.1053604436229205, 1.6, 1.0, 1.0369207031465255, 1.1511111111111112, 1.0653830726032891, 1.100653900046707, 3.0, 1.1565683646112601, 1.182608695652174, 1.1540956579395374, 1.0955882352941178, 1.0575504640262916, 1.0517615350060965, 1.0038878963647382, 1.3695652173913044, 1.0, 1.1781402586253151, 2.0, 1.0480192076830732, 1.194915254237288, 1.3793103448275863, 1.0738255033557047, 1.7916666666666667, 1.0148437558926242, 1.0662251655629138, 1.1666666666666667, 1.0308101939901102, 1.25599481529488, 1.086599241466498, 1.0744280630401626, 1.0181323662737987, 1.0725694444444445, 2.0, 1.0184326409726823, 1.0346451957770948, 1.1363636363636365, 1.0250521920668059, 1.2482862903225806, 1.0065359477124183, 1.006852968564945, 1.6666666666666667, 1.0087565674255692, 1.038323120319035, 1.002267573696145, 1.1647727272727273, 1.0379499726697727, 1.0075187969924813, 1.3333333333333333, 1.0541987286717966, 1.0039499670836076, 1.1592790349464643, 1.1913188647746245, 1.0076469429050692, 1.0422366401747845, 1.2522658610271904, 1.1683417085427135, 1.162534435261708, 1.0101985842847172, 1.0845665961945032, 1.1560121765601217, 1.0039647577092512, 1.0023734860767342, 1.006993006993007, 1.1299167618736738, 1.0, 1.1428571428571428, 1.0870646766169154, 1.621894858463316, 1.0537566802892173, 1.103244837758112, 1.2142857142857142, 1.0372771474878444, 1.0308575529242914, 1.119205298013245, 1.0553748159309613, 3.0, 1.1557353261263876, 2.5, 1.1136801541425818, 1.0666666666666667, 1.0591088648774254, 1.3225806451612903, 1.1588447653429603, 1.0335689045936396, 2.0, 1.1055341055341055, 1.2525737817433082, 1.0, 3.0, 1.1041666666666667, 1.1589595375722543, 1.0230788739538423, 1.2174369747899159, 1.1416058394160584, 1.1961722488038278, 1.0421836228287842, 1.022695035460993, 1.1411764705882352, 1.3129251700680271, 1.206896551724138, 1.5, 1.2763713080168777, 1.0046783625730995, 1.0242805755395683, 1.042242079610073, 1.071401748273632, 1.0253817873303168, 1.0984041568443528, 1.1198332233487311, 1.2138590203106332, 1.018472291562656, 1.4444444444444444, 1.5, 1.4375, 1.0053621006219782, 1.0371991247264771, 1.1400560224089635, 1.0402542372881356, 1.0406529886298672, 1.0631420369623497, 1.0084291678405861, 1.1071428571428572, 1.1818181818181819, 1.588235294117647, 1.0297078999778713, 1.0699533917417274, 1.0614410004800994, 1.0277777777777777, 1.096164535853252, 1.0788306588123773, 1.2025316455696202, 1.0087082728592163, 1.0900832643369316, 1.1494661921708185, 1.0590086546026751, 1.2212389380530972, 1.0261112416622982, 2.0, 1.0506078597681652, 2.0, 1.10062893081761, 1.0282913127439197, 1.1355932203389831, 1.0520642156245652, 1.0285204991087344, 1.5526315789473684, 1.0263755875364453, 1.04291794041839, 1.0810621747159885, 1.0266875981161696, 1.0248565965583174, 1.192139615664743, 1.176043557168784, 1.2352941176470589, 2.0, 1.3333333333333333, 1.071934604904632, 1.1111111111111112, 1.148131553006542, 1.1025147233356474, 1.0331354146715188, 1.0747959353656504, 1.2893386188191112, 1.0914438502673798, 1.0611620795107033, 1.0506912442396312, 1.0084391325120028, 1.147627211096392, 1.039736420065978, 1.2829938109198427, 1.625, 1.084848484848485, 1.0163398692810457, 1.1381996537795729, 1.047486033519553, 1.2959045904590458, 1.0287878787878788, 2.246376811594203, 1.0317762290450179, 1.0564784053156147, 1.0337613217875983, 1.2352941176470589, 1.0691808191808192, 1.037717068280282, 1.2623762376237624, 1.050888811432555, 1.1666666666666667, 1.0393700787401574, 1.1460176991150441, 1.030808361815436, 1.1071428571428572, 1.019748121442497, 1.4444444444444444, 1.0903482022551592, 1.0515075376884422, 1.0524296675191815, 1.0436432637571158, 1.0018083182640145, 1.0086206896551724, 1.0688279301745636, 1.0080592325968727, 1.0580399619410086, 1.003028660098338, 1.0619031056620727, 1.0, 1.1012747875354107, 1.0951219512195123, 1.0162327718223583, 1.1172069825436408, 1.0605726872246697, 1.1053677932405566, 1.110655737704918, 1.0304182509505704, 1.041960595379973, 1.875, 1.1134626690182245, 1.245134927377918, 1.039802065404475, 1.0784641068447411, 1.0773598597655218, 1.0897902529302899, 1.0556647020301244, 1.0843373493975903, 1.1054837066373062, 1.0959331199646838, 1.1313291139240507, 1.0599078341013826, 1.0257639304973039, 1.0853935109512913, 1.0091743119266054, 2.5, 1.0445632317342044, 1.1633826274999663, 1.0235124760076775, 1.0092592592592593, 1.1791819291819292, 1.0100826755978172, 1.1582902771254109, 1.0341948310139164, 1.0833333333333333, 1.0187018701870187, 1.3695652173913044, 1.0945273631840795, 1.59375, 1.050819061801936, 1.1821192052980132, 1.0072289156626506, 1.1111111111111112, 1.0782312925170068, 1.1307401404646138, 1.0490196078431373, 1.5, 1.0321583178726035, 1.0691056910569106, 1.0920183019827148, 1.3076923076923077, 1.0068014534612877, 1.0832214765100672, 1.0605017215937038, 1.2695652173913043, 1.0476190476190477, 1.283386674425371, 1.0715679196301018, 1.044425678014204, 1.1868300153139357, 1.1904761904761905, 1.2352941176470589, 1.0526315789473684, 1.1529411764705881, 1.0240963855421688, 1.0798827409307439, 1.029234253879377, 1.0268693069245725, 1.3391304347826087, 1.0865243947561662, 1.047054115567709, 3.0, 1.0439375055079252, 1.0400835618226922, 4.5, 2.5, 1.1903709162367968, 1.1402333233622495, 1.0799073289500498, 1.1243654822335025, 2.5, 1.108303249097473, 1.3689567430025444, 1.434782608695652, 1.0465085345027332, 1.1177673193287687, 1.0569594289699307, 1.0825096243887213, 1.7142857142857142, 1.0109489763208874, 1.0738031914893618, 1.0212389380530973, 1.1205128205128205, 1.0105386416861826, 2.0, 1.309090909090909, 1.2056807051909892, 1.038567955059948, 1.1524064171122994, 1.0126582278481013, 1.0608161527701758, 1.0597014925373134, 1.0303030303030303, 1.2608695652173914, 1.0333397058622715, 1.3861760179096125, 1.0587088748934836, 1.3223684210526316, 1.139344262295082, 1.1676712328767123, 1.25, 1.0848969547831437, 1.0331632653061225, 1.0198239297691853, 1.0568079350766457, 2.5, 1.1347150259067358, 1.0315422017204838, 1.2033457249070632, 1.1028403525954946, 1.1493099121706398, 1.027812543457099, 1.0790797987059668, 1.0609037328094302, 1.0526315789473684, 1.044498328855102, 1.096445398342839, 1.2107784431137725, 1.1483333333333334, 2.0, 1.1046511627906976, 1.0422926093514329, 1.107981220657277, 1.0055882698559846, 1.1044112312268737, 1.0029342723004695, 2.0, 1.0516528925619835, 1.0040310362242322, 1.1771050141911068, 1.4193548387096775, 1.084387683208796, 1.0580474934036939, 1.1674167416741674, 1.0168837433671007, 1.0313913138103645, 1.046762621173691, 1.0393096836049855, 1.0561797752808988, 1.105263157894737, 1.182260636066124, 1.184282516786869, 1.0148218527315915, 1.045054405054405, 1.1180773249738767, 1.0238244514106583, 1.2118380062305296, 1.2854030501089324, 2.3333333333333335, 1.6666666666666667, 1.1904761904761905, 1.0107296137339057, 1.0502313284864508, 1.0270561740730169, 1.0193454659398022, 1.0098420691233692, 1.0042075736325387, 1.2081447963800904, 1.035900405327157, 1.0687384715963482, 1.8333333333333333, 1.6153846153846154, 1.009433962264151, 1.125, 1.0228310502283104, 1.1716481639624252, 1.032658589811122, 1.0952075122195255, 2.5, 1.1218079673135852, 1.012857142857143, 1.0756176643470676, 1.039999694308794, 1.1072916666666666, 1.1146983857264232, 1.1342433956007516, 1.2026224908266783, 1.019736842105263, 1.037037037037037, 1.0729166666666667, 1.6666666666666667, 2.0, 1.041232238076797, 6.0, 1.3333333333333333, 2.161290322580645, 1.0010162601626016, 1.0376744413549706, 1.1111111111111112, 1.0111524163568772, 1.0, 1.139597702656631, 1.016003879728419, 1.0076923076923077, 1.2966601178781925]
origin-bjaq_15.71 	max: 6.0000	99th: 3.0000	95th: 2.0000	median: 1.0920	mean: 1.2182

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.235547 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.396317