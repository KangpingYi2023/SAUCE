Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 45, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.4293	95th: 1.6667	median: 1.0810	mean: 1.1701
ReportEsts: [1.0222222222222221, 1.0067708333333334, 1.054656192584234, 1.0855949895615866, 1.5, 1.0, 1.01730357049506, 1.0539429842544548, 1.0, 1.020969855832241, 1.1734049000086573, 1.0429765705318976, 1.0530738611233967, 1.0767441860465117, 1.0561638996820912, 1.0, 1.2222222222222223, 1.0060584461867428, 3.0, 2.0, 1.08, 1.1505061532354108, 1.132679984922729, 1.0751614797416325, 1.0809077454366058, 1.0, 1.1584867445477232, 1.0, 1.4, 1.0359712230215827, 1.0, 1.041369290038525, 1.0141663796073028, 1.1764705882352942, 1.0906153620208547, 1.2213494294691583, 1.1229946524064172, 1.0136954606095514, 1.202493284661478, 1.119047619047619, 1.1818181818181819, 1.0182926829268293, 1.0, 1.0681642368342754, 1.0736999006293475, 1.8333333333333333, 1.0510204081632653, 1.2120141342756183, 1.0342264687944704, 1.0740740740740742, 1.0289007311934564, 1.3006872852233677, 1.0400623527876778, 2.0, 1.1974025974025975, 1.1548165552141696, 1.16723259762309, 1.3461538461538463, 1.0522875816993464, 1.25, 1.117570883315158, 1.1008717310087173, 1.1, 1.0229885057471264, 1.0, 1.0646742334905661, 1.2553125962426857, 1.75, 1.0, 1.0657220098816071, 1.0119331742243436, 1.0566146735990756, 1.0113895216400912, 1.0869726644080382, 1.051764705882353, 1.08, 1.0, 1.1152400835073069, 2.0, 1.0229848776148527, 1.1875, 1.0679394162292286, 1.2269938650306749, 1.0954773869346734, 1.1216879293424926, 1.04, 1.0772913949821905, 1.0486736005609443, 1.053921568627451, 1.75, 1.0706106870229009, 1.0687543747169301, 1.102803738317757, 1.0532959326788218, 1.0118721461187214, 1.0077922077922077, 1.0305343511450382, 1.154679802955665, 1.0, 1.2417728531855956, 1.0600431965442765, 1.0951972555746141, 1.2308995352473613, 1.2142857142857142, 1.0034000245103432, 1.0018582426333953, 1.229212916246216, 1.0967007963594995, 1.0515021459227467, 1.1666666666666667, 2.0, 1.0906542056074766, 1.0660557755901436, 1.032849020846494, 1.2857142857142858, 1.0600561472417354, 2.0, 1.1154210028382214, 1.1768018018018018, 1.0, 1.0, 1.0, 1.205513784461153, 1.0308446554206299, 1.1144676555098236, 1.12, 1.8, 1.1961920529801324, 1.0, 1.2727272727272727, 1.1028411937307665, 1.1818181818181819, 1.1227213541666667, 1.0277842325736213, 1.0365739801096001, 1.0627503337783712, 1.0369318181818181, 1.0557287607170693, 1.039972432804962, 1.07739183424741, 1.0303507684057047, 1.3278688524590163, 1.0092165898617511, 1.1270156137810177, 2.0, 1.0145852324521423, 1.0011441647597255, 1.1109579600275672, 1.0947591318157754, 1.5, 1.1301767982562363, 1.0887096774193548, 1.0330578512396693, 1.1074561403508771, 1.1416666666666666, 1.0986176668914363, 1.100924386901117, 1.1862430466409928, 1.0800821355236139, 1.055921052631579, 1.3061224489795917, 1.2897196261682242, 1.0029455081001473, 1.2857142857142858, 1.0598138912483333, 1.0138468459538388, 1.161096256684492, 1.3518339768339769, 1.111337406653089, 1.139063369642999, 1.3410526315789473, 1.1252955082742317, 1.084245182531229, 1.0495449949443882, 1.0131118881118881, 1.0621963070942664, 1.0429564118761845, 1.113161980334656, 1.0496815286624204, 1.0, 1.3015873015873016, 1.0252610781823313, 1.0281100478468899, 1.0987804878048781, 1.263157894736842, 1.083920712946051, 1.3004036133000192, 1.1225677986277947, 1.1153846153846154, 1.1736363636363636, 1.0863417794055361, 1.0, 1.0, 1.0361567329809127, 1.0149769585253456, 1.0323655402189433, 1.5217391304347827, 1.0430868167202572, 1.047184983840055, 1.0499214021480274, 1.0626410835214446, 1.1713924317487088, 1.2937853107344632, 1.0666666666666667, 1.2173913043478262, 1.0, 1.4035087719298245, 1.086973663460022, 1.32404181184669, 1.3563218390804597, 1.0118635689569946, 1.0031277926720286, 1.0208832531700918, 1.0432804350238598, 1.1158054931516777, 1.1972789115646258, 1.176300578034682, 1.0272969374167775, 1.037667298523752, 1.0109919079384728, 1.0, 1.067080745341615, 1.0810273176688396, 1.01490351721768, 1.1482843137254901, 1.013420545160786, 1.2804765773084212, 1.0357142857142858, 1.0046938998952857, 1.0348117586384735, 1.027072758037225, 1.1428571428571428, 1.0275876374196224, 1.0379110251450676, 1.1637795275590552, 2.0, 1.2439741328630218, 1.0779924073246985, 1.2651195499296766, 1.1404255319148937, 1.0, 1.6666666666666667, 1.0185364309456393, 1.0727272727272728, 1.0935176090921845, 1.5, 1.0, 1.0810810810810811, 1.0136612021857923, 1.0425531914893618, 1.058011049723757, 1.0780590717299579, 1.0891608391608392, 1.0029473684210526, 1.0346296045372718, 1.0175438596491229, 2.0, 1.083688030761006, 1.06100757134537, 1.1138353765323994, 1.010222212931413, 1.0769104534762868, 1.0112616721675816, 1.0945945945945945, 1.0467756984666303, 1.0149521531100478, 1.0161223071577485, 1.1943385156937518, 1.0, 1.0332381779818791, 1.1695760598503742, 1.1818181818181819, 1.3888888888888888, 1.0318949343339587, 1.0555555555555556, 1.1367521367521367, 1.1294125563555615, 1.1324921135646688, 1.3709273182957393, 1.0131530054322502, 1.0604982206405693, 1.01803625408119, 1.0613487258904688, 1.1111111111111112, 1.013150236449618, 2.5, 1.032729725704574, 1.0064794816414686, 1.051672659414683, 1.0526315789473684, 2.0, 1.391304347826087, 1.0597014925373134, 1.0621039044853178, 1.0, 1.058252427184466, 1.0723981900452488, 1.0076121794871795, 1.0181305469076716, 1.1595092024539877, 1.1132075471698113, 1.0049773655735894, 1.201509280032633, 1.1235117041829537, 1.0683760683760684, 1.0, 1.107398568019093, 1.2807570977917981, 1.07, 1.1093934288121314, 1.0450375312760634, 1.0113960113960114, 1.2291666666666667, 1.0013717421124828, 1.0041279669762642, 1.2857142857142858, 1.004598557812362, 1.038022813688213, 1.0526315789473684, 1.0984977014010509, 1.2857142857142858, 1.4, 1.0112174813499863, 2.0, 1.1454046639231825, 1.063953488372093, 1.1115668580803937, 1.105351170568562, 1.0758426966292134, 1.1097560975609757, 1.126327466551225, 1.0653830237822839, 1.050071530758226, 1.0631314672269054, 1.073006867721708, 2.0, 1.0, 1.0552800566740557, 1.25, 1.070949720670391, 1.3529411764705883, 2.0, 1.375, 1.429718875502008, 1.0510677808727948, 1.2772277227722773, 1.0692640692640694, 1.0, 1.163115845539281, 1.0507886578254144, 2.0, 1.2561048243001787, 1.0, 1.0999924087147954, 1.0853658536585367, 1.0012332721070585, 1.1428571428571428, 1.1363636363636365, 1.277475516866159, 1.1944444444444444, 1.0298415616960386, 1.0180678406100254, 1.0387275242047027, 1.0, 1.0769230769230769, 1.5714285714285714, 1.5, 1.0666666666666667, 1.0691000603434089, 1.3333333333333333, 1.0299500831946755, 1.188235294117647, 1.2044497344808642, 1.0882663248668114, 1.243048403707518, 1.025090917678175, 1.0046403712296983, 1.0678571428571428, 1.5, 1.2868632707774799, 1.0723404255319149, 1.0422973076907507, 1.0952380952380953, 1.5714285714285714, 1.0393518518518519, 1.0153482880755609, 1.022864056909806, 1.0061274509803921, 1.1464387464387464, 1.026265389876881, 1.0389610389610389, 1.0907770515613653, 1.0953389830508475, 1.3076923076923077, 1.0269121813031161, 1.1081081081081081, 1.0599121162962846, 1.069888211500577, 1.045922241131038, 1.1511627906976745, 1.088235294117647, 1.1329113924050633, 1.0, 1.0088025516098247, 1.056156126909925, 1.032736501431931, 1.060170166244816, 1.038014888337469, 1.1512551636479187, 1.5714285714285714, 1.3145212428662016, 1.0, 1.228864218616567, 1.25, 1.0399091535688862, 1.0014492753623188, 1.0957652622527945, 1.0909090909090908, 1.1016799292661361, 3.0, 1.2245337159253946, 1.0201941759588133, 1.12293084421556, 2.0, 1.126984126984127, 1.3234165067178503, 1.380952380952381, 1.099380665272138, 1.4116424116424116, 1.1666666666666667, 1.2269197584124245, 1.0565473985727338, 1.0259051484807291, 1.0988965290471078, 1.0968201754385964, 1.0497512437810945, 1.1092436974789917, 1.875, 1.112994350282486, 1.5, 1.2371308016877638, 1.3333333333333333, 1.1829198067149045, 1.5625, 1.0837518419390733, 1.133444465448796, 1.0832819247378163, 1.0, 1.2258064516129032, 1.16, 1.2870092147435896, 1.0765864332603938, 1.0, 1.0283227410886986, 1.1121823763799072, 1.014504765851637, 1.5, 1.5, 1.0365048543689321, 1.012704174228675, 1.0, 1.2222222222222223, 1.072501193908414, 1.0806122448979592, 1.4705882352941178, 1.1523163841807909, 1.0545454545454545, 1.1640419947506562, 1.0120967741935485, 1.405973916701725, 1.0232599118942731, 1.0, 1.0724637681159421, 1.0798901488306165, 1.0543332056183714, 1.0437506077598782, 1.0, 1.1101526211015262, 1.00092262129515, 1.0220010476689365, 2.0, 1.0342902711323765, 1.0108023222613496, 1.04694242386882, 1.025424839456555, 1.0145580314012326, 1.0580431177446104, 1.0093299406276506, 1.161764705882353, 2.0, 1.0917876892862681, 1.3962264150943395, 1.0, 1.150259067357513, 1.1538461538461537, 1.014928483312773, 1.2159090909090908, 1.0491522831966664, 1.145938503900872, 1.075967435615179, 1.038549979710537, 1.0441647306309743, 1.1839080459770115, 4.0, 1.0004657304045133, 1.1087044534412955, 1.0468277587413002, 1.0433527397588744, 1.1060375443937087, 1.0684462696783026, 2.223404255319149, 2.4285714285714284, 1.0142669328528997, 1.0226287700689671, 1.0231379483154779, 1.129677658391997, 1.0681401851137677, 1.0543478260869565, 1.0635979633779835, 1.0231788079470199, 1.2039877300613497, 3.0, 1.0909090909090908, 1.0365659777424483, 1.0741444866920151, 1.1078066914498141, 1.1380243572395128, 1.0490196078431373, 1.3819444444444444, 1.148905109489051, 1.1375, 1.0629754510499851, 1.313953488372093, 1.0059898680381258, 2.0, 1.1065182829888711, 1.0714285714285714, 1.236842105263158, 1.1053072625698324, 1.0054704595185995, 1.034764826175869, 1.0168612191958495, 1.0857525911411334, 1.0, 1.553191489361702, 1.5, 1.0, 1.0909090909090908, 1.1653225806451613, 1.0140845070422535, 1.0825242718446602, 1.067766741429029, 1.062645011600928, 1.0804078686825693, 1.169106628242075, 1.0338461538461539, 1.1087260297532031, 1.1675675675675676, 1.119946984758118, 1.043057571359458, 1.0601207666054082, 1.2326589595375723, 1.1635279347143754, 1.0431764050068413, 1.2287320330478742, 1.0742620416160138, 2.0, 1.2137592137592137, 1.06496062992126, 1.4074074074074074, 1.0, 1.2142857142857142, 1.25, 1.1460446247464504, 1.3333333333333333, 1.1666666666666667, 1.0109677211467976, 1.129420737826663, 1.0231834760340413, 1.043968166417146, 1.2, 1.1383125864453665, 1.0, 1.1578947368421053, 1.02902767920511, 1.094562647754137, 1.084305329986712, 1.0366784371796331, 1.027671615463766, 1.1818181818181819, 1.1290390396703598, 1.1261101243339253, 1.0217839765006616, 1.0941188651894802, 1.2727272727272727, 1.0501567398119123, 1.0, 1.2387640449438202, 1.2084129626204714, 3.0, 1.0690932868352223, 1.0630140133241444, 1.2857142857142858, 1.0754271103707433, 1.3, 1.0555555555555556, 1.0431287953783188, 1.6153846153846154, 1.0360332596110848, 1.025630072618539, 1.3571428571428572, 1.2083333333333333, 1.068041237113402, 1.0109995217599235, 1.0073382254836558, 1.0384134134134133, 1.1557887031840917, 1.0, 1.0416033021942213, 1.1158536585365855, 2.0, 1.0235948059136932, 1.12176658880526, 1.1400189214758751, 1.0225826992263365, 1.063951215698538, 1.0560747663551402, 1.7142857142857142, 1.0330058939096267, 1.042741935483871, 1.089457519556106, 1.2142567841231269, 1.0038299768002916, 1.051700358043439, 1.2216117216117217, 1.1057178116001645, 1.1872909698996656, 1.0551625760928907, 1.0794952681388013, 1.069767441860465, 1.0047493403693932, 1.0410282616829252, 3.0, 1.1384569467243695, 1.0636266559529726, 1.0485711767686783, 1.2666666666666666, 1.3088459936119983, 1.3349753694581281, 1.1428571428571428, 1.1180785779784157, 1.0420575865415722, 1.1550218340611353, 1.1176470588235294, 1.3333333333333333, 1.0525290009852784, 1.5, 1.0841121495327102, 1.0833333333333333, 1.0022678110390064, 1.3846153846153846, 1.1181434599156117, 1.0670859538784068, 1.0, 1.6534391534391535, 1.284873949579832, 1.25, 2.0, 1.1083333333333334, 1.1827586206896552, 1.055207026348808, 1.2171136653895274, 1.1091854419410745, 1.191740412979351, 1.1014466214978942, 1.0545454545454545, 1.1342592592592593, 1.3551020408163266, 1.0384615384615385, 1.0, 1.0332640332640333, 1.0692640692640694, 1.0189473684210526, 1.0252814956447844, 1.0739786644604064, 1.0831392223615839, 1.059718969555035, 1.1985613071139387, 1.1477900552486189, 1.0053989202159568, 1.375, 1.0, 1.2142857142857142, 1.0190559307884952, 1.0679611650485437, 1.107843137254902, 1.049095607235142, 1.0179457808323789, 1.0585419734904271, 1.0106603567214165, 1.1142857142857143, 1.2222222222222223, 1.0242608036391205, 1.0754904559915164, 1.0790517098959194, 1.0000793094788045, 1.006578947368421, 1.0616509155345542, 1.009974825980801, 1.135174418604651, 1.3472505091649694, 1.1111111111111112, 1.0868498527968598, 1.2813852813852813, 1.1555555555555554, 1.057636887608069, 1.0701001430615165, 1.0, 1.0257611241217799, 1.0165217248351937, 1.08, 1.0725606795150415, 1.024972855591748, 1.131578947368421, 1.0153897254207263, 1.035832732516222, 1.1329572925060436, 1.0162213740458015, 1.0149769585253456, 1.199121473221828, 1.1839323467230445, 1.2142857142857142, 1.0, 1.6666666666666667, 1.0746033668402568, 1.3333333333333333, 1.179662635264163, 1.1077217166549997, 1.0845747236905334, 1.0649453823237338, 1.0524624359377417, 1.0967845659163986, 1.0465949820788532, 1.030513176144244, 1.0265949702960997, 1.1693382077240344, 1.037973360931024, 1.176653016981814, 1.6666666666666667, 1.032258064516129, 1.0474308300395256, 1.1179590280425664, 1.0521172638436482, 1.2719227674979887, 1.0521415270018621, 2.211206896551724, 1.0463338760098753, 1.0201342281879195, 1.0726674641148326, 1.1875, 1.0875673640364296, 1.0326677835139664, 1.2793746848209784, 1.0581052631578947, 1.1428571428571428, 1.1588089330024813, 1.0864864864864865, 1.5, 1.0652744329822796, 1.6538461538461537, 1.0486257928118394, 1.0781990521327014, 1.0013504388926402, 1.0160821214713431, 1.022864019253911, 1.8333333333333333, 1.0821256038647342, 1.0843229530497445, 1.0524918051002834, 1.0172831358681103, 1.024117529081428, 1.0627151051625239, 1.1818181818181819, 1.1065502183406113, 1.0704726056043496, 1.0125901313261454, 1.0130260521042085, 1.0277777777777777, 1.0699469368065606, 1.0392455383574388, 1.3923154701718907, 1.0093692750588852, 1.0, 1.3333333333333333, 1.045855274543252, 1.0304480208786428, 1.2324150336078765, 1.1620053748494115, 1.0694333599361532, 1.1479591836734695, 1.0953268080156924, 1.095209778658738, 1.1378676470588236, 1.0451977401129944, 1.0625, 1.0772713886025622, 1.0952380952380953, 1.75, 1.0276895287679966, 1.1595305752219494, 1.01036866359447, 1.035294117647059, 1.1991310644460536, 1.0016157901701455, 1.154062412145066, 1.3289036544850499, 1.2307692307692308, 1.0768194070080863, 1.0416666666666667, 1.14375, 1.5925925925925926, 1.0020491114918204, 1.1714568880079286, 1.1592039800995024, 1.048780487804878, 1.0338248570568762, 1.0968113714944294, 1.0674364123159303, 1.207070707070707, 1.3333333333333333, 1.12, 1.3333333333333333, 1.1494252873563218, 1.1538461538461537, 1.0, 1.1538461538461537, 1.0230352303523036, 1.068840579710145, 1.0254391384941302, 1.0434370793798502, 1.0436432637571158, 1.2142857142857142, 1.1428571428571428, 1.064516129032258, 1.0810810810810811, 1.0285714285714285, 1.1588447653429603, 1.0251379480356335, 1.028113984638789, 1.3333333333333333, 1.0821963712958973, 1.047209849356889, 2.5, 1.068099077949032, 1.3133208255159474, 1.5, 2.0, 1.2210059171597634, 1.146023094025676, 1.0337326258510102, 1.2546583850931676, 1.0, 1.0886075949367089, 1.2423312883435582, 3.0, 1.5, 1.0142251060643874, 1.2450598198682619, 1.0607272272897663, 1.6666666666666667, 1.0228160301055182, 1.0449264136328427, 1.0209424083769634, 1.0, 1.0047169811320755, 1.0240997449234255, 1.3026315789473684, 1.1870851324353935, 1.1102577529528133, 1.221264367816092, 1.0703125, 1.0819994634713404, 1.094392523364486, 1.024793388429752, 1.2105263157894737, 1.0325478004806707, 1.5576300247666222, 1.0340785387709266, 1.403361344537815, 1.196078431372549, 1.1940298507462686, 1.0837837837837838, 1.0566978193146417, 1.013566558080246, 1.0597432458325349, 1.0895196506550218, 1.5, 1.6666666666666667, 1.1226427155916385, 1.1820580474934037, 1.090254814238475, 1.0148009965513431, 1.017895969225623, 1.0968387688714656, 1.3404255319148937, 1.0, 1.1062809527552866, 1.0998233034044913, 1.1809324982602645, 1.1558704453441295, 1.6666666666666667, 1.056338028169014, 1.0877928089708289, 1.1680156293608708, 1.00419819227094, 1.081319298962751, 1.0291193181818181, 2.0, 1.0515970515970516, 1.0476581093883588, 1.1603838245373543, 1.0076045627376427, 1.0779037333714776, 1.0286624203821657, 1.3741721854304636, 1.0185507246376813, 1.0314270265170074, 1.0559390521087633, 1.0288018433179724, 1.0413333333333334, 1.0, 1.1941638608305274, 1.0485419142517598, 1.0355677154582763, 1.0901357631395654, 1.123827392120075, 1.029500756429652, 1.2857142857142858, 1.236220472440945, 1.6666666666666667, 2.0, 1.2352941176470589, 1.010230179028133, 1.0505529225908372, 1.0029707750009285, 1.0078311449467516, 1.0040705563093624, 1.0688729874776386, 1.108695652173913, 1.0888888888888888, 1.0672713370792033, 1.6, 1.5, 1.2082514734774066, 1.1428571428571428, 1.0759312320916905, 1.1672652642380708, 1.0100946372239747, 1.0857882520978397, 2.0, 1.1123839009287926, 1.2112403100775193, 1.0311133967600925, 1.0400194500766076, 1.1742424242424243, 1.1123287671232878, 1.1361534547224497, 1.0757032063896284, 1.0161550888529887, 1.2033898305084745, 1.1089385474860336, 1.0, 1.0, 1.04170094059583, 5.0, 1.4285714285714286, 1.588235294117647, 1.0738341968911918, 1.0930232558139534, 1.103658536585366, 1.0969007453903492, 1.0, 1.058969584109249, 1.0157710280373833, 1.1861702127659575, 1.3052884615384615, 1.4285714285714286, 1.0423963133640552, 1.064306784660767, 1.1678004535147393, 1.026775753068055, 1.020292063240794, 1.012889171280748, 1.1221532091097308, 1.0, 1.2139865465160553, 1.057518561091953, 1.0087428263988523, 1.1774193548387097, 1.1356144946518227]
origin-bjaq_15.71 	max: 5.0000	99th: 2.4293	95th: 1.6667	median: 1.0810	mean: 1.1701

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 14.026789 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[4.1723251e-07 2.3841858e-07 1.1920929e-07 6.0796738e-06 1.7881393e-07]
Distance score: 1.4066696394365863e-06
SAUCE Drift detection: False
Detection latency: 0.0235s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.022496 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 3.0000	95th: 1.8928	median: 1.0808	mean: 1.1887
ReportEsts: [1.0211640211640212, 1.0131636682755594, 1.0378006458765123, 1.0541455160744502, 1.434782608695652, 2.0, 1.0720191071100496, 1.0293338343731187, 1.2, 1.024891774891775, 1.1254919002438377, 1.0430102278359341, 1.107489328676756, 1.0627450980392157, 1.0341477774506918, 1.2222222222222223, 1.2325581395348837, 1.4242424242424243, 1.4545454545454546, 1.0391993327773144, 1.130344349433788, 1.1303435248023508, 1.2373333333333334, 1.024247491638796, 1.0069023363097838, 1.0337458502077068, 2.0, 1.130416887164109, 1.2, 1.2857142857142858, 1.0, 1.0, 1.0460999834159466, 1.0012921055937405, 1.1454545454545455, 1.0932380835078213, 1.2251833488276005, 1.1063829787234043, 3.0, 1.2017606715119256, 1.1075078981601933, 1.0278951817413355, 1.175032175032175, 1.0602785283724798, 1.0071556350626119, 1.0904901150594368, 1.4444444444444444, 1.2745098039215685, 1.099056603773585, 1.0797546012269938, 1.75, 1.195744680851064, 1.0532786885245902, 1.0, 1.0169567373398967, 1.0134763137351577, 1.0558659217877095, 1.1855670103092784, 1.0869565217391304, 1.0665364661671535, 1.5172413793103448, 1.0955496933776423, 1.0688073394495412, 1.1532567049808429, 1.0396039603960396, 1.0, 1.0522645971018008, 1.3049853372434017, 2.0, 1.0, 1.0203324313877078, 1.0390946502057614, 1.0618656355727405, 1.021113243761996, 1.0785703340484216, 1.0003303600925009, 1.0393700787401574, 1.2958579881656804, 1.4854368932038835, 1.1079990137076374, 1.0799373040752351, 3.5, 1.0, 2.0, 1.0545050055617353, 1.2166666666666666, 1.0940170940170941, 1.3571428571428572, 1.2, 1.0821799307958477, 1.1162264150943397, 1.1017518248175182, 1.0537940587963674, 1.1349323948879422, 1.0719794344473008, 1.035632183908046, 1.2962962962962963, 1.0959666203059806, 1.0909090909090908, 1.2930086410054988, 1.0357142857142858, 2.0, 1.060765485068274, 1.105285775676837, 1.0385989992852038, 1.2183103620652718, 1.3870967741935485, 1.0215773244222512, 1.0010931351114998, 1.079612793993154, 1.1699968284173803, 1.048986919723006, 1.5, 1.2, 1.0738294151933165, 1.0558424035261311, 1.0589155370177268, 1.011111111111111, 1.0584491771336386, 1.0, 1.0993772703684483, 1.0911504424778762, 1.0, 1.009433962264151, 1.25, 1.2343096234309623, 1.0116768691836806, 1.0376319709825765, 1.1370967741935485, 2.0, 1.1657420249653259, 2.0, 1.25, 1.1339566746898722, 1.5, 1.2241014799154335, 1.0177078263947263, 1.1214147393035916, 3.0, 1.2857142857142858, 1.0313807531380754, 1.0221729490022173, 1.0812883435582823, 1.0133056732863022, 1.2929936305732483, 1.0141381185426863, 1.0905893324142963, 3.0, 1.0299079754601228, 1.0263157894736843, 1.0784313725490196, 1.1335504885993486, 1.5, 1.1254668416271323, 1.040868454661558, 1.0341880341880343, 1.1275675675675676, 1.0, 1.0631408526713437, 1.1009005019191025, 1.1513473766166358, 1.0247524752475248, 1.0681198910081744, 1.3275862068965518, 1.3559322033898304, 1.0158730158730158, 2.0, 1.0611538979079762, 1.0, 1.0674603174603174, 1.0463266015306163, 1.1450498848810438, 1.0426789517145465, 1.2597864768683273, 1.1232604373757455, 1.0938329179062476, 1.090608950843727, 1.0426300578034682, 1.0818330605564648, 1.0406546990496304, 1.0716336597217109, 1.2229668303072807, 1.14375, 1.1352941176470588, 1.009159585835538, 1.0449332821758963, 1.2092198581560283, 1.1329113924050633, 1.0335731414868106, 1.5555555555555556, 1.288515406162465, 1.071046447677616, 1.4, 1.1514533401325855, 1.4861111111111112, 1.0320634705460565, 1.0424852136894895, 1.0557729941291585, 1.0602827265685515, 1.0989505391197576, 1.0024449877750612, 1.0077484559236385, 1.0042533081285445, 1.060187678175483, 1.0545369064409966, 1.0170044052863436, 1.1657458563535912, 1.0714285714285714, 1.1839080459770115, 1.0, 1.5, 1.140574659740943, 1.26878612716763, 1.135135135135135, 1.0110928512736237, 1.3181818181818181, 1.0437217192537298, 1.0336322869955157, 1.2180433135245083, 1.75, 1.0592417061611374, 1.0166666666666666, 1.0583223802126898, 1.0390302886140184, 1.7142857142857142, 1.1170973062122045, 1.114119349957234, 1.007902156929653, 1.0349462365591398, 1.0118043844856661, 1.1481246026700571, 1.0908276959808993, 1.4434782608695653, 1.004627615023606, 1.0229870569792265, 1.0426829268292683, 1.017467248908297, 1.0647321428571428, 1.8888888888888888, 1.1147214854111407, 2.0, 1.1818392940083604, 1.0265979668569838, 1.2417881438289602, 1.1357142857142857, 1.0769230769230769, 2.0, 1.0657954562121412, 1.042857142857143, 1.1355211182011546, 2.0, 1.0721649484536082, 1.0198412698412698, 1.4285714285714286, 1.0027461037680017, 1.06651376146789, 1.114012184508268, 1.0896739130434783, 1.017531305903399, 1.1421997683099498, 1.0769230769230769, 2.0, 1.1145470271381226, 1.0651633630357034, 1.1564327485380117, 1.0181662711154544, 1.1258902836997688, 1.0039100951547633, 1.0681672025723472, 1.095869033948709, 1.0188679245283019, 1.0009351256575103, 1.0074149314372778, 1.3333333333333333, 1.0065028756938739, 1.3310185185185186, 1.1666666666666667, 1.2083333333333333, 1.0397350993377483, 1.1689895470383276, 1.012876677097175, 1.000035033632287, 1.011600928074246, 1.268389662027833, 1.0119048788876333, 1.002152080344333, 1.09837184482887, 1.0591397094283614, 1.4, 1.14, 1.071754729288976, 1.0979800706564478, 1.084885402909176, 1.0487092279340156, 1.1764091858037578, 1.198641765704584, 1.0467017344327552, 1.0205719845710115, 1.1081256419959993, 1.034849122997704, 1.0130718954248366, 1.0357142857142858, 1.1538461538461537, 1.0788487483135962, 2.0, 1.0233393177737882, 1.0065341888607637, 1.0964633029523352, 1.3421052631578947, 1.046875, 1.0043290043290043, 1.01024127755598, 1.0263293360631764, 1.1, 1.1447292125710309, 1.0212289418003588, 1.2542857142857142, 2.0, 2.8, 1.0134548611111112, 1.1, 1.0121901679090042, 1.0172143974960877, 1.25, 1.040990985857711, 1.1, 1.5833333333333333, 1.0088052042279068, 3.0, 1.0114942528735633, 1.0575275397796817, 1.0202140986220247, 1.0986180904522613, 1.0582959641255605, 1.092783505154639, 1.0956069142270044, 1.0719965410313401, 1.25, 1.0784729586426298, 1.0483753194596568, 3.0, 1.2, 1.0390532657185343, 1.0, 1.0762790697674418, 1.125, 4.0, 1.6111111111111112, 1.3259949195596952, 1.077459333849729, 1.2677165354330708, 1.0476190476190477, 1.3246753246753247, 1.3333333333333333, 1.0825321577835867, 3.0, 1.1304347826086956, 1.0130018036336619, 1.0153256704980842, 1.0516717325227964, 1.018957345971564, 1.4, 1.0, 1.2566302652106085, 1.1908396946564885, 1.017, 1.130867322797388, 1.2332225095431597, 1.0049261083743843, 1.0, 1.0303304807787532, 1.2342342342342343, 1.121212121212121, 1.2, 1.145852749301025, 1.1428571428571428, 1.037280701754386, 1.2164948453608246, 1.1815779633553534, 1.13588842585198, 1.3620689655172413, 1.0595712181550379, 1.1102783725910064, 1.028436018957346, 1.1004431314623337, 1.062006229109693, 1.0913621262458473, 1.1176470588235294, 1.0010112179032822, 1.0486367684116789, 1.1980982567353406, 1.0196078431372548, 1.0476190476190477, 1.3669064748201438, 2.0, 1.125, 1.8493150684931507, 1.0898876404494382, 1.6694214876033058, 1.2188905547226387, 1.0899062327633757, 1.1168831168831168, 1.0163756983240224, 1.0427382753403933, 1.0111021936864633, 1.076086956521739, 1.2238805970149254, 1.1071428571428572, 1.0, 1.032299285618664, 1.4901960784313726, 1.1083555606000417, 1.0916070472575072, 1.0958664685834134, 1.15129835718071, 1.625, 1.155140186915888, 1.1666666666666667, 1.090138935953914, 1.0833333333333333, 1.1048012864691017, 1.0046728971962617, 1.0462630255120373, 1.1172638436482085, 1.1049107142857142, 4.0, 1.0982597054886212, 1.016388517252625, 1.0924813328982474, 2.0, 1.0579710144927537, 1.2370723945902944, 1.3449367088607596, 1.065477571859563, 1.0584275417992903, 1.0, 1.1826647564469914, 1.0066152795394672, 1.0370489794602264, 1.0788311654458724, 1.0827436599349207, 1.1248043818466353, 1.1, 1.0254041570438799, 1.0662054742406344, 1.1111111111111112, 1.2871822606814494, 1.0, 1.0, 1.3103221564760026, 1.0148148148148148, 1.0336048879837068, 1.1050076392557795, 1.0830784913353722, 1.0, 1.1428571428571428, 1.1333333333333333, 1.091753235837956, 1.2608695652173914, 1.0, 1.0633158068904658, 1.0, 1.0, 1.0037551633496058, 1.75, 1.0258677144728225, 1.0206738131699846, 1.0217391304347827, 1.0909090909090908, 1.0697852197050997, 1.0726495726495726, 1.55, 1.0184097263673777, 1.112, 1.2116228070175439, 1.0479123887748119, 1.455949455949456, 1.031644944707741, 1.0, 1.0588235294117647, 1.0261663786719328, 1.0698422915996137, 1.0278440731901353, 1.25, 1.0885070214338508, 1.0108427109239697, 1.02226102138804, 2.0, 1.0543877210543877, 1.0414389194822178, 1.050597208937287, 1.0528893241919686, 1.010351716870115, 1.0112643073040999, 1.0134560906515582, 1.2568642545547857, 1.5, 1.0569456427955133, 1.0048076923076923, 1.0575329107752316, 1.0043787629994527, 1.0052770448548813, 1.0102563924450711, 1.3354037267080745, 1.0905348809381357, 1.132046332046332, 1.0896254807741357, 1.325, 1.078915991852551, 1.0769811320754716, 1.1022727272727273, 1.1470588235294117, 1.0568044860002792, 1.1266375545851528, 1.0054071246819338, 1.0651792304163092, 1.0, 1.0571646341463414, 1.3966005665722379, 1.2857142857142858, 1.1153846153846154, 1.0124709535908962, 1.1227436823104693, 1.0260966129927818, 1.0, 1.4, 1.0158511371467953, 1.1346832778871614, 1.0517435320584927, 1.008186697903124, 1.0989827856025038, 1.0115858073859523, 1.0303341902313625, 1.0361476891298735, 1.5397727272727273, 1.0056767160939195, 1.0463366336633664, 1.1105263157894736, 1.1075024590896898, 1.1666666666666667, 1.0353370043770136, 2.0, 1.2041399000713775, 1.023489932885906, 1.0013897503043667, 1.1233183856502242, 1.0056925996204933, 1.0573770491803278, 1.28, 1.151952403747521, 1.0, 1.2545454545454546, 1.3333333333333333, 1.3333333333333333, 1.2233009708737863, 1.0138888888888888, 1.0485175202156334, 1.05078125, 1.0699582940939056, 1.1219512195121952, 1.0764525993883791, 1.172548076923077, 1.0483927074933195, 1.1141651065453548, 1.0161150642082064, 1.0914502164502164, 1.0215912771240419, 1.0487328947039252, 1.034975369458128, 1.0649350649350648, 1.2375838926174496, 1.967032967032967, 1.0006423638991488, 1.1341600901916573, 1.1035216260931222, 1.3558282208588956, 1.1804245283018868, 1.04, 2.0, 1.0285035629453683, 1.0555555555555556, 3.0, 1.1785714285714286, 1.0340164980015307, 1.036076662908681, 1.005249343832021, 1.054945054945055, 1.1013302610955564, 1.0775916164658634, 1.086080586080586, 1.4, 4.0, 1.081956797966963, 1.163716814159292, 1.1015847216578627, 1.0967063770147163, 1.0, 1.4850382741823243, 1.1174004192872118, 1.0966339458578174, 1.0799418604651163, 1.0007848193514028, 1.0433746148031862, 1.0085058552906734, 1.4772727272727273, 1.0, 1.1214819363422373, 1.0, 1.0102389078498293, 1.1545064377682404, 1.3351994401679497, 1.341553637484587, 1.7826086956521738, 1.099737109494702, 1.083916083916084, 1.026126126126126, 1.0374292406792895, 1.099805573558004, 1.0965651328580688, 1.0075973409306742, 1.0072727272727273, 1.065625, 1.6, 1.0185792349726777, 1.0768006642219607, 1.0909090909090908, 1.004778156996587, 1.207262021589794, 1.0308056872037914, 1.0153784954208067, 1.3333333333333333, 1.222027972027972, 1.0198907956318253, 1.1724137931034482, 1.1607142857142858, 1.0891899263569416, 1.0625, 2.75, 1.049619583195501, 1.0208613728129206, 1.088449162993097, 1.153225806451613, 1.02743821222436, 1.1325458003804185, 1.234375, 1.1065068493150685, 1.218232044198895, 1.0763111534756984, 1.0922587486744433, 1.0504334121355399, 1.0334201388888888, 1.0796605529701615, 1.010204081632653, 1.009648405560098, 1.4444444444444444, 1.6, 1.136079900124844, 1.5979202772963605, 1.015823766677009, 1.201954397394137, 1.0, 1.0137096774193548, 1.0349172066234702, 1.0348837209302326, 1.0802191848463443, 2.0, 1.1180459770114943, 2.0, 1.0193423597678917, 1.1333333333333333, 1.0649070045840754, 1.5161290322580645, 1.1779359430604983, 1.0491228070175438, 1.0, 1.277847152847153, 1.241046831955923, 1.2, 2.0, 1.1118881118881119, 1.2136498516320475, 1.0030181086519114, 1.2114771519659937, 1.0669456066945606, 1.178438661710037, 1.086734693877551, 1.0789473684210527, 1.1967213114754098, 1.4701986754966887, 1.032258064516129, 1.0, 1.0206896551724138, 1.1492178098676293, 1.041060735671514, 1.1414151313210505, 1.0868867177185106, 1.024300649901102, 1.0515244900353873, 1.166611609958257, 1.1862396204033214, 1.012036108324975, 1.375, 2.0, 1.4545454545454546, 1.0396554012628545, 1.0755555555555556, 1.102981029810298, 1.0020449897750512, 1.023543673833982, 1.107420669218422, 1.0108860863492586, 1.1566265060240963, 1.4285714285714286, 1.0379746835443038, 1.0377164409394823, 1.0697718864756391, 1.043597543477013, 1.0677966101694916, 1.1091445427728615, 1.1078418529095815, 1.050511536139199, 1.0836417468541821, 1.0763209546375145, 1.141065830721003, 1.0485282418456643, 1.12957157784744, 1.0298861623471232, 1.1111111111111112, 1.0973084886128364, 1.0, 1.078723404255319, 1.0277004473622249, 1.0625, 1.0774854868137336, 1.0254083484573502, 1.170731707317073, 1.0263746505125815, 1.021083428847198, 1.0864722673084457, 1.0682926829268293, 1.0454096742349457, 1.1950605543590747, 1.1915641476274166, 1.0, 1.0, 1.5, 1.063469276341064, 1.4285714285714286, 1.215966774342409, 1.1170579100177804, 1.053843152555599, 1.0780351568917366, 1.0502507522567703, 1.0149306789904018, 1.0454545454545454, 1.0347222222222223, 1.0047031825782526, 1.1363043435936375, 1.0460058133707528, 1.2118104312938816, 1.8571428571428572, 1.3580246913580247, 1.0780141843971631, 1.1015392146981324, 1.0576923076923077, 1.3015656909462219, 1.0298273155416013, 2.2491103202846974, 1.0229600099663636, 1.076581576026637, 1.061954303350092, 1.2352941176470589, 1.0741852424041787, 1.0326857012529755, 1.3004255319148936, 1.0687699397376818, 1.2666666666666666, 1.048465266558966, 1.1119743208038706, 1.0506737060309645, 1.3, 1.0185844003743831, 1.2702702702702702, 1.041059229523206, 1.1064516129032258, 1.0109756097560976, 1.0287907869481765, 1.048158640226629, 1.04364694471387, 1.0384241245136188, 1.011206811206811, 1.0630975143403443, 1.0114149794575893, 1.0968479576738555, 1.2307692307692308, 1.0490539593552908, 1.0370189171559034, 1.1019198622156932, 1.1046153846153846, 1.0067637877211237, 1.1732522796352585, 1.2, 1.003826530612245, 1.042643187892743, 1.0188679245283019, 1.0897583429228999, 1.2453241769339527, 1.0518518518518518, 1.0109546165884193, 1.480600103466115, 1.113680867138474, 1.0191040843214756, 1.0018181818181817, 1.1077770470240054, 1.1135154806561782, 1.1816770186335404, 1.061611374407583, 1.0655637254901962, 1.0987085436377384, 1.0784313725490196, 2.5, 1.0390357865339515, 1.1665950475371971, 1.0266666666666666, 1.042857142857143, 1.2493233082706767, 1.02647832347586, 1.1693245778611632, 1.0113759479956663, 1.1764705882352942, 1.0533629794330184, 1.2222222222222223, 1.1398963730569949, 1.625, 1.0377238746768458, 1.2042657916324857, 1.0825688073394495, 1.08, 1.0940594059405941, 1.2088100686498855, 1.0476190476190477, 1.0, 1.0502197112366605, 1.024, 1.0032407407407407, 1.0769230769230769, 1.0116788018337586, 1.0, 1.005125815470643, 1.226890756302521, 1.1428571428571428, 1.2864190365641324, 1.0546521653632637, 1.0170269649873749, 1.2293853073463268, 1.35, 1.0625, 1.135135135135135, 1.0689655172413792, 1.0595238095238095, 1.0136439267886854, 1.0299406928271253, 1.028907131703848, 1.368421052631579, 1.0833594627413645, 1.0469393883781846, 3.0, 1.1055742045293366, 1.0208791208791208, 2.0, 2.25, 1.1720245398773006, 1.0884908034269967, 1.084231124873664, 1.2454780361757105, 1.5, 1.0635451505016722, 1.385390428211587, 1.217741935483871, 1.0869057758430334, 1.1177205973265927, 1.042679800296856, 1.0518429399540632, 1.7142857142857142, 1.0287174136180879, 1.0505181347150259, 1.0389273356401385, 1.1153846153846154, 1.032490974729242, 1.0, 1.0328054298642535, 1.1948360611462217, 1.03030792594268, 1.2434782608695651, 1.05625, 1.0559439712101202, 1.0342516753536857, 1.1314878892733564, 1.3076923076923077, 1.0413830302947542, 1.3589494163424125, 1.030967299598149, 1.27, 1.1574803149606299, 1.0159453302961277, 1.125, 1.0674977196716326, 1.0539845758354756, 1.0173156329085824, 1.052823315118397, 2.0, 1.1361867704280155, 1.004746771792912, 1.1924624954262715, 1.1448695373779414, 1.0278761567462584, 1.01187648456057, 1.101530826226758, 1.3701799485861184, 1.0169491525423728, 1.1364112639161754, 1.1186743945140274, 1.274718397997497, 1.2299465240641712, 2.0, 1.0705882352941176, 1.0377915783096032, 1.0696594427244581, 1.004332383591585, 1.0749751562863405, 1.017109144542773, 2.0, 1.0737279335410177, 1.0396914901750898, 1.1906950028719128, 1.194267515923567, 1.0904177904937886, 1.015625, 1.2939001848428835, 1.0106951871657754, 1.0316304499023266, 1.1182889871270887, 1.0786193672099713, 1.0661252900232019, 1.0263157894736843, 1.1540743182005437, 1.0465659673897778, 1.0401502900013375, 1.1755102040816328, 1.1268115942028984, 1.021424070573409, 1.037037037037037, 1.2700892857142858, 1.6666666666666667, 2.0, 1.0476190476190477, 1.0382165605095541, 1.0216962524654833, 1.0199867176876127, 1.0133308144985083, 1.0781214721156016, 1.025553967119371, 1.182648401826484, 1.0361271676300579, 1.035361861335204, 1.8333333333333333, 1.5714285714285714, 1.2305898033988671, 1.1111111111111112, 1.0504587155963303, 1.1126070991432069, 1.0053094660194175, 1.0914664681599784, 2.5, 1.074451810300867, 1.1394628099173554, 1.1473640039673456, 1.0409722009847395, 1.1414994720168954, 1.1252479455936526, 1.1351410934744268, 1.088102079579214, 1.0066934404283803, 1.509090909090909, 1.0358381502890173, 2.6666666666666665, 2.0, 1.0415784924443385, 5.0, 1.3333333333333333, 1.8333333333333333, 1.0630914826498423, 1.0690386589120766, 1.0027624309392265, 1.0943396226415094, 1.0, 1.1950813609467457, 1.0375865479723045, 1.0515873015873016, 1.266798418972332]
origin-bjaq_15.71 	max: 5.0000	99th: 3.0000	95th: 1.8928	median: 1.0808	mean: 1.1887

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.159748 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.236309