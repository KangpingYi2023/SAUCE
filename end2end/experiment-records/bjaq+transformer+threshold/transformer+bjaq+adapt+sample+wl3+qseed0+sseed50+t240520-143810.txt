Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 50, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.5025	95th: 1.7506	median: 1.0779	mean: 1.1755
ReportEsts: [1.0158730158730158, 1.0216145833333334, 1.0543234523964526, 1.0743801652892562, 1.5789473684210527, 1.0, 1.0448322147651006, 1.0671702687097067, 1.0, 1.0116883116883117, 1.096153291201339, 1.0428543088756437, 1.0159596808063838, 1.1186046511627907, 1.043094312963617, 1.0, 1.0344827586206897, 1.00035423308537, 3.0, 2.0, 1.125, 1.0720395801544367, 1.0836639019112875, 1.0792718731650028, 1.0552540700542674, 1.0, 1.1734686400937866, 1.5, 1.2, 1.0145985401459854, 1.0, 1.0446671495706865, 1.0091254121352295, 1.0771365149833518, 1.0164203612479474, 1.2211979661857715, 1.1737967914438503, 1.0067568558618902, 1.1369929058475101, 1.1071428571428572, 1.1063829787234043, 1.0579268292682926, 1.0, 1.043997906246365, 1.1231808731808732, 1.8615384615384616, 1.0618556701030928, 1.2968197879858658, 1.0427403943891034, 1.0740740740740742, 1.0355485705732674, 1.4621993127147765, 1.0380331403693097, 2.0, 1.3662337662337662, 1.3270748525380078, 1.0632727272727274, 1.3658536585365855, 1.0807453416149069, 1.25, 1.1042348237004727, 1.0865504358655043, 1.0909090909090908, 1.0235294117647058, 1.0909090909090908, 1.1101675376575468, 1.2927370758008245, 1.75, 1.0, 1.0342267643655998, 1.0345679012345679, 1.0602898550724638, 1.0398126463700235, 1.1113167259786476, 1.096470588235294, 1.0821643286573146, 1.0, 1.113152400835073, 2.0, 1.014993256621424, 1.1851851851851851, 1.0211970074812968, 1.0858895705521472, 1.0699386503067485, 1.10549558390579, 1.04, 1.0635664873174482, 1.028748393128433, 1.0686274509803921, 1.75, 1.1537275064267352, 1.0351918405279659, 1.0354838709677419, 1.0210378681626928, 1.0320452403393026, 1.025974025974026, 1.0150375939849625, 1.1501472031403337, 1.0, 1.2371122640468042, 1.0312455003599712, 1.1200686106346485, 1.2415228248488566, 1.36, 1.0179302586469663, 1.0929121316697636, 1.1904715367700953, 1.0967007963594995, 1.0490496627835684, 1.3333333333333333, 2.0, 1.0453271028037383, 1.0818332596196374, 1.045483259633607, 1.1428571428571428, 1.0554786063914463, 1.0, 1.1460107221696625, 1.1224489795918366, 1.0, 1.0274725274725274, 1.0, 1.1954887218045114, 1.0154011043235576, 1.0421682068804845, 1.1428571428571428, 1.8, 1.1829470198675496, 1.0, 1.037037037037037, 1.100080768011778, 1.1818181818181819, 1.0926106770833333, 1.0286257983884644, 1.057391304347826, 1.0549295774647887, 1.083086053412463, 1.0280592361652376, 1.039972432804962, 1.07739183424741, 1.0421663770818324, 1.2366412213740459, 1.0085526315789475, 1.1034063112290224, 2.0, 1.0182315405651778, 1.0057471264367817, 1.104109589041096, 1.0974060349391213, 1.5, 1.2553887139743278, 1.0400616332819723, 1.0266940451745379, 1.1074561403508771, 1.0178306092124814, 1.0657451112609575, 1.060297132586289, 1.0643055955465976, 1.0499001996007984, 1.111842105263158, 1.2857142857142858, 1.3269230769230769, 1.0147275405007363, 1.4285714285714286, 1.0703478815122949, 1.0273276959793822, 1.1495698213103904, 1.3703522504892367, 1.1305248618784531, 1.2171689062044473, 1.2736842105263158, 1.1666666666666667, 1.0446402633872374, 1.0515672396359959, 1.019349164467898, 1.0612244897959184, 1.0309085232594444, 1.1140267587397497, 1.0727530077848548, 1.0, 1.0413223140495869, 1.0012717253073335, 1.0283094098883572, 1.1319095477386936, 1.118421052631579, 1.0892885740683709, 1.2836824908706514, 1.096422310239595, 1.16, 1.0314111579934364, 1.113686576504093, 1.0, 1.3636363636363635, 1.03133843848843, 1.0588942307692308, 1.0231132075471698, 1.2962962962962963, 1.0553054662379422, 1.0526675470282658, 1.0370554599972108, 1.0626410835214446, 1.067144513544851, 1.3615819209039548, 1.0847457627118644, 1.2173913043478262, 1.0, 1.391304347826087, 1.0827945119066393, 1.3763066202090593, 1.2758620689655173, 1.0103806228373702, 1.0031277926720286, 1.0195280431782852, 1.0344301409388525, 1.103332139018273, 1.2054794520547945, 1.1098265895953756, 1.0094864245992803, 1.106309954621173, 1.0097215471147838, 1.0, 1.1010351966873706, 1.128020798455872, 1.012207014621793, 1.144078144078144, 1.0079323387266232, 1.2788836001730852, 1.0357142857142858, 1.004451392533673, 1.1364105208870552, 1.009024252679075, 1.2151898734177216, 1.106241395135383, 1.0313346228239846, 1.115748031496063, 2.0, 1.1961560203504804, 1.103617686467173, 1.142991092358181, 1.0387596899224807, 1.0, 1.6666666666666667, 1.0930338896607517, 1.1272727272727272, 1.1457238413760154, 1.5, 1.0, 1.025, 1.0495706479313036, 1.101123595505618, 1.019718309859155, 1.1529535864978904, 1.0577249575551784, 1.0109151973131822, 1.1359052283153637, 1.0363636363636364, 2.0, 1.0442600703226204, 1.0472084500970036, 1.1015761821366024, 1.0372064786106112, 1.1325758665324321, 1.0231918107064943, 1.1001589825119238, 1.0712110275865712, 1.0311004784688995, 1.0946295451087784, 1.0267305510023956, 1.0909090909090908, 1.0168191423092425, 1.1666666666666667, 1.2045454545454546, 1.3157894736842106, 1.0, 1.0, 1.1025641025641026, 1.1060897651571227, 1.0, 1.418546365914787, 1.0178718512417262, 1.0738255033557047, 1.0324467178175618, 1.0727727055394913, 1.4285714285714286, 1.0277373590396508, 2.5, 1.0328260926699782, 1.0086393088552916, 1.0357880842929317, 1.0810810810810811, 1.6666666666666667, 1.4782608695652173, 1.109375, 1.0638409277490837, 1.0, 1.0489296636085628, 1.004524886877828, 1.0052083333333333, 1.017236071743878, 1.18125, 1.0943396226415094, 1.008134115437098, 1.1008471408994642, 1.1117236473569554, 1.1282051282051282, 1.0, 1.107398568019093, 1.3012820512820513, 1.0524590163934426, 1.0884161752316766, 1.0442035029190992, 1.1774647887323944, 1.4390243902439024, 1.008298755186722, 1.0018092530369604, 1.2857142857142858, 1.0041644996481782, 1.0263157894736843, 1.1176470588235294, 1.0995375437828372, 1.2380952380952381, 1.4, 1.001969254224368, 2.0, 1.2071330589849107, 1.0247093023255813, 1.0672682526661197, 1.1044277360066834, 1.1331360946745561, 1.0963855421686748, 1.1075501562521137, 1.0746573841922056, 1.02945301542777, 1.0052092348524186, 1.0907573228107452, 2.0, 1.125, 1.0720308965012912, 1.25, 1.0715483510340973, 1.3529411764705883, 1.0, 1.375, 1.3614457831325302, 1.071969696969697, 1.2647058823529411, 1.002169197396963, 1.0, 1.2083888149134487, 1.0349333843309747, 2.0, 1.2983918999404407, 1.0, 1.0987474379412434, 1.0853658536585367, 1.0254788769351877, 1.1428571428571428, 1.1363636363636365, 1.3044444444444445, 1.3703703703703705, 1.0271799168143299, 1.0240476174894144, 1.0637393767705383, 1.0, 1.0769230769230769, 1.5714285714285714, 1.5, 1.2307692307692308, 1.0687629388941444, 1.3333333333333333, 1.0656028368794326, 1.0978260869565217, 1.2196365659187836, 1.0764079625415262, 1.227600411946447, 1.0293061918481083, 1.0046403712296983, 1.0511904761904762, 1.5, 1.0062893081761006, 1.1404255319148937, 1.0388490137458293, 1.1428571428571428, 1.5714285714285714, 1.0311804008908685, 1.026865671641791, 1.0317352879287367, 1.0269607843137254, 1.1464387464387464, 1.0147742818057455, 1.0125, 1.0907770515613653, 1.0625, 1.2884615384615385, 1.0254957507082152, 1.0336134453781514, 1.05996219877146, 1.064830122571626, 1.057878012181128, 1.0232558139534884, 1.0673076923076923, 1.1222570532915361, 1.0, 1.0380083420229405, 1.0592451908728329, 1.054389426391233, 1.0609603935688567, 1.0455908818236352, 1.1448999046711152, 1.8333333333333333, 1.454736842105263, 1.0, 1.1947053800170795, 1.25, 1.0246837979869956, 1.0344827586206897, 1.0677128116938952, 1.098814229249012, 1.0559322033898304, 3.0, 1.2158119658119657, 1.0087185558400558, 1.0357274232113298, 2.0, 1.1111111111111112, 1.2706333973128598, 1.288888888888889, 1.0911015224293739, 1.1081081081081081, 1.2352941176470589, 1.1578947368421053, 1.0178656389761158, 1.0556781464260383, 1.1003224650662844, 1.1281798245614034, 1.021558872305141, 1.106060606060606, 2.142857142857143, 1.053475935828877, 1.5, 1.2308984047019311, 1.0, 1.038190248082797, 2.272727272727273, 1.0884324977348234, 1.1065149770575196, 1.0882171499074644, 1.0, 1.14, 1.2, 1.2872670807453417, 1.0940919037199124, 1.0, 1.0180744074829453, 1.1006787769086561, 1.018234562784915, 1.5, 2.0, 1.0159223300970874, 1.0108695652173914, 1.0360655737704918, 1.2222222222222223, 1.0663993457672725, 1.1182682154171066, 1.4705882352941178, 1.0132203389830508, 1.0454545454545454, 1.1312335958005248, 1.0088709677419354, 1.4084981068573832, 1.0461806389622867, 1.0, 1.0422535211267605, 1.1099597530549434, 1.0585659506377962, 1.0176493468607177, 1.0, 1.0694536606945366, 1.006645500004925, 1.0214772132006287, 2.0, 1.0287081339712918, 1.0444638400924435, 1.0319297606027464, 1.0416320824778298, 1.0131501273161405, 1.0387585880123194, 1.0084745762711864, 1.1089681774349085, 2.0, 1.1400072355160473, 1.7619047619047619, 1.25, 1.1554404145077721, 1.1153846153846154, 1.017276539095854, 1.0305862361937128, 1.0573427375422904, 1.1257457549334557, 1.0740964364637549, 1.0680373326119301, 1.0599766519874707, 1.271604938271605, 4.0, 1.018149081742888, 1.1176113360323887, 1.047138146970919, 1.0540902159004806, 1.0745814307458144, 1.2660178426601785, 2.458823529411765, 2.4285714285714284, 1.023932414666212, 1.0179604024378015, 1.010034631145628, 1.079674220963173, 1.0856874276899344, 1.02680412371134, 1.0718895064426819, 1.0156418554476807, 1.2021439509954057, 3.0, 1.2, 1.0138036809815951, 1.0782442748091603, 1.0661896243291593, 1.1258366800535475, 1.0294117647058822, 1.0101522842639594, 1.148905109489051, 1.1097560975609757, 1.0547768307858467, 1.2555555555555555, 1.0064469136950425, 2.0, 1.1289537712895377, 1.0714285714285714, 1.330188679245283, 1.1083798882681564, 1.0212290502793295, 1.0691699604743083, 1.046692607003891, 1.1446122066238125, 1.0, 1.127659574468085, 1.2, 1.0, 1.1363636363636365, 1.125, 1.0077760497667185, 1.0679611650485437, 1.0660044857417494, 1.0638051044083527, 1.1002600731220082, 1.162140483556778, 1.041860465116279, 1.0736426846531768, 1.0486486486486486, 1.0861182519280206, 1.0280599903241412, 1.0629112924453803, 1.26878612716763, 1.1045887961859355, 1.038007398773628, 1.1448557067032232, 1.0781214960992365, 2.0, 1.2235872235872236, 1.0712871287128714, 1.4205607476635513, 1.0, 1.1590909090909092, 1.25, 1.1795407098121085, 1.3703703703703705, 1.1666666666666667, 1.0091914578248227, 1.1331279324996475, 1.028738456762979, 1.006415578534229, 1.2756756756756757, 1.1289437585733881, 1.0, 1.1846153846153846, 1.021559923906151, 1.0961564002443753, 1.0831482509716823, 1.1151611800888483, 1.0143639595197504, 1.1714285714285715, 1.0736490673916954, 1.1172291296625223, 1.0334551651456376, 1.1597074493119224, 1.2727272727272727, 1.0545645330535152, 1.0, 1.2422535211267605, 1.2076436521953424, 3.0, 1.1341040462427745, 1.056630055031626, 1.4285714285714286, 1.0304762611826719, 1.2, 1.0555555555555556, 1.0616940486484454, 1.6923076923076923, 1.028467664938424, 1.045279794959419, 1.3103448275862069, 1.0689655172413792, 1.1422680412371133, 1.0014347202295553, 1.0770419426048565, 1.024314983954579, 1.1557887031840917, 1.0, 1.0227025852704759, 1.1189024390243902, 2.0, 1.011076908726272, 1.1221472445713296, 1.1381267738883634, 1.0123945365977904, 1.061696290421147, 1.0660377358490567, 1.5714285714285714, 1.0721859706362153, 1.0629032258064517, 1.0860129299373866, 1.1615652847733438, 1.0270648784789262, 1.0772231432591706, 1.1758241758241759, 1.1029954862535905, 1.2374581939799332, 1.0615937963252795, 1.0763406940063092, 1.0405278039585297, 1.0993071593533488, 1.0633365646321913, 3.0, 1.1309968570242543, 1.0591697286825785, 1.0234511085783102, 1.5833333333333333, 1.2891959450076378, 1.266355140186916, 1.1428571428571428, 1.0530436622698738, 1.0420575865415722, 1.1266375545851528, 1.0625, 1.3333333333333333, 1.0493142041828885, 1.5, 1.1168224299065421, 1.0833333333333333, 1.0683134463749913, 1.3846153846153846, 1.1265822784810127, 1.0649895178197064, 1.0, 1.5912698412698412, 1.3566992014196984, 1.5, 2.0, 1.1367521367521367, 1.1482758620689655, 1.0252971654983236, 1.2171136653895274, 1.1267605633802817, 1.2654867256637168, 1.1014466214978942, 1.0623376623376624, 1.1342592592592593, 1.2244897959183674, 1.0, 1.0, 1.137299771167048, 1.0937950937950938, 1.0157397691500525, 1.1331298426860765, 1.083191625207821, 1.1081068695293526, 1.0822636587318057, 1.19725997686524, 1.199134199134199, 1.0133010882708586, 1.8333333333333333, 2.0, 1.2142857142857142, 1.0246793655612052, 1.0706090026478376, 1.107843137254902, 1.0763546798029557, 1.0430698739977091, 1.0179208541002804, 1.0105980831025272, 1.1304347826086956, 1.2222222222222223, 1.0384319754035358, 1.0454665959703076, 1.0695804539350866, 1.0583898720011191, 1.0066225165562914, 1.1075753101004135, 1.0286164904990824, 1.1762048192771084, 1.4073319755600815, 1.125, 1.0137299771167048, 1.8461538461538463, 1.1304347826086956, 1.1504702194357366, 1.0701001430615165, 1.0, 1.0022831050228311, 1.0228611129491167, 1.0740740740740742, 1.074375691575319, 1.052396878483835, 1.1944444444444444, 1.0606671978205557, 1.03168709444845, 1.030754767660489, 1.0419847328244274, 1.0522133938706015, 1.2053938385245067, 1.1914893617021276, 1.8571428571428572, 1.0, 1.25, 1.0618384401114207, 1.3333333333333333, 1.1734381595609962, 1.1046254913574929, 1.0117412494461675, 1.0570009930486595, 1.0532455728568433, 1.0636655948553055, 1.043010752688172, 1.044382801664355, 1.0051642505464005, 1.1289370078740157, 1.042236000019984, 1.1834276767433458, 1.6666666666666667, 1.046875, 1.0284552845528456, 1.1235918056085132, 1.0358306188925082, 1.2871099050203527, 1.0272727272727273, 2.2401746724890828, 1.0552626304672925, 1.0322147651006712, 1.1018301435406699, 1.1875, 1.0777304497211306, 1.0397239290201545, 1.3145077720207254, 1.0581052631578947, 1.103448275862069, 1.1645885286783042, 1.0578947368421052, 1.5, 1.0886350279165442, 1.6153846153846154, 1.3570451436388509, 1.123456790123457, 1.002022926500337, 1.0052471225457007, 1.0107015457788346, 2.75, 1.0717703349282297, 1.099838229346667, 1.049441635646425, 1.019088650782286, 1.0392286557443777, 1.0374505777943697, 1.0833333333333333, 1.0894239036973346, 1.1433995979450524, 1.0071945681010837, 1.0150300601202404, 1.0138888888888888, 1.0608656447249774, 1.0582762412247315, 1.3825301204819278, 1.081884591426468, 1.0, 1.3333333333333333, 1.0756705975425844, 1.0116786267060645, 1.2468751496575834, 1.0833472338059493, 1.0399042298483638, 1.094890510948905, 1.1090970024938147, 1.1051403426895126, 1.1580882352941178, 1.0, 1.0207290922087204, 1.0892848377754871, 1.0952380952380953, 1.75, 1.0398094992367068, 1.179103746632928, 1.0108323831242874, 1.0397727272727273, 1.2027516292541636, 1.0142387655505092, 1.159403992128198, 1.3513513513513513, 1.2692307692307692, 1.0599730458221024, 1.0462555066079295, 1.121875, 1.5357142857142858, 1.0608000893954632, 1.1922695738354807, 1.1691542288557213, 1.0731707317073171, 1.0239943825860167, 1.0069632495164411, 1.0690763052208836, 1.2463854228560112, 1.3333333333333333, 1.0, 2.0, 1.1581330546847788, 1.3076923076923077, 1.0, 1.25, 1.0066225165562914, 1.088768115942029, 1.0204311086906874, 1.0376778543453473, 1.1854545454545455, 1.3076923076923077, 1.1428571428571428, 1.032258064516129, 1.135135135135135, 1.0144927536231885, 1.1088082901554404, 1.0297576031824291, 1.0310192571704204, 1.3061224489795917, 1.0731006749964096, 1.047595215454682, 2.5, 1.0632846789833623, 1.206896551724138, 3.0, 2.0, 1.1958579881656806, 1.0773865021874776, 1.0675897318533776, 1.2142857142857142, 1.0, 1.1365638766519823, 1.107361963190184, 3.0, 1.5, 1.054762522709577, 1.1286463234305686, 1.071848056978633, 1.6666666666666667, 1.024139987530158, 1.0441518202943454, 1.0483870967741935, 1.0, 1.0234741784037558, 1.0240715433945249, 1.131578947368421, 1.1596575169982373, 1.0481795450387266, 1.2648809523809523, 1.125, 1.0671135020724931, 1.0182608695652173, 1.0661157024793388, 1.1129032258064515, 1.0594932451830403, 1.4857350536071234, 1.0397018330126617, 1.2994011976047903, 1.2058823529411764, 1.2388059701492538, 1.0867208672086721, 1.047560222359481, 1.0318663549380491, 1.0810346809733666, 1.074235807860262, 1.5, 1.6666666666666667, 1.0566387521575145, 1.15259454705365, 1.1276016339233612, 1.0214037628404167, 1.0598762334838603, 1.1289491758241759, 1.1395348837209303, 1.0212765957446808, 1.065796714094804, 1.0514885660865814, 1.2191091954022988, 1.2332613390928726, 2.5, 1.0273972602739727, 1.0688546445516214, 1.1909504837791691, 1.0635773895442404, 1.0841907526789907, 1.015625, 2.0, 1.0686641697877652, 1.0043305865674286, 1.1818597212702764, 1.0456273764258555, 1.07895270109188, 1.0605095541401275, 1.1832229580573952, 1.0208695652173914, 1.031310898936344, 1.0663355501304823, 1.0207373271889402, 1.0511440107671601, 1.0, 1.200533388039799, 1.0429883901636348, 1.0330250990752972, 1.0938581166718049, 1.1044867854947757, 1.0317700453857792, 1.2857142857142858, 1.1572481572481572, 1.6666666666666667, 2.0, 1.1764705882352942, 1.0076726342710998, 1.0600315955766193, 1.034934665641814, 1.003993473033322, 1.0504748982360923, 1.0218041898247114, 1.1304347826086956, 1.1395348837209303, 1.0403136990817707, 1.6, 1.4166666666666667, 1.2980160405234276, 1.1428571428571428, 1.060734463276836, 1.1081344374086703, 1.0193780982424516, 1.1128613396958336, 2.0, 1.003417210313762, 1.2151162790697674, 1.0605659878339064, 1.0394093415415102, 1.1666666666666667, 1.1366438356164383, 1.1491708998142636, 1.1485601285378817, 1.0277777777777777, 1.0923076923076922, 1.1047486033519553, 1.0, 1.0, 1.0415265906083473, 5.0, 1.5714285714285714, 1.8, 1.0012062726176116, 1.0681818181818181, 1.0703991130820398, 1.0647312671635936, 1.0, 1.1111111111111112, 1.0175233644859814, 1.1861702127659575, 1.3004807692307692, 1.4285714285714286, 1.0335846470185057, 1.1330376940133038, 1.1419068736141906, 1.0189661584232057, 1.0164237653428654, 1.1067142715461669, 1.1257024548950014, 1.0, 1.246816431865296, 1.0342132845296217, 1.089131994261119, 1.1774193548387097, 1.0537269596921208]
origin-bjaq_15.71 	max: 5.0000	99th: 2.5025	95th: 1.7506	median: 1.0779	mean: 1.1755

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 13.964945 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[2.9802322e-07 5.9604645e-08 2.3841858e-07 1.2516975e-06 4.7683716e-07]
Distance score: 4.6491624061673065e-07
SAUCE Drift detection: False
Detection latency: 0.0231s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.034782 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 8.0000	99th: 2.5050	95th: 2.0000	median: 1.0832	mean: 1.1882
ReportEsts: [1.0491803278688525, 1.0064977257959715, 1.044500349069549, 1.0162074554294975, 1.5217391304347827, 1.0, 1.0782765308949847, 1.0575511491307605, 1.1666666666666667, 1.0088105726872247, 1.0503892733564013, 1.043794797394563, 1.046279155868197, 1.0916030534351144, 1.0808080808080809, 1.0, 1.1634615384615385, 1.0, 1.0833333333333333, 1.1414225941422593, 1.098557965254911, 1.0700615779914056, 1.1993911719939117, 1.0177215189873419, 1.0382723584533085, 1.0140425798087094, 2.0, 1.162105835447626, 1.4, 1.1428571428571428, 1.080091533180778, 1.0, 1.0439621489172266, 1.0001332547472004, 1.1090993500464252, 1.0025827081539787, 1.2378622111922821, 1.1607929515418502, 1.0, 1.015233106338397, 1.02304542424531, 1.0777759025821443, 1.1493670886075948, 1.0182296560796842, 1.009090909090909, 1.0430050438014336, 1.2727272727272727, 1.0, 1.6538461538461537, 1.0269151138716357, 1.0222222222222221, 1.2162162162162162, 1.0666666666666667, 1.0857142857142856, 1.0407120896558564, 1.0056117185888178, 1.0026625560538116, 1.1347150259067358, 1.0869565217391304, 1.0672886378368367, 1.2537313432835822, 1.0551762491444217, 1.077760497667185, 1.0795454545454546, 1.0198019801980198, 1.1666666666666667, 1.095572422517394, 1.2757544224765869, 3.0, 1.0, 1.0383631713554988, 1.002002002002002, 1.055072463768116, 1.0285171102661597, 1.0902985364338678, 1.300192431045542, 1.039419451021661, 1.1082474226804124, 1.4757281553398058, 1.0686970585816498, 1.0725012946659762, 1.2972972972972974, 1.0, 1.8, 1.054176072234763, 1.180327868852459, 1.5, 2.3333333333333335, 1.5, 1.0879170063460093, 1.105972159856309, 1.2208995421492055, 1.0130336617405582, 1.1490875058493215, 1.2452830188679245, 1.0347305389221557, 1.0684931506849316, 1.0461538461538462, 1.9166666666666667, 1.3450454007106198, 1.2, 2.0, 1.05162401616768, 1.2854077253218885, 1.0679886685552409, 1.2259192501802452, 1.25, 1.0096158629013046, 1.0522438044206297, 1.114579368100495, 1.112810707456979, 1.049643584521385, 1.2857142857142858, 1.0, 1.049286133385488, 1.0645407018132518, 1.0682666666666667, 1.1931818181818181, 1.0584204851187673, 2.0, 1.1110817941952507, 1.1942583732057417, 1.0, 1.0046728971962617, 1.1111111111111112, 1.2983193277310925, 1.0240998650313258, 1.1226299100498285, 1.1475409836065573, 1.5, 1.0891763104152485, 2.0, 1.2857142857142858, 1.1151470452659722, 1.0769230769230769, 1.2380952380952381, 1.0050785730991547, 1.084665272707942, 3.0, 1.5714285714285714, 1.0379746835443038, 1.0500664599025256, 1.082995951417004, 1.0073775216138328, 1.2745098039215685, 1.0190114068441065, 1.1524676880590499, 2.0, 1.0345622119815667, 1.0028169014084507, 1.0883174958077138, 1.0905765291191103, 2.0, 1.2468348019852122, 1.028205128205128, 1.0338983050847457, 1.5666666666666667, 1.0, 1.029219143576826, 1.143230434225695, 1.2391557564180218, 1.0789022298456261, 1.016, 1.3392857142857142, 1.416, 1.0404040404040404, 1.3333333333333333, 1.0511953956292979, 1.0, 1.1535269709543567, 1.3320907444882308, 1.1610644257703082, 1.0008386447500839, 1.2482394366197183, 1.1714285714285715, 1.0934828198096467, 1.0167023554603853, 1.0390097524381094, 1.0630114566284778, 1.0444386011043914, 1.198260589466903, 1.2277776325762526, 1.1775147928994083, 1.2352941176470589, 1.00605015775949, 1.076184604544654, 1.3178571428571428, 1.1092233009708738, 1.066193853427896, 1.4, 1.2231638418079096, 1.0492434800631802, 1.2727272727272727, 1.135243841126194, 1.0728157633605822, 1.1148126801152738, 1.029706269378258, 1.094621513944223, 1.0164410617081747, 1.097934391446342, 1.0199004975124377, 1.0586352941176471, 1.0078478002378122, 1.0490777596690277, 1.0648801128349787, 1.0853401300755845, 1.2843601895734598, 1.1911764705882353, 1.2289156626506024, 2.0, 1.391304347826087, 1.0477840240554321, 1.3529411764705883, 1.2815533980582525, 1.0136082474226804, 2.0, 1.0411549652527383, 1.002288329519451, 1.2381637300731152, 1.1428571428571428, 1.003627569528416, 1.0087027468044603, 1.0315029455433689, 1.001431529923747, 2.0, 1.0088141025641026, 1.1268025694808599, 1.03953416236641, 1.0188172043010753, 1.03035413153457, 1.0286975717439293, 1.0778133786699797, 1.4273504273504274, 1.0043572322336956, 1.062999888397009, 1.0613496932515338, 1.199792960662526, 1.0596685082872928, 2.5, 1.1500974658869396, 2.0, 1.222329627839536, 1.0996091932632364, 1.2440172616712437, 1.0726643598615917, 1.0, 2.0, 1.1316186929043799, 1.0735294117647058, 1.0869185538801887, 1.2, 1.01840490797546, 1.1098779134295227, 1.375, 1.0019358101167808, 1.0295454545454545, 1.1028368794326242, 1.0666666666666667, 1.003169014084507, 1.090912025306241, 1.0307692307692307, 2.0, 1.092412068049821, 1.0712137024986188, 1.1204644412191582, 1.0157791977280795, 1.1351286193013332, 1.02544146776618, 1.1001335113484647, 1.0936000234109797, 1.0284715284715285, 1.012463935372187, 1.0066197765825404, 1.0, 1.0385164199935424, 1.069811320754717, 1.2075471698113207, 1.4761904761904763, 1.0687936191425722, 1.083974358974359, 1.0217347484290509, 1.0101979815029716, 1.026634382566586, 1.3674321503131524, 1.0293477175107382, 1.0779310344827586, 1.0729461427842464, 1.0443091196392433, 1.4, 1.0701357466063348, 1.2407068860450945, 1.0388185922299231, 1.0451891342980453, 1.0793752459737473, 1.2027168234064787, 1.18561872909699, 1.0340949533774646, 1.0848393916660983, 1.078568082729795, 1.041924040924219, 1.0036730945821855, 1.4545454545454546, 1.0666666666666667, 1.0870151265538415, 1.0909090909090908, 1.029038112522686, 1.0031263018295362, 1.008865407002776, 1.3783783783783783, 1.0701754385964912, 1.102608695652174, 1.0704639889196677, 1.0296171378883296, 1.1904761904761905, 1.2027310924369747, 1.0136264933029637, 1.2149532710280373, 1.25, 3.0, 1.0731594738056773, 1.0, 1.0012725040264068, 1.066772655007949, 1.25, 1.120967282424132, 1.434782608695652, 1.3076923076923077, 1.0090614544814227, 3.0, 1.138996138996139, 1.0358851674641147, 1.0101010101010102, 1.0959158415841583, 1.1584158415841583, 1.04, 1.0979542204758097, 1.0705995281647773, 1.1327683615819208, 1.026527263547627, 1.0267214187942628, 3.0, 1.2, 1.055995119254161, 1.2, 1.081547064305685, 1.4210526315789473, 4.0, 1.5555555555555556, 1.369308600337268, 1.0763239875389408, 1.173913043478261, 1.031863814927979, 1.3, 1.8333333333333333, 1.023430295917512, 1.2857142857142858, 1.1940298507462686, 1.0072720519599843, 1.1659574468085105, 1.031650339110776, 1.0226628895184136, 1.4, 1.25, 1.3659751037344399, 1.1555555555555554, 1.1848341232227488, 1.125400641025641, 1.212211466865227, 1.0023980815347722, 1.0, 1.0308356325451984, 1.1282051282051282, 1.36, 2.0, 1.0809523809523809, 1.2857142857142858, 1.1141649048625792, 1.1308411214953271, 1.2139484758288002, 1.090170663838011, 1.1109877913429522, 1.0888037229674241, 1.1110812264658418, 1.1716867469879517, 1.0846953937592867, 1.1129918871787094, 1.0595813204508857, 1.027027027027027, 1.009041309431021, 1.0880556658536125, 1.0271328671328672, 1.014218009478673, 1.0, 1.2203023758099352, 2.0, 1.0212765957446808, 1.3867924528301887, 1.196911196911197, 1.5153846153846153, 1.0665983606557377, 1.0667735042735043, 1.1133004926108374, 1.016142542308099, 1.0568828213879409, 1.0242646708299565, 1.0096153846153846, 1.2857142857142858, 1.1064935064935064, 1.0, 1.0240683184709676, 1.6326530612244898, 1.1090325018896448, 1.105772463492713, 1.0692707003659263, 1.1438679245283019, 1.5, 1.3033826638477801, 1.3333333333333333, 1.1836238346169436, 1.0833333333333333, 1.1406940063091482, 1.0012106537530265, 1.0869487591501517, 1.1317567567567568, 1.0508002783576895, 4.0, 1.1675272518646012, 1.0108066955526487, 1.1443808283706414, 2.0, 1.1333333333333333, 1.2009531374106435, 1.2996845425867507, 1.1048281562091053, 1.5082908163265305, 1.0, 1.229018492176387, 1.0335371390520007, 1.0370502085286606, 1.2541546358678217, 1.000537833606234, 1.2542423046566693, 1.075, 1.0679100908656145, 1.0574416717590134, 1.3047619047619048, 1.0207006369426752, 1.0, 1.5, 1.2504930966469427, 1.032967032967033, 1.0555160142348754, 1.0935139620050354, 1.094747682801236, 1.0, 1.0578512396694215, 1.2592592592592593, 1.0512185833968013, 1.2173913043478262, 2.0, 1.0721839141310534, 1.0, 1.0, 1.0216886134779242, 2.0, 1.0075040783034257, 1.0172155688622755, 1.0465753424657533, 1.0909090909090908, 1.0885643349635812, 1.0601694915254238, 1.35, 1.0028297437509825, 1.0534351145038168, 1.1243301178992497, 1.0621160409556314, 1.2671543016370603, 1.044990491442298, 2.0, 1.035294117647059, 1.080321609121222, 1.1525279945707498, 1.0814696485623003, 1.2, 1.1331223235896482, 1.0147022627701294, 1.0240700218818382, 1.0, 1.0496057818659659, 1.0562887795970035, 1.0451367594750398, 1.0118665929611204, 1.0242504769186231, 1.0043239637344976, 1.0071530758226037, 1.1288516746411483, 2.0, 1.1186345831001678, 1.197674418604651, 1.0586803019235451, 1.030045351473923, 1.0026246719160106, 1.015110814956722, 1.3367983367983367, 1.0187610844686215, 1.1811234237676729, 1.0915614060228878, 1.1736453201970443, 1.0886075949367089, 1.1001056125528064, 1.0227272727272727, 1.2317073170731707, 1.151791150801705, 1.109442060085837, 1.0131397689943837, 1.059626860859083, 2.0, 1.2104863221884499, 1.3827893175074184, 1.5714285714285714, 1.3148148148148149, 1.0194762263821044, 1.1610486891385767, 1.1304347826086956, 1.0, 1.0, 1.0135259055479138, 1.1605954912803063, 1.0439132851584214, 1.0105483615559472, 1.1153695737192022, 1.014910536779324, 1.0045871559633028, 1.007821162972929, 1.5892857142857142, 1.02355094948492, 1.0719315895372235, 1.099009900990099, 1.1117636130949924, 1.058165548098434, 1.01989913243441, 3.0, 1.1734837799717912, 1.0649350649350648, 1.0155396982332459, 1.1194690265486726, 1.0696078431372549, 1.0515463917525774, 1.0115702479338844, 1.1135080801051573, 1.0, 1.1333333333333333, 1.1666666666666667, 1.3333333333333333, 1.110091743119266, 2.3461538461538463, 1.0235294117647058, 1.0316205533596838, 1.0585958355579284, 1.0396155649320207, 1.1063097212350943, 1.1831006469815635, 1.0731238602264164, 1.1021285745001075, 1.0192939549700026, 1.113124656781988, 1.168744804655029, 1.0566057948000553, 1.0515313563441906, 1.0831509846827134, 1.1955958549222798, 1.2602739726027397, 1.0284531395868004, 1.1507009345794392, 1.0998662417876393, 1.3314606741573034, 1.1366251198465964, 1.0569620253164558, 1.3333333333333333, 1.0594530321046374, 1.0666666666666667, 3.0, 1.3106060606060606, 1.0525172381222254, 1.0294996265870053, 1.0051150895140666, 1.1758241758241759, 1.0935385025313082, 1.020016631028748, 1.0927272727272728, 1.0, 1.1111111111111112, 1.11113753939466, 1.1805555555555556, 1.1104393389762193, 1.134738337674639, 1.0, 1.3392747387830362, 1.1209503239740821, 1.017019864409994, 1.1040118870728084, 1.033402435380248, 1.0310162288440987, 1.0097522734399498, 1.4333333333333333, 1.0, 1.1570230497389102, 1.0, 1.0451388888888888, 1.2245762711864407, 1.3699300699300698, 1.2272727272727273, 1.8636363636363635, 1.024668028600613, 1.0596026490066226, 1.5, 1.0315175937252645, 1.1512444160816848, 1.2122477383437718, 1.0409860119338745, 1.003584229390681, 1.0510416666666667, 1.4, 1.0983770479193908, 1.0604284490145672, 1.105263157894737, 1.010973936899863, 1.2518014817821983, 1.0170697012802277, 1.0062794064422729, 1.2222222222222223, 1.014209591474245, 1.0242258474162351, 1.0987951807228915, 1.25, 1.0958532607699778, 1.0390625, 1.4444444444444444, 1.0682910089224433, 1.0530913978494623, 1.065883814147801, 1.1478624236579877, 1.0377615927128774, 1.0851576405805519, 1.0212121212121212, 1.0932607215793058, 1.1353591160220995, 1.088689134042564, 1.0695559122525415, 1.0119047619047619, 1.0297723292469352, 1.0468238375900458, 2.0, 1.0024410089503661, 1.0833333333333333, 1.1428571428571428, 1.137546468401487, 1.6115606936416185, 1.0277258566978194, 1.225, 1.0714285714285714, 1.0186385737439223, 1.0196920873612603, 1.0946745562130178, 1.0459451675284244, 2.0, 1.2114570361145705, 2.0, 1.140529531568228, 1.1333333333333333, 1.0095706306725623, 1.3548387096774193, 1.1172413793103448, 1.077396657871592, 1.0, 1.1756657107742727, 1.2652354570637119, 1.0, 2.0, 1.099290780141844, 1.2017543859649122, 1.0562417871222076, 1.18717683557394, 1.0933908045977012, 1.04, 1.0736040609137056, 1.0017543859649123, 1.1686274509803922, 1.32, 1.0588235294117647, 1.0, 1.2073544433094996, 1.1342042755344417, 1.0257953568357696, 1.0302464193577083, 1.0341399607586659, 1.0443772062531518, 1.07476335434792, 1.1321563301644786, 1.2163814180929096, 1.0020060180541626, 1.8888888888888888, 1.0, 1.1875, 1.0291439671481812, 1.0843819393042191, 1.0824468085106382, 1.1004098360655739, 1.035911426939915, 1.057935993398951, 1.0102590559204532, 1.1529411764705881, 1.2857142857142858, 1.0829068577277379, 1.023628739800544, 1.0886403112624192, 1.020616585497531, 1.0454545454545454, 1.1060755742158557, 1.0628955438115744, 1.0268116587931189, 1.0722263588979897, 1.0872529984655372, 1.08, 1.0445736434108528, 1.2309322033898304, 1.0315918332717213, 1.75, 1.0867277664630006, 1.0, 1.084848484848485, 1.032540345019477, 1.0517241379310345, 1.0601089275539006, 1.0389725420726306, 1.2325581395348837, 1.0736483702370367, 1.0269741397477194, 1.0851841517857144, 1.0614035087719298, 1.0018726591760299, 1.200079037994693, 1.1510416666666667, 1.15, 2.0, 1.375, 1.0600899937448294, 1.6666666666666667, 1.2994865944095835, 1.1246112192611488, 1.019718309859155, 1.0580994583948793, 1.1027138778590884, 1.0498417005879692, 1.0206489675516224, 1.034443168771527, 1.0139814180929094, 1.0979603000937792, 1.041373806564777, 1.1884028892455858, 1.7142857142857142, 1.005464480874317, 1.055363321799308, 1.0777110867432331, 1.021917808219178, 1.2513227513227514, 1.056338028169014, 2.2971014492753623, 1.010028758941081, 1.0314253647586982, 1.063508205220235, 1.0952380952380953, 1.0563544519625088, 1.0333537680704856, 1.23587907716786, 1.0443366816764807, 1.3, 1.1120599591187827, 1.1798287345385348, 1.0057915657412584, 1.4133333333333333, 1.0196610983079406, 1.1515151515151516, 1.0488663568511478, 1.0942441492726123, 1.0417193426042983, 1.1161731207289294, 1.078578110383536, 1.033203125, 1.0656465942744324, 1.0035791680683446, 1.051984877126654, 1.0388603988603988, 1.0677448952841455, 1.2, 1.097439544807966, 1.045122985581001, 1.012248022454708, 1.0035650623885919, 1.0170212765957447, 1.1727183513248283, 1.03125, 1.0527638190954773, 1.043907069291954, 1.0909090909090908, 1.1063084112149533, 1.2418995995307633, 1.0466421939106025, 1.0749574105621806, 1.204147914443465, 1.1313034616928634, 1.0622073578595317, 1.080078125, 1.098855658407458, 1.060716956939844, 1.1158536585365855, 1.0673076923076923, 1.0693251533742332, 1.072467463587777, 1.108910891089109, 2.5, 1.0499453384049655, 1.1697980684811238, 1.0667335674862017, 1.0480769230769231, 1.2246508803885854, 1.020786383412605, 1.1613657623947615, 1.1141552511415524, 1.3103448275862069, 1.0320404721753795, 1.6, 1.1096938775510203, 1.65625, 1.0452487004714568, 1.1752241238793806, 1.1649484536082475, 1.1304347826086956, 1.1242937853107344, 1.1404185022026432, 1.0679611650485437, 1.1428571428571428, 1.0409683426443204, 1.0283400809716599, 1.0533007334963325, 1.0769230769230769, 1.010012645369929, 1.0345821325648414, 1.1042866282789507, 1.2946428571428572, 1.1764705882352942, 1.1901734104046242, 1.0306764325721671, 1.0369329143928119, 1.1048513302034428, 1.1875, 1.1176470588235294, 1.0789473684210527, 1.2195121951219512, 1.0759493670886076, 1.1393188854489165, 1.0266766062788342, 1.0321351705712094, 1.373913043478261, 1.0810723054224793, 1.047426955230356, 2.5, 1.0327043951473542, 1.2760180995475112, 2.0, 2.25, 1.1556315660884438, 1.121695016413011, 1.0582960582960583, 1.236842105263158, 1.0, 1.0568561872909699, 1.0175438596491229, 2.4, 1.0994951066018999, 1.1318663227789059, 1.035137778135005, 1.0538004379105412, 1.7142857142857142, 1.0467916638993247, 1.034548944337812, 1.0899742930591259, 1.041602465331279, 1.0035087719298246, 2.0, 1.0614567526555387, 1.1537659629919208, 1.0467753126533652, 1.0959147424511546, 1.1972789115646258, 1.061094813209821, 1.0672268907563025, 1.0517241379310345, 1.2191780821917808, 1.044871751084395, 1.1928700906344412, 1.0280995036229816, 1.2738853503184713, 1.2352941176470589, 1.1491002570694087, 1.0, 1.0750307503075032, 1.0, 1.0087283148605788, 1.0628988149498633, 2.0, 1.036979969183359, 1.0054476266773482, 1.1922222222222223, 1.1979638009049773, 1.021153846153846, 1.0730720959419886, 1.1157308946547568, 1.1160337552742616, 1.0344827586206897, 1.0948520203018917, 1.0957094017094018, 1.2282608695652173, 1.1885714285714286, 2.0, 1.130952380952381, 1.0109482886040668, 1.0421052631578946, 1.0368291070054927, 1.0669859139152595, 1.0339083878643665, 1.6, 1.1127659574468085, 1.0151783880663892, 1.1718929254302104, 1.003257328990228, 1.0736087869744624, 1.1455525606469004, 1.239292364990689, 1.0066571564431763, 1.030740896430548, 1.0945683076462667, 1.0809248554913296, 1.0715883668903803, 1.0, 1.1822793371660467, 1.2146569646569647, 1.033976647105088, 1.0222634508348794, 1.1071245515120451, 1.0403022670025188, 1.1666666666666667, 1.2567567567567568, 1.75, 2.5, 1.1904761904761905, 1.0064377682403434, 1.0341655716162943, 1.0218862673160858, 1.0101340155858594, 1.0887016848364717, 1.0559796437659033, 1.1288888888888888, 1.0306513409961686, 1.0749741438246103, 1.8, 1.8333333333333333, 1.067027027027027, 1.25, 1.036904761904762, 1.1097610368570272, 1.026297470802073, 1.0735426372838721, 2.5, 1.0564494136896645, 1.0893719806763285, 1.1726026877949844, 1.0398746033566542, 1.134819532908705, 1.1325681492109039, 1.141262216947015, 1.1486960107205442, 1.0186666666666666, 1.3015873015873016, 1.0826542491268918, 1.0, 2.0, 1.0420246976144518, 8.0, 1.5, 2.1333333333333333, 1.007920792079208, 1.10645975917725, 1.0314430095451994, 1.0310077519379846, 1.0, 1.1470035886279542, 1.0222976248182258, 1.014760147601476, 1.2865731462925851]
origin-bjaq_15.71 	max: 8.0000	99th: 2.5050	95th: 2.0000	median: 1.0832	mean: 1.1882

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.151811 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.178592