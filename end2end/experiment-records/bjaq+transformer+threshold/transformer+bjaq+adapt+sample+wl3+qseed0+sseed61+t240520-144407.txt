Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 61, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.7525	95th: 1.7505	median: 1.0806	mean: 1.1759
ReportEsts: [1.073015873015873, 1.02265625, 1.0487898384040044, 1.0743801652892562, 1.5789473684210527, 1.0, 1.1150584460233783, 1.0484041854970279, 1.0, 1.0223097112860893, 1.1649496436095, 1.042591073408638, 1.0302899177845088, 1.0883720930232559, 1.0388555280819498, 1.0, 1.0588235294117647, 1.0311725115125754, 3.0, 2.0, 1.2272727272727273, 1.077920870333349, 1.149516367014591, 1.0622431004110393, 1.0971879625061667, 1.0, 1.1510349288486417, 1.5, 1.2, 1.037313432835821, 1.0, 1.045937567714575, 1.001891516165543, 1.0876803551609322, 1.064767219856073, 1.228408665640983, 1.1657754010695187, 1.0087938467568096, 1.1352710241752186, 1.1830985915492958, 1.1111111111111112, 1.0914634146341464, 1.0, 1.0549808992065823, 1.1757344940152339, 1.890625, 1.0957446808510638, 1.215547703180212, 1.0315307989428746, 1.0740740740740742, 1.1337156902908645, 1.2147766323024054, 1.0403782369543273, 2.0, 1.5298701298701298, 1.150864553314121, 1.1224489795918366, 1.3658536585365855, 1.0683229813664596, 1.0, 1.136836604870956, 1.0921544209215441, 1.0954545454545455, 1.0, 1.0, 1.0441272135887243, 1.3355176933158583, 1.75, 1.0, 1.0330315870570108, 1.0035928143712576, 1.062754212667054, 1.0422535211267605, 1.1221253353775393, 1.096470588235294, 1.0424710424710424, 1.0, 1.1102296450939457, 1.6, 1.0358259921375075, 1.28125, 1.047955992038321, 1.2147239263803682, 1.1150895140664963, 1.1123650637880276, 1.0, 1.0706230535621022, 1.0061002687857894, 1.088235294117647, 1.75, 1.0564971751412429, 1.0636547046955784, 1.0965732087227413, 1.0434782608695652, 1.012014787430684, 1.0545454545454545, 1.0546875, 1.159248269040554, 1.0, 1.2368392009711953, 1.0215982721382288, 1.0566037735849056, 1.2493497332804302, 1.3076923076923077, 1.0272033384344175, 1.05840191133528, 1.2513097072419106, 1.1088357982555934, 1.04659717964439, 1.1666666666666667, 2.0, 1.064252336448598, 1.0627960026069954, 1.0650663297536322, 1.0, 1.0634163898816664, 1.0, 1.10722169662567, 1.1383442265795207, 1.0, 1.0274725274725274, 1.0, 1.2731829573934836, 1.0217999554308879, 1.1067795293934923, 1.0666666666666667, 1.8, 1.156456953642384, 1.0, 1.0769230769230769, 1.1076054840457616, 1.3, 1.0751953125, 1.0291407864244129, 1.057785510127998, 1.0026702269692924, 1.022408963585434, 1.0432579890880749, 1.039972432804962, 1.0725167580743449, 1.0434841644319224, 1.3728813559322033, 1.0226817878585723, 1.0888878071339037, 2.0, 1.0177757520510484, 1.0194285714285714, 1.076820307281229, 1.084347979530616, 1.5, 1.333979171712279, 1.0103703703703704, 1.0040160642570282, 1.1074561403508771, 1.186861313868613, 1.0397896581945663, 1.135800240673887, 1.1266446532893066, 1.0912863070539418, 1.0625, 1.2653061224489797, 1.2897196261682242, 1.0191458026509572, 1.2857142857142858, 1.078592539648811, 1.0233627400895164, 1.168123739071957, 1.318862416423392, 1.1204654346338125, 1.0805438498847102, 1.3305263157894738, 1.1638141809290954, 1.0620703011523192, 1.0, 1.0060763888888888, 1.0719144800777454, 1.0299438552713662, 1.1192923116950697, 1.0117480537862704, 1.0, 1.3015873015873016, 1.0374816983894584, 1.0277113237639552, 1.0934466019417475, 1.118421052631579, 1.1109673204256763, 1.2142994426292524, 1.1315282557409692, 1.1153846153846154, 1.1954545454545455, 1.0782689335394127, 1.0, 1.1, 1.0211855857310035, 1.0916976456009913, 1.0059935454126325, 1.4583333333333333, 1.0655948553054662, 1.043608728939404, 1.0599938229075099, 1.0626410835214446, 1.0860124380731528, 1.0677966101694916, 1.103448275862069, 1.1666666666666667, 1.0, 1.3675213675213675, 1.1456394890395836, 1.2926829268292683, 1.1724137931034482, 1.0108749382105784, 1.0031277926720286, 1.0028003985843383, 1.0625624237043614, 1.2466197069063234, 1.1655629139072847, 1.0966719492868462, 1.0137976346911959, 1.011890401516457, 1.0006652291599762, 1.0, 1.0629399585921324, 1.0898509050085676, 1.0126032859562057, 1.1539408866995073, 1.1146870276749883, 1.2833957553058677, 1.0357142857142858, 1.0051397420018031, 1.0275569687334394, 1.0039481105470953, 1.0847457627118644, 1.0909708078750848, 1.0228239845261122, 1.237007874015748, 2.0, 1.1642365887207702, 1.058173291648057, 1.191279887482419, 1.2822966507177034, 1.0, 1.6666666666666667, 1.0574031409929476, 1.1272727272727272, 1.0653771231331808, 1.5, 1.0, 1.0526315789473684, 1.049960967993755, 1.0612244897959184, 1.0469613259668509, 1.0632911392405062, 1.0834782608695652, 1.0071881606765327, 1.0559996902886124, 1.0, 2.0, 1.0597331030370325, 1.1017538554581192, 1.117338003502627, 1.0164935092083534, 1.1795332674275785, 1.0344581870005598, 1.09697933227345, 1.0574089396686794, 1.020334928229665, 1.0645065838141736, 1.0547927461139897, 1.2727272727272727, 1.0213939073611378, 1.1580246913580248, 1.2045454545454546, 1.3888888888888888, 1.0143858354850608, 1.0555555555555556, 1.017391304347826, 1.1099791400309535, 1.0584958217270195, 1.380952380952381, 1.0257799063634627, 1.0092281879194631, 1.039582882669441, 1.0649109226414135, 1.25, 1.0424154237904693, 2.5, 1.0514380579428282, 1.0427927927927927, 1.0360611715443084, 1.0526315789473684, 2.0, 1.2608695652173914, 1.1451612903225807, 1.0634422151142129, 1.0, 1.0015290519877675, 1.0407239819004526, 1.0064102564102564, 1.0194722596533619, 1.1524390243902438, 1.1572327044025157, 1.0125597665588524, 1.1169184099096252, 1.0551945311840663, 1.264957264957265, 1.0, 1.1121718377088305, 1.2807570977917981, 1.1588447653429603, 1.0925021061499578, 1.0212677231025855, 1.047887323943662, 1.2553191489361701, 1.008298755186722, 1.0707182320441988, 1.2857142857142858, 1.009060459660117, 1.0360531309297913, 1.1176470588235294, 1.159396891418564, 1.1428571428571428, 1.2727272727272727, 1.0177983473868848, 2.0, 1.1563786008230452, 1.069767441860465, 1.0910582444626744, 1.1016666666666666, 1.1801566579634464, 1.0833333333333333, 1.1161271121092007, 1.0692777683113848, 1.0411347517730496, 1.0542080149372428, 1.0592483419307295, 2.0, 1.0, 1.042951164331909, 1.25, 1.070949720670391, 1.3529411764705883, 1.0, 1.375, 1.3825301204819278, 1.0530232558139534, 1.162162162162162, 1.0162337662337662, 1.0, 1.1637816245006658, 1.1302640647734947, 2.0, 1.2418106015485408, 1.0, 1.0992029150535185, 1.0112359550561798, 1.000367492650147, 1.1474654377880185, 1.1363636363636365, 1.3976190476190475, 1.2222222222222223, 1.0193432632211092, 1.0201253679382745, 1.0503496503496503, 1.0, 1.0769230769230769, 1.5714285714285714, 3.0, 1.3333333333333333, 1.0688215534379928, 1.3333333333333333, 1.1930116472545758, 1.2317073170731707, 1.1835357624831309, 1.0980669125532971, 1.2409886714727085, 1.0289047371652575, 1.0110208816705337, 1.0309523809523808, 1.5, 1.054945054945055, 1.1617021276595745, 1.0325750011028099, 1.1428571428571428, 1.5714285714285714, 1.0158371040723981, 1.0147492625368733, 1.0137701460751982, 1.0124069478908189, 1.1464387464387464, 1.014500683994528, 1.0666666666666667, 1.0907770515613653, 1.0625, 1.2307692307692308, 1.0254957507082152, 1.0789473684210527, 1.050497955105991, 1.0675300808941979, 1.0328076525336092, 1.162162162162162, 1.0360360360360361, 1.098159509202454, 1.0, 1.036994596002344, 1.0534260103722013, 1.051116166642969, 1.0604791273038394, 1.0541276081040218, 1.1566571337782015, 1.8333333333333333, 1.0853403141361258, 1.0, 1.2425277540563622, 1.25, 1.0213802555864449, 1.025260029717682, 1.0684651762682718, 1.0711462450592886, 1.0200642054574638, 3.0, 1.1418060200668896, 1.016304565586579, 1.1369091410704433, 2.0, 1.1111111111111112, 1.238003838771593, 1.2841328413284132, 1.0964126477686424, 1.2037422037422036, 1.105263157894737, 1.0517687661777395, 1.039579182661937, 1.04166099652015, 1.090637717883744, 1.0853070175438597, 1.0928689883913765, 1.1139240506329113, 2.142857142857143, 1.0287206266318538, 1.4444444444444444, 1.234006734006734, 1.0303030303030303, 1.1914813133605688, 2.272727272727273, 1.1089639043604025, 1.095911598412071, 1.1042566317088218, 1.0, 1.1515151515151516, 1.12, 1.288816449348044, 1.1991247264770242, 1.0, 1.03136225476651, 1.1235803797092458, 1.0953170327393287, 1.5, 2.0, 1.0135922330097087, 1.0099547511312217, 1.0065573770491802, 1.2222222222222223, 1.085140080710828, 1.128997867803838, 1.4705882352941178, 1.0648210922787193, 1.0545454545454545, 1.0748031496062993, 1.0096774193548388, 1.3411863693731594, 1.0285764893428588, 1.0, 1.0422535211267605, 1.056345107282748, 1.0308496096474273, 1.0250964312339956, 2.0, 1.088254810882548, 1.0043044715940992, 1.0220010476689365, 2.0, 1.0338915470494419, 1.004908396314563, 1.030145876929609, 1.0176925429207986, 1.0132795805520676, 1.027481639421938, 1.0512605042016807, 1.0400192864030857, 2.0, 1.055041604217272, 1.9473684210526316, 1.0, 1.1968911917098446, 1.1346153846153846, 1.001924980061215, 1.0101954120645709, 1.0013206247129076, 1.0536750483558994, 1.0774532724431578, 1.0407141890977951, 1.0508686154166234, 1.271604938271605, 4.0, 1.014864962189413, 1.1161943319838057, 1.0458481402511253, 1.0433383527877154, 1.082952815829528, 1.2369255150554674, 2.13265306122449, 2.2857142857142856, 1.00093821203592, 1.0514188940759641, 1.017050474668672, 1.133457249070632, 1.0850607404550714, 1.02680412371134, 1.082884256460135, 1.0194174757281553, 1.2170542635658914, 3.0, 1.1666666666666667, 1.0429447852760736, 1.0700757575757576, 1.0642857142857143, 1.0306372549019607, 1.1529411764705881, 1.228395061728395, 1.148905109489051, 1.064327485380117, 1.092616013230859, 1.2417582417582418, 1.0049051465354502, 2.0, 1.1326281529698943, 1.0476190476190477, 1.247787610619469, 1.0935754189944134, 1.0842230130486359, 1.0118577075098814, 1.0798319327731092, 1.0726712346213607, 1.0, 1.2553191489361701, 1.5, 1.5, 1.2272727272727273, 1.0866935483870968, 1.0046296296296295, 1.0631067961165048, 1.0709708426786286, 1.0417633410672853, 1.1087224870387602, 1.1745222929936305, 1.037037037037037, 1.1065612461647392, 1.1513513513513514, 1.099544567338972, 1.0493468795355587, 1.0665610142630746, 1.1517341040462428, 1.167191435768262, 1.0002534468775344, 1.006520597051825, 1.0782985352957144, 2.0, 1.1695331695331694, 1.0712871287128714, 1.4074074074074074, 1.0, 1.108695652173913, 1.25, 1.1894736842105262, 1.2222222222222223, 1.1666666666666667, 1.010818692251303, 1.1178655859506923, 1.0344227734809488, 1.0238003245498801, 1.2216216216216216, 1.1136671177266577, 1.0, 1.1323529411764706, 1.0301243339253996, 1.0838579435280367, 1.085210135164501, 1.0791092379542089, 1.0204342273307792, 1.2025974025974027, 1.1042459134368254, 1.1278863232682061, 1.0280848487566427, 1.1240610704267777, 1.2424242424242424, 1.0806451612903225, 1.0, 1.2422535211267605, 1.2107517140562911, 3.0, 1.1620469083155651, 1.031130225510295, 1.4285714285714286, 1.0247702019269815, 1.2, 1.1176470588235294, 1.047462203824869, 1.6923076923076923, 1.0361662013705086, 1.034173430158052, 1.3571428571428572, 1.2608695652173914, 1.0948453608247424, 1.007173601147776, 1.0220750551876379, 1.0734357316087308, 1.1542573443187183, 1.0, 1.0854877253964805, 1.1097560975609757, 2.0, 1.000854108956602, 1.0925858638290509, 1.153263954588458, 1.0192174217580947, 1.0203051393869722, 1.0089285714285714, 1.8571428571428572, 1.0399525316455696, 1.0274193548387096, 1.0997403831469634, 1.1674454828660437, 1.0231448721577507, 1.0116129941512226, 1.23992673992674, 1.1546391752577319, 1.1906354515050168, 1.0716572566461375, 1.043533123028391, 1.0337078651685394, 1.0141806722689075, 1.0337269045008473, 3.0, 1.1490194897129258, 1.036557344955849, 1.0474057771664373, 1.5833333333333333, 1.2652409387585057, 1.3897435897435897, 1.1428571428571428, 1.069337659589476, 1.0420575865415722, 1.1615720524017468, 1.0294117647058822, 1.3333333333333333, 1.0671805043095277, 1.5, 1.1308411214953271, 1.0833333333333333, 1.0412043821087154, 1.3846153846153846, 1.1434599156118144, 1.0576519916142557, 1.0, 1.7605820105820107, 1.2968617472434267, 1.25, 2.0, 1.1367521367521367, 1.186206896551724, 1.0265486725663717, 1.1927409261576971, 1.1408199643493762, 1.2153392330383481, 1.1014466214978942, 1.051948051948052, 1.0888888888888888, 1.3020408163265307, 1.0, 1.0, 1.1961492178098676, 1.0808080808080809, 1.0268595041322315, 1.1413030625517322, 1.0746117953992425, 1.09056467616814, 1.0948033083330864, 1.1581477732793521, 1.1525658807212205, 1.0294840294840295, 1.5714285714285714, 1.0, 1.2592592592592593, 1.0200804431964787, 1.0388349514563107, 1.107843137254902, 1.0884718498659518, 1.0044291714394806, 1.0589168590896856, 1.0173272546830419, 1.1142857142857143, 1.2222222222222223, 1.0165537998495109, 1.0428817603393425, 1.0594313149827252, 1.0362401216221768, 1.0460526315789473, 1.1213083284111045, 1.0226414522072762, 1.3396226415094339, 1.3268839103869654, 1.125, 1.0413728255759285, 1.0844594594594594, 1.1063829787234043, 1.105421686746988, 1.0701001430615165, 1.0, 1.037914691943128, 1.0011171375374404, 1.0188679245283019, 1.0529139700204586, 1.0350877192982457, 1.2647058823529411, 1.061690441583165, 1.0270007209805336, 1.0947152833736233, 1.0267175572519085, 1.0488081725312146, 1.1986354578309184, 1.1839323467230445, 1.2857142857142858, 1.0, 1.25, 1.064066852367688, 1.3333333333333333, 1.2430967020681944, 1.076328684508104, 1.0696682464454976, 1.0629592850049652, 1.051371143425441, 1.0171154475089939, 1.032258064516129, 1.0554785020804438, 1.0249606687486792, 1.1335536182977128, 1.04337236112292, 1.2299771167048055, 1.6666666666666667, 1.015625, 1.0434782608695652, 1.10381642344622, 1.0293159609120521, 1.2614361702127659, 1.082375478927203, 2.1464435146443517, 1.0258379731279084, 1.0563758389261746, 1.048744019138756, 1.125, 1.0460487609723954, 1.0274644204152616, 1.3552350427350428, 1.0581052631578947, 1.4545454545454546, 1.1974358974358974, 1.1229050279329609, 1.625, 1.062524647761087, 1.6153846153846154, 1.1980676328502415, 1.0532407407407407, 1.0613621038435603, 1.0229073372373407, 1.0167464114832536, 2.75, 1.0926829268292684, 1.0967866465678886, 1.0418689927218179, 1.0126635080532191, 1.0567205877280723, 1.066813240503237, 1.0, 1.0875536480686696, 1.0439538972455558, 1.0307632129955593, 1.0110220440881763, 1.0069444444444444, 1.1348061316501352, 1.0152879979700584, 1.3620178041543027, 1.0973368306178324, 1.0, 1.3333333333333333, 1.0693960295680982, 1.0274685557322538, 1.2284029252182118, 1.1293670651468817, 1.054269752593775, 1.076555023923445, 1.1018816965825866, 1.0590339892665475, 1.1286764705882353, 1.022099447513812, 1.037037037037037, 1.0804005301133854, 1.1071428571428572, 1.75, 1.0359671390165268, 1.1768942480039106, 1.0074116305587228, 1.0284090909090908, 1.2693700217233888, 1.0127888224564963, 1.1706494236716334, 1.10803324099723, 1.2307692307692308, 1.0330188679245282, 1.099537037037037, 1.14375, 1.4827586206896552, 1.0286177226505755, 1.193260654112983, 1.1666666666666667, 1.0, 1.032146320259471, 1.0827890895121015, 1.0668340026773762, 1.2571796395325807, 1.3333333333333333, 1.0, 2.0, 1.1602229188436084, 1.5769230769230769, 1.0, 1.1538461538461537, 1.042384105960265, 1.088768115942029, 1.0811927630109448, 1.0275741310466715, 1.3072727272727274, 1.3076923076923077, 1.1428571428571428, 1.1290322580645162, 1.1216216216216217, 1.0714285714285714, 1.1088082901554404, 1.0271877511599792, 1.0325516678416384, 1.3333333333333333, 1.091039029427655, 1.0478854912166558, 2.5, 1.0695280868293016, 1.348747591522158, 3.0, 2.0, 1.2402366863905325, 1.1268737000645486, 1.104363952020202, 1.2173913043478262, 1.0, 1.0530612244897959, 1.3496932515337423, 3.0, 1.5, 1.0134663341645884, 1.2507057400188197, 1.012620267399725, 1.6666666666666667, 1.0211538136666949, 1.0426026336173508, 1.1416861826697893, 1.0, 1.0469483568075117, 1.023768475025379, 1.0657894736842106, 1.1794083749519786, 1.0234479548495956, 1.295731707317073, 1.14453125, 1.0695502290841055, 1.0655141037306641, 1.0867768595041323, 1.2545454545454546, 1.032014633386103, 1.0832008479067303, 1.0740401323462903, 1.0060240963855422, 1.2254901960784315, 1.2835820895522387, 1.060846560846561, 1.0504800247754722, 1.0047536429552817, 1.0538570607396054, 1.0600436681222707, 1.5, 1.6666666666666667, 1.06338298280381, 1.079155672823219, 1.1388834857031707, 1.0075539082730944, 1.0468305736745276, 1.0994983277591974, 1.2819767441860466, 1.0434782608695652, 1.1047873594843172, 1.1122331573216084, 1.2130092923516798, 1.0875656742556918, 2.5, 1.0869565217391304, 1.0753481399660736, 1.1984536082474226, 1.010195720003782, 1.1043320954261213, 1.0241477272727273, 2.0, 1.0753768844221105, 1.0311696877345402, 1.181631254283756, 1.1140684410646389, 1.0745243884994993, 1.035031847133758, 1.140176600441501, 1.0011607661056297, 1.0305052638454923, 1.0965148581530433, 1.0368663594470047, 1.0611413043478262, 1.0, 1.1985663082437277, 1.0623228814334034, 1.0, 1.0562349421665012, 1.1431297709923665, 1.0370650529500756, 1.2, 1.2661290322580645, 1.6666666666666667, 2.0, 1.1764705882352942, 1.0, 1.033175355450237, 1.0146571213262998, 1.0112398956417603, 1.0852103120759837, 1.053765690376569, 1.108695652173913, 1.0425531914893618, 1.0716204746171707, 1.6, 1.4166666666666667, 1.1288546255506609, 1.1428571428571428, 1.0026702269692924, 1.1409227683049148, 1.0109058134294728, 1.0918342503773677, 2.0, 1.1408668730650156, 1.2422480620155039, 1.1646819634040082, 1.0402671633164216, 1.1691919191919191, 1.1273972602739726, 1.124559290485054, 1.0961311630101438, 1.0112540192926045, 1.3148148148148149, 1.0502793296089385, 1.0, 1.0, 1.0416607059833338, 5.0, 1.4285714285714286, 2.16, 1.008515815085158, 1.119047619047619, 1.1175166297117516, 1.1090623774029031, 1.0, 1.0707635009310987, 1.0175233644859814, 1.2742857142857142, 1.3269230769230769, 1.4285714285714286, 1.0721649484536082, 1.079268292682927, 1.1704545454545454, 1.0234287839345482, 1.0197976721418471, 1.1497012157428395, 1.1289559301981662, 1.0, 1.1124931251850911, 1.0447665392063814, 1.0227761836441893, 1.1774193548387097, 1.0789692004562896]
origin-bjaq_15.71 	max: 5.0000	99th: 2.7525	95th: 1.7505	median: 1.0806	mean: 1.1759

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 13.977573 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[1.3709068e-06 4.1723251e-07 2.9802322e-07 1.7881393e-06 5.9604645e-08]
Distance score: 7.867812996664725e-07
SAUCE Drift detection: False
Detection latency: 0.0233s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.015119 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.6015	95th: 1.8333	median: 1.0804	mean: 1.1835
ReportEsts: [1.048913043478261, 1.0274450010890874, 1.0420566104906201, 1.0488215488215489, 1.5, 1.0, 1.0180788499237639, 1.0298174901151664, 1.1666666666666667, 1.0276243093922652, 1.1193052804483308, 1.0427721685936626, 1.0088715400993613, 1.0737240075614367, 1.0390831619159564, 1.0333333333333334, 1.157556270096463, 2.0, 1.1818181818181819, 1.0943722943722944, 1.0878174292426446, 1.0138545987432006, 1.0678119349005426, 1.0241465445462115, 1.0245608414757863, 1.0233002696870084, 3.0, 1.147285897397681, 1.4, 1.6, 1.056763925729443, 2.0, 1.0474732683930792, 1.0079514810979298, 1.0027586206896553, 1.0772486772486773, 1.2185423623782146, 1.1084070796460177, 3.0, 1.0975207746720692, 1.039838443179732, 1.0236574166500298, 1.203804347826087, 1.0287238583013232, 1.022099447513812, 1.078410605077044, 1.380952380952381, 1.1116279069767443, 1.4035087719298245, 1.014179608372721, 1.2820512820512822, 1.2241379310344827, 1.111587982832618, 1.0, 1.0447167112382612, 1.0259782697492035, 1.1049220799259374, 1.1464646464646464, 1.0638297872340425, 1.0396390866128937, 1.3880597014925373, 1.1528868360277136, 1.115625, 1.1583011583011582, 1.1287128712871286, 1.0666666666666667, 1.059969465648855, 1.3416506717850287, 2.25, 1.0, 1.1255073368716828, 1.0313765182186234, 1.071949440933398, 1.065217391304348, 1.0628985397879485, 1.1610576923076923, 1.0562143568389608, 1.1218274111675126, 1.4951456310679612, 1.093422254704915, 1.1106991525423728, 1.1612903225806452, 2.0, 1.0, 1.1231300345224395, 1.1333333333333333, 4.0, 1.56, 1.0, 1.125309097915797, 1.109295352323838, 1.336326578838542, 1.0945849114546014, 1.0681394481730053, 1.0255754475703325, 1.0422535211267605, 1.1647058823529413, 1.1223021582733812, 1.2222222222222223, 1.3417821782178219, 1.2692307692307692, 4.0, 1.0448315614192392, 1.2233676975945018, 1.026580459770115, 1.2078669651423088, 1.2727272727272727, 1.0174767042732178, 1.1050669006361045, 1.0899472877490748, 1.122958693563881, 1.048637636872931, 1.2857142857142858, 1.2, 1.050456045022317, 1.083626216502929, 1.0611814345991561, 1.0396039603960396, 1.056048878133934, 2.0, 1.115283613445378, 1.132969034608379, 1.5, 1.0235849056603774, 1.25, 1.254201680672269, 1.0304894056984746, 1.0776034605203693, 1.0573770491803278, 1.8333333333333333, 1.1741225051617343, 1.0, 2.2857142857142856, 1.1306389246915853, 1.4166666666666667, 1.52, 1.0125531797336869, 1.100463179059998, 2.142857142857143, 1.5, 1.0365591397849463, 1.0355713650511338, 1.0627212948912494, 1.0402732298158515, 1.2792207792207793, 1.0120614035087718, 1.1290629523529947, 3.0, 1.007885843034172, 1.023719165085389, 1.0740112994350282, 1.1264468864468864, 2.0, 1.1750933494802704, 1.0276729559748428, 1.0311418685121108, 1.0451127819548873, 1.0, 1.012072434607646, 1.1164757092109872, 1.1566380133715377, 1.038655462184874, 1.005249343832021, 1.2295081967213115, 1.2644628099173554, 1.0254237288135593, 1.625, 1.1271333355774733, 1.0681818181818181, 1.1697312588401698, 1.0106357764266485, 1.035763888888889, 1.037539969270379, 1.3089005235602094, 1.103515625, 1.053610414813617, 1.05078125, 1.0763834762275917, 1.059157212317666, 1.026656314699793, 1.086304347826087, 1.194614660937222, 1.0426829268292683, 1.1002638522427441, 1.0183785981986477, 1.0840005308090415, 1.358974358974359, 1.0721861678795173, 1.0263157894736843, 2.6, 1.2253521126760563, 1.0823785206482712, 1.2083333333333333, 1.129, 1.0279427645788337, 1.0274471313466171, 1.1039377171535194, 1.1065737051792828, 1.116837150037164, 1.0962117073762887, 1.02301685162351, 1.1447165850244927, 1.005671077504726, 1.0435999922010568, 1.0691114245416078, 1.069289540704312, 1.0047619047619047, 1.0, 1.216867469879518, 1.0, 1.3680555555555556, 1.113768923258405, 1.3617021276595744, 1.3055555555555556, 1.03752107925801, 1.3181818181818181, 1.0481531486000606, 1.0, 1.2319727891156462, 1.375, 1.107671601615074, 1.0021551724137931, 1.0451121516592219, 1.0211650542305701, 1.0769230769230769, 1.013832826885573, 1.1253927778234762, 1.1032934131736527, 1.0211081794195251, 1.0899830220713074, 1.024526198439242, 1.1136611649161097, 1.4273504273504274, 1.0049176147462937, 1.0764779753285225, 1.1072555205047319, 1.1794616151545363, 1.0883720930232559, 1.4375, 1.1061889250814332, 2.0, 1.2093409198672356, 1.0878721520756651, 1.2475151042681738, 1.1310344827586207, 1.1428571428571428, 1.5, 1.0263675025663588, 1.1967213114754098, 1.0793591332161485, 1.4, 1.04488416988417, 1.0541666666666667, 1.375, 1.0272685753882012, 1.0232558139534884, 1.0574912891986064, 1.1574074074074074, 1.0094637223974763, 1.1187184409634279, 1.0303030303030303, 2.0, 1.0903449221696495, 1.0704044117647058, 1.1240657698056802, 1.0087465588737499, 1.134127667719399, 1.0120947699784613, 1.0848684210526316, 1.0969727236673963, 1.035228988424761, 1.080453972257251, 1.085407677840469, 1.0769230769230769, 1.015990810112942, 1.1589958158995817, 1.1923076923076923, 1.4761904761904763, 1.2220393559928444, 1.0661290322580645, 1.00551814521344, 1.0078125, 1.0846153846153845, 1.423913043478261, 1.029836592499426, 1.06524926686217, 1.1041893980723767, 1.070325470515616, 1.0, 1.0, 1.0796632124352332, 1.0544309122436206, 1.1247645283477485, 1.0792896216965868, 1.2218649517684887, 1.1753897550111359, 1.049421511212684, 1.0525905594524076, 1.122349368186995, 1.0690461521227737, 1.033550792171482, 1.0069444444444444, 1.3636363636363635, 1.0797674071865215, 2.1666666666666665, 1.0017667844522968, 1.006867030814871, 1.1486386338005479, 1.4722222222222223, 1.1735537190082646, 1.0476190476190477, 1.1380629455746827, 1.0178313782071389, 1.1818181818181819, 1.1733255678509027, 1.0361016586881808, 1.2897862232779098, 2.5, 2.1, 1.022412656558998, 1.4285714285714286, 1.0085112674652945, 1.0203761755485894, 1.1578947368421053, 1.0290410521392968, 1.12, 1.1538461538461537, 1.0061560905477405, 2.0, 1.2857142857142858, 1.0217917675544794, 1.0150517403574788, 1.119300651354131, 1.128787878787879, 1.14, 1.1102458183788175, 1.075300471008608, 1.0502939255388635, 1.066464749671581, 1.0700963438735178, 1.5, 1.1, 1.032318648527547, 1.0, 1.0698649278062413, 1.35, 1.6666666666666667, 1.3888888888888888, 1.319831223628692, 1.055686274509804, 1.0397350993377483, 1.4057971014492754, 1.2592592592592593, 1.8333333333333333, 1.0297771282426014, 1.1, 1.1587301587301588, 1.005074794205293, 1.0826771653543308, 1.0233962264150944, 1.024551463644948, 1.75, 1.25, 1.3308457711442787, 1.103225806451613, 1.0276923076923077, 1.1291767096743703, 1.26781051846326, 1.0098039215686274, 1.5, 1.0229479746905474, 1.0256410256410255, 1.6956521739130435, 2.0, 1.1050734312416555, 1.0, 1.076271186440678, 1.3402061855670102, 1.1552473506861356, 1.0616508102761049, 1.05, 1.0983535056155271, 1.115405332615136, 1.2134831460674158, 1.0497076023391814, 1.1132590402547191, 1.1245791245791246, 1.1515151515151516, 1.0060361313712742, 1.0679991640225714, 1.0504273504273505, 1.029126213592233, 1.0930232558139534, 1.080708661417323, 2.0, 1.0833333333333333, 1.7088607594936709, 1.1138059701492538, 1.2971698113207548, 1.2922077922077921, 1.054535637149028, 1.018181818181818, 1.014894844878847, 1.058278656889232, 1.282437745740498, 1.010204081632653, 1.2685185185185186, 1.1085271317829457, 2.0, 1.0793890676855566, 1.4339622641509433, 1.107055731008529, 1.0988749309773607, 1.0337709520270828, 1.1538461538461537, 2.125, 1.080140907089388, 1.1428571428571428, 1.1070530023482053, 1.0, 1.0798600990964733, 1.0207823960880196, 1.1110317105850827, 1.1258278145695364, 1.0672436750998668, 4.0, 1.1646032639279684, 1.0032220366009161, 1.1163117292857005, 3.0, 1.025974025974026, 1.2980922098569156, 1.284829721362229, 1.1369437980396304, 1.0332075834394598, 1.0769230769230769, 1.0932568149210904, 1.0172523075704156, 1.0679724458461284, 1.010734999118706, 1.06456974649174, 1.2330004755111745, 1.3181818181818181, 1.027126436781609, 1.077512546454437, 1.1818181818181819, 1.0565832426550599, 1.0, 1.0, 1.1086675291073738, 1.0632411067193677, 1.0249739854318418, 1.0945095283844046, 1.058346017250127, 1.0, 1.218487394957983, 1.1379310344827587, 1.0395684784942654, 1.0833333333333333, 2.0, 1.0251854744240532, 1.0, 1.0, 1.0149654643131236, 2.3333333333333335, 1.0197666882696046, 1.0485584218512898, 1.0216216216216216, 1.0909090909090908, 1.0803396327331074, 1.0823327615780447, 1.35, 1.0151738408000752, 1.0451127819548873, 1.1159263271939328, 1.0399728997289972, 1.364171864171864, 1.071205208386733, 1.0, 1.1204819277108433, 1.0849282296650717, 1.1214717741935485, 1.0526315789473684, 1.25, 1.073532135580663, 1.006976515134934, 1.0344675209898364, 2.0, 1.0309924167490934, 1.0519313083389201, 1.0543882848467039, 1.0128205128205128, 1.0116707841857941, 1.1162906999589206, 1.0028348688873139, 1.1503116651825467, 2.0, 1.051197322118273, 1.0402202537706489, 1.0488456865127582, 1.0557724484104851, 1.0583554376657824, 1.0071249934416482, 2.586206896551724, 1.1126771791642087, 1.100808003078107, 1.0581974996043677, 1.0057142857142858, 1.1177425801938643, 1.0216832880024176, 1.0114942528735633, 1.3380281690140845, 1.0632222503801319, 1.1062906724511932, 1.0002888655462185, 1.0652706227340052, 1.0, 1.1602734523357388, 1.1775956284153006, 1.0, 1.0185185185185186, 1.027163166272838, 1.092526690391459, 1.0688717716357046, 1.0, 1.169811320754717, 1.0186721991701244, 1.1405986473364111, 1.0425373134328357, 1.0041598726359984, 1.1217526172935246, 1.05, 1.030287474332649, 1.0103636148288524, 1.622754491017964, 1.0155613965713755, 1.004847950639048, 1.0913705583756346, 1.0735988159401268, 1.0956284153005464, 1.0012834004979594, 2.0, 1.1912491178546225, 1.0341296928327646, 1.0302423768569196, 1.0911062906724511, 1.0082342177493138, 1.1005385996409336, 1.5806451612903225, 1.126510115687388, 1.0, 1.4444444444444444, 1.1666666666666667, 1.0, 1.1061946902654867, 1.4090909090909092, 1.0065274151436032, 1.0860655737704918, 1.074889276607167, 1.074415131906421, 1.0584144645340752, 1.1596185935637664, 1.0367705621331478, 1.0697482164909524, 1.0075409857261068, 1.1343033016228317, 1.1620047950679302, 1.0602876141187785, 1.013738959764475, 1.0888157894736843, 1.1340852130325814, 1.2038216560509554, 1.040019364208488, 1.1278801843317972, 1.103335564919466, 1.2824858757062148, 1.1028420038535645, 1.1470137825421134, 2.0, 1.0059171597633136, 1.5333333333333334, 1.75, 1.4285714285714286, 1.0287383753156372, 1.0419501133786848, 1.0392670157068062, 1.1104972375690607, 1.110602377093463, 1.0138484607920968, 1.0748175182481752, 1.0, 2.0, 1.1490431795878313, 1.0136986301369864, 1.042989152269988, 1.1272984441301273, 1.0, 1.1264367816091954, 1.1586956521739131, 1.0442046246333836, 1.099554234769688, 1.011216106328688, 1.0468060373794432, 1.0082054847875697, 1.3617021276595744, 3.6666666666666665, 1.1730429664508535, 1.0, 1.034319526627219, 1.2112068965517242, 1.344632768361582, 1.2045916294189354, 1.7272727272727273, 1.0131080963055692, 1.0890410958904109, 1.0201207243460764, 1.0811433840479483, 1.2822527832351016, 1.0748730964467006, 1.0472456381101745, 1.0207207207207207, 1.0572916666666667, 1.125, 1.0475607891114849, 1.019961259397879, 1.0, 1.014945652173913, 1.2458767580694121, 1.052801724137931, 1.0126002601344029, 1.3333333333333333, 1.0707803992740472, 1.087952987267385, 1.0068337129840548, 1.1437125748502994, 1.0694075920416677, 1.0, 1.4, 1.0250814332247558, 1.0033738191632928, 1.1286654188645, 1.1410748560460653, 1.024562127310495, 1.0994613156866935, 1.0896656534954408, 1.1157930798218567, 1.144808743169399, 1.074776646685701, 1.1095162147793727, 1.049689440993789, 1.06948109058927, 1.1270759470050382, 1.0, 1.0620497707924035, 1.25, 1.3333333333333333, 1.0422360248447204, 1.5719567690557452, 1.0522249690976515, 1.1642512077294687, 1.0714285714285714, 1.020967741935484, 1.0332142857142856, 1.0440251572327044, 1.0608199501520843, 2.3333333333333335, 1.0833222697219935, 1.5, 1.0234375, 1.0714285714285714, 1.0777100883201678, 1.4193548387096775, 1.1626297577854672, 1.0199652777777777, 1.0, 1.078762399001511, 1.2800555941626128, 1.5, 1.6666666666666667, 1.1631205673758864, 1.23768115942029, 1.0019607843137255, 1.1709577754891864, 1.1061692969870875, 1.4074074074074074, 1.0075757575757576, 1.1932852807283763, 1.1604938271604939, 1.2688524590163934, 1.096774193548387, 1.0, 1.2091370558375634, 1.131188118811881, 1.0253718285214348, 1.0169404076016855, 1.0622322691192105, 1.0927548219724028, 1.071355261530852, 1.1507738542449286, 1.1821386603995299, 1.0084745762711864, 1.875, 1.5, 1.1875, 1.002391145783782, 1.1129151291512915, 1.0654450261780104, 1.0585683297180044, 1.0368698747695633, 1.0268420992309544, 1.0019163621186362, 1.0813953488372092, 1.2380952380952381, 1.175886524822695, 1.0108404112650873, 1.053803364385765, 1.0523795166751704, 1.0946745562130178, 1.0328995826172354, 1.0561425733452336, 1.1599590326109728, 1.0789085545722714, 1.1060743711036622, 1.0679012345679013, 1.1038205980066444, 1.0494071146245059, 1.0296612217282042, 1.1830985915492958, 1.0426754205990973, 1.0, 1.0225988700564972, 1.0091055676752347, 1.0, 1.0694322621800494, 1.0293577981651376, 1.1777777777777778, 1.006698447871032, 1.0523112896456621, 1.0734869104071383, 1.0673616680032076, 1.0037664783427496, 1.1970545997240447, 1.1870503597122302, 1.1111111111111112, 1.0, 1.3333333333333333, 1.0687981556755446, 1.6666666666666667, 1.1782963936889557, 1.1098685986859869, 1.028030303030303, 1.0615359097694477, 1.114341330232323, 1.0262782825583467, 1.033132530120482, 1.0459492140266022, 1.0198355765960525, 1.1656088272629626, 1.0441122477929274, 1.2601369141653502, 1.8571428571428572, 1.047863247863248, 1.0830564784053156, 1.0548798104703572, 1.0027397260273974, 1.289216799091941, 1.034108527131783, 2.145390070921986, 1.000274294909696, 1.0645526613816534, 1.0863729732963723, 1.1578947368421053, 1.0566926814902076, 1.0264596893216253, 1.2516528925619834, 1.07871198568873, 1.2962962962962963, 1.110053539559786, 1.060611120387377, 1.05668016194332, 1.0843098958333333, 1.0180457056657002, 1.1428571428571428, 1.0294659300184161, 1.0642317380352644, 1.0266497461928934, 1.1300448430493273, 1.0617283950617284, 1.0809716599190284, 1.0848146267140681, 1.0027187258133587, 1.0682036503362151, 1.0824987453906745, 1.082441578718672, 1.1428571428571428, 1.0520471894517696, 1.0386041807147675, 1.037371726144892, 1.2777777777777777, 1.0894435777431097, 1.0030800821355237, 1.0293159609120521, 1.0240202275600505, 1.03878011478066, 1.1818181818181819, 1.1018033740546829, 1.2340305711987127, 1.0559060256689146, 1.0241157556270097, 1.094163835228296, 1.1173642140416518, 1.060120240480962, 1.1127049180327868, 1.1079696581617575, 1.0901410761154855, 1.0801186943620178, 1.0321100917431192, 1.018485390578414, 1.1110336698611183, 1.0380952380952382, 2.75, 1.0357436612666737, 1.163924952288794, 1.0009573958831977, 1.0095693779904307, 1.2006678809957498, 1.0012164322621007, 1.1564258911819887, 1.2156368221941993, 1.0256410256410255, 1.0663236134934249, 1.3529411764705883, 1.1702127659574468, 1.3823529411764706, 1.0556161395856052, 1.1904761904761905, 1.0514657980456026, 1.2619047619047619, 1.1074626865671642, 1.0964172813487882, 1.1145833333333333, 1.0, 1.0270104358502148, 1.004, 1.0889679715302492, 1.1538461538461537, 1.010829039420217, 1.0592592592592593, 1.014373232799246, 1.2608695652173914, 1.0714285714285714, 1.2804063860667634, 1.0240385321370358, 1.0255869056048805, 1.1985185185185185, 1.3934426229508197, 1.2352941176470589, 1.1666666666666667, 1.0212765957446808, 1.1, 1.0470588235294118, 1.0243311399188306, 1.029618200707448, 1.3706896551724137, 1.055820771235791, 1.046979977729864, 2.5, 1.0967714645262947, 1.5322843190450353, 1.5, 2.25, 1.1662965704416481, 1.0928252456088121, 1.0976334581555343, 1.1614583333333333, 1.5, 1.0827338129496402, 1.251889168765743, 1.0263157894736843, 1.028500263003187, 1.1064222457889734, 1.0570455338271807, 1.0445317616240994, 1.8571428571428572, 1.0299595486480733, 1.0318471337579618, 1.009490940465919, 1.019806763285024, 1.022300469483568, 1.0, 2.0, 1.1907657536458054, 1.0225730351602895, 1.1082251082251082, 1.055921052631579, 1.0835145715528491, 1.0782080485952923, 1.0491803278688525, 1.1971830985915493, 1.057249035013277, 1.5094980694980695, 1.0724339508798306, 1.3571428571428572, 1.12, 1.1288180610889775, 1.25, 1.069660861594867, 1.0024570024570025, 1.0150686958881132, 1.0381125226860255, 1.5, 1.0764150943396227, 1.0181870314996109, 1.1338958180484227, 1.1353946297803093, 1.0448255114320095, 1.031245640954108, 1.1405399560249432, 1.4593837535014005, 1.0545454545454545, 1.0416911716656865, 1.1065506977861266, 1.3091380427738173, 1.013215859030837, 1.6666666666666667, 1.0588235294117647, 1.031198133103715, 1.0395738203957383, 1.0141625128570297, 1.0765939117478833, 1.023063276167948, 2.0, 1.079702444208289, 1.0708688547183556, 1.1833429728166571, 1.099041533546326, 1.0781630563370481, 1.0102564102564102, 1.228021978021978, 1.0326469110999499, 1.0321392387836263, 1.1028897391957557, 1.0283479960899315, 1.0765714285714285, 1.0857142857142856, 1.117033972471955, 1.3472485768500948, 1.0090353629479345, 1.0797872340425532, 1.1189860320744955, 1.011036174126303, 1.4444444444444444, 1.2505643340857788, 1.6666666666666667, 1.6666666666666667, 1.25, 1.0106382978723405, 1.0019329896907216, 1.0535831044854191, 1.002663946849446, 1.038496583143508, 1.0724691130370643, 1.2222222222222223, 1.040276179516686, 1.048230476747587, 1.8333333333333333, 1.9166666666666667, 1.1636876763875823, 1.0, 1.1226765799256506, 1.1578725200506543, 1.042551600358959, 1.0976663961038962, 2.5, 1.0135064935064935, 1.052820053715309, 1.0010282972159805, 1.0400532055177791, 1.1111111111111112, 1.1178642431127521, 1.1536474420171843, 1.130201478181634, 1.002677376171352, 1.0357142857142858, 1.05848623853211, 1.0, 1.0, 1.0416382633960999, 5.0, 1.7142857142857142, 1.641025641025641, 1.0060483870967742, 1.0771104542246233, 1.030577576443941, 1.023715415019763, 1.2857142857142858, 1.2138409961685823, 1.0274240940254653, 1.0925644916540211, 1.3064516129032258]
origin-bjaq_15.71 	max: 5.0000	99th: 2.6015	95th: 1.8333	median: 1.0804	mean: 1.1835

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.163405 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.183222