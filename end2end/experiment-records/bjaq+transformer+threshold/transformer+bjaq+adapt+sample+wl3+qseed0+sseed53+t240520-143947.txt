Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 53, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.5007	95th: 1.7503	median: 1.0780	mean: 1.1747
ReportEsts: [1.0361842105263157, 1.0065104166666667, 1.0587503435904113, 1.0483870967741935, 1.5789473684210527, 1.0, 1.0737736577829278, 1.0632937272074592, 1.0, 1.0090673575129534, 1.158196981502323, 1.043004788831471, 1.0285097192224621, 1.113953488372093, 1.0752384316495938, 1.0, 1.0843373493975903, 1.0095642933049946, 3.0, 2.0, 1.173913043478261, 1.154229103400209, 1.0754914742950634, 1.1479741632413387, 1.045387271830291, 1.0, 1.1251580722214416, 1.2, 1.4, 1.037313432835821, 1.0, 1.0462290441013846, 1.0104848432655873, 1.1059933407325193, 1.0082926106915444, 1.2334864300626305, 1.1524064171122994, 1.0055228924134698, 1.0867828362834906, 1.0120481927710843, 1.0924369747899159, 1.0314465408805031, 1.0, 1.0348793635236806, 1.1706392199349946, 1.890625, 1.0198019801980198, 1.2226148409893993, 1.0245090465541777, 1.0185185185185186, 1.10132123527539, 1.2439862542955327, 1.0374425743186173, 2.0, 1.051948051948052, 1.1758990025396592, 1.1833046471600688, 1.3333333333333333, 1.1180555555555556, 1.0, 1.0916030534351144, 1.094022415940224, 1.1318181818181818, 1.0357142857142858, 1.0909090909090908, 1.0645173176123803, 1.2623103127903377, 1.75, 1.0, 1.014729188030204, 1.0145278450363195, 1.0646100116414436, 1.0422535211267605, 1.0582414603289354, 1.0588235294117647, 1.1020408163265305, 1.0, 1.1077244258872652, 2.0, 1.0120520415868037, 1.0666666666666667, 1.0243738173887944, 1.2208588957055215, 1.1122448979591837, 1.1285574092247301, 1.04, 1.0692097671543375, 1.0398463987556354, 1.0196078431372548, 1.75, 1.233644859813084, 1.0586609101764004, 1.071651090342679, 1.0126227208976157, 1.006392694063927, 1.0545454545454545, 1.0465116279069768, 1.14453125, 1.0, 1.2041474159234984, 1.0565874730021598, 1.0728987993138936, 1.242938596491228, 1.2592592592592593, 1.01268881605616, 1.084417308202814, 1.198966535433071, 1.1649601820250284, 1.0453709380748006, 1.3333333333333333, 2.0, 1.035981308411215, 1.0635469318984727, 1.0574857864813645, 1.1428571428571428, 1.0578787022205471, 1.0, 1.0577105014191106, 1.1956521739130435, 1.0, 1.0340909090909092, 1.0, 1.1729323308270676, 1.0166603586044916, 1.0808418109808184, 1.0980392156862746, 1.8, 1.1903973509933774, 1.0, 1.0769230769230769, 1.1107441903262414, 1.3, 1.0460611979166667, 1.0405961300533202, 1.1608328029820894, 1.0173564753004005, 1.0458452722063036, 1.0713172252533125, 1.039972432804962, 1.068860450944546, 1.0181842270875427, 1.1911764705882353, 1.0091324200913243, 1.137919704031836, 2.0, 1.0186873290793073, 1.0022857142857142, 1.108665749656121, 1.1109934709722957, 1.5, 1.2725841608137562, 1.0731319554848966, 1.0309278350515463, 1.1074561403508771, 1.1912408759124087, 1.0868172623061363, 1.077669625781406, 1.080904571595672, 1.0333988212180747, 1.055921052631579, 1.2653061224489797, 1.4375, 1.0206185567010309, 1.4285714285714286, 1.0474720945502298, 1.01644694202777, 1.1264591439688716, 1.3203544828886584, 1.139178844815588, 1.1916726299329463, 1.2673684210526315, 1.146987951807229, 1.0786288370291468, 1.0667340748230536, 1.0078260869565216, 1.0524781341107872, 1.045267489711934, 1.115567464776558, 1.0133836596681607, 1.0, 1.0, 1.008467400508044, 1.0285087719298245, 1.1397849462365592, 1.0921052631578947, 1.0830975391663298, 1.2548529694407073, 1.0975044910503646, 1.1153846153846154, 1.174090909090909, 1.1294667720084446, 1.0, 1.2727272727272727, 1.0257858843468786, 1.0376914016489989, 1.013078000934143, 1.4, 1.0488745980707395, 1.0566343125215165, 1.0420742360118465, 1.0626410835214446, 1.0869611046695478, 1.112994350282486, 1.0158730158730158, 1.1666666666666667, 1.0, 1.4414414414414414, 1.18080744362088, 1.240418118466899, 1.1149425287356323, 1.0128521997034108, 1.0031277926720286, 1.0442055171920284, 1.0502441460437244, 1.1433132843246454, 1.1, 1.1213872832369942, 1.01246719160105, 1.034522373484979, 1.0056506888567958, 1.0, 1.0712215320910974, 1.1113387036416993, 1.0140150025850512, 1.139209726443769, 1.0038979725310662, 1.2781922369985945, 1.0740740740740742, 1.0036767180453658, 1.2470345538937597, 1.006204173716864, 1.170731707317073, 1.0338837658159983, 1.0062281043207473, 1.2551181102362206, 2.0, 1.2263112141408288, 1.1112103617686466, 1.1007969995311768, 1.3535353535353536, 1.0909090909090908, 1.6666666666666667, 1.077100297216018, 1.1272727272727272, 1.0738916256157636, 1.5, 1.0, 1.0, 1.0722092115534738, 1.0408163265306123, 1.0331491712707181, 1.139240506329114, 1.0778546712802768, 1.008894536213469, 1.0592710168211998, 1.0526315789473684, 2.0, 1.0698599716242059, 1.004618460053767, 1.1225919439579686, 1.0180613332775885, 1.1780157970320728, 1.0351079722939018, 1.0937996820349762, 1.0744150837103674, 1.020334928229665, 1.0148095909732018, 1.029066093769746, 1.1818181818181819, 1.047460868689919, 1.1495098039215685, 1.2272727272727273, 1.4705882352941178, 1.0597302504816957, 1.0555555555555556, 1.0769230769230769, 1.1035596527824507, 1.0227920227920229, 1.3709273182957393, 1.0118877205384231, 1.077757685352622, 1.0107462626775185, 1.0599042836174268, 1.25, 1.043506729719898, 2.5, 1.0190412363005599, 1.0496760259179265, 1.059669564425834, 1.0526315789473684, 2.0, 1.3478260869565217, 1.109375, 1.0780926551895815, 1.0, 1.0688073394495412, 1.004524886877828, 1.0052083333333333, 1.015354188931741, 1.1524390243902438, 1.1132075471698113, 1.0181628814512726, 1.1874622052005643, 1.0966581878782562, 1.1367521367521367, 1.0, 1.1229116945107398, 1.2727272727272727, 1.1505376344086022, 1.0291069924178602, 1.0433694745621351, 1.056547619047619, 1.4390243902439024, 1.0027510316368637, 1.0369181380417336, 1.2857142857142858, 1.0087023607467984, 1.030188679245283, 1.0526315789473684, 1.0953781742556918, 1.2380952380952381, 1.4, 1.0096240410828632, 2.0, 1.1742112482853224, 1.0436046511627908, 1.085315832649713, 1.0894107952204368, 1.0435967302452316, 1.1375, 1.1066031737442334, 1.119122384232776, 1.0013642564802183, 1.0406959875753077, 1.020228547093477, 2.0, 1.0, 1.0598962499143034, 1.25, 1.070949720670391, 1.3529411764705883, 1.0, 1.4666666666666666, 1.3283132530120483, 1.0679245283018868, 1.2169811320754718, 1.0010834236186348, 1.0, 1.133155792276964, 1.0697036983349915, 2.0, 1.2281119714115545, 1.0, 1.088453655203826, 1.1125, 1.0001049703458773, 1.1612903225806452, 1.1363636363636365, 1.2203742203742203, 1.3703703703703705, 1.017030078811379, 1.0187008066248706, 1.0532959326788218, 1.0, 1.0769230769230769, 1.5714285714285714, 1.5, 1.2307692307692308, 1.0699805094981882, 1.3333333333333333, 1.0698835274542429, 1.2625, 1.1985604519087678, 1.0911785991437566, 1.259526261585994, 1.0179710008029095, 1.00754060324826, 1.0392857142857144, 1.5, 1.3675213675213675, 1.1106382978723404, 1.0372002529697766, 1.1904761904761905, 1.5714285714285714, 1.0665083135391924, 1.0380205190102596, 1.031742524672264, 1.0124069478908189, 1.1464387464387464, 1.0158686730506157, 1.0810810810810811, 1.0907770515613653, 1.0286016949152543, 1.2884615384615385, 1.0240793201133145, 1.1081081081081081, 1.0619693861448636, 1.063405167419766, 1.0265883179291264, 1.2112676056338028, 1.121212121212121, 1.0783132530120483, 1.0, 1.0151437895166224, 1.0510437587159371, 1.0503942974873897, 1.0525530878281226, 1.042464114832536, 1.148395297108357, 1.5714285714285714, 1.0024177949709865, 1.2, 1.219470538001708, 1.25, 1.021555982284579, 1.0246376811594202, 1.09103611349957, 1.0790513833992095, 1.2336633663366336, 3.0, 1.1410427807486632, 1.0152781754865647, 1.090284164061063, 2.0, 1.1111111111111112, 1.2188099808061421, 1.2517985611510791, 1.1213186077643909, 1.0644490644490645, 1.2352941176470589, 1.2303710094909404, 1.0488466122887794, 1.025924791299686, 1.104697738629956, 1.1529605263157894, 1.2321724709784412, 1.095435684647303, 2.142857142857143, 1.0944444444444446, 1.5, 1.234006734006734, 1.0303030303030303, 1.1652403383727525, 1.9230769230769231, 1.0522043795620437, 1.1294230868377184, 1.0734114743985195, 1.0, 1.1875, 1.16, 1.2857214328597157, 1.1991247264770242, 1.0, 1.0168554849405913, 1.1114273404963642, 1.0663075010360548, 1.5, 2.0, 1.0141788105553367, 1.0108695652173914, 1.0327868852459017, 1.1111111111111112, 1.074696702498161, 1.0433497536945813, 1.4705882352941178, 1.0027118644067796, 1.0545454545454545, 1.1338582677165354, 1.081451612903226, 1.307109802271771, 1.0388193202146692, 1.0, 1.0422535211267605, 1.0693182216919892, 1.0563698364404877, 1.0458656121357492, 2.0, 1.1077195310771952, 1.0081821077135737, 1.0220010476689365, 2.0, 1.0466507177033493, 1.0607770675189772, 1.0164891070146038, 1.0417194530601546, 1.013596657470008, 1.0157782515991471, 1.0336134453781514, 1.1557377049180328, 2.0, 1.0743707685151687, 1.8974358974358974, 1.25, 1.160621761658031, 1.1346153846153846, 1.010302403894242, 1.1093308199811498, 1.0573714089110615, 1.0380908673703533, 1.0354353165780008, 1.0787231164615176, 1.0574106822936533, 1.0957446808510638, 4.0, 1.0077952618743469, 1.147570850202429, 1.0473120447913453, 1.0596963389954057, 1.0974124809741248, 1.1352727272727272, 2.13265306122449, 2.5714285714285716, 1.0088255344013244, 1.0339153008813076, 1.008465491109386, 1.1458098459225854, 1.0632954107211723, 1.0543478260869565, 1.0824176112924162, 1.0983412322274881, 1.2076923076923076, 3.0, 1.0, 1.0415335463258786, 1.064030131826742, 1.089579524680073, 1.0950520833333333, 1.072549019607843, 1.4420289855072463, 1.148905109489051, 1.0833333333333333, 1.0502703176597796, 1.2696629213483146, 1.007914632831868, 2.0, 1.0366379310344827, 1.0677966101694916, 1.5326086956521738, 1.0642458100558658, 1.0398179749715586, 1.0201612903225807, 1.0233463035019454, 1.0739432578897035, 1.0, 1.2127659574468086, 1.5, 1.5, 1.125, 1.028225806451613, 1.0046511627906978, 1.0194174757281553, 1.0640820249919898, 1.051044083526682, 1.069914050616673, 1.1844671532846716, 1.036237471087124, 1.070300502220562, 1.0594594594594595, 1.084028223220013, 1.0212868892114175, 1.0567914158597227, 1.1184971098265897, 1.1381639545594104, 1.0696295545532863, 1.158703618058273, 1.0740613971933386, 2.0, 1.253071253071253, 1.0628683693516698, 1.4205607476635513, 1.0, 1.2439024390243902, 1.1538461538461537, 1.1322645290581161, 1.3703703703703705, 1.1666666666666667, 1.0033430806286603, 1.1284694368682817, 1.0222069893168473, 1.047848782031003, 1.2378378378378379, 1.1182065217391304, 1.0, 1.193798449612403, 1.0223522775349034, 1.0602571254017585, 1.0840981912593455, 1.0592322587994076, 1.0220378627293327, 1.1662337662337663, 1.0721272857941389, 1.0781527531083481, 1.041897437047335, 1.2114874150492292, 1.303030303030303, 1.0392967942088935, 1.0, 1.2422535211267605, 1.2078668994556845, 3.0, 1.1193518941122775, 1.0659771015227257, 1.4285714285714286, 1.031012070566388, 1.3, 1.1176470588235294, 1.044625946969697, 1.6153846153846154, 1.0217722345092637, 1.038017941050833, 1.3103448275862069, 1.16, 1.1134020618556701, 1.0143472022955524, 1.0013262599469497, 1.0903238520659528, 1.1571651042779931, 1.0, 1.0362263741038453, 1.125, 2.0, 1.0345510510868787, 1.0614326498832078, 1.1333964049195837, 1.0181158266738832, 1.0237462387161484, 1.0272727272727273, 2.0, 1.0350393700787401, 1.0491935483870967, 1.0878285510664654, 1.1896825396825397, 1.0058842626410194, 1.0433692305548976, 1.2857142857142858, 1.1167428334025757, 1.1839464882943145, 1.0623027552214461, 1.0359621451104102, 1.0534351145038168, 1.05019305019305, 1.066697211676921, 3.0, 1.1329452298918854, 1.0200872034070168, 1.0282050728081926, 1.4615384615384615, 1.2404527149007083, 1.433862433862434, 1.0, 1.090040205967412, 1.0420575865415722, 1.1604803493449782, 1.0303030303030303, 1.3333333333333333, 1.088014452242179, 1.5, 1.0560747663551402, 1.0, 1.0277021840764775, 1.44, 1.1856540084388185, 1.0471698113207548, 1.0, 1.6917989417989419, 1.3147033533963886, 1.25, 2.0, 1.1083333333333334, 1.1551724137931034, 1.0328523180841265, 1.2140127388535031, 1.1327433628318584, 1.2743362831858407, 1.1014466214978942, 1.0571428571428572, 1.1290322580645162, 1.236734693877551, 1.0769230769230769, 1.0, 1.2063106796116505, 1.0880230880230881, 1.0692148760330578, 1.0685265138935016, 1.0728624023241835, 1.088649768132907, 1.059000088933685, 1.1004193175245807, 1.1493775933609958, 1.0320197044334976, 1.5714285714285714, 1.0, 1.2142857142857142, 1.019116642634894, 1.0759046778464254, 1.107843137254902, 1.0246305418719213, 1.0063382970599466, 1.056313149155656, 1.0076489001250242, 1.0985915492957747, 1.2222222222222223, 1.048099301784329, 1.007344104686874, 1.0498778370732336, 1.0432702251761559, 1.013157894736842, 1.0880094506792675, 1.012382281130101, 1.1046676096181047, 1.3340122199592668, 1.0, 1.0394181135617082, 1.9602649006622517, 1.1555555555555554, 1.0922619047619047, 1.0701001430615165, 1.0, 1.0136986301369864, 1.0300173240938166, 1.0740740740740742, 1.0621084390100224, 1.0010593220338984, 1.1944444444444444, 1.061471983950411, 1.0466113914924298, 1.0306876175127586, 1.0543893129770991, 1.0351872871736663, 1.2056805055378135, 1.1594202898550725, 1.2857142857142858, 1.0, 1.4285714285714286, 1.074579144967906, 1.3333333333333333, 1.1709050702890538, 1.1029023746701847, 1.0494018608772706, 1.0782522343594836, 1.0532297935029589, 1.0838156484458736, 1.007168458781362, 1.0249653259361997, 1.0037664517102236, 1.1066976002999624, 1.0403648495668782, 1.2503914247862218, 1.4285714285714286, 1.0, 1.0316205533596838, 1.0886339214530834, 1.0, 1.288158609451385, 1.050185873605948, 2.211206896551724, 1.0485137215554414, 1.0416107382550335, 1.0263875598086125, 1.1875, 1.065228390558445, 1.0280239439436032, 1.3158713692946058, 1.0581052631578947, 1.03125, 1.160248447204969, 1.1229050279329609, 1.5625, 1.0762219478538746, 1.5384615384615385, 1.2525252525252526, 1.091127098321343, 1.0451786918408632, 1.0239097491160127, 1.0023584905660377, 1.8333333333333333, 1.061611374407583, 1.0953711533512263, 1.0712261792321796, 1.0000560332214745, 1.029019094160915, 1.057229566736125, 1.0769230769230769, 1.071912013536379, 1.0552842352021878, 1.0090094148385063, 1.0100200400801602, 1.0069444444444444, 1.0541825095057034, 1.0317178381121543, 1.374251497005988, 1.0750661189578528, 1.0, 1.3333333333333333, 1.0413063363741997, 1.0563317479191439, 1.2474128018397854, 1.0611250115837272, 1.0407023144453311, 1.1029411764705883, 1.0896787611753458, 1.0729497054825554, 1.1397058823529411, 1.010928961748634, 1.0562130177514792, 1.0824620821675748, 1.119047619047619, 1.75, 1.0448643159623197, 1.1593258426966293, 1.0502994011976048, 1.0795454545454546, 1.2041998551774076, 1.0061425663054353, 1.1549058195108237, 1.3157894736842106, 1.2307692307692308, 1.036388140161725, 1.1557177615571776, 1.1375, 1.5357142857142858, 1.0436585093306514, 1.1942517343904857, 1.165837479270315, 1.048780487804878, 1.0191259571337814, 1.0464848252016903, 1.0675033467202142, 1.2771836007130124, 1.3333333333333333, 1.1666666666666667, 2.0, 1.1340996168582376, 1.1153846153846154, 1.0, 1.1538461538461537, 1.0026490066225167, 1.078125, 1.0110525772130978, 1.0400324632304228, 1.0418181818181818, 1.2363636363636363, 1.1428571428571428, 1.1612903225806452, 1.1081081081081081, 1.0, 1.1588447653429603, 1.0259416599690672, 1.029427479499833, 1.3195876288659794, 1.0830922631870499, 1.0476302487362994, 2.5, 1.0676822836922868, 1.2797074954296161, 3.0, 2.0, 1.2884615384615385, 1.1468120203686438, 1.0610065833533404, 1.1304347826086956, 1.0, 1.0794979079497908, 1.107361963190184, 3.0, 2.0, 1.032258064516129, 1.224492539319801, 1.0334874422091715, 1.6666666666666667, 1.0325794328664162, 1.0449264136328427, 1.0174358974358975, 1.0, 1.056338028169014, 1.0227267258182617, 1.0921052631578947, 1.1929279191762192, 1.0031225150792265, 1.2354651162790697, 1.08984375, 1.0876893343521057, 1.0822550831792976, 1.0867768595041323, 1.1311475409836065, 1.020129108462592, 1.3921334922526818, 1.082777404492225, 1.091503267973856, 1.196078431372549, 1.2835820895522387, 1.1031636863823935, 1.058016219588272, 1.0201303329599838, 1.0921402567541674, 1.0993449781659388, 1.5, 1.6666666666666667, 1.0811545100044748, 1.1376429199648197, 1.0877261233223108, 1.0093886918422699, 1.0844622846629872, 1.123211616485159, 1.4225806451612903, 1.0, 1.072950239761025, 1.0707197304349614, 1.304381245196003, 1.1284584980237153, 1.6666666666666667, 1.0266666666666666, 1.0469734214165003, 1.1722689075630253, 1.0340516824208794, 1.0895400720782564, 1.0063920454545454, 2.0, 1.0767295597484277, 1.0340034436753822, 1.1647246972812428, 1.273764258555133, 1.0664485290611738, 1.1624203821656052, 1.099337748344371, 1.0075934579439252, 1.0333032127420987, 1.0583803350450374, 1.0610599078341014, 1.0441176470588236, 1.0, 1.1812676624949536, 1.053089861961788, 1.0661971830985915, 1.0606538097032394, 1.123827392120075, 1.0242057488653555, 1.2, 1.2661290322580645, 1.6666666666666667, 2.0, 1.2352941176470589, 1.0076726342710998, 1.0442338072669826, 1.0374065798597736, 1.00041075844836, 1.050755631593955, 1.019407123053956, 1.1358695652173914, 1.7551020408163265, 1.068386680415553, 1.6, 1.5, 1.1612537764350452, 1.1428571428571428, 1.0743919885550788, 1.1392088132198297, 1.098422712933754, 1.1037801691256433, 2.0, 1.2117647058823529, 1.189922480620155, 1.0391293081109096, 1.0396983403212932, 1.1818181818181819, 1.1253424657534246, 1.155194133261349, 1.083731778425656, 1.014516129032258, 1.4489795918367347, 1.089385474860335, 1.0, 1.0, 1.0416428239333357, 5.0, 1.5714285714285714, 2.076923076923077, 1.0298136645962732, 1.0561797752808988, 1.0764966740576496, 1.1271086700666928, 1.1666666666666667, 1.106765983860956, 1.0151869158878504, 1.1925133689839573, 1.28125, 1.4285714285714286, 1.068240850059032, 1.206208425720621, 1.154708520179372, 1.0855336556340647, 1.033289023673382, 1.0973547054774313, 1.1691807157645666, 1.0, 1.1924525108939374, 1.0632753788259466, 1.0338952654232425, 1.1774193548387097, 1.0838020833333333]
origin-bjaq_15.71 	max: 5.0000	99th: 2.5007	95th: 1.7503	median: 1.0780	mean: 1.1747

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 14.072428 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[9.5367432e-07 2.3841858e-07 2.9802322e-07 8.9406967e-07 1.7881393e-07]
Distance score: 5.125999678057269e-07
SAUCE Drift detection: False
Detection latency: 0.0234s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.035118 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 7.0000	99th: 3.0000	95th: 1.8017	median: 1.0805	mean: 1.1893
ReportEsts: [1.0108108108108107, 1.0065075921908895, 1.0429916803919084, 1.0545144804088586, 1.565217391304348, 1.0, 1.0047311827956988, 1.0798381355011806, 1.0, 1.0640883977900553, 1.146102492675664, 1.0425965318440458, 1.0045694200351494, 1.1228070175438596, 1.080082742316785, 1.325, 1.1973684210526316, 1.6666666666666667, 1.1818181818181819, 1.044314381270903, 1.0747240618101546, 1.0524848343443771, 1.1079136690647482, 1.0424646128226478, 1.0135042343785763, 1.029349294116289, 2.0, 1.1361337080313563, 1.8, 1.1666666666666667, 1.0057413879181227, 2.0, 1.0496357652627297, 1.003585566167071, 1.0526570048309178, 1.0480236424085703, 1.2340972222222222, 1.1191011235955055, 1.1958762886597938, 1.06275415896488, 1.0576070901033974, 1.013718765311122, 1.104368932038835, 1.1099498773594967, 1.0054945054945055, 1.0474840774950815, 1.0, 1.036734693877551, 1.2105263157894737, 1.0363511659807956, 1.0217391304347827, 1.1759656652360515, 1.0532786885245902, 1.0, 1.047883700308484, 1.0038947195801902, 1.033606204222318, 1.1820580474934037, 1.02020202020202, 1.0160451648215831, 1.4029850746268657, 1.1198660561744003, 1.0301204819277108, 1.1107011070110702, 1.0, 1.2666666666666666, 1.0017322516384213, 1.2953519256308101, 1.6, 2.0, 1.0123408879230054, 1.0232088799192736, 1.061441702951137, 1.0174081237911026, 1.162235911853475, 1.2115295211529522, 1.0478755352333715, 1.2228571428571429, 1.5922330097087378, 1.1110064905384405, 1.1203904555314534, 1.2666666666666666, 1.0, 1.5833333333333333, 1.070469798657718, 1.1967213114754098, 1.2066115702479339, 1.096774193548387, 2.0, 1.0880367312983938, 1.1147120892372626, 1.0878320069038259, 1.0511031009535496, 1.0883310088331009, 1.066326530612245, 1.055952380952381, 1.2380952380952381, 1.0358126721763086, 1.064587973273942, 1.3619122876333465, 1.037037037037037, 2.0, 1.0463556926020516, 1.1624149659863945, 1.0803506208911615, 1.1985652696303626, 1.4375, 1.0142584381195834, 1.0851721094439541, 1.109106724150972, 1.0592476489028213, 1.0567977383705989, 1.5, 1.0, 1.0544784800310198, 1.0620413850510753, 1.0294117647058822, 1.0638297872340425, 1.0574403779771726, 2.0, 1.093084407047068, 1.153211009174312, 1.0, 1.0044247787610618, 1.0, 1.2955032119914347, 1.0232497133576794, 1.0230784148943048, 1.0661157024793388, 2.0, 1.1560574948665299, 1.0, 2.0, 1.1167722390526025, 1.2307692307692308, 1.1482649842271293, 1.031119574885397, 1.0528712803479094, 3.0, 1.3571428571428572, 1.0491452991452992, 1.0371032632990613, 1.0861096873398257, 1.0277698552378038, 1.282758620689655, 1.013721185510428, 1.0997477944676843, 1.5, 1.0159030670200682, 1.0106796116504855, 1.1120045950603101, 1.1275872264931992, 1.5, 1.133590107439692, 1.0529715762273901, 1.0305602716468591, 1.1113561190738699, 2.0, 1.020123839009288, 1.0647433907291095, 1.060823182867606, 1.0814940577249577, 1.0634920634920635, 1.2758620689655173, 1.3571428571428572, 1.01468788249694, 1.2222222222222223, 1.0806843498756902, 2.0, 1.0592417061611374, 1.0172150778156295, 1.0891566265060242, 1.069654022509379, 1.2120141342756183, 1.1792260692464358, 1.1056081573197378, 1.1339103869653768, 1.0108459869848156, 1.0672064777327934, 1.0518065887353878, 1.1776192402456513, 1.2081610641740068, 1.150943396226415, 2.0, 1.0120535343179362, 1.125022965276502, 1.2616487455197132, 1.0985293077847698, 1.0432692307692308, 1.6666666666666667, 1.2140845070422535, 1.0973150763290551, 1.7647058823529411, 1.1256231306081754, 1.0254868109366844, 1.1021391806253904, 1.0885690093141405, 1.0475247524752476, 1.153231908877295, 1.044735728896847, 1.0216847372810676, 1.0152764857881138, 1.0283085633404105, 1.0730464439763265, 1.0691114245416078, 1.0453429222943342, 1.2547169811320755, 1.042857142857143, 1.2073170731707317, 1.0, 1.4264705882352942, 1.014510197258442, 1.2638888888888888, 1.2952380952380953, 1.0115036976170912, 1.1764705882352942, 1.0366572737759778, 1.0092592592592593, 1.2082853397942566, 1.5714285714285714, 1.0672963400236128, 1.0021633315305571, 1.0420320061329118, 1.022379453902234, 2.0, 1.0772676371780514, 1.0703906583133795, 1.0258030792624977, 1.0381679389312977, 1.0166112956810631, 1.060758082497213, 1.0555806306015862, 1.3174603174603174, 1.0057680418165467, 1.0103508493411653, 1.1055900621118013, 1.087800369685767, 1.029867256637168, 1.4186046511627908, 1.218812541694463, 2.0, 1.2477244772447724, 1.1171663397777156, 1.162426614481409, 1.1391941391941391, 1.0769230769230769, 2.0, 1.106146150245729, 1.140625, 1.1249398170438132, 1.8, 1.1778846153846154, 1.1133333333333333, 1.2857142857142858, 1.0080832774732857, 1.0226757369614512, 1.0854402789886661, 1.3181818181818181, 1.0116197183098592, 1.0775021358221706, 1.0, 2.0, 1.1109463143636082, 1.0880538418395962, 1.1214814814814815, 1.0160930528999363, 1.0895109409947197, 1.0385067815586955, 1.1085219707057257, 1.0746980897313914, 1.026865671641791, 1.1408599314165129, 1.0638692098092644, 1.1333333333333333, 1.0457042983181404, 1.1942740286298568, 1.1428571428571428, 1.1666666666666667, 1.1725663716814159, 1.053680981595092, 1.0699490194277317, 1.00175162024873, 1.1912442396313363, 1.3874458874458875, 1.0170931457505012, 1.0808543096872616, 1.0980224137641346, 1.0530851494736646, 1.5, 1.0088235294117647, 1.0036014405762306, 1.0800730855174627, 1.132586175873326, 1.0472405025426264, 1.1862177801157285, 1.1643835616438356, 1.0521391329190772, 1.0065985161885875, 1.1071789686552074, 1.0451416504401723, 1.0120593692022264, 1.2222222222222223, 1.2307692307692308, 1.0863568215892054, 1.5833333333333333, 1.0369685767097967, 1.0903584961893813, 1.0913541141746455, 1.4722222222222223, 1.0583333333333333, 1.0648148148148149, 1.0669765840220387, 1.1097560975609757, 1.037037037037037, 1.170183167169024, 1.02030037739381, 1.2463768115942029, 1.75, 3.0, 1.0198281559814937, 1.1, 1.011397076598282, 1.0333333333333334, 1.0, 1.1065023956194386, 1.2307692307692308, 1.5833333333333333, 1.0166469914544973, 2.0, 1.00355871886121, 1.0405405405405406, 1.0269787614005996, 1.1178861788617886, 1.1116504854368932, 1.0588235294117647, 1.0803557338984198, 1.085245613204036, 1.1089449541284404, 1.0091509948685364, 1.062938353636028, 3.0, 1.1, 1.0623649362641965, 1.0, 1.0636321411983278, 1.4210526315789473, 3.3333333333333335, 1.4210526315789473, 1.3260687342833193, 1.0405616224648986, 1.2301587301587302, 1.0773809523809523, 1.3289473684210527, 1.5, 1.0805755714043381, 1.6666666666666667, 1.1194029850746268, 1.0251928599032398, 1.076, 1.0481203007518798, 1.043560606060606, 1.75, 1.25, 1.316309719934102, 1.0817610062893082, 1.2981132075471697, 1.1236949774266365, 1.2331122574306068, 1.0359897172236503, 1.5, 1.0277050807688837, 1.1384615384615384, 1.6, 3.3333333333333335, 1.003167290526922, 1.2857142857142858, 1.1353711790393013, 1.2121212121212122, 1.2021813570069753, 1.1125997760944475, 1.07679180887372, 1.0770322651089153, 1.1073340471092077, 1.0263157894736843, 1.1205357142857142, 1.1026795851941564, 1.1174496644295302, 1.0303030303030303, 1.00368284126482, 1.060025421638747, 1.1071835803876853, 1.0241545893719808, 1.1282051282051282, 1.1931330472103003, 3.0, 1.0208333333333333, 1.4673913043478262, 1.2442748091603053, 1.2576687116564418, 1.1333333333333333, 1.1148536720044175, 1.013555787278415, 1.0816426267506318, 1.0722663639803254, 1.1747843734145105, 1.0303030303030303, 1.2049180327868851, 1.0769230769230769, 1.0, 1.0778908706072774, 1.588235294117647, 1.1064158333804117, 1.0460304890120768, 1.0880166003804255, 1.1346153846153846, 1.75, 1.0226354082457558, 1.5, 1.0025764895330114, 1.2727272727272727, 1.0689687909963406, 1.014580801944107, 1.1761169926431008, 1.0629139072847682, 1.0330578512396693, 4.0, 1.2491592785081016, 1.0004146576419632, 1.0970346278936292, 2.0, 1.1025641025641026, 1.2284345047923322, 1.2195845697329377, 1.1279449457533093, 1.3548596112311015, 1.0869565217391304, 1.0768037238169124, 1.0407960392951816, 1.1008419179301139, 1.095012853470437, 1.0467302554370896, 1.16335472449657, 1.619047619047619, 1.0595964335992492, 1.0900864830237027, 1.176991150442478, 1.2282728272827284, 1.0, 1.5, 1.225130890052356, 1.1155378486055776, 1.0357017850892545, 1.1699571921485532, 1.0878835153406137, 1.0, 1.1578947368421053, 1.0303030303030303, 1.002592785003789, 1.25, 3.0, 1.0150033979821214, 1.0, 1.0, 1.0150404936367143, 2.0, 1.002583144979012, 1.0121951219512195, 1.0222222222222221, 1.3333333333333333, 1.0681554396532726, 1.0911413969335604, 1.7, 1.1160947378353725, 1.0222222222222221, 1.1577777777777778, 1.0073431241655542, 1.2630853994490359, 1.0775277435265105, 1.0, 1.036144578313253, 1.01691120617279, 1.0108975329196308, 1.0644391408114557, 1.5, 1.099833917696992, 1.0029527424382154, 1.037677304964539, 2.0, 1.0495510475557033, 1.0605934495817553, 1.0242680290823345, 1.0226320201173513, 1.0011646131742784, 1.0448288247742115, 1.0127840909090908, 1.1389287290379524, 1.75, 1.023486745531474, 1.1529051987767585, 1.0462650602409638, 1.109641873278237, 1.0213333333333334, 1.009931428333229, 1.0300429184549356, 1.071691381424908, 1.334486735870819, 1.063199394687587, 1.0538599640933572, 1.089954087234255, 1.0070019575365157, 1.0568181818181819, 1.2435897435897436, 1.1167228757094678, 1.0441176470588236, 1.0401915647986453, 1.0545138236776814, 1.0, 1.0072380952380953, 1.2682215743440233, 1.0232558139534884, 1.2115384615384615, 1.018644512031976, 1.136531365313653, 1.0047826086956522, 1.0, 1.1690140845070423, 1.0095934216537232, 1.1190727439833883, 1.0365627319970305, 1.0266364590533241, 1.1038808310466484, 1.0544105523495466, 1.0077200205867216, 1.037630969785575, 1.608433734939759, 1.0508620422338677, 1.063063063063063, 1.0145631067961165, 1.0423471686031578, 1.112293144208038, 1.0500101207745767, 2.0, 1.0561224489795917, 1.0358306188925082, 1.0130165706944563, 1.1168539325842697, 1.041030534351145, 1.0100671140939597, 1.0123456790123457, 1.1148177137880475, 1.0, 1.4035087719298245, 1.6, 1.0, 1.1764705882352942, 1.024, 1.02710027100271, 1.06, 1.072352465642684, 1.0658263305322129, 1.0289147412233612, 1.1874665759152123, 1.1839790717604077, 1.1029552949033685, 1.0061841139713132, 1.09688013136289, 1.1531333821019263, 1.0512915499855588, 1.0094292803970224, 1.0792079207920793, 1.1279212792127922, 1.3206106870229009, 1.0546875, 1.1695702671312427, 1.1007928856710016, 1.2897727272727273, 1.2980541053630754, 1.0771491550330639, 1.5, 1.0376470588235294, 1.1666666666666667, 1.3333333333333333, 1.2727272727272727, 1.0397367498734373, 1.0466970387243735, 1.0103359173126616, 1.1210526315789473, 1.0759763530304218, 1.0205230921071728, 1.0881294964028776, 1.2, 2.5, 1.093012386071512, 1.1711711711711712, 1.070602313522138, 1.12037691401649, 1.0, 1.4809782608695652, 1.1521739130434783, 1.063596599818437, 1.1426491994177583, 1.0254317990850528, 1.0071945060135896, 1.0077210792782856, 1.4725274725274726, 3.5, 1.2067408304879392, 1.0, 1.0091324200913243, 1.2207792207792207, 1.3701657458563536, 1.0192307692307692, 1.5416666666666667, 1.0058132917052864, 1.033112582781457, 1.2025246981339188, 1.1788978122403766, 1.1816418875242405, 1.0184971098265896, 1.0353604041189042, 1.0008968609865472, 1.070486111111111, 2.4, 1.0072227131276652, 1.0122194269284803, 1.0, 1.016995241332427, 1.295902243758559, 1.1048387096774193, 1.0147809901062728, 1.2, 1.2805100182149363, 1.0957219251336898, 1.1990521327014219, 1.1183431952662721, 1.105866156646432, 1.1721311475409837, 2.142857142857143, 1.053481331987891, 1.0920245398773005, 1.1198006381837178, 1.177252106286455, 1.0181213337301624, 1.0773589937330548, 1.2331768388106417, 1.1373645578469067, 1.1888888888888889, 1.0558862871338066, 1.0485386221294364, 1.0428911834789516, 1.0048565121412802, 1.0332047308835621, 1.01841620626151, 1.0652703360935216, 1.1818181818181819, 1.3333333333333333, 1.083743842364532, 1.616922631121414, 1.062869592281357, 1.1648892534864643, 1.1666666666666667, 1.0186234817813766, 1.047016274864376, 1.1130952380952381, 1.0433782428961862, 2.0, 1.0747267326161567, 1.5, 1.0446601941747573, 1.1538461538461537, 1.0217107217107217, 1.3548387096774193, 1.1326164874551972, 1.0429447852760736, 3.0, 1.3880189366351057, 1.2175346077785103, 1.2, 2.5, 1.1521739130434783, 1.2045454545454546, 1.0316245855649069, 1.2091295116772824, 1.0856741573033708, 1.0641672674837779, 1.0876288659793814, 1.0789473684210527, 1.2377049180327868, 1.3636363636363635, 1.0, 2.0, 1.1963562753036436, 1.1046228710462287, 1.0797598627787306, 1.0186198376279563, 1.0689182025134873, 1.033111403852316, 1.0794358153420154, 1.1435231134770971, 1.1491329479768786, 1.0208439247585155, 1.3333333333333333, 1.5, 1.1515151515151516, 1.0170734639894192, 1.0608058608058608, 1.121212121212121, 1.0993914807302232, 1.01578847251284, 1.0375799573560767, 1.0098042233577542, 1.1666666666666667, 1.2380952380952381, 1.0495436766623207, 1.0420767444432157, 1.0589920668171313, 1.0063107811932113, 1.0055555555555555, 1.1028141199703776, 1.1586966713548992, 1.097789730332398, 1.0386617100371747, 1.1143233206411884, 1.0671140939597314, 1.0694668820678515, 1.0476190476190477, 1.041293012280927, 1.0813953488372092, 1.151953377940859, 1.0, 1.0365111561866125, 1.0173917821768577, 1.1147540983606556, 1.0532933655198027, 1.0224618149146452, 1.375, 1.1123179045971718, 1.0195192048618387, 1.126051126807938, 1.0386435331230284, 1.041237113402062, 1.1967070326768003, 1.1968641114982579, 1.2352941176470589, 1.0, 1.25, 1.0637161004133482, 1.25, 1.057012206715595, 1.099997759906812, 1.021759519789908, 1.0611972652993162, 1.0716045621332344, 1.0100307247424543, 1.0642201834862386, 1.0255813953488373, 1.0120087208050697, 1.1588343294659949, 1.0447646493756004, 1.2898387419871795, 1.8333333333333333, 1.0167714884696017, 1.0853242320819112, 1.1086859302644296, 1.002724795640327, 1.2825447136065202, 1.019402985074627, 2.20863309352518, 1.0429171725904782, 1.0834272829763247, 1.0684288192713423, 1.2777777777777777, 1.0854348465535837, 1.0306552220504346, 1.204727564102564, 1.0446985446985446, 1.2580645161290323, 1.0751748251748252, 1.0677935378619658, 1.0308335054248543, 1.1, 1.0184514318046545, 1.3214285714285714, 1.1209923935451767, 1.061712846347607, 1.0303030303030303, 1.037914691943128, 1.018987341772152, 1.0183752417794971, 1.0709393346379648, 1.0066173255763573, 1.0876338851022396, 1.187905935050392, 1.0522374678133137, 1.0666666666666667, 1.0791936645068394, 1.029051738207932, 1.0446382760389943, 1.1242017176833297, 1.0346456692913386, 1.186046511627907, 1.0614886731391586, 1.051702395964691, 1.0350967248424825, 1.1, 1.116745283018868, 1.240837907652567, 1.0461838681699913, 1.0765306122448979, 1.0583925937722876, 1.0959458624312466, 1.0065189048239895, 1.096234309623431, 1.0844666967620142, 1.0778967339747934, 1.0845921450151057, 1.032258064516129, 1.0336336336336336, 1.088984134453094, 1.1578947368421053, 3.0, 1.0522989184231317, 1.1693861589082475, 1.0119846596356663, 1.0330188679245282, 1.2118925445215816, 1.022463587774499, 1.146970048757836, 1.1568047337278107, 1.3571428571428572, 1.080681818181818, 1.2777777777777777, 1.092964824120603, 1.6571428571428573, 1.047745752935266, 1.1733116354759967, 1.0107059217129475, 1.1063829787234043, 1.023076923076923, 1.1996606334841629, 1.1111111111111112, 1.0, 1.049498746867168, 1.045267489711934, 1.0314435445450214, 1.0, 1.0021021021021022, 1.0772727272727274, 1.037463976945245, 1.280701754385965, 2.0, 1.1965737514518002, 1.002029799179443, 1.0017567207878626, 1.1218045112781956, 1.2222222222222223, 1.1764705882352942, 1.0857142857142856, 1.0105263157894737, 1.1111111111111112, 1.056836635271192, 1.03355177818234, 1.0282955574861723, 1.396551724137931, 1.1119208923561212, 1.0470822585148545, 2.5, 1.0383306931207312, 1.0656089594027065, 1.5, 2.75, 1.183369909778103, 1.0471692473246847, 1.0923361934477378, 1.2670157068062826, 1.0, 1.125, 1.3554987212276215, 1.2266666666666666, 1.028200010691947, 1.1240049409827066, 1.0530284444807894, 1.0520357291233902, 1.5714285714285714, 1.0166338177036753, 1.044155844155844, 1.0051020408163265, 1.1375661375661377, 1.0299760191846523, 1.0, 1.1926605504587156, 1.1825227151256013, 1.0007918168156036, 1.04, 1.0632911392405062, 1.0638269266027012, 1.1003861003861004, 1.0618556701030928, 1.253968253968254, 1.0391833438278533, 1.5606734434561627, 1.0548149157292437, 1.2722772277227723, 1.1811023622047243, 1.076555023923445, 1.0, 1.0654888821200121, 1.0252525252525253, 1.0131181023892806, 1.0516304347826086, 2.0, 1.1647465437788018, 1.0328107456231546, 1.1319086219602064, 1.0499268173686778, 1.0193974115506759, 1.0795644891122278, 1.1219564288765485, 1.4615384615384615, 1.0535714285714286, 1.0749394593887034, 1.0794592050656742, 1.2096486003573557, 1.117283950617284, 1.6666666666666667, 1.1139240506329113, 1.0261966899012256, 1.0425531914893618, 1.037556152113208, 1.092039586919105, 1.0374331550802138, 2.0, 1.1020191285866099, 1.008948691080056, 1.16341601969324, 1.1540880503144655, 1.064565332962354, 1.0377358490566038, 1.3667917448405253, 1.006717850287908, 1.0317587532398405, 1.0506388649368974, 1.022944550669216, 1.0727272727272728, 1.105263157894737, 1.1897138964577656, 1.033084622184156, 1.0151175612705865, 1.0037690934338426, 1.116923076923077, 1.0334807327858497, 1.273972602739726, 1.234375, 2.0, 2.5, 1.1578947368421053, 1.0235042735042734, 1.0194552529182879, 1.027655043071935, 1.0096129846605861, 1.011770031688547, 1.0141743444365698, 1.105726872246696, 1.025, 1.066594876776946, 1.5, 1.5, 1.074375363160953, 1.0, 1.070828331332533, 1.1314807133969307, 1.0738535800482703, 1.0830106829377064, 2.5, 1.0388874581509142, 1.2625, 1.1430603497325798, 1.0400047370009435, 1.1376811594202898, 1.1333522888825704, 1.1588579381947448, 1.0732306210881077, 1.0258503401360544, 1.095890410958904, 1.098707403055229, 1.6666666666666667, 2.0, 1.0409249622168122, 7.0, 1.7142857142857142, 1.8571428571428572, 1.0832443970117396, 1.0800412049539063, 1.0398126463700235, 1.0392156862745099, 1.1428571428571428, 1.2201110786319789, 1.0124760076775432, 1.0480225988700564, 1.325910931174089]
origin-bjaq_15.71 	max: 7.0000	99th: 3.0000	95th: 1.8017	median: 1.0805	mean: 1.1893

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.083571 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.218394