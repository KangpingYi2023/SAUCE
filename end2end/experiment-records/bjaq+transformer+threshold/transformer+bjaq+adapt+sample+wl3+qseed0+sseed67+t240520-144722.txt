Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 67, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.5844	95th: 1.8333	median: 1.0819	mean: 1.1807
ReportEsts: [1.0476190476190477, 1.0099947396107312, 1.046142383866441, 1.123110151187905, 1.5, 1.0, 1.0515508483735005, 1.0431762735741241, 1.0, 1.0359042553191489, 1.1870833694052463, 1.042619270852115, 1.000420168067227, 1.1, 1.0187212998940305, 1.0, 1.0465116279069768, 1.0602196245129296, 3.0, 2.0, 1.08, 1.1245574040840083, 1.0446982865656818, 1.081620669406929, 1.1223482979773063, 1.0, 1.1392850791392495, 2.0, 1.2, 1.0071942446043165, 1.0, 1.052687564257198, 1.0037891836031692, 1.0726970033296337, 1.0496401821119108, 1.2212989375335896, 1.195187165775401, 1.0015394701697302, 1.121874784764791, 1.0714285714285714, 1.1800302571860817, 1.0304878048780488, 1.0, 1.0400359222457198, 1.0875691997986916, 1.890625, 1.0098039215686274, 1.2614840989399294, 1.0308599308802602, 1.0648148148148149, 1.066736907025749, 1.268041237113402, 1.039495821401839, 2.0, 1.4363636363636363, 1.225846059396823, 1.2707948243992606, 1.3592233009708738, 1.0733333333333333, 1.25, 1.0498227917121048, 1.0896637608966375, 1.0909090909090908, 1.0114942528735633, 1.0, 1.0786260966959118, 1.2757433489827856, 1.75, 1.0, 1.0403654330194836, 1.0345679012345679, 1.0652300524170064, 1.0422535211267605, 1.0919390181360435, 1.0776470588235294, 1.0588235294117647, 1.3333333333333333, 1.1152400835073069, 2.0, 1.000200866595885, 1.03125, 1.0267886801753052, 1.116564417177914, 1.0941028858218318, 1.1172718351324828, 1.0, 1.0757071224037627, 1.0255813953488373, 1.0980392156862746, 1.75, 1.1385083713850837, 1.0682249972060631, 1.0808080808080809, 1.023842917251052, 1.0082872928176796, 1.1168831168831168, 1.0465116279069768, 1.183838383838384, 1.0, 1.2408104517271923, 1.0278229983720586, 1.053173241852487, 1.2179911462586497, 1.4166666666666667, 1.0194511568567686, 1.0488452349349615, 1.168657360771334, 1.0948047023132348, 1.0542611894543226, 1.3333333333333333, 2.0, 1.0364485981308411, 1.0519236868559265, 1.0467466835123185, 1.2207792207792207, 1.058843131090852, 1.0, 1.130242825607064, 1.1140724946695095, 1.0, 1.04, 1.1666666666666667, 1.2406015037593985, 1.0181176978284938, 1.0629805078822707, 1.108910891089109, 1.8, 1.1730132450331126, 1.0, 1.0, 1.10018300600137, 1.1818181818181819, 1.0940755208333333, 1.048766854867579, 1.0410958904109588, 1.0787716955941256, 1.0110803324099722, 1.0089633671083398, 1.039972432804962, 1.068860450944546, 1.04789500596557, 1.2, 1.0287018917155903, 1.1290601307030461, 2.0, 1.02461257976299, 1.0174418604651163, 1.0869858395144976, 1.0938768307746602, 1.5, 1.2280213126665052, 1.0321100917431192, 1.0438413361169103, 1.1074561403508771, 1.148905109489051, 1.0500973623650203, 1.150054831241623, 1.1248161485012933, 1.0193798449612403, 1.0592105263157894, 1.2857142857142858, 1.2660550458715596, 1.0073637702503682, 1.2857142857142858, 1.0330772326322557, 1.0209990163859428, 1.137524557956778, 1.3344449737970463, 1.1181693989071038, 1.167369006917389, 1.2547368421052632, 1.1553398058252426, 1.0971240437687615, 1.051009564293305, 1.0320569902048085, 1.1030126336248784, 1.0482539682539682, 1.1006310762408322, 1.04711803098215, 1.0, 1.1746031746031746, 1.0615730337078653, 1.0279106858054226, 1.221142986220917, 1.131578947368421, 1.0826466518923021, 1.2131462617720545, 1.0587407744085882, 1.1153846153846154, 1.3422727272727273, 1.0620121052695675, 1.0, 1.1818181818181819, 1.1080263104798032, 1.118020304568528, 1.0235960358659746, 1.206896551724138, 1.0681672025723472, 1.0580165144874292, 1.0558547898523287, 1.0626410835214446, 1.0518604406029304, 1.271186440677966, 1.0847457627118644, 1.1666666666666667, 1.0, 1.4545454545454546, 1.0368238448194291, 1.289198606271777, 1.2758620689655173, 1.0118635689569946, 1.0031277926720286, 1.0355723511461217, 1.0916379980024415, 1.174088760103706, 1.1282051282051282, 1.1864161849710984, 1.002924926876828, 1.0650812797978058, 1.0145450794305757, 1.0, 1.04472049689441, 1.1245543891438363, 1.01117608997836, 1.1503990178023327, 1.0372648147182988, 1.2767428046870781, 1.0357142857142858, 1.0055690269937652, 1.0395822588963384, 1.0016949152542374, 1.1294117647058823, 1.2094831911690918, 1.0027079303675048, 1.110236220472441, 2.0, 1.1687379177022923, 1.0245645377400625, 1.0829817158931083, 1.1260504201680672, 1.0, 1.6666666666666667, 1.1129772603366104, 1.1272727272727272, 1.088705734441573, 1.5, 1.0, 1.0256410256410255, 1.030054644808743, 1.010204081632653, 1.0138121546961325, 1.1466244725738397, 1.0778546712802768, 1.0020990764063813, 1.094732970712917, 1.0178571428571428, 2.0, 1.0708983611950733, 1.1361085126286248, 1.096322241681261, 1.0095741789827957, 1.1344358649302755, 1.0322864640650131, 1.095389507154213, 1.10071651145186, 1.0340909090909092, 1.0359971202303815, 1.0622620655777968, 1.0, 1.0260809544939111, 1.247340425531915, 1.2045454545454546, 1.4705882352941178, 1.0007278020378456, 1.0, 1.0353982300884956, 1.1255097234371845, 1.087878787878788, 1.3909774436090225, 1.0093072995316972, 1.0511744966442953, 1.0268650540624873, 1.0514485598085324, 1.25, 1.0444525281920698, 2.5, 1.0289626534205893, 1.0198237885462555, 1.0661326293750852, 1.0526315789473684, 2.5, 1.3478260869565217, 1.126984126984127, 1.0700385563162789, 1.0, 1.0305810397553516, 1.04, 1.0088141025641026, 1.015754960271363, 1.0988372093023255, 1.1635220125786163, 1.015121818309661, 1.2100236212385744, 1.0980547139156018, 1.1538461538461537, 1.0, 1.1348448687350836, 1.288888888888889, 1.088135593220339, 1.112173546756529, 1.0266889074228525, 1.047887323943662, 1.3111111111111111, 1.0, 1.0186596583442837, 1.2857142857142858, 1.0122438867663055, 1.054054054054054, 1.1176470588235294, 1.0858006786339756, 1.1428571428571428, 1.4, 1.004120966208077, 2.0, 1.196159122085048, 1.0363372093023255, 1.0762920426579163, 1.127505330490405, 1.0132275132275133, 1.0833333333333333, 1.1065761171011512, 1.0882484197885478, 1.0411347517730496, 1.04252863737391, 1.0204458327417294, 2.0, 1.0, 1.0339358760483557, 1.25, 1.0697544642857142, 1.3529411764705883, 1.0, 1.4666666666666666, 1.3483935742971886, 1.0609184629803186, 1.0238095238095237, 1.024891774891775, 1.0, 1.2023968042609854, 1.097137373628156, 2.0, 1.1304347826086956, 1.0, 1.0995824793137479, 1.0112359550561798, 1.0141432694830752, 1.1543778801843319, 1.1363636363636365, 1.3015521064301552, 1.3518518518518519, 1.0269352530786853, 1.0237662176220044, 1.0743919885550788, 1.0, 1.0769230769230769, 1.5714285714285714, 1.5, 1.1428571428571428, 1.0685871338295567, 1.3333333333333333, 1.0083194675540765, 1.2625, 1.1891704583119895, 1.0825028120013602, 1.2440782698249229, 1.0080881311103764, 1.0092807424593968, 1.0488095238095239, 1.5, 1.2060301507537687, 1.0808510638297872, 1.0504873302299775, 1.1428571428571428, 1.5714285714285714, 1.0200445434298442, 1.0183540556542332, 1.0310012861713798, 1.0245098039215685, 1.1464387464387464, 1.0087551299589603, 1.0666666666666667, 1.0907770515613653, 1.1006355932203389, 1.1153846153846154, 1.0254957507082152, 1.1941747572815533, 1.0580124829028252, 1.071536979744323, 1.0508746547415493, 1.075, 1.1935483870967742, 1.1049382716049383, 1.0, 1.0528013537452738, 1.0438886393291835, 1.0721537345902827, 1.0574311076253966, 1.0531722054380666, 1.1560216078805212, 1.8333333333333333, 1.1632996632996633, 1.0, 1.2134927412467975, 1.25, 1.0406087639852333, 1.0102489019033676, 1.0060553633217992, 1.0790513833992095, 1.0112359550561798, 3.0, 1.174406604747162, 1.0064955083925753, 1.0570857090307155, 2.0, 1.1111111111111112, 1.2466410748560461, 1.4146341463414633, 1.112614669378606, 1.2494802494802495, 1.2352941176470589, 1.1596203623813632, 1.0096290929487928, 1.0638525989754994, 1.1082965939682417, 1.0970394736842106, 1.0580431177446104, 1.306930693069307, 2.142857142857143, 1.112994350282486, 1.5, 1.225752508361204, 1.1785714285714286, 1.1564274525161542, 2.272727272727273, 1.04825620291457, 1.0746532849851347, 1.0789636027143739, 1.0, 1.163265306122449, 1.16, 1.2834740048943716, 1.2385120350109409, 1.0, 1.0598922354241502, 1.0659888307330145, 1.0928305014504767, 1.5, 2.0, 1.0201941747572816, 1.0099547511312217, 1.0163934426229508, 1.1111111111111112, 1.0658932102834542, 1.090628218331617, 1.4705882352941178, 1.0009039548022598, 1.0454545454545454, 1.1286089238845145, 1.0266129032258065, 1.2852334875893985, 1.0319886262662163, 1.0, 1.0724637681159421, 1.1325021368315433, 1.0658195093409808, 1.0167174483809276, 2.0, 1.1209909312099093, 1.0018353925408858, 1.0220010476689365, 2.0, 1.063397129186603, 1.0750990142858952, 1.0427961808860098, 1.0144598313747761, 1.0065034815070921, 1.0210850509357972, 1.0285220397579948, 1.0814850530376086, 2.0, 1.0759729184970799, 1.7619047619047619, 1.0, 1.1761658031088082, 1.1346153846153846, 1.006303446135522, 1.1676587301587302, 1.0536059024791178, 1.193207893529142, 1.083503873702675, 1.0225889354795077, 1.0508859530496897, 1.1704545454545454, 4.0, 1.0021701054738625, 1.2147773279352228, 1.0481575135930858, 1.0497021896970105, 1.1194824961948249, 1.2609046849757675, 2.580246913580247, 2.4285714285714284, 1.0077421239713686, 1.062850266843448, 1.0211778029445073, 1.16775181922635, 1.054545892788276, 1.0167714884696017, 1.077632212293075, 1.0192413413963717, 1.2095531587057011, 3.0, 1.1666666666666667, 1.0122699386503067, 1.0970873786407767, 1.047451669595782, 1.124331550802139, 1.0980392156862746, 1.1987951807228916, 1.148905109489051, 1.0705882352941176, 1.0579376527037767, 1.2840909090909092, 1.0500080840743735, 2.0, 1.1047619047619048, 1.1468253968253967, 1.0522388059701493, 1.1360335195530726, 1.0959232613908874, 1.1007905138339922, 1.0090791180285343, 1.09020775354346, 1.0, 1.0851063829787233, 1.3333333333333333, 1.0, 1.125, 1.0766129032258065, 1.051948051948052, 1.1310679611650485, 1.0645626401794297, 1.1334106728538282, 1.0696592158299743, 1.197826857210346, 1.0394431554524362, 1.0632505592149344, 1.0594594594594595, 1.1259160559626915, 1.065795839380745, 1.0458430458430459, 1.2182080924855492, 1.1288063337393424, 1.0413520498657072, 1.3319429108902794, 1.0814734382192217, 2.0, 1.2727272727272727, 1.0841683366733468, 1.4205607476635513, 1.0, 1.1590909090909092, 1.3636363636363635, 1.2176724137931034, 1.4074074074074074, 1.1666666666666667, 1.0076770020219596, 1.1251299688074863, 1.0207584262396854, 1.0157160380251458, 1.2648648648648648, 1.1351724137931034, 1.0, 1.1578947368421053, 1.0119346733668342, 1.0829813796584058, 1.0853610828573663, 1.1413600637885863, 1.0257115610328638, 1.1844155844155844, 1.0561662962890126, 1.108348134991119, 1.015247662398816, 1.0749543477851615, 1.303030303030303, 1.0841423948220066, 1.0, 1.2422535211267605, 1.2066524397751057, 3.0, 1.0948660714285714, 1.0516351901093157, 1.4285714285714286, 1.0592589766093028, 1.3, 1.0555555555555556, 1.0367031079066966, 1.6923076923076923, 1.0474964649577607, 1.0286202477573687, 1.3571428571428572, 1.3181818181818181, 1.0618556701030928, 1.024390243902439, 1.0434878587196468, 1.1011012339126973, 1.1566176807215127, 1.0, 1.065772322398436, 1.1341463414634145, 2.0, 1.0241891668438334, 1.143316895925253, 1.1438032166508987, 1.014078767232322, 1.0447700083168063, 1.018018018018018, 2.0, 1.0420134760206103, 1.043548387096774, 1.1468277535506421, 1.2196908055329536, 1.0035156677751587, 1.0327811755527383, 1.086080586080586, 1.1057178116001645, 1.1806020066889633, 1.0947294054593957, 1.105993690851735, 1.0733695652173914, 1.1449579831932772, 1.0467691912425905, 3.0, 1.1416599323576069, 1.0366000680068832, 1.0259055071432805, 1.5833333333333333, 1.2445493681433135, 1.355, 1.1428571428571428, 1.0858079988714116, 1.0420575865415722, 1.1310043668122272, 1.0294117647058822, 1.3333333333333333, 1.0522414350936478, 1.5, 1.0841121495327102, 1.0833333333333333, 1.029237317702882, 1.44, 1.219409282700422, 1.0838574423480083, 1.0, 1.8082010582010581, 1.2163882259347654, 1.25, 2.0, 1.1083333333333334, 1.293103448275862, 1.0237812128418549, 1.201765447667087, 1.0526315789473684, 1.2418879056047198, 1.1014466214978942, 1.0545454545454545, 1.2436548223350254, 1.0979591836734695, 1.0, 1.0, 1.2694763729246488, 1.0836940836940836, 1.0157397691500525, 1.0420638209697473, 1.079778686613439, 1.0356347438752784, 1.0716434945009339, 1.2059716599190284, 1.1671348314606742, 1.0320197044334976, 1.8333333333333333, 2.0, 1.2592592592592593, 1.0136753434013812, 1.0732568402471314, 1.107843137254902, 1.2303030303030302, 1.0089375144464134, 1.0598176688264735, 1.0281527684182483, 1.1304347826086956, 1.2222222222222223, 1.0360429447852761, 1.0387062566277836, 1.0602912290384896, 1.0408446828999862, 1.027027027027027, 1.1150324867099823, 1.017015210567022, 1.0611413043478262, 1.29989816700611, 1.125, 1.066441983630236, 1.15625, 1.1818181818181819, 1.002724795640327, 1.0701001430615165, 1.0, 1.0682926829268293, 1.0085302800476261, 1.1111111111111112, 1.0521736361537666, 1.007415254237288, 1.2285714285714286, 1.0347771579013352, 1.0516222062004326, 1.0426739188826215, 1.0229007633587786, 1.0196759259259258, 1.1999729492121458, 1.1546391752577319, 1.2857142857142858, 1.0, 1.4285714285714286, 1.067046142666828, 1.3333333333333333, 1.1102291448255204, 1.1123525927521405, 1.0324794144556266, 1.0798411122144984, 1.05053322640579, 1.0431939978563773, 1.014336917562724, 1.0235783633841886, 1.0186207058492027, 1.1513404574428197, 1.0414347402840527, 1.212272672528002, 1.4285714285714286, 1.046875, 1.0316205533596838, 1.0885819265832437, 1.0267558528428093, 1.3048143053645116, 1.0405156537753222, 2.2304347826086954, 1.0747990076000251, 1.0590604026845638, 1.0847488038277513, 1.125, 1.069117266373285, 1.0294166514009653, 1.3111111111111111, 1.0581052631578947, 1.4545454545454546, 1.0064655172413792, 1.0864864864864865, 1.5625, 1.0452124845706225, 1.5384615384615385, 1.164319248826291, 1.1346633416458853, 1.0653735632183907, 1.0152136752136751, 1.0035419126328218, 3.6666666666666665, 1.0666666666666667, 1.0839736755027758, 1.040002222345686, 1.0172520063006245, 1.0819090331238082, 1.0862122571532633, 1.0, 1.0903614457831325, 1.0222699746044148, 1.0036162328675386, 1.0270541082164328, 1.0, 1.0279531109107305, 1.025034137460173, 1.3728813559322033, 1.0556415073488783, 1.0, 1.3333333333333333, 1.0239017033795643, 1.009849444209934, 1.239809523809524, 1.118357890834955, 1.0622505985634478, 1.1363636363636365, 1.102591398803363, 1.074201283131359, 1.1121323529411764, 1.0818713450292399, 1.00990099009901, 1.1197786285770381, 1.1071428571428572, 1.75, 1.051692454902302, 1.166572448435708, 1.0097869890616005, 1.035294117647059, 1.2143374366401158, 1.0170216677981443, 1.1627776215912287, 1.3745704467353952, 1.1923076923076923, 1.0673854447439353, 1.1670761670761671, 1.134375, 1.5925925925925926, 1.0149066934853057, 1.1873141724479683, 1.1708126036484245, 1.024390243902439, 1.0290634299662287, 1.010948905109489, 1.0623159303882195, 1.1787482669835612, 1.3333333333333333, 1.2173913043478262, 2.0, 1.1494252873563218, 1.3846153846153846, 1.0, 1.1538461538461537, 1.0821192052980133, 1.0615942028985508, 1.0185344298514791, 1.0247233917556056, 1.0218181818181817, 1.3333333333333333, 1.1428571428571428, 1.064516129032258, 1.0810810810810811, 1.1142857142857143, 1.106896551724138, 1.0275051836042766, 1.0319802604727097, 1.3195876288659794, 1.0605171553038852, 1.0474550823282118, 2.5, 1.071042155761968, 1.3157894736842106, 3.0, 2.0, 1.205621301775148, 1.0840565158143871, 1.0993898606892218, 1.2763975155279503, 1.0, 1.0, 1.4049079754601228, 3.0, 1.5, 1.0415171706817017, 1.1635972576959268, 1.0064975634137199, 2.0, 1.0326394085068145, 1.0449264136328427, 1.0726072607260726, 1.125, 1.0187793427230047, 1.0246499853622415, 1.263157894736842, 1.1460212779194923, 1.0450728263610094, 1.2724550898203593, 1.09375, 1.1383949571925862, 1.098499061913696, 1.0743801652892562, 1.15, 1.029750723876863, 1.6138965653375443, 1.0701300857356306, 1.778443113772455, 1.196078431372549, 1.373134328358209, 1.1123439667128987, 1.058346333853354, 1.0158480694354315, 1.0695075684997126, 1.0414847161572052, 1.5, 1.6666666666666667, 1.0627756824138592, 1.077396657871592, 1.1040653569344485, 1.0161203225291786, 1.0921558789095167, 1.0865972566517932, 1.2894736842105263, 1.0434782608695652, 1.131907868878233, 1.0707197304349614, 1.2121428571428572, 1.0477064220183485, 2.5, 1.0416666666666667, 1.1066498863267296, 1.1631461923290718, 1.010609786858368, 1.0750935600223528, 1.0291193181818181, 2.0, 1.0673316708229426, 1.0283630837623896, 1.176604980580306, 1.038022813688213, 1.087541124302675, 1.0796178343949046, 1.4194260485651213, 1.0150724637681159, 1.0317681512852057, 1.0606532536408788, 1.0299539170506913, 1.0525606469002695, 1.0, 1.1362003688962237, 1.0472392357619527, 1.0299319727891156, 1.1131321435503945, 1.0690065437239737, 1.0234493192133132, 1.2, 1.236220472440945, 1.6666666666666667, 2.0, 1.2352941176470589, 1.0025641025641026, 1.028436018957346, 1.0288061127029609, 1.0212052521277961, 1.1047489823609227, 1.062133891213389, 1.190217391304348, 1.1951219512195121, 1.0661489790048893, 1.6, 1.5, 1.1013610315186246, 1.1428571428571428, 1.0774748923959827, 1.1369315342328836, 1.0804867057232987, 1.1099965915177485, 2.0, 1.0339308578745199, 1.1666666666666667, 1.084663240465242, 1.0399047680211382, 1.1767676767676767, 1.1164383561643836, 1.134471788980692, 1.0897683963647025, 1.0177993527508091, 1.2033898305084745, 1.058659217877095, 1.0, 1.0, 1.0417814098208218, 5.0, 1.4285714285714286, 1.8620689655172413, 1.0221948212083847, 1.0804597701149425, 1.0825942350332594, 1.109846998823068, 1.0, 1.0968342644320297, 1.0245327102803738, 1.2320441988950277, 1.2932692307692308, 1.4285714285714286, 1.0115148127445501, 1.0409694171956145, 1.1444444444444444, 1.0412792859799183, 1.0278512385711247, 1.2657667876588021, 1.1289559301981662, 1.0, 1.1826796970850786, 1.0341627386667247, 1.0581510043041606, 1.1774193548387097, 1.0815488565488565]
origin-bjaq_15.71 	max: 5.0000	99th: 2.5844	95th: 1.8333	median: 1.0819	mean: 1.1807

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 13.984462 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[5.9604645e-07 5.9604645e-08 7.7486038e-07 3.5762787e-07 1.7881393e-07]
Distance score: 3.9339064983323624e-07
SAUCE Drift detection: False
Detection latency: 0.0234s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.007017 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 3.0000	95th: 1.9620	median: 1.0813	mean: 1.1833
ReportEsts: [1.021505376344086, 1.0368084637425612, 1.0541013268998793, 1.053082191780822, 1.625, 1.0, 1.0308251029717879, 1.0730417472778728, 1.2, 1.0360655737704918, 1.1295182172594695, 1.043326605249409, 1.015318845742786, 1.0752475247524753, 1.044920728126835, 1.0, 1.1628664495114007, 1.082191780821918, 1.1818181818181819, 1.0427493713327745, 1.0551634270822021, 1.0221193102187558, 1.0629770992366412, 1.0195911413969336, 1.002359595398789, 1.0486928123770198, 2.0, 1.167967568221698, 1.5, 1.3333333333333333, 1.111913357400722, 1.0, 1.0440776413499007, 1.0029190233701266, 1.0472727272727274, 1.0090719627313964, 1.2312020282707603, 1.124716553287982, 3.0, 1.1209615548546585, 1.039789574366332, 1.0238309100095435, 1.2210386151797603, 1.0594249201277954, 1.0018214936247722, 1.0452485820209765, 1.3333333333333333, 1.0046885465505693, 1.8507462686567164, 1.063265306122449, 1.4, 1.3256880733944953, 1.066390041493776, 1.09375, 1.019533764987427, 1.0041570628910108, 1.1314878892733564, 1.1477572559366755, 1.1363636363636365, 1.068839621634912, 1.4426229508196722, 1.1327439681264, 1.0345864661654136, 1.1139705882352942, 1.0515463917525774, 2.1666666666666665, 1.1019642743627234, 1.2291771832407874, 1.4, 1.0, 1.0953718879263248, 1.059475806451613, 1.066083576287658, 1.0038461538461538, 1.106509109591748, 1.2382075471698113, 1.0275020123423666, 1.1666666666666667, 1.4854368932038835, 1.0845380407484864, 1.0024366471734893, 1.0396825396825398, 2.0, 1.25, 1.0338218714768883, 1.2419354838709677, 1.1327800829875518, 1.1842105263157894, 1.0, 1.1440932850824286, 1.1087608760876089, 1.1307615230460921, 1.0694795415677565, 1.1351301115241637, 1.080939947780679, 1.0738974970202622, 1.2242424242424241, 1.1159420289855073, 1.1176470588235294, 1.3366573593936977, 1.4, 2.0, 1.0911877198374484, 1.147848317000426, 1.0605187319884726, 1.2233433029440381, 1.1176470588235294, 1.018159679488858, 1.0232099846726517, 1.320320275038451, 1.1440704624095628, 1.0614035087719298, 1.2857142857142858, 1.3333333333333333, 1.1050682261208578, 1.0604678030046617, 1.0559957739038563, 1.1704545454545454, 1.0585288220420173, 2.0, 1.111343439623628, 1.1411764705882352, 2.0, 1.051643192488263, 1.125, 1.1504065040650406, 1.021370670596905, 1.0732103416915681, 1.1610169491525424, 1.6666666666666667, 1.1039944903581267, 1.0, 1.3333333333333333, 1.1305596738324686, 1.3076923076923077, 1.119700748129676, 1.000463878243006, 1.0483385751401613, 1.3333333333333333, 1.5, 1.040169133192389, 1.1096629213483147, 1.053473263368316, 1.0041389214417809, 1.2679738562091503, 1.0098792535675083, 1.0749863274524498, 3.0, 1.022348484848485, 1.010566762728146, 1.094994311717861, 1.1250738334317778, 1.5, 1.1966933867735472, 1.0151898734177216, 1.0324786324786326, 1.0795180722891566, 1.0, 1.022794846382557, 1.0741950200494634, 1.1813918506392957, 1.0063492063492063, 1.1071428571428572, 1.3818181818181818, 1.4867256637168142, 1.0, 1.3333333333333333, 1.1087562559457336, 1.0491803278688525, 1.0966494845360826, 1.1765421618562535, 1.0456286489903686, 1.014809561553544, 1.3087971274685817, 1.0619136960600375, 1.0479728638345986, 1.0677530017152659, 1.0333086602516655, 1.161920260374288, 1.0438871473354232, 1.0119120198846316, 1.2204274547484872, 1.1686746987951808, 2.125, 1.0034103512014787, 1.0714097727870866, 1.2167832167832169, 1.3246268656716418, 1.0436893203883495, 1.6666666666666667, 1.2372881355932204, 1.1217892351355796, 1.1666666666666667, 1.1381048387096775, 1.0735112558774855, 1.0870618480249172, 1.0130561197686552, 1.0876847290640395, 1.0053180186021675, 1.0846965041933072, 1.0203488372093024, 1.1035403092864433, 1.04221635883905, 1.0556390384349918, 1.076163610719323, 1.0095397933044783, 1.2019230769230769, 1.0526315789473684, 1.2048192771084338, 1.0, 1.3897058823529411, 1.1568524933010915, 1.2878338278931751, 1.150943396226415, 1.0219917012448132, 1.368421052631579, 1.0508948019712419, 1.0360360360360361, 1.1632840591290452, 3.0, 1.015970515970516, 1.0124898180830844, 1.0164428807352623, 1.0004013953266115, 2.25, 1.0816326530612246, 1.1017836849646723, 1.012767897856817, 1.0353260869565217, 1.0729684908789385, 1.0383052814857807, 1.079543961098699, 1.396694214876033, 1.007946566032068, 1.0795283550301338, 1.039755351681957, 1.1072340425531915, 1.034675615212528, 2.0, 1.1371911573472042, 2.0, 1.2553776888444221, 1.0392038038411338, 1.1252208047105006, 1.0570469798657718, 1.0769230769230769, 2.0, 1.0940761946707773, 1.0289855072463767, 1.0886186685329367, 2.0, 1.023356401384083, 1.0354906054279749, 1.25, 1.0056465140454083, 1.006993006993007, 1.119724375538329, 1.076837416481069, 1.0073170731707317, 1.1034900434438542, 1.0, 2.0, 1.0608393344921778, 1.0959783498017497, 1.1484257871064467, 1.0630762272553318, 1.1360358417786722, 1.0335045001833931, 1.0935633709356336, 1.0925871494915056, 1.0270541082164328, 1.0520846069201615, 1.1476659629368988, 1.2307692307692308, 1.0156624548003088, 1.1595092024539877, 1.105263157894737, 1.5, 1.0328373524884555, 1.18006993006993, 1.0327147180729734, 1.0077216030187623, 1.1009174311926606, 1.3877118644067796, 1.0107650639879713, 1.0253521126760563, 1.0854777148485595, 1.0502720479435217, 1.2, 1.0437158469945356, 1.047016274864376, 1.0409356029044161, 1.10651467742073, 1.0915503386567524, 1.1757543673901536, 1.1675946547884186, 1.0588736595412258, 1.0570582831479025, 1.1593065627593173, 1.0452388137499657, 1.0054446460980035, 1.3928571428571428, 1.0714285714285714, 1.0889926215931336, 1.0, 1.0216998191681737, 1.0030253188448783, 1.084387496939525, 1.5454545454545454, 1.0512820512820513, 1.1558956916099774, 1.0081838760229844, 1.0143327732210892, 1.0416666666666667, 1.1329047340736411, 1.017274811093194, 1.0120481927710843, 1.3636363636363635, 3.125, 1.0008580008580008, 1.25, 1.001436391783839, 1.0461783439490446, 1.368421052631579, 1.1129630263413075, 1.1923076923076923, 1.6666666666666667, 1.0190568748415447, 2.0, 1.1420612813370474, 1.0537240537240538, 1.088453747467927, 1.1103526734926052, 1.253968253968254, 1.2, 1.1044764324019192, 1.11288598414116, 1.75, 1.0010322809991934, 1.003274279366193, 3.0, 1.0, 1.0665385493568764, 1.5, 1.070297951582868, 1.2272727272727273, 1.5, 1.3157894736842106, 1.3184498736310026, 1.06796875, 1.1627906976744187, 1.035143769968051, 1.2625, 1.5, 1.0953838554685746, 2.0, 1.0714285714285714, 1.0136213565679457, 1.078125, 1.0242976461655278, 1.0205032618825722, 1.1666666666666667, 1.0, 1.176939811457578, 1.127659574468085, 1.0495867768595042, 1.126895366359013, 1.2359871031746033, 1.0176767676767677, 2.0, 1.0290590526766297, 1.2575757575757576, 1.96, 2.0, 1.0392156862745099, 1.2857142857142858, 1.1183932346723044, 1.2765957446808511, 1.1839727707285332, 1.088335344313771, 1.088862559241706, 1.0861806311207836, 1.1183463928667927, 1.1515151515151516, 1.1251885369532428, 1.169017823284035, 1.0551053484602917, 1.054054054054054, 1.0025982109596405, 1.0509933900984818, 1.0101298701298702, 1.0346534653465347, 1.0238095238095237, 1.118712273641851, 3.0, 1.0625, 1.35, 1.219607843137255, 1.1111111111111112, 1.0353053435114503, 1.0711610486891385, 1.2857142857142858, 1.0117429055484963, 1.095948012232416, 1.026389264162839, 1.076086956521739, 1.3238095238095238, 1.0765306122448979, 1.0, 1.0863899466869764, 1.5961538461538463, 1.1088214164177412, 1.0235271572088773, 1.0501221464072108, 1.147427352705945, 2.0, 1.0389610389610389, 1.2857142857142858, 1.2631818181818182, 1.0909090909090908, 1.0655205367242657, 1.0, 1.09414712725971, 1.1196013289036544, 1.1448170731707317, 4.0, 1.304113924050633, 1.0114922839348353, 1.1386045620088174, 2.0, 1.1285714285714286, 1.3178861788617886, 1.3896103896103895, 1.080739070440548, 1.135983679968156, 1.0416666666666667, 1.1661870503597123, 1.012394743055009, 1.0646264121027944, 1.047721119133574, 1.0673397248429672, 1.2128353879622915, 1.021978021978022, 1.0053981106612686, 1.0886703454077493, 1.2300884955752212, 1.144927536231884, 1.0, 1.3333333333333333, 1.2044415414761593, 1.0688259109311742, 1.0692500897021888, 1.1015117244538608, 1.090486039296794, 1.0, 1.075, 1.064516129032258, 1.164782391195598, 1.125, 1.0, 1.113038241493526, 1.3333333333333333, 1.0, 1.0053050397877985, 2.3333333333333335, 1.0158473479948253, 1.012112036336109, 1.0142045454545454, 1.0, 1.0742749212392189, 1.0875106202209006, 1.6, 1.0875050875050876, 1.069767441860465, 1.1341330425299891, 1.060461956521739, 1.3748680042238648, 1.0721691608355892, 1.0, 1.036144578313253, 1.134815278647464, 1.109264853977845, 1.0429252782193958, 1.0, 1.1361198446458294, 1.021636246252161, 1.038580931263858, 2.0, 1.0452579034941765, 1.025476362759286, 1.1029939796441781, 1.037926628946888, 1.0123363073955503, 1.0264829541096065, 1.0177935943060499, 1.2888397790055248, 3.0, 1.0698474102729423, 1.18005540166205, 1.0417874396135265, 1.031301482701812, 1.0274725274725274, 1.0084208406256077, 1.0319817247287264, 1.0652127142481493, 1.1990144048521607, 1.06963014934349, 1.0861904761904762, 1.0845702881377073, 1.1104340630406981, 1.0481927710843373, 1.1219512195121952, 1.078438704116812, 1.0578158458244111, 1.011744523621008, 1.0708527917253972, 1.0, 1.0879577198942998, 1.34, 2.0, 1.0392156862745099, 1.009216739416165, 1.1578947368421053, 1.1191849288735103, 2.0, 1.1025641025641026, 1.0033952014486194, 1.1455114680460083, 1.0345911949685536, 1.0392066715196098, 1.1027131782945736, 1.1758691206543967, 1.024949083503055, 1.019227889424661, 1.483695652173913, 1.021333975813722, 1.0496974935177181, 1.1082474226804124, 1.1117177097203728, 1.0857740585774058, 1.0014740188161706, 2.0, 1.1498618784530388, 1.041522491349481, 1.01709232554583, 1.1286681715575622, 1.1631130063965884, 1.0050167224080269, 1.063265306122449, 1.0951622514762447, 1.0, 1.6071428571428572, 1.1666666666666667, 1.3333333333333333, 1.2115384615384615, 1.066147859922179, 1.0639686684073106, 1.0923694779116466, 1.0689886135298057, 1.0434782608695652, 1.0743136563606541, 1.1744286954006364, 1.0730101735487731, 1.073647530755793, 1.007650852320457, 1.1012101210121013, 1.1170717249555424, 1.0470144453257224, 1.090508806262231, 1.087051142546246, 1.1432129514321294, 1.0670391061452513, 1.0219430688086324, 1.161520190023753, 1.1010099021595763, 1.2954545454545454, 1.2245437079731027, 1.098939929328622, 1.0, 1.0368171021377672, 1.0588235294117647, 1.0, 1.519650655021834, 1.0579753679783719, 1.0451099317664898, 1.0075757575757576, 1.0209424083769634, 1.0431823664597062, 1.0574317057431706, 1.0687732342007434, 1.4, 2.0, 1.0437039517749498, 1.1801801801801801, 1.134, 1.1137922876744737, 1.0, 1.1544671689989237, 1.1506276150627615, 1.047966225541934, 1.1280487804878048, 1.0281784949654547, 1.382153846153846, 1.0066807635307677, 1.5, 3.0, 1.13876272513704, 2.0, 1.0738095238095238, 1.240343347639485, 1.3508522727272727, 1.2216726618705036, 1.4615384615384615, 1.0368443866493282, 1.0533333333333332, 1.0825082508250825, 1.0237487542234862, 1.1972833117723156, 1.0971867007672633, 1.008934511928524, 1.0163487738419619, 1.0694444444444444, 1.2, 1.0167482707701874, 1.085904012367367, 1.05, 1.0186721991701244, 1.233644859813084, 1.0222222222222221, 1.0317162157280642, 1.375, 1.1925795053003534, 1.0016689573924995, 1.5626535626535627, 1.03954802259887, 1.0778633517993064, 1.0451127819548873, 1.875, 1.075221238938053, 1.0020366598778003, 1.144612985540119, 1.1354365838113447, 1.0145750038443795, 1.04084569404472, 1.1761102603369067, 1.0734652801073465, 1.3114285714285714, 1.0767382737384685, 1.023100616016427, 1.0233785822021115, 1.0198763250883391, 1.0079741379310345, 1.128654970760234, 1.0538436587739215, 1.2272727272727273, 1.6, 1.1275, 1.6324610408703322, 1.049752781211372, 1.043820224719101, 1.0, 1.007171314741036, 1.0396253602305476, 1.138728323699422, 1.0622634523613625, 2.0, 1.1648221343873517, 3.0, 1.0218253968253967, 1.0, 1.0215440898928603, 1.3666666666666667, 1.2107142857142856, 1.0469441984056687, 1.0, 1.8970588235294117, 1.29064039408867, 1.5, 1.3333333333333333, 1.1785714285714286, 1.1977715877437325, 1.017059708981435, 1.2110286320254506, 1.0916784203102963, 1.0472473294987674, 1.100250626566416, 1.1047745358090186, 1.1245136186770428, 1.1964912280701754, 1.0294117647058822, 1.0, 1.086128739800544, 1.05115712545676, 1.0139616055846423, 1.0394960235903852, 1.0704333841645892, 1.0802234636871508, 1.07183545867932, 1.1422662359228284, 1.1076233183856503, 1.0090406830738323, 2.0, 1.0, 1.3125, 1.0327344249024482, 1.0768662232076867, 1.121212121212121, 1.0242424242424242, 1.045056, 1.0707916070577015, 1.0355984925839763, 1.1294117647058823, 1.1904761904761905, 1.1997041420118344, 1.0602616698081828, 1.1187065259308986, 1.1021626287061912, 1.027027027027027, 1.1138455873327606, 1.0115585663136095, 1.123690786325695, 1.017467248908297, 1.1046167806129632, 1.0548387096774194, 1.0379796397807362, 1.1115027234860622, 1.0224651026076315, 2.5, 1.137188557366964, 1.0, 1.0311890838206628, 1.0269421955195128, 1.0, 1.0595944231522874, 1.0026737967914439, 1.4054054054054055, 1.0283321731722268, 1.0069862972624508, 1.0665307376476831, 1.0063191153238547, 1.0134357005758157, 1.193775128630472, 1.2102473498233215, 1.411764705882353, 1.0, 1.25, 1.0630153597413097, 1.6666666666666667, 1.0844939974772645, 1.0877544135837176, 1.0473167916907098, 1.0699128146076657, 1.0391347515760825, 1.1570764832022873, 1.0116959064327486, 1.0666666666666667, 1.0153282786789042, 1.1505197748944818, 1.0449103420647408, 1.1915427252890571, 1.375, 1.1896551724137931, 1.009933774834437, 1.132521603647013, 1.0714285714285714, 1.279132185193469, 1.025993883792049, 2.229390681003584, 1.0405751951826454, 1.0764044943820226, 1.0714456558569692, 1.3125, 1.0685280930844019, 1.0412998520773793, 1.3147583804962995, 1.0501567398119123, 1.4285714285714286, 1.019559902200489, 1.3081210191082802, 1.0362213527110118, 1.1282051282051282, 1.0168423475935304, 1.2702702702702702, 1.01374865735768, 1.0, 1.047680412371134, 1.0267670430782099, 1.0356472795497185, 1.017509727626459, 1.0619773733398918, 1.000536197226647, 1.0651340996168583, 1.0321539222578042, 1.0710025913354502, 1.0714285714285714, 1.0728051391862956, 1.117540389053742, 1.0330734468888116, 1.1736426692178905, 1.055400111919418, 1.0785083415112855, 1.1160058737151248, 1.0500658761528328, 1.0461935667491704, 1.205128205128205, 1.1024447031431897, 1.2421035624848533, 1.0403626160155406, 1.056105610561056, 1.0851867127764205, 1.1570103570876489, 1.0828840970350404, 1.1104417670682731, 1.099317204477563, 1.0634720920894123, 1.0584615384615386, 1.0045871559633028, 1.0277945619335347, 1.0799676319051081, 1.0480769230769231, 1.6, 1.0652130040729462, 1.1696012952843553, 1.0144857556735876, 1.0, 1.2773857011353176, 1.0195466268494637, 1.157112526539278, 1.205, 1.0, 1.0005633802816902, 1.013157894736842, 1.1613756613756614, 1.411764705882353, 1.0829777719811444, 1.1838602329450916, 1.0112676056338028, 1.1041666666666667, 1.0112359550561798, 1.1659267480577136, 1.0388349514563107, 1.1538461538461537, 1.0383900928792569, 1.048582995951417, 1.00280767430978, 1.0769230769230769, 1.0086677166668405, 1.0845969672785316, 1.0263157894736843, 1.2719298245614035, 1.0, 1.3632130384167638, 1.014828814421749, 1.0290803294586879, 1.1490312965722802, 1.4754098360655739, 1.3529411764705883, 1.1111111111111112, 1.0666666666666667, 1.103896103896104, 1.1522277227722773, 1.0281160317370999, 1.033950521816056, 1.4051724137931034, 1.0477143182854538, 1.0469267543823055, 3.0, 1.1213060686015832, 1.1570091853377973, 2.5, 2.25, 1.209151952250684, 1.089647299164814, 1.0737570356472796, 1.1550387596899225, 1.0, 1.1484098939929328, 1.258974358974359, 1.5, 1.0846694646080723, 1.107704608428337, 1.0252369593561208, 1.047907949790795, 1.7142857142857142, 1.03207226784155, 1.055158987670344, 1.0017391304347827, 1.0368271954674222, 1.005973715651135, 1.0, 1.174055829228243, 1.1567905778432095, 1.0090529135535509, 1.3243243243243243, 1.0924092409240924, 1.0972877507253689, 1.0864864864864865, 1.0551724137931036, 1.2941176470588236, 1.027693127622067, 1.6010413276928084, 1.0362414439218386, 1.4134615384615385, 1.2695652173913043, 1.0317297850562948, 1.125, 1.1022125272670613, 1.0149625935162094, 1.0082405592336428, 1.0177304964539007, 2.0, 1.072203516647961, 1.0262429276513783, 1.2098360655737705, 1.0799475753604193, 1.021005764114691, 1.0331375838926173, 1.1154839851353742, 1.0155339805825243, 1.0333333333333334, 1.079945269741986, 1.0878296076446672, 1.2349726775956285, 1.404426559356137, 1.6666666666666667, 1.011764705882353, 1.2014308746473197, 1.0388198757763976, 1.001494535199553, 1.113918867538241, 1.030321046373365, 2.0, 1.0912906610703044, 1.0200570110458902, 1.1849952516619184, 1.0131147540983607, 1.0688670058428396, 1.023936170212766, 1.1549421193232414, 1.0038722168441432, 1.0329278625030258, 1.1107568802934566, 1.0095602294455066, 1.0700564971751412, 1.027027027027027, 1.2090240984447103, 1.1479215686274509, 1.0269770346881906, 1.083626198083067, 1.1160020714655619, 1.0336507936507937, 1.0, 1.2538975501113585, 1.6666666666666667, 1.6666666666666667, 1.15, 1.0453563714902807, 1.0574866310160427, 1.0252151737328659, 1.0053597137684775, 1.0042486583184258, 1.0158227848101267, 1.1843317972350231, 1.0027598896044159, 1.072713148410988, 2.0, 1.5714285714285714, 1.1811757147446194, 1.0, 1.0022446689113356, 1.1826758147512864, 1.043039677202421, 1.0990451441757856, 2.0, 1.0786430223592907, 1.0159362549800797, 1.1421399912529235, 1.0408967848511732, 1.153765690376569, 1.139386928860613, 1.1760096328434089, 1.1422320601256049, 1.0429362880886426, 1.3333333333333333, 1.0748538011695907, 1.3333333333333333, 2.0, 1.0421991405880227, 5.0, 1.2, 2.21875, 1.116647791619479, 1.0641806642367395, 1.1079295154185023, 1.0857142857142856, 1.1428571428571428, 1.0729385186380507, 1.0023889154323937, 1.0262390670553936, 1.2788461538461537]
origin-bjaq_15.71 	max: 5.0000	99th: 3.0000	95th: 1.9620	median: 1.0813	mean: 1.1833

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.151462 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.174136