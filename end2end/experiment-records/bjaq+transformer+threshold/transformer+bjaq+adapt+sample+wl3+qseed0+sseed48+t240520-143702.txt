Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 48, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.5025	95th: 1.6961	median: 1.0819	mean: 1.1731
ReportEsts: [1.0294117647058822, 1.00546875, 1.040420699333073, 1.04, 1.5789473684210527, 1.0, 1.0330183671302686, 1.060615977083452, 1.0, 1.0116883116883117, 1.1095431852942026, 1.043051822724075, 1.035667681600696, 1.1, 1.0826563051925115, 1.0, 1.0714285714285714, 1.0446333687566418, 3.0, 2.0, 1.173913043478261, 1.0864573570759137, 1.1160927468562636, 1.1368173810921902, 1.0966946225949679, 1.0, 1.1836591404604413, 1.5, 1.2, 1.0359712230215827, 1.0, 1.0496183544865536, 1.0052840362740278, 1.097669256381798, 1.171097077397562, 1.2394898044809934, 1.1443850267379678, 1.0077669237696254, 1.1080652937530133, 1.1904761904761905, 1.1063829787234043, 1.0121951219512195, 1.0, 1.0481737759481475, 1.1143004468889652, 1.8615384615384616, 1.0198019801980198, 1.197879858657244, 1.0287375482821712, 1.1944444444444444, 1.0812408835173994, 1.1855670103092784, 1.0373121004236967, 2.0, 1.1688311688311688, 1.1000619792025343, 1.1515912897822445, 1.3658536585365855, 1.087837837837838, 1.0, 1.0998500545256271, 1.1008717310087173, 1.1681818181818182, 1.0235294117647058, 1.0909090909090908, 1.076175221634508, 1.3216601815823605, 1.75, 1.0, 1.1074857835368697, 1.025703794369645, 1.0658508158508158, 1.0325581395348837, 1.138987501823664, 1.08, 1.1320754716981132, 1.0, 1.1085594989561587, 2.0, 1.0433584894831989, 1.032258064516129, 1.0254810470666296, 1.2024539877300613, 1.0792079207920793, 1.1089303238469088, 1.0, 1.07606962788226, 1.022683812984033, 1.0686274509803921, 1.75, 1.1810526315789474, 1.043820693955097, 1.0934579439252337, 1.0154277699859748, 1.0073059360730594, 1.0207792207792208, 1.0305343511450382, 1.1467710371819961, 1.0, 1.2272229522558038, 1.0375809935205185, 1.0917667238421955, 1.225629270824323, 1.3076923076923077, 1.0185932948499998, 1.0618529333687283, 1.1252598032423444, 1.111869548729617, 1.0545677498467199, 1.3333333333333333, 2.0, 1.0357476635514018, 1.0824496479087495, 1.04358812381554, 1.1688311688311688, 1.062510646620526, 1.0, 1.217912330495112, 1.1807909604519775, 1.0, 1.0055248618784531, 1.1666666666666667, 1.2030075187969924, 1.022673651519064, 1.102974295255106, 1.087378640776699, 1.8, 1.189569536423841, 1.0, 1.12, 1.1032194742922574, 1.1818181818181819, 1.09228515625, 1.0238150564916755, 1.0916552667578658, 1.1134846461949266, 1.0465753424657533, 1.0027279812938426, 1.039972432804962, 1.0725167580743449, 1.016038803824193, 1.2366412213740459, 1.0189171559034573, 1.1185089630161493, 2.0, 1.023701002734731, 1.0365714285714285, 1.0818791946308726, 1.0986412563966825, 1.5, 1.1748607410995398, 1.0180995475113122, 1.0060362173038229, 1.1074561403508771, 1.289051094890511, 1.0917060013486177, 1.1490747504261019, 1.0013076021282352, 1.0541082164328657, 1.1019736842105263, 1.2857142857142858, 1.4526315789473685, 1.0220913107511045, 1.4285714285714286, 1.0582421227197347, 1.0322686410113688, 1.2045769764216365, 1.389798551156098, 1.1313061506565307, 1.0994672815456785, 1.2378947368421052, 1.1018518518518519, 1.1009973854943353, 1.0525783619817999, 1.0155306298533218, 1.0602526724975705, 1.054278416347382, 1.100865782402866, 1.0930093575528819, 1.0, 1.0161290322580645, 1.0664690939881456, 1.0283094098883572, 1.180349344978166, 1.2105263157894737, 1.090161509061768, 1.286565443013646, 1.1328052290976776, 1.1372549019607843, 1.085909090909091, 1.0594316815083886, 1.0, 1.3636363636363635, 1.0399096081675476, 1.0280046674445742, 1.003701989819528, 1.5217391304347827, 1.072025723472669, 1.0547999403957518, 1.0481504278002, 1.0626410835214446, 1.0245599241066723, 1.92090395480226, 1.103448275862069, 1.1506849315068493, 1.0, 1.4035087719298245, 1.0608736792304052, 1.3554006968641115, 1.2758620689655173, 1.0168067226890756, 1.0031277926720286, 1.0406682356297248, 1.0386194650982132, 1.189508652657602, 1.0057142857142858, 1.0679190751445087, 1.01749837977965, 1.0462548107300822, 1.0032427211259831, 1.0, 1.1134575569358178, 1.0768321745809781, 1.0160985229605184, 1.1482843137254901, 1.0046338717700343, 1.2767428046870781, 1.0357142857142858, 1.0052074994733515, 1.112944816915936, 1.0137221269296741, 1.1162790697674418, 1.1552839683680804, 1.001934235976789, 1.221259842519685, 2.0, 1.218543046357616, 1.0731911567664136, 1.1047819971870605, 1.1074380165289257, 1.0, 1.6666666666666667, 1.1135752097219536, 1.1090909090909091, 1.1837928153717627, 1.5, 1.0, 1.0256410256410255, 1.0523028883684622, 1.1326530612244898, 1.022099447513812, 1.1371308016877637, 1.0559322033898304, 1.0050377833753148, 1.0907647935580032, 1.0, 2.0, 1.084387144531491, 1.0576964946657958, 1.0875656742556918, 1.031458881366165, 1.1869649101651996, 1.0498837709857942, 1.0763116057233704, 1.0507895709733641, 1.0167464114832536, 1.0811674774148714, 1.0861678004535147, 1.2727272727272727, 1.0351525099165642, 1.0707762557077625, 1.2045454545454546, 1.3157894736842106, 1.0204081632653061, 1.1111111111111112, 1.0353982300884956, 1.0817172464840858, 1.1448467966573816, 1.368421052631579, 1.0091412726108437, 1.017933390264731, 1.0232073214418482, 1.0557541060745255, 1.25, 1.0200618406693343, 2.5, 1.038336530964458, 1.0021645021645023, 1.043639342770015, 1.0810810810810811, 1.4285714285714286, 1.434782608695652, 1.0923076923076922, 1.0672767008865167, 1.0, 1.0123839009287925, 1.0746606334841629, 1.0064102564102564, 1.0161876771525487, 1.1183431952662721, 1.150943396226415, 1.0036475906935716, 1.1936377144400918, 1.0968506009299062, 1.0769230769230769, 1.0, 1.1420047732696896, 1.2727272727272727, 1.1145833333333333, 1.0697556866048863, 1.0137614678899083, 1.0441176470588236, 1.4047619047619047, 1.0181564245810055, 1.0575716234652115, 1.2857142857142858, 1.0029763731205892, 1.0360531309297913, 1.0555555555555556, 1.1428415061295971, 1.0476190476190477, 1.4, 1.0159048162471735, 2.0, 1.186556927297668, 1.0392441860465116, 1.110746513535685, 1.1227176220806794, 1.0638888888888889, 1.1666666666666667, 1.1001501643691067, 1.09101531121443, 1.0308988764044944, 1.019400839226307, 1.0391844997108155, 2.0, 1.0, 1.0483671930345757, 1.25, 1.068561872909699, 1.3529411764705883, 1.0, 1.375, 1.3242971887550201, 1.0669180018850142, 1.2772277227722773, 1.04004329004329, 1.0, 1.1158455392809588, 1.0893999073993303, 2.0, 1.1363907087552114, 1.0, 1.0922492978061187, 1.0113636363636365, 1.002921129503408, 1.1382488479262673, 1.1363636363636365, 1.3191011235955057, 1.3333333333333333, 1.0239622179879744, 1.0221945674754047, 1.0899854862119014, 1.0, 1.0769230769230769, 1.5714285714285714, 1.5, 1.2307692307692308, 1.0682576551761942, 1.3333333333333333, 1.003338898163606, 1.2023809523809523, 1.092124197476201, 1.0831218882698126, 1.2605561277033985, 1.0160345723326878, 1.0133410672853829, 1.0345238095238096, 1.5, 1.2403100775193798, 1.123404255319149, 1.0542292244135916, 1.0476190476190477, 1.5714285714285714, 1.0227790432801822, 1.0324129651860745, 1.0311566771819138, 1.0024509803921569, 1.1464387464387464, 1.0051983584131328, 1.0810810810810811, 1.0907770515613653, 1.0508474576271187, 1.1346153846153846, 1.0269121813031161, 1.0423728813559323, 1.0740025534631343, 1.0697011724668422, 1.0384545399405591, 1.0232558139534884, 1.162162162162162, 1.1049382716049383, 1.0, 1.0022351700236074, 1.049055488378342, 1.0734251349192905, 1.0559635425950353, 1.0911936560934892, 1.1582459485224024, 1.8333333333333333, 1.1523068371317398, 1.2, 1.2220324508966696, 1.25, 1.0258202225900475, 1.027536231884058, 1.0727644024075667, 1.0909090909090908, 1.0997352162400706, 3.0, 1.1537681649205813, 1.0131599970502925, 1.1554395806510944, 2.0, 1.0476190476190477, 1.2495201535508638, 1.3181818181818181, 1.0808064516129032, 1.1413721413721414, 1.2352941176470589, 1.2364106988783434, 1.0014256666744572, 1.1022834807652746, 1.0957491947771414, 1.0737938596491228, 1.086235489220564, 1.0075757575757576, 2.142857142857143, 1.053475935828877, 1.4444444444444444, 1.2319327731092438, 1.0909090909090908, 1.116739150987993, 1.4705882352941178, 1.132842952345027, 1.1122205227792195, 1.0579888957433683, 1.0, 1.163265306122449, 1.08, 1.2861718632701067, 1.2297592997811817, 1.0, 1.0253576993908486, 1.0965319594268235, 1.004973062577704, 1.5, 2.0, 1.0011650485436894, 1.0182481751824817, 1.0065573770491802, 1.1111111111111112, 1.0715251331984414, 1.0850409836065573, 1.4705882352941178, 1.0614689265536723, 1.0454545454545454, 1.1167979002624673, 1.032258064516129, 1.2132940681531341, 1.0436736161035227, 1.0, 1.0136986301369864, 1.1177970142684224, 1.0490907026167648, 1.0150886519075557, 1.0, 1.128732581287326, 1.0148965580643996, 1.0214772132006287, 2.0, 1.032695374800638, 1.0478386877967565, 1.032368852957267, 1.0193525839849722, 1.0192342635803209, 1.024212271973466, 1.0016835016835017, 1.070877531340405, 2.0, 1.0791772184609023, 1.510204081632653, 1.25, 1.160621761658031, 1.1153846153846154, 1.0139324175640982, 1.0008503401360545, 1.07378098897108, 1.1776044056906838, 1.0240625395765452, 1.0957662653861762, 1.0693794283204456, 1.2560975609756098, 4.0, 1.0186868323130476, 1.204655870445344, 1.046405925925926, 1.050306442485685, 1.0953830542871639, 1.1790030211480362, 2.223404255319149, 2.2857142857142856, 1.0070612465061541, 1.0485554800396644, 1.007448512159696, 1.1067150635208711, 1.1184197840339376, 1.0589519650655022, 1.0689522741898654, 1.0199568500539373, 1.215170278637771, 3.0, 1.0833333333333333, 1.0153374233128833, 1.0580524344569289, 1.0719424460431655, 1.0319018404907976, 1.0529411764705883, 1.0815217391304348, 1.148905109489051, 1.0459770114942528, 1.0921246155903195, 1.202127659574468, 1.0638713949155414, 2.0, 1.1826677994902295, 1.0327868852459017, 1.3055555555555556, 1.0932960893854748, 1.2154255319148937, 1.069767441860465, 1.0959792477302206, 1.0202662596455525, 1.0, 1.1702127659574468, 1.2, 1.0, 1.0568181818181819, 1.1955645161290323, 1.0236966824644549, 1.087378640776699, 1.0671259211791093, 1.074245939675174, 1.09005022498553, 1.1611425954548056, 1.0434782608695652, 1.1442215960774744, 1.0432432432432432, 1.1442112389979688, 1.0401548137397194, 1.0895844576362654, 1.2658959537572254, 1.1512422360248447, 1.0416561090558962, 1.3392269736842106, 1.0815088460585174, 2.0, 1.1818181818181819, 1.0896273917421955, 1.3944954128440368, 1.0, 1.186046511627907, 1.25, 1.0721062618595825, 1.3333333333333333, 1.1666666666666667, 1.00620282429896, 1.1311007477687545, 1.0255697250316873, 1.0417518477748073, 1.2540540540540541, 1.1106612685560053, 1.0, 1.1578947368421053, 1.010138630250362, 1.0481313252051956, 1.0847858197932052, 1.0995557580590045, 1.0242839352428394, 1.1636363636363636, 1.1264813843733612, 1.0763765541740675, 1.0162903334304998, 1.1323725973757035, 1.3636363636363635, 1.043613707165109, 1.0, 1.2387640449438202, 1.2071974051568402, 3.0, 1.1844964984303308, 1.0308775369260588, 1.4285714285714286, 1.0370979190794636, 1.3, 1.1176470588235294, 1.0170126334288883, 1.6923076923076923, 1.0285099645891496, 1.0529688167449809, 1.3571428571428572, 1.16, 1.0329896907216496, 1.001916626736943, 1.0611479028697572, 1.046466174894395, 1.1563353421313602, 1.0, 1.0659352596132956, 1.1524390243902438, 2.0, 1.0062897460892168, 1.108642616143265, 1.131504257332072, 1.0175109045178135, 1.0273786456629508, 1.018018018018018, 1.8571428571428572, 1.1018440905280804, 1.0225806451612902, 1.1125006363158163, 1.2152411836238346, 1.0125231234280445, 1.0561166915114448, 1.1391941391941391, 1.110285006195787, 1.2441471571906355, 1.0206749305819758, 1.0599369085173502, 1.0951086956521738, 1.0319783197831978, 1.0469421093205096, 3.0, 1.142754426435783, 1.031847460408632, 1.015561566079307, 1.7272727272727273, 1.3107207332314956, 1.456989247311828, 1.1428571428571428, 1.0661987726599422, 1.0420575865415722, 1.1058951965065502, 1.0588235294117647, 1.3333333333333333, 1.0501650401836968, 1.5, 1.0467289719626167, 1.0, 1.058544414206964, 1.3846153846153846, 1.1265822784810127, 1.050314465408805, 1.0, 1.6944444444444444, 1.2553366174055829, 1.5, 2.0, 1.1666666666666667, 1.1758620689655173, 1.0373111316682084, 1.2093908629441625, 1.1072664359861593, 1.2182890855457227, 1.1014466214978942, 1.0597402597402596, 1.0337552742616034, 1.3101604278074865, 1.0, 1.0, 1.0816104461371054, 1.1414141414141414, 1.0743801652892562, 1.0358446018458898, 1.0898677013102658, 1.0838189152846258, 1.070806035632763, 1.221912955465587, 1.1704225352112676, 1.0275904353157572, 1.5714285714285714, 1.0, 1.2592592592592593, 1.0514760567655763, 1.0661959399823477, 1.107843137254902, 1.2339901477832513, 1.065139366170294, 1.042523814172745, 1.0149884121380146, 1.1142857142857143, 1.2222222222222223, 1.032085561497326, 1.050702545068929, 1.0843723540252022, 1.0399433700328509, 1.0133333333333334, 1.052052569403426, 1.0123178295749231, 1.2887788778877889, 1.3508146639511203, 1.125, 1.0773346303501945, 1.1607843137254903, 1.2093023255813953, 1.066860465116279, 1.0701001430615165, 1.0, 1.0977443609022557, 1.0089746100124013, 1.0188679245283019, 1.0847005628129502, 1.005324813631523, 1.1944444444444444, 1.0246800163871337, 1.0229632299927902, 1.0796065001343003, 1.0419847328244274, 1.0056753688989784, 1.203350174629548, 1.25, 1.2142857142857142, 1.0, 1.4285714285714286, 1.0761051229260021, 1.3333333333333333, 1.2747334632580534, 1.1096602229282215, 1.014842711564023, 1.0750744786494537, 1.0536665301106105, 1.0281886387995713, 1.010752688172043, 1.0, 1.0227299410618265, 1.06355455568054, 1.0430541389172217, 1.1875828013970855, 1.6666666666666667, 1.109375, 1.0201612903225807, 1.1026552046864708, 1.009771986970684, 1.300877674163467, 1.0254083484573502, 2.25, 1.0389092951247647, 1.0469798657718121, 1.0556937799043062, 1.1875, 1.068058268420681, 1.043738931363656, 1.2345498783454987, 1.0581052631578947, 1.1428571428571428, 1.1559405940594059, 1.1292134831460674, 1.5, 1.0513675547199262, 1.6923076923076923, 1.0141129032258065, 1.0532407407407407, 1.0255878284923927, 1.0346689895470382, 1.0047281323877069, 2.75, 1.0769230769230769, 1.0956285157542556, 1.060914495249736, 1.0053107042130756, 1.0055797160909166, 1.0632603194754828, 1.0, 1.0810580204778157, 1.0412937347436941, 1.0370105808295014, 1.0070140280561122, 1.0138888888888888, 1.2696122633002704, 1.0460120104880317, 1.3566502463054186, 1.0575698865208967, 1.0, 1.3333333333333333, 1.0539939182674478, 1.0187786697247707, 1.2424719637318062, 1.1523862477990918, 1.0518754988028731, 1.0514018691588785, 1.0989837458477492, 1.0672160700489313, 1.1213235294117647, 1.088235294117647, 1.037037037037037, 1.0707922250036814, 1.1071428571428572, 1.75, 1.0459264225620175, 1.1719102399766352, 1.0156340474811811, 1.0170454545454546, 1.1962346125995655, 1.0040329590098391, 1.1535001405678942, 1.2195121951219512, 1.3461538461538463, 1.0640161725067385, 1.082004555808656, 1.15, 1.4333333333333333, 1.0068722762319813, 1.2081268582755202, 1.165837479270315, 1.024390243902439, 1.0087471160597854, 1.0088359585094122, 1.0666331994645248, 1.228064963359081, 1.3333333333333333, 1.3333333333333333, 1.3333333333333333, 1.1490769766631836, 1.2692307692307692, 1.0, 1.1538461538461537, 1.0966887417218543, 1.036231884057971, 1.0645675641002144, 1.015394317685678, 1.2854545454545454, 1.2830188679245282, 1.1428571428571428, 1.0689655172413792, 1.0810810810810811, 1.042857142857143, 1.1526032315978456, 1.0297508493006355, 1.0316574524136395, 1.3333333333333333, 1.0597922351476854, 1.0477553675992193, 2.5, 1.066032118675785, 1.3539651837524178, 3.0, 2.0, 1.1538461538461537, 1.117263142795668, 1.0763068167252032, 1.1770186335403727, 1.0, 1.425414364640884, 1.2546012269938651, 3.0, 2.0, 1.0108267716535433, 1.2347089662589057, 1.0601024615769086, 1.6666666666666667, 1.0170474812396944, 1.0441518202943454, 1.0198744769874477, 1.0, 1.0757575757575757, 1.0232860503831707, 1.3421052631578947, 1.1681887366818873, 1.04381218362716, 1.2801204819277108, 1.0703125, 1.0853153543719074, 1.121647509578544, 1.0495867768595042, 1.1311475409836065, 1.0163969388006202, 1.2817055964884778, 1.0837396421280172, 1.346774193548387, 1.1568627450980393, 1.208955223880597, 1.1031636863823935, 1.05243561898852, 1.0146443726516847, 1.0388886759915692, 1.0054884742041712, 1.5, 1.6666666666666667, 1.1364188454899955, 1.121372031662269, 1.078583933086948, 1.0178630600999006, 1.0469978257233652, 1.1135103094965917, 1.075609756097561, 1.0208333333333333, 1.0999921389827845, 1.0762055433420312, 1.1908771929824562, 1.0542907180385288, 2.5, 1.0869565217391304, 1.0810628594090819, 1.1615320566194838, 1.0405811216622027, 1.0914224808533681, 1.0113636363636365, 2.0, 1.098844672657253, 1.0579375357297025, 1.1814027872972355, 1.0988593155893536, 1.0711927239784484, 1.0828025477707006, 1.2317880794701987, 1.0075934579439252, 1.0320620992237597, 1.0657883660240761, 1.054147465437788, 1.0742778541953233, 1.0, 1.1996719967199672, 1.0532041320047536, 1.0145310435931307, 1.0413226915128055, 1.1287688442211055, 1.0355521936459908, 1.2, 1.2170542635658914, 1.6666666666666667, 2.0, 1.1764705882352942, 1.0103359173126616, 1.0734597156398105, 1.0495771134583154, 1.00393054189299, 1.0176746755040045, 1.079981924988703, 1.190217391304348, 1.2244897959183674, 1.044192849176119, 1.6, 1.5, 1.1053199137311287, 1.1428571428571428, 1.022636484687084, 1.1397795591182365, 1.0183866606579541, 1.0942932268588401, 2.0, 1.0863777089783282, 1.199612403100775, 1.0817372538440788, 1.0404460673229539, 1.1388888888888888, 1.1123287671232878, 1.1461699848227838, 1.150978449343572, 1.0080128205128205, 1.1833333333333333, 1.074022346368715, 1.0, 1.0, 1.0417679982833232, 5.0, 1.4285714285714286, 1.8620689655172413, 1.0072904009720534, 1.0930232558139534, 1.1175166297117516, 1.0717928599450766, 1.1666666666666667, 1.091247672253259, 1.026285046728972, 1.1925133689839573, 1.3197115384615385, 1.4285714285714286, 1.0073480293921175, 1.1175166297117516, 1.1495535714285714, 1.043882484194868, 1.033672238612482, 1.1095754201053993, 1.144927536231884, 1.0, 1.1931294157464991, 1.0473752234291214, 1.006361954609033, 1.1774193548387097, 1.0683883554962263]
origin-bjaq_15.71 	max: 5.0000	99th: 2.5025	95th: 1.6961	median: 1.0819	mean: 1.1731

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 13.975944 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[3.7550926e-06 6.5565109e-07 1.4901161e-06 2.2053719e-06 5.9604645e-08]
Distance score: 1.6331672441083356e-06
SAUCE Drift detection: False
Detection latency: 0.0230s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.022923 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 6.0000	99th: 2.5017	95th: 1.8345	median: 1.0827	mean: 1.1894
ReportEsts: [1.005420054200542, 1.0013006720138737, 1.0238899002929722, 1.1512455516014235, 1.44, 1.0, 1.030829621135271, 1.0174954413286679, 1.0, 1.0, 1.123070996942485, 1.04274725357355, 1.0711665443873808, 1.1516966067864272, 1.0480234260614933, 1.6666666666666667, 1.1639871382636655, 1.05, 1.0833333333333333, 1.0149501661129567, 1.084804469273743, 1.0423164973529833, 1.5714285714285714, 1.0151642796967144, 1.0048086070606956, 1.0423630526171257, 2.0, 1.1865478319866773, 1.2, 1.4, 1.013665660438933, 1.0, 1.0425750069825217, 1.0110344721523756, 1.0079402148528724, 1.0319961216822204, 1.2324698837128334, 1.1466083150984683, 1.4285714285714286, 1.2185548617305977, 1.0244172118308301, 1.037204325511808, 1.2403846153846154, 1.0025661340419416, 1.053903345724907, 1.0079514609612008, 1.35, 1.1102941176470589, 1.3617021276595744, 1.0006720430107527, 1.1818181818181819, 1.330232558139535, 1.0893617021276596, 1.03125, 1.0336124076955373, 1.0358855700462768, 1.0672007120605251, 1.0827250608272505, 1.0416666666666667, 1.0811050605576942, 1.3709677419354838, 1.1017214263735513, 1.0581222056631894, 1.2727272727272727, 1.0404040404040404, 2.0, 1.0716364311807318, 1.2113453815261044, 1.75, 2.0, 1.020094654356428, 1.008955223880597, 1.0775945683802133, 1.0174757281553397, 1.204961227025406, 1.0193050193050193, 1.0004813863928113, 1.1282051282051282, 1.4368932038834952, 1.089841322072319, 1.014016433059449, 1.7142857142857142, 1.0, 2.1666666666666665, 1.0774487471526195, 1.0461538461538462, 1.1826923076923077, 1.0975609756097562, 1.4, 1.071502955925469, 1.114376130198915, 1.1726682255131202, 1.1194825738633465, 1.0051325121313923, 1.0051150895140666, 1.017814726840855, 1.0919540229885059, 1.0785340314136125, 1.1818181818181819, 1.318765036086608, 1.0357142857142858, 2.0, 1.0438589753437284, 1.2557433896835717, 1.1194563662374821, 1.2112520092873726, 1.25, 1.0161254005822844, 1.0449512843224091, 1.1798593143596379, 1.1917545541706616, 1.0549704597996403, 1.2857142857142858, 1.3076923076923077, 1.0581462291306851, 1.0483151336504322, 1.0352149145520455, 1.0505050505050506, 1.0569748707969786, 2.0, 1.1400788436268068, 1.1306306306306306, 1.5, 1.0913461538461537, 1.125, 1.1712473572938689, 1.0276986187527812, 1.1453790238836967, 1.1900826446280992, 1.8333333333333333, 1.1749489448604493, 1.0, 2.0, 1.1129315930759973, 1.0833333333333333, 1.0024777006937562, 1.0149019607843137, 1.1539586144849303, 6.0, 1.4285714285714286, 1.0580645161290323, 1.0553571428571429, 1.0729591836734693, 1.0250531493601234, 1.1823899371069182, 1.0226644555002764, 1.0665088901025548, 3.0, 1.0247807853602744, 1.008490566037736, 1.0917327293318233, 1.1135860746422777, 2.0, 1.2168320842616973, 1.003831417624521, 1.0344234079173837, 1.0609504132231404, 2.0, 1.0025125628140703, 1.1856304907503252, 1.1211993421330073, 1.0679933665008292, 1.0352303523035231, 1.2459016393442623, 1.411764705882353, 1.0477386934673367, 1.3333333333333333, 1.0708897497091734, 1.4916201117318435, 1.0293083235638922, 1.1034419738044472, 1.0306437706567035, 1.0404191616766467, 1.2444444444444445, 1.0964083175803403, 1.0878471378835721, 1.0625, 1.0377777777777777, 1.0662358642972536, 1.0410634377467756, 1.2801393728222996, 1.2205488359994798, 1.191358024691358, 1.4268292682926829, 1.010071125593675, 1.0674563428123502, 1.3136531365313653, 1.2522963870177588, 1.0141843971631206, 3.0, 1.2836676217765044, 1.0469324144636194, 1.173913043478261, 1.14387031408308, 1.0480030311567943, 1.0774819776352387, 1.1087849794547253, 1.0871248789932235, 1.0434028082107736, 1.3333610027392713, 1.0008206811653673, 1.076547842401501, 1.0229206049149338, 1.0577419418588565, 1.0597085096379877, 1.2026788861473388, 1.0229357798165137, 1.0694444444444444, 1.1566265060240963, 1.0, 1.375, 1.127309791543368, 1.278236914600551, 1.4509803921568627, 1.0233236151603498, 1.6666666666666667, 1.0421136944036378, 1.0153846153846153, 1.2533875338753389, 1.3333333333333333, 1.0562659846547315, 1.010043431053203, 1.0138355295441217, 1.0308180063802135, 4.0, 1.0281263522284725, 1.1292337019933938, 1.0142576910195684, 1.0517711171662125, 1.0033277870216306, 1.062206572769953, 1.0758421432792697, 1.2890625, 1.0067272880751843, 1.0260186791276489, 1.098159509202454, 1.014655172413793, 1.084862385321101, 1.1904761904761905, 1.131494547787043, 2.0, 1.177574478067089, 1.0788836082378157, 1.2181961402126822, 1.2758620689655173, 1.0769230769230769, 2.0, 1.1098629093678598, 1.1076923076923078, 1.114867483528605, 1.6, 1.1547619047619047, 1.1493440968718467, 1.2857142857142858, 1.009560515779186, 1.0251141552511416, 1.1616071428571428, 1.0784810126582278, 1.0059274755927476, 1.0767243189121973, 1.0307692307692307, 1.0, 1.1045441299988001, 1.1874189806918196, 1.085383502170767, 1.049467706298048, 1.1225861618488873, 1.0602021195078577, 1.093544137022398, 1.1024234244806947, 1.0148001973359644, 1.033216374269006, 1.1281044241654152, 1.3333333333333333, 1.0252982607445738, 1.1358024691358024, 1.2075471698113207, 1.5714285714285714, 1.1570807153214113, 1.0258152173913044, 1.0102223138508057, 1.0361249138587647, 1.1990740740740742, 1.3636363636363635, 1.0157223872801895, 1.0537190082644627, 1.1782815132485833, 1.0586529904922486, 1.0, 1.0588235294117647, 1.0308758664146187, 1.0492922143579373, 1.0998608575022042, 1.0832397170593384, 1.1443514644351465, 1.1831379117811278, 1.0564298879909257, 1.0052707235265932, 1.1335173458894843, 1.0261858507366035, 1.0073597056117756, 1.7333333333333334, 1.1428571428571428, 1.0720961281708945, 1.5, 1.0659133709981168, 1.0846539050044406, 1.0368346267351622, 1.3333333333333333, 1.043103448275862, 1.3526315789473684, 1.040069384215091, 1.0378141770899432, 1.0416666666666667, 1.2356866877414823, 1.0217360035591116, 1.0469483568075117, 3.0, 3.8333333333333335, 1.024595612674496, 1.25, 1.0111502120473852, 1.0436817472698907, 1.1304347826086956, 1.1394871560992852, 1.4090909090909092, 1.3846153846153846, 1.0085211160936018, 2.0, 1.0125838926174497, 1.0095351609058403, 1.0539595683234535, 1.0728070175438595, 1.1246943765281174, 1.121212121212121, 1.0956372620914516, 1.0840723828851684, 1.1333333333333333, 1.0249548123134695, 1.0984593926329804, 3.0, 1.1, 1.0446164525546058, 1.5, 1.0771375464684014, 1.4210526315789473, 2.0, 1.3333333333333333, 1.3620401337792643, 1.0365758754863814, 1.125925925925926, 1.0594285714285714, 1.3289473684210527, 2.2, 1.0329567984421193, 1.0, 1.2424242424242424, 1.0173302176421126, 1.1214574898785425, 1.027488855869242, 1.001850138760407, 1.75, 1.25, 1.2094744633604737, 1.2651515151515151, 1.0531062124248498, 1.133256578556931, 1.2330669944683466, 1.07035175879397, 2.0, 1.026691691036329, 1.2151898734177216, 1.3571428571428572, 1.0, 1.087962962962963, 1.1428571428571428, 1.1186813186813187, 1.305263157894737, 1.144738434723668, 1.0875341589627303, 1.1840490797546013, 1.1447210394147833, 1.108847184986595, 1.032544378698225, 1.1167664670658684, 1.1091284499251766, 1.0750407830342577, 1.1875, 1.0054534935553934, 1.0348076667867367, 1.1783029001074115, 1.0738916256157636, 1.1, 1.1590909090909092, 2.0, 1.0833333333333333, 1.1451612903225807, 1.2321083172147003, 1.1853932584269662, 1.001043841336117, 1.0695274307441607, 1.130396475770925, 1.0165319493853289, 1.06357516828721, 1.054280187731478, 1.12, 1.238938053097345, 1.1314432989690721, 1.0, 1.074179551355524, 1.5294117647058822, 1.104054410490222, 1.0021346173313321, 1.0139865793516047, 1.1515716568993075, 1.625, 1.103896103896104, 1.1666666666666667, 1.0544280442804428, 1.1666666666666667, 1.0200692746536266, 1.0393794749403342, 1.000896217960208, 1.138157894736842, 1.128440366972477, 4.0, 1.204021289178001, 1.0037603619284923, 1.130208733021257, 2.0, 1.0810810810810811, 1.2707493956486704, 1.3069620253164558, 1.0633567865754963, 1.1247307230599728, 1.0416666666666667, 1.024355300859599, 1.0191798941798942, 1.0479572554896723, 1.03534904840875, 1.0672806246576738, 1.0318646734854446, 1.3636363636363635, 1.0548523206751055, 1.0767366154154354, 1.1092436974789917, 1.0792186652197504, 1.0, 1.5, 1.2495126705653021, 1.1646586345381527, 1.067027027027027, 1.1152921994336222, 1.0580976863753213, 1.0, 1.1965811965811965, 1.0333333333333334, 1.0177162013069676, 1.173913043478261, 2.0, 1.0314007183170857, 1.3333333333333333, 1.0, 1.012619502868069, 2.3333333333333335, 1.009090909090909, 1.0030349013657056, 1.0421348314606742, 1.0909090909090908, 1.0671369532184778, 1.1004329004329005, 1.55, 1.0898890530219694, 1.037593984962406, 1.0772676371780514, 1.0479405806887239, 1.336022448263767, 1.027599076756863, 1.0, 1.0240963855421688, 1.0760114734299517, 1.052109571788413, 1.044338875692795, 1.6, 1.0638023234372118, 1.0119567000164016, 1.007314974182444, 1.0, 1.0462931902046293, 1.0527425506185855, 1.0203065603923973, 1.0125772366641073, 1.0099441692338087, 1.0386182967548747, 1.022415039768619, 1.0416505758615207, 2.6666666666666665, 1.0728308236613884, 1.0263022176379577, 1.063600782778865, 1.062049861495845, 1.0077720207253886, 1.004298938340045, 1.0634266886326194, 1.0408195806425895, 1.0655481857198594, 1.1006556668347864, 1.24, 1.1304965245770946, 1.096948339206718, 1.0, 1.3636363636363635, 1.0750397597308377, 1.046218487394958, 1.0023974497457648, 1.0654283559502344, 1.0, 1.0596278009874667, 1.1930835734870318, 2.0, 1.1428571428571428, 1.0092466846658694, 1.1355311355311355, 1.2434196672983786, 1.0, 1.3846153846153846, 1.010983981693364, 1.1483862190932899, 1.0441286462228871, 1.0211275691813066, 1.1106780982073265, 1.0980810234541578, 1.0102459016393444, 1.0057592543743954, 1.5625, 1.0174639979527107, 1.263157894736842, 1.121212121212121, 1.0800585230627069, 1.1678966789667897, 1.0098668876573265, 2.0, 1.0915584415584416, 1.082142857142857, 1.0669152821850045, 1.1058558558558558, 1.1187817258883248, 1.1029900332225913, 1.3031973539140023, 1.119343389529725, 2.0, 1.2264150943396226, 1.1428571428571428, 1.0, 1.1132075471698113, 1.0657084188911705, 1.0051679586563307, 1.1604938271604939, 1.0598778544875198, 1.204574013571249, 1.024909413645899, 1.1744697299125477, 1.2222087892159825, 1.07694822756299, 1.039318073130065, 1.113270405330372, 1.208974358974359, 1.0482894992084202, 1.1005917159763314, 1.0583864118895967, 1.0705741626794258, 1.5172413793103448, 1.0588806211582011, 1.188095238095238, 1.1013118102195514, 1.3631284916201116, 1.137972262075562, 1.090311986863711, 1.3333333333333333, 1.0140350877192983, 1.1666666666666667, 2.0, 1.271255060728745, 1.0435803981862313, 1.0423440453686201, 1.0205128205128204, 1.1161616161616161, 1.0749937756345578, 1.0322270899597912, 1.137218045112782, 1.0, 1.8, 1.182070707070707, 1.1542056074766356, 1.0099880143827407, 1.1208352885969028, 1.0, 1.3141263940520447, 1.1573275862068966, 1.086997651908036, 1.087797619047619, 1.0114098667290157, 1.0506574394463668, 1.003317451361461, 1.2903225806451613, 2.0, 1.1489685580809406, 1.0, 1.006779661016949, 1.1735537190082646, 1.4536376604850214, 1.0073606729758149, 1.6956521739130435, 1.0359986770804182, 1.1088435374149659, 1.0246913580246915, 1.0971128608923884, 1.3232189973614776, 1.166097060833903, 1.0706390675241158, 1.008108108108108, 1.070138888888889, 1.1666666666666667, 1.0590843078804555, 1.0639084868826632, 1.0952380952380953, 1.0357643758765778, 1.192132985406398, 1.0878453038674034, 1.0157002756812943, 1.2222222222222223, 1.0923344947735192, 1.1314102564102564, 1.204225352112676, 1.1636363636363636, 1.0702284886113547, 1.0300751879699248, 1.8571428571428572, 1.0747185261003072, 1.0020491803278688, 1.083934583934584, 1.2181083810164928, 1.0033370625207065, 1.0249653706149535, 1.231578947368421, 1.100481761871989, 1.224, 1.066476963428515, 1.0733122362869199, 1.0442338072669826, 1.1926444833625218, 1.003165338950143, 1.217142857142857, 1.0122830003275467, 1.0, 1.6, 1.0968137254901962, 1.6171829339567505, 1.061167747914736, 1.391304347826087, 1.0769230769230769, 1.036764705882353, 1.0192857142857144, 1.05625, 1.032777213731032, 2.3333333333333335, 1.0943952802359882, 1.5, 1.0385356454720616, 1.0666666666666667, 1.0237047171494855, 1.4193548387096775, 1.0827586206896551, 1.0352422907488987, 1.0, 1.1576739568990362, 1.3299270072992702, 1.5, 2.5, 1.1398601398601398, 1.149584487534626, 1.078137543484078, 1.2231668437832093, 1.093484419263456, 1.2444444444444445, 1.0685279187817258, 1.0686936936936937, 1.173913043478261, 1.3905723905723906, 1.0689655172413792, 1.0, 1.128060263653484, 1.117930204572804, 1.0130208333333333, 1.1021710150447535, 1.0806386344406431, 1.0449349056943993, 1.064338973418089, 1.0981641403466393, 1.2156626506024097, 1.0079840319361277, 1.7142857142857142, 1.0, 1.2941176470588236, 1.0183784262050573, 1.0530523255813953, 1.1337047353760445, 1.0457380457380456, 1.0177933673469388, 1.0701383917919352, 1.0172526092148317, 1.180722891566265, 1.1904761904761905, 1.075439453125, 1.0165809981760903, 1.0608953526161846, 1.0465758489606802, 1.0290697674418605, 1.074816956869501, 1.0015485452815072, 1.0350261353632835, 1.0558823529411765, 1.0961085136542694, 1.0532915360501567, 1.0640768922707249, 1.0804988662131518, 1.0330594803769042, 1.5, 1.0886723507917173, 1.0, 1.0622489959839359, 1.0051163357290778, 1.2321428571428572, 1.11056076067713, 1.0214094558429974, 1.275, 1.0310399532417651, 1.025544275746414, 1.028690706340534, 1.0469745222929936, 1.0672782874617737, 1.190721649484536, 1.1781305114638447, 1.5333333333333334, 2.0, 1.375, 1.0658477648006444, 1.6666666666666667, 1.122001385641292, 1.0856475764991131, 1.0564012490241999, 1.0588429752066115, 1.057492935068349, 1.0863778472532382, 1.0176991150442478, 1.0117785630153122, 1.0300067707986802, 1.1231130690161528, 1.051257481003295, 1.2375210813804214, 1.5714285714285714, 1.1219512195121952, 1.0034722222222223, 1.1603472893260454, 1.1151685393258426, 1.2891621129326047, 1.085483870967742, 2.198581560283688, 1.0221934632877685, 1.0546075085324231, 1.0691695470709526, 1.2222222222222223, 1.0503774260475474, 1.0283152012028198, 1.2535153019023986, 1.0564120532585843, 1.15625, 1.1099778270509977, 1.0868695527932561, 1.0159188017708125, 1.1440329218106995, 1.0178570554219935, 1.4137931034482758, 1.0856336739362513, 1.066126013724267, 1.0150375939849625, 1.150753768844221, 1.0265567765567765, 1.0360272638753651, 1.0879795396419438, 1.0029656292180988, 1.0692307692307692, 1.0156163753449863, 1.064861374141071, 1.0666666666666667, 1.0725244072524407, 1.0399727844871576, 1.1257976298997265, 1.008110992529349, 1.0365321701199564, 1.0707876370887337, 1.078880407124682, 1.0227272727272727, 1.046498613690128, 1.2027027027027026, 1.1314217443249701, 1.240898967402308, 1.0416666666666667, 1.111692844677138, 1.0726290257145077, 1.0947994331135622, 1.0383344348975545, 1.0562248995983936, 1.0978169949648193, 1.0650719751699043, 1.1189358372456963, 1.0275229357798166, 1.030989272943981, 1.0958112613257522, 1.118811881188119, 1.75, 1.068838279273062, 1.1683538494762984, 1.0409956076134699, 1.067632850241546, 1.1832242712671028, 1.0099784171399493, 1.1731040979745644, 1.1867486720715683, 1.3214285714285714, 1.0600112170499159, 1.0, 1.1183879093198992, 1.6774193548387097, 1.0421621118301596, 1.193734542456719, 1.0349877949552482, 1.108695652173913, 1.0372771474878444, 1.1237837837837839, 1.0294117647058822, 1.0, 1.0352722772277227, 1.0077220077220077, 1.0013953488372094, 1.0769230769230769, 1.0268148699675583, 1.392226148409894, 1.0361460348162477, 1.2372881355932204, 1.0857142857142856, 1.2980346142563801, 1.0676052027543994, 1.0417998865036193, 1.2811550151975684, 1.4067796610169492, 1.0, 1.1714285714285715, 1.0898876404494382, 1.1176470588235294, 1.0157426420260096, 1.0333169270576985, 1.0303087430849585, 1.3596491228070176, 1.057534558928317, 1.0473904593492205, 2.5, 1.0084917880370272, 1.0110323089046493, 1.5, 2.25, 1.1870840522553612, 1.0899385698097452, 1.0419835086956972, 1.1898734177215189, 1.0, 1.1310861423220975, 1.0925, 1.1176470588235294, 1.1049260510073367, 1.1169218505181562, 1.0442234268844077, 1.010181589167629, 2.0, 1.041012008486035, 1.062295081967213, 1.064604185623294, 1.0416124837451235, 1.0046296296296295, 1.0, 1.7727272727272727, 1.202792625722701, 1.010570722009407, 1.168384879725086, 1.118032786885246, 1.0938888191743004, 1.0952380952380953, 1.1003460207612457, 1.296875, 1.0250006832654623, 1.723802792012723, 1.0563879317917835, 1.3043478260869565, 1.3873873873873874, 1.0558002936857562, 1.125, 1.095561035758323, 1.027431421446384, 1.012400107505406, 1.0804701627486437, 1.5, 1.0227272727272727, 1.0152843697208591, 1.1422303473491773, 1.1458668382116437, 1.0196407993837182, 1.0802797202797203, 1.104421744910096, 1.1180124223602483, 1.0344827586206897, 1.1018476202911798, 1.0816965775758043, 1.2690886699507389, 1.1155555555555556, 1.5, 1.0952380952380953, 1.1167155059542366, 1.0597243491577335, 1.0421009827177228, 1.0738222849083217, 1.0071599045346062, 2.25, 1.0819327731092436, 1.0275051153668449, 1.1808203350664357, 1.118380062305296, 1.086025777932302, 1.0471204188481675, 1.1345980126467932, 1.0261728395061729, 1.0300981408549468, 1.1454587742760787, 1.0324737344794652, 1.0376940133037693, 1.0, 1.208558442672155, 1.0171922188933564, 1.0556664940956044, 1.0286320254506893, 1.1180447217888716, 1.0544771446462116, 1.0068027210884354, 1.2327586206896552, 2.3333333333333335, 2.5, 1.3888888888888888, 1.030701754385965, 1.0315789473684212, 1.031791999490819, 1.0104544271807978, 1.002959927140255, 1.0904255319148937, 1.1324200913242009, 1.0006493506493506, 1.0598841969821031, 2.0, 1.4666666666666666, 1.3078844095611843, 1.2222222222222223, 1.0286368843069873, 1.1766738660907128, 1.0290928128038292, 1.1086016338298894, 2.0, 1.0142968546919677, 1.1603773584905661, 1.1041183845598572, 1.0400074908943593, 1.1862433862433863, 1.1256752914415695, 1.139149283041239, 1.1336982413461052, 1.0471698113207548, 1.0114942528735633, 1.063437139561707, 1.0, 2.0, 1.041227900326189, 6.0, 1.8571428571428572, 1.9, 1.006060606060606, 1.0826705079225905, 1.090505274847307, 1.0436507936507937, 1.1428571428571428, 1.080241587575496, 1.0009704027171276, 1.0322085889570551, 1.3032786885245902]
origin-bjaq_15.71 	max: 6.0000	99th: 2.5017	95th: 1.8345	median: 1.0827	mean: 1.1894

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 16.575485 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=34.601466