Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 59, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.5000	95th: 1.7280	median: 1.0821	mean: 1.1756
ReportEsts: [1.0412698412698413, 1.0067708333333334, 1.0639801513244507, 1.0358565737051793, 1.5, 1.0, 1.0079650565262077, 1.0481535815222232, 1.0, 1.0290620871862615, 1.207658788560875, 1.0434564893760996, 1.0502867225408028, 1.1395348837209303, 1.0939597315436242, 1.0, 1.0444444444444445, 1.053134962805526, 3.0, 2.0, 1.2272727272727273, 1.0890089243776422, 1.1179909646558597, 1.083969465648855, 1.0966946225949679, 1.0, 1.1618063112078345, 1.5, 1.2, 1.0072463768115942, 1.0, 1.0429995149270186, 1.0042624692669788, 1.0899001109877913, 1.0928183286826259, 1.2373094320656726, 1.1310160427807487, 1.003627710463055, 1.1233556030029617, 1.0714285714285714, 1.2380952380952381, 1.0518292682926829, 1.0, 1.072760413554055, 1.087751677852349, 1.8615384615384616, 1.0510204081632653, 1.197879858657244, 1.0150437080707462, 1.0833333333333333, 1.0874724929267525, 1.0498281786941581, 1.0363953496357032, 2.0, 1.1142857142857143, 1.1638615664845173, 1.0448328267477203, 1.3526570048309179, 1.0559006211180124, 1.25, 1.1065521628498727, 1.112079701120797, 1.0363636363636364, 1.0, 1.0, 1.0634202002355713, 1.3139909735654416, 1.75, 1.0, 1.0167800876293465, 1.0155131264916468, 1.062754212667054, 1.0422535211267605, 1.0554754393871113, 1.0635294117647058, 1.0671936758893281, 1.0, 1.1127348643006263, 2.6666666666666665, 1.028996527877414, 1.3333333333333333, 1.0245381062355658, 1.2331288343558282, 1.110828025477707, 1.1113837095191363, 1.04, 1.0732527098913458, 1.0256010739027255, 1.0686274509803921, 1.75, 1.1669266770670828, 1.075518642911341, 1.0965732087227413, 1.026647966339411, 1.0320452403393026, 1.0207792207792208, 1.0546875, 1.154679802955665, 1.0, 1.2576590730557737, 1.0040479976868584, 1.0754716981132075, 1.2229318603547232, 1.1333333333333333, 1.0274233030515376, 1.0894611096363154, 1.2639032994397177, 1.1137656427758817, 1.048743102391171, 1.3333333333333333, 2.0, 1.064252336448598, 1.0361274813485193, 1.045483259633607, 1.2987012987012987, 1.0594026395581444, 1.0, 1.1176285083569852, 1.1929223744292237, 1.0, 1.0282485875706215, 1.0, 1.2832080200501252, 1.01785947995628, 1.1274365147161607, 1.0666666666666667, 1.8, 1.2069536423841059, 1.0, 1.0714285714285714, 1.0982404841991187, 1.3, 1.044921875, 1.0266914530827058, 1.0621412528075866, 1.0801068090787718, 1.03988603988604, 1.058067030397506, 1.039972432804962, 1.0780012187690433, 1.0032800796357644, 1.1654676258992807, 1.0123939986953685, 1.14658456146329, 2.0, 1.0186873290793073, 1.016, 1.068257123923128, 1.0892888653608612, 1.5, 1.0897311697747638, 1.0416666666666667, 1.0121457489878543, 1.1074561403508771, 1.0291970802919708, 1.0123061362103845, 1.1050166832523562, 1.1981631550513236, 1.0415841584158416, 1.0953947368421053, 1.3061224489795917, 1.3269230769230769, 1.004418262150221, 1.4285714285714286, 1.0743639451037363, 1.0239879831336876, 1.1938144329896907, 1.3585216800853623, 1.0986577181208053, 1.0547560361506454, 1.2821052631578946, 1.12, 1.0595526290306962, 1.0081549439347604, 1.0267471958584986, 1.0592808551992225, 1.0305867665418227, 1.1006310762408322, 1.0370684909963042, 1.0, 1.0714285714285714, 1.0390911656788033, 1.027511961722488, 1.2216949152542373, 1.0921052631578947, 1.0884438317043748, 1.211224293676725, 1.095340129428825, 1.1372549019607843, 1.38, 1.0723156755693277, 1.0, 1.7272727272727273, 1.064484887615512, 1.0463182897862233, 1.0046317739694304, 1.4, 1.04951768488746, 1.0475343880544865, 1.0523582190940741, 1.0626410835214446, 1.162116580583957, 1.6384180790960452, 1.103448275862069, 1.2173913043478262, 1.0, 1.391304347826087, 1.2256741838826684, 1.372822299651568, 1.3103448275862069, 1.0103806228373702, 1.0031277926720286, 1.0109812072399758, 1.031877705027189, 1.251992193852659, 1.0625, 1.089763779527559, 1.0136098509397278, 1.0371503245447757, 1.0031158378844496, 1.0, 1.1134575569358178, 1.112934039745534, 1.011615703489974, 1.1503990178023327, 1.048366081200813, 1.2713194967200774, 1.0357142857142858, 1.0029201007743032, 1.0782619907168645, 1.0011280315848843, 1.0434782608695652, 1.0640035312293092, 1.0348162475822051, 1.1425196850393702, 2.0, 1.1944679650014112, 1.108921393479232, 1.1275199249882795, 1.1858407079646018, 1.0, 1.6666666666666667, 1.1170222120609907, 1.1272727272727272, 1.06599644371495, 1.5, 1.0, 1.0810810810810811, 1.0850897736143639, 1.0103092783505154, 1.0055555555555555, 1.0717299578059072, 1.0179738562091503, 1.0, 1.165443951917307, 1.0701754385964912, 2.0, 1.0502436617111837, 1.0661302121433798, 1.1138353765323994, 1.016911595626816, 1.1367284485247415, 1.0047726825428065, 1.09697933227345, 1.0797669137193457, 1.027511961722488, 1.029033180778032, 1.0367965367965368, 1.1818181818181819, 1.0042643667115125, 1.178391959798995, 1.1818181818181819, 1.3888888888888888, 1.049090909090909, 1.1111111111111112, 1.1452991452991452, 1.1169234910167554, 1.1894150417827298, 1.3709273182957393, 1.0375146470808518, 1.0153321976149914, 1.024186864671955, 1.0491307760391444, 1.1111111111111112, 1.0244088759548926, 1.6666666666666667, 1.0148010898227724, 1.061926605504587, 1.036056620090119, 1.0526315789473684, 1.6666666666666667, 1.391304347826087, 1.0597014925373134, 1.0656319405323853, 1.0, 1.0275229357798166, 1.035128805620609, 1.0080128205128205, 1.0141896287347243, 1.1524390243902438, 1.1635220125786163, 1.009202292223316, 1.1048732456003252, 1.053150269541779, 1.2307692307692308, 1.0, 1.1050119331742243, 1.264797507788162, 1.1464285714285714, 1.0747683235046335, 1.0221017514595496, 1.0816901408450703, 1.475, 1.0150891632373114, 1.0371956114530372, 1.2857142857142858, 1.0147736224673929, 1.0439770554493308, 1.1176470588235294, 1.0560420315236427, 1.3333333333333333, 1.2727272727272727, 1.0149200109892431, 2.0, 1.2386831275720165, 1.0508720930232558, 1.0492206726825266, 1.028393621159082, 1.08355091383812, 1.1666666666666667, 1.1033834332174408, 1.0981962464399602, 1.0194444444444444, 1.0417627663027693, 1.0590922487474212, 2.0, 1.125, 1.0706368975525036, 1.25, 1.0691578360290017, 1.3529411764705883, 1.0, 1.4666666666666666, 1.3343373493975903, 1.054003724394786, 1.18348623853211, 1.0432900432900434, 1.0, 1.2203728362183754, 1.0303684193824771, 2.0, 1.285288862418106, 1.0, 1.1003264252637972, 1.072289156626506, 1.0106008921542902, 1.1451612903225807, 1.1363636363636365, 1.3235625704622322, 1.0833333333333333, 1.0263717850814433, 1.0177334486728369, 1.0622347949080622, 1.0, 1.0769230769230769, 1.5714285714285714, 1.5, 1.2307692307692308, 1.0692173698359577, 1.3333333333333333, 1.0152027027027026, 1.2023809523809523, 1.2449134096716192, 1.1028276962515369, 1.230690010298661, 1.0194520679859407, 1.00754060324826, 1.0678571428571428, 1.5, 1.1510791366906474, 1.0468085106382978, 1.040086927719117, 1.0952380952380953, 1.5714285714285714, 1.0274599542334095, 1.039274924471299, 1.0229529743939247, 1.0269607843137254, 1.1464387464387464, 1.0062927496580027, 1.0526315789473684, 1.0907770515613653, 1.0741525423728813, 1.2692307692307692, 1.0254957507082152, 1.1603773584905661, 1.0459427114903406, 1.062033174615113, 1.024219531163204, 1.1466666666666667, 1.121212121212121, 1.0914634146341464, 1.0, 1.017842535787321, 1.0547180617692191, 1.0163374730763943, 1.0538186398583533, 1.0576456310679612, 1.142357801080394, 1.8333333333333333, 1.1751700680272108, 1.0, 1.2203245089666952, 1.25, 1.0368279933306295, 1.0147058823529411, 1.170464316423044, 1.1383399209486167, 1.0337078651685394, 3.0, 1.3472770323599053, 1.0145503215285683, 1.1317592422291705, 2.0, 1.0862068965517242, 1.2802303262955854, 1.3647058823529412, 1.090258287573724, 1.1975051975051976, 1.1666666666666667, 1.1622088006902502, 1.0434010330240493, 1.0713186044186744, 1.0845375584613917, 1.1370614035087718, 1.1260364842454396, 1.0265151515151516, 2.142857142857143, 1.0883977900552486, 1.5, 1.2308984047019311, 1.0909090909090908, 1.0325633236444698, 1.7857142857142858, 1.0725276033451385, 1.0641358332330852, 1.0857495373226402, 1.0, 1.1875, 1.16, 1.285592796398199, 1.3391684901531729, 1.0, 1.0290751403995166, 1.0920519267278979, 1.050973891421467, 1.5, 2.0, 1.02252427184466, 1.0045004500450045, 1.0032894736842106, 1.1111111111111112, 1.0757739732103255, 1.0861538461538462, 1.4705882352941178, 1.0652730696798494, 1.0454545454545454, 1.1076115485564304, 1.0693548387096774, 1.4328986116954143, 1.0227793107497212, 1.0, 1.0277777777777777, 1.056400034665049, 1.03258205392286, 1.004189491426534, 2.0, 1.0740986507409864, 1.0231574661732887, 1.0214772132006287, 2.0, 1.0614035087719298, 1.03431736563394, 1.0022424832551415, 1.023633742518894, 1.006512291512576, 1.0313195925136223, 1.0033613445378151, 1.1284956605593057, 2.0, 1.0748875910899789, 1.3703703703703705, 1.25, 1.238341968911917, 1.1153846153846154, 1.015111859433868, 1.1393998063891577, 1.0281648412561883, 1.1151484135107472, 1.0996995660398352, 1.0976599486000271, 1.0656807332662945, 1.1318681318681318, 4.0, 1.0138662825591165, 1.118825910931174, 1.0478216493988914, 1.0518602353708482, 1.0948756976154237, 1.0847810979847117, 2.4302325581395348, 2.4285714285714284, 1.006914349710279, 1.0578142234799952, 1.0262918279080355, 1.1031114327062228, 1.1225414577709216, 1.0543478260869565, 1.0766295541268098, 1.012405609492988, 1.2170542635658914, 2.0, 1.1666666666666667, 1.01840490797546, 1.0928433268858802, 1.0915750915750915, 1.266566265060241, 1.0450980392156863, 1.3537414965986394, 1.148905109489051, 1.1304347826086956, 1.0514502378542214, 1.2840909090909092, 1.0156906825985865, 2.0, 1.0634071810542398, 1.045643153526971, 1.184873949579832, 1.1505586592178771, 1.012035010940919, 1.1244444444444444, 1.1024643320363166, 1.1488119595165998, 1.0, 1.2765957446808511, 1.5, 1.5, 1.1704545454545454, 1.1108870967741935, 1.0302066772655007, 1.0728155339805825, 1.0611983338673503, 1.0286396181384247, 1.126217712533035, 1.1620739043254082, 1.037037037037037, 1.1560065899335403, 1.0756756756756756, 1.084028223220013, 1.0353168843734881, 1.0676890534108938, 1.2297687861271676, 1.1169026815305816, 1.0519434449906249, 1.0003377341111452, 1.0768940243369882, 2.0, 1.1056511056511056, 1.072348860257681, 1.4205607476635513, 1.0, 1.0851063829787233, 1.1538461538461537, 1.2725225225225225, 1.2592592592592593, 1.1666666666666667, 1.0068190789208697, 1.1218549383946728, 1.0275679660622365, 1.0234049127143519, 1.1945945945945946, 1.1367403314917126, 1.0, 1.1240875912408759, 1.073761386358587, 1.0537094589210296, 1.082603492828775, 1.0999544367240004, 1.0181679166970072, 1.174025974025974, 1.0639499177843375, 1.103019538188277, 1.018622328856201, 1.1149588659425065, 1.3333333333333333, 1.0691489361702127, 1.0, 1.2422535211267605, 1.2066772002544477, 3.0, 1.1268090971743625, 1.0588302594846917, 1.4285714285714286, 1.118317689239818, 1.4, 1.1176470588235294, 1.0395347125082823, 1.6923076923076923, 1.0059633445791922, 1.046561298590346, 1.3571428571428572, 1.2083333333333333, 1.0474226804123712, 1.0305569245933957, 1.069757174392936, 1.122662247624201, 1.1537302300092855, 1.0, 1.0502932869867478, 1.1280487804878048, 2.0, 1.0022654245359348, 1.1251059780257808, 1.1598864711447492, 1.0165684994746729, 1.033084932754716, 1.0, 1.4285714285714286, 1.0440826052422558, 1.0, 1.1309283423548775, 1.1779960707269155, 1.024990058152603, 1.0414466626729266, 1.1245421245421245, 1.107540173053152, 1.1638795986622072, 1.0830476305245083, 1.0542586750788643, 1.0588768115942029, 1.023109243697479, 1.058295839324644, 3.0, 1.1384569467243695, 1.0049949550953536, 1.0268684089867033, 1.3571428571428572, 1.287598944591029, 1.1885964912280702, 1.1428571428571428, 1.0330817521337377, 1.0420575865415722, 1.1834061135371179, 1.088235294117647, 1.3333333333333333, 1.0389967201010948, 1.5, 1.0630841121495327, 1.0833333333333333, 1.0262451215582369, 1.44, 1.1561181434599157, 1.09958071278826, 1.0, 1.6507936507936507, 1.2330645161290323, 1.25, 2.0, 1.1271186440677967, 1.2241379310344827, 1.021997621878716, 1.1987421383647798, 1.0940170940170941, 1.2743362831858407, 1.1014466214978942, 1.0545454545454545, 1.161137440758294, 1.3428571428571427, 1.0, 1.0, 1.3653846153846154, 1.173160173160173, 1.0433884297520661, 1.054632867132867, 1.0867433659749353, 1.0122660861556496, 1.0623425132659414, 1.1615456911509543, 1.1622377622377622, 1.0102471368294152, 1.5714285714285714, 1.0, 1.2592592592592593, 1.0597252788950444, 1.082965578111209, 1.107843137254902, 1.167487684729064, 1.070561282932417, 1.0185311350320208, 1.0193093504612927, 1.164179104477612, 1.2222222222222223, 1.0344563552833077, 1.0723091198303287, 1.0771831450482394, 1.0072690479677286, 1.019736842105263, 1.0834317779090372, 1.0110932500265388, 1.2203125, 1.3589613034623218, 1.125, 1.041862652869238, 1.6028880866425992, 1.2093023255813953, 1.0, 1.0701001430615165, 1.0, 1.045346062052506, 1.0203461989076088, 1.0588235294117647, 1.078228611913803, 1.0465631929046564, 1.303030303030303, 1.0774482416520899, 1.0262436914203317, 1.1439699167338169, 1.0104961832061068, 1.0045402951191829, 1.2024531562362348, 1.2173913043478262, 1.2142857142857142, 1.0, 1.6666666666666667, 1.069783214242461, 1.3333333333333333, 1.2292852799734675, 1.1084217328092187, 1.001775410563693, 1.080635551142006, 1.0554804872433914, 1.0782422293676313, 1.043010752688172, 1.0346740638002774, 1.0223871134383733, 1.1162354705661792, 1.041569931449056, 1.2322654462242564, 1.6666666666666667, 1.109375, 1.1048034934497817, 1.1120316128808625, 1.019543973941368, 1.3087748344370862, 1.0600375234521575, 2.1923076923076925, 1.0345361798601926, 1.0684563758389263, 1.0607775119617224, 1.1875, 1.0518732497117171, 1.0294078804428861, 1.251603354711396, 1.0581052631578947, 1.032258064516129, 1.1105826397146255, 1.1166666666666667, 1.5, 1.052151377449588, 1.8076923076923077, 1.0806100217864925, 1.0833333333333333, 1.0540156361051884, 1.0378851658528372, 1.0216346153846154, 2.75, 1.0926829268292684, 1.0955733666678922, 1.0528362686815935, 1.004849986614286, 1.0020769281088506, 1.087961562416585, 1.0833333333333333, 1.0866209262435678, 1.064462466209191, 1.0533059511585339, 1.0511022044088176, 1.0, 1.0247971145175834, 1.0525881755899518, 1.364717542120912, 1.051786467986714, 1.0, 1.3333333333333333, 1.0486983608989098, 1.0069424766222725, 1.2314241119992433, 1.1301825595403576, 1.066241021548284, 1.1056511056511056, 1.0911671644439187, 1.0604228640885391, 1.1102941176470589, 1.0571428571428572, 1.0077628793225124, 1.0938374318951554, 1.0952380952380953, 1.75, 1.0569792474892632, 1.173338098641887, 1.034198113207547, 1.0602409638554218, 1.221940622737147, 1.0195162410854801, 1.1824571267922406, 1.4760147601476015, 1.2692307692307692, 1.0390835579514826, 1.1994949494949494, 1.146875, 1.5357142857142858, 1.0669348530562075, 1.195242814667988, 1.158374792703151, 1.0975609756097562, 1.0215467950647006, 1.0315021129466, 1.0707831325301205, 1.1629035452564864, 1.3333333333333333, 1.0769230769230769, 2.0, 1.1445489376523859, 1.3846153846153846, 1.0, 1.25, 1.0516556291390728, 1.0380434782608696, 1.0489760537436341, 1.0585468644639244, 1.0, 1.3877551020408163, 1.1428571428571428, 1.0, 1.027027027027027, 1.0294117647058822, 1.1030927835051547, 1.0292713236932927, 1.0299840451189195, 1.3195876288659794, 1.0724031103178022, 1.047309944447225, 2.5, 1.0696897009288557, 1.1627906976744187, 1.5, 2.0, 1.183431952662722, 1.1009108513232446, 1.0697387028142638, 1.2142857142857142, 1.0, 1.032, 1.3006134969325154, 3.0, 2.0, 1.0339566929133859, 1.1164134964376933, 1.0262887919979482, 1.6666666666666667, 1.0391258904750116, 1.0449264136328427, 1.0256410256410255, 1.0, 1.0610328638497653, 1.0224490497302128, 1.2105263157894737, 1.1816782140107776, 1.0161168324896723, 1.303680981595092, 1.03125, 1.1017862291897471, 1.0812557710064634, 1.115702479338843, 1.1129032258064515, 1.0366654909648685, 1.3522990406880582, 1.0622572215551946, 2.4730538922155687, 1.107843137254902, 1.3134328358208955, 1.0837837837837838, 1.058016219588272, 1.0145927116292532, 1.0864073577313662, 1.0480349344978166, 1.5, 1.6666666666666667, 1.0950265294380874, 1.1372031662269129, 1.2141606691305193, 1.0179244240988696, 1.0871383174443887, 1.0871811830846183, 1.4411764705882353, 1.0212765957446808, 1.0955113591698766, 1.1129830905467322, 1.2359796067006554, 1.017825311942959, 2.5, 1.0416666666666667, 1.0233125610030782, 1.133839068003251, 1.061639865525065, 1.0903259600192348, 1.0049715909090908, 2.0, 1.0932311621966795, 1.0478760284736988, 1.167923235092529, 1.167300380228137, 1.065733323797263, 1.0608108108108107, 1.3885209713024282, 1.0185507246376813, 1.031724603442457, 1.0646939978112635, 1.043778801843318, 1.0441176470588236, 1.0, 1.210967408173823, 1.051124417222781, 1.0079260237780714, 1.017058883979036, 1.1106304079110012, 1.0234493192133132, 1.2, 1.2695417789757413, 1.6666666666666667, 2.0, 1.1764705882352942, 1.0051150895140666, 1.0387045813586098, 1.0262576219512196, 1.009400795517728, 1.028467764443204, 1.0239931448157669, 1.1684782608695652, 1.2894736842105263, 1.0324642072995363, 1.6, 1.6666666666666667, 1.089652728561304, 1.1428571428571428, 1.097953216374269, 1.1507334344967122, 1.0446285660483947, 1.0909983606823457, 2.0, 1.16656346749226, 1.189922480620155, 1.0563751317175976, 1.0402534014697653, 1.0808080808080809, 1.1284246575342465, 1.1408481994090596, 1.0936801223961399, 1.019448946515397, 1.2241379310344827, 1.0865921787709498, 1.0, 1.0, 1.0416472944458353, 5.0, 1.4285714285714286, 1.7419354838709677, 1.0337756332931243, 1.1604938271604939, 1.0803769401330376, 1.097685366810514, 1.0, 1.0558659217877095, 1.0204439252336448, 1.1377551020408163, 1.2932692307692308, 1.4285714285714286, 1.0046635576282479, 1.0304878048780488, 1.1444444444444444, 1.0334696913350687, 1.022426459653193, 1.1089138427904204, 1.1112097012718132, 1.0, 1.2559969539281635, 1.0449270511547262, 1.0387374461979915, 1.1774193548387097, 1.0857813722932428]
origin-bjaq_15.71 	max: 5.0000	99th: 2.5000	95th: 1.7280	median: 1.0821	mean: 1.1756

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 13.952793 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[7.1525574e-07 1.7881393e-07 9.5367432e-07 2.3841858e-07 1.1920929e-07]
Distance score: 4.410743770222325e-07
SAUCE Drift detection: False
Detection latency: 0.0236s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.023042 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 8.0000	99th: 2.7525	95th: 1.8345	median: 1.0870	mean: 1.1932
ReportEsts: [1.1445086705202312, 1.0207477847417332, 1.0306460552315775, 1.0683760683760684, 1.5454545454545454, 1.0, 1.06082314290929, 1.065265130907517, 1.3333333333333333, 1.0207197382769901, 1.155787453520451, 1.043465188386733, 1.0133614627285514, 1.0480769230769231, 1.0458851391355832, 1.1176470588235294, 1.1986754966887416, 1.3333333333333333, 1.0, 1.1233221476510067, 1.1567701570062567, 1.068178748007457, 1.1174934725848564, 1.0442869796279894, 1.01251687323598, 1.0351496194590892, 3.0, 1.1486559300724422, 1.4, 1.0, 1.1040372670807452, 1.0, 1.0400708037248916, 1.0081946196527287, 1.1375173050299954, 1.0248780487804878, 1.238028904753613, 1.1662921348314608, 2.0, 1.1503557223684948, 1.0220601809119438, 1.0375476875711132, 1.184278350515464, 1.137525562372188, 1.0018281535648994, 1.058135627394314, 1.1428571428571428, 1.0950510604870385, 1.0753138075313808, 1.0613275613275612, 1.2586206896551724, 1.1470588235294117, 1.103448275862069, 1.15625, 1.041109472405716, 1.0086624517612284, 1.0455610899501904, 1.1701570680628273, 1.0416666666666667, 1.0767793585994936, 1.2394366197183098, 1.057206068268015, 1.0594512195121952, 1.1089494163424125, 1.0404040404040404, 1.5, 1.1190445531805304, 1.3479934029686642, 1.6, 1.0, 1.001248049921997, 1.006006006006006, 1.0746485700436257, 1.0934393638170974, 1.072898831944603, 1.081720430107527, 1.0581413653775515, 1.311764705882353, 1.4368932038834952, 1.0562896984741184, 1.0721200387221685, 1.2666666666666666, 1.0, 1.5, 1.0662921348314607, 1.3333333333333333, 1.0199004975124377, 1.1794871794871795, 1.5, 1.0756290369227803, 1.1135884302500754, 1.524564822904765, 1.0094702802587003, 1.0166480654761905, 1.0183727034120735, 1.0279394644935973, 1.065934065934066, 1.0943134535367545, 1.5, 1.3411624203821657, 1.1923076923076923, 8.0, 1.061392950737108, 1.1451131028595818, 1.0454545454545454, 1.2196571101327893, 1.3225806451612903, 1.0134965564395497, 1.026578073089701, 1.341870926282934, 1.1700852003786684, 1.0515700791422007, 1.125, 2.3333333333333335, 1.0433772269558481, 1.084602884420069, 1.0634328358208955, 1.1428571428571428, 1.0613139758100893, 1.0, 1.1470278800631246, 1.1090589270008795, 1.0, 1.0095238095238095, 1.25, 1.2196162046908317, 1.0165696346190694, 1.0694363175346207, 1.0241935483870968, 2.1666666666666665, 1.175983436853002, 2.0, 2.25, 1.1106032906764167, 1.0769230769230769, 1.4857142857142858, 1.0139021566886568, 1.086039421440726, 1.4444444444444444, 1.4285714285714286, 1.043298969072165, 1.106115107913669, 1.0667001003009027, 1.0231193831132808, 1.2857142857142858, 1.0366320393657737, 1.078580121703854, 1.5, 1.019259818731118, 1.0057251908396947, 1.0693124650642818, 1.1087498167961307, 1.5, 1.109648678748608, 1.0429128738621587, 1.0049586776859505, 1.0827586206896551, 1.0, 1.0857751731486414, 1.1267257885720043, 1.193479135918422, 1.0475382003395586, 1.043360433604336, 1.1363636363636365, 1.3418803418803418, 1.0294478527607362, 1.2, 1.0775406226393867, 1.3129770992366412, 1.0749014454664914, 1.0735669193061157, 1.0107159142726858, 1.0302382150645866, 1.3087719298245615, 1.1227722772277229, 1.060323886639676, 1.0452342487883683, 1.0248756218905473, 1.078415521422797, 1.0170586714913414, 1.0261371973587674, 1.2405443107940937, 1.1436781609195403, 1.3333333333333333, 1.0010789634541648, 1.094171001734027, 1.3272058823529411, 1.1444052370760303, 1.0416666666666667, 2.0, 1.26, 1.0604939241754239, 1.16, 1.1267465069860279, 1.1162049583458797, 1.061811497143482, 1.034885379744752, 1.0592734225621414, 1.0209324784019627, 1.0961960956625447, 1.0108604845446951, 1.0029060020118477, 1.0078590140509645, 1.0652098701608574, 1.0658204043253408, 1.071767392832045, 1.085, 1.0833333333333333, 1.1951219512195121, 2.0, 1.4044117647058822, 1.2049453784261137, 1.378698224852071, 1.3232323232323233, 1.0216486261448792, 1.3333333333333333, 1.040191048113167, 1.0263157894736843, 1.2188548155246766, 2.0, 1.0826140567200986, 1.005401026194977, 1.0523629670355938, 1.0162641886840087, 2.0, 1.0666666666666667, 1.1333475605752183, 1.0235945848937769, 1.0926430517711172, 1.0067001675041876, 1.1649083842309829, 1.0950254889547864, 1.344, 1.0016514120972935, 1.0258464214586431, 1.118380062305296, 1.0483175150992234, 1.0313549832026876, 1.5, 1.1251621271076524, 1.0, 1.2281083696178037, 1.0966515165569057, 1.1531956735496558, 1.2470588235294118, 1.0, 2.0, 1.0980432362762904, 1.1692307692307693, 1.0507609944782352, 1.8, 1.073652990608008, 1.022680412371134, 1.2222222222222223, 1.014831475063432, 1.0209302325581395, 1.1205673758865249, 1.380952380952381, 1.0024518388791595, 1.1062432428071194, 1.0285714285714285, 2.0, 1.1297933336185872, 1.1591977229099093, 1.0957910014513788, 1.0418240362022453, 1.0992853139013452, 1.0757144752162955, 1.093501326259947, 1.0822844233195434, 1.0210737581535374, 1.1033696478337978, 1.1354443545591124, 1.2307692307692308, 1.0234913447667895, 1.2879818594104309, 1.1454545454545455, 1.3333333333333333, 1.6941092973740242, 1.1522248243559718, 1.0020550408439368, 1.0086764085991289, 1.086734693877551, 1.3479166666666667, 1.0334950311774178, 1.0097697138869504, 1.007857098466756, 1.0450844467433622, 1.0, 1.0857037988621765, 1.0239294710327456, 1.0908643246449476, 1.134658905389734, 1.07703245939693, 1.2516059957173447, 1.1830432341381247, 1.0624731951393853, 1.0610617066051184, 1.113696628605444, 1.0193687423033677, 1.02014652014652, 1.4, 1.0, 1.0799761265293941, 1.0, 1.0386740331491713, 1.0007921113830467, 1.0544598174860171, 1.275, 1.1504424778761062, 1.0440917107583774, 1.0723536522189605, 1.0518916683894977, 1.1363636363636365, 1.1555659604354442, 1.0277717882026334, 1.173669467787115, 1.6666666666666667, 3.25, 1.0353569046030686, 1.4285714285714286, 1.0021076363497017, 1.0429252782193958, 1.0, 1.137886230752573, 1.3478260869565217, 1.3333333333333333, 1.0203324763145847, 3.0, 1.02803738317757, 1.0181378476420797, 1.1, 1.0572519083969465, 1.091566265060241, 1.1443298969072164, 1.1001328499696021, 1.1028479515564387, 1.0590717299578059, 1.0796927296050012, 1.0004074742418068, 3.0, 1.0, 1.0348784064291292, 1.0, 1.071561338289963, 1.4, 1.8571428571428572, 1.4736842105263157, 1.3632585203657523, 1.0536547433903578, 1.129496402877698, 1.0885529157667386, 1.355263157894737, 1.5, 1.0508998794419886, 1.5, 1.028169014084507, 1.0114995332743613, 1.078125, 1.0526706231454006, 1.0360189573459715, 1.75, 1.25, 1.432456140350877, 1.3277310924369747, 1.0925925925925926, 1.1328220241688267, 1.2595903165735567, 1.0272277227722773, 1.5, 1.0286785439630863, 1.2176470588235293, 1.4666666666666666, 2.0, 1.1355052402610244, 1.0, 1.0213219616204692, 1.1584158415841583, 1.192522658610272, 1.0755880238477347, 1.12, 1.1317267324573361, 1.1141472607349576, 1.1302288871349644, 1.120715350223547, 1.076647455827709, 1.0498338870431894, 1.054054054054054, 1.0137266453055926, 1.0451052010805464, 1.1793422404933196, 1.0541871921182266, 1.0476190476190477, 1.1810699588477367, 2.0, 1.0208333333333333, 1.6404494382022472, 1.1559454191033138, 1.36, 1.238532110091743, 1.0871934604904632, 1.0481128162588138, 1.1459035672285378, 1.0573738929534078, 1.0760889956102502, 1.3376623376623376, 1.3814432989690721, 1.1028277634961439, 2.0, 1.0674636898882943, 1.5, 1.107031736154325, 1.050452801834935, 1.049819676255976, 1.149815692469721, 1.625, 1.1506722299490033, 1.1428571428571428, 1.157986357822936, 1.0, 1.0718195018429577, 1.0011976047904192, 1.1433169423334824, 1.1414790996784565, 1.083274021352313, 3.0, 1.1684062059238365, 1.0158801117080176, 1.0921630812731649, 2.0, 1.0632911392405062, 1.255044390637611, 1.2380952380952381, 1.1198831426285953, 1.3653783342406096, 1.1363636363636365, 1.0580645161290323, 1.0142042077736835, 1.0841898836894779, 1.0073281758302393, 1.006707884748514, 2.4545454545454546, 1.2, 1.0742884708152436, 1.0869800432796346, 1.2980769230769231, 1.2618556701030927, 2.0, 1.0, 1.1686121919584955, 1.144578313253012, 1.038326300984529, 1.0980061218067911, 1.1005643919958954, 2.0, 1.1512605042016806, 1.1333333333333333, 1.1653634894991922, 1.1304347826086956, 1.0, 1.0238696350700023, 1.3333333333333333, 1.0, 1.001896813353566, 2.3333333333333335, 1.0141215106732349, 1.0098709187547457, 1.0294117647058822, 1.3, 1.077508834705978, 1.1677301731996355, 1.4, 1.0629886783011198, 1.0615384615384615, 1.049040511727079, 1.0516173434273917, 1.253486750348675, 1.03824158337063, 2.0, 1.1058823529411765, 1.1025082626630114, 1.1510704419889504, 1.0736342042755345, 1.2, 1.0669356317623326, 1.0125313763436739, 1.0245183887915936, 2.0, 1.0698852126941256, 1.0315815045752692, 1.0193755671645452, 1.0448776230134196, 1.0037654437766492, 1.0745493698282742, 1.0414545454545454, 1.0005747150029352, 2.6666666666666665, 1.0340845913697985, 1.0730958230958232, 1.0479171683120636, 1.0474613686534215, 1.0375335120643432, 1.0094813898626604, 1.1222222222222222, 1.0769683895465003, 1.1476683937823835, 1.0371862531825853, 1.165137614678899, 1.1294299305157771, 1.0523426336767692, 1.0340909090909092, 1.0851063829787233, 1.0963850071995382, 1.032719836400818, 1.0172212802034761, 1.0616820200936112, 1.3333333333333333, 1.1258027956176804, 1.115492957746479, 1.25, 1.0377358490566038, 1.015565018050738, 1.127659574468085, 1.1188222923238695, 1.0, 2.0, 1.0163255920901357, 1.1536604440817437, 1.037578674564976, 1.0493932704699442, 1.0857362552864283, 1.0377777777777777, 1.012158054711246, 1.0063051329110178, 1.5941176470588236, 1.0429903636928817, 1.1648068669527898, 1.103448275862069, 1.055648476756035, 1.1405820977484897, 1.0180367264843404, 3.0, 1.0521684475172848, 1.0204778156996588, 1.0127904882003242, 1.120879120879121, 1.09126213592233, 1.075657894736842, 1.1291248206599713, 1.145881155651043, 1.0, 1.125, 1.4, 1.0, 1.24, 1.1491228070175439, 1.013959390862944, 1.0474308300395256, 1.0652260904361746, 1.1050686378035903, 1.075927259356855, 1.1723856209150327, 1.2008618335204686, 1.1319400434364653, 1.0239946484662814, 1.0770053475935828, 1.0736047835990887, 1.056868756176939, 1.081094527363184, 1.0256136606189967, 1.0998810939357908, 1.4444444444444444, 1.0876808061108403, 1.1658823529411764, 1.102968041014359, 1.297752808988764, 1.279119827792394, 1.105263157894737, 1.5, 1.0188902007083824, 1.1578947368421053, 1.4, 1.2927756653992395, 1.0391354641368227, 1.0388093443858326, 1.0076335877862594, 1.1038251366120218, 1.035817016552281, 1.0529021203683873, 1.1296296296296295, 1.4, 1.1666666666666667, 1.0361392440090764, 1.1898148148148149, 1.0698135660452202, 1.0718464778843904, 1.0, 1.3767471410419314, 1.1772428884026258, 1.0426397906773912, 1.1017964071856288, 1.009486412248327, 1.033350343709663, 1.0160378024575782, 1.4361702127659575, 1.5, 1.2034864598180024, 1.0, 1.04739336492891, 1.1722689075630253, 1.3477956613016095, 1.175986842105263, 1.5833333333333333, 1.074995453718858, 1.1164383561643836, 1.1113013698630136, 1.0326589481171218, 1.2255737704918033, 1.0411373260738053, 1.0364568223576056, 1.0198915009041591, 1.0607638888888888, 1.2, 1.068811199510404, 1.0879832079762113, 1.0454545454545454, 1.003429355281207, 1.200937774738693, 1.0, 1.0143255183033013, 1.5, 1.0612244897959184, 1.0257309941520467, 1.0799086757990868, 1.115606936416185, 1.0814517583408476, 1.0229007633587786, 2.2857142857142856, 1.0913511635984716, 1.0299319727891156, 1.1088735320303558, 1.1904283801874163, 1.0024954715381353, 1.1133553173948887, 1.1267387944358578, 1.1014344262295082, 1.187150837988827, 1.0922226384909022, 1.0518053375196232, 1.0602409638554218, 1.0114185331576635, 1.101690294438386, 1.046875, 1.0189914865749836, 1.0909090909090908, 1.3333333333333333, 1.0475, 1.6278798483522894, 1.0252852297255628, 1.076782449725777, 1.0769230769230769, 1.0007898894154819, 1.0247400501972033, 1.1090909090909091, 1.0711882755171256, 3.3333333333333335, 1.1628147637116246, 1.5, 1.1473477406679764, 1.0666666666666667, 1.005231037489102, 1.3225806451612903, 1.0743243243243243, 1.0692102928127774, 2.0, 1.213928083750569, 1.232417950435365, 1.5, 2.5, 1.1205673758865249, 1.158640226628895, 1.1529112492933862, 1.2093023255813953, 1.0938833570412518, 1.4583333333333333, 1.032418952618454, 1.2037617554858935, 1.2592592592592593, 1.306896551724138, 1.1, 1.0, 1.2771855010660982, 1.117930204572804, 1.0427046263345197, 1.0200578085311378, 1.0904294003047048, 1.0412515734580112, 1.072641765620757, 1.0735954209971381, 1.2004773269689737, 1.0317460317460319, 1.625, 1.0, 1.303030303030303, 1.0304414868742022, 1.0498533724340176, 1.030379746835443, 1.1440501043841336, 1.0165357849709507, 1.0390224126947356, 1.007251163719601, 1.1785714285714286, 1.2380952380952381, 1.1207056638811514, 1.0092163355408388, 1.091963937893038, 1.0508055953095425, 1.0055555555555555, 1.0181751422801542, 1.0848351175426327, 1.0541654759258672, 1.1065573770491803, 1.0827792293130154, 1.125, 1.1024146544546212, 1.1031518624641834, 1.0329261784042114, 2.0, 1.0854526958290946, 1.0, 1.1210191082802548, 1.0074140854167228, 1.1290322580645162, 1.0998540920546491, 1.0080572963294538, 1.236842105263158, 1.0680221612608252, 1.0334393948490124, 1.0713547052740435, 1.047808764940239, 1.0135265700483091, 1.2064142413111048, 1.1902268760907504, 1.0952380952380953, 1.0, 1.375, 1.0717624304939963, 1.6666666666666667, 1.0858156028368795, 1.107616079635899, 1.0670357919715245, 1.0809777186564682, 1.0402006549153486, 1.023023380331965, 1.0057971014492753, 1.0391705069124424, 1.003503936545471, 1.0828355003709345, 1.0470444606109257, 1.2013237727523443, 1.375, 1.023659305993691, 1.08843537414966, 1.1157897774827557, 1.019283746556474, 1.2948835084513477, 1.0368663594470047, 2.2437275985663083, 1.001920438957476, 1.0590858416945375, 1.1062132034308598, 1.0476190476190477, 1.0780593921636836, 1.02016263942157, 1.2869860110216194, 1.0646186440677967, 1.0, 1.1601272534464475, 1.03515238200022, 1.0295689122128326, 1.0869565217391304, 1.017523318701991, 1.3333333333333333, 1.0218394118495027, 1.0092764378478665, 1.0270967741935484, 2.25, 1.0168738898756662, 1.0918472652218782, 1.0406265296133137, 1.0044073820700934, 1.0805043646944714, 1.0123729888362902, 1.0739821323960164, 1.2142857142857142, 1.0672740014015416, 1.0290442966087945, 1.2312464749012972, 1.0906515580736544, 1.110529072812991, 1.1887550200803212, 1.7, 1.0725806451612903, 1.0237095002063208, 1.1020408163265305, 1.116087212728344, 1.2367301051955353, 1.0403191030616645, 1.0630323679727427, 1.1877763141274338, 1.1358533685397076, 1.0582329317269077, 1.1263157894736842, 1.1124799802882839, 1.0853967475688486, 1.1562021439509953, 1.0, 1.0047309284447072, 1.090609150058917, 1.0970873786407767, 2.75, 1.0464464374239488, 1.1784114052953156, 1.016859344894027, 1.116751269035533, 1.2282938676381299, 1.0325626539012276, 1.1495109455053563, 1.0151195499296766, 1.21875, 1.0523619806488331, 1.0909090909090908, 1.150259067357513, 1.7096774193548387, 1.0936932743774725, 1.1878636741479633, 1.2857142857142858, 1.04, 1.1105058365758755, 1.0541368743615935, 1.0588235294117647, 1.0263157894736843, 1.0348909657320873, 1.0199203187250996, 1.1638023630504835, 1.2307692307692308, 1.0159061547206862, 1.0025316455696203, 1.0536772394562566, 1.2372881355932204, 1.0212765957446808, 1.3272780544975096, 1.0435680301624823, 1.0352681448571859, 1.2014925373134329, 1.3174603174603174, 1.2941176470588236, 1.0, 1.0674157303370786, 1.1645569620253164, 1.087019931939718, 1.0370964609317603, 1.0326689157819802, 1.2782608695652173, 1.1028569150329774, 1.0483630548515455, 4.5, 1.045244034190207, 1.0242654028436018, 1.5, 2.0, 1.2498146775389176, 1.1028183402439757, 1.069711181376398, 1.2301587301587302, 1.5, 1.135036496350365, 1.2244897959183674, 1.15, 1.1000522385766525, 1.10109391124871, 1.036030358292212, 1.016926272066459, 1.8571428571428572, 1.029356818788364, 1.056135770234987, 1.045053003533569, 1.1346153846153846, 1.018735362997658, 2.0, 1.1188311688311687, 1.1881097887852472, 1.0061922007372437, 1.0626631853785902, 1.1162790697674418, 1.0722015431261862, 1.0473684210526315, 1.0985915492957747, 1.2461538461538462, 1.0169943215596235, 1.5750200160128103, 1.0725848822800497, 1.4422110552763818, 1.064, 1.2231404958677685, 1.5, 1.0899503722084367, 1.0805194805194804, 1.0089896510466134, 1.0263396911898275, 2.0, 1.112523540489642, 1.0166993303935978, 1.1918968692449357, 1.0917685411572942, 1.0262748004683488, 1.093793681856304, 1.1024943310657596, 1.183673469387755, 1.0178571428571428, 1.06740614334471, 1.1081599123767798, 1.2986683576410907, 1.0147710487444608, 2.0, 1.043956043956044, 1.0061823802163834, 1.0929487179487178, 1.0068380282603901, 1.0960396324364745, 1.0227954409118176, 2.75, 1.0348004094165815, 1.0277471153755438, 1.1742193450114242, 1.1751592356687899, 1.0480867536850464, 1.1455525606469004, 1.4360902255639099, 1.033462657613967, 1.0339581750545588, 1.066839835118137, 1.0549132947976878, 1.0382452193475815, 1.0526315789473684, 1.10352422907489, 1.1473962400144153, 1.0028715424285044, 1.0244494282878047, 1.1271495570609693, 1.0614312856238126, 1.6, 1.20995670995671, 2.0, 1.3333333333333333, 1.3333333333333333, 1.021505376344086, 1.014407334643091, 1.027264030612245, 1.02440833149124, 1.0919592298980747, 1.0170909738294462, 1.1571428571428573, 1.0342751273737842, 1.0590956617230443, 1.8333333333333333, 1.3125, 1.078810623556582, 1.125, 1.0022497187851518, 1.112566516577978, 1.2755562236921227, 1.0997193765425837, 2.0, 1.0106548856548856, 1.0698080279232112, 1.0572436554000229, 1.042071271703282, 1.12668743509865, 1.1319027181688126, 1.1493442470467863, 1.163702548101924, 1.0079470198675498, 1.2162162162162162, 1.1529411764705881, 1.0, 2.0, 1.0427259913339846, 5.0, 1.5, 1.4883720930232558, 1.021472392638037, 1.075481976791835, 1.1770601336302895, 1.0040160642570282, 1.0, 1.0085474783564656, 1.0082085948816997, 1.1166666666666667, 1.2465483234714003]
origin-bjaq_15.71 	max: 8.0000	99th: 2.7525	95th: 1.8345	median: 1.0870	mean: 1.1932

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.163643 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.166635