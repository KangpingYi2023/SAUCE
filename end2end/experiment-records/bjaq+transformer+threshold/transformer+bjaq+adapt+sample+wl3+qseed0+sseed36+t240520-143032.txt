Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 36, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.5005	95th: 1.7500	median: 1.0833	mean: 1.1754
ReportEsts: [1.0, 1.0075520833333333, 1.044695687397827, 1.0441767068273093, 1.5789473684210527, 1.0, 1.0700538876058507, 1.0723129003797613, 1.0, 1.0263504611330698, 1.1761463653940496, 1.0431788354252263, 1.0153518123667378, 1.1116279069767443, 1.0653479335923701, 1.0, 1.25, 1.0456960680127525, 3.0, 2.0, 1.125, 1.0846783625730994, 1.0863222041469776, 1.1391661773341162, 1.061667488899852, 1.0, 1.1616377747153115, 1.5, 1.2, 1.0, 1.0, 1.0469978397903534, 1.005703821931876, 1.2125416204217536, 1.0853282420326038, 1.2498201971485383, 1.1737967914438503, 1.0037045160975848, 1.1193608375232453, 1.0833333333333333, 1.1126961483594864, 1.125, 1.0, 1.0656277827248442, 1.094546682424447, 1.8615384615384616, 1.0618556701030928, 1.2826855123674912, 1.0116365114860744, 1.1018518518518519, 1.165221052631579, 1.134020618556701, 1.0381945159761852, 2.0, 1.3766233766233766, 1.2743009852020262, 1.2276785714285714, 1.3658536585365855, 1.049689440993789, 1.25, 1.0997818974918212, 1.0965130759651307, 1.1272727272727272, 1.0481927710843373, 1.1, 1.024903331086594, 1.3212317666126419, 1.75, 1.0, 1.053416612286753, 1.0294840294840295, 1.062754212667054, 1.0277777777777777, 1.1046599377417226, 1.0870588235294119, 1.1134020618556701, 1.0, 1.113152400835073, 2.0, 1.0392837671095296, 1.125, 1.041667572562235, 1.1840490797546013, 1.0968553459119497, 1.1211972522080471, 1.04, 1.0709683245077108, 1.0459345817239525, 1.0245098039215685, 1.75, 1.0731707317073171, 1.055084670991877, 1.115264797507788, 1.0127840909090908, 1.012014787430684, 1.018181818181818, 1.0222222222222221, 1.1512770137524557, 1.0, 1.2260146592276555, 1.0076900754497968, 1.0137221269296741, 1.2195111455374816, 1.4166666666666667, 1.0148664657656497, 1.0674276612689142, 1.1062525541479362, 1.1604095563139931, 1.048743102391171, 1.1666666666666667, 2.0, 1.0427570093457943, 1.1019185394998394, 1.0303221730890715, 1.1428571428571428, 1.0623497870998266, 1.0, 1.0920845159255754, 1.153421633554084, 1.0, 1.0055248618784531, 1.0, 1.1929824561403508, 1.0339220465004404, 1.0832492040071444, 1.087378640776699, 1.8, 1.1448675496688743, 1.0, 1.4736842105263157, 1.1032603694880945, 1.3, 1.1043294270833333, 1.0305789847199283, 1.0803858520900322, 1.0320427236315086, 1.1027190332326284, 1.06858924395947, 1.039972432804962, 1.0786106032906764, 1.0326091520612712, 1.265625, 1.0386178861788617, 1.1284881527546216, 2.0, 1.0191431175934367, 1.0285714285714285, 1.0928813559322035, 1.0919357684842068, 1.5, 1.099903124243158, 1.0336906584992342, 1.0060362173038229, 1.1074561403508771, 1.2554744525547445, 1.0381519075953798, 1.1049843416161793, 1.150908147379346, 1.0890269151138716, 1.0986842105263157, 1.2653061224489797, 1.3398058252427185, 1.011782032400589, 1.1428571428571428, 1.0693434326507356, 1.0246742254992414, 1.1465346534653464, 1.3714257735996866, 1.1415620641562063, 1.1760886273886195, 1.2715789473684211, 1.0793650793650793, 1.0840515154449502, 1.0495449949443882, 1.0087032201914707, 1.097181729834791, 1.045598480050665, 1.0689526649273202, 1.0469607611858143, 1.0, 1.024390243902439, 1.0151001975726786, 1.0277113237639552, 1.2261283737809028, 1.2236842105263157, 1.0919520357632415, 1.2627330386315587, 1.1414410319676211, 1.1153846153846154, 1.470909090909091, 1.1051757787747447, 1.0, 1.0, 1.0123078164722974, 1.0138089758342923, 1.0289373814041747, 1.4583333333333333, 1.0482315112540193, 1.0497695473673934, 1.0276631225930088, 1.0626410835214446, 1.097501844629493, 1.0727272727272728, 1.1428571428571428, 1.2173913043478262, 1.0, 1.25, 1.1176470588235294, 1.2857142857142858, 1.2298850574712643, 1.0118635689569946, 1.0031277926720286, 1.0210082563671985, 1.0294639884585506, 1.0405487598837602, 1.1428571428571428, 1.0245664739884393, 1.027981345769487, 1.043555057728761, 1.004258943781942, 1.0, 1.1022774327122153, 1.0983593642290193, 1.012819996842213, 1.152521525215252, 1.0089383436701933, 1.2783304498269896, 1.0357142857142858, 1.0052780898876406, 1.0734914904589994, 1.026508742244783, 1.0105263157894737, 1.210698141637368, 1.0147001934235977, 1.2149606299212599, 2.0, 1.2785498489425982, 1.0840218847699865, 1.1099390529770277, 1.0551181102362204, 1.0, 1.6666666666666667, 1.0893230861222982, 1.0909090909090908, 1.0421207461389317, 1.5, 1.0, 1.025, 1.03551912568306, 1.0204081632653061, 1.022099447513812, 1.0843881856540085, 1.0453020134228188, 1.0083963056255247, 1.072317609028087, 1.0350877192982457, 2.0, 1.0943083914214629, 1.1002566812622678, 1.1330998248686515, 1.021092459811443, 1.1479634974780606, 1.0212038991056176, 1.1089030206677266, 1.0977061070718095, 1.020933014354067, 1.0593345111896348, 1.1353876185164529, 1.0909090909090908, 1.0129712102406854, 1.1193317422434368, 1.1818181818181819, 1.4705882352941178, 1.0484178421654593, 1.1111111111111112, 1.017391304347826, 1.108014265527219, 1.0668523676880224, 1.355889724310777, 1.031279455821521, 1.0218120805369129, 1.0232419023414265, 1.0518182427002412, 1.25, 1.0299017824663514, 2.5, 1.0315251386370208, 1.0243362831858407, 1.0257521278048336, 1.0810810810810811, 2.0, 1.2608695652173914, 1.0923076923076922, 1.0583200432143225, 1.0, 1.015527950310559, 1.0135746606334841, 1.0060096153846154, 1.0154848752381396, 1.173913043478261, 1.1446540880503144, 1.0006728261777755, 1.0659227985524728, 1.0568445965935507, 1.1452991452991452, 1.0, 1.1610978520286397, 1.264797507788162, 1.1184668989547037, 1.1741364785172703, 1.0291845493562233, 1.095774647887324, 1.2291666666666667, 1.0, 1.0167698658410733, 1.2857142857142858, 1.0123418554593742, 1.04, 1.0555555555555556, 1.1200607486865148, 1.1904761904761905, 1.4, 1.0013119749455106, 2.0, 1.1742112482853224, 1.0363372093023255, 1.1017227235438884, 1.1189166314007617, 1.3161512027491409, 1.1097560975609757, 1.107374288072079, 1.0994214681564065, 1.0237099023709901, 1.0093607230351587, 1.0612817483756645, 2.0, 1.0, 1.0486528485568682, 1.25, 1.067966573816156, 1.3529411764705883, 1.0, 1.4666666666666666, 1.4166666666666667, 1.058933582787652, 1.2169811320754718, 1.0205627705627707, 1.0, 1.1857523302263648, 1.0540291375594049, 2.0, 1.10184633710542, 1.0, 1.0939497456919456, 1.155844155844156, 1.0177322010361587, 1.1566820276497696, 1.1363636363636365, 1.2583065380493033, 1.1851851851851851, 1.0176306170715974, 1.0131962768110077, 1.107669616519174, 1.0, 1.0769230769230769, 1.5714285714285714, 1.5, 1.1428571428571428, 1.0687482862626816, 1.3333333333333333, 1.0782029950083194, 1.2469135802469136, 1.140606936416185, 1.0639654014840392, 1.282183316168898, 1.0267439663722666, 1.0145011600928073, 1.042857142857143, 1.5, 1.085972850678733, 1.0936170212765957, 1.0550240312713832, 1.0476190476190477, 1.5714285714285714, 1.0267260579064588, 1.0064365125804564, 1.0266836042060006, 1.0111524163568772, 1.1464387464387464, 1.0221614227086184, 1.095890410958904, 1.0907770515613653, 1.0540254237288136, 1.1538461538461537, 1.028328611898017, 1.1714285714285715, 1.0447735705525283, 1.0613393001688292, 1.0609778769287972, 1.0238095238095237, 1.2333333333333334, 1.11875, 1.0, 1.0222261288864332, 1.040744077926648, 1.0101803771522273, 1.0489643862963887, 1.1201799485861184, 1.1566571337782015, 1.8333333333333333, 1.3912751677852349, 1.0, 1.2527754056362084, 1.25, 1.027962850233722, 1.0144927536231885, 1.1181212381771282, 1.150197628458498, 1.2215686274509805, 3.0, 1.182952182952183, 1.0118076289311457, 1.0810419348905647, 2.0, 1.0476190476190477, 1.251439539347409, 1.359375, 1.1391415214619633, 1.0956719817767653, 1.2352941176470589, 1.003451251078516, 1.011776111991298, 1.0714042910559678, 1.1071950577826282, 1.1458333333333333, 1.1343283582089552, 1.123404255319149, 2.142857142857143, 1.1453488372093024, 1.5, 1.2319327731092438, 1.03125, 1.1093188701838417, 2.0833333333333335, 1.1018773313765058, 1.1196102356115416, 1.0357803824799507, 1.0, 1.1875, 1.12, 1.2830254618072892, 1.0547045951859957, 1.0, 1.0220276757977973, 1.0924583263823835, 1.0791545793617903, 1.5, 2.0, 1.0062135922330098, 1.0108695652173914, 1.0295081967213116, 1.1111111111111112, 1.0768534057913104, 1.0917525773195875, 1.4705882352941178, 1.0339736346516009, 1.0545454545454545, 1.127296587926509, 1.0298387096774193, 1.2986958350862432, 1.0406810035842293, 1.0, 1.0724637681159421, 1.080062377062253, 1.022985414623343, 1.0186784869210075, 1.0, 1.0674629506746296, 1.0085695429905406, 1.0225248821372446, 2.0, 1.0514354066985645, 1.0284330932639352, 1.0488709629934936, 1.0025774321785854, 1.0016245220072646, 1.0190002369106848, 1.0136286201022147, 1.1463355834136932, 2.0, 1.1338053646183266, 1.574468085106383, 1.25, 1.1295336787564767, 1.1346153846153846, 1.0102732304204314, 1.0556053811659192, 1.060439245369574, 1.3056447911886186, 1.0932387753346198, 1.0772352225077777, 1.0476438156662853, 1.1573033707865168, 4.0, 1.0150714199975994, 1.17165991902834, 1.0484811419342581, 1.0539175722465735, 1.0986808726534754, 1.1238300935925125, 2.548780487804878, 2.4285714285714284, 1.0094620167612869, 1.030717636179292, 1.006155040479095, 1.1168498168498169, 1.0626205167759353, 1.024742268041237, 1.0779988171688466, 1.0231788079470199, 1.1966463414634145, 3.0, 1.0909090909090908, 1.065359477124183, 1.0482374768089053, 1.0856102003642987, 1.184507042253521, 1.0745098039215686, 1.3630136986301369, 1.148905109489051, 1.1375, 1.0514440855685063, 1.2555555555555555, 1.0132885761359962, 2.0, 1.1207729468599035, 1.0357142857142858, 1.41, 1.0952513966480446, 1.0229759299781183, 1.033596837944664, 1.1297016861219196, 1.0965381661003268, 1.0, 1.297872340425532, 1.2, 1.5, 1.1477272727272727, 1.0383064516129032, 1.0123456790123457, 1.0825242718446602, 1.0656840756167896, 1.0765661252900232, 1.0596798199440955, 1.159151951540088, 1.041860465116279, 1.1165512015587788, 1.162162162162162, 1.0959792477302206, 1.0266086115142719, 1.0949023861171367, 1.1950867052023122, 1.1409664512157587, 1.0452034662747682, 1.212403216200119, 1.0772717079561416, 2.0, 1.144963144963145, 1.080919080919081, 1.4339622641509433, 1.0, 1.275, 1.25, 1.0212389380530973, 1.3333333333333333, 1.1666666666666667, 1.0001772235513988, 1.1314191498773476, 1.0260547349905584, 1.047268990593629, 1.2864864864864864, 1.1166892808683853, 1.0, 1.2125984251968505, 1.0348989585488655, 1.068066512603926, 1.0843524180100055, 1.1088392755439116, 1.0189469848788486, 1.2103896103896103, 1.1421978349177992, 1.119005328596803, 1.0333766845303496, 1.0769216287957228, 1.2727272727272727, 1.0414507772020725, 1.0, 1.2387640449438202, 1.2073956964520367, 3.0, 1.1064741709903, 1.0689814493958925, 1.4285714285714286, 1.0258684405025869, 1.5, 1.1176470588235294, 1.069883388772286, 1.6153846153846154, 1.0447046880098618, 1.063648013669372, 1.3571428571428572, 1.16, 1.068041237113402, 1.016260162601626, 1.0467991169977926, 1.0623739879028387, 1.1558768357963123, 1.0, 1.072724310232457, 1.1341463414634145, 2.0, 1.0420232027123648, 1.0715719352885198, 1.109744560075686, 1.01369352733293, 1.0863011693961446, 1.0265486725663717, 1.8571428571428572, 1.0391304347826087, 1.0016129032258065, 1.1012166358407005, 1.1863870201820341, 1.0267363652605916, 1.0457236796277463, 1.0282485875706215, 1.0843081887858008, 1.2207357859531773, 1.0716892036917793, 1.0675078864353311, 1.1196754563894524, 1.1141018139262726, 1.060765826080488, 3.0, 1.1417795405223379, 1.033012958741503, 1.0298125557869682, 1.5833333333333333, 1.2753784196639355, 1.3415841584158417, 1.1428571428571428, 1.0684912181702757, 1.0420575865415722, 1.1146288209606987, 1.0294117647058822, 1.3333333333333333, 1.0793642599011726, 1.5, 1.0023419203747073, 1.0833333333333333, 1.0063498709092178, 1.3846153846153846, 1.0886075949367089, 1.070230607966457, 1.0, 1.6164021164021165, 1.251227495908347, 1.25, 2.0, 1.1083333333333334, 1.1689655172413793, 1.022181707687633, 1.2078580481622307, 1.0921501706484642, 1.233038348082596, 1.1014466214978942, 1.051948051948052, 1.079295154185022, 1.473469387755102, 1.04, 1.0, 1.126984126984127, 1.0432900432900434, 1.0041322314049588, 1.0598440759855057, 1.0758802993771348, 1.0356791022401166, 1.0655589482109507, 1.1353383458646618, 1.1638655462184875, 1.005966587112172, 1.5714285714285714, 1.5, 1.2592592592592593, 1.0394702891401684, 1.0670785525154458, 1.107843137254902, 1.4137931034482758, 1.0542191676212296, 1.0222781417103157, 1.0121853380976185, 1.1142857142857143, 1.2222222222222223, 1.0392307692307692, 1.0012592788971368, 1.0757638145433583, 1.0563801119783305, 1.0066225165562914, 1.049616066154755, 1.0279075233921233, 1.0806658130601792, 1.3497963340122199, 1.2857142857142858, 1.0895228726020658, 1.8122448979591836, 1.1555555555555554, 1.139751552795031, 1.0701001430615165, 1.0, 1.0403800475059382, 1.0123610406195256, 1.0188679245283019, 1.0871524212101673, 1.00635593220339, 1.162162162162162, 1.039612565181248, 1.023576063446287, 1.074368788611335, 1.0505725190839694, 1.145289443813848, 1.20760880661517, 1.1814345991561181, 1.2142857142857142, 1.0, 1.4285714285714286, 1.061717330749667, 1.3333333333333333, 1.1014313307909465, 1.0812557212858758, 1.0256759827311974, 1.0315789473684212, 1.052599006812567, 1.0783494105037514, 1.028673835125448, 1.0388349514563107, 1.0059971352760233, 1.1151809148856393, 1.043434985069849, 1.2196495242683367, 1.6666666666666667, 1.0158730158730158, 1.007905138339921, 1.092360220458248, 1.022801302931596, 1.2892090241913563, 1.0161870503597121, 2.1737288135593222, 1.0473585555258025, 1.0738255033557047, 1.0876435406698564, 1.1875, 1.0597216012049044, 1.0319797734766045, 1.2628173220507715, 1.0581052631578947, 1.5238095238095237, 1.0207650273224043, 1.1292134831460674, 1.4375, 1.1081737959916242, 1.5384615384615385, 1.141542002301496, 1.1151960784313726, 1.0047425474254743, 1.0335073244653983, 1.0179640718562875, 2.2, 1.0926829268292684, 1.0894885841391229, 1.0504361353408522, 1.0196925643915102, 1.052997886271073, 1.067884684244081, 1.0833333333333333, 1.0866209262435678, 1.0379156528791564, 1.0642885843117997, 1.029058116232465, 1.0138888888888888, 1.0491958372753074, 1.0151547675267247, 1.3923154701718907, 1.0374694542492533, 1.0, 1.3333333333333333, 1.0522583994659942, 1.0028220685762663, 1.2787191198860566, 1.0981188027059587, 1.0782122905027933, 1.0739856801909309, 1.115316753900898, 1.0801511794604457, 1.1176470588235294, 1.0393258426966292, 1.0609212481426449, 1.0575884749423257, 1.119047619047619, 1.75, 1.0441762299064008, 1.1754577264220034, 1.0005704506560182, 1.0454545454545454, 1.2313540912382333, 1.0453570779574777, 1.151532190047793, 1.3513513513513513, 1.3076923076923077, 1.059299191374663, 1.0698198198198199, 1.15625, 1.34375, 1.0382053860766567, 1.184340931615461, 1.165837479270315, 1.048780487804878, 1.0193934530377504, 1.0437956204379562, 1.0642904953145917, 1.2644087938205586, 1.3333333333333333, 1.3333333333333333, 2.0, 1.1389759665621735, 1.3846153846153846, 1.0, 1.1538461538461537, 1.0013262599469497, 1.036231884057971, 1.0123437661398615, 1.0701649737541754, 1.1836363636363636, 1.3076923076923077, 1.1428571428571428, 1.032258064516129, 1.1216216216216217, 1.1, 1.1030927835051547, 1.0299230732863713, 1.0325813513413231, 1.3473684210526315, 1.0958193991369347, 1.0479405435163405, 2.5, 1.0661086727229423, 1.364522417153996, 3.0, 2.0, 1.1952662721893492, 1.112457864161228, 1.0826070139247035, 1.2111801242236024, 1.0, 1.0661157024793388, 1.156441717791411, 3.0, 2.0, 1.062746062992126, 1.215889232423713, 1.0037626991094946, 1.6666666666666667, 1.0297824494454761, 1.0464756003098374, 1.0230849947534102, 1.0, 1.0234741784037558, 1.0240715433945249, 1.0526315789473684, 1.1847182917417032, 1.0241940289613254, 1.2801204819277108, 1.0625, 1.0958159753667813, 1.07926267281106, 1.0743801652892562, 1.2545454545454546, 1.0175370961259258, 1.1820153245626717, 1.077798612189325, 1.336, 1.0490196078431373, 1.2388059701492538, 1.1077348066298343, 1.0504800247754722, 1.0007585814526834, 1.087848246790573, 1.0600436681222707, 1.5, 1.6666666666666667, 1.0551045195934283, 1.154353562005277, 1.0816961680606887, 1.0123832549919614, 1.0635557785582874, 1.103419341304804, 1.1574803149606299, 1.0909090909090908, 1.1456646490055813, 1.0879271023812949, 1.2243867243867244, 1.0577933450087567, 2.5, 1.056338028169014, 1.0237353062680739, 1.085884795018163, 1.0131013338390542, 1.0843666734986677, 1.0383522727272727, 2.0, 1.0974358974358975, 1.0130680752985808, 1.1512451450765364, 1.0570342205323193, 1.0723430124445716, 1.0541401273885351, 1.1236203090507726, 1.0052173913043478, 1.0331761982007484, 1.0861604512164325, 1.0241935483870968, 1.0413333333333334, 1.0, 1.2278640369282416, 1.0592604442819271, 1.01747311827957, 1.0596832574018886, 1.1259398496240602, 1.0559757942511347, 1.2, 1.2046035805626598, 1.6666666666666667, 2.0, 1.1764705882352942, 1.0025641025641026, 1.0442338072669826, 1.011548887816109, 1.009551032392335, 1.035549525101764, 1.0299504417151475, 1.1467391304347827, 1.183673469387755, 1.0317978071929124, 1.6, 1.5, 1.1727688787185355, 1.1428571428571428, 1.1109467455621302, 1.1335326357747881, 1.0482804232804233, 1.0973040528477058, 2.0, 1.0541795665634675, 1.189922480620155, 1.189557994660338, 1.039987339101076, 1.1742424242424243, 1.126027397260274, 1.1579291528557578, 1.1501949378055574, 1.0031796502384738, 1.4489795918367347, 1.106145251396648, 1.0, 1.0, 1.041879761095812, 5.0, 1.5714285714285714, 1.7419354838709677, 1.0048484848484849, 1.0444444444444445, 1.0920177383592018, 1.0914083954491958, 1.0, 1.106145251396648, 1.012266355140187, 1.1861702127659575, 1.3052884615384615, 1.4285714285714286, 1.0431173622319576, 1.1208425720620843, 1.1521252796420582, 1.0568984752696169, 1.0129493811800143, 1.0541280937086719, 1.069801833776989, 1.0, 1.1435884418496425, 1.0379391534679907, 1.012897366030881, 1.1774193548387097, 1.0711932461649336]
origin-bjaq_15.71 	max: 5.0000	99th: 2.5005	95th: 1.7500	median: 1.0833	mean: 1.1754

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 13.937108 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[5.9604645e-07 1.7881393e-07 1.7881393e-07 1.1920929e-07 1.7881393e-07]
Distance score: 2.5033949668795685e-07
SAUCE Drift detection: False
Detection latency: 0.0232s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.042877 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 3.0000	95th: 1.6667	median: 1.0840	mean: 1.1878
ReportEsts: [1.0899182561307903, 1.0131090233777584, 1.0629935986775025, 1.0671256454388984, 1.565217391304348, 1.0, 1.0483661302613294, 1.0557587915978286, 1.1666666666666667, 1.0153677277716795, 1.0965108719208263, 1.0415893850763305, 1.0160370634354954, 1.1326923076923077, 1.081680970701391, 1.0833333333333333, 1.1645569620253164, 1.5135135135135136, 1.2727272727272727, 1.2231473771856787, 1.1045707156629239, 1.0224291710388247, 1.034535686876439, 1.0378657487091223, 1.004464675003052, 1.0238015978695074, 2.0, 1.161662887377173, 1.4, 1.1428571428571428, 1.0464396284829722, 1.0, 1.05150104862197, 1.0103091198031475, 1.1979458450046685, 1.0582262996941896, 1.2512695725772323, 1.1565995525727069, 1.0, 1.1053497942386832, 1.0413337007440067, 1.0122796383290398, 1.176774193548387, 1.1661936297697888, 1.0073260073260073, 1.134866287032365, 1.5263157894736843, 1.0849090260435248, 1.187793427230047, 1.0336856010568032, 1.25, 1.3140096618357489, 1.0323886639676114, 1.0285714285714285, 1.046811431423936, 1.0091459646520826, 1.0207376478775225, 1.1955922865013775, 1.0, 1.0441020384095507, 1.3142857142857143, 1.0431065437819538, 1.0804953560371517, 1.040590405904059, 1.019047619047619, 2.0, 1.0994015009974982, 1.2472896231285493, 2.0, 1.0, 1.083896003104385, 1.0130784708249496, 1.0662155630739487, 1.02504816955684, 1.09643997818805, 1.003968253968254, 1.008197386575765, 1.0, 1.4660194174757282, 1.1338574758879187, 1.0052681992337165, 1.1118881118881119, 1.0, 1.04, 1.0857787810383748, 1.046875, 1.1224489795918366, 1.3333333333333333, 1.5, 1.0949927187184945, 1.1088618983355825, 1.35451224624229, 1.047833427124367, 1.1217132769673883, 1.0335917312661498, 1.0270906949352179, 2.1666666666666665, 1.0924479166666667, 1.125, 1.3294774631033108, 1.2142857142857142, 3.0, 1.0397306282207959, 1.1258620689655172, 1.0714285714285714, 1.2193714838570968, 1.3103448275862069, 1.0144306415509274, 1.0860119707381954, 1.3264888929269067, 1.1155905511811024, 1.0530517640999228, 1.125, 1.5, 1.0457882534775889, 1.0772993186354356, 1.0489101541733121, 1.1290322580645162, 1.0568712195734529, 2.0, 1.0910044584316811, 1.1665089877010406, 1.0, 1.0480769230769231, 1.0, 1.1887966804979253, 1.018204652725981, 1.0600596705149825, 1.1147540983606556, 1.6666666666666667, 1.0968188105117567, 1.0, 1.1111111111111112, 1.1214746543778802, 1.3076923076923077, 1.0640287769784174, 1.0475760417752151, 1.0501130369253957, 5.0, 1.5, 1.0360169491525424, 1.094070441373161, 1.091141833077317, 1.0028646891507518, 1.186335403726708, 1.0337950138504155, 1.1153331847559618, 3.0, 1.003741114852226, 1.0193423597678917, 1.075885328836425, 1.0868482718219097, 2.0, 1.196181432467926, 1.0354430379746835, 1.0134453781512605, 1.1420389461626574, 1.0, 1.0127161749745677, 1.119440405154691, 1.0777332199133147, 1.1006944444444444, 1.093150684931507, 1.271186440677966, 1.3898305084745763, 1.053817271589487, 1.4444444444444444, 1.0533221114895424, 1.3255813953488371, 1.0850785340314135, 1.0684200110661017, 1.0049244060475162, 1.0557265241620228, 1.2568027210884354, 1.037243947858473, 1.0413536871012035, 1.1226053639846743, 1.0362694300518134, 1.048, 1.057431534166445, 1.0019309161124221, 1.214901940464779, 1.165644171779141, 2.0, 1.0041790576109644, 1.0175277904991882, 1.3333333333333333, 1.2669034786869182, 1.0509708737864079, 2.3333333333333335, 1.2364672364672364, 1.0692888847591615, 1.4736842105263157, 1.1603288797533402, 1.1007848951886061, 1.0216822684877316, 1.0736472990367971, 1.069790628115653, 1.0517002748889872, 1.0089377888970528, 1.0226244343891402, 1.0290625923415202, 1.0418538661622132, 1.0547117136300186, 1.0493653032440056, 1.0375809541183982, 1.0544554455445545, 1.196969696969697, 1.1904761904761905, 1.0, 1.4338235294117647, 1.129164192888713, 1.2055555555555555, 1.4313725490196079, 1.0300751879699248, 1.0, 1.0433274005357496, 1.027027027027027, 1.221530852379243, 2.6666666666666665, 1.1755005889281507, 1.0219840615553724, 1.0332961777713854, 1.0155951562380625, 2.0, 1.2857142857142858, 1.086030328891223, 1.0218167174644284, 1.0108695652173914, 1.0289115646258504, 1.1203761755485893, 1.1040199481079624, 1.2923076923076924, 1.004858706840086, 1.0696838563114168, 1.107361963190184, 1.0931326434619002, 1.0146067415730338, 2.0, 1.1644649933949802, 2.0, 1.1912491178546225, 1.1292498023347752, 1.2287937743190662, 1.3058823529411765, 1.0714285714285714, 1.5, 1.0404911027862327, 1.1967213114754098, 1.1101524046729525, 1.4, 1.0425531914893618, 1.0265486725663717, 1.4285714285714286, 1.008831829563973, 1.0091116173120729, 1.1108179419525066, 1.036220472440945, 1.0144061841180605, 1.1414380855627047, 1.0806451612903225, 2.0, 1.0989479280098091, 1.1019931878390312, 1.1434720229555237, 1.0307272284631168, 1.180791525084949, 1.0504381247400651, 1.0676642810670136, 1.0780294699802067, 1.0109181141439205, 1.004885993485342, 1.0334800860038906, 1.0769230769230769, 1.0013214006847257, 1.1124260355029585, 1.1886792452830188, 1.3043478260869565, 1.1942196531791907, 1.0516194331983806, 1.0226043276661514, 1.039979572481214, 1.070615034168565, 1.3800424628450105, 1.0334905684022677, 1.0657698056801195, 1.234756995581738, 1.0651816464313815, 1.3, 1.1820224719101124, 1.0434265318262939, 1.0643848373707991, 1.061651376146789, 1.0399949411160792, 1.1358866736621196, 1.1661092530657748, 1.0030602804070885, 1.0684205159579891, 1.1632815611310234, 1.0045327342241142, 1.022878932316492, 1.25, 1.1428571428571428, 1.089213178877689, 4.0, 1.0108303249097472, 1.1161639597834494, 1.0835758835758835, 1.4594594594594594, 1.0737704918032787, 1.0725075528700907, 1.140120793787748, 1.0479652060377758, 1.2857142857142858, 1.2052243176759987, 1.0256311253319725, 1.2361111111111112, 1.5, 3.7142857142857144, 1.014454664914586, 1.25, 1.0052329512499159, 1.0523809523809524, 1.0952380952380953, 1.115564934694576, 1.375, 1.3333333333333333, 1.0123817409841265, 3.0, 1.070460704607046, 1.0312876052948254, 1.0447962626524785, 1.0804597701149425, 1.1848101265822786, 1.0, 1.1012692472439525, 1.0878691362532882, 1.1063829787234043, 1.0473237012870613, 1.020264681555004, 3.0, 1.1, 1.0557411690796425, 1.5, 1.0649953574744662, 1.2857142857142858, 1.0, 1.368421052631579, 1.3085904920767306, 1.0590979782270606, 1.347457627118644, 1.0545073375262055, 1.3205128205128205, 1.5, 1.1183038438071995, 1.2173913043478262, 1.1594202898550725, 1.0037124154762547, 1.0952380952380953, 1.0357686453576864, 1.0084190832553788, 1.4, 1.0, 1.249613601236476, 1.4173913043478261, 1.040959040959041, 1.1307660406422182, 1.2354683450573862, 1.0227272727272727, 1.5, 1.0329556468160532, 1.0093457943925233, 1.4444444444444444, 1.0, 1.0587275693311582, 1.1428571428571428, 1.4030172413793103, 1.1717171717171717, 1.1037301754140099, 1.1040516189036795, 1.0980049875311721, 1.1623451061739178, 1.1120654945644879, 1.1074523396880416, 1.0973451327433628, 1.0651190092973055, 1.1077441077441077, 1.054054054054054, 1.014952385056233, 1.0838209950192224, 1.0967117988394584, 1.009478672985782, 1.0, 1.151639344262295, 3.0, 1.0212765957446808, 1.6951219512195121, 1.1903846153846154, 1.2929936305732483, 1.088235294117647, 1.068891280947255, 1.036076662908681, 1.1238379433031103, 1.1249045072574484, 1.063936634024972, 1.1862745098039216, 1.0731707317073171, 1.117948717948718, 1.0, 1.0820192789881318, 1.54, 1.1036287047356392, 1.0168701652884182, 1.0564313265135, 1.13342175066313, 1.375, 1.422527158376215, 1.1666666666666667, 1.1777777777777778, 1.1818181818181819, 1.1006606805423373, 1.027127003699137, 1.0992242467977629, 1.1153846153846154, 1.0857712765957446, 4.0, 1.269748928352725, 1.006312861661124, 1.0873344847438111, 2.0, 1.1012658227848102, 1.243352135374698, 1.3266666666666667, 1.0936503629333152, 1.009771986970684, 1.0, 1.0158045977011494, 1.0040610722792769, 1.066844521035974, 1.0890644853875477, 1.1144812010096985, 1.0137708760621154, 1.4, 1.023394495412844, 1.095094694506418, 1.0236220472440944, 1.0780993992353904, 1.0, 1.5, 1.1839156229400132, 1.0881226053639848, 1.045940170940171, 1.1518635321100918, 1.067421513124035, 1.0, 1.2678571428571428, 1.0303030303030303, 1.0788367203924316, 1.173913043478261, 1.0, 1.0787822637588993, 1.3333333333333333, 2.0, 1.0034181541967337, 2.6666666666666665, 1.0191807542262679, 1.0166163141993958, 1.010840108401084, 1.0833333333333333, 1.0811035794981567, 1.0822259136212624, 1.4, 1.1282357001662955, 1.0454545454545454, 1.09375, 1.0416382252559726, 1.2777972641178534, 1.0612141224282448, 1.0, 1.0, 1.1737481921588555, 1.1577943471475638, 1.0620031796502385, 1.25, 1.0813414860107466, 1.0002981514609421, 1.0165002171081199, 2.0, 1.0436507936507937, 1.0229655766956034, 1.034683072699642, 1.0767321311236038, 1.0130579070638248, 1.0098614414618492, 1.0417276720351392, 1.0350701173017165, 2.0, 1.0292359946687304, 1.1129296235679214, 1.0389235944257569, 1.0316248636859324, 1.0050251256281406, 1.0151928808119541, 1.226932668329177, 1.0433941690080308, 1.0452905811623245, 1.1163495397218477, 1.1060507482108002, 1.0804110340699355, 1.0434269530328062, 1.0574712643678161, 1.2876712328767124, 1.0897455383719015, 1.0622317596566524, 1.0085661080074488, 1.0637147413535333, 1.3333333333333333, 1.1242424242424243, 1.4438202247191012, 3.0, 1.2083333333333333, 1.0134760712131996, 1.1418181818181818, 1.0212765957446808, 1.0, 1.0588235294117647, 1.0089102124742975, 1.1325067275266547, 1.0516887479007277, 1.0295661077691027, 1.1341802302500992, 1.1377276224672994, 1.0214614205416455, 1.0066460745707133, 1.56, 1.0330477356181151, 1.116138398257924, 1.0980392156862746, 1.4267649488466672, 1.0634920634920635, 1.0056924045590636, 2.0, 1.2882672882672883, 1.0336700336700337, 1.3348314606741574, 1.0907079646017699, 1.0018298261665142, 1.104882459312839, 1.0792079207920793, 1.086392112118146, 1.0, 1.3148148148148149, 1.1428571428571428, 1.0, 1.1037735849056605, 1.1666666666666667, 1.0077319587628866, 1.1178861788617886, 1.0683794995316473, 1.054172767203514, 1.0446269882757075, 1.1775145067698258, 1.046417669240438, 1.0401977069237938, 1.0145424931650282, 1.1078860898138008, 1.0385808452888716, 1.0430604428113226, 1.05995085995086, 1.091510474090408, 1.163659793814433, 1.0497237569060773, 1.010767599314789, 1.17096018735363, 1.1005090308759655, 1.3352601156069364, 1.1977836665863648, 1.1643730886850152, 1.5, 1.025089605734767, 1.2222222222222223, 5.0, 1.4135021097046414, 1.0511465093411996, 1.0486877139596804, 1.010443864229765, 1.1043956043956045, 1.0953839597261807, 1.0070483814827706, 1.105072463768116, 1.0, 1.75, 1.0758072871697462, 1.1069767441860465, 1.082797427652733, 1.103609939052977, 1.0, 1.1669376693766937, 1.1912087912087912, 1.1259825977345541, 1.167420814479638, 1.0263270867552636, 1.055177054420052, 1.0058584359387086, 1.4886363636363635, 1.0, 1.156855498653714, 2.0, 1.058343057176196, 1.2543859649122806, 1.3734265734265734, 1.0526315789473684, 1.44, 1.0449139620997605, 1.1118881118881119, 1.0791666666666666, 1.0120358668833123, 1.2593548387096773, 1.1422924901185771, 1.0393570384802728, 1.0063520871143377, 1.0684027777777778, 1.2, 1.054999596481317, 1.0794957282767244, 1.2, 1.0246575342465754, 1.1975633528265108, 1.0121951219512195, 1.003779364849188, 1.3333333333333333, 1.1955017301038062, 1.108672113396988, 1.0119047619047619, 1.1485714285714286, 1.0785075892172689, 1.0075187969924813, 1.75, 1.0270805812417436, 1.047361299052774, 1.1223462897526502, 1.1237531172069826, 1.0034889022195561, 1.0951736580965268, 1.1783536585365855, 1.0974547890154052, 1.210958904109589, 1.059473963554874, 1.059748427672956, 1.0775577557755776, 1.0219106047326907, 1.039159996557363, 1.114795918367347, 1.0863473444118605, 1.4736842105263157, 1.6, 1.045398773006135, 1.6201505500868558, 1.0416407706650093, 1.1174603174603175, 1.0769230769230769, 1.0353982300884956, 1.0325615050651231, 1.1144578313253013, 1.0530491780774907, 2.6666666666666665, 1.1213915618060695, 1.5, 1.08984375, 1.2, 1.010688663626594, 1.3, 1.2340425531914894, 1.0533683289588802, 1.0, 1.2691960252935863, 1.246922024623803, 1.2, 2.0, 1.034965034965035, 1.152112676056338, 1.135012737050665, 1.2148148148148148, 1.0743919885550788, 1.0118343195266273, 1.093198992443325, 1.0342465753424657, 1.0942028985507246, 1.3771043771043772, 1.1666666666666667, 1.0, 1.2563025210084033, 1.0971223021582734, 1.0052219321148825, 1.1305365853658536, 1.0831309752692986, 1.0569070215628522, 1.078080693885872, 1.2379346680716543, 1.1268571428571428, 1.015617128463476, 2.142857142857143, 1.0, 1.303030303030303, 1.0107462266744232, 1.0285103349964362, 1.1059782608695652, 1.1478060046189376, 1.0150559773516923, 1.040316398355286, 1.0134868607387648, 1.1219512195121952, 1.2380952380952381, 1.588235294117647, 1.1239916012819096, 1.0673591352764202, 1.006591796875, 1.0677966101694916, 1.0592383638928067, 1.120908669448308, 1.05615078842762, 1.0840210052513128, 1.079810772496221, 1.134020618556701, 1.0934426229508196, 1.0364145658263306, 1.036688061695594, 1.4285714285714286, 1.103775211170488, 1.0, 1.0255905511811023, 1.0294742395424066, 1.263157894736842, 1.0532145628685323, 1.0044365572315883, 1.1818181818181819, 1.0107407104606958, 1.0351766328795058, 1.0410576036222365, 1.043069694596711, 1.0150517403574788, 1.1948769744409842, 1.2122302158273381, 1.105263157894737, 1.0, 1.5555555555555556, 1.0668297317511977, 1.6666666666666667, 1.0849101098657197, 1.1111086196071396, 1.1032854209445586, 1.0738044017871917, 1.077662768647282, 1.0993190059255329, 1.0489296636085628, 1.0233100233100234, 1.012452939472922, 1.1343977799058023, 1.043320832794517, 1.2420292761179066, 1.5, 1.2, 1.02, 1.1325503355704698, 1.0448179271708684, 1.296, 1.038863976083707, 2.3345588235294117, 1.0252578930915912, 1.0044198895027625, 1.0727018943170488, 1.2222222222222223, 1.046461229192714, 1.03836994008502, 1.2619146290924161, 1.0564120532585843, 1.0285714285714285, 1.0600801068090788, 1.0384615384615385, 1.0600401901681125, 1.0170212765957447, 1.0191301664429793, 1.2857142857142858, 1.0264858339842362, 1.0889589905362775, 1.0239294710327456, 1.280701754385965, 1.1203155818540433, 1.0463510848126232, 1.0727453911310414, 1.009305584916888, 1.061904761904762, 1.0941842105263158, 1.0616353201393607, 1.1428571428571428, 1.0761024182076813, 1.0459525756336876, 1.581896551724138, 1.1749271137026238, 1.0723905723905724, 1.123629112662014, 1.05879345603272, 1.0608365019011408, 1.0345216061800917, 1.0833333333333333, 1.1030867792661618, 1.24150882436089, 1.0618828176431863, 1.1238938053097345, 1.108351001278959, 1.1009198423127464, 1.0453648915187377, 1.0386847195357833, 1.1143307448572508, 1.0920814355484827, 1.0944527736131935, 1.04739336492891, 1.0318318318318318, 1.0966502875706157, 1.088235294117647, 1.6, 1.0607968564379056, 1.1577052778075152, 1.0420375865479723, 1.0382775119617225, 1.2531032394792614, 1.0122914065659674, 1.1763046544428772, 1.0209603658536586, 1.1470588235294117, 1.0794886047804335, 1.0065502183406114, 1.092964824120603, 1.3333333333333333, 1.0226963950047459, 1.1814449917898193, 1.6, 1.1020408163265305, 1.0434035238504513, 1.2600359496704614, 1.08, 1.0909090909090908, 1.0422622747047856, 1.0121457489878543, 1.2045328911000552, 1.0714285714285714, 1.023516863589765, 1.0498220640569396, 1.010559662090813, 1.25, 1.6666666666666667, 1.2651982378854625, 1.0044635809113742, 1.0114908622839598, 1.007256894049347, 1.234375, 1.1764705882352942, 1.1428571428571428, 1.065934065934066, 1.1204819277108433, 1.0435775451950524, 1.0286880633798854, 1.031817465297203, 1.293103448275862, 1.0680688554491564, 1.0467739986079911, 3.5, 1.082288458273713, 1.0325655281969817, 2.0, 2.5, 1.19470559129144, 1.1357147123827729, 1.0473953841197925, 1.28, 1.5, 1.1529850746268657, 1.164490861618799, 1.2580645161290323, 1.0234331574790096, 1.1173233425281677, 1.0568069514309457, 1.068581538141326, 1.5714285714285714, 1.0235725495952217, 1.0352564102564104, 1.0422778257118206, 1.1921824104234529, 1.0235849056603774, 1.0, 1.329268292682927, 1.17536578877361, 1.0098013844859934, 1.065217391304348, 1.1311475409836065, 1.1015381509381585, 1.0625954198473282, 1.0792079207920793, 1.1549295774647887, 1.0313753130688272, 1.2109720176730485, 1.0461132687960117, 1.1404494382022472, 1.188034188034188, 1.4316239316239316, 1.0, 1.0925410089755494, 1.0568475452196382, 1.0128799295574897, 1.046875, 1.5, 1.0893169877408055, 1.035791396777944, 1.1509365994236311, 1.07178658043654, 1.0783983849259757, 1.0420671402702326, 1.112110459192636, 1.0116959064327486, 1.0, 1.0659506189010413, 1.0782568508977628, 1.2127153891859774, 1.049624060150376, 2.0, 1.0602409638554218, 1.0042595620202495, 1.0363636363636364, 1.0066604346810002, 1.0829162875341218, 1.007728894173603, 2.0, 1.0763598326359833, 1.0008644393559007, 1.1767175572519084, 1.190938511326861, 1.0656869028632752, 1.044502617801047, 1.2708142726440987, 1.0090261282660333, 1.0305505690644134, 1.1322844907838392, 1.0210526315789474, 1.0706955530216649, 1.0555555555555556, 1.2071046732195205, 1.0585928935319533, 1.05407569858558, 1.023115399413976, 1.0971074380165289, 1.0417721518987342, 1.2666666666666666, 1.243956043956044, 2.0, 1.6666666666666667, 1.0909090909090908, 1.0043196544276458, 1.0398671096345515, 1.0274364104029723, 1.0044369148461882, 1.0414299242424243, 1.0329096291137037, 1.1428571428571428, 1.1137184115523466, 1.0520441530029072, 1.6666666666666667, 1.375, 1.104964114832536, 1.375, 1.0803897685749086, 1.1578059071729958, 1.028438856458614, 1.0974516392943834, 2.0, 1.0949792960662525, 1.174757281553398, 1.1044229309035687, 1.0398645963871993, 1.1460084033613445, 1.0992108229988726, 1.1352723915050784, 1.0995235054281083, 1.0365853658536586, 1.072289156626506, 1.0940070505287895, 1.3333333333333333, 2.0, 1.041030338915515, 5.0, 1.1818181818181819, 2.1379310344827585, 1.027327935222672, 1.066776610017889, 1.0027979854504756, 1.0112781954887218, 1.1666666666666667, 1.248854353456864, 1.0201672405312345, 1.2703777335984094, 1.246124031007752]
origin-bjaq_15.71 	max: 5.0000	99th: 3.0000	95th: 1.6667	median: 1.0840	mean: 1.1878

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.116387 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.152979