Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 74, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.6802	95th: 1.6950	median: 1.0843	mean: 1.1760
ReportEsts: [1.0430463576158941, 1.0169270833333333, 1.0521606411758748, 1.0947368421052632, 1.5, 1.0, 1.0596819864953169, 1.0704138386574893, 1.0, 1.020969855832241, 1.1293971661905173, 1.0425957728766346, 1.007191201353638, 1.0883720930232559, 1.0582832921229248, 1.0, 1.2328767123287672, 1.006376195536663, 3.0, 2.0, 1.173913043478261, 1.1146098745252633, 1.1027233886398784, 1.1197886083382267, 1.0710409472126294, 1.0, 1.176140118968936, 1.5, 1.4, 1.0, 1.0, 1.0491248458610931, 1.0078336449977856, 1.2597114317425082, 1.004129184486064, 1.2307115480753208, 1.1550802139037433, 1.019790113857537, 1.1272126179488946, 1.0120481927710843, 1.1190817790530847, 1.021341463414634, 1.0, 1.0300395937338613, 1.0893967400436901, 1.8615384615384616, 1.0510204081632653, 1.265017667844523, 1.0313559666598902, 1.0925925925925926, 1.0992796991684763, 1.1391752577319587, 1.0390391627696174, 2.0, 1.103896103896104, 1.2256109256914873, 1.0878164556962024, 1.3793103448275863, 1.158273381294964, 1.25, 1.1474918211559433, 1.0902864259028642, 1.0681818181818181, 1.0357142857142858, 1.0909090909090908, 1.1711934490027567, 1.3774923960797567, 1.75, 1.0, 1.0588293357023, 1.0286396181384247, 1.0683411214953271, 1.0254041570438799, 1.1505133369356977, 1.0658823529411765, 1.0485436893203883, 1.0, 1.1089770354906054, 2.0, 1.0331142930930586, 1.0, 1.0472916848823992, 1.1533742331288344, 1.10941475826972, 1.1231599607458291, 1.04, 1.064179965391271, 1.0131783037522053, 1.0637254901960784, 1.75, 1.1537275064267352, 1.0753833575474527, 1.074766355140187, 1.0070126227208975, 1.0320452403393026, 1.0675324675324676, 1.0222222222222221, 1.1615460852329038, 1.0, 1.243426162210141, 1.0337898183983327, 1.1063464837049743, 1.2197210983902902, 1.3076923076923077, 1.0192657581080529, 1.068224050968941, 1.233881995441884, 1.1588926810769815, 1.0462906192519927, 1.3333333333333333, 2.0, 1.0535046728971962, 1.0727709310995133, 1.0593809222994315, 1.2597402597402598, 1.0578986381225186, 1.0, 1.1040681173131504, 1.1069915254237288, 1.0, 1.021978021978022, 1.0, 1.1979949874686717, 1.028941625074724, 1.0680282674535995, 1.12, 1.8, 1.1423841059602649, 1.0, 1.037037037037037, 1.0987618979460387, 1.1818181818181819, 1.0817057291666667, 1.0258687282935683, 1.1368533523283768, 1.020026702269693, 1.0369318181818181, 1.049103663289166, 1.039972432804962, 1.0658135283363803, 1.0405524338230316, 1.2461538461538462, 1.0071754729288975, 1.1202127271178397, 2.0, 1.0214220601640838, 1.056, 1.108665749656121, 1.131815775542615, 1.5, 1.236497941390167, 1.0546875, 1.002004008016032, 1.1074561403508771, 1.164963503649635, 1.0602323503127793, 1.1277930457641294, 1.0699020695643784, 1.060483870967742, 1.075657894736842, 1.3265306122448979, 1.3529411764705883, 1.004418262150221, 1.5714285714285714, 1.0826078526417837, 1.0277470663138872, 1.1412614980289093, 1.3626191866121813, 1.1360166551006246, 1.0064015363687284, 1.2021052631578948, 1.0672645739910314, 1.1027403892708434, 1.0303336703741153, 1.0371009490940466, 1.0826044703595723, 1.0492532570702255, 1.1148928818244643, 1.0164032397578044, 1.0, 1.105263157894737, 1.0272542766019137, 1.0281100478468899, 1.2336832496576906, 1.1578947368421053, 1.0823815994026416, 1.342494714587738, 1.1107287405579724, 1.1372549019607843, 1.205, 1.0896538797950768, 1.0, 1.2727272727272727, 1.03035216830901, 1.0513126491646778, 1.0221489161168709, 1.2962962962962963, 1.0617363344051447, 1.0422316652707626, 1.0809916314139374, 1.0626410835214446, 1.0122272583535363, 1.0677966101694916, 1.0666666666666667, 1.2352941176470589, 1.0, 1.4414414414414414, 1.1349156284497712, 1.3763066202090593, 1.206896551724138, 1.0074147305981216, 1.0031277926720286, 1.032714083510262, 1.0017201198535124, 1.1235405720957385, 1.2571428571428571, 1.0202312138728324, 1.0132858068697344, 1.0466425412143143, 1.0439447080668454, 1.0, 1.074120082815735, 1.080062237803557, 1.0168415317125423, 1.146177370030581, 1.0472110031655932, 1.2817260259120724, 1.0357142857142858, 1.0056792316036172, 1.1186178442496133, 1.0039481105470953, 1.0971428571428572, 1.0694321206743567, 1.0189555125725338, 1.2716535433070866, 2.0, 1.1844388469073608, 1.0863666815542652, 1.169479606188467, 1.0387596899224807, 1.0, 1.6666666666666667, 1.1959691176729217, 1.1090909090909091, 1.1283888949216345, 1.5, 1.0, 1.0256410256410255, 1.0530835284933646, 1.0888888888888888, 1.0055248618784531, 1.1466244725738397, 1.0366056572379367, 1.0037783375314862, 1.0565416852170884, 1.0363636363636364, 2.0, 1.067557008615549, 1.0556279878313777, 1.1506129597197898, 1.0451951418358174, 1.1575141110065852, 1.0295324451648853, 1.0945945945945945, 1.1034980546802104, 1.0227272727272727, 1.041244573082489, 1.0572578551025709, 1.1818181818181819, 1.0068576819341808, 1.2245430809399478, 1.2045454545454546, 1.25, 1.0177646188008882, 1.0555555555555556, 1.1025641025641026, 1.10665500302806, 1.0557103064066853, 1.4285714285714286, 1.0052906027424517, 1.0461409395973154, 1.0286687935527492, 1.055352103211934, 1.25, 1.036249545289196, 1.6666666666666667, 1.0544210535537508, 1.0, 1.0397888125256018, 1.0526315789473684, 1.6666666666666667, 1.3478260869565217, 1.0757575757575757, 1.061145141530724, 1.0, 1.0122324159021407, 1.085972850678733, 1.0080128205128205, 1.0175903768412249, 1.0384615384615385, 1.150943396226415, 1.0077125228519195, 1.0996484460069067, 1.082885847912697, 1.1196581196581197, 1.0, 1.1276849642004774, 1.2453987730061349, 1.1107266435986158, 1.080497051390059, 1.0217298679164892, 1.0725075528700907, 1.2826086956521738, 1.0013717421124828, 1.0186596583442837, 1.2857142857142858, 1.01302816765001, 1.05, 1.1875, 1.0997564579684764, 1.2380952380952381, 1.4, 1.0024894862528795, 2.0, 1.1632373113854595, 1.0537790697674418, 1.0894175553732568, 1.0648409182440597, 1.1462140992167102, 1.0833333333333333, 1.1054667947347772, 1.0501529498632782, 1.02945301542777, 1.0379237270104427, 1.1050972553240563, 2.0, 1.0, 1.0403117073059256, 1.25, 1.07035175879397, 1.3529411764705883, 1.0, 1.375, 1.4126506024096386, 1.0569561157796452, 1.1217391304347826, 1.0692640692640694, 1.0, 1.1597869507323568, 1.0789956401531264, 2.0, 1.1179273377010126, 1.0, 1.0941926668184925, 1.0987654320987654, 1.0432235635487668, 1.1451612903225807, 1.1363636363636365, 1.3044444444444445, 1.2777777777777777, 1.0082221843281756, 1.0251848406128485, 1.1225710014947683, 1.0, 1.0769230769230769, 1.5714285714285714, 1.5, 1.2307692307692308, 1.0690780676792264, 1.3333333333333333, 1.0715474209650582, 1.2625, 1.1541498508510264, 1.0654476967746997, 1.2203913491246139, 1.0242762008218014, 1.0081206496519721, 1.0702380952380952, 1.5, 1.4285714285714286, 1.1531914893617021, 1.0411719988354413, 1.0952380952380953, 1.5714285714285714, 1.006726457399103, 1.013553329404832, 1.0290430451298769, 1.0461538461538462, 1.1464387464387464, 1.0049247606019152, 1.0666666666666667, 1.0907770515613653, 1.0847457627118644, 1.1730769230769231, 1.0269121813031161, 1.0884955752212389, 1.0619526281737703, 1.1050410556478605, 1.0409801179546423, 1.131578947368421, 1.2065217391304348, 1.1049382716049383, 1.0, 1.0117389978656368, 1.066141250621269, 1.0209460237081367, 1.058423347949568, 1.0677966101694916, 1.1471242453129966, 1.5714285714285714, 1.0962453728186146, 1.2, 1.210930828351836, 1.25, 1.0316675634472245, 1.0217391304347827, 1.122098022355976, 1.134387351778656, 1.003220611916264, 3.0, 1.256532940743467, 1.016060296986075, 1.169302924406842, 2.0, 1.0158730158730158, 1.3051823416506718, 1.380952380952381, 1.1171591714249989, 1.0187110187110187, 1.1666666666666667, 1.3278688524590163, 1.0245683771940328, 1.0083366265831122, 1.1096169996679752, 1.236951754385965, 1.165837479270315, 1.306930693069307, 1.875, 1.0735694822888284, 1.5, 1.2247284878863827, 1.121212121212121, 1.1343272832036877, 1.7857142857142858, 1.0907384987893463, 1.0890890030761828, 1.0709438618136953, 1.0, 1.163265306122449, 1.08, 1.287460548068734, 1.1663019693654266, 1.0, 1.0890761360216672, 1.1158925423217831, 1.0348114380439286, 1.5, 2.0, 1.0198058252427185, 1.0054054054054054, 1.0327868852459017, 1.2222222222222223, 1.0740399603230835, 1.09400826446281, 1.4705882352941178, 1.0735969868173258, 1.0454545454545454, 1.1824146981627297, 1.0612903225806452, 1.2208666386201095, 1.0519927536231883, 1.0, 1.0571428571428572, 1.094354867669767, 1.0336714060789156, 1.0075200155586528, 1.0, 1.092678610926786, 1.0030896321663214, 1.0220010476689365, 2.0, 1.0338915470494419, 1.0213737888587022, 1.0706360713610288, 1.0295312568258268, 1.0163874292330877, 1.0340203743188818, 1.0050675675675675, 1.1202989392478302, 2.0, 1.0093544886040622, 1.6444444444444444, 1.25, 1.1761658031088082, 1.1346153846153846, 1.0081852432234188, 1.1817269076305221, 1.0490567119674292, 1.1294171638366224, 1.0636412556053811, 1.0065350578624914, 1.0568674364575747, 1.2261904761904763, 4.0, 1.0102884251578916, 1.1309716599190283, 1.0474176537929971, 1.0508051908191942, 1.1007102993404363, 1.1870722433460077, 2.6794871794871793, 2.4285714285714284, 1.0102689606827937, 1.0347620692344546, 1.0025293937793591, 1.120955882352941, 1.0925568839182414, 1.0319148936170213, 1.0629886718447603, 1.0598705501618122, 1.2246489859594383, 3.0, 1.0909090909090908, 1.0465489566613162, 1.0782442748091603, 1.0700179533213645, 1.0059453032104637, 1.103921568627451, 1.24375, 1.148905109489051, 1.064327485380117, 1.0438338658146964, 1.202127659574468, 1.026555806711664, 2.0, 1.0674846625766872, 1.0396825396825398, 1.0846153846153845, 1.1044692737430168, 1.0421892816419613, 1.0671936758893281, 1.1361867704280155, 1.0759875312995044, 1.0, 1.297872340425532, 1.2, 1.0, 1.1704545454545454, 1.092741935483871, 1.0, 1.1019417475728155, 1.068727971803909, 1.0406032482598608, 1.0568790731354092, 1.1773173138313309, 1.0426687354538402, 1.1061221863572508, 1.027027027027027, 1.1147757255936674, 1.0082244799225932, 1.078525641025641, 1.2557803468208093, 1.1226529376135674, 1.0408452845487255, 1.1334609361405952, 1.0795024018317656, 2.0, 1.1253071253071254, 1.0744786494538232, 1.4339622641509433, 1.0, 1.2439024390243902, 1.25, 1.162551440329218, 1.3703703703703705, 1.1666666666666667, 1.0124541228284805, 1.1345444280904087, 1.0232934116247188, 1.0640057822036622, 1.2054054054054053, 1.1304945054945055, 1.0, 1.1240875912408759, 1.007014863175441, 1.069846202884692, 1.0832798264642083, 1.0808178608041918, 1.0259373394966615, 1.1714285714285715, 1.1121810801855534, 1.1207815275310835, 1.0030271094468237, 1.062265855908432, 1.2424242424242424, 1.0479666319082377, 1.0, 1.2387640449438202, 1.207693255565596, 3.0, 1.1039837947332882, 1.0698959537572255, 1.4285714285714286, 1.0388443978744106, 1.3, 1.1176470588235294, 1.0617259814573918, 1.6923076923076923, 1.0193430259961567, 1.0533959846219565, 1.3571428571428572, 1.16, 1.179381443298969, 1.0124342419894787, 1.0048565121412802, 1.0609479369746557, 1.1558063286313383, 1.0, 1.0107042872042598, 1.1341463414634145, 2.0, 1.051333656644035, 1.0493295267756726, 1.0936613055818354, 1.0174599637046706, 1.0473026703947874, 1.0089285714285714, 2.0, 1.096787651230705, 1.0491935483870967, 1.0973648040995707, 1.240380637153496, 1.0005420523022805, 1.0655484194541578, 1.2362637362637363, 1.0717703349282297, 1.2073578595317727, 1.0692412020843742, 1.0296529968454258, 1.102355072463768, 1.016550987720235, 1.0425695250454665, 3.0, 1.144623325181173, 1.0013121141936958, 1.0208332216150706, 1.5833333333333333, 1.2880155533953617, 1.3618090452261307, 1.1428571428571428, 1.1224871270367496, 1.0420575865415722, 1.1091703056768558, 1.0294117647058822, 1.3333333333333333, 1.0843626125291743, 1.5, 1.0, 1.0833333333333333, 1.0398436954853116, 1.3846153846153846, 1.109704641350211, 1.039832285115304, 1.0, 1.746031746031746, 1.2699335548172757, 1.25, 2.0, 1.1176470588235294, 1.2241379310344827, 1.1183510638297873, 1.215561224489796, 1.0666666666666667, 1.233038348082596, 1.1014466214978942, 1.051948051948052, 1.1342592592592593, 1.1673469387755102, 1.2692307692307692, 1.0, 1.1694117647058824, 1.0966810966810967, 1.0157397691500525, 1.1523400191021969, 1.068900339355225, 1.112644947542794, 1.1174665757566775, 1.1357359745517641, 1.1622377622377622, 1.0182260024301337, 1.8333333333333333, 1.0, 1.2592592592592593, 1.0152842073309554, 1.0767872903795235, 1.107843137254902, 1.0024630541871922, 1.0458953799159985, 1.0227117252702147, 1.018467518838546, 1.1142857142857143, 1.2222222222222223, 1.048099301784329, 1.0285636376031086, 1.0682509567891139, 1.0570885669176924, 1.013157894736842, 1.0694772593030124, 1.0179478624831289, 1.269918699186992, 1.354378818737271, 1.2857142857142858, 1.0389305816135084, 2.3430079155672825, 1.1555555555555554, 1.2274247491638797, 1.0701001430615165, 1.0, 1.0841584158415842, 1.0175756179442452, 1.037037037037037, 1.0817710696630287, 1.0085470085470085, 1.2285714285714286, 1.0302565062722338, 1.0370583994232156, 1.114457426806339, 1.0333969465648856, 1.0011350737797957, 1.202045862547844, 1.1940298507462686, 1.3571428571428572, 1.0, 1.4285714285714286, 1.0643817367082475, 1.3333333333333333, 1.2500843170320404, 1.0885789672069355, 1.0598139122729286, 1.0436941410129097, 1.0518587972429754, 1.1145766345123258, 1.0108695652173914, 1.029126213592233, 1.0007138328597929, 1.1116422947131608, 1.0417311667948346, 1.252559315909912, 1.4285714285714286, 1.103448275862069, 1.0434782608695652, 1.046500745259801, 1.01628664495114, 1.2980295566502462, 1.0071301247771836, 2.1737288135593222, 1.0493978581996306, 1.076510067114094, 1.052188995215311, 1.125, 1.0677288023909821, 1.0198968436869518, 1.335966298051606, 1.0581052631578947, 1.25, 1.0130151843817787, 1.1823529411764706, 1.625, 1.0502126151665485, 1.6153846153846154, 1.0110887096774193, 1.058139534883721, 1.0178448867536032, 1.016255989048597, 1.015531660692951, 2.75, 1.0821256038647342, 1.0972829883451598, 1.0785265848102672, 1.0096937473150749, 1.0364512855209742, 1.06885549698861, 1.0769230769230769, 1.0960207612456747, 1.0201211174057434, 1.012819063552712, 1.0270541082164328, 1.0208333333333333, 1.1456266907123536, 1.039499281062336, 1.3039772727272727, 1.0260288931454862, 1.0, 1.3333333333333333, 1.0725209523103167, 1.039947322212467, 1.2158401046044645, 1.151607821332592, 1.0558659217877095, 1.1083743842364533, 1.0962237927669516, 1.0696954052658751, 1.1488970588235294, 1.0054347826086956, 1.00990099009901, 1.094536887056398, 1.1071428571428572, 1.75, 1.0463903584217757, 1.1690838459048236, 1.018583042973287, 1.0056818181818181, 1.224475018102824, 1.0031178505663747, 1.1653078436885016, 1.21580547112462, 1.3076923076923077, 1.0808625336927224, 1.1176470588235294, 1.1625, 1.5925925925925926, 1.036383953514359, 1.180376610505451, 1.1683250414593698, 1.024390243902439, 1.0512187782124587, 1.0564733000384172, 1.065562248995984, 1.2158843335313922, 1.3333333333333333, 1.3333333333333333, 1.3333333333333333, 1.1532567049808429, 1.4615384615384615, 1.0, 1.1538461538461537, 1.0304635761589405, 1.0905797101449275, 1.0082274526140387, 1.0241718451827568, 1.278181818181818, 1.3877551020408163, 1.1428571428571428, 1.032258064516129, 1.0810810810810811, 1.1714285714285715, 1.106896551724138, 1.0288356983176081, 1.0309153649215244, 1.3195876288659794, 1.0856431614725452, 1.0477403533356688, 2.5, 1.0688816304310844, 1.2152777777777777, 3.0, 2.0, 1.152662721893491, 1.1319658610055225, 1.075851730367599, 1.15527950310559, 1.0, 1.178082191780822, 1.1441717791411044, 3.0, 2.0, 1.0531496062992125, 1.1833579782228794, 1.0188679245283019, 1.6666666666666667, 1.0149333924355837, 1.0495739736638265, 1.037948717948718, 1.0, 1.056338028169014, 1.0218415005684491, 1.0921052631578947, 1.1816782140107776, 1.0406896685479334, 1.2801204819277108, 1.12109375, 1.0812581913499344, 1.0752984389348026, 1.103305785123967, 1.15, 1.0563680657518066, 1.6043956043956045, 1.094119786614937, 1.4521739130434783, 1.1862745098039216, 1.373134328358209, 1.0511140235910879, 1.0521091811414391, 1.0015795419328395, 1.095022034872581, 1.0851528384279476, 1.5, 1.6666666666666667, 1.1001406379850411, 1.1174142480211082, 1.0970628282435324, 1.017237147310416, 1.0730891453420304, 1.0959246603883657, 1.1164556962025316, 1.0434782608695652, 1.090244477635406, 1.0978303301760801, 1.1623287671232876, 1.1218074656188606, 2.5, 1.1029411764705883, 1.1157545741066677, 1.172597366209022, 1.0209590851900812, 1.0763694623874676, 1.0099431818181819, 2.0, 1.058096415327565, 1.0408636462769316, 1.1793465844185516, 1.349809885931559, 1.1057252181376056, 1.1878980891719746, 1.3211920529801324, 1.0295652173913044, 1.0323487891885221, 1.0757639531947134, 1.0403225806451613, 1.0371845949535192, 1.0, 1.147001176009408, 1.0559923210531128, 1.0587412587412588, 1.0320282259445757, 1.118232731798382, 1.0200617283950617, 1.2, 1.252659574468085, 1.6666666666666667, 2.0, 1.1764705882352942, 1.0077319587628866, 1.0015822784810127, 1.02384046938245, 1.0083144433514393, 1.0686567164179104, 1.0286610878661089, 1.1793478260869565, 1.0425531914893618, 1.053003360059485, 1.6, 1.6666666666666667, 1.1465324384787472, 1.1428571428571428, 1.0899854862119014, 1.1352295409181636, 1.0425671866190567, 1.1003229942705037, 2.0, 1.0109546165884193, 1.2093023255813953, 1.0905629589339134, 1.0403451471141407, 1.095959595959596, 1.1407534246575342, 1.1459909397246213, 1.1424180957649517, 1.0697278911564625, 1.2241379310344827, 1.094972067039106, 1.0, 1.0, 1.0417769393083223, 5.0, 1.4285714285714286, 2.0, 1.0122100122100122, 1.1325301204819278, 1.0731707317073171, 1.0949391918399372, 1.0, 1.1688392302917443, 1.0146028037383177, 1.2185792349726776, 1.34375, 1.4285714285714286, 1.0205570291777188, 1.0770509977827052, 1.1444444444444444, 1.044626255113425, 1.0263679099748861, 1.000358455058697, 1.1120970127181307, 1.0, 1.2805770613868088, 1.0489328302718184, 1.0493633428981348, 1.1774193548387097, 1.0882229892270683]
origin-bjaq_15.71 	max: 5.0000	99th: 2.6802	95th: 1.6950	median: 1.0843	mean: 1.1760

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 14.015328 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[2.9802322e-07 1.1920929e-07 1.1920929e-07 4.7683716e-07 1.3709068e-06]
Distance score: 4.76837158203125e-07
SAUCE Drift detection: False
Detection latency: 0.0232s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.031015 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 6.0000	99th: 2.5000	95th: 1.7514	median: 1.0833	mean: 1.1796
ReportEsts: [1.005464480874317, 1.0077369439071566, 1.0372209784386257, 1.0457627118644068, 1.4166666666666667, 1.0, 1.0810560444650301, 1.0451289035898434, 1.2, 1.0010787486515642, 1.14654156140984, 1.0438522941333503, 1.0534351145038168, 1.13671875, 1.027729130180969, 1.125, 1.1746031746031746, 1.3125, 1.2727272727272727, 1.0837606837606837, 1.1261542012927055, 1.0149603167428995, 1.15625, 1.0173410404624277, 1.0143988734377751, 1.0212138208915928, 2.0, 1.1532149381569885, 1.2, 1.6, 1.0, 2.0, 1.0324963448431375, 1.013724038459075, 1.0388482632541134, 1.12271285679434, 1.2351361718450327, 1.1721132897603486, 1.0, 1.0670556702009062, 1.0047752808988764, 1.0626754722776839, 1.1912144702842378, 1.131116687578419, 1.0241635687732342, 1.206790715518895, 1.1363636363636365, 1.18359375, 1.25, 1.0471380471380471, 1.0555555555555556, 1.2869955156950672, 1.0948275862068966, 1.0, 1.0635045080360643, 1.0225228975853455, 1.1359177215189873, 1.1465968586387434, 1.086021505376344, 1.0597369970920603, 1.3870967741935485, 1.1431025934727232, 1.0886850152905199, 1.0716981132075472, 1.0388349514563107, 1.1111111111111112, 1.0635868154684662, 1.3293413173652695, 2.0, 1.0, 1.1125446914347894, 1.0539714867617107, 1.058624031007752, 1.0391389432485323, 1.1716452110152897, 1.0926204819277108, 1.0703698373866743, 1.0334928229665072, 1.5242718446601942, 1.071511558763528, 1.0067928190198931, 1.0842105263157895, 1.0, 1.0625, 1.074492099322799, 1.4107142857142858, 1.206308610400682, 1.1666666666666667, 1.125, 1.0972721437740693, 1.1153846153846154, 1.2812659231161185, 1.0501240948750097, 1.0843881856540085, 1.1697127937336815, 1.0186046511627906, 1.0980392156862746, 1.0521262002743483, 1.5, 1.3396152336081664, 1.0344827586206897, 2.5, 1.047259285817946, 1.2910798122065728, 1.030324400564175, 1.2140618321698247, 1.25, 1.021430571804717, 1.0974856638729598, 1.2241047523427042, 1.1832858499525165, 1.0425694621463166, 1.1111111111111112, 2.0, 1.0336248785228377, 1.0869780598804613, 1.052877138413686, 1.0666666666666667, 1.0570257525538211, 2.0, 1.0923970432946146, 1.162511542012927, 1.0, 1.0576923076923077, 1.2857142857142858, 1.1683991683991684, 1.020146358146995, 1.126532995912011, 1.0495867768595042, 1.6666666666666667, 1.1509695290858726, 1.0, 2.75, 1.1191508998615598, 1.4166666666666667, 1.1193866374589265, 1.008356732183447, 1.0482791751020828, 1.25, 1.2857142857142858, 1.0700218818380745, 1.1215616681455192, 1.0610802624936901, 1.040830985915493, 1.2345679012345678, 1.0032679738562091, 1.0587823865709767, 3.0, 1.008695652173913, 1.0047258979206048, 1.098360655737705, 1.1056420805171907, 1.5, 1.1955820052451078, 1.0334190231362468, 1.0101694915254238, 1.0894117647058823, 1.0, 1.0, 1.1016467213925427, 1.1598020919230936, 1.0346534653465347, 1.0853994490358128, 1.280701754385965, 1.3559322033898304, 1.0521739130434782, 1.5714285714285714, 1.0727946033588887, 1.3846153846153846, 1.2191176470588236, 1.1259945623925474, 1.015884476534296, 1.013619497385731, 1.203478260869565, 1.115686274509804, 1.057965172524992, 1.1112214498510427, 1.0101522842639594, 1.078239608801956, 1.0346560846560846, 1.077105387896982, 1.2142968022353307, 1.1677018633540373, 1.02, 1.0249736210804237, 1.0796686348814664, 1.2, 1.5837651122625216, 1.0437956204379562, 2.3333333333333335, 1.1853932584269662, 1.0897357890893993, 1.2380952380952381, 1.1386787695410994, 1.1686786963068834, 1.0462135695056767, 1.0373857462448066, 1.070935960591133, 1.0073130359274938, 1.0616513098464317, 1.0, 1.0158826029572958, 1.0123339658444024, 1.052613981882476, 1.0662905500705218, 1.071948120234861, 1.077720207253886, 1.028169014084507, 1.1379310344827587, 1.0, 1.481203007518797, 1.1533004926108374, 1.28125, 1.1682242990654206, 1.0132286068623397, 1.8, 1.0442334322453017, 1.0669745958429562, 1.200272643438515, 2.3333333333333335, 1.0156626506024096, 1.0040042712226376, 1.006302419743565, 1.0170842933488848, 2.0, 1.0833333333333333, 1.1110964897851763, 1.0434016216851423, 1.064516129032258, 1.059625212947189, 1.0964805825242718, 1.0792023915114484, 1.32, 1.0043302088180073, 1.029936664220628, 1.049079754601227, 1.1099526066350711, 1.0132743362831858, 2.0, 1.1196581196581197, 2.0, 1.2266666666666666, 1.0934111759799834, 1.023076923076923, 1.1601423487544484, 1.2857142857142858, 1.5, 1.1010009365488176, 1.123076923076923, 1.0658964484381686, 1.2, 1.049808429118774, 1.0653104925053534, 1.25, 1.0059901115618661, 1.0184757505773672, 1.1333914559721012, 1.0434782608695652, 1.0031746031746032, 1.1473559985126986, 1.121212121212121, 1.0, 1.0673015000729857, 1.0361559855612759, 1.1064139941690962, 1.0132014369392486, 1.1344255206706864, 1.0266203379381849, 1.0924202127659575, 1.072481410322221, 1.0288024254674077, 1.0287744227353464, 1.0033013514907665, 1.0, 1.0156934047070056, 1.163265306122449, 1.2857142857142858, 1.3043478260869565, 1.1164725457570714, 1.12, 1.005767291097337, 1.0070780335680998, 1.036231884057971, 1.3582089552238805, 1.0287136714190221, 1.0883472962680882, 1.206796333556897, 1.0331875693977985, 1.2, 1.0952380952380953, 1.0006134969325153, 1.0380202641215326, 1.1454325560300842, 1.091992641212329, 1.2001075847229694, 1.215454032712916, 1.0241015402167712, 1.0497390236413877, 1.1089006938421508, 1.0346940994210856, 1.0054694621695532, 2.5, 1.1538461538461537, 1.074891839474862, 1.5, 1.0637898686679175, 1.0021226433167387, 1.0197470314919979, 1.3846153846153846, 1.0634920634920635, 1.3259493670886076, 1.06004460456339, 1.060383464204666, 1.0454545454545454, 1.172493901730747, 1.0088675386633277, 1.2458628841607564, 1.4, 2.3636363636363638, 1.0065118298241806, 1.4285714285714286, 1.001894108778699, 1.0528, 1.0, 1.093224888909197, 1.4090909090909092, 1.0769230769230769, 1.0076806661787798, 2.0, 1.0, 1.0035545023696681, 1.0359756097560975, 1.0021052631578948, 1.0569476082004556, 1.1, 1.1177776275464215, 1.068778519491422, 1.0, 1.0165661707943, 1.0287722642520998, 3.0, 1.1, 1.048386481537992, 1.5, 1.0781758957654723, 1.35, 1.6666666666666667, 1.5263157894736843, 1.326955074875208, 1.0417310664605872, 1.3306451612903225, 1.0305376344086021, 1.275, 1.6666666666666667, 1.0275292980379245, 1.9285714285714286, 1.1285714285714286, 1.0142826647073717, 1.0421455938697317, 1.0144596651445967, 1.0018867924528303, 1.75, 1.0, 1.2818471337579618, 1.3833333333333333, 1.2160864345738296, 1.1302598094336274, 1.2475173783515392, 1.0124378109452736, 1.5, 1.0294479670136212, 1.1666666666666667, 1.56, 3.0, 1.0606372045220966, 1.0, 1.2713675213675213, 1.1181818181818182, 1.1778231733140678, 1.0998945032558478, 1.0859269282814614, 1.0483242828149855, 1.1110069630423138, 1.2808219178082192, 1.1074020319303337, 1.1797599666830727, 1.0834724540901504, 1.1818181818181819, 1.0054805310658328, 1.0428196746236886, 1.1071545246651422, 1.0096153846153846, 1.0454545454545454, 1.2046413502109705, 2.0, 1.0, 1.6046511627906976, 1.166351606805293, 1.318407960199005, 1.0422857142857143, 1.0815217391304348, 1.0059907834101383, 1.0047575723113082, 1.0789779326364692, 1.041098479734291, 1.125, 1.1801801801801801, 1.1134020618556701, 1.0, 1.2691341032852612, 1.625, 1.1035998641560696, 1.0222872537506515, 1.016169455897809, 1.141686492201956, 1.375, 1.031759297952361, 1.0, 1.0675675675675675, 1.1818181818181819, 1.1022252090800477, 1.0133010882708586, 1.1178212491026562, 1.099337748344371, 1.0639943741209563, 3.0, 1.236969696969697, 1.011368139045608, 1.1511574428943738, 2.0, 1.2083333333333333, 1.2860596293311846, 1.2826747720364742, 1.0930763205394545, 1.1571925209057596, 1.173913043478261, 1.1477438136826783, 1.0348998412730306, 1.0534115417292986, 1.0686772145452077, 1.0845683718165726, 1.1251914241960184, 1.4444444444444444, 1.0579915134370579, 1.0670302021832179, 1.1727272727272726, 1.0528610354223433, 1.0, 1.0, 1.148407643312102, 1.123015873015873, 1.0513186029935853, 1.1267826111932904, 1.0883264462809918, 1.0, 1.1452991452991452, 1.0, 1.0504328051643192, 1.1666666666666667, 1.0, 1.0541982405713788, 1.3333333333333333, 2.0, 1.0301757066462949, 2.3333333333333335, 1.0113268608414239, 1.0151171579743008, 1.0415512465373962, 1.3076923076923077, 1.0756895635225325, 1.057404326123128, 1.35, 1.080143427798572, 1.104, 1.1200440528634361, 1.0331529093369418, 1.3205944798301485, 1.0208972672804326, 1.0, 1.0823529411764705, 1.040181666897795, 1.1093412974946075, 1.0548926014319808, 1.2, 1.1086197390185628, 1.0098124816956844, 1.0204882301656495, 2.0, 1.0292666885892798, 1.0232520830617748, 1.047267464678179, 1.0260104041616647, 1.0195950117754928, 1.0045718878402343, 1.0457516339869282, 1.0007678374547173, 1.75, 1.1048178207563462, 1.0451467268623025, 1.03855421686747, 1.1523545706371192, 1.0285714285714285, 1.0110226917329812, 1.546875, 1.0649642183358143, 1.0565036025786878, 1.0675129487141104, 1.1099585062240664, 1.1415966806638673, 1.0480877601622962, 1.0227272727272727, 1.2073170731707317, 1.12697548029112, 1.084033613445378, 1.0079997873810662, 1.0663388087273453, 1.3333333333333333, 1.089908952959029, 1.1404494382022472, 1.6666666666666667, 1.2941176470588236, 1.0152930903630681, 1.169741697416974, 1.0088050314465409, 1.0, 1.103305785123967, 1.0040899795501022, 1.1729499104019114, 1.041435442101369, 1.0360506782697723, 1.084267491302667, 1.0087463556851313, 1.0101677681748855, 1.0170852325200346, 1.4860335195530727, 1.0214787341948572, 1.1596925704526047, 1.0792079207920793, 1.0279741846403703, 1.2222222222222223, 1.000643624895411, 2.0, 1.114534494306765, 1.0166666666666666, 1.050792507204611, 1.0816777041942605, 1.1041456016177957, 1.0209424083769634, 1.085750315258512, 1.0865508642187633, 1.0, 1.2, 1.5, 1.3333333333333333, 1.0740740740740742, 1.098360655737705, 1.01953125, 1.091633466135458, 1.0703166935050994, 1.1689978923165358, 1.0633875470324068, 1.1667470576885974, 1.017655894715083, 1.1241902813016336, 1.020542476540201, 1.1164079822616408, 1.0122130498699535, 1.0527382985134592, 1.0848126232741617, 1.0797814207650274, 1.1136919315403424, 1.1290322580645162, 1.0321836288559632, 1.1489117983963344, 1.1011034835460964, 1.2681564245810055, 1.2572663944270959, 1.0311070448307411, 2.0, 1.022274325908558, 1.3333333333333333, 1.0, 1.3622047244094488, 1.057622888016493, 1.0395927601809956, 1.044155844155844, 1.1292134831460674, 1.068674432799574, 1.040627270525551, 1.0632911392405062, 1.6, 2.3333333333333335, 1.1172761664564943, 1.208888888888889, 1.062027833001988, 1.0811450201088242, 1.0, 1.3266178266178266, 1.1745689655172413, 1.0986762319583228, 1.1089837997054492, 1.0016288017074335, 1.0311269385969177, 1.0064003011906442, 1.5168539325842696, 2.0, 1.1375940635451505, 1.0, 1.0390070921985815, 1.1932773109243697, 1.270935960591133, 1.1191567369385884, 2.0, 1.0295182904744657, 1.0067567567567568, 1.2296099290780143, 1.133500772797527, 1.183673469387755, 1.146341463414634, 1.0053727966820625, 1.0018034265103697, 1.0645833333333334, 1.1666666666666667, 1.010894428720971, 1.0824742268041236, 1.105263157894737, 1.0229965156794425, 1.2657227864984097, 1.0588235294117647, 1.0081930972253552, 1.3, 1.0178571428571428, 1.0374963094183642, 1.0352112676056338, 1.1890243902439024, 1.068213883878342, 1.1612903225806452, 1.7777777777777777, 1.0213523131672597, 1.0423387096774193, 1.0870703440078113, 1.1329534662867997, 1.0351486097794822, 1.076945098989187, 1.2234206471494606, 1.0765661252900232, 1.2636103151862463, 1.050381144309121, 1.0768828451882846, 1.025943396226415, 1.007449605609115, 1.0475755183446214, 1.069090909090909, 1.0530155642023347, 1.2380952380952381, 1.6, 1.11125, 1.5959101382488479, 1.0869565217391304, 1.3859649122807018, 1.0769230769230769, 1.0358890701468189, 1.0225483178239083, 1.1337209302325582, 1.0821087953571846, 2.6666666666666665, 1.1206515259321936, 2.0, 1.080392156862745, 1.1333333333333333, 1.0282337874024916, 1.4, 1.2448275862068965, 1.0069204152249136, 1.0, 1.4146179401993355, 1.2563573883161512, 1.5, 2.5, 1.1285714285714286, 1.201729106628242, 1.0272195370134827, 1.213459516298633, 1.122238586156112, 1.1032656663724625, 1.047029702970297, 1.146788990825688, 1.10546875, 1.3793103448275863, 1.1, 1.5, 1.1254752851711027, 1.068075117370892, 1.0926243567753002, 1.1728558347746465, 1.0781033904698043, 1.0627269725982171, 1.068807311085966, 1.3086318972033257, 1.1707602339181287, 1.0377936670071501, 1.4444444444444444, 1.0, 1.1176470588235294, 1.0028250913720695, 1.1116005873715125, 1.0853333333333333, 1.2526315789473683, 1.0141293279022403, 1.0174037376704907, 1.0248033279360236, 1.2048192771084338, 1.1904761904761905, 1.0564516129032258, 1.151495089926073, 1.0596438126638381, 1.056062702778133, 1.0, 1.0670469880996196, 1.161529840291398, 1.0288192878807148, 1.0919366993217785, 1.1117291262973743, 1.1672597864768683, 1.0879801734820322, 1.0886644219977553, 1.0357882193438168, 1.0444444444444445, 1.052319309600863, 1.0, 1.0190114068441065, 1.0045016424911792, 1.1587301587301588, 1.0995379283788986, 1.0070921985815602, 1.1777777777777778, 1.0136470588235293, 1.0145006016847171, 1.1337486670034238, 1.0141287284144427, 1.0401493930905696, 1.2091464280641955, 1.1746031746031746, 1.25, 1.0, 1.25, 1.064408214264122, 1.1111111111111112, 1.2661516853932584, 1.1024415421210898, 1.0234490398818317, 1.0667443408788282, 1.0884107845807234, 1.0196236559139784, 1.0235988200589972, 1.030751708428246, 1.021890306112477, 1.0867712873028592, 1.04297988299805, 1.2381933797471536, 1.7142857142857142, 1.0095969289827256, 1.0, 1.07852357732988, 1.0272479564032697, 1.2848072562358277, 1.003030303030303, 2.1985559566787005, 1.0610029116790682, 1.0786516853932584, 1.0417586368766418, 1.0454545454545454, 1.0554639418121854, 1.0445775978407557, 1.2793556591776176, 1.051255230125523, 1.1764705882352942, 1.068592057761733, 1.096507329829767, 1.104177305688898, 1.0, 1.017733188985828, 1.4324324324324325, 1.0743877479003459, 1.0250941028858218, 1.0150943396226415, 1.0141562853907136, 1.0186832740213523, 1.0773869346733669, 1.0768846729905142, 1.006336144182481, 1.0681381957773513, 1.0497747661523933, 1.0329406631762652, 1.3846153846153846, 1.0753911806543386, 1.0096420983820886, 1.1173896853472352, 1.037174721189591, 1.004641567818463, 1.1313131313131313, 1.1204819277108433, 1.051006711409396, 1.0368195940765847, 1.096774193548387, 1.1187241582988778, 1.228407139719682, 1.0346020761245676, 1.1408450704225352, 1.0568670386852206, 1.1123534604246357, 1.0821643286573146, 1.0669291338582678, 1.1001240052887025, 1.1027775465467966, 1.1475155279503106, 1.0, 1.0618556701030928, 1.063383740203401, 1.1612903225806452, 1.8, 1.0504273968633417, 1.1669765812380413, 1.0283064909712054, 1.0186046511627906, 1.1723926380368097, 1.012585000088007, 1.1532352254146228, 1.1251855517070757, 1.3448275862068966, 1.0567296996662958, 1.0, 1.168, 1.5625, 1.0764286777289978, 1.1818181818181819, 1.0226415094339623, 1.02, 1.1395348837209303, 1.22, 1.09375, 1.0163934426229508, 1.019559902200489, 1.1106382978723404, 1.0093896713615023, 1.2307692307692308, 1.0112941077864386, 1.032036613272311, 1.006758331391284, 1.2946428571428572, 2.0, 1.2195828505214368, 1.0831750677169276, 1.0234585361873418, 1.0945273631840795, 1.4426229508196722, 1.0625, 1.135135135135135, 1.0930232558139534, 1.1904761904761905, 1.0548433048433048, 1.0248872152942534, 1.0325143190971782, 1.3893805309734513, 1.0602342283755184, 1.0474821764541469, 3.0, 1.079799343628963, 1.107594123441984, 2.0, 2.0, 1.1714640198511166, 1.0712363179616007, 1.0962075068130246, 1.2414698162729658, 1.0, 1.0763888888888888, 1.1982507288629738, 1.2, 1.0337814567002146, 1.1307416119846478, 1.0679658287428377, 1.0258710619653661, 1.8571428571428572, 1.0242159329318052, 1.045045045045045, 1.0233183856502241, 1.0183066361556063, 1.019790454016298, 1.0, 1.2038709677419355, 1.1354268891069677, 1.0210124164278893, 1.0256410256410255, 1.1348684210526316, 1.091214101504795, 1.0975039001560063, 1.0763888888888888, 1.0945945945945945, 1.0479285078408547, 1.749241477779761, 1.0857014073220814, 1.4558823529411764, 1.182608695652174, 1.207900207900208, 1.875, 1.0692167577413478, 1.0101522842639594, 1.0123689422396294, 1.070902394106814, 2.0, 1.1256727664155006, 1.0261553669989292, 1.1576658209496193, 1.2357500403681576, 1.014254841306835, 1.0944367176634213, 1.1276534812958654, 1.5170454545454546, 1.0178571428571428, 1.1707940251572326, 1.102637663783506, 1.2559706062461726, 1.034848484848485, 2.3333333333333335, 1.021978021978022, 1.0182601099750261, 1.0801232665639446, 1.0366170978658003, 1.0870898060155842, 1.0207223208999407, 1.6, 1.1073752711496747, 1.0204884922498825, 1.170754896368131, 1.0093167701863355, 1.1072752755936819, 1.2567567567567568, 1.3268876611418048, 1.0077034183919114, 1.033097941963678, 1.1053713170130237, 1.0163304514889528, 1.0515695067264574, 1.0, 1.1188922489256725, 1.0246998529983424, 1.079749725631678, 1.0387916237555785, 1.0775, 1.030379746835443, 1.0506329113924051, 1.146694214876033, 2.0, 1.6666666666666667, 1.0, 1.0376106194690264, 1.0336411609498681, 1.0241505714197703, 1.01757972782999, 1.0338782279080787, 1.039226319595083, 1.2227488151658767, 1.0692307692307692, 1.0833640766181216, 1.5, 1.2352941176470589, 1.070170372509385, 1.0, 1.1870882740447959, 1.1151020408163266, 1.0808451623429598, 1.0897996480303236, 2.5, 1.0657055724979208, 1.2, 1.0730610928816646, 1.040422692985575, 1.1939978563772775, 1.1318272805261653, 1.1441662484432795, 1.0602152576928547, 1.0444444444444445, 1.4090909090909092, 1.0704225352112675, 1.6666666666666667, 3.0, 1.0421049100653732, 6.0, 1.625, 1.8611111111111112, 1.0171890798786654, 1.0410772922455165, 1.4462395543175488, 1.0269230769230768, 1.3333333333333333, 1.1933103245704215, 1.0529735132433784, 1.0, 1.266798418972332]
origin-bjaq_15.71 	max: 6.0000	99th: 2.5000	95th: 1.7514	median: 1.0833	mean: 1.1796

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.203471 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.297669