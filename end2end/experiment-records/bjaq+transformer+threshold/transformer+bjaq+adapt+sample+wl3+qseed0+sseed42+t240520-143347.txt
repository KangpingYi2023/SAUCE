Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 42, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.5025	95th: 1.6667	median: 1.0825	mean: 1.1717
ReportEsts: [1.0634920634920635, 1.0005211047420532, 1.0308218682638195, 1.0788381742738589, 1.5789473684210527, 1.0, 1.1021124766381605, 1.0627126537284495, 1.0, 1.0386666666666666, 1.164170490289441, 1.043343527565022, 1.0142797144057119, 1.069767441860465, 1.0921935711762627, 1.0, 1.3235294117647058, 1.001063829787234, 3.0, 2.0, 1.173913043478261, 1.13802581848525, 1.1155896157619793, 1.1297709923664123, 1.064627528367045, 1.0, 1.1540207522697794, 1.5, 1.2, 1.0287769784172662, 1.0, 1.0495298612436157, 1.0041121253875303, 1.0455049944506105, 1.1536202085475107, 1.239437801552339, 1.1443850267379678, 1.0005831045457858, 1.1282457469522695, 1.05, 1.0970464135021096, 1.103658536585366, 1.0, 1.0979906413432425, 1.079960019990005, 1.8615384615384616, 1.03, 1.1130742049469964, 1.0329823134783493, 1.0833333333333333, 1.1241215896012458, 1.1391752577319587, 1.0404228727604843, 2.0, 1.1896103896103896, 1.2325617283950616, 1.144879267277269, 1.3270142180094786, 1.0592105263157894, 1.25, 1.1357006543075245, 1.0877957658779576, 1.040909090909091, 1.0229885057471264, 1.0, 1.091503267973856, 1.2476277930823385, 1.75, 1.0, 1.0284329262608372, 1.0071599045346062, 1.0689655172413792, 1.034965034965035, 1.1328722066363548, 1.0823529411764705, 1.0325047801147227, 1.0, 1.1135699373695198, 2.0, 1.0238714321390272, 1.21875, 1.0192960248486846, 1.2147239263803682, 1.0941028858218318, 1.1290480863591756, 1.04, 1.0693888065949637, 1.0362826071160414, 1.1029411764705883, 1.75, 1.1408235892221656, 1.0536259418508214, 1.0965732087227413, 1.005641748942172, 1.0045871559633028, 1.0831168831168831, 1.062992125984252, 1.1512770137524557, 1.0, 1.2513398838767307, 1.0640748740100792, 1.0360205831903946, 1.2206142051083257, 1.36, 1.0158877300594218, 1.0791080435359703, 1.136917261654767, 1.1137656427758817, 1.044757817290006, 1.1666666666666667, 1.6666666666666667, 1.0651869158878504, 1.1096166168606927, 1.0397978521794062, 1.0909090909090908, 1.0608641423145004, 1.0, 1.0570797855566068, 1.1140724946695095, 1.0, 1.0494505494505495, 1.0, 1.150375939849624, 1.0291397100177924, 1.0543604876912325, 1.12, 1.8, 1.1473509933774835, 1.0, 1.0357142857142858, 1.1016552330514973, 1.3, 1.0050455729166667, 1.0381153950021038, 1.063423978678216, 1.0133511348464619, 1.0895522388059702, 1.0845674201091193, 1.039972432804962, 1.0816575258988421, 1.018150503444621, 1.296, 1.0026092628832355, 1.0871718732886297, 2.0, 1.0268915223336372, 1.0045714285714287, 1.0914014895057549, 1.096523733898006, 1.5, 1.1356260595785905, 1.0887096774193548, 1.0245901639344261, 1.1074561403508771, 1.013138686131387, 1.1394133513149023, 1.1251713655599929, 1.174931129476584, 1.0912863070539418, 1.1151315789473684, 1.2857142857142858, 1.3142857142857143, 1.0353460972017674, 1.4285714285714286, 1.0965822331112431, 1.0396876834745215, 1.1495698213103904, 1.364743714675502, 1.1023569023569024, 1.110280671066232, 1.2968421052631578, 1.074492099322799, 1.0975113779413188, 1.0323559150657229, 1.0211453744493393, 1.0923226433430515, 1.0315526398000625, 1.0925714285714285, 1.0139655579146025, 1.0, 1.105263157894737, 1.0462129041783552, 1.0283094098883572, 1.1206467661691542, 1.013157894736842, 1.0715601444533314, 1.3275033634441669, 1.088154448845313, 1.16, 1.2354545454545454, 1.0330142860527376, 1.0, 1.0909090909090908, 1.012953472418385, 1.0640096618357489, 1.039290848107331, 1.4, 1.0668810289389068, 1.053921291562402, 1.0713716261646336, 1.0626410835214446, 1.0831664382839676, 1.11864406779661, 1.0847457627118644, 1.2, 1.0, 1.3793103448275863, 1.1645639489039583, 1.2961672473867596, 1.2413793103448276, 1.0103806228373702, 1.0031277926720286, 1.0117873424743018, 1.0537953612251691, 1.1744469870327994, 1.1972789115646258, 1.1315028901734103, 1.0068515497553019, 1.0127233040381411, 1.0089402379478716, 1.0, 1.1354037267080745, 1.090599334291848, 1.015129515713087, 1.1475811390079609, 1.0501381143482567, 1.2740597047095592, 1.0740740740740742, 1.0059845397048488, 1.0881897885507994, 1.0107163000564017, 1.0909090909090908, 1.0, 1.0042735042735043, 1.137007874015748, 2.0, 1.2587745389649019, 1.1040084859312194, 1.0473511486169713, 1.2237442922374429, 1.0, 1.6666666666666667, 1.0733191466910537, 1.1454545454545455, 1.1139140999070964, 1.5, 1.0, 1.0526315789473684, 1.049960967993755, 1.053763440860215, 1.0165745856353592, 1.0949367088607596, 1.0686106346483706, 1.0025188916876575, 1.1207100133563035, 1.0175438596491229, 2.0, 1.0973515925400448, 1.04615605484172, 1.1085814360770578, 1.044651629491816, 1.1011242239498853, 1.0088188090471384, 1.0818759936406994, 1.1118250796612854, 1.0245215311004785, 1.0737203402477242, 1.0003685503685504, 1.0, 1.0015375744762638, 1.1383495145631068, 1.1590909090909092, 1.3888888888888888, 1.0283636363636364, 1.0, 1.0085470085470085, 1.083009218760514, 1.0919220055710306, 1.3834586466165413, 1.010453187133815, 1.1115771812080537, 1.0212297324190225, 1.063306779202022, 1.25, 1.047435431065842, 1.6666666666666667, 1.026527197385827, 1.0280777537796977, 1.0391015429429702, 1.0810810810810811, 2.5, 1.434782608695652, 1.0, 1.0701150920085831, 1.0, 1.0275229357798166, 1.0542986425339367, 1.0084134615384615, 1.0162341433948237, 1.18125, 1.0817610062893082, 1.0187869146392912, 1.1500618207847986, 1.047942335093454, 1.1111111111111112, 1.0, 1.0823389021479715, 1.3012820512820513, 1.1888888888888889, 1.0983993260320135, 1.0446205170975813, 1.0901408450704226, 1.3409090909090908, 1.0123456790123457, 1.0012899896800826, 1.2857142857142858, 1.0034189674027743, 1.04, 1.0555555555555556, 1.090753612084063, 1.4285714285714286, 1.1666666666666667, 1.0144466282043154, 2.0, 1.1989026063100137, 1.061046511627907, 1.0795734208367513, 1.0849405006155108, 1.0638888888888889, 1.058139534883721, 1.1187921914528065, 1.1137427683519552, 1.0530846484935437, 1.0422969762234415, 1.040011576586354, 2.0, 1.0, 1.0622386251971023, 1.25, 1.0691578360290017, 1.3529411764705883, 1.0, 1.375, 1.3815261044176708, 1.054986020503262, 1.2169811320754718, 1.0108225108225108, 1.0, 1.1637816245006658, 1.0842271166971644, 2.0, 1.4109589041095891, 1.0, 1.0979579442799665, 1.0987654320987654, 1.044581474678562, 1.1543778801843319, 1.1363636363636365, 1.335608646188851, 1.1666666666666667, 1.0269204249734947, 1.0219609046913065, 1.0774748923959827, 1.0, 1.1666666666666667, 1.5714285714285714, 1.5, 1.2307692307692308, 1.0699437951645998, 1.3333333333333333, 1.064891846921797, 1.2625, 1.1631985380806413, 1.0502672491215221, 1.2523171987641606, 1.020332498937326, 1.0110208816705337, 1.036904761904762, 1.5, 1.170731707317073, 1.004255319148936, 1.0440088877355735, 1.0952380952380953, 1.5714285714285714, 1.0111358574610245, 1.0238095238095237, 1.0372317358239107, 1.0251256281407035, 1.1464387464387464, 1.0098495212038303, 1.0389610389610389, 1.0907770515613653, 1.055084745762712, 1.1923076923076923, 1.0269121813031161, 1.0165289256198347, 1.071147754946122, 1.0739191481893173, 1.038022813688213, 1.2647058823529411, 1.0673076923076923, 1.11875, 1.0, 1.0134643284379852, 1.0416882347604741, 1.0200303559930088, 1.067335686190629, 1.071516393442623, 1.151572926596759, 1.8333333333333333, 1.0226936359151455, 1.2, 1.224594363791631, 1.25, 1.041745429848888, 1.018840579710145, 1.1638005159071367, 1.0948616600790513, 1.0289017341040463, 3.0, 1.260709010339734, 1.0111560528793226, 1.0746965238182822, 2.0, 1.0952380952380953, 1.2696737044145874, 1.3436293436293436, 1.1181844729047599, 1.0411255411255411, 1.2352941176470589, 1.097497842968076, 1.0260425409462604, 1.0197160583108134, 1.099747389204518, 1.0881578947368422, 1.0315091210613598, 1.0151515151515151, 1.6666666666666667, 1.0591397849462365, 1.4444444444444444, 1.2267782426778242, 1.0, 1.089720229720691, 2.0833333333333335, 1.0455798299823018, 1.1282544810874908, 1.069710055521283, 1.0, 1.163265306122449, 1.12, 1.2861718632701067, 1.1597374179431073, 1.0, 1.0522643018099875, 1.1040976324646101, 1.0737670949026108, 1.5, 2.0, 1.0205825242718447, 1.011786038077969, 1.0262295081967212, 1.1111111111111112, 1.0853828804639674, 1.0696969696969696, 1.4705882352941178, 1.027382297551789, 1.0454545454545454, 1.1246719160104988, 1.0266129032258065, 1.4417332772402187, 1.0103323574995695, 1.0, 1.0571428571428572, 1.0653929520346805, 1.0324254422376908, 1.0175196914200513, 1.0, 1.1001990710019907, 1.019788749273559, 1.0220010476689365, 2.0, 1.0578149920255184, 1.0287319441585645, 1.0190184590926488, 1.0003494823292998, 1.015785870453391, 1.021701018715944, 1.035294117647059, 1.2107039537126325, 2.0, 1.0875497441728255, 1.4230769230769231, 1.0, 1.1917098445595855, 1.1346153846153846, 1.0013044710432435, 1.0025553662691653, 1.0694802836554085, 1.1151484135107472, 1.0840981388716224, 1.1443257135127824, 1.0591964584994857, 1.1444444444444444, 4.0, 1.0044796543032048, 1.161336032388664, 1.0467098594554862, 1.0545793729198838, 1.1100963977676306, 1.1008462623413258, 2.13265306122449, 2.142857142857143, 1.0129157131031796, 1.094058137332457, 1.0080116261737964, 1.1127737226277372, 1.0299122637871192, 1.027542372881356, 1.0716441207075962, 1.0462753950338601, 1.2208398133748055, 3.0, 1.0909090909090908, 1.028391167192429, 1.0721062618595825, 1.0511463844797178, 1.089378238341969, 1.0549019607843138, 1.3630136986301369, 1.148905109489051, 1.0963855421686748, 1.0945993689314475, 1.1770833333333333, 1.0068994387422865, 2.0, 1.0832684824902723, 1.0912698412698412, 1.5326086956521738, 1.0729050279329608, 1.011061946902655, 1.0039525691699605, 1.1738002594033723, 1.1328043039677202, 1.0, 1.4680851063829787, 1.5, 1.5, 1.1931818181818181, 1.0786290322580645, 1.0123456790123457, 1.0728155339805825, 1.0658442806792694, 1.060324825986079, 1.044587582751834, 1.1882835383714119, 1.0467289719626167, 1.094270164755307, 1.0216216216216216, 1.1111111111111112, 1.0280599903241412, 1.1038819026790596, 1.2095375722543353, 1.1182503770739065, 1.0566563624385548, 1.196634580057315, 1.0761976701641744, 2.0, 1.162162162162162, 1.080919080919081, 1.4339622641509433, 1.0, 1.108695652173913, 1.25, 1.2417582417582418, 1.3703703703703705, 1.1666666666666667, 1.0046803128801243, 1.1255350642077049, 1.0260612017900101, 1.0319339512423087, 1.172972972972973, 1.104697986577181, 1.0, 1.1079136690647482, 1.0439948156682028, 1.0453555396180307, 1.083298625572678, 1.0964802369290352, 1.0320330663911135, 1.1714285714285715, 1.129133990707062, 1.0710479573712255, 1.019978922349037, 1.115664828027636, 1.2424242424242424, 1.055672268907563, 1.0, 1.2387640449438202, 1.2094319443873145, 3.0, 1.1335798474693783, 1.0723008829050125, 1.4285714285714286, 1.0682675286692835, 1.3, 1.1176470588235294, 1.0890524010057538, 1.6153846153846154, 1.0250172220006526, 1.0516873131140538, 1.3103448275862069, 1.1153846153846154, 1.0556701030927835, 1.0062560153994224, 1.0176600441501105, 1.0745476321496779, 1.1568648401129513, 1.0, 1.0517054095155334, 1.1067073170731707, 2.0, 1.0184745254514842, 1.1268448827753266, 1.1523178807947019, 1.0199337769429144, 1.0222211094280098, 1.0761904761904761, 1.5714285714285714, 1.0717488789237668, 1.014516129032258, 1.1004360884394142, 1.2108239095315023, 1.0226564111631744, 1.0557544685771605, 1.1135531135531136, 1.1581214993537268, 1.2207357859531773, 1.0749578384585023, 1.0813880126182964, 1.0715579710144927, 1.1213235294117647, 1.0485202205882354, 3.0, 1.1426174999251115, 1.0287347506416746, 1.0506951611923987, 1.4615384615384615, 1.303499513956395, 1.1581196581196582, 1.1428571428571428, 1.0493052126684066, 1.0420575865415722, 1.1572052401746724, 1.0294117647058822, 1.3333333333333333, 1.0817976863658203, 1.5, 1.0093457943925233, 1.0833333333333333, 1.000348894006001, 1.44, 1.109704641350211, 1.0545073375262055, 1.0, 1.58994708994709, 1.3079555175363557, 1.25, 2.0, 1.1271186440677967, 1.1689655172413793, 1.0215608867294261, 1.2078580481622307, 1.1428571428571428, 1.224188790560472, 1.1014466214978942, 1.0597402597402596, 1.079295154185022, 1.1959183673469387, 1.0769230769230769, 1.0, 1.388268156424581, 1.121212121212121, 1.0568181818181819, 1.0124326564442603, 1.0717886809447559, 1.0355460385438973, 1.060637950967895, 1.1667148640832852, 1.1720733427362482, 1.0194647201946472, 1.8333333333333333, 1.0, 1.2592592592592593, 1.0011535250815815, 1.0679611650485437, 1.107843137254902, 1.1330049261083743, 1.0233676975945016, 1.0528317300243666, 1.0149161834866927, 1.1304347826086956, 1.2222222222222223, 1.0513618677042802, 1.0512327677624602, 1.0657757326545265, 1.0318731076620933, 1.006578947368421, 1.00661464139725, 1.0188805143992357, 1.3282312925170068, 1.3533604887983706, 1.125, 1.055264411624583, 1.50253807106599, 1.1555555555555554, 1.2152317880794703, 1.0701001430615165, 1.0, 1.0528846153846154, 1.0023342519046847, 1.0188679245283019, 1.1029462103662662, 1.0150537634408603, 1.1944444444444444, 1.0449694253484751, 1.0542898341744773, 1.0747045393499866, 1.034351145038168, 1.0715096481271282, 1.1995673336938886, 1.1764705882352942, 1.2857142857142858, 1.0, 1.6666666666666667, 1.0714303015623108, 1.3333333333333333, 1.1308349435574088, 1.1211566420763557, 1.014842711564023, 1.0619662363455808, 1.0488979072173152, 1.0279742765273312, 1.039426523297491, 1.0332871012482663, 1.0113180078427688, 1.1518560179977504, 1.0400536441637045, 1.1783692641214019, 1.6666666666666667, 1.0158730158730158, 1.0039525691699605, 1.1108530624978334, 1.0618892508143323, 1.2805075593952484, 1.0560747663551402, 2.220779220779221, 1.0675322649822592, 1.0496644295302013, 1.0797607655502393, 1.1875, 1.0740004235991811, 1.027805307551287, 1.2697697697697699, 1.0581052631578947, 1.2307692307692308, 1.0163220892274212, 1.1551724137931034, 1.5625, 1.0535352458142262, 1.5769230769230769, 1.0050403225806452, 1.1346633416458853, 1.0277200277200278, 1.0222259639669977, 1.0119047619047619, 2.75, 1.0821256038647342, 1.097558733776977, 1.0381743430190566, 1.0152783917220254, 1.058564394920964, 1.0734439469756825, 1.1818181818181819, 1.1055846422338569, 1.0664583333333333, 1.0235331749223178, 1.035070140280561, 1.0208333333333333, 1.2732491389207807, 1.0313583692802166, 1.374251497005988, 1.061900174157928, 1.0, 1.3333333333333333, 1.0740290242033177, 1.0047840157591108, 1.234401668879196, 1.0822351959966638, 1.0678371907422186, 1.1538461538461537, 1.1027688243585574, 1.0895228079400552, 1.1121323529411764, 1.0, 1.0601336302895323, 1.0857998331124528, 1.119047619047619, 1.75, 1.0548696695386628, 1.1697465381812293, 1.0547203848466626, 1.0113636363636365, 1.2490948587979724, 1.033651254554994, 1.1633398931684003, 1.2903225806451613, 1.3076923076923077, 1.0262803234501348, 1.1728395061728396, 1.125, 1.7916666666666667, 1.0775393898759638, 1.1873141724479683, 1.1509121061359868, 1.0, 1.0113624835142538, 1.0526315789473684, 1.0753012048192772, 1.222024163200634, 1.3333333333333333, 1.2173913043478262, 1.3333333333333333, 1.1274817136886102, 1.2307692307692308, 1.0, 1.1538461538461537, 1.00265604249668, 1.0778985507246377, 1.0221189885445812, 1.0045915592103158, 1.2654545454545454, 1.2592592592592593, 1.0666666666666667, 1.1290322580645162, 1.1486486486486487, 1.0571428571428572, 1.1567567567567567, 1.0343502428020506, 1.0297243144966792, 1.3473684210526315, 1.0919896322739924, 1.0476102297182324, 2.5, 1.0681756319961893, 1.4, 3.0, 2.0, 1.170414201183432, 1.074661120275407, 1.0744750278321624, 1.2546583850931676, 1.0, 1.097872340425532, 1.065359477124183, 3.0, 2.0, 1.0520320994046077, 1.198548191961285, 1.0253654879420218, 1.6666666666666667, 1.0186585776879002, 1.0410534469403563, 1.0502564102564103, 1.0, 1.028169014084507, 1.0237614290581114, 1.144736842105263, 1.1140006047777442, 1.0609181358003141, 1.2283236994219653, 1.09765625, 1.1010677020140742, 1.0762867647058822, 1.0867768595041323, 1.15, 1.0317275434121054, 1.2391633828432858, 1.1019219497899775, 1.251497005988024, 1.1470588235294117, 1.2537313432835822, 1.1424501424501425, 1.0616588419405322, 1.0115301125750922, 1.0911285686913201, 1.091703056768559, 1.5, 1.6666666666666667, 1.075624880138081, 1.18117854001759, 1.1567788368021785, 1.0339711098292854, 1.0555276802140827, 1.151740748850449, 1.1519274376417235, 1.0666666666666667, 1.1267195975159185, 1.1055248505270079, 1.220863309352518, 1.1676891615541922, 2.5, 1.056338028169014, 1.112657659496306, 1.1525750481960892, 1.0083924810857188, 1.0952635619463302, 1.0177556818181819, 2.0, 1.0594059405940595, 1.0169388722857553, 1.1672378341329679, 1.311787072243346, 1.0792924235922376, 1.0096463022508038, 1.1545253863134657, 1.0255072463768116, 1.032766122681531, 1.0697028369391364, 1.0046082949308757, 1.0483221476510067, 1.0, 1.079107505070994, 1.0651796325075418, 1.034153005464481, 1.0653581337991984, 1.128060263653484, 1.0325264750378216, 1.2, 1.2297650130548303, 1.6666666666666667, 2.0, 1.1764705882352942, 1.0051150895140666, 1.0308056872037914, 1.0502320502320501, 1.001783499422608, 1.0094979647218454, 1.0035691790888095, 1.1358695652173914, 1.1395348837209303, 1.0444734386946977, 1.6, 1.4166666666666667, 1.1750095529231945, 1.1428571428571428, 1.0287671232876712, 1.1380690345172586, 1.0270392068499323, 1.0806430669847917, 2.0, 1.035294117647059, 1.2596899224806202, 1.0826133909287257, 1.0395882455480425, 1.1085858585858586, 1.1106164383561643, 1.1497369304824807, 1.1464347396989885, 1.014516129032258, 1.3396226415094339, 1.1159217877094971, 1.0, 1.0, 1.0417367046958264, 5.0, 1.4285714285714286, 1.588235294117647, 1.0072904009720534, 1.1058823529411765, 1.0720620842572062, 1.0863083562181248, 1.0, 1.08504034761018, 1.0204439252336448, 1.1614583333333333, 1.3004807692307692, 1.4285714285714286, 1.0551603498542275, 1.3181818181818181, 1.1495535714285714, 1.073261435477873, 1.0257553703992282, 1.085083625048619, 1.083111505471754, 1.0, 1.1965985531158776, 1.040582038336284, 1.0306671449067433, 1.1774193548387097, 1.0702016046081053]
origin-bjaq_15.71 	max: 5.0000	99th: 2.5025	95th: 1.6667	median: 1.0825	mean: 1.1717

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 13.993592 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[8.3446503e-07 1.4901161e-06 1.7881393e-07 9.5367432e-07 1.1920929e-07]
Distance score: 7.152557373046875e-07
SAUCE Drift detection: False
Detection latency: 0.0238s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.047225 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 3.0000	95th: 1.7500	median: 1.0820	mean: 1.1838
ReportEsts: [1.0503978779840848, 1.0128428384849804, 1.0499303843627006, 1.0665529010238908, 1.4583333333333333, 1.0, 1.031072695035461, 1.031367044799077, 1.0, 1.0419889502762432, 1.1366431282125187, 1.0415801196696126, 1.0239943542695835, 1.1055662188099808, 1.0683886116818315, 1.206896551724138, 1.1941747572815533, 1.6666666666666667, 1.4545454545454546, 1.139475908706678, 1.0525972614648988, 1.0015041228114472, 1.0895522388059702, 1.0099585062240664, 1.0005203364842599, 1.0288057651919038, 4.0, 1.1394768874506427, 1.75, 1.1666666666666667, 1.0686600221483942, 1.0, 1.050893091916435, 1.0003614189152819, 1.0498855835240275, 1.0701732825365613, 1.2263712641287012, 1.1666666666666667, 2.5, 1.0716564743419303, 1.0346901017576318, 1.0330025589436056, 1.1455223880597014, 1.1155104712041886, 1.0147874306839186, 1.0948096164535854, 1.2727272727272727, 1.0229430379746836, 1.0081967213114753, 1.0712858094603597, 1.5185185185185186, 1.2256637168141593, 1.0843881856540085, 1.0277777777777777, 1.007876288163923, 1.016428214939278, 1.080036106514217, 1.1292682926829267, 1.0869565217391304, 1.0744848187822353, 1.1690140845070423, 1.0744184855005636, 1.0732824427480916, 1.2115384615384615, 1.0515463917525774, 5.0, 1.0948251305586327, 1.2746534135495684, 2.0, 1.0, 1.0045573922447089, 1.0100806451612903, 1.0445304937076476, 1.0406189555125724, 1.0867728558694725, 1.1017780502759043, 1.0383187169155408, 1.1330049261083743, 1.4660194174757282, 1.0719179021887262, 1.0009727626459144, 1.0169491525423728, 1.0, 3.0, 1.0471380471380471, 1.0634920634920635, 1.236842105263158, 1.5, 1.6666666666666667, 1.1145475189100156, 1.111979558094093, 1.1871062578748426, 1.0494535029564593, 1.1041938490214351, 1.081151832460733, 1.0601156069364162, 1.1395348837209303, 1.0333333333333334, 1.2124105011933175, 1.2744630071599046, 1.2142857142857142, 3.0, 1.035897435897436, 1.1335910652920962, 1.0701001430615165, 1.2337936046511628, 1.5517241379310345, 1.0132947598539095, 1.099193909538737, 1.1833428084138715, 1.09689557855127, 1.0409564996184177, 1.125, 1.0, 1.0512870514820594, 1.08417323343834, 1.0572178477690288, 1.2159090909090908, 1.0646629468288207, 2.0, 1.1439433665443104, 1.2222222222222223, 1.5, 1.0225225225225225, 1.125, 1.1504065040650406, 1.016575073774982, 1.0492607657046937, 1.1083333333333334, 1.8333333333333333, 1.2184531886024423, 1.0, 1.0909090909090908, 1.127823691460055, 1.1666666666666667, 1.2903981264637003, 1.0241951543312313, 1.076453243470935, 1.3333333333333333, 1.3571428571428572, 1.0307377049180328, 1.049731182795699, 1.0626579080343608, 1.0386325051249357, 1.1987951807228916, 1.0148760330578512, 1.0913282263294424, 1.5, 1.007909604519774, 1.011472275334608, 1.101752402487281, 1.0935019112025874, 2.0, 1.1193502824858756, 1.004950495049505, 1.0632478632478632, 1.0833333333333333, 2.0, 1.0303643724696356, 1.1250126275381351, 1.1037818454738773, 1.084717607973422, 1.1098591549295775, 1.2982456140350878, 1.3636363636363635, 1.032490974729242, 1.2, 1.0699585025781122, 1.1666666666666667, 1.1266846361185985, 1.0678904365588127, 1.0799467021985343, 1.0046752379362165, 1.3240901213171576, 1.1106796116504853, 1.076669613437274, 1.0862533692722371, 1.01861504095309, 1.092622950819672, 1.043273013375295, 1.157819225251076, 1.2162729794902378, 1.1818181818181819, 1.2857142857142858, 1.022198301749069, 1.0757010576205732, 1.2943262411347518, 1.415543219666931, 1.0047619047619047, 1.5, 1.1805555555555556, 1.1201240691242265, 1.5238095238095237, 1.1514533401325855, 1.1035135981023605, 1.0698830975909062, 1.0425735345891438, 1.0977295162882528, 1.0331762810341039, 1.5214262871762072, 1.0, 1.0733348284368693, 1.0045152091254752, 1.0489112319764091, 1.0597085096379877, 1.1040680343678766, 1.0194174757281553, 1.144927536231884, 1.2, 1.0, 1.3795620437956204, 1.1648090747213613, 1.3429394812680115, 1.2307692307692308, 1.0203911776945485, 1.0909090909090908, 1.0415130509076942, 1.0841346153846154, 1.2069856155129937, 2.0, 1.083132530120482, 1.0188781014023733, 1.0639845641283765, 1.0067147428243948, 1.0, 1.0259197324414715, 1.086796725023381, 1.0103275570743386, 1.0288713910761156, 1.0606060606060606, 1.127899686520376, 1.0845182196944647, 1.3801652892561984, 1.0045964589722178, 1.1666579575342704, 1.1419558359621451, 1.1034816247582204, 1.025945945945946, 1.0, 1.2191601049868765, 2.0, 1.2374939290917921, 1.1202525768409324, 1.1560738581146743, 1.1563636363636363, 1.0, 1.2, 1.075593542260209, 1.140625, 1.0884803635939868, 1.6, 1.0832721936903889, 1.1703406813627255, 1.2857142857142858, 1.012324294984874, 1.016470588235294, 1.156637168141593, 1.0384615384615385, 1.0070422535211268, 1.169136260298931, 1.0303030303030303, 2.0, 1.130705732090966, 1.0317011372341052, 1.1153284671532846, 1.0209451057026115, 1.1365649369404063, 1.0108869632409758, 1.0977088948787062, 1.0407096745860964, 1.0235, 1.0004626416840157, 1.0179166666666666, 1.2142857142857142, 1.0170193707311612, 1.1492842535787322, 1.2653061224489797, 1.2857142857142858, 1.2331658291457286, 1.0707964601769913, 1.0048894906133854, 1.0270308123249299, 1.1822429906542056, 1.396186440677966, 1.0012576234316124, 1.1078355314197053, 1.1171283471837488, 1.05672880555932, 1.3, 1.1030927835051547, 1.0297213622291022, 1.0980450806537763, 1.1152432962061065, 1.081400204138443, 1.084412221646815, 1.1801552106430155, 1.0491955666785842, 1.0142881327238868, 1.1574885687950696, 1.0443653161389663, 1.0073193046660567, 1.0434782608695652, 1.0, 1.0773587717990758, 1.05, 1.023465703971119, 1.014082765612829, 1.0574049954030034, 1.4594594594594594, 1.0420168067226891, 1.0507122507122506, 1.0588842975206612, 1.116451258437549, 1.1304347826086956, 1.229751872659176, 1.0148240721659765, 1.1169724770642202, 1.25, 4.333333333333333, 1.0130985613055614, 1.1111111111111112, 1.008047565482886, 1.0365659777424483, 1.2, 1.1153477874290405, 1.2692307692307692, 1.6666666666666667, 1.0075396853556249, 3.0, 1.0666666666666667, 1.0385078219013237, 1.1130905870708965, 1.0734169470786172, 1.198992443324937, 1.1237113402061856, 1.1112311136611652, 1.0879369801879775, 1.0365853658536586, 1.0098963210016607, 1.0783352194140576, 3.0, 1.1, 1.0584570607873536, 1.0, 1.0803903345724908, 1.4736842105263157, 1.4, 1.5, 1.3780183180682763, 1.0703125, 1.246031746031746, 1.0198675496688743, 1.2592592592592593, 2.0, 1.068651306895821, 2.0, 1.0724637681159421, 1.0240968564644264, 1.2393162393162394, 1.0549199084668193, 1.0232342007434945, 1.0, 1.0, 1.2572298325722984, 1.0254777070063694, 1.0327868852459017, 1.128783312651421, 1.2442710268797226, 1.0271604938271606, 1.3333333333333333, 1.0293103598767532, 1.0175438596491229, 1.826086956521739, 2.0, 1.043103448275862, 1.1428571428571428, 1.0043103448275863, 1.1616161616161615, 1.1676379080448418, 1.0710235945745563, 1.0140515222482436, 1.0528277071459886, 1.1061093247588425, 1.0641592920353982, 1.1428571428571428, 1.11293890748199, 1.0528052805280528, 1.1111111111111112, 1.0018603597010203, 1.052381856139685, 1.1493533583646225, 1.0046296296296295, 1.0681818181818181, 1.2309368191721133, 3.0, 1.1458333333333333, 1.1557377049180328, 1.2058252427184466, 1.2395209580838322, 1.0430839002267573, 1.0648098553829672, 1.0869705787261559, 1.0074770978206067, 1.0572300648607402, 1.0241815476190477, 1.1022727272727273, 1.2105263157894737, 1.0645994832041343, 2.0, 1.0887822575926034, 1.4901960784313726, 1.1047516808859257, 1.1577267607144772, 1.0493146104981612, 1.1402214022140222, 1.75, 1.0980998674326117, 1.1666666666666667, 1.029874213836478, 1.0, 1.102970847277428, 1.0169082125603865, 1.1226933117292286, 1.1121794871794872, 1.050390347764372, 3.0, 1.3119617224880382, 1.0133193650761125, 1.1060918749522282, 2.0, 1.0129870129870129, 1.272146847565842, 1.2897196261682242, 1.105223263506064, 1.0213040217493203, 1.28, 1.0815024805102764, 1.0233118330944417, 1.0428353707967184, 1.013803010430329, 1.0373616578771447, 1.1250971250971251, 2.5, 1.003155996393147, 1.013485373325591, 1.201834862385321, 1.0016402405686167, 1.0, 1.5, 1.127319257837492, 1.135135135135135, 1.0388619014573213, 1.140292819895708, 1.075168481078279, 1.0, 1.184873949579832, 1.1428571428571428, 1.00552704992982, 1.0, 1.0, 1.0317787177203919, 1.3333333333333333, 2.0, 1.007745933384973, 2.0, 1.010345942450695, 1.0098559514783927, 1.0495867768595042, 1.2, 1.0735065856579005, 1.0682967959527825, 1.45, 1.1324597410798862, 1.0952380952380953, 1.1444444444444444, 1.0067476383265856, 1.3464539007092198, 1.055287009063444, 1.0, 1.0823529411764705, 1.0376417233560091, 1.1198110023624706, 1.0536, 1.2, 1.1181481481481481, 1.003936706298183, 1.024945295404814, 2.0, 1.0587454364420843, 1.0168369648355529, 1.0214330530806877, 1.0018157388241276, 1.0051888992537314, 1.108290948595131, 1.0314787701317716, 1.0305311585110832, 1.5, 1.0964493445611598, 1.0847058823529412, 1.0510648596321395, 1.0821992378878607, 1.1185983827493262, 1.0060856154391231, 1.1683168316831682, 1.0502558959542172, 1.0690964312832194, 1.0144552647595861, 1.1352295409181636, 1.1193684158095285, 1.0451506273007287, 1.0, 1.4090909090909092, 1.100464050342815, 1.0, 1.0279382667194301, 1.0697424785064356, 1.6666666666666667, 1.0537549407114624, 1.3868194842406876, 1.1666666666666667, 1.3061224489795917, 1.019086159596909, 1.1563636363636363, 1.043331345656927, 1.0, 1.1363636363636365, 1.0102857142857142, 1.1618062889653529, 1.0422640104263639, 1.0058608996096998, 1.1215426567978184, 1.0526315789473684, 1.0070814365199798, 1.0401234096497793, 1.5714285714285714, 1.0332896400344376, 1.056658246120534, 1.1218274111675126, 1.0788579321374698, 1.2431906614785992, 1.015986114917329, 2.0, 1.1309603760913365, 1.0, 1.0051425650259798, 1.0634573304157549, 1.117053481331988, 1.053082191780822, 1.0620592383638927, 1.1259064236149847, 1.0, 1.4107142857142858, 1.5, 1.0, 1.1714285714285715, 1.0301003344481605, 1.0116731517509727, 1.0850202429149798, 1.057051877404803, 1.060752994865944, 1.0377031194401614, 1.1827166504381694, 1.0504461606178224, 1.0670570405607047, 1.0236725985550115, 1.071084981293426, 1.0713050841477614, 1.040161192024975, 1.0306867998051632, 1.0832420591456735, 1.090800477897252, 1.7181818181818183, 1.0565664716562437, 1.178698224852071, 1.098236182777767, 1.3181818181818181, 1.1636840849439274, 1.0726915520628684, 2.0, 1.0684769775678866, 1.125, 1.3333333333333333, 1.5, 1.0509061707789447, 1.0435276305828918, 1.0101010101010102, 1.1292134831460674, 1.1183878405850491, 1.027965544056948, 1.0827205882352942, 1.2, 1.4444444444444444, 1.0353923574628103, 1.0737327188940091, 1.0597014925373134, 1.0785730939612963, 1.0, 1.0532486565705912, 1.1367521367521367, 1.0965855820534238, 1.0875370919881306, 1.0303468882767637, 1.4348157173317089, 1.0053423103662775, 1.3368421052631578, 2.0, 1.1614135625596944, 1.0, 1.0881642512077294, 1.1882845188284519, 1.3608540925266903, 1.0968783638320776, 1.9130434782608696, 1.0290023201856149, 1.1397058823529411, 1.029090909090909, 1.0564948788814827, 1.22920759659463, 1.047301394784718, 1.0397971127584862, 1.01806684733514, 1.0659722222222223, 1.4, 1.0243315508021391, 1.0438611289179798, 1.0454545454545454, 1.038915913829048, 1.181209978017777, 1.154867256637168, 1.026004621439145, 1.3333333333333333, 1.0036363636363637, 1.0325362602900823, 1.0743243243243243, 1.2011834319526626, 1.0748660216523396, 1.0846153846153845, 2.0, 1.0239637305699483, 1.0133422281521014, 1.1173495337666008, 1.1792698826597132, 1.0000240224081023, 1.0261251270320295, 1.1737756714060033, 1.0807808818579603, 1.2428571428571429, 1.0561137961120315, 1.0686015831134565, 1.2196796338672768, 1.00839222614841, 1.0101339487282397, 1.5, 1.1172870140612077, 1.3157894736842106, 1.6, 1.0236612702366128, 1.6057109893279493, 1.04797507788162, 1.3902439024390243, 1.0769230769230769, 1.0168946098149638, 1.040348964013086, 1.029940119760479, 1.0798962528904412, 2.0, 1.225602621109291, 1.5, 1.0935672514619883, 1.0714285714285714, 1.0374875794164584, 1.4193548387096775, 1.2056737588652482, 1.051528384279476, 1.0, 1.2304147465437787, 1.218145430286858, 1.2, 2.0, 1.0555555555555556, 1.2140762463343109, 1.0506694670517196, 1.2012644889357218, 1.0706214689265536, 1.0952380952380953, 1.08, 1.1478743068391868, 1.196911196911197, 1.0612244897959184, 1.0333333333333334, 1.0, 1.2894736842105263, 1.0860606060606062, 1.0606060606060606, 1.0006905481225723, 1.0595598022928254, 1.0757592654548158, 1.0804709773767942, 1.3153832292167227, 1.2365853658536585, 1.0123395853899309, 1.7142857142857142, 1.0, 1.40625, 1.028838920531769, 1.0580029368575623, 1.1243093922651934, 1.1244444444444444, 1.0155832591273375, 1.0425269573916178, 1.0039845109153152, 1.1904761904761905, 1.2380952380952381, 1.1807692307692308, 1.0023135397157652, 1.0777390032965972, 1.051929385309084, 1.0277777777777777, 1.0413805900909259, 1.0309886793574812, 1.1547225042524294, 1.1022058823529413, 1.0706308930864894, 1.0284810126582278, 1.0666128381106177, 1.0614657210401892, 1.0294599611796078, 3.0, 1.1313279530447542, 1.0, 1.0077972709551657, 1.021120458206551, 1.1343283582089552, 1.0639557627152358, 1.01985559566787, 1.0222222222222221, 1.0217826385800348, 1.0393923016873836, 1.1083342662039628, 1.0449526813880126, 1.0635071090047394, 1.1843505390122286, 1.1845342706502635, 1.3529411764705883, 1.0, 1.3333333333333333, 1.0671395180140244, 1.5, 1.094366971559954, 1.103337210342668, 1.0430892824538982, 1.0496595249958478, 1.0770520522402087, 1.0425342587649047, 1.0212121212121212, 1.005720823798627, 1.0157145071973477, 1.0992626979792464, 1.040620122775986, 1.1616844424415402, 2.0, 1.103921568627451, 1.056105610561056, 1.1004654658995634, 1.0710227272727273, 1.2817028985507246, 1.0479134466769706, 2.2007168458781363, 1.0514282423404746, 1.0338600451467268, 1.0671989620240532, 1.0, 1.0873676062823943, 1.0416982617039399, 1.260325406758448, 1.0519888346127007, 1.054054054054054, 1.0954828138383048, 1.0782577479956923, 1.0616321718627195, 1.321875, 1.0169382813972674, 1.2258064516129032, 1.058848553601815, 1.0818008877615726, 1.0417193426042983, 1.1465428276573788, 1.010909090909091, 1.044204322200393, 1.0740556660039762, 1.0032319280054778, 1.0826044703595723, 1.0528243387268676, 1.0408122692416928, 1.1538461538461537, 1.080887616320687, 1.045493125106094, 1.234624145785877, 1.099362271137626, 1.1214470284237725, 1.1586345381526104, 1.191869918699187, 1.0, 1.0545441495388432, 1.125, 1.1005229517722255, 1.2395833333333333, 1.0347938144329898, 1.0367278797996662, 1.115006731064453, 1.1617478908495318, 1.0784053156146178, 1.104722792607803, 1.1042866282789507, 1.0969809131839903, 1.116385911179173, 1.1144278606965174, 1.023522316043426, 1.0861726930628273, 1.0480769230769231, 1.75, 1.0403180215184988, 1.168808403338682, 1.0090996168582376, 1.0186046511627906, 1.1900851581508516, 1.002450169247473, 1.1383677298311445, 1.2049180327868851, 1.2666666666666666, 1.0294936004451865, 1.0270793036750483, 1.123076923076923, 1.71875, 1.039555799440099, 1.1994970662196145, 1.1965811965811965, 1.0392156862745099, 1.0476190476190477, 1.3055725658297612, 1.125, 1.18, 1.0145542753183747, 1.048780487804878, 1.0394929302779132, 1.0833333333333333, 1.0262291250584286, 1.0778894472361809, 1.0562881562881563, 1.1693548387096775, 1.0666666666666667, 1.132944606413994, 1.0227532787606726, 1.0292100203188284, 1.3533026113671276, 1.3174603174603174, 1.2941176470588236, 1.0833333333333333, 1.021978021978022, 1.0121951219512195, 1.1203931203931203, 1.0378878860578993, 1.0281841127240936, 1.3189655172413792, 1.0732078092884756, 1.0457550923476253, 2.5, 1.0311106382046524, 1.0104223806911683, 1.5, 2.5, 1.1929695181907571, 1.1235587780815404, 1.0880388059378283, 1.1453634085213034, 1.5, 1.2962962962962963, 1.2401055408970976, 1.5, 1.0980635294603922, 1.1176745015710974, 1.0543587678679283, 1.0131981839298911, 1.4285714285714286, 1.0324163966723798, 1.0446313065976713, 1.0086880973066898, 1.3132530120481927, 1.0070921985815602, 1.0, 1.1046511627906976, 1.1851474530831099, 1.0000808616618688, 1.013793103448276, 1.0792079207920793, 1.110545064542077, 1.0722983257229832, 1.0784313725490196, 1.3770491803278688, 1.0494254994839407, 1.5541481950601648, 1.0317133010663382, 1.196078431372549, 1.112, 1.1536819637139808, 1.25, 1.098708487084871, 1.0360824742268042, 1.00746712173036, 1.0904059040590406, 1.5, 1.0858688302907369, 1.0024361022364217, 1.2193595877806405, 1.1513583441138422, 1.0119103386892772, 1.0449826989619377, 1.0914259959088861, 1.032319391634981, 1.0178571428571428, 1.015605615409729, 1.097862411432381, 1.2472187886279358, 1.0922098569157392, 2.0, 1.0, 1.0561996430179992, 1.0298062593144561, 1.0003895800327247, 1.0922844935913547, 1.0246623605402232, 1.8, 1.0457856399583767, 1.0421840742194606, 1.1777354900095147, 1.2254901960784315, 1.073406927223452, 1.1078167115902966, 1.1483516483516483, 1.0348162475822051, 1.0312848621537214, 1.1048674317372378, 1.0896817743490839, 1.0481522956326987, 1.0555555555555556, 1.1318353869694773, 1.2788837209302326, 1.023843135378284, 1.055986853289511, 1.116605934409162, 1.0203045685279188, 1.4782608695652173, 1.244060475161987, 1.6666666666666667, 1.0, 1.12, 1.044150110375276, 1.0713333333333332, 1.0537947744090106, 1.0115793936673187, 1.003203661327231, 1.0317124735729386, 1.1936936936936937, 1.1607142857142858, 1.0522525471582307, 2.0, 1.2352941176470589, 1.2659355723098011, 1.0, 1.018161180476731, 1.140625, 1.0296045197740114, 1.0931210715708315, 2.5, 1.059370160041301, 1.119718309859155, 1.083635466297147, 1.0383525656201553, 1.2075869336143308, 1.1179138321995465, 1.1412002297445019, 1.075613177882057, 1.0450070323488045, 1.2878787878787878, 1.064367816091954, 1.0, 2.0, 1.0407102706324685, 5.0, 1.8571428571428572, 1.7222222222222223, 1.0, 1.0624625703677086, 1.0299435028248587, 1.0564516129032258, 1.1666666666666667, 4.068181818181818, 1.0057609217474797, 1.0510204081632653, 1.2504892367906066]
origin-bjaq_15.71 	max: 5.0000	99th: 3.0000	95th: 1.7500	median: 1.0820	mean: 1.1838

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.271613 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.339671