Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 85, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.5025	95th: 1.6906	median: 1.0824	mean: 1.1743
ReportEsts: [1.0698412698412698, 1.00703125, 1.0498603937907787, 1.0633946830265848, 1.5, 1.0, 1.05280242371781, 1.0264044428125574, 1.0, 1.0103761348897535, 1.147548552794852, 1.0434564893760996, 1.047975352112676, 1.069767441860465, 1.0604026845637584, 1.0, 1.4285714285714286, 1.014169323414807, 3.0, 2.0, 1.125, 1.107634244219377, 1.0970013037809647, 1.1209630064591896, 1.0626541687222497, 1.0, 1.1818248902335535, 1.5, 1.4, 1.0, 1.0, 1.048827103010953, 1.002109886324492, 1.025527192008879, 1.0459685710089588, 1.2413648205731573, 1.13903743315508, 1.0086505444552754, 1.1356498381431228, 1.119047619047619, 1.1320754716981132, 1.0365853658536586, 1.0, 1.0564088983050848, 1.1886688668866887, 1.8333333333333333, 1.0097087378640777, 1.1413427561837455, 1.0380646472860338, 1.1111111111111112, 1.141886501801777, 1.0498281786941581, 1.042125900441551, 2.0, 1.2, 1.1786755211215643, 1.097366320830008, 1.3592233009708738, 1.0993788819875776, 1.25, 1.0941703017084696, 1.082191780821918, 1.1818181818181819, 1.0740740740740742, 1.1, 1.0985171102661597, 1.2693864839613827, 1.75, 1.0, 1.053509834995805, 1.0435865504358655, 1.0695906432748539, 1.0277777777777777, 1.0914810327150712, 1.1011764705882352, 1.0384615384615385, 1.3333333333333333, 1.1102296450939457, 2.0, 1.001048473967684, 1.28125, 1.0182886654906378, 1.1840490797546013, 1.0982367758186398, 1.1261040235525024, 1.0, 1.0733012721067328, 1.0091991980186343, 1.0343137254901962, 1.75, 1.2356828193832599, 1.0564316426584162, 1.0778816199376946, 1.0462833099579243, 1.0233644859813085, 1.044155844155844, 1.0546875, 1.14453125, 1.0, 1.2343870470316114, 1.040748740100792, 1.0780445969125214, 1.2224570787680096, 1.2592592592592593, 1.0283377273884229, 1.0602601539686753, 1.1800348735832606, 1.1221084565794464, 1.045677498467198, 1.3333333333333333, 1.6666666666666667, 1.066822429906542, 1.0658989890186508, 1.0644346178142767, 1.1688311688311688, 1.0623162808301267, 1.0, 1.1173131504257332, 1.130952380952381, 1.0, 1.0164835164835164, 1.0, 1.1929824561403508, 1.0234412306734535, 1.0326162926147395, 1.0467289719626167, 1.8, 1.1548013245033113, 1.0, 1.2173913043478262, 1.1050597581049166, 1.1818181818181819, 1.0782877604166667, 1.0303340513857575, 1.0653316645807258, 1.0761014686248331, 1.0167130919220055, 1.0436477007014808, 1.039972432804962, 1.089579524680073, 1.0351823944907015, 1.2272727272727273, 1.0013046314416179, 1.0937678743108883, 2.0, 1.0227894257064722, 1.0391923990498813, 1.1094287680660702, 1.1143462149285337, 1.5, 1.1088641317510293, 1.0, 1.0183299389002036, 1.1074561403508771, 1.0103244837758112, 1.0187120701281187, 1.0537274275028607, 1.0768633163389172, 1.02734375, 1.055921052631579, 1.3061224489795917, 1.2777777777777777, 1.0294550810014726, 1.4285714285714286, 1.070650610726544, 1.0481742140618686, 1.128654970760234, 1.3935323383084577, 1.1344421344421345, 1.1662293604728207, 1.2821052631578946, 1.127962085308057, 1.105161227849327, 1.0273003033367036, 1.0034632034632034, 1.0787172011661808, 1.046592709984152, 1.1116279069767443, 1.0767004796728787, 1.0, 1.2142857142857142, 1.0810068649885582, 1.028907496012759, 1.1693705386112914, 1.013157894736842, 1.1084882598503178, 1.3250048049202383, 1.1143215808497284, 1.1153846153846154, 1.055, 1.0603205097028354, 1.0, 1.2727272727272727, 1.0517331826802792, 1.0136208853575484, 1.0093066542577944, 1.4583333333333333, 1.0610932475884245, 1.0534845362943628, 1.0783006738140584, 1.0626410835214446, 1.0756825129124064, 1.1694915254237288, 1.0666666666666667, 1.2352941176470589, 1.0, 1.3793103448275863, 1.2460179782368712, 1.289198606271777, 1.2413793103448276, 1.0143351458230352, 1.0031277926720286, 1.0313090799865716, 1.0087948063477972, 1.1522975602454721, 1.0602409638554218, 1.1019108280254777, 1.01747444774151, 1.0429088402550406, 1.0431507586355322, 1.0, 1.0766045548654244, 1.079589545624643, 1.01118228171796, 1.1475811390079609, 1.0172573761365744, 1.2770876093766879, 1.0357142857142858, 1.0041582841606411, 1.1628416709644147, 1.003384094754653, 1.0847457627118644, 1.0602595117659996, 1.0595744680851065, 1.221259842519685, 2.0, 1.251330573625074, 1.0661567664135776, 1.2182372245663384, 1.1355932203389831, 1.0, 1.6666666666666667, 1.0980109389564026, 1.1272727272727272, 1.1218107884414696, 1.5, 1.0, 1.25, 1.0729898516783762, 1.0, 1.0055555555555555, 1.1339662447257384, 1.0383333333333333, 1.0062972292191437, 1.1088054818915623, 1.0178571428571428, 2.0, 1.081888840910493, 1.0557044549076422, 1.1050788091068302, 1.0188347931517445, 1.1347301074958933, 1.0234322545991674, 1.0866454689984102, 1.0780768621375632, 1.027511961722488, 1.0927032661570535, 1.140635943409441, 1.0909090909090908, 1.0220748925721301, 1.247340425531915, 1.1818181818181819, 1.3157894736842106, 1.0014545454545454, 1.0555555555555556, 1.0085470085470085, 1.1156988089630577, 1.0227920227920229, 1.380952380952381, 1.004767920453156, 1.0401396160558465, 1.0347261144755369, 1.0541361373678617, 1.25, 1.0176016583686538, 2.5, 1.0386300121772802, 1.069284064665127, 1.0604842747257748, 1.0810810810810811, 1.6666666666666667, 1.3043478260869565, 1.0923076923076922, 1.0578846549418903, 1.0, 1.0, 1.0610859728506787, 1.0044070512820513, 1.0197016867245945, 1.111764705882353, 1.1761006289308176, 1.0032847310709105, 1.1352132579650565, 1.130112532200479, 1.0854700854700854, 1.0, 1.1097852028639619, 1.2848101265822784, 1.1505376344086022, 1.0400420573030755, 1.031276063386155, 1.053412462908012, 1.372093023255814, 1.0125, 1.0388635754489413, 1.2857142857142858, 1.0018658360439678, 1.024390243902439, 1.0555555555555556, 1.0756074868651488, 1.0952380952380953, 1.4, 1.0240918024472199, 2.0, 1.1796982167352539, 1.055232558139535, 1.0557834290401968, 1.1160827353313634, 1.1005747126436782, 1.123456790123457, 1.1260163151557787, 1.071849922510812, 1.02945301542777, 1.0291300642177834, 1.0151846881841937, 2.0, 1.0, 1.0638497223428323, 1.25, 1.0697544642857142, 1.3529411764705883, 1.0, 1.375, 1.3815261044176708, 1.0659133709981168, 1.075, 1.0378787878787878, 1.0, 1.254993342210386, 1.044817422419008, 2.0, 1.4395473496128648, 1.0, 1.0998254004402945, 1.0853658536585367, 1.019720118802344, 1.1359447004608294, 1.1363636363636365, 1.1543756145526056, 1.1388888888888888, 1.016718688602377, 1.0140925852716445, 1.0790229885057472, 1.0, 1.0769230769230769, 1.5714285714285714, 3.0, 1.3333333333333333, 1.0692027047415271, 1.3333333333333333, 1.1148086522462561, 1.1348314606741574, 1.0657574939238454, 1.1165868843024929, 1.247167868177137, 1.0092452651962405, 1.009860788863109, 1.0297619047619047, 1.5, 1.170731707317073, 1.0510638297872341, 1.0567213182032709, 1.1904761904761905, 1.5714285714285714, 1.0158371040723981, 1.0123602118893467, 1.033990819561504, 1.0174563591022443, 1.1464387464387464, 1.0068399452804377, 1.0256410256410255, 1.0907770515613653, 1.0614406779661016, 1.25, 1.0226628895184136, 1.1714285714285715, 1.0591447772234375, 1.0561852704257768, 1.0254639730985446, 1.2093023255813953, 1.121212121212121, 1.098159509202454, 1.0, 1.0074130297280202, 1.0552768437327682, 1.0180169841634152, 1.0523451332691645, 1.098414032139481, 1.1474420082618366, 1.5714285714285714, 1.2780517879161528, 1.0, 1.22801024765158, 1.25, 1.0459662342237905, 1.0057971014492753, 1.1325236457437662, 1.0909090909090908, 1.0977973568281938, 3.0, 1.3120676402767102, 1.015093770394907, 1.1479446385874563, 2.0, 1.0476190476190477, 1.2735124760076775, 1.2985074626865671, 1.0888410448064345, 1.1995841995841996, 1.05, 1.1889559965487488, 1.0272249297769669, 1.079324792522762, 1.0957597616131614, 1.2024122807017543, 1.0364842454394694, 1.0681818181818181, 1.875, 1.1161473087818696, 1.5, 1.225752508361204, 1.1515151515151516, 1.1157370235677513, 1.9230769230769231, 1.0843387994584024, 1.0921651858598704, 1.068476249228871, 1.0, 1.1875, 1.16, 1.2863006156464287, 1.2035010940919038, 1.0, 1.0666863164099918, 1.105890452777002, 1.1147948611686698, 1.5, 2.0, 1.003898635477583, 1.013623978201635, 1.022950819672131, 1.1111111111111112, 1.0850235754099975, 1.057942057942058, 1.4705882352941178, 1.1020715630885123, 1.0454545454545454, 1.0853018372703411, 1.0137096774193548, 1.3167858645351282, 1.0436829114287354, 1.0, 1.0571428571428572, 1.0486571118872696, 1.0411186064108964, 1.0173819325143432, 1.0, 1.092899800928998, 1.0186001766442194, 1.0220010476689365, 2.0, 1.0434609250398723, 1.030766244480031, 1.0458974887390702, 1.0707701716831943, 1.0114346531561842, 1.0331201137171286, 1.0126050420168067, 1.1227097396335584, 2.0, 1.0034227039361094, 1.3454545454545455, 1.25, 1.1968911917098446, 1.1730769230769231, 1.0104482712632947, 1.019047619047619, 1.076667240094042, 1.1170261587884351, 1.0479640887883501, 1.046395238739348, 1.0694661164857773, 1.197674418604651, 3.0, 1.0162928914392786, 1.1536437246963562, 1.0444253859348198, 1.0592647298606381, 1.1012176560121765, 1.1934250764525993, 2.2967032967032965, 2.2857142857142856, 1.0104429328774032, 1.0313081456887234, 1.016429477243906, 1.161081492764661, 1.0950636328576937, 1.0061855670103093, 1.0607933417797142, 1.000539374325782, 1.2095531587057011, 2.0, 1.0833333333333333, 1.0858895705521472, 1.0741444866920151, 1.0955882352941178, 1.2048710601719197, 1.1, 1.3266666666666667, 1.148905109489051, 1.0963855421686748, 1.0615562749592382, 1.2555555555555555, 1.042698982184377, 2.0, 1.2041522491349481, 1.0815450643776825, 1.3428571428571427, 1.0935754189944134, 1.0855106888361046, 1.0079681274900398, 1.0907911802853436, 1.0544871794871795, 1.0, 1.0851063829787233, 1.2, 1.5, 1.2045454545454546, 1.1774193548387097, 1.0138888888888888, 1.087378640776699, 1.0648830503043896, 1.0417633410672853, 1.042833666761932, 1.181982401957928, 1.0459143968871596, 1.0819653215570684, 1.1135135135135135, 1.1206896551724137, 1.045960328979197, 1.084026845637584, 1.2109826589595376, 1.1360711002145265, 1.0558962144630821, 1.2946180141505683, 1.0798446776116233, 2.0, 1.1474201474201475, 1.072348860257681, 1.3693693693693694, 1.0, 1.0625, 1.1538461538461537, 1.018018018018018, 1.4814814814814814, 1.1666666666666667, 1.0031980795411521, 1.133310507341242, 1.028738456762979, 1.0253850321182572, 1.2054054054054053, 1.1273972602739726, 2.0, 1.1323529411764706, 1.0447617077039797, 1.0547852418519403, 1.0845784974633401, 1.0681740517143183, 1.0316142836063156, 1.1246753246753247, 1.1524678111587983, 1.0870337477797514, 1.006155122541875, 1.1083039966866846, 1.2424242424242424, 1.0737179487179487, 1.0, 1.2422535211267605, 1.2080157768236817, 3.0, 1.1479054528434356, 1.044725909870857, 1.4285714285714286, 1.0220536799086926, 1.1, 1.1176470588235294, 1.0569574297669753, 1.6153846153846154, 1.0204730309512586, 1.046561298590346, 1.3571428571428572, 1.3181818181818181, 1.1154639175257732, 1.0047824007651842, 1.0763796909492274, 1.029716483652832, 1.1552425808221685, 1.0, 1.0664240712578752, 1.1189024390243902, 2.0, 1.0196046774453953, 1.0772298641751017, 1.1296121097445602, 1.0195230666369512, 1.017355876453072, 1.0970873786407767, 2.0, 1.0217644772638943, 1.0451612903225806, 1.1188298576349414, 1.204983922829582, 1.0225233273201966, 1.0255367168670502, 1.294871794871795, 1.0904665314401623, 1.2408026755852843, 1.0688851359387266, 1.065615141955836, 1.047438330170778, 1.084033613445378, 1.0505672818359304, 3.0, 1.141882081755452, 1.0209153643190583, 1.0534686559234991, 1.5833333333333333, 1.245521455353423, 1.2152466367713004, 1.0, 1.0529731254849404, 1.0420575865415722, 1.1713973799126638, 1.0588235294117647, 1.3333333333333333, 1.07784594309955, 1.5, 1.1378504672897196, 1.0833333333333333, 1.057532621589561, 1.44, 1.1561181434599157, 1.0377358490566038, 1.0, 1.6494708994708995, 1.2271268057784912, 1.5, 2.0, 1.0991735537190082, 1.282758620689655, 1.0231143552311435, 1.18091697645601, 1.090289608177172, 1.28023598820059, 1.1014466214978942, 1.0623376623376624, 1.1136363636363635, 1.2326530612244897, 1.0769230769230769, 1.0, 1.1131019036954088, 1.1053391053391053, 1.03099173553719, 1.0961953435547984, 1.0687936626746506, 1.0055726524162023, 1.0987534461802981, 1.2593984962406015, 1.1671348314606742, 1.006002400960384, 1.8333333333333333, 1.0, 1.1724137931034482, 1.0016923427183728, 1.0511915269196823, 1.107843137254902, 1.0788177339901477, 1.0064560756283145, 1.0135730653974968, 1.0116952210588, 1.0684931506849316, 1.2222222222222223, 1.0242608036391205, 1.0046394485683987, 1.096919924761521, 1.0443646904548278, 1.006578947368421, 1.038984051978736, 1.0159081603251392, 1.3327645051194539, 1.3574338085539714, 1.2857142857142858, 1.042843691148776, 2.1501210653753025, 1.1818181818181819, 1.066860465116279, 1.0701001430615165, 1.0, 1.0605326876513317, 1.0499736801888233, 1.0, 1.053773712575327, 1.0407938257993385, 1.303030303030303, 1.0542052493773548, 1.0255227108868061, 1.130405586892291, 1.0400763358778626, 1.0783353733170136, 1.1986759440653922, 1.1666666666666667, 1.2142857142857142, 1.0, 1.4285714285714286, 1.0625893181542934, 1.3333333333333333, 1.1560534386858659, 1.118948898820742, 1.0358883473637572, 1.066335650446872, 1.0514497666812905, 1.2080385852090032, 1.032258064516129, 1.0360610263522885, 1.0243736351468757, 1.1158136482939633, 1.0467490893034552, 1.2447308201854752, 1.4285714285714286, 1.046875, 1.0118577075098814, 1.1397968733751602, 1.022801302931596, 1.2871099050203527, 1.050185873605948, 2.1737288135593222, 1.0390906675775171, 1.0483221476510067, 1.0697727272727273, 1.125, 1.052543948415033, 1.0268487748493529, 1.2659680638722555, 1.0581052631578947, 1.2307692307692308, 1.0010718113612005, 1.0578947368421052, 1.5625, 1.1038399940407464, 1.4615384615384615, 1.0949227373068433, 1.0756501182033098, 1.0785454545454545, 1.0397408963585435, 1.0119047619047619, 2.75, 1.087378640776699, 1.0902790543769991, 1.0546363686871494, 1.0068734085008624, 1.0447214076246334, 1.0548855185741153, 1.1818181818181819, 1.1114035087719298, 1.0255909357296347, 1.0002009421956284, 1.0170340681362726, 1.0, 1.0653742110009017, 1.0436648904677324, 1.3553149606299213, 1.051053529185234, 1.0, 1.3333333333333333, 1.0598383149150783, 1.0261334103378574, 1.228866757917591, 1.095764989342971, 1.0415003990422984, 1.066350710900474, 1.0973080600486935, 1.0705244122965643, 1.1158088235294117, 1.1144578313253013, 1.043859649122807, 1.0856403082511166, 1.0833333333333333, 1.75, 1.0668188787046535, 1.1693109700815956, 1.0257309941520467, 1.0173410404624277, 1.2411296162201304, 1.0011137795412621, 1.1706494236716334, 1.3745704467353952, 1.3076923076923077, 1.0599730458221024, 1.0869565217391304, 1.153125, 1.5357142857142858, 1.095597273438373, 1.1922695738354807, 1.1683250414593698, 1.048780487804878, 1.0213862975223191, 1.0708797541298503, 1.0712516733601072, 1.1402257872846109, 1.3333333333333333, 1.2173913043478262, 2.0, 1.1549982584465344, 1.3076923076923077, 1.0, 1.1538461538461537, 1.0370860927152319, 1.1123188405797102, 1.0413223140495869, 1.0587788962517073, 1.1090909090909091, 1.2830188679245282, 1.1428571428571428, 1.1290322580645162, 1.135135135135135, 1.0, 1.130281690140845, 1.0264144316946164, 1.0313940113539386, 1.3333333333333333, 1.1065837795695617, 1.047765377108253, 2.5, 1.0677333197237249, 1.2280701754385965, 3.0, 2.0, 1.1597633136094674, 1.0867101771498242, 1.0719373946790585, 1.2267080745341614, 1.0, 1.070539419087137, 1.0920245398773005, 3.0, 2.0, 1.0722955145118733, 1.240489313079715, 1.0181182056728726, 1.6666666666666667, 1.036300484486489, 1.0449264136328427, 1.0241596638655461, 1.0, 1.0187793427230047, 1.024992420275075, 1.3157894736842106, 1.1390056888449172, 1.02366129438917, 1.2801204819277108, 1.12109375, 1.082790198213247, 1.054954954954955, 1.0826446280991735, 1.3018867924528301, 1.013444013353785, 1.388586956521739, 1.0668534543906938, 1.3046875, 1.1372549019607843, 1.2835820895522387, 1.0867208672086721, 1.05243561898852, 1.0111391697525627, 1.0864456792488983, 1.054585152838428, 1.5, 1.6666666666666667, 1.0840311960621365, 1.1684256816182939, 1.1046489009920248, 1.0049459383169081, 1.1381501923398563, 1.1225404413333901, 1.4459016393442623, 1.0212765957446808, 1.0642245106516783, 1.110538102771671, 1.2138769670958511, 1.0477064220183485, 1.6666666666666667, 1.0416666666666667, 1.0077264325323474, 1.1487784792753226, 1.035187158867035, 1.100255621506867, 1.0362215909090908, 2.0, 1.1002570694087404, 1.0391222139460266, 1.172035640849897, 1.1977186311787071, 1.0678848996328614, 1.1337579617834395, 1.3278145695364238, 1.0195035460992907, 1.02992099695528, 1.0674720094284031, 1.0506912442396312, 1.0757575757575757, 1.0, 1.1222552497842555, 1.0584605539811682, 1.034153005464481, 1.0512451615113212, 1.085144927536232, 1.0136157337367624, 1.125, 1.2394736842105263, 1.6666666666666667, 2.0, 1.2352941176470589, 1.0153452685421995, 1.0552922590837284, 1.0244616906337976, 1.0103203455797443, 1.0388059701492538, 1.0098326359832637, 1.1684782608695652, 1.0612244897959184, 1.0888206121060349, 1.6, 1.5833333333333333, 1.1927851047323506, 1.1428571428571428, 1.034435261707989, 1.146095717884131, 1.0693975903614459, 1.1096070506890003, 2.0, 1.0820433436532508, 1.2267441860465116, 1.03751617076326, 1.0395469600080736, 1.1906565656565657, 1.125, 1.1437957992738936, 1.0856308411214954, 1.043117744610282, 1.0289855072463767, 1.111731843575419, 1.0, 1.0, 1.0416383534208362, 5.0, 1.4285714285714286, 1.6875, 1.05470737913486, 1.1058823529411765, 1.085920177383592, 1.138485680659082, 1.0, 1.0651769087523277, 1.0227803738317758, 1.1736842105263159, 1.3221153846153846, 1.4285714285714286, 1.0279619805481874, 1.0210643015521064, 1.1469933184855234, 1.0431387132763108, 1.0346021108391188, 1.0513472771810817, 1.1523217982845313, 1.0, 1.2584507340186994, 1.0451736476993327, 1.0201309182209468, 1.1774193548387097, 1.093713865237044]
origin-bjaq_15.71 	max: 5.0000	99th: 2.5025	95th: 1.6906	median: 1.0824	mean: 1.1743

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 14.011591 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[5.3644180e-07 4.1723251e-07 1.3113022e-06 1.3113022e-06 2.3841858e-07]
Distance score: 7.629394644936838e-07
SAUCE Drift detection: False
Detection latency: 0.0241s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.039165 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 6.0000	99th: 2.6700	95th: 1.6930	median: 1.0815	mean: 1.1822
ReportEsts: [1.0508021390374331, 1.032391304347826, 1.0446238178422986, 1.0603015075376885, 1.5416666666666667, 1.0, 1.1075048779327084, 1.029155345721545, 1.2, 1.0184782608695653, 1.0876288659793814, 1.042498741084246, 1.0358825661471547, 1.1003861003861004, 1.0613931523022433, 1.0, 1.1639344262295082, 1.2857142857142858, 1.4545454545454546, 1.0749789385004211, 1.10063034669068, 1.1246043866055817, 1.1323636363636365, 1.031905961376994, 1.017770711888359, 1.0351463293578806, 2.0, 1.1437524131990853, 2.25, 1.0, 1.0769230769230769, 1.0, 1.0437399295158074, 1.0079995285351535, 1.1803355079217148, 1.0416666666666667, 1.232253354654801, 1.1382289416846652, 1.0, 1.222378804960541, 1.0251925087936116, 1.0280825225971157, 1.0687203791469195, 1.0660724233983288, 1.0129390018484288, 1.0366159947124918, 1.1904761904761905, 1.1674418604651162, 1.1348837209302325, 1.0240641711229947, 1.2857142857142858, 1.1048387096774193, 1.0893617021276596, 1.0606060606060606, 1.0051581018185307, 1.0215583872989347, 1.099893568496275, 1.0765661252900232, 1.041237113402062, 1.0443687245636402, 1.55, 1.1540768461794786, 1.1084905660377358, 1.0946969696969697, 1.1111111111111112, 2.0, 1.0628538026089096, 1.3061115559113958, 2.0, 1.0, 1.078376487053884, 1.0422680412371135, 1.0537530266343826, 1.005703422053232, 1.0120867657109969, 1.0659722222222223, 1.0812452543659834, 1.46, 1.4271844660194175, 1.0874652116595869, 1.0572390572390573, 1.297872340425532, 1.0, 1.3333333333333333, 1.0964408725602754, 1.121212121212121, 2.0, 1.0921052631578947, 1.8888888888888888, 1.144499231557377, 1.117985176221449, 1.2161739318083729, 1.119239041376485, 1.0980901168180974, 1.0623441396508728, 1.0103448275862068, 2.1666666666666665, 1.0198938992042441, 1.3333333333333333, 1.3255630185697354, 1.2916666666666667, 1.6666666666666667, 1.0343026827769815, 1.1401709401709401, 1.105638829407566, 1.2252200259702786, 1.3225806451612903, 1.0169475103761603, 1.0605053191489362, 1.135694249649369, 1.080891719745223, 1.0491507977354606, 1.125, 1.5, 1.0495900039047248, 1.069602428087061, 1.070967741935484, 1.0714285714285714, 1.0599208473740014, 1.0, 1.0749868904037756, 1.1172227231740306, 1.5, 1.0514018691588785, 1.0, 1.2004175365344467, 1.0153581857774714, 1.1281372991805922, 1.1512605042016806, 1.8333333333333333, 1.1069225496915696, 1.0, 1.173913043478261, 1.1127379209370425, 1.2307692307692308, 2.0, 1.0085690938404117, 1.0679770965714686, 3.0, 1.8571428571428572, 1.070539419087137, 1.0031166518254675, 1.0764556962025316, 1.0481916592724045, 1.2670807453416149, 1.0341463414634147, 1.0457925556703747, 3.0, 1.0033544539694372, 1.0132200188857412, 1.0723025583982202, 1.1203129613227045, 2.5, 1.2235436403950817, 1.057915057915058, 1.00503355704698, 1.162534435261708, 1.0, 1.0497121925693353, 1.1136040330430008, 1.109554086840124, 1.0556492411467115, 1.0986301369863014, 1.171875, 1.2403100775193798, 1.0048309178743962, 1.5, 1.0556166510971576, 1.0789473684210527, 1.126530612244898, 1.0576738975455748, 1.4222222222222223, 1.0505012531328322, 1.225, 1.1143410852713178, 1.1079531691562374, 1.0516493055555556, 1.024745269286754, 1.1096774193548387, 1.0499471458773784, 1.2292585740714388, 1.2290102299782841, 1.0787878787878789, 1.1578947368421053, 1.0268039087453913, 1.1609924712344335, 1.3405017921146953, 1.0036673829103187, 1.0440097799511003, 1.5, 1.2407932011331444, 1.0652057225876173, 1.3043478260869565, 1.1485249237029502, 1.0057654563297351, 1.0290957558656149, 1.082116408720253, 1.0766990291262135, 1.0432605472124317, 1.3342379014020804, 1.0020550760378133, 1.107321339330335, 1.0318214200902398, 1.0513320388960075, 1.0606488011283497, 1.0900070249385319, 1.0047846889952152, 1.1857142857142857, 1.2592592592592593, 1.0, 1.4087591240875912, 1.1533158240315167, 1.3372093023255813, 1.2110091743119267, 1.016189290161893, 1.0, 1.0449472596252534, 1.0, 1.2715768463073853, 1.5, 1.0251196172248804, 1.0251691474966171, 1.0417136550135566, 1.0273314972075587, 1.5714285714285714, 1.0053475935828877, 1.087457826984179, 1.0532640658694374, 1.0052083333333333, 1.0594059405940595, 1.086382723455309, 1.0671036407294439, 1.4310344827586208, 1.0069393957871138, 1.0455998511577558, 1.0959752321981424, 1.1086538461538462, 1.0022446689113356, 1.5, 1.1741721854304636, 1.0, 1.2547519131078746, 1.0713319337532075, 1.0931400966183575, 1.1814814814814816, 1.0714285714285714, 2.0, 1.0445062179956108, 1.1538461538461537, 1.0990652007760597, 1.4, 1.0109044259140474, 1.0541082164328657, 1.2857142857142858, 1.007058188371853, 1.0069444444444444, 1.0901926444833625, 1.0171306209850106, 1.0049036777583187, 1.0951296341167918, 1.1129032258064515, 1.0, 1.0209672718544807, 1.089144860398147, 1.0746054519368724, 1.0365265695419767, 1.0902692849066618, 1.012964933862251, 1.1235804943219774, 1.0899105142137406, 1.0260913196186654, 1.0175438596491229, 1.052863436123348, 1.0, 1.0064588824724843, 1.2, 1.2115384615384615, 1.1304347826086956, 1.0754160522435223, 1.0174927113702623, 1.018725608582279, 1.0040943103204856, 1.0561797752808988, 1.4076433121019107, 1.010003282173877, 1.0370879120879122, 1.0714062277833072, 1.0614308662038645, 1.3, 1.027906976744186, 1.0054911531421598, 1.0894126372607593, 1.0958163787211508, 1.1036523303429828, 1.2146263910969792, 1.2074944071588367, 1.0189135381114904, 1.0170552826402823, 1.1121872623918316, 1.0460982678809356, 1.0327102803738317, 1.2, 1.2307692307692308, 1.082236842105263, 1.6666666666666667, 1.0198915009041591, 1.0167828705804696, 1.0382998598785613, 1.4210526315789473, 1.168141592920354, 1.076874205844981, 1.0069276065119501, 1.0692533335800938, 1.12, 1.1116533054490532, 1.0037299331241065, 1.1131105398457584, 2.0, 4.333333333333333, 1.0045287901660556, 1.25, 1.000449658928919, 1.0269413629160062, 1.2272727272727273, 1.1443577636351194, 1.2692307692307692, 1.5, 1.0178993618947954, 2.0, 1.2162162162162162, 1.0462287104622872, 1.113020664445951, 1.1652415068176565, 1.0556745182012848, 1.1515151515151516, 1.0902661245818928, 1.109821150539527, 1.0, 1.0534305496516496, 1.0013366653106295, 3.0, 1.2, 1.0586291298012362, 1.0, 1.074953445065177, 1.4736842105263157, 1.0, 1.3888888888888888, 1.294262295081967, 1.056338028169014, 1.1567164179104477, 1.005792903692976, 1.3733333333333333, 1.3333333333333333, 1.0695219952265214, 2.0, 1.1142857142857143, 1.0069124083638172, 1.213389121338912, 1.0136882129277567, 1.0197740112994351, 1.4, 1.0, 1.3365853658536586, 1.1133333333333333, 1.068522483940043, 1.1260679726221383, 1.2492300110878403, 1.054862842892768, 1.5, 1.0314386332547514, 1.1153846153846154, 1.5769230769230769, 2.0, 1.0931849791376913, 1.4285714285714286, 1.0330396475770924, 1.161904761904762, 1.1603104049507624, 1.0931626854486056, 1.1357702349869452, 1.0834743680733745, 1.1061071762662034, 1.0427927927927927, 1.112927191679049, 1.1045140070318702, 1.1271186440677967, 1.0833333333333333, 1.0060375185279595, 1.045369122420699, 1.0734545454545454, 1.0528846153846154, 1.0465116279069768, 1.1933471933471933, 2.0, 1.125, 1.6022727272727273, 1.130019120458891, 1.3986486486486487, 1.0157068062827226, 1.0991379310344827, 1.2432061487784793, 1.0250110668437362, 1.1400228920259443, 1.20625, 1.0, 1.1260504201680672, 1.0887728459530026, 1.0, 1.1077198507366106, 1.7058823529411764, 1.102091136667357, 1.05537519710602, 1.0572126727334008, 1.1727395411605939, 2.125, 1.3606735469853342, 1.1666666666666667, 1.0285714285714285, 1.0909090909090908, 1.3131564400221116, 1.0096735187424426, 1.1261510952168081, 1.097972972972973, 1.0525578135949545, 4.0, 1.2035630841121496, 1.0089891309061318, 1.2059498317528297, 3.0, 1.123456790123457, 1.2515822784810127, 1.271341463414634, 1.1042502830091592, 1.0302283451297607, 1.04, 1.3987022350396539, 1.003662575491915, 1.0525101453069774, 1.0494078891318548, 1.0989717728731416, 1.0406352171882298, 1.1486486486486487, 1.0357308584686775, 1.1337285572657447, 1.2285714285714286, 1.0451127819548873, 2.0, 1.5, 1.1692406692406692, 1.110236220472441, 1.0352485019386677, 1.1029044929323049, 1.080389144905274, 1.0, 1.1491228070175439, 1.03125, 1.038473408085588, 1.0454545454545454, 1.0, 1.0763811454637608, 1.0, 1.0, 1.0072051573758058, 2.3333333333333335, 1.0299479166666667, 1.0234670704012112, 1.0106100795755968, 1.0909090909090908, 1.0712381821930315, 1.0418445772843723, 1.55, 1.0869919463507882, 1.0072992700729928, 1.0876232201533407, 1.0195549561699258, 1.3626834381551363, 1.0199121522693997, 1.0, 1.1204819277108433, 1.0269563762599858, 1.1091151031270792, 1.0705229793977813, 1.0, 1.0977264393105977, 1.0177576306379998, 1.035366931918656, 1.0, 1.0597662771285477, 1.0472263868065967, 1.0198421479678395, 1.0112256837794353, 1.0041024334310102, 1.0078589824417212, 1.0006968641114982, 1.0780178846597184, 1.5, 1.1066678108641552, 1.1126809097174362, 1.0692704495210021, 1.0636118598382749, 1.072192513368984, 1.0109882394242584, 1.4210526315789473, 1.088134081060413, 1.00812693498452, 1.1088818966322938, 1.1466237942122186, 1.1246458219416413, 1.0637395912187737, 1.0344827586206897, 1.4848484848484849, 1.130635194002634, 1.1361607142857142, 1.0131717875620314, 1.063126596841429, 1.3333333333333333, 1.0338345864661653, 1.4457831325301205, 1.8, 1.1206896551724137, 1.0147678120420742, 1.171641791044776, 1.087378640776699, 1.0, 1.6875, 1.013070396698005, 1.167925396798336, 1.0398000740466493, 1.0081889602579523, 1.110415035238841, 1.0239520958083832, 1.010230179028133, 1.009275865110399, 1.5847953216374269, 1.0122578645591198, 1.0511425462459194, 1.101522842639594, 1.1131376172731038, 1.4615384615384615, 1.0067477250526966, 2.0, 1.1332882273342355, 1.1155115511551155, 1.0515098917138406, 1.1076233183856503, 1.0847784200385358, 1.0939716312056738, 1.0954545454545455, 1.0830874859196482, 2.0, 1.1896551724137931, 1.5, 1.0, 1.1538461538461537, 1.1753246753246753, 1.0379084967320262, 1.0791666666666666, 1.0651826179685417, 1.0080912100036779, 1.0209128800023317, 1.166427615222796, 1.1436880527034246, 1.1339760227413176, 1.0196977777777778, 1.0614406779661016, 1.157773689052438, 1.0497043572042162, 1.0449382716049382, 1.0482315112540193, 1.0946601941747574, 1.3385826771653544, 1.0380921636671778, 1.1527777777777777, 1.0999901854941603, 1.292817679558011, 1.1191722169362512, 1.0375634517766497, 1.0, 1.0313953488372094, 1.2857142857142858, 1.0, 1.6394230769230769, 1.035095867295203, 1.039984911354206, 1.0025773195876289, 1.0923913043478262, 1.0817763157894738, 1.0332852246076132, 1.0927272727272728, 1.2, 3.5, 1.0489745601255183, 1.004201680672269, 1.074751491053678, 1.09941792782305, 1.0, 1.118873826903024, 1.1176470588235294, 1.107430063921919, 1.0635838150289016, 1.015150652161531, 1.0950507249928236, 1.0018293257403665, 1.372340425531915, 2.4, 1.1325755618703177, 1.0, 1.0414691943127963, 1.2008547008547008, 1.3727015558698727, 1.102346140768446, 1.826086956521739, 1.0972972972972972, 1.144927536231884, 1.0323426573426573, 1.0062090748016332, 1.2906752411575562, 1.136482939632546, 1.0504819636291365, 1.011786038077969, 1.0618055555555554, 1.1666666666666667, 1.0674171101105199, 1.1060616853052212, 1.15, 1.008953168044077, 1.1852524866105585, 1.135135135135135, 1.01811025043786, 1.25, 1.0147874306839186, 1.056651939126166, 1.0580808080808082, 1.0685714285714285, 1.0336745456746148, 1.0077519379844961, 1.625, 1.0253988928687723, 1.0419485791610283, 1.0595681625740898, 1.194104007949652, 1.0142100516205792, 1.0681171011008155, 1.3159509202453987, 1.1174216027874564, 1.1059782608695652, 1.0293964632603871, 1.0916189484643415, 1.0397815912636506, 1.0179352580927383, 1.0070637966516491, 1.0575396825396826, 1.039094315035022, 1.1904761904761905, 1.6, 1.0644768856447688, 1.606738309613709, 1.0688473520249222, 2.3333333333333335, 1.0769230769230769, 1.0064205457463884, 1.036807580174927, 1.0178571428571428, 1.0785491644582366, 2.6666666666666665, 1.0519333806726487, 1.5, 1.0702087286527515, 1.0666666666666667, 1.0425929712833397, 1.4333333333333333, 1.207612456747405, 1.0590277777777777, 3.0, 1.6638477801268499, 1.3079136690647482, 1.2, 2.5, 1.1071428571428572, 1.146814404432133, 1.0282527881040893, 1.1854166666666666, 1.1204644412191582, 1.02557856272838, 1.0477386934673367, 1.2236421725239617, 1.1314741035856575, 1.0759075907590758, 1.1935483870967742, 1.0, 1.2326064382139148, 1.1364764267990075, 1.04553264604811, 1.0102489019033676, 1.078060973181442, 1.0342081771112301, 1.0962629997403144, 1.1211819389110225, 1.147295742232451, 1.0265712825753706, 1.5, 1.0, 1.34375, 1.039044289044289, 1.1010479041916168, 1.1400560224089635, 1.116331096196868, 1.042414978983569, 1.01869806881344, 1.0050546200350938, 1.1411764705882352, 1.1904761904761905, 1.227338129496403, 1.0041267008699533, 1.088878069138207, 1.0108460595251365, 1.0052910052910053, 1.070130030196586, 1.0630955993930198, 1.0857995657077966, 1.0543964232488823, 1.069359362025475, 1.015625, 1.0884491114701131, 1.018970189701897, 1.0339609350567331, 1.5, 1.062062062062062, 1.0, 1.0606060606060606, 1.002254958884133, 1.0317460317460319, 1.0877674381611389, 1.0333033303330332, 1.0952380952380953, 1.0568764967499145, 1.0372957577574577, 1.0457417235279252, 1.011014948859166, 1.0143953934740884, 1.197696358669633, 1.1887477313974593, 1.0476190476190477, 1.0, 1.6666666666666667, 1.070727232403879, 1.4285714285714286, 1.056180757762563, 1.1156793332138375, 1.0094426957970746, 1.06006006006006, 1.301625937104469, 1.0875526480867461, 1.039274924471299, 1.0368239355581128, 1.012966807006845, 1.096847286791421, 1.0453373774340848, 1.2268953928723698, 2.2857142857142856, 1.050420168067227, 1.027027027027027, 1.1546027888676735, 1.0026881720430108, 1.3065660032029285, 1.0735524256651017, 2.217857142857143, 1.0499475247017866, 1.0528683914510686, 1.0542859425877464, 1.2941176470588236, 1.0469856285603536, 1.0268551836873334, 1.260459392945037, 1.0523560209424083, 1.5172413793103448, 1.1050228310502284, 1.0302218317592795, 1.039900049654819, 1.2304147465437787, 1.017368329550157, 1.0952380952380953, 1.0464062964062963, 1.0941250789639925, 1.0606060606060606, 1.0103916866506795, 1.0422138836772983, 1.0047846889952152, 1.0716049382716049, 1.0122124329841273, 1.0901960784313725, 1.0091823349365983, 1.079280538492662, 1.0769230769230769, 1.0676532769556026, 1.1684313406092197, 1.0027984884077215, 1.2, 1.0495269894268224, 1.1784274193548387, 1.1162790697674418, 1.0417193426042983, 1.047117911937896, 1.3333333333333333, 1.1115023474178405, 1.2214052936968445, 1.031416969437914, 1.065217391304348, 1.4942388504812254, 1.1214673115255651, 1.0706270627062706, 1.1181434599156117, 1.092118655197321, 1.0500805195490905, 1.1223241590214068, 1.0372093023255815, 1.0319084888621313, 1.0818935128894156, 1.125, 2.0, 1.0386067906427305, 1.1681912148194187, 1.0332193453834881, 1.0193236714975846, 1.244270205066345, 1.020479733166168, 1.1600559962669155, 1.0359080340997158, 1.4642857142857142, 1.0508096035734227, 1.1219512195121952, 1.1436031331592689, 1.59375, 1.0650206067597614, 1.1959798994974875, 1.044077134986226, 1.0851063829787233, 1.1917098445595855, 1.0504495504495504, 1.0686274509803921, 1.0222222222222221, 1.0481550969355848, 1.069672131147541, 1.0474365117393387, 1.1666666666666667, 1.0229613511553206, 1.0, 1.0063239255182106, 1.280701754385965, 1.5, 1.2933908045977012, 1.0472270298743322, 1.0317135760453404, 1.2331288343558282, 1.3225806451612903, 1.0625, 1.024390243902439, 1.0555555555555556, 1.1794871794871795, 1.1873857404021937, 1.028783172395165, 1.0352427673655868, 1.3017241379310345, 1.100330936893758, 1.0466544122244315, 3.0, 1.0856742841658387, 1.0621266427718041, 2.0, 2.25, 1.2011241446725318, 1.109249688112636, 1.061610226602645, 1.2694300518134716, 1.5, 1.082437275985663, 1.708762886597938, 1.24, 1.1065093233480843, 1.1152219873150107, 1.0331117857095096, 1.0702500778250492, 1.5714285714285714, 1.0061653171071587, 1.0319693094629157, 1.0034334763948498, 1.041981528127624, 1.0082159624413145, 1.0, 1.0, 1.1321527280171972, 1.0008741966294863, 1.2182203389830508, 1.0511182108626198, 1.1077194720729646, 1.0701078582434516, 1.0529801324503312, 1.3, 1.032575270948079, 1.716775215631051, 1.0506036949037483, 1.3333333333333333, 1.275, 1.0483091787439613, 1.25, 1.0771586037966931, 1.0574412532637076, 1.0071146829701212, 1.0322878228782288, 1.5, 1.0370822151744328, 1.0235400633770937, 1.1024229074889869, 1.1323769155526573, 1.016327484682104, 1.0581767571329157, 1.1200113519457944, 1.235981308411215, 1.105263157894737, 1.0967234600262123, 1.1132344893631576, 1.222356495468278, 1.1757469244288226, 2.0, 1.0476190476190477, 1.0118606167893414, 1.0633484162895928, 1.0515777363865455, 1.1075667386200931, 1.0112492599171108, 1.6, 1.1101511879049677, 1.0310136784414867, 1.1534776777160376, 1.1661442006269593, 1.1084220043118436, 1.1128608923884515, 1.2923923006416131, 1.0227934044616878, 1.0311717833694063, 1.110456788158523, 1.0833333333333333, 1.0787949015063731, 1.0, 1.1959218351741716, 1.1008397116742217, 1.0150386640732483, 1.0525810114420473, 1.1000513083632633, 1.0443318556048131, 1.2727272727272727, 1.2671232876712328, 1.6666666666666667, 1.3333333333333333, 1.1428571428571428, 1.0318471337579618, 1.0013157894736842, 1.0236678901404885, 1.0118102285594768, 1.0853242320819112, 1.0098297349482184, 1.0730593607305936, 1.1691176470588236, 1.0746934094738814, 1.5, 1.6923076923076923, 1.214950166112957, 1.0, 1.0372460496613995, 1.1339614911921343, 1.0720415537488708, 1.1072684246112239, 2.0, 1.1742976066597295, 1.0391061452513966, 1.0462940162521546, 1.0401293187454859, 1.1144957983193278, 1.1099119568304459, 1.1415546312114684, 1.1634695579649708, 1.0226666666666666, 1.4603174603174602, 1.0809859154929577, 1.3333333333333333, 1.0, 1.0408669330066758, 6.0, 1.8571428571428572, 2.3214285714285716, 1.0207684319833852, 1.0772269273256787, 1.0330672748004561, 1.0564516129032258, 1.0, 1.0133271176680285, 1.0164330594490092, 1.2058823529411764, 1.2196531791907514]
origin-bjaq_15.71 	max: 6.0000	99th: 2.6700	95th: 1.6930	median: 1.0815	mean: 1.1822

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.163575 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.241820