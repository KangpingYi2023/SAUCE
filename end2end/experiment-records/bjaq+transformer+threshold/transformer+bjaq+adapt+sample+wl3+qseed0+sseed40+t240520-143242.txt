Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 40, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.6675	95th: 1.6673	median: 1.0821	mean: 1.1753
ReportEsts: [1.0507936507936508, 1.01640625, 1.017027617435586, 1.090146750524109, 1.5, 1.0, 1.0754352030947776, 1.0386896606178269, 1.0, 1.015645371577575, 1.1325426370011253, 1.0432494114038806, 1.064371926687528, 1.1069767441860465, 1.0815966089720948, 1.0, 1.0, 1.0219624512929508, 3.0, 2.0, 1.08, 1.1277848039692577, 1.0801026957637998, 1.1056958308866707, 1.1065614208189443, 1.0, 1.1600811270870306, 2.0, 1.2, 1.0503597122302157, 1.0, 1.0488829169216578, 1.0148676246247723, 1.1692563817980022, 1.012924071082391, 1.2432455180540358, 1.1657754010695187, 1.0104026104664001, 1.1556581031751498, 1.0714285714285714, 1.0249671484888305, 1.0186335403726707, 1.0, 1.0422702859631297, 1.154174826419797, 1.8333333333333333, 1.0404040404040404, 1.1342756183745584, 1.0375848749745884, 1.1388888888888888, 1.0870026316823127, 1.1855670103092784, 1.0376657533494023, 2.0, 1.374025974025974, 1.2991216655823032, 1.3613861386138615, 1.3526570048309179, 1.0062111801242235, 1.25, 1.1060069065794256, 1.0902864259028642, 1.1363636363636365, 1.0116279069767442, 1.0909090909090908, 1.0120503030090728, 1.291508238276299, 1.75, 1.0, 1.0299244896056678, 1.0244498777506112, 1.0639906922629436, 1.023041474654378, 1.0890955591722855, 1.0729411764705883, 1.0526315789473684, 1.0, 1.113152400835073, 2.6666666666666665, 1.0340755832305089, 1.0, 1.026876707924771, 1.2024539877300613, 1.0818858560794045, 1.1133464180569186, 1.0, 1.0830604657230447, 1.007583072321786, 1.0588235294117647, 1.75, 1.1495901639344261, 1.079677197357818, 1.0404984423676011, 1.0185714285714285, 1.0148285449490269, 1.0311688311688312, 1.0, 1.1490196078431372, 1.0, 1.2386162687886826, 1.0719942404607632, 1.020583190394511, 1.2419036767605942, 1.2592592592592593, 1.0143636894979464, 1.0722059994690736, 1.1930365799911855, 1.1213500189609404, 1.0429184549356223, 1.1666666666666667, 1.6666666666666667, 1.0542056074766355, 1.0649186679945362, 1.053063802905875, 1.2597402597402598, 1.0593693189323838, 1.0, 1.1258278145695364, 1.1483516483516483, 1.0, 1.0282485875706215, 1.1666666666666667, 1.2355889724310778, 1.0224861782693744, 1.0608060883746213, 1.0467289719626167, 1.8, 1.2069536423841059, 1.0, 1.12, 1.0941714122133503, 1.1818181818181819, 1.0885416666666667, 1.0343409095191143, 1.0766960408146056, 1.006675567423231, 1.0735294117647058, 1.0596258768511302, 1.039972432804962, 1.0706886045094455, 1.0434930199007086, 1.173913043478261, 1.0026160889470241, 1.0801864404716992, 2.0, 1.0177757520510484, 1.0205714285714285, 1.0951086956521738, 1.1014646197282514, 1.5, 1.1820053281666263, 1.0384615384615385, 1.0330578512396693, 1.1074561403508771, 1.2554744525547445, 1.025118004045853, 1.119466271312083, 1.1914687869345655, 1.0669371196754565, 1.082236842105263, 1.2653061224489797, 1.422680412371134, 1.0294550810014726, 1.4285714285714286, 1.0762588125310215, 1.019130912168602, 1.0883458646616542, 1.3124355730484492, 1.1495786516853932, 1.1239564284010495, 1.2273684210526317, 1.1306413301662708, 1.0570349569090733, 1.031344792719919, 1.0311387900355873, 1.098153547133139, 1.041640378548896, 1.1113885898815932, 1.0515373122591807, 1.0, 1.0793650793650793, 1.0609372660577931, 1.0285087719298245, 1.1511925042589437, 1.1578947368421053, 1.1057159649364128, 1.2239092831059004, 1.129601973897799, 1.1153846153846154, 1.1863636363636363, 1.0224887732010741, 1.0, 1.2727272727272727, 1.0065393988627132, 1.031615925058548, 1.0173545966228894, 1.4, 1.0739549839228295, 1.0630571841103296, 1.0753534603685726, 1.0626410835214446, 1.037314219458206, 1.2429378531073447, 1.0491803278688525, 1.1666666666666667, 1.0, 1.322314049586777, 1.2231509225674184, 1.3693379790940767, 1.264367816091954, 1.0143351458230352, 1.0031277926720286, 1.0114366909840753, 1.04697036954833, 1.0803396014594442, 1.1193181818181819, 1.0520231213872833, 1.0077770576798444, 1.0356137629961515, 1.0011360115666632, 1.0, 1.043064182194617, 1.1284147086049672, 1.0016067564262516, 1.152521525215252, 1.0323135456298536, 1.279714223857978, 1.0357142857142858, 1.005879922537923, 1.314337287261475, 1.0016920473773265, 1.170731707317073, 1.042153047989624, 1.0027079303675048, 1.1448818897637796, 2.0, 1.2136507026096932, 1.0438811969629298, 1.244491326769808, 1.0938775510204082, 1.0, 1.6666666666666667, 1.0665306624927455, 1.1090909090909091, 1.098798068450178, 1.5, 1.0, 1.0, 1.015222482435597, 1.0103092783505154, 1.011049723756906, 1.169831223628692, 1.0488215488215489, 1.0062972292191437, 1.0368362981746384, 1.0, 2.0, 1.105638146937265, 1.0139140114094893, 1.1138353765323994, 1.0261304011539185, 1.1204894706886739, 1.002263333989372, 1.0763116057233704, 1.0720032392655316, 1.0263157894736843, 1.0095411814227586, 1.0242767295597484, 1.0909090909090908, 1.01163991927734, 1.1695760598503742, 1.1818181818181819, 1.3157894736842106, 1.0346124905944318, 1.0555555555555556, 1.1452991452991452, 1.0980418545185384, 1.0167130919220055, 1.3984962406015038, 1.0112503090744251, 1.0453020134228188, 1.01984, 1.066531984245552, 1.25, 1.0324481629683522, 2.5, 1.0381876001997425, 1.0323974082073435, 1.0419279959947203, 1.0810810810810811, 1.6666666666666667, 1.4782608695652173, 1.0923076923076922, 1.081336977804644, 1.0, 1.0030674846625767, 1.009049773755656, 1.0088141025641026, 1.0184848520050183, 1.0384615384615385, 1.1383647798742138, 1.0113826775293233, 1.1725716560509554, 1.092251244867651, 1.1623931623931625, 1.0, 1.1431980906921242, 1.2929936305732483, 1.1107266435986158, 1.0692502106149957, 1.0195996663886573, 1.0725075528700907, 1.3111111111111111, 1.0164609053497942, 1.0257997936016512, 1.2857142857142858, 1.0073695118709622, 1.0439770554493308, 1.1176470588235294, 1.1159013791593695, 1.2857142857142858, 1.4, 1.0073120733743317, 2.0, 1.1755829903978052, 1.0436046511627908, 1.0607054963084495, 1.1132631578947367, 1.0668523676880224, 1.0963855421686748, 1.106292022348787, 1.0821385393085206, 1.0485714285714285, 1.0124779995350845, 1.0633229767717118, 2.0, 1.0, 1.0296053383304007, 1.25, 1.07035175879397, 1.3529411764705883, 1.0, 1.4666666666666666, 1.3182730923694779, 1.0629107981220658, 1.0155038759689923, 1.0411255411255411, 1.0, 1.103861517976032, 1.0822972567581082, 2.0, 1.2453841572364504, 1.0, 1.095771654141046, 1.141025641025641, 1.0038721913442035, 1.1566820276497696, 1.1363636363636365, 1.313199105145414, 1.2777777777777777, 1.043928261627088, 1.0198660605171823, 1.0547752808988764, 1.0, 1.1666666666666667, 1.5714285714285714, 1.5, 1.3333333333333333, 1.0693273708685125, 1.3333333333333333, 1.0915141430948418, 1.216867469879518, 1.2298606999283244, 1.098825498966753, 1.2451081359423275, 1.0248305905130688, 1.0110208816705337, 1.025, 1.5, 1.1085450346420322, 1.0723404255319149, 1.0676668035013082, 1.2380952380952381, 1.5714285714285714, 1.0204545454545455, 1.0293237582286057, 1.039779595241293, 1.0024570024570025, 1.1464387464387464, 1.013406292749658, 1.095890410958904, 1.0907770515613653, 1.0572033898305084, 1.0961538461538463, 1.0254957507082152, 1.0884955752212389, 1.0635133853788046, 1.0518338977417931, 1.011563425812605, 1.011764705882353, 1.11, 1.088145896656535, 1.0, 1.0761767050906093, 1.04708595950114, 1.0366951034240972, 1.0586669518614904, 1.0408041401273886, 1.1474420082618366, 1.8333333333333333, 1.4945926459985581, 1.2, 1.1861656703672074, 1.25, 1.0388527051280605, 1.0333333333333334, 1.1185511607910577, 1.1620553359683794, 1.044425817267393, 3.0, 1.1267326732673266, 1.0120063714793432, 1.164727791061247, 2.0, 1.1111111111111112, 1.2255278310940498, 1.256317689530686, 1.0880454637710575, 1.4054054054054055, 1.1666666666666667, 1.1199309749784296, 1.0087466993587326, 1.0383303619874429, 1.1108210888543468, 1.113377192982456, 1.1492537313432836, 1.0193050193050193, 2.5, 1.1098591549295775, 1.5, 1.2288348700754401, 1.064516129032258, 1.1521410456496293, 1.6666666666666667, 1.0781105094683938, 1.1224458230937118, 1.0832819247378163, 1.0, 1.14, 1.08, 1.2823212414550171, 1.2319474835886215, 1.0, 1.0111763062307908, 1.1124221695185454, 1.0770824699544137, 1.5, 2.0, 1.0189948555599526, 1.0154686078252957, 1.042622950819672, 1.2222222222222223, 1.0799123759995726, 1.06006006006006, 1.4705882352941178, 1.0343502824858757, 1.0454545454545454, 1.1076115485564304, 1.0064935064935066, 1.28270929743374, 1.095798213611775, 1.0, 1.0724637681159421, 1.0765521504901527, 1.0222577024613098, 1.0349016239343944, 1.0, 1.1136916611369165, 1.00269234683994, 1.0225248821372446, 2.0, 1.0378787878787878, 1.0037805396720383, 1.008461492785464, 1.0231532043161067, 1.006939761990245, 1.0231698649609098, 1.0109243697478991, 1.1805689488910318, 2.0, 1.060003100935449, 1.6818181818181819, 1.25, 1.1917098445595855, 1.1153846153846154, 1.0003835698680854, 1.1584645669291338, 1.040952271728119, 1.0435979807251032, 1.0502408728097106, 1.0848099553631814, 1.0489672549903488, 1.2409638554216869, 4.0, 1.003614022406939, 1.2172064777327936, 1.0470263860065223, 1.0371423638752746, 1.115423642820903, 1.1998462720983858, 2.348314606741573, 2.4285714285714284, 1.0037615036275989, 1.0645995119940281, 1.02551368564713, 1.1305153874675566, 1.0404936367142306, 1.0020661157024793, 1.071638545064802, 1.0005396654074474, 1.2095531587057011, 3.0, 1.0833333333333333, 1.044478527607362, 1.0803059273422562, 1.1037037037037036, 1.060529634300126, 1.0392156862745099, 1.24375, 1.148905109489051, 1.1375, 1.0747175588954743, 1.2555555555555555, 1.0147821936159402, 2.0, 1.1127098321342925, 1.0862068965517242, 1.6785714285714286, 1.1307262569832401, 1.0099447513812154, 1.1, 1.2814526588845656, 1.0964953392699057, 1.0, 1.3829787234042554, 1.5, 1.5, 1.1477272727272727, 1.0504032258064515, 1.035143769968051, 1.1019417475728155, 1.0660044857417494, 1.091647331786543, 1.0651705893085204, 1.183983189353257, 1.0402476780185759, 1.1052924850783854, 1.0432432432432432, 1.0655737704918034, 1.000484027105518, 1.1075150850246847, 1.2745664739884393, 1.1533914125700062, 1.049004206152131, 1.1890332943925233, 1.0820635688741487, 2.0, 1.0687960687960687, 1.0776892430278884, 1.4074074074074074, 1.0, 1.0408163265306123, 1.25, 1.1345381526104417, 1.3703703703703705, 1.1666666666666667, 1.0119102282156005, 1.1110672326981934, 1.0330647455961095, 1.0336245904197223, 1.2648648648648648, 1.1182065217391304, 1.0, 1.193798449612403, 1.0134492033933375, 1.0800462188222169, 1.0838158568663026, 1.088791434104112, 1.0141064693936757, 1.096103896103896, 1.0791504239842462, 1.0870337477797514, 1.014541336861224, 1.1034846288521998, 1.303030303030303, 1.0646186440677967, 1.0, 1.2387640449438202, 1.2082391617012533, 3.0, 1.1002691790040378, 1.0593878064974016, 1.4285714285714286, 1.0059428902739527, 1.2, 1.1176470588235294, 1.0366193874254839, 1.6153846153846154, 1.0271745041876654, 1.0311832550192226, 1.3571428571428572, 1.16, 1.1546391752577319, 1.0363462458153994, 1.066887417218543, 1.0487473541212524, 1.1543628249843885, 1.0, 1.0033130567021509, 1.1097560975609757, 2.0, 1.017390502110386, 1.093139544943334, 1.118259224219489, 1.0119838262918273, 1.0712936237208082, 1.0865384615384615, 1.8571428571428572, 1.1009212730318259, 1.0225806451612902, 1.1115673731186262, 1.2507300792657488, 1.0021209274446858, 1.0739770685019296, 1.1007326007326008, 1.111202976436544, 1.2240802675585285, 1.0452288189800547, 1.0876971608832808, 1.034676663542643, 1.03873431533006, 1.026333309342162, 3.0, 1.1387968353485596, 1.0102936450550333, 1.0430556468757535, 1.7272727272727273, 1.2732953756422718, 1.3618090452261307, 1.1428571428571428, 1.0772377795020103, 1.0420575865415722, 1.1200873362445414, 1.0588235294117647, 1.3333333333333333, 1.0371044892463595, 1.5, 1.0771028037383177, 1.0, 1.07853604075082, 1.44, 1.2109704641350212, 1.0607966457023061, 1.0, 1.5714285714285714, 1.187111801242236, 1.25, 2.0, 1.1367521367521367, 1.2275862068965517, 1.0492825951341236, 1.1794554455445545, 1.1531531531531531, 1.2418879056047198, 1.1014466214978942, 1.0597402597402596, 1.1290322580645162, 1.2979591836734694, 1.0833333333333333, 1.0, 1.1032186459489457, 1.1832611832611832, 1.0268595041322315, 1.0468546637744034, 1.0723319836536476, 1.0926838085769803, 1.0780615421100999, 1.2366975130133024, 1.2329376854599408, 1.0143198090692125, 1.5714285714285714, 1.0, 1.2142857142857142, 1.018987629961296, 1.0979699911738747, 1.107843137254902, 1.1215469613259668, 1.0106911034746087, 1.003005662453372, 1.0067582291107189, 1.0985915492957747, 1.2222222222222223, 1.028941355674029, 1.0233315246880086, 1.0679714836979626, 1.0183190367305939, 1.006578947368421, 1.087640283520378, 1.0295453511472377, 1.162202380952381, 1.3273930753564154, 1.125, 1.0911330049261083, 1.8734177215189873, 1.1304347826086956, 1.180064308681672, 1.0701001430615165, 1.0, 1.1376623376623376, 1.0381799865681665, 1.08, 1.0566713634084015, 1.019438444924406, 1.3870967741935485, 1.0290287015834938, 1.033489545782264, 1.0705748052645716, 1.041030534351145, 1.0442678774120318, 1.1994051642557795, 1.1764705882352942, 1.3571428571428572, 1.0, 1.4285714285714286, 1.0620079932178756, 1.3333333333333333, 1.1283677507737582, 1.0840019385062731, 1.0134710372698699, 1.0613704071499503, 1.0490961727866928, 1.0414790996784566, 1.039426523297491, 1.0319001386962552, 1.0193861976659544, 1.089379452568429, 1.0435080558431749, 1.2423220522702638, 1.4285714285714286, 1.0158730158730158, 1.0158102766798418, 1.1339561163298555, 1.0390879478827362, 1.2818918918918918, 1.0272727272727273, 2.220779220779221, 1.0530060613519585, 1.0496644295302013, 1.052846889952153, 1.125, 1.0488315722589603, 1.028842469194676, 1.2678660669665167, 1.0581052631578947, 1.2307692307692308, 1.0637813211845102, 1.1754385964912282, 1.5625, 1.0731044970671302, 1.6538461538461537, 1.1402298850574712, 1.0705882352941176, 1.040701754385965, 1.0399229556995273, 1.0059171597633136, 2.75, 1.0821256038647342, 1.0895069671679105, 1.072015111950664, 1.0134292954133695, 1.0359431266800792, 1.0810361594907612, 1.0, 1.088487972508591, 1.1469863320636344, 1.001901013128173, 1.0150300601202404, 1.0138888888888888, 1.05318138651472, 1.0591009050156475, 1.3633663366336635, 1.0643849353736443, 1.0, 1.3333333333333333, 1.0593685876041434, 1.0083016744055158, 1.230260360062373, 1.101584653878232, 1.0558659217877095, 1.094890510948905, 1.0992400272052518, 1.0961875475316603, 1.1286764705882353, 1.0335195530726258, 1.0453879941434847, 1.0970402002650568, 1.0952380952380953, 1.75, 1.045225641912337, 1.1702961954760516, 1.002858776443682, 1.0113636363636365, 1.213975380159305, 1.0081632653061225, 1.1757098678661793, 1.4388489208633093, 1.1923076923076923, 1.0552560646900269, 1.0698198198198199, 1.134375, 1.4827586206896552, 1.0812828248966364, 1.191278493557978, 1.1625207296849087, 1.024390243902439, 1.044972748854783, 1.0672301190933537, 1.0613453815261045, 1.2843137254901962, 1.3333333333333333, 1.1666666666666667, 2.0, 1.1504702194357366, 1.3076923076923077, 1.0, 1.1538461538461537, 1.1112582781456954, 1.1014492753623188, 1.0614743613172033, 1.039963564094071, 1.1945454545454546, 1.3877551020408163, 1.1428571428571428, 1.0333333333333334, 1.054054054054054, 1.1142857142857143, 1.1588447653429603, 1.028464234818962, 1.0335163815813884, 1.3333333333333333, 1.0904508866594174, 1.046854511786197, 2.5, 1.0688220883944064, 1.2195121951219512, 3.0, 2.0, 1.2307692307692308, 1.138133830595998, 1.099404255319149, 1.2701863354037266, 1.0, 1.0271317829457365, 1.3374233128834356, 3.0, 1.5, 1.1140350877192982, 1.2306761661513643, 1.0084425403225807, 1.6666666666666667, 1.032544156332206, 1.0418280402788536, 1.0123076923076924, 1.0, 1.0375586854460095, 1.0247276309489775, 1.2894736842105263, 1.1588549858446051, 1.0239092876859226, 1.261127596439169, 1.1484375, 1.052433208181726, 1.0772769089236431, 1.0826446280991735, 1.078125, 1.0370099989336659, 1.3242630385487528, 1.0489469034777756, 1.2754491017964071, 1.1470588235294117, 1.328358208955224, 1.113888888888889, 1.045945112550108, 1.0007891477204618, 1.087978539950182, 1.0687772925764192, 1.5, 1.6666666666666667, 1.154030556798568, 1.200527704485488, 1.1524995137132854, 1.0132300781777346, 1.1103863522328148, 1.0846255361266908, 1.119289340101523, 1.0212765957446808, 1.1076173256819433, 1.0976043229027552, 1.254249815225425, 1.0160142348754448, 1.6666666666666667, 1.0416666666666667, 1.126777447089947, 1.1994840928632846, 1.0433247074524357, 1.0906537480351484, 1.0099431818181819, 2.0, 1.0713391739674594, 1.003528931726199, 1.1804889193511539, 1.0722433460076046, 1.0755137557812426, 1.0127388535031847, 1.1975717439293598, 1.0023242300987798, 1.0313145279232396, 1.077615960939473, 1.012672811059908, 1.0539811066126856, 1.0, 1.1797197863118638, 1.0549181826492366, 1.007989347536618, 1.0482307402459494, 1.1099444101297098, 1.0264750378214826, 1.2, 1.2493368700265253, 1.6666666666666667, 2.0, 1.1764705882352942, 1.0153452685421995, 1.0363349131121642, 1.0398100239400725, 1.0065695441786777, 1.0727272727272728, 1.0092905405405406, 1.1304347826086956, 1.5918367346938775, 1.0690250215703192, 1.6, 1.4166666666666667, 1.0250406504065042, 1.1428571428571428, 1.0459610027855153, 1.142641888498242, 1.0090130689499774, 1.0926863709402541, 2.0, 1.0185758513931888, 1.176356589147287, 1.0884907709011944, 1.0405148765562355, 1.1477272727272727, 1.1273972602739726, 1.1394306507799152, 1.1034851273526094, 1.0015923566878981, 1.126984126984127, 1.0768156424581006, 1.0, 1.0, 1.0416919995708307, 5.0, 1.4285714285714286, 1.588235294117647, 1.0520304568527918, 1.0217391304347827, 1.0753880266075388, 1.1023930953315026, 1.1666666666666667, 1.1036623215394166, 1.0216121495327102, 1.1435897435897435, 1.3028846153846154, 1.4285714285714286, 1.0425164189422744, 1.2649667405764966, 1.122004357298475, 1.043056633048875, 1.0208475633296707, 1.0988675529295913, 1.1520260278024252, 1.0, 1.2237593603249144, 1.0637148666160239, 1.0147406733393995, 1.1774193548387097, 1.0855548020241015]
origin-bjaq_15.71 	max: 5.0000	99th: 2.6675	95th: 1.6673	median: 1.0821	mean: 1.1753

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 14.000591 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[2.9802322e-07 1.2516975e-06 5.3644180e-07 2.0265579e-06 2.9802322e-07]
Distance score: 8.82148754044465e-07
SAUCE Drift detection: False
Detection latency: 0.0233s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.034841 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 7.0000	99th: 3.0000	95th: 1.7500	median: 1.0830	mean: 1.1871
ReportEsts: [1.077319587628866, 1.0167245873153778, 1.0247515514864776, 1.0541455160744502, 1.5, 2.0, 1.0396346870012414, 1.0534188118073358, 1.2, 1.0457018498367792, 1.0921799807507218, 1.042864602704114, 1.111626110467362, 1.1337209302325582, 1.0838445807770962, 1.1612903225806452, 1.182108626198083, 1.0789473684210527, 1.3333333333333333, 1.005008347245409, 1.0861260053619304, 1.0826827927432656, 1.1203974284044418, 1.0239111870196413, 1.0188839230511049, 1.0277056027653753, 3.0, 1.1645673354174888, 1.75, 1.6, 1.0063532401524777, 1.0, 1.0487657103169032, 1.0055740445410772, 1.0590405904059041, 1.0613873542050338, 1.2276788806538754, 1.1859956236323852, 1.0571428571428572, 1.0786610878661087, 1.065562524500196, 1.009434474765949, 1.0813186813186813, 1.0802715654952078, 1.0111940298507462, 1.0513802404182344, 1.12, 1.11864406779661, 1.0206611570247934, 1.0107454667562121, 1.3333333333333333, 1.2378854625550662, 1.0411522633744856, 1.0294117647058822, 1.0302095874591513, 1.0105898899644246, 1.1623556206279486, 1.1917098445595855, 1.0869565217391304, 1.0498887916575512, 1.1688311688311688, 1.1327249535582513, 1.0781010719754978, 1.1395348837209303, 1.0091743119266054, 2.0, 1.0885816853508, 1.277922077922078, 1.6, 1.0, 1.0704007426891538, 1.0203045685279188, 1.0492991783470276, 1.0135396518375241, 1.1504171437919188, 1.1145833333333333, 1.0864407023396943, 1.4183006535947713, 1.5242718446601942, 1.082795453508011, 1.060200668896321, 1.087378640776699, 3.0, 1.25, 1.073903002309469, 1.3898305084745763, 1.0029411764705882, 1.0350877192982457, 1.0, 1.1086371499967964, 1.1154831901100557, 1.2553522771506422, 1.0335830468469394, 1.056449362968474, 1.005390835579515, 1.0175233644859814, 1.2278481012658229, 1.0299625468164795, 1.12, 1.2974036191974823, 1.2692307692307692, 2.0, 1.0745483980913428, 1.1658075601374571, 1.1070911722141823, 1.220806260544926, 1.2333333333333334, 1.0186444895553664, 1.0542275343072156, 1.2590791738382099, 1.0386292834890967, 1.0442297915607524, 1.5, 2.25, 1.100828729281768, 1.0508432828468297, 1.050820539968237, 1.0421052631578946, 1.0573738748168307, 1.0, 1.0176807072282892, 1.1951896392229417, 1.0, 1.018348623853211, 1.0, 1.2668067226890756, 1.0267094143023845, 1.068263781555899, 1.1322314049586777, 2.0, 1.0787671232876712, 1.0, 1.4615384615384615, 1.1104910714285714, 1.0769230769230769, 1.0638129211256442, 1.024526463657785, 1.0797561147529429, 1.0, 1.4285714285714286, 1.1045751633986929, 1.0468890892696123, 1.0814966683751923, 1.0140543885584625, 1.232258064516129, 1.004950495049505, 1.1058384538946686, 3.0, 1.0159090909090909, 1.0, 1.1005649717514123, 1.11690036900369, 2.0, 1.3090098307489613, 1.0521628498727735, 1.0481099656357389, 1.1231155778894473, 1.0, 1.0331801939765186, 1.0748693998411132, 1.1577346025122788, 1.0168067226890756, 1.0863509749303621, 1.15625, 1.3583333333333334, 1.0475594493116396, 2.0, 1.0766897659937733, 1.5714285714285714, 1.0094117647058825, 1.0385332188404415, 1.1154336734693877, 1.0053635030379215, 1.249554367201426, 1.0384615384615385, 1.059914523022337, 1.1381381381381381, 1.057057057057057, 1.091497975708502, 1.0346715328467153, 1.2813186813186814, 1.2008547008547008, 1.1358024691358024, 1.099236641221374, 1.007956497651227, 1.136283350376499, 1.2943262411347518, 1.1006976693954251, 1.0802005012531328, 4.0, 1.3, 1.0848458904109588, 1.4761904761904763, 1.1295647823911956, 1.2032731722239216, 1.0212744954109862, 1.008012083961671, 1.0693756194251733, 1.0516267396051067, 1.087818968743702, 1.0016207455429498, 1.0570789830427854, 1.0459580485505537, 1.0391237521541352, 1.0662905500705218, 1.092207334273625, 1.083720930232558, 1.0704225352112675, 1.223529411764706, 1.0, 1.4772727272727273, 1.131824759900013, 1.3125, 1.2641509433962264, 1.0284162139573756, 1.4482758620689655, 1.043432016874059, 1.0348027842227379, 1.2326339214751232, 1.5, 1.0119760479041917, 1.0070518036343912, 1.0469497035762096, 1.0141392033624188, 3.5, 1.0, 1.0954337824784295, 1.0162038751910993, 1.0266666666666666, 1.0693739424703892, 1.107795371498173, 1.0879947011094553, 1.3916666666666666, 1.0048130781014302, 1.0989136298984747, 1.0716417910447762, 1.075436982520699, 1.0625, 2.0, 1.1874180865006554, 2.0, 1.1414547077197679, 1.0719209986957332, 1.1474421318809571, 1.0931034482758621, 1.0, 2.0, 1.0681628162816281, 1.088235294117647, 1.0801326412918109, 1.4, 1.1955307262569832, 1.001, 1.2857142857142858, 1.017218947266974, 1.0431654676258992, 1.1396598030438676, 1.0, 1.0097765363128492, 1.1480555107309989, 1.0, 2.0, 1.112427352329433, 1.0915840039927631, 1.1127379209370425, 1.0358971585172365, 1.1087678004001413, 1.0578385725440296, 1.0785854616895874, 1.0839844897479585, 1.0330495743615422, 1.026904761904762, 1.0384574524593646, 1.0769230769230769, 1.0007016629411705, 1.251111111111111, 1.1428571428571428, 1.2083333333333333, 1.0958837772397094, 1.1469957081545064, 1.0517036021078467, 1.0139739528335092, 1.0650224215246638, 1.3888888888888888, 1.0207712194300544, 1.0241992882562279, 1.2031331592689296, 1.0535762546013698, 1.1, 1.1428571428571428, 1.0784434836318715, 1.0744263604124098, 1.1131029325356552, 1.0710816979946995, 1.1829204006325778, 1.137308533916849, 1.0167828189446735, 1.0516913462844721, 1.1069992245126152, 1.0333459952246582, 1.0199637023593466, 1.0740740740740742, 1.0625, 1.0871918220084185, 1.375, 1.0366300366300367, 1.030814466590355, 1.0157201646090535, 1.2619047619047619, 1.024793388429752, 1.1726190476190477, 1.0955098934550989, 1.021532678113616, 1.0416666666666667, 1.2514272398928115, 1.0156947314823135, 1.0023041474654377, 1.1666666666666667, 1.4, 1.035930735930736, 1.25, 1.0108211658268806, 1.0410742496050553, 1.0, 1.092381093360358, 1.4583333333333333, 1.3333333333333333, 1.012195164872294, 2.0, 1.0509337860780985, 1.0465686274509804, 1.0304426479733169, 1.0241496598639457, 1.0021739130434784, 1.1818181818181819, 1.0999211267605633, 1.084259184169978, 1.2365591397849462, 1.0052226667856237, 1.0136488782145159, 3.0, 1.1, 1.0378807342068455, 1.5, 1.075955265610438, 1.4210526315789473, 1.0, 1.5555555555555556, 1.3474646716541978, 1.0577223088923557, 1.094890510948905, 1.2208835341365463, 1.2048192771084338, 1.2857142857142858, 1.0396127447849015, 1.2790697674418605, 1.2307692307692308, 1.0151050905767887, 1.0756972111553784, 1.059090909090909, 1.0226201696512724, 1.75, 1.5, 1.2884615384615385, 1.127388535031847, 1.0715811965811965, 1.1255791471652736, 1.240834464880879, 1.0251256281407035, 1.0, 1.0264712730659526, 1.0743801652892562, 1.3142857142857143, 2.0, 1.1867283950617284, 1.2857142857142858, 1.0632911392405062, 1.2277227722772277, 1.136334204657186, 1.0818380362934532, 1.0305429864253393, 1.1552212775234358, 1.126956048441965, 1.0242557883131203, 1.0835777126099706, 1.1529782109874271, 1.1338983050847458, 1.0263157894736843, 1.0145639669928115, 1.0650860681349064, 1.0577264653641207, 1.0343137254901962, 1.024390243902439, 1.2012987012987013, 2.0, 1.0909090909090908, 1.9452054794520548, 1.1844660194174756, 1.375886524822695, 1.036764705882353, 1.0678148546824542, 1.0908675799086758, 1.002126528442318, 1.101071975497703, 1.2762345679012346, 1.074468085106383, 1.2857142857142858, 1.0897435897435896, 1.0, 1.2172213495049866, 1.75, 1.1078116133913372, 1.023198629045114, 1.0619634509137272, 1.1249675913922739, 2.2857142857142856, 1.2388582874311467, 1.5, 1.0545938748335553, 1.0909090909090908, 1.007307282192812, 1.0037220843672456, 1.1371351594072743, 1.038709677419355, 1.0963070238957278, 3.0, 1.195824757424287, 1.0125366184390632, 1.1439742410303588, 3.0, 1.027027027027027, 1.232114467408585, 1.2455621301775148, 1.1112452986439392, 1.0886835510095967, 1.1304347826086956, 1.2670986321094313, 1.0009010773751223, 1.026542864003842, 1.011944180353845, 1.035314012047003, 1.4142538975501113, 1.2, 1.062178588125292, 1.0608625191320789, 1.152542372881356, 1.171281390856407, 1.0, 1.5, 1.188034188034188, 1.0884615384615384, 1.0351617440225036, 1.0838, 1.0927254098360655, 1.0, 1.1735537190082646, 1.1290322580645162, 1.0832337552742617, 1.0434782608695652, 1.0, 1.0900183191973454, 1.0, 1.0, 1.024530471444998, 1.5, 1.013337670787248, 1.0249433106575965, 1.0383561643835617, 1.0909090909090908, 1.0815883402736466, 1.04837364470392, 1.35, 1.0157666163141994, 1.0147058823529411, 1.1780973451327434, 1.0039370078740157, 1.326984126984127, 1.0180725834025302, 1.0, 1.0731707317073171, 1.151314753582113, 1.1293658867412681, 1.0604133545310015, 1.0, 1.1316857248247878, 1.012791788743992, 1.0129813933362182, 1.0, 1.0366178428761652, 1.027662084892246, 1.0666979557780558, 1.001714765223102, 1.0065712744554918, 1.0040100350204049, 1.0056777856635912, 1.0607567624460583, 2.0, 1.0487752099021899, 1.2105263157894737, 1.046376811594203, 1.0911086717892426, 1.0501392757660166, 1.0174682946807254, 1.2685185185185186, 1.0341751566460995, 1.04633497911128, 1.0810337851507181, 1.1778149386845038, 1.1247115456192154, 1.0354321823516137, 1.035294117647059, 1.1649484536082475, 1.0870094233803762, 1.0511727078891258, 1.0123512899345006, 1.0717111671202064, 1.0, 1.0295880149812735, 1.1400560224089635, 1.0, 1.150943396226415, 1.0061623470879941, 1.1195652173913044, 1.09288858003243, 1.0, 1.3384615384615384, 1.0009066183136899, 1.1365303627224561, 1.0298923134051243, 1.0054192885578528, 1.1078625049387594, 1.1496746203904555, 1.0122324159021407, 1.0504983593425046, 1.5977011494252873, 1.0244415794215416, 1.2080200501253133, 1.140625, 1.0135951822073053, 1.4190476190476191, 1.010152943314897, 2.0, 1.3571428571428572, 1.0302013422818792, 1.059784229633972, 1.0798226164079823, 1.020637898686679, 1.0298013245033113, 1.1627906976744187, 1.086494280702887, 1.0, 1.396551724137931, 1.5, 1.0, 1.2524271844660195, 1.4335664335664335, 1.0080106809078773, 1.0311284046692606, 1.062909042340056, 1.0147504546373005, 1.0614479390979952, 1.1805339805825243, 1.0668675977917237, 1.0663763010663563, 1.0075979054073698, 1.0972972972972972, 1.037297462549679, 1.0557631593872292, 1.0348432055749128, 1.0462365591397849, 1.103030303030303, 1.540983606557377, 1.057238379118666, 1.159117305458769, 1.106638725238227, 1.3275862068965518, 1.124791617051679, 1.1364480198019802, 2.0, 1.0193236714975846, 1.25, 3.0, 1.3372549019607842, 1.0280583009652733, 1.0459028831562973, 1.017766497461929, 1.1453488372093024, 1.0517592509574372, 1.087312113174182, 1.108499095840868, 1.4, 2.3333333333333335, 1.1441815076848012, 1.079646017699115, 1.0726615816940988, 1.0930448941614328, 2.0, 1.4382022471910112, 1.1694915254237288, 1.1271582261873525, 1.103397341211226, 1.0096803073824, 1.1623616236162362, 1.0180359778959331, 1.2857142857142858, 1.5, 1.1714590557481994, 1.0, 1.0456674473067915, 1.1391304347826088, 1.283571915473756, 1.096774193548387, 1.608695652173913, 1.1889576392194192, 1.1702127659574468, 1.0118110236220472, 1.0947824903253407, 1.2595772787318362, 1.1689280868385346, 1.0897540983606557, 1.0235081374321882, 1.057986111111111, 1.6, 1.0242748091603053, 1.0385077817113084, 1.16, 1.0109965635738831, 1.1591080876795163, 1.174757281553398, 1.001729398875438, 1.4444444444444444, 1.036101083032491, 1.0864605543710022, 1.0598086124401913, 1.018181818181818, 1.0413393532896627, 1.0229007633587786, 1.75, 1.0166232073011734, 1.0437415881561238, 1.081514753450005, 1.218549747048904, 1.0126500177763258, 1.0157068828159832, 1.226646248085758, 1.113573407202216, 1.26890756302521, 1.0439624825074934, 1.0630005339028297, 1.0120030007501875, 1.0844277673545966, 1.064217417520889, 1.0546875, 1.0399539625123315, 1.0952380952380953, 1.6, 1.1359102244389028, 1.6260257913247362, 1.076319095477387, 1.2916666666666667, 1.1428571428571428, 1.0024509803921569, 1.0268115942028986, 1.0459770114942528, 1.055405136782074, 2.0, 1.1524774774774775, 2.5, 1.1673306772908367, 1.0, 1.0089605213394235, 1.4516129032258065, 1.1950354609929077, 1.0647668393782384, 1.0, 1.3113836719049443, 1.3511730205278591, 1.5, 3.0, 1.0486111111111112, 1.19364161849711, 1.0416883793642522, 1.2226935312831388, 1.0691562932226832, 1.1772151898734178, 1.0299251870324189, 1.368421052631579, 1.1174242424242424, 1.6266233766233766, 1.2592592592592593, 1.0, 1.1813725490196079, 1.185276073619632, 1.0229074889867842, 1.0406896551724139, 1.0814816762185184, 1.113966223719986, 1.0842573841746517, 1.132759865255053, 1.1755005889281507, 1.0232198142414861, 1.5, 2.0, 1.375, 1.005784622387437, 1.0586080586080586, 1.1337047353760445, 1.031512605042017, 1.021685334722584, 1.0863787375415281, 1.0217776658889237, 1.0689655172413792, 1.2857142857142858, 1.015625, 1.029255613317111, 1.0706390895163056, 1.0193370786516853, 1.0166666666666666, 1.0344508813016147, 1.1047135196161446, 1.0093287137288869, 1.1003663003663005, 1.0450855569806363, 1.0777027027027026, 1.1031648170982327, 1.1194539249146758, 1.031307901907357, 3.0, 1.0547112462006079, 2.0, 1.0711382113821137, 1.0042283871142612, 1.0151515151515151, 1.076201594608578, 1.0317892824704813, 1.1627906976744187, 1.0159382188629642, 1.0479918106822423, 1.0809768637532133, 1.0486055776892431, 1.0077071290944124, 1.2043147566940933, 1.1819787985865724, 1.2222222222222223, 1.0, 1.0, 1.0663332190468506, 1.6666666666666667, 1.0547185935783177, 1.0958153735632183, 1.0614814814814815, 1.0703831606643643, 1.061471459322855, 1.1050378956754348, 1.0, 1.0363849765258215, 1.0007442662122725, 1.1048539896474265, 1.0425317467920017, 1.1767638805371818, 1.375, 1.1643835616438356, 1.1010452961672474, 1.086952763732227, 1.0190217391304348, 1.2832175666591978, 1.0165165165165164, 2.172043010752688, 1.0554216867469879, 1.09297052154195, 1.0769031718701791, 1.0, 1.064575880825207, 1.0346334098364167, 1.3541389995573263, 1.0638673253352153, 1.3870967741935485, 1.1663223140495869, 1.020782666371877, 1.049432424565829, 1.1219135802469136, 1.0184889920817444, 1.3333333333333333, 1.0390881858698036, 1.0792332268370608, 1.0342205323193916, 1.113744075829384, 1.0285188592456302, 1.0396902226524685, 1.0734632683658172, 1.0152915851272015, 1.0752895752895753, 1.0465309929054392, 1.0775813939821344, 1.0, 1.10239651416122, 1.0253502334889926, 1.0469922685272488, 1.1893901834407536, 1.017478813559322, 1.2431332655137335, 2.3333333333333335, 1.0835543766578248, 1.0292624813543032, 1.0, 1.1005229517722255, 1.2363213038416763, 1.0456216216216216, 1.0701168614357262, 1.2432878356082195, 1.124013928263281, 1.0515394912985274, 1.1149897330595482, 1.0997328950071912, 1.0593427629479952, 1.087667161961367, 1.0277777777777777, 1.064102564102564, 1.0874837813263043, 1.2065217391304348, 1.6, 1.046318503958307, 1.1698413769827878, 1.0043290043290043, 1.076555023923445, 1.2016933776837013, 1.0137951021591074, 1.1907009676658014, 1.0028985507246377, 1.2580645161290323, 1.0489432703003336, 1.0769230769230769, 1.1732283464566928, 1.71875, 1.0296733415370847, 1.194979079497908, 1.2154471544715446, 1.02, 1.0510204081632653, 1.149375339489408, 1.0404040404040404, 1.1041666666666667, 1.0377008652657602, 1.0358565737051793, 1.0130172013017202, 1.2307692307692308, 1.0197885352959468, 1.0376266280752533, 1.1039027511196418, 1.2166666666666666, 3.0, 1.3182883939038688, 1.0291515526851278, 1.0528353577568734, 1.1722560975609757, 1.3709677419354838, 1.2352941176470589, 1.0810810810810811, 1.011111111111111, 1.1566265060240963, 1.210826210826211, 1.034043966186783, 1.0318604421146333, 1.353448275862069, 1.0959113945675076, 1.047268255060138, 3.0, 1.0829518417601747, 1.0522518039313262, 1.5, 2.25, 1.1689655172413793, 1.113599809376303, 1.0511215440792905, 1.2876344086021505, 1.5, 1.0446735395189004, 1.3367875647668395, 1.0833333333333333, 1.0919292724336411, 1.0997611005848917, 1.0505047415111655, 1.0570002080299563, 1.25, 1.021903650984171, 1.0299172501591343, 1.045132743362832, 1.026751592356688, 1.0198830409356725, 1.0, 1.2019288728149489, 1.1409140089649132, 1.0289036919950323, 1.1166253101736974, 1.0924092409240924, 1.1067702383672227, 1.0577946768060837, 1.0405405405405406, 1.1066666666666667, 1.0161177965059895, 1.57587923558696, 1.06337003539127, 1.627659574468085, 1.1612903225806452, 1.1559139784946237, 1.5, 1.0761467889908256, 1.0516795865633075, 1.0018985671981833, 1.039568345323741, 2.0, 1.1685144124168514, 1.0203528929011079, 1.156754772393539, 1.1988682295877122, 1.0045200525969757, 1.0366741321388577, 1.0960357923212984, 1.0402298850574712, 1.0, 1.0869508282590192, 1.0840523144344016, 1.2390243902439024, 1.092485549132948, 1.6666666666666667, 1.035294117647059, 1.0339251883508833, 1.0297619047619047, 1.005544150528917, 1.107995022667239, 1.0090252707581226, 1.6, 1.113146551724138, 1.0069338574288706, 1.179093151204705, 1.16403785488959, 1.0969140462048828, 1.0080645161290323, 1.4653739612188366, 1.004835589941973, 1.0316133830794627, 1.1512732417138238, 1.025242718446602, 1.090069284064665, 1.0263157894736843, 1.128910029022896, 1.2235108554462795, 1.0137677127602902, 1.0448577680525164, 1.1059125964010283, 1.0239294710327456, 1.1481481481481481, 1.263616557734205, 2.0, 2.5, 1.2105263157894737, 1.010752688172043, 1.083058668424522, 1.0116714652797127, 1.0011112219167153, 1.0418538661622132, 1.0224039829302987, 1.2009132420091324, 1.0071090047393365, 1.1000759345794393, 1.3333333333333333, 1.1764705882352942, 1.2153141361256545, 1.0, 1.0939759036144578, 1.1508169250104734, 1.1176207513416816, 1.0753457545734284, 2.5, 1.0619469026548674, 1.1528384279475983, 1.1176325289758693, 1.0402628380083025, 1.1993704092339978, 1.1468023255813953, 1.1449622774742632, 1.1019965491742667, 1.0206043956043955, 1.0963855421686748, 1.0631458094144661, 1.6666666666666667, 2.0, 1.041785905920229, 7.0, 1.625, 1.6341463414634145, 1.0584484590860785, 1.1018810631753293, 1.1518058690744921, 1.052, 1.4285714285714286, 1.2474173553719008, 1.0245459008345605, 1.1212871287128714, 1.2860040567951319]
origin-bjaq_15.71 	max: 7.0000	99th: 3.0000	95th: 1.7500	median: 1.0830	mean: 1.1871

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.335863 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.404192