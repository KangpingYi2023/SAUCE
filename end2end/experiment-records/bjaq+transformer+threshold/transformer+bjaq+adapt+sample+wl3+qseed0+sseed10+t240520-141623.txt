Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 10, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.5724	95th: 1.6667	median: 1.0833	mean: 1.1727
ReportEsts: [1.0294117647058822, 1.0174479166666666, 1.0517338657176338, 1.0766045548654244, 1.5789473684210527, 1.0, 1.0927059352013027, 1.0768930729781139, 1.0, 1.0090673575129534, 1.130320607162439, 1.04276028095105, 1.0365694383979103, 1.1093023255813954, 1.0385022960084775, 1.0, 1.1, 1.0151024811218985, 3.0, 2.0, 1.173913043478261, 1.119291300569663, 1.0925570041032566, 1.1579565472695243, 1.1642821904292058, 1.0, 1.164382565705769, 2.0, 1.2, 1.0575539568345325, 1.0, 1.042085042450731, 1.0006243541164312, 1.2663706992230854, 1.059186370979586, 1.2217535153019023, 1.1443850267379678, 1.0001893985382317, 1.1137475032715751, 1.119047619047619, 1.2765957446808511, 1.0640243902439024, 1.0, 1.015816875106106, 1.124154673140281, 1.890625, 1.0729166666666667, 1.2190812720848057, 1.024931896726977, 1.1481481481481481, 1.0970862239841428, 1.2491408934707904, 1.04026836420071, 2.0, 1.161038961038961, 1.161323155216285, 1.2071992976294996, 1.3658536585365855, 1.0454545454545454, 1.25, 1.0925345328971283, 1.0797011207970113, 1.0636363636363637, 1.0235294117647058, 1.0909090909090908, 1.2031399658518303, 1.317388493859082, 1.75, 1.0, 1.068518691153165, 1.005966587112172, 1.0602898550724638, 1.034965034965035, 1.1213731686297042, 1.0847058823529412, 1.115702479338843, 1.0, 1.1089770354906054, 2.6666666666666665, 1.0030654098006764, 1.0, 1.029989358614685, 1.1349693251533743, 1.1037974683544305, 1.1241413150147204, 1.0, 1.0799820484302132, 1.0317634685053172, 1.0833333333333333, 1.75, 1.1259407927747116, 1.069136702919223, 1.02803738317757, 1.0280504908835906, 1.0374429223744293, 1.0597402597402596, 1.0546875, 1.1389698736637512, 1.0, 1.2241398143091207, 1.0593349603416717, 1.0523156089193826, 1.216005149109633, 1.36, 1.0162113922817557, 1.0817626758693921, 1.165080579599254, 1.0910125142207054, 1.0462906192519927, 1.3333333333333333, 1.3333333333333333, 1.0857476635514018, 1.1170530377846406, 1.0814908401768792, 1.155844155844156, 1.0591894237663366, 2.0, 1.0999684642068748, 1.2011494252873562, 1.0, 1.0164835164835164, 1.1666666666666667, 1.255639097744361, 1.0204098235982837, 1.1096528694571717, 1.1313131313131313, 1.8, 1.2119205298013245, 1.0, 1.0714285714285714, 1.0974736992771774, 1.1818181818181819, 1.0647786458333333, 1.0294673642033072, 1.0670232324920608, 1.0560747663551402, 1.106060606060606, 1.063522992985191, 1.039972432804962, 1.0840950639853748, 1.0246410506404007, 1.265625, 1.0092165898617511, 1.1606649547894026, 2.0, 1.0209662716499543, 1.0091428571428571, 1.0789825970548863, 1.1109934709722957, 1.5, 1.2153063695810125, 1.08, 1.0060362173038229, 1.1074561403508771, 1.127007299270073, 1.0805100182149363, 1.0765940458537697, 1.1122367101303912, 1.0253411306042886, 1.069078947368421, 1.2857142857142858, 1.3398058252427185, 1.0103092783505154, 1.5714285714285714, 1.0623798923073995, 1.0405264241435315, 1.1163239074550129, 1.337375859434683, 1.1204654346338125, 1.099732315602555, 1.2694736842105263, 1.1414868105515588, 1.076111164907524, 1.0161779575328616, 1.0721554116558742, 1.0894071914480077, 1.0442757748260594, 1.0935434672089477, 1.003695840213887, 1.0, 1.0161290322580645, 1.0086085238498448, 1.0287081339712918, 1.1777777777777778, 1.105263157894737, 1.0777246910269849, 1.3052085335383432, 1.0823106724671558, 1.1372549019607843, 1.1972727272727273, 1.0888919411632496, 1.0, 1.1818181818181819, 1.0411605665630927, 1.0147559591373438, 1.0253573075149838, 1.5217391304347827, 1.0655948553054662, 1.0484335900769204, 1.0660368342078352, 1.0626410835214446, 1.0740405298313145, 1.0350877192982457, 1.0847457627118644, 1.1830985915492958, 1.0, 1.415929203539823, 1.1478473426904274, 1.3101045296167246, 1.2183908045977012, 1.0128521997034108, 1.0031277926720286, 1.0048028920640386, 1.0544889579402952, 1.170785491597597, 1.0232558139534884, 1.079563182527301, 1.0168039538714992, 1.0300562927221553, 1.0092193084940253, 1.0, 1.0049937578027466, 1.1322159415437338, 1.018819792514806, 1.155363748458693, 1.0125867482914215, 1.2753654458169266, 1.0357142857142858, 1.0080303525355747, 1.2178958225889633, 1.0231246474901297, 1.2075471698113207, 1.1216845044206607, 1.0263056092843328, 1.1669291338582677, 2.0, 1.1597697999451904, 1.0898838767306833, 1.139240506329114, 1.1858407079646018, 1.0, 1.6666666666666667, 1.0784017164664708, 1.1090909090909091, 1.0936326960182423, 1.5, 1.0, 1.025, 1.074551131928181, 1.0425531914893618, 1.011049723756906, 1.1075949367088607, 1.0577249575551784, 1.0029387069689337, 1.0770213507287896, 1.0175438596491229, 2.0, 1.0862377398063043, 1.0741450471698113, 1.1225919439579686, 1.0394150750711602, 1.16982589577515, 1.024154264789868, 1.0977742448330683, 1.0780592574335863, 1.0221291866028708, 1.0984732824427481, 1.0318043588443995, 1.0, 1.0247168882323978, 1.193384223918575, 1.2045454545454546, 1.3888888888888888, 1.0257366654233495, 1.0555555555555556, 1.1025641025641026, 1.1026579637978602, 1.2061281337047354, 1.3433583959899749, 1.0100550972286741, 1.0402684563758389, 1.0217777207807985, 1.069461152597771, 1.25, 1.0526736995271007, 1.6666666666666667, 1.0174993648540918, 1.0151187904967602, 1.0667880387783897, 1.0810810810810811, 1.6666666666666667, 1.2608695652173914, 1.0597014925373134, 1.0560314679705598, 1.0, 1.0046082949308757, 1.0375586854460095, 1.0064102564102564, 1.0186271548719854, 1.1317365269461077, 1.150943396226415, 1.0041303350160624, 1.1152268568183252, 1.128531455907573, 1.0, 1.0, 1.100238663484487, 1.2453987730061349, 1.0771812080536913, 1.09469250210615, 1.0, 1.0823170731707317, 1.2826086956521738, 1.0055172413793103, 1.0020682523267839, 1.2857142857142858, 1.007101813196124, 1.0340909090909092, 1.1578947368421053, 1.1183778458844134, 1.1904761904761905, 1.4, 1.0191550962615439, 2.0, 1.1755829903978052, 1.0247093023255813, 1.0861361771944216, 1.0984628167843788, 1.0078947368421052, 1.0833333333333333, 1.095739931546693, 1.0924514982595361, 1.0381895332390383, 1.083813230955174, 1.001530541255044, 2.0, 1.125, 1.0406087890491098, 1.25, 1.067966573816156, 1.3529411764705883, 1.0, 1.4666666666666666, 1.3112449799196788, 1.0619136960600375, 1.3870967741935485, 1.0324675324675325, 1.0, 1.126498002663116, 1.0852925643922429, 2.0, 1.2406194163192377, 1.0, 1.0975176497381007, 1.072289156626506, 1.0476777748622408, 1.1451612903225807, 1.1363636363636365, 1.2816593886462881, 1.0925925925925926, 1.013589958407165, 1.0197730079541714, 1.0743919885550788, 1.0, 1.0769230769230769, 1.5714285714285714, 1.5, 1.1428571428571428, 1.0694520660703506, 1.3333333333333333, 1.1846921797004992, 1.2469135802469136, 1.19218801921276, 1.0723447295683033, 1.2523171987641606, 1.001157134085864, 1.0092807424593968, 1.0380952380952382, 1.5, 1.1320754716981132, 1.0595744680851065, 1.044309521781628, 1.0952380952380953, 1.5714285714285714, 1.032183908045977, 1.019561351511559, 1.0204443365302902, 1.0124069478908189, 1.1464387464387464, 1.0210670314637482, 1.0526315789473684, 1.0907770515613653, 1.0985169491525424, 1.1538461538461537, 1.0212464589235128, 1.1081081081081081, 1.0631773515750893, 1.0748812779238421, 1.0119136073491168, 1.058139534883721, 1.009090909090909, 1.1118012422360248, 1.0, 1.0175304098947153, 1.0406220179867045, 1.0545398350015454, 1.0620001663636471, 1.0351380777986736, 1.1439466158245948, 1.5714285714285714, 1.0480283114256825, 1.0, 1.2254483347566183, 1.25, 1.0289742457360398, 1.0420289855072464, 1.0841573516766982, 1.1778656126482214, 1.1710526315789473, 3.0, 1.1691780821917808, 1.01469705781889, 1.1316902703696892, 2.0, 1.0161290322580645, 1.2120921305182342, 1.3754940711462451, 1.1126608551266086, 1.1683991683991684, 1.105263157894737, 1.0267471958584986, 1.006610831412036, 1.0569484170036492, 1.0949572624863886, 1.0649122807017544, 1.1144278606965174, 1.2, 2.142857142857143, 1.0423280423280423, 1.5, 1.2288348700754401, 1.0, 1.1144474584267012, 1.9230769230769231, 1.0733901233097038, 1.0727628933303546, 1.0493522516964837, 1.0, 1.1875, 1.2, 1.2835381080811108, 1.1378555798687089, 1.0, 1.0181460120973413, 1.0770476455555273, 1.162453377538334, 1.5, 2.0, 1.006990291262136, 1.0054054054054054, 1.0132890365448506, 1.1111111111111112, 1.0791724137931034, 1.0985477178423237, 1.4705882352941178, 1.027156308851224, 1.0454545454545454, 1.094488188976378, 1.0205761316872428, 1.2923853596970971, 1.010967966573816, 1.0, 1.0422535211267605, 1.0727247126740236, 1.033737501298826, 1.0186136592006743, 1.0, 1.11059500110595, 1.0073579869125677, 1.0225248821372446, 1.0, 1.0526315789473684, 1.063565580952858, 1.0110429813072985, 1.0283517539644402, 1.005829972971318, 1.0313669746505567, 1.0294117647058822, 1.1735776277724204, 2.0, 1.09292469895085, 1.3214285714285714, 1.0, 1.1709844559585492, 1.1346153846153846, 1.0070516453839229, 1.2298850574712643, 1.034310071296137, 1.1225332721431849, 1.0704511812065998, 1.0462599756526445, 1.0624096998277794, 1.197674418604651, 3.0, 1.0117873004441245, 1.1657894736842105, 1.0467346781507674, 1.0558550176959745, 1.1040081177067478, 1.1605947955390334, 2.2967032967032965, 2.5714285714285716, 1.0072217658382276, 1.0279879224092787, 1.0206277032272375, 1.1230202578268877, 1.061945622830698, 1.029723991507431, 1.0716831518317524, 1.0254424778761062, 1.2058371735791091, 3.0, 1.0833333333333333, 1.0, 1.107843137254902, 1.0642857142857143, 1.2241630276564774, 1.0647058823529412, 1.0101522842639594, 1.148905109489051, 1.0340909090909092, 1.0370806424618084, 1.2696629213483146, 1.0280091772785365, 2.0, 1.107398568019093, 1.0436507936507937, 1.3055555555555556, 1.1486033519553072, 1.1339950372208436, 1.012, 1.066147859922179, 1.1032748231595493, 1.0, 1.2765957446808511, 1.5, 1.0, 1.1704545454545454, 1.002020202020202, 1.0093457943925233, 1.0485436893203883, 1.0640820249919898, 1.093967517401392, 1.0285039813966599, 1.1630733944954128, 1.0426687354538402, 1.0863525298057883, 1.2216216216216216, 1.0833333333333333, 1.0237058538945332, 1.0895844576362654, 1.1965317919075145, 1.0960969840331165, 1.062078751330259, 1.1315314063368538, 1.0767641955929044, 2.0, 1.3243243243243243, 1.090725806451613, 1.4205607476635513, 1.0, 1.1333333333333333, 1.25, 1.1345381526104417, 1.4444444444444444, 1.1666666666666667, 1.0124338432538245, 1.1272261062921933, 1.0280659096200109, 1.0318535825545172, 1.1837837837837837, 1.1212534059945505, 1.0, 1.1578947368421053, 1.026139733774743, 1.0709485483571068, 1.0856159023321335, 1.0804191821391957, 1.0394365150163545, 1.2103896103896103, 1.0709300470607004, 1.0959147424511546, 1.0056281812677983, 1.1027598411114667, 1.2727272727272727, 1.0414507772020725, 1.0, 1.2422535211267605, 1.2110259895382842, 3.0, 1.1500586166471278, 1.0791781333084565, 1.4285714285714286, 1.0594206770217152, 1.4, 1.1176470588235294, 1.053935838296983, 1.6153846153846154, 1.0388008653299976, 1.0187953865869286, 1.3571428571428572, 1.3181818181818181, 1.088659793814433, 1.038259206121473, 1.030905077262693, 1.0739913940923356, 1.1576599969451657, 1.0, 1.0386704323267435, 1.1219512195121952, 2.0, 1.019719999077427, 1.090319231767454, 1.1438032166508987, 1.020073864179057, 1.0149410929042055, 1.0761904761904761, 1.7142857142857142, 1.083676834295136, 1.0443548387096775, 1.1357813109802657, 1.1901548233425963, 1.0489254159726584, 1.0160771256217, 1.1996336996336996, 1.058267716535433, 1.1505016722408026, 1.0679262097852242, 1.0548895899053627, 1.0356472795497185, 1.129201680672269, 1.0751621051044258, 3.0, 1.153432113698216, 1.0110348431705576, 1.032824063022201, 1.2666666666666666, 1.2724621580336064, 1.2098214285714286, 1.1428571428571428, 1.0542780560062073, 1.0420575865415722, 1.1615720524017468, 1.0588235294117647, 1.3333333333333333, 1.0575334744813534, 1.5, 1.0817757009345794, 1.0, 1.0583001884027632, 1.3846153846153846, 1.0717299578059072, 1.0534591194968554, 1.0, 1.6216931216931216, 1.3090753424657535, 1.25, 2.0, 1.1367521367521367, 1.2137931034482758, 1.0483016516048613, 1.2032828282828283, 1.0921501706484642, 1.2271386430678466, 1.1014466214978942, 1.0545454545454545, 1.1395348837209303, 1.183673469387755, 1.0, 1.0, 1.3635116598079562, 1.1515151515151516, 1.06301652892562, 1.0614380439287194, 1.0818375245443124, 1.041119483315393, 1.086762220970563, 1.2015615962984385, 1.1638655462184875, 1.0005970149253731, 1.8333333333333333, 1.0, 1.2592592592592593, 1.0519845184791683, 1.0573698146513681, 1.107843137254902, 1.002469135802469, 1.0267277586865216, 1.0606146598938675, 1.002310012191731, 1.0985915492957747, 1.2222222222222223, 1.0135033758439609, 1.0019257586825154, 1.0746133596577823, 1.025020156227283, 1.006578947368421, 1.1389545186060248, 1.0212273092613093, 1.3038397328881468, 1.3574338085539714, 1.125, 1.0654160654160654, 1.5913978494623655, 1.1304347826086956, 1.1577287066246056, 1.0701001430615165, 1.0, 1.0354609929078014, 1.0090898705876594, 1.0588235294117647, 1.0763101123237726, 1.005324813631523, 1.2285714285714286, 1.0763101959914978, 1.0487743330930064, 1.0616102605425732, 1.0372137404580153, 1.0034168564920274, 1.1988379163570029, 1.206896551724138, 1.2857142857142858, 1.0, 1.4285714285714286, 1.0735133825844738, 1.3333333333333333, 1.250576393184502, 1.1062139895536052, 1.0466032923718989, 1.0621648460774578, 1.0509258336489207, 1.0380493033226152, 1.032258064516129, 1.0471567267683772, 1.015727804259516, 1.128843269591301, 1.0426370924211832, 1.1998675177646634, 1.6666666666666667, 1.0, 1.0858369098712446, 1.0892231966445978, 1.0814332247557004, 1.2892090241913563, 1.0580524344569289, 2.2017167381974247, 1.032507448052193, 1.0778523489932885, 1.062165071770335, 1.1875, 1.0348822158943827, 1.033003300330033, 1.3268828451882846, 1.0581052631578947, 1.391304347826087, 1.1530864197530863, 1.1355932203389831, 1.5625, 1.077239022971794, 1.5, 1.0826612903225807, 1.1070559610705597, 1.018543956043956, 1.076686004350979, 1.0143198090692125, 2.2, 1.061611374407583, 1.0960880914739513, 1.0541252291793988, 1.0019150157193473, 1.027759141227776, 1.082289629046106, 1.0, 1.0773809523809523, 1.2217183770883056, 1.036894731969262, 1.0170340681362726, 1.0069444444444444, 1.2290351668169521, 1.0832698976571091, 1.3881048387096775, 1.029956152961472, 1.0, 1.3333333333333333, 1.054330144132117, 1.0221487127858477, 1.2253388554216869, 1.112723565934575, 1.0782122905027933, 1.1278195488721805, 1.0969729228888823, 1.0776582257907226, 1.0955882352941178, 1.0162162162162163, 1.0453879941434847, 1.0878000294507437, 1.1071428571428572, 1.75, 1.0609211666502134, 1.164503490640569, 1.0109510086455331, 1.0227272727272727, 1.215423606082549, 1.007778283872324, 1.1599662637053696, 1.4035087719298245, 1.2307692307692308, 1.0619946091644206, 1.130952380952381, 1.14375, 1.5925925925925926, 1.0814280925243045, 1.1962338949454905, 1.169983416252073, 1.048780487804878, 1.0420637308991205, 1.00787552823665, 1.0678045515394914, 1.1934046345811051, 1.3333333333333333, 1.12, 1.3333333333333333, 1.1678857540926506, 1.1923076923076923, 1.3333333333333333, 1.1538461538461537, 1.0039735099337748, 1.0742753623188406, 1.0265808914495775, 1.054582402633391, 1.0472727272727274, 1.3333333333333333, 1.1428571428571428, 1.1612903225806452, 1.0945945945945945, 1.044776119402985, 1.1184668989547037, 1.0344751896152313, 1.0326778227152982, 1.3473684210526315, 1.076636370475233, 1.0468695260497474, 2.5, 1.0689326664625225, 1.263537906137184, 3.0, 2.0, 1.1535502958579882, 1.085204045040522, 1.0758379458794587, 1.2111801242236024, 1.0, 1.131578947368421, 1.2822085889570551, 3.0, 2.0, 1.0861220472440944, 1.1485414706277726, 1.0276146445083094, 1.6666666666666667, 1.026215982208037, 1.0433772269558481, 1.0483870967741935, 1.0, 1.0093896713615023, 1.0255895807693767, 1.4078947368421053, 1.1840329112296715, 1.0471092492387657, 1.2039660056657224, 1.12109375, 1.0692824319547543, 1.0664845173041895, 1.0867768595041323, 1.1896551724137931, 1.0310549326158818, 1.5881895881895882, 1.043537084576424, 1.4311377245508983, 1.2058823529411764, 1.4029850746268657, 1.1031636863823935, 1.0636563185951708, 1.0200887857128311, 1.0928377083732517, 1.0906113537117903, 1.5, 1.6666666666666667, 1.014255577574634, 1.164028144239226, 1.1569733514880374, 1.0084805046575276, 1.0849640408094998, 1.108441859484975, 1.4, 1.0212765957446808, 1.1116264444619133, 1.1461753405518686, 1.2836611195158851, 1.3859223300970873, 2.5, 1.056338028169014, 1.0809771186104613, 1.1089030206677266, 1.0164264535667284, 1.1019648343255863, 1.03125, 2.0, 1.0862944162436547, 1.0197474219268357, 1.1793465844185516, 1.209125475285171, 1.0948183378629666, 1.127388535031847, 1.205298013245033, 1.0336231884057971, 1.0325338675202045, 1.073954036535062, 1.0195852534562213, 1.0554054054054054, 1.0, 1.1958720752017984, 1.0473535058049182, 1.0543175487465182, 1.0503887918336587, 1.108574953732264, 1.0287443267776097, 1.2, 1.2493368700265253, 1.6666666666666667, 2.0, 1.2352941176470589, 1.0025641025641026, 1.042654028436019, 1.0020838760093775, 1.012620400526644, 1.0911804613297151, 1.0027196652719665, 1.1684782608695652, 1.2564102564102564, 1.0742510013538444, 1.6, 1.4166666666666667, 1.214934808376136, 1.1428571428571428, 1.0189959294436906, 1.163087934560327, 1.0473186119873816, 1.0928649104867638, 2.0, 1.047001620745543, 1.193798449612403, 1.0052644773126096, 1.0402442269053276, 1.1085858585858586, 1.122945205479452, 1.142625102908128, 1.1279966013230565, 1.0, 1.2241379310344827, 1.0656424581005586, 1.0, 1.0, 1.0417858803333213, 5.0, 1.4285714285714286, 1.6875, 1.0388471177944862, 1.0681818181818181, 1.0981152993348116, 1.1133777952138093, 1.0, 1.094972067039106, 1.0110981308411215, 1.17989417989418, 1.3004807692307692, 1.4285714285714286, 1.08320363941099, 1.1169623059866962, 1.1343612334801763, 1.0111565637783562, 1.0316867473897282, 1.0700997314921366, 1.1378290446613428, 1.0, 1.2206709819351018, 1.071851097240436, 1.0401721664275467, 1.1774193548387097, 1.0774049911980947]
origin-bjaq_15.71 	max: 5.0000	99th: 2.5724	95th: 1.6667	median: 1.0833	mean: 1.1727

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 16.492885 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[3.5762787e-07 5.9604645e-08 5.9604645e-08 3.5762787e-07 5.3644180e-07]
Distance score: 2.74181360282455e-07
SAUCE Drift detection: False
Detection latency: 0.0230s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.031034 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 3.0000	95th: 1.9174	median: 1.0854	mean: 1.1913
ReportEsts: [1.0278551532033426, 1.0373626373626375, 1.0522326001807774, 1.063903281519862, 1.3333333333333333, 1.0, 1.0390211345939933, 1.067942283064343, 1.0, 1.0621531631520533, 1.1265706995330027, 1.0431444612297356, 1.0248112189859762, 1.0938697318007662, 1.040768094534712, 2.0, 1.1018518518518519, 1.0, 1.0909090909090908, 1.1006768189509306, 1.0914381645215445, 1.0556217559024903, 1.1229235880398671, 1.0025020850708923, 1.0032321968512148, 1.025035689357534, 2.0, 1.1857918440372632, 1.0, 1.3333333333333333, 1.2073628850488354, 1.0, 1.053572621654727, 1.0081530726572094, 1.0961989676208352, 1.0532811927166077, 1.2519974545711658, 1.1808035714285714, 3.0, 1.0508581752484192, 1.0010111223458038, 1.0009209987720016, 1.1503184713375796, 1.093922024856705, 1.0241635687732342, 1.0756228361957776, 1.3181818181818181, 1.024869109947644, 1.1355140186915889, 1.04502688172043, 1.4, 1.2077922077922079, 1.0987124463519313, 1.1875, 1.0372915351186718, 1.0086379825602816, 1.03368999421631, 1.137844611528822, 1.1348314606741574, 1.088874508155293, 1.328125, 1.1181218404592579, 1.0719640179910046, 1.029739776951673, 1.0285714285714285, 1.2, 1.1155121888384376, 1.2755182366832851, 2.2, 1.0, 1.060939680570631, 1.0138067061143985, 1.0653753026634383, 1.001937984496124, 1.0971778280190223, 1.1206496519721578, 1.0591818973020017, 1.2114285714285715, 1.5048543689320388, 1.1195665096712242, 1.0043753038405445, 1.6, 2.0, 1.0769230769230769, 1.0367074527252502, 1.1129032258064515, 1.4017278617710582, 2.0, 1.1428571428571428, 1.098701923076923, 1.109593154181054, 1.2591437955798028, 1.0123108489356245, 1.1035541496092296, 1.1666666666666667, 1.0011862396204034, 1.1193415637860082, 1.0363636363636364, 3.0, 1.256188605108055, 1.1071428571428572, 2.0, 1.0417131708314518, 1.2795744680851064, 1.0919540229885059, 1.200579546257686, 1.3870967741935485, 1.0188896103216076, 1.0053932584269663, 1.386595734574645, 1.1698647373387858, 1.053658536585366, 1.2857142857142858, 3.0, 1.0789727746669242, 1.049453274765737, 1.0662809047869541, 1.2705882352941176, 1.0625860420147757, 2.0, 1.142669813794912, 1.145985401459854, 1.0, 1.0483091787439613, 1.0, 1.2055084745762712, 1.023071075412657, 1.0730540470649081, 1.0819672131147542, 1.6666666666666667, 1.1357340720221607, 1.0, 1.1176470588235294, 1.1361619523017195, 1.3076923076923077, 1.1763341067285382, 1.0025897560759662, 1.1196506231041918, 1.4545454545454546, 1.5, 1.00836820083682, 1.0819357930043123, 1.0786115364982134, 1.039952632024135, 1.2838709677419355, 1.022392135445112, 1.1067934561987498, 3.0, 1.0086110071134406, 1.00664767331434, 1.0914221218961626, 1.0962842819227367, 1.5, 1.2393969849246231, 1.020125786163522, 1.0119453924914676, 1.3, 2.0, 1.0174042764793636, 1.0789842466415387, 1.1777057622303115, 1.0823529411764705, 1.0679347826086956, 1.4181818181818182, 1.3255813953488371, 1.0309789343246591, 1.0, 1.0543385513127523, 1.2, 1.087012987012987, 3.7282229965156795, 1.032258064516129, 1.067983367983368, 1.2208480565371025, 1.1098265895953756, 1.0916344294003868, 1.0616740088105727, 1.0056858564321252, 1.0236779794790845, 1.0699865410497982, 1.1052403637938502, 1.2568908193908195, 1.1233766233766234, 1.0789473684210527, 1.0101824235277796, 1.0355787876233034, 1.3636363636363635, 1.0968042406896201, 1.0359712230215827, 2.0, 1.254847645429363, 1.045096062406601, 1.7222222222222223, 1.1409802930773119, 1.1058485587360967, 1.04474429226125, 1.0695541105434279, 1.0855721393034825, 1.0181471957293058, 1.0426242959341532, 1.0271059216013345, 1.0023066691360936, 1.0887659369737792, 1.0603864447322253, 1.0620592383638927, 1.0529133029133029, 1.0226244343891402, 1.028169014084507, 1.2023809523809523, 1.0, 1.4492753623188406, 1.2214962430578242, 1.3101449275362318, 1.1304347826086956, 1.0305951383067895, 1.65, 1.0419223564369227, 1.0134529147982063, 1.2089582003828974, 2.0, 1.0250626566416041, 1.0018939393939394, 1.0957556316280852, 1.0113945172824792, 1.5, 1.0729632945389436, 1.1500484663282238, 1.0047752002713775, 1.0052356020942408, 1.0453781512605043, 1.0486827033218786, 1.0816534243876814, 1.3949579831932772, 1.004412951204967, 1.0038674396925455, 1.1751592356687899, 1.0878504672897196, 1.0382452193475815, 1.5, 1.1422924901185771, 2.0, 1.2726355611601514, 1.1720765612629813, 1.1613403060236296, 1.2834008097165992, 1.0714285714285714, 1.6666666666666667, 1.1205885801383515, 1.3214285714285714, 1.1340490704515815, 1.2, 1.053105310531053, 1.0059880239520957, 1.0, 1.0070627073182346, 1.0161290322580645, 1.1111111111111112, 1.290909090909091, 1.0034916201117319, 1.0900515132002575, 1.0, 2.0, 1.0952560531390616, 1.0438013062496254, 1.1407837445573294, 1.0068798971490123, 1.1389063482086739, 1.023651434881673, 1.0926049300466356, 1.101099321007613, 1.042929292929293, 1.0281205505457998, 1.0612001733102252, 1.2142857142857142, 1.0630454937817706, 1.0806142034548945, 1.2156862745098038, 1.2727272727272727, 1.1587301587301588, 1.1423357664233578, 1.0007553583231046, 1.034304775280899, 1.096244131455399, 1.3596673596673596, 1.0190008845665377, 1.051862673484295, 1.1255210548702679, 1.0542332421053613, 1.3, 1.0824742268041236, 1.0340050377833754, 1.044192077260127, 1.0195607081410494, 1.051371432435072, 1.1719745222929936, 1.1961560203504804, 1.0391211906449327, 1.0610962882907224, 1.1050606848721283, 1.0290309501283956, 1.0128558310376492, 2.0, 1.1428571428571428, 1.074727245553729, 2.6666666666666665, 1.0035149384885764, 1.014239188063319, 1.0858744701217011, 1.358974358974359, 1.0854700854700854, 1.3361801242236024, 1.1550709588092765, 1.0475193279357156, 1.125, 1.2211019929660023, 1.0108353444765565, 1.1914285714285715, 2.0, 2.1818181818181817, 1.0090536753610693, 1.4285714285714286, 1.003864459439158, 1.0555555555555556, 1.0434782608695652, 1.0914552128217405, 1.16, 1.1666666666666667, 1.003946516081789, 2.0, 1.0476190476190477, 1.0550795593635252, 1.0787809085681426, 1.076181592039801, 1.0807860262008733, 1.0947368421052632, 1.1085776820063855, 1.086211797190114, 1.5942028985507246, 1.0148855886731056, 1.0512820512820513, 1.5, 1.2, 1.0390546860860537, 1.5, 1.0669767441860465, 1.5, 3.0, 1.4210526315789473, 1.31701244813278, 1.0352664576802508, 1.1798561151079137, 1.0111940298507462, 1.2409638554216869, 1.6666666666666667, 1.0819061691909864, 1.3333333333333333, 1.234375, 1.0033227964419613, 1.0183150183150182, 1.095890410958904, 1.0215355805243447, 1.75, 1.25, 1.3640098603122432, 1.0714285714285714, 1.0666666666666667, 1.1299752642230718, 1.2484388392310517, 1.0198019801980198, 2.0, 1.0308282695348099, 1.1580882352941178, 1.608695652173913, 2.0, 1.0076230076230077, 1.0, 1.0021505376344086, 1.118811881188119, 1.178486850305372, 1.126464194047974, 1.1333661417322836, 1.0780498469610844, 1.1115457243053681, 1.0141776937618148, 1.1430678466076696, 1.092223339467643, 1.1592465753424657, 1.096774193548387, 1.0169796187959992, 1.0695799020910022, 1.2222222222222223, 1.0196078431372548, 1.048780487804878, 1.084942084942085, 3.0, 1.0416666666666667, 1.4787234042553192, 1.1742574257425742, 1.0, 1.0558375634517767, 1.0936995153473343, 1.0905797101449275, 1.0059629222802573, 1.1411229135053111, 1.0357042766661062, 1.2933333333333332, 1.08, 1.1307692307692307, 1.0, 1.1100713730892677, 1.62, 1.1096951334974436, 1.057939485165281, 1.0790469637020472, 1.1592661526189842, 1.625, 1.1385321100917432, 1.0, 1.0534100246507807, 1.0833333333333333, 1.0289078943862735, 1.021505376344086, 1.0959369965992483, 1.1224489795918366, 1.0517844646606018, 4.0, 1.2744430693069306, 1.0202981009540366, 1.1733689079985412, 2.0, 1.0657894736842106, 1.2900158478605388, 1.0970350404312668, 1.1266638643687823, 1.0437191149161185, 1.04, 1.1057898498927805, 1.0388671835462255, 1.0607888171048065, 1.0910022370600592, 1.0771704180064308, 1.115419708029197, 1.2432432432432432, 1.0358306188925082, 1.0713362522417818, 1.1150442477876106, 1.0728241563055063, 1.0, 1.5, 1.3048376408217361, 1.2244897959183674, 1.0304169514695831, 1.0498181922295073, 1.0852064819654992, 1.0, 1.1379310344827587, 1.2142857142857142, 1.0433268915868825, 1.0416666666666667, 1.0, 1.0754312146459721, 1.3333333333333333, 1.0, 1.0056518462697814, 2.3333333333333335, 1.0217109526895658, 1.0105740181268883, 1.005540166204986, 1.3333333333333333, 1.0762596526524453, 1.0544388609715243, 1.65, 1.062031015507754, 1.0534351145038168, 1.1238938053097345, 1.0542372881355933, 1.3417989417989418, 1.0019137840294723, 1.0, 1.0238095238095237, 1.0021743675517458, 1.1094345879621954, 1.0468625893566323, 1.25, 1.1060550458715597, 1.0094563359091842, 1.0116731517509727, 2.0, 1.0328249336870026, 1.044078913656162, 1.0432755674884062, 1.0304252998909487, 1.000322398353957, 1.018970921251931, 1.0121082621082622, 1.3121307601417882, 1.5, 1.067494414847912, 1.0630975143403443, 1.0651162790697675, 1.0543657331136738, 1.0831099195710456, 1.0009970817120624, 1.1404494382022472, 1.0430864836872087, 1.0817872018174934, 1.1004062442001938, 1.1397379912663756, 1.1055374105562343, 1.0211934465654593, 1.0357142857142858, 1.03125, 1.1074521638791321, 1.1141649048625792, 1.0188843236409608, 1.0682530713882126, 1.0, 1.0060975609756098, 1.2427745664739884, 1.2666666666666666, 1.3518518518518519, 1.0159201133453217, 1.1114982578397212, 1.2358078602620088, 1.0, 1.5, 1.021021021021021, 1.104128775645493, 1.0422325581395349, 1.0226555412157068, 1.0862924780450554, 1.0788888888888888, 1.0224604389994896, 1.009332918536954, 1.5380116959064327, 1.0370683897423152, 1.1324175824175824, 1.1384615384615384, 1.0712176152188764, 1.0697115384615385, 1.0259153746176366, 2.0, 1.104417670682731, 1.0169491525423728, 1.1989482909728308, 1.1081081081081081, 1.046376811594203, 1.0410958904109588, 1.3078703703703705, 1.0650067408156387, 1.0, 1.1451612903225807, 1.6666666666666667, 1.3333333333333333, 1.072072072072072, 1.2406417112299466, 1.0367847411444142, 1.1166666666666667, 1.0684803001876173, 1.36, 1.061474168735994, 1.1774755589971928, 1.0879144131562688, 1.0905323111738308, 1.0184787418564014, 1.1354802887284843, 1.1470588235294117, 1.0488706057404362, 1.06071076011846, 1.109619686800895, 1.1620603015075377, 1.210144927536232, 1.052338034999798, 1.1752941176470588, 1.1028713320063852, 1.3222222222222222, 1.0851367419738407, 1.1910112359550562, 1.5, 1.0011737089201878, 1.1176470588235294, 2.0, 1.655, 1.029376028545502, 1.0435276305828918, 1.0101010101010102, 1.1092896174863387, 1.0653961911680765, 1.0077807455580072, 1.0705244122965643, 1.4, 1.6666666666666667, 1.15857063093244, 1.1095890410958904, 1.1163446054750403, 1.1102993165213293, 1.0, 1.1777899343544858, 1.143162393162393, 1.0504397394136809, 1.130827067669173, 1.0384575835475578, 1.0698425466977393, 1.0150784896941438, 1.2828282828282829, 3.0, 1.1769768692845617, 1.0, 1.0208574739281575, 1.1767241379310345, 1.317614424410541, 1.1544117647058822, 1.9130434782608696, 1.1019174845510724, 1.0928571428571427, 1.247148288973384, 1.02321761939646, 1.230869001297017, 1.1772665764546684, 1.026630644538788, 1.0072332730560578, 1.0642361111111112, 1.0, 1.0527180226735569, 1.018237778723683, 1.1578947368421053, 1.0054607508532423, 1.197078870496592, 1.0694444444444444, 1.028387792877008, 1.1, 1.0774774774774776, 1.0141962012923438, 1.097938144329897, 1.1775147928994083, 1.0518590053114438, 1.0859375, 1.6666666666666667, 1.0741496598639455, 1.0182555780933062, 1.1178626515912662, 1.2805446076675027, 1.0074459806116272, 1.0212698712760742, 1.1761978361669243, 1.0978446801231612, 1.2077562326869806, 1.050734774449833, 1.0139679255043974, 1.0340821068938808, 1.0148536478811707, 1.0684352623547364, 1.093093093093093, 1.0349366265843354, 1.2857142857142858, 1.6, 1.1327433628318584, 1.6177156177156178, 1.0658963148032479, 1.0334928229665072, 1.0, 1.0111464968152866, 1.0268720888570404, 1.1183431952662721, 1.0279350309817403, 2.0, 1.0135283363802559, 1.5, 1.0198019801980198, 1.0666666666666667, 1.0368138820268724, 1.4193548387096775, 1.2, 1.0494791666666667, 2.0, 1.0907652697211279, 1.2880396319886767, 1.5, 1.6666666666666667, 1.1258741258741258, 1.1306818181818181, 1.003441494591937, 1.1582213029989659, 1.119047619047619, 1.0738522954091816, 1.0221130221130221, 1.0364181662382177, 1.120754716981132, 1.0852459016393443, 1.0344827586206897, 2.5, 1.2186858316221767, 1.1262019230769231, 1.0909090909090908, 1.0259923967818938, 1.1033727410366265, 1.0668505239933812, 1.1011189416419387, 1.1850484679331352, 1.1352601156069364, 1.0371879775853285, 1.875, 2.0, 1.121212121212121, 1.0409558470442541, 1.0599415204678362, 1.115068493150685, 1.0061728395061729, 1.038883222845487, 1.0307854652229766, 1.0019827079361767, 1.0813953488372092, 1.2272727272727273, 1.0485611510791366, 1.0208391065787286, 1.0654807273519165, 1.0451210100102521, 1.011173184357542, 1.0971428571428572, 1.0477122298967816, 1.043800192884891, 1.0285296269202633, 1.0672973015301248, 1.1585365853658536, 1.0652260904361746, 1.054054054054054, 1.0281719891488355, 1.2, 1.0969461948618517, 1.0, 1.0503018108651911, 1.0450779761484723, 1.064516129032258, 1.075004314407466, 1.0177147918511957, 1.2325581395348837, 1.0709562921360474, 1.0274592004791137, 1.082726559874538, 1.0502392344497609, 1.1333982473222979, 1.199318136992477, 1.2124542124542124, 1.1764705882352942, 1.0, 1.375, 1.0759762308998302, 1.4285714285714286, 1.0808978363993984, 1.095837736952171, 1.0138376383763839, 1.0565629678921977, 1.0833200137001942, 1.0212652371207402, 1.0087719298245614, 1.0651920838183935, 1.0027482126802534, 1.1430520100551473, 1.042538839176039, 1.246734652868482, 1.5, 1.1856209150326797, 1.0135593220338983, 1.0883971516473359, 1.0215633423180592, 1.2902634593356244, 1.046583850931677, 2.1696113074204946, 1.0141082372109385, 1.0355160932297447, 1.027048321946841, 1.0476190476190477, 1.062601139629081, 1.0286148212283366, 1.2825904121110177, 1.0665015917934206, 1.0857142857142856, 1.0917159763313609, 1.1670073910992294, 1.019273024044196, 1.2622950819672132, 1.0191924386003575, 1.1363636363636365, 1.021960175116509, 1.1198995605775266, 1.050257731958763, 1.184257602862254, 1.0171480144404332, 1.069, 1.069767441860465, 1.0030408391773233, 1.0743243243243243, 1.0090357434198478, 1.035104940538403, 1.0714285714285714, 1.0757575757575757, 1.0207339147605727, 1.1501772478246859, 1.0178890876565294, 1.094142259414226, 1.2093495934959348, 1.775, 1.007361963190184, 1.0278100983266, 1.1290322580645162, 1.116745283018868, 1.244840867626191, 1.0534201954397393, 1.1499118165784832, 1.0860643247526363, 1.09123213595983, 1.026525198938992, 1.1268191268191268, 1.1136490708765006, 1.1026779519911198, 1.0823353293413174, 1.0416666666666667, 1.0389294403892944, 1.0884096096956792, 1.1111111111111112, 2.25, 1.0533380462957929, 1.1668440122301091, 1.0621865596790372, 1.0422535211267605, 1.1746513038204973, 1.0066242157068552, 1.1796082133585084, 1.1545768566493955, 1.25, 1.0680157391793141, 1.2222222222222223, 1.1161616161616161, 1.7272727272727273, 1.0357632317431313, 1.2021720969089391, 1.121251629726206, 1.1304347826086956, 1.0196936542669583, 1.015466408893185, 1.1237113402061856, 1.3650793650793651, 1.0383426097711812, 1.0702479338842976, 1.1051295073641443, 1.0769230769230769, 1.0402513696422817, 1.0069390902081727, 1.0349297803384947, 1.1885245901639345, 1.1071428571428572, 1.3043227665706052, 1.0069725563638983, 1.0502820462944953, 1.1991017964071857, 1.25, 1.1176470588235294, 1.0, 1.0666666666666667, 1.0246913580246915, 1.0961165048543688, 1.023040774404142, 1.032023726318524, 1.3217391304347825, 1.1156581296014325, 1.0484362349445357, 3.0, 1.087216057961769, 1.0375199324641216, 1.5, 2.75, 1.2550818046603867, 1.118980678351379, 1.0863887331234094, 1.2564766839378239, 1.5, 1.2150943396226415, 1.1949367088607594, 2.25, 1.072775259752553, 1.0482820230896097, 1.0212426504591399, 1.015472481827622, 2.0, 1.0372807581984207, 1.0326504481434058, 1.0890538033395176, 1.0226130653266332, 1.0023391812865496, 1.0, 1.0731889469753548, 1.143042104718007, 1.0349227344581733, 1.0203821656050955, 1.121405750798722, 1.105107618938904, 1.1069476971116314, 1.1003460207612457, 1.4516129032258065, 1.0393261496018902, 1.4948296836982968, 1.0313602135163473, 1.2935323383084578, 1.134453781512605, 1.0340030911901081, 1.125, 1.0857669843221642, 1.0482233502538072, 1.0029691665371971, 1.0641711229946524, 2.0, 1.0023828435266084, 1.0315327997425894, 1.1644736842105263, 1.1670710011321366, 1.0343906045474378, 1.0828336354762236, 1.1179618014953403, 1.3152454780361758, 1.0169491525423728, 1.0699369582348306, 1.0755150113495224, 1.2390243902439024, 1.0058823529411764, 2.6666666666666665, 1.0238095238095237, 1.0524389127848448, 1.0352422907488987, 1.0039300912249651, 1.0716958833957062, 1.0035273368606703, 2.0, 1.1051502145922747, 1.0367982477024904, 1.170657544659825, 1.173913043478261, 1.0576911618669316, 1.1167108753315649, 1.4699812382739212, 1.0172001911132347, 1.0326533081285445, 1.1024537922243467, 1.0535019455252919, 1.0741163055872291, 1.0526315789473684, 1.2269728160464501, 1.110317113088004, 1.0157159487776484, 1.012726054922974, 1.1155440414507771, 1.008248730964467, 1.1923076923076923, 1.2685589519650655, 1.6666666666666667, 2.5, 1.2, 1.0129032258064516, 1.04177545691906, 1.0365548643622138, 1.022921462013725, 1.0381465012871518, 1.029853446716121, 1.1889400921658986, 1.0739481512962177, 1.0649995618007069, 1.5, 1.2941176470588236, 1.4493322859387274, 1.0, 1.1147741147741148, 1.1421467053460423, 1.0256793072558972, 1.1026113463166807, 2.5, 1.0756216354780825, 1.098169717138103, 1.0930786679628677, 1.0412784738476601, 1.2790697674418605, 1.116107000569152, 1.1597812765155087, 1.1228070175438596, 1.0604395604395604, 1.0, 1.0660486674391656, 1.0, 5.0, 1.0424342963653308, 5.0, 1.4444444444444444, 1.903225806451613, 1.0299896587383661, 1.0696113314922628, 1.0998883928571428, 1.0685483870967742, 1.1428571428571428, 1.109841965263652, 1.0384236453201972, 1.10828025477707, 1.3102766798418972]
origin-bjaq_15.71 	max: 5.0000	99th: 3.0000	95th: 1.9174	median: 1.0854	mean: 1.1913

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.096244 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=34.678345