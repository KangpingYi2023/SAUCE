Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 31, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.5025	95th: 1.6679	median: 1.0805	mean: 1.1726
ReportEsts: [1.0063897763578276, 1.0161458333333333, 1.0549382983956137, 1.1111111111111112, 1.5, 1.0, 1.0417001231197474, 1.072786146023218, 1.0, 1.0304232804232805, 1.2058407641474043, 1.043164721375354, 1.0677130044843048, 1.1441860465116278, 1.0582832921229248, 1.0, 1.0227272727272727, 1.0648246546227418, 3.0, 2.0, 1.173913043478261, 1.080583519761372, 1.1007326007326008, 1.0822078684674103, 1.045387271830291, 1.0, 1.1960791635548917, 1.5, 1.2, 1.0359712230215827, 1.0, 1.0412363418649904, 1.0064373062349294, 1.1403995560488347, 1.0660889998531355, 1.2209456108447678, 1.1898395721925135, 1.002423330014812, 1.18431021420208, 1.1428571428571428, 1.1470588235294117, 1.0701219512195121, 1.0, 1.025801474369964, 1.1335897884245498, 1.8615384615384616, 1.0510204081632653, 1.1731448763250882, 1.0301158772108152, 1.1574074074074074, 1.072483238816189, 1.4381443298969072, 1.041583403720566, 2.0, 1.2207792207792207, 1.1798072306953729, 1.076742364917776, 1.3461538461538463, 1.1180124223602483, 1.25, 1.1145038167938932, 1.1058530510585305, 1.0954545454545455, 1.0116279069767442, 1.0909090909090908, 1.0283324434952839, 1.2976758993950972, 1.75, 1.0, 1.0496877039246761, 1.025703794369645, 1.059675550405562, 1.0277777777777777, 1.060685657352475, 1.0752941176470587, 1.0650887573964498, 1.0, 1.1106471816283925, 2.0, 1.008249878045281, 1.15625, 1.0222755640902546, 1.196319018404908, 1.09, 1.1221786064769381, 1.04, 1.0718947497530777, 1.0018263984826843, 1.0637254901960784, 1.75, 1.0609929078014184, 1.0649722665004029, 1.0654205607476634, 1.0014044943820224, 1.0064338235294117, 1.0623376623376624, 1.0227272727272727, 1.1434146341463414, 1.0, 1.2430124223602483, 1.0174226061915046, 1.0360205831903946, 1.2337396604266435, 1.2592592592592593, 1.019228049887975, 1.0414122644013803, 1.3516977363515312, 1.149032992036405, 1.0533415082771307, 1.3333333333333333, 2.3333333333333335, 1.0899532710280373, 1.037693425392684, 1.0176879343019583, 1.155844155844156, 1.0597426297077053, 1.0, 1.075685903500473, 1.1702127659574468, 1.0, 1.0224719101123596, 1.1666666666666667, 1.25062656641604, 1.0263205368101957, 1.0955968004970102, 1.1313131313131313, 1.8, 1.1456953642384107, 1.0, 1.0714285714285714, 1.0855220782938524, 1.1818181818181819, 1.0486653645833333, 1.0340268924240235, 1.1719137218907756, 1.048064085447263, 1.0579710144927537, 1.0717069368667187, 1.039972432804962, 1.0719073735527118, 1.0178133898417323, 1.1824817518248176, 1.0026160889470241, 1.1407430845432087, 2.0, 1.0200546946216955, 1.0251428571428571, 1.0914014895057549, 1.0873478030704076, 1.5, 1.2222087672559943, 1.021180030257186, 1.0080645161290323, 1.1074561403508771, 1.162043795620438, 1.0134861766689143, 1.1396745856853925, 1.1725085910652921, 1.0333988212180747, 1.0657894736842106, 1.3061224489795917, 1.393939393939394, 1.053019145802651, 1.2857142857142858, 1.0362503421813305, 1.0520171713089692, 1.1864754098360655, 1.3616917841516771, 1.086264100862641, 1.1149187670615675, 1.2757894736842106, 1.1044083526682134, 1.1148445821632613, 1.0626895854398382, 1.0232959447799828, 1.075801749271137, 1.0556265984654731, 1.1231398485771473, 1.0298500210553594, 1.0, 1.0714285714285714, 1.063646627152131, 1.0279106858054226, 1.226963231956423, 1.144736842105263, 1.1002401483195838, 1.3146261772054584, 1.1012488366556283, 1.1153846153846154, 1.3263636363636364, 1.0902941875148469, 1.0, 1.1818181818181819, 1.0363988539606956, 1.0450771055753263, 1.0240793201133145, 1.4583333333333333, 1.0488745980707395, 1.0462806435203502, 1.0542281409789893, 1.0626410835214446, 1.0883314008643408, 1.1016949152542372, 1.0158730158730158, 1.2, 1.0, 1.4678899082568808, 1.0580350102507492, 1.278745644599303, 1.264367816091954, 1.0098863074641622, 1.0031277926720286, 1.0430858858429537, 1.043530129841305, 1.1722116482679863, 1.2137931034482758, 1.141914191419142, 1.0103694102397927, 1.0291085070940318, 1.0302049877196298, 1.0, 1.0314699792960662, 1.0893979083371084, 1.0148973254780798, 1.1646985705407085, 1.068197216865586, 1.2770876093766879, 1.0357142857142858, 1.0042090022139352, 1.193527591542032, 1.0141003948110547, 1.037837837837838, 1.100433690938142, 1.030174081237911, 1.2015748031496063, 2.0, 1.2439741328630218, 1.067831621259491, 1.1598687294889827, 1.0763052208835342, 1.0, 1.6666666666666667, 1.008986827526776, 1.1272727272727272, 1.0917177376991771, 1.5, 1.0, 1.0810810810810811, 1.074551131928181, 1.065217391304348, 1.0303867403314917, 1.1476793248945147, 1.0559322033898304, 1.0012610340479193, 1.1478484737035675, 1.0363636363636364, 2.0, 1.0653979807949334, 1.0274957698815568, 1.115586690017513, 1.0185019587804462, 1.1159798197381101, 1.0313610067999595, 1.109697933227345, 1.0931816981497455, 1.01255980861244, 1.0079221681723418, 1.184953434225844, 1.1818181818181819, 1.0490712503465485, 1.163771712158809, 1.2045454545454546, 1.4705882352941178, 1.034909090909091, 1.0, 1.0353982300884956, 1.1206379113114864, 1.128133704735376, 1.3609022556390977, 1.0121977808288598, 1.077757685352622, 1.030103736769224, 1.0604529469686312, 1.1111111111111112, 1.0372862859221534, 2.5, 1.0299000411749761, 1.019438444924406, 1.0203358973191934, 1.0526315789473684, 1.6666666666666667, 1.173913043478261, 1.0923076923076922, 1.0934501820501237, 1.0, 1.018348623853211, 1.0429864253393666, 1.0032051282051282, 1.0150957204590865, 1.111764705882353, 1.1320754716981132, 1.007125722530561, 1.1068800300629442, 1.0813405405405405, 1.0854700854700854, 1.0, 1.0823389021479715, 1.2378048780487805, 1.1263157894736842, 1.0339511373209773, 1.005004170141785, 1.2225352112676056, 1.3111111111111111, 1.0013717421124828, 1.0622088243354344, 1.2857142857142858, 1.012835906453587, 1.0419847328244274, 1.0526315789473684, 1.1348648204903677, 1.0952380952380953, 1.4, 1.0211585198334707, 2.0, 1.2016460905349795, 1.0276162790697674, 1.0951599671862182, 1.0849405006155108, 1.037940379403794, 1.1097560975609757, 1.1086594786184878, 1.0793797619337406, 1.0485714285714285, 1.0370234946981742, 1.0708485435446622, 2.0, 1.0, 1.062444297173153, 1.25, 1.070949720670391, 1.3529411764705883, 1.0, 1.4666666666666666, 1.3534136546184738, 1.0679245283018868, 1.131578947368421, 1.0119047619047619, 1.0, 1.241011984021305, 1.0874661736730702, 2.0, 1.1923764145324598, 1.0, 1.090594397631519, 1.0348837209302326, 1.0069490316273417, 1.1244239631336406, 1.1363636363636365, 1.4213075060532687, 1.212962962962963, 1.0336375566248266, 1.016916603031731, 1.0162381596752368, 1.0, 1.0769230769230769, 1.5714285714285714, 1.5, 1.1428571428571428, 1.069723562063027, 1.3333333333333333, 1.0016638935108153, 1.10989010989011, 1.2234933035714286, 1.079233042977844, 1.2420185375901134, 1.0578685117838758, 1.0127610208816706, 1.069047619047619, 1.5, 1.3043478260869565, 1.0808510638297872, 1.0498619815132697, 1.1428571428571428, 1.5714285714285714, 1.0089887640449438, 1.0093896713615023, 1.0169591714687694, 1.013664596273292, 1.1464387464387464, 1.0180574555403556, 1.0125, 1.0907770515613653, 1.0381355932203389, 1.1923076923076923, 1.0240793201133145, 1.1941747572815533, 1.0760461137493804, 1.0693272905210178, 1.006255142650837, 1.0886075949367089, 1.018348623853211, 1.108359133126935, 1.0, 1.004896022612558, 1.0429070587481033, 1.0698779487674273, 1.0504557175620597, 1.0636696501220504, 1.1550683190340005, 1.5714285714285714, 1.228080568720379, 1.0, 1.2339880444064901, 1.25, 1.0333413800266102, 1.0147058823529411, 1.0674978503869303, 1.098814229249012, 1.147329650092081, 3.0, 1.1628065395095368, 1.0117703733933103, 1.105067132609895, 2.0, 1.0793650793650793, 1.1813819577735125, 1.2125435540069687, 1.0935498347680632, 1.1496881496881497, 1.2352941176470589, 1.1251078515962036, 1.045651164495711, 1.0645077977550412, 1.1044293031890595, 1.0643640350877193, 1.1061359867330016, 1.003787878787879, 2.142857142857143, 1.0765027322404372, 1.5, 1.2247284878863827, 1.1818181818181819, 1.199740991848861, 1.5625, 1.0877097669926354, 1.063121895890976, 1.0579888957433683, 1.0, 1.1875, 1.16, 1.2869447643847964, 1.1466083150984683, 1.0, 1.0072533849129595, 1.0695646711476852, 1.0489017820140902, 1.5, 2.0, 1.0, 1.0099547511312217, 1.0304054054054055, 1.1111111111111112, 1.0881975539064814, 1.1277955271565496, 1.4705882352941178, 1.087382297551789, 1.0545454545454545, 1.125984251968504, 1.0588709677419355, 1.4501472444257468, 1.1128074097732354, 1.0, 1.0422535211267605, 1.0723849740476818, 1.055245057643824, 1.0325921363975237, 1.0, 1.0931209909312098, 1.0195983149848802, 1.0220010476689365, 2.0, 1.0334928229665072, 1.041302056523764, 1.0227279418258899, 1.0303612773579136, 1.0212483458706716, 1.0324567638000475, 1.0101867572156198, 1.1415139826422371, 2.0, 1.0283735593570726, 1.48, 1.25, 1.1709844559585492, 1.1346153846153846, 1.0264770113026374, 1.1900910010111223, 1.062752069117113, 1.0867370353373107, 1.0908120968335335, 1.047883132693088, 1.0569136701457518, 1.2117647058823529, 4.0, 1.0103661025087025, 1.1208502024291498, 1.045872918098036, 1.0551500561091876, 1.0844748858447488, 1.280557834290402, 2.2717391304347827, 2.4285714285714284, 1.0005112723377318, 1.058883825610286, 1.0081712896102566, 1.1160322108345535, 1.065994986502121, 1.0061855670103093, 1.0627199273530292, 1.0164473684210527, 1.2076923076923076, 3.0, 1.0, 1.0688524590163935, 1.0620300751879699, 1.0604982206405693, 1.14421768707483, 1.0588235294117647, 1.3630136986301369, 1.148905109489051, 1.0705882352941176, 1.0550245414621544, 1.1894736842105262, 1.0039419985159534, 2.0, 1.2083333333333333, 1.0833333333333333, 1.46875, 1.1016759776536313, 1.1012048192771084, 1.134387351778656, 1.1543450064850842, 1.1270138628699888, 1.0, 1.297872340425532, 1.0, 1.5, 1.1818181818181819, 1.1451612903225807, 1.0285714285714285, 1.0825242718446602, 1.0669657161166293, 1.0348027842227379, 1.0753928051723185, 1.1738425925925926, 1.0442890442890442, 1.0871540293851052, 1.0864864864864865, 1.0642317380352644, 1.042573778422835, 1.132361189007291, 1.1604046242774566, 1.1526741293532339, 1.0415547559924998, 1.2074142724745134, 1.080824294498802, 2.0, 1.0638820638820639, 1.0776892430278884, 1.4339622641509433, 1.0, 1.1333333333333333, 1.25, 1.0928433268858802, 1.2962962962962963, 1.1666666666666667, 1.0058990835352364, 1.1170666825481905, 1.034739646654078, 1.010140286672766, 1.2054054054054053, 1.1304945054945055, 1.0, 1.1492537313432836, 1.0261146496815288, 1.0638165059632905, 1.0836559326447357, 1.0748376808292517, 1.0561997205121425, 1.1844155844155844, 1.1730592809401075, 1.0852575488454708, 1.0167948516716372, 1.0867486210207271, 1.303030303030303, 1.0737179487179487, 1.0, 1.2422535211267605, 1.2063553932630369, 3.0, 1.0948660714285714, 1.016207313055891, 1.4285714285714286, 1.0385334829779274, 1.2, 1.1176470588235294, 1.0745487199780828, 1.6923076923076923, 1.0324196608776572, 1.0499786416061512, 1.3571428571428572, 1.0740740740740742, 1.1051546391752578, 1.0157819225251077, 1.021412803532009, 1.1140344989596618, 1.155912092604737, 1.0, 1.0342168151205735, 1.1128048780487805, 2.0, 1.0192125838964874, 1.1182022666320617, 1.1059602649006623, 1.0128689229201822, 1.1149130232939184, 1.0, 1.8571428571428572, 1.026151444184231, 1.025, 1.0880661089712045, 1.1906274821286735, 1.020323075746973, 1.061619693782304, 1.1043956043956045, 1.0891410048622365, 1.1906354515050168, 1.0392340514101364, 1.0567823343848581, 1.0914855072463767, 1.039301310043668, 1.0715164608087164, 3.0, 1.1338208192140777, 1.0171169167306993, 1.0529558830036727, 1.4615384615384615, 1.3411331759477851, 1.4972375690607735, 1.1428571428571428, 1.0890879593708118, 1.0420575865415722, 1.1506550218340612, 1.0294117647058822, 1.3333333333333333, 1.0247736550594133, 1.5, 1.0560747663551402, 1.0833333333333333, 1.012791519434629, 1.3846153846153846, 1.1350210970464134, 1.051362683438155, 1.0, 1.6124338624338623, 1.3001700680272108, 1.25, 2.0, 1.1176470588235294, 1.1482758620689655, 1.0284316722714766, 1.2002518891687657, 1.0756302521008403, 1.2654867256637168, 1.1014466214978942, 1.0545454545454545, 1.1666666666666667, 1.236734693877551, 1.1304347826086956, 1.0, 1.2456140350877194, 1.1082251082251082, 1.024793388429752, 1.1910167818361304, 1.0837876813702547, 1.0573265118719664, 1.0579328847122995, 1.1644375361480626, 1.1509695290858726, 1.0041941282204914, 1.8333333333333333, 1.0, 1.2592592592592593, 1.0236396751916217, 1.0776699029126213, 1.107843137254902, 1.0320197044334976, 1.0297059946544482, 1.0243935864053721, 1.0092237923385299, 1.1142857142857143, 1.2222222222222223, 1.032085561497326, 1.006336290268792, 1.0851830929753439, 1.0094192360545942, 1.0410958904109588, 1.0733165977554637, 1.0200406423924417, 1.0345710627400768, 1.3528513238289206, 1.0, 1.0804878048780489, 1.3831775700934579, 1.1818181818181819, 1.0426136363636365, 1.0701001430615165, 1.0, 1.0682926829268293, 1.0094852497020554, 1.037037037037037, 1.0395163152070945, 1.0350877192982457, 1.2647058823529411, 1.0266683251445985, 1.060201874549387, 1.0503626107977437, 1.0391221374045803, 1.0280046674445742, 1.20037883912867, 1.1764705882352942, 1.0714285714285714, 1.0, 1.4285714285714286, 1.060433571515078, 1.3333333333333333, 1.207132388861749, 1.1106833234613107, 1.0141541226690631, 1.057398212512413, 1.0594198166520157, 1.0770632368703108, 1.03584229390681, 1.0554785020804438, 1.0042209017166572, 1.1699475065616798, 1.045207222734378, 1.175659400216789, 1.4285714285714286, 1.03125, 1.012, 1.1001594509341746, 1.0065573770491802, 1.2729468599033817, 1.0089285714285714, 2.211206896551724, 1.0388462238950946, 1.0456375838926175, 1.0119377990430622, 1.1875, 1.086349516390935, 1.0418578179434996, 1.2983623336745138, 1.0581052631578947, 1.3333333333333333, 1.0163220892274212, 1.1043956043956045, 1.5, 1.1003564268211183, 1.7692307692307692, 1.0685483870967742, 1.1070559610705597, 1.0341701534170153, 1.0152136752136751, 1.0204081632653061, 2.75, 1.041860465116279, 1.1088642964814883, 1.0623756875381967, 1.0202591225197517, 1.0096225140465638, 1.0534495830174375, 1.0, 1.0728196443691786, 1.0926360725720383, 1.0216424547880225, 1.0210420841683367, 1.0, 1.1045987376014428, 1.0218430178465703, 1.4036697247706422, 1.0113757306115327, 1.0, 1.3333333333333333, 1.0761650473435684, 1.0060503728718164, 1.2284029252182118, 1.1428783245297007, 1.0303272146847566, 1.0344827586206897, 1.106721471449271, 1.0990949176142957, 1.099264705882353, 1.010928961748634, 1.0400582665695557, 1.0884258577529082, 1.119047619047619, 1.75, 1.0400778544852356, 1.1734524776604387, 1.0057339449541285, 1.0232558139534884, 1.2465604634322955, 1.0039511619627361, 1.1672757942086027, 1.084010840108401, 1.3076923076923077, 1.1388140161725067, 1.1202830188679245, 1.14375, 1.5357142857142858, 1.02203598167393, 1.2011892963330029, 1.158374792703151, 1.0731707317073171, 1.0140903467415656, 1.006530925854783, 1.0704819277108433, 1.2392552980788274, 1.3333333333333333, 1.0769230769230769, 2.0, 1.1330546847788228, 1.4230769230769231, 1.0, 1.1538461538461537, 1.0609271523178807, 1.0923913043478262, 1.064528543938422, 1.0042839169971176, 1.0581818181818181, 1.2592592592592593, 1.1428571428571428, 1.0, 1.0675675675675675, 1.0142857142857142, 1.130281690140845, 1.0317331136070456, 1.0371860042298986, 1.3473684210526315, 1.073251130123168, 1.0463190030529002, 2.5, 1.0675376816032118, 1.2750455373406193, 3.0, 2.0, 1.2198224852071007, 1.107365703220254, 1.0852936614621032, 1.236024844720497, 1.0, 1.1415929203539823, 1.1687116564417177, 3.0, 2.0, 1.0109452736318407, 1.2266433660438232, 1.0379857553417469, 1.6666666666666667, 1.0302633642171, 1.0441518202943454, 1.076158940397351, 1.1428571428571428, 1.0234741784037558, 1.0232402964797331, 1.0857142857142856, 1.1507465483850816, 1.0187932739861523, 1.3198757763975155, 1.0390625, 1.0992671552298467, 1.0964419475655431, 1.1198347107438016, 1.3269230769230769, 1.065481121783567, 1.4993581514762515, 1.0154609593896635, 1.1843971631205674, 1.1176470588235294, 1.2537313432835822, 1.0867208672086721, 1.0596688534832865, 1.0145416248949377, 1.0965932170913968, 1.084061135371179, 1.5, 1.6666666666666667, 1.1255513648277184, 1.156552330694811, 1.1032872981910133, 1.0137762177685596, 1.040809499916374, 1.1009251119762233, 1.3047337278106508, 1.0208333333333333, 1.0735791211382752, 1.1382959051591297, 1.185883997204752, 1.1797520661157024, 2.5, 1.0416666666666667, 1.0726821973870613, 1.1513067400275103, 1.0248928822664194, 1.1060925467786333, 1.0127840909090908, 1.6, 1.104516129032258, 1.0050987042640684, 1.1814027872972355, 1.0608365019011408, 1.0918502360177371, 1.0031847133757963, 1.2041942604856513, 1.0266666666666666, 1.0333503895717433, 1.061158346662177, 1.044930875576037, 1.0455153949129852, 1.0, 1.1510621557828482, 1.0549410366578298, 1.034153005464481, 1.0746411811050594, 1.0910746812386156, 1.0302571860816945, 1.2, 1.2107969151670952, 1.6666666666666667, 2.0, 1.1176470588235294, 1.0, 1.0260663507109005, 1.006572839689554, 1.008249352083037, 1.0439620081411127, 1.012133891213389, 1.190217391304348, 1.346938775510204, 1.0424321499470388, 1.6, 1.5833333333333333, 1.0016260162601627, 1.1428571428571428, 1.0176151761517616, 1.1443661971830985, 1.1076170510132775, 1.105516871987145, 2.0, 1.0222910216718266, 1.189922480620155, 1.062251655629139, 1.0404460673229539, 1.1515151515151516, 1.1147260273972603, 1.1330450323235444, 1.1085530239770964, 1.011128775834658, 1.0289855072463767, 1.1033519553072626, 1.0, 1.0, 1.041709881620829, 5.0, 1.5714285714285714, 2.347826086956522, 1.066924066924067, 1.1058823529411765, 1.0720620842572062, 1.0898391526088662, 1.0, 1.054003724394786, 1.0169392523364487, 1.1925133689839573, 1.2956730769230769, 1.25, 1.0692507681399197, 1.0582039911308203, 1.162528216704289, 1.0182223875046486, 1.027373377787814, 1.0504565565282877, 1.1514344868382136, 1.0, 1.1833566019376403, 1.0463738811751713, 1.0447453371592539, 1.1774193548387097, 1.0836327657136906]
origin-bjaq_15.71 	max: 5.0000	99th: 2.5025	95th: 1.6679	median: 1.0805	mean: 1.1726

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 14.027024 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[3.5762787e-07 3.1590462e-06 2.9802322e-07 2.3841858e-07 1.1920929e-07]
Distance score: 8.344650268554688e-07
SAUCE Drift detection: False
Detection latency: 0.0231s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.027067 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 7.0000	99th: 3.0000	95th: 2.0000	median: 1.0833	mean: 1.1998
ReportEsts: [1.0326086956521738, 1.0268108108108107, 1.0527792358232728, 1.072041166380789, 1.75, 1.0, 1.1044408673421078, 1.064091896089899, 1.0, 1.004343105320304, 1.1740125792225944, 1.043491656740925, 1.015912305516266, 1.054820415879017, 1.064773735581189, 1.1481481481481481, 1.2277227722772277, 1.1538461538461537, 1.3636363636363635, 1.0585241730279897, 1.069157046395121, 1.0516440244142549, 1.1762820512820513, 1.0272340425531914, 1.0047827819848545, 1.0229692358394589, 2.0, 1.1633132530120482, 2.25, 1.4, 1.0489082969432315, 1.0, 1.046757937019771, 1.0058178408662972, 1.161812297734628, 1.0825159391858754, 1.2330434782608695, 1.1144708423326133, 4.0, 1.1531365313653137, 1.0780293189831138, 1.0585018105009052, 1.2188328912466844, 1.0073004119518172, 1.0017889087656529, 1.071124143339357, 1.1818181818181819, 1.0, 1.0206611570247934, 1.0755735492577598, 1.2, 1.1235059760956174, 1.1228070175438596, 1.0555555555555556, 1.041594926360382, 1.0086246028143442, 1.0419387607023654, 1.2685714285714285, 1.098901098901099, 1.0519270091649322, 1.2727272727272727, 1.0901005777872887, 1.026470588235294, 1.1145038167938932, 1.1057692307692308, 1.4, 1.001213416924277, 1.2607124419204956, 1.6, 1.0, 1.0114630934861746, 1.0069033530571991, 1.0472972972972974, 1.0095419847328244, 1.1323244552058112, 1.105917955615333, 1.031117864693446, 1.0047169811320755, 1.4077669902912622, 1.1047558134222668, 1.1080950072709645, 1.3898305084745763, 2.0, 1.0, 1.071347678369196, 1.4035087719298245, 1.1510791366906474, 1.6666666666666667, 5.0, 1.1370630043799836, 1.116785012841819, 1.0434782608695652, 1.0215204738078218, 1.13629989716743, 1.0432569974554708, 1.0034642032332564, 1.0511811023622046, 1.0832266325224071, 3.0, 1.347548824232762, 1.2, 4.0, 1.0858231590099365, 1.189640410958904, 1.052325581395349, 1.226331948708687, 1.15625, 1.0285795103349293, 1.1034066199565111, 1.206128938999711, 1.066729619137551, 1.0487679671457906, 1.125, 1.4, 1.0363847493710083, 1.04653784290749, 1.023121387283237, 1.1612903225806452, 1.0579138459606792, 2.0, 1.178994472229534, 1.1668219944082012, 1.0, 1.009090909090909, 1.0, 1.2681912681912682, 1.0223397481250884, 1.1013010550844715, 1.1083333333333334, 2.1666666666666665, 1.160220994475138, 2.0, 1.1333333333333333, 1.1475485661424607, 1.3076923076923077, 1.2589285714285714, 1.0540936863543788, 1.1187552381299422, 2.0, 1.4285714285714286, 1.0445859872611465, 1.1094373061586176, 1.0661950480040425, 1.038779778461625, 1.3197278911564625, 1.000544069640914, 1.0965357827184525, 3.0, 1.0235831114492202, 1.0047348484848484, 1.087450312322544, 1.1082925381990802, 2.0, 1.2261820390806926, 1.1115702479338843, 1.0117056856187292, 1.0802919708029197, 1.0, 1.0200823892893924, 1.0806853657946323, 1.1546105445866783, 1.1082024432809774, 1.0054945054945055, 1.2222222222222223, 1.1428571428571428, 1.018773466833542, 1.4444444444444444, 1.0412165021293447, 1.1176470588235294, 1.140518417462483, 1.3268816044856588, 1.0618556701030928, 1.0052710218311613, 1.291005291005291, 1.1311154598825832, 1.1136051675413807, 1.0344827586206897, 1.0007183908045978, 1.0778050778050778, 1.0231898995104354, 1.110933200677787, 1.211401608910891, 1.2407407407407407, 1.8571428571428572, 1.0045338793091496, 1.039584657766476, 1.2226148409893993, 1.6901408450704225, 1.0775, 3.0, 1.2556818181818181, 1.0569602607819168, 1.5238095238095237, 1.1473577235772359, 1.044814865418773, 1.0640893366510893, 1.056829600296993, 1.049856184084372, 1.034110471693473, 1.4431759211209134, 1.007825370675453, 1.0064286213402278, 1.0232001913417843, 1.0543219885397646, 1.0639398213446167, 1.1796696538393956, 1.3364928909952607, 1.0285714285714285, 1.2409638554216869, 1.0, 1.4130434782608696, 1.0757475958371756, 1.3370786516853932, 1.4301075268817205, 1.006568144499179, 1.0434782608695652, 1.0439422969771697, 1.0817757009345794, 1.2124975044919146, 3.0, 1.051129607609988, 1.0018965050121917, 1.0294814424848644, 1.0313887221079363, 1.2, 1.2185185185185186, 1.083503356588127, 1.0141968539407646, 1.032258064516129, 1.0826306913996628, 1.099260172626387, 1.1198798470780993, 1.4137931034482758, 1.0038752351903142, 1.042694514325014, 1.0707692307692307, 1.099809885931559, 1.0055187637969094, 3.0, 1.164828033744322, 2.0, 1.1831845937059653, 1.0857768868584214, 1.1157669070356655, 1.0975609756097562, 1.2142857142857142, 2.0, 1.117886954098024, 1.1029411764705883, 1.0852497096399536, 1.4, 1.0615883306320908, 1.0498409331919407, 1.1428571428571428, 1.0171804259674817, 1.0, 1.062339880444065, 1.1863057324840764, 1.0024484085344525, 1.1303589876033058, 1.0298507462686568, 2.0, 1.0675370065789473, 1.0136596140432457, 1.0841799709724238, 1.0469169145422361, 1.1131286556576072, 1.0299010791366907, 1.0738562091503268, 1.065508356033277, 1.0213505461767627, 1.0198055028462998, 1.0500806018269748, 1.0833333333333333, 1.0000299658389435, 1.245119305856833, 1.2352941176470589, 1.2083333333333333, 1.1565656565656566, 1.0286928799149841, 1.0431534304427186, 1.013108089163045, 1.0502392344497609, 1.3752577319587629, 1.012315115811504, 1.0665732305536089, 1.1369863013698631, 1.0645542058755755, 1.1818181818181819, 1.098550724637681, 1.0393224440411373, 1.045625999577537, 1.1629045260854542, 1.0906091192790492, 1.1846153846153846, 1.1784511784511784, 1.0192498934507743, 1.017782717421506, 1.129053248020822, 1.0898112775607731, 1.0495710200190658, 1.6, 1.25, 1.08002388772768, 1.5714285714285714, 1.0363636363636364, 1.0217841987625926, 1.1020106809735928, 1.4594594594594594, 1.0833333333333333, 1.0923566878980893, 1.0338285305172723, 1.0331477511375569, 1.0476190476190477, 1.1905484247374563, 1.0004947267371953, 1.0724637681159421, 2.0, 1.6153846153846154, 1.0114010085507563, 1.1111111111111112, 1.0032322831876515, 1.0494417862838916, 1.0476190476190477, 1.0923599940677868, 1.0, 1.5833333333333333, 1.005117841304448, 2.0, 1.2081911262798635, 1.0611995104039167, 1.0153310104529616, 1.0313504823151125, 1.0359550561797752, 1.121212121212121, 1.1194873301837744, 1.0570195903407515, 1.170731707317073, 1.020306265276704, 1.0383550096339114, 3.0, 1.1, 1.05654424310593, 1.0, 1.077030162412993, 1.35, 1.8333333333333333, 1.5555555555555556, 1.345731191885038, 1.0718188914910227, 1.1666666666666667, 1.1696428571428572, 1.36, 2.2, 1.133524883443565, 1.7894736842105263, 1.2686567164179106, 1.0071938578528876, 1.0979591836734695, 1.0241509433962264, 1.0301318267419963, 1.75, 1.0, 1.2933333333333332, 1.0625, 1.0117762512266928, 1.1298575397529114, 1.240465577018326, 1.0074257425742574, 1.5, 1.026544085313826, 1.0604395604395604, 1.4642857142857142, 1.6, 1.0662673156121303, 1.0, 1.2521739130434784, 1.1214953271028036, 1.0869086151091523, 1.0539768597924357, 1.0024984384759525, 1.0965874965874967, 1.11004144939163, 1.066427289048474, 1.1101321585903083, 1.1332638954644447, 1.1594454072790294, 1.0857142857142856, 1.0012375360751213, 1.0389585708855948, 1.0922509225092252, 1.0809523809523809, 1.0232558139534884, 1.1721311475409837, 2.0, 1.0625, 1.1120689655172413, 1.2362948960302458, 1.396039603960396, 1.028169014084507, 1.0986842105263157, 1.1894736842105262, 1.0031124807395995, 1.0922201138519925, 1.1243573711268584, 1.04, 1.346938775510204, 1.0913705583756346, 2.0, 1.0881984072239292, 1.6274509803921569, 1.110143665650849, 1.0460276078095665, 1.0952297439494914, 1.139183457051962, 1.375, 1.1764425369575584, 1.0, 1.0547063555913114, 1.1666666666666667, 1.0610169834823735, 1.0109622411693058, 1.0740312833274084, 1.0738255033557047, 1.0875643855776307, 3.0, 1.1662876634451393, 1.015659203182139, 1.0757069309973875, 4.0, 1.0136986301369864, 1.3091787439613527, 1.297872340425532, 1.086007702182285, 1.0851525982952983, 1.0869565217391304, 1.1647807637906649, 1.0366944746705355, 1.0331515637530073, 1.0413552217953197, 1.055113957430778, 1.4190981432360743, 1.125, 1.0428106095858538, 1.068655967903711, 1.0862068965517242, 1.0269832703723691, 1.0, 1.5, 1.1022801302931595, 1.099601593625498, 1.0563430191353649, 1.0918955335129867, 1.0909090909090908, 1.0, 1.1623931623931625, 1.1379310344827587, 1.1399178632208624, 1.2173913043478262, 1.0, 1.0275797293258764, 1.0, 1.0, 1.0138036809815951, 2.3333333333333335, 1.0038597619813445, 1.0135338345864662, 1.010989010989011, 1.2, 1.0789980589429389, 1.0767218831734962, 1.5, 1.017432547036467, 1.0454545454545454, 1.1626637554585153, 1.056970509383378, 1.3084507042253521, 1.0342057272413623, 1.0, 1.0705882352941176, 1.0294610778443114, 1.1198195187165776, 1.0580286168521462, 1.4, 1.0946395563770794, 1.0029359213950142, 1.0138588133391078, 1.0, 1.0397328881469114, 1.0494276260353084, 1.0192929267620456, 1.0019279036775672, 1.0087607407705212, 1.0851119549561346, 1.0091228070175438, 1.0205543914823407, 2.3333333333333335, 1.1459175772175858, 1.157957244655582, 1.0522058823529412, 1.0493348115299335, 1.0108108108108107, 1.0010735056037687, 1.092756183745583, 1.0413410758238344, 1.0717230008244023, 1.0676723276723277, 1.2216494845360826, 1.0913762566418042, 1.0655626646593903, 1.0459770114942528, 1.24, 1.12327880913571, 1.0905349794238683, 1.0255088623573345, 1.067629422346592, 1.0, 1.2482941622441244, 1.2642045454545454, 3.0, 1.0961538461538463, 1.0166700266437099, 1.1309090909090909, 1.0183654729109275, 1.0, 1.0609756097560976, 1.0095912308746289, 1.1451176099879068, 1.0482219326010054, 1.0109287502258006, 1.1205813040062844, 1.0177133655394526, 1.013347022587269, 1.0164534093793391, 1.5862068965517242, 1.0381946600434648, 1.1219187208527648, 1.08, 1.0148128780258745, 1.0666666666666667, 1.0165434477013588, 2.0, 1.1444969615124916, 1.0996677740863787, 1.1892017686758203, 1.0638766519823788, 1.0644850818094322, 1.0101522842639594, 1.46, 1.1070974808324205, 2.0, 1.0793650793650793, 1.1666666666666667, 1.0, 1.169811320754717, 1.0279329608938548, 1.0411311053984575, 1.1193415637860082, 1.0709599678671844, 1.0002439024390244, 1.0618881648734657, 1.180040654341303, 1.0712055610724927, 1.15612299240407, 1.015521150356899, 1.1049180327868853, 1.0778156996587032, 1.0495830022586075, 1.070662768031189, 1.0591397849462365, 1.208, 1.0862068965517242, 1.0678545571554983, 1.1274175199089875, 1.1025251528901163, 1.3255813953488371, 1.1383209044984364, 1.0917992656058753, 2.0, 1.0482921083627796, 1.0, 2.0, 1.4871794871794872, 1.0399362760335717, 1.0518885921404044, 1.0469973890339426, 1.1049723756906078, 1.0822871430451375, 1.0284908829174664, 1.1143375680580763, 1.2, 1.8333333333333333, 1.1171888935132885, 1.0407239819004526, 1.0632299637535239, 1.110304449648712, 1.0, 1.428759894459103, 1.1207627118644068, 1.0654188624386698, 1.1099706744868034, 1.01436381380101, 1.046924718073758, 1.015165690988919, 1.3563218390804597, 2.5, 1.1767739163130473, 2.0, 1.0184331797235022, 1.2813852813852813, 1.3882099209202012, 1.0984528832630098, 1.6, 1.1555367709213864, 1.0555555555555556, 1.8279569892473118, 1.1093167701863353, 1.225974025974026, 1.0070838252656436, 1.0194898251648037, 1.0054397098821397, 1.0635416666666666, 1.1666666666666667, 1.0073498449642078, 1.0585524069648344, 1.2222222222222223, 1.001367053998633, 1.2360136354521756, 1.3846153846153846, 1.0156921301173474, 1.7777777777777777, 1.1699819168173597, 1.0011828486939378, 1.3396226415094339, 1.0294117647058822, 1.0711449016100179, 1.0227272727272727, 1.5, 1.0391061452513966, 1.019674355495251, 1.1163601326267465, 1.209263015551048, 1.0012012358314233, 1.060957910014514, 1.125, 1.1078331637843337, 1.2714285714285714, 1.0811919314483982, 1.0845219228737453, 1.0808407437348424, 1.107108549471662, 1.0309698451507743, 1.1032388663967612, 1.054208974778906, 1.2105263157894737, 1.3333333333333333, 1.0331695331695332, 1.592336502448862, 1.076347771891555, 1.08203125, 1.0714285714285714, 1.0023866348448687, 1.0197841726618706, 1.1696969696969697, 1.0700137268359644, 2.3333333333333335, 1.1855603794822318, 2.5, 1.0740740740740742, 1.1333333333333333, 1.054492669473073, 1.4193548387096775, 1.2408759124087592, 1.048780487804878, 2.0, 1.0088781275221954, 1.2167553191489362, 1.2, 1.3333333333333333, 1.06993006993007, 1.2781065088757397, 1.0223690899847484, 1.2118644067796611, 1.0830985915492957, 1.1947712418300653, 1.1291989664082687, 1.0213776722090262, 1.1647058823529413, 1.2197452229299364, 1.1379310344827587, 1.5, 1.2260778128286014, 1.071680376028202, 1.0070175438596491, 1.0702361387423234, 1.082439801643853, 1.0330070729442022, 1.0971634404483135, 1.1568015985951738, 1.1619718309859155, 1.0319634703196348, 1.5555555555555556, 1.0, 1.2727272727272727, 1.0361570770709985, 1.0519765739385065, 1.088235294117647, 1.1131639722863742, 1.0523797371443153, 1.0410741397494292, 1.008591364577143, 1.0823529411764705, 1.2380952380952381, 1.173027989821883, 1.0147115756871854, 1.0618756260660043, 1.0094334381493129, 1.0159574468085106, 1.0715299635869902, 1.0009850194951775, 1.0682283335913179, 1.0119047619047619, 1.0880225457961483, 1.0094043887147335, 1.0708316752884999, 1.087686567164179, 1.0324473948806163, 1.1, 1.1650772025431426, 1.0, 1.0704225352112675, 1.0192307692307692, 1.0666666666666667, 1.0762071164731206, 1.0324616771866546, 1.0888888888888888, 1.0370665186379966, 1.0155241269555295, 1.0958300813914594, 1.0480384307445956, 1.0377002827521207, 1.1954339696910057, 1.1349072512647556, 1.4666666666666666, 1.0, 1.5, 1.0735961429381735, 1.6666666666666667, 1.0967102032799765, 1.1117928662935743, 1.006255749770009, 1.0480721081622433, 1.1893538847566987, 1.0597268101062405, 1.0028818443804035, 1.037122969837587, 1.00261983386802, 1.1195490487747592, 1.0430790372282834, 1.2060627387894631, 1.5, 1.1551020408163266, 1.064406779661017, 1.0934518647007805, 1.0027322404371584, 1.2872727272727273, 1.0510046367851622, 2.1879432624113475, 1.0785721780645838, 1.0261723009814614, 1.0693710754510117, 1.1578947368421053, 1.0534373619902841, 1.044245620983276, 1.2740008240626288, 1.0680127523910734, 1.1714285714285715, 1.0290722530996153, 1.0869744213936672, 1.057791773401426, 1.4615384615384615, 1.0201452416816685, 1.0512820512820513, 1.0856022150438394, 1.0417986067131095, 1.0125786163522013, 1.06, 1.0508166969147006, 1.0390625, 1.0763131813676907, 1.0044798134519604, 1.0682036503362151, 1.0108449734408813, 1.1000494663628733, 1.0714285714285714, 1.0827933765298776, 1.1613811221617565, 1.0385996409335727, 1.0822510822510822, 1.0041928721174005, 1.0078354554358473, 1.145478374836173, 1.0245795601552394, 1.0264227743663672, 1.625, 1.1069549970777324, 1.2265522060291476, 1.062883435582822, 1.0655737704918034, 1.1300780421097305, 1.0934888902642816, 1.0642570281124497, 1.047337278106509, 1.0946504085067947, 1.0487412255238295, 1.1118012422360248, 1.018181818181818, 1.0178784266984506, 1.1143462203443584, 1.11, 1.4, 1.0292494041131697, 1.1665343256665277, 1.004259346900142, 1.0046296296296295, 1.2377684964200477, 1.0267848122329393, 1.1924253116913668, 1.0136807817589577, 1.4285714285714286, 1.0677871148459384, 3.0, 1.101010101010101, 1.3888888888888888, 1.0493283151049915, 1.1951827242524917, 1.1483870967741936, 1.04, 1.14375, 1.1936758893280632, 1.0396039603960396, 1.0303030303030303, 1.0157575757575759, 1.032520325203252, 1.0990853658536586, 1.0, 1.0211608924743671, 1.1071428571428572, 1.0297536029753602, 1.226890756302521, 1.0, 1.4088235294117648, 1.0185252823352375, 1.0555555555555556, 1.0464767616191903, 1.28125, 1.2941176470588236, 1.0833333333333333, 1.032967032967033, 1.0963855421686748, 1.085692995529061, 1.0304321157860974, 1.031280737895069, 1.2758620689655173, 1.0918440646272078, 1.0477958972475838, 4.5, 1.0205336921915515, 1.0555398928672117, 3.0, 2.0, 1.1978239366963404, 1.1048107914527874, 1.0365248883675946, 1.2670157068062826, 1.0, 1.095890410958904, 1.2411167512690355, 1.1133004926108374, 1.1154301738100418, 1.1019267822736032, 1.0455924584208551, 1.0035538831399602, 2.1666666666666665, 1.0265224599263312, 1.057516339869281, 1.0025553662691653, 1.0146799765120376, 1.044311377245509, 1.0, 1.1764705882352942, 1.1783924954695661, 1.021925566343042, 1.5333333333333334, 1.0838709677419356, 1.1480024812258312, 1.0952012383900929, 1.030716723549488, 1.1111111111111112, 1.030916195077222, 1.4716726618705036, 1.043105189745563, 1.415, 1.188976377952756, 1.2926829268292683, 1.25, 1.0975232198142415, 1.068421052631579, 1.0125399193598106, 1.0054249547920433, 1.5, 1.0196078431372548, 1.017478813559322, 1.1430662275887304, 1.1416086745428062, 1.0289603821298117, 1.108734897930843, 1.0932982006032659, 1.0693877551020408, 1.0714285714285714, 1.0868123293015997, 1.084931318799173, 1.241484184914842, 1.2456140350877194, 2.0, 1.1046511627906976, 1.2336615935541628, 1.0741885625965997, 1.0610638620480517, 1.0864721145072993, 1.0188679245283019, 1.8, 1.1088362068965518, 1.0205464982778416, 1.198464491362764, 1.2805280528052805, 1.0843859204358481, 1.0077922077922077, 1.3890977443609023, 1.0067372473532243, 1.0319110965923184, 1.065661567576092, 1.018216682646213, 1.0535117056856187, 1.0526315789473684, 1.1428224041501176, 1.0667472829332378, 1.0087901455978479, 1.0182665195537575, 1.108639420589757, 1.051007556675063, 1.2156862745098038, 1.2693156732891833, 2.0, 2.0, 1.263157894736842, 1.0021231422505308, 1.036255767963085, 1.0018871426803613, 1.0023983977420137, 1.1106325096350034, 1.02826916406521, 1.219626168224299, 1.0799112097669257, 1.0668293082467473, 1.6666666666666667, 1.375, 1.1990212071778141, 1.0, 1.0340909090909092, 1.1289269685842513, 1.1554767652383826, 1.1117072807213653, 2.0, 1.0911208904996117, 1.2551020408163265, 1.1257940583514017, 1.0411031729033442, 1.1195876288659794, 1.1350042722870977, 1.141211604095563, 1.1874499759884745, 1.0080213903743316, 1.3384615384615384, 1.0266512166859791, 1.6666666666666667, 3.0, 1.0420165248599635, 7.0, 1.4444444444444444, 1.6756756756756757, 1.0286320254506893, 1.04720317483175, 1.02116704805492, 1.0198412698412698, 1.0, 1.346563981042654, 1.0165048543689321, 1.030674846625767, 1.2808764940239044]
origin-bjaq_15.71 	max: 7.0000	99th: 3.0000	95th: 2.0000	median: 1.0833	mean: 1.1998

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.139544 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.220774