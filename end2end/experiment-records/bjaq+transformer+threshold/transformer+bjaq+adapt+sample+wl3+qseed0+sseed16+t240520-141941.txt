Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 16, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.5757	95th: 1.7500	median: 1.0771	mean: 1.1727
ReportEsts: [1.0128617363344052, 1.0158854166666667, 1.048334129016391, 1.0176125244618395, 1.5789473684210527, 1.0, 1.0396409872849663, 1.0943572578553566, 1.0, 1.02365308804205, 1.1699708538943236, 1.042844905320108, 1.005879882402352, 1.1395348837209303, 1.0607559166372307, 1.0, 1.0112359550561798, 1.0024796315975912, 3.0, 2.0, 1.08, 1.071940450321328, 1.1618337475835405, 1.1467997651203758, 1.0794277257030094, 1.0, 1.1591155822537453, 1.5, 1.2, 1.0287769784172662, 1.0, 1.05097556532133, 1.0086855961812904, 1.1681465038845726, 1.0928183286826259, 1.2314810955021052, 1.1363636363636365, 1.010814286836318, 1.154211722570425, 1.0952380952380953, 1.0512129380053907, 1.048780487804878, 1.0, 1.0577161039420186, 1.1329954561342188, 1.8059701492537314, 1.0618556701030928, 1.2720848056537102, 1.0365724740800977, 1.0833333333333333, 1.0554941073267479, 1.006872852233677, 1.0373910714653591, 2.0, 1.2103896103896103, 1.2186915887850467, 1.1420265780730896, 1.3658536585365855, 1.0662251655629138, 1.25, 1.0924663758633224, 1.1052303860523038, 1.0727272727272728, 1.0, 1.0909090909090908, 1.0623644052215482, 1.3285528031290743, 1.75, 1.0, 1.053416612286753, 1.0023923444976077, 1.0633720930232557, 1.018348623853211, 1.1178941339315547, 1.0823529411764705, 1.0887096774193548, 1.0, 1.1135699373695198, 2.0, 1.010688972423886, 1.125, 1.02783498519758, 1.147239263803681, 1.1237113402061856, 1.1030421982335623, 1.0, 1.0769979179233717, 1.0038360921131353, 1.1029411764705883, 1.75, 1.1651090342679127, 1.0369329043414839, 1.0404984423676011, 1.0476858345021038, 1.0291353383458646, 1.0103896103896104, 1.0714285714285714, 1.155818540433925, 1.0, 1.2499442337720277, 1.065020702346266, 1.0660377358490567, 1.2233541981437515, 1.4166666666666667, 1.0139960343521885, 1.064242102468808, 1.082944392585678, 1.1835419036784225, 1.0508890251379521, 1.3333333333333333, 1.6666666666666667, 1.0427570093457943, 1.0458070343272174, 1.027163613392293, 1.12987012987013, 1.0604967191848969, 1.0, 1.0346893724377169, 1.1483516483516483, 1.0, 1.0224719101123596, 1.1666666666666667, 1.200501253132832, 1.0352449709416462, 1.061970955968005, 1.12, 1.8, 1.1821192052980132, 1.0, 1.0357142857142858, 1.1013280714848024, 1.1818181818181819, 1.0192057291666667, 1.0343660308867215, 1.1310124900345468, 1.0106809078771695, 1.0054794520547945, 1.0518316445830085, 1.039972432804962, 1.0749542961608776, 1.0146219097600422, 1.296, 1.0300065231572082, 1.1382969660829245, 2.0, 1.0168641750227894, 1.0045924225028702, 1.1025991792065664, 1.09617081348156, 1.5, 1.304916444659724, 1.0258358662613982, 1.002004008016032, 1.1074561403508771, 1.0802919708029197, 1.0714767363452462, 1.1078376712931717, 1.0999900803491718, 1.0154440154440154, 1.0657894736842106, 1.2857142857142858, 1.38, 1.0456553755522828, 1.4285714285714286, 1.0646994327120178, 1.0408237958352713, 1.1360366252452583, 1.37465645857872, 1.112092391304348, 1.0887864090535633, 1.3094736842105263, 1.1147540983606556, 1.061198799264065, 1.1759352881698686, 1.0534943917169974, 1.055393586005831, 1.0641314856590396, 1.08162923231646, 1.0916725642840293, 1.0, 1.0714285714285714, 1.0375388089189952, 1.0283094098883572, 1.1354757403906743, 1.2236842105263157, 1.0917632823400132, 1.3180857197770517, 1.0906218210938683, 1.1372549019607843, 1.0313636363636363, 1.085300742990131, 1.0, 1.0909090909090908, 1.0720713449820427, 1.0256111757857975, 1.032857142857143, 1.4, 1.0533762057877814, 1.0496821963137855, 1.0435854493740762, 1.0626410835214446, 1.0621903657636766, 1.11864406779661, 1.103448275862069, 1.2173913043478262, 1.0, 1.3675213675213675, 1.151316826998896, 1.3344947735191637, 1.2528735632183907, 1.0108749382105784, 1.0031277926720286, 1.039186013388406, 1.0372045277993562, 1.1061063218390805, 1.1761363636363635, 1.0086705202312138, 1.0235489220563847, 1.0569676604055374, 1.0066249455562433, 1.0, 1.0401656314699792, 1.1334173674984735, 1.0114949645677702, 1.1330108827085852, 1.0208995674154375, 1.2766049349387183, 1.0357142857142858, 1.0047418512591595, 1.2502578648788034, 1.031413612565445, 1.0971428571428572, 1.0250903678503083, 1.0433268858800773, 1.1433070866141732, 2.0, 1.1785018100807574, 1.0769874944171505, 1.073370839193624, 1.1551724137931034, 1.0, 1.6666666666666667, 1.088584442763933, 1.1090909090909091, 1.0517543859649123, 1.5, 1.0, 1.025, 1.0308352849336455, 1.0425531914893618, 1.0276243093922652, 1.0812236286919832, 1.0559322033898304, 1.0079764903442485, 1.0848415632682293, 1.0, 2.0, 1.107879423436761, 1.0121449156031288, 1.1330998248686515, 1.0136031359254158, 1.1195973612374885, 1.0026805242645003, 1.0771065182829889, 1.0817386405647589, 1.0316985645933014, 1.053132318501171, 1.0711040157190226, 1.1818181818181819, 1.015120476051117, 1.1193317422434368, 1.2045454545454546, 1.3888888888888888, 1.058914131690412, 1.1111111111111112, 1.0256410256410255, 1.1422111567189288, 1.0945121951219512, 1.3759398496240602, 1.0322524428205713, 1.0109060402684564, 1.037417122102486, 1.0501771943119511, 1.1111111111111112, 1.0082939250636596, 2.5, 1.039782035445522, 1.0107991360691144, 1.0652496472623003, 1.0810810810810811, 2.0, 1.5217391304347827, 1.0923076923076922, 1.0597716545067004, 1.0, 1.0611620795107033, 1.0384615384615385, 1.0052083333333333, 1.0166552437154408, 1.1385542168674698, 1.1572327044025157, 1.0160710518914358, 1.0943034055727554, 1.0413959686823255, 1.1452991452991452, 1.0, 1.10381861575179, 1.2848101265822784, 1.1030927835051547, 1.1377000842459983, 1.0088346655448044, 1.1525974025974026, 1.18, 1.0013717421124828, 1.013157894736842, 1.2857142857142858, 1.0151163422644234, 1.0321361058601135, 1.0526315789473684, 1.0729257880910683, 1.2857142857142858, 1.4, 1.0003974613215165, 2.0, 1.1618655692729767, 1.0537790697674418, 1.0746513535684987, 1.1450844521437853, 1.0132275132275133, 1.123456790123457, 1.0994872766135906, 1.1002409873177381, 1.050071530758226, 1.034446197431591, 1.0637951450562464, 2.0, 1.0, 1.0458877031010763, 1.25, 1.0715483510340973, 1.3529411764705883, 1.0, 1.375, 1.3825301204819278, 1.0709555345316935, 1.34375, 1.0411255411255411, 1.0, 1.215046604527297, 1.0383090304425684, 2.0, 1.0169594185342217, 1.0, 1.095953844985956, 1.0470588235294118, 1.023196011545526, 1.1497695852534562, 1.1363636363636365, 1.3295583238958097, 1.1851851851851851, 1.033467033415135, 1.0207042983923837, 1.0474198047419805, 1.0, 1.0769230769230769, 1.5714285714285714, 1.5, 1.1428571428571428, 1.069657509810917, 1.3333333333333333, 1.1131447587354408, 1.1744186046511629, 1.1921159945627549, 1.0738095860908385, 1.2492276004119465, 1.0012634015019128, 1.015661252900232, 1.0714285714285714, 1.5, 1.1483253588516746, 1.0340425531914894, 1.0465251443876784, 1.0952380952380953, 1.5714285714285714, 1.0369515011547343, 1.0129564193168434, 1.0248416696277407, 1.0061652281134401, 1.1464387464387464, 1.0347469220246237, 1.0256410256410255, 1.0907770515613653, 1.0932203389830508, 1.2307692307692308, 1.0240793201133145, 1.2424242424242424, 1.0636814819498008, 1.0729900980839149, 1.022978105928044, 1.2112676056338028, 1.2906976744186047, 1.1049382716049383, 1.0, 1.0171924894622557, 1.0657396184798156, 1.0597806608845244, 1.058357990802467, 1.0338078291814947, 1.142675564029234, 1.8333333333333333, 1.0385771543086173, 1.0, 1.2049530315969257, 1.25, 1.028186794771534, 1.0159420289855072, 1.0827601031814273, 1.150197628458498, 1.1174887892376681, 3.0, 1.2672605790645879, 1.0156722141622851, 1.1646818098215928, 2.0, 1.05, 1.2044145873320538, 1.2936802973977695, 1.0873392560139548, 1.0083857442348008, 1.1666666666666667, 1.0603968938740294, 1.0269783740969205, 1.0542864451134328, 1.0846721460141089, 1.0692982456140352, 1.1708126036484245, 1.0946969696969697, 2.142857142857143, 1.047872340425532, 1.5, 1.2247284878863827, 1.0303030303030303, 1.1441336723574282, 2.272727272727273, 1.0843061740281623, 1.1322071181838491, 1.1030228254164096, 1.0, 1.14, 1.12, 1.2858500950665466, 1.288840262582057, 1.0, 1.026302729528536, 1.0873930259292375, 1.0729382511396601, 1.0, 2.0, 1.0023300970873787, 1.0099547511312217, 1.0360655737704918, 1.2222222222222223, 1.0833177006565724, 1.0526838966202783, 1.4705882352941178, 1.05909604519774, 1.0454545454545454, 1.152230971128609, 1.007311129163282, 1.2789230122002524, 1.0341327318057698, 1.0, 1.0422535211267605, 1.0809818562332618, 1.0364048689408691, 1.013848821756183, 1.0, 1.0758681707586817, 1.0005942863146697, 1.0220010476689365, 1.0, 1.0358851674641147, 1.0457493815156251, 1.026614066594047, 1.0576645843344545, 1.0151760608454983, 1.0231224828239753, 1.0235294117647058, 1.099324975891996, 2.0, 1.0791255362034213, 1.7619047619047619, 1.0, 1.160621761658031, 1.1538461538461537, 1.0214883472810323, 1.1900910010111223, 1.073685417741843, 1.0927030748049564, 1.0372102243574794, 1.05910996888949, 1.0557173734641747, 1.1704545454545454, 4.0, 1.0092994630638314, 1.1848178137651821, 1.0486305762744073, 1.0474338439109543, 1.0806697108066972, 1.136098981077147, 2.111111111111111, 2.5714285714285716, 1.0129035399522812, 1.0679754437177587, 1.0089553066430077, 1.1566767830045523, 1.0851571538758196, 1.027542372881356, 1.0759153141764655, 1.0294280955024986, 1.2246489859594383, 3.0, 1.0909090909090908, 1.0061349693251533, 1.0680529300567108, 1.058614564831261, 1.0823680823680824, 1.0490196078431373, 1.267515923566879, 1.148905109489051, 1.1097560975609757, 1.0417159420289854, 1.2696629213483146, 1.0170457170133809, 2.0, 1.095200629425649, 1.0476190476190477, 1.396039603960396, 1.0874301675977653, 1.0791027154663517, 1.0138339920948616, 1.1014285714285714, 1.0633000883726802, 1.0, 1.2340425531914894, 1.5, 1.5, 1.1818181818181819, 1.0866935483870968, 1.0138888888888888, 1.1067961165048543, 1.0611983338673503, 1.054524361948956, 1.0273637531455118, 1.1689718764407562, 1.0459143968871596, 1.076005883518845, 1.145945945945946, 1.1162483487450463, 1.019351717464925, 1.055686274509804, 1.2095375722543353, 1.1003265063817156, 1.018395581006436, 1.211230940870212, 1.0818157139990794, 3.0, 1.2604422604422605, 1.0755467196819086, 1.4339622641509433, 1.0, 1.1590909090909092, 1.3636363636363635, 1.0600375234521575, 1.2592592592592593, 1.0, 1.0175974930923093, 1.1351623966108533, 1.0203186838769756, 1.0211175337186897, 1.2054054054054053, 1.095872170439414, 2.0, 1.1407407407407408, 1.0226407109606432, 1.0583446224134725, 1.0856536635419747, 1.0363367126096366, 1.0256363236264945, 1.1844155844155844, 1.1337823002871137, 1.1136767317939609, 1.0126353790613718, 1.138010881228939, 1.303030303030303, 1.0534591194968554, 1.0, 1.2422535211267605, 1.2093324558877967, 3.0, 1.1037353735373536, 1.0661244614427574, 1.2857142857142858, 1.0085374639769453, 1.5, 1.1176470588235294, 1.0748759172984987, 1.6153846153846154, 1.0024472686301353, 1.0521144809910294, 1.3103448275862069, 1.0740740740740742, 1.043298969072165, 1.003347680535629, 1.0472406181015452, 1.0665381526104418, 1.1577484151836859, 1.0, 1.063545513795351, 1.1128048780487805, 2.0, 1.0394620124187863, 1.1485336101738906, 1.1258278145695364, 1.021595720971696, 1.042183052751152, 1.036697247706422, 1.5714285714285714, 1.1064814814814814, 1.0201612903225807, 1.1486264062579539, 1.1854487939897194, 1.0201891544530832, 1.0962119840064644, 1.3003663003663004, 1.1676802780191138, 1.2006688963210703, 1.0559125888503789, 1.090851735015773, 1.03954802259887, 1.0830489192263937, 1.0756081463322646, 3.0, 1.1362356831146394, 1.038140446829369, 1.0158921595833244, 1.4615384615384615, 1.3147479516733787, 1.622754491017964, 1.1428571428571428, 1.0313888692953375, 1.0420575865415722, 1.1168122270742358, 1.1176470588235294, 1.3333333333333333, 1.0369060945714246, 1.5, 1.1425233644859814, 1.0, 1.0516014234875444, 1.44, 1.1181434599156117, 1.0534591194968554, 1.0, 1.537037037037037, 1.2957627118644068, 1.25, 2.0, 1.1271186440677967, 1.2275862068965517, 1.0440720049658596, 1.185323383084577, 1.103448275862069, 1.2123893805309736, 1.1014466214978942, 1.0649350649350648, 1.1722488038277512, 1.3551020408163266, 1.0, 1.0, 1.136, 1.0923520923520924, 1.0361570247933884, 1.0919787306256363, 1.0634736410918435, 1.0654329147389292, 1.099131414342039, 1.2655798149219202, 1.1654978962131837, 1.0017931858936042, 1.8333333333333333, 1.0, 1.2142857142857142, 1.0104727935038325, 1.0732568402471314, 1.107843137254902, 1.0769230769230769, 1.036807941962581, 1.0296285072797147, 1.0060141198407684, 1.0985915492957747, 1.2222222222222223, 1.0281582952815829, 1.0638918345705197, 1.0617735511663822, 1.0240241459585295, 1.0394736842105263, 1.1248523331364442, 1.0075256668840327, 1.3535528596187174, 1.3391038696537678, 1.0, 1.0794346978557505, 1.793939393939394, 1.1063829787234043, 1.0515759312320916, 1.0701001430615165, 1.0, 1.0922693266832917, 1.0264949035492545, 1.125, 1.0660807680366824, 1.048888888888889, 1.2647058823529411, 1.0585994613312812, 1.03168709444845, 1.0883360193392426, 1.0458015267175573, 1.0124858115777526, 1.2059673089339722, 1.2641083521444696, 1.2857142857142858, 1.0, 1.4285714285714286, 1.058350490492915, 1.3333333333333333, 1.3233561440047605, 1.1132949221905122, 1.0057598582188747, 1.0808341608738827, 1.0497070929786927, 1.0258306538049304, 1.010752688172043, 1.0069348127600555, 1.0059313875126212, 1.119820959880015, 1.045521520357637, 1.1919788028423461, 1.6666666666666667, 1.03125, 1.0395256916996047, 1.1084959617317758, 1.022801302931596, 1.2909635274904736, 1.044362292051756, 2.1923076923076925, 1.0179580606781677, 1.0590604026845638, 1.073397129186603, 1.25, 1.0543736615442543, 1.0464147446279632, 1.3523454157782515, 1.0581052631578947, 1.0, 1.0674285714285714, 1.1355932203389831, 1.75, 1.0861215963645692, 1.6153846153846154, 1.1272727272727272, 1.0532407407407407, 1.0175320296695887, 1.0025320729237002, 1.0131108462455305, 3.727272727272727, 1.0980392156862746, 1.10243023640575, 1.0403522417912106, 1.0129997073820656, 1.0178740510639712, 1.082212997955517, 1.0833333333333333, 1.0810580204778157, 1.0613725896744766, 1.0271887137818652, 1.0370741482965933, 1.0277777777777777, 1.0174311926605504, 1.0031294933603991, 1.3421052631578947, 1.0503793571088222, 1.0, 1.3333333333333333, 1.033988479319637, 1.0036583649922612, 1.2052587723358947, 1.0900750625521267, 1.054269752593775, 1.079136690647482, 1.0993583109087146, 1.068798762009156, 1.1433823529411764, 1.0393258426966292, 1.0063424947145878, 1.0877141314484857, 1.0714285714285714, 1.75, 1.065009854983098, 1.1710362047440699, 1.011534025374856, 1.0, 1.1965966690803764, 1.0096319229446165, 1.1776778183862806, 1.2422360248447204, 1.2692307692307692, 1.0471698113207548, 1.1529126213592233, 1.128125, 1.5925925925925926, 1.0683651804670913, 1.2011892963330029, 1.165837479270315, 1.0975609756097562, 1.0033169492092153, 1.0728006146753746, 1.0693440428380188, 1.1827094474153297, 1.3333333333333333, 1.1071428571428572, 2.0, 1.1417624521072798, 1.1923076923076923, 1.25, 1.1538461538461537, 1.023841059602649, 1.0579710144927537, 1.040967741935484, 1.0419307735705041, 1.1327272727272728, 1.3333333333333333, 1.0666666666666667, 1.064516129032258, 1.1216216216216217, 1.1, 1.148479427549195, 1.0246314069011164, 1.0325627991540203, 1.3473684210526315, 1.0708985590502178, 1.047405034783044, 2.5, 1.0692644006668708, 1.338432122370937, 1.5, 2.0, 1.1955621301775148, 1.070716488560568, 1.0732801595214356, 1.186335403726708, 1.0, 1.0038910505836576, 1.2546012269938651, 3.0, 1.5, 1.0613737268216243, 1.3110633149616884, 1.0455970734256599, 1.6666666666666667, 1.0153732446415373, 1.0426026336173508, 1.0372340425531914, 1.0, 1.0046948356807512, 1.023627574104977, 1.25, 1.192001553096486, 1.0176683927774868, 1.2463343108504399, 1.1328125, 1.1053593179049939, 1.069406392694064, 1.037190082644628, 1.2105263157894737, 1.0287254025411563, 1.2780991089573237, 1.0822320293574461, 1.8682634730538923, 1.0980392156862746, 1.3134328358208955, 1.076510067114094, 1.062323833385531, 1.0134025206853998, 1.0744817014753785, 1.074235807860262, 1.5, 1.6666666666666667, 1.0890174518954165, 1.1701846965699207, 1.1499708227971213, 1.0146598593537144, 1.075765178123432, 1.1183399243100736, 1.0862068965517242, 1.0, 1.0381259334957944, 1.08957079164184, 1.2826908541194255, 1.159369527145359, 1.6666666666666667, 1.0714285714285714, 1.0673061863743147, 1.1631461923290718, 1.0092732539832483, 1.0840333982173957, 1.0092329545454546, 2.0, 1.0726817042606516, 1.0133316943432493, 1.1649531642677633, 1.1368821292775666, 1.0805678729795452, 1.0, 1.161147902869757, 1.0092753623188406, 1.0331108764366252, 1.0548446838959509, 1.0506912442396312, 1.0483221476510067, 1.0, 1.1222552497842555, 1.0568836273882438, 1.0707213578500707, 1.027917651491796, 1.1017780502759043, 1.018910741301059, 1.2, 1.2233766233766235, 1.6666666666666667, 2.0, 1.2352941176470589, 1.0076726342710998, 1.0387045813586098, 1.0146571213262998, 1.0145160600487575, 1.0607369027058147, 1.009623430962343, 1.173913043478261, 1.1395348837209303, 1.050036125900517, 1.6, 1.4166666666666667, 1.1845146379044684, 1.1428571428571428, 1.007989347536618, 1.1484098939929328, 1.0484903109508787, 1.0950966548181331, 2.0, 1.061609907120743, 1.2732558139534884, 1.018542037084074, 1.0411341596557704, 1.1957070707070707, 1.1277397260273974, 1.1380418402623882, 1.1211243817107008, 1.0112540192926045, 1.0422535211267605, 1.1103351955307263, 1.0, 1.0, 1.041370122670863, 5.0, 1.4285714285714286, 1.8620689655172413, 1.0615199034981906, 1.119047619047619, 1.1042128603104213, 1.1086700666928206, 1.0, 1.1210428305400373, 1.0169392523364487, 1.1262626262626263, 1.28125, 1.4285714285714286, 1.016857720836143, 1.0493348115299335, 1.1419068736141906, 1.048716995165489, 1.0147701330394394, 1.1637292731254563, 1.09346347234546, 1.0, 1.2237593603249144, 1.0358671707144607, 1.050349713055954, 1.1774193548387097, 1.0841408773575076]
origin-bjaq_15.71 	max: 5.0000	99th: 2.5757	95th: 1.7500	median: 1.0771	mean: 1.1727

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 14.049377 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[5.9604645e-07 1.3709068e-06 4.1723251e-07 1.7881393e-07 1.1920929e-07]
Distance score: 5.364418029785156e-07
SAUCE Drift detection: False
Detection latency: 0.0234s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.018974 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 6.0000	99th: 3.0000	95th: 1.7152	median: 1.0814	mean: 1.1783
ReportEsts: [1.029023746701847, 1.0198170731707317, 1.0532712307636687, 1.0982456140350878, 1.4166666666666667, 1.0, 1.0016294327001416, 1.044934541871, 1.0, 1.005464480874317, 1.1193436460893451, 1.0431018285396485, 1.0038569424964936, 1.0801526717557253, 1.0550835042484619, 1.5057471264367817, 1.1286173633440515, 1.0, 1.25, 1.0789915966386554, 1.103405221339387, 1.0326027397260273, 1.1796536796536796, 1.033824804856895, 1.0091577657152864, 1.0227533893666592, 3.0, 1.1665807898645166, 1.5, 1.0, 1.1086244541484715, 1.0, 1.0476686156390267, 1.0067613130844357, 1.0471789883268483, 1.0106291997556507, 1.236883498199867, 1.1373873873873874, 2.0, 1.0453340742957296, 1.1338549817423056, 1.0081872385868114, 1.122347066167291, 1.1225296442687747, 1.0018315018315018, 1.1222771045805053, 1.2272727272727273, 1.0381355932203389, 1.2180094786729858, 1.0407331975560081, 1.0526315789473684, 1.2657657657657657, 1.0321285140562249, 1.0285714285714285, 1.0258987007912475, 1.0274404336681093, 1.0481220657276995, 1.0734597156398105, 1.0520833333333333, 1.0504129669808742, 1.278688524590164, 1.1368498519570762, 1.057315233785822, 1.0753968253968254, 1.0618556701030928, 1.6666666666666667, 1.0961599191561928, 1.2874770280913626, 2.0, 2.0, 1.0726632772780602, 1.0128840436075321, 1.0478492025132915, 1.0609037328094302, 1.1772029848243482, 1.0548354935194417, 1.038301080673536, 1.5611510791366907, 1.5825242718446602, 1.0476077320294293, 1.0024354603019971, 1.1, 1.0, 1.0625, 1.1193511008111239, 1.2307692307692308, 1.0603882099209203, 1.135135135135135, 1.1, 1.1113586103009518, 1.1203030303030304, 1.1543055484661324, 1.1093946793471277, 1.1216191009140086, 1.0462724935732648, 1.0484061393152302, 1.0938897168405366, 1.0339869281045753, 1.1, 1.2534544018949862, 1.1290322580645162, 3.0, 1.0546991504120118, 1.2247431506849316, 1.103719599427754, 1.2398765207917197, 1.2727272727272727, 1.0325197503999832, 1.0780141843971631, 1.2519953903282257, 1.13518635502211, 1.0590684361176164, 1.0, 1.5555555555555556, 1.0684395776300353, 1.0968602283130617, 1.072020725388601, 1.065934065934066, 1.0597410364836364, 1.5, 1.1303424475710113, 1.1332133213321331, 1.5, 1.0714285714285714, 1.0, 1.2087682672233822, 1.0317513644776084, 1.0370010368066356, 1.1694915254237288, 1.8333333333333333, 1.0819672131147542, 1.0, 1.4, 1.1174573929064946, 1.0, 1.2653562653562653, 1.035180490714507, 1.0930357142857143, 1.6666666666666667, 1.7142857142857142, 1.0375782881002087, 1.0396862021227504, 1.0617160060210737, 1.0297264662567267, 1.4326241134751774, 1.048780487804878, 1.0841160361091389, 3.0, 1.004121393780442, 1.032007759456838, 1.1368360277136258, 1.118621505694424, 1.5, 1.1635755548799027, 1.0251256281407035, 1.0016806722689076, 1.1325301204819278, 1.0, 1.0794774088187262, 1.1311512873901783, 1.112571214704537, 1.0732113144758735, 1.104109589041096, 1.25, 1.401639344262295, 1.021091811414392, 1.5714285714285714, 1.0365666909000912, 1.4891304347826086, 1.0083432657926104, 1.071354173711905, 1.0629272073849623, 1.0564273789649417, 1.3392539964476022, 1.0950570342205324, 1.1030239665433488, 1.0126459143968871, 1.0714791224345364, 1.0746147607461476, 1.0399789584429249, 1.0679635216200285, 1.2229800083298625, 1.1851851851851851, 1.303030303030303, 1.019868988567704, 1.114015877361073, 1.296028880866426, 2.4285714285714284, 1.0483091787439613, 2.0, 1.2598870056497176, 1.0896083476272156, 1.3333333333333333, 1.1444500760263558, 1.0188489190516363, 1.0340366307606152, 1.0629065028432658, 1.078125, 1.022784223036737, 1.8781752203214102, 1.0205423171733772, 1.0063082226949314, 1.0200566304860783, 1.0698722584718166, 1.0648801128349787, 1.1040007003414165, 1.1466666666666667, 1.0985915492957747, 1.1511627906976745, 1.0, 1.3216783216783217, 1.2086136393615619, 1.322674418604651, 1.2830188679245282, 1.000814332247557, 1.1176470588235294, 1.0404583052596872, 1.0491071428571428, 1.1792760540970564, 1.1666666666666667, 1.0893921334922527, 1.0029907558455682, 1.0554160388414533, 1.0118762320745236, 1.2, 1.1081081081081081, 1.1121443122823158, 1.0024508736002788, 1.0131233595800524, 1.0285714285714285, 1.1042944785276074, 1.0885715232446402, 1.3070866141732282, 1.0050428230448822, 1.026269538244547, 1.1261829652996846, 1.0904893813481071, 1.0469798657718121, 1.5, 1.1752508361204013, 2.0, 1.1820078831439833, 1.0206544441865861, 1.1326590157556895, 1.220216606498195, 1.4, 1.5, 1.1233326492920173, 1.0735294117647058, 1.074456786934183, 1.2, 1.11539780521262, 1.1003976143141152, 1.2857142857142858, 1.026459573461584, 1.023041474654378, 1.0590790616854908, 1.0034129692832765, 1.0202443280977311, 1.1744499073103893, 1.0307692307692307, 2.0, 1.0366930024507703, 1.0571857185718572, 1.1171428571428572, 1.0226107392109387, 1.0746745103404245, 1.0225746555166204, 1.095114006514658, 1.0912029147323266, 1.0133795837462833, 1.0119131044148564, 1.0293994559531283, 1.0833333333333333, 1.0052346570397113, 1.2118644067796611, 1.1923076923076923, 1.4761904761904763, 1.0246321177223288, 1.0982824427480915, 1.0169133745627732, 1.032421052631579, 1.0141176470588236, 1.2989690721649485, 1.0165763829671874, 1.008362369337979, 1.4224473889321902, 1.0395548583284644, 1.0, 1.1130690161527166, 1.1590214067278288, 1.0403008622271144, 1.0628748070170526, 1.0686268519932793, 1.1445209105346745, 1.1913477537437605, 1.0405097536665242, 1.0732884628458768, 1.1271108381946577, 1.0910747335045408, 1.0687022900763359, 1.0, 1.0666666666666667, 1.0741626794258374, 1.7142857142857142, 1.0364963503649636, 1.0485252445718105, 1.1098618918731349, 1.5, 1.0666666666666667, 1.0897920604914935, 1.0563793103448276, 1.0393712378098467, 1.1363636363636365, 1.2238840850666044, 1.0114777523232337, 1.1455026455026456, 1.0909090909090908, 1.7333333333333334, 1.0323895323895325, 1.1, 1.0134534360017435, 1.0488188976377952, 1.0476190476190477, 1.068054954318653, 1.24, 1.1538461538461537, 1.0064568257365814, 3.0, 1.1024844720496894, 1.031363088057901, 1.1031746031746033, 1.0742705570291777, 1.1359223300970873, 1.1505376344086022, 1.1125814378141978, 1.0699539500821595, 1.0977011494252873, 1.006282175529758, 1.0688927507447865, 3.0, 1.1, 1.0556333133384748, 1.5, 1.069767441860465, 1.2173913043478262, 1.3333333333333333, 1.4444444444444444, 1.3269230769230769, 1.0504731861198737, 1.2333333333333334, 1.106280193236715, 1.3246753246753247, 1.8333333333333333, 1.0865226352703925, 1.2, 1.1176470588235294, 1.0317836696180192, 1.0348837209302326, 1.0312261995430312, 1.0160075329566856, 1.4, 1.0, 1.3704020530367835, 1.0130718954248366, 1.2625, 1.129248806315889, 1.2136447449293177, 1.0224438902743143, 1.5, 1.030065230110056, 1.0357142857142858, 1.8095238095238095, 1.8, 1.0634366822615178, 1.1428571428571428, 1.1096774193548387, 1.0841121495327102, 1.2263833531756303, 1.1006348237891863, 1.1340269277845778, 1.1331177727845674, 1.1170856297889502, 1.089385474860335, 1.1104477611940298, 1.1202687825063589, 1.1605584642233857, 1.088235294117647, 1.0054669682270996, 1.0610390103217973, 1.0028622540250447, 1.0328638497652582, 1.048780487804878, 1.2566371681415929, 3.0, 1.0833333333333333, 1.1605839416058394, 1.2074363992172212, 1.3087557603686637, 1.0526315789473684, 1.05851344227728, 1.0373376623376624, 1.048568834775179, 1.0555972952667168, 1.213918102483777, 1.1018518518518519, 1.2212389380530972, 1.121761658031088, 1.0, 1.0726505774151165, 1.5384615384615385, 1.1041611599894272, 1.1024342238559728, 1.0709666439754935, 1.1512027491408934, 1.625, 1.108499095840868, 1.1428571428571428, 1.0789851603638105, 1.0, 1.0571274608951124, 1.020706455542022, 1.1462348322626694, 1.0384615384615385, 1.0166204986149585, 4.0, 1.1309655937846836, 1.0172383655170996, 1.0852902210019009, 3.0, 1.0666666666666667, 1.285143769968051, 1.450354609929078, 1.089656576625492, 1.0960909996213024, 1.1363636363636365, 1.130246020260492, 1.033787604063091, 1.1009600548602778, 1.120669084103404, 1.064444783404515, 1.1797990481226863, 1.391304347826087, 1.0322135296824666, 1.0156608748834457, 1.0073529411764706, 1.0584152689415847, 1.0, 1.5, 1.267892317793828, 1.0684410646387832, 1.0288294546717611, 1.1397989389237655, 1.044079958995387, 1.0, 1.182608695652174, 1.3333333333333333, 1.0057925879788228, 1.0, 1.0, 1.0215876148769505, 1.0, 1.0, 1.0235204855842186, 3.0, 1.0026058631921824, 1.003041825095057, 1.0, 1.0909090909090908, 1.0694590442306138, 1.0964163822525597, 1.4, 1.063320972911822, 1.0534351145038168, 1.1290672451193058, 1.018855218855219, 1.4531522117729014, 1.102373417721519, 1.0, 1.1176470588235294, 1.112035851472471, 1.1246857717445953, 1.0604614160700079, 1.0, 1.0724584103512014, 1.0194439123176706, 1.0169491525423728, 2.0, 1.0470941883767535, 1.0191131880997888, 1.0015653279851293, 1.0670614305954154, 1.0021306328378796, 1.0723869631199865, 1.026148409893993, 1.1775192343779322, 1.75, 1.076336863859468, 1.0048611111111112, 1.0513441511261807, 1.014484679665738, 1.0447368421052632, 1.0046089058994694, 1.0463917525773196, 1.06188156310548, 1.0959752321981424, 1.0832063704877404, 1.1873111782477341, 1.1121735016558352, 1.001733494121194, 1.0459770114942528, 1.4861111111111112, 1.135709437815963, 1.168103448275862, 1.005251153662547, 1.0635195143710099, 1.0, 1.0548618993567915, 1.3563218390804597, 1.1111111111111112, 1.2962962962962963, 1.018896687001254, 1.1263537906137184, 1.062082514734774, 2.0, 1.1631578947368422, 1.0119047619047619, 1.1388105831606834, 1.047557364914878, 1.0164022380623898, 1.1257861635220126, 1.011111111111111, 1.0178480367159612, 1.0623523715907923, 1.6374269005847952, 1.0152077093775702, 1.4583333333333333, 1.1237113402061856, 1.1151871657754011, 1.2692307692307692, 1.071891289697003, 2.0, 1.184926727145848, 1.0098684210526316, 1.0634465108767222, 1.1298405466970387, 1.0730503455083908, 1.091549295774648, 1.110862262038074, 1.1265478539026539, 2.0, 1.4444444444444444, 1.1666666666666667, 1.0, 1.2, 1.1403508771929824, 1.0182767624020888, 1.0923694779116466, 1.0647184414198025, 1.1352617079889806, 1.0891351930331115, 1.1303597256566975, 1.054531830774843, 1.0937430570984226, 1.0252098125738947, 1.0995132504056246, 1.0265301999865328, 1.0433930449174635, 1.0167946257197698, 1.0744797371303396, 1.1203007518796992, 1.3384615384615384, 1.0511211851372135, 1.1674418604651162, 1.102512641914094, 1.2777777777777777, 1.260648596321394, 1.1387532318299338, 1.3333333333333333, 1.0377358490566038, 1.1875, 2.5, 1.4110169491525424, 1.040519621951694, 1.0423440453686201, 1.0, 1.1675977653631284, 1.1065627906349826, 1.0509814696095492, 1.162313432835821, 1.6, 1.0, 1.1089575381679388, 1.1688888888888889, 1.0726166328600406, 1.1020027945971123, 2.0, 1.0748987854251013, 1.2424242424242424, 1.065118894070179, 1.0903703703703704, 1.0028486024044454, 1.0040255658745012, 1.0135265852038922, 1.288659793814433, 2.0, 1.125875927452597, 1.0, 1.04, 1.2355555555555555, 1.332184700206754, 1.0228215767634854, 1.75, 1.1740654205607477, 1.0482758620689656, 1.208139534883721, 1.087173100871731, 1.1773560209424083, 1.0426426426426427, 1.0067982249079408, 1.0172727272727273, 1.0645833333333334, 1.0, 1.018113034506477, 1.071653135256521, 1.105263157894737, 1.0256055363321799, 1.1993569131832797, 1.098360655737705, 1.0089600992727903, 1.2222222222222223, 1.0706713780918728, 1.0203672117989364, 1.150462962962963, 1.187878787878788, 1.003999262190623, 1.146341463414634, 2.125, 1.0467196819085487, 1.0074224021592442, 1.124713473130147, 1.1654884318766068, 1.002840362025804, 1.0953960356945431, 1.3001508295625943, 1.0822510822510822, 1.2206703910614525, 1.1371662291936793, 1.0867265996827076, 1.0304182509505704, 1.0667838312829525, 1.0821266479360276, 1.0, 1.0201626016260164, 1.2727272727272727, 1.0, 1.0593325092707047, 1.5753854940034266, 1.0444099378881988, 1.0153846153846153, 1.1666666666666667, 1.0087440381558028, 1.0311270125223613, 1.1097560975609757, 1.0505261714599117, 2.3333333333333335, 1.0960732984293193, 2.5, 1.0336633663366337, 1.0, 1.0393972403776326, 1.6129032258064515, 1.2372262773722629, 1.0378983634797587, 2.0, 1.2402250897448337, 1.1765834932821497, 1.0, 3.0, 1.1079136690647482, 1.180515759312321, 1.0222278353119474, 1.2077649527806926, 1.134587554269175, 1.0097597597597598, 1.087281795511222, 1.0193285859613428, 1.1725490196078432, 1.3310810810810811, 1.03125, 1.5, 1.091160220994475, 1.065190651906519, 1.0578084555651424, 1.1050937322476804, 1.0801699731593681, 1.094790841537475, 1.0804692806421734, 1.26266337408902, 1.1617473435655254, 1.0024752475247525, 1.5555555555555556, 1.5, 1.21875, 1.0119027311840185, 1.0638766519823788, 1.1497175141242937, 1.024742268041237, 1.055082050629691, 1.1382283109660873, 1.009813099692988, 1.0459770114942528, 1.380952380952381, 1.1978609625668448, 1.0075954981427067, 1.0361267083377477, 1.0689091635901897, 1.0165745856353592, 1.0485645785947009, 1.0336450845983773, 1.0160420557421612, 1.044150110375276, 1.0867203156312626, 1.1137123745819397, 1.0687450039968025, 1.0789473684210527, 1.0344204713461265, 1.2105263157894737, 1.0346964064436184, 1.0, 1.058, 1.0509727681675631, 1.1451612903225807, 1.0443409247757074, 1.02710027100271, 1.1590909090909092, 1.0053549818475191, 1.0222162178390224, 1.0833917702168243, 1.0481154771451484, 1.0028222013170274, 1.201167578543629, 1.2056737588652482, 1.25, 1.0, 1.3333333333333333, 1.0788455336988068, 1.2857142857142858, 1.0644398762362655, 1.1152784324287928, 1.0553293856402666, 1.08028472107267, 1.0459572772076124, 1.0570073384642922, 1.0368098159509203, 1.0710955710955712, 1.0043965205354475, 1.1541760898385713, 1.0457328157189838, 1.2327921507615869, 1.5, 1.0714285714285714, 1.040133779264214, 1.1233998901956253, 1.0160857908847185, 1.313319530710835, 1.0658307210031348, 2.1342756183745584, 1.0420335456367835, 1.0907003444316876, 1.0433392115252413, 1.2941176470588236, 1.055259585271299, 1.0548665805700566, 1.2379591836734694, 1.0657476139978792, 1.0625, 1.1201764057331862, 1.0663844724344416, 1.0863831355989007, 1.2005141388174807, 1.0198358563902612, 1.0512820512820513, 1.0773321178972957, 1.082080200501253, 1.0325814536340852, 1.0483870967741935, 1.0739336492890996, 1.0751730959446093, 1.063, 1.0037255316317986, 1.0670498084291187, 1.0455225336541587, 1.0433032507662876, 1.0, 1.0918220946915351, 1.0089285714285714, 1.0319099378881988, 1.0021276595744681, 1.1284296555750146, 1.0838323353293413, 1.0612244897959184, 1.0126103404791928, 1.03192711547241, 1.054054054054054, 1.1141176470588234, 1.2382213660807448, 1.0354852501068832, 1.0933786078098473, 1.1478915662650602, 1.1435813673975685, 1.0652759084791386, 1.0096153846153846, 1.1105054590897132, 1.0893713847081723, 1.1778471138845554, 1.0458715596330275, 1.0, 1.1177589398014174, 1.099009900990099, 2.25, 1.0574368040241302, 1.1687041234887738, 1.0482926829268293, 1.014218009478673, 1.243761412051126, 1.018310133416731, 1.1635426429240863, 1.0352155434122647, 1.3703703703703705, 1.052924791086351, 1.0517241379310345, 1.148936170212766, 1.5294117647058822, 1.0571354030785285, 1.2023217247097844, 1.0814285714285714, 1.0769230769230769, 1.018539976825029, 1.0119560019129603, 1.0093457943925233, 1.0714285714285714, 1.0188564476885644, 1.02, 1.0541062801932368, 1.1538461538461537, 1.0065805229016773, 1.4901960784313726, 1.0602780169762578, 1.3063063063063063, 2.0, 1.3004379562043795, 1.0392022520442663, 1.0506697890965861, 1.1432973805855162, 1.2380952380952381, 1.3529411764705883, 1.05, 1.0777777777777777, 1.0714285714285714, 1.0389520055645722, 1.02562342069571, 1.0307891140477266, 1.3652173913043477, 1.089963092064794, 1.046766683479718, 2.5, 1.0289133849969205, 1.1083600953071584, 1.5, 2.25, 1.1835474308300395, 1.0631146075451456, 1.076328461152454, 1.1778350515463918, 1.0, 1.01628664495114, 1.218274111675127, 1.3333333333333333, 1.1024196221412, 1.1034340546039427, 1.0647529833141047, 1.00177545691906, 1.375, 1.0247141734908982, 1.0380645161290323, 1.0816326530612246, 1.1428571428571428, 1.0172018348623852, 1.0, 1.2102161100196465, 1.1315937868457477, 1.0314749652968331, 1.0242718446601942, 1.1437699680511182, 1.0716368692399503, 1.039611360239163, 1.1493055555555556, 1.1538461538461537, 1.0470591450375422, 1.8397061593520436, 1.0839150333997656, 1.6587677725118484, 1.1451612903225807, 1.4186046511627908, 1.25, 1.0745814307458144, 1.0430379746835443, 1.0044493991831258, 1.061874431301183, 1.5, 1.0903225806451613, 1.0394989561586638, 1.14689880304679, 1.0627324171382377, 1.0166120450595089, 1.032950297660252, 1.1133907761847588, 1.0578842315369261, 1.037037037037037, 1.074006035953287, 1.1044433204454465, 1.2425531914893617, 1.1297836938435941, 2.0, 1.0813953488372092, 1.0165017437409622, 1.0900621118012421, 1.0266186089974636, 1.0857505399952951, 1.0177409816676524, 2.5, 1.0696937697993665, 1.0055324651334627, 1.164, 1.1442006269592477, 1.0677888673717661, 1.0053050397877985, 1.3528319405756732, 1.0249520153550864, 1.030704407690167, 1.1071026722925457, 1.0181992337164751, 1.0649496080627099, 1.027027027027027, 1.180618975139523, 1.140100596058496, 1.0124412005166061, 1.0089984079739738, 1.1542979177789643, 1.0354206198608475, 1.0185185185185186, 1.2416851441241685, 2.0, 1.3333333333333333, 1.1578947368421053, 1.0107991360691144, 1.0365205843293492, 1.047901282549553, 1.0141945830363506, 1.0539889129910822, 1.0385171790235082, 1.1898148148148149, 1.0019569471624266, 1.0492971330040624, 1.8, 1.4375, 1.142322097378277, 1.4444444444444444, 1.0916976456009913, 1.1098856209150327, 1.036610878661088, 1.11410989010989, 2.0, 1.1843733883445076, 1.0808080808080809, 1.1271570606834025, 1.0405867802403246, 1.0876451953537487, 1.1117764471057885, 1.1318249435272079, 1.148783755926613, 1.0392156862745099, 1.3548387096774193, 1.1393152302243212, 1.0, 2.0, 1.0419516847736994, 6.0, 1.625, 2.413793103448276, 1.0127952755905512, 1.02176193317893, 1.0619103773584906, 1.0390625, 1.125, 1.1407506702412868, 1.014499758337361, 1.1224944320712695, 1.247011952191235]
origin-bjaq_15.71 	max: 6.0000	99th: 3.0000	95th: 1.7152	median: 1.0814	mean: 1.1783

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.075589 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.171333