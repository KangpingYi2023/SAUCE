Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 90, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.5025	95th: 1.6667	median: 1.0809	mean: 1.1721
ReportEsts: [1.0063492063492063, 1.0369791666666666, 1.0411006466733215, 1.0855949895615866, 1.5, 1.0, 1.0225959012086179, 1.0336534906078982, 1.0, 1.025, 1.17354918766052, 1.0440405152880214, 1.0572824156305507, 1.1116279069767443, 1.0314376545390322, 1.0, 1.0588235294117647, 1.057385759829968, 3.0, 2.0, 1.2857142857142858, 1.094199820661664, 1.0603387438249823, 1.1209630064591896, 1.0226936359151455, 1.0, 1.134643995749203, 1.5, 1.2, 1.0072463768115942, 1.0, 1.056109486280726, 1.0017900201761725, 1.0083240843507215, 1.0621236598619475, 1.2381910390209145, 1.1470588235294117, 1.007180345028296, 1.1565534816447414, 1.0952380952380953, 1.2037037037037037, 1.079268292682927, 1.0, 1.0625055491432123, 1.1198825358438418, 1.8615384615384616, 1.0510204081632653, 1.254416961130742, 1.0271681236023582, 1.1111111111111112, 1.0664217543769507, 1.1168384879725086, 1.0409138666282112, 2.0, 1.1246753246753247, 1.2102432002424426, 1.5804597701149425, 1.3658536585365855, 1.00625, 1.0, 1.0821065067248274, 1.0896637608966375, 1.0363636363636364, 1.0481927710843373, 1.0909090909090908, 1.111235047501827, 1.3001594896331738, 1.75, 1.0, 1.0008397089009144, 1.0096385542168675, 1.0670945157526255, 1.0113895216400912, 1.0378428679044622, 1.0588235294117647, 1.062992125984252, 1.0, 1.118580375782881, 1.6, 1.0061932466182564, 1.375, 1.025075150568577, 1.2147239263803682, 1.0699386503067485, 1.1315014720314034, 1.04, 1.068645496788477, 1.0216215570864027, 1.0049019607843137, 1.75, 1.1402439024390243, 1.07014252018987, 1.0591900311526479, 1.0518934081346423, 1.0369318181818181, 1.0337662337662337, 1.0305343511450382, 1.1345595353339788, 1.0, 1.2431503050471437, 1.020014398848092, 1.065180102915952, 1.229564387365498, 1.36, 1.0215251089610442, 1.058136448101938, 1.103246841461758, 1.1262798634812288, 1.0490496627835684, 1.3333333333333333, 1.6666666666666667, 1.0880841121495326, 1.080948803500011, 1.036639292482628, 1.1428571428571428, 1.0600628198430133, 1.0, 1.1236203090507726, 1.1470911086717892, 1.0, 1.011111111111111, 1.0, 1.2731829573934836, 1.0223588379488304, 1.0664751106624213, 1.0980392156862746, 1.8, 1.1125827814569536, 1.0, 1.037037037037037, 1.0971976567052786, 1.3, 1.04150390625, 1.0327457026760536, 1.1069400494169666, 1.0360480640854473, 1.0082872928176796, 1.0150316455696202, 1.039972432804962, 1.0749542961608776, 1.035173679513731, 1.1172413793103448, 1.011881188118812, 1.1301432378819778, 2.0, 1.019598906107566, 1.054857142857143, 1.0855218855218856, 1.0899947061937534, 1.5, 1.0760474691208526, 1.0731319554848966, 1.008, 1.1074561403508771, 1.1255474452554743, 1.0703717069649945, 1.085446495313668, 1.1034928848641656, 1.0583501006036218, 1.0164473684210527, 1.2857142857142858, 1.2897196261682242, 1.027982326951399, 2.0, 1.049110561001846, 1.0163630679608688, 1.122093023255814, 1.3566792599050663, 1.10832769126608, 1.1053510376083326, 1.2652631578947369, 1.1226415094339623, 1.0418320906361964, 1.0091836734693878, 1.0327868852459017, 1.096209912536443, 1.0469245402663285, 1.1476080384136582, 1.098057718015255, 1.0, 1.0327868852459017, 1.0169348010160881, 1.0281100478468899, 1.1157894736842104, 1.3157894736842106, 1.0988045531364947, 1.251201230059581, 1.1228491656385948, 1.1153846153846154, 1.211818181818182, 1.079657302744797, 1.0, 1.2727272727272727, 1.0220733626568743, 1.0057077625570776, 1.0245630609352858, 1.4, 1.0469453376205788, 1.0492248878566621, 1.0737385746121746, 1.0626410835214446, 1.0276167386950563, 1.1419354838709677, 1.103448275862069, 1.2, 1.0, 1.4414414414414414, 1.1290805866582558, 1.2822299651567943, 1.3448275862068966, 1.013840830449827, 1.0031277926720286, 1.0384280097493284, 1.0568749306403284, 1.19699914483402, 1.0057142857142858, 1.0173410404624277, 1.0091563113145847, 1.0525303004193234, 1.0325860211356395, 1.0, 1.063768115942029, 1.060859118035176, 1.0127240248784097, 1.144777031154551, 1.0175118569865014, 1.285139689096641, 1.0357142857142858, 1.004048412618254, 1.10146982980918, 1.0259447264523407, 1.170731707317073, 1.1761405220785557, 1.0147001934235977, 1.1023622047244095, 2.0, 1.2087974864324478, 1.0797230906654756, 1.0595405532114393, 1.0592885375494072, 1.0909090909090908, 1.6666666666666667, 1.1083519459735143, 1.1272727272727272, 1.1209636821287308, 1.5, 1.0, 1.0256410256410255, 1.0402029664324746, 1.0918367346938775, 1.0469613259668509, 1.1518987341772151, 1.070446735395189, 1.0046179680940386, 1.1153481349567371, 1.0363636363636364, 2.0, 1.0727181132153065, 1.0781180648024855, 1.0910683012259195, 1.0244162468382214, 1.0846831955922864, 1.0487100103199174, 1.1001589825119238, 1.080787986550006, 1.0263157894736843, 1.0591785661710584, 1.0205084121331205, 1.0909090909090908, 1.015888511946892, 1.1608910891089108, 1.2045454545454546, 1.4705882352941178, 1.0218181818181817, 1.0, 1.1282051282051282, 1.1272323531390889, 1.0316091954022988, 1.3333333333333333, 1.017534194641408, 1.0503355704697988, 1.0327284510693455, 1.0576796807919593, 1.1111111111111112, 1.0482357220807565, 1.6666666666666667, 1.0417181353868257, 1.0302375809935205, 1.037007874015748, 1.0810810810810811, 1.6666666666666667, 1.391304347826087, 1.0289855072463767, 1.0605228732899001, 1.0, 1.1413612565445026, 1.025522041763341, 1.0096153846153846, 1.0188014032805166, 1.1183431952662721, 1.1257861635220126, 1.0187679083094556, 1.1723771932734088, 1.0966100951629172, 1.0854700854700854, 1.0, 1.1276849642004774, 1.2807570977917981, 1.0771812080536913, 1.0989048020219039, 1.0195578231292517, 1.1378205128205128, 1.18, 1.0041152263374487, 1.0138634580172639, 1.2857142857142858, 1.0065319727943525, 1.0419847328244274, 1.1875, 1.1096623248686515, 1.2380952380952381, 1.2727272727272727, 1.011585198334707, 2.0, 1.1796982167352539, 1.0319767441860466, 1.0492206726825266, 1.0567545963229417, 1.046448087431694, 1.058139534883721, 1.100082522761401, 1.0416575383591766, 1.0381895332390383, 1.0497525285130191, 1.1028926571012045, 2.0, 1.0, 1.0561370232409333, 1.25, 1.07035175879397, 1.3529411764705883, 1.0, 1.4666666666666666, 1.355421686746988, 1.0699432892249527, 1.084033613445378, 1.0216450216450217, 1.0, 1.1957390146471372, 1.050373955125385, 2.0, 1.220369267421084, 1.0, 1.09460259621954, 1.0987654320987654, 1.0102597743374442, 1.1382488479262673, 1.1363636363636365, 1.3058954393770856, 1.1759259259259258, 1.0169707663906167, 1.014480491694869, 1.0743919885550788, 1.0, 1.0769230769230769, 1.5714285714285714, 1.5, 1.2307692307692308, 1.068653053950498, 1.3333333333333333, 1.0532445923460898, 1.10989010989011, 1.1494437001223277, 1.1021127067583947, 1.2533470648815654, 1.02897558210929, 1.0121809744779582, 1.061904761904762, 1.5, 1.2121212121212122, 1.1446808510638298, 1.0412983168468986, 1.0952380952380953, 1.5714285714285714, 1.0779510022271714, 1.0040863981319323, 1.0291474408532937, 1.0111524163568772, 1.1464387464387464, 1.0213406292749658, 1.095890410958904, 1.0907770515613653, 1.0572033898305084, 1.1730769230769231, 1.0226628895184136, 1.1388888888888888, 1.0685625367185887, 1.0758640495601361, 1.0323806078147613, 1.1168831168831168, 1.2197802197802199, 1.098159509202454, 1.0, 1.04492730803548, 1.0599296287045383, 1.0323038611027067, 1.0613228286573266, 1.0341145060812815, 1.145853193517636, 1.5714285714285714, 1.1535893155258765, 1.1666666666666667, 1.228864218616567, 1.25, 1.0370032338392545, 1.0, 1.0877042132416166, 1.0671936758893281, 1.072289156626506, 3.0, 1.2887882219705549, 1.0108150859413079, 1.1347020415670406, 2.0, 1.0476190476190477, 1.3051823416506718, 1.2296819787985867, 1.1084735949712585, 1.1288981288981288, 1.1666666666666667, 1.003451251078516, 1.0132136683321888, 1.068754363219308, 1.1009941475136622, 1.1343201754385965, 1.0796019900497513, 1.071969696969697, 2.142857142857143, 1.1193181818181819, 1.5, 1.2288348700754401, 1.0, 1.1516355481889533, 2.272727272727273, 1.083491175851598, 1.0738112014298236, 1.0845157310302282, 1.0, 1.2, 1.12, 1.286751452032846, 1.2428884026258207, 1.0, 1.000483792936623, 1.0927177393994236, 1.1205967675093245, 1.5, 2.0, 1.0229126213592232, 1.0108695652173914, 1.0262295081967212, 1.1111111111111112, 1.092560226310384, 1.0547808764940239, 1.4705882352941178, 1.0558568738229754, 1.0454545454545454, 1.0958005249343832, 1.0205761316872428, 1.354648716870004, 1.0408702141094082, 1.0, 1.0571428571428572, 1.0817492856255435, 1.0412024215882012, 1.0181517616933, 1.0, 1.1455430214554303, 1.0169749184908412, 1.0220010476689365, 2.0, 1.034688995215311, 1.0358557965448716, 1.00425745794282, 1.0441658293652527, 1.006776663412584, 1.0391850272447287, 1.0201680672268907, 1.104387656702025, 2.0, 1.0484779575171843, 1.2131147540983607, 1.0, 1.1554404145077721, 1.0961538461538463, 1.0107816823925582, 1.1985743380855398, 1.047556243668406, 1.060856864654333, 1.0517435054569533, 1.0505883944271608, 1.0511864720228394, 1.1704545454545454, 4.0, 1.0090025207057975, 1.1506072874493927, 1.0474797866850163, 1.042537478059869, 1.0707762557077625, 1.1110320284697508, 2.4022988505747125, 2.4285714285714284, 1.0029301167163158, 1.0529007386939713, 1.0143617819109045, 1.1321945785369476, 1.075081951407636, 1.0103092783505154, 1.0775307350248495, 1.0204962243797195, 1.2039877300613497, 3.0, 1.0909090909090908, 1.0300157977883095, 1.0700757575757576, 1.0681003584229392, 1.0538847117794485, 1.0515463917525774, 1.4420289855072463, 1.148905109489051, 1.089820359281437, 1.0685314352652955, 1.1894736842105262, 1.020779302431587, 2.0, 1.2620126926563917, 1.0202429149797572, 1.194915254237288, 1.0997206703910614, 1.0155555555555555, 1.007905138339921, 1.0390835579514826, 1.0855146992486049, 1.0, 1.2127659574468086, 1.5, 1.0, 1.1363636363636365, 1.0766129032258065, 1.0285714285714285, 1.0436893203883495, 1.0589554629926305, 1.1078886310904872, 1.0825313826926999, 1.17711234911792, 1.030674846625767, 1.0747165958156206, 1.0864864864864865, 1.1067452521283563, 1.0445089501693274, 1.0699523052464228, 1.1488439306358382, 1.1420209488601356, 1.0406425784219329, 1.1335003828217443, 1.075973420515302, 2.0, 1.0571428571428572, 1.0863453815261044, 1.3944954128440368, 1.0, 1.2142857142857142, 1.25, 1.047787610619469, 1.3703703703703705, 1.1666666666666667, 1.0153378928119738, 1.1217654798453012, 1.0285573863783337, 1.0294483294483294, 1.2216216216216216, 1.1182065217391304, 1.0, 1.1407407407407408, 1.0125, 1.0501899221717534, 1.0839193624003751, 1.0739264153092607, 1.0299425456688274, 1.1714285714285715, 1.1578845241688587, 1.0905861456483126, 1.0134426082471915, 1.1267343135224683, 1.303030303030303, 1.0403726708074534, 1.0, 1.2422535211267605, 1.2083136416873856, 3.0, 1.1484429875907283, 1.0735447648655545, 1.4285714285714286, 1.0527912621359223, 1.5, 1.1176470588235294, 1.0757521503615046, 1.6923076923076923, 1.0159167542873717, 1.0508329773601026, 1.3103448275862069, 1.1153846153846154, 1.0804123711340206, 1.0100430416068866, 1.008459483526269, 1.066675235371614, 1.1569531369256603, 1.0, 1.0967847056267652, 1.1371951219512195, 2.0, 1.0348963258528034, 1.0800415260835712, 1.1144749290444655, 1.019067783119488, 1.0614892621288545, 1.0176991150442478, 1.7142857142857142, 1.0233553912028026, 1.0330645161290322, 1.1241070368045067, 1.1992, 1.0057793081061028, 1.0388971704816172, 1.3424908424908424, 1.0993865030674848, 1.2040133779264215, 1.0695020438277592, 1.0586750788643533, 1.0009057971014492, 1.1421715656868627, 1.025106708001977, 3.0, 1.1523692995574084, 1.0631433221313382, 1.0446468748285134, 1.3571428571428572, 1.2759338980697126, 1.433862433862434, 1.1428571428571428, 1.0400648938421386, 1.0420575865415722, 1.1473799126637554, 1.1470588235294117, 1.3333333333333333, 1.0723020449433263, 1.5, 1.0864485981308412, 1.0833333333333333, 1.0283301932872793, 1.44, 1.1814345991561181, 1.0775681341719077, 1.0, 1.566137566137566, 1.251227495908347, 1.25, 2.0, 1.1083333333333334, 1.2206896551724138, 1.0405196412001236, 1.2032828282828283, 1.1267605633802817, 1.2743362831858407, 1.1014466214978942, 1.0597402597402596, 1.1893203883495145, 1.2408163265306122, 1.0384615384615385, 1.0, 1.2004830917874396, 1.1067821067821069, 1.0144628099173554, 1.0490053874844592, 1.0752861589437221, 1.0304270007670673, 1.080144072569887, 1.224371023713129, 1.1905444126074498, 1.0047961630695443, 1.5714285714285714, 2.0, 1.2142857142857142, 1.01500341504136, 1.0670785525154458, 1.107843137254902, 1.0960591133004927, 1.0475754104620083, 1.086450975262347, 1.0054374978927396, 1.1142857142857143, 1.2222222222222223, 1.0376344086021505, 1.0738997879109227, 1.0611008220424343, 1.0391292404889438, 1.0133333333333334, 1.0979769639692853, 1.0142172548187016, 1.157037037037037, 1.319755600814664, 1.125, 1.06388088376561, 1.819672131147541, 1.1818181818181819, 1.1577287066246056, 1.0701001430615165, 1.0, 1.045346062052506, 1.0152365940958197, 1.0185185185185186, 1.0637085154315828, 1.0205405405405406, 1.2285714285714286, 1.0776029766956068, 1.0493871665465033, 1.102068224550094, 1.036259541984733, 1.0161476355247983, 1.2002976391801394, 1.1914893617021276, 1.2857142857142858, 1.0, 1.4285714285714286, 1.0764442291389125, 1.3333333333333333, 1.2054311886823135, 1.0872058585967368, 1.0155230596175477, 1.0869910625620656, 1.0507164066080787, 1.0336548767416935, 1.043010752688172, 1.0540915395284327, 1.0030760560734497, 1.1352409073865766, 1.0476848131779832, 1.1717752619535107, 1.6666666666666667, 1.0158730158730158, 1.0368852459016393, 1.1044576935075738, 1.0749185667752443, 1.292018523563062, 1.0741444866920151, 2.211206896551724, 1.026730467783186, 1.0604026845637584, 1.0407177033492823, 1.1875, 1.0492904713717552, 1.0408570283996192, 1.3138270326255825, 1.0581052631578947, 1.0, 1.1898089171974522, 1.1292134831460674, 1.6875, 1.0501009814690145, 1.5769230769230769, 1.110862262038074, 1.0833333333333333, 1.0061058344640434, 1.0257619127799293, 1.0107015457788346, 2.75, 1.0717703349282297, 1.0905180337512408, 1.0514695260847824, 1.0198482122289394, 1.012809917355372, 1.1120953879455393, 1.1818181818181819, 1.0782978723404255, 1.114280132838445, 1.0003125139515157, 1.0300601202404809, 1.0138888888888888, 1.1276054905948145, 1.0535608559587246, 1.3881048387096775, 1.0410876791455506, 1.0, 1.3333333333333333, 1.0676901777547034, 1.0032467532467533, 1.2557758163314523, 1.0514873505699194, 1.0646448523543495, 1.1083743842364533, 1.0991808853535203, 1.0591016548463357, 1.1213235294117647, 1.0216216216216216, 1.0317919075144508, 1.0893216512050263, 1.1071428571428572, 1.75, 1.0506300238974582, 1.173319037639911, 1.0384843102427472, 1.0113636363636365, 1.2013034033309196, 1.0090046239961061, 1.164183300534158, 1.5325670498084292, 1.1923076923076923, 1.059299191374663, 1.1613691931540342, 1.125, 1.4333333333333333, 1.037981897418706, 1.1922695738354807, 1.1567164179104477, 1.0, 1.0296318587621627, 1.0482135996926623, 1.0727576974564927, 1.2145969498910676, 1.3333333333333333, 1.2173913043478262, 2.0, 1.1455938697318007, 1.3461538461538463, 1.0, 1.1538461538461537, 1.0543046357615895, 1.0670289855072463, 1.0215796971455706, 1.019102181251623, 1.249090909090909, 1.2592592592592593, 1.1428571428571428, 1.032258064516129, 1.0675675675675675, 1.1, 1.148479427549195, 1.0296022639011773, 1.0299246781195504, 1.3473684210526315, 1.1105434849510678, 1.0470747209849356, 2.5, 1.0686264502738934, 1.206896551724138, 3.0, 2.0, 1.2005917159763313, 1.1146812020368644, 1.0666675135608938, 1.2701863354037266, 1.0, 1.1727272727272726, 1.1932515337423313, 3.0, 1.5, 1.0185463659147869, 1.1629251243446699, 1.0249906285143071, 1.6666666666666667, 1.0219410509658593, 1.0542215336948102, 1.0103626943005182, 1.0, 1.0187793427230047, 1.023877699921532, 1.0, 1.1489520958083832, 1.0466437811524214, 1.221264367816092, 1.08203125, 1.1124731841863316, 1.0521114106019767, 1.0661157024793388, 1.078125, 1.060165855979264, 1.3268419344368712, 1.0464291097995106, 1.3053892215568863, 1.2549019607843137, 1.1940298507462686, 1.1216783216783217, 1.0609946825148577, 1.0315263835263835, 1.101299099444338, 1.0709606986899562, 1.5, 1.6666666666666667, 1.1166975644058046, 1.1653474054529465, 1.0990079751021202, 1.0128864397835078, 1.0030105368790767, 1.1094237745718383, 1.4318181818181819, 1.0, 1.0915808505620628, 1.0923958825584024, 1.209550962223806, 1.182136602451839, 1.6666666666666667, 1.0416666666666667, 1.0355845775707107, 1.139395589436428, 1.0553826904397359, 1.0691911281766282, 1.0262784090909092, 2.0, 1.0932311621966795, 1.0600895497959995, 1.1900845327850125, 1.2167300380228137, 1.0943892147046201, 1.043189368770764, 1.2969094922737308, 1.0289855072463767, 1.0306213914261555, 1.0533714959171647, 1.0610599078341014, 1.0455153949129852, 1.0, 1.1394080996884735, 1.0602431666514307, 1.0039630118890357, 1.0762054830495895, 1.1078914919852034, 1.0196671709531013, 1.2, 1.262734584450402, 1.6666666666666667, 2.0, 1.1764705882352942, 1.0025641025641026, 1.0466034755134281, 1.0755681591244957, 1.0015206356685442, 1.0838534599728629, 1.0335135135135136, 1.2065217391304348, 1.3243243243243243, 1.050309700681131, 1.6, 1.5833333333333333, 1.130930489150423, 1.1428571428571428, 1.106038291605302, 1.163087934560327, 1.012964484616087, 1.111530408530944, 2.0, 1.1046439628482971, 1.300387596899225, 1.1450599657338663, 1.039661642063543, 1.1603535353535352, 1.1212328767123287, 1.1504065951298192, 1.0956142419240744, 1.0362438220757826, 1.4489795918367347, 1.089385474860335, 1.0, 1.0, 1.0417232931583276, 5.0, 1.4285714285714286, 1.5, 1.008515815085158, 1.1898734177215189, 1.0903547671840355, 1.0878775990584544, 1.1666666666666667, 1.1402855369335816, 1.0204439252336448, 1.2458100558659218, 1.2764423076923077, 1.4285714285714286, 1.0148048452220726, 1.0742793791574279, 1.1343612334801763, 1.1030122722201563, 1.0202449577226977, 1.1867489099223651, 1.09849157054126, 1.0, 1.2155518889876042, 1.0322512453317, 1.0657281205164992, 1.1774193548387097, 1.1122454433695013]
origin-bjaq_15.71 	max: 5.0000	99th: 2.5025	95th: 1.6667	median: 1.0809	mean: 1.1721

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 13.865389 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[ 5.9604645e-08  1.6689301e-06  0.0000000e+00  1.3113022e-06
 -2.9802322e-08]
Distance score: 6.020069349688129e-07
SAUCE Drift detection: False
Detection latency: 0.0232s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.043005 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 6.0000	99th: 3.0000	95th: 1.6667	median: 1.0829	mean: 1.1792
ReportEsts: [1.0485714285714285, 1.009774109470026, 1.0426730350562963, 1.0510204081632653, 1.375, 1.0, 1.0813813535783723, 1.069306299159235, 1.2, 1.018640350877193, 1.124717480163501, 1.0430366141924623, 1.005967005967006, 1.0685714285714285, 1.0590828924162257, 1.0, 1.1514195583596214, 1.619047619047619, 1.1818181818181819, 1.0783182192910141, 1.0763257155535833, 1.0620023455342262, 1.1538461538461537, 1.0293356341673856, 1.0198693041328153, 1.0284627027027027, 3.0, 1.1264047416449048, 1.5, 1.1666666666666667, 1.0422535211267605, 1.0, 1.0434630806378702, 1.007659447976486, 1.0528511821974966, 1.0228471001757469, 1.2271437469721087, 1.079295154185022, 1.3333333333333333, 1.026713532513181, 1.04483808469416, 1.0124479662972066, 1.1215189873417721, 1.000192727739946, 1.009242144177449, 1.0227502847740793, 1.1666666666666667, 1.0261115031757233, 1.1238532110091743, 1.0353097934710194, 1.3333333333333333, 1.2702702702702702, 1.0362903225806452, 1.0, 1.03539986455704, 1.0254817178120146, 1.0633855331841908, 1.1538461538461537, 1.0309278350515463, 1.0585268751953807, 1.4603174603174602, 1.0623860748119431, 1.0464071856287425, 1.1078066914498141, 1.0097087378640777, 1.1538461538461537, 1.104993149157187, 1.334153677878042, 1.4, 1.0, 1.045451007860534, 1.044102564102564, 1.0672472181906145, 1.0574712643678161, 1.1091102949887455, 1.4061855670103092, 1.0559710494571772, 1.1510416666666667, 1.5048543689320388, 1.10055519029878, 1.0407239819004526, 1.1111111111111112, 1.0, 1.1875, 1.0741163055872291, 1.1333333333333333, 1.0598006644518272, 1.0125, 1.6666666666666667, 1.1002592912705271, 1.110460753414378, 1.1451203412206763, 1.061621704790235, 1.194392523364486, 1.1289473684210527, 1.0298165137614679, 1.1170431211498972, 1.0289855072463767, 1.5, 1.3710191082802548, 1.36, 1.25, 1.09420722858655, 1.2031114952463267, 1.0630311614730878, 1.2236114105051377, 1.4375, 1.0263390063903701, 1.0324790101634997, 1.313605228992255, 1.169045353631462, 1.0389610389610389, 1.125, 1.5, 1.079734219269103, 1.0566870668706687, 1.0537691091196626, 1.0204081632653061, 1.062378710983723, 2.0, 1.1368531652219596, 1.1488372093023256, 1.0, 1.0330188679245282, 1.2857142857142858, 1.1278350515463917, 1.0255434238204948, 1.1207726326742975, 1.0564516129032258, 1.8333333333333333, 1.099721059972106, 1.0, 1.2, 1.1316929315270483, 1.3076923076923077, 1.0212331563903634, 1.0106793402292424, 1.063918819960247, 1.0, 1.7142857142857142, 1.048016701461378, 1.1842941443486155, 1.0738665308201731, 1.0066009751440554, 1.3493150684931507, 1.0010893246187365, 1.1187522801897118, 3.0, 1.0190621425848265, 1.0179584120982987, 1.0983050847457627, 1.1179517537368655, 1.5, 1.2269035532994923, 1.0062578222778473, 1.0067226890756302, 1.3728813559322033, 2.0, 1.0070993914807302, 1.0635685161782589, 1.157913013282403, 1.0245499181669395, 1.0657534246575342, 1.3333333333333333, 1.4778761061946903, 1.017220172201722, 1.7142857142857142, 1.0355813998415857, 1.5, 1.1348005502063274, 1.2129122402359778, 1.040895061728395, 1.0252176139272913, 1.2552083333333333, 1.140562248995984, 1.0711014702337913, 1.071519255184088, 1.010806916426513, 1.049674267100977, 1.0186867376070594, 1.0780230901866708, 1.2128439419751174, 1.170731707317073, 2.0, 1.0385833506715676, 1.041643625845421, 1.2490974729241877, 1.0661805654488234, 1.024390243902439, 1.5, 1.247191011235955, 1.0684387564900053, 1.45, 1.1549872122762148, 1.0214511780564999, 1.0852417859905708, 1.0824156523877269, 1.0600985221674877, 1.123524245007621, 1.0769547014930487, 1.0093306288032455, 1.0224260377501804, 1.0383333333333333, 1.0588172481026374, 1.0700517160319698, 1.1018591946426999, 1.3194444444444444, 1.1714285714285715, 1.2790697674418605, 1.0, 1.4125874125874125, 1.0813088419250774, 1.3471810089020773, 1.28, 1.0090534979423869, 1.5625, 1.0413130653734963, 1.0113636363636365, 1.240655790019546, 1.25, 1.0837696335078535, 1.0067732321863994, 1.0259873768767334, 1.001375082361704, 2.0, 1.2579710144927536, 1.1401138096721821, 1.0309376117407458, 1.0297297297297296, 1.0525451559934318, 1.0303550973654065, 1.0936625349860056, 1.3781512605042017, 1.0053305053796668, 1.0147191215080595, 1.062111801242236, 1.0017286084701815, 1.011049723756906, 1.0833333333333333, 1.122584943371086, 2.0, 1.2441176470588236, 1.1215096798212956, 1.0658049353701529, 1.127208480565371, 1.0714285714285714, 1.25, 1.0896302368474984, 1.0895522388059702, 1.103079694097499, 1.2, 1.0189214758751182, 1.008991008991009, 1.4285714285714286, 1.0126900949389566, 1.0492957746478873, 1.0944540727902947, 1.156, 1.0017500875043752, 1.1252824220515139, 1.044776119402985, 2.0, 1.101548714258793, 1.006977280590474, 1.1102831594634874, 1.011595966620306, 1.0849799196787149, 1.0355555555555556, 1.072233267064281, 1.0854644423903634, 1.025844930417495, 1.012039824033341, 1.0970873786407767, 1.0, 1.0337837837837838, 1.027124773960217, 1.1454545454545455, 1.2173913043478262, 1.3933554817275748, 1.128430296377607, 1.000626668612487, 1.0330837112822135, 1.0723981900452488, 1.3081632653061224, 1.036087889770825, 1.053558327219369, 1.0690827460418533, 1.0587158454594827, 1.2, 1.2105263157894737, 1.033734939759036, 1.0922040783601037, 1.1435697758316126, 1.0712694195386017, 1.203544575725027, 1.157079646017699, 1.057968940098762, 1.0448976821529168, 1.122964596172266, 1.0574878757139086, 1.029934518241347, 1.1875, 1.3636363636363635, 1.0878673700075359, 1.1333333333333333, 1.0582706766917294, 1.0066695377222707, 1.0940033270840486, 1.4722222222222223, 1.0583333333333333, 1.0567951318458417, 1.0637966804979253, 1.0815520344116227, 1.0952380952380953, 1.1657062213336469, 1.0214746602354186, 1.0629722921914357, 2.3333333333333335, 3.6666666666666665, 1.0036677454153182, 1.1111111111111112, 1.0052839015637016, 1.0424528301886793, 1.1, 1.0609341874301867, 1.1923076923076923, 1.3333333333333333, 1.0031980606677409, 2.0, 1.0164473684210527, 1.046116504854369, 1.0352564102564104, 1.2207207207207207, 1.216, 1.1443298969072164, 1.0957397611017743, 1.0647145087279437, 1.1133333333333333, 1.0398114493412085, 1.0860438729198185, 3.0, 1.1, 1.0478896026647633, 1.2, 1.0599721059972107, 1.2173913043478262, 1.1428571428571428, 1.4210526315789473, 1.315658657829329, 1.0727130570758405, 1.1654135338345866, 1.1347150259067358, 1.275, 1.8333333333333333, 1.0426589562443027, 1.3333333333333333, 1.1594202898550725, 1.0119820318993153, 1.1031746031746033, 1.0097817908201656, 1.0207156308851224, 1.4, 1.25, 1.4108391608391608, 1.407079646017699, 1.181712962962963, 1.1304157549234135, 1.2247694991278346, 1.0607594936708862, 1.5, 1.0288928997700213, 1.15, 1.56, 3.0, 1.1322500564206726, 1.1428571428571428, 1.1163793103448276, 1.196078431372549, 1.183624503261603, 1.0950838954193318, 1.043208343680159, 1.070982582977325, 1.115799406848207, 1.073019801980198, 1.0761194029850747, 1.056195746939085, 1.1065292096219932, 1.0, 1.0012478493505512, 1.054996964638033, 1.4083601286173633, 1.062200956937799, 1.0465116279069768, 1.2433628318584071, 2.0, 1.0208333333333333, 1.7945205479452055, 1.1455223880597014, 1.4068627450980393, 1.0811965811965811, 1.0592906299629434, 1.0867526377491208, 1.0010966556688663, 1.093049753133308, 1.0939020434641582, 1.1368421052631579, 1.0403225806451613, 1.0680100755667505, 1.0, 1.2043867394445336, 1.54, 1.1065671359727864, 1.1221241050119333, 1.073890361754896, 1.1559268098647573, 1.625, 1.127581459385039, 1.3333333333333333, 1.1162385720505006, 1.25, 1.0556433515597838, 1.014354066985646, 1.142882785855322, 1.110410094637224, 1.1770750988142293, 5.0, 1.2879169288860919, 1.0119489523575789, 1.1149695786936058, 2.0, 1.0136986301369864, 1.2120481927710844, 1.2710843373493976, 1.118224201516944, 1.0921593799776526, 1.1304347826086956, 1.2581344902386118, 1.0292998477929984, 1.0488615805857522, 1.0937889855371723, 1.0411168079850033, 1.0514216738197424, 1.1711711711711712, 1.0132723112128146, 1.0743661689548052, 1.0991735537190082, 1.0802879291251384, 1.0, 1.5, 1.2242866622428665, 1.0873015873015872, 1.052574720921858, 1.113243789509898, 1.0810950413223142, 1.0, 1.208695652173913, 1.206896551724138, 1.057668525473237, 1.0833333333333333, 1.0, 1.0987466624784044, 1.0, 1.0, 1.0264976958525345, 1.5, 1.0104609349460607, 1.005965697240865, 1.083565459610028, 1.0909090909090908, 1.0776609071434395, 1.0737365368682685, 1.45, 1.0436531632043748, 1.065217391304348, 1.1414473684210527, 1.0020013342228151, 1.3483577917540182, 1.0069551036070605, 1.0, 1.0120481927710843, 1.0376625447587016, 1.1358150603433623, 1.0654429369513168, 1.2, 1.0946268109297634, 1.0102096662087687, 1.0222707423580786, 1.0, 1.043908880818752, 1.051226573527442, 1.0070796893755665, 1.0104468311278911, 1.0012507658675058, 1.0870650091342513, 1.0055020632737277, 1.3116966580976863, 1.75, 1.1096855019872127, 1.0446307817149039, 1.0632787686293672, 1.0151597184623715, 1.018970189701897, 1.0062640411398889, 1.7037037037037037, 1.0309577298726957, 1.0978169605373636, 1.0165208848021214, 1.0765765765765767, 1.0966554768121348, 1.064922334489519, 1.0227272727272727, 1.3466666666666667, 1.1018431660877723, 1.0610526315789475, 1.0115883113797746, 1.064557157749303, 1.0, 1.0531955606582473, 1.4606413994169096, 2.5, 1.3018867924528301, 1.0212985548191402, 1.1007194244604317, 1.1055718475073313, 1.0, 1.1538461538461537, 1.0140068886337543, 1.1261665500827462, 1.0476813762154076, 1.0118172537008678, 1.0946676970633693, 1.0806241872561768, 1.0050994390617032, 1.0074487619950243, 1.5632183908045978, 1.0199590106665424, 1.055344317701732, 1.0757575757575757, 1.1427393710988105, 1.134453781512605, 1.035229992023398, 2.0, 1.1090425531914894, 1.030612244897959, 1.0194347547519043, 1.0554323725055432, 1.097165991902834, 1.0016666666666667, 1.1462450592885376, 1.1508454312553373, 2.0, 1.1, 1.2, 1.0, 1.1584158415841583, 1.0076849183477425, 1.0090439276485788, 1.0076923076923077, 1.0709987966305656, 1.0815109343936382, 1.065899963490325, 1.1621091882589158, 1.1063419689119172, 1.0471375024523892, 1.0168972303277655, 1.076555023923445, 1.0530925013683634, 1.0546466998049455, 1.0422885572139304, 1.0661521499448732, 1.123134328358209, 1.1776315789473684, 1.0235997737008, 1.1357882623705409, 1.1023763116964935, 1.2443181818181819, 1.1551226551226552, 1.0476497102382485, 2.0, 1.0011820330969268, 1.1764705882352942, 1.3333333333333333, 1.2426470588235294, 1.033104652420464, 1.0230055658627086, 1.0545454545454545, 1.1284916201117319, 1.115131757674545, 1.0034512006083471, 1.0, 1.4, 1.6666666666666667, 1.042099994438574, 1.1272727272727272, 1.1016746411483254, 1.1106153123532174, 1.0, 1.209106239460371, 1.1404255319148937, 1.1110976976804345, 1.1165191740412979, 1.0197135462894622, 1.1218261928028939, 1.004021868091089, 1.3870967741935485, 1.0, 1.114988587370023, 1.0, 1.0398126463700235, 1.25, 1.3412921348314606, 1.107408118837239, 1.625, 1.1785171736633444, 1.118881118881119, 1.1800766283524904, 1.0657024537981334, 1.2755754475703325, 1.156849768365321, 1.0467501726008481, 1.0070609002647837, 1.0600694444444445, 1.3333333333333333, 1.0137609418600206, 1.0629689266504505, 1.1428571428571428, 1.0206753962784287, 1.2033865317244063, 1.2413793103448276, 1.0106207286695803, 1.3333333333333333, 1.0539568345323742, 1.0493978362931211, 1.0024038461538463, 1.0946745562130178, 1.0605268289224115, 1.0151515151515151, 1.5, 1.0076360165447025, 1.0013333333333334, 1.117271994684235, 1.1687887691805419, 1.0052636128747203, 1.0681986656782803, 1.134441087613293, 1.1193458594293668, 1.2128851540616246, 1.061815960831831, 1.0238589211618256, 1.1108545034642032, 1.0632743362831858, 1.0204994133260425, 1.096654275092937, 1.036575497653342, 1.35, 1.3333333333333333, 1.1002475247524752, 1.6078939786804956, 1.0543919974992184, 1.037037037037037, 1.1666666666666667, 1.0071428571428571, 1.027056277056277, 1.1158536585365855, 1.0434943524509266, 2.3333333333333335, 1.140982218458933, 2.0, 1.1453831041257367, 1.1333333333333333, 1.0384459498581438, 1.4516129032258065, 1.164516129032258, 1.0487380330722367, 1.0, 1.1479529708167122, 1.253028263795424, 1.5, 2.0, 1.1063829787234043, 1.1766381766381766, 1.0544880231639906, 1.1944739638682254, 1.0965417867435159, 1.2436974789915967, 1.0671641791044777, 1.1219135802469136, 1.0353356890459364, 1.3097643097643097, 1.0625, 1.0, 1.2579281183932347, 1.0726392251815982, 1.0455764075067024, 1.0330439404677534, 1.0936338957789962, 1.0485897389478258, 1.0905269784838723, 1.1212441491771101, 1.2066905615292711, 1.0065689742294088, 1.5, 1.0, 1.3333333333333333, 1.029016022357955, 1.0920471281296023, 1.1059782608695652, 1.05, 1.059827970691303, 1.0600354400472534, 1.0119562870742564, 1.0235294117647058, 1.0952380952380953, 1.0112359550561798, 1.024650417288454, 1.0922173725090991, 1.0347354385804965, 1.0670391061452513, 1.095686419297274, 1.0067347625996184, 1.095955679258913, 1.0672645739910314, 1.0365170736285567, 1.0890410958904109, 1.0859820700896496, 1.0125391849529781, 1.0335638878776847, 3.0, 1.0532615200478754, 2.0, 1.0114068441064639, 1.0376298123414573, 1.125, 1.0674059621459477, 1.0421631530705775, 1.186046511627907, 1.0067176844822505, 1.0383415336613464, 1.0750866599575086, 1.02568093385214, 1.0028598665395614, 1.205361687687348, 1.2282229965156795, 1.4, 2.0, 1.2, 1.075521254242767, 1.4285714285714286, 1.06672131147541, 1.1075483552483956, 1.0043119610048743, 1.0784149807724461, 1.045649102393617, 1.0821221578243423, 1.0178571428571428, 1.0281848928974069, 1.0134016663012497, 1.1531107026942478, 1.0410932681944347, 1.2059096962235232, 1.5, 1.0777777777777777, 1.0334448160535117, 1.1337140378776926, 1.0423728813559323, 1.2506066622545775, 1.0719874804381846, 2.1785714285714284, 1.0406899433912085, 1.0475651189127972, 1.0485827139858122, 1.1578947368421053, 1.07129769346842, 1.0211551873533824, 1.2820299500831946, 1.0439750692520775, 1.09375, 1.1007194244604317, 1.0894863339109049, 1.0414725069897484, 1.4666666666666666, 1.0191401858170586, 1.0731707317073171, 1.0063924994672917, 1.0139505389980976, 1.0025412960609912, 1.4014084507042253, 1.0073327222731439, 1.05759682224429, 1.0585027268220129, 1.0194080640206806, 1.0660919540229885, 1.0697179238520893, 1.0706887736469213, 1.1428571428571428, 1.0971223021582734, 1.1362375591450482, 1.0486350960677464, 1.1508498583569404, 1.1114369501466275, 1.095573440643863, 1.0632497273718649, 1.0383141762452108, 1.0237325938575048, 1.1428571428571428, 1.1018033740546829, 1.2417971737992672, 1.0550379198266522, 1.0601001669449082, 1.113292138554804, 1.0664905532125257, 1.058239576439444, 1.1260330578512396, 1.0989968863219988, 1.1031373963216733, 1.0914634146341464, 1.0710900473933649, 1.0005854800936769, 1.0735381464413722, 1.2173913043478262, 2.0, 1.030184520211896, 1.1734083714386212, 1.0159806295399516, 1.0049019607843137, 1.2120935885749013, 1.0122589992198818, 1.1648325918988527, 1.0836216839677046, 1.2903225806451613, 1.037162162162162, 1.5555555555555556, 1.150395778364116, 1.71875, 1.068803752931978, 1.1986754966887416, 2.2222222222222223, 1.02, 1.1126050420168068, 1.144864864864865, 1.0721649484536082, 1.0, 1.0519399249061328, 1.0197628458498025, 1.1538049303322615, 1.0769230769230769, 1.0004540623097324, 1.024793388429752, 1.0035767855082496, 1.2478632478632479, 1.1666666666666667, 1.2760932944606413, 1.0338937895920906, 1.0497571971225423, 1.2127031019202363, 1.4655172413793103, 1.1176470588235294, 1.0, 1.1149425287356323, 1.0348837209302326, 1.0072604065827686, 1.0269988855994687, 1.033152110045213, 1.3391304347826087, 1.0739278777418932, 1.0470522487655145, 3.5, 1.08145824941014, 1.2486828240252899, 2.0, 2.25, 1.1591806515301086, 1.1107852525736175, 1.050349212967789, 1.1379310344827587, 1.0, 1.2423076923076923, 1.3165829145728642, 1.2596153846153846, 1.030531246660413, 1.1110088592816427, 1.05548668244487, 1.0557017543859648, 1.5714285714285714, 1.024593173332731, 1.0359204618345093, 1.0590372388737512, 1.0808510638297872, 1.0116414435389989, 3.0, 1.2916666666666667, 1.1804299244439715, 1.0342336531484317, 1.3125, 1.0863787375415281, 1.0947572522159548, 1.077223088923557, 1.1201413427561837, 1.2142857142857142, 1.0348701258743171, 1.2784283112151964, 1.074864612882109, 1.3333333333333333, 1.1951219512195121, 1.1310507674144037, 1.125, 1.0798293723339427, 1.0307692307692307, 1.0103489854443504, 1.0155677655677655, 1.5, 1.0, 1.0038544928932787, 1.2, 1.0996930037162709, 1.0255973576921091, 1.0902602854743912, 1.0823581894924676, 1.1616379310344827, 1.1090909090909091, 1.1180751327607683, 1.0758324272027535, 1.2475786924939467, 1.1414141414141414, 1.6666666666666667, 1.0617283950617284, 1.0077550296906852, 1.0637329286798178, 1.0231127877475659, 1.0720435713883096, 1.0419412822049132, 2.25, 1.0890774125132556, 1.037052563381892, 1.1756988020536223, 1.2, 1.0740067811418728, 1.032520325203252, 1.1302367941712204, 1.0423076923076924, 1.0325511617637273, 1.0153340438372347, 1.051356589147287, 1.0276548672566372, 1.131578947368421, 1.1910045739454516, 1.1108515134379, 1.0636251664033243, 1.0684896169224816, 1.1389033942558746, 1.0301697045883091, 1.59375, 1.2075055187637969, 2.0, 2.0, 1.0454545454545454, 1.0129589632829374, 1.0477124183006536, 1.0106000495908753, 1.0059996791615422, 1.0655663576757857, 1.0357891061452513, 1.1830357142857142, 1.1226190476190476, 1.0492950342845795, 1.3333333333333333, 1.5714285714285714, 1.0363331470095025, 1.1111111111111112, 1.0274285714285714, 1.134575569358178, 1.0724908452283088, 1.1072113955185556, 2.5, 1.2113613101330605, 1.1240458015267176, 1.0751076625372313, 1.039942055353191, 1.1213389121338913, 1.1297297297297297, 1.1620746153411552, 1.097348615278666, 1.0443213296398892, 1.0921052631578947, 1.0646992054483542, 1.3333333333333333, 3.0, 1.041438810329156, 6.0, 1.625, 1.8235294117647058, 1.019367991845056, 1.09922507618633, 1.102708803611738, 1.0551181102362204, 1.1666666666666667, 1.042398688217381, 1.0106589147286822, 1.2222222222222223, 1.3188118811881189]
origin-bjaq_15.71 	max: 6.0000	99th: 3.0000	95th: 1.6667	median: 1.0829	mean: 1.1792

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.123704 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.059337