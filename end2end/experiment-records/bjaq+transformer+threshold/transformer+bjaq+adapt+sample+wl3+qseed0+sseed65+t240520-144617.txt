Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 65, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.5000	95th: 1.6667	median: 1.0769	mean: 1.1676
ReportEsts: [1.0031847133757963, 1.0096354166666666, 1.0370209626318303, 1.1063829787234043, 1.5, 1.0, 1.1088319088319087, 1.0437166886020182, 1.0, 1.0183006535947712, 1.178830115718697, 1.0427273751831398, 1.0232058444348948, 1.0744186046511628, 1.0543977393147297, 1.0, 1.1, 1.057385759829968, 3.0, 2.0, 1.0740740740740742, 1.0578063691942696, 1.152097710592617, 1.1168526130358192, 1.1036013813517513, 1.0, 1.1216121577141256, 1.2, 1.2, 1.0575539568345325, 1.0, 1.0472296262187077, 1.0077598297327888, 1.065482796892342, 1.0433250110148333, 1.2270820353063343, 1.0935828877005347, 1.012648579001982, 1.137233969281631, 1.0119047619047619, 1.1142857142857143, 1.0030487804878048, 1.0, 1.0549188998589563, 1.1224030470914128, 1.8615384615384616, 1.0404040404040404, 1.1413427561837455, 1.0278389916649726, 1.037037037037037, 1.0557759804669617, 1.0120274914089347, 1.0386683422261593, 2.0, 1.3142857142857143, 1.1687580025608195, 1.2211367673179396, 1.3592233009708738, 1.0186335403726707, 1.25, 1.099554707379135, 1.1039850560398505, 1.1, 1.0114942528735633, 1.0909090909090908, 1.0640860373466907, 1.2564734895191123, 1.75, 1.0, 1.0042126942520126, 1.0194647201946472, 1.062754212667054, 1.0301624129930393, 1.1055463771536465, 1.0447058823529412, 1.0693069306930694, 1.0, 1.1123173277661795, 2.0, 1.017891474647766, 1.21875, 1.047234456454028, 1.1042944785276074, 1.0941028858218318, 1.131992149165849, 1.0, 1.0722408415505917, 1.0356680343245828, 1.0490196078431373, 1.75, 1.134479271991911, 1.0761774238137531, 1.0342679127725856, 1.0042075736325387, 1.027204502814259, 1.0649350649350648, 1.007462686567164, 1.1512770137524557, 1.0, 1.2431503050471437, 1.0334821428571428, 1.0497427101200687, 1.2215612741928532, 1.4166666666666667, 1.0216822265447014, 1.078577117069286, 1.2498332734827886, 1.1312097080015169, 1.0435315757204169, 1.1666666666666667, 1.6666666666666667, 1.066588785046729, 1.0420090205705217, 1.0303221730890715, 1.2077922077922079, 1.0566507717404945, 1.0, 1.086092715231788, 1.1371055495103373, 1.0, 1.04, 1.0, 1.3233082706766917, 1.0128047766769128, 1.0599518521394735, 1.087378640776699, 1.8, 1.1961920529801324, 1.0, 1.0357142857142858, 1.103004774514114, 1.1818181818181819, 1.1510416666666667, 1.0307234325836698, 1.0712757477870538, 1.02803738317757, 1.0301369863013699, 1.0015612802498048, 1.039972432804962, 1.0755636806825106, 1.050832393258811, 1.2857142857142858, 1.0482713633398566, 1.1636587117109443, 2.0, 1.0214220601640838, 1.0011441647597255, 1.1124913733609385, 1.092641609317099, 1.5, 1.2406151610559457, 1.0273972602739727, 1.0224948875255624, 1.1074561403508771, 1.1372262773722628, 1.0027045300878972, 1.1055020350795, 1.0714009661835748, 1.0583501006036218, 1.0526315789473684, 1.3061224489795917, 1.2777777777777777, 1.0206185567010309, 1.4285714285714286, 1.0388096633457056, 1.0390624404303501, 1.165771812080537, 1.3163831187141648, 1.1626420454545454, 1.0841218096525405, 1.2673684210526315, 1.0769230769230769, 1.0481262709402537, 1.0185375901132854, 1.0329768270944741, 1.1137026239067056, 1.0495867768595042, 1.1079538137957676, 1.0705040496972555, 1.0, 1.0714285714285714, 1.0182497485270872, 1.0291068580542264, 1.1206467661691542, 1.2236842105263157, 1.0934373724757935, 1.3148183740149912, 1.0890851243425752, 1.1153846153846154, 1.2336363636363636, 1.0425483585586879, 1.0, 1.1, 1.0172309430612163, 1.0208574739281575, 1.0245630609352858, 1.4, 1.0778135048231512, 1.0542706957768335, 1.064008089248835, 1.0626410835214446, 1.020976072520291, 1.0960451977401129, 1.103448275862069, 1.1830985915492958, 1.0, 1.4285714285714286, 1.1327866267150293, 1.32404181184669, 1.160919540229885, 1.0128521997034108, 1.0031277926720286, 1.0203657086917, 1.0464432360448341, 1.1474884483529588, 1.0173410404624277, 1.0447976878612717, 1.0139338950097214, 1.0599546211729565, 1.0172443946972611, 1.0, 1.0178053830227742, 1.0942626986784314, 1.0132224599162258, 1.1546518792359828, 1.0023713973002555, 1.2786761127034774, 1.0357142857142858, 1.005854478408976, 1.2190562145435793, 1.01804850535815, 1.0607734806629834, 1.071095312152855, 1.0599613152804641, 1.1425196850393702, 2.0, 1.2385133157740709, 1.068780705672175, 1.1495546179090483, 1.2126696832579185, 1.0, 1.6666666666666667, 1.1854522431895325, 1.0909090909090908, 1.1347553873034362, 1.5, 1.0, 1.025, 1.0554254488680719, 1.1122448979591837, 1.0284090909090908, 1.1561181434599157, 1.031456953642384, 1.009322033898305, 1.110741178064691, 1.0754716981132075, 2.0, 1.1146752205292703, 1.0544060193893792, 1.136602451838879, 1.082946596337129, 1.15666402279604, 1.0335113145181796, 1.0930047694753577, 1.0760523211802193, 1.013157894736842, 1.101163146617692, 1.017438290556306, 1.0909090909090908, 1.0274993828684276, 1.2025641025641025, 1.2045454545454546, 1.3888888888888888, 1.0261194029850746, 1.1111111111111112, 1.1965811965811965, 1.1020523517932845, 1.0974930362116992, 1.3358395989974938, 1.0240065336878377, 1.0134228187919463, 1.0292562865661088, 1.055949306096379, 1.1111111111111112, 1.0366678792288104, 2.5, 1.042782552322882, 1.0153508771929824, 1.0505347958672795, 1.0526315789473684, 2.0, 1.2173913043478262, 1.126984126984127, 1.0589942408545414, 1.0, 1.1483180428134556, 1.0429864253393666, 1.0056089743589745, 1.0163415965800846, 1.111764705882353, 1.1069182389937107, 1.0000878919983125, 1.1320138355111453, 1.103627857710301, 1.1452991452991452, 1.0, 1.1336515513126493, 1.2929936305732483, 1.1263157894736842, 1.0554759898904802, 1.0350291909924938, 1.2788732394366198, 1.2553191489361701, 1.010973936899863, 1.0413756045137024, 1.2857142857142858, 1.0034112667733408, 1.04, 1.0, 1.1155319614711032, 1.1904761904761905, 1.4, 1.012210739871933, 2.0, 1.1755829903978052, 1.0218023255813953, 1.0648072190319935, 1.1076665270213657, 1.0156657963446476, 1.1666666666666667, 1.10608909752567, 1.0529522974935697, 1.02945301542777, 1.032030126089532, 1.031947734941489, 2.0, 1.0, 1.0521378459288375, 1.25, 1.070949720670391, 1.3529411764705883, 1.0, 1.4666666666666666, 1.3965863453815262, 1.0629107981220658, 1.131578947368421, 1.003257328990228, 1.0, 1.196404793608522, 1.062131590482359, 2.0, 1.0673019654556284, 1.0, 1.0993091930463827, 1.1265822784810127, 1.012280241406455, 1.140552995391705, 1.1363636363636365, 1.386068476977568, 1.3703703703703705, 1.0382787535494777, 1.0238968483250286, 1.0459610027855153, 1.0, 1.0769230769230769, 1.5714285714285714, 1.5, 1.4545454545454546, 1.0694373945371984, 1.3333333333333333, 1.08153078202995, 1.294871794871795, 1.2286354721210424, 1.0663021964128454, 1.238928939237899, 1.0174514712133378, 1.0092807424593968, 1.0523809523809524, 1.5, 1.0062893081761006, 1.0382978723404255, 1.0439453956464095, 1.0952380952380953, 1.5714285714285714, 1.0112612612612613, 1.001747233546884, 1.0267445188220266, 1.0098039215686274, 1.1464387464387464, 1.0049247606019152, 1.0126582278481013, 1.0907770515613653, 1.0635593220338984, 1.2307692307692308, 1.0212464589235128, 1.0423728813559323, 1.0770966709346992, 1.0372779259527145, 1.041025329210243, 1.5087719298245614, 1.0776699029126213, 1.0948012232415902, 1.0, 1.054613836211463, 1.038302784012936, 1.0889205312645767, 1.064127244423847, 1.0817128671907323, 1.1531617413409596, 1.8333333333333333, 1.0298062593144561, 1.1666666666666667, 1.1759180187873612, 1.25, 1.031939406511221, 1.0058309037900874, 1.0503009458297508, 1.1185770750988142, 1.2120622568093384, 3.0, 1.1941238195173138, 1.0094133421497318, 1.1722457237447121, 2.0, 1.0952380952380953, 1.2216890595009597, 1.3082706766917294, 1.135185498898865, 1.0582120582120582, 1.3125, 1.2528041415012943, 1.0219255296281258, 1.0597496093827259, 1.0904702495201535, 1.0192982456140351, 1.0928689883913765, 1.0232558139534884, 2.142857142857143, 1.0450928381962865, 1.5, 1.2288348700754401, 1.03125, 1.2130166880616176, 2.5, 1.038050522798629, 1.1274467682895393, 1.052436767427514, 1.0, 1.2127659574468086, 1.08, 1.2882349992480826, 1.1159737417943107, 1.0, 1.000829646017699, 1.114468241084987, 1.0708661417322836, 1.5, 2.0, 1.010993325480958, 1.0108695652173914, 1.023489932885906, 1.1111111111111112, 1.0635655651441802, 1.0526838966202783, 1.4705882352941178, 1.0056497175141244, 1.0454545454545454, 1.0800524934383202, 1.0290322580645161, 1.3369793857803955, 1.0154985362493543, 1.0, 1.0136986301369864, 1.0930203364298268, 1.0253861034471823, 1.0129574406016013, 1.0, 1.0915726609157266, 1.0087534105796097, 1.0220010476689365, 1.0, 1.0354864433811801, 1.0719656825637143, 1.020857752532083, 1.0277838451793282, 1.0068119234928181, 1.0295664534470506, 1.0276338514680483, 1.0527965284474445, 2.0, 1.0730787120781435, 1.4509803921568627, 1.0, 1.1243523316062176, 1.1346153846153846, 1.0029091152277134, 1.1912955465587045, 1.053194946193398, 1.1606241395135384, 1.0747843108823316, 1.1113215203570945, 1.0443207693285712, 1.1573033707865168, 4.0, 1.0067041104365646, 1.1953441295546559, 1.0458976971190295, 1.0304284440011127, 1.0918315575849822, 1.3095637583892616, 2.2967032967032965, 2.2857142857142856, 1.0083468355673393, 1.0152975388009315, 1.0247561322094896, 1.1313543599257885, 1.0631748939452372, 1.0062240663900415, 1.0859959928292735, 1.0097087378640777, 1.2323390894819466, 3.0, 1.1666666666666667, 1.1013513513513513, 1.0886319845857417, 1.0511463844797178, 1.060529634300126, 1.0323886639676114, 1.1436781609195403, 1.148905109489051, 1.0963855421686748, 1.0728183451841504, 1.2282608695652173, 1.016830143356482, 2.0, 1.0658499234303216, 1.0198412698412698, 1.4242424242424243, 1.094972067039106, 1.0133037694013303, 1.0563674321503131, 1.1504539559014266, 1.0750673321164623, 1.0, 1.1914893617021276, 1.0, 1.0, 1.1931818181818181, 1.0040322580645162, 1.0246913580246915, 1.0679611650485437, 1.0613585389298301, 1.0696055684454757, 1.0724887941803218, 1.1770440434050948, 1.0354391371340523, 1.0856550432064331, 1.0432432432432432, 1.1311914323962518, 1.0338655055636188, 1.070235886562417, 1.25, 1.1757056771328893, 1.044240612172503, 1.0974828992148802, 1.0773779314740284, 2.0, 1.0933660933660934, 1.0734126984126984, 1.4339622641509433, 1.0, 1.2439024390243902, 1.25, 1.101364522417154, 1.2592592592592593, 1.1666666666666667, 1.0059765234056863, 1.1250849762066621, 1.0238883571742674, 1.004701600060666, 1.227027027027027, 1.1212534059945505, 1.0, 1.1846153846153846, 1.0542106352162217, 1.071692299519218, 1.0825753305874701, 1.0658389338193417, 1.0196528841245533, 1.1246753246753247, 1.0718277252225283, 1.1296625222024868, 1.0027882085759898, 1.0963685310340932, 1.2424242424242424, 1.0912052117263844, 1.0, 1.2422535211267605, 1.2074452794546424, 3.0, 1.1067238267148014, 1.0893916564648272, 1.4285714285714286, 1.0146198830409356, 1.1, 1.1176470588235294, 1.0418972565339946, 1.6923076923076923, 1.0343291879675622, 1.0495514737291756, 1.3571428571428572, 1.0, 1.1257731958762887, 1.003347680535629, 1.0258278145695365, 1.0295568030270137, 1.1572711170830026, 1.0, 1.0286226374103846, 1.1189024390243902, 2.0, 1.0241891668438334, 1.0971883380915304, 1.1381267738883634, 1.017485434111242, 1.113332060756456, 1.0272727272727273, 2.0, 1.0144541650817802, 1.0114192495921697, 1.1043557938676123, 1.2256745707277188, 1.0040681457819751, 1.0274871480516585, 1.1868131868131868, 1.102091020910209, 1.160535117056856, 1.065495349705689, 1.0662460567823344, 1.0797101449275361, 1.0561974789915967, 1.0701996322563698, 3.0, 1.134478399881032, 1.0395779727397672, 1.037015650620196, 1.5833333333333333, 1.2493403693931397, 1.014760147601476, 1.1428571428571428, 1.0924737250476124, 1.0420575865415722, 1.1135371179039302, 1.0294117647058822, 1.3333333333333333, 1.0804878588989213, 1.5, 1.0210280373831775, 1.0833333333333333, 1.0317144651454888, 1.3846153846153846, 1.1223628691983123, 1.0723270440251573, 1.0, 1.6917989417989419, 1.2709891936824604, 1.25, 2.0, 1.0901639344262295, 1.186206896551724, 1.0672588832487309, 1.2171136653895274, 1.1327433628318584, 1.2713864306784661, 1.1014466214978942, 1.051948051948052, 1.144859813084112, 1.0775510204081633, 1.0, 1.0, 1.161214953271028, 1.0808080808080809, 1.1, 1.0192185850052797, 1.080010084775141, 1.0670785525154458, 1.069390507811342, 1.1658834586466165, 1.1720733427362482, 1.0096385542168675, 1.5714285714285714, 1.0, 1.2592592592592593, 1.0309099187979054, 1.0511915269196823, 1.107843137254902, 1.215568862275449, 1.0523100420007636, 1.0686051664736744, 1.0101841586597684, 1.1142857142857143, 1.2222222222222223, 1.0392307692307692, 1.022600742311771, 1.0767924559407818, 1.0305659606347477, 1.0066225165562914, 1.08616361488482, 1.0329006232844513, 1.2033898305084745, 1.3335030549898168, 1.2857142857142858, 1.0649038461538463, 1.1269035532994924, 1.1304347826086956, 1.0027322404371584, 1.0701001430615165, 1.0, 1.042857142857143, 1.01208073228321, 1.1296296296296295, 1.0597919104594051, 1.0031880977683316, 1.303030303030303, 1.0428833154336976, 1.0111391492429704, 1.0650349180768197, 1.0534351145038168, 1.0863131935881627, 1.2000946873626188, 1.1814345991561181, 1.3571428571428572, 1.0, 1.4285714285714286, 1.0628799806225022, 1.3333333333333333, 1.171830540625988, 1.1158795972214743, 1.0283562250775367, 1.0667328699106255, 1.0573272037258923, 1.1083601286173634, 1.021505376344086, 1.0332871012482663, 1.009317397327823, 1.1172665916760405, 1.045809792607669, 1.2162170299891606, 1.6666666666666667, 1.0491803278688525, 1.0395256916996047, 1.0646469548337898, 1.01628664495114, 1.2948402948402948, 1.0521415270018621, 2.1737288135593222, 1.0838532429693437, 1.044295302013423, 1.030657894736842, 1.125, 1.1178252888711082, 1.0357929751463868, 1.262189054726368, 1.0581052631578947, 1.103448275862069, 1.119904076738609, 1.0806451612903225, 1.5625, 1.067615273775216, 1.5, 1.0504032258064515, 1.1070559610705597, 1.0330411328388402, 1.007745411685469, 1.015531660692951, 1.8333333333333333, 1.0717703349282297, 1.0936982977315342, 1.0765875881993443, 1.0035799002608659, 1.0742461430575034, 1.0876712328767124, 1.0, 1.1133567662565904, 1.0215525843145081, 1.0004019651630192, 1.032064128256513, 1.0208333333333333, 1.026851851851852, 1.03823056753785, 1.3797595190380763, 1.0867463026166098, 1.0, 1.3333333333333333, 1.0343939281564438, 1.0476120283018868, 1.2059845291583677, 1.1155036604577888, 1.0869912210694335, 1.1363636363636365, 1.1089885757656406, 1.0985122104774843, 1.1158088235294117, 1.0, 1.0585618977020015, 1.1106120846218033, 1.1071428571428572, 1.75, 1.0643535483586983, 1.1698602180145452, 1.01270207852194, 1.0113636363636365, 1.2487328023171615, 1.0024336821611097, 1.1605285352825414, 1.6, 1.2307692307692308, 1.0357142857142858, 1.1020881670533642, 1.146875, 1.4333333333333333, 1.0264945804000447, 1.1813676907829533, 1.169983416252073, 1.024390243902439, 1.017387233757983, 1.0745293891663465, 1.0697456492637216, 1.2983759160229749, 1.3333333333333333, 1.2727272727272727, 1.3333333333333333, 1.1480320445837686, 1.3076923076923077, 1.0, 1.1538461538461537, 1.0230352303523036, 1.0126811594202898, 1.0995305519800107, 1.0341062547346926, 1.1818181818181819, 1.2830188679245282, 1.1428571428571428, 1.064516129032258, 1.0135135135135136, 1.0142857142857142, 1.1464285714285714, 1.0239188723718957, 1.0339245297020518, 1.3333333333333333, 1.0837624723880648, 1.0469395926129823, 2.5, 1.0684223061481406, 1.2939001848428835, 3.0, 2.0, 1.2328402366863904, 1.1245786416122785, 1.044508577044123, 1.220496894409938, 1.0, 1.075, 1.0582822085889572, 3.0, 2.0, 1.075541338582677, 1.2310794461621186, 1.0148694239660128, 1.6666666666666667, 1.0246538560637908, 1.04570100697134, 1.0495156081808397, 1.125, 1.0422535211267605, 1.0263113410952998, 1.027027027027027, 1.1595845136921623, 1.0044807231497535, 1.328125, 1.05859375, 1.1175420232744289, 1.080258302583026, 1.0909090909090908, 1.1129032258064515, 1.0185870251736895, 1.4999082737112457, 1.0716805016210054, 1.5045045045045045, 1.1470588235294117, 1.208955223880597, 1.045632333767927, 1.0633228840125393, 1.0214408058398923, 1.0673768921249283, 1.009825327510917, 1.5, 1.6666666666666667, 1.0443009652879882, 1.15259454705365, 1.0315113791091228, 1.0159791853315496, 1.0729218932931928, 1.1166305778457097, 1.2894736842105263, 1.0, 1.1297853942300133, 1.0848760041914076, 1.2386861313868613, 1.0214669051878353, 1.6666666666666667, 1.056338028169014, 1.0059413978891432, 1.145947426067908, 1.0466293327237997, 1.0827669716634405, 1.0, 2.0, 1.107373868046572, 1.0156596345350082, 1.1859721270276444, 1.167300380228137, 1.0893589376817814, 1.0063694267515924, 1.249448123620309, 1.007536231884058, 1.0327080588911994, 1.057791059853523, 1.0299539170506913, 1.0611413043478262, 1.0, 1.1872590789206736, 1.055215284760947, 1.0299319727891156, 1.096781191838226, 1.1453154875717018, 1.021180030257186, 1.2, 1.2493368700265253, 1.6666666666666667, 2.0, 1.2352941176470589, 1.0077319587628866, 1.0347551342812007, 1.0045510500988548, 1.0031564090500833, 1.11904038870331, 1.040794979079498, 1.1630434782608696, 1.0888888888888888, 1.0634272606746775, 1.6, 1.5, 1.2304921968787514, 1.1428571428571428, 1.0836940836940836, 1.1273538156590683, 1.0221721496169445, 1.0854960964762785, 2.0, 1.0359133126934985, 1.2306201550387597, 1.2060150375939849, 1.0397396258612623, 1.1363636363636365, 1.1232876712328768, 1.1359523967527152, 1.1882112261859097, 1.003189792663477, 1.1639344262295082, 1.0614525139664805, 1.0, 1.0, 1.041879761095812, 5.0, 1.5714285714285714, 1.8620689655172413, 1.0132689987937273, 1.0804597701149425, 1.0737250554323725, 1.109846998823068, 1.0, 1.090626939788951, 1.012266355140187, 1.1675392670157068, 1.2908653846153846, 1.4285714285714286, 1.0169720130381028, 1.206208425720621, 1.1419068736141906, 1.017106731126813, 1.0450657694724255, 1.1273994746413416, 1.129843241644484, 1.0, 1.1902948766763972, 1.0337080481357441, 1.0090118364418939, 1.1774193548387097, 1.092737488841044]
origin-bjaq_15.71 	max: 5.0000	99th: 2.5000	95th: 1.6667	median: 1.0769	mean: 1.1676

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 14.152551 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[1.1920929e-07 5.9604645e-08 7.1525574e-07 1.7881393e-07 5.9604645e-08]
Distance score: 2.2649764730431343e-07
SAUCE Drift detection: False
Detection latency: 0.0232s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.042643 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 6.0000	99th: 2.5724	95th: 1.7183	median: 1.0768	mean: 1.1805
ReportEsts: [1.03485254691689, 1.0013066202090593, 1.0374564354883447, 1.0373514431239388, 1.5416666666666667, 1.0, 1.0756310234052318, 1.0670380169892772, 1.2, 1.014115092290988, 1.0965530466465314, 1.0420765683903817, 1.0205479452054795, 1.1310211946050097, 1.109997051017399, 1.2868217054263567, 1.1629392971246006, 1.2117647058823529, 1.5454545454545454, 1.1871838111298483, 1.0788978643355096, 1.064073103849748, 1.1716961498439127, 1.044314381270903, 1.0005022427737655, 1.029093018021917, 2.0, 1.1688934774687234, 1.5, 1.3333333333333333, 1.0225225225225225, 1.0, 1.0415248018784855, 1.0023178833417519, 1.0689814814814815, 1.032760736196319, 1.2207836925831554, 1.1079295154185023, 1.25, 1.010752688172043, 1.0234447110947018, 1.0039695882836435, 1.0606407322654463, 1.071504802561366, 1.022099447513812, 1.073323784189346, 1.1363636363636365, 1.0683994528043776, 1.0701754385964912, 1.0618705035971223, 1.1, 1.2731481481481481, 1.0625, 1.0, 1.0115874296864649, 1.031426167437947, 1.031461971424448, 1.2165775401069518, 1.1111111111111112, 1.0548145299027891, 1.1940298507462686, 1.1403184544435603, 1.0766823161189358, 1.15625, 1.0384615384615385, 2.0, 1.070871722182849, 1.324661246612466, 1.6, 1.0, 1.0578635014836795, 1.019019019019019, 1.0589094449853944, 1.0521235521235521, 1.0902299295502051, 1.049043062200957, 1.006300053390283, 1.2074468085106382, 1.5048543689320388, 1.0799437453197203, 1.0546500479386385, 1.0727272727272728, 2.0, 2.0, 1.0847651775486826, 1.096774193548387, 1.0208655332302936, 1.08, 4.0, 1.1227517122191641, 1.112063778580024, 1.164584939604215, 1.0617306068128887, 1.2110935612747376, 1.122715404699739, 1.0118906064209274, 1.4017094017094016, 1.037084398976982, 2.0, 1.3001181567546278, 1.0357142857142858, 2.0, 1.078686678213978, 1.1389247311827957, 1.0385438972162742, 1.2171205668682676, 1.3125, 1.021306684265108, 1.009504862953139, 1.343668062008372, 1.1402613962384445, 1.059274399591211, 1.0, 1.0, 1.0495900039047248, 1.0416426397920528, 1.0594679186228482, 1.0106382978723405, 1.05475799086758, 1.0, 1.1257563799000263, 1.2036156041864892, 1.0, 1.0, 1.0, 1.1509054325955734, 1.0263158670759722, 1.0963207669387227, 1.098360655737705, 2.5, 1.1208191126279863, 1.0, 1.4, 1.1345605154164748, 1.2307692307692308, 1.12987012987013, 1.0067182138241455, 1.0621900038153376, 1.0, 1.7142857142857142, 1.022964509394572, 1.130316742081448, 1.0750766087844739, 1.0181612509397913, 1.2402597402597402, 1.0393569844789357, 1.1187513311224024, 3.0, 1.029051987767584, 1.0387890255439924, 1.119496855345912, 1.0944199706314244, 1.5, 1.2528434826371415, 1.0740740740740742, 1.022108843537415, 1.1152263374485596, 2.0, 1.0175077239958805, 1.1321645142465684, 1.1183238159220692, 1.064784053156146, 1.0911528150134049, 1.25, 1.36, 1.0488721804511278, 1.7142857142857142, 1.059341467464792, 1.0, 1.106578947368421, 1.2396357483190097, 1.0384615384615385, 1.0583236610843973, 1.3183391003460208, 1.1710794297352343, 1.050230900105323, 1.1220472440944882, 1.020393299344501, 1.0537897310513447, 1.0615671641791045, 1.0109156193895872, 1.2185050609914352, 1.1566265060240963, 2.5714285714285716, 1.014262146024128, 1.0696814066852367, 1.3726937269372694, 1.1581163553020815, 1.013953488372093, 1.0833333333333333, 1.2592592592592593, 1.0718017529334514, 1.2608695652173914, 1.1245019920318724, 1.1040432655163532, 1.0379548109630035, 1.0232686352605356, 1.0587084148727985, 1.0641746444303652, 1.1143514635352818, 1.0028536485935589, 1.0247155401985166, 1.0171878730007162, 1.0582864418776616, 1.072872590503056, 1.128606615059817, 1.12, 1.0895522388059702, 1.1951219512195121, 1.0, 1.4057971014492754, 1.1002432130414777, 1.3410404624277457, 1.2549019607843137, 1.007799671592775, 1.6818181818181819, 1.0483110109372518, 1.002257336343115, 1.2273454370950971, 2.0, 1.0681003584229392, 1.0150519978106185, 1.0136224465387744, 1.0142700224461532, 1.25, 2.176470588235294, 1.0727484192248469, 1.0219806297554248, 1.0406504065040652, 1.001700680272109, 1.061917808219178, 1.0439120488052873, 1.3636363636363635, 1.003540141465455, 1.027277453096202, 1.103030303030303, 1.0008928571428573, 1.0602272727272728, 1.125, 1.1318537859007833, 2.0, 1.2255441281989954, 1.0782681486304238, 1.120364977674238, 1.167832167832168, 1.1666666666666667, 1.2, 1.1219340556231583, 1.0895522388059702, 1.098932989388521, 1.4, 1.0441079657669519, 1.033437826541275, 1.0, 1.0120556072775473, 1.0654205607476634, 1.1263345195729537, 1.0375234521575984, 1.0045154567558179, 1.0981255645889791, 1.0147058823529411, 2.0, 1.0891664669018184, 1.0533389332213356, 1.1524663677130045, 1.022552783109405, 1.1237378548294914, 1.031358688764662, 1.0978332239001969, 1.0754526130616433, 1.0384615384615385, 1.0009293680297398, 1.039683377308707, 1.1333333333333333, 1.0393138030044526, 1.1595744680851063, 1.1666666666666667, 1.5217391304347827, 1.0785542168674698, 1.0627705627705628, 1.010938963877997, 1.0021408015722608, 1.1755196304849884, 1.3162217659137576, 1.0392561358202783, 1.0251748251748252, 1.0837260273972602, 1.0544686682795172, 1.1818181818181819, 1.065217391304348, 1.059286146400484, 1.0680049004314511, 1.0914634146341464, 1.0351098986404064, 1.2573684210526315, 1.2072892938496582, 1.0369027303754266, 1.0751347137967262, 1.123753432576962, 1.0944051428489432, 1.0264840182648403, 1.054054054054054, 1.0666666666666667, 1.087407853166842, 1.4, 1.0177935943060499, 1.0016068784493202, 1.094865399501161, 1.5294117647058822, 1.0583333333333333, 1.0234986945169713, 1.133806986382475, 1.0408573137827049, 1.1304347826086956, 1.1907940969782151, 1.0149662668790296, 1.0778301886792452, 3.0, 2.75, 1.014207650273224, 1.1111111111111112, 1.0168449917185003, 1.0126984126984127, 1.1904761904761905, 1.0694708771609933, 1.1851851851851851, 1.3076923076923077, 1.01470759193566, 2.0, 1.0249520153550864, 1.0364520048602672, 1.072813506741439, 1.0266038053544368, 1.0042826552462527, 1.2857142857142858, 1.0953903303877977, 1.1041873535034215, 1.037174721189591, 1.0690184497529311, 1.1432729196983729, 1.5, 1.0, 1.0541254062502978, 1.5, 1.0609869646182495, 1.4210526315789473, 1.0, 1.4444444444444444, 1.3440677966101695, 1.0439905734485468, 1.3305785123966942, 1.3902439024390243, 1.2875, 1.6666666666666667, 1.0703655763000666, 1.0434782608695652, 1.0285714285714285, 1.0030319034485458, 1.1570247933884297, 1.0729086722947045, 1.0055555555555555, 1.4, 1.25, 1.3008130081300813, 1.2692307692307692, 1.0048543689320388, 1.1323572959975363, 1.2523271689214348, 1.0380710659898478, 1.0, 1.0291444122655102, 1.0590405904059041, 1.48, 2.0, 1.0390969162995596, 1.0, 1.1336206896551724, 1.116504854368932, 1.3230777821207214, 1.0945264242837753, 1.070640756302521, 1.0837331007413868, 1.1118262268704746, 1.0097799511002445, 1.0976331360946745, 1.0872826457551994, 1.086092715231788, 1.0303030303030303, 1.0030039958813137, 1.066777931609991, 1.2173913043478262, 1.0147783251231528, 1.0476190476190477, 1.1451942740286298, 2.0, 1.0416666666666667, 1.7179487179487178, 1.222444889779559, 1.3202614379084967, 1.1339712918660287, 1.0731707317073171, 1.7246376811594204, 1.062076749435666, 1.0678095238095238, 1.0473100061739917, 1.0957446808510638, 1.1217391304347826, 1.1099744245524297, 1.0, 1.100782907613612, 1.607843137254902, 1.108509272198512, 1.0698413624168903, 1.0420595844112492, 1.1401795142555438, 1.375, 1.2538808212318477, 1.1428571428571428, 1.368814968814969, 1.0, 1.0973090363902944, 1.0133819951338199, 1.1116487455197133, 1.193979933110368, 1.1042584434654918, 4.0, 1.2794026135656502, 1.0149339489547262, 1.2098156223701324, 2.0, 1.048780487804878, 1.3137096774193548, 1.2730061349693251, 1.1207915971062883, 1.232937181663837, 1.0416666666666667, 1.0942712110224802, 1.028171481971809, 1.085102791749654, 1.1537533916189329, 1.0531203333040522, 1.284596708929053, 1.2, 1.0452847805788983, 1.0966863549904895, 1.1015625, 1.0406320541760723, 1.0, 1.0, 1.1599740932642486, 1.141732283464567, 1.0291534949069197, 1.11680128315289, 1.0566037735849056, 1.0, 1.1391304347826088, 1.1290322580645162, 1.1703305171423368, 1.25, 1.0, 1.0811332127787825, 1.3333333333333333, 1.0, 1.0259388308168795, 1.75, 1.048780487804878, 1.0, 1.0280898876404494, 1.3, 1.0634323726350685, 1.1145374449339207, 1.55, 1.067045096184169, 1.0222222222222221, 1.080906148867314, 1.0579905596763317, 1.3271648044692737, 1.0493383199079402, 1.0, 1.035294117647059, 1.083137824451644, 1.115951631605102, 1.0498417721518987, 2.0, 1.0912081886309632, 1.0102307458676159, 1.0165073848827106, 2.0, 1.0469576719576719, 1.0599887754889938, 1.0527605147115706, 1.0374531835205993, 1.0101423963150513, 1.1234776360696965, 1.0267983074753173, 1.102438599926037, 3.0, 1.0645804438280166, 1.0235426008968609, 1.042836398838335, 1.0328324986087924, 1.0026455026455026, 1.0043731015891726, 1.6294117647058823, 1.036053115814461, 1.023046875, 1.0959446295821584, 1.0635036496350365, 1.1227515860181614, 1.0015845468950426, 1.0459770114942528, 1.1975308641975309, 1.0856514770445171, 1.098901098901099, 1.0058195153061225, 1.0578703130494214, 1.3333333333333333, 1.0867424242424242, 1.30635838150289, 1.076271186440678, 1.1964285714285714, 1.0214844980240834, 1.144404332129964, 1.0314192849404118, 2.0, 2.0, 1.0066074276600592, 1.1501395697167756, 1.0325744956505645, 1.039767575506034, 1.1379035472299721, 1.2698412698412698, 1.0168024439918533, 1.0347009841029524, 1.3989071038251366, 1.0096818488607535, 1.0665258711721224, 1.0478468899521531, 1.12836634642865, 1.0819536423841059, 1.0106413313977602, 2.0, 1.0986193293885602, 1.0297029702970297, 1.0644074514466904, 1.1196388261851016, 1.038387715930902, 1.0562700964630225, 1.2, 1.1077815422738286, 2.0, 1.4074074074074074, 1.2, 1.0, 1.0892857142857142, 1.225, 1.0208877284595301, 1.015625, 1.0685316557355107, 1.110463421742932, 1.005059553669968, 1.183409510843139, 1.0522344167451516, 1.1441426715646212, 1.0144701756654115, 1.0872628726287263, 1.0195166346445546, 1.0601717568105558, 1.06660088801184, 1.0584988962472406, 1.1666666666666667, 1.1986754966887416, 1.004859437751004, 1.143843498273878, 1.099768072644365, 1.2640449438202248, 1.0072011521843496, 1.1082431307243963, 2.0, 1.040391676866585, 1.5, 1.0, 1.5571428571428572, 1.0607903458556, 1.0306542056074766, 1.013089005235602, 1.1016042780748663, 1.0601323684684916, 1.0415834392591248, 1.0840950639853748, 1.2, 2.0, 1.0563372322992597, 1.0695652173913044, 1.0416832076220723, 1.1175650557620818, 1.0, 1.1300898995240614, 1.184782608695652, 1.1593610430773664, 1.092511013215859, 1.0255922839217155, 1.0936755552140167, 1.0070423455663808, 1.303030303030303, 1.5, 1.1740411399185773, 1.0, 1.0400943396226414, 1.1814345991561181, 1.3563218390804597, 1.1253153910849454, 1.625, 1.0745853193517636, 1.1172413793103448, 1.4701492537313432, 1.0216884604748548, 1.1858064516129032, 1.1800687285223368, 1.0844149207971385, 1.0081227436823104, 1.0663194444444444, 1.6, 1.0402689692060825, 1.0784734727801635, 1.0, 1.013157894736842, 1.1363009289064656, 1.2331730769230769, 1.005165905026823, 1.3333333333333333, 1.0373665480427046, 1.0606444076705928, 1.4730679156908666, 1.0454545454545454, 1.0001921695102185, 1.0555555555555556, 1.75, 1.1210078069552873, 1.0040513166779204, 1.1414859981933152, 1.1702886798572818, 1.0010963066966068, 1.0348956352491108, 1.0849772382397571, 1.0675496688741721, 1.2485875706214689, 1.1061323780735024, 1.063063063063063, 1.0670180722891567, 1.0070144673388866, 1.0004548211036992, 1.1923076923076923, 1.01283105773976, 1.0416666666666667, 1.6, 1.0431565967940815, 1.619517862329364, 1.0340346534653466, 1.2301587301587302, 1.2142857142857142, 1.0249597423510468, 1.036889692585895, 1.018987341772152, 1.073088335057869, 2.3333333333333335, 1.082262153627185, 1.5, 1.0554455445544555, 1.1333333333333333, 1.0866749905630244, 1.3870967741935485, 1.213768115942029, 1.0017182130584192, 1.0, 1.2218385539621577, 1.2944483485593816, 1.5, 1.6666666666666667, 1.0763888888888888, 1.2202380952380953, 1.0002489419965148, 1.2198731501057083, 1.0774748923959827, 1.04, 1.0555555555555556, 1.1223958333333333, 1.221311475409836, 1.180887372013652, 1.032258064516129, 1.0, 1.2408759124087592, 1.1041916167664672, 1.0173310225303294, 1.1478568619740463, 1.0768815909352714, 1.0446049888577384, 1.0786603496563891, 1.1009445634788906, 1.1367816091954024, 1.0297079556898288, 1.7142857142857142, 1.0, 1.25, 1.0144612291096258, 1.0404114621601763, 1.1400560224089635, 1.0164271047227926, 1.0230097520555803, 1.032019959299585, 1.012406558524075, 1.1341463414634145, 1.2857142857142858, 1.213235294117647, 1.033070605743262, 1.1187320789169604, 1.0011241279742553, 1.0397727272727273, 1.0740058910162003, 1.0267687036710909, 1.0417426175720015, 1.0941000746825988, 1.1005475594493117, 1.1246006389776357, 1.0545023696682465, 1.041237113402062, 1.0399919393251016, 1.380952380952381, 1.5168539325842696, 1.0, 1.0328820116054158, 1.0237576526391263, 1.0833333333333333, 1.0544016351015966, 1.0052585451358458, 1.175, 1.036089911134344, 1.0210371526318949, 1.0526536312849162, 1.0325138778747027, 1.0684410646387832, 1.2059372349448685, 1.2107142857142856, 1.5333333333333334, 1.0, 1.25, 1.0741354234001292, 1.6666666666666667, 1.0985459394247254, 1.108665441341283, 1.051829834664685, 1.0600565629678922, 1.0483243173179928, 1.0280557541100785, 1.0246913580246915, 1.0, 1.0147595843362884, 1.1485895131671486, 1.042183168358045, 1.2093774250882419, 1.375, 1.0093283582089552, 1.0130718954248366, 1.0635803093096128, 1.0935828877005347, 1.2855197458011802, 1.057052297939778, 2.315985130111524, 1.0262322733803961, 1.0416197975253094, 1.0648179517327967, 1.15, 1.0576082268057407, 1.0311294981431154, 1.222356252513068, 1.0661244695898162, 1.2580645161290323, 1.01875, 1.0711659095825221, 1.0380899145572147, 1.0087527352297594, 1.019171042834189, 1.1142857142857143, 1.0790035044948956, 1.0726468730259002, 1.0189633375474083, 1.212676056338028, 1.0064456721915285, 1.0762970498474058, 1.0612951062778053, 1.0063160285376416, 1.0794573643410852, 1.0087040373537697, 1.085294356836043, 1.0, 1.059691011235955, 1.0903283052351376, 1.0430863926137612, 1.1202600216684724, 1.0675381263616557, 1.1213640922768304, 1.1839622641509433, 1.038860103626943, 1.0216164666613685, 1.0, 1.1043731778425656, 1.2305136314504184, 1.0479673047967304, 1.009433962264151, 1.071016801418653, 1.184701463701139, 1.0461741424802111, 1.079591836734694, 1.0935760382284843, 1.07297072029683, 1.1598793363499247, 1.058252427184466, 1.0376442015786278, 1.0918328750038335, 1.107843137254902, 2.25, 1.0487525170891163, 1.1773772985305702, 1.048975512243878, 1.0, 1.2472113355441665, 1.0129562118783866, 1.1514726507713886, 1.1105495893872395, 1.2903225806451613, 1.0737986270022883, 1.030612244897959, 1.1368421052631579, 1.5757575757575757, 1.086691143581333, 1.1712887438825448, 1.4615384615384615, 1.02, 1.2439024390243902, 1.1427801724137931, 1.0485436893203883, 1.1666666666666667, 1.0454828660436137, 1.0077821011673151, 1.190894130554032, 1.0, 1.0188760913400126, 1.3431372549019607, 1.0675691310887423, 1.3425925925925926, 1.2, 1.3011695906432748, 1.0344546411469067, 1.0678880378304143, 1.2723146747352496, 1.3870967741935485, 1.0588235294117647, 1.0263157894736843, 1.0674157303370786, 1.0595238095238095, 1.0590665014456837, 1.0332760013624553, 1.0309314684795816, 1.2782608695652173, 1.0804549931398055, 1.0480084102324494, 2.5, 1.049645441625989, 1.0060735977134692, 1.5, 2.5, 1.1839506172839507, 1.118717348225545, 1.0582364127294313, 1.3015463917525774, 1.0, 1.1263537906137184, 1.0567567567567568, 1.2, 1.0944490967819116, 1.0786359709862747, 1.0639184345269044, 1.0305676855895196, 1.75, 1.0217331274514223, 1.0305927342256214, 1.0113240418118468, 1.1111111111111112, 1.0186046511627906, 1.0, 1.0186335403726707, 1.145954356846473, 1.0068531898042639, 1.0, 1.119205298013245, 1.0530877048585054, 1.0564885496183205, 1.0859106529209621, 1.051948051948052, 1.0219088907427414, 1.281201044386423, 1.0721522115147022, 1.345, 1.2619047619047619, 1.206896551724138, 1.125, 1.0885997521685253, 1.0580808080808082, 1.015500281195426, 1.0643974241030358, 4.0, 1.0917280917280918, 1.0243932538050184, 1.1826783114992723, 1.0493827160493827, 1.0090333563866574, 1.1143808995002775, 1.10655278633436, 1.403183023872679, 1.0178571428571428, 1.0679541734860885, 1.068234106790055, 1.2206320810971973, 1.1512605042016806, 2.6666666666666665, 1.0229885057471264, 1.0071380013596194, 1.0706605222734256, 1.0235345826507372, 1.0969628439937484, 1.0408042578356003, 1.8, 1.069327731092437, 1.0141006523765144, 1.172794818060583, 1.0289389067524115, 1.0605053785869663, 1.1071428571428572, 1.1028880866425992, 1.016160626836435, 1.032143710546295, 1.1069655079855052, 1.0378787878787878, 1.0659840728100114, 1.0263157894736843, 1.2115832112384728, 1.0489179116600067, 1.0570006422607579, 1.08954885513489, 1.11012987012987, 1.0215736040609138, 1.0285714285714285, 1.2437923250564333, 2.3333333333333335, 2.5, 1.2, 1.0150862068965518, 1.0520156046814044, 1.0050356822886095, 1.0175362902794467, 1.031810035842294, 1.0475281873373807, 1.1576576576576576, 1.0054911531421598, 1.0517020717061625, 1.5, 1.6153846153846154, 1.117451690821256, 1.1111111111111112, 1.1643312101910828, 1.1657315494173501, 1.0441937000470145, 1.0972897986804264, 3.5, 1.1609254498714654, 1.0413223140495869, 1.0541381338088283, 1.0404523938793768, 1.1718249733191035, 1.1277205040091638, 1.1570069609921758, 1.1141407105184595, 1.0927152317880795, 1.1111111111111112, 1.0617142857142856, 1.3333333333333333, 2.0, 1.042014301631012, 6.0, 1.8571428571428572, 1.7567567567567568, 1.027806385169928, 1.103044550998557, 1.0581005586592178, 1.0426356589147288, 1.1428571428571428, 1.1165835007452531, 1.0228933268387725, 1.5, 1.360323886639676]
origin-bjaq_15.71 	max: 6.0000	99th: 2.5724	95th: 1.7183	median: 1.0768	mean: 1.1805

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.163628 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.393585