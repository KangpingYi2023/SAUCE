Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 34, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.5000	95th: 1.6667	median: 1.0842	mean: 1.1740
ReportEsts: [1.0888888888888888, 1.0153645833333333, 1.0359865746567714, 1.0924369747899159, 1.5, 1.0, 1.1099070324530884, 1.060424866043909, 1.0, 1.0196335078534031, 1.1651805038524803, 1.04322588501662, 1.0411018801923917, 1.1, 1.0490992582126457, 1.0, 1.125, 1.0524264966347856, 3.0, 2.0, 1.2272727272727273, 1.0823490966808271, 1.086097844326836, 1.0963006459189666, 1.080414405525407, 1.0, 1.1760969340921608, 1.5, 1.2, 1.0287769784172662, 1.0, 1.044404212571479, 1.006298340147508, 1.1176470588235294, 1.0469966221177853, 1.2260126162018592, 1.1871657754010696, 1.0134110930656037, 1.1237688546043116, 1.105263157894737, 1.342512908777969, 1.0670731707317074, 1.0, 1.0525991731902542, 1.1612036539494894, 1.890625, 1.0510204081632653, 1.2367491166077738, 1.022675340516365, 1.0740740740740742, 1.0974922997607308, 1.2285223367697595, 1.0374906436483249, 2.0, 1.07012987012987, 1.2346098852262628, 1.040090771558245, 1.3592233009708738, 1.0, 1.25, 1.0684750999636496, 1.0815691158156913, 1.1090909090909091, 1.0235294117647058, 1.0909090909090908, 1.1111923076923076, 1.261138613861386, 1.75, 1.0, 1.0594760883751282, 1.0167064439140812, 1.062137049941928, 1.0398126463700235, 1.1281248494773854, 1.0541176470588236, 1.108829568788501, 1.0, 1.1110647181628392, 2.0, 1.0455536744239433, 1.2307692307692308, 1.0487129536400648, 1.196319018404908, 1.0968553459119497, 1.1133464180569186, 1.04, 1.0797292288484424, 1.0087471118027067, 1.0, 1.75, 1.0711217183770882, 1.0665839269223756, 1.1214953271028036, 1.0140252454417953, 1.0148285449490269, 1.0158311345646438, 1.0150375939849625, 1.1467710371819961, 1.0, 1.2315384615384615, 1.019674056673029, 1.088336192109777, 1.2314344066397254, 1.2142857142857142, 1.030870462836978, 1.0236262277674542, 1.2563428217821782, 1.161167993932499, 1.0490496627835684, 1.1666666666666667, 1.6666666666666667, 1.0511682242990654, 1.1005489190344424, 1.0448515476942515, 1.0389610389610389, 1.0590695275947075, 1.0, 1.1264585304320405, 1.110520722635494, 1.0, 1.011111111111111, 1.1666666666666667, 1.2305764411027569, 1.0173112091317158, 1.0556806709637339, 1.108910891089109, 1.8, 1.2458609271523178, 1.0, 1.0, 1.100602181758698, 1.3, 1.0944010416666667, 1.01808110433532, 1.0651539167431383, 1.02803738317757, 1.0579710144927537, 1.0171473109898674, 1.039972432804962, 1.0749542961608776, 1.0324617529010698, 1.208955223880597, 1.0078895463510849, 1.1683318932470093, 2.0, 1.0182315405651778, 1.0022857142857142, 1.1010928961748634, 1.0974060349391213, 1.5, 1.1844272220876726, 1.0514018691588785, 1.0416666666666667, 1.1074561403508771, 1.1985401459854015, 1.022053756030324, 1.0891414724209554, 1.286949457436314, 1.0562248995983936, 1.0986842105263157, 1.3061224489795917, 1.2212389380530972, 1.0119225037257824, 1.4285714285714286, 1.047324736225088, 1.0162639440636223, 1.1800271739130435, 1.3418606879371466, 1.125085910652921, 1.075243168747184, 1.305263157894737, 1.1306413301662708, 1.1338239566185726, 1.044489383215369, 1.0163934426229508, 1.1068999028182702, 1.0364092906465787, 1.0968427314834488, 1.0723283793347487, 1.0, 1.1775700934579438, 1.0134067174710697, 1.0277113237639552, 1.1323837452869712, 1.0, 1.0919385512114401, 1.2683067461080146, 1.0834577841265718, 1.1372549019607843, 1.0745454545454545, 1.0805937968550576, 1.0, 1.3636363636363635, 1.0581090351478957, 1.034037558685446, 1.0078996282527881, 1.5217391304347827, 1.0662379421221866, 1.0482126432942651, 1.0703332661619216, 1.0626410835214446, 1.1800358385158638, 1.3333333333333333, 1.0491803278688525, 1.1830985915492958, 1.0, 1.391304347826087, 1.0417915155338275, 1.2961672473867596, 1.3448275862068966, 1.009391992090954, 1.0031277926720286, 1.0166158669337282, 1.042031960936633, 1.207607843137255, 1.2137931034482758, 1.1170520231213872, 1.0071801566579635, 1.0392325808489862, 1.009289358305473, 1.0, 1.024016563146998, 1.1351702676619464, 1.01025042490813, 1.1468788249694002, 1.0202741439516338, 1.2763292847503374, 1.0740740740740742, 1.0047418512591595, 1.1491748323878288, 1.029892836999436, 1.0971428571428572, 1.151421065201815, 1.034, 1.0913385826771653, 2.0, 1.217841726618705, 1.1092563644484146, 1.1819034224097515, 1.2407407407407407, 1.0, 1.6666666666666667, 1.1123441374580116, 1.1454545454545455, 1.1164273179815922, 1.5, 1.0, 1.0526315789473684, 1.0765027322404372, 1.0714285714285714, 1.0331491712707181, 1.1265822784810127, 1.028052805280528, 1.0, 1.0846286366891853, 1.0363636363636364, 2.0, 1.0749388275450826, 1.1399296050058663, 1.1085814360770578, 1.0446584556254368, 1.1284211733012353, 1.0400163749872071, 1.0961844197138315, 1.0729538932802845, 1.0185406698564594, 1.021291696238467, 1.048140043763676, 1.0909090909090908, 1.0138471094006893, 1.1873417721518988, 1.1818181818181819, 1.4705882352941178, 1.0073260073260073, 1.1111111111111112, 1.0256410256410255, 1.1543906870331742, 1.2033426183844012, 1.3984962406015038, 1.0268775743228298, 1.0595637583892616, 1.032260154175034, 1.0493644315518116, 1.25, 1.0371407784648963, 2.5, 1.0534486232664897, 1.0647948164146868, 1.0386190887988713, 1.0810810810810811, 2.0, 1.3478260869565217, 1.0289855072463767, 1.0471085264905928, 1.0, 1.128440366972477, 1.0610859728506787, 1.0096153846153846, 1.0151683239626412, 1.0862068965517242, 1.119496855345912, 1.0049658979046547, 1.1241293769678466, 1.0414827155351936, 1.188034188034188, 1.0, 1.1217183770883055, 1.2340425531914894, 1.088135593220339, 1.0681550126368997, 1.0025020850708923, 1.180281690140845, 1.2553191489361701, 1.00960219478738, 1.0338757001867165, 1.2857142857142858, 1.0119383462778286, 1.0263157894736843, 1.0526315789473684, 1.1167907180385288, 1.3333333333333333, 1.2727272727272727, 1.0057651260592997, 2.0, 1.159122085048011, 1.0130813953488371, 1.1123872026251025, 1.0916597853014038, 1.0435967302452316, 1.1818181818181819, 1.11588360232146, 1.0825036716081238, 1.0381895332390383, 1.0397022967143514, 1.0852397130992828, 2.0, 1.0, 1.0444594254896136, 1.25, 1.068561872909699, 1.3529411764705883, 1.0, 1.375, 1.3413654618473896, 1.0669180018850142, 1.3298969072164948, 1.001082251082251, 1.0, 1.1691078561917443, 1.1173511173511173, 2.0, 1.0625372245384157, 1.0, 1.0974113717452365, 1.0113636363636365, 1.0389008532562767, 1.1451612903225807, 1.1363636363636365, 1.2191069574247144, 1.2685185185185186, 1.0109431416306467, 1.0197597161170073, 1.097953216374269, 1.0, 1.0769230769230769, 1.5714285714285714, 1.5, 1.2307692307692308, 1.0702375804004751, 1.3333333333333333, 1.1547420965058237, 1.1222222222222222, 1.1746934158828433, 1.099339942626453, 1.2173017507723995, 1.0140391064091059, 1.0121809744779582, 1.0845238095238094, 1.5, 1.2060301507537687, 1.0468085106382978, 1.0526431979199458, 1.0952380952380953, 1.5714285714285714, 1.0022321428571428, 1.0293237582286057, 1.0328763275695603, 1.02, 1.1464387464387464, 1.0213406292749658, 1.1428571428571428, 1.0907770515613653, 1.1101694915254237, 1.1730769230769231, 1.0269121813031161, 1.1826923076923077, 1.0544978768078472, 1.0755866756511294, 1.0316696508504923, 1.075, 1.009090909090909, 1.115264797507788, 1.0, 1.0207126377851834, 1.041843907281587, 1.023254204443214, 1.0543533801528169, 1.085305105853051, 1.1547505560851605, 1.5714285714285714, 1.3356958762886597, 1.0, 1.202391118701964, 1.25, 1.0287902076404998, 1.0014513788098693, 1.0542777300085984, 1.1264822134387351, 1.1026548672566372, 3.0, 1.2625739644970415, 1.0177820716221473, 1.1208846790509472, 2.0, 1.1428571428571428, 1.2456813819577734, 1.408906882591093, 1.1119684712715205, 1.4677754677754677, 1.2352941176470589, 1.1259706643658327, 1.0111783334121094, 1.0633459019646756, 1.0937241312927135, 1.0841008771929825, 1.0945273631840795, 1.2916666666666667, 1.875, 1.0914127423822715, 1.5, 1.2247284878863827, 1.03125, 1.145187483336161, 1.6666666666666667, 1.1073963678824938, 1.1136125384522848, 1.0475015422578655, 1.0, 1.175257731958763, 1.16, 1.2872670807453417, 1.0590809628008753, 1.0, 1.0242470295661785, 1.10018803429849, 1.0397845006216329, 1.5, 2.0, 1.0170873786407768, 1.0099547511312217, 1.0166666666666666, 1.2222222222222223, 1.0765188367716507, 1.033170731707317, 1.4705882352941178, 1.0179661016949153, 1.0545454545454545, 1.0183727034120735, 1.0024193548387097, 1.3887252839713926, 1.052310480217457, 1.0, 1.0571428571428572, 1.1020522556730856, 1.067059386499018, 1.02462643026158, 1.0, 1.1008626410086264, 1.01143919071994, 1.0220010476689365, 2.0, 1.041866028708134, 1.0042370886493104, 1.0438955456766863, 1.0461316674675636, 1.0107323204577716, 1.0416962805022507, 1.0109243697478991, 1.1837029893924782, 2.0, 1.0447568349785519, 1.3454545454545455, 1.2, 1.2072538860103628, 1.1153846153846154, 1.0058096889274164, 1.2376445846477393, 1.0611942580805473, 1.0688389169343735, 1.1016745522554436, 1.0661436493980794, 1.0594391853624143, 1.197674418604651, 4.0, 1.0128003841075501, 1.0880566801619433, 1.0475854295206455, 1.0517883005150537, 1.099695585996956, 1.065529010238908, 2.3222222222222224, 2.4285714285714284, 1.0074621415007061, 1.0319209385758694, 1.0000739398868719, 1.1168498168498169, 1.1047531816428846, 1.0125260960334028, 1.0652812545255188, 1.006514657980456, 1.2003058103975535, 3.0, 1.0909090909090908, 1.034920634920635, 1.0844529750479845, 1.077757685352622, 1.0950520833333333, 1.1098039215686275, 1.474074074074074, 1.148905109489051, 1.0769230769230769, 1.0911497707745088, 1.2696629213483146, 1.0030796236699875, 2.0, 1.0466165413533834, 1.0909090909090908, 1.2155172413793103, 1.0907821229050279, 1.1065375302663438, 1.0140280561122244, 1.0505836575875487, 1.1052148124819567, 1.0, 1.4893617021276595, 1.3333333333333333, 1.0, 1.1931818181818181, 1.0311850311850312, 1.0138888888888888, 1.1213592233009708, 1.0642422300544698, 1.0638051044083527, 1.0184988523860095, 1.169443643701355, 1.0290964777947933, 1.096223948646552, 1.0756756756756756, 1.1038536903984324, 1.0324141267537494, 1.0420645161290323, 1.2341040462427746, 1.0823357664233577, 1.045760908123448, 1.1769594912008094, 1.07946699399247, 2.0, 1.3194103194103195, 1.0744786494538232, 1.4339622641509433, 1.0, 1.1590909090909092, 1.3636363636363635, 1.3078703703703705, 1.2592592592592593, 1.1666666666666667, 1.008727237268716, 1.1228399249710659, 1.0355415297860782, 1.062725595572311, 1.145945945945946, 1.1289437585733881, 1.0, 1.1240875912408759, 1.0232429822746396, 1.0623157223683162, 1.085833065168422, 1.0765463036792344, 1.028049408131755, 1.1532467532467532, 1.1130569948186528, 1.1225577264653641, 1.0150570666188308, 1.1187334098909996, 1.2424242424242424, 1.0612460401267159, 1.0, 1.2387640449438202, 1.2108514362194995, 3.0, 1.1193518941122775, 1.106056984415336, 1.4285714285714286, 1.0468361113206124, 1.1, 1.1176470588235294, 1.0229882559209431, 1.6153846153846154, 1.0491642797578042, 1.06877402819308, 1.3571428571428572, 1.16, 1.0804123711340206, 1.0133907221425156, 1.0166068222621185, 1.0609140300415467, 1.156035508373753, 1.0, 1.0040191179665436, 1.1067073170731707, 2.0, 1.0091706817494124, 1.0974824811834933, 1.1031220435193945, 1.0131395459900028, 1.0737871993477375, 1.036697247706422, 1.8571428571428572, 1.00038037276531, 1.071774193548387, 1.0885242563589161, 1.2241731318905675, 1.0045157443162411, 1.01119970697622, 1.120879120879121, 1.1079967023907666, 1.193979933110368, 1.0590917929047425, 1.0548895899053627, 1.0498188405797102, 1.0383403361344539, 1.061624649859944, 3.0, 1.144984090772648, 1.0543741418884218, 1.0189317504241846, 1.4615384615384615, 1.3461324815997777, 1.011070110701107, 1.1428571428571428, 1.0564294279466742, 1.0420575865415722, 1.1441048034934498, 1.088235294117647, 1.3333333333333333, 1.0744038879426794, 1.5, 1.1121495327102804, 1.0833333333333333, 1.0263414974530738, 1.3846153846153846, 1.1772151898734178, 1.049266247379455, 1.0, 1.5727513227513228, 1.3090753424657535, 1.25, 2.0, 1.1271186440677967, 1.217241379310345, 1.0591939546599496, 1.2186700767263428, 1.095890410958904, 1.2536873156342183, 1.1014466214978942, 1.0545454545454545, 1.1395348837209303, 1.3551020408163266, 1.04, 1.0, 1.0201207243460764, 1.051948051948052, 1.033084311632871, 1.0826696578799775, 1.0970478452663726, 1.0212873796249367, 1.0660110277769543, 1.1436162521688837, 1.1687763713080168, 1.0041941282204914, 1.5714285714285714, 1.0, 1.2142857142857142, 1.0606435455718297, 1.0785525154457194, 1.107843137254902, 1.0463917525773196, 1.0241313478426881, 1.018947655398037, 1.0083675320084229, 1.1142857142857143, 1.2941176470588236, 1.06127258444619, 1.1331521739130435, 1.051635860114639, 1.0122282426918188, 1.0555555555555556, 1.0415682220909628, 1.0397286968653796, 1.1125356125356125, 1.3131364562118126, 1.0, 1.041862652869238, 2.253807106598985, 1.1304347826086956, 1.1362229102167183, 1.0701001430615165, 1.0, 1.045346062052506, 1.0361793045664014, 1.08, 1.0876300559628718, 1.013771186440678, 1.303030303030303, 1.036843956485692, 1.0316149963950974, 1.039047810905184, 1.0505725190839694, 1.0102156640181612, 1.1984330676752668, 1.1789473684210525, 1.3571428571428572, 1.0, 1.4285714285714286, 1.069226111178394, 1.3333333333333333, 1.2086413043478261, 1.0770017769640838, 1.0022153300841825, 1.0506454816285997, 1.0533139555209285, 1.022829581993569, 1.0465949820788532, 1.0485436893203883, 1.0012648942473175, 1.1444975628046494, 1.0391625529880002, 1.2700529928941346, 1.6666666666666667, 1.0158730158730158, 1.007905138339921, 1.1144060452702, 1.0, 1.2832792207792207, 1.0482374768089053, 2.220779220779221, 1.0527793158607113, 1.0416107382550335, 1.0842583732057416, 1.1875, 1.053279363659897, 1.0447994811371744, 1.251603354711396, 1.0581052631578947, 1.1428571428571428, 1.0506186726659168, 1.1618497109826589, 1.5, 1.0629819590402065, 1.8076923076923077, 1.2509457755359394, 1.1070559610705597, 1.0182063385030344, 1.0426615168539326, 1.009501187648456, 1.5714285714285714, 1.041860465116279, 1.0958123460421338, 1.0440691149508305, 1.0174885910135165, 1.010905071435642, 1.0874971095181345, 1.3076923076923077, 1.09130060292851, 1.1605078213557016, 1.004079254079254, 1.0110220440881763, 1.0208333333333333, 1.0546837850689492, 1.0391609574558065, 1.3674280039721947, 1.0252947174469151, 1.0, 1.3333333333333333, 1.0650102598333704, 1.0014090460758067, 1.2468154391341826, 1.0877583171161154, 1.071827613727055, 1.0843373493975903, 1.0992203132546747, 1.0741316744427165, 1.125, 1.0277777777777777, 1.019271948608137, 1.0948436656358906, 1.0952380952380953, 1.75, 1.0409621697250175, 1.181360201511335, 1.0471641791044777, 1.0056818181818181, 1.272266473569877, 1.0174173876748283, 1.1754287320775936, 1.3157894736842106, 1.1923076923076923, 1.028975741239892, 1.1282660332541568, 1.13125, 1.4827586206896552, 1.0823220471561068, 1.1813676907829533, 1.1575456053067994, 1.1219512195121952, 1.0442103855284717, 1.0491740299654244, 1.0683400267737617, 1.2388591800356505, 1.3333333333333333, 1.1666666666666667, 2.0, 1.1563915012190875, 1.3846153846153846, 1.0, 1.25, 1.0161507402422612, 1.0260223048327137, 1.058399081649387, 1.0162652942318897, 1.2036363636363636, 1.2592592592592593, 1.1428571428571428, 1.0333333333333334, 1.054054054054054, 1.0285714285714285, 1.1443850267379678, 1.0275828532449025, 1.032959815962302, 1.3333333333333333, 1.0789547472011927, 1.0472899254291577, 2.5, 1.0675717056241707, 1.338432122370937, 3.0, 2.0, 1.1659763313609468, 1.1142508785770637, 1.0716227426456513, 1.2670807453416149, 1.0, 1.1365638766519823, 1.2791411042944785, 3.0, 1.5, 1.0369094488188977, 1.2583680602231482, 1.0171185805323004, 1.6666666666666667, 1.0213298008948244, 1.04570100697134, 1.0307692307692307, 1.0, 1.0046948356807512, 1.0242301972017187, 1.1692307692307693, 1.1355650083225448, 1.0315354628498283, 1.2686567164179106, 1.05859375, 1.1165795139956936, 1.0862708719851577, 1.1115702479338843, 1.1694915254237288, 1.0409882457162074, 1.813664596273292, 1.0821671403388855, 1.3688524590163935, 1.2450980392156863, 1.2686567164179106, 1.0896739130434783, 1.0737575182019627, 1.0084958175211136, 1.0762214983713354, 1.064410480349345, 1.5, 1.6666666666666667, 1.0942594131560441, 1.1882145998240985, 1.1320754716981132, 1.020250119659798, 1.0991804649606958, 1.0983045184999582, 1.0317460317460319, 1.0212765957446808, 1.0537693577548934, 1.09621746008917, 1.2432234432234432, 1.0332749562171628, 2.5, 1.0714285714285714, 1.118180326523915, 1.1332250203086922, 1.0450595849431865, 1.1048317627711504, 1.0071022727272727, 2.0, 1.064676616915423, 1.0210334305435138, 1.1569568197395477, 1.1634980988593155, 1.0874696037762839, 1.0328947368421053, 1.3222958057395144, 1.048695652173913, 1.033473775126198, 1.081698796194966, 1.042626728110599, 1.0832177531206657, 1.0, 1.154354472827695, 1.0556038029070298, 1.039835164835165, 1.0385252172324415, 1.0910746812386156, 1.0015151515151515, 1.2, 1.2233766233766235, 1.6666666666666667, 2.0, 1.2352941176470589, 1.0051150895140666, 1.084518167456556, 1.031327792884225, 1.007300799794705, 1.0366350067842605, 1.0782765621475299, 1.190217391304348, 1.2244897959183674, 1.027932686574493, 1.6, 1.5, 1.0533333333333332, 1.1428571428571428, 1.0503496503496503, 1.1075949367088607, 1.0526565464895636, 1.1046890977260555, 2.0, 1.0497237569060773, 1.2170542635658914, 1.061127282349828, 1.0404644164518289, 1.2815656565656566, 1.1164383561643836, 1.1340208462149988, 1.1494835796895293, 1.028616852146264, 1.2033898305084745, 1.0963687150837989, 1.0, 1.0, 1.041571295733343, 5.0, 1.4285714285714286, 1.7419354838709677, 1.0109756097560976, 1.0804597701149425, 1.1180709534368072, 1.121224009415457, 1.0, 1.0124146492861577, 1.0204439252336448, 1.1377551020408163, 1.2668269230769231, 1.4285714285714286, 1.0279481935923653, 1.082039911308204, 1.1419068736141906, 1.1230940870211974, 1.028698826909265, 1.289312536106297, 1.142561372375037, 1.0, 1.2763887126115836, 1.0548065845444878, 1.0625, 1.1774193548387097, 1.0759565667011375]
origin-bjaq_15.71 	max: 5.0000	99th: 2.5000	95th: 1.6667	median: 1.0842	mean: 1.1740

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 13.933061 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[7.7486038e-07 1.4901161e-06 0.0000000e+00 1.0728836e-06 5.3644180e-07]
Distance score: 7.748603820800781e-07
SAUCE Drift detection: False
Detection latency: 0.0245s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.050799 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 6.0000	99th: 3.0040	95th: 2.0000	median: 1.0862	mean: 1.2057
ReportEsts: [1.0376344086021505, 1.0112871716952463, 1.0271757493845635, 1.1036906854130053, 1.4583333333333333, 1.0, 1.0473290646129048, 1.0183162965351136, 1.3333333333333333, 1.0327153762268266, 1.0862064817265356, 1.0431816387822839, 1.0917014020462297, 1.222444889779559, 1.1227340267459138, 3.6, 1.2131147540983607, 2.0, 1.3636363636363635, 1.0982367758186398, 1.1073536087153881, 1.0060289230216473, 1.1631663974151858, 1.0409015025041737, 1.0109104919353427, 1.023684006623372, 3.0, 1.1472683377544635, 1.0, 1.0, 1.002028397565923, 1.0, 1.0382543261206922, 1.001209524492871, 1.132093023255814, 1.0238936974277704, 1.2383327520055807, 1.1291759465478841, 1.5, 1.0028202593475606, 1.0232169390787518, 1.07548871305562, 1.117283950617284, 1.174357808592862, 1.0408163265306123, 1.082527446054307, 1.4210526315789473, 3.4, 1.4628571428571429, 1.0598520511096168, 1.0980392156862746, 1.2985781990521328, 1.1125541125541125, 1.0303030303030303, 1.051401517998046, 1.0139130434782608, 1.0175808720112518, 1.0794044665012408, 1.0869565217391304, 1.0761050291436258, 1.2647058823529411, 1.083448081215843, 1.0586466165413533, 1.0823529411764705, 1.0096153846153846, 5.0, 1.0910434618529468, 1.291951604418727, 2.0, 1.0, 1.019551331983175, 1.03242147922999, 1.0683678382282138, 1.0466019417475727, 1.0943770415305647, 1.155, 1.0570365033621518, 1.1581632653061225, 1.6310679611650485, 1.0965994362897618, 1.104638619201726, 1.13125, 1.0, 1.3333333333333333, 1.0630011454753723, 1.2881355932203389, 1.387218045112782, 1.3902439024390243, 1.0, 1.095784029590252, 1.1135371179039302, 1.1878108801507932, 1.0230373460977296, 1.116281247074244, 1.1220159151193634, 1.0247058823529411, 1.0674603174603174, 1.144736842105263, 2.0, 1.3474643423137875, 1.1428571428571428, 2.0, 1.0618245554035568, 1.3678111587982833, 1.0301724137931034, 1.23043321299639, 1.40625, 1.0135778605440573, 1.0710309507904698, 1.1794748059677485, 1.108502538071066, 1.0517418032786885, 1.1111111111111112, 1.2857142857142858, 1.030064845745726, 1.0871236683649839, 1.0188976377952756, 1.1046511627906976, 1.056474289955364, 2.0, 1.086071987480438, 1.0928196147110332, 1.0, 1.0651162790697675, 1.1428571428571428, 1.1867219917012448, 1.0316985804625658, 1.0884640311082308, 1.0901639344262295, 1.5, 1.1802047781569966, 1.0, 1.1176470588235294, 1.1523774214477709, 1.2307692307692308, 1.0508130081300813, 1.0233655968755306, 1.0344315920817455, 3.5, 1.2142857142857142, 1.046218487394958, 1.0261948529411764, 1.0676156583629892, 1.009050392365953, 1.2101910828025477, 1.0167567567567568, 1.1423998703429834, 3.0, 1.0155538694992412, 1.0077369439071566, 1.1024915062287655, 1.0966592427616926, 2.5, 1.2370799065895015, 1.0559895833333333, 1.0066889632107023, 1.1436170212765957, 2.0, 1.028075548749362, 1.1330770592549506, 1.08953274841869, 1.0520134228187918, 1.0563002680965148, 1.2131147540983607, 1.3697478991596639, 1.0345679012345679, 1.375, 1.0475933549933338, 1.3333333333333333, 1.0190023752969122, 1.0979853995798556, 1.097640358014646, 1.0178400233420866, 1.2720970537261698, 1.0973282442748091, 1.0698446099061185, 1.00920245398773, 1.0349854227405249, 1.0849514563106797, 1.0643788241553604, 1.1276797972330763, 1.2210758263123784, 1.2, 2.0, 1.0125773672055427, 1.0894363071460276, 1.3065693430656935, 1.1940705795291615, 1.0119047619047619, 2.0, 1.2670454545454546, 1.1198962086121118, 1.3181818181818181, 1.1392532795156407, 1.025384650504497, 1.0323590290409583, 1.0924558164072804, 1.062135922330097, 1.118374498196911, 1.010744539315246, 1.0145894122551062, 1.0664020314643472, 1.031242603550296, 1.0593221345046595, 1.0503055947343676, 1.102397470800035, 1.7201834862385321, 1.0845070422535212, 1.127906976744186, 2.0, 1.4179104477611941, 1.1429512516469038, 1.3410404624277457, 1.25, 1.0102711585866886, 1.3076923076923077, 1.040772493716138, 1.0359550561797752, 1.2601153753705632, 1.0714285714285714, 1.078144078144078, 1.0123018042646255, 1.0410826081231521, 1.014647395479678, 1.3333333333333333, 1.0423728813559323, 1.1139749310933194, 1.0160144080996885, 1.0054054054054054, 1.0218487394957982, 1.0331088664421997, 1.1004791101283211, 1.4521739130434783, 1.0029799924799563, 1.0324718062488445, 1.0771604938271604, 1.1372161895360315, 1.0526905829596414, 1.0588235294117647, 1.179016393442623, 2.0, 1.1940612578910452, 1.0848901999344478, 1.1210103779126688, 1.1357142857142857, 1.0, 2.0, 1.0868208463355595, 1.0138888888888888, 1.0623441396508728, 1.6, 1.0787545787545787, 1.0746268656716418, 1.1428571428571428, 1.0000236727479326, 1.0184331797235022, 1.1048888888888888, 1.2380952380952381, 1.0027884280237016, 1.0821355899357257, 1.0138888888888888, 2.0, 1.1206692406692407, 1.0036248561565018, 1.1319340329835081, 1.0123668356800877, 1.0618705035971223, 1.0245466638661345, 1.0499027867790018, 1.0671286461461829, 1.008428358948934, 1.0257048092868988, 1.0346297282898242, 1.1538461538461537, 1.033404905442233, 1.0847457627118644, 1.24, 1.1304347826086956, 1.0138713745271122, 1.03, 1.0231232154623324, 1.0333919156414764, 1.0921348314606742, 1.3795309168443497, 1.026241696690636, 1.049226441631505, 1.0905319606404775, 1.053928375066397, 1.5, 1.1067415730337078, 1.0695708712613785, 1.035699951937608, 1.138591521781598, 1.0561555401369573, 1.2167280378748027, 1.16796875, 1.0276814159292036, 1.0347385253989316, 1.124499882325253, 1.0283617987244622, 1.0383895131086143, 1.0654205607476634, 1.1428571428571428, 1.0797307404637249, 1.375, 1.0089445438282647, 1.115759239165124, 1.0712577714012435, 1.4054054054054055, 1.0588235294117647, 1.069476082004556, 1.1062571537581076, 1.127785125648591, 1.0909090909090908, 1.2359406056354496, 1.0306143102924805, 1.0745501285347043, 1.3333333333333333, 3.0, 1.0271621034332898, 1.0, 1.0152956863963545, 1.0575079872204474, 1.0909090909090908, 1.076007681931457, 1.4090909090909092, 1.5833333333333333, 1.0027094160133885, 2.0, 1.0392156862745099, 1.0320987654320988, 1.0083658672615727, 1.0365782852719179, 1.0878048780487806, 1.1237113402061856, 1.1007013350171386, 1.057576536479119, 1.1534181240063592, 1.0037224996072591, 1.0285850689264189, 3.0, 1.1111111111111112, 1.050957540151833, 1.2, 1.0558399255467659, 1.35, 2.0, 1.5, 1.3472906403940887, 1.0605345911949686, 1.1366906474820144, 1.0080645161290323, 1.2409638554216869, 1.8333333333333333, 1.0764291906028238, 1.3333333333333333, 1.0597014925373134, 1.0033334315198288, 1.148, 1.0598159509202454, 1.0018691588785047, 1.75, 1.0, 1.4308093994778068, 1.1895424836601307, 1.1493212669683257, 1.1317878127369219, 1.2467964514539183, 1.012853470437018, 2.0, 1.0245422173306662, 2.0, 1.5925925925925926, 4.0, 1.019341348667015, 1.1428571428571428, 1.1329113924050633, 1.1818181818181819, 1.1725365166456587, 1.0987886670978149, 1.092768959435626, 1.0939557151406343, 1.1183463928667927, 1.1120896717373898, 1.134441087613293, 1.0429192664019664, 1.092281879194631, 1.1470588235294117, 1.0044330510154944, 1.0854247561322095, 1.093899931459904, 1.0891089108910892, 1.0975609756097562, 1.094, 3.0, 1.0, 1.3978494623655915, 1.1640625, 1.4779411764705883, 1.0169050715214565, 1.0728656878738445, 1.1146204788588894, 1.0218692449355433, 1.1389843451699122, 1.083385952531293, 1.0288461538461537, 1.316831683168317, 1.0997506234413965, 2.0, 1.0824890200154222, 1.5294117647058822, 1.107081565299387, 1.086722681316652, 1.1070675105485233, 1.1317991631799162, 1.375, 1.1213333333333333, 1.1666666666666667, 1.450389987302739, 1.0, 1.104020461655534, 1.0191387559808613, 1.1392630921580873, 1.1016393442622952, 1.0175438596491229, 4.0, 1.2701863354037266, 1.0160593164838496, 1.1733177587989736, 2.0, 1.0, 1.2707006369426752, 1.3044776119402985, 1.143561721605223, 1.1023961703358847, 1.0, 1.053405572755418, 1.001536994883169, 1.0610125914694442, 1.086346004654771, 1.013674470295475, 1.4728606356968215, 1.0461538461538462, 1.0493653032440056, 1.0886727631486695, 1.0458015267175573, 1.0129799891833424, 2.0, 1.0, 1.0423892100192678, 1.130952380952381, 1.03319357092942, 1.157899269423433, 1.0516290726817044, 1.0, 1.1293103448275863, 1.0294117647058822, 1.0182054867171304, 1.0833333333333333, 2.0, 1.0359447660624466, 1.0, 1.0, 1.044811320754717, 1.75, 1.0072439907803754, 1.0022590361445782, 1.0054347826086956, 1.0, 1.0727197694898267, 1.0655058043117744, 1.8, 1.059591836734694, 1.094488188976378, 1.1129568106312293, 1.0443250503693755, 1.29136061559986, 1.0802622070816559, 2.0, 1.1176470588235294, 1.0754124116260801, 1.1045838159854378, 1.0588703261734287, 1.25, 1.1132697947214076, 1.0105286480986067, 1.0195993031358885, 2.0, 1.0304718217562254, 1.0502951278201673, 1.05437315519652, 1.026167544975468, 1.0102263945000165, 1.078228010209143, 1.0112994350282485, 1.228616287801215, 1.75, 1.1344595759351837, 1.0274678111587983, 1.069499017681729, 1.057285873192436, 1.0712328767123287, 1.0025782534771581, 1.3035714285714286, 1.054795936213174, 1.1924971580143995, 1.0524019191659921, 1.0047732696897376, 1.0969037698660213, 1.0111778571971712, 1.0568181818181819, 1.2985074626865671, 1.073491861341849, 1.0864978902953586, 1.014473996988986, 1.0573930346288634, 1.3333333333333333, 1.0150231124807396, 1.0701754385964912, 1.7142857142857142, 1.0517241379310345, 1.0126162685032727, 1.1777777777777778, 1.0522317188983856, 2.0, 1.121212121212121, 1.0063795853269537, 1.1214790535695995, 1.0430308699719364, 1.0234497732933137, 1.1215686274509804, 1.0, 1.0254841997961264, 1.0034491907667817, 1.6198830409356726, 1.034494252249878, 1.0139398385913427, 1.183673469387755, 1.1062075880885198, 1.0905797101449275, 1.009852089031773, 3.0, 1.2720247295208655, 1.0171821305841924, 1.0225141295571705, 1.1126126126126126, 1.0835820895522388, 1.0398613518197575, 1.0264900662251655, 1.0890447864132076, 1.0, 1.1964285714285714, 1.2, 1.0, 1.1603773584905661, 1.2770833333333333, 1.0572569906790945, 1.1134453781512605, 1.0665238923838845, 1.0991591765729196, 1.102693258197044, 1.1839583637336446, 1.0518725042861916, 1.050229737755134, 1.0021030494216614, 1.112991266375546, 1.0382978723404255, 1.0501699881665696, 1.033563672260612, 1.0467899891186072, 1.1730769230769231, 1.4365079365079365, 1.0278168722576373, 1.177245508982036, 1.1017442432108233, 1.2681564245810055, 1.2792207792207793, 1.1209068010075567, 2.0, 1.0298165137614679, 1.2666666666666666, 2.0, 1.7244897959183674, 1.0389232956973788, 1.0388093443858326, 1.035897435897436, 1.1366120218579234, 1.1450348675034867, 1.0232468266000774, 1.1143911439114391, 1.0, 1.5, 1.013527462378443, 1.0324074074074074, 1.0873709293089753, 1.101555136663525, 1.0, 1.3693579148124602, 1.1838074398249452, 1.0341931036693865, 1.0601503759398496, 1.0091474535846232, 1.0671225315834663, 1.0082133430893458, 1.3505154639175259, 3.0, 1.1251794871794871, 1.0, 1.0579881656804733, 1.146551724137931, 1.263194933145672, 1.375, 1.56, 1.0497777355171511, 1.1619718309859155, 1.2146847565841978, 1.0155729449136128, 1.1592520954223082, 1.144808743169399, 1.0679971918563835, 1.0044802867383513, 1.070486111111111, 5.2, 1.0933923648817976, 1.0542052272958404, 1.0, 1.0040760869565217, 1.1873856523832451, 1.0765407554671969, 1.0112912934824245, 1.75, 1.1107205623901582, 1.0253413220705234, 1.0392609699769053, 1.1618497109826589, 1.0450312862715665, 1.0793650793650793, 2.0, 1.113875262789068, 1.0725530458590007, 1.0889042819378278, 1.2222222222222223, 1.007022006767621, 1.0032501756851722, 1.1729323308270676, 1.0647625373630023, 1.2175141242937852, 1.0548808511054397, 1.052056220718376, 1.008289374529013, 1.0333479596314172, 1.0240141000220313, 1.15, 1.0356792144026186, 1.2380952380952381, 1.6, 1.0687116564417178, 1.6076679158258864, 1.0649350649350648, 1.0470219435736676, 1.2142857142857142, 1.0105092966855296, 1.0323958704165184, 1.1746987951807228, 1.0441885248719447, 2.0, 1.1878510244422829, 1.0, 1.0896686159844056, 1.2666666666666666, 1.027593851179885, 1.3333333333333333, 1.1517241379310346, 1.0738137082601054, 1.0, 1.3867675725260864, 1.341534008683068, 1.5, 3.5, 1.103448275862069, 1.228985507246377, 1.0792553191489362, 1.1893305439330544, 1.0970042796005706, 1.1192853389385182, 1.1053984575835476, 1.1504901960784313, 1.2323651452282158, 1.2534246575342465, 1.1333333333333333, 1.5, 1.0315789473684212, 1.1366384522370012, 1.0253496503496504, 1.0620441325824024, 1.065236429589325, 1.078523140925637, 1.0959874406645569, 1.1651854306630915, 1.1538461538461537, 1.0142204164550532, 1.2222222222222223, 1.5, 1.375, 1.0012170616834752, 1.049743964886613, 1.1059782608695652, 1.2063882063882063, 1.0500348785591984, 1.0850863080477566, 1.0096569413273484, 1.072289156626506, 1.4285714285714286, 1.221556886227545, 1.0696823548977217, 1.0778158216795237, 1.0153355704697986, 1.0224719101123596, 1.0191039625315832, 1.1102792391744234, 1.113681773492753, 1.0672082717872968, 1.1020285040468225, 1.0732484076433122, 1.099095394736842, 1.0103412616339194, 1.028720737048784, 1.7272727272727273, 1.1570680628272252, 1.0, 1.0019569471624266, 1.0376104333193101, 1.0, 1.0594505727619856, 1.0318471337579618, 1.2272727272727273, 1.0300666645866483, 1.0162194573527208, 1.047604414024305, 1.0417670682730924, 1.0258620689655173, 1.1991220171094101, 1.1199324324324325, 1.625, 1.0, 1.2222222222222223, 1.0577644259849188, 1.25, 2.5176151761517613, 1.106664569476901, 1.0305668766209708, 1.0742696814655883, 1.1412656240565184, 1.1161255797359972, 1.0395136778115501, 1.0265282583621684, 1.0066430922866099, 1.1237517133346386, 1.046966142729907, 1.3001634603294354, 1.7142857142857142, 1.0710659898477157, 1.046204620462046, 1.126592541116516, 1.086111111111111, 1.295340338053906, 1.1284109149277688, 2.225806451612903, 1.0102763975346498, 1.0857787810383748, 1.0735944976076555, 1.0, 1.0671165295173455, 1.0433493886624676, 1.3034424139396514, 1.0519888346127007, 1.206896551724138, 1.0733844468784228, 1.0666805729383952, 1.034302640379654, 1.2340425531914894, 1.0179403507224647, 1.2307692307692308, 1.0205009745181548, 1.0037712130735386, 1.003875968992248, 1.0393765381460214, 1.0330882352941178, 1.0606965174129352, 1.0550049554013876, 1.0124153766974149, 1.071290944123314, 1.0779351184346035, 1.0627292098511314, 1.2, 1.0916305916305917, 1.0277499164159145, 1.0176144780060539, 1.0009010632546405, 1.1217239370995924, 1.0396341463414633, 1.093429158110883, 1.0252525252525253, 1.0174018856164857, 1.3333333333333333, 1.1076023391812866, 1.2391618497109826, 1.06496062992126, 1.0904436860068258, 1.076779564934131, 1.1030755412395081, 1.0551128818061088, 1.0615384615384615, 1.1004796084292825, 1.080381840863481, 1.1228878648233487, 1.0476190476190477, 1.03026706231454, 1.072651843374479, 1.134020618556701, 1.75, 1.0285195839787564, 1.1659788964312117, 1.0353634577603144, 1.0141509433962264, 1.2282345828295043, 1.0261118979327088, 1.1780401416765054, 1.0023550191345305, 1.3548387096774193, 1.1413105413105413, 1.25, 1.1358974358974359, 1.5161290322580645, 1.0179552881758764, 1.1730926989335522, 2.6, 1.0416666666666667, 1.125, 1.1406165494862088, 1.0, 1.1538461538461537, 1.0437226733291693, 1.003921568627451, 1.092058674759737, 1.0769230769230769, 1.0095648265264523, 1.0586881472957423, 1.0845105638204775, 1.2831858407079646, 1.0, 1.3780630105017504, 1.0356520833023208, 1.062577499718183, 1.108231707317073, 1.3559322033898304, 1.1176470588235294, 1.1081081081081081, 1.0108695652173914, 1.1012658227848102, 1.0977767152761175, 1.0280492473287772, 1.027718695125269, 1.2956521739130435, 1.05722170273907, 1.047585470263775, 3.5, 1.0384555793126955, 1.0077889590084712, 2.5, 2.25, 1.3045622688039458, 1.1251194457716196, 1.0811741977031233, 1.2265625, 1.5, 1.046204620462046, 1.3112244897959184, 1.0, 1.0670311594105195, 1.1453988824974946, 1.0703866764118035, 1.0483170466883822, 1.5714285714285714, 1.0209783909340466, 1.0485122897800776, 1.0552536231884058, 1.2333333333333334, 1.0023282887077998, 1.0, 1.09478672985782, 1.1779327230146903, 1.0116250511665985, 1.230617608409987, 1.0741935483870968, 1.0879616928947302, 1.0255255255255256, 1.0402684563758389, 1.2142857142857142, 1.0315863664045875, 1.380672268907563, 1.0056569597324787, 1.1775147928994083, 1.144, 1.0112359550561798, 1.375, 1.0866238138965412, 1.0176322418136021, 1.0070551261905525, 1.0516129032258064, 1.5, 1.1556929792651873, 1.0303067890515174, 1.2107035928143712, 1.1045111574891635, 1.0064049387479501, 1.0658224325076537, 1.104077927519028, 1.0303030303030303, 1.0727272727272728, 1.064804542191477, 1.092860871276623, 1.2588454376163873, 1.0875912408759123, 2.3333333333333335, 1.1162790697674418, 1.0904512352821072, 1.0455927051671732, 1.0255634487997973, 1.1058839754943237, 1.0210843373493976, 2.0, 1.0834213305174234, 1.008496586524191, 1.179384203480589, 1.0063694267515924, 1.0712019424128223, 1.0180878552971577, 1.3018518518518518, 1.0116504854368933, 1.0307293225581162, 1.0706128673454494, 1.0480678605089537, 1.0569832402234638, 1.0, 1.1128993895187504, 1.0585840223129794, 1.0051684149801623, 1.0031659882406152, 1.1008273009307135, 1.032418952618454, 1.3333333333333333, 1.2136752136752136, 2.3333333333333335, 2.5, 1.3157894736842106, 1.0347826086956522, 1.051128818061089, 1.1004301222093262, 1.0047954021185337, 1.0940516273849608, 1.0143362831858407, 1.1121076233183858, 1.0621572212065813, 1.0550077294233382, 1.8, 1.6923076923076923, 1.0396736072031514, 1.1111111111111112, 1.0997624703087887, 1.1471197679237464, 1.0248947051744886, 1.0828029350954718, 2.5, 1.0554266563547305, 1.0995184590690208, 1.1340112480827131, 1.0394602033794633, 1.1916666666666667, 1.1224197247706422, 1.1377478557594762, 1.1193349692022636, 1.0762032085561497, 1.0649350649350648, 1.1105937136204889, 1.3333333333333333, 2.0, 1.041627863661762, 6.0, 1.4444444444444444, 1.972972972972973, 1.1044444444444443, 1.0407281152295498, 1.0907543959160522, 1.024, 1.3333333333333333, 1.1556503198294243, 1.0175695461200585, 1.1630434782608696, 1.2664015904572565]
origin-bjaq_15.71 	max: 6.0000	99th: 3.0040	95th: 2.0000	median: 1.0862	mean: 1.2057

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.211899 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.222848