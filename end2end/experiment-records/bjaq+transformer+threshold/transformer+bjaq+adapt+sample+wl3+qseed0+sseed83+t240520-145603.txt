Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 83, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.5000	95th: 1.6667	median: 1.0814	mean: 1.1721
ReportEsts: [1.0641891891891893, 1.0205729166666666, 1.0697163028225047, 1.0590631364562118, 1.5789473684210527, 1.0, 1.0674126487850364, 1.0543206151496152, 1.0, 1.0103761348897535, 1.1301474619802037, 1.042971867630415, 1.0131914893617022, 1.130232558139535, 1.0498057223595902, 1.0, 1.2162162162162162, 1.0085015940488842, 3.0, 2.0, 1.2272727272727273, 1.0889066315987226, 1.0630179907014352, 1.1732237228420435, 1.0927479033053773, 1.0, 1.1718801448798155, 1.5, 1.2, 1.0220588235294117, 1.0, 1.0487433932815438, 1.0069232567294917, 1.0726970033296337, 1.0603612865325305, 1.216220666941128, 1.0935828877005347, 1.0062550394605028, 1.172566981197052, 1.0357142857142858, 1.1746987951807228, 1.0152439024390243, 1.0, 1.031519365590162, 1.155821001961134, 1.8333333333333333, 1.0404040404040404, 1.187279151943463, 1.0333848343159178, 1.0925925925925926, 1.130258393007869, 1.120274914089347, 1.0382151171174883, 2.0, 1.122077922077922, 1.2975914869420413, 1.2398557258791705, 1.3592233009708738, 1.124223602484472, 1.0, 1.1508542348237005, 1.0952677459526774, 1.1727272727272726, 1.0357142857142858, 1.0, 1.050199927299164, 1.191116306253653, 1.75, 1.0, 1.0789596345669805, 1.0345679012345679, 1.062754212667054, 1.0398126463700235, 1.018348623853211, 1.0705882352941176, 1.0546875, 1.3333333333333333, 1.1056367432150314, 2.0, 1.011105053229648, 1.0666666666666667, 1.0185267857142857, 1.1104294478527608, 1.09, 1.1226692836113836, 1.04, 1.0722546898711698, 1.0207666238167583, 1.0392156862745099, 1.75, 1.108148148148148, 1.0452441312620948, 1.003125, 1.0308555399719495, 1.0182648401826484, 1.07012987012987, 1.0714285714285714, 1.1434146341463414, 1.0, 1.2514796203238414, 1.0199735644000587, 1.0917667238421955, 1.209982494342684, 1.2592592592592593, 1.018467600783074, 1.0793735067693124, 1.2679156908665106, 1.1395525218050815, 1.0511955855303494, 1.3333333333333333, 1.6666666666666667, 1.0436915887850466, 1.0439992530743991, 1.0574857864813645, 1.103896103896104, 1.059096168842603, 1.0, 1.1176285083569852, 1.1754780652418448, 1.0, 1.0282485875706215, 1.1666666666666667, 1.087719298245614, 1.0238515494840947, 1.053040304418731, 1.108910891089109, 1.8, 1.2069536423841059, 1.0, 1.1428571428571428, 1.0932410465080615, 1.1818181818181819, 1.0325520833333333, 1.0402507112487205, 1.0684071796159156, 1.0520694259012016, 1.0301369863013699, 1.0615744349181606, 1.039972432804962, 1.0725167580743449, 1.0348948777080142, 1.1824817518248176, 1.0397912589693412, 1.1850409511871585, 2.0, 1.0232452142206017, 1.0331428571428571, 1.088453747467927, 1.1067584259749426, 1.5, 1.2242673770888834, 1.0384615384615385, 1.0245901639344261, 1.1074561403508771, 1.0603715170278638, 1.057774607703281, 1.098042637349853, 1.1699725680523316, 1.0626262626262626, 1.0592105263157894, 1.3061224489795917, 1.3529411764705883, 1.01620029455081, 1.4285714285714286, 1.0500526573137248, 1.0521391699517342, 1.191358024691358, 1.3536632514981635, 1.1289655172413793, 1.1027006970395696, 1.3073684210526315, 1.1724137931034482, 1.076111164907524, 1.0080889787664307, 1.009490940465919, 1.0816326530612246, 1.047921294827039, 1.2071271570874058, 1.0171158921858754, 1.0, 1.2380952380952381, 1.0269565217391305, 1.0281100478468899, 1.1499680918953414, 1.013157894736842, 1.0846919123149203, 1.28099173553719, 1.137458606583988, 1.1372549019607843, 1.1227272727272728, 1.0321095488330256, 1.0, 1.0909090909090908, 1.038255114805698, 1.0563549160671464, 1.0078996282527881, 1.206896551724138, 1.067524115755627, 1.045453377659711, 1.0791300435848938, 1.0626410835214446, 1.0464846632233582, 1.2824858757062148, 1.103448275862069, 1.2923076923076924, 1.0, 1.4545454545454546, 1.096357041476108, 1.3066202090592334, 1.1839080459770115, 1.0118635689569946, 1.0031277926720286, 1.025024585557741, 1.008600599267562, 1.0861314898419865, 1.135483870967742, 1.0997109826589595, 1.0157998683344305, 1.0607875236946407, 1.005616303326227, 1.0, 1.0782608695652174, 1.0997774407657612, 1.0110367758373553, 1.152521525215252, 1.0768228488038776, 1.2741283612652907, 1.0357142857142858, 1.0077266391653878, 1.1331872099020113, 1.01804850535815, 1.1162790697674418, 1.0126023944549465, 1.0286266924564798, 1.1803149606299213, 2.0, 1.1664829106945975, 1.1150066994193837, 1.2172995780590716, 1.0592885375494072, 1.0, 1.6666666666666667, 1.0849439862119907, 1.1272727272727272, 1.109039809313743, 1.5, 1.0, 1.05, 1.053864168618267, 1.1734693877551021, 1.022099447513812, 1.1223628691983123, 1.0577249575551784, 1.0029387069689337, 1.0430692398521129, 1.0178571428571428, 2.0, 1.0863508317397652, 1.0793157076205289, 1.073555166374781, 1.0208275538294105, 1.1547643487696866, 1.013059515501944, 1.1136724960254372, 1.0913332042321708, 1.014354066985646, 1.085873830365228, 1.0018420729460886, 1.0, 1.0015760915336214, 1.0255863539445629, 1.1818181818181819, 1.4705882352941178, 1.0215453194650816, 1.0555555555555556, 1.0940170940170941, 1.1034385303815355, 1.15041782729805, 1.3834586466165413, 1.0124960949703217, 1.0411073825503356, 1.0181012973212904, 1.05158936074053, 1.1111111111111112, 1.000764498161564, 2.5, 1.0247619297922854, 1.0151187904967602, 1.0574120431477858, 1.0526315789473684, 1.6666666666666667, 1.434782608695652, 1.0757575757575757, 1.0642881163019298, 1.0, 1.010819165378671, 1.006787330316742, 1.0076121794871795, 1.0157752892523582, 1.111764705882353, 1.1572327044025157, 1.008446859239694, 1.1278958452996362, 1.0412658754944826, 1.0683760683760684, 1.0, 1.1217183770883055, 1.2767295597484276, 1.106896551724138, 1.016933445661331, 1.062135112593828, 1.0201149425287357, 1.4390243902439024, 1.0013736263736264, 1.0371956114530372, 1.2857142857142858, 1.0034998311484973, 1.0360531309297913, 1.2666666666666666, 1.0898505910683012, 1.2380952380952381, 1.4, 1.0173080580739238, 2.0, 1.1700960219478738, 1.0465116279069768, 1.0508613617719442, 1.0912092447379282, 1.2852348993288591, 1.123456790123457, 1.0971739336300546, 1.0786494973345342, 1.057636887608069, 1.0099542040363387, 1.0592483419307295, 2.0, 1.0, 1.042711213693183, 1.25, 1.0739495798319327, 1.3529411764705883, 1.0, 1.375, 1.3493975903614457, 1.0649106302916276, 1.1415929203539823, 1.0367965367965368, 1.0, 1.196404793608522, 1.0474463857131797, 2.0, 1.1697438951756998, 1.0, 1.0993395581872012, 1.0595238095238095, 1.0128365269620219, 1.152073732718894, 1.1363636363636365, 1.3058954393770856, 1.3425925925925926, 1.0335115177307068, 1.0191353903769438, 1.0682788051209104, 1.0, 1.1666666666666667, 1.5714285714285714, 1.5, 1.1428571428571428, 1.0694960830852391, 1.3333333333333333, 1.0998336106489184, 1.216867469879518, 1.1420262175536071, 1.0750826161639941, 1.2224510813594234, 1.004451423983375, 1.0133410672853829, 1.0440476190476191, 1.5, 1.266490765171504, 1.0808510638297872, 1.043809971663579, 1.0476190476190477, 1.5714285714285714, 1.0089887640449438, 1.0256410256410255, 1.0357746419367104, 1.025735294117647, 1.1464387464387464, 1.0128590971272229, 1.1111111111111112, 1.0907770515613653, 1.0783898305084745, 1.2307692307692308, 1.0254957507082152, 1.1714285714285715, 1.0775105674394774, 1.0859649537962777, 1.0207128561086745, 1.2835820895522387, 1.0373831775700935, 1.1118012422360248, 1.0, 1.0217472190503072, 1.029486530388372, 1.0720759915887172, 1.060122633774197, 1.0910798122065728, 1.1464887194153162, 1.5714285714285714, 1.2835913312693499, 1.0, 1.162254483347566, 1.25, 1.0283418904649904, 1.0438729198184569, 1.1679922613929492, 1.1264822134387351, 1.0345104333868378, 3.0, 1.0851875397329942, 1.0246069231247281, 1.1010897553798051, 2.0, 1.0793650793650793, 1.272552783109405, 1.2654545454545454, 1.1204280399615434, 1.1226611226611227, 1.0, 1.1233822260569457, 1.0285583788071828, 1.0593305786757874, 1.0837514068252485, 1.1205043859649122, 1.0696517412935322, 1.2692307692307692, 1.6666666666666667, 1.100558659217877, 1.5, 1.225752508361204, 1.4242424242424243, 1.1142372001980991, 1.7857142857142858, 1.091829005968431, 1.0989190396810393, 1.0487353485502775, 1.0, 1.14, 1.16, 1.2872026045579765, 1.0809628008752736, 1.0, 1.0081481997353576, 1.0974649194614001, 1.1205967675093245, 1.5, 2.0, 1.0094080752646022, 1.012704174228675, 1.0459016393442624, 1.1111111111111112, 1.066643212102555, 1.0795107033639144, 1.4705882352941178, 1.0377579737335836, 1.0454545454545454, 1.1128608923884515, 1.0459677419354838, 1.197307530500631, 1.0221791938039078, 1.0, 1.0724637681159421, 1.103049497783006, 1.0471371202798108, 1.0293021295906128, 1.0, 1.1477549214775493, 1.0122567448213364, 1.0220010476689365, 2.0, 1.0657894736842106, 1.022774351490043, 1.0039606301539916, 1.0314534096369752, 1.0217383577832473, 1.0326462923477848, 1.0329861111111112, 1.0976374156219866, 2.0, 1.0787637604010543, 2.3125, 1.2, 1.2124352331606219, 1.1346153846153846, 1.0126904611075918, 1.26017130620985, 1.0571229237150448, 1.0826067003212483, 1.095473859227785, 1.0672257540917083, 1.04965498110198, 1.10752688172043, 4.0, 1.0112591525627175, 1.198582995951417, 1.0455942349938714, 1.03582835384276, 1.1080669710806696, 1.197085889570552, 2.3222222222222224, 2.2857142857142856, 1.0073160636899254, 1.0478646953305182, 1.0029573768067723, 1.1317743132887899, 1.0523524874662553, 1.0167714884696017, 1.0633069532851163, 1.006514657980456, 1.2323390894819466, 3.0, 1.0833333333333333, 1.0741350906095553, 1.064030131826742, 1.1119402985074627, 1.06861499364676, 1.072549019607843, 1.2756410256410255, 1.148905109489051, 1.103030303030303, 1.0820041306141128, 1.2555555555555555, 1.0438311688311688, 2.0, 1.0529500756429653, 1.0833333333333333, 1.3428571428571427, 1.0798882681564246, 1.0386363636363636, 1.0811965811965811, 1.0026007802340702, 1.134467477539365, 1.0, 1.297872340425532, 1.2, 1.0, 1.1136363636363635, 1.1108870967741935, 1.0108024691358024, 1.1310679611650485, 1.0664851009291894, 1.1264501160092808, 1.0409928142217784, 1.1817758098345374, 1.0402476780185759, 1.1435619415064635, 1.0432432432432432, 1.0981156595191683, 1.02322206095791, 1.045031055900621, 1.2095375722543353, 1.1378146101903008, 1.043987229514012, 1.0931731221051217, 1.0777674177062802, 2.0, 1.0049382716049382, 1.0744786494538232, 1.4205607476635513, 1.0, 1.0851063829787233, 1.25, 1.236323851203501, 1.2962962962962963, 1.1666666666666667, 1.0057879600763673, 1.1229967868760853, 1.030788432189141, 1.0593267770048773, 1.1891891891891893, 1.1182065217391304, 1.0, 1.1755725190839694, 1.0273811987033588, 1.0874173240895688, 1.0845502323763194, 1.119489691308805, 1.0239089045108378, 1.148051948051948, 1.0276108836248135, 1.1492007104795736, 1.0068614480794673, 1.0602609235866638, 1.2727272727272727, 1.0490605427974948, 1.0, 1.2387640449438202, 1.2096309705023245, 3.0, 1.159848663986758, 1.0452923104725762, 1.4285714285714286, 1.0040706051873198, 1.4, 1.1176470588235294, 1.055030447939627, 1.6153846153846154, 1.0175060125932103, 1.0474156343442973, 1.3571428571428572, 1.0740740740740742, 1.1154639175257732, 1.0086083213773314, 1.0233995584988962, 1.093880778989686, 1.1579783658253378, 1.0, 1.0638170758201173, 1.1158536585365855, 2.0, 1.0327029344512195, 1.1064105891513107, 1.1665089877010406, 1.0143812283103568, 1.0508339339030166, 1.0761904761904761, 1.8571428571428572, 1.0178087495160666, 1.0096774193548388, 1.090221098535625, 1.1566358024691359, 1.0271859096646283, 1.0413352094623776, 1.271062271062271, 1.0913520097442144, 1.1705685618729098, 1.0108026340207055, 1.0694006309148265, 1.105072463768116, 1.0252100840336134, 1.0370063995345793, 3.0, 1.1400732272285736, 1.0016228917342043, 1.016689720734241, 1.3571428571428572, 1.2056658797389253, 1.7828947368421053, 1.1428571428571428, 1.089722790435212, 1.0420575865415722, 1.1408296943231442, 1.0588235294117647, 1.3333333333333333, 1.0522490006039515, 1.5, 1.1495327102803738, 1.0, 1.0226432209894634, 1.3846153846153846, 1.1856540084388185, 1.0890985324947589, 1.0, 1.582010582010582, 1.3124463519313305, 1.25, 2.0, 1.1271186440677967, 1.1551724137931034, 1.0453697949036669, 1.2032828282828283, 1.0921501706484642, 1.28023598820059, 1.1014466214978942, 1.0623376623376624, 1.1238532110091743, 1.1346938775510205, 1.04, 1.0, 1.0769230769230769, 1.0836940836940836, 1.0308839190628327, 1.0252797347699958, 1.0878610881848771, 1.033686730506156, 1.0492618504135416, 1.201886928860613, 1.1671348314606742, 1.0077565632458234, 1.8333333333333333, 1.0, 1.2592592592592593, 1.0596038552022464, 1.059135039717564, 1.107843137254902, 1.2265861027190332, 1.0535318823978619, 1.0476524176594253, 1.024600891454345, 1.1142857142857143, 1.2222222222222223, 1.032874617737003, 1.0298913043478262, 1.0689152919612463, 1.0203368801499642, 1.0704225352112675, 1.1050649734199645, 1.0231494821127978, 1.1960183767228179, 1.3375763747454175, 1.125, 1.0598086124401913, 1.2454417952314165, 1.1304347826086956, 1.2568493150684932, 1.0701001430615165, 1.0, 1.086848635235732, 1.010706084031439, 1.0384615384615385, 1.0873036722151903, 1.028322440087146, 1.303030303030303, 1.0185096064857662, 1.0430064888248016, 1.055566747246844, 1.0238549618320612, 1.0238365493757093, 1.2000946873626188, 1.1428571428571428, 1.1428571428571428, 1.0, 1.6666666666666667, 1.063437083686569, 1.3333333333333333, 1.199838144051794, 1.0823865166119218, 1.0121076233183857, 1.0657398212512412, 1.0509205969554276, 1.0519828510182208, 1.028673835125448, 1.0041782729805013, 1.0009448419152556, 1.110306524184477, 1.0472956012731307, 1.2824280380585331, 1.6666666666666667, 1.0625, 1.1096491228070176, 1.1041457242885369, 1.019543973941368, 1.2580901856763926, 1.0541044776119404, 2.2401746724890828, 1.0677237700059277, 1.076510067114094, 1.067224880382775, 1.25, 1.05677405690349, 1.0333920659630156, 1.2845569620253166, 1.0581052631578947, 1.28, 1.0923976608187134, 1.1166666666666667, 1.5625, 1.0493945188017846, 1.5, 1.0675403225806452, 1.1151960784313726, 1.0856515373352855, 1.0244954286700017, 1.009501187648456, 2.2, 1.0926829268292684, 1.0975771168057649, 1.0400966720373355, 1.001693448471227, 1.0042777067558266, 1.0999307348403753, 1.1818181818181819, 1.0629194630872483, 1.1553037702676303, 1.043609933373713, 1.0190380761523046, 1.0277777777777777, 1.0278035217794255, 1.0071259409625306, 1.3633663366336635, 1.0724710901538117, 1.0, 1.3333333333333333, 1.0328116887932952, 1.022653721682848, 1.2443722219566984, 1.078824946714855, 1.0590582601755787, 1.056338028169014, 1.104355797380016, 1.066049263618239, 1.125, 1.0, 1.0340333091962346, 1.0506675501889755, 1.0952380952380953, 1.75, 1.034460261607076, 1.1672134326669792, 1.0415676959619953, 1.0057142857142858, 1.214699493120927, 1.0049160379654418, 1.1610908068597132, 1.4184397163120568, 1.3461538461538463, 1.0606469002695418, 1.1964735516372795, 1.15, 1.5357142857142858, 1.079271426975081, 1.193260654112983, 1.1683250414593698, 1.048780487804878, 1.0020530310629618, 1.005186323472916, 1.0649933065595716, 1.3260051495345613, 1.3333333333333333, 1.2173913043478262, 1.3333333333333333, 1.1243469174503657, 1.1923076923076923, 1.0, 1.25, 1.0471567267683772, 1.1105072463768115, 1.0361768168682437, 1.040894473361403, 1.309090909090909, 1.3076923076923077, 1.0666666666666667, 1.1612903225806452, 1.0135135135135136, 1.0144927536231885, 1.0808080808080809, 1.0307335391015986, 1.032811398463879, 1.3195876288659794, 1.074912975386909, 1.0467343976777939, 2.5, 1.0696216528869382, 1.2216404886561956, 3.0, 2.0, 1.2085798816568047, 1.0939539553898012, 1.0298024209867913, 1.1832298136645962, 1.0, 1.075, 1.0122699386503067, 3.0, 2.0, 1.031742125984252, 1.347492942599812, 1.0321129576408847, 1.6666666666666667, 1.0305830523038733, 1.0410534469403563, 1.04389721627409, 1.0, 1.0047169811320755, 1.0232790110547787, 1.2105263157894737, 1.1895382628350015, 1.0330482341304474, 1.2917933130699089, 1.1171875, 1.1016691957511382, 1.1078524124881741, 1.0950413223140496, 1.3018867924528301, 1.0392410981601634, 1.421913043478261, 1.0715150795535502, 1.3688524590163935, 1.1764705882352942, 1.3134328358208955, 1.063660477453581, 1.0543985079266398, 1.0098986946222468, 1.089457750526921, 1.039301310043668, 1.5, 1.6666666666666667, 1.0962411302179889, 1.2049252418645557, 1.2110484341567789, 1.008652323854641, 1.0715838769024921, 1.1225883558135565, 1.3404255319148937, 1.0666666666666667, 1.0850562062730917, 1.1104456452507654, 1.2702095808383234, 1.019642857142857, 1.6666666666666667, 1.0869565217391304, 1.0770902481428797, 1.1513067400275103, 1.0153317389169583, 1.0976210646427276, 1.0262784090909092, 2.0, 1.0904458598726114, 1.0123135661337859, 1.1756911126342244, 1.2357414448669202, 1.070215276784437, 1.0764331210191083, 1.2461368653421634, 1.0446376811594202, 1.0326572530746592, 1.0581277885343885, 1.012672811059908, 1.0611413043478262, 1.0, 1.1774647887323944, 1.0602431666514307, 1.0892086330935251, 1.0771531988262026, 1.1203241895261846, 1.008320726172466, 1.2, 1.2593582887700534, 1.6666666666666667, 2.0, 1.1764705882352942, 1.0051150895140666, 1.0568720379146919, 1.0290026748184944, 1.0152046533510115, 1.0336499321573949, 1.0161087866108787, 1.1793478260869565, 1.0204081632653061, 1.0590711083987459, 1.6, 1.5833333333333333, 1.2173396674584323, 1.1428571428571428, 1.0231607629427792, 1.1507334344967122, 1.1138350608382155, 1.0976286702049958, 2.0, 1.074517631403859, 1.2073643410852712, 1.0429128738621587, 1.0398818316100442, 1.1755050505050506, 1.1345890410958903, 1.1479635176822998, 1.1433316929133859, 1.0177993527508091, 1.1639344262295082, 1.100558659217877, 1.0, 1.0, 1.0415444726583456, 5.0, 1.5714285714285714, 1.7419354838709677, 1.044080604534005, 1.0930232558139534, 1.1031042128603104, 1.0839544919576305, 1.0, 1.063935443823712, 1.0169392523364487, 1.0931372549019607, 1.3100961538461537, 1.4285714285714286, 1.0567624386825507, 1.2028824833702882, 1.1318681318681318, 1.0888806247675715, 1.032085989651618, 1.0844509232264334, 1.1650399290150844, 1.0, 1.2218132588737995, 1.0399740059742573, 1.037885581061693, 1.1774193548387097, 1.1689136052128974]
origin-bjaq_15.71 	max: 5.0000	99th: 2.5000	95th: 1.6667	median: 1.0814	mean: 1.1721

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 13.909566 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[7.7486038e-07 5.3644180e-07 1.4901161e-06 5.9604645e-08 2.3841858e-07]
Distance score: 6.19888282926695e-07
SAUCE Drift detection: False
Detection latency: 0.0238s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.035164 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.8762	95th: 1.7500	median: 1.0810	mean: 1.1826
ReportEsts: [1.0516304347826086, 1.0297761356226907, 1.0627667526705409, 1.0716723549488054, 1.5833333333333333, 1.0, 1.1095106362682439, 1.0534987659262225, 1.3333333333333333, 1.0342541436464088, 1.1382543880740563, 1.0429163737787985, 1.0273124544792425, 1.1117533718689787, 1.0327966607036374, 1.3088235294117647, 1.1628664495114007, 1.3181818181818181, 1.7272727272727273, 1.0692307692307692, 1.1155519926706368, 1.0547957292861554, 1.1913145539906103, 1.0826161790017212, 1.019558605078871, 1.0204936561804312, 3.0, 1.1413338099067702, 1.4, 1.1666666666666667, 1.0086413826212195, 1.0, 1.0536387509425131, 1.0059500484665993, 1.2228360957642725, 1.0363169479090242, 1.2159426257635029, 1.1222707423580787, 1.3333333333333333, 1.1301044634377968, 1.0122361292733046, 1.0673796330235668, 1.1536555142503098, 1.0300338409475465, 1.0181488203266789, 1.0139484637625902, 1.3333333333333333, 1.0077369439071566, 1.271356783919598, 1.046070460704607, 1.1730769230769231, 1.219298245614035, 1.1222707423580787, 1.1142857142857143, 1.0414354007574347, 1.0156708703741988, 1.053703157273532, 1.097799511002445, 1.1235955056179776, 1.0284003108447295, 1.2753623188405796, 1.1306921559080543, 1.08649468892261, 1.091254752851711, 1.0729166666666667, 1.5, 1.0485451575827234, 1.328223378045442, 2.25, 1.0, 1.0804597701149425, 1.0180722891566265, 1.0805825242718448, 1.0114942528735633, 1.1899547626093943, 1.0537530266343826, 1.0064852776742452, 1.4465408805031446, 1.4854368932038835, 1.1017935578330893, 1.0666342412451362, 1.5, 1.0, 4.0, 1.0518018018018018, 1.2241379310344827, 1.2927927927927927, 1.1428571428571428, 2.0, 1.0975426238693669, 1.1047989236059201, 1.1247135027404085, 1.0473958996561823, 1.106654257794323, 1.035264483627204, 1.0126146788990826, 1.0550898203592813, 1.0745428973277074, 1.1037037037037036, 1.286514605842337, 1.0740740740740742, 1.3333333333333333, 1.0611215001152752, 1.158074137196421, 1.054519368723099, 1.237613309548946, 1.1818181818181819, 1.020362417513355, 1.0472510487966438, 1.3077267236365264, 1.2108951895508124, 1.0427848101265822, 1.5, 3.0, 1.0613592233009708, 1.078604065347099, 1.075371549893843, 1.0816326530612246, 1.0606724454951406, 1.0, 1.0927099841521395, 1.1245421245421245, 1.5, 1.0277777777777777, 1.25, 1.2851153039832286, 1.0311260775544595, 1.1414586709886547, 1.1065573770491803, 1.8333333333333333, 1.1498973305954825, 1.0, 2.0, 1.115952664893129, 1.0, 1.0307136404697381, 1.0091691950740675, 1.0775185615257399, 1.6666666666666667, 1.4285714285714286, 1.0516129032258064, 1.0190735694822888, 1.069331983805668, 1.037568579517116, 1.2269938650306749, 1.04004329004329, 1.0714278488695563, 3.0, 1.0272448196469686, 1.0268199233716475, 1.135135135135135, 1.0986929064473492, 2.0, 1.2239031770045385, 1.0024783147459728, 1.0187074829931972, 1.0587719298245615, 1.0, 1.014322250639386, 1.1549146129726087, 1.1667251975417032, 1.1031468531468531, 1.0542005420054201, 1.3392857142857142, 1.2790697674418605, 1.0374064837905237, 1.4, 1.0565935019645591, 1.1363636363636365, 1.1972027972027972, 1.233986610397932, 1.0254777070063694, 1.0092457623589188, 1.289198606271777, 1.0528301886792453, 1.0814387788242936, 1.0952380952380953, 1.0079767947788252, 1.0612409347300564, 1.055643879173291, 1.0005538759779373, 1.204214146391541, 1.1402439024390243, 1.5, 1.0140748290221868, 1.0680420464953984, 1.3220973782771535, 1.1097034616527164, 1.0435835351089588, 2.0, 1.2528409090909092, 1.1054846281559512, 1.380952380952381, 1.1398283695103484, 1.0591897327842161, 1.0473937675787102, 1.0830711139081184, 1.068452380952381, 1.0357198483983179, 1.040620319611464, 1.0012295081967213, 1.0199553446832264, 1.0550634426621976, 1.0255020280476304, 1.0681711330512458, 1.0069880583812472, 1.4144144144144144, 1.0857142857142856, 1.170731707317073, 1.0, 1.4411764705882353, 1.03351259181532, 1.3444108761329305, 1.2363636363636363, 1.0211355159552424, 1.1538461538461537, 1.0458079405719232, 1.024390243902439, 1.2203227352612238, 1.7272727272727273, 1.0479616306954436, 1.0117775951794028, 1.0203732094092848, 1.0062578704015226, 3.0, 1.0162264150943396, 1.1172899266527738, 1.1962848297213622, 1.013262599469496, 1.0098039215686274, 1.0192743764172336, 1.0744792349010874, 1.3833333333333333, 1.0037572186762058, 1.0155425780244063, 1.0823170731707317, 1.1548451548451548, 1.0044247787610618, 1.75, 1.1068152031454783, 2.0, 1.215480172001911, 1.1216783216783217, 1.1098039215686275, 1.2267657992565055, 1.1333333333333333, 2.0, 1.088443534230544, 1.1363636363636365, 1.0526345417698717, 1.6, 1.174074074074074, 1.0372549019607844, 1.0, 1.0236368795220605, 1.028169014084507, 1.1, 1.0742115027829313, 1.0038394415357765, 1.0550956184943112, 1.0416666666666667, 2.0, 1.132472033491181, 1.051925391095066, 1.1437037037037037, 1.0174444947893067, 1.117351771168782, 1.0174686424686425, 1.1049136786188578, 1.0712904643327963, 1.0205102551275638, 1.00011586142973, 1.0092970984879444, 1.4166666666666667, 1.0610407398362762, 1.0161579892280073, 1.1666666666666667, 1.6, 1.0724421209858104, 1.1508771929824562, 1.0353037401872316, 1.0112952602132377, 1.0436781609195402, 1.3728813559322033, 1.0334942622087864, 1.1184668989547037, 1.2150662251655628, 1.0550841719395736, 1.0, 1.0899581589958158, 1.0734843845682793, 1.0286219831552126, 1.0914427728402385, 1.1219083540646817, 1.2240553485896755, 1.2013348164627364, 1.0131466133180909, 1.040305270689244, 1.0569913490426033, 1.0398961251964738, 1.0212765957446808, 1.126984126984127, 1.0, 1.0673974226040586, 1.0714285714285714, 1.031021897810219, 1.1147003879867796, 1.0634598299276559, 1.5142857142857142, 1.0826446280991735, 1.1456392887383573, 1.128315535652773, 1.018478983655899, 1.0909090909090908, 1.168728121353559, 1.0170463623775032, 1.1425233644859814, 2.0, 4.0, 1.0310641110376735, 1.25, 1.003353181522946, 1.031201248049922, 1.0476190476190477, 1.1007284601858829, 1.1538461538461537, 1.5833333333333333, 1.0146203055883545, 3.0, 1.0571428571428572, 1.0191616766467066, 1.0704715851115745, 1.0620689655172413, 1.0584415584415585, 1.0495049504950495, 1.103396592138478, 1.0907472345956484, 1.1041902604756513, 1.056872311973689, 1.0516429052193599, 1.5, 1.0, 1.0719920728686307, 1.5, 1.0591523055426175, 1.2727272727272727, 2.25, 1.6111111111111112, 1.2994210090984284, 1.0664581704456606, 1.1732283464566928, 1.0112994350282485, 1.2530120481927711, 1.6666666666666667, 1.047965095486732, 1.0625, 1.0273972602739727, 1.0508506079964, 1.073643410852713, 1.0452830188679245, 1.0365168539325842, 1.75, 1.5, 1.2634450506625097, 1.1510791366906474, 1.146503884572697, 1.1242241145778122, 1.2029200692897797, 1.017283950617284, 1.0, 1.0323548236937041, 1.0377358490566038, 1.3703703703703705, 2.0, 1.2040816326530612, 1.5714285714285714, 1.0086580086580086, 1.1071428571428572, 1.2128074269740723, 1.0972694135023247, 1.444736842105263, 1.1171225382932166, 1.11011506556061, 1.0618556701030928, 1.0850439882697946, 1.0985390409144242, 1.1103896103896105, 1.0285714285714285, 1.0003258051873851, 1.0532532039129445, 1.009551447569865, 1.0292682926829269, 1.0232558139534884, 1.1924686192468619, 2.0, 1.1041666666666667, 1.5465116279069768, 1.150375939849624, 2.176767676767677, 1.3504464285714286, 1.0816104461371054, 1.0981087470449173, 1.1012175177176087, 1.114735226400614, 1.1042844077574279, 1.118279569892473, 1.1858407079646018, 1.1102564102564103, 2.0, 1.0870420762460224, 1.6666666666666667, 1.0999190100389882, 1.0186500888099468, 1.048066528066528, 1.1556388963300295, 1.375, 1.047519799916632, 1.0, 1.0740849971982187, 1.0833333333333333, 1.0081535464319216, 1.0366300366300367, 1.1370340573880398, 1.117056856187291, 1.0385674931129476, 3.0, 1.2012248468941382, 1.0093627749948324, 1.1435567799204163, 2.0, 1.2972972972972974, 1.349025974025974, 1.2804878048780488, 1.0807353040199312, 1.143374669081789, 1.0, 1.0014378145219267, 1.0301506558303613, 1.111406890114259, 1.00979711951072, 1.0144431820928714, 1.077401129943503, 1.3206106870229009, 1.0377180575200378, 1.1166334591547604, 1.0458015267175573, 1.0230563002680966, 2.0, 1.5, 1.3081967213114754, 1.0418250950570342, 1.0518834399431414, 1.109264442052386, 1.0781089414182938, 1.0, 1.1355932203389831, 1.2413793103448276, 1.05697622252131, 1.0869565217391304, 1.0, 1.017952200888432, 1.3333333333333333, 1.0, 1.0151515151515151, 2.3333333333333335, 1.0305393112410657, 1.0135542168674698, 1.0268096514745308, 1.3333333333333333, 1.070806950375497, 1.0733788395904438, 1.45, 1.0593847413331654, 1.078125, 1.1061571125265393, 1.0362173038229376, 1.3209790209790209, 1.0002392344497608, 1.0, 1.0963855421686748, 1.098993288590604, 1.1497842968075926, 1.0682539682539682, 1.5, 1.1052146674037222, 1.0151431431869533, 1.0353825740822644, 2.0, 1.0483817150483816, 1.01910128074487, 1.0005653606017404, 1.0251904779264336, 1.0215425088463606, 1.010380670780878, 1.001411432604093, 1.0709558823529413, 1.5, 1.0516452197944555, 1.0636848341232228, 1.0339388145315487, 1.0474065811489124, 1.0100502512562815, 1.0001423690205011, 1.5947712418300655, 1.0294267515923567, 1.1060547628229849, 1.073558668086731, 1.0811485642946317, 1.1426861204638983, 1.0569815581482875, 1.0454545454545454, 1.2297297297297298, 1.11514042827935, 1.0211416490486258, 1.0090109135110852, 1.0697589316597071, 1.3333333333333333, 1.1702317290552584, 1.3888888888888888, 1.3846153846153846, 1.0, 1.0157595424315267, 1.1258992805755397, 1.0267909143855563, 1.0, 1.0363636363636364, 1.010054844606947, 1.1002455410428673, 1.0488532537758717, 1.037466741711011, 1.1452380952380952, 1.0930326762084797, 1.0225756798358132, 1.0217853506617955, 1.5348837209302326, 1.0097743603258638, 1.1546391752577319, 1.085, 1.1000914741897259, 1.0178343949044586, 1.0074576968574809, 2.0, 1.200583515681984, 1.0726072607260726, 1.080956465794553, 1.0798226164079823, 1.070935960591133, 1.1190864600326265, 1.146189735614308, 1.0865468485833971, 1.0, 1.3148148148148149, 1.1666666666666667, 1.3333333333333333, 1.1308411214953271, 2.875, 1.01889338731444, 1.0866141732283465, 1.0587922319765894, 1.1377587437544612, 1.0223102098065573, 1.145519747086302, 1.0527872489011214, 1.0250954769528815, 1.0178086043677945, 1.072072072072072, 1.141027719241368, 1.0488729103902692, 1.065036674816626, 1.061742006615215, 1.1507024265644956, 1.0807453416149069, 1.0069180354397604, 1.1835518474374256, 1.0967811495334432, 1.261111111111111, 1.177046051061799, 1.2916666666666667, 1.3333333333333333, 1.0082352941176471, 1.1764705882352942, 1.3333333333333333, 1.36, 1.0462804224106212, 1.051487414187643, 1.0452127659574468, 1.0267379679144386, 1.1042937367332133, 1.0623276850159538, 1.1495327102803738, 1.6, 1.2307692307692308, 1.1410170319272328, 1.090497737556561, 1.0888355342136855, 1.0811003082760255, 1.0, 1.4296197464976652, 1.1695652173913043, 1.0824275667126562, 1.1339285714285714, 1.025939586348569, 1.0482072796488366, 1.0050403568227724, 1.3265306122448979, 1.0, 1.110387628446434, 2.0, 1.0565371024734982, 1.205128205128205, 1.3476454293628808, 1.0979820227394488, 1.6666666666666667, 1.0536807817589577, 1.0972222222222223, 1.0340909090909092, 1.133228969267529, 1.2163398692810456, 1.1371391076115485, 1.0016075650118204, 1.0018034265103697, 1.0590277777777777, 1.4, 1.0415834465127427, 1.0351619784028796, 1.05, 1.0440028388928317, 1.1886302424009234, 1.364864864864865, 1.0033873743320352, 1.5, 1.0606060606060606, 1.0132223310479922, 1.055299539170507, 1.0274725274725274, 1.0024341890637156, 1.053030303030303, 1.7777777777777777, 1.0587044534412955, 1.023537323470074, 1.058510187356939, 1.125984251968504, 1.0066417441296869, 1.0814376254147378, 1.1575037147102527, 1.1125511596180082, 1.2486033519553073, 1.0817784556414591, 1.0822784810126582, 1.0022505626406601, 1.112141280353201, 1.1022654475569273, 1.1818181818181819, 1.0648269105160026, 1.2105263157894737, 1.1428571428571428, 1.1547314578005115, 1.6078886310904872, 1.0211508553654742, 1.4848484848484849, 1.0, 1.015472312703583, 1.0138740661686232, 1.1781609195402298, 1.0473074572756673, 2.0, 1.1488139257068093, 2.0, 1.0365384615384616, 1.0, 1.0525137390596377, 1.4193548387096775, 1.158450704225352, 1.0718038528896672, 1.0, 1.1214442013129102, 1.2630480167014613, 1.4, 3.0, 1.1666666666666667, 1.180515759312321, 1.056419720537833, 1.2023305084745763, 1.078762306610408, 1.0336273428886438, 1.0885416666666667, 1.0063795853269537, 1.1847389558232932, 1.1661237785016287, 1.03125, 1.0, 1.1661863592699329, 1.078502415458937, 1.040888888888889, 1.0322724039829303, 1.0458957978060017, 1.0470306895177361, 1.0925990013348494, 1.1645244991552015, 1.2122302158273381, 1.0225790265930759, 1.5, 1.0, 1.1818181818181819, 1.0258345299621086, 1.078241430700447, 1.1337047353760445, 1.3276231263383298, 1.003800595426617, 1.0421510782157362, 1.011183520753243, 1.130952380952381, 1.2857142857142858, 1.1150793650793651, 1.028628343767786, 1.079859387923904, 1.02247989442458, 1.0568181818181819, 1.0600728529974686, 1.0477541431854067, 1.0320705383153073, 1.0268256333830104, 1.0887096774193548, 1.1201413427561837, 1.0789367700362464, 1.1208459214501512, 1.0307525117527934, 2.25, 1.0976696367374914, 1.0, 1.0194931773879143, 1.033052323556051, 1.0625, 1.1023634579166557, 1.011722272317403, 1.1627906976744187, 1.0252541477113752, 1.025269138755981, 1.0444637453771153, 1.04971932638332, 1.0068560235063664, 1.2015072823755222, 1.1625874125874125, 1.1764705882352942, 1.0, 1.4444444444444444, 1.0547132630901632, 1.4285714285714286, 1.0610564176724697, 1.0921748878923767, 1.0239763924751015, 1.0533267294039954, 1.0549723816744287, 1.0868092691622104, 1.0116618075801749, 1.0326340326340326, 1.0215708591968522, 1.1264405985076376, 1.0427444130876107, 1.1991209343212357, 2.0, 1.1278195488721805, 1.0299003322259137, 1.084152325261619, 1.0926430517711172, 1.2917995444191344, 1.0, 2.176056338028169, 1.0598630225495898, 1.0647321428571428, 1.0907294878318916, 1.2941176470588236, 1.0482888204242626, 1.025258554918195, 1.3428320911880753, 1.0560420315236427, 1.1176470588235294, 1.1093117408906883, 1.114516449328126, 1.0576700327911643, 1.032017870439315, 1.0194367576833598, 1.3333333333333333, 1.0555516340791982, 1.0460526315789473, 1.0217113665389528, 1.048811013767209, 1.0279531109107305, 1.0481231953801733, 1.043940125543216, 1.0096927879086577, 1.073288331726133, 1.0933123936657505, 1.0706012094300488, 1.0, 1.0900709219858156, 1.1951700344997536, 1.0159887646518662, 1.1012269938650308, 1.0445054945054946, 1.0781725888324873, 1.1605839416058394, 1.061437908496732, 1.0535922051429245, 1.3902439024390243, 1.1180637544273908, 1.2458252269779506, 1.061416977407326, 1.0, 1.1901214458523965, 1.077395596404091, 1.047082228116711, 1.0701402805611222, 1.106294176492776, 1.0654581534418492, 1.146875, 1.0238095238095237, 1.0543677458766036, 1.0787019043917605, 1.1313131313131313, 1.8, 1.0465546324610542, 1.16442799461642, 1.0100334448160535, 1.038647342995169, 1.2605633802816902, 1.0400693925740307, 1.153953488372093, 1.039972432804962, 1.1515151515151516, 1.008337965536409, 1.1111111111111112, 1.1133501259445844, 1.4857142857142858, 1.0397565734460652, 1.2044887780548628, 1.24, 1.0625, 1.2857142857142858, 1.1033578174186778, 1.0485436893203883, 1.0289855072463767, 1.029593094944513, 1.028225806451613, 1.1099531005732153, 1.0833333333333333, 1.0009535259732183, 1.0295489891135303, 1.0278341894636245, 1.0977443609022557, 1.1176470588235294, 1.199177438307873, 1.0157179517088535, 1.059918401800788, 1.121122599704579, 1.3015873015873016, 1.0625, 1.0909090909090908, 1.0337078651685394, 1.0617283950617284, 1.0567269076305221, 1.0290425032139732, 1.0331213615632764, 1.358974358974359, 1.0961879609612522, 1.0462757289969287, 2.5, 1.0101225107610803, 1.1697522461203376, 2.5, 2.25, 1.1518796992481204, 1.1381397578808583, 1.037682563568712, 1.2727272727272727, 1.5, 1.35, 1.1532467532467532, 1.033210332103321, 1.0367067307692308, 1.08705798374698, 1.030885788665643, 1.0239370078740158, 1.8571428571428572, 1.03559124487942, 1.0338225909380983, 1.0501824817518248, 1.1443850267379678, 1.0046296296296295, 1.0, 1.1133333333333333, 1.194275802254987, 1.0039125654788852, 1.1485714285714286, 1.0830564784053156, 1.1002056600678805, 1.0684615384615384, 1.0815602836879432, 1.0555555555555556, 1.022214622802818, 1.4124873536638243, 1.048255454123472, 1.4720812182741116, 1.217741935483871, 1.1224598930481284, 1.375, 1.0874922982131854, 1.0073710073710074, 1.0040613818562019, 1.0905797101449275, 1.5, 1.0416666666666667, 1.0305823035913544, 1.1726644856415849, 1.2125020138553246, 1.009441580222374, 1.0602560534372392, 1.0974641214992336, 1.1865168539325843, 1.0566037735849056, 1.1622488382747562, 1.073949924750308, 1.2476722532588453, 1.0119760479041917, 1.75, 1.0481927710843373, 1.011078640903738, 1.0763239875389408, 1.065068588055979, 1.085718971258262, 1.0111436950146628, 1.8, 1.06301652892562, 1.0060248721439347, 1.1730143540669857, 1.089171974522293, 1.0681234507801363, 1.0530503978779842, 1.1909594095940959, 1.0043838285435946, 1.0313439828318396, 1.0393917837453317, 1.0214007782101167, 1.0599547511312217, 1.0, 1.0949738138044243, 1.3051948051948052, 1.000572898398223, 1.044344473007712, 1.111963190184049, 1.0293933708567855, 1.0029940119760479, 1.230603448275862, 1.6666666666666667, 2.5, 1.2272727272727273, 1.0238611713665944, 1.051667756703728, 1.0106701205785302, 1.0034888089742902, 1.0286446204005588, 1.0153390273662193, 1.1300448430493273, 1.2144846796657383, 1.0573188783122027, 1.6666666666666667, 1.8333333333333333, 1.0708016383850205, 1.1111111111111112, 1.0562719812426729, 1.131981795614398, 1.0387904228855722, 1.1146246662385506, 2.5, 1.0879524886877827, 1.2271186440677966, 1.0946171341925701, 1.0400239907093305, 1.1820083682008369, 1.1110796259563616, 1.1532025064725526, 1.101268321571337, 1.087018544935806, 1.2285714285714286, 1.068208092485549, 1.3333333333333333, 2.0, 1.04110614246406, 5.0, 1.7142857142857142, 1.911764705882353, 1.0154162384378211, 1.071465642516089, 1.1270903010033444, 1.0576923076923077, 1.0, 1.2374269005847953, 1.0279411764705881, 1.136038186157518, 1.2426614481409002]
origin-bjaq_15.71 	max: 5.0000	99th: 2.8762	95th: 1.7500	median: 1.0810	mean: 1.1826

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.139623 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.111422