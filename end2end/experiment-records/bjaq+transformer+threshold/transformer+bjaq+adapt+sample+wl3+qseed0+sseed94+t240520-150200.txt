Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 94, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.2879	95th: 1.6667	median: 1.0786	mean: 1.1704
ReportEsts: [1.0227272727272727, 1.0276041666666667, 1.0333174196721786, 1.0483870967741935, 1.5, 1.0, 1.0028263103802673, 1.0452386961683353, 1.0, 1.0196335078534031, 1.1433930684212046, 1.04293894850753, 1.0493609519612164, 1.072093023255814, 1.0635817732250088, 1.0, 1.1842105263157894, 1.0198370527807297, 3.0, 2.0, 1.173913043478261, 1.09735895494131, 1.1171597004620533, 1.1285965942454492, 1.1011346817957572, 1.0, 1.1786936522539098, 1.5, 1.4, 1.064748201438849, 1.0, 1.039744153332161, 1.0113521726292998, 1.0067039106145252, 1.07416654427963, 1.2425134589502018, 1.2165775401069518, 1.0154701200327452, 1.1198429643914871, 1.0238095238095237, 1.0182767624020888, 1.0396341463414633, 1.0, 1.0033982340324783, 1.1462164073550212, 1.8615384615384616, 1.03, 1.197879858657244, 1.026277698719252, 1.0462962962962963, 1.0681642735834491, 1.006872852233677, 1.0382906546356, 2.0, 1.1402597402597403, 1.2038132559629224, 1.2146643109540636, 1.3793103448275863, 1.049689440993789, 1.25, 1.1234323882224646, 1.085305105853051, 1.018181818181818, 1.0116279069767442, 1.0909090909090908, 1.0713067339068525, 1.3546028580923895, 1.75, 1.0, 1.0290854852242006, 1.033292231812577, 1.0609048723897911, 1.0422535211267605, 1.0583849247593655, 1.0847058823529412, 1.0671936758893281, 1.0, 1.1156576200417536, 2.0, 1.0030990846222274, 1.032258064516129, 1.0550869852455407, 1.0736196319018405, 1.0738916256157636, 1.108439646712463, 1.0, 1.0832583082162288, 1.0022840409956075, 1.0149253731343284, 1.75, 1.0762589928057553, 1.024939562734176, 1.0321543408360128, 1.02945301542777, 1.012014787430684, 1.0389610389610389, 1.0148148148148148, 1.1434146341463414, 1.0, 1.2616233254531126, 1.0475161987041037, 1.0789022298456261, 1.212882516584635, 1.2592592592592593, 1.02788522874749, 1.0764534112025483, 1.332112198589316, 1.1418278346605992, 1.049662783568363, 1.1666666666666667, 2.0, 1.0859813084112149, 1.061193722274645, 1.0265319014529375, 1.0, 1.0567104429287637, 2.0, 1.0930305897193315, 1.110520722635494, 1.0, 1.04, 1.1666666666666667, 1.2456140350877194, 1.008316030377741, 1.0833268618467033, 1.108910891089109, 1.8, 1.1043046357615893, 1.0, 1.0357142857142858, 1.0929956753330403, 1.1818181818181819, 1.0847981770833333, 1.0293857197585836, 1.066354866997954, 1.048064085447263, 1.092814371257485, 1.0623538581449727, 1.039972432804962, 1.0676416819012797, 1.0476539402046572, 1.1095890410958904, 1.0032615786040444, 1.1326867142909298, 2.0, 1.0209662716499543, 1.0182857142857142, 1.1233449477351916, 1.095817893065114, 1.5, 1.244126907241463, 1.021180030257186, 1.0060362173038229, 1.1074561403508771, 1.0817518248175182, 1.0367498314227916, 1.1093676539727315, 1.2435099523409028, 1.0845360824742267, 1.0986842105263157, 1.2653061224489797, 1.3269230769230769, 1.0103092783505154, 1.1428571428571428, 1.0577309236947792, 1.0100420132826022, 1.1549202127659575, 1.3321601826310283, 1.1399721448467968, 1.1521030452413135, 1.2673684210526315, 1.1226415094339623, 1.0795971724605404, 1.0485338725985844, 1.0431406384814494, 1.0855199222546161, 1.0583333333333333, 1.078871473354232, 1.0235747424707085, 1.0, 1.1825396825396826, 1.0040925769122213, 1.0277113237639552, 1.1385846672283066, 1.131578947368421, 1.0819180696945967, 1.2934845281568326, 1.0703633963162564, 1.1153846153846154, 1.1290909090909091, 1.053811388244393, 1.0, 1.0909090909090908, 1.0638795851660547, 1.0576230492196879, 1.0387931034482758, 1.4, 1.0585209003215434, 1.0424269205670624, 1.057421302857793, 1.0626410835214446, 1.1421945820596606, 1.0903954802259888, 1.103448275862069, 1.2727272727272727, 1.0, 1.4285714285714286, 1.1052673079955844, 1.2857142857142858, 1.3563218390804597, 1.013840830449827, 1.0031277926720286, 1.0116821215009966, 1.0420874486738432, 1.1464631422189129, 1.1428571428571428, 1.1315028901734103, 1.0071801566579635, 1.0615342638864955, 1.047257799277389, 1.0, 1.0658385093167702, 1.1130916038051721, 1.0056654417341824, 1.1518131530424094, 1.0166518997237712, 1.280407234918228, 1.0357142857142858, 1.0042118200337844, 1.023981433728726, 1.0045121263395376, 1.0786516853932584, 1.0356605800214822, 1.0143133462282399, 1.1125984251968504, 2.0, 1.2414197711938986, 1.0696181330951318, 1.2100328176277544, 1.1754385964912282, 1.0, 1.6666666666666667, 1.1382142417474193, 1.1454545454545455, 1.053424796404555, 1.5, 1.0, 1.05, 1.0402029664324746, 1.1136363636363635, 1.0331491712707181, 1.1139240506329113, 1.0435510887772195, 1.0041981528127624, 1.0786279785524864, 1.0178571428571428, 2.0, 1.0932905640203154, 1.1093012635104278, 1.106830122591944, 1.0303036829636012, 1.0600080764571276, 1.0045922718624942, 1.095389507154213, 1.0785697938489165, 1.020933014354067, 1.1530448717948718, 1.084576451784763, 1.0, 1.0195963158926122, 1.1580246913580248, 1.2045454545454546, 1.3888888888888888, 1.0378181818181818, 1.0555555555555556, 1.0598290598290598, 1.111082699683736, 1.0084269662921348, 1.3508771929824561, 1.037351740464285, 1.0161977834612106, 1.0275864877798784, 1.0372308809932638, 1.25, 1.0571662422699164, 1.6666666666666667, 1.0322172286612876, 1.0453563714902807, 1.0478630922579764, 1.0810810810810811, 1.6666666666666667, 1.4782608695652173, 1.0441176470588236, 1.0668200823258678, 1.0, 1.033639143730887, 1.0565610859728507, 1.0060096153846154, 1.016954370150086, 1.0677966101694916, 1.1320754716981132, 1.0054080803082253, 1.1725327583347156, 1.0263924804006075, 1.0256410256410255, 1.0, 1.1205250596658711, 1.3181818181818181, 1.088135593220339, 1.0931760741364784, 1.0379482902418682, 1.2450704225352112, 1.1568627450980393, 1.0013736263736264, 1.0259396506087877, 1.2857142857142858, 1.0039583053385293, 1.0459770114942528, 1.0, 1.0768799255691768, 1.2380952380952381, 1.4, 1.0059595511316808, 2.0, 1.159122085048011, 1.0334302325581395, 1.0598851517637409, 1.1109243697478992, 1.1101449275362318, 1.1666666666666667, 1.0874741270850525, 1.1131504426214875, 1.0396600566572238, 1.0351222658869264, 1.0079237080148657, 2.0, 1.0, 1.045704883566809, 1.25, 1.0715483510340973, 1.3529411764705883, 1.0, 1.4666666666666666, 1.3624497991967872, 1.0599250936329587, 1.1415929203539823, 1.027056277056277, 1.0, 1.2050599201065246, 1.0523415977961432, 2.0, 1.1506849315068493, 1.0, 1.0960753055492294, 1.155844155844156, 1.0276114976001727, 1.1497695852534562, 1.1363636363636365, 1.3401826484018264, 1.3055555555555556, 1.036618005768133, 1.022461741528248, 1.0836940836940836, 1.0, 1.0769230769230769, 1.5714285714285714, 1.5, 1.1428571428571428, 1.0695914657153638, 1.3333333333333333, 1.0782029950083194, 1.216867469879518, 1.1157445364846907, 1.074759998953674, 1.2265705458290421, 1.051082208101668, 1.0127610208816706, 1.042857142857143, 1.5, 1.1214953271028036, 1.025531914893617, 1.044745960772221, 1.0952380952380953, 1.5714285714285714, 1.0227790432801822, 1.0076157000585824, 1.0274760584237328, 1.0232843137254901, 1.1464387464387464, 1.0136798905608755, 1.0666666666666667, 1.0907770515613653, 1.0858050847457628, 1.1730769230769231, 1.0254957507082152, 1.0512820512820513, 1.045503977131494, 1.0632573388012325, 1.0317584669157527, 1.4576271186440677, 1.3214285714285714, 1.1222570532915361, 1.0, 1.0219498719172233, 1.0354388347248598, 1.0609213547646383, 1.0578648414197949, 1.0442336495257114, 1.151572926596759, 1.5714285714285714, 1.2137002341920375, 1.0, 1.2228864218616566, 1.25, 1.0248949024193323, 1.0, 1.1340283748925193, 1.0948616600790513, 1.0559322033898304, 3.0, 1.103425985778927, 1.015731659232608, 1.103572742321133, 2.0, 1.1111111111111112, 1.2927063339731286, 1.2985074626865671, 1.1126608551266086, 1.0299785867237687, 1.2352941176470589, 1.003451251078516, 1.0546982843620587, 1.060777636997149, 1.0963095180664768, 1.0737938596491228, 1.1807628524046434, 1.268939393939394, 1.5, 1.0824175824175823, 1.5, 1.2206494587843464, 1.0303030303030303, 1.1808502661768014, 1.3157894736842106, 1.0873815702130227, 1.0984550344566844, 1.0857495373226402, 1.0, 1.0857142857142856, 1.08, 1.2837945848736136, 1.3347921225382933, 1.0, 1.0059408676429953, 1.1208436740900682, 1.1210111893908, 1.5, 1.5, 1.0202060221870048, 1.0099547511312217, 1.019672131147541, 1.1111111111111112, 1.08179085305478, 1.0611222444889779, 1.4705882352941178, 1.0694161958568738, 1.0454545454545454, 1.1377952755905512, 1.0105949470252649, 1.378628523348759, 1.0653091175931022, 1.0, 1.0571428571428572, 1.0906732042518164, 1.0379560930785003, 1.0227221159767916, 2.0, 1.0900243309002433, 1.021853976300781, 1.0214772132006287, 2.0, 1.0554226475279107, 1.0696310097818287, 1.0236700326787764, 1.0350356035122974, 1.0151670985199277, 1.0691779199241886, 1.0162254483347566, 1.1012536162005786, 2.0, 1.0791772184609023, 1.510204081632653, 1.0, 1.1761658031088082, 1.1346153846153846, 1.0084394692094822, 1.2196891191709844, 1.0585660492765259, 1.3607159247361176, 1.0788516119641947, 1.1294467739753822, 1.0557693863633737, 1.2117647058823529, 4.0, 1.0091465610370904, 1.2184210526315788, 1.046095971563981, 1.02895617728585, 1.0953830542871639, 1.0721153846153846, 2.863013698630137, 2.2857142857142856, 1.011998915909035, 1.0166568248415095, 1.0221617638723572, 1.1259231905465288, 1.0178846895487852, 1.0125260960334028, 1.0682758835305954, 1.0317195325542572, 1.2114197530864197, 3.0, 1.0833333333333333, 1.0300157977883095, 1.0907335907335907, 1.099630996309963, 1.1745810055865922, 1.0529411764705883, 1.3724137931034484, 1.148905109489051, 1.1518987341772151, 1.043270263523046, 1.2555555555555555, 1.0481608805823206, 2.0, 1.222124670763828, 1.0396825396825398, 1.4242424242424243, 1.1058659217877096, 1.143929912390488, 1.0118577075098814, 1.0583657587548638, 1.0908855414664473, 1.0, 1.5106382978723405, 1.0, 1.0, 1.1363636363636365, 1.0705645161290323, 1.001543209876543, 1.0970873786407767, 1.0719320730535085, 1.0661252900232019, 1.102483240487206, 1.1850899742930592, 1.0402476780185759, 1.0893124933995142, 1.0972972972972972, 1.1162483487450463, 1.0227382680212869, 1.0996732026143792, 1.1632947976878614, 1.2035714285714285, 1.0737850301525365, 1.3667072300784693, 1.0777320098669845, 2.0, 1.0417690417690417, 1.072348860257681, 1.4074074074074074, 1.0, 1.02, 1.25, 1.0141592920353983, 1.2962962962962963, 1.1666666666666667, 1.023176007153387, 1.1199793001870946, 1.0234615484104608, 1.013230345671459, 1.1945945945945946, 1.1289437585733881, 2.0, 1.1578947368421053, 1.0031133250311333, 1.0535899274842617, 1.0829227673305115, 1.1018908759539812, 1.0188727365467993, 1.1688311688311688, 1.114766688807705, 1.1243339253996447, 1.0291611543377357, 1.1139611061955232, 1.303030303030303, 1.0403726708074534, 1.0, 1.2422535211267605, 1.206330645988471, 3.0, 1.125258086717137, 1.0681917865140007, 1.4285714285714286, 1.0158823098880188, 1.4, 1.1176470588235294, 1.0604103457598606, 1.6153846153846154, 1.036317271551672, 1.0260572404955148, 1.3571428571428572, 1.0357142857142858, 1.0969072164948455, 1.0004784688995216, 1.020971302428256, 1.0753134009264358, 1.155524385967587, 1.0, 1.0189007169237454, 1.1341463414634145, 2.0, 1.0034135203081394, 1.0902759754304006, 1.1163670766319773, 1.0184023687478112, 1.0444091990483744, 1.0884955752212389, 2.142857142857143, 1.026953125, 1.038709677419355, 1.1355098162319923, 1.2419221209610605, 1.0096126430695287, 1.0251744939327658, 1.2417582417582418, 1.102091020910209, 1.2307692307692308, 1.0823628590353465, 1.0769716088328076, 1.0036363636363637, 1.0247578040904197, 1.0737554474177122, 3.0, 1.1438338706049929, 1.054562036144073, 1.0407461470753856, 1.7272727272727273, 1.2759338980697126, 1.3091787439613527, 1.1428571428571428, 1.0616491500317415, 1.0420575865415722, 1.1517467248908297, 1.0588235294117647, 1.3333333333333333, 1.0719800181653043, 1.5, 1.0186915887850467, 1.0833333333333333, 1.0436466401507223, 1.3846153846153846, 1.1476793248945147, 1.0429769392033543, 1.0, 1.7023809523809523, 1.3023850085178876, 1.25, 2.0, 1.1176470588235294, 1.1724137931034482, 1.0709964979305953, 1.1972361809045227, 1.097770154373928, 1.2005899705014749, 1.1014466214978942, 1.0545454545454545, 1.1556603773584906, 1.3877551020408163, 1.0384615384615385, 1.0, 1.0995575221238938, 1.0735930735930737, 1.0929752066115703, 1.0085684430512016, 1.0899578263054444, 1.0622968104735964, 1.0519520943882845, 1.1778846153846154, 1.1837606837606838, 1.0145278450363195, 1.5714285714285714, 1.0, 1.2592592592592593, 1.0183729225165061, 1.0979699911738747, 1.107843137254902, 1.1123287671232878, 1.0629247804505537, 1.061262156598282, 1.0177849485719606, 1.1142857142857143, 1.2222222222222223, 1.0505443234836702, 1.0554082714740192, 1.076189220807039, 1.0040048110601514, 1.013157894736842, 1.0848346131128175, 1.0285482476759527, 1.14014598540146, 1.3217922606924644, 1.2857142857142858, 1.0572792362768497, 1.458128078817734, 1.1555555555555554, 1.2832167832167831, 1.0701001430615165, 1.0, 1.076167076167076, 1.0193201674854109, 1.0740740740740742, 1.0709765242519045, 1.016146393972013, 1.1944444444444444, 1.0189622606570128, 1.0253424657534247, 1.0453934998656997, 1.0305343511450382, 1.0488095238095239, 1.1994457025044782, 1.1382113821138211, 1.2857142857142858, 1.0, 1.4285714285714286, 1.0682087925396633, 1.5, 1.1944892039961328, 1.10904097786872, 1.0219317678334072, 1.0683217477656406, 1.0575074585704616, 1.1055734190782422, 1.0465949820788532, 1.0097087378640777, 1.014280474618576, 1.1405136857892764, 1.0429133484309931, 1.2092316030350476, 1.4285714285714286, 1.09375, 1.0160642570281124, 1.128513986619987, 1.0749185667752443, 1.3073318632855568, 1.0071301247771836, 2.211206896551724, 1.0392168770733856, 1.0657718120805368, 1.0510526315789475, 1.125, 1.0651519073729792, 1.026177210029218, 1.3537886872998932, 1.0581052631578947, 1.032258064516129, 1.0174291938997821, 1.1618497109826589, 1.625, 1.049023078012176, 1.5769230769230769, 1.2076612903225807, 1.0556844547563806, 1.0255878284923927, 1.0063983835662569, 1.015531660692951, 1.375, 1.108910891089109, 1.0965844332512225, 1.046602589032724, 1.0067364384039248, 1.0444186878930952, 1.1259403861914015, 1.0769230769230769, 1.0829059829059828, 1.0496206684437155, 1.032746997633823, 1.0430861723446894, 1.0, 1.1284941388638412, 1.001800580422395, 1.3633663366336635, 1.0634369897580525, 1.0, 1.3333333333333333, 1.0530544636455783, 1.0250457295624034, 1.242294112033591, 1.0847743489945325, 1.0750199521149242, 1.056338028169014, 1.1062877645365743, 1.078359301304362, 1.1268382352941178, 1.0277777777777777, 1.08018154311649, 1.0823884553084966, 1.0952380952380953, 1.75, 1.0330018903995473, 1.1767025089605734, 1.001140250855188, 1.0511363636363635, 1.2411296162201304, 1.0157000395502571, 1.1703682878830475, 1.2048192771084338, 1.3076923076923077, 1.0667115902964959, 1.1150234741784038, 1.1375, 1.5357142857142858, 1.0586434238462399, 1.1982160555004955, 1.1633499170812605, 1.0731707317073171, 1.0094894171932993, 1.0485977718017672, 1.0623828647925033, 1.2950089126559714, 1.3333333333333333, 1.0769230769230769, 2.0, 1.137234413096482, 1.1923076923076923, 1.0, 1.1538461538461537, 1.1576158940397352, 1.059782608695652, 1.007127362875736, 1.053803682011177, 1.290909090909091, 1.3333333333333333, 1.1428571428571428, 1.0333333333333334, 1.1486486486486487, 1.0571428571428572, 1.1243432574430823, 1.0285047581097235, 1.0298059441208118, 1.3195876288659794, 1.0678689399068546, 1.0479605625344077, 2.5, 1.0689922084992005, 1.3059701492537314, 1.5, 2.0, 1.2127218934911244, 1.0908699705945635, 1.0707208528327872, 1.2577639751552796, 1.0, 1.2169811320754718, 1.2361963190184049, 3.0, 2.0, 1.0423228346456692, 1.2637451270332034, 1.029863801074597, 1.6666666666666667, 1.0265819775143508, 1.0395042602633617, 1.0974358974358975, 1.0, 1.0046948356807512, 1.0235395307231818, 1.1176470588235294, 1.1431053742087625, 1.0133628129788017, 1.3449367088607596, 1.0703125, 1.0392510521343297, 1.0655141037306641, 1.078512396694215, 1.3269230769230769, 1.0571227022548866, 1.6202933016250496, 1.0714260272834126, 1.1059602649006623, 1.1862745098039216, 1.2238805970149254, 1.0926430517711172, 1.0751188589540412, 1.0523402378051343, 1.0867445870856487, 1.0338427947598254, 1.5, 1.6666666666666667, 1.1232819791600077, 1.1710642040457344, 1.1058159891071775, 1.0094009646420639, 1.062050510118749, 1.1192918244882326, 1.0317460317460319, 1.0, 1.126876817860231, 1.1149246984857513, 1.3144848954298993, 1.038181818181818, 1.6666666666666667, 1.0135135135135136, 1.091582572481179, 1.1641168289290682, 1.0293857888398235, 1.0946309419127915, 1.0035511363636365, 1.6, 1.1102464332036317, 1.0392770366295327, 1.1793465844185516, 1.1520912547528517, 1.0960639870309445, 1.0414012738853504, 1.1423841059602649, 1.0040745052386495, 1.0325483834677873, 1.0710076605774896, 1.044930875576037, 1.0597014925373134, 1.0, 1.1607656451452941, 1.0651567784989486, 1.0013210039630118, 1.0505258109820848, 1.122423485321674, 1.0393343419062027, 1.2, 1.252659574468085, 1.6666666666666667, 2.0, 1.1176470588235294, 1.0025575447570332, 1.0157977883096367, 1.0633366238894373, 1.0104999786151148, 1.0171128898702733, 1.0416317991631798, 1.1576086956521738, 1.225, 1.0603337612323491, 1.6, 1.5, 1.6356382978723405, 1.1428571428571428, 1.0488826815642458, 1.1346633416458853, 1.0419107706173951, 1.0848712080634952, 2.0, 1.0006191950464396, 1.195736434108527, 1.010224438902743, 1.0405561620962045, 1.1136363636363635, 1.1226027397260274, 1.1570681807940155, 1.1737290811493526, 1.0465890183028286, 1.2456140350877194, 1.1215083798882681, 1.0, 1.0, 1.0413522406208648, 5.0, 1.4285714285714286, 2.076923076923077, 1.0221948212083847, 1.1058823529411765, 1.0637472283813747, 1.102785406041585, 1.0, 1.0620732464307883, 1.0146028037383177, 1.17989417989418, 1.28125, 1.4285714285714286, 1.0098214285714286, 1.04490022172949, 1.1469933184855234, 1.048716995165489, 1.0224940426811735, 1.0568235628373899, 1.145519077196096, 1.0, 1.233870626560054, 1.0582648899163118, 1.0323708751793401, 1.1774193548387097, 1.0309651208878319]
origin-bjaq_15.71 	max: 5.0000	99th: 2.2879	95th: 1.6667	median: 1.0786	mean: 1.1704

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 13.975525 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[7.7486038e-07 9.5367432e-07 4.7683716e-07 7.7486038e-07 5.9604645e-08]
Distance score: 6.079673653403006e-07
SAUCE Drift detection: False
Detection latency: 0.0235s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.031250 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 6.0000	99th: 3.0000	95th: 1.7500	median: 1.0850	mean: 1.1840
ReportEsts: [1.0616966580976863, 1.0228062554300608, 1.051608158935288, 1.0823117338003503, 1.4583333333333333, 1.0, 1.048289109264719, 1.0417980858385416, 1.2, 1.0275938189845475, 1.15762634402136, 1.0441298542276243, 1.024117441454037, 1.095602294455067, 1.0526627218934912, 1.1, 1.0602409638554218, 1.0, 1.1818181818181819, 1.1488451668092388, 1.0719850762646768, 1.0119843799093318, 1.1923076923076923, 1.0202531645569621, 1.0193590512829562, 1.025239918538285, 4.0, 1.1660968747163647, 1.5, 1.6, 1.0073487846240814, 1.0, 1.0478916040331325, 1.004009841871191, 1.1308924485125857, 1.002223594811612, 1.2336779296468465, 1.1235955056179776, 1.0410958904109588, 1.0728565082185695, 1.0389146388567014, 1.0779259703281883, 1.1430429128738622, 1.0648326398807675, 1.0314232902033271, 1.1797706490780993, 1.1304347826086956, 1.1584158415841583, 1.3298969072164948, 1.0026525198938991, 1.4705882352941178, 1.2256637168141593, 1.0854700854700854, 1.0625, 1.0447965206585896, 1.005059854374923, 1.0221688788477832, 1.0911330049261083, 1.1363636363636365, 1.0236549309213885, 1.393939393939394, 1.1691450610670666, 1.0675883256528418, 1.1320754716981132, 1.0495049504950495, 2.0, 1.0951447097896567, 1.3281420765027323, 2.5, 1.0, 1.0339945608702608, 1.0161616161616163, 1.0434362934362935, 1.0425531914893618, 1.1403112652205467, 1.0223463687150838, 1.0321964213330246, 1.49645390070922, 1.4466019417475728, 1.086638182880514, 1.0937651039149348, 1.1737089201877935, 1.0, 2.0, 1.0299194476409665, 1.0461538461538462, 1.221311475409836, 1.2903225806451613, 1.3333333333333333, 1.0829392622990237, 1.1112614644414374, 1.2533643462369164, 1.1566596411864494, 1.0025231286795626, 1.1342105263157896, 1.0456182472989195, 1.181651376146789, 1.0811188811188812, 1.083916083916084, 1.202451561882167, 1.24, 1.3333333333333333, 1.045103543606065, 1.2240437158469946, 1.0636942675159236, 1.2315914918204471, 1.0833333333333333, 1.0272990688974006, 1.0198938992042441, 1.3117857142857143, 1.1609013011742304, 1.0411659422142674, 1.125, 1.5, 1.1017316017316017, 1.0749223939689028, 1.0465362242199894, 1.1123595505617978, 1.0616679081381075, 2.0, 1.121842105263158, 1.1737089201877935, 1.0, 1.0, 1.1428571428571428, 1.18580375782881, 1.0243908197263152, 1.0765525322223668, 1.1229508196721312, 1.6666666666666667, 1.1912072575017445, 1.0, 1.0833333333333333, 1.1255291735689306, 1.3846153846153846, 1.048180924287119, 1.0188136343514829, 1.073134067470722, 4.0, 1.4285714285714286, 1.0683760683760684, 1.1205516014234875, 1.0684584178498986, 1.0108668113748878, 1.2193548387096773, 1.0249864204236827, 1.1413911523846294, 1.5, 1.030686612965094, 1.0115718418514947, 1.0835670218732474, 1.0952591283863369, 1.5, 1.104158255954784, 1.0869565217391304, 1.0171526586620927, 1.1228070175438596, 1.0, 1.020746887966805, 1.1715779840502027, 1.1006636712148068, 1.07, 1.0217391304347827, 1.25, 1.4473684210526316, 1.0197287299630087, 1.75, 1.0985103335379578, 1.0759493670886076, 1.1864161849710984, 1.1137123407014202, 1.163106796116505, 1.0593595853189532, 1.2424778761061948, 1.127659574468085, 1.0327630729502906, 1.2939759036144578, 1.0223988439306357, 1.072072072072072, 1.061830835117773, 1.3645621181262728, 1.2303254939834511, 1.0963855421686748, 1.0238095238095237, 1.0132838179371397, 1.1064835659612786, 1.15625, 1.1566416040100251, 1.0730478589420656, 4.0, 1.2534818941504178, 1.0360428625553117, 1.0833333333333333, 1.1467750126968004, 1.033313143549364, 1.002182815290531, 1.0215519976311838, 1.0918866080156402, 1.0892253616330945, 1.0675886894330506, 1.0032935364347468, 1.0369088811995386, 1.014047619047619, 1.0714534068156296, 1.0493653032440056, 1.0610841780520053, 1.077294685990338, 1.0441176470588236, 1.2650602409638554, 1.0, 1.3795620437956204, 1.1114902552660937, 1.2905982905982907, 1.1574074074074074, 1.0090274928190397, 1.1666666666666667, 1.0452832359964326, 1.0294117647058822, 1.243140851810496, 1.5, 1.0257668711656442, 1.0037776578521316, 1.0593698453300184, 1.015633804162011, 1.25, 1.0721539283805452, 1.0773809523809523, 1.0741621772895824, 1.0437158469945356, 1.0927152317880795, 1.0409117475160725, 1.105659615966641, 1.4102564102564104, 1.0070079105688388, 1.0162759840778417, 1.15625, 1.1028301886792453, 1.0844594594594594, 1.5, 1.200133422281521, 2.0, 1.2582716049382716, 1.0856389377255482, 1.1406589070822648, 1.1307420494699647, 1.0, 2.0, 1.1190661707413887, 1.0571428571428572, 1.0951284219118975, 1.6, 1.0782945736434109, 1.0460251046025104, 1.0, 1.0241023661132866, 1.0636792452830188, 1.148636763412489, 1.0919689119170986, 1.0083974807557732, 1.139400680239212, 1.044776119402985, 2.0, 1.016335866092156, 1.049269963347954, 1.1413690476190477, 1.038839519079979, 1.1410970464135022, 1.0456699451674325, 1.0936058009228742, 1.0907207710163664, 1.03727959697733, 1.04093426438719, 1.020772746157042, 1.1333333333333333, 1.0240445223380377, 1.0459558823529411, 1.2307692307692308, 1.0833333333333333, 1.1684631967970434, 1.0860832137733143, 1.0649694315174743, 1.0144194823227828, 1.1267281105990783, 1.3478260869565217, 1.036391872264076, 1.032119914346895, 1.1103854730805989, 1.0478917013925824, 1.2, 1.0, 1.1184690157958688, 1.0181258198825072, 1.0935652312557298, 1.0748151836672157, 1.1936507936507936, 1.1914414414414414, 1.0345387766633705, 1.0014293493057447, 1.1669192192517228, 1.1015442680572762, 1.053030303030303, 1.75, 1.0, 1.0996672716273441, 1.5, 1.0294117647058822, 1.0331625403299955, 1.0311391407173827, 1.3333333333333333, 1.0521739130434782, 1.0632302405498282, 1.02391342293594, 1.033266324244073, 1.0909090909090908, 1.2246890619551318, 1.0018716156861718, 1.2666666666666666, 1.4, 3.625, 1.0123456790123457, 1.25, 1.0001688715556576, 1.0429252782193958, 1.1, 1.0979616949036677, 1.434782608695652, 1.1538461538461537, 1.0036310999661895, 2.0, 1.1043478260869566, 1.0314009661835748, 1.0677710843373494, 1.1453125, 1.0666666666666667, 1.1368421052631579, 1.1017694115520202, 1.0856076131728993, 1.0609756097560976, 1.0384407915282627, 1.056773090775899, 3.0, 1.0, 1.0335435561313924, 1.5, 1.06967022758941, 1.6470588235294117, 1.2, 1.368421052631579, 1.3144286905754796, 1.1001577287066246, 1.3008130081300813, 1.1542056074766356, 1.2142857142857142, 1.8333333333333333, 1.0616779651196477, 1.2216748768472907, 1.2459016393442623, 1.012349179654653, 1.084942084942085, 1.089675960813866, 1.0092336103416435, 1.4, 1.25, 1.3363863447127393, 1.167832167832168, 1.1376975169300225, 1.1307817628031072, 1.2923497267759563, 1.045, 2.0, 1.0319213114754098, 1.2857142857142858, 1.7727272727272727, 4.0, 1.0840816326530611, 1.1428571428571428, 1.0866807610993658, 1.0769230769230769, 1.1952918689167777, 1.0624250485140527, 1.1022927689594357, 1.075085695630883, 1.1184975003377922, 1.1391437308868502, 1.0847953216374269, 1.0816981669674233, 1.1321070234113713, 1.125, 1.0117960264525538, 1.079320382807892, 1.0028837535559798, 1.103960396039604, 1.1891891891891893, 1.1882845188284519, 2.0, 1.0625, 1.2952380952380953, 1.1106941838649156, 1.3365853658536586, 1.1666666666666667, 1.066017316017316, 1.0889748549323017, 1.0475911447881716, 1.1032233307751342, 1.0224562382313969, 1.0721649484536082, 1.1428571428571428, 1.12987012987013, 1.0, 1.094055572426359, 1.7916666666666667, 1.1123833677158053, 1.0424068327135558, 1.051994960100798, 1.1398472478272321, 1.75, 1.2506303580433686, 1.1666666666666667, 1.0148148148148148, 1.3333333333333333, 1.1907556859867938, 1.0338573155985489, 1.1294232997593368, 1.0841423948220066, 1.221774193548387, 3.0, 1.275658914728682, 1.0036305923037527, 1.0795574389752833, 2.0, 1.1216216216216217, 1.2789389067524115, 1.3529411764705883, 1.11062660944206, 1.1247077305275464, 1.125, 1.0115774240231548, 1.0377634660421546, 1.0882985024113716, 1.1833333333333333, 1.1226924929102682, 1.0976353928299007, 1.8571428571428572, 1.0529770276605719, 1.0742314747065722, 1.11864406779661, 1.0158124318429662, 1.0, 1.5, 1.119558154645874, 1.037593984962406, 1.0646442759118815, 1.1056740833952983, 1.0738119312436805, 1.0, 1.1875, 1.096774193548387, 1.0422010200374103, 1.0869565217391304, 1.0, 1.047207835948629, 1.0, 1.0, 1.0360325455249904, 3.0, 1.0126623376623376, 1.0240963855421688, 1.0384615384615385, 1.0, 1.0750823562358593, 1.1150519031141868, 1.4, 1.1043725760040035, 1.0454545454545454, 1.0909090909090908, 1.0258855585831064, 1.3382611756423795, 1.0354740670619302, 1.0, 1.0714285714285714, 1.2272727272727273, 1.073241713823767, 1.0395569620253164, 1.5, 1.0995043143014502, 1.0248042454314812, 1.0129870129870129, 2.0, 1.0262284196547145, 1.0213615352290237, 1.0141798734115106, 1.0396300223010273, 1.027102831550285, 1.0200818007499977, 1.0177304964539007, 1.173100616016427, 2.0, 1.0395678827110215, 1.1205673758865249, 1.0506912442396312, 1.080581980973699, 1.0600522193211488, 1.0026999062871238, 1.0028544243577546, 1.0230729939823462, 1.2800306044376435, 1.1157679209410192, 1.1562094331458244, 1.1596955328175693, 1.048819255222525, 1.0227272727272727, 1.0105263157894737, 1.0803929417894609, 1.0974025974025974, 1.004934780869055, 1.0585926090938342, 1.6666666666666667, 1.015625, 1.3920454545454546, 3.5, 1.5918367346938775, 1.0095513309630881, 1.0719424460431655, 1.0693916349809887, 1.0, 1.0602409638554218, 1.0061475409836065, 1.1510780365971762, 1.045726017170586, 1.0066786539943489, 1.1266272189349111, 1.0, 1.01888718734048, 1.053492423191355, 1.5738636363636365, 1.0430256442176025, 1.0175054704595186, 1.0679611650485437, 1.0296470876490886, 1.1443089430894309, 1.037242015450248, 2.0, 1.071245186136072, 1.0372881355932204, 1.0561910125451508, 1.087527352297593, 1.0849802371541502, 1.1176470588235294, 1.1194581280788178, 1.1356049991593342, 2.0, 1.180327868852459, 1.4285714285714286, 1.3333333333333333, 1.1926605504587156, 1.025974025974026, 1.0090322580645161, 1.1687763713080168, 1.0688134687332977, 1.087719298245614, 1.0616396914233852, 1.1808911656678909, 1.0804494808012302, 1.0808881420074496, 1.0096654130840397, 1.108991825613079, 1.0635266753888646, 1.055119496855346, 1.0180840664711632, 1.0117521367521367, 1.1031553398058251, 1.2733812949640289, 1.036037491919845, 1.1751740139211138, 1.1007842055485497, 1.2666666666666666, 1.204550956184943, 1.0964083175803403, 2.0, 1.028301886792453, 1.375, 2.0, 1.1404109589041096, 1.048711386599673, 1.0329711502435368, 1.04221635883905, 1.0425531914893618, 1.1130119863245092, 1.0743415727538759, 1.07871198568873, 1.2, 1.2222222222222223, 1.1059602649006623, 1.0909090909090908, 1.0808323329331733, 1.0829417293233083, 2.0, 1.0926680244399185, 1.0620985010706638, 1.0301003344481605, 1.098550724637681, 1.0283039721669598, 1.0477455996555893, 1.0080453488888947, 1.3061224489795917, 1.5, 1.1306371534960695, 1.0, 1.004566210045662, 1.1581196581196582, 1.342756183745583, 1.1691542288557213, 1.5, 1.0332585949177877, 1.171641791044776, 1.1916010498687664, 1.0889489564998742, 1.2251481237656352, 1.1630073186959415, 1.056392467789891, 1.0161145926589077, 1.0614583333333334, 1.2, 1.0089392825355057, 1.0328329586033593, 1.2222222222222223, 1.0209035738368173, 1.2291190783593207, 1.0375747224594363, 1.0036387276191163, 1.4444444444444444, 1.021505376344086, 1.0645002461841457, 1.1255813953488372, 1.206060606060606, 1.0506217085374296, 1.0148148148148148, 1.75, 1.092573402417962, 1.0122783083219646, 1.0988025224969886, 1.1586073500967118, 1.000754923834436, 1.0116136619787328, 1.034848484848485, 1.101409419044345, 1.200557103064067, 1.0566241720396443, 1.0667718191377498, 1.0776846915460776, 1.0536851683348498, 1.0651017980829778, 1.2784810126582278, 1.0037569421757595, 1.2, 1.3333333333333333, 1.1191969887076536, 1.6001154068090018, 1.0563293098112039, 1.1553133514986376, 1.0, 1.0323624595469256, 1.0307362401715512, 1.0760233918128654, 1.0657230634189159, 2.0, 1.1409806682883115, 2.0, 1.104950495049505, 1.1333333333333333, 1.029183275626291, 1.3548387096774193, 1.1319444444444444, 1.024669603524229, 1.0, 1.2946058091286308, 1.329919531821507, 1.5, 2.3333333333333335, 1.1258741258741258, 1.2103746397694524, 1.0160804020100502, 1.2182581322140609, 1.09, 1.0659217877094973, 1.0552763819095476, 1.0483870967741935, 1.1433962264150943, 1.2131147540983607, 1.2142857142857142, 1.0, 1.199182839632278, 1.1148325358851674, 1.0961871750433276, 1.085759611795446, 1.060371628577311, 1.0724173477652603, 1.0862758428876047, 1.1728953639188007, 1.1559953434225845, 1.0344473007712083, 1.875, 1.5, 1.2121212121212122, 1.0319080320218539, 1.073475385745775, 1.1243093922651934, 1.0, 1.0802919708029197, 1.0544312712759714, 1.0266813723189563, 1.0689655172413792, 1.1428571428571428, 1.5416666666666667, 1.06164345863834, 1.0564690406840176, 1.0460165388109999, 1.0444444444444445, 1.0706206053194742, 1.0502051328122661, 1.127944053358801, 1.062362435803375, 1.0952026921270934, 1.0097402597402598, 1.0463733650416172, 1.1399317406143346, 1.0278384147812243, 2.5, 1.028328611898017, 1.0, 1.0721649484536082, 1.0332889849769944, 1.0819672131147542, 1.0605768847691266, 1.0304709141274238, 1.1777777777777778, 1.0175400828310166, 1.050922998163038, 1.086283185840708, 1.0670926517571886, 1.0076335877862594, 1.2053210438519608, 1.2075812274368232, 1.3125, 1.0, 1.1111111111111112, 1.0713173592154484, 1.4285714285714286, 1.0930630913411954, 1.0938568087785574, 1.0007362414872079, 1.0760742350777461, 1.1544924219164316, 1.1695021489971347, 1.0518292682926829, 1.0264976958525345, 1.0008816268954979, 1.1167488933523138, 1.0446494803257236, 1.2064514505699118, 2.0, 1.0710227272727273, 1.0707070707070707, 1.1110774425349552, 1.0298913043478262, 1.3017832647462277, 1.0775316455696202, 2.1792114695340503, 1.039469443724763, 1.0559284116331096, 1.0258483193109773, 1.2222222222222223, 1.0640034933298008, 1.0279892354549225, 1.352156514006225, 1.0519888346127007, 1.2666666666666666, 1.2219081272084806, 1.098115193264447, 1.016984310178109, 1.2954545454545454, 1.0212737290024816, 1.0857142857142856, 1.0657373337107274, 1.0951776649746192, 1.0176544766708702, 1.0614324243332334, 1.0228937728937728, 1.0478048780487805, 1.076651538073626, 1.0038274538187997, 1.055977229601518, 1.0577183022438497, 1.120789062797517, 1.0666666666666667, 1.0873299928418039, 1.0216513168524801, 1.0530662305805396, 1.2411575562700965, 1.029681597409606, 1.088088088088088, 1.1365902293120638, 1.0470588235294118, 1.041712420615844, 1.0454545454545454, 1.1005229517722255, 1.2351484159642043, 1.0424935289042279, 1.0390879478827362, 1.0371994206278135, 1.0536448193813541, 1.0970744680851063, 1.0691699604743083, 1.0892201872603708, 1.0731523985933265, 1.1643835616438356, 1.0861244019138756, 1.03125, 1.0695203586562674, 1.1224489795918366, 2.5, 1.0501613880274496, 1.182269899396926, 1.021225277375784, 1.0277777777777777, 1.2130707251566697, 1.0083223187863335, 1.1927083333333333, 1.094601287766221, 1.1935483870967742, 1.067590027700831, 1.0670391061452513, 1.130890052356021, 1.40625, 1.0396052545585255, 1.197838736492103, 1.0171428571428571, 1.0425531914893618, 1.0259067357512954, 1.057171514543631, 1.1237113402061856, 1.004201680672269, 1.0488559059987632, 1.008130081300813, 1.0600838379133675, 1.2307692307692308, 1.0190124918095158, 1.17740232312566, 1.0171663727219282, 1.2372881355932204, 1.0, 1.2176470588235293, 1.0370981161228978, 1.089047233624328, 1.2077727952167414, 1.2575757575757576, 1.0588235294117647, 1.1388888888888888, 1.0813953488372092, 1.1282051282051282, 1.0414012738853504, 1.0274683647690692, 1.0354416508274569, 1.3716814159292035, 1.0623677501411615, 1.0489847228138756, 3.5, 1.0709884980129107, 1.1834621658038438, 1.5, 2.5, 1.231680236861584, 1.1387752646775746, 1.0891354081236242, 1.1766233766233767, 1.0, 1.1286764705882353, 1.0496083550913837, 1.8571428571428572, 1.0693506193332842, 1.0936469553748076, 1.0464989614273439, 1.0157272535359931, 1.7142857142857142, 1.0315252705272404, 1.0433937823834196, 1.068936170212766, 1.015075376884422, 1.0223529411764707, 1.0, 1.07168458781362, 1.1156895419885875, 1.0416148767534585, 1.378787878787879, 1.0855263157894737, 1.109291703245671, 1.1000788022064618, 1.120274914089347, 1.2769230769230768, 1.015961190256568, 1.363800779076238, 1.0320269781088651, 1.0740740740740742, 1.1328125, 1.1367924528301887, 1.5, 1.0848651960784315, 1.0128205128205128, 1.0076946608576376, 1.0135623869801085, 1.5, 1.224390243902439, 1.0026627935124668, 1.143169398907104, 1.1433503205655104, 1.0, 1.0397982062780269, 1.1313134913562646, 1.0731707317073171, 1.0740740740740742, 1.1242997429644763, 1.098435770488146, 1.1772885283893395, 1.2287769784172662, 2.3333333333333335, 1.0813953488372092, 1.0396973548335848, 1.0689655172413792, 1.0202870128665509, 1.1036911174577926, 1.0337146297411197, 1.6, 1.0719499478623566, 1.0213822427888903, 1.1781554324995227, 1.2024539877300613, 1.1174198359433258, 1.056, 1.212825278810409, 1.011307767944936, 1.0332171323783068, 1.1112084063047285, 1.0143266475644699, 1.0624303232998886, 1.0789473684210527, 1.158982381030792, 1.0113105248061012, 1.073051459524526, 1.0740941049215793, 1.1170655567117587, 1.0383165829145728, 1.0638297872340425, 1.188034188034188, 2.3333333333333335, 2.0, 1.1, 1.0338983050847457, 1.043189368770764, 1.0026439391582942, 1.002376179603446, 1.0488188976377952, 1.054880166724557, 1.2081447963800904, 1.0362257792754843, 1.060435448603267, 1.3333333333333333, 1.3333333333333333, 1.114570737605804, 1.125, 1.118665018541409, 1.1463822668339607, 1.1318747642399094, 1.0963212923247887, 2.5, 1.128118503118503, 1.1091617933723197, 1.106764745015301, 1.0413899235519077, 1.1577287066246056, 1.1482658959537573, 1.1554564365898912, 1.1006711409395973, 1.0283400809716599, 1.0120481927710843, 1.100113765642776, 1.3333333333333333, 2.0, 1.0428690245749088, 6.0, 1.2, 1.55, 1.001002004008016, 1.0366035182679296, 1.1065848214285714, 1.0114942528735633, 1.0, 1.2742138364779874, 1.0014360938247966, 1.032033426183844, 1.2736418511066399]
origin-bjaq_15.71 	max: 6.0000	99th: 3.0000	95th: 1.7500	median: 1.0850	mean: 1.1840

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.179159 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.229198