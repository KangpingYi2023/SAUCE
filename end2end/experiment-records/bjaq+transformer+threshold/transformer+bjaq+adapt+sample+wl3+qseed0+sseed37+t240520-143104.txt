Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 37, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.7511	95th: 1.6952	median: 1.0849	mean: 1.1771
ReportEsts: [1.0787671232876712, 1.003125, 1.0302938240527755, 1.0993657505285412, 1.5789473684210527, 1.0, 1.0698185816382628, 1.0695947044700165, 1.0, 1.0304232804232805, 1.1115343548899086, 1.0428825205598038, 1.0470536499560246, 1.1023255813953488, 1.0589897562698694, 1.0, 1.288888888888889, 1.0233793836344314, 3.0, 2.0, 1.2272727272727273, 1.0775201003857415, 1.0363855837213312, 1.1015854374633, 1.0809077454366058, 1.0, 1.1908320321213473, 1.5, 1.4, 1.0287769784172662, 1.0, 1.0355560420315237, 1.00599749028099, 1.2025527192008878, 1.0188538081699836, 1.2424089494490707, 1.1524064171122994, 1.0157506338729887, 1.2389971761140575, 1.0, 1.1403508771929824, 1.0426829268292683, 1.0, 1.058183747457777, 1.1173733195449844, 1.8615384615384616, 1.0, 1.0706713780918728, 1.038650132140679, 1.1203703703703705, 1.0927541954590325, 1.140893470790378, 1.037027117969002, 2.0, 1.3454545454545455, 1.1673487284419761, 1.0576923076923077, 1.3725490196078431, 1.038709677419355, 1.25, 1.103348782260996, 1.0990037359900373, 1.1272727272727272, 1.0, 1.0, 1.0494750989865234, 1.2809553739786297, 1.75, 1.0, 1.16416519064044, 1.0294840294840295, 1.0670945157526255, 1.0160183066361557, 1.1148079394545194, 1.0752941176470587, 1.0953346855983772, 1.0, 1.1077244258872652, 2.6666666666666665, 1.009856810812362, 1.09375, 1.0491607633604503, 1.2208588957055215, 1.11651728553137, 1.1207065750736016, 1.0, 1.06674376023899, 1.0020727694307496, 1.0049019607843137, 1.75, 1.1549150797735461, 1.0618665851033169, 1.1495327102803738, 1.0308555399719495, 1.0176579925650557, 1.0623376623376624, 1.0150375939849625, 1.140077821011673, 1.0, 1.2437021418266563, 1.0673866090712743, 1.1166380789022299, 1.2165271517493024, 1.1724137931034482, 1.014093447254056, 1.1329970799044333, 1.172820488133635, 1.1384148653773227, 1.0511955855303494, 1.1666666666666667, 2.0, 1.072196261682243, 1.0447461572549, 1.04358812381554, 1.2857142857142858, 1.0586234858532968, 2.0, 1.1595711132134974, 1.1636971046770601, 1.0, 1.011111111111111, 1.1666666666666667, 1.1829573934837092, 1.021173865521547, 1.1175739690921798, 1.0980392156862746, 1.8, 1.1365894039735098, 1.0, 1.12, 1.0995082352700616, 1.3, 1.0367838541666667, 1.0253348992319142, 1.1092480778419704, 1.0026702269692924, 1.0339943342776203, 1.029228371005456, 1.039972432804962, 1.07739183424741, 1.012800910865322, 1.2, 1.0032722513089005, 1.1084445850725926, 2.0, 1.0191431175934367, 1.0194285714285714, 1.0899256254225829, 1.0951120522322217, 1.5, 1.2816662630176798, 1.0227272727272727, 1.0101010101010102, 1.1074561403508771, 1.1120129870129871, 1.0997977073499663, 1.116420735133217, 1.150490221507496, 1.1027253668763102, 1.0953947368421053, 1.2857142857142858, 1.3142857142857143, 1.0029455081001473, 1.2857142857142858, 1.0718066599801324, 1.0043497905514585, 1.1442687747035574, 1.3722320203801686, 1.112092391304348, 1.0914102462166388, 1.2968421052631578, 1.1870324189526185, 1.0727219908976469, 1.0829120323559152, 1.0258843830888698, 1.0845481049562682, 1.0305867665418227, 1.1315097317201472, 1.0064008807108595, 1.0, 1.0327868852459017, 1.0434398468561332, 1.0279106858054226, 1.1580976863753214, 1.236842105263158, 1.0937619831030516, 1.2759946184893332, 1.1038893578339068, 1.0943396226415094, 1.0886363636363636, 1.0317310081279651, 1.0, 1.2727272727272727, 1.013437714377951, 1.032825322391559, 1.024435223605348, 1.3461538461538463, 1.0540192926045016, 1.0455766967942164, 1.0710578497318526, 1.0626410835214446, 1.18077369031306, 1.3615819209039548, 1.0158730158730158, 1.1830985915492958, 1.0, 1.3793103448275863, 1.1283709194133418, 1.3344947735191637, 1.2298850574712643, 1.0123578843302026, 1.0031277926720286, 1.0037833840650743, 1.0686938186660748, 1.1424649402686058, 1.2571428571428571, 1.0532724505327244, 1.000973078170613, 1.0466138204377047, 1.0037967692944911, 1.0, 1.0778467908902691, 1.0830756504441337, 1.008101891266861, 1.1323262839879153, 1.0374993485172253, 1.271251142534545, 1.0357142857142858, 1.004183642546887, 1.0939917483238784, 1.0141003948110547, 1.170731707317073, 1.2073628850488354, 1.0340425531914894, 1.184251968503937, 2.0, 1.1837762237762237, 1.0463934792318, 1.1118143459915613, 1.0307692307692307, 1.0, 1.6666666666666667, 1.0812155959269094, 1.1272727272727272, 1.1884411574091724, 1.5, 1.0, 1.1111111111111112, 1.016783762685402, 1.0918367346938775, 1.011049723756906, 1.1360759493670887, 1.0778546712802768, 1.0037783375314862, 1.0859836240103753, 1.0350877192982457, 2.0, 1.0947607591553061, 1.01511457825451, 1.115586690017513, 1.0118664861663422, 1.1593204369460883, 1.0173194253099784, 1.0834658187599364, 1.0740101755188987, 1.0257177033492824, 1.0193189715079916, 1.0312816616008105, 1.0909090909090908, 1.0010702389398622, 1.0732265446224256, 1.1590909090909092, 1.3888888888888888, 1.0047497259773475, 1.0555555555555556, 1.0683760683760684, 1.068326492160689, 1.0748502994011977, 1.3759398496240602, 1.0343284840310227, 1.1119402985074627, 1.0239582523056943, 1.0644778682089544, 1.25, 1.022971989814478, 2.5, 1.0199830043715559, 1.0215982721382288, 1.0310773292066815, 1.0526315789473684, 1.6666666666666667, 1.434782608695652, 1.0597014925373134, 1.077909063519302, 1.0, 1.0351681957186545, 1.01131221719457, 1.0052083333333333, 1.018836252962223, 1.1385542168674698, 1.10062893081761, 1.0047110111095485, 1.1032523877895, 1.1265993872769868, 1.1111111111111112, 1.0, 1.1026252983293556, 1.3012820512820513, 1.1107266435986158, 1.1535383319292334, 1.005421184320267, 1.1601307189542485, 1.18, 1.0123456790123457, 1.0205371248025277, 1.2857142857142858, 1.0102416504085456, 1.0340909090909092, 1.1875, 1.1059955122591945, 1.1428571428571428, 1.2727272727272727, 1.0050721959549875, 2.0, 1.205761316872428, 1.0377906976744187, 1.0795734208367513, 1.0704453441295547, 1.0234986945169713, 1.123456790123457, 1.1061567391333758, 1.0982449307465738, 1.0265734265734265, 1.0126293239450654, 1.0316514749156678, 2.0, 1.0, 1.036735300166823, 1.25, 1.0697544642857142, 1.3529411764705883, 1.0, 1.4666666666666666, 1.3483935742971886, 1.0679245283018868, 1.2524271844660195, 1.067099567099567, 1.0, 1.1611185086551266, 1.082391060856579, 2.0, 1.3108993448481239, 1.0, 1.095574280725727, 1.141025641025641, 1.0145892125019966, 1.1428571428571428, 1.1363636363636365, 1.3698949824970827, 1.1203703703703705, 1.0176602732819786, 1.0262068015700472, 1.0713266761768903, 1.0, 1.0769230769230769, 1.5714285714285714, 1.5, 1.1428571428571428, 1.0688948306595365, 1.3333333333333333, 1.0715474209650582, 1.2625, 1.2294009532413321, 1.0884058350118149, 1.2852729145211124, 1.0037547820337223, 1.0081206496519721, 1.0476190476190477, 1.5, 1.1566265060240963, 1.0595744680851065, 1.0551537329885627, 1.0952380952380953, 1.6923076923076923, 1.0334075723830736, 1.0324129651860745, 1.0219792817391666, 1.0, 1.1464387464387464, 1.009028727770178, 1.095890410958904, 1.0907770515613653, 1.0031779661016949, 1.1923076923076923, 1.0254957507082152, 1.1603773584905661, 1.0562688347564038, 1.0565682612224223, 1.0372591784805525, 1.178082191780822, 1.0471698113207548, 1.1049382716049383, 1.0, 1.058637421070123, 1.0597052197280203, 1.0248450005636343, 1.055511984124155, 1.0702005730659025, 1.1493485859548778, 1.8333333333333333, 1.1906950028719128, 1.0, 1.2596071733561058, 1.25, 1.0331267820659618, 1.0043668122270741, 1.1226354256233877, 1.051383399209486, 1.2027027027027026, 3.0, 1.2686733556298773, 1.0103164487149634, 1.141024462019496, 2.0, 1.0793650793650793, 1.2581573896353166, 1.3282442748091603, 1.0842603454552808, 1.1434511434511434, 1.2352941176470589, 1.2044866264020708, 1.0205118420111146, 1.0922841708286617, 1.1085236529662545, 1.118311403508772, 1.1509121061359868, 1.143939393939394, 2.142857142857143, 1.0180878552971577, 1.5, 1.241320914479255, 1.121212121212121, 1.1026395015052861, 1.4705882352941178, 1.0882024337953318, 1.1084225540909793, 1.0851326341764342, 1.0, 1.1287128712871286, 1.16, 1.2870736715580708, 1.1641137855579868, 1.0, 1.003257328990228, 1.0549717458114405, 1.0762536261914628, 1.5, 2.0, 1.006645817044566, 1.0182481751824817, 1.0295081967213116, 1.1111111111111112, 1.071335812786558, 1.105427974947808, 1.4705882352941178, 1.1301694915254237, 1.0454545454545454, 1.143044619422572, 1.0459677419354838, 1.2751367269667648, 1.0778320856276682, 1.0, 1.0277777777777777, 1.07283800672405, 1.0333658255964462, 1.0045095645095645, 2.0, 1.077637690776377, 1.0129462482803455, 1.0225248821372446, 2.0, 1.0558213716108453, 1.0445152010621688, 1.0307085419511455, 1.013804552007339, 1.0046787355618851, 1.0286661928452974, 1.0240963855421688, 1.0771456123432979, 2.0, 1.0579874928936897, 1.6444444444444444, 1.25, 1.1865284974093264, 1.1538461538461537, 1.0146200780182042, 1.073905109489051, 1.0088403387044365, 1.020651675080312, 1.0480752235851392, 1.0627620722304882, 1.0541338696441163, 1.2117647058823529, 4.0, 1.0044220381706879, 1.1172064777327935, 1.0485869868585918, 1.025263521355061, 1.0938609842719431, 1.0855354659248957, 2.4022988505747125, 2.2857142857142856, 1.0061717875054779, 1.0122447160540595, 1.0242782152230971, 1.107116920842411, 1.0780707674508292, 1.043010752688172, 1.0763088724806262, 1.0318230852211434, 1.2170542635658914, 3.0, 1.0909090909090908, 1.053680981595092, 1.0803059273422562, 1.1078066914498141, 1.0809768637532133, 1.0470588235294118, 1.2208588957055215, 1.148905109489051, 1.1097560975609757, 1.083223823015251, 1.2555555555555555, 1.0169687264216314, 2.0, 1.1816638370118846, 1.0238095238095237, 1.3055555555555556, 1.074581005586592, 1.038293216630197, 1.030549898167006, 1.119325551232166, 1.0849833176600925, 1.0, 1.3404255319148937, 1.0, 1.0, 1.1477272727272727, 1.1633064516129032, 1.0046296296296295, 1.0825242718446602, 1.0727330983659085, 1.0765661252900232, 1.0825715292328804, 1.198180636777128, 1.0402476780185759, 1.1139105173921964, 1.1189189189189188, 1.0819462227912933, 1.0188679245283019, 1.0849005910800644, 1.1791907514450868, 1.0867780709469363, 1.0702376729336645, 1.360655052847057, 1.0793843757007802, 2.0, 1.032994923857868, 1.0841683366733468, 1.4074074074074074, 1.0, 1.1333333333333333, 1.3636363636363635, 1.1697722567287785, 1.2222222222222223, 1.1666666666666667, 1.0011116750042293, 1.1149197543094909, 1.0249941798804936, 1.014005816623297, 1.2108108108108109, 1.1017402945113788, 1.0, 1.1755725190839694, 1.005310711083523, 1.0877095120461127, 1.0841735052754982, 1.0729581956942704, 1.0257868094783948, 1.1246753246753247, 1.0669514254494885, 1.0728241563055063, 1.0063681413547996, 1.055761591897438, 1.303030303030303, 1.0864864864864865, 1.0, 1.2352941176470589, 1.2080157768236817, 3.0, 1.0768386388583973, 1.0748165009755644, 1.4285714285714286, 1.010961797589133, 1.1, 1.1176470588235294, 1.0605776091936756, 1.6923076923076923, 1.0124179688916284, 1.0495514737291756, 1.3571428571428572, 1.2083333333333333, 1.0804123711340206, 1.011477761836442, 1.0141280353200883, 1.1088989845002672, 1.1544859101294744, 1.0, 1.096404518792092, 1.1189024390243902, 2.0, 1.0058122102543996, 1.131663638723073, 1.1598864711447492, 1.0198000573084147, 1.0811376214813442, 1.118811881188119, 2.857142857142857, 1.0660989456609895, 1.0346774193548387, 1.125226952641135, 1.192521877486078, 1.0017377950210151, 1.0399141810278771, 1.195970695970696, 1.1043549712407559, 1.2173913043478262, 1.1016603232390094, 1.098422712933754, 1.0728862973760933, 1.034138655462185, 1.0416175893207695, 3.0, 1.1355760643048527, 1.0018922229636196, 1.0387981839612346, 1.3571428571428572, 1.3510623524510486, 1.1061224489795918, 1.1428571428571428, 1.0780842209212105, 1.0420575865415722, 1.1561135371179039, 1.0, 1.3333333333333333, 1.0986322553523706, 1.5, 1.105140186915888, 1.0833333333333333, 1.0551601423487544, 1.3846153846153846, 1.139240506329114, 1.0356394129979036, 1.0, 1.6349206349206349, 1.2553366174055829, 1.25, 2.0, 1.1271186440677967, 1.210344827586207, 1.0421313506815366, 1.1957340025094103, 1.1015490533562822, 1.2300884955752212, 1.1014466214978942, 1.051948051948052, 1.1893203883495145, 1.1387755102040817, 1.0384615384615385, 1.0, 1.2892347600518808, 1.1096681096681096, 1.0268595041322315, 1.0354001287277408, 1.0641010513764773, 1.0923876214140502, 1.0827527939999406, 1.1111552920763448, 1.1260162601626016, 1.0017899761336515, 1.5714285714285714, 1.0, 1.2592592592592593, 1.0228959550732337, 1.1015004413062666, 1.107843137254902, 1.163323782234957, 1.0371134020618558, 1.0461715021483253, 1.0131231893457864, 1.1142857142857143, 1.2222222222222223, 1.0297256097560976, 1.0664766702014847, 1.0552719165024074, 1.0547601455437676, 1.0066225165562914, 1.1072799763733019, 1.0157299707314114, 1.194189602446483, 1.3604887983706722, 1.125, 1.0998013902681232, 1.5283993115318417, 1.1063829787234043, 1.063768115942029, 1.0701001430615165, 1.0, 1.086848635235732, 1.0168515703334735, 1.1020408163265305, 1.0889435515328094, 1.0042372881355932, 1.2285714285714286, 1.0023625195362191, 1.0494592645998557, 1.112812248186946, 1.0009551098376313, 1.0045402951191829, 1.2109878860262753, 1.1965811965811965, 1.1428571428571428, 1.0, 1.4285714285714286, 1.0677485769649995, 1.3333333333333333, 1.1913537258263245, 1.0864789187442787, 1.0231187669990933, 1.0764647467725919, 1.0561940675971415, 1.0053879310344827, 1.007168458781362, 1.0126404494382022, 1.0152957475285886, 1.1893044619422573, 1.0430645693543064, 1.3227749006383236, 1.6666666666666667, 1.103448275862069, 1.0395256916996047, 1.0974037228326805, 1.013029315960912, 1.2668269230769231, 1.0424354243542435, 2.269911504424779, 1.0394614952391077, 1.0550335570469798, 1.0549162679425836, 1.1875, 1.0366177958722613, 1.0354955796582859, 1.303699897225077, 1.0581052631578947, 1.1875, 1.1132300357568534, 1.1893491124260356, 1.625, 1.065542532537571, 1.5769230769230769, 1.0853391684901532, 1.104368932038835, 1.0363382250174702, 1.0335073244653983, 1.0253317249698433, 2.75, 1.0666666666666667, 1.1015478510239347, 1.061592310683927, 1.016996743847241, 1.0719909027291812, 1.0614604673773396, 1.0769230769230769, 1.0810580204778157, 1.0485456780008193, 1.0200901825974373, 1.035070140280561, 1.0069444444444444, 1.0703336339044185, 1.0163664044658716, 1.3853118712273642, 1.0138864319830179, 1.0, 1.3333333333333333, 1.0605354891344656, 1.0168847615027439, 1.231016548463357, 1.1025854879065888, 1.074221867517957, 1.171875, 1.1011227094853673, 1.0748978665456197, 1.1047794117647058, 1.0164835164835164, 1.017094017094017, 1.115029696166495, 1.119047619047619, 1.75, 1.0446837466516892, 1.1608537722202579, 1.0293427230046948, 1.0056818181818181, 1.2338884866039102, 1.0320342157573321, 1.1627776215912287, 1.408450704225352, 1.1923076923076923, 1.0377358490566038, 1.1613691931540342, 1.14375, 1.4827586206896552, 1.0242596938205386, 1.182358771060456, 1.1633499170812605, 1.0, 1.0302203497508944, 1.0338071456012294, 1.0650937081659972, 1.2735195088136264, 1.3333333333333333, 1.0769230769230769, 2.0, 1.1549982584465344, 1.3846153846153846, 1.0, 1.1538461538461537, 1.062251655629139, 1.0090579710144927, 1.0386410371032633, 1.0469862442684452, 1.18, 1.3877551020408163, 1.1428571428571428, 1.032258064516129, 1.0945945945945945, 1.0144927536231885, 1.1145833333333333, 1.027204635864463, 1.0322103075952656, 1.3195876288659794, 1.0737708841974245, 1.0471998398478555, 2.5, 1.0713058419243986, 1.2152777777777777, 3.0, 2.0, 1.200887573964497, 1.1506849315068493, 1.0828722869191783, 1.2298136645962734, 1.5, 1.2964824120603016, 1.3588957055214723, 3.0, 2.0, 1.0663867751246392, 1.2247613926603038, 1.0048970366649925, 1.6666666666666667, 1.0143168775380071, 1.04570100697134, 1.0472610096670247, 1.0, 1.0375586854460095, 1.0228040801873008, 1.394736842105263, 1.1612659185474719, 1.0624309070809332, 1.3980263157894737, 1.10546875, 1.125703564727955, 1.094392523364486, 1.0909090909090908, 1.1896551724137931, 1.02462411719833, 1.3279194412863407, 1.0420790078407371, 1.401197604790419, 1.1176470588235294, 1.3134328358208955, 1.1031636863823935, 1.0566978193146417, 1.0140487251895263, 1.088361755125503, 1.0578602620087336, 1.5, 1.6666666666666667, 1.1088985488716998, 1.1477572559366755, 1.1820657459638202, 1.010530062223095, 1.0739254055862184, 1.0835977092002802, 1.2894736842105263, 1.0434782608695652, 1.1153997327254146, 1.0789587228534445, 1.2924600152322925, 1.132936507936508, 1.6666666666666667, 1.056338028169014, 1.0632264607223652, 1.1573561946902655, 1.0395180644742816, 1.0807854686595622, 1.0518465909090908, 2.0, 1.0946291560102301, 1.044207738369415, 1.1585560886451907, 1.1863117870722433, 1.089537738997759, 1.0636942675159236, 1.2902869757174393, 1.011014492753623, 1.0323596761492093, 1.0712181160030305, 1.0472350230414746, 1.0669398907103824, 1.0, 1.1952614379084967, 1.0607916628576652, 1.0026420079260239, 1.0524554973224174, 1.118232731798382, 1.037821482602118, 1.2, 1.2107969151670952, 1.6666666666666667, 2.0, 1.1176470588235294, 1.0208877284595301, 1.0063191153238547, 1.0329101300295347, 1.002667375679709, 1.0778833107191317, 1.0472803347280335, 1.1630434782608696, 1.1136363636363635, 1.0488295909706293, 1.6, 1.4166666666666667, 1.1057173678532901, 1.1428571428571428, 1.0026702269692924, 1.117936117936118, 1.0057683641279855, 1.0909740143805489, 2.0, 1.0343653250773994, 1.2015503875968991, 1.0311133967600925, 1.0392441993816344, 1.1944444444444444, 1.1065068493150685, 1.1503808243727598, 1.0459200900393921, 1.0779014308426074, 1.2033898305084745, 1.0614525139664805, 1.0, 1.0, 1.0417724687958227, 5.0, 1.4285714285714286, 1.8620689655172413, 1.0361881785283473, 1.0930232558139534, 1.0776053215077606, 1.1161239701843861, 1.0, 1.047796399751707, 1.0134345794392523, 1.2458100558659218, 1.2548076923076923, 1.4285714285714286, 1.0318166267533355, 1.192350332594235, 1.1393805309734513, 1.0145035329118632, 1.0243933935524887, 1.0200182815356489, 1.1511387163561078, 1.0, 1.231839912002369, 1.050599392057021, 1.0629035150645625, 1.1774193548387097, 1.1208726097495287]
origin-bjaq_15.71 	max: 5.0000	99th: 2.7511	95th: 1.6952	median: 1.0849	mean: 1.1771

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 13.944443 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[3.5762787e-07 5.9604645e-07 3.5762787e-07 1.4305115e-06 1.7881393e-07]
Distance score: 5.841255301675119e-07
SAUCE Drift detection: False
Detection latency: 0.0232s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.063119 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 6.0000	99th: 3.0000	95th: 1.7161	median: 1.0784	mean: 1.1789
ReportEsts: [1.0517711171662125, 1.0055029716046666, 1.0352111827438695, 1.0964912280701755, 1.565217391304348, 1.0, 1.0789339276593768, 1.0804739401410863, 1.1666666666666667, 1.0404814004376368, 1.1258416197436205, 1.0423810651065444, 1.0285404624277457, 1.1453488372093024, 1.076151121605667, 1.2790697674418605, 1.13312693498452, 1.608695652173913, 1.25, 1.0163398692810457, 1.1418181818181818, 1.0414273376561065, 1.1531413612565444, 1.0649466192170818, 1.0342640048743772, 1.020577003452402, 2.0, 1.1426487226820699, 2.25, 1.6, 1.0298013245033113, 1.0, 1.044524810889244, 1.0061670643902014, 1.0216572504708097, 1.0158413371585382, 1.2174286696459264, 1.0606060606060606, 3.0, 1.0382581734628906, 1.0245591358138677, 1.0206515463917525, 1.1042183622828785, 1.0268314210061782, 1.011049723756906, 1.177695804456368, 1.0, 1.0011454753722795, 1.2899159663865547, 1.0211459754433834, 1.0526315789473684, 1.1548117154811715, 1.0362903225806452, 1.088235294117647, 1.0178104356500688, 1.025360181986688, 1.0134048257372654, 1.1189873417721519, 1.1111111111111112, 1.0511299280207533, 1.2535211267605635, 1.123004109249656, 1.0648567119155354, 1.1355311355311355, 1.03, 1.2727272727272727, 1.0911785106248817, 1.3037195611453036, 1.6, 1.0, 1.0410502672140036, 1.0161127895266868, 1.06702025072324, 1.0154142581888246, 1.0924297829300553, 1.2198391420911527, 1.0560739588733368, 1.301775147928994, 1.5339805825242718, 1.0994949910048126, 1.0840579710144929, 1.0114503816793894, 2.0, 1.1764705882352942, 1.0574971815107101, 1.2096774193548387, 1.1590909090909092, 1.1714285714285715, 1.3333333333333333, 1.095335659634408, 1.1125489015949444, 1.1552651806302845, 1.0497207848762744, 1.0705134199943889, 1.1376623376623376, 1.004739336492891, 1.183673469387755, 1.0806675938803894, 2.25, 1.3267248215701823, 1.28, 2.0, 1.0390974236478416, 1.3450192389910218, 1.047008547008547, 1.2442557258924305, 1.3333333333333333, 1.013863438844853, 1.1121537086684539, 1.0449241122565864, 1.1145471757652257, 1.0497180932854946, 1.1428571428571428, 1.5, 1.0394813237855622, 1.0779118126881275, 1.0572337042925277, 1.021505376344086, 1.0573357496019442, 2.0, 1.0332640332640333, 1.1377079482439927, 1.0, 1.1386138613861385, 1.1428571428571428, 1.226890756302521, 1.0250670940259068, 1.0785279253595956, 1.0, 2.5, 1.1210235131396957, 1.0, 1.0, 1.1190194112822383, 1.0769230769230769, 1.0532859680284192, 1.0162020385351764, 1.0908054575896833, 2.0, 1.5, 1.0145228215767634, 1.0642857142857143, 1.0829068577277379, 1.0293327377919839, 1.26, 1.001086956521739, 1.089666146392881, 3.0, 1.007527286413248, 1.0179076343072573, 1.080518018018018, 1.1364844903988183, 1.5, 1.084561049445005, 1.0185185185185186, 1.0169779286926994, 1.1428571428571428, 1.0, 1.0785791173304629, 1.1022216736608246, 1.1683794466403161, 1.1065292096219932, 1.0826446280991735, 1.3214285714285714, 1.5130434782608695, 1.0148148148148148, 1.2222222222222223, 1.0526907725279695, 1.017094017094017, 1.1834733893557423, 1.023380622578653, 1.0383795309168444, 1.0109198516233902, 1.2982456140350878, 1.0438756855575868, 1.0641378194758977, 1.2109067017082786, 1.0313199105145414, 1.08099173553719, 1.0416885159937075, 1.128761716822891, 1.2062724935732647, 1.1595092024539877, 1.1372549019607843, 1.0030071645348595, 1.0383326972819404, 1.288808664259928, 1.1368732667540025, 1.0442260442260443, 2.0, 1.2106741573033708, 1.0792118099945007, 1.2173913043478262, 1.1323971915747242, 1.0035262645914398, 1.078912032670092, 1.087527951444348, 1.0590513068731848, 1.0721412485925184, 1.006817629955234, 1.0066417600664177, 1.0182938176945695, 1.0210750651195832, 1.0752685578283803, 1.0615890926187117, 1.0037805521364516, 1.5339366515837105, 1.0416666666666667, 1.3076923076923077, 1.0, 1.4420289855072463, 1.1101483523696993, 1.2889518413597734, 1.209090909090909, 1.0305823209049016, 1.2222222222222223, 1.0354767104906286, 1.083720930232558, 1.224993017595659, 1.0, 1.0, 1.0223982518437584, 1.0439953575744523, 1.0032879062231965, 2.5, 1.035897435897436, 1.1136716769434585, 1.0787144853283652, 1.1002785515320335, 1.0760135135135136, 1.0260567458019687, 1.1076145552560648, 1.434782608695652, 1.0012758523370022, 1.0164719470481098, 1.0205882352941176, 1.0317052270779776, 1.0419977298524403, 1.0, 1.100262123197903, 2.0, 1.2385724761671963, 1.052074592074592, 1.071735731039875, 1.0921501706484642, 1.0769230769230769, 1.5, 1.1313760770029695, 1.106060606060606, 1.126039031441995, 1.2, 1.0341880341880343, 1.0677248677248676, 1.0, 1.0020817398298336, 1.0386363636363636, 1.0738434163701067, 1.1140065146579805, 1.0034928396786587, 1.101266842885694, 1.046875, 1.0, 1.058502166429758, 1.0784898161947343, 1.1403762662807526, 1.0190218352974485, 1.0772518455877311, 1.0423976399834685, 1.0764206401045069, 1.0964899440850142, 1.0331658291457286, 1.0213247557779366, 1.0060556296828491, 1.0, 1.0298039451407046, 1.2428256070640176, 1.105263157894737, 1.380952380952381, 1.8082706766917294, 1.1359649122807018, 1.027208365293905, 1.0250297973778308, 1.0, 1.3646055437100213, 1.0273376701121444, 1.041328413284133, 1.115026974272779, 1.0425180503333256, 1.1, 1.0, 1.117504542701393, 1.0418833259889495, 1.1864538278022383, 1.0647004158986, 1.2004253056884635, 1.190556492411467, 1.0615714285714286, 1.030931339225017, 1.1123932318471568, 1.0604565599130362, 1.0307262569832403, 1.3703703703703705, 1.2307692307692308, 1.0763826606875935, 1.1111111111111112, 1.0383211678832116, 1.1390172933261793, 1.048189993082776, 1.5, 1.0420168067226891, 1.0036563071297988, 1.021968517557516, 1.095910623946037, 1.173913043478261, 1.1383647798742138, 1.0107619044467315, 1.3473193473193472, 2.8, 1.7692307692307692, 1.0199656504937742, 1.5714285714285714, 1.0052907848691885, 1.0348101265822784, 1.0416666666666667, 1.103366124454273, 1.24, 1.5833333333333333, 1.0062637172942714, 2.0, 1.0246305418719213, 1.014475271411339, 1.066243833685694, 1.003883495145631, 1.1967213114754098, 1.0761904761904761, 1.0933127895991723, 1.0823774976695173, 1.0498338870431894, 1.0067047566600125, 1.0852312156961705, 3.0, 1.0, 1.0416309176533394, 1.2, 1.0651162790697675, 1.12, 2.0, 1.3157894736842106, 1.345, 1.054095826893354, 1.1818181818181819, 1.0712589073634204, 1.3205128205128205, 1.8333333333333333, 1.00875613239769, 1.2727272727272727, 1.2615384615384615, 1.0122296181273305, 1.0461538461538462, 1.0220102714600148, 1.0446096654275092, 1.4, 1.0, 1.3505747126436782, 1.1456953642384107, 1.0968443960826986, 1.123916219018, 1.2349397590361446, 1.0327455919395465, 1.0, 1.0318932526228481, 1.4, 1.0277777777777777, 3.0, 1.0744612882616018, 1.0, 1.0782608695652174, 1.1333333333333333, 1.2582769099536173, 1.1189756848618657, 1.2391304347826086, 1.0366992518158484, 1.1024136551540205, 1.2125984251968505, 1.096774193548387, 1.044442761962447, 1.0870307167235496, 1.1470588235294117, 1.0022198976669774, 1.0647847779485136, 1.005045776113192, 1.0555555555555556, 1.024390243902439, 1.1305220883534137, 3.0, 1.0208333333333333, 1.627906976744186, 1.1337209302325582, 1.1823529411764706, 1.044041450777202, 1.037348763808522, 1.0875241779497098, 1.0018934214124924, 1.0955993930197268, 1.1880592636056917, 1.058252427184466, 1.1229508196721312, 1.1409921671018277, 2.0, 1.0354551793336848, 1.5769230769230769, 1.1042890495556559, 1.0722391310689525, 1.0763299922898997, 1.129547238942685, 1.625, 1.2016441005802707, 1.1666666666666667, 1.0840380351035441, 1.0, 1.0933612938439, 1.0060975609756098, 1.110991668906208, 1.1802721088435375, 1.2493723849372385, 3.0, 1.2321163550014842, 1.0009187710235312, 1.0584621255485593, 4.0, 1.0694444444444444, 1.2862776025236593, 1.3904109589041096, 1.1021710052474534, 1.230184856925804, 1.0833333333333333, 1.1866096866096867, 1.0356545062213887, 1.0592406900418907, 1.0297647683220927, 1.0400560710564184, 1.1658500734933857, 1.1547619047619047, 1.0471521942110178, 1.0490170563741192, 1.1140350877192982, 1.226927252985885, 1.0, 1.5, 1.2098360655737705, 1.116, 1.0432793807178045, 1.0768271711092003, 1.0985043837029396, 1.0, 1.0583333333333333, 1.1724137931034482, 1.173116973273169, 1.2608695652173914, 2.0, 1.072562008935449, 1.0, 2.0, 1.0252197172334734, 1.5, 1.0472005208333333, 1.001510574018127, 1.0372340425531914, 1.2, 1.0766053991532776, 1.06318449873631, 1.6, 1.0319871673900736, 1.1311475409836065, 1.082236842105263, 1.0634178905206944, 1.3598872047937962, 1.0222309082913958, 1.0, 1.0120481927710843, 1.1697388632872503, 1.1073025335320417, 1.0656, 1.75, 1.0982126405011978, 1.013956426848413, 1.0134257254222607, 2.0, 1.0575828590559089, 1.017497078826737, 1.0073371160242615, 1.035199182093694, 1.0135485624857645, 1.0080622503787358, 1.00625, 1.0183565464485975, 2.3333333333333335, 1.1384036665513664, 1.0685324721923215, 1.0528494885533366, 1.087893864013267, 1.0205128205128204, 1.0157274737788642, 1.356401384083045, 1.0851432982880609, 1.0125047366426676, 1.0787206253100732, 1.2069536423841059, 1.0970139976629123, 1.0604939203987613, 1.0340909090909092, 1.0689655172413792, 1.0970281104152286, 1.1164835164835165, 1.0083676486115511, 1.0559496641138992, 1.0, 1.206439393939394, 1.372093023255814, 1.8333333333333333, 1.4285714285714286, 1.0142693194674093, 1.0734265734265733, 1.0649942987457242, 1.0, 1.0919540229885059, 1.0089041095890412, 1.1909472319814443, 1.026233718583746, 1.0326941337834987, 1.0944055944055944, 1.0361757105943152, 1.0219836400817996, 1.0030011916496255, 1.4065934065934067, 1.0268240260092958, 1.0673539518900343, 1.1398963730569949, 1.0249467825837917, 1.108433734939759, 1.0183257682475086, 2.0, 1.0090036014405763, 1.1407407407407408, 1.0614713276099226, 1.1172566371681416, 1.022514071294559, 1.080906148867314, 1.0575, 1.070483320255339, 2.0, 1.3508771929824561, 1.1666666666666667, 1.0, 1.2190476190476192, 1.4, 1.0475561426684281, 1.0191570881226053, 1.0574880509824747, 1.1309328968903436, 1.0454205663367522, 1.176045132359323, 1.1497537584240538, 1.0424748342744905, 1.015904604678661, 1.1060109289617486, 1.113099586072559, 1.0475470188575464, 1.0715328467153284, 1.0830601092896175, 1.1752988047808766, 1.0476190476190477, 1.0966115369100444, 1.20260663507109, 1.0963333333333334, 1.3465909090909092, 1.3091915303176132, 1.7563025210084033, 1.3333333333333333, 1.0296912114014252, 1.1333333333333333, 1.6666666666666667, 1.2408759124087592, 1.0465447823158027, 1.0302690582959642, 1.0076530612244898, 1.1151832460732984, 1.0955367269330842, 1.0001162892112685, 1.1431159420289856, 1.0, 2.0, 1.0708025042686398, 1.2121212121212122, 1.0442655935613683, 1.1373868647017868, 1.0, 1.4030808729139923, 1.2406181015452538, 1.1041827310269197, 1.0976331360946745, 1.0258109066477548, 1.3937263385613845, 1.0056463223132939, 1.4301075268817205, 1.3333333333333333, 1.1627021883920077, 1.0, 1.0568720379146919, 1.1452282157676348, 1.3586880669923238, 1.135202492211838, 1.625, 1.0127868420252086, 1.2205882352941178, 1.2729411764705882, 1.0547008547008547, 1.2140554480980013, 1.1154094132817538, 1.0240859802322233, 1.0081374321880652, 1.0690972222222221, 1.0, 1.083640581631385, 1.0808310055865922, 1.1904761904761905, 1.023728813559322, 1.2274553123117091, 1.0445632798573976, 1.0038276643990929, 1.2, 1.1229946524064172, 1.0316952602500726, 1.242562929061785, 1.23125, 1.044327881443209, 1.0147058823529411, 1.6, 1.102439024390244, 1.0019815059445178, 1.1153412454542893, 1.1746968207145199, 1.009493041508409, 1.0180542876470318, 1.1182634730538923, 1.1036020583190393, 1.1978609625668448, 1.070533312783697, 1.0369984366857739, 1.0487220447284344, 1.134640522875817, 1.0129972898969881, 1.3795620437956204, 1.051477752517051, 1.3, 1.3333333333333333, 1.1267252195734003, 1.6176041970271058, 1.0441903584672436, 1.095846645367412, 1.0, 1.0039525691699605, 1.027997128499641, 1.2208588957055215, 1.047624273769266, 2.3333333333333335, 1.1178665605253992, 1.5, 1.0894941634241244, 1.0, 1.0418023255813953, 1.4193548387096775, 1.1608391608391608, 1.0441306266548984, 1.0, 1.2508792935718027, 1.2417582417582418, 1.5, 2.5, 1.1418439716312057, 1.1388888888888888, 1.0610865609565896, 1.2044491525423728, 1.091937765205092, 1.5, 1.0269607843137254, 1.0836231164100016, 1.0541516245487366, 1.0640569395017794, 1.0344827586206897, 1.0, 1.2231404958677685, 1.084423305588585, 1.0034364261168385, 1.0271700776287933, 1.0524201605754895, 1.0786019706265104, 1.0781653866321212, 1.1923563045440866, 1.160092807424594, 1.0380010411244143, 1.4444444444444444, 1.0, 1.1470588235294117, 1.0312480256756928, 1.1057692307692308, 1.1432584269662922, 1.023454157782516, 1.0469018112488084, 1.0417643644805572, 1.0031356673235423, 1.0574712643678161, 1.3333333333333333, 1.1951219512195121, 1.017359936872957, 1.0523692448242044, 1.0165227229447413, 1.0344827586206897, 1.083220485042472, 1.0292187208651873, 1.0926913920201933, 1.0565055762081785, 1.109145258347484, 1.0970873786407767, 1.0682634730538922, 1.0914826498422714, 1.0422437333921115, 1.5, 1.024190241902419, 2.0, 1.0810276679841897, 1.015950601056984, 1.046875, 1.0728031532575932, 1.0267034990791897, 1.3095238095238095, 1.0013747927702075, 1.0440746435139128, 1.0226916181084715, 1.0262321144674087, 1.0104265402843602, 1.2090710165108414, 1.2130281690140845, 1.4285714285714286, 1.0, 1.2, 1.0733731873813468, 1.6666666666666667, 1.0744864933471538, 1.1135525404027986, 1.0168634064080944, 1.0734312416555407, 1.032821371553411, 1.0809519596567283, 1.0425531914893618, 1.0386869871043376, 1.0070055966498377, 1.119963280532823, 1.0398606891564461, 1.254874965581116, 1.375, 1.029739776951673, 1.0584192439862543, 1.0903361951839967, 1.0275482093663912, 1.2775510204081633, 1.0368098159509203, 2.2436363636363637, 1.057211977712293, 1.0640449438202246, 1.0669472340510406, 1.1578947368421053, 1.0555076736236937, 1.0257454972813775, 1.2616326530612245, 1.0582660582660584, 1.4827586206896552, 1.0007843137254901, 1.0521495654202881, 1.0704362460401267, 1.0, 1.0182528760401004, 1.025, 1.0546403279910548, 1.0125, 1.016602809706258, 1.0695443645083933, 1.0126239855725878, 1.047571853320119, 1.0726817042606516, 1.003004096851769, 1.0650095602294456, 1.040431967045813, 1.0870613189355958, 1.1538461538461537, 1.0892086330935251, 1.13720757519495, 1.1709001233045622, 1.0110220440881763, 1.0099947396107312, 1.1792260692464358, 1.0710479573712255, 1.041025641025641, 1.0548679105856271, 1.1111111111111112, 1.1115023474178405, 1.2267263069611407, 1.0421505376344087, 1.0557377049180328, 1.044521140541578, 1.1147804080120984, 1.0046052631578948, 1.0369649805447472, 1.1041572655743623, 1.0522804881276968, 1.1822429906542056, 1.0226244343891402, 1.0058513750731422, 1.0946766118320221, 1.088235294117647, 1.4, 1.0321051555010095, 1.168768801176296, 1.0063383715260847, 1.0689655172413792, 1.185701302635565, 1.0141153221822288, 1.1552723059096177, 1.099702380952381, 1.3793103448275863, 1.0182128628343767, 1.173913043478261, 1.144736842105263, 1.46875, 1.0605668784476423, 1.1621841890790545, 1.0625, 1.0888888888888888, 1.038655462184874, 1.2072480181200453, 1.0471698113207548, 1.6, 1.0387742338961852, 1.0612244897959184, 1.1243496357960459, 1.0769230769230769, 1.0298764127585958, 1.2244897959183674, 1.0051299988340912, 1.228813559322034, 1.3076923076923077, 1.176878612716763, 1.0523214234631117, 1.048504300223695, 1.3206106870229009, 1.21875, 1.0, 1.0263157894736843, 1.0795454545454546, 1.0235294117647058, 1.020096111839231, 1.0276458162814703, 1.0311895356959615, 1.3478260869565217, 1.0767036720751495, 1.0463844473714925, 2.5, 1.026302627777588, 1.1030572990483904, 3.0, 2.25, 1.194505764042188, 1.1004525425747291, 1.0520604424352775, 1.1979949874686717, 1.0, 1.0372881355932204, 1.2083333333333333, 1.0263157894736843, 1.0421838039891365, 1.0913171186999011, 1.0277099455049936, 1.029559278625547, 1.7142857142857142, 1.0216756406280834, 1.041343669250646, 1.108433734939759, 1.2348336594911937, 1.009433962264151, 1.0, 1.0754310344827587, 1.1684143963745586, 1.0480332463515996, 1.1, 1.1009771986970684, 1.099354235381835, 1.0393939393939393, 1.0909090909090908, 1.2424242424242424, 1.023418643291328, 1.606358570960341, 1.0850925071236506, 1.393103448275862, 1.0909090909090908, 1.019853709508882, 1.125, 1.0651910248635537, 1.0670103092783505, 1.008863281115171, 1.053297199638663, 1.5, 1.0063593004769475, 1.0486740516951998, 1.2024899304284145, 1.0712431028886724, 1.0035890533871692, 1.0375192496150076, 1.0792689187801623, 1.1971830985915493, 1.0862068965517242, 1.064054848188051, 1.1299174231933118, 1.2294188861985471, 1.2103746397694524, 2.0, 1.0348837209302326, 1.0083671318621659, 1.035114503816794, 1.0054592709652983, 1.0982320681194977, 1.035650623885918, 1.8, 1.022380467955239, 1.0102128763797114, 1.1832410765413246, 1.1846153846153846, 1.0704600724601718, 1.0848329048843188, 1.147842056932966, 1.0242600679281901, 1.031865665773444, 1.066437355105332, 1.010556621880998, 1.061936936936937, 1.027027027027027, 1.1803639441388065, 1.1205014749262536, 1.0336648259361745, 1.0755756740799056, 1.1271008403361344, 1.0408548082966687, 1.2053571428571428, 1.2556053811659194, 2.0, 2.5, 1.0909090909090908, 1.0237068965517242, 1.017296604740551, 1.0109896913599357, 1.0030445969125215, 1.1233619521012201, 1.0569332867621377, 1.1130434782608696, 1.1097634930260765, 1.0428319431788977, 1.6666666666666667, 1.6923076923076923, 1.2577249575551783, 1.0, 1.1076732673267327, 1.1534548537515896, 1.081605049594229, 1.066157503072539, 3.0, 1.0486486486486486, 1.0576923076923077, 1.1040459143084442, 1.039358918030908, 1.1499460625674218, 1.1287467884670284, 1.1416050549409824, 1.1786224031294603, 1.0662251655629138, 1.1756756756756757, 1.1164144353899883, 1.0, 3.0, 1.0410105561037366, 6.0, 1.5, 2.03125, 1.0706751054852321, 1.0000588803572947, 1.0038631346578366, 1.058139534883721, 1.0, 1.0537525354969575, 1.0234260614934114, 1.0229885057471264, 1.2495088408644401]
origin-bjaq_15.71 	max: 6.0000	99th: 3.0000	95th: 1.7161	median: 1.0784	mean: 1.1789

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.243737 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.310596