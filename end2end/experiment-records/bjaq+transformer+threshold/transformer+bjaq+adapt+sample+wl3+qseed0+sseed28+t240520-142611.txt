Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 28, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.4293	95th: 1.6667	median: 1.0834	mean: 1.1700
ReportEsts: [1.0862068965517242, 1.0138020833333334, 1.0517338657176338, 1.0420841683366733, 1.5, 1.0, 1.0501322108898603, 1.06102357534955, 1.0, 1.02365308804205, 1.192941448070874, 1.0433482338188396, 1.0063398140321218, 1.1441860465116278, 1.0374425997880607, 1.0, 1.2857142857142858, 1.0903294367693943, 3.0, 2.0, 1.1111111111111112, 1.1260867453494585, 1.0876703120556375, 1.106283029947152, 1.0848544647261964, 1.0, 1.1578167359479488, 1.5, 1.2, 1.014388489208633, 1.0, 1.0370907911006657, 1.004158259928153, 1.1531631520532741, 1.0840064620355412, 1.2355499790882476, 1.160427807486631, 1.0113951717871263, 1.139679041256285, 1.0357142857142858, 1.2093023255813953, 1.0518292682926829, 1.0, 1.0416956824512535, 1.1175659369074298, 1.8333333333333333, 1.03, 1.226148409893993, 1.0414230534661517, 1.1296296296296295, 1.0407933005716579, 1.1701030927835052, 1.0386580416555078, 2.0, 1.0935064935064935, 1.1250484206078106, 1.1133603238866396, 1.3658536585365855, 1.0254777070063694, 1.25, 1.1558978553253363, 1.1108343711083437, 1.0681818181818181, 1.0481927710843373, 1.0, 1.1281140179617337, 1.3131443298969072, 1.75, 1.0, 1.0674000186445418, 1.020706455542022, 1.0615206035983749, 1.0277777777777777, 1.0814017914858252, 1.0494117647058823, 1.0424710424710424, 1.0, 1.1123173277661795, 1.6, 1.0165837721153426, 1.28, 1.0014610271020528, 1.1226993865030674, 1.1413612565445026, 1.1123650637880276, 1.0, 1.0697953108993563, 1.0258469801232406, 1.0735294117647058, 1.75, 1.0814457831325301, 1.0447971013640294, 1.003125, 1.032258064516129, 1.056949806949807, 1.0545454545454545, 1.0227272727272727, 1.140077821011673, 1.0, 1.2582238688671832, 1.0253949505389044, 1.1217838765008576, 1.2370247500982148, 1.1724137931034482, 1.0178234186900792, 1.0804353597026812, 1.1618025751072962, 1.0739476678043232, 1.0472103004291846, 1.3333333333333333, 1.6666666666666667, 1.0981308411214954, 1.0713143833216539, 1.0720151610865445, 1.12987012987013, 1.0531552320382218, 1.0, 1.0624408703878903, 1.1152614727854855, 1.0, 1.0224719101123596, 1.1666666666666667, 1.2982456140350878, 1.02568029797635, 1.102896637415547, 1.0666666666666667, 1.8, 1.153973509933775, 1.0, 1.0769230769230769, 1.1050699819038758, 1.3, 1.0885416666666667, 1.031250981303422, 1.094931824028814, 1.0307076101468624, 1.0195530726256983, 1.0997661730319563, 1.039972432804962, 1.0798293723339427, 1.0056185748284576, 1.208955223880597, 1.0039138943248533, 1.1125579584038163, 2.0, 1.0186873290793073, 1.002290950744559, 1.1025991792065664, 1.095817893065114, 1.5, 1.1172196657786388, 1.06973058637084, 1.0141987829614605, 1.1074561403508771, 1.0306569343065692, 1.0241065407956844, 1.1132604016158996, 1.190062245116978, 1.0193798449612403, 1.0361842105263157, 1.3265306122448979, 1.3529411764705883, 1.0736377025036818, 1.2857142857142858, 1.0846952205650233, 1.0161419454208571, 1.1954576737783895, 1.376954085144037, 1.1495786516853932, 1.148048024171106, 1.2673684210526315, 1.08675799086758, 1.040863755204803, 1.0404448938321538, 1.0247568523430592, 1.087463556851312, 1.0436156763590392, 1.13195632153664, 1.00124397694706, 1.0, 1.0956521739130434, 1.0051063829787235, 1.0285087719298245, 1.1660914581535806, 1.2236842105263157, 1.0771076705687452, 1.2742648472035365, 1.085752007445404, 1.1372549019607843, 1.0722727272727273, 1.1753962691395299, 1.0, 1.0, 1.0235260885355717, 1.0640096618357489, 1.003701989819528, 1.3461538461538463, 1.0553054662379422, 1.060559971636599, 1.0824025463614397, 1.0626410835214446, 1.1062506587962475, 1.6440677966101696, 1.0847457627118644, 1.2, 1.0, 1.4414414414414414, 1.1400410029963728, 1.3588850174216027, 1.2988505747126438, 1.0118635689569946, 1.0031277926720286, 1.038058653008234, 1.0440850072134058, 1.1137876157407407, 1.24822695035461, 1.0173410404624277, 1.0184705119896307, 1.0535355276006664, 1.0263393164156522, 1.0, 1.0095238095238095, 1.114194552222638, 1.0113525545569655, 1.1399026763990268, 1.0713607683287731, 1.2786069651741294, 1.0357142857142858, 1.0039047707209519, 1.2126095925734914, 1.0174844895657078, 1.136094674556213, 1.1279831539541414, 1.0506769825918763, 1.2385826771653543, 2.0, 1.1877631209654784, 1.0807838320678875, 1.0977496483825597, 1.098360655737705, 1.0, 1.6666666666666667, 1.087089569300575, 1.1454545454545455, 1.0738176432089834, 1.5, 1.0, 1.0526315789473684, 1.0281030444964872, 1.1326530612244898, 1.0055248618784531, 1.0981012658227849, 1.092982456140351, 1.007136859781696, 1.0974235883935657, 1.0363636363636364, 2.0, 1.1241029753459586, 1.1217672413793103, 1.1208406304728546, 1.0075189553496209, 1.1147791619479048, 1.032793549698489, 1.0937996820349762, 1.10742390366706, 1.0155502392344498, 1.0058716622396198, 1.0321967296235264, 1.1, 1.0307945666844145, 1.2641509433962264, 1.2045454545454546, 1.3888888888888888, 1.012, 1.0555555555555556, 1.0854700854700854, 1.1152412354484893, 1.083565459610028, 1.3859649122807018, 1.010821848482352, 1.1098696461824953, 1.027544637857247, 1.050844717033733, 1.1111111111111112, 1.0722080756638779, 2.5, 1.0437944054596267, 1.0109170305676856, 1.0321150607619134, 1.0526315789473684, 2.0, 1.5217391304347827, 1.109375, 1.053644826305748, 1.0, 1.0015290519877675, 1.0475113122171946, 1.0092147435897436, 1.0176658844849218, 1.105263157894737, 1.169811320754717, 1.009540676416819, 1.1013273509067116, 1.128939051918736, 1.1111111111111112, 1.0, 1.1336515513126493, 1.2415902140672783, 1.1588447653429603, 1.0738416175231678, 1.0554628857381152, 1.1234177215189873, 1.1346153846153846, 1.00960219478738, 1.018392012611666, 1.2857142857142858, 1.008546744831842, 1.038022813688213, 1.0526315789473684, 1.059380472854641, 1.1428571428571428, 1.1666666666666667, 1.0083898645364442, 2.0, 1.2016460905349795, 1.0261627906976745, 1.1353568498769484, 1.0849405006155108, 1.1253263707571801, 1.058139534883721, 1.097038650414643, 1.0769698887563595, 1.0530846484935437, 1.0403408800095542, 1.0273013150371642, 2.0, 1.0, 1.0553257615576224, 1.25, 1.0697544642857142, 1.3529411764705883, 2.0, 1.375, 1.3253012048192772, 1.058933582787652, 1.18348623853211, 1.0367965367965368, 1.0, 1.1557922769640478, 1.0929642320975355, 2.0, 1.0107206670637283, 1.0, 1.0971229029074623, 1.0, 1.0139143852927874, 1.1497695852534562, 1.1363636363636365, 1.3205849268841394, 1.3703703703703705, 1.0192913648529422, 1.006166548244077, 1.0459610027855153, 1.0, 1.0769230769230769, 1.5714285714285714, 1.5, 1.2307692307692308, 1.0691000603434089, 1.3333333333333333, 1.1164725457570714, 1.2317073170731707, 1.2054062309102016, 1.1073181790438325, 1.262615859938208, 1.0415387521843857, 1.0110208816705337, 1.036904761904762, 1.5, 1.28, 1.0127659574468084, 1.042305746149331, 1.0952380952380953, 1.5714285714285714, 1.0369515011547343, 1.0183540556542332, 1.017877531814187, 1.0098039215686274, 1.1464387464387464, 1.011217510259918, 1.0126582278481013, 1.0907770515613653, 1.0286016949152543, 1.1923076923076923, 1.0254957507082152, 1.0512820512820513, 1.0905363798411927, 1.066419956777357, 1.0040635143140837, 1.131578947368421, 1.1443298969072164, 1.098159509202454, 1.0, 1.0222456131342823, 1.0571399172497455, 1.0447040535129661, 1.0534146138580918, 1.0808185200496072, 1.1394979345408325, 1.5714285714285714, 1.029294935451837, 1.0, 1.233134073441503, 1.25, 1.0360634699058309, 1.0014513788098693, 1.0700773860705073, 1.173913043478261, 1.036115569823435, 3.0, 1.1813148788927335, 1.0108429745985616, 1.1215743976457606, 2.0, 1.0634920634920635, 1.2456813819577734, 1.183673469387755, 1.113631642361544, 1.1392931392931394, 1.2352941176470589, 1.0681622088006903, 1.028373103980181, 1.0871205973056322, 1.1061495478130505, 1.0991228070175438, 1.0746268656716418, 1.2916666666666667, 2.142857142857143, 1.0287206266318538, 1.5, 1.2360876897133222, 1.0909090909090908, 1.081612563527311, 1.7857142857142858, 1.090507459073441, 1.1097630136280052, 1.0900678593460826, 1.0, 1.2, 1.12, 1.2825772321205768, 1.1925601750547046, 1.0, 1.0472506217187068, 1.1115942312839897, 1.0029009531703275, 1.5, 2.0, 1.0046601941747573, 1.0108695652173914, 1.0032894736842106, 1.1111111111111112, 1.0823894824216136, 1.0861538461538462, 1.4705882352941178, 1.0592843691148777, 1.0454545454545454, 1.0892388451443569, 1.014516129032258, 1.3134202776609172, 1.0078097882679624, 1.0, 1.0571428571428572, 1.069168157737782, 1.0421546705344373, 1.0179572785323003, 1.0, 1.0811767308117672, 1.017464137611757, 1.0214772132006287, 2.0, 1.0422647527910687, 1.066395561914803, 1.0291159183178815, 1.0160761871477872, 1.005715610131542, 1.0090843891943582, 1.0232158211521927, 1.1453712632594022, 2.0, 1.060003100935449, 1.8048780487804879, 1.0, 1.217616580310881, 1.1346153846153846, 1.0010835861701064, 1.1618953603158935, 1.0527744327847546, 1.16154199173933, 1.0703094917212168, 1.0792641688083322, 1.0548158165447252, 1.1573033707865168, 4.0, 1.0022617357618921, 1.1672064777327935, 1.0442277442017245, 1.0429307219382127, 1.0895484525621513, 1.1008462623413258, 2.223404255319149, 2.4285714285714284, 1.0143277986073915, 1.0749389992535068, 1.0072328185651651, 1.1453794139744553, 1.0242961820285383, 1.052060737527115, 1.0744448327847302, 1.0037899296155928, 1.2021439509954057, 2.0, 1.0833333333333333, 1.0124223602484472, 1.0865384615384615, 1.099630996309963, 1.2646616541353384, 1.0294117647058822, 1.3266666666666667, 1.148905109489051, 1.1097560975609757, 1.0810797802898586, 1.2696629213483146, 1.0059324659231723, 2.0, 1.0832684824902723, 1.0632911392405062, 1.247787610619469, 1.1159217877094971, 1.0185995623632385, 1.030549898167006, 1.046692607003891, 1.1509941920054663, 1.0, 1.5106382978723405, 1.2, 1.0, 1.1136363636363635, 1.159274193548387, 1.0109204368174727, 1.145631067961165, 1.0653636654918295, 1.0522041763341068, 1.0167360373382561, 1.173027989821883, 1.0410534469403563, 1.1042748402154015, 1.1081081081081081, 1.1473183978275627, 1.011611030478955, 1.040453491368204, 1.157514450867052, 1.138863287250384, 1.0434297876653322, 1.1344084148932465, 1.0757373682533313, 2.0, 1.230958230958231, 1.059745347698335, 1.4205607476635513, 1.0, 1.108695652173913, 1.1538461538461537, 1.121031746031746, 1.2592592592592593, 1.1666666666666667, 1.010806608827344, 1.1267746650914114, 1.0375915052122404, 1.0086799003698392, 1.2, 1.1121621621621622, 1.0, 1.1240875912408759, 1.03262293951307, 1.0887852949770234, 1.083251629024841, 1.142100467023579, 1.019764431316778, 1.1324675324675324, 1.1165512796523835, 1.0923623445825932, 1.0016395651783307, 1.0705397315461511, 1.303030303030303, 1.0414507772020725, 1.0, 1.2422535211267605, 1.2061821836604927, 3.0, 1.1034870641169854, 1.0466163032660816, 1.4285714285714286, 1.004668669248308, 1.3, 1.1176470588235294, 1.0518082610153079, 1.6923076923076923, 1.0255973314963198, 1.0491243058522, 1.3571428571428572, 1.0357142857142858, 1.0948453608247424, 1.0038259206121474, 1.083222958057395, 1.07632449257506, 1.155277798948251, 1.0, 1.0609385183575928, 1.1341463414634145, 2.0, 1.0058583389072122, 1.087758456613894, 1.10879848628193, 1.0188767550702027, 1.030126409810007, 1.0272727272727273, 1.5714285714285714, 1.0304298212248002, 1.0258064516129033, 1.0719630767142347, 1.1868566904196358, 1.009740128754128, 1.0127753242591844, 1.1721611721611722, 1.1218697829716193, 1.1973244147157192, 1.0987578854711721, 1.0801261829652997, 1.0905797101449275, 1.036764705882353, 1.0736139736676171, 3.0, 1.1414549480803184, 1.0530828012142783, 1.0271731505962338, 1.5833333333333333, 1.328704346618525, 1.2098214285714286, 1.0, 1.069655075121676, 1.0420575865415722, 1.1353711790393013, 1.0294117647058822, 1.3333333333333333, 1.059700519890519, 1.5, 1.105140186915888, 1.0833333333333333, 1.0393552438769103, 1.44, 1.2151898734177216, 1.0618448637316562, 1.0, 1.4973544973544974, 1.2251602564102564, 1.25, 2.0, 1.1083333333333334, 1.2206896551724138, 1.0062817828297936, 1.2124681933842238, 1.103448275862069, 1.2359882005899705, 1.1014466214978942, 1.0545454545454545, 1.1342592592592593, 1.4040816326530612, 1.0, 1.0, 1.231722428748451, 1.098124098124098, 1.0113636363636365, 1.1417080671871302, 1.0483908467939305, 1.0222804718217562, 1.0962633029970652, 1.2256000578369, 1.2220588235294119, 1.0371287128712872, 1.5714285714285714, 1.0, 1.2142857142857142, 1.0379145480761933, 1.085613415710503, 1.107843137254902, 1.0330788804071247, 1.0028255059182893, 1.0540342367241038, 1.0117638712821508, 1.0985915492957747, 1.2222222222222223, 1.0384319754035358, 1.036519088016967, 1.067866718985024, 1.0377609524593312, 1.006578947368421, 1.0321175428233904, 1.0231494821127978, 1.306020066889632, 1.3467413441955194, 1.125, 1.058795411089866, 1.458128078817734, 1.1063829787234043, 1.066860465116279, 1.0701001430615165, 1.0, 1.0579710144927537, 1.012095916196088, 1.037037037037037, 1.0811660656429363, 1.0260869565217392, 1.1025641025641026, 1.0443612162008276, 1.0275054073540015, 1.066545796400752, 1.0353053435114503, 1.0590238365493758, 1.2022087469087706, 1.1965811965811965, 1.4285714285714286, 1.0, 1.4285714285714286, 1.0742884824996972, 1.3333333333333333, 1.1605176642488129, 1.1195412201820043, 1.077326968973747, 1.069314796425025, 1.0524781923069246, 1.007450599287334, 1.021505376344086, 1.0097087378640777, 1.017028670721112, 1.1501452943382078, 1.04445367885609, 1.2044140672046248, 1.4285714285714286, 1.03125, 1.0368852459016393, 1.120992062116538, 1.019543973941368, 1.2955476645725212, 1.0, 2.2401746724890828, 1.0359845618283638, 1.051006711409396, 1.0710645933014353, 1.1875, 1.0490727884592757, 1.0304922255486468, 1.3825613079019075, 1.0581052631578947, 1.032258064516129, 1.212987012987013, 1.1043956043956045, 1.5625, 1.0666546697858557, 1.7307692307692308, 1.4894894894894894, 1.0963855421686748, 1.018543956043956, 1.0313184037716787, 1.0119047619047619, 2.75, 1.0769230769230769, 1.1047097319754402, 1.0664981387854882, 1.0068858603278565, 1.0491037033232318, 1.0639171669711998, 1.0, 1.0801364023870417, 1.0078140261769877, 1.0706211313720335, 1.0230460921843687, 1.0069444444444444, 1.0577096483318305, 1.0106994840565, 1.3579881656804733, 1.0207298178126836, 1.0, 1.3333333333333333, 1.0452322677940122, 1.03, 1.204032556418794, 1.1716615698267074, 1.0327214684756585, 1.1029411764705883, 1.1026012557786518, 1.0785347127334244, 1.1029411764705883, 1.0335195530726258, 1.03328509406657, 1.1054459333431503, 1.1071428571428572, 1.75, 1.0560444599729222, 1.1675908113613218, 1.0287390029325514, 1.0113636363636365, 1.229181752353367, 1.0039441535776614, 1.1526567332021367, 1.0638297872340425, 1.2692307692307692, 1.0242587601078168, 1.072234762979684, 1.14375, 1.2285714285714286, 1.0068722762319813, 1.2051536174430129, 1.164179104477612, 1.048780487804878, 1.0389674658106798, 1.109681137149443, 1.0669344042838018, 1.2219251336898396, 1.3333333333333333, 1.2727272727272727, 2.0, 1.1525600835945664, 1.2307692307692308, 1.0, 1.1538461538461537, 1.043708609271523, 1.0615942028985508, 1.0371862410907964, 1.0195820546543914, 1.1381818181818182, 1.4166666666666667, 1.1428571428571428, 1.1935483870967742, 1.0810810810810811, 1.1142857142857143, 1.1263157894736842, 1.0282278489561876, 1.0313235130421876, 1.3061224489795917, 1.0706386820130895, 1.0469696211400832, 2.5, 1.069094280562077, 1.1111111111111112, 1.5, 2.0, 1.167455621301775, 1.1110951732051926, 1.0516645374614864, 1.236024844720497, 1.0, 1.1415929203539823, 1.352760736196319, 3.0, 1.5, 1.0292814960629921, 1.1414168571044496, 1.129410104431273, 1.6666666666666667, 1.0179826673897008, 1.0464756003098374, 1.1168384879725086, 1.1428571428571428, 1.0375586854460095, 1.0273958883720287, 1.027027027027027, 1.1734726380837102, 1.0546537111382634, 1.2724550898203593, 1.0625, 1.0910238492403408, 1.0606884057971016, 1.165289256198347, 1.15, 1.048559218459065, 1.879108250976787, 1.083427377722285, 1.5449101796407185, 1.107843137254902, 1.2985074626865671, 1.1001371742112482, 1.0633228840125393, 1.0007791507257089, 1.0394098486300059, 1.0305676855895196, 1.5, 1.6666666666666667, 1.1563958320015342, 1.1732629727352681, 1.0618556701030928, 1.0015364570529524, 1.0939956514467302, 1.0874059373191103, 1.2708933717579252, 1.0208333333333333, 1.1033723763855043, 1.1305397464609315, 1.2414045354791514, 1.3562945368171022, 1.6666666666666667, 1.0, 1.0723446105428796, 1.1560773480662982, 1.043239812524411, 1.1089229103167602, 1.0042613636363635, 2.0, 1.052890528905289, 1.0196212921942114, 1.1672378341329679, 1.1711026615969582, 1.0797751871453773, 1.085987261146497, 1.338852097130243, 1.0266666666666666, 1.0329040241835687, 1.0683980133007829, 1.0161290322580645, 1.0597014925373134, 1.0, 1.200533388039799, 1.046439345461194, 1.018842530282638, 1.0434693248381461, 1.1571152607855764, 1.0234493192133132, 1.2857142857142858, 1.2493368700265253, 1.6666666666666667, 2.0, 1.1764705882352942, 1.0051413881748072, 1.0110584518167456, 1.0368473740951794, 1.0247337581797187, 1.0104195228955306, 1.0207112970711296, 1.1630434782608696, 1.4, 1.057198173362234, 1.6, 1.4166666666666667, 1.1057173678532901, 1.1428571428571428, 1.0387275242047027, 1.1392088132198297, 1.0222622803064443, 1.1093473568031682, 2.0, 1.0470588235294118, 1.176356589147287, 1.0796984383414108, 1.04001027551217, 1.1414141414141414, 1.1167808219178081, 1.1527048260381594, 1.094259640859582, 1.0381558028616853, 1.42, 1.074022346368715, 1.0, 1.0, 1.041441650870856, 5.0, 1.5714285714285714, 2.076923076923077, 1.0907894736842105, 1.119047619047619, 1.084811529933481, 1.0859160455080423, 1.0, 1.090626939788951, 1.0035046728971964, 1.0931372549019607, 1.3197115384615385, 1.4285714285714286, 1.0322875071306332, 1.0509977827050998, 1.1573033707865168, 1.0330978058757903, 1.0208273527286407, 1.0548255978825976, 1.127181307305531, 1.0, 1.2210094343613827, 1.0721045313036577, 1.0083182640144666, 1.1774193548387097, 1.1290217568227443]
origin-bjaq_15.71 	max: 5.0000	99th: 2.4293	95th: 1.6667	median: 1.0834	mean: 1.1700

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 14.096113 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[1.1920929e-07 2.9802322e-07 0.0000000e+00 0.0000000e+00 5.9604645e-08]
Distance score: 9.536743306171047e-08
SAUCE Drift detection: False
Detection latency: 0.0232s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.014760 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.5000	95th: 1.7500	median: 1.0866	mean: 1.1764
ReportEsts: [1.0328767123287672, 1.0019396551724138, 1.0464102981323786, 1.0380794701986755, 1.5416666666666667, 2.0, 1.0831250578542997, 1.0755771080474512, 1.0, 1.0339168490153172, 1.0243311337732453, 1.0427946219094026, 1.0112201963534362, 1.11531190926276, 1.066079295154185, 1.15, 1.167202572347267, 1.0416666666666667, 1.1818181818181819, 1.0836855452240068, 1.1008260721964467, 1.1449237923017308, 1.0059642147117296, 1.0108063175394846, 1.0073885217753265, 1.0193414039156987, 2.0, 1.1295642970541542, 1.75, 1.0, 1.068362480127186, 1.0, 1.0338952164009112, 1.005850351995324, 1.0114521300961978, 1.0054421768707482, 1.2245924802701864, 1.2222222222222223, 1.4166666666666667, 1.111082546508367, 1.0312644102185742, 1.1259516413910713, 1.117930204572804, 1.055408095554081, 1.0072727272727273, 1.0599253455291389, 1.2173913043478262, 1.1034816247582204, 1.2462311557788945, 1.0367847411444142, 1.1388888888888888, 1.1133603238866396, 1.0530612244897959, 1.09375, 1.0334706424838611, 1.0249695748877419, 1.0105633802816902, 1.1150895140664963, 1.02020202020202, 1.0473537731129887, 1.3043478260869565, 1.0839734442953937, 1.087557603686636, 1.068840579710145, 1.05, 1.6666666666666667, 1.0522659710004247, 1.324661246612466, 1.6, 2.0, 1.0544376852285136, 1.0720906282183316, 1.0813559322033899, 1.0095057034220531, 1.1281382850725916, 1.0455486542443064, 1.0463714351959192, 1.2085561497326203, 1.5242718446601942, 1.0365921609105109, 1.0573770491803278, 1.053030303030303, 1.0, 2.0, 1.0622914349276975, 1.2105263157894737, 1.273972602739726, 1.3333333333333333, 1.5, 1.0630417020458514, 1.1143072289156626, 1.2592757412248985, 1.0080647225991448, 1.016567263088138, 1.1314432989690721, 1.0172018348623852, 1.4236111111111112, 1.0039525691699605, 2.0, 1.2628434886499402, 1.1785714285714286, 2.0, 1.0745404631176891, 1.008203799654577, 1.0607576840600428, 1.2142499463480936, 1.1875, 1.0154522149222152, 1.061599822734323, 1.0490059108006449, 1.2039535613429557, 1.0491344195519348, 1.2857142857142858, 1.5, 1.0329585110507948, 1.0338523200246648, 1.0601583113456465, 1.0957446808510638, 1.0541605763207351, 1.0, 1.1621764395139988, 1.172607879924953, 1.5, 1.0373831775700935, 1.0, 1.1414141414141414, 1.021777000916709, 1.0841568171542983, 1.0317460317460319, 2.1666666666666665, 1.1787671232876713, 2.0, 1.3333333333333333, 1.120088544548976, 1.3333333333333333, 1.0102707749766573, 1.0154404575949296, 1.0527132317451562, 2.0, 1.4285714285714286, 1.086767895878525, 1.106364428945074, 1.0784615384615384, 1.0295655208515093, 1.238709677419355, 1.0026824034334765, 1.150645929378388, 1.5, 1.022874571101792, 1.0106692531522794, 1.084096109839817, 1.1142228739002933, 1.5, 1.1646905144694535, 1.031941031941032, 1.0186440677966102, 1.2919708029197081, 1.0, 1.0090270812437312, 1.0872198075890023, 1.1111807208787536, 1.0818030050083471, 1.1153846153846154, 1.2881355932203389, 1.3387096774193548, 1.0282555282555284, 1.3333333333333333, 1.0501787198018404, 1.3333333333333333, 1.1799163179916319, 1.0681025508944764, 1.1772669220945082, 1.0538461538461539, 1.2746478873239437, 1.120388349514563, 1.1141751330430576, 1.1091058244462675, 1.0671043034281547, 1.105785123966942, 1.0479978785468045, 1.0729678638941398, 1.2186778702767187, 1.2341772151898733, 1.1440677966101696, 1.014593310282344, 1.1109144542772862, 1.2795698924731183, 2.015873015873016, 1.0554216867469879, 1.6666666666666667, 1.2357954545454546, 1.0827092385090327, 1.1538461538461537, 1.1461928934010153, 1.0104341314928458, 1.0147982633660673, 1.0995554542345833, 1.0875621890547265, 1.0189998973902932, 1.078728616595825, 1.0260869565217392, 1.0726992061158482, 1.0193409742120343, 1.0642333908644783, 1.0503055947343676, 1.106492824641232, 1.6415094339622642, 1.1408450704225352, 1.25, 1.0, 1.385185185185185, 1.0388616290480863, 1.3333333333333333, 1.2136752136752136, 1.0173985086992543, 1.04, 1.041972454006233, 1.063063063063063, 1.2312927877726476, 1.25, 1.0046296296296295, 1.0024403470715835, 1.0536847651665748, 1.0110845888458304, 2.0, 1.043196544276458, 1.0997457974579745, 1.0083290155440414, 1.0412087912087913, 1.0784313725490196, 1.0447154471544715, 1.10673589103904, 1.4910714285714286, 1.006641372894106, 1.0150732781532386, 1.1146496815286624, 1.152409046214356, 1.0918367346938775, 1.2142857142857142, 1.1523178807947019, 2.0, 1.189347724073205, 1.154956465055641, 1.06635349383441, 1.0863787375415281, 1.2142857142857142, 2.0, 1.1155642080302122, 1.0724637681159421, 1.1253269988273145, 1.2, 1.1818181818181819, 1.0141129032258065, 1.125, 1.0059466702610984, 1.0160919540229885, 1.0891774891774892, 1.101010101010101, 1.005967005967006, 1.069566899308522, 1.0140845070422535, 2.0, 1.0609192742481508, 1.0108042523688467, 1.1676557863501484, 1.0135727414109996, 1.1650828129242465, 1.0381515848017933, 1.092217135382603, 1.0762345633798691, 1.0270676691729324, 1.064551825894504, 1.0448683789832676, 1.1538461538461537, 1.0352724893278908, 1.0071301247771836, 1.1923076923076923, 1.3636363636363635, 1.0522435897435898, 1.3205128205128205, 1.0226712839170649, 1.0203264876250657, 1.0523917995444192, 1.3169734151329244, 1.0054719228366136, 1.027643400138217, 1.1590811507084586, 1.039772230731373, 1.3636363636363635, 1.0355805243445693, 1.024878640776699, 1.0335818851862575, 1.0696752265861027, 1.0754389334972532, 1.2910249601699415, 1.207070707070707, 1.0613505645104027, 1.0298903792469531, 1.1016741232501082, 1.0464611197404776, 1.024186046511628, 2.0, 1.0666666666666667, 1.0985830569791981, 1.5, 1.0197841726618706, 1.0161891507094751, 1.0422102839600922, 1.4444444444444444, 1.0245901639344261, 1.8870967741935485, 1.0407810609987904, 1.0951549658913895, 1.0, 1.1264568764568765, 1.0261486236682016, 1.0669856459330143, 1.5, 3.857142857142857, 1.010153380859797, 1.0, 1.0120151002762796, 1.0479233226837061, 1.2, 1.1016471929324594, 1.2727272727272727, 1.4166666666666667, 1.006473358151395, 3.0, 1.0740740740740742, 1.0462287104622872, 1.1329113924050633, 1.0743609604957398, 1.0109170305676856, 1.2291666666666667, 1.1182525649544446, 1.0874607768881195, 1.0545454545454545, 1.040286246251368, 1.0979171958343916, 3.0, 1.1, 1.0600839576213912, 1.1666666666666667, 1.0516519311307584, 1.125, 2.0, 1.4210526315789473, 1.3938091143594153, 1.0737833594976451, 1.1865671641791045, 1.0337381916329285, 1.3076923076923077, 1.8333333333333333, 1.0769236426212871, 1.3076923076923077, 1.3548387096774193, 1.005698636064155, 1.1481481481481481, 1.0592705167173253, 1.0028222013170274, 1.4, 1.0, 1.129565816678153, 1.1468531468531469, 1.053740779768177, 1.1316962697716333, 1.2461405458811905, 1.0458015267175573, 1.5, 1.0278455296384477, 1.075268817204301, 1.72, 2.0, 1.0082644628099173, 1.7142857142857142, 1.1498929336188437, 1.21, 1.251121194533847, 1.101720291003176, 1.1138780078343593, 1.0909685863874345, 1.1202222824613717, 1.0526315789473684, 1.0972017673048602, 1.151504820349641, 1.1058631921824105, 1.121212121212121, 1.0044975377404142, 1.0404429922875271, 1.1450939457202505, 1.0686274509803921, 1.1578947368421053, 1.2094017094017093, 2.0, 1.0208333333333333, 1.0393700787401574, 1.1474480151228734, 1.35, 1.0054347826086956, 1.0960086299892124, 1.1363636363636365, 1.0188825868437519, 1.0779122541603632, 1.0124649491763056, 1.1222222222222222, 1.0465116279069768, 1.1265822784810127, 1.0, 1.098642062106502, 1.6274509803921569, 1.1081597156577305, 1.0299977779423746, 1.0671237514812935, 1.1702523240371845, 1.625, 1.072041166380789, 1.0, 1.0575079872204474, 1.0909090909090908, 1.0308029722740515, 1.0036585365853659, 1.126659490491568, 1.1587837837837838, 1.1194690265486726, 3.0, 1.2368738684369343, 1.012539561921283, 1.0426843273868769, 2.0, 1.1538461538461537, 1.2784911717495988, 1.4074074074074074, 1.0757362784471218, 1.0471430334444034, 1.0384615384615385, 1.2275711159737417, 1.0621651254680486, 1.0552408164605809, 1.1597222222222223, 1.0241696649288983, 1.3708260105448156, 2.0, 1.0765184122429459, 1.0386634605750926, 1.1016949152542372, 1.0264150943396226, 1.0, 1.0, 1.1146579804560262, 1.161825726141079, 1.0168211465842774, 1.1191430288805564, 1.0631632137443152, 1.0, 1.2300884955752212, 1.2222222222222223, 1.056207681922645, 1.0833333333333333, 1.0, 1.0707769894440187, 2.0, 1.0, 1.0057317539166986, 2.3333333333333335, 1.0025798129635601, 1.0030097817908201, 1.0351351351351352, 1.0909090909090908, 1.0662335186190106, 1.083614864864865, 1.75, 1.0651265126512652, 1.0434782608695652, 1.1372767857142858, 1.005390835579515, 1.2544378698224852, 1.005586592178771, 1.0, 1.0470588235294118, 1.2307607980705986, 1.1666375850636888, 1.062748212867355, 1.2, 1.0584154801022272, 1.017395634401659, 1.024507658643326, 1.0, 1.0305418719211823, 1.0683418878777382, 1.0113560288611738, 1.018054833197117, 1.0145449065259102, 1.026206178932205, 1.0157819225251077, 1.144386785557667, 1.5, 1.1671122994652405, 1.1327889987107864, 1.0375994215473607, 1.0066408411732153, 1.1132075471698113, 1.0094498676808217, 1.1048034934497817, 1.022438985547637, 1.176605504587156, 1.1330321551953229, 1.0728155339805825, 1.1289309743334164, 1.054342951113769, 1.0113636363636365, 1.0505050505050506, 1.120847931172114, 1.1059322033898304, 1.0281719862833025, 1.0612939163649384, 1.0, 1.0369253956292388, 1.2492997198879552, 1.75, 1.0, 1.0152403186834715, 1.1439114391143912, 1.0987573577501635, 1.0, 1.0902777777777777, 1.020309254558043, 1.15918055083305, 1.040297121634169, 1.008318850950726, 1.1152019002375297, 1.1295843520782396, 1.0176322418136021, 1.0093962710861202, 1.5371428571428571, 1.0280523188158446, 1.1268723786698622, 1.1421052631578947, 1.0343672175684855, 1.5625, 1.027054082496984, 2.0, 1.0300480769230769, 1.0378006872852235, 1.0681599420204513, 1.0931263858093125, 1.0810546875, 1.0410509031198687, 1.3097345132743363, 1.1014045831471815, 1.0, 1.125, 1.0, 1.0, 1.2, 1.0593220338983051, 1.0343461030383092, 1.1255230125523012, 1.0670585092172054, 1.0692934782608696, 1.0527376048588353, 1.1710944267975743, 1.0443489704827624, 1.1109562559007329, 1.0055022632621344, 1.0640756302521008, 1.100632244467861, 1.0474059257407176, 1.0672268907563025, 1.0582627118644068, 1.1586901763224182, 1.5203252032520325, 1.0924632502233411, 1.1943793911007026, 1.1028769333700656, 1.3485714285714285, 1.2045779685264664, 1.0434782608695652, 1.0, 1.037780401416765, 1.1176470588235294, 1.3333333333333333, 1.4248927038626609, 1.040104600393808, 1.0435276305828918, 1.0077720207253886, 1.1256830601092895, 1.0987849055594916, 1.0158182086468939, 1.0953237410071943, 1.4, 2.5, 1.008514307269494, 1.059090909090909, 1.1365283930728958, 1.1066853016538551, 2.0, 1.2789442111577685, 1.1948051948051948, 1.0021938013442868, 1.1122448979591837, 1.013729933720831, 1.0245769330903411, 1.0111424471563628, 1.3440860215053763, 2.5, 1.1294069065193826, 1.0, 1.016184971098266, 1.2719298245614035, 1.3446601941747574, 1.1518987341772151, 1.6521739130434783, 1.0346525721442141, 1.1071428571428572, 1.3129117259552041, 1.078719723183391, 1.2053281351526965, 1.1002570694087404, 1.0759069200284523, 1.0202205882352942, 1.0666666666666667, 1.1428571428571428, 1.0653349181396419, 1.0875656742556918, 1.0, 1.008849557522124, 1.2374635715003517, 1.2620967741935485, 1.0180348934013828, 1.3333333333333333, 1.0700179533213645, 1.0193459687714819, 1.119904076738609, 1.022099447513812, 1.068518336710013, 1.0808823529411764, 2.125, 1.0615018688413185, 1.027192386131883, 1.1295501397870717, 1.213781512605042, 1.0217813127383457, 1.004425495169734, 1.050381679389313, 1.1259285461620092, 1.16991643454039, 1.0578786496126542, 1.0799364743250397, 1.0685975609756098, 1.1333040035195776, 1.0070338685588829, 1.0833333333333333, 1.0919446704637916, 1.0, 1.6, 1.1428571428571428, 1.6138470451911935, 1.0766389658356417, 1.0666666666666667, 1.0769230769230769, 1.0284552845528456, 1.0428828828828829, 1.0258064516129033, 1.0364753113955323, 2.0, 1.0554031815688425, 2.0, 1.1310483870967742, 1.0, 1.0204146823092113, 1.5, 1.1660777385159011, 1.0465116279069768, 1.0, 1.1776077451592755, 1.2721518987341771, 1.5, 1.6666666666666667, 1.0985915492957747, 1.2148997134670487, 1.118611111111111, 1.198329853862213, 1.0915593705293276, 1.155121951219512, 1.058227848101266, 1.0904392764857882, 1.1181102362204725, 1.2895622895622896, 1.096774193548387, 1.0, 1.2022022022022023, 1.1190765492102066, 1.0110169491525425, 1.0118709677419355, 1.0917412671005446, 1.0625, 1.1040690993117255, 1.1688385951184277, 1.2075242718446602, 1.029320987654321, 1.5555555555555556, 1.0, 1.1818181818181819, 1.0408285895003162, 1.089036055923473, 1.0940860215053763, 1.1058558558558558, 1.0091239711605946, 1.0753915901077022, 1.007834689076655, 1.1325301204819278, 1.2380952380952381, 1.3333333333333333, 1.041399867520424, 1.0774249494156998, 1.0237791884182161, 1.0670391061452513, 1.0951323338885803, 1.1413217470843815, 1.047272916522101, 1.0270676691729324, 1.0821195890496773, 1.1238390092879258, 1.0617088607594938, 1.001974333662389, 1.0371677266735067, 1.288888888888889, 1.0063311174422285, 1.0, 1.0969072164948455, 1.0072142818325092, 1.3442622950819672, 1.073947630096122, 1.060434372049103, 1.2195121951219512, 1.028297481555272, 1.0206377298497165, 1.0925042111173497, 1.0227450980392156, 1.0427756653992395, 1.1915864308105688, 1.2154115586690017, 1.4666666666666666, 1.0, 1.5714285714285714, 1.073483654584394, 1.5, 1.0551005424807276, 1.0911513739893843, 1.0092404361485863, 1.1052718286655683, 1.088339644908538, 1.0363571236679503, 1.0428134556574924, 1.085680751173709, 1.0267913040756276, 1.1595101595101596, 1.0446121022592052, 1.2181394649834687, 1.5, 1.0657777777777777, 1.0636042402826855, 1.156702192184386, 1.0135135135135136, 1.3017359524897214, 1.040059347181009, 2.2836363636363637, 1.0382730646905212, 1.0133037694013303, 1.0907884761182713, 1.2777777777777777, 1.0971849208994138, 1.0350497064020419, 1.2737594617325483, 1.0571528751753156, 1.1428571428571428, 1.1020408163265305, 1.077269122849823, 1.1118550610476565, 1.0110100526567736, 1.0196418863655285, 1.3125, 1.1196671602848882, 1.1032745591939546, 1.057915057915058, 1.0773333333333333, 1.0592734225621414, 1.0544747081712063, 1.0620420127015144, 1.0058743415336688, 1.0549763033175354, 1.0706257755717072, 1.0828649299426099, 1.0625, 1.074839629365645, 1.0679001570954791, 1.0226566545831175, 1.068148148148148, 1.0741773563859454, 1.158811475409836, 1.1585760517799353, 1.0037546933667083, 1.0351429980772522, 1.4375, 1.1030867792661618, 1.235821735982624, 1.03014108593416, 1.10051993067591, 1.109559140107937, 1.1170764058114069, 1.0317460317460319, 1.0018975332068312, 1.1079193948046406, 1.0675563416137417, 1.1295180722891567, 1.0833333333333333, 1.0466830466830468, 1.070490882157634, 1.0891089108910892, 2.5, 1.0486732469036397, 1.1582862800717173, 1.000475963826749, 1.0046082949308757, 1.1427286356821589, 1.0148194083827893, 1.193350624852629, 1.1395492435937018, 1.2666666666666666, 1.058990357345434, 1.125, 1.158311345646438, 1.3235294117647058, 1.0239126796705034, 1.170090386195563, 1.0246085011185682, 1.0188679245283019, 1.0357470210815765, 1.1745594713656389, 1.1111111111111112, 1.25, 1.0492518703241895, 1.0886075949367089, 1.0660749506903353, 1.1538461538461537, 1.0382550404998603, 1.1077519379844962, 1.0991220257030156, 1.3425925925925926, 1.5, 1.3667352336173964, 1.0194569606179413, 1.0381057420555593, 1.094170403587444, 1.3333333333333333, 1.1764705882352942, 1.027027027027027, 1.0, 1.1125, 1.1044897959183673, 1.0289334687801626, 1.029463766861608, 1.3362068965517242, 1.1011034860126307, 1.0464025808387727, 3.5, 1.0443568481832728, 1.0383875400824554, 1.5, 2.0, 1.2336055431823807, 1.0977475055266774, 1.0928390023660162, 1.1865284974093264, 1.5, 1.186046511627907, 1.1507936507936507, 1.0625, 1.093657870137341, 1.112662123543636, 1.0328281477717907, 1.0111551292743954, 1.8571428571428572, 1.0171920976378748, 1.026015228426396, 1.0156657963446476, 1.0987654320987654, 1.0130023640661938, 1.0, 1.2428571428571429, 1.1543410041841005, 1.01515322854235, 1.0869565217391304, 1.1433333333333333, 1.0934986384911722, 1.1138339920948617, 1.0931034482758621, 1.2463768115942029, 1.032164322491094, 1.1581794660707985, 1.0467829468613055, 1.2142857142857142, 1.1129032258064515, 1.1573604060913705, 1.25, 1.0696395846059865, 1.020100502512563, 1.006839820433131, 1.0863509749303621, 2.0, 1.1968616262482168, 1.0243722908317658, 1.1625925925925926, 1.1436178796191705, 1.0029438503831334, 1.069386038687973, 1.1070551070551071, 1.0953389830508475, 1.0517241379310345, 1.0379963186957666, 1.0968795696901803, 1.2788220551378446, 1.1996587030716723, 2.0, 1.0470588235294118, 1.084519604695137, 1.0146627565982405, 1.023219896682111, 1.0917221297836939, 1.001763668430335, 1.8, 1.0873684210526315, 1.0173920365242122, 1.180212685150019, 1.0841423948220066, 1.077806951799993, 1.029100529100529, 1.1304744525547445, 1.02190847127556, 1.0317794304371486, 1.091183228029868, 1.031700288184438, 1.0717488789237668, 1.0555555555555556, 1.175423871076045, 1.0950486350800126, 1.0245384042834162, 1.04623878536922, 1.1119096509240247, 1.0446821900566394, 1.0, 1.2214912280701755, 2.6666666666666665, 1.3333333333333333, 1.1428571428571428, 1.017391304347826, 1.0339425587467364, 1.026373486702043, 1.0055321090452833, 1.0240852246410375, 1.0549852096746128, 1.2186046511627906, 1.0399673735725938, 1.026947105129359, 1.5, 1.6923076923076923, 1.0429497568881685, 1.125, 1.0318543799772468, 1.1244830438378826, 1.0180646128476125, 1.0901890079614287, 1.3333333333333333, 1.0981210855949897, 1.391304347826087, 1.088862739143638, 1.0400003056666782, 1.1854583772391991, 1.1211251435132032, 1.1606322055609977, 1.1149729945989197, 1.0026109660574412, 1.6415094339622642, 1.1069330199764982, 1.3333333333333333, 3.0, 1.0410614618744252, 5.0, 1.8571428571428572, 2.4444444444444446, 1.0377551020408162, 1.0483207420151095, 1.0993150684931507, 1.1124497991967872, 1.125, 1.1743908265647396, 1.0185004868549172, 1.1891891891891893, 1.2840236686390532]
origin-bjaq_15.71 	max: 5.0000	99th: 2.5000	95th: 1.7500	median: 1.0866	mean: 1.1764

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.175821 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.314375