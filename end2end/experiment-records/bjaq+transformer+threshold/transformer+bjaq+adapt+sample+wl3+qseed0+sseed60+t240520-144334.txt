Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 60, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.7525	95th: 1.7510	median: 1.0821	mean: 1.1795
ReportEsts: [1.0666666666666667, 1.015625, 1.0316320182862433, 1.0462776659959758, 1.5, 1.0, 1.0927059352013027, 1.0368548431965283, 1.0, 1.013003901170351, 1.1440567916197733, 1.04276028095105, 1.0162185232607768, 1.0767441860465117, 1.0745319675026492, 1.0, 1.25, 1.0049839800640799, 3.0, 2.0, 1.08, 1.1153069078314413, 1.106668420360384, 1.0563711098062243, 1.0409472126295016, 1.0, 1.125395263860586, 1.5, 1.4, 1.0071942446043165, 1.0, 1.0463910456345256, 1.0009543571019561, 1.1392896781354052, 1.0089587310912027, 1.2319432860717265, 1.1176470588235294, 1.004350731381357, 1.11726014188305, 1.0595238095238095, 1.213063763608087, 1.0030487804878048, 1.0, 1.03422348975888, 1.0560351848835314, 1.890625, 1.0404040404040404, 1.2756183745583038, 1.019040455377109, 1.1111111111111112, 1.0855387029288703, 1.147766323024055, 1.041442629254994, 2.0, 1.1454545454545455, 1.224953030942065, 1.3819095477386936, 1.3592233009708738, 1.0125786163522013, 1.25, 1.0827880770628862, 1.1133250311332503, 1.0772727272727274, 1.0235294117647058, 1.0909090909090908, 1.059403762238275, 1.2805529374803644, 1.75, 1.0, 1.0468910226531183, 1.0567465321563683, 1.062754212667054, 1.0206896551724138, 1.1142775583995432, 1.0588235294117647, 1.0567514677103718, 1.0, 1.1064718162839249, 2.6666666666666665, 1.0044965843253681, 1.0, 1.0595084087968951, 1.2453987730061349, 1.0506024096385542, 1.1246319921491659, 1.04, 1.0718601528609792, 1.002812609867573, 1.107843137254902, 1.75, 1.1699687174139728, 1.0529495150313803, 1.0996884735202492, 1.005641748942172, 1.0369318181818181, 1.0051948051948052, 1.0, 1.1356589147286822, 1.0, 1.2225373622777354, 1.0394528437724981, 1.0617495711835334, 1.2172587088183497, 1.2592592592592593, 1.021952468788592, 1.074329705335811, 1.4514745308310992, 1.1573758058399697, 1.04659717964439, 1.3333333333333333, 1.3333333333333333, 1.0425233644859813, 1.0758201340363185, 1.047378395451674, 1.0909090909090908, 1.0599827541714135, 1.0, 1.1053295490381583, 1.1470911086717892, 1.0, 1.0, 1.0, 1.1904761904761905, 1.0211137325924013, 1.1193600994020347, 1.108910891089109, 1.8, 1.1490066225165563, 1.0, 1.0714285714285714, 1.0890901841306193, 1.3, 1.1087239583333333, 1.0291847488177257, 1.1229551451187334, 1.0106809078771695, 1.0138888888888888, 1.0413094310210445, 1.039972432804962, 1.0804387568555758, 1.0088446202064292, 1.3064516129032258, 1.0065659881812212, 1.0853707512382713, 2.0, 1.0182315405651778, 1.0125714285714287, 1.090663058186739, 1.0755249691194635, 1.5, 1.2670138047953499, 1.0305343511450382, 1.016260162601626, 1.1074561403508771, 1.091970802919708, 1.043492919757249, 1.0959707385044124, 1.2444868413669266, 1.0691056910569106, 1.0361842105263157, 1.3061224489795917, 1.2897196261682242, 1.0191458026509572, 1.4285714285714286, 1.0694919312359334, 1.045169997483778, 1.1840490797546013, 1.333047782219684, 1.1431564245810055, 1.0628660782910604, 1.2736842105263158, 1.0892448512585813, 1.062554468868016, 1.096056622851365, 1.0211453744493393, 1.054421768707483, 1.0293017456359101, 1.0788263813424726, 1.069591884878509, 1.0, 1.0952380952380953, 1.0119954840530623, 1.028907496012759, 1.189700704225352, 1.2763157894736843, 1.101089595915572, 1.2239092831059004, 1.091422634893838, 1.16, 1.4681818181818183, 1.073900300477809, 1.0, 1.1818181818181819, 1.066341148460514, 1.035252643948296, 1.0074314909428703, 1.4583333333333333, 1.062379421221865, 1.0461984307640135, 1.0637949862424476, 1.0626410835214446, 1.091704437651523, 1.1751412429378532, 1.0666666666666667, 1.1666666666666667, 1.0, 1.3675213675213675, 1.1130736476896388, 1.3414634146341464, 1.2758620689655173, 1.0128521997034108, 1.0031277926720286, 1.0230842038841759, 1.0504383531239596, 1.252195836044242, 1.0731707317073171, 1.1445086705202312, 1.0098167539267016, 1.067034292607272, 1.0076806689689424, 1.0, 1.0977225672877846, 1.1457467551651468, 1.0116961961047766, 1.1489883507050889, 1.0042132258655432, 1.2829083016820402, 1.0357142857142858, 1.006972405817654, 1.0827746260959257, 1.0253807106598984, 1.1098265895953756, 1.062596429358607, 1.0367504835589942, 1.1708661417322834, 2.0, 1.2291606157420853, 1.0585640911121037, 1.0428973277074542, 1.130801687763713, 1.0, 1.6666666666666667, 1.104834596647966, 1.1090909090909091, 1.1012434647449485, 1.5, 1.0, 1.2, 1.065183450429352, 1.0510204081632653, 1.0, 1.1466244725738397, 1.0667808219178083, 1.0016792611251049, 1.0349586728867037, 1.0, 2.0, 1.1032837785043077, 1.0038572806171648, 1.1138353765323994, 1.0039876592440238, 1.0894551893970836, 1.020913216013931, 1.0993640699523053, 1.0834991109624492, 1.0221291866028708, 1.0185447338618348, 1.0826476728478447, 1.1818181818181819, 1.0494415450167662, 1.2506666666666666, 1.2045454545454546, 1.3888888888888888, 1.0114012504597278, 1.0555555555555556, 1.0512820512820513, 1.1427898526344122, 1.0947075208913648, 1.3157894736842106, 1.020096324581772, 1.00503355704698, 1.0143254860313111, 1.065922754548591, 1.25, 1.0225222711971582, 2.5, 1.0279245183841887, 1.0215982721382288, 1.03251103727641, 1.0810810810810811, 2.0, 1.434782608695652, 1.0597014925373134, 1.058251990174518, 1.0, 1.0779816513761469, 1.0950226244343892, 1.0080128205128205, 1.0151131452999396, 1.0988372093023255, 1.150943396226415, 1.0019859005464529, 1.1518607834191488, 1.0548829360894325, 1.0683760683760684, 1.0, 1.1085918854415275, 1.2608695652173914, 1.1342756183745584, 1.059351305812974, 1.0145954962468724, 1.21160409556314, 1.372093023255814, 1.008230452674897, 1.0297555791710946, 1.2857142857142858, 1.0096292692720519, 1.0419847328244274, 1.0526315789473684, 1.094297285464098, 1.0476190476190477, 1.4, 1.024894862528794, 2.0, 1.196159122085048, 1.0188953488372092, 1.0894175553732568, 1.1099916036943744, 1.04177545691906, 1.0963855421686748, 1.0914514536181497, 1.0793229635760246, 1.0280112044817926, 1.0460518415590208, 1.059873175047928, 2.0, 1.125, 1.0526863045316392, 1.25, 1.067966573816156, 1.3529411764705883, 1.0, 1.4666666666666666, 1.3273092369477912, 1.0760456273764258, 1.2169811320754718, 1.0151515151515151, 1.0, 1.1438082556591211, 1.0705713230639375, 2.0, 1.1590232281119714, 1.0, 1.0910802398846124, 1.0987654320987654, 1.0314775218556311, 1.1451612903225807, 1.1363636363636365, 1.1763527054108216, 1.1203703703703705, 1.0266535190800643, 1.027207200110286, 1.0698005698005697, 1.0, 1.0769230769230769, 1.5714285714285714, 3.0, 1.2307692307692308, 1.0693493737911357, 1.3333333333333333, 1.0515806988352745, 1.2317073170731707, 1.1907491778052681, 1.118356919267223, 1.2451081359423275, 1.003233869152679, 1.0087006960556844, 1.0357142857142858, 1.5, 1.3597733711048159, 1.0085106382978724, 1.0588549762721344, 1.0952380952380953, 1.5714285714285714, 1.0539906103286385, 1.0147492625368733, 1.040897993843541, 1.0086526576019776, 1.1464387464387464, 1.0041039671682626, 1.0256410256410255, 1.0907770515613653, 1.090042372881356, 1.0961538461538463, 1.0240793201133145, 1.1714285714285715, 1.0509737166773383, 1.0734042055528268, 1.0190378205564248, 1.048780487804878, 1.1935483870967742, 1.088145896656535, 1.0, 1.0464789287638472, 1.0610357985367498, 1.0547655283934176, 1.0658087055719938, 1.0681237871514657, 1.148395297108357, 1.8333333333333333, 1.1886467889908257, 1.2, 1.2160546541417592, 1.25, 1.0331383796769233, 1.0391304347826087, 1.1305889939810834, 1.1067193675889329, 1.051476793248945, 3.0, 1.182952182952183, 1.0075011305166155, 1.1311384954938386, 2.0, 1.2380952380952381, 1.238003838771593, 1.256317689530686, 1.0999220320899503, 1.3014553014553014, 1.3125, 1.2010353753235548, 1.0182064645803632, 1.0445648783530879, 1.1063757278339272, 1.0054824561403508, 1.1890547263681592, 1.3636363636363635, 2.142857142857143, 1.1098591549295775, 1.4444444444444444, 1.2319327731092438, 1.2424242424242424, 1.0989719017491626, 1.9230769230769231, 1.1159694051342397, 1.1141452851913591, 1.0845157310302282, 1.0, 1.163265306122449, 1.12, 1.284436225509796, 1.2078774617067833, 1.0, 1.0616016427104722, 1.1090527741952294, 1.0087028595109822, 1.5, 2.0, 1.0117878192534382, 1.0045004500450045, 1.0065573770491802, 1.1111111111111112, 1.0667558034182771, 1.0974093264248705, 1.4705882352941178, 1.001357773251867, 1.0454545454545454, 1.0459317585301837, 1.019736842105263, 1.3609591922591502, 1.0793011585403631, 1.0, 1.0277777777777777, 1.0914544608001147, 1.033692059927189, 1.052267349518654, 1.0, 1.0889183808891838, 1.0169913352398652, 1.0220010476689365, 2.0, 1.058213716108453, 1.0489771226094793, 1.0383607619159774, 1.0206194574286838, 1.0034119120232812, 1.028002842928216, 1.0101867572156198, 1.146576663452266, 2.0, 1.0873430151429015, 2.466666666666667, 1.0, 1.160621761658031, 1.1346153846153846, 1.0136698562998032, 1.2184265010351967, 1.0496779249574708, 1.008329477093938, 1.0670609546888683, 1.1225483565534966, 1.0579886033958643, 1.197674418604651, 4.0, 1.0236994358420357, 1.0981781376518218, 1.046902235133693, 1.0491219151936007, 1.1057838660578387, 1.2243137254901961, 2.2, 2.4285714285714284, 1.000097385207187, 1.0318763718204405, 1.0042320971154917, 1.113179992698065, 1.069369456228307, 1.027542372881356, 1.0755782074915012, 1.0512405609492987, 1.2114197530864197, 3.0, 1.0, 1.0521472392638036, 1.0600375234521575, 1.0642857142857143, 1.1664355062413314, 1.0411764705882354, 1.2838709677419355, 1.148905109489051, 1.1304347826086956, 1.0964025967686826, 1.2417582417582418, 1.0071961413793638, 2.0, 1.14379622021364, 1.0912698412698412, 1.3689320388349515, 1.09804469273743, 1.1354037267080745, 1.0607966457023061, 1.1841763942931258, 1.1202979515828677, 1.0, 1.297872340425532, 1.2, 1.5, 1.1590909090909092, 1.1028225806451613, 1.0156739811912225, 1.1213592233009708, 1.0661646908042295, 1.054524361948956, 1.0745417065449459, 1.1662833486660533, 1.0410534469403563, 1.1014212645089643, 1.1135135135135135, 1.1009771986970684, 1.0212868892114175, 1.071656050955414, 1.3367052023121386, 1.1343329253365972, 1.0381594283687225, 1.2272504615848374, 1.0820281610348532, 2.0, 1.0614250614250613, 1.07876370887338, 1.4339622641509433, 1.0, 1.3076923076923077, 1.25, 1.2696629213483146, 1.3703703703703705, 1.1666666666666667, 1.019454312574011, 1.118465513814351, 1.0288289919553015, 1.0480974606439364, 1.227027027027027, 1.1061827956989247, 2.0, 1.1578947368421053, 1.037037037037037, 1.0718915185804978, 1.0847952454187628, 1.0149789269848501, 1.0176491994177583, 1.187012987012987, 1.1370950666948973, 1.1225577264653641, 1.0138101137771514, 1.087718142284305, 1.2727272727272727, 1.0646186440677967, 1.0, 1.2422535211267605, 1.2086364944300572, 3.0, 1.1552048987282149, 1.0837275750620639, 1.4285714285714286, 1.012030623405031, 1.1, 1.1176470588235294, 1.0461274023145197, 1.6923076923076923, 1.0414415720967332, 1.0529688167449809, 1.3571428571428572, 1.1153846153846154, 1.0804123711340206, 1.003347680535629, 1.0701986754966888, 1.0547118256338566, 1.156088408914108, 1.0, 1.0558331522919835, 1.1067073170731707, 2.0, 1.0041285144267362, 1.1425123280560603, 1.1229895931882687, 1.0061320003820562, 1.0016929191815105, 1.0265486725663717, 1.8571428571428572, 1.0309803921568628, 1.0419354838709678, 1.1070198360850458, 1.2628475147430498, 1.002884226345298, 1.04761838420708, 1.2362637362637363, 1.094908350305499, 1.2173913043478262, 1.0602349943374858, 1.0889589905362775, 1.0009057971014492, 1.1323529411764706, 1.0396715454860288, 3.0, 1.1488983599644584, 1.080708576830526, 1.022851708370721, 1.4615384615384615, 1.3103735592278851, 1.3686868686868687, 1.1428571428571428, 1.071242152782676, 1.0420575865415722, 1.1528384279475983, 1.0303030303030303, 1.3333333333333333, 1.0420372097659616, 1.5, 1.0467289719626167, 1.0833333333333333, 1.0124695326574586, 1.3846153846153846, 1.1687763713080168, 1.0555555555555556, 1.0, 1.5555555555555556, 1.2646815550041357, 1.25, 2.0, 1.1367521367521367, 1.2206896551724138, 1.006242568370987, 1.2124681933842238, 1.128747795414462, 1.1946902654867257, 1.1014466214978942, 1.0597402597402596, 1.0888888888888888, 1.3918367346938776, 1.0769230769230769, 1.0, 1.1231638418079095, 1.0692640692640694, 1.0537190082644627, 1.0245196900541345, 1.071366492637634, 1.0319221577330147, 1.0905419025879703, 1.1137218045112782, 1.1321525885558583, 1.0108564535585043, 1.5714285714285714, 1.0, 1.2142857142857142, 1.0225468619564393, 1.1094439541041483, 1.107843137254902, 1.1502463054187193, 1.0361970217640322, 1.06476931185277, 1.0089723478207375, 1.1142857142857143, 1.2222222222222223, 1.0312977099236642, 1.0026581605528975, 1.057133608481023, 1.0548777937342275, 1.0482758620689656, 1.0279090372120496, 1.0087237075567552, 1.12051649928264, 1.3431771894093687, 1.0, 1.0537583254043768, 1.1777188328912467, 1.1063829787234043, 1.060693641618497, 1.0701001430615165, 1.0, 1.028169014084507, 1.0493500322438312, 1.0185185185185186, 1.0576345934930225, 1.0021231422505308, 1.1944444444444444, 1.045777056990092, 1.0350396539293438, 1.075409615901155, 1.0515267175572518, 1.018161180476731, 1.1990809568860656, 1.1666666666666667, 1.1428571428571428, 1.0, 1.25, 1.0654474990916798, 1.3333333333333333, 1.0767927177649737, 1.1030100694631415, 1.0788657509968986, 1.0524329692154915, 1.0592601893473292, 1.1753483386923902, 1.021505376344086, 1.044382801664355, 1.0122384765303967, 1.109111361079865, 1.0403648495668782, 1.208870287847766, 1.4285714285714286, 1.015625, 1.0355731225296443, 1.0951679434295816, 1.1107491856677525, 1.3123962368566686, 1.0521415270018621, 2.211206896551724, 1.021718849124902, 1.0281879194630872, 1.0738755980861243, 1.1875, 1.0447779634292707, 1.0221445763765804, 1.2115568290353391, 1.0581052631578947, 1.3333333333333333, 1.12124849939976, 1.0634920634920635, 1.625, 1.0846111619396157, 1.7692307692307692, 1.2767052767052767, 1.0990338164251208, 1.021577882670263, 1.0260884588804422, 1.0047281323877069, 2.75, 1.0821256038647342, 1.0929813596088092, 1.0657980998944385, 1.015104066144105, 1.001290934047977, 1.0811413009840936, 1.0769230769230769, 1.0866209262435678, 1.067347789824854, 1.0120764319835707, 1.0430861723446894, 1.0, 1.0049594229035166, 1.0177619893428065, 1.3825301204819278, 1.0417310383685636, 1.0, 1.3333333333333333, 1.080862320452916, 1.033347403967919, 1.227765726681128, 1.0751737559077008, 1.097366320830008, 1.0922330097087378, 1.1056470611428177, 1.0743405275779376, 1.0900735294117647, 1.1077844311377245, 1.0265995686556435, 1.0738354685122466, 1.0952380952380953, 1.75, 1.0451691682605548, 1.1733571602631794, 1.0162224797219004, 1.0113636363636365, 1.1893555394641564, 1.0268392642942823, 1.1796457689063817, 1.25, 1.3076923076923077, 1.004739336492891, 1.1020881670533642, 1.15625, 1.5925925925925926, 1.0615040786680077, 1.1833498513379583, 1.1650082918739635, 1.024390243902439, 1.0222222222222221, 1.0941221667306953, 1.068574297188755, 1.1943949296890473, 1.3333333333333333, 1.0769230769230769, 1.3333333333333333, 1.1340996168582376, 1.3461538461538463, 1.3333333333333333, 1.1538461538461537, 1.005298013245033, 1.0298507462686568, 1.0340923252211995, 1.0470386180217435, 1.430909090909091, 1.3076923076923077, 1.0666666666666667, 1.064516129032258, 1.054054054054054, 1.1285714285714286, 1.1403197158081706, 1.0250433936905237, 1.0309636006085117, 1.3195876288659794, 1.0730186085636322, 1.0469746258945998, 2.5, 1.0709570957095709, 1.2027491408934707, 3.0, 2.0, 1.1547337278106509, 1.1162590547228, 1.069438960708145, 1.204968944099379, 1.0, 1.1466666666666667, 1.4938650306748467, 3.0, 2.0, 1.0091043307086613, 1.2485549132947977, 1.0008746719980008, 1.6666666666666667, 1.016025199264461, 1.0495739736638265, 1.0, 1.0, 1.0093896713615023, 1.0278892996579483, 1.25, 1.2129593046226788, 1.0163689610364424, 1.239067055393586, 1.1171875, 1.0731707317073171, 1.0635785649409628, 1.0661157024793388, 1.3269230769230769, 1.0315306817156498, 1.6069182389937107, 1.0381947240661276, 1.2994011976047903, 1.2352941176470589, 1.2835820895522387, 1.1016483516483517, 1.0693568726355611, 1.0312609366958312, 1.054838091588427, 1.0611353711790392, 1.5, 1.6666666666666667, 1.097839289138912, 1.1983289357959543, 1.1600855864617778, 1.0137209901694875, 1.0568656966047834, 1.109096276304137, 1.2422535211267605, 1.0434782608695652, 1.1998270576212562, 1.1045386369706807, 1.2607726597325408, 1.1284584980237153, 2.5, 1.0273972602739727, 1.0170130209304928, 1.1481481481481481, 1.0241233325345476, 1.0999315655887525, 1.0248579545454546, 2.0, 1.0620347394540943, 1.0722233389696232, 1.1798035183915925, 1.0570342205323193, 1.0868735993896914, 1.085987261146497, 1.239514348785872, 1.0214492753623188, 1.0324685457560814, 1.067935011364593, 1.0610599078341014, 1.0525606469002695, 1.0, 1.1687637307769123, 1.053684066185209, 1.0145310435931307, 1.075897189965631, 1.0818783865141481, 1.027231467473525, 1.2857142857142858, 1.2202072538860103, 1.6666666666666667, 2.0, 1.1764705882352942, 1.0051413881748072, 1.0221169036334914, 1.0080104810031818, 1.004519715756279, 1.011251372118551, 1.0673640167364016, 1.201086956521739, 1.1136363636363635, 1.0689198005008522, 1.6, 1.5833333333333333, 1.2903902643726395, 1.0, 1.037292817679558, 1.1206896551724137, 1.051194231635872, 1.1086494294849945, 2.0, 1.0362528071863972, 1.2034883720930232, 1.0659223817118555, 1.039602007394699, 1.1755050505050506, 1.1342465753424658, 1.1505096897053881, 1.1338457784285016, 1.0190779014308426, 1.1833333333333333, 1.100558659217877, 1.0, 1.0, 1.0418842316083117, 5.0, 1.5714285714285714, 2.25, 1.03625, 1.0681818181818181, 1.0864745011086474, 1.1184778344448802, 1.1666666666666667, 1.1129733085040348, 1.028621495327103, 1.1435897435897435, 1.2668269230769231, 1.4285714285714286, 1.0577507598784195, 1.187361419068736, 1.1469933184855234, 1.097433990330978, 1.008205776632112, 1.1672594142259414, 1.1623779946761312, 1.0, 1.248889452976266, 1.0285549170411337, 1.0558195839311335, 1.1774193548387097, 1.044051979328684]
origin-bjaq_15.71 	max: 5.0000	99th: 2.7525	95th: 1.7510	median: 1.0821	mean: 1.1795

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 14.069536 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[3.5762787e-07 1.7881393e-07 4.1723251e-07 2.9802322e-07 2.3841858e-07]
Distance score: 2.980232238769531e-07
SAUCE Drift detection: False
Detection latency: 0.0232s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.043104 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 3.0000	95th: 1.7143	median: 1.0847	mean: 1.1845
ReportEsts: [1.0576923076923077, 1.0155675675675675, 1.0142625685874154, 1.156537753222836, 1.4583333333333333, 1.0, 1.101338971106413, 1.0478039405634287, 1.1666666666666667, 1.0186813186813186, 1.1801348422826872, 1.0424441647726206, 1.0353627415238789, 1.0733590733590734, 1.0831138425519462, 1.2727272727272727, 1.1528662420382165, 3.3333333333333335, 1.2727272727272727, 1.0625, 1.0289839797639122, 1.0037842208980066, 1.1312089971883785, 1.0024752475247525, 1.0025329192762096, 1.0340309662094638, 4.0, 1.1595693347005247, 2.25, 1.0, 1.0622929092113982, 1.0, 1.0365805996807644, 1.0094689784576896, 1.063425925925926, 1.0443899448191294, 1.2348471646160817, 1.1176470588235294, 1.0985915492957747, 1.2916666666666667, 1.0721149083704804, 1.0080791584610211, 1.2346521145975444, 1.006521589894968, 1.0091074681238617, 1.0436506625251958, 1.2272727272727273, 1.0527182866556837, 1.7333333333333334, 1.0013413816230718, 1.0317460317460319, 1.2274678111587982, 1.0493827160493827, 1.121212121212121, 1.0549605446971317, 1.0288081419799815, 1.0886460230722526, 1.16580310880829, 1.0309278350515463, 1.0538179988104497, 1.34375, 1.1490777242836008, 1.052160953800298, 1.0492424242424243, 1.0096153846153846, 2.0, 1.1331567068982435, 1.3050802842853382, 1.4, 1.0, 1.1712392829306313, 1.054582904222451, 1.0705252918287937, 1.0230326295585412, 1.062293963851313, 1.0776397515527951, 1.0059245400685999, 1.1472081218274113, 1.4563106796116505, 1.114261176234114, 1.0004847309743092, 1.1333333333333333, 1.0, 1.3333333333333333, 1.0534521158129175, 1.1016949152542372, 1.1971326164874552, 1.3636363636363635, 1.1818181818181819, 1.0791844324047062, 1.1116125150421179, 1.4463565990659586, 1.0811545165590075, 1.0734415826801045, 1.1028277634961439, 1.0188902007083824, 1.0038461538461538, 1.1996879875195008, 1.4285714285714286, 1.2896497441951988, 1.1379310344827587, 2.0, 1.0589598922733394, 1.2613438045375218, 1.1079342387419586, 1.237449068684517, 1.2258064516129032, 1.0079170593779454, 1.0094009619588982, 1.2532026480956067, 1.140809968847352, 1.041134389371487, 1.125, 1.3333333333333333, 1.0580392156862746, 1.0609417030222201, 1.0538666666666667, 1.1122448979591837, 1.057729659548403, 1.0, 1.073774765380605, 1.1713483146067416, 1.5, 1.0422535211267605, 1.125, 1.2474012474012475, 1.0271852386777298, 1.11012987012987, 1.0307692307692307, 1.6666666666666667, 1.2554539057002112, 1.0, 1.5, 1.1267852206763107, 1.25, 1.188235294117647, 1.0436002864336698, 1.0384172759274304, 2.0, 1.5, 1.0381355932203389, 1.0300618921308577, 1.0815494393476044, 1.0539255976843083, 1.3266666666666667, 1.013215859030837, 1.1031750053203888, 3.0, 1.0151343170639424, 1.0243673851921276, 1.0854072398190044, 1.0703296703296703, 2.0, 1.0721513863590366, 1.0631443298969072, 1.0411663807890223, 1.3116883116883118, 1.0, 1.0522945570971185, 1.1088225794429676, 1.06244011497924, 1.0716723549488054, 1.1010928961748634, 1.3220338983050848, 1.4180327868852458, 1.0397022332506203, 1.4285714285714286, 1.081092309864268, 1.1304347826086956, 1.022167487684729, 1.312220159440865, 1.0480392156862746, 1.0643868219967432, 1.2146596858638743, 1.140625, 1.0731628095818109, 1.2227272727272727, 1.0327272727272727, 1.0898598516075846, 1.0440333507034913, 1.1237906731534064, 1.2007159294298133, 1.147239263803681, 1.1538461538461537, 1.016078491095451, 1.094115538027159, 1.3020833333333333, 1.4105448930068387, 1.0291970802919708, 2.0, 1.28125, 1.0739383811115397, 1.3043478260869565, 1.1427125506072875, 1.014434796462997, 1.063641162215984, 1.074896425374222, 1.0038277511961722, 1.00546069700582, 1.1948671942584346, 1.0205338809034907, 1.0820262885836656, 1.0449464922711058, 1.0506281900274834, 1.0818053596614952, 1.133638122032706, 1.0146341463414634, 1.1515151515151516, 1.2048192771084338, 2.0, 1.3724137931034484, 1.130391899000526, 1.3524096385542168, 1.3578947368421053, 1.0, 1.0, 1.0452264926327315, 1.0090702947845804, 1.2132744770540047, 1.0, 1.0662721893491125, 1.0043149946062568, 1.0187006460875807, 1.0044348224163584, 2.0, 1.1516064257028114, 1.1668583634571148, 1.0025250726767714, 1.0555555555555556, 1.022530329289428, 1.1619897959183674, 1.096597914098164, 1.3333333333333333, 1.0054466690083128, 1.0531688682713023, 1.1269349845201238, 1.092557251908397, 1.0089786756453423, 1.6666666666666667, 1.1391752577319587, 1.0, 1.2569873856047489, 1.1197654941373534, 1.1835059605237443, 1.0902777777777777, 1.0714285714285714, 1.25, 1.1968515478424016, 1.1746031746031746, 1.0614694781054006, 2.0, 1.1823255813953488, 1.0267489711934157, 1.0, 1.001946941876662, 1.0702576112412179, 1.1517857142857142, 1.1139240506329113, 1.0049122807017543, 1.0728391274159952, 1.0298507462686568, 2.0, 1.093120008217982, 1.0404610540074861, 1.0930232558139534, 1.0471505611426906, 1.1088748502853385, 1.0247406225059856, 1.1128924515698062, 1.0892372670078752, 1.0143280632411067, 1.0409984324128783, 1.0450394993331282, 1.3333333333333333, 1.0143089265766223, 1.2057522123893805, 1.1886792452830188, 1.6666666666666667, 1.0505359877488514, 1.0868347338935573, 1.0097526661340188, 1.0006328446366417, 1.1374407582938388, 1.3688699360341152, 1.024007276739782, 1.0156583629893239, 1.1161752988047808, 1.0524768984276027, 1.3, 1.2153846153846153, 1.0632218844984802, 1.0732180941553322, 1.0845263810050065, 1.1002116760176581, 1.189060010621349, 1.1759514616657474, 1.0548405548405548, 1.0815078960774325, 1.122715404699739, 1.014654357006781, 1.000914913083257, 1.3043478260869565, 1.1538461538461537, 1.0695910780669144, 1.75, 1.0342960288808665, 1.0613100615316435, 1.1242659149635894, 1.3333333333333333, 1.0932203389830508, 1.0144628099173554, 1.0438171111880845, 1.0339370895607587, 1.1304347826086956, 1.2031764705882353, 1.0286419986049662, 1.0688836104513064, 1.4444444444444444, 3.4285714285714284, 1.0004320587599913, 1.4285714285714286, 1.0118918605101213, 1.0316455696202531, 1.0952380952380953, 1.0890041020966272, 1.0689655172413792, 1.3333333333333333, 1.0107595806052836, 2.0, 1.0919540229885059, 1.005966587112172, 1.0715054728153597, 1.0202185792349727, 1.0227272727272727, 1.1145833333333333, 1.0965160128327798, 1.1213867365619363, 1.8571428571428572, 1.0391603232145517, 1.0202836219923284, 3.0, 1.1111111111111112, 1.0614481557942406, 1.0, 1.058193668528864, 1.4210526315789473, 3.0, 1.4444444444444444, 1.2939719240297276, 1.0608424336973479, 1.2439024390243902, 1.0013568521031209, 1.3376623376623376, 1.5, 1.0339555693777875, 1.5, 1.2222222222222223, 1.0126280513719876, 1.1485943775100402, 1.035661218424963, 1.0065727699530516, 1.4, 1.25, 1.3791348600508906, 1.3395061728395061, 1.0447609359104781, 1.1298556896143837, 1.2431690580162196, 1.0431472081218274, 1.5, 1.0277217404467267, 1.04, 1.25, 1.3333333333333333, 1.1572327044025157, 1.0, 1.0476190476190477, 1.2156862745098038, 1.1347864662014724, 1.123536031947722, 1.0011454753722795, 1.05513839408057, 1.109860664523044, 1.056338028169014, 1.1022222222222222, 1.0779014007088839, 1.1140939597315436, 1.0571428571428572, 1.0146487463826612, 1.0424416285122633, 1.0666342412451362, 1.0194174757281553, 1.0681818181818181, 1.1234817813765183, 2.0, 1.0666666666666667, 1.6746987951807228, 1.1539961013645224, 1.1843575418994414, 1.1176470588235294, 1.0636023516835917, 1.1188992731048806, 1.0214277124733186, 1.0647372429550648, 1.014881915237787, 1.1226415094339623, 1.25, 1.1122448979591837, 1.0, 1.0890433655623384, 1.54, 1.1051539390280711, 1.0210409019402202, 1.0408805031446542, 1.1543193367210485, 1.7142857142857142, 1.0175438596491229, 1.1666666666666667, 1.0156, 1.1818181818181819, 1.0901487763024174, 1.0246305418719213, 1.103770197486535, 1.080906148867314, 1.0689905591866375, 4.0, 1.1289611463213007, 1.0164798335837282, 1.140876977422823, 2.0, 1.0256410256410255, 1.2919354838709678, 1.2477064220183487, 1.1042805569881382, 1.1438088594349494, 1.2083333333333333, 1.072, 1.051541772990241, 1.0783007150290376, 1.067666773060964, 1.039905695495719, 1.2835682205358525, 1.0769230769230769, 1.0196616369455875, 1.123266548516616, 1.0076923076923077, 1.011557512383049, 1.0, 1.5, 1.1597938144329898, 1.0303030303030303, 1.0743169398907104, 1.1030364575139093, 1.0741308793456033, 1.0, 1.2280701754385965, 1.2142857142857142, 1.074738889464731, 1.173913043478261, 2.0, 1.0119411073977058, 1.3333333333333333, 1.0, 1.0115830115830116, 2.6666666666666665, 1.010971281058406, 1.0045011252813203, 1.0140449438202248, 1.0909090909090908, 1.0626515527768852, 1.073728813559322, 1.65, 1.0155272670124156, 1.0454545454545454, 1.086283185840708, 1.0486301369863014, 1.2548611111111112, 1.033643204957946, 2.0, 1.0119047619047619, 1.1030716723549487, 1.06310448707785, 1.0415335463258786, 1.5, 1.0808361080281168, 1.0109900930520073, 1.0272049144361561, 2.0, 1.0507051712558764, 1.0423213354732528, 1.028801645808332, 1.014763779527559, 1.0129227425584093, 1.0196220744067694, 1.0573476702508962, 1.0122343543100267, 2.3333333333333335, 1.0813492063492063, 1.060674157303371, 1.0605402797877472, 1.0903190914007572, 1.0857142857142856, 1.0001909921172345, 1.0916271721958926, 1.0675700421168284, 1.1216628527841344, 1.0966489285200633, 1.1831160769708255, 1.095297430657662, 1.082501512401694, 1.0340909090909092, 1.728813559322034, 1.0654680043349578, 1.0849673202614378, 1.006588136084539, 1.065313067603441, 1.0, 1.1804339550818423, 1.22, 1.0869565217391304, 1.3043478260869565, 1.015629169366828, 1.0964285714285715, 1.1651455888744024, 1.0, 1.3333333333333333, 1.0029505220154336, 1.1096785167545502, 1.056345937850992, 1.0509222644590148, 1.1113716295427902, 1.0329985652797704, 1.0368663594470047, 1.002847957251281, 1.5602409638554218, 1.0264504258308942, 1.0172612197928654, 1.048780487804878, 1.0589452299792486, 1.3907793633369923, 1.0334500039774084, 2.0, 1.2178289000718907, 1.114864864864865, 1.236842105263158, 1.1050228310502284, 1.038022813688213, 1.0555555555555556, 1.0359408033826638, 1.0719692546155235, 1.0, 1.1818181818181819, 1.6, 1.3333333333333333, 1.1226415094339623, 1.0213740458015268, 1.0199203187250996, 1.1228813559322033, 1.0568933580312252, 1.1011355571327182, 1.0961115992970123, 1.1801841085271318, 1.0257590475760177, 1.0896720598073537, 1.0186505795186134, 1.0748010610079575, 1.0393258426966292, 1.0553601815087919, 1.0340632603406326, 1.0774193548387097, 1.1034912718204488, 1.2094594594594594, 1.1187001048302556, 1.1931279620853081, 1.096480915432244, 1.25, 1.299186213499282, 1.0245499181669395, 1.3333333333333333, 1.009512485136742, 1.0555555555555556, 1.4285714285714286, 1.3201581027667983, 1.0499285725498815, 1.033745781777278, 1.0104166666666667, 1.0154639175257731, 1.0939634927412467, 1.0290088638195003, 1.1021505376344085, 1.2, 3.0, 1.0058918050348151, 1.179245283018868, 1.1230398069963812, 1.120592383638928, 1.0, 1.0813131313131312, 1.1870967741935483, 1.1285058196606366, 1.1376701966717095, 1.0468582006525744, 1.098202585300351, 1.0203985104853988, 1.4021739130434783, 2.0, 1.1246619380517426, 1.0, 1.0341176470588236, 1.1991525423728813, 1.3125894134477825, 1.2528735632183907, 1.875, 1.0264191710862307, 1.1357142857142857, 1.1000685400959562, 1.1005182527478785, 1.2301173402868317, 1.1722745625841184, 1.0855169612025188, 1.0045126353790614, 1.0489583333333334, 1.1666666666666667, 1.091318794637742, 1.0364207431168138, 1.0952380952380953, 1.0172651933701657, 1.20494596436569, 1.2421875, 1.0011576167565026, 1.3333333333333333, 1.1395348837209303, 1.0698083691826359, 1.3216783216783217, 1.1935483870967742, 1.0553447576019626, 1.037313432835821, 1.6666666666666667, 1.0767132628707807, 1.037292817679558, 1.0533507015730528, 1.1613739468567725, 1.0092026176765938, 1.0624491229874125, 1.1688693098384728, 1.1905290418054013, 1.1910112359550562, 1.0591101549222441, 1.0628930817610063, 1.0402124430955995, 1.0539710399297937, 1.0045458047615379, 1.0789473684210527, 1.0295172863666013, 1.2857142857142858, 1.1428571428571428, 1.1120689655172413, 1.5927189988623436, 1.0376126826235623, 1.361842105263158, 1.1666666666666667, 1.0016012810248198, 1.041560335399198, 1.1369047619047619, 1.0193927266996046, 2.3333333333333335, 1.1337123183474118, 1.0, 1.020912547528517, 1.1333333333333333, 1.0177532013969732, 1.3870967741935485, 1.0659722222222223, 1.088869715271786, 1.0, 1.2607932476844936, 1.2873004857737682, 1.2, 2.0, 1.1870503597122302, 1.2424242424242424, 1.0170526851616188, 1.1975051975051976, 1.1277533039647578, 1.2314814814814814, 1.0829145728643217, 1.1292420814479638, 1.1259541984732824, 1.3229166666666667, 1.0357142857142858, 1.0, 1.2573221757322175, 1.0759193357058126, 1.0214592274678111, 1.0579547417515978, 1.084480501657412, 1.1215371556447258, 1.0838519852700794, 1.1065163662668034, 1.1618497109826589, 1.0386571719226856, 1.5, 1.0, 1.28125, 1.0361816344574966, 1.02020202020202, 1.102981029810298, 1.2049382716049384, 1.0028598665395614, 1.0119380124335526, 1.0067561174572244, 1.1294117647058823, 1.380952380952381, 1.066579634464752, 1.1243726214770282, 1.0657051500102048, 1.0016131348956434, 1.0862068965517242, 1.027906386757151, 1.0035943929204767, 1.1387731298674475, 1.028281363306744, 1.0564127026329577, 1.0943396226415094, 1.0466403162055335, 1.1954022988505748, 1.0442531834838773, 1.2, 1.1166518254674977, 1.0, 1.0057803468208093, 1.002375168690958, 1.032258064516129, 1.091647439467473, 1.0303030303030303, 1.3658536585365855, 1.0061426435741236, 1.0314582457825539, 1.0764845605700712, 1.0299684542586751, 1.0492277992277992, 1.198449046107162, 1.2306306306306307, 1.5, 2.0, 1.375, 1.0675506831647252, 1.4285714285714286, 1.056414762741652, 1.104042739455431, 1.0909928163566034, 1.0489579887528944, 1.112681183846828, 1.0156862745098039, 1.017910447761194, 1.068445475638051, 1.0024495083318612, 1.1170952864847963, 1.0430674457957871, 1.2109941990407072, 1.7142857142857142, 1.0598639455782313, 1.114695340501792, 1.083596646900114, 1.005420054200542, 1.2962962962962963, 1.0733229329173166, 2.2310469314079424, 1.0583947246406678, 1.0478841870824054, 1.0572629733310752, 1.1578947368421053, 1.0684950966465177, 1.0435285095535898, 1.3033375580904099, 1.0616197183098592, 1.4642857142857142, 1.0617876424715056, 1.0427209738544578, 1.0136091623568382, 1.2916666666666667, 1.0172077667620205, 1.5185185185185186, 1.0888276446894212, 1.0056890012642226, 1.0278481012658227, 1.2305825242718447, 1.0145586897179253, 1.0344827586206897, 1.099236641221374, 1.0105238430819825, 1.0814742967992241, 1.041877658497063, 1.0839889573912207, 1.0, 1.0802867383512544, 1.0178310909385637, 1.0500718243381901, 1.0520922288642187, 1.0385835095137421, 1.146268656716418, 1.0532359081419624, 1.0089628681177978, 1.043955151121222, 1.0491803278688525, 1.114773396115362, 1.2314581584102995, 1.0546519193233572, 1.0749574105621806, 1.1030449107754903, 1.1340411413404115, 1.0564784053156147, 1.1370449678800856, 1.09792743134565, 1.0698506659491458, 1.0753012048192772, 1.0228310502283104, 1.0040863981319323, 1.0850241348277836, 1.121212121212121, 1.4, 1.0515537617866904, 1.172614377316631, 1.0339901477832512, 1.0, 1.2324588163514338, 1.0222909373093305, 1.144561403508772, 1.2336500838457238, 1.0, 1.0496333897349126, 1.0, 1.143979057591623, 1.5142857142857142, 1.0918022720294749, 1.187244480784955, 1.0022547914317925, 1.0196078431372548, 1.0571428571428572, 1.1199154780771263, 1.09, 1.3333333333333333, 1.0333745364647713, 1.0364372469635628, 1.001410437235543, 1.0, 1.0143256681168427, 1.0433070866141732, 1.0491232284410281, 1.3153153153153154, 2.0, 1.2041343669250646, 1.0331462255068944, 1.0394276103559514, 1.0452488687782806, 1.4067796610169492, 1.1176470588235294, 1.2058823529411764, 1.1, 1.2179487179487178, 1.2051724137931035, 1.0188214174167751, 1.034563878721931, 1.3478260869565217, 1.0523057471395294, 1.0465270452261726, 3.5, 1.0267623740547847, 1.06591907864828, 1.5, 2.5, 1.1740749937919046, 1.1396361467342677, 1.1119410406284875, 1.3263707571801566, 1.5, 1.1584905660377358, 1.1832460732984293, 1.0129870129870129, 1.0696084043754739, 1.1022635018919849, 1.0432518008925136, 1.0346365239033495, 1.7142857142857142, 1.040860535912569, 1.062254259501966, 1.0204778156996588, 1.2575757575757576, 1.0208333333333333, 1.0, 1.0826446280991735, 1.144849951098986, 1.039475598519261, 1.2727272727272727, 1.0815047021943573, 1.1108433427689797, 1.0985259891388672, 1.0724137931034483, 1.1714285714285715, 1.0220645962902533, 1.4959695817490495, 1.0539185136135238, 1.7457627118644068, 1.1610169491525424, 1.1070175438596492, 1.125, 1.0714285714285714, 1.0076923076923077, 1.0114836240611145, 1.0791628753412192, 1.5, 1.178082191780822, 1.0196777764112654, 1.2377802278574053, 1.0388835108099388, 1.2101359703337453, 1.0395708513306396, 1.120311167945439, 1.4010840108401084, 1.0727272727272728, 1.0640083945435468, 1.1442575232224648, 1.210400478182905, 1.110016420361248, 2.0, 1.0348837209302326, 1.0050619886146748, 1.0574886535552193, 1.0068141986450077, 1.0941949301767322, 1.0141592920353983, 2.75, 1.0683491062039958, 1.0346313203534632, 1.16156462585034, 1.2950819672131149, 1.088906212759196, 1.0952380952380953, 1.2930232558139534, 1.041385948026949, 1.0309003117242796, 1.1708756195421288, 1.053554040895813, 1.0434298440979954, 1.0526315789473684, 1.184502776375568, 1.1486587700074897, 1.0583728023408634, 1.0397260273972602, 1.0919136112506278, 1.0169597989949748, 1.3421052631578947, 1.2904656319290466, 2.3333333333333335, 2.5, 1.1904761904761905, 1.0152173913043478, 1.034937376400791, 1.0154897780007526, 1.0023411693018185, 1.0058048671578477, 1.0036572622779518, 1.1376146788990826, 1.1507191994996873, 1.0314142546779732, 1.5, 1.4, 1.125456760048721, 1.125, 1.057109557109557, 1.1388888888888888, 1.0578990901571548, 1.09160604667514, 2.5, 1.1610651499482938, 1.1625, 1.0641537408759123, 1.0398859745659086, 1.2297872340425533, 1.1097249787354693, 1.1542981175854197, 1.1725063131313131, 1.009433962264151, 1.2686567164179106, 1.0971098265895953, 1.3333333333333333, 3.0, 1.041563927025678, 5.0, 1.5, 1.96875, 1.0121951219512195, 1.1018282066163667, 1.1336661120354965, 1.0637450199203187, 1.0, 1.097530082330589, 1.0164888457807952, 1.0853858784893267, 1.3709677419354838]
origin-bjaq_15.71 	max: 5.0000	99th: 3.0000	95th: 1.7143	median: 1.0847	mean: 1.1845

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.183424 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.323280