Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 5, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.5000	95th: 1.7214	median: 1.0812	mean: 1.1709
ReportEsts: [1.034920634920635, 1.0010416666666666, 1.0423303386716434, 1.04, 1.5789473684210527, 1.0, 1.0824340861052397, 1.0416165963353174, 1.0, 1.0277044854881265, 1.1062822843621043, 1.0427179739166106, 1.0397379912663756, 1.1046511627906976, 1.083362769339456, 1.0, 1.1538461538461537, 1.0584484590860785, 3.0, 2.0, 1.1481481481481481, 1.0925498327128786, 1.0875859572927977, 1.0974750440399295, 1.134188455846078, 1.0, 1.1501669718840892, 2.0, 1.4, 1.0220588235294117, 1.0, 1.0391046480977066, 1.0037881009789786, 1.083795782463929, 1.1013364664414744, 1.2391778523489934, 1.125668449197861, 1.0045761231747952, 1.1775948756801433, 1.0476190476190477, 1.1890243902439024, 1.0823170731707317, 1.0, 1.0497061489430133, 1.1668466522678185, 1.890625, 1.0729166666666667, 1.2579505300353357, 1.0282049196991259, 1.1851851851851851, 1.0663532675709002, 1.1512027491408934, 1.037772192579469, 2.0, 1.1818181818181819, 1.135081361472323, 1.2050832602979842, 1.3658536585365855, 1.018987341772152, 1.25, 1.1061659396583061, 1.0927770859277708, 1.1181818181818182, 1.0344827586206897, 1.0, 1.0379751383200402, 1.3573093573093573, 1.75, 1.0, 1.0791460799850843, 1.006002400960384, 1.059675550405562, 1.0398126463700235, 1.1286141094834232, 1.0870588235294119, 1.08, 1.0, 1.113152400835073, 2.0, 1.0202157881144365, 1.1851851851851851, 1.0595552705198095, 1.1411042944785277, 1.102402022756005, 1.1280667320902846, 1.04, 1.0609569084496242, 1.0297651045927312, 1.0392156862745099, 1.75, 1.1484135107471853, 1.0519848715671338, 1.118380062305296, 1.0701262272089762, 1.0092165898617511, 1.0077922077922077, 1.0887096774193548, 1.1490196078431372, 1.0, 1.2513398838767307, 1.0028880866425993, 1.0445969125214407, 1.223090202848511, 1.4782608695652173, 1.018879248852256, 1.0836209185027874, 1.138670779584969, 1.093287827076223, 1.047516860821582, 1.3333333333333333, 1.6666666666666667, 1.1018691588785046, 1.044762891221476, 1.0574857864813645, 1.051948051948052, 1.0566706613877788, 1.0, 1.1251970987070326, 1.1821266968325792, 1.0, 1.010989010989011, 1.1666666666666667, 1.1528822055137844, 1.0292635131072099, 1.061194377572416, 1.0980392156862746, 1.8, 1.1324503311258278, 1.0, 1.0769230769230769, 1.1087403257302348, 1.3, 1.08837890625, 1.0353520445653062, 1.078423919929051, 1.041388518024032, 1.0993975903614457, 1.0506625097427904, 1.039972432804962, 1.0822669104204754, 1.01893515641185, 1.3064516129032258, 1.0391389432485323, 1.1212958342967714, 2.0, 1.01640838650866, 1.0, 1.104109589041096, 1.12687488971237, 1.5, 1.188060062969242, 1.0336906584992342, 1.0080645161290323, 1.1074561403508771, 1.0058737151248165, 1.0222521915037086, 1.1133260593907581, 1.0685617923391955, 1.0800821355236139, 1.0789473684210527, 1.2653061224489797, 1.2432432432432432, 1.01620029455081, 1.5714285714285714, 1.0647146595985069, 1.0285858069828973, 1.1199226305609284, 1.3336825064279592, 1.11740614334471, 1.1018260846518777, 1.2, 1.1018518518518519, 1.040573254575385, 1.0111223458038423, 1.012079378774806, 1.064139941690962, 1.0672268907563025, 1.1180802217794334, 1.0121454267613257, 1.0, 1.0, 1.0158058142816822, 1.0285087719298245, 1.149479055921752, 1.1973684210526316, 1.1002949118375371, 1.3503747837785893, 1.085319135121096, 1.1372549019607843, 1.298181818181818, 1.0532895293080333, 1.0, 1.2727272727272727, 1.0293677826701004, 1.0652962515114872, 1.0432900432900434, 1.25, 1.0546623794212218, 1.0385218146410642, 1.0561447197735085, 1.0626410835214446, 1.1916306524718034, 1.344632768361582, 1.0158730158730158, 1.2173913043478262, 1.0, 1.3559322033898304, 1.1677180255480208, 1.2961672473867596, 1.1954022988505748, 1.0113692535837864, 1.0031277926720286, 1.038446484486194, 1.0531017645100433, 1.1612489629685496, 1.0795454545454546, 1.0251851851851852, 1.008101101749838, 1.0254322476879776, 1.005478761203952, 1.0, 1.0546583850931677, 1.1129537352529888, 1.0052722662695697, 1.145476772616137, 1.0014853807265336, 1.2777777777777777, 1.0357142857142858, 1.0029341538875438, 1.0313305827746262, 1.0360970107163001, 1.2229299363057324, 1.0607260726072607, 1.0073500967117988, 1.0929133858267717, 2.0, 1.2617769827072152, 1.1513510495757033, 1.1744022503516174, 1.112033195020747, 1.0, 1.6666666666666667, 1.043456850917149, 1.1090909090909091, 1.0682612569392091, 1.5, 1.0, 1.0810810810810811, 1.1483216237314597, 1.0208333333333333, 1.0055248618784531, 1.1170886075949367, 1.0577249575551784, 1.0008396305625524, 1.0807572443429279, 1.0363636363636364, 2.0, 1.0825262681718175, 1.0580036297640654, 1.0788091068301227, 1.0654723331312583, 1.1542565666041276, 1.03470395574185, 1.0890302066772655, 1.0860341883351232, 1.020334928229665, 1.0391392258809937, 1.017875, 1.1, 1.0296725995374092, 1.1247002398081534, 1.2045454545454546, 1.4705882352941178, 1.0117733627667402, 1.0555555555555556, 1.0256410256410255, 1.1055245272861853, 1.064066852367688, 1.3508771929824561, 1.041218866117486, 1.1476510067114094, 1.0275655623924547, 1.0572109721209402, 1.25, 1.0352673699527102, 2.5, 1.0253620331677573, 1.043196544276458, 1.0432934322516043, 1.0810810810810811, 2.0, 1.3478260869565217, 1.056338028169014, 1.0532065353035664, 1.0, 1.0364500792393028, 1.0339366515837105, 1.0080128205128205, 1.0185167975465823, 1.08, 1.1383647798742138, 1.0155261215018985, 1.057124057901663, 1.106411220742445, 1.1111111111111112, 1.0, 1.0799522673031026, 1.26875, 1.1030927835051547, 1.0916175231676495, 1.0100083402835696, 1.0441176470588236, 1.3111111111111111, 1.0027510316368637, 1.0208058993942586, 1.2857142857142858, 1.0039467420182133, 1.0340909090909092, 1.1176470588235294, 1.0813266199649738, 1.1904761904761905, 1.2727272727272727, 1.0101988630359897, 2.0, 1.1700960219478738, 1.059593023255814, 1.051681706316653, 1.1652710445130012, 1.0911680911680912, 1.1973684210526316, 1.1062649657057049, 1.0712900529847538, 1.0096286107290233, 1.0399594095626294, 1.0343239548103906, 2.0, 1.0, 1.0466418336799288, 1.25, 1.0697544642857142, 1.3529411764705883, 1.0, 1.4666666666666666, 1.3795180722891567, 1.0599250936329587, 1.131578947368421, 1.0010834236186348, 1.0, 1.162450066577896, 1.0913918859870257, 2.0, 1.3365098272781417, 1.0, 1.0942078493889016, 1.0229885057471264, 1.0117816845972185, 1.140552995391705, 1.1363636363636365, 1.2583065380493033, 1.1111111111111112, 1.0234877186218758, 1.015744888023369, 1.1293233082706766, 1.0, 1.0769230769230769, 1.5714285714285714, 1.5, 1.0666666666666667, 1.0688142262684153, 1.3333333333333333, 1.0947176684881603, 1.216867469879518, 1.0585253332618083, 1.0724668009451812, 1.259526261585994, 1.005313370802437, 1.0104408352668213, 1.0011904761904762, 1.5, 1.0762331838565022, 1.0425531914893618, 1.0480245190018194, 1.0, 1.5714285714285714, 1.032183908045977, 1.0070257611241218, 1.02663344465499, 1.0149253731343284, 1.1464387464387464, 1.0183310533515733, 1.0256410256410255, 1.0907770515613653, 1.0709745762711864, 1.1153846153846154, 1.0240793201133145, 1.1181818181818182, 1.074208274805261, 1.0826663678346673, 1.031500942446229, 1.069767441860465, 1.0571428571428572, 1.098159509202454, 1.0, 1.019262520638415, 1.0455828552757735, 1.0458864863590276, 1.0642995496298409, 1.0655119714722363, 1.1433110899269145, 1.8333333333333333, 1.052818689690198, 1.2, 1.2049530315969257, 1.25, 1.0411090623197095, 1.027536231884058, 1.1324161650902838, 1.0869565217391304, 1.0473515248796148, 3.0, 1.2781729689254961, 1.0099265539145723, 1.0360952731285635, 2.0, 1.0, 1.276391554702495, 1.1153846153846154, 1.1018210219098121, 1.0623700623700623, 1.05, 1.184641932700604, 1.0298209300086647, 1.060777636997149, 1.1003437757226553, 1.1645833333333333, 1.1227197346600333, 1.0871212121212122, 1.875, 1.1067415730337078, 1.5, 1.2267782426778242, 1.0303030303030303, 1.1484722526070152, 2.5, 1.0538659492338285, 1.1745862620082834, 1.0740283775447255, 1.0, 1.1067961165048543, 1.16, 1.284757286407039, 1.3194748358862145, 1.0, 1.0360721442885772, 1.0796086463042693, 1.0576046415250726, 1.5, 2.0, 1.0151456310679612, 1.0045004500450045, 1.0360655737704918, 1.2222222222222223, 1.077350863945276, 1.0883864337101747, 1.4705882352941178, 1.0228454752089995, 1.0454545454545454, 1.1220472440944882, 1.0064516129032257, 1.326882625157762, 1.0649183935448376, 1.0, 1.0277777777777777, 1.0733859321616006, 1.0465821043474743, 1.011709506985187, 1.0, 1.1070559610705597, 1.0075287211024175, 1.0220010476689365, 2.0, 1.0534290271132376, 1.0102134236965699, 1.0188673585698003, 1.0252064130007426, 1.0109233650118246, 1.013219616204691, 1.0663082437275986, 1.18900675024108, 2.0, 1.0652230089410306, 1.7209302325581395, 1.25, 1.1243523316062176, 1.1346153846153846, 1.0085519954656086, 1.1618953603158935, 1.0740963740275626, 1.0435823754789273, 1.0428650150660679, 1.0413905045313134, 1.0672295618202203, 1.197674418604651, 4.0, 1.001375072720192, 1.2265182186234818, 1.0477967791320033, 1.024702429479863, 1.0659563673262304, 1.0878048780487806, 2.2717391304347827, 2.4285714285714284, 1.0125018259726348, 1.0931779439127383, 1.0230490554877822, 1.1201322556943425, 1.1151417277284998, 1.043010752688172, 1.0776885968125072, 1.0823117338003503, 1.215170278637771, 3.0, 1.2, 1.0567260940032415, 1.0620300751879699, 1.0875912408759123, 1.2170767004341534, 1.0333333333333334, 1.1705882352941177, 1.148905109489051, 1.1097560975609757, 1.0938597612569014, 1.3780487804878048, 1.008619618562465, 2.0, 1.0977917981072556, 1.0120481927710843, 1.4536082474226804, 1.1083798882681564, 1.0946107784431138, 1.0612648221343874, 1.1141374837872893, 1.1285239575517205, 1.0, 1.3829787234042554, 1.0, 1.0, 1.2045454545454546, 1.1391129032258065, 1.0200617283950617, 1.0679611650485437, 1.0645626401794297, 1.0394431554524362, 1.0588149948312446, 1.1654792001838659, 1.0442890442890442, 1.1292642872783007, 1.0571428571428572, 1.1024135681669929, 1.0527334300919207, 1.0523846755277562, 1.0823699421965318, 1.1682949889694296, 1.0119596614807682, 1.2155252845680165, 1.0793489678614845, 2.0, 1.0638820638820639, 1.0798403193612773, 1.4339622641509433, 1.0, 1.1333333333333333, 1.25, 1.2072649572649572, 1.4074074074074074, 1.1666666666666667, 1.0016433456584257, 1.1212960564334535, 1.0295856074911405, 1.026338213649392, 1.1675675675675676, 1.1304945054945055, 1.0, 1.0921985815602837, 1.005966835495733, 1.0656493213270646, 1.0853988263420995, 1.078084064244219, 1.0062972292191437, 1.12987012987013, 1.1520722498712888, 1.1225577264653641, 1.0000336356807302, 1.114629416969446, 1.3333333333333333, 1.0923913043478262, 1.0, 1.2422535211267605, 1.2096309705023245, 3.0, 1.130184331797235, 1.0444193657600722, 1.4285714285714286, 1.0262856297829865, 1.4, 1.0555555555555556, 1.0326921670445404, 1.6153846153846154, 1.0261593125702477, 1.0653566851772747, 1.3571428571428572, 1.0, 1.131958762886598, 1.0047824007651842, 1.013907284768212, 1.1011377583175772, 1.156264779020275, 1.0, 1.019769715402998, 1.149390243902439, 2.0, 1.007841870978158, 1.1087031750151397, 1.1466414380321666, 1.0193511413925944, 1.0688255929629824, 1.036697247706422, 1.5714285714285714, 1.0678310316815598, 1.038709677419355, 1.0887618142636553, 1.2414078674948241, 1.0203390025877621, 1.0139316513186307, 1.141025641025641, 1.1423714407139822, 1.234113712374582, 1.0242168001914551, 1.0977917981072556, 1.0564593301435408, 1.0336590662323561, 1.0729475278161829, 3.0, 1.1447263778641417, 1.0279988963938647, 1.0474461189701942, 1.5833333333333333, 1.284752117761422, 1.456989247311828, 1.1428571428571428, 1.0642237426818086, 1.0420575865415722, 1.1626637554585153, 1.088235294117647, 1.3333333333333333, 1.0752090159719059, 1.5, 1.088785046728972, 1.0833333333333333, 1.0459438747582381, 1.3846153846153846, 1.1518987341772151, 1.0408805031446542, 1.0, 1.6825396825396826, 1.3068376068376069, 1.25, 2.0, 1.1271186440677967, 1.1793103448275861, 1.0092152199762188, 1.1927409261576971, 1.128747795414462, 1.2566371681415929, 1.1014466214978942, 1.0571428571428572, 1.183574879227053, 1.7551020408163265, 1.0769230769230769, 1.0, 1.083969465648855, 1.0851370851370852, 1.0010330578512396, 1.0855921718591834, 1.0826509464958172, 1.050527870704262, 1.088533483532446, 1.0708863504916137, 1.1753889674681754, 1.0072115384615385, 1.5714285714285714, 1.0, 1.2142857142857142, 1.0116035516430144, 1.0547219770520742, 1.107843137254902, 1.0812807881773399, 1.0179570895522387, 1.0236500828506088, 1.0012545174838836, 1.1304347826086956, 1.2222222222222223, 1.0165537998495109, 1.1409729586426298, 1.0691077537524758, 1.0113403560713201, 1.019736842105263, 1.074645599527466, 1.029958599353968, 1.0289855072463767, 1.3574338085539714, 1.125, 1.0736791080950072, 1.793939393939394, 1.1818181818181819, 1.1762820512820513, 1.0701001430615165, 1.0, 1.0092165898617511, 1.0032506388071287, 1.0, 1.0957020832835798, 1.007470651013874, 1.162162162162162, 1.0026603498542275, 1.040843547224225, 1.0856500134300295, 1.0314885496183206, 1.0147559591373438, 1.1949626237457067, 1.2200435729847494, 1.2857142857142858, 1.0, 1.4285714285714286, 1.0702676516894756, 1.3333333333333333, 1.1382434230729859, 1.085940444779495, 1.0633584404076208, 1.0649453823237338, 1.0501043113706863, 1.0479099678456592, 1.021505376344086, 1.0319001386962552, 1.019005799891986, 1.1783605174353207, 1.0417207630080896, 1.2305793086836083, 1.6666666666666667, 1.15625, 1.0553359683794465, 1.1279420430517522, 1.0423452768729642, 1.2774037166711554, 1.0721062618595825, 2.269911504424779, 1.0378617296305563, 1.0604026845637584, 1.0482894736842105, 1.1875, 1.0616866307391806, 1.0370465743077373, 1.3165542293720809, 1.0581052631578947, 1.0, 1.1014150943396226, 1.1754385964912282, 1.6875, 1.0610031145956396, 1.7307692307692308, 1.0333333333333334, 1.0630841121495327, 1.0638450502152081, 1.0067351405960598, 1.0131108462455305, 1.8333333333333333, 1.103448275862069, 1.096327070848193, 1.0504916939829991, 1.015265939895031, 1.0455414121421014, 1.0496604887931256, 1.0833333333333333, 1.0664983164983164, 1.0269583903106076, 1.0243314433680075, 1.0120240480961924, 1.0208333333333333, 1.1253170979198377, 1.006385858073247, 1.3674280039721947, 1.0173778756035217, 1.0, 1.3333333333333333, 1.0434028035303715, 1.0119607005553182, 1.2299697656840514, 1.082457603558521, 1.0734237829209896, 1.1111111111111112, 1.0885353520418724, 1.0977483443708609, 1.1286764705882353, 1.0335195530726258, 1.0251256281407035, 1.1020836401119127, 1.1428571428571428, 1.75, 1.0479095114789976, 1.173643158921027, 1.0068415051311288, 1.0170454545454546, 1.174149167270094, 1.0152411475687582, 1.1807703120607254, 1.2658227848101267, 1.2692307692307692, 1.0384097035040432, 1.1282660332541568, 1.1375, 1.5925925925925926, 1.0775282154430663, 1.1774033696729436, 1.1691542288557213, 1.024390243902439, 1.0193065168689603, 1.044563964656166, 1.0677710843373494, 1.193800752624282, 1.3333333333333333, 1.4, 2.0, 1.1452455590386625, 1.5, 1.0, 1.1538461538461537, 1.0211920529801324, 1.0996376811594204, 1.0725681364945712, 1.061086890398459, 1.3236363636363637, 1.36, 1.1428571428571428, 1.032258064516129, 1.054054054054054, 1.09375, 1.1126516464471403, 1.0317533752524264, 1.0325256947794146, 1.3333333333333333, 1.0709395922666065, 1.047880486462139, 2.5, 1.0671804293831444, 1.3133208255159474, 1.5, 2.0, 1.1505917159763313, 1.1055009682277845, 1.0697387028142638, 1.2732919254658386, 1.0, 1.0403225806451613, 1.343558282208589, 3.0, 1.5, 1.0182911550989726, 1.2263745127033203, 1.0197425965263027, 1.6666666666666667, 1.028702906369234, 1.040278853601859, 1.0667396061269148, 1.0, 1.0093896713615023, 1.0235148812902737, 1.3026315789473684, 1.1428216900359847, 1.0009706664595912, 1.4166666666666667, 1.0625, 1.0829840237480794, 1.090316573556797, 1.140495867768595, 1.1896551724137931, 1.0191694076923707, 1.3127809890815672, 1.1060817767318722, 1.4910179640718564, 1.088235294117647, 1.2985074626865671, 1.1123439667128987, 1.060662914321451, 1.0065201229681127, 1.0938034106150603, 1.1004366812227073, 1.5, 1.6666666666666667, 1.109122291120629, 1.183377308707124, 1.1244893989496207, 1.0127759845853634, 1.1159056698444556, 1.0956963712869225, 1.2352941176470589, 1.0, 1.0907947488404999, 1.096063364220994, 1.220863309352518, 1.1465863453815262, 1.6666666666666667, 1.0416666666666667, 1.0910582772974704, 1.1180870959123697, 1.017055370458512, 1.0751754913333955, 1.0355113636363635, 2.0, 1.07, 1.014862732370091, 1.1615261594699566, 1.0114068441064639, 1.081646640919277, 1.105095541401274, 1.0507726269315674, 1.017391304347826, 1.031525009163192, 1.0566966916407106, 1.023041474654378, 1.0554054054054054, 1.0, 1.1388537510946775, 1.0599232105311271, 1.028532608695652, 1.054670640221971, 1.140952380952381, 1.018910741301059, 1.2857142857142858, 1.252659574468085, 1.6666666666666667, 2.0, 1.1176470588235294, 1.0051413881748072, 1.0276461295418642, 1.0040848156262765, 1.0012504389383259, 1.0759837177747626, 1.0266323024054982, 1.2391304347826086, 1.0612244897959184, 1.0509340123599682, 1.6, 1.5833333333333333, 1.0816039395005277, 1.1428571428571428, 1.0868306801736614, 1.175103305785124, 1.0812786278140532, 1.093002872863612, 2.0, 1.0452012383900928, 1.189922480620155, 1.0724792725327628, 1.0394139288237292, 1.1111111111111112, 1.1284246575342465, 1.1469379550632064, 1.1081564512282376, 1.014516129032258, 1.0845070422535212, 1.0782122905027933, 1.0, 1.0, 1.0412315367833769, 5.0, 1.4285714285714286, 1.7419354838709677, 1.0221948212083847, 1.1058823529411765, 1.0837028824833703, 1.0604158493526874, 1.0, 1.0937306021104904, 1.016355140186916, 1.120603015075377, 1.2836538461538463, 1.4285714285714286, 1.0726733847065797, 1.180709534368071, 1.1469933184855234, 1.0159910747489773, 1.0255581522549848, 1.0152852333727596, 1.1481810115350488, 1.0, 1.2777002157634219, 1.0475595870027998, 1.0021969153515065, 1.1774193548387097, 1.1226262408286578]
origin-bjaq_15.71 	max: 5.0000	99th: 2.5000	95th: 1.7214	median: 1.0812	mean: 1.1709

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 13.961940 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[5.9604645e-08 6.5565109e-07 1.7881393e-07 0.0000000e+00 5.9604645e-08]
Distance score: 1.9073486612342094e-07
SAUCE Drift detection: False
Detection latency: 0.0233s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.031187 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 7.0000	99th: 3.0000	95th: 1.6667	median: 1.0825	mean: 1.1850
ReportEsts: [1.061624649859944, 1.019667832167832, 1.0454671488848704, 1.1214788732394365, 1.5833333333333333, 1.0, 1.0783862202367245, 1.0611206238606121, 1.0, 1.031868131868132, 1.1901791925540337, 1.0430538078692835, 1.0405405405405406, 1.0415094339622641, 1.0304914150384843, 1.0161290322580645, 1.109717868338558, 1.1363636363636365, 1.0909090909090908, 1.0593978844589096, 1.0892018779342723, 1.098523396188766, 1.1052249637155298, 1.044839255499154, 1.0046082949308757, 1.0320711599652879, 2.0, 1.1280371918949739, 1.5, 1.1428571428571428, 1.0798319327731092, 1.0, 1.0391800745519923, 1.006087542708918, 1.1503208065994501, 1.0252450980392156, 1.2091871584699454, 1.162528216704289, 2.0, 1.2339930151338765, 1.0477245453706268, 1.0265626451193461, 1.122961104140527, 1.0457419114912607, 1.029739776951673, 1.1078479589685941, 1.1818181818181819, 1.0794223826714802, 1.1674418604651162, 1.0395177494976557, 1.3793103448275863, 1.191304347826087, 1.0672268907563025, 1.0571428571428572, 1.0624659616237098, 1.0190817431880677, 1.080853621881575, 1.161038961038961, 1.1764705882352942, 1.074470365641107, 1.2794117647058822, 1.127097602739726, 1.0464071856287425, 1.1434108527131783, 1.0196078431372548, 1.3333333333333333, 1.0893131446126838, 1.3549723756906078, 2.25, 2.0, 1.0459347366773613, 1.0191146881287727, 1.055930568948891, 1.0174757281553397, 1.11119432400473, 1.2422018348623853, 1.01840490797546, 1.0631067961165048, 1.4757281553398058, 1.0509349337279512, 1.0618034447821683, 1.0, 1.0, 2.5, 1.094211123723042, 1.152542372881356, 2.0, 1.4545454545454546, 1.0, 1.1153488073453401, 1.109377344336084, 1.4170747018204646, 1.0255044555976647, 1.1058493214787084, 1.1746835443037975, 1.0204778156996588, 1.062420382165605, 1.136094674556213, 1.2, 1.315810434090004, 1.1153846153846154, 1.25, 1.042086751636944, 1.2715996578272026, 1.084406294706724, 1.2395275073826972, 1.6206896551724137, 1.0182179555667286, 1.0077985739750446, 1.3583360476478525, 1.1360759493670887, 1.0453846153846154, 1.2857142857142858, 2.0, 1.0507782101167316, 1.03298960908699, 1.054865424430642, 1.0434782608695652, 1.0597742942766728, 1.0, 1.1329248801278635, 1.0984182776801406, 1.5, 1.004566210045662, 1.125, 1.3, 1.0189881997901662, 1.0129970402779565, 1.0232558139534884, 2.0, 1.1460055096418733, 1.0, 1.0454545454545454, 1.1146508443633045, 1.1538461538461537, 1.0282822268532301, 1.0123063461258006, 1.0759413563970046, 1.5, 1.7142857142857142, 1.0102669404517455, 1.0883012102196326, 1.0906266183324702, 1.016331615061149, 1.304054054054054, 1.0005396654074474, 1.0698683301499574, 1.0, 1.0278095238095237, 1.0221366698748797, 1.1057418988061398, 1.0923753665689149, 1.5, 1.2807676685621445, 1.0140127388535032, 1.0352112676056338, 1.1514195583596214, 1.0, 1.082236842105263, 1.1052722558340535, 1.1515007146260123, 1.0613598673300166, 1.091160220994475, 1.4339622641509433, 1.375, 1.0283251231527093, 1.1818181818181819, 1.0615281665881346, 1.5, 1.0170731707317073, 1.06829016472026, 1.0663991244071507, 1.0253846153846153, 1.3056537102473498, 1.0853889943074004, 1.102071956312239, 1.087719298245614, 1.0568011958146488, 1.1349794238683129, 1.031143679665009, 1.0089613970588236, 1.2024053224155578, 1.1730769230769231, 1.3984962406015038, 1.014179545958737, 1.0131546391752577, 1.3368794326241136, 1.0792442188381275, 1.009501187648456, 6.0, 1.208450704225352, 1.0868859608359012, 1.5263157894736843, 1.1404040404040403, 1.2906432748538013, 1.0278107229188043, 1.0407541861968315, 1.0597302504816957, 1.0357065556029252, 1.0774330181245075, 1.0127205580631924, 1.0282397238782555, 1.0520094562647755, 1.0617997573681581, 1.0695815702867888, 1.0521944395873404, 1.0380952380952382, 1.0746268656716418, 1.1566265060240963, 2.0, 1.5151515151515151, 1.0443262411347518, 1.4136904761904763, 1.128440366972477, 1.017790649565577, 1.1666666666666667, 1.0445164935209807, 1.0317460317460319, 1.2061093119027628, 1.0, 1.02875, 1.0051254383598598, 1.0164379303749043, 1.0053592314919564, 1.0, 1.0006067961165048, 1.0807863842067291, 1.016074312134107, 1.0026455026455026, 1.0220713073005094, 1.0688640376692171, 1.0592122227952552, 1.423728813559322, 1.0050614182740143, 1.1586533658717586, 1.11875, 1.044064748201439, 1.031496062992126, 1.2, 1.1396103896103895, 2.0, 1.1693660342434058, 1.0963479879041638, 1.0368359829391236, 1.1374570446735395, 1.0769230769230769, 2.0, 1.0741760656217958, 1.1538461538461537, 1.0539266575011925, 1.2, 1.0738372093023256, 1.0845986984815619, 1.4285714285714286, 1.0132235056491825, 1.0115207373271888, 1.1195361284567351, 1.1035058430717863, 1.0076949982511367, 1.0547011027278004, 1.0307692307692307, 2.0, 1.0622045625813523, 1.0748190849993868, 1.0613138686131387, 1.0275968938259568, 1.1341448774280294, 1.0221786614393726, 1.1020408163265305, 1.1051002596335793, 1.0153999006458023, 1.0422586520947177, 1.0800353747512712, 1.2727272727272727, 1.05188835141063, 1.1509054325955734, 1.2156862745098038, 1.2083333333333333, 1.5681306306306306, 1.0997109826589595, 1.0431509791987397, 1.0307014451885794, 1.0628140703517588, 1.3890063424947146, 1.027822268792256, 1.0557103064066853, 1.0659668376476201, 1.0533325258999777, 1.2, 1.1089206505667817, 1.093134328358209, 1.049093076403283, 1.1154777031524172, 1.0891911438770034, 1.2206196581196582, 1.1890072910824454, 1.0299166607308212, 1.0622391149421386, 1.1000288631525779, 1.0386832958495196, 1.0675675675675675, 1.6, 1.3333333333333333, 1.0735911270983214, 1.2, 1.0326086956521738, 1.0753732599235448, 1.0000730609620667, 1.2380952380952381, 1.0924369747899159, 4.0, 1.096561306009031, 1.021575077692716, 1.2173913043478262, 1.1478840308627543, 1.0235326066913202, 1.1303317535545023, 1.0909090909090908, 1.6, 1.021015761821366, 1.1111111111111112, 1.0055244367350995, 1.0348101265822784, 1.0, 1.1133271754872112, 1.12, 1.1666666666666667, 1.0142832474036065, 2.0, 1.055045871559633, 1.0475030450669915, 1.01217869898706, 1.0433145009416196, 1.1343283582089552, 1.2258064516129032, 1.1034754689348278, 1.0782895048246297, 1.0161453077699294, 1.0354870634808426, 1.0380745828061932, 3.0, 1.0, 1.0435151873729613, 1.0, 1.06967022758941, 1.5, 3.0, 1.368421052631579, 1.3109807208717519, 1.067663257277734, 1.1925925925925926, 1.047806671920147, 1.2289156626506024, 1.6666666666666667, 1.0117853491392412, 1.1578947368421053, 1.0285714285714285, 1.0149444897999091, 1.0549019607843138, 1.0823170731707317, 1.0, 1.4, 2.0, 1.2890809112333073, 1.15, 1.059375, 1.1294885103571934, 1.221026592455164, 1.0073170731707317, 1.3333333333333333, 1.0305131438322854, 1.1971830985915493, 1.5, 1.3529411764705883, 1.0294968189705032, 1.0, 1.1214953271028036, 1.1764705882352942, 1.1549505191829572, 1.0813213169561742, 1.125, 1.0363566990079582, 1.1063772775991425, 1.0376344086021505, 1.107669616519174, 1.1483590277120967, 1.0528, 1.027027027027027, 1.009183542100771, 1.046032891488473, 1.0280363944138806, 1.101010101010101, 1.0731707317073171, 1.1571428571428573, 3.0, 1.0833333333333333, 1.4725274725274726, 1.0855018587360594, 1.3133333333333332, 2.1538461538461537, 1.0882034632034632, 1.0210084033613445, 1.0051649507648266, 1.0633587786259542, 1.1877539450061418, 1.0, 1.1929824561403508, 1.1099744245524297, 1.0, 1.0018712849489984, 1.588235294117647, 1.099265121537592, 1.0935629404653082, 1.0504222761100426, 1.144927536231884, 1.625, 1.005663430420712, 1.3333333333333333, 1.0804131316857248, 1.0909090909090908, 1.1714539908490087, 1.0503685503685503, 1.1077725800647715, 1.0651465798045603, 1.025712300208478, 4.0, 1.224769276570408, 1.019774739697487, 1.056372783442049, 2.0, 1.0246913580246915, 1.2984590429845904, 1.1960227272727273, 1.1242823840506593, 1.1186660173112257, 1.1666666666666667, 1.071870170015456, 1.0063350723728082, 1.0415626924198722, 1.0533498436548858, 1.0584863977781986, 1.0170152428216945, 1.1538461538461537, 1.099951004409603, 1.0501635003109515, 1.1048387096774193, 1.037473233404711, 1.0, 1.5, 1.1977587343441003, 1.10546875, 1.0131170176044184, 1.0932917048579285, 1.0813175501801338, 2.0, 1.1810344827586208, 1.125, 1.0609625926730903, 1.2173913043478262, 1.0, 1.0591826424526045, 1.3333333333333333, 1.0, 1.0160427807486632, 1.75, 1.0038923126824522, 1.0105740181268883, 1.0254237288135593, 1.3333333333333333, 1.0785016021490257, 1.0529363110008272, 1.55, 1.0700497450176767, 1.069767441860465, 1.1453551912568305, 1.013262599469496, 1.2495667244367417, 1.038070184146523, 2.0, 1.0843373493975903, 1.058784456991033, 1.1266272189349111, 1.0554675118858954, 1.2, 1.1033011869436202, 1.0126678559311832, 1.0281195079086116, 1.0, 1.0576987588057698, 1.0585742331543249, 1.0333232200647249, 1.0026504974221189, 1.00057295991819, 1.048006994175233, 1.0174947515745276, 1.1357929797591597, 3.0, 1.0676047852655133, 1.0767981095849948, 1.0722742969906265, 1.0032840722495895, 1.0689655172413792, 1.0074540682414699, 1.4210526315789473, 1.0707600149756646, 1.0945273631840795, 1.060143349934886, 1.032258064516129, 1.1329730268237403, 1.0382850695750283, 1.0229885057471264, 1.2658227848101267, 1.110446909667195, 1.0809128630705394, 1.0081984667802386, 1.0689429317120487, 1.0, 1.142095238095238, 1.1038575667655786, 1.298913043478261, 1.0961538461538463, 1.0104335955275303, 1.0851063829787233, 1.0008114687584528, 1.0, 1.2307692307692308, 1.0144495412844037, 1.1426941999625475, 1.0531418981913108, 1.0125886960230577, 1.0821181887950884, 1.2211538461538463, 1.0266257040450588, 1.0685593286801036, 1.5705882352941176, 1.0419977034324375, 1.0714285714285714, 1.2402234636871508, 1.1145933770327097, 1.1967509025270757, 1.0059857065455766, 2.0, 1.250187265917603, 1.1231884057971016, 1.1531112832429642, 1.1244343891402715, 1.0273327049952874, 1.0294627383015598, 1.2249240121580547, 1.1133576947630264, 2.0, 1.3461538461538463, 1.2, 1.0, 1.1574074074074074, 1.1724137931034482, 1.0217113665389528, 1.0826446280991735, 1.0672459893048127, 1.0270485282418456, 1.0985862512146956, 1.180153115611978, 1.0278520651900616, 1.1281057088924034, 1.0083999663872065, 1.0965103598691386, 1.034983853606028, 1.0501664914125481, 1.0705882352941176, 1.0862445414847162, 1.1354679802955665, 1.3284671532846715, 1.0353788860103628, 1.1650943396226414, 1.0989980588615909, 1.2921348314606742, 1.207785888077859, 1.0365262765560939, 2.0, 1.0034642032332564, 1.1764705882352942, 1.6666666666666667, 1.9832402234636872, 1.063751756328737, 1.036076662908681, 1.0127226463104326, 1.1942857142857144, 1.0766319153394803, 1.0065382268328829, 1.0036496350364963, 1.2, 1.3333333333333333, 1.0772638361523414, 1.1308411214953271, 1.1668691778047793, 1.1333015948583671, 1.0, 1.560693641618497, 1.1361702127659574, 1.0656755863891643, 1.0883652430044182, 1.0394458880933242, 1.035203746831534, 1.0171863157619632, 1.3298969072164948, 1.6666666666666667, 1.123266642787699, 1.0, 1.0409145607701564, 1.262008733624454, 1.3664285714285713, 1.1547573394690869, 1.4782608695652173, 1.00593781090599, 1.0526315789473684, 1.263157894736842, 1.033166904422254, 1.1354712041884816, 1.0601596071209332, 1.0106123215627347, 1.0263396911898275, 1.0586805555555556, 1.2, 1.0218570882690103, 1.0385103116865781, 1.1, 1.0270645385149202, 1.2610388279889355, 1.1626984126984128, 1.0491724785892387, 1.2222222222222223, 1.2458410351201479, 1.0185755438561637, 1.1493333333333333, 1.206896551724138, 1.093870920639556, 1.0396825396825398, 1.875, 1.01248, 1.0074173971679028, 1.090946310335578, 1.1241035235422514, 1.0027247694055574, 1.1802965088474413, 1.4012158054711246, 1.112033195020747, 1.2142857142857142, 1.0835786258928481, 1.073209549071618, 1.0038197097020627, 1.0740578439964943, 1.0981953579387944, 1.7428571428571429, 1.0130997216309154, 1.0909090909090908, 1.6, 1.0772058823529411, 1.5910138248847927, 1.051552795031056, 1.1548387096774193, 1.0769230769230769, 1.008849557522124, 1.0439201451905626, 1.0465116279069768, 1.007327565505554, 2.3333333333333335, 1.2312539382482672, 2.5, 1.0470809792843692, 1.1333333333333333, 1.018131628650298, 1.3548387096774193, 1.2481751824817517, 1.0469684030742954, 1.0, 1.1855699855699855, 1.209441489361702, 1.1666666666666667, 1.6666666666666667, 1.1056338028169015, 1.1666666666666667, 1.084029086991651, 1.1863874345549739, 1.1294117647058823, 1.417142857142857, 1.1030927835051547, 1.0156782549420587, 1.2111553784860558, 1.4222972972972974, 1.0, 1.0, 1.109628217349857, 1.1233689205219455, 1.0112359550561798, 1.0039001560062402, 1.0659870577010826, 1.0244933920704846, 1.0931411911497646, 1.21667468719923, 1.1829988193624557, 1.0147883732789393, 1.5, 1.5, 1.2727272727272727, 1.020993223706272, 1.0782041998551775, 1.0940860215053763, 1.0922131147540983, 1.0087374952513612, 1.0140415485241123, 1.0062383143506808, 1.2469135802469136, 1.1428571428571428, 1.0611664295874823, 1.0067440574903261, 1.0752832725177646, 1.0566090416249796, 1.0404624277456647, 1.0401228878648234, 1.0292586509284263, 1.1527307977889614, 1.0119225037257824, 1.0680533592196528, 1.0284810126582278, 1.0659515295987287, 1.2304526748971194, 1.0355200972570473, 2.0, 1.194501018329939, 1.0, 1.1030927835051547, 1.0566425189664024, 1.2295081967213115, 1.0943200965888737, 1.0061946902654868, 1.1904761904761905, 1.0553178353983055, 1.0111569753529552, 1.0954247633981071, 1.0741935483870968, 1.024029574861368, 1.2036032983169547, 1.2043010752688172, 1.5333333333333334, 1.0, 1.5, 1.072766831862686, 1.1, 1.0920158791817862, 1.1101683561827356, 1.0863670133729568, 1.0890809373441914, 1.0893008027038444, 1.0421804023361454, 1.0028901734104045, 1.0195852534562213, 1.002715318071733, 1.1768767187408578, 1.0461611694998059, 1.2204082656234327, 1.4285714285714286, 1.0789889415481833, 1.075657894736842, 1.0941188367691885, 1.0465753424657533, 1.2938766218984747, 1.0894568690095847, 2.1590106007067136, 1.040706989468618, 1.0951302378255945, 1.0588293927674335, 1.1, 1.0638213375171601, 1.0395743062928635, 1.2841296928327646, 1.0538273331003145, 1.027027027027027, 1.0899096976835492, 1.0631168107053248, 1.0337662750584233, 1.0859465737514518, 1.0180966772551046, 1.1388888888888888, 1.0080409876894614, 1.0986005089058524, 1.0358514724711907, 1.0327868852459017, 1.0045045045045045, 1.0383858267716535, 1.0797576981322565, 1.0100780806637835, 1.0681381957773513, 1.0029929515106435, 1.0551187333194254, 1.2, 1.1107934238741959, 1.0404286410131516, 1.0697796985348371, 1.0410618000829532, 1.2798725438130643, 1.1881390593047034, 1.0588235294117647, 1.0480519480519481, 1.0595961677140209, 1.2702702702702702, 1.1076023391812866, 1.2504270723175792, 1.0363791996576075, 1.0757825370675453, 1.401830282861897, 1.122262040841546, 1.0832778147901398, 1.1634408602150537, 1.1031055798507217, 1.0816730367840395, 1.1154422788605698, 1.027906976744186, 1.0633759902498476, 1.097701737511, 1.0693069306930694, 2.25, 1.0556640713721144, 1.169077306733167, 1.0004770992366412, 1.0289855072463767, 1.2695600826690285, 1.0158202676188288, 1.150550222430344, 1.3539161520961975, 1.3, 1.0152801358234296, 1.9166666666666667, 1.1381074168797953, 1.59375, 1.0631946383691706, 1.1904761904761905, 1.061124694376528, 1.0416666666666667, 1.1940928270042195, 1.083969465648855, 1.0377358490566038, 1.072992700729927, 1.0175970873786409, 1.015625, 1.0296296296296297, 1.3076923076923077, 1.0065616114484497, 1.088421052631579, 1.0058045042953332, 1.226890756302521, 1.3333333333333333, 1.303793802490588, 1.019149527109006, 1.0345897274000055, 1.1877862595419848, 1.4, 1.1176470588235294, 1.0277777777777777, 1.0561797752808988, 1.0689655172413792, 1.022, 1.0316910328366276, 1.0325523975717972, 1.3043478260869565, 1.093089669560459, 1.0484630955113625, 3.0, 1.0550382196230044, 1.0921606601549343, 1.5, 2.75, 1.154357459379616, 1.0616519876219948, 1.0444066848327238, 1.2277486910994764, 1.5, 1.1157894736842104, 1.05249343832021, 1.3214285714285714, 1.1023471074380164, 1.1233916199274168, 1.0329981721518817, 1.0360867751355862, 2.0, 1.0077280397187882, 1.0525974025974025, 1.1346899224806202, 1.0394321766561514, 1.0510083036773428, 1.0, 1.0495689655172413, 1.2266304648972128, 1.0099132989973683, 1.0263157894736843, 1.1151315789473684, 1.0419971052977834, 1.1014832162373145, 1.0578231292517006, 1.0972222222222223, 1.0403040577490976, 1.5169307238272756, 1.0760736805521076, 1.3350515463917525, 1.0846153846153845, 1.0713043478260869, 1.375, 1.0626902008520998, 1.0515463917525774, 1.0114103892259878, 1.0543478260869565, 1.5, 1.0012067578439259, 1.0122671883278314, 1.2404411764705883, 1.1318753060225233, 1.038303059437558, 1.0856903998885328, 1.1086173745848629, 1.0153256704980842, 1.0545454545454545, 1.0488537652668017, 1.085650427738339, 1.2439613526570048, 1.0411931818181819, 1.6666666666666667, 1.0454545454545454, 1.2053158130506196, 1.0423600605143721, 1.0485659030861003, 1.0862470530416883, 1.0406455469216975, 1.8, 1.1031149301825993, 1.0722224411776298, 1.1728159051806537, 1.1157556270096463, 1.0497866569971042, 1.0342105263157895, 1.3432007400555042, 1.013215859030837, 1.0301042407370986, 1.1268255361281756, 1.0411877394636015, 1.0549828178694158, 1.0526315789473684, 1.16624916499666, 1.0785951177078237, 1.0177600749765698, 1.1140660044857418, 1.1130030959752322, 1.0341772151898734, 1.3181818181818181, 1.2538631346578366, 3.0, 2.0, 1.1904761904761905, 1.0, 1.0243261012491782, 1.051756067448585, 1.02017057812578, 1.0527859237536656, 1.0291176986493598, 1.2126696832579185, 1.0517464424320828, 1.0461742581433273, 1.3333333333333333, 1.3125, 1.2889279437609842, 1.2222222222222223, 1.2044270833333333, 1.1474789915966386, 1.0449269936353425, 1.0903918491056206, 3.0, 1.0318275154004106, 1.2190476190476192, 1.0748165146314173, 1.0402649381657891, 1.0886075949367089, 1.118755352554953, 1.1513401754614712, 1.1450689831374552, 1.019047619047619, 1.2285714285714286, 1.0906976744186045, 1.3333333333333333, 2.0, 1.0427001148413846, 7.0, 1.3333333333333333, 1.7837837837837838, 1.0759358288770053, 1.0951915100098613, 1.130958904109589, 1.0682730923694779, 1.3333333333333333, 1.1027597436486232, 1.011063011063011, 1.247191011235955, 1.255952380952381]
origin-bjaq_15.71 	max: 7.0000	99th: 3.0000	95th: 1.6667	median: 1.0825	mean: 1.1850

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.143492 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.186156