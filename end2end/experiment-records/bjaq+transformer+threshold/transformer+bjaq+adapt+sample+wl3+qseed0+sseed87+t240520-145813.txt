Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 87, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.5000	95th: 1.7500	median: 1.0820	mean: 1.1753
ReportEsts: [1.0194174757281553, 1.001826245760501, 1.055480809571344, 1.0766045548654244, 1.5789473684210527, 1.0, 1.0329087048832273, 1.019818776306849, 1.0, 1.0223097112860893, 1.1446050846968516, 1.0432305902091847, 1.05121412803532, 1.1372093023255814, 1.0342635111268104, 1.0, 1.0222222222222221, 1.0074946466809422, 3.0, 2.0, 1.0384615384615385, 1.0705545551092026, 1.0853973168214655, 1.1056958308866707, 1.0892945239269858, 1.0, 1.1910534339791023, 2.0, 1.2, 1.0145985401459854, 1.0, 1.0572471995494248, 1.0079320653511146, 1.2047724750277469, 1.0142458510794536, 1.229431104082567, 1.1631016042780749, 1.009575313048509, 1.1468420690130174, 1.037037037037037, 1.1818181818181819, 1.003058103975535, 1.0, 1.0349091957336407, 1.126890318094907, 1.8615384615384616, 1.0404040404040404, 1.2614840989399294, 1.0343687741410856, 1.1388888888888888, 1.0282455252824552, 1.2439862542955327, 1.0398700754688477, 2.0, 1.1116883116883116, 1.231516459794927, 1.0904044409199047, 1.3526570048309179, 1.0522875816993464, 1.25, 1.111822973464195, 1.1070983810709838, 1.1227272727272728, 1.0116279069767442, 1.1818181818181819, 1.0652238035543102, 1.2666252330640149, 1.75, 1.0, 1.0615269879742706, 1.0047732696897376, 1.0670945157526255, 1.0136986301369864, 1.1089488636363636, 1.051764705882353, 1.0505836575875487, 1.0, 1.1106471816283925, 2.0, 1.0172888748601108, 1.032258064516129, 1.0244833374317086, 1.1901840490797546, 1.0832298136645964, 1.1113837095191363, 1.04, 1.073662157618395, 1.0080051419890148, 1.0588235294117647, 1.75, 1.1021611001964637, 1.0603490362388317, 1.0288461538461537, 1.0126227208976157, 1.0136986301369864, 1.0857142857142856, 1.0148148148148148, 1.1236816874400768, 1.0, 1.2408104517271923, 1.0487768045907582, 1.0789022298456261, 1.2407074996716432, 1.36, 1.0194448721534222, 1.0127422352004247, 1.1386175632097957, 1.1149032992036405, 1.04659717964439, 1.1666666666666667, 1.6666666666666667, 1.0869158878504672, 1.0681973262586728, 1.045483259633607, 1.0649350649350648, 1.0572411498452519, 2.0, 1.119520655944497, 1.1611111111111112, 1.0, 1.0164835164835164, 1.0, 1.1228070175438596, 1.0292210663336954, 1.0726877378271336, 1.1313131313131313, 1.8, 1.1440397350993377, 1.0, 1.0714285714285714, 1.0944270071873308, 1.3, 1.0576171875, 1.0201912992143292, 1.0444171779141105, 1.0307076101468624, 1.0863095238095237, 1.0522213561964147, 1.039972432804962, 1.0719073735527118, 1.0195603684878234, 1.208955223880597, 1.0208741030658839, 1.1115235301992188, 2.0, 1.0182315405651778, 1.0, 1.0928813559322035, 1.1018175401446975, 1.5, 1.246548801162509, 1.0044642857142858, 1.0080645161290323, 1.1074561403508771, 1.0116788321167882, 1.0364126770060689, 1.1027251219440957, 1.0622156233536089, 1.100418410041841, 1.0723684210526316, 1.2857142857142858, 1.38, 1.0088365243004418, 1.8571428571428572, 1.0523930017010408, 1.0638967891482207, 1.0788819875776396, 1.3505303760848602, 1.14555633310007, 1.0775489650420078, 1.2715789473684211, 1.0696629213483146, 1.0378619153674833, 1.0242669362992922, 1.000862812769629, 1.086491739552964, 1.0309085232594444, 1.1423766319982296, 1.027176220806794, 1.0, 1.024390243902439, 1.0049393169630256, 1.0283094098883572, 1.09035901573215, 1.0, 1.1039627447063525, 1.3344224485873535, 1.1145813042443131, 1.1153846153846154, 1.2104545454545454, 1.121737564476917, 1.0, 1.1818181818181819, 1.013195593398168, 1.011350737797957, 1.032857142857143, 1.6666666666666667, 1.0655948553054662, 1.0628362373276743, 1.067245544791293, 1.0626410835214446, 1.1071993253926427, 1.152542372881356, 1.1228070175438596, 1.2352941176470589, 1.0, 1.3333333333333333, 1.092177889922725, 1.3275261324041812, 1.2298850574712643, 1.0148294611962432, 1.0031277926720286, 1.040000712707576, 1.0038841416047053, 1.2104559748427672, 1.2661870503597121, 1.0176470588235293, 1.0118032786885245, 1.039979321040841, 1.0019255897118493, 1.0, 1.0824016563146999, 1.1086601146278534, 1.0092968970096994, 1.1646985705407085, 1.0506593005680929, 1.2753654458169266, 1.0357142857142858, 1.0042371811240596, 1.1685146982980918, 1.0242526790750142, 1.1636363636363636, 1.0819120287253141, 1.0502901353965184, 1.1732283464566928, 2.0, 1.2406918792143067, 1.0772108083966057, 1.2130801687763713, 1.1601731601731602, 1.0, 1.6666666666666667, 1.1043597544890171, 1.1090909090909091, 1.100776836158192, 1.5, 1.0, 1.0526315789473684, 1.076112412177986, 1.0204081632653061, 1.0497237569060773, 1.100210970464135, 1.0488215488215489, 1.0058774139378674, 1.0975397301639536, 1.0363636363636364, 2.0, 1.0930540990685338, 1.0275682154692236, 1.1103327495621715, 1.023952223982191, 1.154967586753102, 1.0531843228024114, 1.0906200317965025, 1.108304138865905, 1.0245215311004785, 1.1132600959306824, 1.0824139306127873, 1.2222222222222223, 1.0191836440515087, 1.163771712158809, 1.2045454545454546, 1.5625, 1.0234462225530332, 1.0555555555555556, 1.1025641025641026, 1.0924433079873495, 1.1364902506963788, 1.318295739348371, 1.0248985680190932, 1.0511744966442953, 1.0325453069687813, 1.046329195443139, 1.1111111111111112, 1.069152419061477, 2.5, 1.0417181353868257, 1.1079913606911447, 1.038009193937463, 1.0526315789473684, 1.6666666666666667, 1.3043478260869565, 1.0, 1.0629888710187894, 1.0, 1.036697247706422, 1.0361990950226245, 1.0048076923076923, 1.0179214488174342, 1.1385542168674698, 1.1320754716981132, 1.0216565883841935, 1.123093543467209, 1.077984222097685, 1.1452991452991452, 1.0, 1.126491646778043, 1.2929936305732483, 1.1464285714285714, 1.0137742207245155, 1.0133444537114262, 1.0816901408450703, 1.4047619047619047, 1.023876404494382, 1.0384416924664603, 1.2857142857142858, 1.0139591153022924, 1.04, 1.0526315789473684, 1.122427758318739, 1.2857142857142858, 1.4, 1.0274266151017561, 2.0, 1.1893004115226338, 1.0116279069767442, 1.0459392945036916, 1.105351170568562, 1.0268096514745308, 1.0705882352941176, 1.092696059199935, 1.095956768335727, 1.02945301542777, 1.0303037983238714, 1.0868809073724008, 2.0, 1.0, 1.0478758655362326, 1.25, 1.0691578360290017, 1.3529411764705883, 1.0, 1.4666666666666666, 1.3303212851405624, 1.0609184629803186, 1.2524271844660195, 1.0216450216450217, 1.0, 1.1504660452729694, 1.0593317107864568, 2.0, 1.4639666468135795, 1.0, 1.101207014347529, 1.0987654320987654, 1.014405667803726, 1.152073732718894, 1.1363636363636365, 1.300110741971207, 1.0648148148148149, 1.0198177625872078, 1.0170521020201233, 1.0637393767705383, 1.0, 1.0769230769230769, 1.5714285714285714, 1.5, 1.2307692307692308, 1.0704139289956265, 1.3333333333333333, 1.0238500851788757, 1.2469135802469136, 1.1328797795384085, 1.1205454846669631, 1.27394438722966, 1.0360364615311954, 1.0145011600928073, 1.0571428571428572, 1.5, 1.1594202898550725, 1.0425531914893618, 1.0608836095900853, 1.0476190476190477, 1.5714285714285714, 1.0133630289532294, 1.016548463356974, 1.0299437045750535, 1.0061274509803921, 1.1464387464387464, 1.0221614227086184, 1.0, 1.0907770515613653, 1.0614406779661016, 1.1730769230769231, 1.0254957507082152, 1.1603773584905661, 1.0706705910428764, 1.054959138400708, 1.0118025479320214, 1.075, 1.5857142857142856, 1.108359133126935, 1.0, 1.0354978805294774, 1.0280118388068504, 1.055192101819912, 1.0592313999500909, 1.0981833455843746, 1.1506196377502382, 1.5714285714285714, 1.171848501978519, 1.0, 1.2186165670367208, 1.25, 1.0473470084497425, 1.0028985507246377, 1.1240326741186586, 1.098814229249012, 1.1125, 3.0, 1.182952182952183, 1.0115344853502832, 1.147898657347802, 2.0, 1.0634920634920635, 1.2754318618042226, 1.392, 1.12640779963019, 1.0712694877505569, 1.1666666666666667, 1.0155306298533218, 1.0055699177438309, 1.0261802164129081, 1.0927459296231115, 1.0912280701754387, 1.1243781094527363, 1.2815533980582525, 1.875, 1.0591397849462365, 1.4444444444444444, 1.2247284878863827, 1.2424242424242424, 1.050073343112415, 2.0833333333333335, 1.0819947758729396, 1.0704256818298992, 1.0888340530536706, 1.0, 1.175257731958763, 1.24, 1.2857214328597157, 1.0043956043956044, 1.0, 1.0224607995479587, 1.0807667893868225, 1.0634065478657273, 1.5, 2.0, 1.0229126213592232, 1.011786038077969, 1.0295081967213116, 1.1111111111111112, 1.0741826620725086, 1.1194503171247356, 1.4705882352941178, 1.0195461003801698, 1.0454545454545454, 1.1089238845144358, 1.014516129032258, 1.44509886411443, 1.0092109836635383, 1.0, 1.0724637681159421, 1.0729891026882383, 1.0439337805006013, 1.019877799747172, 1.0, 1.0962176509621766, 1.0125226961555258, 1.0225248821372446, 1.0, 1.029505582137161, 1.0258131504600005, 1.0166337916212795, 1.004324843825084, 1.012614810183432, 1.009571191660744, 1.0144927536231885, 1.1111378977820636, 2.0, 1.002538860103627, 1.48, 1.0, 1.1917098445595855, 1.1538461538461537, 1.0149868302603942, 1.2905701754385965, 1.0336124013227057, 1.020651675080312, 1.0791788500503512, 1.0358447179764643, 1.0505565380214292, 1.1704545454545454, 4.0, 1.0021029888368744, 1.1619433198380567, 1.0465485666194503, 1.048191557725324, 1.1070522577371893, 1.1916030534351145, 2.348314606741573, 2.4285714285714284, 1.0169937186541365, 1.039764687531336, 1.0357918920212512, 1.1440900562851783, 1.0812765136907057, 1.01890756302521, 1.0823152308136939, 1.04686617730096, 1.1966463414634145, 3.0, 1.25, 1.0506134969325154, 1.0782442748091603, 1.0548672566371682, 1.1745810055865922, 1.1274509803921569, 1.5546875, 1.148905109489051, 1.116564417177914, 1.048419750637409, 1.2696629213483146, 1.0020633478588916, 2.0, 1.0799069045771916, 1.0909090909090908, 1.88, 1.1226256983240224, 1.0421892816419613, 1.017786561264822, 1.1063553826199741, 1.0968809012176857, 1.0, 1.4680851063829787, 1.1666666666666667, 1.0, 1.1363636363636365, 1.1149193548387097, 1.0318471337579618, 1.0825242718446602, 1.0607177186799104, 1.0765661252900232, 1.0213964555013209, 1.1784801301417616, 1.037837837837838, 1.1182337572229268, 1.0864864864864865, 1.099544567338972, 1.0382196419932268, 1.0708035003977725, 1.203757225433526, 1.0643123743898937, 1.0579739522627072, 1.4246970823673506, 1.076103249259386, 2.0, 1.4103194103194103, 1.0744786494538232, 1.4339622641509433, 1.0, 1.02, 1.25, 1.0541044776119404, 1.2592592592592593, 1.1666666666666667, 1.007859120395554, 1.1301693145072205, 1.0281564448123335, 1.0297683817814394, 1.2108108108108109, 1.1151761517615175, 1.0, 1.1846153846153846, 1.0243747350572276, 1.0906313916115493, 1.085021509581541, 1.088791434104112, 1.0348974909333135, 1.1402597402597403, 1.090390433070067, 1.1385435168738898, 1.03097742000583, 1.1506523089666598, 1.2727272727272727, 1.0414507772020725, 1.0, 1.2387640449438202, 1.207519661594694, 3.0, 1.1286240220892776, 1.0325567902887491, 1.4285714285714286, 1.0423159238538655, 1.1, 1.1176470588235294, 1.045925925925926, 1.6923076923076923, 1.0109374811162273, 1.0350277659120035, 1.3103448275862069, 1.16, 1.068041237113402, 1.0459110473457676, 1.0187637969094923, 1.1000795334040296, 1.154644201032891, 1.0, 1.0406799913100153, 1.125, 2.0, 1.0492884655303643, 1.0806125097326758, 1.1106906338694418, 1.0198637333248433, 1.0276777622651676, 1.0462962962962963, 2.142857142857143, 1.00190186382655, 1.0153225806451613, 1.1179305312812855, 1.2201872201872201, 1.0102298663188785, 1.0535532676688169, 1.249084249084249, 1.0935720097640358, 1.2441471571906355, 1.0500648447814556, 1.0681388012618296, 1.125, 1.0231058570660936, 1.0502577794144725, 3.0, 1.1386778512470708, 1.0247840436802216, 1.029734568802774, 1.4615384615384615, 1.2362171920566587, 1.1434599156118144, 1.0, 1.0871834661776116, 1.0420575865415722, 1.138646288209607, 1.088235294117647, 1.3333333333333333, 1.0516516602832648, 1.5, 1.1682242990654206, 1.0833333333333333, 1.0827227688228316, 1.44, 1.1645569620253164, 1.0618448637316562, 1.0, 1.7288359788359788, 1.2163882259347654, 1.25, 2.0, 1.1176470588235294, 1.1206896551724137, 1.0618311533888227, 1.1927409261576971, 1.0940170940170941, 1.247787610619469, 1.1014466214978942, 1.0623376623376624, 1.1502347417840375, 1.2285714285714286, 1.04, 1.0, 1.221130221130221, 1.0331890331890332, 1.0340909090909092, 1.0841289452993372, 1.0634208403152734, 1.072188719404044, 1.088148104230279, 1.1483877964141123, 1.1770538243626063, 1.0023923444976077, 1.8333333333333333, 1.0, 1.2592592592592593, 1.013397114467653, 1.0970873786407767, 1.107843137254902, 1.0246305418719213, 1.041389843451699, 1.0533806826188665, 1.008724130508318, 1.1142857142857143, 1.2222222222222223, 1.0336648814078042, 1.016026936026936, 1.0862659659393294, 1.0277032474656023, 1.006578947368421, 1.0573685764914353, 1.0089739312415644, 1.1923664122137405, 1.3223014256619146, 1.0, 1.0577841451766954, 1.9388646288209608, 1.1304347826086956, 1.0251396648044693, 1.0701001430615165, 1.0, 1.095, 1.0162531940356438, 1.0188679245283019, 1.080457574093091, 1.050055617352614, 1.2285714285714286, 1.0669053681992684, 1.0371665465032445, 1.0782634971796938, 1.0534351145038168, 1.0124858115777526, 1.1995267872232551, 1.2584269662921348, 1.3571428571428572, 1.0, 1.25, 1.0716725202858182, 1.3333333333333333, 1.1442169170611236, 1.105648591890582, 1.020805065581185, 1.0492552135054618, 1.0486945020411613, 1.182422293676313, 1.014336917562724, 1.0513176144244105, 1.0156761453025571, 1.0650778027746532, 1.0475743317548873, 1.1824340599783212, 1.6666666666666667, 1.0158730158730158, 1.0630252100840336, 1.1456376304204652, 1.0165562913907285, 1.2488151658767772, 1.01985559566787, 2.1923076923076925, 1.0291232211455335, 1.0469798657718121, 1.078732057416268, 1.0625, 1.0816252088579295, 1.0406060110160331, 1.2858590978205777, 1.0581052631578947, 1.3333333333333333, 1.1418092909535453, 1.1292134831460674, 1.5625, 1.0507338864071474, 1.5769230769230769, 1.003024193548387, 1.0756501182033098, 1.0977054034048852, 1.0067351405960598, 1.0107015457788346, 1.8333333333333333, 1.0821256038647342, 1.0929445935512334, 1.0553641868992722, 1.0065621128260045, 1.0484574713823727, 1.0963704181909475, 1.1538461538461537, 1.0728196443691786, 1.1068108108108108, 1.0129916514130095, 1.035070140280561, 1.0069444444444444, 1.1618648507071765, 1.0029814767825425, 1.4094165813715456, 1.0352395058160537, 1.0, 1.3333333333333333, 1.0481940221019062, 1.0521095484826055, 1.230144105835105, 1.11131498470948, 1.083000798084597, 1.139240506329114, 1.0972390612216736, 1.109393300538768, 1.1433823529411764, 1.0946745562130178, 1.0273381294964028, 1.1078633485495508, 1.1071428571428572, 1.75, 1.0615266421555178, 1.15670793228808, 1.0323719835197174, 1.0057142857142858, 1.2186821144098479, 1.0140027779932173, 1.1608096710711273, 1.36986301369863, 1.1538461538461537, 1.1172506738544474, 1.082004555808656, 1.14375, 1.5925925925925926, 1.0581293999329533, 1.1833498513379583, 1.1749585406301823, 1.024390243902439, 1.008800615240579, 1.0061847700038655, 1.0661311914323963, 1.2834224598930482, 1.3333333333333333, 1.2173913043478262, 2.0, 1.1340996168582376, 1.5, 1.0, 1.1538461538461537, 1.0490066225165562, 1.0126811594202898, 1.0416024100706525, 1.0387764892719482, 1.1072727272727272, 1.3076923076923077, 1.1428571428571428, 1.0, 1.1081081081081081, 1.044776119402985, 1.1443850267379678, 1.0233650540648238, 1.0297502875589033, 1.3195876288659794, 1.0977684769153964, 1.0475251488914468, 2.5, 1.0659300466129087, 1.12, 3.0, 2.0, 1.1627218934911243, 1.1250089650720791, 1.0559363171066034, 1.2701863354037266, 1.0, 1.2285714285714286, 1.1625766871165644, 3.0, 2.0, 1.0029527559055118, 1.2533942734238472, 1.0137448456828688, 2.0, 1.0187512850849252, 1.0464756003098374, 1.1117445838084379, 1.0, 1.0751173708920188, 1.0210454061845764, 1.144736842105263, 1.1933143301373412, 1.0243401020150888, 1.3117283950617284, 1.13671875, 1.0318656016373404, 1.071363220494053, 1.0950413223140496, 1.3018867924528301, 1.014461132118806, 1.6199722607489597, 1.0378484681203421, 1.3892215568862276, 1.2941176470588236, 1.328358208955224, 1.1016483516483517, 1.0659962287869265, 1.0236533431420631, 1.081555853611803, 1.0906113537117903, 1.5, 1.6666666666666667, 1.118807134181423, 1.218117854001759, 1.3680217856448162, 1.010057559431033, 1.04248202040475, 1.132400430570506, 1.4318181818181819, 1.0666666666666667, 1.0942535964153761, 1.0864272359310472, 1.2332848837209303, 1.0834914611005693, 1.6666666666666667, 1.0273972602739727, 1.0248129628933418, 1.1706293706293707, 1.000639985014985, 1.0789303740461906, 1.0078125, 2.0, 1.047735618115055, 1.023390200597713, 1.1562714187799863, 1.1254752851711027, 1.0943772946168884, 1.0414012738853504, 1.2560706401766004, 1.0069565217391305, 1.0309915480895198, 1.0789628756629346, 1.0092165898617511, 1.0582655826558265, 1.0, 1.1511753712993016, 1.050301672913429, 1.0814285714285714, 1.0570113840075817, 1.130188679245283, 1.059001512859304, 1.2857142857142858, 1.2107969151670952, 1.6666666666666667, 2.0, 1.1176470588235294, 1.0051413881748072, 1.0442338072669826, 1.0262576219512196, 1.006056199478209, 1.0879240162822252, 1.0775473399458972, 1.1630434782608696, 1.2564102564102564, 1.0523790483806477, 1.6, 1.5, 1.3907734056987788, 1.1428571428571428, 1.1044117647058824, 1.1409227683049148, 1.005346139905763, 1.081519533849475, 2.0, 1.1241486068111455, 1.2286821705426356, 1.091156462585034, 1.0402946870097343, 1.0681818181818181, 1.1202054794520548, 1.1382688684473012, 1.1324640506946138, 1.012718600953895, 1.3148148148148149, 1.106145251396648, 1.0, 1.0, 1.0411734201208827, 5.0, 1.5714285714285714, 1.7419354838709677, 1.0060679611650485, 1.1058823529411765, 1.0953436807095345, 1.111023930953315, 1.0, 1.1229050279329609, 1.0251168224299065, 1.17989417989418, 1.2572115384615385, 1.4285714285714286, 1.0186894843503715, 1.0742793791574279, 1.1368653421633554, 1.0855336556340647, 1.0344671929701372, 1.1418192980661004, 1.101153504880213, 1.0, 1.2474087236112874, 1.0412989512592543, 1.0587786944045912, 1.1774193548387097, 1.0573141608658096]
origin-bjaq_15.71 	max: 5.0000	99th: 2.5000	95th: 1.7500	median: 1.0820	mean: 1.1753

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 13.951873 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[9.5367432e-07 5.3644180e-07 1.7881393e-07 5.9604645e-08 4.1723251e-07]
Distance score: 4.2915343101412873e-07
SAUCE Drift detection: False
Detection latency: 0.0232s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.026595 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.5050	95th: 1.7143	median: 1.0859	mean: 1.1843
ReportEsts: [1.0184696569920844, 1.020026121027427, 1.0254861538090587, 1.0633561643835616, 1.5833333333333333, 1.0, 1.0729061784897025, 1.0438125386461123, 1.2, 1.005458515283843, 1.138022465410018, 1.0445015153452204, 1.0225208863058481, 1.1608527131782946, 1.0558675731599172, 2.1333333333333333, 1.1601307189542485, 1.4, 1.2727272727272727, 1.0433694745621351, 1.126750781340433, 1.0538749639873235, 1.3387978142076502, 1.0093776641091219, 1.0147007895830447, 1.021761361195056, 3.0, 1.1822978984506827, 2.0, 1.1666666666666667, 1.0863636363636364, 1.0, 1.040005862201623, 1.0022817528989798, 1.0092081031307552, 1.0432060881306002, 1.220331408140814, 1.203125, 2.25, 1.046829268292683, 1.0238252812706816, 1.0249962580452028, 1.0960591133004927, 1.1494115894532995, 1.0203327171903882, 1.0542363824600074, 1.2, 1.0432960893854748, 1.066390041493776, 1.0426666666666666, 1.5, 1.2155172413793103, 1.0847457627118644, 1.1111111111111112, 1.0392494213464372, 1.0044278627362553, 1.032941850472644, 1.0161290322580645, 1.0638297872340425, 1.0880406668302907, 1.462686567164179, 1.1403568859814364, 1.0913312693498451, 1.0703125, 1.0606060606060606, 1.6666666666666667, 1.1274710293115202, 1.3113484646194926, 1.6, 1.0, 1.0372291021671827, 1.0081383519837233, 1.073407875546913, 1.0135135135135136, 1.0913567800224901, 1.175792507204611, 1.0314201183431952, 1.3233532934131738, 1.4757281553398058, 1.0805442003065917, 1.1210295728368018, 1.0294117647058822, 3.0, 1.1111111111111112, 1.062358276643991, 1.35, 1.3269230769230769, 1.1538461538461537, 1.0, 1.0814910724276283, 1.1147466827503016, 1.273974914224647, 1.0587177643069967, 1.115491651205937, 1.135204081632653, 1.0384153661464586, 1.0940170940170941, 1.0089285714285714, 1.0204678362573099, 1.3033138401559454, 1.2222222222222223, 1.0, 1.0424531516183986, 1.1005892255892256, 1.0571428571428572, 1.2295672211420754, 1.3333333333333333, 1.0105430799414303, 1.075924295774648, 1.2919998232981402, 1.1145734970097576, 1.0423106156574613, 1.2857142857142858, 1.5, 1.0886225191589702, 1.0556262277101773, 1.0772532188841202, 1.1170212765957446, 1.0582977476345976, 2.0, 1.137208067940552, 1.195712954333644, 1.0, 1.0186915887850467, 1.0, 1.2231404958677685, 1.0132774015912835, 1.0290574060949682, 1.1475409836065573, 1.8333333333333333, 1.2061016949152543, 1.0, 1.25, 1.1296296296296295, 1.1538461538461537, 1.1511325659116227, 1.0464682291304448, 1.0998708566508826, 1.0, 1.6428571428571428, 1.0887445887445888, 1.035860190649115, 1.0649350649350648, 1.0223832561616246, 1.2830188679245282, 1.0135427952329361, 1.0753428138690955, 3.0, 1.0135797812146359, 1.0104562737642586, 1.0969766115231032, 1.0988019523739092, 1.5, 1.2415488012839804, 1.0416141235813368, 1.0050675675675675, 1.5, 1.0, 1.013939081053175, 1.1043093430909585, 1.088247288149417, 1.032414910858995, 1.131720430107527, 1.2096774193548387, 1.1851851851851851, 1.0134474327628362, 1.4444444444444444, 1.068859411370811, 1.5, 1.072083879423329, 1.23526999316473, 1.0694219598133512, 1.013781697905182, 1.3040421792618628, 1.0859813084112149, 1.086981056025796, 1.089567966280295, 1.0028735632183907, 1.099434114793856, 1.037710970464135, 1.0687286342178088, 1.2290590261468608, 1.1604938271604939, 1.125, 1.013282662265311, 1.0965560481884544, 1.2527472527472527, 1.5637692932575142, 1.0338164251207729, 1.5, 1.25, 1.0774480479151347, 1.2727272727272727, 1.1585428424833248, 1.0299626705427638, 1.0588235294117647, 1.107809495079, 1.063913470993117, 1.0277859412776595, 1.0872754848867017, 1.0082101806239738, 1.0307227969783144, 1.0586698337292162, 1.0617444929730415, 1.0620592383638927, 1.1466324907194627, 1.6116504854368932, 1.0724637681159421, 1.2409638554216869, 1.0, 1.3357142857142856, 1.1600838409641712, 1.3556851311953353, 1.2242990654205608, 1.0157219693835333, 1.8461538461538463, 1.0398110443773525, 1.0206422018348624, 1.2130866461980143, 1.1428571428571428, 1.2187958883994126, 1.0005427408412484, 1.0571575387483418, 1.0069582409566862, 1.0, 1.037640667442763, 1.1480885444035733, 1.01389638424177, 1.0213903743315509, 1.005050505050505, 1.04093567251462, 1.096976364303097, 1.375, 1.0041470108327217, 1.0524613454104887, 1.0953846153846154, 1.1013824884792627, 1.014840182648402, 1.2142857142857142, 1.12434554973822, 2.0, 1.2351658997335917, 1.1585234961967428, 1.0262230919765167, 1.2048611111111112, 1.0, 1.6666666666666667, 1.1358631826189078, 1.0422535211267605, 1.0693026968470267, 1.4, 1.0424295263004941, 1.0287769784172662, 1.1428571428571428, 1.0194156804733727, 1.0, 1.1129893238434163, 1.133034379671151, 1.0052539404553416, 1.1690170388537497, 1.0298507462686568, 1.0, 1.1004243886578708, 1.0573321288768442, 1.1477611940298507, 1.0143028464604422, 1.1482558139534884, 1.0310502927276575, 1.1158455392809588, 1.0855917390090923, 1.027930174563591, 1.0870060790273557, 1.0956104099184631, 1.0714285714285714, 1.0220989505247375, 1.0469043151969981, 1.1636363636363636, 1.2608695652173914, 1.2727272727272727, 1.0248618784530388, 1.0402001072002858, 1.0574217735050666, 1.099273607748184, 1.4276457883369331, 1.026417105374566, 1.1240188383045526, 1.0627933391911875, 1.0382317966235544, 1.0, 1.1683123877917414, 1.0650851581508516, 1.0617198335644937, 1.1425467817623545, 1.0952846877592874, 1.2092534174553102, 1.2143256855064353, 1.0595535268525782, 1.0135562124146367, 1.130191505875133, 1.0440502647680192, 1.0186219739292366, 3.6666666666666665, 1.3333333333333333, 1.0968519355324597, 1.0, 1.0124333925399644, 1.0929103889376843, 1.0234777422328254, 1.5142857142857142, 1.0, 1.1016333938294012, 1.0163674762407604, 1.0707384364493393, 1.1666666666666667, 1.2419487059374634, 1.0189111326984, 1.0046189376443417, 1.6666666666666667, 1.6923076923076923, 1.0327868852459017, 1.25, 1.0046664511606918, 1.0558213716108453, 1.0, 1.070052459687973, 1.1153846153846154, 1.2307692307692308, 1.0165373111191751, 4.0, 1.0962962962962963, 1.014388489208633, 1.1456500488758554, 1.091524074810983, 1.0503432494279177, 1.13, 1.1066782502736063, 1.0682120771804142, 1.1049562682215743, 1.0108805213813292, 1.1038678278688525, 3.0, 1.2, 1.064337517035004, 1.0, 1.0697026022304832, 1.4, 1.125, 1.4444444444444444, 1.2599667774086378, 1.0706991358994502, 1.1450381679389312, 1.0752997601918466, 1.3421052631578947, 1.6, 1.082705655384479, 1.5, 1.1764705882352942, 1.0028164874727536, 1.0671936758893281, 1.0320656226696494, 1.0186219739292366, 1.4, 1.0, 1.3918575063613232, 1.1180555555555556, 1.1988235294117646, 1.1298771911161543, 1.225086762518592, 1.01, 1.5, 1.029630513694543, 1.1419354838709677, 2.0526315789473686, 2.5, 1.0413223140495869, 1.1428571428571428, 1.2042105263157894, 1.1346153846153846, 1.1873497596153846, 1.049497119138499, 1.064, 1.0507789013391637, 1.1125605164066703, 1.5, 1.176923076923077, 1.0667109382411535, 1.085427135678392, 1.03125, 1.0041959628033568, 1.0729135110572554, 1.069879518072289, 1.0186046511627906, 1.1578947368421053, 1.1135029354207437, 2.0, 1.0625, 1.5333333333333334, 1.1785028790786949, 1.6774193548387097, 1.0739130434782609, 1.0778019586507073, 1.1296296296296295, 1.031852427602872, 1.0972379871358304, 1.0822784810126582, 1.0520833333333333, 1.5393258426966292, 1.162303664921466, 2.0, 1.0690144568590074, 1.64, 1.1097979051840066, 1.0280256867934594, 1.0516231593038823, 1.1597759402507335, 1.5, 1.0593723494486853, 1.1666666666666667, 1.0773263433813893, 1.4545454545454546, 1.0876328378334992, 1.054862842892768, 1.1266846361185985, 1.0352564102564104, 1.1722787783868442, 3.0, 1.2173654475170979, 1.014357352794213, 1.1212824298671167, 2.0, 1.125, 1.1923377638780297, 1.3973509933774835, 1.1342307827492883, 1.2765196662693683, 1.04, 1.2731152204836416, 1.0071988637469114, 1.0670907464466752, 1.0394499369789245, 1.0644368738997734, 1.0595419847328245, 1.5, 1.0196868008948545, 1.0645183915992826, 1.0573770491803278, 1.088805166846071, 2.0, 1.5, 1.1355820105820107, 1.2074688796680497, 1.0003401360544217, 1.088275231193631, 1.029022403258656, 1.0, 1.2456140350877194, 1.0666666666666667, 1.0207464201150074, 1.1304347826086956, 1.0, 1.0417858878151487, 2.0, 1.0, 1.0037950664136623, 2.3333333333333335, 1.0116731517509727, 1.0256410256410255, 1.02710027100271, 1.2, 1.0832124498798605, 1.0777683854606932, 1.4, 1.0121339847367246, 1.0296296296296297, 1.0940919037199124, 1.0850918992511913, 1.2830921284857042, 1.0068832731648616, 1.0, 1.130952380952381, 1.2801556420233462, 1.1755485893416928, 1.043512658227848, 1.5, 1.0702922678505364, 1.0116703515607899, 1.0195907705703091, 2.0, 1.052649116961013, 1.0513966250373223, 1.0122773053642757, 1.004364588637521, 1.0078170639093351, 1.0173690404063942, 1.0035511363636365, 1.08723885179717, 2.0, 1.0373544561312384, 1.0610328638497653, 1.0564102564102564, 1.025219298245614, 1.0185676392572944, 1.0058814489878598, 1.0061162079510704, 1.0326817714190013, 1.2219220378232343, 1.0600283958339538, 1.0762829403606102, 1.137645478961504, 1.0500754147812972, 1.0113636363636365, 1.4264705882352942, 1.090357777213905, 1.103225806451613, 1.0188554503622997, 1.069691644512534, 1.3333333333333333, 1.071750717507175, 1.4293478260869565, 1.4, 1.02, 1.020570750084127, 1.1505376344086022, 1.0387700534759359, 1.0, 1.1428571428571428, 1.0121476048590419, 1.097528196927683, 1.0444693572496264, 1.0561589809697636, 1.1410670978172999, 1.2218963831867058, 1.0096642929806714, 1.0175197731681838, 1.5664739884393064, 1.0215106312008875, 1.023425499231951, 1.08, 1.1019774350357079, 1.178197064989518, 1.024566531063628, 2.0, 1.2854938271604939, 1.0598591549295775, 1.0378231521657233, 1.0991189427312775, 1.0753623188405796, 1.0116666666666667, 1.1389312977099237, 1.0928451679195283, 1.0, 1.4821428571428572, 1.0, 1.0, 1.2376237623762376, 1.1944444444444444, 1.0323415265200517, 1.125, 1.0700415160037497, 1.035024154589372, 1.0262572123129192, 1.1645230695672961, 1.067832110167395, 1.094823006237579, 1.0247197405478115, 1.0993555316863588, 1.2105716253443526, 1.0625213832254141, 1.0633906633906633, 1.0690399137001079, 1.1079754601226994, 1.0470588235294118, 1.0741893749494622, 1.1717289719626167, 1.104794439398128, 1.3620689655172413, 1.135103105001185, 1.1378600823045268, 2.0, 1.028048780487805, 1.0588235294117647, 2.0, 1.5086206896551724, 1.040262405173486, 1.0283476314807907, 1.028205128205128, 1.03125, 1.1028793920094195, 1.0212241015427603, 1.0877513711151736, 1.0, 2.0, 1.196413757896752, 1.1697247706422018, 1.118844118844119, 1.084848484848485, 1.0, 1.0258780036968578, 1.206208425720621, 1.0984229170924449, 1.102102102102102, 1.0029086351860685, 1.0640409071036174, 1.0094549426771233, 1.3020833333333333, 1.6666666666666667, 1.1068713818273346, 2.0, 1.031322505800464, 1.2264957264957266, 1.3786610878661087, 1.1001717032967033, 1.56, 1.0902652652652653, 1.1111111111111112, 1.2248157248157248, 1.047307959351133, 1.193196405648267, 1.1454423592493297, 1.0135738016136686, 1.0153015301530153, 1.0628472222222223, 1.75, 1.0427415661731034, 1.000709814802865, 1.25, 1.0123203285420945, 1.196309535310598, 1.297872340425532, 1.0103663872824546, 1.5555555555555556, 1.095667870036101, 1.027808564231738, 1.0069767441860464, 1.1176470588235294, 1.0999576995935483, 1.078740157480315, 2.4285714285714284, 1.0927405349079542, 1.01763907734057, 1.1635931330229135, 1.1510652033570046, 1.0171646596380621, 1.0962324103495233, 1.1157407407407407, 1.137846369694844, 1.2180232558139534, 1.1341741792285116, 1.0861067089276282, 1.0711398544866613, 1.097537878787879, 1.0264384823696922, 1.1666666666666667, 1.0741825280624695, 1.15, 1.6, 1.1416040100250626, 1.586857142857143, 1.0475598383587192, 2.5, 1.0, 1.0032102728731942, 1.0367302844796542, 1.0419161676646707, 1.0890543375426762, 2.3333333333333335, 1.113069363069363, 1.5, 1.1374045801526718, 1.2, 1.0074013637158343, 1.5483870967741935, 1.2147887323943662, 1.041155866900175, 1.0, 1.2060385373994842, 1.3086680761099365, 1.5, 2.0, 1.1134751773049645, 1.2412790697674418, 1.0459438172748754, 1.2090813093980992, 1.074438202247191, 1.0225806451612902, 1.1088082901554404, 1.0583941605839415, 1.1185770750988142, 1.4848484848484849, 1.096774193548387, 1.0, 1.4202380952380953, 1.0968899521531101, 1.0459866220735785, 1.1265025203567274, 1.0872888747918483, 1.0011369900771776, 1.0685307085252744, 1.198344121631793, 1.146341463414634, 1.0, 1.625, 1.0, 1.3636363636363635, 1.0105424064985187, 1.0749819754866619, 1.0970350404312668, 1.072314049586777, 1.0333142238359132, 1.04414654280366, 1.011445204318092, 1.2, 1.2380952380952381, 1.1373283395755305, 1.0001102839812517, 1.060453740862351, 1.012933923066613, 1.0451977401129944, 1.0745525004613397, 1.0906281895334369, 1.1216981753507673, 1.0747384155455904, 1.1073501118393267, 1.2352941176470589, 1.0876623376623376, 1.0897435897435896, 1.0401531738688312, 1.7, 1.0443896424167693, 1.0, 1.0214007782101167, 1.0058382664421877, 1.0634920634920635, 1.119124813525609, 1.0153429602888087, 1.1590909090909092, 1.0473455399358995, 1.030871998555696, 1.0516961031679282, 1.026813880126183, 1.055765595463138, 1.2039975156682288, 1.1652173913043478, 1.0952380952380953, 1.0, 1.1111111111111112, 1.0704724489175999, 1.4285714285714286, 1.0935982795512063, 1.1306556382189656, 1.0184808722971723, 1.0648684428264108, 1.0707050663395539, 1.0130992692924612, 1.0029940119760479, 1.0590277777777777, 1.0209976529960543, 1.1115690372482763, 1.0416564445239116, 1.2574818754233248, 1.7142857142857142, 1.0807365439093484, 1.0172413793103448, 1.082471251929764, 1.010840108401084, 1.284814398200225, 1.0940988835725678, 2.1789473684210527, 1.055214566373045, 1.0354767184035476, 1.0420446737106266, 1.2777777777777777, 1.0545338661044787, 1.0254205501652478, 1.3224419604471196, 1.0501567398119123, 1.3333333333333333, 1.1797235023041475, 1.0029433831592311, 1.0397903073248151, 1.0, 1.0182530932255298, 1.0256410256410255, 1.068828042726042, 1.068370607028754, 1.0025125628140703, 1.0901554404145077, 1.0090661831368994, 1.1148577449947312, 1.0611138491867915, 1.001466356144189, 1.0641148325358851, 1.0176643244685581, 1.0836810504626793, 1.1333333333333333, 1.0668073136427567, 1.0311096323407087, 1.0377952755905513, 1.1724137931034482, 1.055678059536935, 1.1334002006018054, 1.1016949152542372, 1.0425257731958764, 1.0334221641190668, 1.0, 1.099883855981417, 1.2441883888642682, 1.04173801369863, 1.1245614035087719, 1.1079588578607134, 1.1178320869632257, 1.0597609561752988, 1.1015936254980079, 1.0983485151447827, 1.0764953573742173, 1.1193353474320242, 1.0336538461538463, 1.0291840381179274, 1.0777198371312238, 1.0679611650485437, 2.25, 1.0499986455125832, 1.1710764329490537, 1.0188496858385694, 1.0186915887850467, 1.197289156626506, 1.0180207282615747, 1.1579194001874413, 1.0208616780045352, 1.3225806451612903, 1.0705092333519866, 1.2, 1.160857908847185, 1.3243243243243243, 1.0164234087199813, 1.1824877250409165, 1.3651685393258426, 1.0444444444444445, 1.075, 1.0664961636828645, 1.0095238095238095, 1.75, 1.0563291139240507, 1.0458333333333334, 1.1374734607218684, 1.0769230769230769, 1.0074552165662212, 1.1592920353982301, 1.0023183030022025, 1.25, 1.0, 1.271901552886024, 1.0123693101898175, 1.0601949383444285, 1.0610119047619047, 1.3387096774193548, 1.1764705882352942, 1.1388888888888888, 1.0217391304347827, 1.0602409638554218, 1.0666666666666667, 1.0277450985910737, 1.0315329658609274, 1.3157894736842106, 1.0928985416393593, 1.0482853040371323, 3.0, 1.0888377863172864, 1.0492836676217765, 2.0, 2.0, 1.1700097847358122, 1.094962742175857, 1.0744623054552427, 1.2981530343007917, 1.0, 1.203921568627451, 1.162729658792651, 1.0, 1.087996183585442, 1.1019548665889294, 1.0625253420750607, 1.0844523709609735, 1.7142857142857142, 1.0170337310487128, 1.050420168067227, 1.1012987012987012, 1.0763688760806915, 1.0177725118483412, 1.0, 1.1851851851851851, 1.1475062086092715, 1.0062197873026104, 1.135483870967742, 1.1155115511551155, 1.0938837498274196, 1.1087124132613724, 1.0707070707070707, 1.2388059701492538, 1.0039993448172313, 1.349009900990099, 1.052997047626447, 1.6942148760330578, 1.2601626016260163, 1.3415841584158417, 1.5, 1.0887121443866625, 1.0432569974554708, 1.0085282428662001, 1.0144665461121158, 2.5, 1.0714285714285714, 1.081668982285516, 1.233430444282593, 1.0732571244566091, 1.0292571222502704, 1.061184668989547, 1.115283012222183, 1.2906976744186047, 1.0363636363636364, 1.0649171270718232, 1.1058292050617315, 1.2555282555282554, 1.0858034321372856, 1.6666666666666667, 1.1481481481481481, 1.0892203549923256, 1.0832049306625577, 1.0191028032437723, 1.0722487466336654, 1.0017709563164108, 2.25, 1.1399132321041214, 1.0116713091922005, 1.166952217780316, 1.2380952380952381, 1.0825614676710857, 1.0210526315789474, 1.3949814126394051, 1.0513196480938416, 1.0321026947384981, 1.098082463089665, 1.0319767441860466, 1.0752808988764044, 1.131578947368421, 1.2795104261106074, 1.0181549351983303, 1.0451098390332207, 1.0598892263712703, 1.1433941997851773, 1.0391908975979773, 1.0303030303030303, 1.178343949044586, 2.0, 2.0, 1.2777777777777777, 1.0323974082073435, 1.0250164581961816, 1.0234784806926627, 1.0001676457894155, 1.0708305046390587, 1.0779098283342765, 1.1216216216216217, 1.0612244897959184, 1.0185005551335242, 1.8333333333333333, 1.1176470588235294, 1.0137665198237886, 1.25, 1.1531755915317559, 1.1369294605809128, 1.06051666400893, 1.0988775150973542, 2.0, 1.150298004664421, 1.3962264150943395, 1.0891662866697067, 1.0411966819204457, 1.0643459915611815, 1.1221198156682028, 1.1459748088336528, 1.0938294543320946, 1.029810298102981, 1.0595238095238095, 1.094361334867664, 1.3333333333333333, 3.0, 1.0426427546093473, 5.0, 1.625, 2.259259259259259, 1.009297520661157, 1.0736701009251473, 1.0914189568143577, 1.0756972111553784, 1.1428571428571428, 1.0830882352941176, 1.00774068698597, 1.1209677419354838, 1.3333333333333333]
origin-bjaq_15.71 	max: 5.0000	99th: 2.5050	95th: 1.7143	median: 1.0859	mean: 1.1843

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.123568 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.129499