Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 22, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.7525	95th: 1.6941	median: 1.0832	mean: 1.1775
ReportEsts: [1.0606060606060606, 1.0026109660574412, 1.0374766720194435, 1.0947368421052632, 1.5, 1.0, 1.062691131498471, 1.08630371212342, 1.0, 1.016971279373368, 1.1367269789051453, 1.0429342459453244, 1.05121412803532, 1.0953488372093023, 1.0692334864005653, 1.0, 1.0555555555555556, 1.0584484590860785, 3.0, 2.0, 1.037037037037037, 1.1067354050312663, 1.0863502556422042, 1.1409277745155608, 1.0631475086334485, 1.0, 1.1652297282549384, 1.5, 1.4, 1.0287769784172662, 1.0, 1.046423451961704, 1.0014414725196201, 1.0560488346281909, 1.1038331619914818, 1.2229673787050837, 1.1764705882352942, 1.0195326038520571, 1.1561402300433914, 1.1071428571428572, 1.1555555555555554, 1.0884146341463414, 1.0, 1.0289472929981944, 1.0796003330557868, 1.890625, 1.0618556701030928, 1.3180212014134276, 1.0233096157755641, 1.1203703703703705, 1.1274954504712498, 1.1254295532646048, 1.037950735804097, 2.0, 1.3194805194805195, 1.2280135301353015, 1.1224489795918366, 1.3333333333333333, 1.0522875816993464, 1.25, 1.13676844783715, 1.0983810709838107, 1.1136363636363635, 1.0, 1.0, 1.1544393830416366, 1.2923272035510462, 1.75, 1.0, 1.0033560175258693, 1.033292231812577, 1.062754212667054, 1.0398126463700235, 1.1081093868281604, 1.0729411764705883, 1.0384615384615385, 1.0, 1.1106471816283925, 2.0, 1.0080851617755535, 1.34375, 1.0432666659408376, 1.1901840490797546, 1.0832298136645964, 1.1104023552502453, 1.04, 1.0706920899400958, 1.0230506205016618, 1.0833333333333333, 1.75, 1.1158627548483342, 1.0468557916840675, 1.0591900311526479, 1.0182328190743337, 1.015769944341373, 1.0415584415584416, 1.0227272727272727, 1.163853028798411, 1.0, 1.2547021943573669, 1.0110871130309576, 1.118353344768439, 1.2251523928926549, 1.4166666666666667, 1.0160448476430792, 1.071409609769047, 1.2776233677696784, 1.11224876753887, 1.0502759043531575, 1.3333333333333333, 1.6666666666666667, 1.064252336448598, 1.0600037918799599, 1.0505369551484522, 1.12987012987013, 1.0606770587309085, 1.0, 1.098076316619363, 1.1346362649294246, 1.0, 1.0054945054945055, 1.1666666666666667, 1.1854636591478698, 1.0123661600172618, 1.040226760891512, 1.0666666666666667, 1.8, 1.228476821192053, 1.0, 1.1785714285714286, 1.0991708499044075, 1.3, 1.0978190104166667, 1.032098827460167, 1.06377837950427, 1.0253671562082778, 1.0167130919220055, 1.0136399064692128, 1.039972432804962, 1.0743449116392443, 1.0114587017858465, 1.218045112781955, 1.0110893672537509, 1.1570018619707683, 2.0, 1.0209662716499543, 1.0, 1.1094287680660702, 1.092465149108876, 1.5, 1.1874545894889803, 1.08, 1.02880658436214, 1.1074561403508771, 1.102189781021898, 1.0280762564991335, 1.101952657540644, 1.1299164458936213, 1.0626262626262626, 1.125, 1.2448979591836735, 1.4680851063829787, 1.0382916053019147, 1.4285714285714286, 1.0860032578833483, 1.0450174991803216, 1.164989939637827, 1.3598407612389551, 1.1383866481223923, 1.1711059871193448, 1.305263157894737, 1.1782178217821782, 1.1112617410671057, 1.0535894843276037, 1.014667817083693, 1.0806608357628766, 1.0449367088607595, 1.134543536547844, 1.021907682629551, 1.0, 1.0952380952380953, 1.0317414094350612, 1.0279106858054226, 1.200532978014657, 1.3157894736842106, 1.1088218697096996, 1.3050163367288103, 1.0923316667748848, 1.1153846153846154, 1.2795454545454545, 1.0901987748468558, 1.0, 1.0, 1.0555667648601752, 1.0652962515114872, 1.0333492139113865, 1.25, 1.0488745980707395, 1.0435522076694226, 1.0444942831190478, 1.0626410835214446, 1.0516496258037313, 1.195945945945946, 1.0491803278688525, 1.2352941176470589, 1.0, 1.4678899082568808, 1.0734899858066551, 1.32404181184669, 1.2873563218390804, 1.013346515076619, 1.0031277926720286, 1.0426387052981316, 1.059427366551992, 1.18602680634725, 1.0056818181818181, 1.0375722543352601, 1.000648088139987, 1.0449192946177264, 1.0048139742796232, 1.0, 1.0869565217391304, 1.0649951746006736, 1.017609307422967, 1.1282360024081879, 1.106133979015335, 1.276949665154461, 1.0357142857142858, 1.0054701459829405, 1.1834708612686953, 1.0137221269296741, 1.0847457627118644, 1.0325551509959305, 1.0321083172147, 1.1700787401574804, 2.0, 1.2750828562820127, 1.0746985261277355, 1.152836380684482, 1.1452991452991452, 1.0, 1.6666666666666667, 1.1257276516417227, 1.0727272727272728, 1.0520383369330453, 1.5, 1.0, 1.1764705882352942, 1.010928961748634, 1.0612244897959184, 1.0386740331491713, 1.1139240506329113, 1.0686106346483706, 1.0050377833753148, 1.1126768742378197, 1.0, 2.0, 1.117512799950651, 1.2175438596491228, 1.1103327495621715, 1.0135816594626663, 1.1079407957679104, 1.0220757068818473, 1.1001589825119238, 1.104519127510871, 1.0227272727272727, 1.055294807861543, 1.0375782881002087, 1.1818181818181819, 1.006955112309944, 1.2118863049095607, 1.2045454545454546, 1.5625, 1.0642414860681115, 1.0555555555555556, 1.0341880341880343, 1.1233833523988965, 1.0222841225626742, 1.3609022556390977, 1.0339860468196018, 1.0205479452054795, 1.0076916932375672, 1.0555294196713598, 1.25, 1.0757548199345217, 2.5, 1.0378152732879533, 1.0043196544276458, 1.029293159164353, 1.0526315789473684, 1.6666666666666667, 1.391304347826087, 1.0597014925373134, 1.0654249775032856, 1.0, 1.021875, 1.0769230769230769, 1.0052083333333333, 1.0163851586822175, 1.1317365269461077, 1.10062893081761, 1.0034849177330896, 1.1233433974257112, 1.0941150732881209, 1.1025641025641026, 1.0, 1.1205250596658711, 1.2807570977917981, 1.130281690140845, 1.0802443133951138, 1.0546288573811509, 1.0889570552147239, 1.1568627450980393, 1.0068587105624143, 1.028935492434298, 1.2857142857142858, 1.0053362449444077, 1.05, 1.0, 1.1360414842381787, 1.1428571428571428, 1.4, 1.0186014074684588, 2.0, 1.2181069958847737, 1.0145348837209303, 1.0557834290401968, 1.0783034257748776, 1.2682119205298013, 1.0705882352941176, 1.102409394066478, 1.0581615183012423, 1.050071530758226, 1.0402432679103013, 1.0994339911274285, 2.0, 1.0, 1.0386549052766287, 1.25, 1.0691578360290017, 1.3529411764705883, 1.0, 1.4666666666666666, 1.3353413654618473, 1.0569561157796452, 1.162162162162162, 1.0238095238095237, 1.0, 1.1511318242343542, 1.0886474887681887, 2.0, 1.3537820131030376, 1.0, 1.0990207242086085, 1.0113636363636365, 1.0397533455785883, 1.1497695852534562, 1.1363636363636365, 1.4493827160493826, 1.2685185185185186, 1.0296784525389424, 1.014582448541593, 1.0790229885057472, 1.0, 1.0769230769230769, 1.5714285714285714, 1.5, 1.1428571428571428, 1.0686091062995633, 1.3333333333333333, 1.021630615640599, 1.3116883116883118, 1.2508319863078825, 1.0729202089164422, 1.2245108135942326, 1.0369692532942898, 1.0104408352668213, 1.0773809523809523, 1.5, 1.0278372591006424, 1.1191489361702127, 1.0452930836401724, 1.0952380952380953, 1.5714285714285714, 1.032183908045977, 1.0293237582286057, 1.023682681299868, 1.0024509803921569, 1.1464387464387464, 1.026265389876881, 1.0125, 1.0907770515613653, 1.0752118644067796, 1.1923076923076923, 1.0269121813031161, 1.1714285714285715, 1.039159370608854, 1.0460199784601885, 1.0644834661195341, 1.0348837209302326, 1.0471698113207548, 1.084848484848485, 1.0, 1.0148927620674066, 1.0290306595816465, 1.0687436750036143, 1.048572243413782, 1.0399761336515514, 1.1585637114712424, 1.8333333333333333, 1.2024361948955917, 1.2, 1.2263023057216054, 1.25, 1.040979527202805, 1.0289855072463767, 1.099097162510748, 1.0711462450592886, 1.0604255319148936, 3.0, 1.13271400132714, 1.0078398650259495, 1.1707053522162958, 2.0, 1.1111111111111112, 1.272552783109405, 1.3231939163498099, 1.1090698444223768, 1.1247401247401247, 1.05, 1.1380500431406384, 1.010318772136954, 1.118248601719676, 1.1042039182150354, 1.1896929824561404, 1.0597539543057997, 1.1666666666666667, 2.142857142857143, 1.0794520547945206, 1.5, 1.2237061769616027, 1.121212121212121, 1.0749436898505222, 2.272727272727273, 1.0935849972689202, 1.1191462303871866, 1.0672424429364589, 1.0, 1.2258064516129032, 1.16, 1.28495, 1.2735229759299782, 1.0, 1.0568737679783895, 1.0776611770067217, 1.0696228760878574, 1.5, 3.0, 1.007766990291262, 1.013623978201635, 1.0098360655737706, 1.1111111111111112, 1.0816364755304633, 1.035190615835777, 1.4705882352941178, 1.0549529190207156, 1.0545454545454545, 1.1614173228346456, 1.0008064516129032, 1.3946150610012622, 1.0888805550346896, 1.0, 1.0571428571428572, 1.0719888841986773, 1.052578464843925, 1.031579203267317, 1.0, 1.1088254810882547, 1.011728125502763, 1.0214772132006287, 2.0, 1.036682615629984, 1.0663420266572956, 1.0361527364795242, 1.0651347691232362, 1.021289162244377, 1.021701018715944, 1.0142857142857142, 1.18297974927676, 2.0, 1.014832807897049, 1.5416666666666667, 1.25, 1.1191709844559585, 1.1346153846153846, 1.0125946054079284, 1.0719489981785064, 1.030152722824321, 1.1298760899495182, 1.0558760683760684, 1.0971188962532126, 1.0587110047736283, 1.197674418604651, 4.0, 1.017596927139599, 1.125506072874494, 1.0474922141480054, 1.0544019336089239, 1.099949264332826, 1.2035466461063993, 2.458823529411765, 2.2857142857142856, 1.0023549508876823, 1.030661927735006, 1.021274629403719, 1.1023138105567607, 1.0685499421519475, 1.0319148936170213, 1.0635924711471432, 1.0334448160535117, 1.2058371735791091, 3.0, 1.0, 1.0300157977883095, 1.0803059273422562, 1.1266540642722118, 1.1183510638297873, 1.0408163265306123, 1.3355704697986577, 1.148905109489051, 1.0963855421686748, 1.0604599559754737, 1.2555555555555555, 1.0218554300280076, 2.0, 1.145679012345679, 1.1111111111111112, 1.236842105263158, 1.083240223463687, 1.1132764920828258, 1.0079681274900398, 1.0103761348897535, 1.1229417489967068, 1.0, 1.446808510638298, 1.0, 1.5, 1.1704545454545454, 1.0625, 1.007716049382716, 1.0970873786407767, 1.0632809996795898, 1.1044083526682134, 1.0969936114242766, 1.182947454365195, 1.0410534469403563, 1.0756019479232928, 1.0335195530726258, 1.1096520026263952, 1.0290275761973875, 1.0444904293843766, 1.2095375722543353, 1.1226529376135674, 1.0557441848679876, 1.1589510016724194, 1.0745925147827728, 2.0, 1.2481572481572483, 1.0734126984126984, 1.4615384615384615, 1.0, 1.186046511627907, 1.25, 1.2203023758099352, 1.4074074074074074, 1.1666666666666667, 1.0241789313419851, 1.135116598079561, 1.0252657854574614, 1.0509240897913856, 1.2108108108108109, 1.1182065217391304, 1.0, 1.1323529411764706, 1.0099317194289261, 1.0723165192445614, 1.0840605381749981, 1.0922656338990773, 1.0231596663251865, 1.122077922077922, 1.1637053087757314, 1.1385435168738898, 1.046550216382268, 1.103550518646812, 1.2727272727272727, 1.0680127523910734, 1.0, 1.2387640449438202, 1.2066772002544477, 3.0, 1.1275862068965516, 1.0597274705141417, 1.4285714285714286, 1.0056877875593233, 1.2, 1.1176470588235294, 1.0515576010783678, 1.6153846153846154, 1.0189321151033923, 1.0192225544639044, 1.3571428571428572, 1.0689655172413792, 1.0783505154639175, 1.0086083213773314, 1.034878587196468, 1.0531057674005457, 1.1567765567765569, 1.0, 1.0067890506191615, 1.0914634146341464, 2.0, 1.0006924088905302, 1.106747988580327, 1.1031220435193945, 1.0185647425897035, 1.0042128983270875, 1.0353982300884956, 2.0, 1.00456447318372, 1.038709677419355, 1.1804082602277162, 1.149099271751629, 1.0166389063391523, 1.0477159057663106, 1.0952380952380953, 1.126571668063705, 1.1839464882943145, 1.0580070985855803, 1.0858044164037854, 1.147644927536232, 1.0808823529411764, 1.0655116050997058, 3.0, 1.1427886631913236, 1.019466963923794, 1.031112218478838, 1.7272727272727273, 1.22774614636856, 1.3969072164948453, 1.1428571428571428, 1.0667277985469423, 1.0420575865415722, 1.1528384279475983, 1.0588235294117647, 1.3333333333333333, 1.07283656489389, 1.5, 1.1144859813084111, 1.0833333333333333, 1.045007326774126, 1.44, 1.2151898734177216, 1.0251572327044025, 1.0, 1.8412698412698412, 1.175249807840123, 1.25, 2.0, 1.1176470588235294, 1.2448275862068965, 1.0398763523956724, 1.2202304737516005, 1.090289608177172, 1.2182890855457227, 1.1014466214978942, 1.0545454545454545, 1.1395348837209303, 1.4, 1.1538461538461537, 1.0, 1.0769230769230769, 1.0649350649350648, 1.137396694214876, 1.0158930638880117, 1.104387282231088, 1.0568643734428953, 1.0681750807814308, 1.1353021978021978, 1.1671348314606742, 1.0182260024301337, 1.5714285714285714, 1.0, 1.2592592592592593, 1.0559611444183046, 1.1129744042365401, 1.107843137254902, 1.0689655172413792, 1.00893470790378, 1.0324585635359116, 1.0097612480606792, 1.1142857142857143, 1.2941176470588236, 1.0273764258555134, 1.071712619300106, 1.0753387444640181, 1.0002908629374512, 1.0328947368421053, 1.0457072266831378, 1.0391713804764866, 1.1109530583214793, 1.3518329938900204, 1.125, 1.044811320754717, 1.0935960591133005, 1.2093023255813953, 1.0794117647058823, 1.0701001430615165, 1.0, 1.1317829457364341, 1.0180279556792176, 1.08, 1.0565599152994372, 1.0052966101694916, 1.1944444444444444, 1.0346215074520224, 1.0304614275414563, 1.0497246843943058, 1.0543893129770991, 1.0408626560726448, 1.2059673089339722, 1.1814345991561181, 1.3571428571428572, 1.0, 1.25, 1.069516773646603, 1.3333333333333333, 1.177289571201694, 1.1109794841419418, 1.011200716845878, 1.0764647467725919, 1.0505541580533486, 1.1078242229367632, 1.014336917562724, 1.0388349514563107, 1.0128724728203442, 1.1034870641169854, 1.040707390686189, 1.244700710586535, 1.6666666666666667, 1.0847457627118644, 1.0118577075098814, 1.0807653644840376, 1.01628664495114, 1.3012345679012345, 1.0161870503597121, 2.220779220779221, 1.0076033033519307, 1.0348993288590604, 1.081877990430622, 1.1875, 1.0670581036876663, 1.0327560562802387, 1.3063851699279094, 1.0581052631578947, 1.2307692307692308, 1.1014150943396226, 1.0923913043478262, 1.4375, 1.044107803417298, 1.6923076923076923, 1.2112332112332111, 1.1070559610705597, 1.0392431674842326, 1.0415643633812697, 1.0143198090692125, 2.75, 1.087378640776699, 1.0801683885436966, 1.0432246235901994, 1.013877561185165, 1.028052279247689, 1.08977478320544, 1.0769230769230769, 1.0856898029134534, 1.0836100800937682, 1.0165883767898882, 1.0140280561122244, 1.0277777777777777, 1.0777453838678328, 1.025057092108602, 1.3593287265547878, 1.0291793858861555, 1.0, 1.3333333333333333, 1.0569803950653909, 1.0130856901646264, 1.2328819016952364, 1.0914836437772217, 1.0606544293695133, 1.1111111111111112, 1.1024336871987461, 1.09149573634478, 1.1121323529411764, 1.022099447513812, 1.043859649122807, 1.1053109507681735, 1.1071428571428572, 1.75, 1.0626696111715395, 1.1718912253374871, 1.049670855774985, 1.0227272727272727, 1.2074583635047067, 1.0024058686506971, 1.1579983131852685, 1.2903225806451613, 1.2692307692307692, 1.0411051212938005, 1.1255924170616114, 1.140625, 1.5925925925925926, 1.0917644429545201, 1.1813676907829533, 1.1650082918739635, 1.048780487804878, 1.014458153609523, 1.0724164425662697, 1.0680053547523427, 1.2459893048128343, 1.3333333333333333, 1.0, 2.0, 1.1414141414141414, 1.1538461538461537, 1.0, 1.1538461538461537, 1.0410596026490067, 1.0634057971014492, 1.0222988788961438, 1.0180282420842723, 1.0363636363636364, 1.2830188679245282, 1.0666666666666667, 1.0, 1.1081081081081081, 1.0769230769230769, 1.1403197158081706, 1.0344751896152313, 1.0316389002263366, 1.3333333333333333, 1.0475574977944646, 1.0472248636204393, 2.5, 1.0686519682896125, 1.263537906137184, 3.0, 2.0, 1.219526627218935, 1.1227856271964427, 1.061972757281799, 1.2173913043478262, 1.0, 1.1889400921658986, 1.4570552147239264, 3.0, 2.0, 1.0586090127637406, 1.2513778733700767, 1.0633802816901408, 1.6666666666666667, 1.029063670411985, 1.0433772269558481, 1.035031847133758, 1.0, 1.0234741784037558, 1.0246605727039146, 1.263157894736842, 1.1738465460107061, 1.0501153972964061, 1.1971830985915493, 1.0625, 1.0647815437865744, 1.0502242152466368, 1.0950413223140496, 1.1311475409836065, 1.0126319588559054, 1.5154772937905467, 1.0620946955876986, 1.3916666666666666, 1.1862745098039216, 1.2388059701492538, 1.1123439667128987, 1.0540708514605346, 1.0141719052101996, 1.0982640352557962, 1.064410480349345, 1.5, 1.6666666666666667, 1.1324234481876878, 1.1631486367634125, 1.1151526940283991, 1.0244535535891803, 1.087472821542064, 1.1069023569023568, 1.3008849557522124, 1.0208333333333333, 1.0821476299033095, 1.1064494257360646, 1.2314949201741654, 1.1103327495621715, 2.5, 1.0416666666666667, 1.0646799203218373, 1.1722689075630253, 1.0146728291493874, 1.1047260262054326, 1.0440340909090908, 1.6, 1.1160365058670143, 1.0278785606369722, 1.1571852867260681, 1.1787072243346008, 1.0946097363276595, 1.0605095541401275, 1.2196467991169977, 1.0237681159420289, 1.0317681512852057, 1.070839296237057, 1.0184331797235022, 1.0832177531206657, 1.0, 1.221967007726039, 1.057546393637444, 1.011889035667107, 1.028123180214435, 1.146045918367347, 1.0363086232980332, 1.2, 1.262734584450402, 1.6666666666666667, 2.0, 1.1176470588235294, 1.0155844155844156, 1.0213270142180095, 1.051708650654169, 1.0012274924083657, 1.0591587516960652, 1.0746402877697843, 1.201086956521739, 1.1951219512195121, 1.0378655555321732, 1.6, 1.5, 1.2236370871468365, 1.1428571428571428, 1.0189959294436906, 1.1279127416955874, 1.1081701957650818, 1.108600736881401, 2.0, 1.0170278637770898, 1.180232558139535, 1.036443525458775, 1.040501114709579, 1.130050505050505, 1.1212328767123287, 1.1558961892542823, 1.1145358599184456, 1.06070826306914, 1.290909090909091, 1.0824022346368716, 1.0, 1.0, 1.0415265906083473, 5.0, 1.5714285714285714, 2.347826086956522, 1.0122100122100122, 1.119047619047619, 1.1042128603104213, 1.0996469203609258, 1.0, 1.091247672253259, 1.014018691588785, 1.0825242718446602, 1.3341346153846154, 1.4285714285714286, 1.0008841732979663, 1.1967849223946785, 1.1318681318681318, 1.1007809594644848, 1.0171723348851889, 1.1370491135113103, 1.1443359952676724, 1.0, 1.228497694292846, 1.0424960038538178, 1.0001793400286945, 1.1774193548387097, 1.0561335837182155]
origin-bjaq_15.71 	max: 5.0000	99th: 2.7525	95th: 1.6941	median: 1.0832	mean: 1.1775

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 13.953068 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[6.5565109e-07 5.9604645e-07 9.5367432e-07 5.3644180e-06 5.9604645e-08]
Distance score: 1.5258789289873675e-06
SAUCE Drift detection: False
Detection latency: 0.0233s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.042943 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 7.0000	99th: 3.0000	95th: 1.6912	median: 1.0791	mean: 1.1790
ReportEsts: [1.0564516129032258, 1.0274303269694975, 1.0428428512884795, 1.0693739424703892, 1.375, 1.0, 1.0955882352941178, 1.057316885787792, 1.1666666666666667, 1.0151024811218985, 1.122183938510469, 1.0421228978931039, 1.0497586334942444, 1.2032520325203253, 1.024933998239953, 1.2653061224489797, 1.205211726384365, 1.380952380952381, 1.25, 1.093062605752961, 1.0876265466816648, 1.1010653952557536, 1.2688172043010753, 1.0335628227194493, 1.0147286005196263, 1.0178567354202792, 3.0, 1.1491699510330826, 1.75, 1.4, 1.0433597621407333, 1.0, 1.0406655022090445, 1.0096140287908115, 1.0510715914272686, 1.047323600973236, 1.231740839973555, 1.1853546910755148, 2.0, 1.0671538613470275, 1.0267084877863322, 1.061579585785525, 1.1575682382133996, 1.10667861945316, 1.043557168784029, 1.0429692652684341, 1.0909090909090908, 1.0106732348111658, 1.0833333333333333, 1.0297783933518005, 1.0, 1.262672811059908, 1.0711297071129706, 1.0625, 1.0258858917610232, 1.0278640369282417, 1.1055938697318008, 1.0348027842227379, 1.0638297872340425, 1.0422298749666261, 1.4029850746268657, 1.174797931365162, 1.069277108433735, 1.0338345864661653, 1.00990099009901, 2.3333333333333335, 1.143466754879259, 1.3129161118508654, 1.6, 1.0, 1.0187601327877711, 1.001, 1.069131060969755, 1.0348837209302326, 1.0533057851239669, 1.1014851485148516, 1.0529907755982653, 1.1727748691099475, 1.5533980582524272, 1.1112450129184812, 1.004354136429608, 1.0127388535031847, 1.0, 1.3333333333333333, 1.0895691609977325, 1.278688524590164, 1.103448275862069, 3.0, 2.0, 1.1178187650360867, 1.1098934093979882, 1.1955360448511134, 1.0616013280551653, 1.112564222326016, 1.015228426395939, 1.0151338766006985, 1.0569395017793595, 1.017150395778364, 1.236842105263158, 1.2740478994895956, 1.32, 1.25, 1.040776119402985, 1.1544023819651212, 1.0723589001447178, 1.240082975471286, 1.3214285714285714, 1.0172109963944103, 1.1056620597414177, 1.2778651292802237, 1.1044112980006346, 1.0398060729778005, 1.2857142857142858, 1.3333333333333333, 1.06558013193636, 1.0714716195485425, 1.0455026455026455, 1.053191489361702, 1.0598905739360336, 1.0, 1.0256075254768748, 1.1441605839416058, 1.0, 1.0528846153846154, 1.125, 1.1971252566735113, 1.0395314701391796, 1.0928668434327102, 1.056910569105691, 1.8333333333333333, 1.135135135135135, 1.0, 1.2, 1.145140428677014, 1.2307692307692308, 1.0013706140350878, 1.0364647076989946, 1.0769041163421247, 1.25, 1.6428571428571428, 1.029723991507431, 1.0354924578527063, 1.0717896865520729, 1.032993892873151, 1.2564102564102564, 1.006050605060506, 1.1527717286714136, 3.0, 1.0007462686567163, 1.010597302504817, 1.0912698412698412, 1.0920047031158142, 1.5, 1.31726502622025, 1.0354330708661417, 1.0100840336134453, 1.1023706896551724, 1.0, 1.0121765601217656, 1.1255509381689963, 1.070205134405352, 1.1091854419410745, 1.0722222222222222, 1.2333333333333334, 1.4, 1.0196078431372548, 1.7142857142857142, 1.0259405159773825, 1.1578947368421053, 1.0602564102564103, 1.0113279766544743, 1.026049766718507, 1.0297389816003424, 1.2784588441330997, 1.2307692307692308, 1.0099065721649485, 1.2923588039867109, 1.0071994240460762, 1.0311986863711002, 1.0443104352385946, 1.0876106194690265, 1.2202226152085718, 1.1847133757961783, 1.7857142857142858, 1.0058331137826957, 1.0733169920336163, 1.3, 1.0226854211727536, 1.0637254901960784, 1.5, 1.3037249283667622, 1.092538614314087, 1.2727272727272727, 1.1409802930773119, 1.020912547528517, 1.0418713414540952, 1.0970113295197619, 1.054263565891473, 1.0123897445825116, 1.0302453210147398, 1.0146520146520146, 1.1081268011527377, 1.029935851746258, 1.0795331687402172, 1.0620592383638927, 1.0543793376087147, 1.427927927927928, 1.1343283582089552, 1.2962962962962963, 1.0, 1.3687943262411348, 1.0626307531380754, 1.2658959537572254, 1.25, 1.0032679738562091, 2.1666666666666665, 1.0442266453664926, 1.0172786177105833, 1.2050195827671648, 3.0, 1.069879518072289, 1.0024187046492878, 1.032907092190098, 1.0094730552771567, 1.4, 1.1027918781725887, 1.1334090123883322, 1.005632397319094, 1.0465116279069768, 1.0467445742904842, 1.138976626658244, 1.0670017836873682, 1.2692307692307692, 1.007534352613332, 1.050745533830356, 1.088145896656535, 1.0517711171662125, 1.0439189189189189, 1.7272727272727273, 1.1277705345501956, 2.0, 1.2464197530864198, 1.1052607032926034, 1.0910689857338285, 1.2129963898916967, 1.0, 2.0, 1.0820598395690615, 1.088235294117647, 1.111002052288748, 1.2, 1.0508666164280331, 1.0150300601202404, 1.0, 1.0184783722635218, 1.0092378752886837, 1.1026339691189828, 1.015748031496063, 1.0035100035100035, 1.0288309509212352, 1.0, 2.0, 1.0770034246575342, 1.034350014806041, 1.0507042253521126, 1.0132463011314186, 1.0947348906192065, 1.0473992569305517, 1.077733860342556, 1.0966928210016866, 1.0270676691729324, 1.0410102224894768, 1.049511330684137, 1.0, 1.0032328992680797, 1.0718336483931947, 1.1666666666666667, 1.434782608695652, 1.1715741789354472, 1.0544959128065394, 1.034420305938546, 1.0335095766658497, 1.0486111111111112, 1.345114345114345, 1.0229952976577668, 1.1111111111111112, 1.1269510658540975, 1.0619679001672648, 1.0, 1.0362537764350452, 1.0049019607843137, 1.0407488820969903, 1.0649890782667037, 1.052303616851548, 1.1050420168067228, 1.2110552763819096, 1.036631072767131, 1.0014276002719238, 1.1530268351145314, 1.0689257754852493, 1.0374531835205993, 1.135135135135135, 1.2307692307692308, 1.0884435739038723, 1.0833333333333333, 1.0497237569060773, 1.0312257905486302, 1.0816346911374708, 1.5, 1.1217391304347826, 1.018427980443776, 1.1711711711711712, 1.0571418754080335, 1.1818181818181819, 1.135201688555347, 1.0134630512930305, 1.1320754716981132, 1.1333333333333333, 1.9090909090909092, 1.027783951989331, 1.4285714285714286, 1.01178234099481, 1.0268562401263823, 1.0454545454545454, 1.1239127464820802, 1.2608695652173914, 1.2142857142857142, 1.0112314452299807, 4.0, 1.3076923076923077, 1.0554870530209617, 1.051948051948052, 1.026630800268998, 1.0803571428571428, 1.1717171717171717, 1.103387251310376, 1.0989598469846376, 1.087378640776699, 1.0148042937914834, 1.0636369242153296, 3.0, 1.0, 1.0671124933221399, 1.2, 1.068435754189944, 1.6470588235294117, 2.0, 1.4736842105263157, 1.3238967527060783, 1.0812943962115233, 1.1071428571428572, 1.1011673151750974, 1.197674418604651, 1.5, 1.082119391292137, 1.0, 1.1940298507462686, 1.0215265144846741, 1.1062992125984252, 1.0007418397626113, 1.0093457943925233, 1.75, 1.0, 1.372093023255814, 1.2987012987012987, 1.071957671957672, 1.126540004720321, 1.241246585547554, 1.0342298288508558, 1.0, 1.0347567117513143, 1.069767441860465, 1.5, 1.3333333333333333, 1.265625, 1.0, 1.032537960954447, 1.1923076923076923, 1.20291141487662, 1.082169799676171, 1.0304555084745763, 1.0639247048582776, 1.1246947082767977, 1.0039525691699605, 1.1028315946348732, 1.134136409265678, 1.122657580919932, 1.1111111111111112, 1.0097481990615294, 1.0474673946011526, 1.229, 1.0097087378640777, 1.0238095238095237, 1.1097804391217565, 2.0, 1.1041666666666667, 1.511111111111111, 1.191699604743083, 1.39, 1.1774891774891776, 1.0648648648648649, 1.6899696048632218, 1.0411176011963343, 1.0691489361702127, 1.0519716692189893, 1.1603773584905661, 1.0962962962962963, 1.1253196930946292, 1.0, 1.1120319573901465, 1.66, 1.104396123401281, 1.0160123341225704, 1.0282711422519146, 1.1580774365821094, 1.875, 1.175625579240037, 1.1666666666666667, 1.1485148514851484, 1.1666666666666667, 1.1061119147816938, 1.0408921933085502, 1.0379428160402806, 1.1475409836065573, 1.0309704060564349, 4.0, 1.0886143931256713, 1.001473312324523, 1.1300770912438154, 3.0, 1.1066666666666667, 1.265982636148382, 1.3782894736842106, 1.0998285322359396, 1.0429681698925797, 1.1538461538461537, 1.1061046511627908, 1.043817037152184, 1.0662923953365129, 1.0236761818456426, 1.063454803836979, 1.0019986675549633, 1.0761904761904761, 1.027956003666361, 1.112134453107775, 1.184873949579832, 1.032626427406199, 1.0, 1.5, 1.2446043165467626, 1.1155378486055776, 1.0216178521617851, 1.1198878510020456, 1.0877100840336134, 1.0, 1.191304347826087, 1.0294117647058822, 1.0628920614319706, 1.0869565217391304, 1.0, 1.041839541280127, 1.6666666666666667, 1.0, 1.0092236740968485, 1.75, 1.03022424439389, 1.0052473763118441, 1.0914127423822715, 1.3, 1.0721400187261776, 1.056244830438379, 1.45, 1.0687887270782876, 1.037313432835821, 1.1167023554603854, 1.061904761904762, 1.3699115044247787, 1.022372782218756, 1.0, 1.0238095238095237, 1.3272525786377973, 1.0369278510473234, 1.050592885375494, 1.4, 1.0801765354909894, 1.004371913601357, 1.0204882301656495, 2.0, 1.0238484155504737, 1.039344864159256, 1.0202658803538407, 1.0163496830163496, 1.0127141032979614, 1.0075786796209618, 1.0013898540653232, 1.0643860474494253, 1.75, 1.0569560354469587, 1.0361842105263157, 1.042311411992263, 1.0841020075963104, 1.095367847411444, 1.0033468503499612, 1.614814814814815, 1.0285379296043133, 1.1788461538461539, 1.13668681880109, 1.0857142857142856, 1.1271190666134823, 1.06363704989809, 1.0454545454545454, 1.2345679012345678, 1.0893005393141648, 1.04149377593361, 1.0101175538238014, 1.0568808884573853, 1.3333333333333333, 1.0451099317664898, 1.2485875706214689, 2.0, 1.0576923076923077, 1.0080478221155664, 1.098939929328622, 1.0609689711486119, 1.0, 1.4444444444444444, 1.0009057971014492, 1.1443139257746, 1.0335869363518277, 1.024061781976002, 1.0849923430321593, 1.0532374100719424, 1.0132924335378324, 1.0727995849904894, 1.5393258426966292, 1.0183603558917445, 1.0306220095693779, 1.0776699029126213, 1.0874455191766974, 1.0, 1.0026554802955665, 4.0, 1.1238348868175765, 1.0863309352517985, 1.0056644842834128, 1.0827886710239651, 1.105, 1.13003663003663, 1.1153238546603474, 1.1003359804520465, 1.0, 1.2549019607843137, 1.0, 1.3333333333333333, 1.1592920353982301, 1.4634146341463414, 1.0240963855421688, 1.110204081632653, 1.055857048312376, 1.0974051896207584, 1.0650681281875618, 1.151393100833965, 1.1096887573417196, 1.0724706389397693, 1.0135356571483978, 1.1199557766721946, 1.0505102724644342, 1.0582968136295323, 1.0458089668615984, 1.075, 1.1723237597911227, 1.0903225806451613, 1.0068829496055385, 1.17018779342723, 1.1037405601006922, 1.2777777777777777, 1.1949640287769785, 1.0974504249291785, 2.0, 1.0176263219741482, 1.1111111111111112, 1.3333333333333333, 1.1762589928057554, 1.0364574043196713, 1.040377358490566, 1.0129533678756477, 1.0158730158730158, 1.1017541032046634, 1.0432342233009708, 1.0649819494584838, 1.2, 2.0, 1.1263581247373793, 1.1830357142857142, 1.134840532902705, 1.0941724941724942, 1.0, 1.2505787037037037, 1.220556745182013, 1.064583745956295, 1.1251862891207154, 1.0317288186296965, 1.067603117089393, 1.0148324683673309, 1.402061855670103, 2.0, 1.1439512347608627, 1.0, 1.0411280846063455, 1.2, 1.2890295358649788, 1.1794538361508453, 1.7727272727272727, 1.0547123054286378, 1.1884057971014492, 1.011173184357542, 1.0307492822080206, 1.2042525773195876, 1.1275476660092045, 1.0107944323454219, 1.0008857395925599, 1.0760416666666666, 1.3333333333333333, 1.0315577968639194, 1.0736907687515143, 1.0434782608695652, 1.013157894736842, 1.2110290497291973, 1.3125, 1.0211643140511117, 1.5555555555555556, 1.0247349823321554, 1.0063427010148323, 1.2697674418604652, 1.1871345029239766, 1.0838820705583987, 1.037313432835821, 1.8571428571428572, 1.018812844631852, 1.0142083897158323, 1.091068747698496, 1.142357801080394, 1.0006150120600021, 1.118468681145735, 1.1859756097560976, 1.1184439041333796, 1.2331460674157304, 1.0468654397125237, 1.0672575599582899, 1.19665907365224, 1.0341419586702605, 1.0029638825987743, 1.0781049935979514, 1.0960194963444354, 1.2272727272727273, 1.3333333333333333, 1.0952380952380953, 1.5876641918903485, 1.054828660436137, 1.0771349862258952, 1.0769230769230769, 1.0364372469635628, 1.030512168543407, 1.2760736196319018, 1.0666035678278225, 2.0, 1.031079782121115, 2.0, 1.119140625, 1.1333333333333333, 1.0328365160689335, 1.3548387096774193, 1.1850533807829182, 1.046207497820401, 1.0, 1.120068147937815, 1.26525017135024, 1.2, 1.3333333333333333, 1.1830985915492958, 1.2209631728045325, 1.029344220464404, 1.2218683651804672, 1.1006993006993007, 1.0336605890603086, 1.0862944162436547, 1.047972972972973, 1.1455938697318007, 1.3277027027027026, 1.09375, 1.5, 1.1803921568627451, 1.0866983372921615, 1.0353753235547887, 1.0434352517985612, 1.0911527438700774, 1.087890258985795, 1.071723158609619, 1.1542469879518071, 1.1691772885283893, 1.0045362903225807, 2.0, 1.0, 1.2727272727272727, 1.004733196835267, 1.075127644055434, 1.1628571428571428, 1.09375, 1.0001909125620465, 1.0196439324221458, 1.0096327003883865, 1.216867469879518, 1.1428571428571428, 1.2317596566523605, 1.0772759935879719, 1.0625958966420899, 1.1260992696378, 1.0227272727272727, 1.0501200664983683, 1.007581360418731, 1.0434638932021931, 1.1074074074074074, 1.1119658186541879, 1.0761245674740485, 1.0566336633663367, 1.2746478873239437, 1.0443264259825957, 1.5, 1.0204081632653061, 1.0, 1.0194552529182879, 1.0028799351000541, 1.126984126984127, 1.0802598005103223, 1.07909604519774, 1.25, 1.0505534428179906, 1.0186621933319353, 1.0579482284238306, 1.018181818181818, 1.0425531914893618, 1.2005687897730473, 1.221415607985481, 1.4375, 1.0, 1.3333333333333333, 1.0722964517821822, 1.4285714285714286, 1.1700016537125848, 1.1102257636122177, 1.0234880710190495, 1.044426362896664, 1.0429139858093497, 1.1914665714540749, 1.0445103857566767, 1.0725995316159251, 1.0279200137799283, 1.1154522024367386, 1.0383407783460044, 1.2234122604595163, 1.25, 1.0564102564102564, 1.0199335548172757, 1.0797985918744228, 1.0354223433242506, 1.2777654128644558, 1.0045045045045045, 2.1588447653429603, 1.046520370582763, 1.0685393258426967, 1.0218162964144697, 1.2105263157894737, 1.0472323963343777, 1.0241824686814602, 1.3255913978494624, 1.060499472388322, 1.3, 1.0847457627118644, 1.0769230769230769, 1.055651409596979, 1.0313653136531364, 1.0186308630152754, 1.3333333333333333, 1.0218343697003958, 1.0506883604505632, 1.0127064803049555, 1.0584132519616392, 1.0349907918968693, 1.0347826086956522, 1.0268161872257435, 1.004679678006693, 1.0479774223894638, 1.0661575995690884, 1.0604514868678099, 1.0, 1.0754583921015515, 1.0971255133011961, 1.0455860643637438, 1.015862524785195, 1.0021074815595363, 1.1407035175879396, 1.105263157894737, 1.0571791613722998, 1.025496739949216, 1.0317460317460319, 1.1056625802685347, 1.224381345177665, 1.0502402795980779, 1.0720268006700167, 1.0649387152241965, 1.0721527178602244, 1.0097592713077423, 1.0685483870967742, 1.10452042409797, 1.1000553403431101, 1.0939907550077042, 1.0186046511627906, 1.070250458155162, 1.0748251391228876, 1.1443298969072164, 1.4, 1.0548398233787, 1.1770776677907102, 1.0292825768667642, 1.0193236714975846, 1.1924460431654675, 1.0440815190424901, 1.187632759027614, 1.0937293729372937, 1.0909090909090908, 1.0584307178631052, 1.2624113475177305, 1.1288659793814433, 1.4285714285714286, 1.0957206264131982, 1.1937086092715232, 1.2213740458015268, 1.0192307692307692, 1.1081081081081081, 1.093071354705274, 1.07, 1.1935483870967742, 1.0289230769230768, 1.0416666666666667, 1.0525581395348838, 1.1538461538461537, 1.0237058237929317, 1.3264248704663213, 1.02226148409894, 1.2608695652173914, 1.6666666666666667, 1.3642918950100953, 1.0080029778522241, 1.050887673068334, 1.1348148148148147, 1.203125, 1.2352941176470589, 1.0263157894736843, 1.0, 1.0240963855421688, 1.0051546391752577, 1.0312811333817395, 1.032747398852867, 1.2758620689655173, 1.0697494261123168, 1.0468783223197349, 4.0, 1.0027020609355681, 1.1552636068930218, 2.0, 2.25, 1.1600397614314115, 1.111797887662026, 1.102986137745877, 1.2952127659574468, 1.0, 1.0921985815602837, 1.2402088772845954, 1.131578947368421, 1.0114225191461625, 1.103845942379591, 1.034267568779404, 1.040368491874547, 1.4285714285714286, 1.0084284499102114, 1.0266497461928934, 1.0076726342710998, 1.1887550200803212, 1.0211267605633803, 1.0, 1.0833333333333333, 1.1614187666998481, 1.03344724201296, 1.6557377049180328, 1.0482315112540193, 1.0691943476767578, 1.0714285714285714, 1.05, 1.5, 1.0614754938469844, 1.3195696032279758, 1.002584170112227, 1.0101522842639594, 1.1382113821138211, 1.1787010891488503, 1.125, 1.084532924961715, 1.0228426395939085, 1.0150822421148677, 1.0487364620938628, 2.5, 1.1196172248803828, 1.0491610738255033, 1.178740444120859, 1.143135029988653, 1.0516209523094817, 1.0669165625433847, 1.1318732693206746, 1.2255125284738042, 1.0714285714285714, 1.096767848947748, 1.1102888272175968, 1.3108371187540557, 1.063664596273292, 2.3333333333333335, 1.069767441860465, 1.2084095063985374, 1.0059970014992503, 1.0141409877585479, 1.0907476240609042, 1.0231591448931117, 1.8, 1.09261186264308, 1.00772297191058, 1.195868400918133, 1.1661341853035143, 1.0753486246280262, 1.03125, 1.2468354430379747, 1.0241141732283465, 1.0313003619255527, 1.0680470970361349, 1.0352380952380953, 1.0813287514318441, 1.0263157894736843, 1.20917225950783, 1.0069395454806733, 1.0075005593038728, 1.1026484751203853, 1.1307732226258433, 1.032398753894081, 1.3333333333333333, 1.1740041928721174, 2.0, 1.6666666666666667, 1.2, 1.0063965884861408, 1.066579634464752, 1.0139910482331216, 1.0006664029564059, 1.131812420785805, 1.0269183709141758, 1.2322274881516588, 1.0207547169811322, 1.0341204126026244, 1.5, 1.4375, 1.007581911724885, 1.1111111111111112, 1.1154761904761905, 1.13625, 1.0371755903670796, 1.0886547855857318, 2.0, 1.1991679667186688, 1.0884615384615384, 1.0815565741674116, 1.0405050616996152, 1.154171066525871, 1.1323316960416066, 1.1320155053000938, 1.0313745481508945, 1.0486486486486486, 1.303030303030303, 1.0786773090079818, 1.3333333333333333, 3.0, 1.0413111725997402, 7.0, 1.625, 2.0, 1.0, 1.0761889528684154, 1.0328507795100224, 1.0790513833992095, 1.0, 1.1676528599605522, 1.02880859375, 1.26, 1.2719836400817996]
origin-bjaq_15.71 	max: 7.0000	99th: 3.0000	95th: 1.6912	median: 1.0791	mean: 1.1790

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.075999 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.099546