Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 71, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.5025	95th: 1.6677	median: 1.0817	mean: 1.1695
ReportEsts: [1.0317460317460319, 1.025, 1.034105869247573, 1.0833333333333333, 1.5, 1.0, 1.042537233472624, 1.0506255373325755, 1.0, 1.0304232804232805, 1.1316480535595763, 1.0428166956709917, 1.0401922236784622, 1.1395348837209303, 1.0204874602613918, 1.0, 1.1222222222222222, 1.0318809776833155, 3.0, 2.0, 1.2272727272727273, 1.1198319165378672, 1.091338296713274, 1.0645918966529653, 1.1119881598421313, 1.0, 1.1695695037791654, 1.2, 1.2, 1.014388489208633, 1.0, 1.047039553774984, 1.0091038826829388, 1.0593784683684795, 1.0872374798061388, 1.244659785127449, 1.1016042780748663, 1.0125589468973895, 1.142916178800193, 1.0833333333333333, 1.1174785100286533, 1.1310975609756098, 1.0, 1.0457921873634537, 1.120463187003111, 1.8615384615384616, 1.03, 1.2084805653710247, 1.02292335840618, 1.1203703703703705, 1.0453538151599093, 1.0601374570446735, 1.0392520412297508, 2.0, 1.2181818181818183, 1.2144757849920171, 1.107085346215781, 1.3461538461538463, 1.0124223602484472, 1.25, 1.1448336968375137, 1.0952677459526774, 1.1045454545454545, 1.12987012987013, 1.0909090909090908, 1.0147796891765601, 1.316112366806587, 1.75, 1.0, 1.0674932413535938, 1.0084235860409145, 1.0639906922629436, 1.0206896551724138, 1.105755157924555, 1.0870588235294119, 1.08, 1.0, 1.108141962421712, 2.0, 1.0329564693391489, 1.1428571428571428, 1.0308758189622713, 1.1595092024539877, 1.1237113402061856, 1.1442590775269872, 1.0, 1.0642754589272896, 1.0058538649614444, 1.0833333333333333, 1.75, 1.1484135107471853, 1.067566216303651, 1.074766355140187, 1.0196353436185133, 1.0054794520547945, 1.0233766233766233, 1.0384615384615385, 1.1512770137524557, 1.0, 1.228972475052089, 1.0802613159122725, 1.0866209262435678, 1.209259654363132, 1.3076923076923077, 1.021977607601977, 1.0265463233342182, 1.2828032855939342, 1.0985968904057641, 1.0453709380748006, 1.1666666666666667, 1.6666666666666667, 1.0925233644859813, 1.074544086718248, 1.0581174984207202, 1.0649350649350648, 1.0619813343422877, 1.0, 1.120466729738253, 1.1188436830835118, 1.0, 1.065934065934066, 1.1666666666666667, 1.1954887218045114, 1.0162358908693454, 1.085268307835676, 1.1313131313131313, 1.8, 1.1556291390728477, 1.0, 1.0, 1.1023300037828057, 1.1818181818181819, 1.0628255208333333, 1.0238715795687918, 1.0569098961135714, 1.0453938584779707, 1.0465753424657533, 1.0366328916601715, 1.039972432804962, 1.0706886045094455, 1.0078853751700847, 1.3278688524590163, 1.0352250489236792, 1.0985140743084543, 2.0, 1.0209662716499543, 1.0245901639344261, 1.117117117117117, 1.127227810128816, 1.5, 1.2711310244611287, 1.1175496688741722, 1.037344398340249, 1.1074561403508771, 1.0193452380952381, 1.033715441672286, 1.1560413987384408, 1.115930361276039, 1.0583501006036218, 1.0592105263157894, 1.2448979591836735, 1.2432432432432432, 1.0058910162002945, 1.2857142857142858, 1.0620616193750565, 1.0095845183722332, 1.1760324983073798, 1.3459875060067275, 1.1568904593639575, 1.1228167819564814, 1.3136842105263158, 1.1638141809290954, 1.0948000387334174, 1.042149631190727, 1.0682027649769585, 1.0427599611273082, 1.0515923566878982, 1.1489873135989317, 1.069812062593379, 1.0, 1.135135135135135, 1.0347546728971964, 1.0287081339712918, 1.184487291849255, 1.013157894736842, 1.0900808718378618, 1.2636940226792235, 1.0844533904724802, 1.1372549019607843, 1.325909090909091, 1.082901811769673, 1.0, 1.2727272727272727, 1.0336951696864534, 1.0079455164585698, 1.0138312586445366, 1.4583333333333333, 1.0392282958199357, 1.057487269868511, 1.0692661649810669, 1.0626410835214446, 1.0445873300305681, 1.0338983050847457, 1.0158730158730158, 1.2352941176470589, 1.0, 1.3793103448275863, 1.1245860274404669, 1.3205574912891986, 1.2298850574712643, 1.0113692535837864, 1.0031277926720286, 1.0218662464985995, 1.0827877039174343, 1.1057885665038782, 1.1534090909090908, 1.130718954248366, 1.0016202203499676, 1.0248865529323914, 1.0052380624899708, 1.0, 1.0476190476190477, 1.1073602111358398, 1.0113835132549664, 1.1661481020535158, 1.0207692708604785, 1.2717297762478486, 1.0357142857142858, 1.0060326143484017, 1.2302733367715317, 1.0157924421883813, 1.0491803278688525, 1.1639304683727667, 1.0015497869043006, 1.1653543307086613, 2.0, 1.1978488536654401, 1.0991514068780706, 1.1380684481950305, 1.201793721973094, 1.0, 1.6666666666666667, 1.1276797805174021, 1.1272727272727272, 1.1511391750673905, 1.5, 1.0, 1.0810810810810811, 1.0441061670569867, 1.010204081632653, 1.0386740331491713, 1.1540084388185654, 1.0631399317406143, 1.0033698399326032, 1.1373376434834788, 1.0175438596491229, 2.0, 1.0998807394156231, 1.1849743881616392, 1.1260945709281962, 1.0344712252022492, 1.1117573977863113, 1.005491515361401, 1.0715421303656598, 1.062021372110628, 1.0311004784688995, 1.0004171301446052, 1.0339004570848147, 1.1, 1.0033153949644436, 1.1383495145631068, 1.1590909090909092, 1.25, 1.0069571585499817, 1.0555555555555556, 1.0086206896551724, 1.1050400376825247, 1.0405797101449274, 1.3258145363408522, 1.0300179292066176, 1.1067780872794801, 1.0202317689992957, 1.0581903933073187, 1.25, 1.0618224809021461, 1.6666666666666667, 1.0366457287532742, 1.043196544276458, 1.0305129488871694, 1.0526315789473684, 2.0, 1.434782608695652, 1.0757575757575757, 1.0769568034133221, 1.0, 1.0186915887850467, 1.0271493212669682, 1.0084134615384615, 1.0160424701454394, 1.1666666666666667, 1.169811320754717, 1.0081117840165514, 1.144216762163737, 1.0811067877215736, 1.1196581196581197, 1.0, 1.1479713603818615, 1.2378048780487805, 1.106896551724138, 1.0961246840775063, 1.007139857202856, 1.1601307189542485, 1.3409090909090908, 1.0205761316872428, 1.0149638802889578, 1.2857142857142858, 1.005927949068108, 1.0419847328244274, 1.0555555555555556, 1.0793016637478108, 1.2857142857142858, 1.4, 1.004746507745303, 2.0, 1.1618655692729767, 1.0334302325581395, 1.0713699753896637, 1.0605695948656237, 1.0435967302452316, 1.123456790123457, 1.11293442822549, 1.0864552144949409, 1.0237099023709901, 1.0498067470667733, 1.0273013150371642, 2.0, 1.125, 1.0580794807925227, 1.25, 1.0721476510067114, 1.3529411764705883, 1.0, 1.375, 1.395582329317269, 1.0530232558139534, 1.0932203389830508, 1.0595238095238095, 1.0, 1.1584553928095873, 1.0771986862621503, 2.0, 1.3073257891602144, 1.0, 1.096303044105367, 1.0987654320987654, 1.0623458409866178, 1.1382488479262673, 1.1363636363636365, 1.267818574514039, 1.2685185185185186, 1.018972560591345, 1.0202085071979972, 1.0821325648414986, 1.0, 1.0769230769230769, 1.5714285714285714, 1.5, 1.2307692307692308, 1.069657509810917, 1.3333333333333333, 1.016638935108153, 1.160919540229885, 1.2014430102289333, 1.081308256384769, 1.2533470648815654, 1.0140745288811222, 1.013921113689095, 1.075, 1.5, 1.256544502617801, 1.0468085106382978, 1.0483957654723126, 1.0952380952380953, 1.5714285714285714, 1.0022271714922049, 1.0225921521997623, 1.0150853814648555, 1.0074074074074073, 1.1464387464387464, 1.0216142270861832, 1.0526315789473684, 1.0907770515613653, 1.0794491525423728, 1.1153846153846154, 1.0269121813031161, 1.2058823529411764, 1.0553577869430897, 1.0497826832894888, 1.0155406607746604, 1.0886075949367089, 1.099009900990099, 1.088145896656535, 1.0, 1.0055939287563296, 1.0520747435876707, 1.0449501731571136, 1.0532126008579612, 1.0736064059131507, 1.1496663489037178, 1.8333333333333333, 1.09973474801061, 1.2, 1.1699402220324508, 1.25, 1.0378803256873492, 1.0043668122270741, 1.0994196044711952, 1.0474308300395256, 1.1337579617834395, 3.0, 1.1768355739400207, 1.0022532973048381, 1.210502115137024, 2.0, 1.126984126984127, 1.2428023032629558, 1.2340425531914894, 1.1282569347981648, 1.2536382536382535, 1.105263157894737, 1.100086281276963, 1.0066375300909154, 1.0667542654641742, 1.0897277287069271, 1.061951754385965, 1.0580431177446104, 1.003787878787879, 2.142857142857143, 1.0368421052631578, 1.5, 1.2288348700754401, 1.1379310344827587, 1.0801042452506686, 2.5, 1.086955210375509, 1.143051092130815, 1.0876002467612584, 1.0, 1.14, 1.16, 1.2864293938028732, 1.061269146608315, 1.0, 1.0396437805228382, 1.1084607171688237, 1.0990468296726068, 1.5, 2.0, 1.0129819040125885, 1.0145454545454546, 1.0132890365448506, 1.1111111111111112, 1.0910759431034018, 1.0423228346456692, 1.4705882352941178, 1.0671563088512241, 1.0454545454545454, 1.0918635170603674, 1.0201612903225807, 1.4076567101388304, 1.0453018120724828, 1.0, 1.0422535211267605, 1.0662876137158852, 1.023114894155618, 1.0213283199896275, 2.0, 1.101968591019686, 1.007791389086802, 1.0214772132006287, 1.0, 1.0649920255183414, 1.0445152010621688, 1.015868342803309, 1.0399283561224935, 1.022492441757069, 1.0207059938403222, 1.020583190394511, 1.0887174541947926, 2.0, 1.0526125381156648, 1.5416666666666667, 1.0, 1.150259067357513, 1.1538461538461537, 1.0083502481540783, 1.0818014705882353, 1.0908595676357589, 1.3244607618173474, 1.0793359948549308, 1.0539699715947517, 1.0281967705768809, 1.1444444444444444, 4.0, 1.0010418917296844, 1.1402834008097167, 1.0489482657225513, 1.0237528893833745, 1.0948756976154237, 1.1649253731343283, 2.2717391304347827, 2.2857142857142856, 1.006049917946457, 1.06940157989148, 1.0000092418025213, 1.1288411699370604, 1.0320092556883917, 1.024742268041237, 1.0779762496663543, 1.0722961249277039, 1.2039877300613497, 3.0, 1.0909090909090908, 1.053680981595092, 1.0761904761904761, 1.0567375886524824, 1.089378238341969, 1.0240963855421688, 1.1179775280898876, 1.148905109489051, 1.0963855421686748, 1.0632647747982296, 1.2282608695652173, 1.0326132146651679, 2.0, 1.099526066350711, 1.0120481927710843, 1.4387755102040816, 1.0720670391061453, 1.0269662921348315, 1.0434782608695652, 1.146562905317769, 1.0902218655344706, 1.0, 1.1063829787234043, 1.2, 1.0, 1.1363636363636365, 1.0544354838709677, 1.0077760497667185, 1.087378640776699, 1.0637616148670297, 1.0846867749419953, 1.0473422671904993, 1.2039411206077872, 1.037837837837838, 1.1063120072933983, 1.0571428571428572, 1.131949095780308, 1.0198355104015482, 1.0863599677159, 1.3222543352601157, 1.1657232704402516, 1.0379567222419297, 1.205938981042654, 1.0816504774156999, 2.0, 1.2702702702702702, 1.072348860257681, 1.3818181818181818, 1.0, 1.1590909090909092, 1.25, 1.0721062618595825, 1.2962962962962963, 1.1666666666666667, 1.0008820899490078, 1.1372961173878773, 1.0309436353759798, 1.0233258669962153, 1.1837837837837837, 1.1197278911564625, 1.0, 1.1755725190839694, 1.0024139595834196, 1.0641352564613382, 1.0852950380750375, 1.0517143182594828, 1.0328335056876938, 1.1974025974025975, 1.094233903830481, 1.103019538188277, 1.033197300266834, 1.1226397334287166, 1.2727272727272727, 1.0771704180064308, 1.0, 1.2387640449438202, 1.2088849601184113, 3.0, 1.1317489616982004, 1.075716012646457, 1.4285714285714286, 1.0159194876486735, 1.2, 1.1176470588235294, 1.0461971622272441, 1.6923076923076923, 1.035289994319761, 1.0431439555745408, 1.3103448275862069, 1.16, 1.134020618556701, 1.0119560019129603, 1.0662251655629138, 1.056625393895025, 1.1572181082525383, 1.0, 1.0381273082772104, 1.1371951219512195, 2.0, 1.0189180297048317, 1.1250886754909595, 1.1012298959318827, 1.0244897959183674, 1.0322099461482062, 1.0089285714285714, 1.7142857142857142, 1.1018440905280804, 1.028225806451613, 1.0936317513108105, 1.2059533386967016, 1.008526987596052, 1.0683068864152467, 1.2747252747252746, 1.0726256983240223, 1.120401337792642, 1.0696293298898523, 1.0782334384858043, 1.0222222222222221, 1.0372899159663866, 1.0657405504381459, 3.0, 1.1463949749045772, 1.0232726089123514, 1.016602850627747, 1.4615384615384615, 1.249548673795306, 1.1338912133891212, 1.1428571428571428, 1.044861395217606, 1.0420575865415722, 1.1506550218340612, 1.0294117647058822, 1.3333333333333333, 1.0700362647325476, 1.5, 1.0093457943925233, 1.0, 1.0297257693112831, 1.3846153846153846, 1.1645569620253164, 1.0566037735849056, 1.0, 1.687830687830688, 1.2115689381933439, 1.25, 2.0, 1.1083333333333334, 1.1689655172413793, 1.018468059339994, 1.2032828282828283, 1.118881118881119, 1.2153392330383481, 1.1014466214978942, 1.0597402597402596, 1.225, 1.3020408163265307, 1.0833333333333333, 1.0, 1.2256473489519113, 1.0952380952380953, 1.0330578512396693, 1.1475448817025324, 1.047442355184977, 1.0060747274694184, 1.0903418017964603, 1.1461827646038172, 1.1169354838709677, 1.0263319044703, 1.5714285714285714, 1.0, 1.2592592592592593, 1.0231539804204295, 1.0944395410414829, 1.107843137254902, 1.0913978494623655, 1.0277205040091637, 1.0853309714982649, 1.0006772318909107, 1.1142857142857143, 1.2222222222222223, 1.0250379362670714, 1.1158536585365855, 1.0599987016780812, 1.0350776386893767, 1.0394736842105263, 1.0701417601890135, 1.0132770203666914, 1.0455153949129852, 1.3884928716904277, 1.125, 1.0462919225318847, 1.458128078817734, 1.1555555555555554, 1.0515759312320916, 1.0701001430615165, 1.0, 1.0788177339901477, 1.0013603238866398, 1.0555555555555556, 1.0666539297399278, 1.0419426048565121, 1.2285714285714286, 1.103403561306882, 1.053604902667628, 1.0718170829975826, 1.0276717557251909, 1.0227014755959138, 1.2019644369178661, 1.206896551724138, 1.1428571428571428, 1.0, 1.25, 1.0611360058132493, 1.3333333333333333, 1.2902645625435136, 1.0695977599483064, 1.0059813912272928, 1.0466732869910627, 1.0537033798805926, 1.0754555198285103, 1.007168458781362, 1.0513176144244105, 1.006917603963651, 1.076490438695163, 1.044955920657183, 1.2138684812718294, 1.4285714285714286, 1.0, 1.0276679841897234, 1.1178897015494471, 1.022801302931596, 1.281545528235612, 1.0560747663551402, 2.1645569620253164, 1.0395009605673802, 1.0818791946308726, 1.0930023923444976, 1.1875, 1.047131292212835, 1.0447362390775177, 1.34375, 1.0581052631578947, 1.1851851851851851, 1.1559405940594059, 1.0806451612903225, 1.625, 1.0658107670730392, 1.6923076923076923, 1.1071428571428572, 1.1290322580645162, 1.0498988536749831, 1.0218513420509292, 1.0253317249698433, 2.75, 1.087378640776699, 1.1051693076951359, 1.0582643480193343, 1.015571009656392, 1.012843399781811, 1.0397088583915786, 1.0833333333333333, 1.0755517826825127, 1.1657936688681394, 1.0112951471047815, 1.0200400801603207, 1.0208333333333333, 1.102795311091073, 1.0074219741182442, 1.3265895953757225, 1.0380707442087913, 1.0, 1.3333333333333333, 1.0608420480110756, 1.0072278911564625, 1.2219458393955038, 1.1245297006764896, 1.0646448523543495, 1.0416666666666667, 1.088880346176972, 1.0726372666386255, 1.1268382352941178, 1.0393258426966292, 1.0042194092827004, 1.102844450989054, 1.0833333333333333, 1.75, 1.0262392835922247, 1.1797585795723688, 1.0251315020455873, 1.0, 1.2128892107168718, 1.001383722143031, 1.1633398931684003, 1.3651877133105803, 1.2307692307692308, 1.0795148247978437, 1.0969976905311778, 1.13125, 1.5357142857142858, 1.0497597496927031, 1.197224975222993, 1.1724709784411278, 1.024390243902439, 1.040672752198482, 1.0560891279293123, 1.0701807228915663, 1.1779560308972075, 1.3333333333333333, 1.2173913043478262, 1.3333333333333333, 1.1334029954719609, 1.1538461538461537, 1.0, 1.1538461538461537, 1.0582781456953643, 1.0471014492753623, 1.0844437558103501, 1.055592912618095, 1.18, 1.3333333333333333, 1.1428571428571428, 1.0, 1.0945945945945945, 1.0571428571428572, 1.1630434782608696, 1.026944611415411, 1.0307966309227858, 1.3473684210526315, 1.049923746606211, 1.0475902107001651, 2.5, 1.0717226361811438, 1.2433392539964476, 3.0, 2.0, 1.1455621301775147, 1.0874273829161587, 1.0429517196835136, 1.2732919254658386, 1.5, 1.167420814479638, 1.147239263803681, 3.0, 2.0, 1.0098425196850394, 1.1657480844199488, 1.0413594901911782, 1.6666666666666667, 1.0224665505167543, 1.04570100697134, 1.0529157667386608, 1.0, 1.051643192488263, 1.026268856485458, 1.2894736842105263, 1.1166343355965083, 1.0693547448653051, 1.2686567164179106, 1.05078125, 1.105746531215255, 1.0635785649409628, 1.0661157024793388, 1.2545454545454546, 1.061773559833652, 1.4366543665436655, 1.0551158086730816, 1.2994011976047903, 1.2156862745098038, 1.2835820895522387, 1.072192513368984, 1.0511310814998451, 1.0065403472110592, 1.0536271316344128, 1.0262008733624455, 1.5, 1.6666666666666667, 1.1040081825736752, 1.1728232189973615, 1.1766193347597744, 1.014610768154539, 1.029101856497742, 1.0921926910299002, 1.2782608695652173, 1.0434782608695652, 1.0827765112805596, 1.1326046310944915, 1.2450476889214968, 1.1465863453815262, 1.6666666666666667, 1.0, 1.0531623073059537, 1.1984536082474226, 1.023601903127681, 1.0863799313820275, 1.0291193181818181, 2.0, 1.07, 1.0193870686708058, 1.187799862919808, 1.064638783269962, 1.0766759643350976, 1.0318471337579618, 1.2417218543046358, 1.0353623188405796, 1.0320947601058212, 1.0794679686842328, 1.0357142857142858, 1.0611413043478262, 1.0, 1.175926856224254, 1.050278818904836, 1.0039787798408488, 1.0747211089416413, 1.123125, 1.040090771558245, 1.2857142857142858, 1.2329842931937174, 1.6666666666666667, 2.0, 1.1764705882352942, 1.0076726342710998, 1.0323854660347551, 1.001711118550757, 1.014627261451606, 1.0151967435549525, 1.0612970711297072, 1.201086956521739, 1.510204081632653, 1.0334041821867743, 1.6, 1.5, 1.1443989579456644, 1.1428571428571428, 1.0713266761768903, 1.1386386386386387, 1.1136203954632138, 1.0941471490480597, 2.0, 1.0106382978723405, 1.2034883720930232, 1.0380533264302356, 1.0401524812609522, 1.1186868686868687, 1.1167808219178081, 1.149402390438247, 1.1285445382233288, 1.0095389507154213, 1.0757575757575757, 1.094972067039106, 1.0, 1.0, 1.0417411752083259, 5.0, 1.4285714285714286, 1.9285714285714286, 1.0641848523748396, 1.0561797752808988, 1.0903547671840355, 1.0984699882306788, 1.0, 1.0974549968963376, 1.019859813084112, 1.1989247311827957, 1.2692307692307692, 1.4285714285714286, 1.0008849557522124, 1.021618625277162, 1.1784897025171626, 1.0059857837635615, 1.0217207511278146, 1.0522395096652521, 1.1106181603076013, 1.0, 1.1900410373566865, 1.031859730492688, 1.0323708751793401, 1.1774193548387097, 1.058066812426908]
origin-bjaq_15.71 	max: 5.0000	99th: 2.5025	95th: 1.6677	median: 1.0817	mean: 1.1695

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 13.952155 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[3.5762787e-06 4.0531158e-06 1.0132790e-06 3.4570694e-06 1.0728836e-06]
Distance score: 2.6345253445470007e-06
SAUCE Drift detection: False
Detection latency: 0.0230s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.030900 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 6.0000	99th: 3.0000	95th: 1.8082	median: 1.0840	mean: 1.1896
ReportEsts: [1.0581717451523547, 1.0333117023577763, 1.0475201371864697, 1.0569514237855946, 1.5833333333333333, 2.0, 1.0854016298020954, 1.0489565672586354, 1.2, 1.0351262349066959, 1.1633335739898443, 1.0438126310883244, 1.0458181818181818, 1.2, 1.0659958567623558, 1.103448275862069, 1.2384105960264902, 1.0682926829268293, 1.5454545454545454, 1.1256410256410256, 1.0863397743773038, 1.0015331000560717, 1.1526315789473685, 1.0050675675675675, 1.0183277473981303, 1.0339852804821512, 4.0, 1.1544015885432337, 2.0, 1.0, 1.0535958435876402, 2.0, 1.0539253706418272, 1.0101785082796475, 1.1063732232920678, 1.0042986981085729, 1.2282368384689788, 1.1501103752759383, 1.8076923076923077, 1.079830936105061, 1.0759293680297397, 1.0803838662169225, 1.1725888324873097, 1.0385454545454544, 1.0131086142322097, 1.0586514208844795, 1.380952380952381, 1.0355160932297447, 1.1442307692307692, 1.0300400534045393, 1.075, 1.2197309417040358, 1.0714285714285714, 1.0588235294117647, 1.0209678202203563, 1.0248804229252328, 1.0863787375415281, 1.2049180327868851, 1.0204081632653061, 1.0785778741987218, 1.5573770491803278, 1.0920059944337401, 1.1029185867895546, 1.0898876404494382, 1.0594059405940595, 1.9090909090909092, 1.060981580074659, 1.2336804673609347, 1.6, 1.0, 1.0532021993340044, 1.0593132154006244, 1.0721549636803873, 1.036468330134357, 1.1365658362989324, 1.0360902255639097, 1.043026706231454, 1.392638036809816, 1.5339805825242718, 1.0600694094700889, 1.04369918699187, 1.875, 1.0, 1.1666666666666667, 1.0883352208380521, 1.1159420289855073, 1.226691042047532, 1.162162162162162, 1.0, 1.0990762717300662, 1.1170421896264933, 1.265183202275389, 1.0342116719162122, 1.0795465192541929, 1.1343669250645996, 1.0094451003541913, 1.8666666666666667, 1.0473145780051152, 2.0, 1.3281929616449188, 1.2222222222222223, 2.0, 1.0345806782705385, 1.2950402713013989, 1.1090252707581227, 1.2133864428479977, 1.3333333333333333, 1.0267602940829812, 1.0608734009704455, 1.1771304940101768, 1.1182829888712242, 1.0448865085437389, 1.2857142857142858, 1.25, 1.073494917904613, 1.088594817846758, 1.027461139896373, 1.0434782608695652, 1.0605344387554567, 2.0, 1.1164817749603804, 1.1766917293233083, 1.0, 1.0093023255813953, 1.0, 1.2665289256198347, 1.017135242228407, 1.0553786155346117, 1.0826446280991735, 1.8333333333333333, 1.1056578050443082, 1.0, 1.1176470588235294, 1.1048520492556515, 1.25, 1.0462899931926481, 1.047388915930742, 1.0756373340824497, 1.25, 1.5, 1.0186721991701244, 1.1253961068356721, 1.0799180327868851, 1.0205362196788756, 1.2037037037037037, 1.0048569886670264, 1.1073338542565174, 3.0, 1.0272657450076805, 1.0028355387523629, 1.1164772727272727, 1.0853171669377495, 1.5, 1.1154235914065667, 1.1231190150478796, 1.013793103448276, 1.0327408793264734, 1.0, 1.082258064516129, 1.1295594624633727, 1.1204410161817724, 1.0582362728785357, 1.074585635359116, 1.375, 1.4210526315789473, 1.0112923462986199, 1.7142857142857142, 1.0447198338832897, 1.0, 1.0425, 1.088443780656998, 1.11864406779661, 1.0024620263728927, 1.2751677852348993, 1.1397205588822354, 1.118431689571544, 1.394648829431438, 1.0733812949640287, 1.0654429369513168, 1.0290956749672346, 1.172994880546075, 1.2064150846719444, 1.1835443037974684, 1.1826923076923077, 1.0165777254140966, 1.082286570584865, 1.2974910394265233, 1.032142498409616, 1.0169082125603865, 1.5, 1.28, 1.080899407267417, 1.25, 1.1329653788258907, 1.0970681130421842, 1.0332357990283638, 1.0371066340001427, 1.0505344995140913, 1.0076627004200849, 1.0640508431355882, 1.0169211721007017, 1.0719181612038755, 1.0033183218772221, 1.0617315746306208, 1.0709920075223318, 1.0288579975365124, 1.2740384615384615, 1.0142857142857142, 1.2839506172839505, 1.0, 1.3868613138686132, 1.1331668200341791, 1.32, 1.3142857142857143, 1.0048959608323134, 1.05, 1.0404962320336268, 1.0774647887323943, 1.212386549918036, 1.0666666666666667, 1.0968122786304604, 1.0213640098603123, 1.033546268442058, 1.0114573874065345, 1.5, 1.0681440984086694, 1.1125320112942412, 1.0029119145838388, 1.0421348314606742, 1.059773828756058, 1.0849268841394826, 1.0768826562448686, 1.3414634146341464, 1.0026640765274077, 1.007501530065077, 1.0853658536585367, 1.0051063829787235, 1.0223964165733483, 2.0, 1.0744611365120835, 2.0, 1.2713467762011452, 1.0981806337536644, 1.1103971962616823, 1.2481481481481482, 1.0, 1.6666666666666667, 1.0796038849742906, 1.1363636363636365, 1.1033300830304642, 1.2, 1.0582135710387484, 1.083, 1.4285714285714286, 1.0066857006899834, 1.0208333333333333, 1.1597160603371783, 1.0733590733590734, 1.0105226236408278, 1.1107637989116352, 1.0303030303030303, 2.0, 1.0813944500270543, 1.0495818399044206, 1.1082251082251082, 1.0276581274087508, 1.079095788228873, 1.0221153577319877, 1.0866710439921208, 1.0783802011553236, 1.0142927550517495, 1.0607632456465357, 1.073168031879566, 1.0714285714285714, 1.0348887649501146, 1.1814345991561181, 1.1923076923076923, 1.3333333333333333, 1.3614832071442438, 1.2293103448275862, 1.0115706206848698, 1.050158506516379, 1.180094786729858, 1.3787234042553191, 1.0220596259735106, 1.0490883590462834, 1.0585726637534176, 1.04658847234546, 1.0, 1.0175438596491229, 1.1284236153377967, 1.1066091761714008, 1.0924793937047077, 1.1159903812466159, 1.1363636363636365, 1.2116666666666667, 1.0344680548646152, 1.0287686605230046, 1.1002388362162554, 1.0207152523750185, 1.0478011472275335, 1.007936507936508, 1.0666666666666667, 1.0834086118638964, 1.1428571428571428, 1.0124555160142348, 1.009169842181274, 1.0096789358701364, 1.358974358974359, 1.007936507936508, 1.424936386768448, 1.1680041870202373, 1.086534859521332, 1.1363636363636365, 1.2600355239786856, 1.0256448141195906, 1.1477272727272727, 1.3333333333333333, 1.411764705882353, 1.0262018189692508, 1.4285714285714286, 1.0026122683889946, 1.0488958990536277, 1.2222222222222223, 1.128946736907061, 1.25, 1.3333333333333333, 1.0041389035783537, 3.0, 1.0, 1.0291970802919708, 1.0286123937841314, 1.0206896551724138, 1.06651376146789, 1.0824742268041236, 1.0902534003047577, 1.0849021454168557, 1.0931208053691275, 1.0459756977433619, 1.0514934945940992, 1.5, 1.0, 1.0489625288716666, 1.2, 1.0819366852886405, 1.0384615384615385, 2.0, 1.3888888888888888, 1.3935108153078204, 1.059968847352025, 1.0689655172413792, 1.0, 1.3246753246753247, 1.6666666666666667, 1.056333359753857, 1.2580645161290323, 1.1940298507462686, 1.0161893998326752, 1.110655737704918, 1.0344827586206897, 1.0151085930122756, 1.75, 1.0, 1.427592116538132, 1.0372670807453417, 1.2092746730083235, 1.1297660363104092, 1.2393194237456533, 1.1, 1.5, 1.034856991355676, 1.0909090909090908, 1.40625, 5.0, 1.2206896551724138, 1.4285714285714286, 1.3448275862068966, 1.1919191919191918, 1.1485457314861827, 1.099892995188423, 1.003297609233306, 1.1031767729236153, 1.1093122825796093, 1.2927927927927927, 1.096439169139466, 1.0363760114951222, 1.1483420593368237, 1.088235294117647, 1.0163713805413368, 1.059444676567782, 1.0691731606112742, 1.0430622009569377, 1.1282051282051282, 1.1178861788617886, 3.0, 1.0208333333333333, 1.0975609756097562, 1.1942307692307692, 1.3630136986301369, 1.152, 1.040187891440501, 1.1346153846153846, 1.038207932103803, 1.0844427538988208, 1.1015506671474937, 1.0104166666666667, 1.0, 1.1139896373056994, 1.0, 1.0966769520794615, 1.5686274509803921, 1.1046485303550542, 1.0509056839475328, 1.0618966977138018, 1.149604221635884, 1.625, 1.331923890063425, 1.0, 1.0476022566995769, 1.0909090909090908, 1.0946297610598534, 1.0060532687651331, 1.0886923901393355, 1.1133333333333333, 1.2514474772539288, 3.0, 1.1892125757138736, 1.0166339025299054, 1.0842427723530539, 4.0, 1.1486486486486487, 1.2697262479871176, 1.3685897435897436, 1.0798183652875883, 1.0717213114754098, 1.0, 1.0922087205146533, 1.0266915321405676, 1.0675080327271522, 1.0488601225344267, 1.0365089545611526, 1.1235821906212968, 1.14, 1.0141423357664234, 1.0931872990353697, 1.1391304347826088, 1.1243889190657252, 2.0, 1.5, 1.159468438538206, 1.12890625, 1.0553401480437081, 1.183215096073757, 1.0660134089736977, 1.0, 1.1724137931034482, 1.1, 1.054279362726936, 1.2173913043478262, 2.0, 1.0035058027079304, 1.0, 1.0, 1.0209627329192548, 2.0, 1.026800129157249, 1.0173847316704459, 1.021798365122616, 1.2, 1.0830342613851676, 1.0867003367003367, 1.55, 1.003880456892505, 1.0222222222222221, 1.1074197120708749, 1.0006680026720107, 1.2940968540120183, 1.0127628716461203, 2.0, 1.144578313253012, 1.078269694278828, 1.2130166787527195, 1.0558213716108453, 1.75, 1.127104532839963, 1.0057225585392287, 1.009918068132816, 2.0, 1.0361083249749248, 1.0631350159631443, 1.0209056659525744, 1.0585536377539873, 1.0096113022472732, 1.0120089766183706, 1.024355300859599, 1.0010875205242844, 3.0, 1.1004893543956045, 1.0172955974842768, 1.0588379504780583, 1.067574931880109, 1.0588235294117647, 1.016866665739672, 1.625, 1.0611298113267604, 1.0442917143948072, 1.0934919366406426, 1.1421800947867298, 1.1303697797269012, 1.0487106017191976, 1.0459770114942528, 1.2777777777777777, 1.11016933022884, 1.037190082644628, 1.014593057567466, 1.0562139677803413, 1.3333333333333333, 1.0007683442182098, 1.6228070175438596, 1.0086580086580086, 1.2156862745098038, 1.0151539875765587, 1.1228070175438596, 1.1683587140439933, 1.0, 1.0823529411764705, 1.0068321566841267, 1.1642129684914448, 1.037167812674224, 1.0169873106835858, 1.0921712302352486, 1.0007052186177716, 1.001015228426396, 1.0342626703658222, 1.6, 1.032821840907505, 1.0695533583361745, 1.0784313725490196, 1.11884148091457, 1.0618729096989967, 1.0045633420071014, 2.0, 1.1001326259946949, 1.0433333333333332, 1.0110896489035337, 1.086283185840708, 1.0884955752212389, 1.0632090761750406, 2.0, 1.0928930505512524, 1.0, 1.3728813559322033, 1.0, 1.6666666666666667, 1.169811320754717, 1.1201828870019594, 1.0291390728476821, 1.088235294117647, 1.060244161358811, 1.0196124212000934, 1.095071522268724, 1.1837577760497666, 1.0753106535907901, 1.0711312617494195, 1.0151163656012088, 1.0990795885219276, 1.1772001359157322, 1.039024027651311, 1.0272412085190687, 1.063169164882227, 1.1498079385403328, 1.2836879432624113, 1.0492241623789653, 1.1754385964912282, 1.099669473518533, 1.2865168539325842, 1.113762352374066, 1.0307692307692307, 2.0, 1.0399529964747356, 1.0625, 1.2222222222222223, 1.3266932270916334, 1.0546495871935464, 1.034133533383346, 1.0304568527918783, 1.0994475138121547, 1.1470019611388513, 1.015555686993553, 1.1224489795918366, 1.0, 3.0, 1.0147788507709545, 1.1327433628318584, 1.1149471974004874, 1.1130434782608696, 1.0, 1.3649588867805187, 1.196035242290749, 1.054828284147297, 1.151197604790419, 1.0507861091106352, 1.0699856723362604, 1.0008922777417262, 1.4456521739130435, 3.0, 1.1800215401184706, 1.0, 1.0307328605200945, 1.1974248927038627, 1.3930839802399435, 1.0861812778603268, 1.7727272727272727, 1.0279460094433195, 1.1095890410958904, 1.069693094629156, 1.0167392006397342, 1.2237442922374429, 1.0559311616472034, 1.013023517286611, 1.0194518125552607, 1.059375, 1.0, 1.020965401359505, 1.090047725996631, 1.2380952380952381, 1.0081911262798635, 1.1890308327730286, 1.2616279069767442, 1.0490874990983192, 1.3333333333333333, 1.0535714285714286, 1.086075143281681, 1.0942028985507246, 1.1137724550898203, 1.0452828213204435, 1.0291970802919708, 2.125, 1.0476825608536178, 1.0553656869446344, 1.088207420399734, 1.2012133468149646, 1.0117987511774473, 1.089431435899144, 1.2449612403100776, 1.0935494765282, 1.2541899441340782, 1.0812337272181054, 1.0854922279792747, 1.0106707317073171, 1.0096153846153846, 1.0142888448117953, 1.0892857142857142, 1.0532592713608888, 1.0869565217391304, 1.1428571428571428, 1.0975308641975308, 1.6109510086455332, 1.06131929389904, 1.16991643454039, 1.1428571428571428, 1.010492332526231, 1.0210714285714286, 1.0872093023255813, 1.0331685547545486, 2.0, 1.1410502958579882, 1.5, 1.0224032586558045, 1.0, 1.0461926578901584, 1.3225806451612903, 1.0816326530612246, 1.0246478873239437, 1.0, 1.3113442066331171, 1.2211088844355378, 1.5, 2.5, 1.08843537414966, 1.1152815013404827, 1.1063539678211072, 1.228813559322034, 1.1050359712230216, 1.209090909090909, 1.0505050505050506, 1.62015503875969, 1.155893536121673, 1.456445993031359, 1.15625, 1.0, 1.2166836215666328, 1.1239570917759236, 1.017933390264731, 1.0467409165601607, 1.0630403886405333, 1.0638305695481118, 1.0837856551144303, 1.1446958938876635, 1.2216808769792935, 1.0035496957403651, 1.7142857142857142, 1.5, 1.34375, 1.0270152201990528, 1.119047619047619, 1.115068493150685, 1.0100806451612903, 1.0114550485874252, 1.009292686187993, 1.0088531414041995, 1.1358024691358024, 1.4285714285714286, 1.2798165137614679, 1.0197883364568405, 1.0828710986008776, 1.0125933926443897, 1.0331491712707181, 1.0419485791610283, 1.1327630210794972, 1.0444993440182908, 1.1037593984962406, 1.0983664410687537, 1.0095846645367412, 1.1023007395234183, 1.029058116232465, 1.032058950913612, 1.4260869565217391, 1.0630833601544898, 1.0, 1.1419491525423728, 1.038521902413049, 1.1355932203389831, 1.0669670747431246, 1.024, 1.1162790697674418, 1.0781382320370008, 1.0301060451740458, 1.0903240248475012, 1.0118389897395421, 1.0467380720545278, 1.2059280608064198, 1.1234782608695653, 1.5333333333333334, 1.0, 1.1111111111111112, 1.054115085285697, 1.6666666666666667, 1.0518550978673677, 1.1125167935512763, 1.0162231133795114, 1.0705628424373237, 1.0691791496541687, 1.006601248884924, 1.0151057401812689, 1.0794930875576036, 1.0047735311609853, 1.072545365375184, 1.0497304452366092, 1.2306277247183932, 2.0, 1.0380761523046091, 1.0833333333333333, 1.0866743916570105, 1.0333333333333334, 1.2995694538862452, 1.0470219435736676, 2.2120141342756185, 1.0743895662406433, 1.072234762979684, 1.0814948716156159, 1.2941176470588236, 1.0487937655407824, 1.0396081466511875, 1.3042155584528465, 1.0450606585788562, 1.263157894736842, 1.0082644628099173, 1.4436392914653784, 1.0233812098948398, 1.0046948356807512, 1.0188080171102243, 1.3214285714285714, 1.0722726233132576, 1.0876320696084525, 1.0347490347490347, 1.114914425427873, 1.0269299820466786, 1.0875251509054327, 1.0752525252525253, 1.0096069144502688, 1.0900195694716244, 1.0443958620858116, 1.103640888006796, 1.2142857142857142, 1.0926724137931034, 1.1867666859011348, 1.0817293157311296, 1.0388349514563107, 1.0214323052796654, 1.083416087388282, 1.3157894736842106, 1.0369913686806411, 1.05097350195109, 1.3, 1.110850439882698, 1.2460169834209462, 1.0487329434697856, 1.1091854419410745, 1.8168654173764907, 1.085591657757325, 1.074517631403859, 1.0447470817120623, 1.112713793755291, 1.0667168027503222, 1.1109422492401215, 1.0412844036697249, 1.0166369578134284, 1.1219577071419071, 1.0571428571428572, 2.5, 1.0331237867967873, 1.162944216812619, 1.0226506024096385, 1.1065989847715736, 1.2556526982212843, 1.0026727736549166, 1.1486832906082498, 1.1348837209302325, 1.2857142857142858, 1.068194522079374, 1.4482758620689655, 1.1394736842105264, 1.2432432432432432, 1.0314164896985953, 1.180246913580247, 1.0, 1.0, 1.0060240963855422, 1.118895966029724, 1.0294117647058822, 1.1320754716981132, 1.033623910336239, 1.0039525691699605, 1.0565577766942955, 1.0769230769230769, 1.0090191540797984, 1.3220338983050848, 1.0327086485857293, 1.2695652173913043, 1.4, 1.369131455399061, 1.0789216825470602, 1.0458777979767142, 1.1, 1.403225806451613, 1.1176470588235294, 1.21875, 1.0674157303370786, 1.1477272727272727, 1.1574754901960784, 1.0260100718654908, 1.034423237541374, 1.4298245614035088, 1.0682004930156122, 1.0481909096603128, 3.0, 1.074669720507203, 1.161021311644188, 1.5, 2.25, 1.2488844819038176, 1.1126929058499822, 1.0782833682589916, 1.1725888324873097, 1.0, 1.0815602836879432, 1.288265306122449, 1.0677966101694916, 1.019558400804578, 1.1266498020237572, 1.0365475225028988, 1.0323275862068966, 1.7142857142857142, 1.0256625606569616, 1.045571245186136, 1.1232517482517483, 1.012779552715655, 1.0354191263282173, 2.0, 1.0909090909090908, 1.1531644249817536, 1.0032798064589457, 1.2592592592592593, 1.0220125786163523, 1.1173185074856835, 1.1613168724279836, 1.1149825783972125, 1.3650793650793651, 1.0427254498046112, 1.2260469740275879, 1.0850719586125621, 1.1867469879518073, 1.2586206896551724, 1.0018083182640145, 1.125, 1.0996913580246914, 1.0769230769230769, 1.0052027955466636, 1.0527272727272727, 1.5, 1.0404829545454546, 1.0274380165289256, 1.1807494489346069, 1.1902604756511892, 1.0245459008345605, 1.0425324222563102, 1.0881804365846919, 1.0539499036608864, 1.0357142857142858, 1.117650927265553, 1.071093984157568, 1.2077380952380952, 1.2527272727272727, 2.0, 1.0227272727272727, 1.0522374788232762, 1.0696594427244581, 1.0205089403050456, 1.089938621374624, 1.0223529411764707, 2.25, 1.0843881856540085, 1.0132630932325648, 1.1954110898661567, 1.32398753894081, 1.0782729735775893, 1.0, 1.3044692737430168, 1.0184645286686103, 1.0324218194579322, 1.0282893961749706, 1.034318398474738, 1.0885357548240635, 1.0526315789473684, 1.152732060566162, 1.001480176871768, 1.005846585594013, 1.0418693051595953, 1.0986570247933884, 1.009369144284822, 1.2635658914728682, 1.2433628318584071, 2.0, 2.5, 1.263157894736842, 1.0149253731343284, 1.0366666666666666, 1.0212933753943219, 1.0059011573974967, 1.0139205842081243, 1.021193232413179, 1.0952380952380953, 1.0300480769230769, 1.04725012571188, 1.6, 1.6923076923076923, 1.0800346720600982, 1.25, 1.008, 1.123497720679652, 1.0173926194797338, 1.1008486524591943, 2.5, 1.0616016427104722, 1.0797546012269938, 1.1677136512876962, 1.04164387125406, 1.1851063829787234, 1.105992085924251, 1.1401059220028888, 1.074439418727745, 1.0577716643741404, 1.4666666666666666, 1.1133651551312649, 1.0, 2.0, 1.0427093237876839, 6.0, 1.7142857142857142, 2.0, 1.0534188034188035, 1.0191026578604565, 1.1831626848691694, 1.0443548387096775, 1.1428571428571428, 1.0645073178168514, 1.0038186157517899, 1.4006734006734007, 1.283702213279678]
origin-bjaq_15.71 	max: 6.0000	99th: 3.0000	95th: 1.8082	median: 1.0840	mean: 1.1896

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.163772 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.174042