Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 18, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.5000	95th: 1.6667	median: 1.0769	mean: 1.1674
ReportEsts: [1.0260586319218241, 1.0247395833333333, 1.0405798359446206, 1.0590631364562118, 1.5, 1.0, 1.0769230769230769, 1.0539678200789888, 1.0, 1.016971279373368, 1.0977404553718293, 1.0430283052475413, 1.0582222222222222, 1.127906976744186, 1.010243730130696, 1.0, 1.0444444444444445, 1.0294013460857243, 3.0, 2.0, 1.08, 1.0714450760201488, 1.0913949204866786, 1.1350557839107458, 1.0769610261470153, 1.0, 1.1450684588710542, 1.5, 1.2, 1.0071942446043165, 1.0, 1.0518823241644615, 1.0008796319078785, 1.0893451720310765, 1.0889998531355558, 1.2243358614115794, 1.1149732620320856, 1.0002962387392855, 1.1677801501480818, 1.0714285714285714, 1.1095305832147937, 1.0030487804878048, 1.0, 1.0731452143241467, 1.1335897884245498, 1.8615384615384616, 1.0404040404040404, 1.1943462897526502, 1.0369831266517584, 1.0648148148148149, 1.0657099213124013, 1.2594501718213058, 1.038513833666385, 2.0, 1.212987012987013, 1.1115440818314661, 1.08012568735271, 1.3658536585365855, 1.0186335403726707, 1.0, 1.04907306434024, 1.1008717310087173, 1.1272727272727272, 1.0114942528735633, 1.0, 1.062169117647059, 1.3276872964169382, 1.75, 1.0, 1.06488300550014, 1.0084235860409145, 1.0695906432748539, 1.0325581395348837, 1.1158702177330984, 1.0611764705882354, 1.0305343511450382, 1.3333333333333333, 1.1123173277661795, 2.0, 1.051192286722718, 1.0625, 1.067190110257267, 1.1042944785276074, 1.09, 1.1040235525024533, 1.04, 1.0729683622828785, 1.0073102685140496, 1.0147058823529411, 1.75, 1.0721452460582896, 1.0678544329484563, 1.115264797507788, 1.0042075736325387, 1.001826484018265, 1.0207792207792208, 1.0150375939849625, 1.170829170829171, 1.0, 1.2200087089048552, 1.044060475161987, 1.1080617495711835, 1.2114307698884281, 1.3076923076923077, 1.0276338406136385, 1.0599946907353333, 1.2943207777718748, 1.124762988244217, 1.04659717964439, 1.1666666666666667, 1.6666666666666667, 1.0922897196261683, 1.051138255927633, 1.0120025268477575, 1.0649350649350648, 1.0575863952926106, 1.0, 1.076947335225481, 1.153421633554084, 1.0, 1.0340909090909092, 1.1666666666666667, 1.1604010025062657, 1.0193840265716803, 1.1272811990370428, 1.1313131313131313, 1.8, 1.1266556291390728, 1.0, 1.2727272727272727, 1.1035977548537486, 1.1818181818181819, 1.0821940104166667, 1.0398173676574953, 1.1032099192119929, 1.0226969292389854, 1.1027190332326284, 1.0674201091192517, 1.039972432804962, 1.0670322973796467, 1.0297122567246173, 1.173913043478261, 1.0052459016393442, 1.083642647649414, 2.0, 1.0200546946216955, 1.0125714285714287, 1.1147994467496543, 1.1101111699311805, 1.5, 1.2024703317994672, 1.016566265060241, 1.0060362173038229, 1.1074561403508771, 1.0175182481751825, 1.0923803101820633, 1.1462140992167102, 1.1690474935427757, 1.0415841584158416, 1.049342105263158, 1.2653061224489797, 1.393939393939394, 1.0147275405007363, 1.2857142857142858, 1.0847531715656753, 1.0148304600111324, 1.2004146510020732, 1.365009746588694, 1.1220013708019192, 1.1582783387665314, 1.2463157894736843, 1.152542372881356, 1.0886995255156386, 1.0030425963488845, 1.0721554116558742, 1.0767735665694849, 1.054615138933248, 1.0441747572815534, 1.0791853424549815, 1.0, 1.0555555555555556, 1.020180637877505, 1.0277113237639552, 1.1997336884154461, 1.0657894736842106, 1.1128969327778686, 1.3497981933499903, 1.1300781334545376, 1.1153846153846154, 1.4513636363636364, 1.0545632641215097, 1.0, 1.2727272727272727, 1.047294298050926, 1.0389150943396226, 1.0412866058569372, 1.5909090909090908, 1.070096463022508, 1.0483770688069387, 1.068881914664239, 1.0626410835214446, 1.1309159903025192, 1.073446327683616, 1.0666666666666667, 1.2537313432835822, 1.0, 1.4414414414414414, 1.0454187036744993, 1.2752613240418118, 1.2183908045977012, 1.013346515076619, 1.0031277926720286, 1.0297080356355297, 1.0823715458883587, 1.0037812112914792, 1.0731707317073171, 1.157190635451505, 1.00032414910859, 1.0291085070940318, 1.0042820636784309, 1.0, 1.0298136645962732, 1.129931262678983, 1.0120615087411884, 1.1654228855721394, 1.0430239224474904, 1.280407234918228, 1.0357142857142858, 1.003055026920673, 1.0865136668385766, 1.0141003948110547, 1.177914110429448, 1.1343529411764706, 1.013926499032882, 1.1393700787401575, 2.0, 1.2595238095238095, 1.0224988834301028, 1.090014064697609, 1.191111111111111, 1.0, 1.6666666666666667, 1.0804945393151721, 1.1090909090909091, 1.045931890622379, 1.5, 1.0, 1.0, 1.0339578454332552, 1.0510204081632653, 1.0083565459610029, 1.0748945147679325, 1.0488215488215489, 1.0020990764063813, 1.1263235322583767, 1.0, 2.0, 1.0678654411613513, 1.0635627234912064, 1.138353765323993, 1.0189575478731336, 1.1234627785545126, 1.0099049259615067, 1.109697933227345, 1.1076879742267134, 1.0227272727272727, 1.0998165698563132, 1.1649499284692417, 1.1818181818181819, 1.003072548287205, 1.1220095693779903, 1.2045454545454546, 1.3157894736842106, 1.0448328267477203, 1.0555555555555556, 1.0598290598290598, 1.1213646457169772, 1.011142061281337, 1.3659147869674186, 1.004593271352308, 1.076784101174345, 1.0254773186832542, 1.0616117748449567, 1.25, 1.0771917060749363, 1.6666666666666667, 1.029418206347955, 1.013129102844639, 1.0346274634745802, 1.0526315789473684, 1.4285714285714286, 1.4782608695652173, 1.109375, 1.0905590860596261, 1.0, 1.0045871559633028, 1.011441647597254, 1.0096153846153846, 1.0165448863900377, 1.092485549132948, 1.1320754716981132, 1.0052603360990016, 1.1518607834191488, 1.0954571340955885, 1.0769230769230769, 1.0, 1.126491646778043, 1.2971246006389776, 1.1030927835051547, 1.115206402695872, 1.0175145954962468, 1.062874251497006, 1.2040816326530612, 1.0027510316368637, 1.0444624090541632, 1.2857142857142858, 1.006462240730976, 1.0479846449136276, 1.1875, 1.0879624562171628, 1.1428571428571428, 1.4, 1.0048886359389069, 2.0, 1.168724279835391, 1.056686046511628, 1.0721903199343725, 1.1294318667236223, 1.0365535248041775, 1.1518987341772151, 1.1040192643298745, 1.0909666269078162, 1.0381895332390383, 1.036424206885416, 1.006400445248365, 2.0, 1.0, 1.0475445051303731, 1.25, 1.0697544642857142, 1.3529411764705883, 1.0, 1.375, 1.3765060240963856, 1.068932955618508, 1.1517857142857142, 1.0454545454545454, 1.0, 1.2010652463382157, 1.090277824413896, 2.0, 1.1000595592614653, 1.0, 1.0922189326653002, 1.155844155844156, 1.0029126213592232, 1.1497695852534562, 1.1363636363636365, 1.287280701754386, 1.0925925925925926, 1.0433054812090836, 1.016124161891001, 1.0868306801736614, 1.0, 1.1666666666666667, 1.5714285714285714, 1.5, 1.2307692307692308, 1.0691073914325486, 1.3333333333333333, 1.0452173913043479, 1.2784810126582278, 1.1366647465437787, 1.0512874170568591, 1.216271884654995, 1.0638549095546215, 1.0104408352668213, 1.0547619047619048, 1.5, 1.1009174311926606, 1.148936170212766, 1.052023877133273, 1.1428571428571428, 1.6923076923076923, 1.0066815144766148, 1.0129564193168434, 1.0262896254356313, 1.0329113924050632, 1.1464387464387464, 1.0216142270861832, 1.0526315789473684, 1.0907770515613653, 1.1207627118644068, 1.2115384615384615, 1.0254957507082152, 1.0982142857142858, 1.0418298629924916, 1.056033366891989, 1.0000917836908725, 1.1025641025641026, 1.1801801801801801, 1.0948012232415902, 1.0, 1.050011207362578, 1.0386895259987654, 1.0129487530830366, 1.0650838353950542, 1.0439209423038531, 1.1585637114712424, 1.5714285714285714, 1.3120253164556963, 1.2, 1.2476515798462853, 1.25, 1.0242732493433646, 1.0333333333333334, 1.1302665520206363, 1.0948616600790513, 1.1016799292661361, 3.0, 1.1576805696846388, 1.0074795823899831, 1.1128609527312856, 2.0, 1.0476190476190477, 1.2495201535508638, 1.2428571428571429, 1.0960987977427006, 1.0124740124740124, 1.1666666666666667, 1.046028880866426, 1.0172949727721037, 1.0868118940408098, 1.0946513554652126, 1.0701754385964912, 1.0729684908789385, 1.1022727272727273, 2.5, 1.0506666666666666, 1.5, 1.2350463352990733, 1.2121212121212122, 1.1261888303577814, 1.9230769230769231, 1.0550692391017946, 1.0994002302840744, 1.0715607649599013, 1.0, 1.2, 1.2, 1.2851427714157124, 1.2407002188183807, 1.0, 1.0085659021829234, 1.1065085296506905, 1.0430998756734355, 1.5, 2.0, 1.007766990291262, 1.0108695652173914, 1.0327868852459017, 1.1111111111111112, 1.0850818249331173, 1.1008316008316008, 1.4705882352941178, 1.0101970930674986, 1.0454545454545454, 1.1771653543307086, 1.0362903225806452, 1.2482120319730754, 1.066744228767375, 1.0, 1.0277777777777777, 1.0747108195796304, 1.0526898392892752, 1.0041003533110757, 1.0, 1.0873700508737005, 1.0128575978356158, 1.0220010476689365, 2.0, 1.0450558213716108, 1.0467285114141751, 1.0180469279006095, 1.0720370451269057, 1.0073587707348697, 1.0187777563236147, 1.0344537815126051, 1.073288331726133, 2.0, 1.04465347046359, 1.1935483870967742, 1.0, 1.217616580310881, 1.1538461538461537, 1.0115485279898644, 1.1676587301587302, 1.0452720912896383, 1.0743460302891235, 1.095015327038373, 1.0378736642770188, 1.053607961441104, 1.2261904761904763, 4.0, 1.013486976353379, 1.1635627530364372, 1.0479646763482275, 1.0523014358197216, 1.126078132927448, 1.1024011299435028, 2.488095238095238, 2.5714285714285716, 1.0101323102651123, 1.051296335498535, 1.012245661630572, 1.1393871449925261, 1.033744697261859, 1.0232067510548524, 1.0727268939512307, 1.017563117453348, 1.2076923076923076, 3.0, 1.2, 1.0124223602484472, 1.0803059273422562, 1.0797101449275361, 1.0120336943441637, 1.0607843137254902, 1.1775147928994083, 1.148905109489051, 1.0963855421686748, 1.0748975624345745, 1.2555555555555555, 1.0012642419944189, 2.0, 1.1897435897435897, 1.0158730158730158, 1.0681818181818181, 1.0958100558659218, 1.0933014354066986, 1.0355731225296443, 1.059662775616083, 1.0763588033073905, 1.0, 1.297872340425532, 1.2, 1.0, 1.1704545454545454, 1.0060483870967742, 1.0401284109149278, 1.1407766990291262, 1.0628003844921499, 1.0150812064965198, 1.0779343069736527, 1.183361530832507, 1.0410534469403563, 1.0951415284649524, 1.022099447513812, 1.1177248677248677, 1.0241896468311562, 1.0665610142630746, 1.323699421965318, 1.174960380348653, 1.0381087518370242, 1.2720668645524136, 1.07510002714601, 2.0, 1.4275184275184276, 1.0702274975272008, 1.4205607476635513, 1.0, 1.0625, 1.1538461538461537, 1.3325471698113207, 1.2962962962962963, 1.1666666666666667, 1.0399880776883605, 1.1240062322719828, 1.0295468066944309, 1.058480466565471, 1.227027027027027, 1.1320495185694635, 2.0, 1.232, 1.0078626112145666, 1.067096979839031, 1.082885195850536, 1.0370201617496297, 1.0274828232354778, 1.2285714285714286, 1.09514875915088, 1.1225577264653641, 1.034273605847927, 1.0980910785218094, 1.303030303030303, 1.0534591194968554, 1.0, 1.2387640449438202, 1.2109761120263591, 3.0, 1.1388437427443696, 1.0419500112587254, 1.4285714285714286, 1.0302085652787056, 1.0, 1.1176470588235294, 1.0418972565339946, 1.6923076923076923, 1.0194094968758687, 1.0388722768047842, 1.3571428571428572, 1.0357142857142858, 1.0742268041237113, 1.0157819225251077, 1.0600441501103752, 1.028312991760114, 1.1538531802819474, 1.0, 1.065989572018249, 1.1189024390243902, 2.0, 1.0053563975328108, 1.1115494419932521, 1.1551561021759698, 1.0137285491419656, 1.0249027237354085, 1.018018018018018, 2.0, 1.0686991869918698, 1.038709677419355, 1.128043710654472, 1.161115414407436, 1.0096767314663793, 1.0299669819863748, 1.1978021978021978, 1.0966952264381884, 1.193979933110368, 1.046902938349981, 1.0958990536277602, 1.0932971014492754, 1.0291891891891891, 1.0546757268987195, 3.0, 1.137523298292701, 1.0008250415005815, 1.0640440896997339, 1.2666666666666666, 1.339397305929732, 1.5397727272727273, 1.1428571428571428, 1.1041475629540805, 1.0420575865415722, 1.138646288209607, 1.0588235294117647, 1.3333333333333333, 1.0666360562066353, 1.5, 1.0186915887850467, 1.0833333333333333, 1.0216314283720607, 1.44, 1.0970464135021096, 1.050314465408805, 1.0, 1.6904761904761905, 1.3124463519313305, 1.5, 2.0, 1.1176470588235294, 1.2137931034482758, 1.0879689521345408, 1.1794554455445545, 1.1111111111111112, 1.1533923303834808, 1.1014466214978942, 1.0571428571428572, 1.1238532110091743, 1.2938775510204081, 1.0769230769230769, 1.0, 1.143843498273878, 1.0923520923520924, 1.0419806243272336, 1.0248460394988321, 1.0538004071315674, 1.0276243093922652, 1.0907864702220378, 1.1103961827646038, 1.1352459016393444, 1.0151423379769837, 1.375, 1.0, 1.3076923076923077, 1.042194733247325, 1.060017652250662, 1.107843137254902, 1.180232558139535, 1.0298587247040856, 1.0297419790332134, 1.0209272867044503, 1.0985915492957747, 1.2222222222222223, 1.05546875, 1.0455328738069989, 1.0641088302378625, 1.0076849311419516, 1.0133333333333334, 1.0704370939161252, 1.0279681836793497, 1.3126050420168067, 1.3411405295315681, 1.125, 1.0413728255759285, 1.3682588597842835, 1.1555555555555554, 1.102102102102102, 1.0701001430615165, 1.0, 1.0579710144927537, 1.0193033644890626, 1.0, 1.115364713936586, 1.0547486033519553, 1.2647058823529411, 1.0208147818343722, 1.0286229271809662, 1.0466693526725759, 1.0458015267175573, 1.0805902383654937, 1.211483972280067, 1.1940298507462686, 1.2857142857142858, 1.0, 1.25, 1.081918372290178, 1.3333333333333333, 1.1369631901840491, 1.109471757040547, 1.0601221230624707, 1.0484607745779544, 1.052341652778748, 1.047588424437299, 1.028673835125448, 1.015256588072122, 1.0163195341301337, 1.1662682789651293, 1.042491204925242, 1.1986631338070577, 1.4285714285714286, 1.046875, 1.0585774058577406, 1.1251343200804187, 1.013029315960912, 1.2906122448979591, 1.031021897810219, 2.1923076923076925, 1.0646430710124977, 1.0671140939597314, 1.0363277511961722, 1.125, 1.0403654719600874, 1.0397641945824996, 1.2472959685349065, 1.0581052631578947, 1.1851851851851851, 1.086046511627907, 1.0923913043478262, 1.625, 1.060775260388704, 1.6153846153846154, 1.0181451612903225, 1.068075117370892, 1.1294744859101296, 1.0399229556995273, 1.009501187648456, 1.8333333333333333, 1.041860465116279, 1.0977425640648553, 1.0489971665092506, 1.0022724584264626, 1.0478478718128494, 1.0738681772274183, 1.0833333333333333, 1.065601345668629, 1.0756461441479301, 1.010491539800884, 1.0170340681362726, 1.0208333333333333, 1.069882777276826, 1.0711959739490824, 1.3620178041543027, 1.0107752539503385, 1.0, 1.3333333333333333, 1.064871813889095, 1.0040804840298299, 1.2611286025672075, 1.1148735056991939, 1.0814046288906625, 1.1278195488721805, 1.1229756237001114, 1.1046984338553816, 1.0790441176470589, 1.0054347826086956, 1.0834597875569043, 1.1124895695282973, 1.1071428571428572, 1.75, 1.0396194980383726, 1.1781036423246938, 1.0465393794749402, 1.0476190476190477, 1.1889934829833455, 1.0158189340472135, 1.1636210289569862, 1.1594202898550725, 1.2692307692307692, 1.034366576819407, 1.0869565217391304, 1.14375, 1.6538461538461537, 1.043144485417365, 1.1902874132804757, 1.164179104477612, 1.0, 1.0280135085431503, 1.011333077218594, 1.064825970548862, 1.3771043771043772, 1.3333333333333333, 1.1666666666666667, 2.0, 1.1438523162661094, 1.1153846153846154, 1.0, 1.1538461538461537, 1.099337748344371, 1.0815217391304348, 1.052892981438515, 1.0439575055279389, 1.0545454545454545, 1.3076923076923077, 1.0666666666666667, 1.0333333333333334, 1.0675675675675675, 1.1, 1.1243432574430823, 1.0277989774622964, 1.031067492857408, 1.3473684210526315, 1.075583184587924, 1.046899554576848, 2.5, 1.0690347385253989, 1.25, 1.5, 2.0, 1.1644970414201183, 1.137631786559564, 1.0968336076495022, 1.2453416149068324, 1.0, 1.075, 1.0382165605095541, 3.0, 2.0, 1.0433889602053916, 1.1685710444952278, 1.0740840155683802, 1.6666666666666667, 1.0290391444534859, 1.0449264136328427, 1.0372340425531914, 1.0, 1.0375586854460095, 1.0207161090220405, 1.25, 1.159292592359494, 1.0411357421306802, 1.1971830985915493, 1.0703125, 1.1068929241183736, 1.0664845173041895, 1.1115702479338843, 1.1694915254237288, 1.0465988040651941, 1.3121489327555769, 1.058804894932595, 1.2395209580838322, 1.107843137254902, 1.3432835820895523, 1.072192513368984, 1.0649921507064364, 1.0112544412144704, 1.06360605479977, 1.0262008733624455, 1.5, 1.6666666666666667, 1.1306974365530909, 1.1191732629727353, 1.24761719509823, 1.0099471042328887, 1.0623850142164242, 1.1248449595825671, 1.391167192429022, 1.0212765957446808, 1.0687839006367423, 1.117410778492326, 1.239590942293645, 1.038181818181818, 1.6666666666666667, 1.0416666666666667, 1.069651546068121, 1.1443806398687448, 1.0318380092391393, 1.0913099156861565, 1.0042796005706134, 2.0, 1.0767295597484277, 1.02287622249044, 1.163810829335161, 1.209125475285171, 1.0635221475230057, 1.0286624203821657, 1.2549668874172186, 1.0092753623188406, 1.0303310724744974, 1.076605774896877, 1.0276497695852536, 1.0469168900804289, 1.0, 1.2004102564102563, 1.047719169942408, 1.0426997245179064, 1.0662030852144921, 1.1497120921305182, 1.0105900151285931, 1.2, 1.2427440633245384, 1.6666666666666667, 2.0, 1.2352941176470589, 1.0025575447570332, 1.018167456556082, 1.0171866737176096, 1.0100263943427117, 1.0379918588873813, 1.091324200913242, 1.1195652173913044, 1.1395348837209303, 1.0372973617570516, 1.6, 1.4166666666666667, 1.0350050488051161, 1.1428571428571428, 1.034435261707989, 1.1102977061981454, 1.076430824695809, 1.0889289250296212, 2.0, 1.0693498452012384, 1.1531007751937985, 1.1141983884412336, 1.0393084213326973, 1.1148989898989898, 1.1267123287671232, 1.1493509400179052, 1.1127342393581992, 1.0079491255961843, 1.0597014925373134, 1.0865921787709498, 1.0, 1.0, 1.0417679982833232, 5.0, 1.4285714285714286, 1.9285714285714286, 1.0752269779507133, 1.119047619047619, 1.08980044345898, 1.1035700274617497, 1.0, 1.0664183736809436, 1.0186915887850467, 1.2119565217391304, 1.2980769230769231, 1.4285714285714286, 1.0272479564032697, 1.126940133037694, 1.1469933184855234, 1.0528077352175529, 1.0198649080761764, 1.0922125638498072, 1.1044069801833778, 1.0, 1.2017599526166602, 1.0295112985187589, 1.045642037302726, 1.1774193548387097, 1.0497931591161336]
origin-bjaq_15.71 	max: 5.0000	99th: 2.5000	95th: 1.6667	median: 1.0769	mean: 1.1674

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 13.940558 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[2.3841858e-07 2.3841858e-07 1.1920929e-07 2.9802322e-07 5.9604645e-07]
Distance score: 2.980232238769531e-07
SAUCE Drift detection: False
Detection latency: 0.0231s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.042925 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 7.0000	99th: 2.5050	95th: 1.6690	median: 1.0793	mean: 1.1794
ReportEsts: [1.0708661417322836, 1.0174825174825175, 1.0546035959937252, 1.061328790459966, 1.565217391304348, 1.0, 1.0767281105990782, 1.0512999298817391, 1.0, 1.009761388286334, 1.1272871534707027, 1.0428773280021646, 1.0464690815953166, 1.0833333333333333, 1.030223772159256, 1.0055248618784531, 1.1730769230769231, 1.125, 1.3636363636363635, 1.1050875729774812, 1.16104913363399, 1.0334158200163812, 1.2592592592592593, 1.0024916943521596, 1.015417415512563, 1.0328690420699418, 4.0, 1.1627231467473524, 1.0, 1.4, 1.047244094488189, 1.0, 1.0499581862451248, 1.0079161737890707, 1.11171910624715, 1.1030715066164867, 1.2229580573951435, 1.1466666666666667, 1.043956043956044, 1.0486798679867986, 1.0355029585798816, 1.0043738862789569, 1.1821656050955414, 1.033190408130856, 1.010928961748634, 1.051025529494429, 1.4210526315789473, 1.1534391534391535, 1.0125, 1.0107889413351314, 1.25, 1.3095238095238095, 1.1030042918454936, 1.0606060606060606, 1.0173617434589934, 1.0456107338623906, 1.064013069953958, 1.0852130325814537, 1.1235955056179776, 1.0066674536448017, 1.459016393442623, 1.154708846249262, 1.0846153846153845, 1.03515625, 1.0693069306930694, 1.7142857142857142, 1.148763074879628, 1.2894736842105263, 1.6, 2.0, 1.1064488658357203, 1.012036108324975, 1.055528730082086, 1.0333333333333334, 1.1102744046680335, 1.368271954674221, 1.0746800923012376, 1.0044247787610618, 1.4854368932038835, 1.088520599593682, 1.0421920465567411, 1.0483870967741935, 1.0, 1.0769230769230769, 1.082579185520362, 1.2, 1.0104166666666667, 2.0, 2.0, 1.0726931588569228, 1.1096938775510203, 1.1613235218442854, 1.0009726630490428, 1.0865654862282181, 1.0916030534351144, 1.0331807780320366, 1.0769230769230769, 1.0594744121715076, 1.0, 1.2791349619543453, 1.0689655172413792, 1.0, 1.0496650832165682, 1.1162691652470187, 1.1132756132756132, 1.2275824770146024, 1.4, 1.0057876280938276, 1.0405074560427332, 1.1533551361361756, 1.1164925609370053, 1.0580645161290323, 1.25, 2.0, 1.06152950310559, 1.065333381728431, 1.0563751317175976, 1.053191489361702, 1.0597399192491217, 2.0, 1.1334033613445378, 1.1501364877161055, 2.0, 1.0576923076923077, 1.1428571428571428, 1.2349272349272349, 1.0198750442060591, 1.023844217777189, 1.0833333333333333, 1.5, 1.1558803061934586, 2.0, 1.2941176470588236, 1.1209469417833455, 1.3333333333333333, 1.1835443037974684, 1.0263095224594867, 1.0711115770346298, 1.5, 1.4285714285714286, 1.010615711252654, 1.0103324348607368, 1.0912841670964415, 1.0057284860139624, 1.2151898734177216, 1.0059363194819213, 1.0892690733762813, 1.5, 1.0230798335225122, 1.0096993210475267, 1.1050228310502284, 1.11670139922596, 2.0, 1.169337768370124, 1.0, 1.0329861111111112, 4.0, 1.0, 1.0151515151515151, 1.1409377151161308, 1.121920457411923, 1.080267558528428, 1.158774373259053, 1.2063492063492063, 1.396551724137931, 1.0396039603960396, 1.2222222222222223, 1.080772069350734, 1.183574879227053, 1.0371287128712872, 1.9545863309352518, 1.168073676132003, 1.045390365448505, 1.2538593481989708, 1.0723809523809524, 1.0776620650682167, 1.016250725478816, 1.0121428571428572, 1.1343523732904264, 1.0607501320655044, 1.0273353422298752, 1.2030334808297312, 1.2375, 1.2222222222222223, 1.0109490229357587, 1.0747799295774647, 1.3368794326241136, 1.0326406330821696, 1.0023696682464456, 2.0, 1.2436260623229463, 1.119898761689593, 1.5263157894736843, 1.1491094147582697, 1.042841110550884, 1.080491373221673, 1.0406222958667035, 1.076086956521739, 1.0200021328783193, 1.046172521167432, 1.0044934640522876, 1.0636708860759494, 1.0158273381294964, 1.0726326167460203, 1.0625293841090737, 1.096669303102206, 1.2367149758454106, 1.0135135135135136, 1.2682926829268293, 2.0, 1.391304347826087, 1.0477345747819815, 1.2704225352112677, 1.2254901960784315, 1.0152829409334985, 1.1818181818181819, 1.0500211678118996, 1.0068027210884354, 1.2270964130043587, 1.6666666666666667, 1.1685082872928176, 1.0116373477672531, 1.0998011642670626, 1.0067926416256157, 1.6, 1.061814556331007, 1.0524864146049153, 1.0080024788823474, 1.0241286863270778, 1.0298507462686568, 1.0073033707865169, 1.0896898296059638, 1.5089285714285714, 1.005929214730305, 1.0699458593313749, 1.1182108626198084, 1.0537727666955767, 1.0338983050847457, 1.4081632653061225, 1.1101639344262295, 1.0, 1.2444390124663895, 1.0607134530193518, 1.1058107577542207, 1.2169117647058822, 1.0, 1.5, 1.0667017651618187, 1.125, 1.0919556980472165, 1.6, 1.0211841390548615, 1.1305803571428572, 1.4285714285714286, 1.0009940122594845, 1.0113895216400912, 1.1314186248912097, 1.0128205128205128, 1.0155038759689923, 1.1223880597014926, 1.0724637681159421, 1.5, 1.114250403378077, 1.0594185342216837, 1.0880230880230881, 1.0100271384767208, 1.0842775069239396, 1.0550551271888737, 1.0985352862849533, 1.0988158491781204, 1.0148957298907646, 1.0223357490792444, 1.0197875442616122, 1.2727272727272727, 1.0023849129206164, 1.1177644710578842, 1.2352941176470589, 1.16, 1.1308962264150944, 1.0838068181818181, 1.0301987598517484, 1.0055508414651393, 1.1116883116883116, 1.3807531380753137, 1.0010550369506028, 1.0083160083160083, 1.0430055038258301, 1.0581284935799986, 1.1, 1.0398593200468933, 1.0703794369645043, 1.055161046842989, 1.0456930453432456, 1.0397069531749217, 1.2347318109399894, 1.2094329028635598, 1.0586649641767751, 1.0219899921707458, 1.0768229637395612, 1.072396214724272, 1.0239852398523985, 2.5, 1.2307692307692308, 1.0780035863717872, 1.3076923076923077, 1.0329067641681902, 1.0507249385073636, 1.072682856732289, 1.588235294117647, 1.1176470588235294, 1.0075973409306742, 1.0603747397640528, 1.0678935588162148, 1.0, 1.1294117647058823, 1.0302119593081303, 1.1167048054919908, 1.0, 2.0833333333333335, 1.058007279344859, 1.25, 1.0049176336410992, 1.0270700636942676, 1.1, 1.0501783101682516, 1.0740740740740742, 1.2142857142857142, 1.0106308382400095, 3.0, 1.0152505446623095, 1.0797011207970113, 1.0721864297176251, 1.1097560975609757, 1.0197802197802197, 1.2340425531914894, 1.0945225399903054, 1.0676838757696732, 1.0226442658875092, 1.0391537172239425, 1.0412253249879635, 3.0, 1.1111111111111112, 1.0655174716437559, 1.2, 1.0720595072059507, 1.2857142857142858, 1.3333333333333333, 1.5, 1.306191687871077, 1.0641125879593432, 1.1925925925925926, 1.1132665832290363, 1.3076923076923077, 1.5, 1.0779512152062614, 1.3333333333333333, 1.1818181818181819, 1.0227195974882168, 1.1171548117154813, 1.0082582582582582, 1.0263405456255879, 1.75, 1.0, 1.3928881179531656, 1.3162393162393162, 1.113785557986871, 1.1341483659820708, 1.248727814322949, 1.0331632653061225, 2.0, 1.0315461822247716, 1.0350877192982457, 1.56, 4.0, 1.0431519699812384, 1.2857142857142858, 1.1324503311258278, 1.2222222222222223, 1.1098029118486963, 1.0964662949527846, 1.0797047970479705, 1.0265351713616302, 1.1162194957529998, 1.0865561694290975, 1.1032934131736527, 1.0968865995000379, 1.0693548387096774, 1.2058823529411764, 1.00844612936883, 1.0446540403081945, 1.2985915492957747, 1.0294117647058822, 1.1891891891891893, 1.2, 2.0, 1.0833333333333333, 1.7215189873417722, 1.1784313725490196, 1.1849710982658959, 1.1654135338345866, 1.0251572327044025, 1.1821946169772257, 1.0033411711025497, 1.136874757658007, 1.054975358546985, 1.04, 1.3541666666666667, 1.0869565217391304, 1.0, 1.080651384997014, 1.6037735849056605, 1.103826684799033, 1.0216830454733443, 1.0511259382819016, 1.14259160913436, 1.75, 1.1282968261063926, 1.1428571428571428, 1.0781671159029649, 1.1666666666666667, 1.0294875333517344, 1.0245098039215685, 1.0659038495653717, 1.1784511784511784, 1.0262793914246195, 3.0, 1.255721696673787, 1.0080326503160324, 1.0471539109783192, 2.0, 1.1333333333333333, 1.2987117552334944, 1.2636363636363637, 1.101372575798962, 1.066493146723289, 1.1304347826086956, 1.0885714285714285, 1.0048175919810405, 1.0711077844311376, 1.0388582732796383, 1.0690041361756284, 1.0528301886792453, 1.3076923076923077, 1.0439868975198876, 1.0627638982217897, 1.1403508771929824, 1.122636412749865, 3.0, 1.5, 1.2103912764592688, 1.1518987341772151, 1.0184926727145849, 1.1373108641089997, 1.0845286885245902, 1.0, 1.170940170940171, 1.2857142857142858, 1.0682552504038771, 1.0416666666666667, 1.0, 1.060417354008578, 1.0, 1.0, 1.013102119460501, 2.3333333333333335, 1.0120012974375607, 1.0060240963855422, 1.0222841225626742, 1.0769230769230769, 1.0722955456045251, 1.053147996729354, 1.55, 1.028637621468563, 1.0952380952380953, 1.1604803493449782, 1.0472972972972974, 1.2249293785310735, 1.0796701880958517, 1.0, 1.0465116279069768, 1.0861109153688957, 1.1125455147302217, 1.0516693163751987, 1.4, 1.1259093452714046, 1.0048428005067156, 1.0156114483954901, 2.0, 1.0003266906239792, 1.0131407741435652, 1.0457959063466353, 1.0359594042056075, 1.0050966876994594, 1.058221538178811, 1.0099644128113878, 1.011881663625012, 1.75, 1.0799706846007933, 1.565217391304348, 1.064367257711926, 1.1551628934290448, 1.0052770448548813, 1.0093733280525852, 1.2351190476190477, 1.0695091137349628, 1.1737655484357332, 1.0701269297428346, 1.2419685577580315, 1.0871214957937043, 1.0560041872289516, 1.0232558139534884, 1.263157894736842, 1.1428752439117102, 1.0396659707724425, 1.010311453361112, 1.0695594285885899, 1.0, 1.1399848254931715, 1.0368098159509203, 1.0, 1.148936170212766, 1.0199995081416224, 1.130281690140845, 1.081409117821196, 1.0, 1.0, 1.010054844606947, 1.1568861458724042, 1.0461966604823747, 1.0159231191933649, 1.1199844176081029, 1.1046511627906976, 1.0289256198347108, 1.0050589970501476, 1.5340909090909092, 1.009695594334455, 1.1745908028059235, 1.1185567010309279, 1.019606114203022, 1.091743119266055, 1.0049361020300043, 2.0, 1.162676056338028, 1.0927152317880795, 1.0276417074877537, 1.1324200913242009, 1.1026422764227641, 1.0398009950248757, 1.2486187845303867, 1.1100953676978962, 1.0, 1.625, 1.2, 1.0, 1.203883495145631, 1.2263157894736842, 1.0, 1.0717131474103585, 1.0617185421654696, 1.0784418356456777, 1.1371639054310612, 1.1823792399650113, 1.0659566031802459, 1.0146249828362417, 1.0398704597901758, 1.0756526371870005, 1.1754487550665895, 1.0469308216953557, 1.0399002493765586, 1.030949839914621, 1.1800518134715026, 1.2962962962962963, 1.0418734115938522, 1.1817102137767221, 1.1015597305919886, 1.3333333333333333, 1.1222410865874364, 1.1024229074889869, 1.25, 1.0843091334894615, 1.0, 2.0, 1.4362139917695473, 1.0338574463975276, 1.0459028831562973, 1.0361757105943152, 1.0588235294117647, 1.084112765985515, 1.0139240506329115, 1.106115107913669, 1.0, 2.0, 1.0949991247009394, 1.075221238938053, 1.125101543460601, 1.0875381365876555, 1.0, 1.014726840855107, 1.1926406926406927, 1.0886652167315765, 1.1157270029673592, 1.0322869871393747, 1.1311244391332778, 1.0023813195804068, 1.3076923076923077, 1.5, 1.1845672012527675, 1.0, 1.0149942329873125, 1.1875, 1.391089108910891, 1.2200435729847494, 1.5, 1.0432994596064304, 1.207142857142857, 1.1362048894062864, 1.0648937523857998, 1.2152732060566163, 1.0615853658536585, 1.0569763068822866, 1.0035555555555555, 1.0673611111111112, 1.5, 1.1353725147476512, 1.0793150067598016, 1.0454545454545454, 1.0083102493074791, 1.176555023923445, 1.2222222222222223, 1.0210732464531966, 1.5555555555555556, 1.0492091388400704, 1.0169626820993813, 1.4236111111111112, 1.2366863905325445, 1.0749881092335167, 1.062992125984252, 1.875, 1.0942807625649913, 1.0006600660066007, 1.1137806688821326, 1.1678026614735475, 1.0039950122296293, 1.0318093435429752, 1.2179289026275115, 1.0950764006791172, 1.1836158192090396, 1.0860664194014302, 1.0885280251440546, 1.0382882882882882, 1.0254691689008042, 1.02465483234714, 1.0916030534351144, 1.0075845012366034, 1.2272727272727273, 1.3333333333333333, 1.16, 1.5808022922636102, 1.052937576499388, 1.0112612612612613, 1.0769230769230769, 1.0202265372168284, 1.031907179115301, 1.1272727272727272, 1.0729835304778839, 2.3333333333333335, 1.0052953636149682, 2.0, 1.0670611439842208, 1.0714285714285714, 1.0203053037105698, 1.4193548387096775, 1.195729537366548, 1.0543103448275861, 1.0, 1.4798301486199574, 1.3012729844413014, 1.2, 2.0, 1.1041666666666667, 1.1788856304985338, 1.0578878748370273, 1.2075078206465069, 1.086894586894587, 1.005763688760807, 1.0403022670025188, 1.4553571428571428, 1.1606425702811245, 1.0716723549488054, 1.206896551724138, 1.0, 1.1807348560079445, 1.1231527093596059, 1.0339285714285715, 1.0462611991729842, 1.0626780626780628, 1.0803030865802474, 1.0526481578703561, 1.157955163453985, 1.171021377672209, 1.0217831813576495, 1.8571428571428572, 1.0, 1.393939393939394, 1.0018304230240616, 1.0803183791606368, 1.0940860215053763, 1.1905737704918034, 1.014711501719526, 1.0414329928094386, 1.0189933228217616, 1.1411764705882352, 1.2857142857142858, 1.0043859649122806, 1.034111012826183, 1.050579797573564, 1.0115685531507033, 1.0279329608938548, 1.0314384151593454, 1.001389948762673, 1.1168645854803165, 1.0415451895043732, 1.0783412667916155, 1.0817610062893082, 1.0949857317570322, 1.0072463768115942, 1.0324746377141056, 1.0833333333333333, 1.2100456621004567, 1.0, 1.0865979381443298, 1.0153279776649469, 1.0806451612903225, 1.0904912552975587, 1.0089766606822261, 1.3333333333333333, 1.0372300272593835, 1.0307489435669974, 1.0757093386952636, 1.0469635627530365, 1.039423076923077, 1.1975749732740675, 1.1908931698774081, 1.4, 1.0, 1.4285714285714286, 1.0643846122794978, 1.25, 2.470842332613391, 1.096405777628485, 1.0752, 1.1067545304777595, 1.0345261570764137, 1.0542087843277574, 1.072289156626506, 1.0530035335689045, 1.0291513290036185, 1.1635656490638315, 1.0447249669175507, 1.2067594433399602, 1.8571428571428572, 1.142664872139973, 1.04, 1.0769719826029158, 1.036619718309859, 1.262734584450402, 1.0774091627172195, 2.2302158273381294, 1.0371163454675232, 1.0971751412429378, 1.0364942385394322, 1.0476190476190477, 1.0835682454394369, 1.0409286439516519, 1.3343478260869566, 1.0714285714285714, 1.3666666666666667, 1.0150375939849625, 1.105164903546982, 1.0540325591209363, 1.2372881355932204, 1.018810120878475, 1.1842105263157894, 1.0406312218862916, 1.061881188118812, 1.0176322418136021, 1.0596026490066226, 1.024567788898999, 1.0460921843687374, 1.0638297872340425, 1.0278634865140726, 1.0661553211888783, 1.0491498181202943, 1.0912133268880377, 1.1875, 1.0696692470091484, 1.0708661417322836, 1.0713993243934896, 1.1208651399491094, 1.0405701754385965, 1.2696969696969698, 1.0405679513184585, 1.0, 1.0389275846916148, 1.25, 1.114773396115362, 1.244279129942589, 1.0537657814540706, 1.060655737704918, 1.111781848459617, 1.106108677820253, 1.0733822548365577, 1.140461215932914, 1.1076638890029145, 1.089450231006862, 1.1386292834890965, 1.076555023923445, 1.053743961352657, 1.1037967433106948, 1.121212121212121, 1.6, 1.0348389854659448, 1.1714181484083661, 1.0122729504172803, 1.0392156862745099, 1.163874505025891, 1.0034221262578351, 1.1623452464377482, 1.0709832134292565, 1.2580645161290323, 1.1176470588235294, 1.2222222222222223, 1.0852130325814537, 1.2972972972972974, 1.0477213741523177, 1.191454396055875, 1.0909090909090908, 1.0204081632653061, 1.0728392824787099, 1.0884318766066838, 1.074766355140187, 1.02, 1.0282381829343155, 1.0158730158730158, 1.0645638245441105, 1.0, 1.0137525589207916, 1.0126582278481013, 1.127659574468085, 1.3063063063063063, 1.1071428571428572, 1.2708763647093537, 1.048372513562387, 1.0585166959578207, 1.1811263318112633, 1.45, 1.1764705882352942, 1.0526315789473684, 1.0333333333333334, 1.1829268292682926, 1.1120826709062004, 1.027669040898512, 1.031896111927031, 1.412280701754386, 1.0994820483307597, 1.0476631652748738, 3.0, 1.0789706067869307, 1.0829162875341218, 1.5, 2.5, 1.1806483543677309, 1.096425801062116, 1.0792997793062074, 1.1974025974025975, 1.5, 1.0513698630136987, 1.3451776649746192, 1.0782608695652174, 1.0767472240365774, 1.1110240549828179, 1.0522374851946144, 1.0214717531790702, 2.0, 1.0252336237258814, 1.045219638242894, 1.0497000856898029, 1.0104166666666667, 1.0286054827175208, 1.0, 1.0060975609756098, 1.1774528051050253, 1.0174619388102535, 1.0, 1.0483870967741935, 1.0607824787000013, 1.0653343581860109, 1.096551724137931, 1.2, 1.018714162549779, 1.2262098286857572, 1.0339817872892842, 1.391089108910891, 1.3728813559322033, 1.1329479768786128, 1.25, 1.081180811808118, 1.066326530612245, 1.0099452309498151, 1.065934065934066, 1.5, 1.05125, 1.0565885206143897, 1.1207782672540383, 1.0611423974255834, 1.0769461111049496, 1.0714185688278952, 1.1039291566433078, 1.056338028169014, 1.0727272727272728, 1.1150517896945065, 1.0987562444398824, 1.2713032581453634, 1.1381031613976706, 1.6666666666666667, 1.0357142857142858, 1.0347861597861598, 1.0090771558245084, 1.0211530540386122, 1.0829903831801608, 1.0160810005955927, 1.6, 1.1297709923664123, 1.0014650597080939, 1.1772562488074796, 1.0501672240802675, 1.0851695693846437, 1.03485254691689, 1.1897196261682244, 1.019980506822612, 1.0318580538647848, 1.1017033631141515, 1.055185537583254, 1.04052573932092, 1.0526315789473684, 1.1955060005106817, 1.1580674706151732, 1.0352714680098805, 1.0061196105702364, 1.1043566362715298, 1.019447929736512, 1.04739336492891, 1.2380952380952381, 2.0, 2.0, 1.0, 1.0107066381156318, 1.0358773646444879, 1.0226467611336032, 1.000503039643805, 1.093203000681973, 1.017853986211773, 1.1576576576576576, 1.0841300191204588, 1.0691153423311734, 1.3333333333333333, 1.8461538461538463, 1.044975804155992, 1.25, 1.0362573099415204, 1.1692373607540703, 1.0786525302654335, 1.0920944954314584, 2.5, 1.0454781704781704, 1.2802303262955854, 1.100009467007479, 1.0402718945452878, 1.2589473684210526, 1.140491147915477, 1.1335061687535624, 1.1469170001025957, 1.0346205059920106, 1.1232876712328768, 1.0940070505287895, 1.0, 3.0, 1.041781702341698, 7.0, 1.2, 1.6666666666666667, 1.0325534079348933, 1.0874750018517148, 1.108154020385051, 1.0642570281124497, 1.0, 1.0753270519573659, 1.037837837837838, 1.0218579234972678, 1.3257731958762886]
origin-bjaq_15.71 	max: 7.0000	99th: 2.5050	95th: 1.6690	median: 1.0793	mean: 1.1794

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.079179 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.090017