Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 92, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.5732	95th: 1.6941	median: 1.0840	mean: 1.1724
ReportEsts: [1.09375, 1.0033854166666667, 1.0317260535567032, 1.0947368421052632, 1.5789473684210527, 1.0, 1.0636204634892872, 1.0801439335394127, 1.0, 1.0183006535947712, 1.082994257351456, 1.0436542314148032, 1.0338688666956144, 1.1, 1.0830095372659838, 1.0, 1.139240506329114, 1.0662415869642226, 3.0, 2.0, 1.08, 1.082702904641823, 1.048107825307058, 1.1409277745155608, 1.0596941292550568, 1.0, 1.170894867670712, 1.2, 1.2, 1.0431654676258992, 1.0, 1.0341388552465316, 1.0081565867821465, 1.0366259711431742, 1.0810691731531796, 1.2364290796467585, 1.1042780748663101, 1.0077324002251205, 1.1289000619877403, 1.0833333333333333, 1.2225705329153604, 1.0365853658536586, 1.0, 1.0306605804840239, 1.1181441876509142, 1.8615384615384616, 1.0198019801980198, 1.2508833922261484, 1.021154706241106, 1.1574074074074074, 1.1137165470521162, 1.1993127147766323, 1.0409241671988627, 2.0, 1.1090909090909091, 1.2166958641176022, 1.356015779092702, 1.3592233009708738, 1.00625, 1.25, 1.076176844783715, 1.0983810709838107, 1.1636363636363636, 1.0114942528735633, 1.1818181818181819, 1.0970154921020656, 1.2853989277830338, 1.75, 1.0, 1.0540691712501165, 1.001194743130227, 1.0639906922629436, 1.0206896551724138, 1.100352360817477, 1.0588235294117647, 1.0865191146881288, 1.0, 1.1093945720250522, 2.0, 1.0014060661711957, 1.2307692307692308, 1.0346938775510204, 1.1226993865030674, 1.0982367758186398, 1.10549558390579, 1.0, 1.0658741061226586, 1.0266962625232467, 1.1274509803921569, 1.75, 1.101620029455081, 1.0518437042309028, 1.1401869158878504, 1.0490883590462834, 1.0073597056117756, 1.0051948051948052, 1.0150375939849625, 1.154679802955665, 1.0, 1.2431503050471437, 1.0561555075593954, 1.0891938250428816, 1.2200886898867698, 1.5454545454545454, 1.0275332853600978, 1.05840191133528, 1.1134826325411336, 1.1095942358740993, 1.0542611894543226, 1.3333333333333333, 1.6666666666666667, 1.0682242990654205, 1.0473743650678955, 1.0587492103600757, 1.0909090909090908, 1.0627855610248642, 2.0, 1.1280353200883002, 1.1408296943231442, 1.0, 1.0054945054945055, 1.0, 1.2155388471177946, 1.0210465252010033, 1.033781160208123, 1.087378640776699, 1.8, 1.0687086092715232, 1.0, 1.2727272727272727, 1.1050904295017943, 1.1818181818181819, 1.033203125, 1.03831008560106, 1.133875049953377, 1.0600801068090788, 1.0055096418732783, 1.029228371005456, 1.039972432804962, 1.0749542961608776, 1.0480825782695045, 1.2857142857142858, 1.050880626223092, 1.1018972630246682, 2.0, 1.0223336371923428, 1.0057142857142858, 1.114029025570145, 1.1210517028410094, 1.5, 1.174134172923226, 1.0497667185069985, 1.016260162601626, 1.1074561403508771, 1.0, 1.0173212141999657, 1.1024675135056212, 1.131934874700148, 1.0499001996007984, 1.049342105263158, 1.3061224489795917, 1.6626506024096386, 1.0119225037257824, 1.4285714285714286, 1.0513972055888223, 1.0264432058193353, 1.1549202127659575, 1.3749263695268015, 1.1368055555555556, 1.1185232302350852, 1.2757894736842106, 1.0993071593533488, 1.0752396630192698, 1.0293225480283115, 1.0025951557093427, 1.08843537414966, 1.0273802115743622, 1.1075734820853893, 1.076731933632146, 1.0, 1.2301587301587302, 1.0203023758099352, 1.0279106858054226, 1.1800916830386379, 1.131578947368421, 1.0851977761686773, 1.3328848741110897, 1.0822240980022941, 1.1372549019607843, 1.2104545454545454, 1.0454104079504178, 1.0, 1.0909090909090908, 1.0449504532995995, 1.04756242568371, 1.0313837375178316, 1.4, 1.0456591639871382, 1.0490964304248858, 1.0555999829651117, 1.0626410835214446, 1.0071677031727628, 1.11864406779661, 1.0491803278688525, 1.2537313432835822, 1.0, 1.3559322033898304, 1.0700205014981865, 1.3310104529616724, 1.1149425287356323, 1.013346515076619, 1.0031277926720286, 1.027261527631116, 1.0537953612251691, 1.111135166341921, 1.0852272727272727, 1.0087463556851313, 1.0048844024747638, 1.0478200930553163, 1.0504858343467425, 1.0, 1.0869565217391304, 1.1187245189372303, 1.0127302166180099, 1.140596469872185, 1.0269192682545474, 1.279991338241663, 1.0357142857142858, 1.0059930231316077, 1.0535069623517277, 1.0073863636363636, 1.1228070175438596, 1.1687272727272728, 1.001161890007746, 1.2125984251968505, 2.0, 1.16072408118486, 1.0868691380080393, 1.170182841068917, 1.0634920634920635, 1.0, 1.6666666666666667, 1.1114823868732524, 1.1272727272727272, 1.103426306102223, 1.5, 1.0, 1.0256410256410255, 1.0476190476190477, 1.101123595505618, 1.0524861878453038, 1.1276371308016877, 1.0631399317406143, 1.0008403361344538, 1.0445403689436905, 1.0555555555555556, 2.0, 1.0952850944831698, 1.0262657559326809, 1.094570928196147, 1.0144199164493077, 1.0968910184978828, 1.014407879413037, 1.1104928457869634, 1.0823724099079275, 1.013755980861244, 1.0852187028657616, 1.0471965020576133, 1.0909090909090908, 1.0360929954697067, 1.2407407407407407, 1.2045454545454546, 1.25, 1.015509601181684, 1.0, 1.0854700854700854, 1.147513626270103, 1.0779944289693593, 1.3884711779448622, 1.008424426728035, 1.0570469798657718, 1.0359227552982557, 1.0599400487033985, 1.1111111111111112, 1.0346671516915242, 1.6666666666666667, 1.0300489719396917, 1.0, 1.04805425333394, 1.0526315789473684, 2.0, 1.2173913043478262, 1.126984126984127, 1.080683713538999, 1.0, 1.013953488372093, 1.0068337129840548, 1.0080128205128205, 1.018293178755634, 1.1454545454545455, 1.1446540880503144, 1.0119445225706651, 1.2392104617326367, 1.095121310326706, 1.1282051282051282, 1.0, 1.1121718377088305, 1.2767295597484276, 1.1342756183745584, 1.1726621735467566, 1.0321100917431192, 1.0441176470588236, 1.2826086956521738, 1.0041322314049588, 1.0330237358101135, 1.2857142857142858, 1.0045561061810917, 1.0340909090909092, 1.0526315789473684, 1.1059955122591945, 1.1904761904761905, 1.2727272727272727, 1.0095193801095732, 2.0, 1.1934156378600822, 1.0392441860465116, 1.0828547990155866, 1.0563324011186577, 1.112271540469974, 1.1818181818181819, 1.1047633220146376, 1.089822545702393, 1.0251396648044693, 1.028696026249863, 1.0341007194244605, 2.0, 1.0, 1.036152562901346, 1.25, 1.0691578360290017, 1.3529411764705883, 1.0, 1.375, 1.3805220883534137, 1.0679245283018868, 1.048780487804878, 1.0010834236186348, 1.0, 1.1651131824234353, 1.0771772449209782, 2.0, 1.0899344848123884, 1.0, 1.09149016928566, 1.0113636363636365, 1.0139071109944897, 1.1543778801843319, 1.1363636363636365, 1.399284862932062, 1.25, 1.0139680750895246, 1.0156196249732263, 1.0759312320916905, 1.0, 1.1666666666666667, 1.5714285714285714, 3.0, 1.2307692307692308, 1.0700319137984284, 1.3333333333333333, 1.016638935108153, 1.2784810126582278, 1.0767195045426023, 1.0639218045637255, 1.2481977342945416, 1.0188565626033155, 1.0092807424593968, 1.0571428571428572, 1.5, 1.0412147505422993, 1.102127659574468, 1.050084623070492, 1.1428571428571428, 1.5714285714285714, 1.0133630289532294, 1.026252983293556, 1.0248416696277407, 1.02, 1.1464387464387464, 1.0087551299589603, 1.0256410256410255, 1.0907770515613653, 1.0444915254237288, 1.1538461538461537, 1.0240793201133145, 1.1714285714285715, 1.0774588129813158, 1.061701475444918, 1.0223497999607598, 1.036144578313253, 1.2333333333333334, 1.088145896656535, 1.0, 1.0068398760983628, 1.052681816711067, 1.0188120176405733, 1.0622913027461884, 1.0225872689938398, 1.1582459485224024, 1.8333333333333333, 1.1927502876869966, 1.2, 1.2211784799316823, 1.25, 1.0285430100917534, 1.03768115942029, 1.1154342218400688, 1.1146245059288538, 1.014446227929374, 3.0, 1.2320461927102129, 1.0126248357020895, 1.0897553798050394, 2.0, 1.253968253968254, 1.2293666026871402, 1.3231939163498099, 1.1301121511088625, 1.4074844074844075, 1.2352941176470589, 1.177739430543572, 1.0268304974921405, 1.0389544916913889, 1.1061280116816743, 1.0701754385964912, 1.0149253731343284, 1.03125, 1.875, 1.0824175824175823, 1.4444444444444444, 1.2267782426778242, 1.2424242424242424, 1.0946941612604264, 1.25, 1.1102963830180541, 1.0838990187148774, 1.064774830351635, 1.0, 1.163265306122449, 1.16, 1.284757286407039, 1.3610503282275712, 1.0, 1.0644900360320613, 1.0837040855944449, 1.0033153750518027, 1.5, 2.0, 1.0003885003885005, 1.006311992786294, 1.0950819672131147, 1.1111111111111112, 1.0776955273751656, 1.0773143438453714, 1.4705882352941178, 1.0365348399246703, 1.0454545454545454, 1.073490813648294, 1.0661290322580645, 1.3723180479596129, 1.0175817757009347, 1.0, 1.0277777777777777, 1.043790245239074, 1.0361599256532381, 1.008938121940942, 1.0, 1.112585711125857, 1.0062679147773725, 1.0220010476689365, 2.0, 1.0406698564593302, 1.016877736453086, 1.0391850914122531, 1.0695906688218078, 1.0123741019861952, 1.0494669509594883, 1.0329861111111112, 1.1010125361620058, 2.0, 1.054163005840095, 1.574468085106383, 1.0, 1.150259067357513, 1.1346153846153846, 1.008264428366619, 1.0758683729433272, 1.0447655637746813, 1.156493804497476, 1.0944494346076705, 1.1056404707155418, 1.0342013708288544, 1.1704545454545454, 4.0, 1.0123730644580482, 1.204655870445344, 1.0481450703389328, 1.0529968060924026, 1.117199391171994, 1.1435897435897435, 2.3222222222222224, 2.5714285714285716, 1.0063950211942274, 1.0313972791995811, 1.0310445371905552, 1.1601978691019788, 1.0460374084072503, 1.0082474226804123, 1.0604820232413257, 1.0199568500539373, 1.2323390894819466, 3.0, 1.0833333333333333, 1.0061728395061729, 1.0865384615384615, 1.1245283018867924, 1.0865633074935401, 1.1058823529411765, 1.1179775280898876, 1.148905109489051, 1.0833333333333333, 1.084073359073359, 1.1770833333333333, 1.0362362777635945, 2.0, 1.2, 1.008, 1.2589285714285714, 1.0960893854748603, 1.0578703703703705, 1.0276679841897234, 1.0418918918918918, 1.1125141996671333, 1.0, 1.297872340425532, 1.1666666666666667, 1.5, 1.1704545454545454, 1.1713709677419355, 1.0125, 1.0533980582524272, 1.0645626401794297, 1.017401392111369, 1.0800281189877163, 1.1405116671352262, 1.037837837837838, 1.1101460506064813, 1.0108108108108107, 1.1221779548472774, 1.0716013546202225, 1.064592670709201, 1.283236994219653, 1.1437827830916383, 1.0451021132113718, 1.2079068387479603, 1.0853328927024444, 2.0, 1.1302211302211302, 1.0712871287128714, 1.4339622641509433, 1.0, 1.0851063829787233, 1.25, 1.0721062618595825, 1.2592592592592593, 1.1666666666666667, 1.008518813891104, 1.1258052899043656, 1.0240176931632996, 1.0237212177406891, 1.2378378378378379, 1.1106612685560053, 2.0, 1.1323529411764706, 1.059713492179506, 1.0589821234095678, 1.0845408110080268, 1.1296275202187038, 1.0215151957919346, 1.1428571428571428, 1.1118817415788493, 1.1136767317939609, 1.0284099827342645, 1.0840753779250363, 1.303030303030303, 1.0818083961248655, 1.0, 1.2387640449438202, 1.2058606406102612, 3.0, 1.1147727272727272, 1.0654125990053416, 1.4285714285714286, 1.0505998561858987, 1.1, 1.1176470588235294, 1.0494162064941919, 1.6923076923076923, 1.026165355377494, 1.0559589918838104, 1.3571428571428572, 1.16, 1.1731958762886598, 1.024390243902439, 1.0083885209713024, 1.0242201721637716, 1.157076775109537, 1.0, 1.0303606343688898, 1.1128048780487805, 2.0, 1.0245522000094522, 1.1179773336793841, 1.1523178807947019, 1.023200356585692, 1.0246969354717266, 1.0272727272727273, 1.8571428571428572, 1.0524419535628502, 1.0290322580645161, 1.1296557107223457, 1.211802748585287, 1.0047251480951747, 1.0551972025244152, 1.326007326007326, 1.1346559729843817, 1.1872909698996656, 1.0695402264653906, 1.0511041009463722, 1.0507246376811594, 1.0330982094411285, 1.05412023433313, 3.0, 1.123187232225674, 1.016469470855099, 1.0366881048200447, 1.7272727272727273, 1.2646160255520067, 1.1991150442477876, 1.1428571428571428, 1.0770261691472103, 1.0420575865415722, 1.138646288209607, 1.0303030303030303, 1.3333333333333333, 1.0502554755001865, 1.5, 1.1004672897196262, 1.0, 1.0555439257553556, 1.3846153846153846, 1.1054852320675106, 1.0366876310272537, 1.0, 1.6362433862433863, 1.2990654205607477, 1.25, 2.0, 1.0991735537190082, 1.2275862068965517, 1.0105136677680986, 1.2140127388535031, 1.1130434782608696, 1.2153392330383481, 1.1014466214978942, 1.0597402597402596, 1.1085972850678734, 1.420408163265306, 1.1538461538461537, 1.0, 1.045271629778672, 1.0447330447330447, 1.026511134676564, 1.03174772848744, 1.0816121701805328, 1.0655737704918034, 1.109966501645273, 1.1248192596876807, 1.1638655462184875, 1.036487322201608, 1.5714285714285714, 1.0, 1.2592592592592593, 1.012058890491007, 1.11738746690203, 1.107843137254902, 1.118457300275482, 1.0426116838487973, 1.074565501775369, 1.0132640169522416, 1.1470588235294117, 1.2222222222222223, 1.028941355674029, 1.0229984093319193, 1.054828811369509, 1.0375332547105125, 1.027027027027027, 1.0301978735971649, 1.0215078630897316, 1.1318840579710145, 1.3477596741344195, 1.2857142857142858, 1.055264411624583, 1.6786389413988658, 1.1063829787234043, 1.1433021806853583, 1.0701001430615165, 1.0, 1.0528846153846154, 1.0141875379291114, 1.125, 1.097556898239916, 1.024972855591748, 1.2647058823529411, 1.0152023910556807, 1.0209084354722422, 1.0381077088369595, 1.0562977099236641, 1.0158910329171396, 1.2001758598532246, 1.2147505422993492, 1.2142857142857142, 1.0, 1.4285714285714286, 1.061911105728473, 1.3333333333333333, 1.2265056254136333, 1.1116256528996824, 1.0219317678334072, 1.09493545183714, 1.0543987441444234, 1.0140202151940008, 1.014336917562724, 1.0124826629680999, 1.0027973872214975, 1.0545322459692539, 1.0405516622191187, 1.2253402384680236, 1.6666666666666667, 1.0666666666666667, 1.0811965811965811, 1.0733127664737079, 1.0336700336700337, 1.2658126501200961, 1.0161870503597121, 2.220779220779221, 1.0705962398723683, 1.0469798657718121, 1.0353947368421053, 1.125, 1.0811545431012166, 1.0392007603614297, 1.327577184720042, 1.0581052631578947, 1.28, 1.2161458333333333, 1.1043956043956045, 1.5625, 1.0775523560209423, 1.5384615384615385, 1.0735930735930737, 1.0963855421686748, 1.0443661971830986, 1.0737660459229796, 1.0131108462455305, 2.75, 1.0821256038647342, 1.0966947314239495, 1.0488416023112395, 1.0139460462336336, 1.0062072023252377, 1.1030662781571658, 1.0769230769230769, 1.0950734658599828, 1.1142794949934698, 1.0462520648243225, 1.028056112224449, 1.0208333333333333, 1.134526854219949, 1.0136099620635703, 1.3937246963562753, 1.1010892743934066, 1.0, 1.3333333333333333, 1.0406239956488417, 1.0147058823529411, 1.2269557021677662, 1.128051153739227, 1.0750199521149242, 1.1221945137157108, 1.0938186907965421, 1.0814549013211547, 1.1084558823529411, 1.0335195530726258, 1.0492285084496693, 1.0993226328964807, 1.0952380952380953, 1.75, 1.0651154083340675, 1.166158068943247, 1.011534025374856, 1.0, 1.2295438088341781, 1.0330572575837027, 1.1549058195108237, 1.0178117048346056, 1.2307692307692308, 1.0909703504043127, 1.1336515513126493, 1.153125, 1.6538461538461537, 1.051044809475919, 1.1883052527254707, 1.1575456053067994, 1.025, 1.0208513057143813, 1.0858624663849406, 1.0715528781793842, 1.1991483462071697, 1.3333333333333333, 1.12, 2.0, 1.1473354231974922, 1.4230769230769231, 1.0, 1.1538461538461537, 1.018543046357616, 1.065217391304348, 1.0004995091031228, 1.0516681181751188, 1.0545454545454545, 1.3076923076923077, 1.1428571428571428, 1.0, 1.0675675675675675, 1.1142857142857143, 1.0936967632027257, 1.025668127756428, 1.0286260250083485, 1.3473684210526315, 1.0952380952380953, 1.0481257194334619, 2.5, 1.0676822836922868, 1.2152777777777777, 1.5, 2.0, 1.1523668639053255, 1.1328982285017573, 1.0986562340534105, 1.2608695652173914, 1.0, 1.3096446700507614, 1.1748466257668713, 3.0, 2.0, 1.0199311023622046, 1.1713940045705067, 1.0094964388354366, 1.6666666666666667, 1.0249770238511078, 1.0487993803253293, 1.0061538461538462, 1.0, 1.1032863849765258, 1.023750860289057, 1.2236842105263157, 1.1198929961089494, 1.0978452706502977, 1.2318840579710144, 1.0078125, 1.107635975284156, 1.0655141037306641, 1.0991735537190082, 1.1694915254237288, 1.0257970848063782, 1.3058616834371506, 1.058730363574504, 1.0986842105263157, 1.0686274509803921, 1.2835820895522387, 1.118549511854951, 1.0465905584696082, 1.0275168198227764, 1.0797547422877947, 1.0403930131004366, 1.5, 1.6666666666666667, 1.1006200856613182, 1.1451187335092348, 1.0326784672242755, 1.0138805365668069, 1.0704131125606289, 1.0940554931569533, 1.1088435374149659, 1.0212765957446808, 1.122867699080261, 1.0928889893365659, 1.279788838612368, 1.0896946564885497, 1.6666666666666667, 1.0416666666666667, 1.0568781017369726, 1.127728375101051, 1.0244342879059065, 1.0970236295304332, 1.0078125, 2.0, 1.0932311621966795, 1.0080484686787838, 1.177061914553347, 1.3193916349809887, 1.0986089257616936, 1.019108280254777, 1.206401766004415, 1.0133333333333334, 1.0308863074695438, 1.0593905210876335, 1.0207373271889402, 1.0539811066126856, 1.0, 1.115091463414634, 1.0585519700155408, 1.0243572395128553, 1.0207584009865378, 1.1359039190897597, 1.0453857791225416, 1.2857142857142858, 1.2394736842105263, 1.6666666666666667, 2.0, 1.2352941176470589, 1.0076726342710998, 1.0497630331753554, 1.0040105462512532, 1.00307172213785, 1.023337856173677, 1.042887029288703, 1.1521739130434783, 1.1395348837209303, 1.0345265402610886, 1.6, 1.5, 1.1473880597014925, 1.1428571428571428, 1.0637393767705383, 1.1157430112800393, 1.0799104535721238, 1.090300433364172, 2.0, 1.0176470588235293, 1.2151162790697674, 1.0867208672086721, 1.04023505234089, 1.1704545454545454, 1.1335616438356164, 1.1316717352020802, 1.1654856712861352, 1.0302066772655007, 1.0985915492957747, 1.068435754189944, 1.0, 1.0, 1.041848467508315, 5.0, 1.4285714285714286, 2.076923076923077, 1.0422195416164053, 1.0930232558139534, 1.0798226164079823, 1.1063162024323263, 1.0, 1.111731843575419, 1.018107476635514, 1.2054054054054053, 1.2668269230769231, 1.4285714285714286, 1.0182309250506414, 1.1457871396895787, 1.1573033707865168, 1.1390851617701747, 1.0185218716769437, 1.063268222963316, 1.0946465542738835, 1.0, 1.2561238735880187, 1.0507732968433598, 1.0659971305595408, 1.1774193548387097, 1.13190818102698]
origin-bjaq_15.71 	max: 5.0000	99th: 2.5732	95th: 1.6941	median: 1.0840	mean: 1.1724

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 14.053132 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[1.1920929e-07 2.3841858e-07 4.7683716e-07 1.0132790e-06 1.1920929e-07]
Distance score: 3.9339064983323624e-07
SAUCE Drift detection: False
Detection latency: 0.0234s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.019023 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 3.0000	95th: 1.6667	median: 1.0771	mean: 1.1742
ReportEsts: [1.0161290322580645, 1.0064935064935066, 1.0472261426555205, 1.0426621160409557, 1.4166666666666667, 1.0, 1.05, 1.050424805012347, 1.0, 1.0306010928961749, 1.1470892844239986, 1.0428046415848728, 1.01953125, 1.187866927592955, 1.0667257159728374, 1.1304347826086956, 1.1590909090909092, 1.2727272727272727, 1.2727272727272727, 1.092887029288703, 1.1150615579334944, 1.0035657142857144, 1.03954802259887, 1.0102915951972555, 1.0240155738430228, 1.0178704435648425, 2.0, 1.1607353074345739, 1.8, 1.1666666666666667, 1.1666666666666667, 1.0, 1.0464878700036142, 1.0067074602752666, 1.007511737089202, 1.0732632093933463, 1.2219117596329643, 1.1428571428571428, 4.0, 1.10871694417238, 1.0433857539315448, 1.0456598093326643, 1.0942028985507246, 1.0697463768115942, 1.0222222222222221, 1.0279018220932885, 1.0416666666666667, 1.0773333333333333, 1.040983606557377, 1.018957345971564, 1.1590909090909092, 1.2202643171806167, 1.1222707423580787, 1.0294117647058822, 1.001062128553357, 1.039364406779661, 1.0749288176232579, 1.1394736842105264, 1.1235955056179776, 1.0466639098803525, 1.5666666666666667, 1.134505426781251, 1.0772727272727274, 1.1, 1.02, 1.5, 1.1130021515044475, 1.271918345982727, 1.8, 1.0, 1.0137094232587456, 1.0091093117408907, 1.0555555555555556, 1.0410958904109588, 1.0642170589570876, 1.166188197767145, 1.0317111459968602, 1.2471264367816093, 1.4951456310679612, 1.0832298590314806, 1.0426563257392147, 1.1436170212765957, 1.0, 1.7777777777777777, 1.0993150684931507, 1.2857142857142858, 1.028909329829172, 1.08, 2.0, 1.102555502315924, 1.114410611998794, 1.2987766354603412, 1.1095879881110997, 1.0016677476141944, 1.0585241730279897, 1.0236406619385343, 1.1506024096385543, 1.0347938144329898, 1.4, 1.2560689115113548, 1.0344827586206897, 2.0, 1.0486756971024747, 1.2023759015697921, 1.0113314447592068, 1.2312838599425517, 1.4666666666666666, 1.0117487798236242, 1.0783964365256125, 1.1540406035231852, 1.1316950220541904, 1.0465354129378674, 1.125, 1.0833333333333333, 1.0571761960326722, 1.0383012607830127, 1.0588859416445624, 1.0666666666666667, 1.0591543537625334, 1.0, 1.1171503957783642, 1.1397058823529411, 1.0, 1.0328638497652582, 1.125, 1.1941544885177453, 1.0279387606433024, 1.0300537599585466, 1.0819672131147542, 1.8333333333333333, 1.1143052703627652, 1.0, 1.0555555555555556, 1.1435437655975598, 1.1538461538461537, 1.62, 1.0150759327058148, 1.049546621043627, 2.0, 1.4285714285714286, 1.0248962655601659, 1.0893980233602876, 1.0642387455741023, 1.0363364648597828, 1.2389937106918238, 1.001628664495114, 1.0713025133375256, 3.0, 1.0184696569920844, 1.0057251908396947, 1.0720268006700167, 1.0963126843657818, 2.0, 1.1206131504638968, 1.0176991150442478, 1.0185185185185186, 1.2692307692307692, 1.0, 1.0005102040816327, 1.0803064356316006, 1.132194705380017, 1.0551839464882944, 1.005540166204986, 1.4363636363636363, 1.2518518518518518, 1.0024479804161566, 1.875, 1.0466189905207532, 1.2, 1.094437257438551, 1.1232682650409365, 1.017667844522968, 1.0084489281210594, 1.3071428571428572, 1.1080550098231827, 1.0995379751965633, 1.0431266846361187, 1.0523917995444192, 1.095392077607114, 1.053740779768177, 1.0740734636019746, 1.232337277330325, 1.1962025316455696, 1.0833333333333333, 1.0091715755722914, 1.063109954456734, 1.292857142857143, 1.0347282089517462, 1.0797101449275361, 2.0, 1.2436974789915967, 1.0731639366512604, 1.3636363636363635, 1.1473577235772359, 1.016993694607346, 1.054123144902893, 1.014649383267882, 1.0871287128712872, 1.0269203442014683, 1.0447221050367688, 1.0098320360507989, 1.0903879085697268, 1.0089201877934273, 1.0733913322375015, 1.0625293841090737, 1.1065645899331222, 1.6372093023255814, 1.0972222222222223, 1.1785714285714286, 2.0, 1.4592592592592593, 1.1400262467191602, 1.346704871060172, 1.2702702702702702, 1.0249791840133222, 1.0, 1.0374744849626614, 1.0562060889929743, 1.2316525608932332, 5.0, 1.0537084398976981, 1.0095654550423614, 1.0439844451091833, 1.035042827927563, 2.0, 1.1957411957411956, 1.0873118773694834, 1.0085425015819447, 1.0404312668463611, 1.0951585976627713, 1.0155815247634947, 1.0849643103845268, 1.3577235772357723, 1.0052392897591658, 1.020972682377946, 1.1, 1.006102877070619, 1.0464852607709751, 1.1818181818181819, 1.1553836234687298, 1.0, 1.2648390342052314, 1.1154397816129182, 1.1626284163597596, 1.1696750902527075, 1.0, 2.0, 1.1089391609927521, 1.0724637681159421, 1.0258934186421678, 1.2, 1.0515463917525774, 1.0763888888888888, 1.2857142857142858, 1.0061405666140408, 1.0246085011185682, 1.1262222222222222, 1.4705882352941178, 1.0183875530410185, 1.1735190738770114, 1.0147058823529411, 2.0, 1.0949015648662292, 1.082447965206586, 1.098981077147016, 1.1042235117789478, 1.083909836441105, 1.0221909844008026, 1.0889470241988228, 1.0759123873278722, 1.0467955239064088, 1.0228584894544597, 1.057777298695699, 1.2727272727272727, 1.0196828310641988, 1.060721062618596, 1.2156862745098038, 1.5, 1.096554199569275, 1.2822857142857143, 1.0247556142668428, 1.018537950332284, 1.0185185185185186, 1.2955465587044535, 1.0068578797233403, 1.0637659414853713, 1.0960171038723936, 1.0366781911722898, 1.1, 1.0637393767705383, 1.0006020469596628, 1.1453367276093498, 1.0595390770463096, 1.089442175173833, 1.2113648433351036, 1.1698525395958492, 1.034786312650859, 1.0349695547164677, 1.1152494729444835, 1.0398431863659257, 1.0054694621695532, 1.0108695652173914, 1.0714285714285714, 1.0821589205397302, 1.1176470588235294, 1.0143112701252237, 1.0095072225225958, 1.001816200508536, 1.4054054054054055, 1.024793388429752, 1.013215859030837, 1.0531309297912714, 1.0444303619208561, 1.12, 1.1985757646509456, 1.0224024124643993, 1.0412621359223302, 1.2, 2.7777777777777777, 1.034058448692595, 1.25, 1.003440359639082, 1.0476190476190477, 1.0, 1.0804706257182846, 1.12, 1.1538461538461537, 1.014537434068896, 3.0, 1.0723981900452488, 1.032967032967033, 1.0602891213110386, 1.0100686498855835, 1.0842105263157895, 1.0480769230769231, 1.0929996389239935, 1.078722641802852, 1.0596546310832025, 1.0238847934647288, 1.0243830265727645, 3.0, 1.0, 1.0535596901883448, 1.5, 1.0670703306939917, 1.2272727272727273, 2.0, 1.5555555555555556, 1.3717627401837929, 1.084251968503937, 1.2248062015503876, 1.0362173038229376, 1.3076923076923077, 1.5, 1.0646687697160884, 1.6, 1.25, 1.0007781339467052, 1.0636704119850187, 1.055722891566265, 1.0083025830258303, 1.75, 1.5, 1.3809931506849316, 1.595959595959596, 1.1319910514541387, 1.1278381920583755, 1.2569384482545949, 1.058227848101266, 1.5, 1.0266127928877296, 1.019047619047619, 1.56, 1.25, 1.009009009009009, 1.1428571428571428, 1.1974358974358974, 1.288659793814433, 1.2420856121161128, 1.0728449402946048, 1.1014851485148516, 1.0626398210290828, 1.1137370753323486, 1.120603015075377, 1.0821114369501466, 1.1239057111456399, 1.0515297906602254, 1.09375, 1.0041407965697318, 1.0408194147577885, 1.0350262697022767, 1.0974358974358975, 1.1282051282051282, 1.2145922746781115, 3.0, 1.0625, 1.4886363636363635, 1.1450381679389312, 1.5339805825242718, 1.0, 1.1039248203427308, 1.2179487179487178, 1.0235958016506645, 1.1046423135464232, 1.0431732801127025, 1.08, 1.0606060606060606, 1.1007751937984496, 1.0, 1.0517605171796263, 1.4038461538461537, 1.1102177491061125, 1.0324390181993552, 1.0967965969268165, 1.1494252873563218, 1.625, 1.3895604395604395, 1.1666666666666667, 1.018821889159986, 1.0909090909090908, 1.0536340042212415, 1.0133333333333334, 1.0711515916674181, 1.1155115511551155, 1.2242914979757085, 3.0, 1.2097058823529412, 1.018148288181236, 1.1102480004603257, 2.0, 1.1216216216216217, 1.281076801266825, 1.3322784810126582, 1.0959896595122283, 1.4252166620072686, 1.0869565217391304, 1.1772694781987134, 1.0372887508570967, 1.0412536183838155, 1.13298393287276, 1.0693709432663003, 1.9213483146067416, 1.1547619047619047, 1.0310472659870251, 1.1102599069468955, 1.032520325203252, 1.0122767857142858, 1.0, 1.0, 1.1772727272727272, 1.12890625, 1.0023688663282573, 1.1008597789139936, 1.0708055413032325, 1.0, 1.2017543859649122, 1.1612903225806452, 1.063490847821092, 1.0416666666666667, 1.0, 1.0283501637554586, 1.0, 1.0, 1.0299802761341224, 2.3333333333333335, 1.0057822036620623, 1.0075357950263752, 1.052924791086351, 1.3333333333333333, 1.0840143935273827, 1.1215277777777777, 1.45, 1.0370230687032498, 1.0147058823529411, 1.0647948164146868, 1.04418762746431, 1.17234262125903, 1.0297458085451596, 1.0, 1.0120481927710843, 1.08453603583224, 1.0561762391817466, 1.0492454328832406, 1.25, 1.0736476608187135, 1.0140998424231813, 1.02226102138804, 2.0, 1.0462870462870464, 1.0187721157114011, 1.0071624391810121, 1.06693689745837, 1.0097668395677717, 1.1440707575893705, 1.0085287846481876, 1.0611814671814672, 2.3333333333333335, 1.0353818307188416, 1.0862533692722371, 1.0798809228479285, 1.097018970189702, 1.040983606557377, 1.012791073345446, 1.3877551020408163, 1.0900168233389942, 1.120589375727026, 1.0443623642990454, 1.1475095785440612, 1.1174859305742317, 1.0846816875850598, 1.0227272727272727, 1.2210526315789474, 1.108697444614282, 1.0838709677419356, 1.0231832720928389, 1.0604320834368015, 1.0, 1.0620037807183365, 1.0482954545454546, 1.2727272727272727, 1.0961538461538463, 1.0236838205836027, 1.118279569892473, 1.1068573832562052, 1.0, 1.3333333333333333, 1.01144950767117, 1.1413608121413779, 1.0581872435658337, 1.0196326384631105, 1.0824781451919423, 1.032258064516129, 1.0020171457387796, 1.029529431301801, 1.5371428571428571, 1.0136764329629946, 1.0660761985097709, 1.0904522613065326, 1.1070701239556775, 1.6666666666666667, 1.009081114360474, 2.0, 1.1103810775295664, 1.0557377049180328, 1.006552925202196, 1.1402714932126696, 1.0377002827521207, 1.0180032733224222, 1.24853228962818, 1.1292863296152513, 1.0, 1.2678571428571428, 1.1666666666666667, 1.3333333333333333, 1.1009174311926606, 1.0043859649122806, 1.0165184243964422, 1.075, 1.0622003196590304, 1.0605263157894738, 1.044227584045839, 1.1822717364979414, 1.0550187119477183, 1.0722143440333463, 1.0141334763698873, 1.133668903803132, 1.051733239486187, 1.049880579986334, 1.0094246031746033, 1.0444203683640303, 1.103448275862069, 1.2533333333333334, 1.0094137610601592, 1.1805555555555556, 1.1018671708815884, 1.30635838150289, 1.0870913863039848, 1.0494736842105263, 2.0, 1.0058823529411764, 1.0588235294117647, 2.3333333333333335, 1.4291845493562232, 1.0370473688696717, 1.0352985354862936, 1.0279898218829517, 1.0497237569060773, 1.1069108649362551, 1.0304501981348508, 1.0718232044198894, 1.0, 2.0, 1.0902939804013065, 1.0221238938053097, 1.1264044943820224, 1.0788680120621665, 1.0, 1.3836681788723266, 1.141350210970464, 1.0941793019232726, 1.1137370753323486, 1.0066358372809985, 1.0118269725207882, 1.000815372915507, 1.425531914893617, 1.5, 1.1532823622462431, 1.0, 1.073546856465006, 1.2245762711864407, 1.311050477489768, 1.076313472262988, 1.6, 1.0214277914507228, 1.0620689655172413, 1.2195121951219512, 1.1047835990888382, 1.2082262210796915, 1.1676933607118412, 1.1011016163904046, 1.0027422303473492, 1.084375, 2.3333333333333335, 1.094964330675619, 1.0571506327391482, 1.0555555555555556, 1.0205338809034907, 1.2132939438700148, 1.015625, 1.0353639721352097, 1.4444444444444444, 1.074468085106383, 1.0705058672714722, 1.0212765957446808, 1.0114285714285713, 1.0149409488902463, 1.0461538461538462, 1.6666666666666667, 1.0241701579116984, 1.038255033557047, 1.1093516033338042, 1.168462291870715, 1.0276499687815186, 1.0843769170562478, 1.0287443267776097, 1.1258347978910368, 1.2401129943502824, 1.0445553662031837, 1.061578947368421, 1.0901639344262295, 1.0132919805050953, 1.0026257635198887, 1.0809523809523809, 1.0514147130153597, 1.0434782608695652, 1.1428571428571428, 1.0327044025157233, 1.5983912668773341, 1.0683814303638646, 1.1775700934579438, 1.1428571428571428, 1.0373376623376624, 1.0241789967520751, 1.0679012345679013, 1.0674376174602522, 2.3333333333333335, 1.1774735766344835, 1.5, 1.10873786407767, 1.1333333333333333, 1.0017529508005143, 1.4516129032258065, 1.143859649122807, 1.077260755048288, 1.0, 1.2592048791506663, 1.2658839779005524, 1.0, 2.0, 1.0551724137931036, 1.1755952380952381, 1.001254705144291, 1.2145833333333333, 1.0742857142857143, 1.3120567375886525, 1.0477386934673367, 1.0420819490586932, 1.1372549019607843, 1.5675675675675675, 1.2, 1.5, 1.042982456140351, 1.070828331332533, 1.0103896103896104, 1.034251290877797, 1.081272809499269, 1.0402139037433156, 1.0924665150990955, 1.1772594400747372, 1.17016317016317, 1.024822695035461, 1.625, 1.0, 1.1176470588235294, 1.0177957532861477, 1.0828402366863905, 1.0970350404312668, 1.1995073891625616, 1.0259008295864733, 1.0202419941775838, 1.017989368743278, 1.0833333333333333, 1.1428571428571428, 1.0, 1.021779988944168, 1.0528149200139338, 1.017075630252101, 1.0114285714285713, 1.0819882611885547, 1.1137573240259637, 1.0482444187786848, 1.0329428989751097, 1.1257109329160961, 1.0031347962382444, 1.0234165067178502, 1.2256637168141593, 1.0260329570004247, 1.25, 1.1316666666666666, 1.0, 1.1081081081081081, 1.017552367481646, 1.0769230769230769, 1.0690217715676458, 1.0696202531645569, 1.2820512820512822, 1.0378228007558261, 1.0500598086124402, 1.02666517595103, 1.022099447513812, 1.0756302521008403, 1.1937431548204105, 1.2261029411764706, 1.0526315789473684, 1.0, 1.625, 1.065849861507046, 1.5, 1.088068844449355, 1.0875014011882076, 1.003891771682728, 1.0627780523974295, 1.0867509912563906, 1.0134084204880665, 1.0365853658536586, 1.0601415094339623, 1.0211996977065638, 1.1129721815519766, 1.0440023029554595, 1.2728686058174523, 1.5714285714285714, 1.0018975332068312, 1.009933774834437, 1.086283664029741, 1.0245231607629428, 1.274452880750335, 1.0402476780185759, 2.167259786476868, 1.040569724067612, 1.0369127516778522, 1.0606809664301093, 1.3529411764705883, 1.0881525415420812, 1.0422862938174546, 1.3387737097485664, 1.0567823343848581, 1.4074074074074074, 1.1285425101214575, 1.2679209335556085, 1.0353159851301115, 1.0059880239520957, 1.0184197960158192, 1.3548387096774193, 1.01420896366464, 1.0583016476552598, 1.0251889168765742, 1.0057142857142858, 1.0222222222222221, 1.0450538687561215, 1.052947052947053, 1.004248589704251, 1.0933202357563852, 1.1786844882166725, 1.091919642857143, 1.0, 1.0901348474095103, 1.066255277687561, 1.0053635004546646, 1.0904560179416896, 1.0057712486883525, 1.1176470588235294, 1.0671875, 1.0279898218829517, 1.0093230365900956, 1.1391752577319587, 1.132098027495517, 1.2313238533947526, 1.0569441425777004, 1.132404181184669, 1.1184770316118262, 1.093468312300652, 1.0647291941875825, 1.0989690721649485, 1.103126335513988, 1.0790554414784395, 1.1316998468606432, 1.014218009478673, 1.031591737545565, 1.0652918859380738, 1.0776699029126213, 2.0, 1.050366531850354, 1.1717513359940472, 1.0379377431906616, 1.0192307692307692, 1.1988481357987268, 1.004321881698627, 1.1629055007052187, 1.0139958012596222, 1.1142857142857143, 1.072077185017026, 1.5555555555555556, 1.156657963446475, 1.5757575757575757, 1.037325806692004, 1.1981757877280266, 1.1658653846153846, 1.0392156862745099, 1.0568878973786948, 1.1381543443065298, 1.0388349514563107, 1.3333333333333333, 1.0245098039215685, 1.0275590551181102, 1.1026167265264237, 1.0769230769230769, 1.00609984984985, 1.0013071895424837, 1.011646494633478, 1.2920353982300885, 1.3333333333333333, 1.3114419147694103, 1.0018246339956611, 1.040147446605829, 1.2179878048780488, 1.3389830508474576, 1.1764705882352942, 1.0256410256410255, 1.0705882352941176, 1.0595238095238095, 1.0431445758141464, 1.0347113906516585, 1.0312305755963003, 1.305084745762712, 1.0754737418192597, 1.0468442472562298, 3.0, 1.1064308305025186, 1.1671612265084075, 1.5, 2.0, 1.217549829849295, 1.155421901982969, 1.0891376047580428, 1.1398963730569949, 1.0, 1.1407407407407408, 1.4408602150537635, 1.0615384615384615, 1.102506127239463, 1.0810729313724146, 1.0381416844679108, 1.0599846474394121, 1.4285714285714286, 1.0371507996430778, 1.0507152145643692, 1.0360515021459227, 1.0134976525821595, 1.017667844522968, 1.0, 1.0613496932515338, 1.2012849131594707, 1.045350302012339, 1.0081967213114753, 1.1026490066225165, 1.07762167772547, 1.101246105919003, 1.1267605633802817, 1.2, 1.0185965799236187, 1.4327553548011074, 1.0586141479728541, 1.4341463414634146, 1.2773109243697478, 1.2491694352159468, 1.25, 1.0678899082568807, 1.078880407124682, 1.0089184416404409, 1.0828729281767955, 2.0, 1.0064599483204135, 1.0342932694294096, 1.1961067051189618, 1.1449181390825094, 1.0281959649207915, 1.004970316167334, 1.107031605474082, 1.113978494623656, 1.0178571428571428, 1.0656111545478237, 1.0964808731951003, 1.2590062111801241, 1.302063789868668, 1.6666666666666667, 1.0481927710843373, 1.0563612931331796, 1.0432098765432098, 1.0318331209336642, 1.0860852083155104, 1.0023391812865496, 3.0, 1.1158342189160468, 1.0247936998379743, 1.1725062224775034, 1.0031948881789137, 1.08470038987807, 1.0185676392572944, 1.3791512915129152, 1.025505293551492, 1.0322218693765217, 1.121642517024218, 1.0132701421800947, 1.0476190476190477, 1.0, 1.113598475827578, 1.144105816831683, 1.0421570777590954, 1.1010309278350516, 1.1435381355932204, 1.026015228426396, 1.0, 1.2572062084257207, 1.6666666666666667, 2.0, 1.3157894736842106, 1.0085653104925054, 1.0290620871862615, 1.0356559869410749, 1.0112179658611553, 1.05318138651472, 1.0386759581881533, 1.12, 1.0563186813186813, 1.0561646639183697, 1.5, 1.2222222222222223, 1.1426356589147286, 1.0, 1.0, 1.1543681085665818, 1.0353922452660054, 1.0797469210989308, 2.0, 1.1364705882352941, 1.1705756929637527, 1.024162016474965, 1.0411454010701322, 1.1458117890382626, 1.1206896551724137, 1.1379303975173636, 1.1265937610240386, 1.0093582887700534, 1.105263157894737, 1.0564516129032258, 1.3333333333333333, 3.0, 1.0422768833937803, 5.0, 1.0833333333333333, 1.9428571428571428, 1.001984126984127, 1.1014455417203377, 1.1428571428571428, 1.038910505836576, 1.0, 1.0761680408323517, 1.0086124401913876, 1.170731707317073, 1.3089430894308942]
origin-bjaq_15.71 	max: 5.0000	99th: 3.0000	95th: 1.6667	median: 1.0771	mean: 1.1742

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.239613 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.377691