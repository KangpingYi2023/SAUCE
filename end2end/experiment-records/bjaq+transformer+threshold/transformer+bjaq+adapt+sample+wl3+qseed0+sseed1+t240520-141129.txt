Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 1, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.6700	95th: 1.6667	median: 1.0793	mean: 1.1697
ReportEsts: [1.0161290322580645, 1.0, 1.0509309491775531, 1.0677618069815196, 1.5789473684210527, 1.0, 1.0793721226912196, 1.0634454161138613, 1.0, 1.0277044854881265, 1.14933771967795, 1.043014195270648, 1.0276219249028917, 1.0395348837209302, 1.0529848110208406, 1.0, 1.2222222222222223, 1.0208997520368401, 3.0, 2.0, 1.2272727272727273, 1.0816926378650742, 1.0987202925045705, 1.121550205519671, 1.0809077454366058, 1.0, 1.155644550276004, 1.2, 1.2, 1.064748201438849, 1.0, 1.0435010875271882, 1.001922887289222, 1.1082130965593784, 1.0082926106915444, 1.2311218536422737, 1.0695187165775402, 1.007900108173724, 1.1597561815552035, 1.0357142857142858, 1.1320754716981132, 1.0649350649350648, 1.0, 1.0064760302775442, 1.1363716038562663, 1.890625, 1.03, 1.2968197879858658, 1.0288473266924172, 1.037037037037037, 1.118141414141414, 1.0738007380073802, 1.0394614861663336, 2.0, 1.1272727272727272, 1.3356745683347966, 1.305792972459639, 1.3725490196078431, 1.0733333333333333, 1.25, 1.083469647400945, 1.1027397260273972, 1.1136363636363635, 1.0, 1.1, 1.0946877841770233, 1.323806430659305, 1.75, 1.0, 1.0813834250023306, 1.020706455542022, 1.0584490740740742, 1.034965034965035, 1.0875278603268945, 1.1011764705882352, 1.0188679245283019, 1.0, 1.1077244258872652, 2.6666666666666665, 1.0578065367729346, 1.0, 1.0383715134045644, 1.2208588957055215, 1.0792079207920793, 1.1251226692836114, 1.04, 1.0545154324907913, 1.0068954156076437, 1.053921568627451, 1.75, 1.1153081510934393, 1.0421855056437526, 1.0155763239875388, 1.035063113604488, 1.0100456621004565, 1.044155844155844, 1.0150375939849625, 1.159248269040554, 1.0, 1.2155097613882864, 1.1377785058977719, 1.0548885077186965, 1.2486341205498765, 1.2142857142857142, 1.0011783818774294, 1.077249800902575, 1.1048478527050927, 1.1452408039438755, 1.0453709380748006, 1.1666666666666667, 1.6666666666666667, 1.0203271028037384, 1.0708629530517202, 1.0372710044219835, 1.0909090909090908, 1.0608775079530064, 1.0, 1.1333964049195837, 1.1260775862068966, 1.0, 1.011111111111111, 1.0, 1.2380952380952381, 1.0118603359662124, 1.0827055991302321, 1.108910891089109, 1.8, 1.1051324503311257, 1.0, 1.0357142857142858, 1.1026469415505413, 1.1818181818181819, 1.0582682291666667, 1.051492523252966, 1.0937125235566216, 1.0226969292389854, 1.028169014084507, 1.054559625876851, 1.039972432804962, 1.081048141377209, 1.025204899238767, 1.2461538461538462, 1.0065231572080888, 1.1424590183884826, 2.0, 1.0191431175934367, 1.0091428571428571, 1.1018455228981545, 1.0942297511911063, 1.5, 1.2346815209493824, 1.06973058637084, 1.0060362173038229, 1.1074561403508771, 1.164963503649635, 1.0441823622601654, 1.073624342385895, 1.1689242607916512, 1.1027253668763102, 1.082236842105263, 1.2857142857142858, 1.38, 1.0119225037257824, 1.2857142857142858, 1.0470497782528387, 1.0366529672357394, 1.0924528301886793, 1.3758718931132725, 1.1471618780658726, 1.0662320108133896, 1.2273684210526317, 1.0818181818181818, 1.073302992156483, 1.076845298281092, 1.0215703192407248, 1.0573372206025267, 1.059012187299551, 1.1105756819550814, 1.0464732248171738, 1.0, 1.0677966101694916, 1.0488286762630539, 1.0283094098883572, 1.1870882740447959, 1.2236842105263157, 1.1049560131960412, 1.2819527195848548, 1.1099712139904334, 1.1372549019607843, 1.0990909090909091, 1.0572353426119006, 1.0, 1.0909090909090908, 1.0200960413219806, 1.0079455164585698, 1.0313508529276165, 1.4583333333333333, 1.064951768488746, 1.0497644090701224, 1.0673578848150505, 1.0626410835214446, 1.0587119215768948, 1.3276836158192091, 1.1228070175438596, 1.1666666666666667, 1.0, 1.3559322033898304, 1.1055827156599904, 1.240418118466899, 1.2758620689655173, 1.013346515076619, 1.0031277926720286, 1.030835526199601, 1.0625901675729663, 1.1147552852591949, 1.0864197530864197, 1.0621387283236994, 1.0118032786885245, 1.0825435119765638, 1.006320791713765, 1.0, 1.0728778467908904, 1.0674177220176078, 1.0179560448405782, 1.133696309739867, 1.0169877825775846, 1.2810315869317874, 1.0357142857142858, 1.0064060562259387, 1.0522176379577102, 1.0507614213197969, 1.136094674556213, 1.0270558159352365, 1.004255319148936, 1.1661417322834646, 2.0, 1.2259559675550407, 1.0258485931219294, 1.1521331458040318, 1.0850202429149798, 1.0, 1.6666666666666667, 1.0787534513990258, 1.1272727272727272, 1.0799182457477396, 1.5, 1.0, 1.0256410256410255, 1.0423108218063466, 1.101123595505618, 1.0082872928176796, 1.090717299578059, 1.0631399317406143, 1.0050377833753148, 1.1760902808695146, 1.0363636363636364, 2.0, 1.0866695453704276, 1.0286561264822134, 1.1085814360770578, 1.0821539812279197, 1.1119457780288053, 1.0475748672748828, 1.0945945945945945, 1.0861398165589846, 1.0251196172248804, 1.0392893254369493, 1.1279955672530821, 1.0, 1.0409252891528602, 1.2407407407407407, 1.2045454545454546, 1.4705882352941178, 1.056067588325653, 1.0555555555555556, 1.0854700854700854, 1.0824305228450306, 1.0779944289693593, 1.3383458646616542, 1.0196179689911438, 1.0374238468233246, 1.0120334932228034, 1.0616416750222502, 1.0, 1.0308839578028375, 1.6666666666666667, 1.0200399484874767, 1.0243362831858407, 1.0594055800828364, 1.0526315789473684, 1.6666666666666667, 1.4782608695652173, 1.0597014925373134, 1.076970898691848, 1.0, 1.0548387096774194, 1.081447963800905, 1.0056089743589745, 1.0174567863946842, 1.125, 1.1761006289308176, 1.0194065532273942, 1.0767356139763, 1.0753881219627575, 1.1111111111111112, 1.0, 1.0954653937947494, 1.2453987730061349, 1.1588447653429603, 1.0994524010109519, 1.0391993327773144, 1.3352112676056338, 1.3111111111111111, 1.0041152263374487, 1.0267549668874172, 1.2857142857142858, 1.0065978397271558, 1.0360531309297913, 1.1875, 1.0800404991243433, 1.0952380952380953, 1.5555555555555556, 1.005328438308667, 2.0, 1.1330589849108368, 1.0261627906976745, 1.088597210828548, 1.0783034257748776, 1.0550964187327823, 1.0833333333333333, 1.1073337031074555, 1.087785918875717, 1.0470756062767475, 1.0145584626263466, 1.0424251214736384, 2.0, 1.0, 1.047750177106424, 1.25, 1.070949720670391, 1.3529411764705883, 1.0, 1.4666666666666666, 1.3393574297188755, 1.0659133709981168, 1.2285714285714286, 1.0076335877862594, 1.0, 1.1431424766977363, 1.0917074614019044, 2.0, 1.1000595592614653, 1.0, 1.0936460942837622, 1.0229885057471264, 1.0018630280766203, 1.1382488479262673, 1.1363636363636365, 1.3651162790697675, 1.2314814814814814, 1.0078440676458158, 1.0182930995773258, 1.0774748923959827, 1.0, 1.1666666666666667, 1.5714285714285714, 1.5, 1.1428571428571428, 1.0692907013428803, 1.3333333333333333, 1.0016638935108153, 1.364864864864865, 1.1938469915600327, 1.0902194668968583, 1.2687950566426365, 1.0290110045813063, 1.009860788863109, 1.0404761904761906, 1.5, 1.0762331838565022, 1.0893617021276596, 1.0528110561393467, 1.0476190476190477, 1.5714285714285714, 1.0417633410672853, 1.013553329404832, 1.0251773741654004, 1.0290037831021437, 1.1464387464387464, 1.0216142270861832, 1.095890410958904, 1.0907770515613653, 1.103813559322034, 1.1346153846153846, 1.0240793201133145, 1.0336134453781514, 1.0506619621557485, 1.0279089040827412, 1.0265707310805603, 1.131578947368421, 1.1326530612244898, 1.1049382716049383, 1.0, 1.0039079242619067, 1.020749339817502, 1.0341812585977757, 1.054674224329495, 1.039769337840525, 1.1487130600571973, 1.8333333333333333, 1.034431137724551, 1.0, 1.1947053800170795, 1.25, 1.0309279505332019, 1.0492753623188407, 1.0738392089423903, 1.1304347826086956, 1.0176565008025682, 3.0, 1.239201451905626, 1.0100502974348922, 1.1003080743056832, 2.0, 1.0634920634920635, 1.2523992322456814, 1.2428571428571429, 1.12650247961671, 1.3097713097713097, 1.1666666666666667, 1.0791433891992552, 1.0105873279267068, 1.0785426731078904, 1.0978666254420375, 1.1341008771929824, 1.1592039800995024, 1.2272727272727273, 1.25, 1.0853994490358128, 1.5, 1.2206494587843464, 1.064516129032258, 1.1938597599494631, 2.272727272727273, 1.076854120600012, 1.167385588341439, 1.0987045033929672, 1.0, 1.1515151515151516, 1.12, 1.287460548068734, 1.2210065645514223, 1.0, 1.039270586546055, 1.0859366030996875, 1.0658930791545793, 1.5, 3.0, 1.0166990291262137, 1.013623978201635, 1.0032894736842106, 1.2222222222222223, 1.0660243844551296, 1.1147368421052632, 1.4705882352941178, 1.0240677966101694, 1.0454545454545454, 1.0485564304461943, 1.0056451612903226, 1.343710559528818, 1.0210665289019, 1.0, 1.0571428571428572, 1.0483504764525784, 1.0413239775687089, 1.0094567437036077, 1.0, 1.1289537712895377, 1.0148243243686939, 1.0220010476689365, 2.0, 1.0446570972886762, 1.0303537429815306, 1.0298230635616923, 1.013324013804552, 1.0080873521702158, 1.038474295190713, 1.0119047619047619, 1.142960462873674, 2.0, 1.0427412269367926, 1.5416666666666667, 1.0, 1.1554404145077721, 1.1346153846153846, 1.0077226352815658, 1.203476482617587, 1.0189326605118796, 1.0196537201684606, 1.1005431756597914, 1.1130799404842417, 1.0597628211796526, 1.0842105263157895, 4.0, 1.015993278117873, 1.1526315789473685, 1.0465919867235656, 1.0403554541007662, 1.1177067478437341, 1.2310725552050472, 2.2, 2.4285714285714284, 1.0018170953304308, 1.0526779049168273, 1.013601618705036, 1.1313543599257885, 1.1208301195526418, 1.0146443514644352, 1.068852424987805, 1.012405609492988, 1.2003058103975535, 3.0, 1.0909090909090908, 1.067103109656301, 1.064030131826742, 1.0170648464163823, 1.2014285714285715, 1.00990099009901, 1.2756410256410255, 1.148905109489051, 1.1304347826086956, 1.0495709921791494, 1.2282608695652173, 1.026247590152018, 2.0, 1.2010353753235548, 1.0873015873015872, 1.3428571428571427, 1.085754189944134, 1.13681592039801, 1.0197628458498025, 1.0211920529801324, 1.0707211960183574, 1.0, 1.297872340425532, 1.2, 1.5, 1.1136363636363635, 1.1411290322580645, 1.0509259259259258, 1.0776699029126213, 1.0613585389298301, 1.0417633410672853, 1.03424329926128, 1.1642750545287568, 1.032258064516129, 1.1253709522562625, 1.0918918918918918, 1.0903225806451613, 1.039187227866473, 1.0477426050856253, 1.1748554913294798, 1.1694006309148266, 1.033902599706076, 1.2178432545617708, 1.0804230056534516, 2.0, 1.3243243243243243, 1.0744786494538232, 1.3944954128440368, 1.0, 1.1333333333333333, 1.25, 1.202127659574468, 1.2962962962962963, 1.1666666666666667, 1.0063802188893394, 1.122705506783719, 1.0240241599627513, 1.037753583457351, 1.2594594594594595, 1.1351724137931034, 1.0, 1.193798449612403, 1.0102765707979862, 1.0866071665736978, 1.0852478681513547, 1.1030869119489692, 1.0113192535802111, 1.2207792207792207, 1.097812755519215, 1.0834813499111902, 1.0193286543937934, 1.065974510062313, 1.3333333333333333, 1.0912052117263844, 1.0, 1.2387640449438202, 1.2110259895382842, 3.0, 1.1393728222996515, 1.0247364691292409, 1.4285714285714286, 1.046954554026023, 1.2, 1.1176470588235294, 1.0448655808549843, 1.6923076923076923, 1.0162309802641916, 1.0328919265271252, 1.3571428571428572, 1.1153846153846154, 1.0762886597938144, 1.0052884615384616, 1.0189845474613686, 1.0894650475877912, 1.1565823808579145, 1.0, 1.0608298935476863, 1.1189024390243902, 2.0, 1.0204119288696174, 1.1067393373129164, 1.1012298959318827, 1.0198796523289504, 1.0228869931226277, 1.0272727272727273, 1.5714285714285714, 1.0652350081037276, 1.001615508885299, 1.0821780666180238, 1.1447117220313097, 1.0114057484049819, 1.0882430794522076, 1.0842490842490842, 1.0455075845974329, 1.2374581939799332, 1.0625476600046109, 1.0473186119873816, 1.0082191780821919, 1.0455793520043932, 1.0679554390563566, 3.0, 1.1207286616718084, 1.0241685076404654, 1.0316039320667194, 1.3571428571428572, 1.2439244549368143, 1.418848167539267, 1.1428571428571428, 1.0456020314594061, 1.0420575865415722, 1.1441048034934498, 1.0, 1.3333333333333333, 1.0519691491579273, 1.5, 1.060747663551402, 1.0833333333333333, 1.0099365750528542, 1.3846153846153846, 1.130801687763713, 1.0073375262054507, 1.0, 1.6481481481481481, 1.3012765957446808, 1.25, 2.0, 1.0901639344262295, 1.2275862068965517, 1.041486068111455, 1.2202304737516005, 1.06312292358804, 1.2448377581120944, 1.1014466214978942, 1.0571428571428572, 1.1502347417840375, 1.4979591836734694, 1.0384615384615385, 1.0, 1.1143497757847534, 1.0331890331890332, 1.0351239669421488, 1.011396601740572, 1.0617602954480674, 1.0350141255029535, 1.0864805976343639, 1.109384037015616, 1.1260162601626016, 1.006563245823389, 1.5714285714285714, 1.0, 1.2142857142857142, 1.0109053654094255, 1.0670785525154458, 1.107843137254902, 1.0304568527918783, 1.047880870561283, 1.0883967442740867, 1.0181039994537453, 1.0833333333333333, 1.2222222222222223, 1.0188536953242835, 1.0336370487086388, 1.0709835044108484, 1.0158474206637678, 1.006578947368421, 1.0739810986414648, 1.0181525909525182, 1.0090439276485788, 1.3553971486761711, 1.125, 1.076287657920311, 1.11, 1.1818181818181819, 1.2356902356902357, 1.0701001430615165, 1.0, 1.0682926829268293, 1.0372047772410091, 1.0925925925925926, 1.1136611499852729, 1.004255319148936, 1.2285714285714286, 1.0466788404473863, 1.05620043258832, 1.064867042707494, 1.0620229007633588, 1.0510783200908058, 1.1912322513510791, 1.206896551724138, 1.2857142857142858, 1.0, 1.4285714285714286, 1.0640426304953372, 1.3333333333333333, 1.2704370179948585, 1.0914328792202896, 1.0338945502879928, 1.063157894736842, 1.0491848948098916, 1.12454448017149, 1.021505376344086, 1.0027739251040222, 1.0023904008265434, 1.1205943007124108, 1.043779551197058, 1.1802661688546308, 1.6666666666666667, 1.015625, 1.0905172413793103, 1.1092412215328087, 1.0293159609120521, 1.3026641032683328, 1.0254083484573502, 2.25, 1.0595506226731992, 1.0389261744966443, 1.049641148325359, 1.125, 1.0757301202551008, 1.0126435866381134, 1.300358790363916, 1.0581052631578947, 1.25, 1.0711009174311927, 1.1551724137931034, 1.625, 1.037237951912645, 1.5769230769230769, 1.0553191489361702, 1.0833333333333333, 1.079330422125182, 1.005388112476848, 1.0191846522781776, 1.5714285714285714, 1.103448275862069, 1.1002242729512115, 1.071703983554642, 1.0060889434002205, 1.0032966136270909, 1.095113563086623, 1.0769230769230769, 1.112379280070237, 1.0116600790513834, 1.01709897763293, 1.0300601202404809, 1.0277777777777777, 1.018034265103697, 1.0576841749133046, 1.3606719367588933, 1.009742433318065, 1.0, 1.3333333333333333, 1.037775964795174, 1.032244008714597, 1.2205709999531198, 1.0655916967843573, 1.0534716679968077, 1.1083743842364533, 1.1007974293008447, 1.0627684811181637, 1.1011029411764706, 1.010928961748634, 1.0415754923413567, 1.073982722230403, 1.1071428571428572, 1.75, 1.0478981581798483, 1.1640530565539027, 1.0080459770114942, 1.0173410404624277, 1.220492396813903, 1.021790718162958, 1.1827382625808265, 1.1940298507462686, 1.1923076923076923, 1.0808625336927224, 1.0944700460829493, 1.1125, 1.5925925925925926, 1.060733042798078, 1.199207135777998, 1.1691542288557213, 1.146341463414634, 1.0174273581435784, 1.0927775643488282, 1.0743975903614458, 1.2904535551594376, 1.3333333333333333, 1.1666666666666667, 2.0, 1.1563915012190875, 1.1923076923076923, 1.0, 1.1538461538461537, 1.0543046357615895, 1.0960144927536233, 1.0472927897877864, 1.0259455926803365, 1.0618181818181818, 1.4166666666666667, 1.1428571428571428, 1.032258064516129, 1.0945945945945945, 1.0142857142857142, 1.0826306913996628, 1.0262016844181192, 1.0323438833438463, 1.3333333333333333, 1.0907586357823325, 1.0480906861518442, 2.5, 1.0698428090231704, 1.1254019292604502, 3.0, 2.0, 1.1857988165680473, 1.1057878505343184, 1.065327717018955, 1.31055900621118, 1.0, 1.178082191780822, 1.3190184049079754, 3.0, 2.0, 1.023419793502896, 1.1461217905632477, 1.0022491565662877, 1.6666666666666667, 1.0398158692368826, 1.0449264136328427, 1.015625, 1.0, 1.0234741784037558, 1.0255047345253239, 1.2763157894736843, 1.1839568067875048, 1.0133240239716064, 1.283987915407855, 1.12109375, 1.127942204614309, 1.0872794800371401, 1.0537190082644627, 1.2321428571428572, 1.0065887792593815, 1.867092943594428, 1.0430787368810392, 1.336, 1.1764705882352942, 1.2388059701492538, 1.03751617076326, 1.0717219589257503, 1.028592842036098, 1.1125119754742288, 1.0480349344978166, 1.5, 1.6666666666666667, 1.077223039059004, 1.1802990325417766, 1.1256564870647734, 1.017636013303715, 1.086134805151363, 1.1036508602601762, 1.5259515570934257, 1.0212765957446808, 1.0963760710635957, 1.0866943354358858, 1.280754716981132, 1.0297723292469352, 1.6666666666666667, 1.0273972602739727, 1.0439261642156863, 1.1326116373477673, 1.0652564059955465, 1.1023092282316174, 1.0106534090909092, 2.0, 1.07, 1.0190254646798373, 1.1823166552433173, 1.026615969581749, 1.0630274638821342, 1.0573248407643312, 1.216335540838852, 1.0164997053624043, 1.0325991892843276, 1.0513932149170806, 1.0184331797235022, 1.0582655826558265, 1.0, 1.17865055387714, 1.0584148459639822, 1.051388888888889, 1.0485504515922768, 1.1395053899809766, 1.018910741301059, 1.2, 1.2107969151670952, 1.6666666666666667, 2.0, 1.2941176470588236, 1.0051150895140666, 1.0244865718799367, 1.0003342121876044, 1.0144732902784313, 1.0027137042062415, 1.0554206226540075, 1.1032608695652173, 1.0, 1.0585660472653045, 1.6, 1.5, 1.3576158940397351, 1.1428571428571428, 1.0852601156069364, 1.1414952333166082, 1.0653447498873367, 1.1066936099073217, 2.0, 1.008744534665834, 1.2112403100775193, 1.1080408952749379, 1.040157068543171, 1.1527777777777777, 1.1263698630136987, 1.1522909841583269, 1.127107337780473, 1.0302066772655007, 1.1833333333333333, 1.0726256983240223, 1.0, 1.0, 1.0415355316333466, 5.0, 1.4285714285714286, 2.25, 1.0310945273631842, 1.1604938271604939, 1.106430155210643, 1.0545311887014515, 1.0, 1.0577281191806331, 1.019859813084112, 1.1989247311827957, 1.2692307692307692, 1.4285714285714286, 1.041556348566824, 1.1031042128603104, 1.1444444444444444, 1.0513201933804388, 1.0196262606288313, 1.0486796353726153, 1.1585329784087548, 1.0, 1.1826373905317933, 1.0320890102862594, 1.0490046628407461, 1.1774193548387097, 1.085951362070765]
origin-bjaq_15.71 	max: 5.0000	99th: 2.6700	95th: 1.6667	median: 1.0793	mean: 1.1697

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 14.028335 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[1.9073486e-06 1.7881393e-07 2.3841858e-07 1.2516975e-06 1.6689301e-06]
Distance score: 1.0490417707842425e-06
SAUCE Drift detection: False
Detection latency: 0.0233s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.031171 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 6.0000	99th: 3.0000	95th: 1.7007	median: 1.0834	mean: 1.1843
ReportEsts: [1.0485175202156334, 1.036411493748629, 1.0307774857115297, 1.0778546712802768, 1.375, 2.0, 1.0695588504484714, 1.0392618812742993, 1.1666666666666667, 1.026431718061674, 1.1203607937462416, 1.0427854491908704, 1.048094709581946, 1.1504950495049504, 1.0785650756003557, 1.082179132040628, 1.1815286624203822, 1.6, 1.2727272727272727, 1.097071129707113, 1.0974033337113052, 1.0448071635056053, 1.1096654275092936, 1.002514668901928, 1.0174512987012987, 1.0376368162097402, 2.0, 1.1676795915886715, 1.3333333333333333, 1.6, 1.0198863636363635, 1.0, 1.0416467964284928, 1.0111301523383567, 1.1505827505827506, 1.0180070568195645, 1.2398284698253321, 1.1903669724770642, 1.1818181818181819, 1.11, 1.0034303727053588, 1.106862366422042, 1.1070559610705597, 1.1519774011299435, 1.0090579710144927, 1.0274550868811152, 1.2272727272727273, 1.371900826446281, 1.0873362445414847, 1.0066844919786095, 1.0, 1.2602739726027397, 1.0326530612244897, 1.0606060606060606, 1.0219375091254197, 1.0558671268334772, 1.1012133312855168, 1.2893982808022924, 1.1363636363636365, 1.0435532732879598, 1.378787878787879, 1.0818566482882421, 1.0674846625766872, 1.039855072463768, 1.04, 3.0, 1.127913402463999, 1.2553355618410902, 1.6, 1.0, 1.0276676770031865, 1.0413306451612903, 1.064516129032258, 1.0675675675675675, 1.1349161560786842, 1.1320754716981132, 1.00135784416127, 1.0913705583756346, 1.5048543689320388, 1.056480625406212, 1.0499505440158259, 1.131578947368421, 1.0, 1.6666666666666667, 1.1162255466052935, 1.1774193548387097, 1.2794117647058822, 1.0625, 1.1428571428571428, 1.1226238329356373, 1.10984393757503, 1.3730519677399793, 1.0395700901176892, 1.0686468646864686, 1.002659574468085, 1.016355140186916, 1.1166666666666667, 1.0257400257400258, 1.1818181818181819, 1.2986193293885602, 1.2916666666666667, 2.0, 1.058250187931388, 1.2194492254733218, 1.0405693950177937, 1.2321583671105965, 1.088235294117647, 1.0174976501360171, 1.0452528837622006, 1.3328335150854236, 1.1412663060769965, 1.0521582733812949, 1.2857142857142858, 1.75, 1.072469476171721, 1.0506960297211405, 1.0665610142630746, 1.1111111111111112, 1.0617795710788176, 2.0, 1.1414646996838778, 1.1623376623376624, 1.0, 1.0235849056603774, 1.1428571428571428, 1.1326530612244898, 1.0229751559386386, 1.0251083931922604, 1.1074380165289257, 1.8333333333333333, 1.1798063623789765, 1.0, 1.25, 1.1357491032833624, 1.1666666666666667, 1.079147149087385, 1.0030493890133285, 1.1251748766659304, 1.3333333333333333, 1.4285714285714286, 1.00625, 1.045863309352518, 1.0720446473871132, 1.038791102106285, 1.2142857142857142, 1.012002182214948, 1.169469219166017, 1.5, 1.0224419931532902, 1.0249759846301634, 1.097309673726388, 1.107749077490775, 1.5, 1.1370180207389509, 1.0638020833333333, 1.0134228187919463, 1.2473118279569892, 2.0, 1.0337768679631525, 1.0758708868088391, 1.1599756426427732, 1.001615508885299, 1.0670391061452513, 1.3636363636363635, 1.5514018691588785, 1.0012004801920769, 1.7142857142857142, 1.0288403949813414, 1.1024734982332156, 1.0615384615384615, 1.1135615503998577, 1.0195811803100354, 1.0222175819586552, 1.2486772486772486, 1.1738241308793456, 1.0767989674088416, 1.0596658711217184, 1.0673732021196063, 1.0453074433656957, 1.048288670734943, 1.0382090951711205, 1.233644615344372, 1.1341463414634145, 1.6666666666666667, 1.0092640462783127, 1.1095729279768367, 1.2743682310469313, 1.2138200782268578, 1.0261282660332542, 3.0, 1.2869318181818181, 1.0575574607676717, 1.4285714285714286, 1.1415571284125379, 1.0331761006289308, 1.0411798287345386, 1.083440519432411, 1.0558823529411765, 1.0333057384000324, 1.009241301453135, 1.014559068219634, 1.0733893185514654, 1.0236742424242424, 1.056434877977576, 1.0695815702867888, 1.018253400143164, 1.0046948356807512, 1.0533333333333332, 1.1566265060240963, 1.0, 1.4565217391304348, 1.0971428571428572, 1.2979942693409743, 1.2844036697247707, 1.0044953003677972, 1.0526315789473684, 1.0486170289593413, 1.036613272311213, 1.2724169778741516, 2.0, 1.1241565452091768, 1.0127198917456022, 1.0640244633649119, 1.0149013752907061, 2.0, 1.0862745098039215, 1.096007744941995, 1.104328648325359, 1.0392670157068062, 1.064625850340136, 1.058858501783591, 1.0914715274081959, 1.31496062992126, 1.0044627820815089, 1.0108144751089636, 1.0712074303405572, 1.0269565217391305, 1.030905077262693, 2.5, 1.1221273801707157, 2.0, 1.1697808535178778, 1.0726186587016382, 1.138203356367226, 1.0396039603960396, 1.2857142857142858, 1.5, 1.1102650461268122, 1.1194029850746268, 1.1323120618805897, 2.0, 1.0277659120034173, 1.205179282868526, 1.4444444444444444, 1.0253307442139497, 1.1074766355140186, 1.0359897172236503, 1.2651162790697674, 1.0097902097902098, 1.104413835521098, 1.0, 2.0, 1.078576335222394, 1.1259578852469574, 1.072857142857143, 1.0101728688538918, 1.1006634850424863, 1.0264788337538548, 1.0805280528052805, 1.0884885764499121, 1.0178394449950445, 1.125721784776903, 1.1355758383755512, 1.1333333333333333, 1.017493661347969, 1.27803738317757, 1.2307692307692308, 1.2173913043478262, 1.029273392577104, 1.1150627615062763, 1.0112289348999461, 1.0091629955947137, 1.1126760563380282, 1.384133611691023, 1.0361723844912285, 1.1029065200314219, 1.0370489139729775, 1.057664609053498, 1.1, 1.0066265060240964, 1.1631291691934507, 1.0753808872035362, 1.0808834215105203, 1.0702926184344264, 1.1241342567927544, 1.1868317388857625, 1.0326156469835857, 1.0662790697674418, 1.1762181541637242, 1.017019515711349, 1.0404135338345866, 1.08, 1.0666666666666667, 1.0771531100478469, 1.1333333333333333, 1.0622641509433963, 1.0727527540577537, 1.003998933617702, 1.4722222222222223, 1.1260504201680672, 1.1739788199697427, 1.0825116761805915, 1.0285142323814298, 1.0833333333333333, 1.1542621987066433, 1.0177354796171854, 1.0963541666666667, 2.25, 1.6153846153846154, 1.0298840321141838, 1.1111111111111112, 1.0100633019344583, 1.060702875399361, 1.1363636363636365, 1.0814704705277, 1.2962962962962963, 1.3846153846153846, 1.0135390860940687, 3.0, 1.2067415730337079, 1.036231884057971, 1.150463655399342, 1.1198033080017882, 1.1723237597911227, 1.1170212765957446, 1.0961217022045537, 1.0980621993359985, 1.1343283582089552, 1.0071138141934601, 1.0519853390348197, 1.5, 1.1, 1.0535533817668707, 1.1666666666666667, 1.0586046511627907, 1.5555555555555556, 1.2, 1.2777777777777777, 1.3039134054954205, 1.0530835284933646, 1.2421875, 1.045045045045045, 1.3376623376623376, 1.5, 1.06442574997641, 1.5, 1.2461538461538462, 1.0103708344141384, 1.093385214007782, 1.0564024390243902, 1.0264150943396226, 1.0, 1.0, 1.3860386879730866, 1.0903225806451613, 1.013, 1.123709276724006, 1.2607833415964302, 1.0124069478908189, 1.5, 1.0283398452284598, 1.234375, 1.4, 2.3333333333333335, 1.0514734774066798, 1.0, 1.2319148936170212, 1.1142857142857143, 1.1530646964467992, 1.080748417733043, 1.1858350951374208, 1.125170737037644, 1.1116341627437794, 1.1077586206896552, 1.0911808669656202, 1.098201438848921, 1.1016949152542372, 1.0303030303030303, 1.0025158660348628, 1.0607009949115211, 1.0292330620199472, 1.0048543689320388, 1.0227272727272727, 1.1708860759493671, 4.0, 1.0, 1.6067415730337078, 1.2, 1.9800995024875623, 1.0785714285714285, 1.1072017592083563, 1.0121951219512195, 1.186623764651804, 1.14302103250478, 1.0289521970062772, 1.0957446808510638, 1.0833333333333333, 1.0854922279792747, 1.0, 1.0763101944194815, 1.392156862745098, 1.1071529758419432, 1.0797661568281112, 1.026596617960926, 1.1391304347826088, 1.625, 1.305279665446942, 1.1666666666666667, 1.2559681697612732, 1.3636363636363635, 1.0632486416399112, 1.023543990086741, 1.0749460819554277, 1.1229235880398671, 1.1938046068308181, 3.0, 1.3094852703140174, 1.0138068475816244, 1.1102935540737335, 2.0, 1.0133333333333334, 1.2555379746835442, 1.2937685459940653, 1.133051890941073, 1.0709629182680327, 1.12, 1.0326797385620916, 1.0103867490262424, 1.0583201685097419, 1.0751249748299379, 1.1053463260468792, 1.0689655172413792, 1.0833333333333333, 1.0108991825613078, 1.0682453626223858, 1.069767441860465, 1.2171052631578947, 1.0, 1.5, 1.1172233136869678, 1.0810810810810811, 1.0299338670379394, 1.143904542840713, 1.0873224618621777, 1.0, 1.228813559322034, 1.1333333333333333, 1.0295033028455285, 1.1666666666666667, 1.0, 1.0184227483766501, 1.5, 1.0, 1.0144706778370145, 1.75, 1.016866688290626, 1.0052910052910053, 1.058659217877095, 1.0909090909090908, 1.0759934362249424, 1.073394495412844, 1.7, 1.0565479934582966, 1.0866141732283465, 1.1013071895424837, 1.0162381596752368, 1.2670454545454546, 1.069367710251688, 1.0, 1.0588235294117647, 1.0201222146781064, 1.122854257825648, 1.0717131474103585, 1.6, 1.096851408580372, 1.0055347559013097, 1.0280824923211935, 2.0, 1.0492840492840494, 1.0599499465196216, 1.0614729902587818, 1.0601325757575757, 1.0071960822951562, 1.0111208436117827, 1.0091036414565826, 1.2353563400766892, 1.5, 1.1034735390449923, 1.1125, 1.0540606653620352, 1.0110071546505228, 1.1173333333333333, 1.006242964939342, 1.1996233521657251, 1.0781384179892497, 1.2929447852760736, 1.0802748348056626, 1.0506700167504188, 1.1222000995520158, 1.0182627726209343, 1.1264367816091954, 1.3291139240506329, 1.1025624774206633, 1.158351409978308, 1.0066505280519273, 1.0674622990112854, 1.0, 1.1020408163265305, 1.1911764705882353, 3.5, 1.1090909090909091, 1.008979940385951, 1.0962199312714778, 1.0466370558375635, 2.0, 1.0147058823529411, 1.0093671464473384, 1.0930630107012205, 1.0458955223880597, 1.0061782877316858, 1.124311565696302, 1.0966666666666667, 1.0149330587023686, 1.073281626103236, 1.5257142857142858, 1.0119238671163313, 1.03382949932341, 1.0769230769230769, 1.0571368946603719, 1.1260470682090147, 1.0277285681275514, 3.0, 1.155950752393981, 1.01, 1.0144958051245505, 1.0949227373068433, 1.1419753086419753, 1.0725806451612903, 1.0200235571260305, 1.097606512890095, 1.0, 1.5272727272727273, 1.3333333333333333, 1.6666666666666667, 1.1274509803921569, 1.0945945945945945, 1.0129032258064516, 1.1164658634538152, 1.0747172859450727, 1.375, 1.0762935667127285, 1.166116611661166, 1.0656882204509452, 1.1844359285465444, 1.0133326867432877, 1.1265193370165747, 1.13915857605178, 1.062034660837056, 1.0624690133862171, 1.1394557823129252, 1.1780645161290322, 1.6228070175438596, 1.0911992888314208, 1.1554524361948957, 1.1022449783379282, 1.3505747126436782, 1.2723300970873785, 1.0220635950681376, 1.0, 1.0665873959571939, 1.0625, 2.5, 1.310077519379845, 1.0235285112897052, 1.0447139067828723, 1.038659793814433, 1.1179775280898876, 1.054517233859692, 1.0483571363318005, 1.0605504587155963, 1.0, 1.3333333333333333, 1.0959774170783345, 1.0873362445414847, 1.1165279429250892, 1.0872404945183112, 1.0, 1.269118505545826, 1.1900647948164147, 1.0036139323322326, 1.0886262924667651, 1.0275705824189538, 1.0032547991559508, 1.010765584620892, 1.4893617021276595, 1.5, 1.1990750935917198, 1.0, 1.0184757505773672, 1.2085106382978723, 1.3059649122807018, 1.1472589035614245, 1.565217391304348, 1.092169408897014, 1.118881118881119, 1.0114754098360657, 1.0496744758291896, 1.2396373056994818, 1.1873727087576376, 1.01856039193518, 1.0090579710144927, 1.0583333333333333, 1.1666666666666667, 1.0689615561341705, 1.0888187872415003, 1.1904761904761905, 1.0275482093663912, 1.2394239423942395, 1.1666666666666667, 1.0149818142435538, 1.5555555555555556, 1.106951871657754, 1.0007850834151129, 1.2910798122065728, 1.2716763005780347, 1.0081689713833353, 1.0, 1.5, 1.053293611386958, 1.0026936026936026, 1.0324431256181998, 1.140973312401884, 1.0142816708163627, 1.0321546683472909, 1.1732522796352585, 1.0967961826857533, 1.2011019283746556, 1.015187481491579, 1.0609057782404998, 1.0053722179585571, 1.1172143207454635, 1.02204918513881, 1.1168831168831168, 1.0543282605138276, 1.0952380952380953, 1.6, 1.0697384806973849, 1.6099537037037037, 1.0891243377999378, 1.2615384615384615, 1.2142857142857142, 1.0153721682847896, 1.03450754852624, 1.0658682634730539, 1.0529267823265789, 2.3333333333333335, 1.1781268072930935, 1.5, 1.2162698412698412, 1.0, 1.0052488050904613, 1.4516129032258065, 1.1280276816608996, 1.0789473684210527, 1.0, 1.0741410089700922, 1.263157894736842, 1.2, 2.5, 1.103448275862069, 1.0968660968660968, 1.0432968179447053, 1.2377398720682302, 1.0646067415730338, 1.1159420289855073, 1.0625, 1.3225806451612903, 1.16796875, 1.2255892255892256, 1.064516129032258, 1.5, 1.1819085487077534, 1.0230582524271845, 1.0675909878682843, 1.0621698848385142, 1.0795610713049317, 1.0892723180795199, 1.0647595115339148, 1.237767746235647, 1.1857142857142857, 1.007549068948163, 1.625, 1.0, 1.28125, 1.0345446473871132, 1.048529411764706, 1.1059782608695652, 1.2363636363636363, 1.0188211356266295, 1.0704728881449155, 1.0047449978431828, 1.1058823529411765, 1.2857142857142858, 1.002820874471086, 1.075493612078978, 1.0730277842441838, 1.0349557925439796, 1.0053191489361701, 1.071556571711055, 1.0128826402175009, 1.0378490505824158, 1.0443275732531931, 1.107444371214261, 1.0315457413249212, 1.043563579277865, 1.8, 1.0255859304467156, 1.4285714285714286, 1.0102951269732328, 1.0, 1.2008547008547008, 1.0073569114470842, 1.0, 1.073796429590219, 1.0234445446348062, 1.2195121951219512, 1.0416364686728639, 1.0165036307987758, 1.067228767658719, 1.0462889066241021, 1.0381679389312977, 1.2057259250876995, 1.2158273381294964, 1.3125, 1.0, 1.375, 1.0606066713695455, 1.25, 1.0331636933057435, 1.1183879658733722, 1.0510778791998445, 1.0877367896311068, 1.0857652399481192, 1.099343111671016, 1.029673590504451, 1.012514220705347, 1.0105491911244524, 1.1002158132234647, 1.042334581772784, 1.2144689842531569, 1.25, 1.0826446280991735, 1.0131147540983607, 1.1509026630734012, 1.0779569892473118, 1.275900648914746, 1.039274924471299, 2.2627737226277373, 1.050195867578155, 1.0469798657718121, 1.0599334738440331, 1.1, 1.0527700729031149, 1.0281087243617206, 1.2817493692178301, 1.0699077359829667, 1.0588235294117647, 1.3604263824117255, 1.056804250102166, 1.043457989002862, 1.1016042780748663, 1.0201797731888549, 1.2195121951219512, 1.0309687477854157, 1.0290771175726927, 1.006281407035176, 1.071835803876853, 1.0314232902033271, 1.0852557673019056, 1.050713934022649, 1.0032148037793547, 1.083657587548638, 1.0156256975757847, 1.0767277504201496, 1.0, 1.0706214689265536, 1.0260671228413163, 1.0410563948794833, 1.0204081632653061, 1.0895601483836779, 1.1724137931034482, 1.362271234162365, 1.0926174496644296, 1.0464747176721945, 1.2, 1.1193853427895981, 1.2323769181585678, 1.044108108108108, 1.0787269681742044, 1.0792898929171475, 1.0602342356317382, 1.0541422048271363, 1.0818363273453093, 1.1045978049401162, 1.0548696481559983, 1.117283950617284, 1.0188679245283019, 1.0077243018419488, 1.0926608133276028, 1.0673076923076923, 2.5, 1.0399630751581852, 1.1653914937675645, 1.0243072435585805, 1.0696517412935322, 1.2148461074230537, 1.0097372009058405, 1.155731963576932, 1.0327868852459017, 1.3333333333333333, 1.0986954055587068, 1.2394366197183098, 1.1587301587301588, 1.3157894736842106, 1.074697429895691, 1.2023217247097844, 1.0394144144144144, 1.0625, 1.1302083333333333, 1.2235772357723578, 1.0588235294117647, 1.75, 1.049375, 1.0120967741935485, 1.071593533487298, 1.0769230769230769, 1.0023955945948748, 1.1683168316831682, 1.018683901292597, 1.1587301587301588, 1.2307692307692308, 1.242153757558307, 1.0342519004837596, 1.0372316220576676, 1.2653374233128833, 1.3166666666666667, 1.1764705882352942, 1.1470588235294117, 1.065934065934066, 1.0963855421686748, 1.068108108108108, 1.0262894940539018, 1.0350832717593266, 1.3362068965517242, 1.079377045248171, 1.0469786062804953, 2.5, 1.0074299206877761, 1.009501514734233, 2.0, 2.5, 1.1903822441430334, 1.1035121251941227, 1.1025147815823124, 1.2691292875989446, 1.6666666666666667, 1.0618556701030928, 1.1974025974025975, 1.1666666666666667, 1.0754037462616086, 1.090149631074898, 1.0285804615871008, 1.0452321409155159, 1.8571428571428572, 1.0378966107419048, 1.026015228426396, 1.0328014184397163, 1.1688311688311688, 1.009400705052879, 2.0, 1.0296589223924864, 1.172816465820625, 1.0418571474888954, 1.226643598615917, 1.070967741935484, 1.039669106253129, 1.0548872180451128, 1.0132013201320131, 1.2058823529411764, 1.0568424511253491, 1.4388321167883211, 1.0489433348815607, 1.2295918367346939, 1.1260504201680672, 1.0031201248049921, 1.125, 1.0572116832279435, 1.0477386934673367, 1.0108183838528344, 1.048938134810711, 3.0, 1.01510989010989, 1.0158457894306951, 1.170392085012825, 1.1763273258645883, 1.0010320132598067, 1.1006711409395973, 1.0823029763331848, 1.3601036269430051, 1.1071428571428572, 1.0170212765957447, 1.1047000676700103, 1.2729528535980148, 1.0215208034433285, 1.6666666666666667, 1.0116279069767442, 1.0978586230716094, 1.0483383685800605, 1.010534632604688, 1.0661541149746636, 1.0244047619047618, 1.6, 1.0700104493207943, 1.000994850726333, 1.176796636085627, 1.1218637992831542, 1.066889665352863, 1.0898876404494382, 1.2150537634408602, 1.0197780993728895, 1.0327536328267881, 1.0973006905210294, 1.0192492781520692, 1.0577136514983352, 1.027027027027027, 1.1990961800818554, 1.0696267763260632, 1.088423250248237, 1.0919346691362182, 1.1220145379023885, 1.0545454545454545, 1.7692307692307692, 1.208955223880597, 3.0, 2.5, 1.0952380952380953, 1.0042918454935623, 1.0417209908735332, 1.0066846998103411, 1.0140029952931109, 1.0449412827461608, 1.057446030003659, 1.0844444444444445, 1.0347705146036161, 1.092024001170789, 1.8333333333333333, 1.6428571428571428, 1.047872340425532, 1.0, 1.0055005500550056, 1.157088122605364, 1.1226678752171615, 1.0838803546051297, 3.0, 1.0571981210279082, 1.1026711185308848, 1.0983823919384779, 1.0407465745045266, 1.1341077085533262, 1.111929725134599, 1.1458221074341775, 1.1794384631623391, 1.0216216216216216, 1.0632911392405062, 1.090069284064665, 1.3333333333333333, 2.0, 1.0415795846139517, 6.0, 1.7142857142857142, 2.7142857142857144, 1.0766871165644172, 1.0912851151835468, 1.1289617486338799, 1.0038610038610039, 1.0, 1.0069020047111537, 1.0028818443804035, 1.25, 1.336048879837067]
origin-bjaq_15.71 	max: 6.0000	99th: 3.0000	95th: 1.7007	median: 1.0834	mean: 1.1843

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.148986 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.277271