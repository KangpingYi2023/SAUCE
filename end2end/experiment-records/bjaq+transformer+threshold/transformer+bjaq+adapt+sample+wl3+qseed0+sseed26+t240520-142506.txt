Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 26, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
load_npy_dataset_from_path - df.shape = (382168, 5)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 5.0000	99th: 2.7525	95th: 1.7500	median: 1.0828	mean: 1.1742
ReportEsts: [1.0476190476190477, 1.01328125, 1.050706711224918, 1.0358565737051793, 1.5789473684210527, 1.0, 1.0099691675231244, 1.0554401895358825, 1.0, 1.0223097112860893, 1.2134014371050126, 1.04336235283504, 1.0256194876102478, 1.1255813953488372, 1.0642882373719533, 1.0, 1.139240506329114, 1.0049592631951825, 3.0, 2.0, 1.125, 1.047105049227712, 1.0992083191806234, 1.1109806224310042, 1.0522940305870745, 1.0, 1.147324306898775, 2.0, 1.2, 1.037313432835821, 1.0, 1.045516832873612, 1.002423308154771, 1.1653718091009988, 1.0135456981244417, 1.2249958533753524, 1.1310160427807487, 1.0173666007905138, 1.1075487292513257, 1.0, 1.0612244897959184, 1.0548780487804879, 1.0, 1.033866090712743, 1.083751253761284, 1.890625, 1.0404040404040404, 1.176678445229682, 1.0344338280138239, 1.0277777777777777, 1.0593188980899033, 1.2353951890034365, 1.0372468634762366, 2.0, 1.3974025974025974, 1.2972753481950705, 1.1812714776632303, 1.3658536585365855, 1.0434782608695652, 1.25, 1.1093920392584515, 1.110211706102117, 1.1181818181818182, 1.0116279069767442, 1.1818181818181819, 1.0079896727374225, 1.2741481713035323, 1.75, 1.0, 1.0304838258599796, 1.0540880503144654, 1.0658508158508158, 1.0206896551724138, 1.0660446062812927, 1.0470588235294118, 1.0384615384615385, 1.0, 1.1127348643006263, 2.0, 1.0072110868654172, 1.4545454545454546, 1.05625, 1.1533742331288344, 1.0845771144278606, 1.1123650637880276, 1.0, 1.0665930098858534, 1.020805000835063, 1.0251256281407035, 1.75, 1.1242484969939879, 1.0835710630488615, 1.1682242990654206, 1.008415147265077, 1.0262417994376758, 1.0311688311688312, 1.062992125984252, 1.156959526159921, 1.0, 1.2457759004001778, 1.0123906705539358, 1.0668953687821612, 1.228019239935867, 1.4166666666666667, 1.0197528226173904, 1.024953543934165, 1.228283337534661, 1.074326886613576, 1.0493562231759657, 1.1666666666666667, 2.0, 1.0785046728971963, 1.0503652730288406, 1.0429564118761845, 1.0649350649350648, 1.06123850753981, 1.0, 1.0990223904131189, 1.1285097192224622, 1.0, 1.021978021978022, 1.1428571428571428, 1.3508771929824561, 1.0302610122848037, 1.1032072687737826, 1.0666666666666667, 1.8, 1.1001655629139073, 1.0, 1.1666666666666667, 1.0975759372667695, 1.1818181818181819, 1.1018880208333333, 1.0320046223316397, 1.0592334494773519, 1.0400534045393859, 1.0164383561643835, 1.0646921278254091, 1.039972432804962, 1.068860450944546, 1.0273119950539304, 1.1408450704225352, 1.0528375733855186, 1.0946562655924839, 2.0, 1.01640838650866, 1.0137142857142858, 1.0855218855218856, 1.1106405505558496, 1.5, 1.2177282635020585, 1.1382799325463744, 1.0040160642570282, 1.1074561403508771, 1.2992700729927007, 1.0123061362103845, 1.1449279757391964, 1.1341344924571721, 1.0691056910569106, 1.0855263157894737, 1.2857142857142858, 1.422680412371134, 1.0132547864506627, 1.4285714285714286, 1.0518874367125868, 1.0087305278728773, 1.1808293677770225, 1.3678093563824592, 1.153629316420014, 1.0409477617873897, 1.3326315789473684, 1.1095571095571095, 1.0725283238113683, 1.0657229524772498, 1.0060396893874028, 1.0670553935860059, 1.066882067851373, 1.091416490486258, 1.0047810018086027, 1.0, 1.0714285714285714, 1.0149590742308778, 1.0283094098883572, 1.1477707006369426, 1.236842105263158, 1.0925591854890526, 1.3027099750144147, 1.1249918836439192, 1.1153846153846154, 1.2495454545454545, 1.162686825860299, 1.0, 1.0909090909090908, 1.0053551868229949, 1.0678787878787879, 1.0323655402189433, 1.4, 1.04951768488746, 1.0483822071042097, 1.058545242309353, 1.0626410835214446, 1.1157373247601983, 1.1073446327683616, 1.0158730158730158, 1.1830985915492958, 1.0, 1.3559322033898304, 1.1137833149345528, 1.3344947735191637, 1.1724137931034482, 1.0158180919426594, 1.0031277926720286, 1.02543876600903, 1.060981023193874, 1.1129825068671388, 1.1578947368421053, 1.039039039039039, 1.0065231572080888, 1.0603854328221034, 1.0105907434151709, 1.0, 1.056728778467909, 1.0911705040080357, 1.008139041704462, 1.1539408866995073, 1.0270235054985146, 1.279714223857978, 1.0357142857142858, 1.0027009231889945, 1.1317689530685922, 1.0141003948110547, 1.0104166666666667, 1.16028880866426, 1.004642166344294, 1.2622047244094488, 2.0, 1.264415894831192, 1.1382871817775793, 1.1167369901547117, 1.0509803921568628, 1.0, 1.6666666666666667, 1.0550992771847136, 1.0909090909090908, 1.0970579954954955, 1.5, 1.0, 1.0526315789473684, 1.031615925058548, 1.1529411764705881, 1.0441988950276244, 1.1181434599156117, 1.0815972222222223, 1.0016792611251049, 1.041269042411103, 1.0555555555555556, 2.0, 1.087286410462032, 1.047057978303039, 1.0805604203152364, 1.0016122278056951, 1.1065085431654675, 1.023020134228188, 1.1104928457869634, 1.0716511451859938, 1.0322966507177034, 1.0068102849200833, 1.048005148005148, 1.0909090909090908, 1.048503092056375, 1.1355932203389831, 1.1818181818181819, 1.1904761904761905, 1.0238272524199554, 1.0555555555555556, 1.017391304347826, 1.0888769261826257, 1.1030640668523677, 1.3934837092731829, 1.0172208568975216, 1.043782837127846, 1.029925025853154, 1.0619527367389026, 1.25, 1.0602582757366315, 2.5, 1.0287611588565622, 1.0302375809935205, 1.0509535296527241, 1.0526315789473684, 2.0, 1.434782608695652, 1.2033898305084745, 1.0774221424970702, 1.0, 1.0749235474006116, 1.004524886877828, 1.0108173076923077, 1.0149505134519772, 1.0558659217877095, 1.1320754716981132, 1.0010766769793278, 1.167420814479638, 1.0877376136413066, 1.1196581196581197, 1.0, 1.1276849642004774, 1.2807570977917981, 1.0955631399317407, 1.029486099410278, 1.0341951626355297, 1.115492957746479, 1.4390243902439024, 1.0041322314049588, 1.0141287284144427, 1.1428571428571428, 1.0101440877660601, 1.038022813688213, 1.1176470588235294, 1.106679619089317, 1.1904761904761905, 1.4, 1.0035926372070416, 2.0, 1.215363511659808, 1.0479651162790697, 1.091878589007383, 1.1323340471092078, 1.216710182767624, 1.0963855421686748, 1.116519433433894, 1.0732698814537134, 1.060693641618497, 1.0853565198818127, 1.0082092667315987, 2.0, 1.0, 1.0544345163280697, 1.25, 1.0697544642857142, 1.3529411764705883, 1.0, 1.375, 1.3132530120481927, 1.0649106302916276, 1.1517857142857142, 1.0367965367965368, 1.0, 1.1957390146471372, 1.0789812981005675, 2.0, 1.2293031566408577, 1.0, 1.091733090412207, 1.0348837209302326, 1.0336394647074258, 1.140552995391705, 1.1363636363636365, 1.313199105145414, 1.2222222222222223, 1.0156214088182742, 1.0182997263501092, 1.0637393767705383, 1.0, 1.0769230769230769, 1.5714285714285714, 3.0, 1.2307692307692308, 1.0687482862626816, 1.3333333333333333, 1.0186440677966102, 1.1744186046511629, 1.2050013740038472, 1.0659621404343997, 1.2420185375901134, 1.0077462191073405, 1.0121809744779582, 1.0404761904761906, 1.5, 1.2121212121212122, 1.0382978723404255, 1.049361383031617, 1.0476190476190477, 1.5714285714285714, 1.0112612612612613, 1.011764705882353, 1.0283020846441004, 1.0421455938697317, 1.1464387464387464, 1.004120879120879, 1.0526315789473684, 1.0907770515613653, 1.0158898305084745, 1.25, 1.0240793201133145, 1.1495327102803738, 1.0795501941031154, 1.0911225369275122, 1.0254025565119185, 1.075, 1.1935483870967742, 1.1015384615384616, 1.0, 1.036522191852141, 1.0360983429050648, 1.0215573827126374, 1.066432569248868, 1.0335013341239252, 1.144264378773435, 1.8333333333333333, 1.018172888015717, 1.0, 1.1759180187873612, 1.25, 1.041262190844704, 1.03768115942029, 1.1024290627687017, 1.1383399209486167, 1.1710526315789473, 3.0, 1.1368631368631368, 1.0120436443994292, 1.1354607320213352, 2.0, 1.126984126984127, 1.251439539347409, 1.256317689530686, 1.0992003280705351, 1.2182952182952183, 1.1666666666666667, 1.012079378774806, 1.0008180054689508, 1.0298289448395157, 1.1028000194108798, 1.0281798245614036, 1.0414593698175787, 1.0606060606060606, 1.875, 1.0450928381962865, 1.5, 1.2319327731092438, 1.1818181818181819, 1.1020479567083412, 1.5625, 1.082352234502643, 1.1365378336111636, 1.0888340530536706, 1.0, 1.1515151515151516, 1.12, 1.2840511641850705, 1.3522975929978118, 1.0, 1.0992677535230726, 1.117650533999383, 1.018234562784915, 1.5, 2.0, 1.0341747572815534, 1.0154686078252957, 1.0065573770491802, 1.1111111111111112, 1.0855383293350997, 1.057942057942058, 1.4705882352941178, 1.1711111111111112, 1.0545454545454545, 1.1076115485564304, 1.0137096774193548, 1.2856541859486748, 1.0171658784375548, 1.0, 1.0571428571428572, 1.0835377777777777, 1.0394158941408589, 1.0337671388285632, 1.0, 1.114797611147976, 1.0078603394327028, 1.0225248821372446, 1.0, 1.0318979266347688, 1.0185453804380402, 1.001297055095363, 1.0119697697785155, 1.0093039994031396, 1.0543946932006634, 1.0214592274678111, 1.0899228543876567, 2.0, 1.0483229107447414, 1.6818181818181819, 1.0, 1.1917098445595855, 1.1346153846153846, 1.0226594538725702, 1.256136606189968, 1.0240743926448381, 1.1778378378378378, 1.0987622294693151, 1.0405789260110916, 1.069968907844701, 1.197674418604651, 4.0, 1.0070387708558397, 1.1477732793522266, 1.0487675951772881, 1.0514526045213455, 1.0925925925925926, 1.0946704067321178, 2.247311827956989, 2.2857142857142856, 1.007973413838438, 1.0854233284681292, 1.0081337171926097, 1.1201322556943425, 1.0342508677207867, 1.0391752577319588, 1.0590425066971056, 1.0037899296155928, 1.2284820031298904, 3.0, 1.0833333333333333, 1.0332805071315372, 1.0600375234521575, 1.0681003584229392, 1.2241630276564774, 1.0392156862745099, 1.3266666666666667, 1.148905109489051, 1.123456790123457, 1.084034120386569, 1.2150537634408602, 1.002640029642438, 2.0, 1.15136476426799, 1.1559633027522935, 1.3689320388349515, 1.0762569832402236, 1.0816568047337278, 1.0217391304347827, 1.0739299610894941, 1.0394174996914722, 1.0, 1.1702127659574468, 1.0, 1.5, 1.2159090909090908, 1.002016129032258, 1.0188679245283019, 1.1067961165048543, 1.0674463313040692, 1.0475638051044083, 1.050489419893479, 1.1610761305094448, 1.0434782608695652, 1.1083447949797989, 1.0, 1.1281708945260347, 1.0009675858732463, 1.0898785425101214, 1.2919075144508672, 1.1216338880484116, 1.0411493437389145, 1.2037995269071555, 1.083291040636397, 2.0, 1.1572481572481572, 1.0885311871227363, 1.4205607476635513, 1.0, 1.186046511627907, 1.25, 1.1795407098121085, 1.4074074074074074, 1.1666666666666667, 1.0078300587254405, 1.1373191042121433, 1.0313187097441734, 1.052928554398792, 1.2540540540540541, 1.1320495185694635, 2.0, 1.1846153846153846, 1.0212720997393816, 1.061638377559965, 1.0832892259368845, 1.1113452557238865, 1.0065145407428735, 1.1428571428571428, 1.057788895235469, 1.0657193605683837, 1.0428392044307913, 1.085779099757149, 1.3333333333333333, 1.0403726708074534, 1.0, 1.2387640449438202, 1.2070487294223902, 3.0, 1.0792079207920793, 1.0625990309320963, 1.4285714285714286, 1.0685965047347756, 1.3, 1.1176470588235294, 1.0660304709559545, 1.6923076923076923, 1.0122850271322046, 1.0316104228961982, 1.3571428571428572, 1.2083333333333333, 1.088659793814433, 1.0109995217599235, 1.0083885209713024, 1.0834203655352481, 1.1567059398083146, 1.0, 1.0734303714968498, 1.1280487804878048, 2.0, 1.03675274988044, 1.1003633532312485, 1.1475875118259224, 1.019370244197523, 1.0047497169857755, 1.0, 1.7142857142857142, 1.0129326740205402, 1.021774193548387, 1.1342880898647616, 1.2177091795288384, 1.0068415249811409, 1.0415859791861128, 1.2802197802197801, 1.0756302521008403, 1.234113712374582, 1.0409070904079127, 1.0977917981072556, 1.048913043478261, 1.1334033613445378, 1.0371478184975407, 3.0, 1.1329452298918854, 1.0365466647433388, 1.0332108528225696, 1.5833333333333333, 1.2498264129981946, 1.2152466367713004, 1.1428571428571428, 1.0767792903999436, 1.0420575865415722, 1.1506550218340612, 1.1470588235294117, 1.3333333333333333, 1.0663640404246482, 1.5, 1.0841121495327102, 1.0, 1.0179680413090504, 1.44, 1.1434599156118144, 1.069182389937107, 1.0, 1.7645502645502646, 1.2370550161812297, 1.25, 2.0, 1.1176470588235294, 1.2448275862068965, 1.0558694287507846, 1.1722017220172203, 1.0578512396694215, 1.3215339233038348, 1.1014466214978942, 1.0545454545454545, 1.1238532110091743, 1.3591836734693878, 1.0769230769230769, 1.0, 1.0851528384279476, 1.1111111111111112, 1.0113636363636365, 1.0909912964846842, 1.0773143374493876, 1.0500260552371026, 1.0711765926540777, 1.1268435511856565, 1.1352459016393444, 1.0188449848024317, 1.5714285714285714, 1.0, 1.2142857142857142, 1.0422933899977234, 1.0812003530450132, 1.107843137254902, 1.16, 1.079266895761741, 1.073130814287355, 1.017987096213586, 1.0833333333333333, 1.2222222222222223, 1.020392749244713, 1.066079003181336, 1.0705271094210975, 1.0044074501838651, 1.105263157894737, 1.074719432959244, 1.0312438391895786, 1.126984126984127, 1.345213849287169, 1.2857142857142858, 1.0572792362768497, 1.5257731958762886, 1.1555555555555554, 1.1257668711656441, 1.0701001430615165, 1.0, 1.0841584158415842, 1.0152699330093262, 1.08, 1.0681505186317357, 1.0419426048565121, 1.131578947368421, 1.0532232543895468, 1.051946647440519, 1.0868251410153102, 1.047709923664122, 1.0022701475595914, 1.2089252256855731, 1.1789473684210525, 1.2142857142857142, 1.0, 1.25, 1.067046142666828, 1.3333333333333333, 1.051042109740536, 1.125868289268214, 1.0064244572441294, 1.0601787487586891, 1.0473976956694477, 1.1847802786709538, 1.043010752688172, 1.0416088765603329, 1.0094672368184017, 1.0651949756280465, 1.0430280637371319, 1.2076357942912201, 1.6666666666666667, 1.03125, 1.0411522633744856, 1.1143540504003604, 1.0456026058631922, 1.3048143053645116, 1.0254083484573502, 2.1923076923076925, 1.009862936897859, 1.042953020134228, 1.0910765550239234, 1.1875, 1.0765655519732662, 1.038843341172222, 1.303699897225077, 1.0581052631578947, 1.28, 1.0043010752688173, 1.0806451612903225, 1.625, 1.0480956254199527, 1.5769230769230769, 1.1428571428571428, 1.09375, 1.0566419420094404, 1.0195319077285738, 1.015531660692951, 2.75, 1.0566037735849056, 1.0896356483694254, 1.0706594810822823, 1.0069605712898224, 1.0299184805445836, 1.084872682104516, 1.0, 1.067396798652064, 1.0459746628524724, 1.0279957776859883, 1.0200400801603207, 1.0416666666666667, 1.1498185588387766, 1.0592700668189123, 1.4225206611570247, 1.011096214232791, 1.0, 1.3333333333333333, 1.0567578926549481, 1.0285633882088083, 1.2392784044933123, 1.1080530071355759, 1.0670391061452513, 1.1221945137157108, 1.1040305171954934, 1.1016881563206167, 1.1066176470588236, 1.0335195530726258, 1.0156472261735419, 1.1080719579836058, 1.1071428571428572, 1.75, 1.048216143575516, 1.1667232049107503, 1.0415676959619953, 1.0, 1.222664735698769, 1.0203942565100999, 1.1796457689063817, 1.3071895424836601, 1.2307692307692308, 1.09366576819407, 1.043956043956044, 1.121875, 1.5357142857142858, 1.0667001899653592, 1.1694747274529236, 1.1608623548922057, 1.048780487804878, 1.0091416725181395, 1.0945063388398002, 1.0616131191432396, 1.249059219647455, 1.3333333333333333, 1.3333333333333333, 2.0, 1.1365377917102055, 1.3076923076923077, 1.0, 1.1538461538461537, 1.0463576158940397, 1.0742753623188406, 1.0584183673469387, 1.065733197556008, 1.08, 1.3076923076923077, 1.1428571428571428, 1.032258064516129, 1.0945945945945945, 1.0294117647058822, 1.1243432574430823, 1.0299635965771328, 1.0299320989944714, 1.3195876288659794, 1.0765064319566688, 1.0476102297182324, 2.5, 1.0710336497567283, 1.3257575757575757, 3.0, 2.0, 1.1846153846153846, 1.1514738578498172, 1.0714723221805376, 1.2298136645962734, 1.0, 1.131578947368421, 1.0337423312883436, 3.0, 2.0, 1.0292814960629921, 1.2246269659900524, 1.0097148624779209, 1.6666666666666667, 1.0270180267427833, 1.0503485670023238, 1.09304932735426, 1.125, 1.056338028169014, 1.0251336972102767, 1.1578947368421053, 1.242914979757085, 1.0163007056411875, 1.2648809523809523, 1.0859375, 1.096560786623771, 1.0390417036379769, 1.103305785123967, 1.15, 1.0062564483512855, 1.3706621961441743, 1.0330013736263737, 1.4131736526946108, 1.2352941176470589, 1.2537313432835822, 1.118549511854951, 1.050805452292441, 1.0076133963592477, 1.0738532285878521, 1.1069868995633187, 1.5, 1.6666666666666667, 1.131816147797737, 1.1921723834652596, 1.2242754327951761, 1.0243615075907266, 1.1060377989630372, 1.084670268486823, 1.1666666666666667, 1.0434782608695652, 1.0246835940570709, 1.081259887818208, 1.2768999247554553, 1.064798598949212, 1.6666666666666667, 1.0416666666666667, 1.0891401630174204, 1.1446936542669583, 1.0013259496139146, 1.0843574130848783, 1.0078125, 2.0, 1.0862944162436547, 1.056113951619478, 1.1624400274160385, 1.091254752851711, 1.081575120392886, 1.1305732484076434, 1.2649006622516556, 1.0023242300987798, 1.0307665509019848, 1.0574543311726576, 1.0357142857142858, 1.0525606469002695, 1.0, 1.2166320166320166, 1.0501416948532774, 1.0184940554821664, 1.0364014204318386, 1.13518635502211, 1.033282904689864, 1.2, 1.246031746031746, 1.6666666666666667, 2.0, 1.1764705882352942, 1.0025641025641026, 1.0015797788309637, 1.0637146468636436, 1.0169582139343911, 1.021166892808684, 1.0215858089335328, 1.1358695652173914, 1.1136363636363635, 1.0728550684989162, 1.6, 1.5, 1.0861886259272342, 1.1428571428571428, 1.0162381596752368, 1.142641888498242, 1.1146462370437134, 1.0841489344435247, 2.0, 1.0226006191950465, 1.1531007751937985, 1.1046831955922864, 1.0409598429314568, 1.196969696969697, 1.127054794520548, 1.145581903763357, 1.0592124009802246, 1.0261011419249593, 1.1126760563380282, 1.0963687150837989, 1.0, 1.0, 1.0416115303458389, 5.0, 1.4285714285714286, 2.0, 1.0171779141104293, 1.175, 1.0582039911308203, 1.1200470772852098, 1.0, 1.0931098696461825, 1.0169392523364487, 1.17989417989418, 1.2836538461538463, 1.25, 1.0098214285714286, 1.0227272727272727, 1.1419068736141906, 1.0847898847155075, 1.0242204337563192, 1.126830253458548, 1.1017450458444247, 1.0, 1.1602149172906884, 1.0632041447537377, 1.046987087517934, 1.1774193548387097, 1.0259836308056405]
origin-bjaq_15.71 	max: 5.0000	99th: 2.7525	95th: 1.7500	median: 1.0828	mean: 1.1742

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 13.997749 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[-2.9802322e-08  2.3841858e-07  2.6226044e-06 -2.9802322e-08
  5.9604645e-08]
Distance score: 5.722046125811175e-07
SAUCE Drift detection: False
Detection latency: 0.0233s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 4.034970 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=bjaq', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=3', '--data_update=sample', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt')]
Validate Argument: DATASET="bjaq" is valid.
data size: 458601, total size: 458601, split index: [382167 458601]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-bjaq-0.4MB-model34.249-data18.543-300epochs-seed0.pt
query_seed:0
origin-bjaq_15.71 	max: 6.0000	99th: 2.5017	95th: 1.7500	median: 1.0802	mean: 1.1809
ReportEsts: [1.0566572237960339, 1.0015115525804361, 1.0522286092635507, 1.038655462184874, 1.2916666666666667, 1.0, 1.0226632635099455, 1.0224462570513797, 1.2, 1.0162337662337662, 1.0958033573141486, 1.0415885550700845, 1.0003474635163307, 1.1020793950850662, 1.0437223042836041, 1.1538461538461537, 1.128526645768025, 1.6666666666666667, 1.2727272727272727, 1.0542763157894737, 1.0329205038636604, 1.080037446880128, 1.073051948051948, 1.030025020850709, 1.019458006085049, 1.0266466255478193, 2.0, 1.1561135699876555, 1.2, 1.0, 1.0840579710144929, 1.0, 1.0479143720940547, 1.0026368794108151, 1.0097674418604652, 1.1195399486112811, 1.23063868107509, 1.189010989010989, 1.5, 1.0415929203539822, 1.0506243345271513, 1.0941296740455313, 1.0425531914893618, 1.0029670204267944, 1.0480591497227356, 1.0663112861605324, 1.3, 1.2142857142857142, 1.021186440677966, 1.0134952766531713, 1.1666666666666667, 1.2545454545454546, 1.0447154471544715, 1.0588235294117647, 1.0408520246129416, 1.02019530438396, 1.0704538712548206, 1.1955307262569832, 1.1477272727272727, 1.0660111709074742, 1.2162162162162162, 1.1304344116844116, 1.06605222734255, 1.1395348837209303, 1.1224489795918366, 1.75, 1.061124321687702, 1.2522179974651457, 1.6, 1.0, 1.030817364098553, 1.026, 1.052707235265932, 1.037037037037037, 1.0968044745179333, 1.138705035971223, 1.075834175935288, 1.2057142857142857, 1.5048543689320388, 1.1031004139367855, 1.0232670867668443, 1.0416666666666667, 1.0, 2.0, 1.0845546786922209, 1.152542372881356, 1.0235294117647058, 1.7142857142857142, 1.5, 1.1034085637966058, 1.117967332123412, 1.136869118905047, 1.0130241585372082, 1.1239228175346572, 1.1336898395721926, 1.038327526132404, 1.1143847487001732, 1.0665742024965326, 1.1443661971830985, 1.328750981932443, 1.1428571428571428, 1.0, 1.0422477580386675, 1.1300467488312793, 1.0439093484419264, 1.234497247174732, 1.1176470588235294, 1.0152795489718054, 1.0530585397939047, 1.399331423113658, 1.045726900031536, 1.0542137718396711, 1.2857142857142858, 1.3, 1.065480844409695, 1.0709843281946372, 1.0299369747899159, 1.0105263157894737, 1.057792088798136, 1.0, 1.0701708278580815, 1.1736304549675023, 1.5, 1.0136363636363637, 1.0, 1.1646090534979423, 1.0269631463389475, 1.0237987745888424, 1.0495867768595042, 1.6666666666666667, 1.1593597773138482, 1.0, 1.4, 1.1131833973304077, 1.3333333333333333, 1.4324324324324325, 1.0333203830244304, 1.0322146295485912, 1.3333333333333333, 1.7142857142857142, 1.0574468085106383, 1.0909897913892588, 1.070737913486005, 1.0364461491987889, 1.2364864864864864, 1.0027487630566245, 1.102373932338369, 3.0, 1.0136105860113422, 1.0150375939849625, 1.1131221719457014, 1.1142355008787346, 2.5, 1.1480213472963448, 1.002534854245881, 1.0260416666666667, 1.0325814536340852, 1.0, 1.0184994861253853, 1.0897986053542692, 1.1935498280251933, 1.097053726169844, 1.0731707317073171, 1.3157894736842106, 1.2682926829268293, 1.0184956843403206, 1.375, 1.0680237381149895, 1.0, 1.175977653631285, 1.0719207059107942, 1.1246753246753247, 1.0114721955696466, 1.2685512367491165, 1.1047430830039526, 1.0987883683360258, 1.1145631067961166, 1.0198237885462555, 1.0682196339434276, 1.0137092602172788, 1.0943078913324709, 1.2358270094267783, 1.088235294117647, 1.129120879120879, 1.0067261052339815, 1.0675592894022927, 1.2198581560283688, 1.795874049945711, 1.0212264150943395, 1.6666666666666667, 1.2331460674157304, 1.0931374651511903, 1.380952380952381, 1.1467750126968004, 1.1563637687490897, 1.065154330780039, 1.0339081589204415, 1.098135426889107, 1.0910075057736721, 1.1988391010062465, 1.0259472817133444, 1.0433548972874815, 1.0332854406130267, 1.0669954394742827, 1.0634696755994357, 1.066894018887723, 1.5142857142857142, 1.2388059701492538, 1.2023809523809523, 1.0, 1.3695652173913044, 1.090998427672956, 1.3323615160349853, 1.2525252525252526, 1.0065627563576702, 1.4166666666666667, 1.0393371401533482, 1.0321100917431192, 1.1887615497481858, 1.75, 1.1241473396998636, 1.0273861171366594, 1.057517671019528, 1.0234325274423979, 2.0, 1.0130864197530864, 1.1287887471548577, 1.0084872645523593, 1.0158730158730158, 1.0743362831858407, 1.026374859708193, 1.0909513840428007, 1.31496062992126, 1.0035362530208902, 1.0241386373589116, 1.0574018126888218, 1.0078602620087336, 1.0490307867730901, 1.25, 1.1512939615129396, 2.0, 1.2476143870809886, 1.1678506755815574, 1.1817296455005843, 1.1326164874551972, 1.0, 1.5, 1.1307168485025993, 1.0422535211267605, 1.1071301564722618, 1.6, 1.0189830508474575, 1.0396744659206512, 1.2857142857142858, 1.005711694655031, 1.0212765957446808, 1.1538461538461537, 1.1255707762557077, 1.0003506311360448, 1.1006404686041646, 1.0757575757575757, 2.0, 1.0539345863244642, 1.0578472348416015, 1.1253561253561253, 1.0090715977155593, 1.1034297337105183, 1.0445139007820974, 1.1093439363817097, 1.0721065119957818, 1.0225450901803608, 1.0348566099323853, 1.0237629873469807, 1.0, 1.013839426130541, 1.0202205882352942, 1.125, 1.1818181818181819, 1.300265604249668, 1.047071129707113, 1.0471028508199818, 1.0204131911448984, 1.1375291375291374, 1.3141683778234086, 1.006684543935331, 1.0726722180166541, 1.1576558643204076, 1.047118428798561, 1.1, 1.29198682766191, 1.0129950495049505, 1.0495254938678318, 1.052626638715935, 1.0334840089073678, 1.2014925373134329, 1.1805251641137855, 1.0445996010259333, 1.049951832161844, 1.0713202642694681, 1.0826304992021882, 1.028130671506352, 1.5, 1.2307692307692308, 1.0798984468339308, 2.142857142857143, 1.0599250936329587, 1.1245746984225178, 1.035252500609905, 1.4324324324324325, 1.125, 1.0680907877169559, 1.0321313816494109, 1.063988149443291, 1.2380952380952381, 1.197414395527603, 1.0068354413676162, 1.1635514018691588, 1.8, 3.6666666666666665, 1.005437146585472, 1.25, 1.0050713448194115, 1.0349761526232115, 1.2272727272727273, 1.0642395357057342, 1.3333333333333333, 1.4166666666666667, 1.0018069078935758, 2.0, 1.0833333333333333, 1.0421686746987953, 1.0269410542716177, 1.0259670002704895, 1.0315315315315314, 1.1717171717171717, 1.1021274678739963, 1.076707386286857, 1.0971223021582734, 1.0208579972764165, 1.0433645541904877, 3.0, 1.3, 1.042682579198419, 1.2, 1.0703306939916162, 1.2727272727272727, 1.8333333333333333, 1.4736842105263157, 1.3153973509933774, 1.0546021840873634, 1.2015503875968991, 1.066079295154185, 1.2911392405063291, 1.6666666666666667, 1.065530303030303, 1.0578512396694215, 1.0571428571428572, 1.012336701935586, 1.0268199233716475, 1.0285929270127916, 1.0027906976744185, 1.4, 1.0, 1.3417085427135678, 1.0738255033557047, 1.173165137614679, 1.1239547929578624, 1.2162228494293779, 1.0875331564986737, 1.5, 1.025675596971462, 1.1, 1.4333333333333333, 1.0, 1.4285714285714286, 1.0, 1.1837160751565763, 1.1203703703703705, 1.1570874686044528, 1.1066973556191277, 1.0037664783427496, 1.0735245991054871, 1.1125268240343347, 1.0224719101123596, 1.1161764705882353, 1.0903532351493583, 1.1224489795918366, 1.125, 1.002849891533979, 1.0623190873488848, 1.004580413604512, 1.061904761904762, 1.0930232558139534, 1.1425619834710743, 3.0, 1.25, 1.36, 1.126679462571977, 1.5833333333333333, 1.4375, 1.0807319698600646, 1.0201131363922062, 1.000028847374312, 1.0694444444444444, 1.1321130378933848, 1.1348314606741574, 1.1061946902654867, 1.1289473684210527, 1.0, 1.0964429866745584, 1.6, 1.1052780342572877, 1.0899677096091749, 1.0775306945994676, 1.1550079491255962, 1.75, 1.1794019933554818, 1.1666666666666667, 1.0490523968784837, 1.0, 1.3131655372700872, 1.0154761904761904, 1.1551199427139276, 1.1568627450980393, 1.016506189821183, 3.0, 1.3197693047100287, 1.010563002406954, 1.1236652594983858, 2.0, 1.0789473684210527, 1.2641065830721003, 1.1976401179941003, 1.0864381016720148, 1.1035754369087702, 1.0869565217391304, 1.1077931536780772, 1.0397512769264934, 1.0007003346043108, 1.935634874195436, 1.0638278969412363, 1.124801958807432, 1.148936170212766, 1.0399632521819018, 1.0810221969038267, 1.0330578512396693, 1.0092341118957089, 2.0, 1.5, 1.0833333333333333, 1.0923694779116466, 1.0516877637130801, 1.085247780005729, 1.0795279630579784, 2.0, 1.1652173913043478, 1.0294117647058822, 1.0550566811565865, 1.0416666666666667, 2.0, 1.0416420887053734, 1.6666666666666667, 2.0, 1.0217138425746413, 2.6666666666666665, 1.0084142394822007, 1.0211002260738509, 1.0157068062827226, 1.4444444444444444, 1.0985645644286544, 1.0548986486486487, 1.45, 1.0350580119159611, 1.0144927536231885, 1.039003250270856, 1.0144356955380578, 1.3225473321858865, 1.010179958508226, 2.0, 1.0823529411764705, 1.104199893673578, 1.1067266067266068, 1.074698795180723, 2.5, 1.122109158186864, 1.0050001368400887, 1.0322011468901633, 1.5, 1.0390260173448966, 1.0502211089464082, 1.0259307839773988, 1.1178558360775703, 1.0138890419867943, 1.0094869286125767, 1.0334044065387349, 1.269700654275954, 2.3333333333333335, 1.075078701108284, 1.0910815939278937, 1.069995105237396, 1.074485825458588, 1.0302197802197801, 1.009929531238604, 1.0657894736842106, 1.050782276364505, 1.2022160664819945, 1.0389956952803912, 1.0144578313253012, 1.0802788844621514, 1.0328957295910668, 1.1348314606741574, 1.3108108108108107, 1.0328889113770334, 1.1775280898876404, 1.000105546466832, 1.0565081125508118, 1.0, 1.0053292729349068, 1.4022988505747127, 1.125, 1.24, 1.0131826895401943, 1.1634980988593155, 1.075621546961326, 2.0, 1.5, 1.0089020771513353, 1.1280916472330502, 1.0374768089053803, 1.0289484451718494, 1.1241190289741583, 1.1541353383458646, 1.0117107942973524, 1.0922349611667659, 1.4857142857142858, 1.0168420235275848, 1.3105022831050228, 1.1333333333333333, 1.1180294453855584, 1.0876190476190477, 1.019692782312488, 2.0, 1.1221009549795362, 1.1311475409836065, 1.006979131029764, 1.0964125560538116, 1.0074836295603367, 1.0186440677966102, 1.2142857142857142, 1.112859939725907, 1.0, 1.1111111111111112, 1.2, 1.0, 1.0446428571428572, 1.128755364806867, 1.0025940337224384, 1.1694915254237288, 1.0580901856763927, 1.0245868601370416, 1.086701171511808, 1.1602747567258156, 1.0836426179053136, 1.0461715795472206, 1.0175368273374086, 1.0904684975767367, 1.138010087116002, 1.0489803338912815, 1.0282101167315174, 1.0703296703296703, 1.1271393643031784, 1.1920529801324504, 1.0644381796214257, 1.1344827586206896, 1.098573026871062, 1.2802197802197801, 1.1447527141133895, 1.190126050420168, 2.0, 1.0367298578199051, 1.2352941176470589, 1.0, 1.3824701195219125, 1.0412265281040465, 1.0372460496613995, 1.0392670157068062, 1.0687830687830688, 1.1036258284823146, 1.019345458861229, 1.1210428305400373, 1.0, 2.0, 1.0490904002239014, 1.2102803738317758, 1.1567676767676767, 1.0975724723073297, 1.0, 1.3117824773413898, 1.1324786324786325, 1.0669935723278776, 1.0969162995594715, 1.0174573834462928, 1.0524674167316475, 1.0061062157407576, 1.292929292929293, 1.6, 1.1628757754095753, 1.0, 1.0228050171037628, 1.1495726495726495, 1.3541233541233542, 1.0043668122270741, 1.6521739130434783, 1.038175217279695, 1.1428571428571428, 1.0825285338015804, 1.0093113482056255, 1.150130548302872, 1.165211551376763, 1.0481832543443919, 1.0181983621474067, 1.070138888888889, 1.4285714285714286, 1.0433143560547777, 1.0473076010708597, 1.0952380952380953, 1.0185950413223142, 1.2622498979175174, 1.0096153846153846, 1.0285832979616902, 1.2222222222222223, 1.0652557319223985, 1.0329471032745592, 1.0138248847926268, 1.2838709677419355, 1.060253447039133, 1.0076335877862594, 1.625, 1.0886512590548465, 1.0424242424242425, 1.1202646838889907, 1.1892430278884463, 1.0069224265482986, 1.0352233676975946, 1.1786786786786787, 1.1124956732433369, 1.0797872340425532, 1.0646798626040972, 1.0497121925693353, 1.0648567119155354, 1.0504316219900045, 1.171497584541063, 1.0714285714285714, 1.074025333113999, 1.125, 1.6, 1.0591787439613527, 1.6185088482738614, 1.0306786488999071, 1.0, 1.0714285714285714, 1.0072173215717724, 1.0203353549768106, 1.2349397590361446, 1.0638337277497685, 3.0, 1.086846509403889, 2.0, 1.051383399209486, 1.1333333333333333, 1.087426755677346, 1.3548387096774193, 1.1056338028169015, 1.0180102915951972, 1.0, 1.277282508453735, 1.271731690622861, 1.2, 1.3333333333333333, 1.1702127659574468, 1.1810344827586208, 1.0242378810594703, 1.1951476793248945, 1.0951704545454546, 1.4545454545454546, 1.0765306122448979, 1.0375983119125263, 1.2448132780082988, 1.3013698630136987, 1.0294117647058822, 1.0, 1.0881818181818181, 1.0514354066985645, 1.0708263069139967, 1.023662997312993, 1.095686584039081, 1.088218725353964, 1.0631653041566844, 1.182170659132578, 1.1755634638196917, 1.0201918223119637, 1.625, 1.0, 1.1470588235294117, 1.0315740881266757, 1.1015683345780434, 1.1181318681318682, 1.012072434607646, 1.0060594463579537, 1.0657179233945335, 1.0100570765411052, 1.0595238095238095, 1.380952380952381, 1.6153846153846154, 1.0297757153905647, 1.0721059762155654, 1.0301792602677557, 1.0162162162162163, 1.0616396263520158, 1.0423247205394344, 1.0232442441430465, 1.0262008733624455, 1.059207437318058, 1.0382165605095541, 1.045330207112153, 1.2553846153846153, 1.0308211398612201, 1.0, 1.1087737301180092, 1.0, 1.046938775510204, 1.0519635403356333, 1.0625, 1.070364677197074, 1.0227272727272727, 1.3846153846153846, 1.0542259146828568, 1.0310837216293403, 1.0735780330624825, 1.041897233201581, 1.0482954545454546, 1.2040378370746858, 1.125, 1.25, 1.0, 1.5714285714285714, 1.064181902477373, 1.6666666666666667, 1.058740294608519, 1.1093949080179717, 1.0671246319921492, 1.0658111220796314, 1.15965895030483, 1.0603271069800697, 1.0059701492537314, 1.0490654205607477, 1.014770493472319, 1.1549770231326428, 1.0420951745978833, 1.2302942426439338, 1.25, 1.4090909090909092, 1.0564784053156147, 1.0717927976078698, 1.0080862533692723, 1.3038178472861086, 1.0762987012987013, 2.1543859649122807, 1.0362898389713355, 1.0522803114571746, 1.0553527616540004, 1.3125, 1.066744437963503, 1.0452482162107593, 1.311426116838488, 1.0541958041958042, 1.4444444444444444, 1.0502092050209204, 1.0954030590285433, 1.0108515867740488, 1.035928143712575, 1.020588523545842, 1.075, 1.0741076830006049, 1.1473616473616473, 1.0173053152039555, 1.0358361774744027, 1.0081818181818183, 1.0681362725450902, 1.0697211155378485, 1.0018110344018305, 1.0660919540229885, 1.0086623332192952, 1.086057346873773, 1.125, 1.0955459770114941, 1.0186204663212435, 1.0387261524525002, 1.6, 1.0268317853457172, 1.1919597989949748, 1.183673469387755, 1.063660477453581, 1.047685577050551, 1.0256410256410255, 1.114773396115362, 1.2330450796701098, 1.0329244673983216, 1.0364238410596027, 1.0903538202509555, 1.1330162602881453, 1.0539473684210525, 1.1171548117154813, 1.1117696728232622, 1.087250527007419, 1.1483771251931993, 1.0710900473933649, 1.0403422982885087, 1.0816553440643042, 1.058252427184466, 2.0, 1.0636499619164732, 1.168646784665535, 1.0033396946564885, 1.0568720379146919, 1.1962785114045618, 1.006401607410912, 1.1503707136237258, 1.0335917312661498, 1.2666666666666666, 1.0705882352941176, 2.0, 1.1317829457364341, 1.5, 1.0568419681647765, 1.1853978671041838, 1.2816901408450705, 1.0833333333333333, 1.0569561157796452, 1.0232670867668443, 1.0392156862745099, 1.5714285714285714, 1.0284653465346534, 1.0607287449392713, 1.0390738060781477, 1.0769230769230769, 1.0088081331564045, 1.1137724550898203, 1.013724340175953, 1.2946428571428572, 1.3295454545454546, 1.1916254725210818, 1.0667065372406497, 1.0289489128802871, 1.0844645550527903, 1.2622950819672132, 1.2352941176470589, 1.025, 1.0555555555555556, 1.1097560975609757, 1.090221187427241, 1.0290902952636836, 1.0323155342208146, 1.3928571428571428, 1.0981415137862882, 1.0461712180934841, 4.0, 1.0382003049198936, 1.0086311829146841, 1.5, 2.25, 1.151708876321613, 1.157051854497827, 1.0660118461065726, 1.2046632124352332, 1.0, 1.1814814814814816, 1.0897435897435896, 1.125, 1.0163882156299586, 1.1016237862746174, 1.0498349150433028, 1.0379878939678564, 1.4285714285714286, 1.0177808849169916, 1.0411046885035324, 1.0198275862068966, 1.054421768707483, 1.07673568818514, 1.0, 1.2155172413793103, 1.1334871794871795, 1.0413809831824061, 1.191304347826087, 1.1363636363636365, 1.0870767190803217, 1.0909090909090908, 1.0538720538720538, 1.3174603174603174, 1.0203221775322484, 1.8892960462873674, 1.0614330120316529, 1.8115942028985508, 1.2521739130434784, 1.422918807810894, 1.375, 1.085819747769917, 1.0477386934673367, 1.0114126412394533, 1.0406654343807764, 1.5, 1.110816542948038, 1.0037656395513626, 1.2627683197631385, 1.0793288809252322, 1.0591437762929967, 1.0938457254246727, 1.0806407447973714, 1.1594746716697937, 1.0666666666666667, 1.0518895633444292, 1.092871721734972, 1.1923076923076923, 1.0858505564387917, 2.0, 1.0574712643678161, 1.0446484832118101, 1.0850393700787402, 1.0924813631522896, 1.0758667967038404, 1.0034924330616997, 2.2, 1.0598111227701994, 1.0555512437424812, 1.1696923370915344, 1.1826625386996905, 1.0647125129727932, 1.0691489361702127, 1.1419354838709677, 1.0192030724915986, 1.0325633015704052, 1.1146999353803182, 1.0284629981024669, 1.026258205689278, 1.0263157894736843, 1.1245391889725918, 1.002991740195547, 1.0213713054924016, 1.0196173407604747, 1.1097876747799067, 1.025445292620865, 1.0310077519379846, 1.2307692307692308, 2.3333333333333335, 2.5, 1.2777777777777777, 1.0171673819742488, 1.034233048057933, 1.0164216452924617, 1.0042957164042894, 1.0182701202590194, 1.0288144419371636, 1.145374449339207, 1.080701754385965, 1.0583411269581482, 1.6666666666666667, 1.3125, 1.0097560975609756, 1.125, 1.0838323353293413, 1.096498371335505, 1.0591893309357907, 1.0990726293962296, 2.0, 1.0842572062084257, 1.0735294117647058, 1.1842923205215676, 1.0405170403947364, 1.175420168067227, 1.1257078142695356, 1.159623265781855, 1.126314724919094, 1.0527045769764216, 1.064102564102564, 1.1183294663573087, 1.0, 3.0, 1.0415297859819281, 6.0, 1.8571428571428572, 2.033333333333333, 1.0232793522267207, 1.0814311677910236, 1.1211283185840708, 1.0306513409961686, 1.1428571428571428, 1.0964178464178465, 1.0155339805825243, 1.0888888888888888, 1.2559055118110236]
origin-bjaq_15.71 	max: 6.0000	99th: 2.5017	95th: 1.7500	median: 1.0802	mean: 1.1809

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 14.091563 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=32.195488