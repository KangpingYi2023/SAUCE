Input arguments = Namespace(data_update='valueskew', update_size=25000, dataset='forest', debug=False, drift_test='distribution', model_update='adapt', model='naru', end2end=False, query_seed=0, random_seed=42, num_workload=15)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-2'}, 'random_seed': 3, 'naru': {'epochs': 40}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-forest-16.5MB-model62.533-data19.148-200epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/forest/end2end/forest.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=forest', '--model=naru', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-forest-16.5MB-model62.533-data19.148-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-forest-16.5MB-model62.533-data19.148-200epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
load_csv_dataset - forest (581012, 10)
Parsing... done, took 0.1s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-forest-16.5MB-model62.533-data19.148-200epochs-seed0.pt
query_seed:0
origin-forest_43.39 	max: 31.0000	99th: 4.0000	95th: 2.5000	median: 1.0027	mean: 1.3531
ReportEsts: [1.0, 1.0585575401311327, 1.0, 1.903225806451613, 2.6666666666666665, 1.0, 1.263157894736842, 1.0, 2.8278688524590163, 1.0, 1.0149253731343284, 3.0, 1.0, 1.0, 3.0, 1.0040064572938068, 1.0, 1.4285714285714286, 1.1777777777777778, 1.0, 1.0, 3.0, 1.6666666666666667, 1.4, 2.2, 1.0, 1.0693178985848404, 1.1818181818181819, 3.0, 1.0998415213946118, 1.0, 1.0032341526520052, 1.0769230769230769, 1.0, 1.6338028169014085, 1.0064216910453085, 1.121903520208605, 1.0, 1.3534303534303533, 1.0, 2.0, 1.0, 1.2142857142857142, 1.0, 1.0603448275862069, 1.1902439024390243, 1.0, 2.0, 1.0, 1.0, 3.0, 1.0588863892013498, 1.0, 1.0, 18.0, 1.080568720379147, 1.274582560296846, 1.5294117647058822, 1.0, 1.0, 1.0503412969283277, 1.2, 1.0, 1.1899543378995434, 1.1910828025477707, 1.0, 1.4890965732087227, 1.5643564356435644, 1.5060240963855422, 1.0, 2.0, 1.0, 1.3333333333333333, 1.0901337264399285, 2.0, 1.5, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0047829286239882, 2.3333333333333335, 2.4615384615384617, 1.0, 1.0, 1.3333333333333333, 1.184247837799518, 1.0, 4.0, 1.2608695652173914, 1.0, 1.0684022460439, 1.0, 1.0, 1.0877202643171806, 1.0085653104925054, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0344827586206897, 1.0, 1.0, 1.0, 1.069767441860465, 1.0, 1.0518518518518518, 1.0, 1.0, 1.2600510529674538, 1.0594594594594595, 2.0, 1.0, 2.0, 1.0, 1.0, 1.0, 2.0, 3.0, 1.0, 1.098556183301946, 1.1428571428571428, 1.0, 1.2222222222222223, 1.0, 1.0, 1.0, 1.0287087235091177, 1.0328462199701398, 2.0, 2.75, 1.0, 1.0, 2.0, 1.0245198201879853, 1.0327868852459017, 1.0198828222388432, 1.0, 1.0, 1.4, 1.0, 1.013217916482729, 1.0, 1.0666666666666667, 1.7142857142857142, 1.0833333333333333, 1.4, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 3.0, 2.909090909090909, 1.0, 1.1545525291828793, 4.0, 1.041233839872987, 1.0, 2.0, 10.0, 1.069204152249135, 1.0, 1.0, 1.0, 1.3571428571428572, 1.6111111111111112, 1.0, 1.0, 1.3350253807106598, 1.0, 1.0953846153846154, 1.0, 1.3271028037383177, 1.0, 1.0, 1.0098180951624434, 1.0, 1.166015625, 1.0, 1.0, 2.15, 1.0084743300436791, 1.0, 1.1553398058252426, 1.7692307692307692, 1.0, 1.0, 1.0, 1.0, 1.8194444444444444, 1.0, 1.1543913713405238, 1.1980416929879976, 1.0, 1.0, 1.0, 2.0, 31.0, 1.0638297872340425, 1.0, 1.0, 1.0, 1.0, 1.411764705882353, 1.0, 1.25, 1.0, 1.0, 1.0, 1.018957345971564, 1.0, 1.0, 1.0, 1.205098493626883, 3.0, 1.0, 1.0434782608695652, 1.0, 1.0126582278481013, 1.0, 1.0172143974960877, 1.0, 1.0, 1.0, 1.8333333333333333, 2.0, 1.5576923076923077, 1.0, 2.0, 3.0, 1.0749659755023617, 1.0190766882869133, 1.0, 1.3333333333333333, 1.0, 1.0015145778114352, 1.1666666666666667, 1.1428571428571428, 1.0, 1.1537242472266245, 2.0, 1.2714041095890412, 1.0, 1.0, 1.125, 1.0, 1.423529411764706, 1.0485, 1.4, 1.0, 1.1126760563380282, 1.0242718446601942, 4.0, 1.0, 1.1478680258686835, 1.25, 2.0, 1.0, 1.875, 1.0, 1.0, 1.0, 1.5833333333333333, 1.0, 1.157439446366782, 2.0, 1.0, 1.0712341924123578, 1.1111111111111112, 2.0, 1.16, 1.0, 1.5, 1.0, 1.3333333333333333, 1.0, 1.0, 1.0, 1.0, 1.0, 3.425925925925926, 1.0, 1.1111111111111112, 1.0, 1.0, 1.0, 1.0, 1.366394399066511, 1.0172413793103448, 1.1028571428571428, 1.1608695652173913, 1.0, 1.1423307231690465, 1.0, 1.0, 3.0, 1.0, 1.0696202531645569, 1.0, 2.0, 1.0, 1.2, 2.0, 1.0, 1.2, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.6363636363636365, 1.0, 1.0, 1.0056047730970892, 2.5, 1.0, 1.0528237738462507, 1.0, 1.0, 1.0, 1.0, 1.277037037037037, 1.0, 3.0, 1.0, 1.6666666666666667, 1.0436893203883495, 1.0, 1.0909090909090908, 1.1585365853658536, 2.0, 1.198848368522073, 1.0673076923076923, 1.0, 1.09375, 1.0, 1.3333333333333333, 5.0, 1.5, 1.0, 1.0, 1.0, 1.0, 1.0, 1.1206896551724137, 1.9090909090909092, 1.037037037037037, 2.0, 1.0, 1.0, 1.0, 1.2826086956521738, 1.1, 1.9298245614035088, 1.433950887963166, 1.0729034382202154, 1.0036618372870563, 1.0841879741500422, 1.1622641509433962, 1.0, 1.4843205574912892, 1.0, 1.1901049475262369, 1.0479234651117173, 1.0, 1.0100719246644752, 1.0292143141605508, 1.061883875450558, 1.0, 1.25, 1.0, 1.0256410256410255, 1.0, 1.0, 1.0640834575260805, 1.0515463917525774, 1.0, 3.269230769230769, 1.0, 1.0210084033613445, 1.0, 3.3333333333333335, 1.5555555555555556, 1.0, 1.0, 4.25, 1.0, 1.1910112359550562, 1.0, 1.0, 1.0, 1.0, 1.0068728020895652, 1.0, 2.0, 1.2105263157894737, 1.0302313354363828, 1.0059347181008902, 1.2242951907131012, 1.3613861386138615, 1.0373668649592134, 1.0235988200589972, 2.0625, 1.0, 1.0, 1.0285851204025398, 1.0572679148429085, 1.0, 1.8333333333333333, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0322836729293463, 1.6666666666666667, 1.4083546462063086, 1.0, 1.0, 2.0, 1.0192444761225945, 1.010854218143311, 1.2, 1.0505359877488514, 1.4, 1.0, 1.0, 1.0, 1.044875665587089, 2.5, 1.0, 1.1149732620320856, 1.0, 3.1666666666666665, 1.0, 1.0, 1.0, 1.027221089426158, 1.0, 1.0, 1.0, 1.1111111111111112, 1.35, 1.032496307237814, 3.1818181818181817, 1.0, 1.0, 1.7333333333333334, 1.25, 2.0, 1.0965340179717586, 1.0, 1.3, 1.0, 1.0, 1.1, 1.0, 1.0, 1.0, 1.0255503428365211, 1.0003296653328484, 1.2979591836734694, 1.0731707317073171, 1.0, 1.0, 1.5, 1.0, 1.085159742667103, 1.2, 3.0, 1.5, 1.1014760147601477, 1.5, 1.0, 1.0203339905456446, 1.25, 2.0, 1.0041510201024917, 2.5, 1.018047579983593, 1.0, 1.0, 1.0, 1.0929364692605608, 1.0, 2.0, 1.2, 1.0, 2.0, 1.0, 1.4054054054054055, 1.0, 1.2119205298013245, 1.0990461508815879, 2.0, 1.5, 1.0, 1.010204081632653, 2.0, 20.0, 1.0404040404040404, 1.0, 1.0162264706965778, 1.5, 1.3888888888888888, 1.0, 1.4, 1.0, 1.0, 1.0477903391572456, 2.0, 4.0, 1.0, 1.8, 1.0, 1.031198064778225, 1.0, 2.3333333333333335, 1.0, 2.0, 1.0, 1.0374531835205993, 1.0, 2.0, 1.4, 1.0030162459585918, 1.013157894736842, 1.0375, 1.4666666666666666, 2.7037037037037037, 1.0, 1.5, 1.1085899513776336, 1.0, 1.0, 1.1153846153846154, 1.254278728606357, 2.2, 2.0, 1.6, 1.3516483516483517, 1.0, 1.9684210526315788, 1.0, 1.256218905472637, 1.0, 3.0, 1.0006934995722163, 6.0, 1.00835280664247, 2.3333333333333335, 1.0, 3.0, 1.3076923076923077, 1.0, 2.0, 1.0018315018315018, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 2.8333333333333335, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.1933333333333334, 1.1904761904761905, 2.0, 1.0616666666666668, 1.0, 1.0, 1.1666666666666667, 1.0088992519187798, 1.5555555555555556, 1.0, 1.0, 1.0, 1.0, 1.0168947985921002, 1.0, 1.0, 1.0466019417475727, 1.0568612585291888, 1.0851063829787233, 2.0, 1.0, 1.0, 1.0, 1.08, 2.0, 1.0, 1.0, 1.159392789373814, 2.0, 1.0345206684256816, 1.0, 1.0, 1.0227979797979798, 1.0, 1.0, 1.0, 3.0, 1.0494217905596916, 1.0, 1.0, 1.4444444444444444, 1.0561555075593954, 1.0, 1.0, 2.0, 1.0, 1.0, 1.1893530997304582, 1.0, 2.0, 1.1100289549881548, 1.0, 1.0, 1.0251764705882354, 1.0, 1.0008864125617323, 1.0, 1.0, 1.1942148760330578, 1.0067001675041876, 1.3333333333333333, 1.015625, 1.0, 1.0, 1.3333333333333333, 1.1165984305697714, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.5, 1.168271435121504, 1.0, 1.0, 1.0, 1.5, 1.0, 1.2, 1.0973451327433628, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 4.0, 1.1288730723606168, 1.141566265060241, 1.0, 2.0, 1.5, 1.112, 1.0, 1.0, 1.0, 2.0, 1.0, 1.076215505913272, 1.076086956521739, 2.75, 1.0972495088408645, 1.0, 2.4130434782608696, 1.0, 1.08, 1.0, 1.5, 1.0, 1.0, 1.0, 1.1213355048859934, 4.0, 1.0, 4.0, 1.0227272727272727, 1.0068416954054955, 1.0, 1.0, 1.0953020134228189, 1.0036798528058877, 1.3507462686567164, 1.8, 1.0, 1.0, 1.0447783429459212, 1.0, 1.6, 1.0, 1.0, 1.5, 1.2063305978898007, 1.0, 1.0, 1.0714285714285714, 1.0, 1.0, 1.0, 1.25, 1.0, 1.1603352951667558, 1.118018018018018, 2.0, 1.0, 1.0, 3.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 2.0, 1.5, 1.2101694915254237, 1.0, 1.1325095867064336, 1.0, 1.0, 2.0, 1.0188457008244993, 3.0, 1.0, 1.0, 1.0, 1.0, 1.5714285714285714, 1.265137614678899, 3.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0630434782608695, 1.0, 1.0, 1.0, 1.0, 1.3892529488859764, 1.120016611295681, 1.0, 1.0, 1.0459770114942528, 1.52, 2.0, 1.3975903614457832, 1.0, 1.0, 1.0, 1.0, 1.0, 1.3333333333333333, 2.0, 1.0, 1.3799392097264438, 1.034606547960942, 1.2, 1.0, 1.0, 1.0, 1.0, 2.2, 1.0, 1.0, 1.2748344370860927, 1.0, 1.0, 1.434782608695652, 1.3333333333333333, 1.3888888888888888, 1.0, 1.5289473684210526, 1.0, 1.0, 1.0, 1.0, 1.0384615384615385, 1.0277777777777777, 1.0, 1.5, 1.0, 4.0, 1.0, 1.0, 2.0, 1.1666666666666667, 1.0, 1.0, 1.0, 1.0, 1.1494252873563218, 1.0, 1.0, 1.200583238240142, 1.0259646265888633, 1.0, 1.0, 1.0, 1.096257704725565, 1.0, 1.625668449197861, 1.0, 1.0276100086281277, 2.0, 1.0, 1.3846153846153846, 1.3333333333333333, 1.6666666666666667, 1.0914904082636498, 1.0, 2.6470588235294117, 1.0, 1.5, 2.5, 1.0, 1.0, 1.0, 1.6, 1.6666666666666667, 1.0, 1.0, 1.5, 1.0, 1.0, 1.0, 1.25, 1.0, 1.3333333333333333, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.1408408408408408, 2.0, 1.0, 1.0, 1.0, 1.0, 1.2222222222222223, 1.5, 1.0, 1.0097560975609756, 1.0, 1.2838241570635938, 1.0, 1.0651862464183381, 1.0, 1.0232558139534884, 6.666666666666667, 1.3, 1.0, 1.0, 1.368421052631579, 1.077932731747334, 1.0, 2.0, 1.4662857142857142, 1.0, 1.0, 1.0, 2.0, 1.0578646048515612, 1.0, 2.6, 1.0, 1.0377358490566038, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.5, 2.0, 1.0, 1.0, 1.0, 1.046629213483146, 1.042311476876286, 1.0, 1.0, 1.3333333333333333, 1.050531914893617, 1.0, 2.0, 1.0786192214111923, 1.0, 1.144927536231884, 1.0, 1.0, 1.0, 1.5, 2.3684210526315788, 2.0, 1.254883218352589, 1.0, 1.0, 1.5188965077340137, 1.0, 2.6666666666666665, 1.0, 1.0, 1.2, 1.2597864768683273, 1.0, 1.0, 1.2666666666666666, 1.0019642399209938, 1.0, 1.5555555555555556, 1.5, 1.0, 1.0890744606819764, 2.0, 2.3333333333333335, 1.0, 1.3237704918032787, 1.0, 1.187172371261178, 1.5, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.9615384615384615, 1.0, 1.1647147714393653, 1.0, 1.0023189439885836, 1.0, 1.0, 1.0, 1.0, 1.0, 1.162162162162162, 1.1627723812024153, 2.0, 1.1725806451612903, 1.0, 1.4630929953759206, 1.1153846153846154, 2.0, 1.0508474576271187, 1.4036697247706422, 2.0, 1.0, 1.0, 1.084938704028021, 1.0, 1.0, 1.0117994100294985, 2.0, 1.0]
origin-forest_43.39 	max: 31.0000	99th: 4.0000	95th: 2.5000	median: 1.0027	mean: 1.3531

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/15 | Workload-time: 23.153975 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=naru', '--data_update=valueskew', '--dataset=forest', '--drift_test=distribution', '--end2end', '--update_size=25000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-forest-16.5MB-model62.533-data19.148-200epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
ValueSample - START
ValueSample - END
load_npy_dataset_from_path - df.shape = (606012, 10)
Parsing... done, took 0.1s
Data updated!
Previous data size: (581012, 10), new data size: (25000, 10)
[ 2.9802322e-07  5.9604645e-08  5.9604645e-08  1.7881393e-07
 -5.9604645e-08  5.9604645e-08  5.9604645e-08  1.3113022e-06
  5.1879883e-04  0.0000000e+00]
Distance score: 5.207657886785455e-05
SAUCE Drift detection: True
Detection latency: 0.0597s

DRIFT-DETECTED after 2-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=forest', '--end2end', '--model=naru', '--model_update=adapt', '--update_size=25000', '--epochs=40']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-forest-16.5MB-model62.533-data19.148-200epochs-seed0.pt
update_size: 25000
AdaptTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (606012, 10)
Parsing... done, took 0.0s
done, took 0.1s
dataset size: 606012
train data shape: torch.Size([25000, 10]), transfer data shape:torch.Size([5000, 10])
Epoch 0 Iter 0, train entropy gap 38.1098 bits (loss 57.316, data 19.207) 0.00400 lr
epoch 10 train loss 25.2318 nats / 36.4018 bits
time since start: 3.9 secs
Epoch 10 Iter 0, train entropy gap 16.6259 bits (loss 35.832, data 19.207) 0.00341 lr
epoch 20 train loss 23.3006 nats / 33.6156 bits
time since start: 7.7 secs
Epoch 20 Iter 0, train entropy gap 14.2184 bits (loss 33.425, data 19.207) 0.00200 lr
epoch 30 train loss 22.6783 nats / 32.7179 bits
time since start: 11.6 secs
Epoch 30 Iter 0, train entropy gap 13.4342 bits (loss 32.641, data 19.207) 0.00059 lr
epoch 40 train loss 22.5568 nats / 32.5425 bits
time since start: 15.5 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 50.6517 nats / 73.0750 bits
Saved to: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-forest-16.5MB-model62.533-data19.148-200epochs-seed0.pt
AdaptTask - END

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/15 | Workload-time: 2.177260 | Model-update-time: 19.420557


WORKLOAD-START | Type: QueryWorkload | Progress: 3/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=forest', '--model=naru', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-forest-16.5MB-model62.533-data19.148-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-forest-16.5MB-model62.533-data19.148-200epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
data size: 606012, total size: 606012, split index: [505010 606012]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-forest-16.5MB-model62.533-data19.148-200epochs-seed0.pt
query_seed:0
origin-forest_43.39 	max: 55.0000	99th: 14.7625	95th: 4.2114	median: 1.0481	mean: 1.8499
ReportEsts: [1.0, 1.0543453336390736, 1.0, 14.75, 4.0, 1.0, 1.314769975786925, 1.0, 1.4722222222222223, 2.0, 1.2647058823529411, 4.0, 1.0, 1.0, 7.0, 2.9411764705882355, 1.7317073170731707, 1.0, 1.1636363636363636, 1.3142857142857143, 1.0, 3.0, 20.0, 1.6666666666666667, 1.6666666666666667, 1.0, 1.002985965959988, 1.0769230769230769, 3.0, 1.5185995623632385, 1.0, 2.0, 1.0, 1.0, 2.0, 2.0, 1.0, 1.0, 1.8666666666666667, 1.0, 1.0, 1.011169900058789, 5.0, 1.0508222179675368, 1.0, 1.3322259136212624, 2.0, 1.0, 1.0, 1.0, 3.0, 1.0380880418660623, 1.0, 1.0, 4.5, 1.847457627118644, 1.032490974729242, 1.2162162162162162, 1.0, 1.0, 1.0499602227525855, 2.2, 1.0, 1.240174672489083, 1.4698795180722892, 1.0, 1.4236311239193085, 1.603960396039604, 1.7120622568093384, 1.0, 2.0, 1.0, 2.840909090909091, 1.0956646759566468, 4.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.105930871229634, 7.0, 1.0384615384615385, 1.0, 1.0, 1.0, 1.4638100245355765, 1.0, 2.0, 2.0, 1.1537595043649675, 7.333333333333333, 55.0, 1.0416666666666667, 1.0, 1.0, 2.0, 1.0277777777777777, 1.0, 1.1670801109003357, 1.0, 2.146067415730337, 1.0, 1.0, 1.2790532123153586, 1.0315039250791902, 1.0, 1.0, 1.5333333333333334, 1.5, 1.2658227848101267, 1.0, 1.0, 1.1899346721509798, 2.5789473684210527, 2.0, 1.0, 3.0, 1.0, 1.0, 1.0, 2.0, 1.5, 1.0, 1.6243508366993653, 1.25, 1.0, 1.3, 1.0, 1.0, 1.0, 1.4794567062818336, 1.0531865731210353, 1.0, 3.888888888888889, 1.0, 1.0, 2.0, 1.1098646034816249, 1.0952380952380953, 1.0338825952626158, 1.0, 1.0, 2.5, 1.0, 1.1345213613924463, 1.0, 1.1333333333333333, 48.0, 4.333333333333333, 1.3846153846153846, 1.0, 1.0, 1.0, 1.0, 4.0, 2.0, 1.0, 1.0, 3.3333333333333335, 8.5, 1.0, 1.0343129712263426, 6.0, 1.0005659555942534, 1.0, 4.0, 5.0, 1.3261802575107295, 1.0, 1.0, 6.212121212121212, 1.0, 1.1991472096474256, 1.2054958183990443, 1.0, 1.9287833827893175, 2.0, 1.0, 1.0, 4.0, 3.1470588235294117, 1.0, 1.0, 1.072321807555425, 2.0, 1.0084101568817727, 1.0, 1.0, 2.5294117647058822, 1.2986293852811692, 1.0, 1.451219512195122, 2.875, 1.0, 1.0, 1.0, 1.0, 1.0263157894736843, 2.6666666666666665, 1.0777891504605936, 1.042965204236006, 1.25, 1.0, 1.0, 2.0, 35.0, 1.5, 1.0, 1.0, 1.0, 1.0, 1.619047619047619, 1.0, 1.4444444444444444, 1.0, 1.0, 1.0, 1.1322314049586777, 1.0, 1.0, 1.0, 1.2979893182532203, 3.0, 1.0, 1.84, 1.0, 1.2595419847328244, 2.0, 10.65, 1.0, 1.0, 1.0, 2.2, 1.0, 2.169811320754717, 1.0, 3.0, 1.5, 1.0889766595655352, 1.0502092050209204, 1.0, 4.0, 1.5, 1.0600680015111448, 1.4183673469387754, 1.125, 1.0, 1.3280701754385964, 3.0588235294117645, 2.3333333333333335, 1.0, 1.0, 2.7183098591549295, 1.0, 1.1411764705882352, 1.4020291693088143, 1.0714285714285714, 2.0, 1.1428571428571428, 1.3408071748878925, 1.5, 1.0, 1.0132231404958678, 2.0, 3.1666666666666665, 1.0, 1.3333333333333333, 1.0, 1.0, 1.0, 1.4444444444444444, 1.6666666666666667, 1.324228028503563, 2.0, 1.0, 1.0857142857142856, 1.0, 1.140625, 1.1290743155149934, 1.0, 1.0, 1.4, 1.03, 1.2138364779874213, 1.0877951906057073, 1.5, 1.0, 1.0, 1.875, 1.951668584579977, 1.0, 1.33, 1.0, 1.0263157894736843, 1.0, 1.0, 16.0, 6.25, 1.0, 1.0, 1.5639097744360901, 1.0, 1.3333333333333333, 1.0, 1.0, 1.5416666666666667, 1.0, 3.0, 1.0, 1.0, 1.2391304347826086, 2.0, 2.0, 3.0833333333333335, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.7272727272727273, 1.0, 1.0, 1.1729368932038835, 2.5, 1.0, 1.0036309146446891, 1.0, 1.0, 1.0, 1.0, 1.5237020316027088, 2.0, 3.0, 1.0, 1.0, 2.654320987654321, 1.1428571428571428, 1.318840579710145, 1.391812865497076, 2.0, 1.3083877448518333, 4.826086956521739, 1.0, 1.5, 1.6666666666666667, 2.0, 3.3333333333333335, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.2644628099173554, 11.0, 27.0, 6.0, 1.0, 1.0, 1.0, 1.3041237113402062, 1.8, 1.71875, 1.3130539675879793, 1.1110798913552495, 1.2399685287175453, 1.0667516874552863, 1.2258064516129032, 1.0, 2.3278688524590163, 1.0, 1.2107298211696471, 1.1428766935814971, 1.0, 1.0051732632616193, 1.0260183527305282, 1.0661954298924157, 1.0, 1.25, 1.0, 1.2352941176470589, 2.0, 2.0, 2.0, 1.4207389749702026, 1.0, 4.0, 2.0, 1.0, 1.5, 1.2, 1.0, 1.0, 1.0, 5.666666666666667, 1.0, 1.0472813238770686, 1.0, 1.0, 1.0, 1.0, 1.0071583666036281, 1.0, 2.0, 1.3768115942028984, 4.296758976150956, 1.304812834224599, 1.3538840937114673, 1.2731481481481481, 1.0457876112520998, 3.561224489795918, 2.2205882352941178, 1.0, 1.0, 1.0134051899823378, 1.0029275808936826, 1.0, 5.5, 2.0, 2.0, 1.0, 1.71875, 1.031530638261707, 1.0, 2.511830635118306, 19.0, 1.0, 1.0, 1.3045977011494252, 2.4285714285714284, 1.0, 1.0, 1.0717185385656292, 1.0282677208890856, 1.25, 1.002962962962963, 5.6, 1.0, 1.0, 1.0, 1.0014532243415077, 1.5, 1.0, 1.048397234443746, 1.0, 1.9130434782608696, 1.0, 1.0, 1.0, 1.06198761920696, 1.0, 1.0, 1.5, 1.3125, 1.074468085106383, 2.6, 1.0, 1.001861042183623, 1.0, 1.0, 1.051866552242008, 1.0, 1.0, 1.0010280133641738, 1.0, 2.0, 1.0, 1.0, 1.6666666666666667, 1.0, 1.0, 10.0, 1.232373978201635, 1.1599413217702703, 2.366906474820144, 2.8, 1.0, 1.0, 3.25, 1.0, 1.0943374598807887, 1.65625, 3.0, 1.0, 1.029520295202952, 1.4, 1.0, 1.0952973321189772, 1.7142857142857142, 1.0, 1.004191647450679, 2.5, 1.0242794486215538, 1.0, 1.0, 1.0, 1.108653468264885, 1.4166666666666667, 1.0, 5.0, 1.0, 2.0, 2.0, 1.3269230769230769, 3.0, 1.1490683229813665, 1.2776623491446002, 2.0, 1.5, 1.0, 1.3522727272727273, 2.0, 20.0, 1.4210526315789473, 1.0, 1.1233312514638145, 1.3136094674556213, 1.25, 1.0, 1.6666666666666667, 1.0, 1.0, 1.2845443091138178, 2.0, 5.0, 1.3674911660777385, 5.0, 1.0, 4.208556149732621, 1.0316088686753837, 1.3953488372093024, 1.0, 1.0, 1.0, 1.2450090744101634, 1.0, 2.0, 1.25, 1.0033459830935763, 6.08, 1.6919540229885057, 2.1666666666666665, 2.027027027027027, 1.0, 2.6, 1.018361581920904, 2.0, 1.0, 1.175, 1.4930015552099534, 1.0, 2.0, 1.3333333333333333, 1.2403846153846154, 1.0, 2.108695652173913, 1.0, 1.2976190476190477, 1.0, 6.0, 1.04706256459178, 9.0, 1.054397508664423, 2.0, 1.0, 3.0, 1.0, 1.0, 2.0943396226415096, 6.235294117647059, 1.4754797441364607, 1.1287215411558669, 1.0, 1.0, 1.0, 1.1253333333333333, 2.0, 1.5714285714285714, 1.0, 1.1688311688311688, 1.0, 3.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 2.171974522292994, 1.4705882352941178, 2.0, 1.0294599018003274, 1.0, 1.0, 1.1666666666666667, 1.0397586393925307, 3.183333333333333, 1.0, 1.0, 1.0, 1.0, 1.07832907971776, 1.0, 2.0, 1.116588940706196, 1.0, 1.0, 1.0, 4.5, 1.5, 1.0, 1.0, 1.0, 1.0, 2.75, 1.1531531531531531, 1.0670003850596843, 2.5, 2.0, 2.0, 1.0003972906714211, 1.0, 1.0, 1.0, 10.5, 1.2270263964451231, 1.0, 1.0, 1.3, 1.0198019801980198, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0934139474777311, 1.0, 1.5, 1.0061926605504588, 1.0, 1.0, 1.0444024563060936, 1.0, 1.0693768257059397, 2.0, 1.0, 1.336, 1.0478100969575392, 5.3, 2.4705882352941178, 1.0, 1.0, 1.0, 1.0643411988861204, 1.0, 1.0, 1.0, 1.0, 3.3333333333333335, 5.0, 1.0, 1.5, 1.1602914389799637, 1.0, 4.0, 1.0, 1.0, 1.0, 1.3157894736842106, 1.3852459016393444, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.2, 1.0, 1.0, 1.0, 1.0, 1.0, 4.0, 1.04290301277526, 1.371900826446281, 1.0, 2.0, 1.0, 1.6352941176470588, 1.0, 2.0, 1.0, 3.0, 1.0, 1.060932944606414, 1.3287671232876712, 1.5, 1.1212982705520018, 1.0, 2.875, 2.0, 1.1481481481481481, 1.0, 3.0, 1.0, 1.0, 1.0, 1.1590118302018093, 2.0384615384615383, 1.0, 4.0, 1.3098591549295775, 1.0748640290071452, 1.0, 1.0, 1.089705882352941, 1.1661276095266098, 1.049645390070922, 3.0, 1.0, 1.0, 1.0169277464300992, 1.0, 4.0, 1.0, 1.0, 1.3333333333333333, 1.0335570469798658, 1.0, 1.0, 1.5, 1.0, 1.0, 1.0, 1.7222222222222223, 2.0, 1.2546430968896845, 1.4035369774919615, 1.0, 1.0, 17.0, 1.1302964951204755, 1.3333333333333333, 2.0, 1.0, 1.0, 1.0, 2.0, 1.0208387600937745, 1.1065111633751088, 1.8823529411764706, 7.0, 1.1706630424230657, 2.0, 1.0, 1.2106975063245393, 1.0, 1.2653061224489797, 1.031921288240691, 1.8, 1.99609375, 1.3685015290519877, 2.0, 2.0, 1.0639686684073106, 1.6070175438596492, 3.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.7298657718120805, 1.0, 1.0, 2.0, 1.0, 1.2039473684210527, 1.2582197273456295, 1.0, 1.0, 1.8645833333333333, 1.1111111111111112, 2.0, 1.494186046511628, 2.0, 1.0, 1.0, 1.0, 1.0, 5.333333333333333, 2.0, 1.0, 1.1943462897526502, 1.0459191017705485, 1.0833333333333333, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 1.5292397660818713, 1.0, 1.0, 4.264705882352941, 4.0, 2.638888888888889, 1.0, 27.666666666666668, 1.0, 1.0, 1.1162790697674418, 1.3076923076923077, 1.0, 1.2472301644031452, 1.0, 1.4381270903010033, 1.0, 1.0, 1.0, 1.0, 2.0, 2.3333333333333335, 1.0, 1.0, 2.0, 2.0, 1.0, 1.0, 1.0, 1.383744981141258, 1.1207175781736638, 1.0, 1.0, 1.0, 1.1255487269534679, 1.0, 1.1614906832298137, 1.0, 1.033800494641385, 2.0, 1.0, 1.2857142857142858, 4.0, 1.0, 1.5327408793264734, 1.0, 1.2857142857142858, 1.0, 2.0, 5.0, 1.0, 2.0, 1.0, 8.0, 5.0, 1.0, 1.0, 1.5, 1.0, 1.875, 1.0, 1.3333333333333333, 1.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.1174884073057632, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0902255639097744, 1.0, 1.0, 1.0230642504118617, 1.0, 1.1827801827801827, 1.0, 1.0528813559322034, 1.0, 2.0816326530612246, 1.3191489361702127, 2.6, 1.0, 1.0, 1.173913043478261, 1.711111111111111, 2.0, 2.0, 1.4148936170212767, 1.0, 1.3024691358024691, 1.0, 1.0, 1.0, 1.0, 1.0031080083238235, 1.1696812813460604, 1.1257861635220126, 1.3333333333333333, 1.0, 1.3333333333333333, 1.0, 1.0, 1.0, 1.0, 1.0, 6.0, 2.0, 2.0, 1.0, 1.0, 1.0220567962503446, 1.3677964027896734, 1.0, 1.0, 2.25, 1.3906810035842294, 1.0, 2.0, 1.1485459785171601, 1.4285714285714286, 2.6285714285714286, 1.0, 1.0, 1.0, 3.5, 1.25, 1.0, 1.1301669174009599, 1.0, 1.0, 1.47098976109215, 3.0, 3.0632530120481927, 3.0, 3.0, 2.0, 1.0780669144981412, 1.0, 3.0, 4.444444444444445, 1.0735507387301289, 1.0, 2.2857142857142856, 1.0, 1.0, 1.6807017543859648, 2.0, 3.5, 1.0, 1.3863636363636365, 1.0, 1.2772861356932153, 3.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 3.2941176470588234, 1.0, 1.0945037564254647, 1.3333333333333333, 1.0020030801131388, 1.0, 1.0, 1.0, 1.0, 1.0, 3.2, 1.0909090909090908, 1.0, 1.0, 2.0, 1.0788381742738589, 1.0, 1.1, 1.2121212121212122, 1.7865168539325842, 1.0]
origin-forest_43.39 	max: 55.0000	99th: 14.7625	95th: 4.2114	median: 1.0481	mean: 1.8499

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/15 | Workload-time: 22.981969 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 4/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=naru', '--data_update=valueskew', '--dataset=forest', '--drift_test=distribution', '--end2end', '--update_size=25000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-forest-16.5MB-model62.533-data19.148-200epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
ValueSample - START
ValueSample - END
load_npy_dataset_from_path - df.shape = (631012, 10)
Parsing... done, took 0.1s
Data updated!
Previous data size: (606012, 10), new data size: (25000, 10)
[5.9604645e-08 5.9604645e-08 0.0000000e+00 5.9604645e-08 5.9604645e-08
 1.1920929e-07 5.9604645e-08 1.1920929e-07 4.7707558e-04 0.0000000e+00]
Distance score: 4.7761201130924746e-05
SAUCE Drift detection: True
Detection latency: 0.0823s

DRIFT-DETECTED after 4-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=forest', '--end2end', '--model=naru', '--model_update=adapt', '--update_size=25000', '--epochs=40']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-forest-16.5MB-model62.533-data19.148-200epochs-seed0.pt
update_size: 25000
AdaptTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (631012, 10)
Parsing... done, took 0.1s
done, took 0.1s
dataset size: 631012
train data shape: torch.Size([25000, 10]), transfer data shape:torch.Size([5000, 10])
Epoch 0 Iter 0, train entropy gap 19.5821 bits (loss 38.765, data 19.183) 0.00400 lr
epoch 10 train loss 23.7509 nats / 34.2653 bits
time since start: 3.9 secs
Epoch 10 Iter 0, train entropy gap 14.9151 bits (loss 34.098, data 19.183) 0.00341 lr
epoch 20 train loss 22.5871 nats / 32.5863 bits
time since start: 7.8 secs
Epoch 20 Iter 0, train entropy gap 13.3640 bits (loss 32.547, data 19.183) 0.00200 lr
epoch 30 train loss 22.1358 nats / 31.9352 bits
time since start: 11.6 secs
Epoch 30 Iter 0, train entropy gap 12.7554 bits (loss 31.938, data 19.183) 0.00059 lr
epoch 40 train loss 22.0539 nats / 31.8170 bits
time since start: 15.6 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 45.4578 nats / 65.5817 bits
Saved to: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-forest-16.5MB-model62.533-data19.148-200epochs-seed0.pt
AdaptTask - END

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 4/15 | Workload-time: 2.225464 | Model-update-time: 19.349026


WORKLOAD-START | Type: QueryWorkload | Progress: 5/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=forest', '--model=naru', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-forest-16.5MB-model62.533-data19.148-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-forest-16.5MB-model62.533-data19.148-200epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
data size: 631012, total size: 631012, split index: [525843 631012]
Parsing... done, took 0.1s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-forest-16.5MB-model62.533-data19.148-200epochs-seed0.pt
query_seed:0
origin-forest_43.39 	max: 55.0000	99th: 8.0137	95th: 4.0000	median: 1.0604	mean: 1.7538
ReportEsts: [1.0, 1.2057406243452755, 1.0, 3.2777777777777777, 4.0, 1.0, 1.054054054054054, 1.0, 1.2330827067669172, 1.0, 1.4492753623188406, 1.1442953020134228, 1.0, 2.0, 5.826086956521739, 1.3623188405797102, 5.0, 2.0, 1.2954545454545454, 3.3636363636363638, 1.0, 3.0, 20.0, 1.25, 1.6, 1.0, 1.104461267437985, 1.25, 3.0, 1.6763285024154588, 1.0, 2.0, 1.0, 1.0, 2.0, 2.0, 1.0, 1.0, 1.8666666666666667, 1.0, 1.0, 1.306878306878307, 5.0, 1.071255904277377, 1.0, 1.3109243697478992, 2.0, 2.0, 1.736842105263158, 1.0, 3.0, 1.0437072854480132, 1.0, 1.0, 6.0, 1.3099415204678362, 2.0082781456953644, 1.25, 1.0, 2.0, 1.0747691391123027, 1.5, 1.0, 1.6470588235294117, 1.2857142857142858, 1.0, 1.3590425531914894, 2.089108910891089, 1.630188679245283, 1.0, 2.0, 1.0, 3.3947368421052633, 1.1148108108108108, 1.3333333333333333, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 1.071892055252351, 7.0, 1.0833333333333333, 1.0, 1.0, 1.1666666666666667, 1.3976740294511378, 1.0, 2.0, 3.0, 1.0898494001531525, 1.5172413793103448, 55.0, 1.3, 3.0, 1.0, 2.0, 1.1104972375690607, 1.0, 1.096923280073947, 1.0, 1.6050420168067228, 1.0, 1.0, 1.1616919665700154, 1.0352463819389932, 1.0, 3.0, 1.3639455782312926, 1.0, 1.4080459770114941, 1.0, 1.0, 1.0460494425593796, 1.4736842105263157, 1.0, 1.0, 4.0, 1.0, 1.0, 1.0, 2.0, 3.0, 1.0, 1.2138690861957226, 2.25, 1.0, 1.2727272727272727, 1.0, 1.0, 1.0, 1.15656050955414, 1.0643084870253037, 1.0, 2.2, 1.0, 1.0, 2.0, 1.089410040307805, 1.1454545454545455, 1.0463090876328909, 2.0, 1.0, 1.25, 1.0, 1.1319966723058799, 1.0, 1.25, 5.333333333333333, 2.6, 1.2857142857142858, 1.0, 1.0, 1.0, 1.0, 4.0, 1.0, 1.0, 1.0, 1.6666666666666667, 4.5, 1.0, 1.0143042912873863, 4.0, 1.0437311683963844, 1.0, 4.0, 1.0, 1.3612334801762114, 1.0, 1.0, 2.716666666666667, 1.0, 1.1685703825736775, 1.3912220961029134, 1.0, 1.4038876889848813, 3.0, 1.0, 2.0, 2.142857142857143, 1.009433962264151, 1.0, 1.0, 1.0193889627562427, 4.0, 1.1705956451322657, 1.0, 1.0, 3.0714285714285716, 1.4350408621711388, 1.0, 1.2081218274111676, 1.5333333333333334, 1.0, 1.0, 1.0, 1.0, 1.1097560975609757, 2.0, 1.0889788905252822, 1.1869375907111757, 1.3333333333333333, 1.0, 1.0, 1.5, 32.0, 1.2935779816513762, 1.0, 1.0, 1.0, 3.0, 1.0333333333333334, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0386100386100385, 1.0, 1.0, 1.0, 1.06944028733912, 3.0, 1.0, 5.75, 1.0, 1.0705882352941176, 3.0, 1.0904255319148937, 1.3422748389030421, 1.0423728813559323, 1.0, 3.6666666666666665, 3.0, 5.4, 1.0, 4.0, 1.5, 1.0175655616031667, 1.1075697211155378, 1.0, 4.0, 1.4285714285714286, 1.0, 2.0, 2.6666666666666665, 1.0, 1.0931849791376913, 2.782608695652174, 3.3333333333333335, 2.0, 1.0, 1.8584905660377358, 1.0, 2.236842105263158, 1.5816882232811436, 2.0, 2.0, 1.1095617529880477, 1.498956158663883, 4.0, 1.0, 1.0770009106546594, 5.0, 1.5, 1.0, 1.1428571428571428, 1.0, 1.0, 1.0, 1.8181818181818181, 1.0, 1.2915057915057915, 1.8571428571428572, 1.0, 1.0049934049368758, 1.0, 1.2105263157894737, 1.2215269086357947, 1.0, 1.0, 1.6, 1.2588235294117647, 1.0641711229946524, 1.0653760658239608, 2.0, 1.0, 1.0, 3.0, 1.6697353279631761, 1.0, 1.0037735849056604, 1.0, 1.25, 1.0, 1.0, 3.5555555555555554, 7.5, 1.0, 1.0, 1.375, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.935483870967742, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.6666666666666667, 1.0, 1.0, 1.3460679177837356, 3.0, 1.0, 1.0031028368794326, 1.0, 1.0, 1.0, 1.0, 1.2328767123287672, 2.0, 3.0, 1.0, 1.5, 1.4333333333333333, 1.0, 1.1898734177215189, 1.8258426966292134, 1.0, 1.3233426466852933, 1.7903225806451613, 1.0, 3.3076923076923075, 3.5, 1.6, 10.0, 3.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.135135135135135, 11.0, 40.5, 6.0, 1.0, 1.0, 1.0, 1.152619589977221, 1.3, 1.2359550561797752, 1.3319754576543954, 1.0792955401734863, 1.5023832221163012, 1.0439231643827418, 1.5034246575342465, 1.0, 1.9631336405529953, 1.0, 1.7942238267148014, 1.1641624198586225, 1.0, 1.007153398145749, 1.0497140343158822, 1.0833731382170306, 1.0, 1.25, 1.0, 1.3611111111111112, 3.0, 2.0, 2.0, 1.0448318804483188, 3.0, 4.0, 2.0, 1.0, 1.4, 1.2, 1.25, 1.0, 1.0, 5.666666666666667, 1.0, 1.15007215007215, 1.0, 1.0, 1.0, 1.0, 1.0294550810014726, 1.0, 4.0, 1.2029339853300733, 2.7995179207713266, 1.0085470085470085, 1.0497630331753554, 3.5714285714285716, 1.1679324894514769, 1.2534818941504178, 1.0769230769230769, 1.0, 1.0, 1.0808434629303145, 1.0559434339840796, 1.0, 5.5, 3.0, 2.0, 1.0, 1.1458333333333333, 1.002260348583878, 1.0, 3.285016286644951, 15.2, 1.0, 1.0, 1.0224719101123596, 1.8421052631578947, 1.0, 1.0, 1.0576671035386631, 1.080426024908502, 1.4, 1.24645390070922, 2.5454545454545454, 1.0, 1.0, 1.0, 1.1281811469357617, 2.0, 1.0, 1.4111675126903553, 1.0, 4.166666666666667, 1.0, 1.0, 1.0, 1.075142421567841, 1.0, 1.0, 1.5, 1.1, 1.0980392156862746, 1.4482758620689655, 1.0, 1.0684844641724793, 3.0, 1.0, 1.0475962524789715, 1.0, 1.0, 1.1106358711149131, 4.0, 1.4864864864864864, 1.0, 1.3190465777389022, 1.0, 1.0, 1.0, 4.0, 1.2449063763094943, 1.1219724958949098, 1.425, 1.34375, 1.0, 1.0, 2.8, 1.0, 1.15169452181987, 1.0740740740740742, 1.5, 1.5, 1.1107011070110702, 1.7937649880095923, 3.0, 1.1533984228313932, 1.5, 2.0, 1.0130353263295735, 2.5, 1.0615458015267176, 1.0, 1.0, 1.0, 1.1125499298919512, 1.3333333333333333, 2.0, 2.0, 1.0, 2.0, 3.0, 2.260869565217391, 3.0, 1.4335260115606936, 1.3390666298473313, 2.0, 1.0, 1.0, 1.1293759512937596, 2.0, 20.0, 1.765625, 1.0, 1.1965497963421452, 1.2, 1.0869565217391304, 1.0, 1.6666666666666667, 2.5, 1.0, 1.1859247770453665, 1.0, 6.0, 1.057705363204345, 5.0, 1.0, 3.151128266033254, 1.0537287300979372, 2.3076923076923075, 1.0, 1.0, 1.0, 1.4814814814814814, 1.0, 1.0, 1.25, 1.0076690732282305, 1.2881355932203389, 3.1232876712328768, 3.75, 3.85, 1.5, 6.666666666666667, 1.2739965095986039, 3.0, 1.0, 1.146341463414634, 1.5306818181818183, 1.0, 1.0, 4.0, 1.115702479338843, 1.0, 1.425531914893617, 1.0, 1.1215255332902392, 1.0, 4.0, 1.0589721432711094, 12.0, 1.4372828125681552, 3.5, 1.0, 1.5, 2.0, 1.0, 2.5, 1.0, 2.0, 1.370547581073897, 1.0, 1.0, 1.0, 1.0691244239631337, 1.3333333333333333, 1.5714285714285714, 1.0, 1.1785714285714286, 1.0, 1.0128374379751446, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.4848484848484849, 1.0416666666666667, 2.0, 1.4483516483516483, 1.0, 1.0, 1.0, 1.0223703825646373, 2.630434782608696, 1.0, 1.0, 1.0, 1.0, 1.016743044780428, 1.0, 3.0, 1.0274914089347078, 1.0, 1.0, 1.0, 4.5, 1.5, 1.0, 1.0, 1.0, 1.0, 2.75, 1.1504922644163151, 1.0577391304347825, 1.0, 3.0, 3.0, 1.007701190099268, 1.0, 1.0, 1.0, 5.25, 1.0607324211862614, 1.0, 2.0, 1.0, 1.2458233890214798, 1.0, 1.0, 2.0, 1.0, 1.0, 1.1146632377067351, 1.0, 4.0, 1.1080903310677483, 1.0, 1.0, 1.0108979947689625, 1.0, 1.044191771187434, 1.0, 1.0, 1.0572597137014315, 1.3660850933578206, 1.4285714285714286, 3.9444444444444446, 1.0, 1.0, 1.0, 1.0497393264759758, 1.0, 1.0, 1.0, 1.0, 1.2, 5.0, 1.0, 1.0, 1.3553191489361702, 1.0, 1.0, 1.0, 1.5, 1.0, 1.25, 1.2911877394636015, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.6, 1.0, 1.0, 1.0, 1.0, 1.0, 4.0, 5.0, 1.0, 1.0, 1.231578947368421, 1.0, 1.6842105263157894, 1.0, 1.0, 3.0833333333333335, 1.0, 1.0, 1.0, 1.672075726842461, 1.6, 1.0, 1.5555555555555556, 1.15, 2.0, 1.0666666666666667, 1.0, 2.0, 1.0, 1.0, 2.0, 1.025351147653306, 2.85, 1.0, 4.0, 1.3214285714285714, 1.0889685180445354, 1.0, 1.0, 1.1147540983606556, 1.0287891617273497, 1.0810810810810811, 1.5, 1.0, 1.0, 1.1538606181689974, 1.0, 2.0, 1.0, 1.0, 1.3333333333333333, 1.1530864197530863, 3.0, 1.0, 2.0625, 1.8850574712643677, 1.531615925058548, 2.0, 3.0, 2.0, 1.0, 1.0130257202781765, 3.3529411764705883, 1.196852731591449, 1.0, 1.0, 3.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.5, 1.1400560224089635, 1.0, 1.0774535809018568, 1.0, 1.0, 3.6, 1.1621052631578948, 3.0, 2.0, 1.0, 3.0, 1.0, 1.5555555555555556, 1.1961441743503771, 3.0, 1.0, 1.0, 1.0, 1.0, 3.0, 1.4573748308525034, 1.0, 1.0, 3.0, 1.0, 1.4465648854961832, 1.1311411992263056, 1.0, 1.0, 1.2416107382550337, 1.6551724137931034, 2.0, 1.0446927374301676, 3.0, 1.0, 1.0, 1.0, 1.0, 2.6666666666666665, 2.0, 1.0, 1.6781609195402298, 1.006121905775885, 1.0909090909090908, 1.0, 1.0, 1.0, 1.0, 2.8, 1.0, 1.0, 2.0988867059593974, 1.0, 1.0, 1.206896551724138, 4.0, 1.1666666666666667, 1.0, 3.772727272727273, 1.0, 1.0, 1.5, 1.1147540983606556, 1.0, 1.2681929681112019, 1.0, 1.3017656500802568, 1.3333333333333333, 1.0, 1.0, 1.0, 2.0, 2.0, 1.0, 1.0, 1.0, 2.0, 2.0, 1.0, 1.0, 1.318840579710145, 1.200729086722947, 1.0, 1.0, 1.0, 1.6658652705502743, 1.0, 2.176470588235294, 1.0, 1.1545827633378933, 2.0, 1.0, 1.3333333333333333, 2.0, 1.6666666666666667, 1.0495314591700133, 1.0, 1.25, 1.0, 1.5, 1.6666666666666667, 1.0, 2.0, 1.0, 8.0, 5.0, 1.0, 1.0, 1.5, 1.0, 1.25, 1.0, 4.0, 1.0, 1.3573393348337084, 1.0, 1.0, 3.75, 1.0, 1.0, 1.0119047619047619, 1.0, 1.0, 1.0, 1.0, 3.3275862068965516, 3.0, 1.0930232558139534, 1.0, 1.1419558359621451, 1.0, 1.0, 5.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.04, 1.0148629646989171, 1.0, 1.2292576419213974, 1.0, 1.104, 3.0, 1.235632183908046, 1.0, 9.375, 1.2365714285714287, 3.0, 1.0, 2.0, 2.0, 1.6666666666666667, 1.0, 1.019804979279854, 1.259634817757335, 1.035928143712575, 1.5, 1.0, 1.25, 1.0, 1.0, 1.0, 1.0, 1.0, 6.0, 2.0, 3.0, 1.0, 1.0, 1.1070556114384251, 1.2606837606837606, 1.0, 1.0, 1.6666666666666667, 1.0526315789473684, 1.0, 2.0, 1.216032545883223, 2.2, 1.3463414634146342, 1.0, 1.0, 1.0, 1.6, 3.4615384615384617, 1.0, 1.1546474921080323, 1.0, 1.0, 1.602705644534287, 6.0, 3.1947674418604652, 1.1474358974358974, 1.0, 2.0, 1.0454545454545454, 1.0, 2.0, 4.2, 1.060071946207661, 1.0, 3.0, 1.0, 1.0, 1.5325275506576608, 2.0, 6.0, 1.0, 1.1625441696113075, 1.0, 1.4558573853989814, 1.5, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 4.066666666666666, 1.0, 1.1370618353682551, 1.0, 1.0462774017577534, 1.0, 1.0, 1.0, 1.0, 1.0, 1.2666666666666666, 1.5, 1.0, 1.0, 2.0, 1.535031847133758, 1.0, 1.2, 1.375, 1.1224489795918366]
origin-forest_43.39 	max: 55.0000	99th: 8.0137	95th: 4.0000	median: 1.0604	mean: 1.7538

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 5/15 | Workload-time: 23.253219 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 6/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=naru', '--data_update=valueskew', '--dataset=forest', '--drift_test=distribution', '--end2end', '--update_size=25000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-forest-16.5MB-model62.533-data19.148-200epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
ValueSample - START
ValueSample - END
load_npy_dataset_from_path - df.shape = (656012, 10)
Parsing... done, took 0.1s
Data updated!
Previous data size: (631012, 10), new data size: (25000, 10)
[ 5.9604645e-08  0.0000000e+00  5.9604645e-08  5.9604645e-08
  1.1920929e-07 -2.9802322e-08  0.0000000e+00  1.1920929e-07
  3.8915873e-04  0.0000000e+00]
Distance score: 3.895461486536078e-05
SAUCE Drift detection: True
Detection latency: 0.0868s

DRIFT-DETECTED after 6-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=forest', '--end2end', '--model=naru', '--model_update=adapt', '--update_size=25000', '--epochs=40']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-forest-16.5MB-model62.533-data19.148-200epochs-seed0.pt
update_size: 25000
AdaptTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (656012, 10)
Parsing... done, took 0.1s
done, took 0.1s
dataset size: 656012
train data shape: torch.Size([25000, 10]), transfer data shape:torch.Size([5000, 10])
Epoch 0 Iter 0, train entropy gap 18.5147 bits (loss 37.647, data 19.132) 0.00400 lr
epoch 10 train loss 23.4295 nats / 33.8017 bits
time since start: 3.9 secs
Epoch 10 Iter 0, train entropy gap 14.5806 bits (loss 33.713, data 19.132) 0.00341 lr
epoch 20 train loss 22.4075 nats / 32.3272 bits
time since start: 7.8 secs
Epoch 20 Iter 0, train entropy gap 13.1731 bits (loss 32.306, data 19.132) 0.00200 lr
epoch 30 train loss 22.0009 nats / 31.7405 bits
time since start: 11.6 secs
Epoch 30 Iter 0, train entropy gap 12.5633 bits (loss 31.696, data 19.132) 0.00059 lr
epoch 40 train loss 21.9272 nats / 31.6343 bits
time since start: 15.6 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 43.5798 nats / 62.8724 bits
Saved to: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-forest-16.5MB-model62.533-data19.148-200epochs-seed0.pt
AdaptTask - END

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 6/15 | Workload-time: 2.233924 | Model-update-time: 19.367327


WORKLOAD-START | Type: QueryWorkload | Progress: 7/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=forest', '--model=naru', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-forest-16.5MB-model62.533-data19.148-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-forest-16.5MB-model62.533-data19.148-200epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
data size: 656012, total size: 656012, split index: [546676 656012]
Parsing... done, took 0.1s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-forest-16.5MB-model62.533-data19.148-200epochs-seed0.pt
query_seed:0
origin-forest_43.39 	max: 134.0000	99th: 8.5150	95th: 4.0000	median: 1.0767	mean: 1.9320
ReportEsts: [1.0, 1.145366444579043, 1.0, 4.538461538461538, 4.0, 1.0, 1.80083857442348, 1.0, 1.1666666666666667, 1.0, 1.2428571428571429, 1.1017543859649124, 1.0, 2.5, 134.0, 1.391304347826087, 1.0, 3.0, 1.45, 3.761904761904762, 1.0, 2.0, 20.0, 1.25, 1.25, 1.0, 1.0134578412524031, 1.7777777777777777, 3.0, 2.1158536585365852, 1.0, 2.857142857142857, 1.0, 1.0, 2.0, 2.0, 1.0, 1.0, 1.75, 1.0, 1.0, 1.1038286826735886, 5.0, 1.034090032402407, 1.0, 1.255813953488372, 2.0, 6.0, 1.7692307692307692, 1.0, 3.0, 1.1163850600266785, 1.0, 1.0, 3.6, 1.0456621004566211, 1.5023584905660377, 1.40625, 1.0, 3.0, 1.0287275784753362, 1.3, 3.0, 1.0, 1.0, 2.219178082191781, 1.3713192480452503, 2.0, 2.0, 4.0, 3.0, 1.97985347985348, 1.0167854725020906, 2.3863636363636362, 1.0, 1.5683453237410072, 1.0, 1.0, 1.0, 1.0, 3.0, 1.0, 2.0, 1.0003593798131225, 7.0, 2.5, 1.0, 1.0, 1.125, 1.9410876132930515, 1.0, 3.0, 4.0, 1.188441986979399, 1.0476190476190477, 55.0, 1.35, 1.0, 1.0, 1.5, 1.8333333333333333, 1.0, 1.136108617594255, 1.5, 1.0, 1.0, 1.0, 1.0, 1.3413049565947914, 2.0, 1.0, 2.1842105263157894, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0532724505327244, 1.0, 1.0, 2.0, 3.0, 1.0, 1.096325719960278, 2.75, 1.0, 4.0, 1.0, 1.0, 1.0, 1.3156354515050168, 1.0015334743870956, 6.0, 1.9090909090909092, 1.0, 1.0, 2.0, 1.0306193458594293, 1.105263157894737, 1.0516146519011849, 1.0, 1.0, 2.5, 1.0, 1.1195319427437402, 1.0, 1.25, 6.0, 1.625, 1.0357142857142858, 1.0, 1.0, 1.0, 1.0, 4.0, 1.0, 1.0, 1.0, 1.6666666666666667, 2.235294117647059, 1.0, 1.0245913092077685, 2.0, 1.1859659022207891, 1.0, 2.0, 2.0, 1.197411003236246, 1.0, 1.0, 3.2588235294117647, 1.0, 1.21899942715295, 1.2334897149043667, 1.0, 1.0288082901554405, 2.4100719424460433, 2.227569331158238, 1.0, 2.0, 1.0, 1.0, 1.0, 3.0, 1.0, 1.0655447298494243, 1.0, 1.0, 1.4, 1.3055983950849477, 1.0, 1.096774193548387, 3.2857142857142856, 1.0, 1.0, 1.0, 1.0, 1.075, 2.6666666666666665, 1.0566104493454416, 1.1268115942028984, 4.0, 1.0, 1.0, 2.0, 36.0, 3.0, 1.0, 1.0, 1.0, 4.0, 1.0625, 1.0, 1.0, 1.0, 1.0, 4.0, 2.433333333333333, 1.0, 2.625, 5.666666666666667, 1.0, 1.0, 1.1183407033059591, 1.1641400940930475, 1.3333333333333333, 1.0, 1.1123252152977128, 1.0, 1.7647058823529411, 1.9, 1.25, 1.0826923076923076, 1.8869565217391304, 1.0, 2.0, 4.0, 4.0, 1.0654456654456654, 1.0, 4.0, 1.0, 1.0, 2.0, 2.6666666666666665, 1.0, 1.0024509803921569, 2.689655172413793, 3.5384615384615383, 3.0, 1.5, 3.406779661016949, 1.0, 1.0176470588235293, 1.937201907790143, 1.1666666666666667, 2.0, 1.149514563106796, 1.3333333333333333, 4.0, 1.0, 1.0731374555376894, 3.0, 1.0, 1.0, 1.1428571428571428, 1.0, 1.0, 1.0, 1.8636363636363635, 1.3333333333333333, 1.6325036603221084, 1.5555555555555556, 1.0, 1.0921887390959555, 1.0, 1.337837837837838, 1.555956678700361, 1.0, 1.0, 1.5, 1.1300448430493273, 1.2, 1.0221668980705703, 1.5, 1.25, 1.0, 2.5, 1.6432681242807825, 1.0, 1.2488262910798122, 4.0, 1.029940119760479, 1.0, 1.0, 3.2, 8.5, 1.0, 1.0, 1.1741935483870967, 1.0, 1.3333333333333333, 1.0, 1.0, 1.5416666666666667, 1.0, 1.5, 1.0, 1.0, 1.0158730158730158, 3.0, 1.0, 1.6666666666666667, 1.5, 1.0, 1.0, 1.0, 1.0, 1.0, 1.1666666666666667, 1.0, 1.0, 1.290608875128999, 3.0, 1.0, 1.0257570113352137, 3.0, 1.0, 1.0, 1.0, 1.196808510638298, 2.0, 3.0, 1.2105263157894737, 1.0, 1.1139896373056994, 1.2, 1.3505154639175259, 1.4756756756756757, 1.0, 1.000384024577573, 2.3125, 1.0, 2.2857142857142856, 10.0, 1.6, 2.0, 4.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.1908396946564885, 11.0, 5.4, 1.1666666666666667, 1.0, 4.0, 1.875, 1.9166666666666667, 1.0150368731563422, 3.0, 1.0555469654160985, 1.0731707317073171, 1.0017462891355868, 1.7692307692307692, 1.4272300469483568, 1.0, 1.1240105540897098, 1.0, 2.347107438016529, 1.1113317720036713, 1.0, 1.068521950215113, 1.0060508269463493, 1.1243705504427852, 1.0, 1.25, 1.0, 1.253968253968254, 4.0, 2.0, 2.0, 1.3492252681764005, 4.0, 4.0, 1.5, 1.0, 1.2173913043478262, 1.0, 1.75, 1.0, 1.0, 3.4, 1.0, 1.1236391912908243, 1.0, 1.0, 1.0, 1.0, 1.0293571901921803, 1.0, 5.0, 1.1211453744493391, 2.3464404748530128, 1.0348432055749128, 1.4726651480637813, 1.3221153846153846, 1.111587530313148, 1.315217391304348, 6.0, 1.0, 1.0, 1.0494322122052704, 1.061355095028455, 1.0, 1.2222222222222223, 2.0, 2.0, 1.0, 3.4375, 1.089032294908769, 1.0, 3.1515625, 8.444444444444445, 1.0, 1.0, 1.0947368421052632, 1.2857142857142858, 1.0, 1.0, 1.150763358778626, 1.006629806293255, 1.8, 1.7234042553191489, 4.666666666666667, 1.0, 1.0, 1.0, 1.1858059079631103, 2.5, 1.0, 1.470899470899471, 1.0, 5.6, 1.0, 1.0, 1.0, 1.0809786309959781, 1.0, 1.0, 1.5, 3.8333333333333335, 1.4507042253521127, 1.2162162162162162, 1.0, 1.1481481481481481, 4.0, 1.0, 1.0188489208633094, 1.0, 1.0, 1.0937938781241225, 6.0, 3.8666666666666667, 1.0, 1.2960594181968228, 1.0, 1.0, 1.0, 4.0, 1.1341753879465897, 1.1254405890185635, 1.7115384615384615, 1.76, 1.0, 1.0, 1.5, 1.0, 1.0774544693322168, 1.4883720930232558, 1.5, 1.5, 1.8066666666666666, 1.8405466970387243, 1.0, 1.155440618301245, 1.8333333333333333, 2.0, 1.0330293248288738, 2.5, 1.0417040358744394, 1.0, 1.0, 1.0, 1.0962191532714511, 2.0, 2.0, 1.84, 1.0, 5.0, 5.0, 2.1666666666666665, 1.5, 1.5243243243243243, 1.3594985397820358, 2.0, 1.5, 1.0, 1.0769230769230769, 2.0, 20.0, 1.3111111111111111, 1.0, 1.1255736638600802, 1.1306122448979592, 1.1904761904761905, 1.0, 1.25, 3.0, 1.0, 1.1572077185017027, 1.0, 7.0, 4.0, 1.0416666666666667, 1.8, 1.0, 2.0, 1.5, 1.6666666666666667, 1.0, 1.0625465376023828, 1.5, 1.0, 1.4273858921161826, 2.0, 1.0226059568390116, 1.0, 1.0, 1.2189463508941518, 1.0, 1.0, 1.2142857142857142, 2.5, 3.0, 1.0120481927710843, 1.0724637681159421, 1.25, 2.0, 1.25, 1.0070921985815602, 1.0, 2.0392156862745097, 1.0, 1.0749583564686285, 1.0, 4.0, 1.0616553057999387, 1.2, 1.0572427335669425, 2.4860557768924303, 1.0, 3.0, 3.0, 1.0, 1.8888888888888888, 4.25, 3.0, 1.1565724540152535, 1.0, 1.0, 1.0, 1.1465295629820051, 1.8333333333333333, 2.066666666666667, 1.767866738312735, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.3352601156069364, 1.36, 2.0, 1.1355685131195334, 1.0, 1.0, 1.1666666666666667, 1.0077085215296597, 2.1774193548387095, 1.0, 1.0, 1.0, 1.0, 1.0079840319361277, 1.0, 4.0, 1.1204188481675392, 1.0, 1.0, 1.0, 6.5, 1.6666666666666667, 1.0, 1.0, 1.0, 1.0, 1.8333333333333333, 1.231863442389758, 1.0261888352860096, 1.0, 4.0, 4.0, 1.015996773759914, 1.0, 1.0, 1.0, 3.230769230769231, 1.0745711706289498, 1.0, 2.0, 1.2307692307692308, 1.061023622047244, 1.0, 1.0, 1.0, 1.0, 1.0, 1.1984641638225255, 1.0, 5.0, 1.0436801012871915, 1.0, 1.0, 1.0098947368421052, 1.0, 1.1157585349310424, 1.0, 1.0, 2.7142857142857144, 1.2389240506329113, 1.0, 1.0, 1.0, 1.3333333333333333, 1.0, 1.0139042898880521, 1.2621609640108007, 1.0, 4.0, 1.1428571428571428, 1.0, 3.5, 1.0, 1.0, 1.0, 1.0673811024725082, 1.0, 1.0, 1.2292307692307691, 13.625, 2.0, 1.6, 1.2482014388489209, 1.0, 1.7575757575757576, 20.0, 1.5957446808510638, 4.0, 3.0, 1.0, 1.0, 1.0, 1.6777777777777778, 1.0, 2.8207547169811322, 1.0, 10.0, 3.3333333333333335, 1.0, 1.205, 1.0, 1.4583333333333333, 1.0, 1.0, 1.2666666666666666, 1.0, 1.0, 1.0, 1.266905737704918, 1.1574074074074074, 1.0, 1.2857142857142858, 2.0, 2.0, 1.2307692307692308, 1.0, 1.5, 1.0, 1.0, 3.0, 1.0610713067212556, 3.210526315789474, 1.0, 4.0, 1.3161290322580645, 1.073633576488001, 1.0, 1.0, 1.0032670841274163, 1.218028780885148, 1.135483870967742, 1.2857142857142858, 4.0, 1.0, 1.8299492385786802, 1.2912621359223302, 2.642694795734017, 1.0, 1.0, 4.0, 1.3752244165170557, 1.0, 6.75, 1.0, 1.0, 2.0606060606060606, 4.0, 1.5, 2.0, 1.0, 1.0389801022072416, 4.657894736842105, 1.2444312444312444, 1.0, 1.0, 3.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.5, 1.8049792531120332, 1.0, 1.08349171354721, 1.0, 1.0, 6.0, 1.1675166732051785, 3.0, 2.0, 1.0, 4.0, 1.0, 1.5357142857142858, 1.5985576923076923, 3.0, 1.0, 1.0, 1.0, 1.0, 2.0, 2.473684210526316, 1.0, 1.0, 4.0, 1.0, 1.462686567164179, 1.085575485799701, 1.0, 1.0, 1.0670391061452513, 1.1071428571428572, 2.0, 1.6021505376344085, 5.0, 1.0, 1.0, 1.0, 1.0, 2.0, 2.0, 1.0, 1.1731843575418994, 1.017054855542828, 1.2, 1.0, 3.2295081967213113, 1.0, 1.1529411764705881, 1.0, 2.0, 1.0, 1.0495795231874592, 6.0, 1.0, 1.0, 1.0350523771152296, 1.1113783803484218, 1.0, 1.6666666666666667, 1.0, 1.0958999305072967, 1.0, 1.121983039791259, 1.0476190476190477, 1.1073209975864844, 1.7013888888888888, 1.0880816899212722, 1.0, 1.146153846153846, 1.6666666666666667, 1.0, 1.0, 1.0, 2.0, 2.8, 4.0, 4.0, 1.0, 4.0, 1.0, 1.0, 1.0, 1.7638888888888888, 3.0, 1.0, 5.0, 1.0586560364464692, 2.411764705882353, 1.0, 1.0, 1.1508810572687225, 5.0, 1.304154302670623, 2.0, 1.0, 1.1875, 1.5500878734622143, 1.0, 1.2777777777777777, 1.0, 1.4444444444444444, 1.0, 2.0, 1.6666666666666667, 1.0, 2.0, 1.0, 8.0, 5.0, 1.0, 1.0, 1.5, 1.0, 1.1428571428571428, 1.0, 4.0, 1.0, 1.2780337941628264, 1.0, 1.0, 1.935483870967742, 1.0, 1.0, 1.0714285714285714, 1.0, 1.0, 1.0, 1.0, 2.6987951807228914, 3.0, 1.9545454545454546, 1.0, 1.0212765957446808, 1.0, 1.0, 5.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.1378205128205128, 1.011086208756307, 1.0, 1.1959798994974875, 1.5, 1.162162162162162, 4.0, 1.076453488372093, 1.0, 5.181818181818182, 1.1864406779661016, 5.0, 1.0, 3.0, 2.0, 2.0, 1.0, 1.0239902824172487, 1.1195453560035926, 1.5217391304347827, 1.2, 1.0, 1.0, 1.0, 1.0, 1.0, 6.0, 1.0, 6.0, 2.0, 4.0, 1.0, 1.0, 1.0481248360870705, 1.2657200811359026, 1.0, 1.0, 3.142857142857143, 1.0340632603406326, 1.0, 2.0, 1.3775333857030636, 1.263157894736842, 1.140495867768595, 1.0, 1.0, 1.0, 1.8, 1.3235294117647058, 1.0, 1.1315728668097045, 1.0, 1.0, 1.5435660703981535, 3.0, 3.1292134831460676, 1.0222929936305734, 1.5, 2.0, 1.088339222614841, 1.0, 2.0, 1.0152905198776758, 1.0, 1.0, 1.0422535211267605, 1.0, 2.0, 1.0513966480446928, 1.25, 1.0, 1.0, 2.3333333333333335, 1.3783783783783783, 1.0, 1.0640877598152425, 1.5, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 2.5384615384615383, 1.0, 1.0629865534324132, 1.0, 1.0019143913908146, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0344827586206897, 1.25, 1.0, 1.0, 2.0, 1.544871794871795]
origin-forest_43.39 	max: 134.0000	99th: 8.5150	95th: 4.0000	median: 1.0767	mean: 1.9320

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 7/15 | Workload-time: 23.508106 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 8/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=naru', '--data_update=valueskew', '--dataset=forest', '--drift_test=distribution', '--end2end', '--update_size=25000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-forest-16.5MB-model62.533-data19.148-200epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
ValueSample - START
ValueSample - END
load_npy_dataset_from_path - df.shape = (681012, 10)
Parsing... done, took 0.1s
Data updated!
Previous data size: (656012, 10), new data size: (25000, 10)
[5.9604645e-08 5.9604645e-08 5.9604645e-08 5.9604645e-08 1.7881393e-07
 0.0000000e+00 0.0000000e+00 1.1920929e-07 4.1639805e-04 5.9604645e-08]
Distance score: 4.169940802967176e-05
SAUCE Drift detection: True
Detection latency: 0.0893s

DRIFT-DETECTED after 8-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=forest', '--end2end', '--model=naru', '--model_update=adapt', '--update_size=25000', '--epochs=40']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-forest-16.5MB-model62.533-data19.148-200epochs-seed0.pt
update_size: 25000
AdaptTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (681012, 10)
Parsing... done, took 0.1s
done, took 0.1s
dataset size: 681012
train data shape: torch.Size([25000, 10]), transfer data shape:torch.Size([5000, 10])
Epoch 0 Iter 0, train entropy gap 17.9809 bits (loss 37.049, data 19.068) 0.00400 lr
epoch 10 train loss 23.2039 nats / 33.4761 bits
time since start: 3.9 secs
Epoch 10 Iter 0, train entropy gap 14.1807 bits (loss 33.249, data 19.068) 0.00341 lr
epoch 20 train loss 22.1512 nats / 31.9575 bits
time since start: 7.7 secs
Epoch 20 Iter 0, train entropy gap 12.8565 bits (loss 31.925, data 19.068) 0.00200 lr
epoch 30 train loss 21.7515 nats / 31.3808 bits
time since start: 11.6 secs
Epoch 30 Iter 0, train entropy gap 12.2430 bits (loss 31.312, data 19.068) 0.00059 lr
epoch 40 train loss 21.6743 nats / 31.2695 bits
time since start: 15.6 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 42.2619 nats / 60.9710 bits
Saved to: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-forest-16.5MB-model62.533-data19.148-200epochs-seed0.pt
AdaptTask - END

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 8/15 | Workload-time: 2.257798 | Model-update-time: 19.441682


WORKLOAD-START | Type: QueryWorkload | Progress: 9/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=forest', '--model=naru', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-forest-16.5MB-model62.533-data19.148-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-forest-16.5MB-model62.533-data19.148-200epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
data size: 681012, total size: 681012, split index: [567510 681012]
Parsing... done, took 0.1s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-forest-16.5MB-model62.533-data19.148-200epochs-seed0.pt
query_seed:0
origin-forest_43.39 	max: 32.0000	99th: 9.0000	95th: 5.0000	median: 1.0686	mean: 1.8593
ReportEsts: [1.0, 1.0974983964079539, 1.0, 2.5652173913043477, 2.6666666666666665, 1.0, 1.3241650294695482, 1.0, 1.0175438596491229, 1.0, 1.4647887323943662, 1.0123456790123457, 1.0, 1.0, 5.826086956521739, 1.1395348837209303, 2.0, 4.0, 1.6388888888888888, 1.3095238095238095, 1.0, 3.5, 1.0, 1.0, 1.091127098321343, 1.0, 5.0, 10.0, 1.0, 1.3404255319148937, 1.0, 1.0, 1.0, 1.0, 2.0, 2.0, 1.0, 1.6363636363636365, 1.0, 2.5, 6.0, 1.0, 1.8888888888888888, 1.0, 1.0708333333333333, 1.3969072164948453, 1.0, 2.0, 1.0, 1.0, 3.0, 1.0810334551297003, 1.0, 1.0, 2.0, 1.0854700854700854, 1.5007451564828613, 1.6451612903225807, 1.0, 4.0, 1.0864375089889255, 1.4285714285714286, 4.0, 2.0, 1.0, 1.2191780821917808, 1.5070903361344539, 2.5, 2.0, 5.0, 4.0, 1.6734693877551021, 1.0352901457679629, 1.3548387096774193, 1.0, 1.4825174825174825, 1.0, 1.0, 1.0, 1.0, 4.0, 1.0, 1.0, 1.0569774728717967, 7.0, 2.9615384615384617, 1.0, 1.0, 1.4, 1.6118294094944037, 1.0, 4.0, 5.0, 1.2082242011524358, 2.4444444444444446, 27.5, 1.4285714285714286, 1.0, 1.0, 4.0, 4.666666666666667, 1.0, 1.08364312267658, 1.8333333333333333, 1.0, 1.0, 1.0, 1.0, 1.2360310200835156, 1.5, 1.0, 1.3076923076923077, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.241234221598878, 1.0, 1.0, 2.0, 3.0, 1.0, 1.4410399257195914, 3.25, 1.0, 5.0, 1.0, 1.0, 1.0, 1.4789433962264151, 1.090402661980783, 1.0, 1.5833333333333333, 1.0, 1.0, 2.0, 1.0053050397877985, 1.5555555555555556, 1.0462746408286, 1.0, 1.0, 5.0, 1.0, 1.1550553250691875, 1.0, 1.5, 1.5, 1.4444444444444444, 1.0689655172413792, 1.0, 1.0, 1.0, 1.0, 4.0, 1.0, 1.0, 1.0, 2.0, 3.6363636363636362, 1.0, 1.2110001636929122, 3.0, 1.0756380870984033, 1.0, 2.0, 3.0, 1.6612903225806452, 1.0, 1.0, 2.190909090909091, 1.0, 1.2965655909173994, 1.0693581780538302, 1.0, 1.0176892207558847, 2.5355191256830603, 1.3546626984126984, 1.0, 6.0, 1.0, 1.0, 1.0, 3.0, 1.0, 1.0696366124372814, 1.0, 1.0, 1.7894736842105263, 1.2923917090728558, 1.0, 1.367816091954023, 1.0136588318369817, 2.0, 1.362962962962963, 1.0952380952380953, 1.3570523266340757, 1.0, 1.0, 4.0, 1.0, 9.0, 1.0, 1.0, 1.0, 2.0, 1.1144130757800892, 7.0, 1.25, 1.7692307692307692, 1.0, 5.0, 1.0441176470588236, 1.0, 1.0, 1.0, 1.0, 5.0, 3.926829268292683, 1.0, 1.8888888888888888, 3.0, 1.0, 1.0, 1.1395774075579033, 1.2340681362725452, 1.1612903225806452, 1.0, 1.0751659339712094, 1.0, 5.0, 1.0, 1.0, 1.375, 5.0, 1.435897435897436, 1.0, 2.0, 1.5, 1.1360681461555704, 1.1845018450184501, 1.0, 4.0, 2.0, 1.0, 1.0, 5.0, 1.0, 1.063454759106933, 1.3428571428571427, 2.8333333333333335, 4.0, 1.0, 2.5, 1.0, 1.2264705882352942, 2.2479047198941333, 2.8, 2.0, 1.035294117647059, 1.456043956043956, 4.0, 1.0, 1.0408163265306123, 7.0, 1.5, 1.0, 1.1428571428571428, 1.0, 1.0, 1.0, 1.1666666666666667, 2.0, 1.7304707708225555, 1.2222222222222223, 1.0, 1.2305194805194806, 1.0, 1.139240506329114, 1.4168591224018476, 1.0, 1.0, 2.5, 1.2412868632707774, 1.0, 1.049089469517023, 2.0, 1.1333333333333333, 1.0, 2.5, 2.0299194476409665, 1.0, 1.2293233082706767, 5.0, 1.4310344827586208, 1.0, 1.0, 5.333333333333333, 11.5, 1.0, 1.0, 1.070967741935484, 1.0, 2.6666666666666665, 1.0, 1.0, 1.3333333333333333, 1.0, 1.5, 1.0, 1.0, 1.3484848484848484, 1.0, 2.0, 3.6666666666666665, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.2222222222222223, 1.0, 1.0, 1.179930795847751, 4.0, 1.0, 1.0175636811832374, 3.0, 1.0, 1.0, 1.0, 1.087832393231265, 1.5, 3.0, 1.9230769230769231, 1.0, 1.158139534883721, 1.0, 1.19, 1.1041666666666667, 1.0, 1.2599758162031438, 5.045454545454546, 1.0, 1.2045454545454546, 2.6, 1.6, 3.3333333333333335, 5.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.2952380952380953, 11.0, 5.0625, 6.0, 1.0, 6.0, 1.1240875912408759, 2.4095238095238094, 1.0073016206377543, 3.0, 1.0692219189207481, 1.2191780821917808, 1.0114127823161942, 1.3846153846153846, 1.0258899676375404, 5.0, 1.1767955801104972, 1.0, 2.798076923076923, 1.10060164250692, 1.0, 1.0519926515104068, 1.0771929824561404, 1.1554551323434474, 1.0, 1.2, 1.0, 1.0555555555555556, 5.0, 2.0, 2.0, 1.3015494636471991, 5.0, 2.5, 1.0, 1.0, 1.5272727272727273, 1.0, 2.75, 1.0, 1.0, 5.666666666666667, 1.0, 1.0882778581765558, 1.0, 1.0, 1.0, 1.0, 1.0220448257481534, 1.0, 3.0, 2.9010516252390057, 1.0, 2.0, 1.0, 1.0, 1.0382954769343353, 2.5, 1.4313725490196079, 1.0, 1.0, 1.0638874193207069, 1.16633371169126, 1.0, 1.375, 2.5, 2.0, 1.0, 1.0909090909090908, 1.0567277389028364, 1.0, 3.1864139020537126, 4.75, 1.0, 1.0, 1.2792207792207793, 1.0571428571428572, 9.0, 1.0, 1.0890538033395176, 1.121351286366915, 1.4, 1.1509146341463414, 2.8, 1.0, 1.0, 1.0, 1.1560316928914183, 2.5, 1.0, 1.824945295404814, 4.0, 1.0, 1.097872340425532, 1.0, 1.0, 1.111842105263158, 2.3333333333333335, 1.3888888888888888, 15.0, 1.0167810831426392, 1.0, 4.0, 2.0, 1.0, 1.0, 1.0202650432208806, 1.0, 1.0, 1.111239860950174, 1.10989010989011, 1.0, 1.0, 1.0, 1.0, 1.2538461538461538, 8.0, 1.4255820807544946, 1.037392269677943, 3.0, 2.0, 1.0565068493150684, 1.0, 1.0, 1.0, 2.375, 1.0, 1.0, 1.0, 2.5, 1.5625, 1.0105023819835426, 1.0, 3.8333333333333335, 1.0, 1.7547169811320755, 1.0, 2.0, 1.0, 1.0, 1.0, 1.1027201846850772, 2.6666666666666665, 3.0, 2.0833333333333335, 1.0, 3.0, 7.0, 1.0196078431372548, 1.5, 1.0203045685279188, 1.3798746631165373, 2.0, 2.0, 1.0, 1.096286107290234, 4.0, 4.0, 1.2424242424242424, 1.0, 1.1208029260344259, 1.0156862745098039, 1.32, 1.0, 5.0, 1.0, 1.0, 1.0, 5.0, 1.1015452538631347, 2.3, 2.0, 6.0, 1.0, 1.0825335892514396, 1.0, 4.0, 2.5, 5.0, 1.0721793973370708, 5.0, 1.0, 1.4921875, 2.0, 1.046592170893773, 1.0, 1.0, 1.1660730186999109, 1.0, 1.0, 1.2253521126760563, 3.5, 4.0, 1.011764705882353, 1.4416382252559727, 1.0, 2.0, 1.125, 1.0970149253731343, 1.0, 1.5925925925925926, 1.0, 1.2267633487145682, 1.0, 3.0, 1.022090451956864, 1.0, 1.0376170280867407, 1.4397394136807817, 1.0, 3.0, 2.3333333333333335, 1.0, 1.7222222222222223, 8.5, 4.0, 1.4748283752860412, 1.0, 1.0, 1.0, 1.1127982646420824, 1.5, 4.85, 1.8700351256417185, 1.0, 5.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.5, 1.0, 1.0, 1.0, 1.0225988700564972, 1.0240476122837419, 1.2682242990654207, 1.0, 1.0, 1.25, 2.0, 5.0, 5.0, 1.0, 1.0, 1.0, 1.0, 1.0056616415410384, 1.0, 5.0, 1.0362800204394482, 1.0, 1.0, 1.0, 1.0, 1.3333333333333333, 1.0, 1.0, 1.0, 1.0, 2.2, 4.761904761904762, 1.0120051914341337, 1.0, 5.0, 5.0, 1.0419823289125623, 1.0, 1.0, 1.0, 6.0, 1.0049466567423397, 1.0, 1.0, 1.1538461538461537, 1.1921005385996408, 1.0, 1.0, 1.5, 1.0, 1.0, 1.0086717080387966, 1.0, 6.0, 1.0094455852156057, 1.0, 1.0, 1.043770358306189, 1.0, 1.043782072278633, 1.0, 1.0, 1.0526315789473684, 1.4909420289855073, 1.0, 1.0, 1.0, 1.875, 1.0, 1.0376669701079384, 1.2654813833930518, 1.0, 5.0, 32.0, 1.0, 2.3333333333333335, 2.5, 1.0, 1.0, 1.0474505442658308, 1.0, 1.0, 1.103448275862069, 12.11111111111111, 1.4666666666666666, 4.5, 1.0489208633093525, 1.0, 1.7281553398058251, 1.1, 1.5625, 5.0, 3.0, 1.0, 1.0, 1.0, 1.3333333333333333, 1.0, 4.218181818181818, 1.0, 13.0, 2.5, 5.0, 1.5935483870967742, 1.0, 1.3103448275862069, 1.0, 1.0, 3.5454545454545454, 1.0, 1.0, 1.0, 1.505173463177115, 1.1875, 5.0, 1.1111111111111112, 3.066666666666667, 2.0, 1.2592592592592593, 1.0, 1.5, 4.0, 1.0, 4.0, 1.0043545878693623, 1.625, 1.0, 4.0, 1.0925925925925926, 1.001376887285158, 1.0, 1.0, 1.0280550310223902, 1.0318621049882475, 1.2461538461538462, 3.0, 5.0, 1.0, 1.0960698689956332, 1.0142857142857142, 2.074995533321422, 1.0, 1.0, 5.0, 1.441941074523397, 1.0, 9.0, 1.0, 1.0, 1.2121212121212122, 6.0, 1.0, 2.0, 1.0, 1.1093655589123868, 3.452830188679245, 1.626122754491018, 1.0, 1.0, 3.0, 4.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.5, 1.4141104294478528, 1.0, 1.1200915920746362, 1.0, 1.0, 3.0, 1.0847042352117606, 3.0, 2.0, 1.0, 5.0, 1.0, 2.107142857142857, 1.0792917628945342, 3.0, 1.0, 1.0, 1.0, 1.0, 5.0, 2.230769230769231, 1.0, 1.0, 5.0, 1.0, 1.506188118811881, 1.106936416184971, 1.0, 1.0, 1.0761421319796953, 1.5714285714285714, 2.0, 1.61139896373057, 7.0, 1.0, 1.0, 1.0, 1.0, 2.6666666666666665, 2.0, 1.0, 1.6103542234332424, 1.2365419987737585, 1.2, 1.0, 3.08955223880597, 1.0, 1.0294117647058822, 1.0, 2.3333333333333335, 1.0, 1.1111782855236825, 6.0, 1.0, 1.0, 1.1270742358078603, 1.1240532959326788, 1.0, 3.0, 5.0, 1.363220494053065, 1.0, 1.1714208584540629, 2.522727272727273, 1.1514033680834002, 1.0061349693251533, 1.3516994286820956, 1.0, 1.344165435745938, 1.0, 1.0, 1.0, 1.0, 2.0, 2.0, 5.0, 5.0, 1.0, 5.0, 1.0, 1.0, 1.0, 1.401305057096248, 3.0, 1.0, 6.0, 1.0153256704980842, 1.7142857142857142, 1.0, 1.0, 1.470634299138606, 2.0, 1.0, 1.8666666666666667, 1.0, 1.0, 1.0, 1.0, 1.125, 1.0, 1.6666666666666667, 1.3403582718651212, 4.0, 1.0, 5.0, 2.1812080536912752, 1.0, 1.0470875479595396, 1.0, 1.0, 1.0, 6.0, 1.0810810810810811, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0041281778795061, 2.0, 1.0, 1.0, 1.0, 1.0, 1.109375, 1.0, 1.0, 5.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.782857142857143, 1.0371194545712799, 6.0, 1.208502024291498, 2.0, 1.0300751879699248, 5.0, 1.1082474226804124, 1.0, 5.428571428571429, 1.0337142857142858, 7.0, 1.0, 4.0, 1.5, 1.6, 1.0, 1.0616838939151607, 1.234386204541574, 1.1215469613259668, 1.1666666666666667, 1.0, 1.5, 1.0, 1.0, 1.0, 8.0, 1.0, 6.0, 2.0, 5.0, 1.0, 1.0, 1.2978389472413376, 2.12984496124031, 1.0, 1.0, 3.125, 1.2369668246445498, 1.0, 2.0, 1.4087403598971722, 2.6, 1.0298507462686568, 1.0, 1.0, 1.0, 2.5, 1.2162162162162162, 1.0, 1.1632346702346377, 1.0, 1.0, 1.597264218862491, 1.5, 3.3008130081300813, 1.2359550561797752, 1.5, 2.0, 1.1527272727272728, 1.0, 2.0, 1.2426778242677825, 1.0, 1.0, 1.9912280701754386, 1.0, 2.0, 1.1175869120654396, 1.4, 1.0, 1.0, 1.3333333333333333, 1.0391644908616189, 1.0, 1.0671525247267049, 3.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 2.1515151515151514, 1.0, 1.0681973954763537, 3.0, 1.0441817399599709, 1.0, 1.0, 1.0, 1.0, 1.0, 1.325, 1.2222222222222223, 1.0, 1.0, 2.0, 1.5253164556962024]
origin-forest_43.39 	max: 32.0000	99th: 9.0000	95th: 5.0000	median: 1.0686	mean: 1.8593

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 9/15 | Workload-time: 23.710238 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 10/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=naru', '--data_update=valueskew', '--dataset=forest', '--drift_test=distribution', '--end2end', '--update_size=25000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-forest-16.5MB-model62.533-data19.148-200epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
ValueSample - START
ValueSample - END
load_npy_dataset_from_path - df.shape = (706012, 10)
Parsing... done, took 0.1s
Data updated!
Previous data size: (681012, 10), new data size: (25000, 10)
[ 1.7881393e-07  0.0000000e+00  5.9604645e-08  0.0000000e+00
  5.9604645e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
  3.0851364e-04 -2.9802322e-08]
Distance score: 3.087818549829535e-05
SAUCE Drift detection: True
Detection latency: 0.0932s

DRIFT-DETECTED after 10-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=forest', '--end2end', '--model=naru', '--model_update=adapt', '--update_size=25000', '--epochs=40']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-forest-16.5MB-model62.533-data19.148-200epochs-seed0.pt
update_size: 25000
AdaptTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (706012, 10)
Parsing... done, took 0.1s
done, took 0.1s
dataset size: 706012
train data shape: torch.Size([25000, 10]), transfer data shape:torch.Size([5000, 10])
Epoch 0 Iter 0, train entropy gap 18.0711 bits (loss 37.068, data 18.997) 0.00400 lr
epoch 10 train loss 23.0780 nats / 33.2946 bits
time since start: 3.9 secs
Epoch 10 Iter 0, train entropy gap 14.0644 bits (loss 33.061, data 18.997) 0.00341 lr
epoch 20 train loss 22.0989 nats / 31.8820 bits
time since start: 7.7 secs
Epoch 20 Iter 0, train entropy gap 12.7619 bits (loss 31.759, data 18.997) 0.00200 lr
epoch 30 train loss 21.7053 nats / 31.3141 bits
time since start: 11.6 secs
Epoch 30 Iter 0, train entropy gap 12.2319 bits (loss 31.229, data 18.997) 0.00059 lr
epoch 40 train loss 21.6262 nats / 31.1999 bits
time since start: 15.5 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 41.4260 nats / 59.7652 bits
Saved to: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-forest-16.5MB-model62.533-data19.148-200epochs-seed0.pt
AdaptTask - END

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 10/15 | Workload-time: 2.272746 | Model-update-time: 19.342542


WORKLOAD-START | Type: QueryWorkload | Progress: 11/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=forest', '--model=naru', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-forest-16.5MB-model62.533-data19.148-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-forest-16.5MB-model62.533-data19.148-200epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
data size: 706012, total size: 706012, split index: [588343 706012]
Parsing... done, took 0.1s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-forest-16.5MB-model62.533-data19.148-200epochs-seed0.pt
query_seed:0
origin-forest_43.39 	max: 20.2500	99th: 10.0000	95th: 6.0000	median: 1.0889	mean: 1.9815
ReportEsts: [1.0, 1.309131183854295, 1.0, 2.269230769230769, 4.0, 1.0, 1.1595547309833023, 1.0, 2.103305785123967, 1.0, 1.1076923076923078, 1.1374269005847952, 1.0, 1.5, 2.977777777777778, 1.0, 1.0, 5.0, 1.0169491525423728, 1.0864197530864197, 1.0, 4.5, 1.0, 1.0, 1.2634408602150538, 1.0, 5.0, 12.0, 6.0, 1.8727272727272728, 1.5, 1.0, 1.0, 1.0, 2.0, 2.0, 1.0, 1.0649350649350648, 1.0, 2.2, 7.0, 1.0, 1.1333333333333333, 1.0, 1.3754266211604096, 1.4631578947368422, 1.0, 2.0, 1.0, 1.0, 3.0, 2.3177150192554556, 1.0, 1.0, 3.6, 1.100418410041841, 1.614678899082569, 1.2456140350877194, 1.0, 5.0, 1.0008785140562249, 2.6666666666666665, 5.0, 1.0, 1.0, 1.1267605633802817, 9.0, 1.0, 2.0, 1.0, 14.0, 1.3529411764705883, 1.0169177803279903, 1.206896551724138, 1.0, 1.683673469387755, 1.0, 1.0, 1.0, 1.0, 2.5, 1.0, 2.0, 1.0297122668533962, 7.0, 5.0, 1.6888888888888889, 1.697674418604651, 1.0, 1.0, 1.717483684929428, 1.0, 1.0, 1.0643401105549097, 1.0, 1.025285679552638, 1.0, 6.0, 1.6296296296296295, 1.254575707154742, 5.0, 2.0, 1.0, 1.0, 1.0, 2.0, 1.4137931034482758, 1.1724444444444444, 1.0, 1.5663716814159292, 1.1111111111111112, 1.0, 4.125, 1.2, 1.0, 2.0, 1.0, 1.0, 1.0, 2.6, 1.0, 1.0, 2.9, 1.7762237762237763, 2.111111111111111, 17.0, 2.048780487804878, 2.0, 5.0, 1.5088547815820543, 1.0, 1.0, 1.0, 1.271407110665999, 1.0348238280083608, 1.0, 1.1818181818181819, 1.0, 1.0, 2.0, 1.2335557673975215, 1.0634920634920635, 1.0714573933458054, 1.0, 1.0, 5.0, 1.0, 1.1391531546109146, 1.0, 1.5666666666666667, 4.0, 1.1818181818181819, 1.0, 1.0, 1.0, 1.0, 1.0, 4.0, 1.0, 1.0, 1.0, 3.0, 3.230769230769231, 1.0, 1.2567362907805895, 3.5, 1.0743364822312191, 1.0, 2.0, 4.0, 1.6263157894736842, 1.0, 1.0, 3.3407407407407406, 1.0, 1.184298156925674, 1.0327980867782713, 1.0, 1.0125288236068386, 2.211453744493392, 1.4557569296375266, 1.0, 3.0, 1.0, 1.0, 1.0, 3.0, 1.0, 1.010386373078521, 1.0, 1.0, 2.1666666666666665, 1.3344782068205412, 1.0, 1.2899159663865547, 1.0310194096888032, 2.0, 1.1382113821138211, 1.3987854251012146, 1.2556184316895715, 1.0, 1.0, 4.0, 1.0, 6.0, 1.0, 1.0, 1.0, 5.0, 1.2446873102610807, 1.423529411764706, 1.3333333333333333, 11.5, 1.0, 6.0, 1.0277777777777777, 1.0, 1.0, 1.0, 1.0, 6.0, 1.9811320754716981, 1.0, 4.5, 6.333333333333333, 1.0, 1.0, 1.059169855755078, 1.402873478962029, 1.875, 1.0, 1.016335506165083, 1.0, 6.0, 1.0, 1.0, 2.1818181818181817, 6.0, 1.5405405405405406, 1.0, 3.0, 2.5, 1.0864776189360206, 1.09375, 1.0, 4.0, 1.6, 1.0, 2.0, 6.0, 1.0, 1.1128668171557563, 1.9047619047619047, 2.6666666666666665, 5.0, 1.3333333333333333, 1.3636363636363635, 1.0, 1.1147058823529412, 2.437070938215103, 2.8, 2.0, 1.0909090909090908, 1.1505190311418685, 4.0, 1.0, 1.0388424495729602, 4.0, 1.7142857142857142, 1.0, 1.3333333333333333, 1.0, 1.0, 1.0, 1.5925925925925926, 1.6666666666666667, 2.1183053662523235, 1.368421052631579, 1.0, 1.1021671826625388, 1.0, 1.2, 1.2927374301675978, 1.0, 1.0, 2.75, 1.072314049586777, 1.3179723502304148, 1.040151885966864, 2.5, 3.6, 7.0, 1.0, 1.7272727272727273, 1.0, 1.0601503759398496, 5.0, 1.1215469613259668, 1.0, 1.0, 1.277511961722488, 1.097616345062429, 1.0, 1.0, 1.125, 1.0169362041770396, 1.3105095541401275, 2.2837837837837838, 6.0, 2.1818181818181817, 1.0, 3.0, 1.0, 1.0, 1.3269230769230769, 1.0, 2.0, 1.8333333333333333, 1.6666666666666667, 1.0, 1.0, 1.0, 1.0, 1.0, 2.5555555555555554, 1.0, 1.0, 1.0649515642369383, 3.5, 1.0, 1.0091683366733466, 3.0, 1.0, 1.0, 1.0, 1.0429629629629629, 1.5, 3.0, 2.0, 1.0, 1.8220338983050848, 1.45, 1.03, 2.814070351758794, 1.0, 1.3047833708990735, 1.9137931034482758, 1.0, 1.5263157894736843, 5.333333333333333, 1.625, 10.0, 6.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.037037037037037, 5.5, 20.25, 1.0833333333333333, 1.0, 7.0, 1.127659574468085, 1.9239543726235742, 1.0114490668503922, 2.3333333333333335, 1.054357805150786, 1.4516129032258065, 1.0417370325693607, 1.0, 1.0410094637223974, 6.0, 1.0812182741116751, 1.0, 1.7738095238095237, 1.0685958561422098, 1.0, 1.0253078328361906, 1.1088964637922512, 1.019443833003155, 1.0, 1.25, 1.0, 1.3155339805825244, 6.0, 2.0, 2.0, 1.6376638855780692, 6.0, 2.0, 1.0, 1.0, 1.5555555555555556, 1.2, 2.0, 1.0, 1.0, 17.0, 1.0, 1.000638569604087, 1.0, 1.0, 1.0, 1.0, 1.0029940839786446, 1.0, 2.3333333333333335, 2.5656237301909792, 1.0, 1.3333333333333333, 1.0, 1.0, 1.0311117338607543, 1.3333333333333333, 1.1044776119402986, 1.0, 1.0, 1.058704000975352, 1.1832826680276034, 1.0, 5.5, 2.0, 2.0, 1.0, 1.4102564102564104, 1.0077576112412179, 1.0, 3.339403973509934, 2.7142857142857144, 1.0, 1.0, 1.0199004975124377, 1.0789473684210527, 12.0, 1.0, 1.053517739025857, 1.0500339857835739, 1.4, 1.4753787878787878, 1.75, 1.0, 1.0, 1.0, 1.1506805478516875, 2.5, 1.0, 1.146282973621103, 5.0, 1.0, 1.2412060301507537, 1.0, 1.0, 1.1933333333333334, 3.0, 1.8, 5.543478260869565, 1.1435684647302904, 1.0, 5.0, 2.0, 1.0, 1.0, 1.019407161104578, 1.0, 1.0, 1.1179775280898876, 1.5495049504950495, 1.0, 1.0, 1.0, 1.0, 1.4736842105263157, 10.0, 1.2051063829787234, 1.0614115912650879, 1.0, 1.5, 1.1648626144879268, 1.0, 1.0, 1.0, 1.2866441658630665, 1.2702702702702702, 1.0, 5.0, 1.3957671957671958, 1.896678966789668, 1.64375, 2.0, 1.2188376400035277, 1.0, 2.0, 1.0487310379783499, 1.6666666666666667, 1.1638435478903604, 1.0, 1.0, 1.0, 1.102900436534587, 1.4444444444444444, 3.0, 1.0869565217391304, 1.0, 7.0, 9.0, 3.0588235294117645, 1.5, 1.255952380952381, 1.3079974942576738, 2.0, 2.0, 1.0, 1.1589310829817159, 5.0, 1.0, 1.1796875, 1.0, 1.149933915789835, 2.3056603773584907, 1.4, 1.0, 6.0, 1.0, 1.0, 1.0, 6.0, 1.0038535645472062, 1.7692307692307692, 3.3333333333333335, 7.0, 1.0, 1.1480019733596447, 1.0, 5.0, 5.0, 6.0, 1.404527559055118, 6.0, 1.0, 1.1592592592592592, 2.0, 1.0656305879654602, 1.0, 1.0, 1.1262886597938144, 1.0, 1.0, 1.0434782608695652, 9.0, 5.0, 1.0681818181818181, 1.1492087415222305, 1.25, 1.0, 1.25, 1.108695652173913, 1.0, 2.8461538461538463, 1.0, 1.1950078003120126, 1.0, 3.0, 1.047196821408747, 2.5, 1.0306303957799825, 1.628808864265928, 1.0, 3.0, 3.4, 1.0, 1.8888888888888888, 8.5, 5.0, 1.3568421052631578, 1.0, 1.0, 1.0, 1.1317991631799162, 2.6666666666666665, 3.1666666666666665, 1.9141427442717935, 1.0, 6.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.4210526315789473, 1.0037032465127762, 1.3982978723404256, 1.0, 1.0, 1.7878787878787878, 1.0, 6.0, 6.0, 1.0, 1.0, 1.0, 1.0, 1.010706084031439, 1.0, 6.0, 1.0418084589207584, 1.0, 1.0, 1.0, 3.0, 1.5, 1.0, 1.0, 1.0, 1.0, 1.8333333333333333, 3.466666666666667, 1.0991022099447514, 2.0, 6.0, 7.0, 1.0218669935224671, 1.0, 1.0, 1.0, 4.666666666666667, 1.040094522352212, 1.0, 1.0, 1.2307692307692308, 1.5975609756097562, 1.0, 1.0, 2.0, 1.0, 1.0, 1.1349819680577022, 1.0, 2.3333333333333335, 1.0326439578264395, 1.0, 1.0, 1.2044159544159545, 1.0, 1.0545646437994722, 1.0, 1.0, 2.1, 1.0574572127139363, 1.0, 1.0, 1.0, 1.1428571428571428, 1.0, 1.0458806028997976, 1.2493971881144044, 1.0, 6.0, 1.34375, 1.0, 3.5, 5.0, 1.0, 1.0, 1.0205854078960452, 1.0, 1.0, 2.032863849765258, 2.422222222222222, 1.3009708737864079, 3.3333333333333335, 1.3539823008849559, 1.0, 2.891566265060241, 1.5, 1.0, 1.0, 1.0, 1.290909090909091, 1.0, 1.0, 1.0, 1.0, 3.5, 1.0, 1.0031042004586386, 1.1111111111111112, 1.8241758241758241, 1.0, 2.0, 1.5, 2.538812785388128, 1.0, 6.0, 6.0, 1.1787564766839378, 1.0740574304588146, 1.0, 1.0, 9.444444444444445, 2.0, 1.0, 1.6666666666666667, 1.0, 1.0, 1.0, 1.2806324110671936, 1.0, 5.0, 5.0, 1.1322388059701494, 3.45, 1.0, 4.0, 1.1258278145695364, 1.1009786883746455, 1.0, 1.0, 1.1118624964778812, 1.143935581278309, 1.5794392523364487, 2.25, 6.0, 1.0, 1.9885057471264367, 1.4326923076923077, 2.0306096589674896, 1.0, 1.0, 9.0, 1.1984924623115578, 1.0, 9.0, 1.0, 1.0, 1.8333333333333333, 8.0, 1.0, 2.0, 1.0, 1.0662589194699286, 2.147727272727273, 1.4274833386226595, 1.0, 1.0, 3.0, 5.0, 1.0, 1.0, 1.0, 1.0, 3.0, 1.0, 2.0, 3.0, 1.4057971014492754, 2.0, 1.0787160736886514, 1.0, 1.0, 2.0, 1.0964341085271319, 3.0, 2.0, 1.0, 10.0, 1.0, 2.2857142857142856, 1.2446256486286138, 3.0, 1.0, 1.0, 1.0, 1.0, 6.0, 2.0303030303030303, 1.0, 1.0, 6.0, 1.0, 1.6038216560509555, 1.1732586629331467, 1.0, 1.0, 1.152542372881356, 1.4583333333333333, 2.0, 1.4020100502512562, 9.0, 1.0, 1.0, 1.0, 1.0, 2.0, 2.0, 1.0, 1.0986666666666667, 1.2591672581026734, 1.5, 1.0, 1.6175115207373272, 1.0, 1.017391304347826, 1.0, 8.0, 1.0, 1.0366419382101606, 9.0, 1.0, 1.0, 1.457811649428416, 1.1540260347649856, 1.0, 3.0, 6.0, 1.229050279329609, 1.0, 1.222096563723358, 1.8636363636363635, 1.0210033444816053, 1.1764705882352942, 1.2384881554431728, 1.0, 1.32574679943101, 1.5, 1.0, 1.0, 1.0, 2.0, 3.5, 6.0, 5.0, 2.0, 6.0, 1.0, 1.0, 1.0, 1.386111111111111, 3.0, 1.0, 7.0, 1.1061843640606768, 3.44, 1.0, 1.0, 1.1972789115646258, 4.0, 1.0, 1.0714285714285714, 1.0, 1.0, 1.0, 1.0, 1.8, 1.0, 1.3076923076923077, 1.5062857142857142, 5.0, 1.0, 10.0, 1.675257731958763, 1.0, 1.014482990906029, 1.0, 1.0, 1.0, 8.0, 1.5946843853820598, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0459761173130033, 2.0, 1.0, 1.0, 1.0, 1.0, 1.416, 1.0, 1.0, 2.5, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0352564102564104, 1.0088692283991374, 7.0, 1.2252249833544535, 2.6666666666666665, 1.0, 6.0, 1.1348837209302325, 1.0, 4.764705882352941, 1.074857142857143, 9.0, 1.0, 2.0, 1.5714285714285714, 1.6666666666666667, 6.0, 1.450214558940603, 3.0, 1.0, 1.0, 1.0, 1.0, 6.0, 1.0, 1.0, 10.0, 1.0, 6.0, 2.0, 6.0, 1.0, 1.0, 1.049204406364749, 1.4572490706319703, 1.0, 1.0, 2.1538461538461537, 1.0601851851851851, 1.0, 2.0, 1.298514093893469, 2.1538461538461537, 1.985611510791367, 1.0, 1.0, 1.0, 2.75, 1.4516129032258065, 1.0, 1.1395227097767513, 1.0, 1.0, 1.5704129067541701, 2.0, 2.832460732984293, 1.1114754098360655, 1.5, 2.0, 1.0976430976430978, 1.0, 1.25, 1.0, 1.0, 10.0, 5.0, 1.0, 2.0, 1.0513326752221126, 1.4, 1.0, 1.0, 4.5, 1.0580808080808082, 1.0, 1.6336088154269972, 1.5, 1.0, 5.0, 1.109433962264151, 1.0, 1.0, 1.4, 1.0752118644067796, 6.0, 2.8275862068965516, 1.0, 1.0690886597412204, 3.0, 1.5, 1.0, 1.0, 1.0, 2.0, 1.0, 1.44, 1.1666666666666667, 1.0, 1.0]
origin-forest_43.39 	max: 20.2500	99th: 10.0000	95th: 6.0000	median: 1.0889	mean: 1.9815

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 11/15 | Workload-time: 23.784157 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 12/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=naru', '--data_update=valueskew', '--dataset=forest', '--drift_test=distribution', '--end2end', '--update_size=25000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-forest-16.5MB-model62.533-data19.148-200epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
ValueSample - START
ValueSample - END
load_npy_dataset_from_path - df.shape = (731012, 10)
Parsing... done, took 0.1s
Data updated!
Previous data size: (706012, 10), new data size: (25000, 10)
[1.7881393e-07 0.0000000e+00 0.0000000e+00 1.1920929e-07 0.0000000e+00
 5.9604645e-08 5.9604645e-08 0.0000000e+00 3.8510561e-04 5.9604645e-08]
Distance score: 3.855824616039172e-05
SAUCE Drift detection: True
Detection latency: 0.0970s

DRIFT-DETECTED after 12-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=forest', '--end2end', '--model=naru', '--model_update=adapt', '--update_size=25000', '--epochs=40']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-forest-16.5MB-model62.533-data19.148-200epochs-seed0.pt
update_size: 25000
AdaptTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (731012, 10)
Parsing... done, took 0.1s
done, took 0.1s
dataset size: 731012
train data shape: torch.Size([25000, 10]), transfer data shape:torch.Size([5000, 10])
Epoch 0 Iter 0, train entropy gap 17.9635 bits (loss 36.884, data 18.920) 0.00400 lr
epoch 10 train loss 23.0688 nats / 33.2813 bits
time since start: 3.8 secs
Epoch 10 Iter 0, train entropy gap 14.3143 bits (loss 33.235, data 18.920) 0.00341 lr
epoch 20 train loss 22.1041 nats / 31.8895 bits
time since start: 7.7 secs
Epoch 20 Iter 0, train entropy gap 12.9773 bits (loss 31.898, data 18.920) 0.00200 lr
epoch 30 train loss 21.7317 nats / 31.3522 bits
time since start: 11.6 secs
Epoch 30 Iter 0, train entropy gap 12.4173 bits (loss 31.338, data 18.920) 0.00059 lr
epoch 40 train loss 21.6626 nats / 31.2525 bits
time since start: 15.5 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 40.7969 nats / 58.8574 bits
Saved to: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-forest-16.5MB-model62.533-data19.148-200epochs-seed0.pt
AdaptTask - END

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 12/15 | Workload-time: 2.289292 | Model-update-time: 19.358373


WORKLOAD-START | Type: QueryWorkload | Progress: 13/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=forest', '--model=naru', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-forest-16.5MB-model62.533-data19.148-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-forest-16.5MB-model62.533-data19.148-200epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
data size: 731012, total size: 731012, split index: [609176 731012]
Parsing... done, took 0.1s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-forest-16.5MB-model62.533-data19.148-200epochs-seed0.pt
query_seed:0
origin-forest_43.39 	max: 40.5000	99th: 11.0000	95th: 7.0000	median: 1.1077	mean: 2.2002
ReportEsts: [1.0, 1.1597471022128556, 2.0, 2.36, 2.0, 1.0, 1.1509054325955734, 1.0, 1.6389776357827477, 1.0, 1.2054794520547945, 1.2027027027027026, 1.0, 1.5, 6.090909090909091, 1.0392156862745099, 1.0, 6.0, 1.0327868852459017, 1.1421800947867298, 1.0, 6.0, 1.0, 1.0, 1.3661971830985915, 1.0, 5.0, 14.0, 7.0, 2.0, 1.0, 1.0, 1.0, 1.0, 2.0, 2.0, 1.0, 1.0315789473684212, 1.0, 4.0, 8.0, 1.0, 1.7, 1.0, 1.458966565349544, 1.2954545454545454, 1.0, 2.0, 1.0, 1.0, 3.0, 1.6613272311212814, 1.0, 1.0, 4.857142857142857, 1.4344262295081966, 2.1271676300578033, 2.9523809523809526, 1.0, 6.0, 1.0387328300952852, 1.3888888888888888, 6.0, 1.0, 2.1785714285714284, 2.236111111111111, 11.0, 1.0, 2.2115384615384617, 1.0, 5.666666666666667, 1.3632075471698113, 1.0843642145266994, 1.627906976744186, 1.0, 1.1059602649006623, 1.0, 1.0, 1.0, 1.0, 7.0, 1.4782608695652173, 1.0, 1.0091278711073801, 1.4, 1.0307617425164273, 6.0, 1.0714285714285714, 1.34375, 1.0, 1.0, 1.4306375638559012, 1.0, 1.0, 1.0173684786175217, 1.0, 1.3417332513829134, 1.0, 7.0, 1.1428571428571428, 1.221359223300971, 6.0, 1.978494623655914, 1.0, 2.0, 1.0, 1.1724137931034482, 1.064516129032258, 1.5664095972579264, 1.0, 1.2567567567567568, 1.08, 1.0, 5.0, 1.3333333333333333, 1.0, 2.0, 1.0, 1.0, 1.0, 4.333333333333333, 1.0, 1.0, 3.4444444444444446, 1.7037037037037037, 2.4375, 20.0, 1.4489795918367347, 4.0, 6.0, 1.1978196684079037, 1.0, 1.0, 1.0, 1.282770393854408, 1.3, 4.5, 1.603530534351145, 1.0, 3.61, 4.0, 1.0, 3.8333333333333335, 1.9333333333333333, 1.0, 1.0, 1.1245828698553948, 1.0113969943918681, 1.0, 1.0, 1.7586206896551724, 2.0, 1.0, 1.0, 1.0388349514563107, 1.313929313929314, 1.0, 1.0, 1.82, 1.0, 1.0, 1.0, 1.0, 1.0, 1.8203821656050956, 7.0, 1.0, 1.0, 1.0, 2.0848056537102475, 2.0, 1.0, 3.0, 1.1666666666666667, 1.0, 1.0, 1.8670886075949367, 1.0, 1.1948603728382121, 1.038892551087673, 1.0, 1.0138023362151052, 1.9409594095940959, 1.952108649035025, 1.0, 7.5, 1.0, 1.0, 1.0, 3.0, 1.0, 1.1148798112372806, 1.0, 1.0, 1.9387755102040816, 1.271031687905864, 1.0, 1.2205128205128206, 1.0028797289666855, 2.0, 2.3496503496503496, 1.1112618724559022, 1.1032590051457976, 1.0, 1.0, 4.0, 1.0, 6.0, 1.0, 1.0, 1.0, 6.0, 1.4876632801161103, 1.3515625, 1.0625, 3.8333333333333335, 1.0, 7.0, 1.236842105263158, 1.0, 1.0, 1.0, 1.0, 7.0, 2.246153846153846, 1.0, 1.7272727272727273, 6.666666666666667, 1.0, 1.0, 1.0806114698063045, 1.3841634023503078, 1.4545454545454546, 1.0, 1.0128457004684903, 1.0, 7.0, 1.0, 1.0, 2.2, 7.0, 1.6724137931034482, 1.0, 2.0, 2.0, 1.14214463840399, 1.2152777777777777, 1.0, 2.0, 2.25, 1.0, 2.0, 7.0, 1.0, 1.0097932535364527, 1.8979591836734695, 3.5714285714285716, 6.0, 2.5757575757575757, 1.109375, 1.0, 1.2470588235294118, 1.3435455428337764, 2.0, 2.0, 1.0724637681159421, 1.2245901639344263, 4.0, 1.0, 1.067220610217181, 3.0, 1.0666666666666667, 1.0, 1.5, 1.0, 1.0, 1.0, 2.588235294117647, 1.6666666666666667, 1.7893247559991599, 1.2258064516129032, 1.0, 1.2625368731563422, 1.0, 1.0731707317073171, 1.4172972972972973, 1.4, 1.0, 4.0, 1.4134078212290502, 1.12271776340814, 1.0505566327134366, 1.5, 2.375, 9.0, 1.0, 1.766398158803222, 1.0, 1.4860335195530727, 5.0, 1.2127659574468086, 1.0, 1.0, 1.018181818181818, 1.1235955056179776, 1.0, 1.0, 1.2857142857142858, 1.0161120982070748, 1.118740320082602, 2.289473684210526, 7.0, 1.6, 1.0, 3.0, 1.0, 1.0, 1.0588235294117647, 2.0, 2.0, 1.75, 3.0, 1.0, 1.0, 1.0, 1.0, 1.0, 3.4285714285714284, 1.0, 1.0, 1.0658360252268881, 2.5, 1.0, 1.0363575236540032, 3.0, 1.0, 1.0, 1.0, 1.1578044596912522, 2.0, 3.0, 1.8, 1.0, 1.2215909090909092, 1.25, 1.6825396825396826, 2.175609756097561, 2.0, 1.166330870830535, 2.775, 1.0, 1.5365853658536586, 2.111111111111111, 1.5, 10.0, 7.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.5, 11.0, 40.5, 2.6666666666666665, 1.0, 8.0, 1.9404761904761905, 2.1350210970464136, 1.0072156473857958, 1.6, 1.0293261414762631, 1.7843137254901962, 1.1514098107377366, 1.3, 1.130718954248366, 7.0, 1.471830985915493, 1.0, 1.125, 1.122490473753057, 1.0, 1.0317284418652124, 1.0233546140452698, 1.027529495888452, 1.0, 1.2, 1.0, 1.0808080808080809, 7.0, 2.0, 2.0, 1.0307125307125307, 7.0, 8.0, 2.0, 1.0, 1.5849056603773586, 1.1666666666666667, 8.0, 1.0, 1.0, 3.4, 1.0, 1.1507430997876857, 1.0, 1.0, 1.0, 1.0, 1.0041141771066324, 7.0, 1.0, 2.698314837648993, 1.0, 1.2, 1.0, 1.0, 1.0270015438334732, 2.1666666666666665, 2.027027027027027, 1.0, 1.0, 1.0832078086401158, 1.208404390222572, 1.0, 2.75, 7.0, 2.0, 1.0, 1.375, 1.011298502181861, 1.0, 2.595881595881596, 4.470588235294118, 1.0, 1.0, 1.1767955801104972, 1.625, 15.0, 1.0, 1.0136195195675235, 1.0403353351692712, 1.4, 4.3, 1.4736842105263157, 1.0, 1.0, 1.0, 1.1796919682980636, 2.0, 1.0, 1.2401486988847583, 7.0, 1.0, 1.1607142857142858, 1.0, 1.0, 1.413533834586466, 3.0, 1.2608695652173914, 5.3125, 1.2506596306068603, 1.0, 6.0, 2.0, 1.0, 1.0, 1.0205168363351604, 1.0, 1.0, 1.032032032032032, 1.0454545454545454, 1.0, 1.0, 1.0, 1.0, 1.1466666666666667, 13.0, 1.2320744389709908, 1.0351432545201669, 1.0, 3.0, 1.1029173419773095, 1.0, 1.0, 1.0, 1.1245344506517692, 1.6666666666666667, 1.0, 6.0, 1.2100917431192661, 1.794701986754967, 1.6127744510978044, 1.0, 1.1441728598030498, 2.0, 2.0, 1.0633410919574182, 2.5, 1.016934046345811, 1.0, 1.0, 1.0, 1.1588416949324154, 1.6470588235294117, 4.0, 1.3888888888888888, 1.0, 8.0, 11.0, 1.9259259259259258, 1.0, 1.0089285714285714, 1.2476482109851306, 2.0, 1.0, 1.0, 1.071764705882353, 6.0, 10.0, 1.2884615384615385, 1.0, 1.1446875257987286, 1.931159420289855, 1.12, 1.0, 7.0, 1.0, 1.0, 1.0, 8.0, 1.6137724550898203, 1.5333333333333334, 2.5, 8.0, 1.0, 1.0835969272480794, 1.0, 10.0, 1.0679012345679013, 7.0, 1.3274418604651164, 7.0, 1.0, 1.4859154929577465, 2.0, 1.0506891660312072, 1.0, 1.0, 1.0067519545131485, 1.0, 1.0, 1.1712328767123288, 11.0, 6.0, 1.1666666666666667, 1.411190053285968, 1.2, 2.0, 2.0, 1.1886792452830188, 1.0, 1.5944055944055944, 1.0, 1.075839653304442, 1.0, 4.0, 1.038640323342903, 1.2, 1.0331704999331839, 1.6289156626506025, 1.0, 1.5, 1.043103448275862, 1.0, 1.3148148148148149, 3.4, 6.0, 1.4003259098316132, 1.0, 1.0, 1.0, 1.0263157894736843, 1.75, 1.5357142857142858, 1.5450121654501217, 1.0, 7.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 1.5, 1.0296578148408395, 1.29765625, 1.0, 1.0, 1.6444444444444444, 1.0, 7.0, 7.0, 1.0, 1.0, 1.0, 1.0, 1.0675903915926435, 1.0, 7.0, 1.024909420289855, 1.0, 1.0, 1.0, 8.5, 1.0, 1.0, 1.0, 1.0, 1.0, 2.75, 2.076923076923077, 1.007059545733579, 1.0, 7.0, 9.0, 1.029826262023712, 1.0, 1.0, 1.0, 5.25, 1.1486097556941297, 1.0, 2.0, 2.3846153846153846, 1.0137221269296741, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0488245205809195, 1.0, 8.0, 1.0769084694265096, 1.0, 1.0, 1.244418052256532, 1.0, 1.0356349793803532, 1.0, 1.0, 2.75, 1.0390355912743972, 1.0, 1.0, 1.0, 1.125, 1.0, 1.0537504111343847, 1.2300174643216257, 1.0, 7.0, 4.571428571428571, 1.0, 3.5, 1.25, 1.0, 1.0, 1.0663971128784335, 1.0, 1.0, 1.159178433889602, 5.7368421052631575, 1.9428571428571428, 5.5, 1.1640058055152396, 1.0, 1.3522267206477734, 3.0, 1.0, 1.0, 1.0, 1.1333333333333333, 1.0, 1.0, 1.0, 1.0, 1.2, 1.0, 1.0161294183219522, 1.055045871559633, 1.3373493975903614, 1.0, 2.0, 1.0, 2.9732620320855614, 1.0, 3.5, 7.0, 1.0034100596760442, 1.0116982984293195, 1.0, 1.0, 8.3, 2.0, 1.0, 2.263157894736842, 1.0, 1.0, 1.0, 1.196969696969697, 1.0, 6.0, 6.0, 1.1167820069204153, 1.5869565217391304, 1.0, 4.0, 1.0280898876404494, 1.0269565601661585, 1.0, 7.0, 1.048470012239902, 1.2032046613255645, 1.0738636363636365, 2.25, 9.0, 1.0, 1.3993174061433447, 1.0192307692307692, 1.93978085527317, 7.0, 1.0, 7.0, 1.3844282238442822, 1.0, 7.714285714285714, 1.0, 1.0, 1.0909090909090908, 10.0, 1.3333333333333333, 2.0, 1.0, 1.0712913953815166, 4.454545454545454, 1.218586387434555, 1.0, 1.0, 3.0, 6.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 2.0, 3.0, 1.4325842696629214, 1.0, 1.0093198992443324, 9.0, 1.0, 1.0, 4.604206500956023, 1.0, 2.0, 1.0, 1.0762675756284619, 1.414969079665333, 1.279381443298969, 1.0, 6.0, 15.5, 1.0, 1.0, 1.0, 3.5, 1.5365853658536586, 1.0, 1.0, 7.0, 1.0, 1.6327044025157234, 1.1115632417768735, 17.0, 1.0, 1.221698113207547, 1.1176470588235294, 2.0, 1.6292682926829267, 11.0, 1.0, 1.0, 1.0, 1.0, 3.2, 1.0, 7.0, 1.1253263707571801, 1.205643779275677, 1.2, 1.0, 1.41875, 1.0, 1.0564516129032258, 1.0, 4.5, 1.0, 1.1784531838486467, 3.0, 1.0, 1.0, 1.0981400870597546, 1.025113545284531, 1.0, 3.0, 7.0, 1.0842767295597484, 1.0, 1.219834850016852, 2.9318181818181817, 1.0608873720136518, 1.534351145038168, 1.3064108563406645, 1.0, 1.3104395604395604, 1.0, 1.0, 1.0, 1.0, 1.0, 2.8, 7.0, 5.0, 2.0, 7.0, 1.0, 1.0, 1.0, 1.2424242424242424, 3.0, 1.0, 7.0, 1.1667655786350148, 1.78, 1.0, 1.0, 1.5724409448818897, 10.0, 1.0, 1.6666666666666667, 1.0, 1.0, 1.0, 1.0577354260089686, 1.5, 1.0, 2.7142857142857144, 2.168831168831169, 6.0, 1.0, 5.0, 2.2260273972602738, 1.0, 1.1137178233952427, 1.0, 1.0, 1.0, 10.0, 1.643835616438356, 1.0, 1.0, 1.0, 1.0, 3.75, 6.0, 7.0, 1.0, 1.0, 1.0, 5.25, 1.0, 1.0, 1.2941176470588236, 1.0, 2.6013071895424837, 3.0, 1.011764705882353, 1.0, 1.3848101265822785, 1.0, 1.0, 5.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.1634615384615385, 1.3916417068194644, 11.0, 1.1712754576832247, 1.6, 1.0, 7.0, 1.0889522000633112, 1.0, 2.245222929936306, 1.1685714285714286, 11.0, 1.0, 1.0714285714285714, 1.1363636363636365, 1.0, 7.0, 1.3852083803256068, 3.0, 1.4, 1.125, 1.0, 10.0, 1.0, 1.0, 5.0, 1.0, 12.0, 1.0, 6.0, 2.0, 7.0, 1.0, 7.0, 1.013494967978042, 1.439068100358423, 1.0, 1.0, 2.3846153846153846, 1.5400696864111498, 1.0, 2.0, 1.4358862383317867, 4.2, 1.6666666666666667, 1.169811320754717, 1.0, 4.0, 1.0, 4.4, 1.0, 1.117891816920943, 2.0, 1.0, 4.0, 1.1266666666666667, 1.020979020979021, 1.7878787878787878, 1.02, 2.0, 1.0514095174671363, 1.0, 1.0413961392653275, 1.0316166838378236, 7.0, 1.0605980557903636, 7.0, 2.888888888888889, 2.0, 1.0, 1.7337623165091494, 2.0, 14.0, 1.0, 1.4981412639405205, 1.0, 1.1430984555984556, 3.0, 1.0, 6.0, 1.3580246913580247, 1.0, 1.0, 1.75, 1.0291881285258768, 7.0, 1.3666666666666667, 3.9166666666666665, 1.0179604261796042, 1.5, 1.0232162693326496, 1.0, 1.0, 1.0, 1.0]
origin-forest_43.39 	max: 40.5000	99th: 11.0000	95th: 7.0000	median: 1.1077	mean: 2.2002

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 13/15 | Workload-time: 23.981953 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 14/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=naru', '--data_update=valueskew', '--dataset=forest', '--drift_test=distribution', '--end2end', '--update_size=25000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-forest-16.5MB-model62.533-data19.148-200epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
ValueSample - START
ValueSample - END
load_npy_dataset_from_path - df.shape = (756012, 10)
Parsing... done, took 0.1s
Data updated!
Previous data size: (731012, 10), new data size: (25000, 10)
[ 5.9604645e-08  0.0000000e+00  0.0000000e+00  5.9604645e-08
  5.9604645e-08  5.9604645e-08 -5.9604645e-08  0.0000000e+00
  2.5105476e-04  5.9604645e-08]
Distance score: 2.5129318601102568e-05
SAUCE Drift detection: True
Detection latency: 0.0994s

DRIFT-DETECTED after 14-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=forest', '--end2end', '--model=naru', '--model_update=adapt', '--update_size=25000', '--epochs=40']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-forest-16.5MB-model62.533-data19.148-200epochs-seed0.pt
update_size: 25000
AdaptTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (756012, 10)
Parsing... done, took 0.1s
done, took 0.1s
dataset size: 756012
train data shape: torch.Size([25000, 10]), transfer data shape:torch.Size([5000, 10])
Epoch 0 Iter 0, train entropy gap 17.8445 bits (loss 36.686, data 18.842) 0.00400 lr
epoch 10 train loss 23.0060 nats / 33.1907 bits
time since start: 3.8 secs
Epoch 10 Iter 0, train entropy gap 14.3617 bits (loss 33.203, data 18.842) 0.00341 lr
epoch 20 train loss 22.0693 nats / 31.8393 bits
time since start: 7.7 secs
Epoch 20 Iter 0, train entropy gap 12.9367 bits (loss 31.778, data 18.842) 0.00200 lr
epoch 30 train loss 21.7033 nats / 31.3113 bits
time since start: 11.6 secs
Epoch 30 Iter 0, train entropy gap 12.4540 bits (loss 31.296, data 18.842) 0.00059 lr
epoch 40 train loss 21.6292 nats / 31.2043 bits
time since start: 15.5 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 40.3948 nats / 58.2774 bits
Saved to: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-forest-16.5MB-model62.533-data19.148-200epochs-seed0.pt
AdaptTask - END

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 14/15 | Workload-time: 2.302491 | Model-update-time: 19.402064


WORKLOAD-START | Type: QueryWorkload | Progress: 15/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=forest', '--model=naru', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/naru/origin-forest-16.5MB-model62.533-data19.148-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/naru/origin-forest-16.5MB-model62.533-data19.148-200epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
data size: 756012, total size: 756012, split index: [630010 756012]
Parsing... done, took 0.1s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/naru/origin-forest-16.5MB-model62.533-data19.148-200epochs-seed0.pt
query_seed:0
origin-forest_43.39 	max: 24.0000	99th: 15.0100	95th: 8.0000	median: 1.1233	mean: 2.3415
ReportEsts: [1.0, 1.0347778587035688, 1.0, 2.0344827586206895, 1.1428571428571428, 1.0, 1.0082644628099173, 1.0, 1.0939226519337018, 1.0, 1.1081081081081081, 1.3773584905660377, 1.0, 2.0, 8.933333333333334, 1.2380952380952381, 1.0, 7.0, 1.032258064516129, 3.418918918918919, 1.0, 4.0, 1.0, 1.0, 1.2339901477832513, 1.0, 5.0, 16.0, 8.0, 1.3611111111111112, 2.6666666666666665, 1.0, 1.0, 1.0, 2.0, 2.0, 1.0, 1.0454545454545454, 1.0, 3.25, 9.0, 1.0, 1.8888888888888888, 1.0, 1.0164383561643835, 1.3990384615384615, 1.0, 2.0, 1.0, 1.0, 3.0, 1.0913750835747715, 1.0, 1.0, 2.469178082191781, 3.5, 1.0180150585075771, 5.0, 8.0, 7.0, 1.1865068677619175, 2.857142857142857, 8.0, 1.0, 1.6818181818181819, 1.972972972972973, 13.0, 1.0, 2.480769230769231, 1.0, 20.0, 1.0327102803738317, 1.032982543908235, 1.1931818181818181, 1.0, 1.1132686084142396, 8.0, 1.0, 1.0, 1.0, 8.0, 1.1470588235294117, 1.0, 1.0107941516570957, 1.2, 1.0673806445317264, 7.0, 1.40625, 1.2647058823529411, 1.0, 1.0, 1.5482634589303614, 1.0, 1.0, 1.063142794085191, 1.0, 1.0331959706959708, 7.0, 1.2864321608040201, 22.0, 1.4266666666666667, 1.0, 4.8, 2.0, 1.0, 1.2260869565217392, 1.1666666666666667, 1.1035676251331203, 2.5, 1.0651432053625838, 1.0, 1.5806451612903225, 1.1, 1.0, 5.25, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 1.8571428571428572, 1.0, 1.0, 3.4, 1.7702265372168284, 1.7391304347826086, 21.0, 1.543859649122807, 2.0, 6.0, 1.3082109318564892, 1.0, 1.0, 1.0, 1.2508045977011495, 1.1, 10.0, 1.58, 1.0, 4.548780487804878, 1.1764705882352942, 1.0, 3.25, 1.8125, 1.0, 1.0, 2.40258064516129, 1.0107611200890136, 8.0, 1.0, 2.0, 1.0105756851204708, 1.0, 1.0, 4.5, 1.4827586206896552, 8.0, 1.0, 1.0, 4.0, 1.0, 1.0, 1.0, 2.3333333333333335, 2.425806451612903, 1.0, 1.195458422802012, 1.6363636363636365, 1.028238096906422, 13.0, 1.3333333333333333, 4.0, 1.1594746716697937, 1.0, 1.0, 1.8277777777777777, 1.0, 1.237705633161104, 1.0392694063926942, 1.0, 1.0202623723205295, 1.7859424920127795, 1.7943495400788436, 1.0, 1.0625, 1.0, 1.0, 1.0, 3.0, 1.0, 1.114656031904287, 1.0, 1.0, 2.017857142857143, 1.2651786690643112, 1.0, 1.2795698924731183, 1.0139151853826216, 2.0, 1.7945205479452055, 1.0767263427109974, 1.3213093913872558, 1.0, 1.0, 4.0, 1.0, 9.0, 1.0, 1.0, 1.0, 7.0, 1.3504611330698286, 1.362962962962963, 1.1875, 5.75, 1.0, 8.0, 1.1111111111111112, 1.0, 1.0, 1.0, 1.0, 8.0, 1.7179487179487178, 1.0, 2.75, 7.0, 1.0, 1.0, 1.0407431251724455, 1.4469139297848244, 1.2647058823529411, 1.0, 1.018149753839371, 1.0, 8.0, 1.0, 1.0, 1.2222222222222223, 8.0, 3.1052631578947367, 1.0, 4.0, 1.5, 1.076568450591301, 1.0777027027027026, 1.0, 4.0, 3.3333333333333335, 1.0, 2.0, 8.0, 1.0, 1.1031286210892237, 2.6607142857142856, 4.833333333333333, 7.0, 1.875, 1.4829931972789117, 1.0, 1.0365853658536586, 1.2775631535798333, 2.8, 2.0, 1.0799289520426287, 1.3462732919254659, 4.0, 1.0, 1.1189999574087481, 3.3333333333333335, 1.2222222222222223, 1.0, 1.0, 1.0, 1.0, 1.0, 3.75, 2.0, 1.8156001370436636, 1.25, 1.0, 1.0084985835694051, 1.0, 1.0337078651685394, 1.3518324607329844, 1.7777777777777777, 1.0, 3.25, 1.2137931034482758, 1.1166514181152791, 1.0213718830837455, 2.5, 1.0526315789473684, 11.0, 1.0, 1.7054085155350978, 1.0, 1.0725806451612903, 5.0, 1.095505617977528, 1.0, 1.0, 1.0856164383561644, 1.2962962962962963, 1.0, 1.0, 1.1666666666666667, 1.004596925916723, 1.0236747297992794, 1.289855072463768, 8.0, 2.4, 1.0, 1.5, 1.0, 1.0, 1.12, 2.0, 1.0, 1.1666666666666667, 3.5, 1.0, 1.0, 1.0, 1.0, 1.0, 1.3157894736842106, 1.0, 1.0, 1.0071830985915493, 3.0, 1.0, 1.0692590353039677, 3.0, 1.0, 1.0, 1.0, 1.0250569476082005, 2.0, 3.0, 1.6470588235294117, 1.0, 1.2285714285714286, 1.85, 1.5352112676056338, 1.4880382775119618, 1.0, 1.4262250205310703, 1.072072072072072, 1.0, 1.0895522388059702, 4.4, 2.375, 5.0, 8.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0472972972972974, 5.5, 2.793103448275862, 1.2741935483870968, 1.0, 9.0, 1.815217391304348, 1.5714285714285714, 1.0005112442169444, 2.3684210526315788, 1.0163550358324704, 2.0652173913043477, 1.0662774353984215, 2.1666666666666665, 1.448, 8.0, 1.249266862170088, 1.0, 1.1602564102564104, 1.1358107039464185, 1.0, 1.0276381201191607, 1.0745765111121597, 1.0069192415968524, 1.0, 1.6, 1.0, 1.445945945945946, 8.0, 2.0, 2.0, 1.100119189511323, 8.0, 5.0, 1.5, 1.0, 1.0909090909090908, 1.2, 1.7, 1.0, 1.0, 8.0, 1.0, 1.0, 1.0, 1.736842105263158, 8.0, 1.0, 1.0, 1.0, 1.7735849056603774, 1.0, 1.153467029231815, 1.5, 1.0, 1.5, 1.0, 1.0126502307445522, 2.8, 1.6842105263157894, 1.0, 1.0, 1.0876019194007724, 1.2057410217501265, 1.0, 2.2, 4.5, 2.0, 1.0, 1.6, 1.0531377735032459, 1.0, 3.0014880952380953, 2.7142857142857144, 1.0, 1.0, 1.04739336492891, 1.6666666666666667, 18.0, 1.0, 1.0014165500261387, 1.0266787176351746, 2.0, 2.0, 2.3333333333333335, 1.0, 1.0, 1.0, 1.1757283645839456, 2.0, 1.0, 2.141206675224647, 8.0, 1.0, 1.5657142857142856, 1.0, 1.0, 1.132183908045977, 2.6666666666666665, 1.0689655172413792, 5.795454545454546, 1.2770034843205575, 1.0, 7.0, 1.0, 1.0, 1.0, 1.0151010966547036, 1.0, 1.0, 1.0384254920337395, 2.1842105263157894, 8.0, 1.0, 1.5714285714285714, 1.0, 1.0, 1.0, 1.0666666666666667, 1.202253112853284, 1.1249969011081637, 1.61328125, 1.0054407733797046, 1.0, 1.0, 2.0, 1.434782608695652, 1.0, 1.0005094676063513, 2.9655172413793105, 1.5, 2.0, 1.7039800995024876, 2.5714285714285716, 1.0, 1.4883551673944686, 1.0, 1.028590831918506, 1.0, 5.5, 1.0, 1.0, 1.0, 1.090741030556751, 1.6243386243386244, 4.0, 1.72, 1.0, 4.5, 13.0, 1.4857142857142858, 2.6666666666666665, 1.1261682242990654, 1.2621675736728617, 2.0, 2.0, 1.0, 1.0554885404101326, 7.0, 10.0, 1.39, 1.0, 1.1468324452338663, 1.31651376146789, 1.48, 1.0, 8.0, 1.0, 1.0, 7.0, 1.076111111111111, 1.2232566800111722, 8.666666666666666, 1.8656716417910448, 1.0, 1.0, 4.0, 4.615384615384615, 1.0, 1.0, 1.0, 1.1114503816793893, 1.0, 1.0, 2.0, 1.0177446841176019, 1.2991452991452992, 1.520979020979021, 2.409090909090909, 2.1219512195121952, 1.0, 4.3, 1.100653594771242, 8.0, 2.1666666666666665, 1.4565217391304348, 1.2009685230024214, 1.2, 1.0, 1.1428571428571428, 1.1549295774647887, 1.0, 1.3276836158192091, 1.0, 1.2721636701797892, 1.0, 3.0, 1.0022623815838039, 2.5, 1.0725311747650246, 1.605543710021322, 1.0, 1.5, 1.2439024390243902, 1.0, 2.1296296296296298, 8.5, 7.0, 1.258174719375305, 1.0, 1.0, 1.0, 1.1431372549019607, 4.166666666666667, 3.0, 1.4977435125987213, 1.0, 8.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.5877862595419847, 1.0265166579004759, 1.0620938628158845, 1.0, 1.0, 8.0, 2.7333333333333334, 4.5, 18.0, 1.8982035928143712, 1.2666666666666666, 1.4285714285714286, 1.0, 1.0, 1.008121393460141, 1.0, 8.0, 1.0508189836203277, 1.0, 1.0, 1.0, 4.5, 1.5, 1.7384615384615385, 1.0, 1.0, 1.0, 1.8333333333333333, 2.22, 1.001185536455246, 2.0, 8.0, 11.0, 1.0431988575508746, 1.0, 10.0, 1.0, 4.2, 1.0830201777818023, 1.0, 1.0, 1.7692307692307692, 1.28, 1.0, 12.0, 1.0, 1.0, 1.0, 1.0607326359368647, 1.0, 9.0, 1.0235467255334805, 1.0, 1.0, 1.0310880829015545, 1.0, 1.1318203198494825, 1.0, 1.0, 1.6428571428571428, 1.1216056670602126, 1.0, 1.0, 1.0, 1.3333333333333333, 1.0, 1.0604482983745418, 1.2544543429844097, 1.0, 8.0, 10.666666666666666, 1.0, 3.5, 2.5, 1.0, 1.0, 1.0300801097222656, 1.0, 1.0, 1.4520123839009287, 3.5161290322580645, 1.4081632653061225, 1.5, 1.0742637644046096, 1.0, 1.78397212543554, 1.5, 1.0, 1.0, 1.0, 1.2769230769230768, 1.0, 1.0, 1.0, 1.0, 2.6666666666666665, 1.0, 1.025074951394146, 1.0739644970414202, 1.5514018691588785, 1.0, 2.0, 2.0, 3.177142857142857, 1.0, 4.0, 8.0, 1.0825932504440496, 1.0529610411004036, 1.0, 1.0, 8.181818181818182, 2.0, 1.0, 2.3, 1.0, 1.0, 1.0, 1.0534351145038168, 1.0, 7.0, 7.0, 1.009861932938856, 1.925, 1.0, 4.0, 1.3191489361702127, 1.0058064516129033, 1.0, 8.0, 1.1249334043686734, 15.0, 2.2, 1.0, 1.4661835748792271, 3.1121495327102804, 1.0, 1.0248300917228423, 1.0, 1.0, 3.0, 1.5, 1.3333333333333333, 1.1501070009171508, 1.0, 2.0, 1.375, 1.0670045045045045, 4.0, 1.0, 1.0916666666666666, 7.0, 1.0, 2.5, 1.0, 1.0, 1.0, 1.0106951871657754, 8.0, 1.0, 4.142657342657342, 1.0, 1.2, 5.333333333333333, 1.0, 1.0, 3.3333333333333335, 1.4880750512013037, 1.0, 1.55, 1.2222222222222223, 1.0, 1.2926829268292683, 1.0, 1.5466666666666666, 3.5628571428571427, 1.0, 1.0, 1.3636363636363635, 1.0929795236105306, 1.3415305101700568, 1.3521825396825398, 1.0, 7.0, 19.0, 1.0, 1.0, 1.0, 8.0, 1.26, 10.0, 1.0, 8.0, 1.0, 1.4580152671755726, 1.1645278051990786, 21.0, 1.0, 1.100502512562814, 1.3225806451612903, 2.0, 1.2701421800947867, 13.0, 1.0, 1.0, 1.0, 1.0, 1.7777777777777777, 2.0, 8.0, 1.434782608695652, 1.1304972375690607, 1.0, 1.0, 2.9625, 1.0, 1.095890410958904, 1.0, 3.3333333333333335, 1.0, 1.100268676766923, 6.0, 1.0, 1.0, 1.1829419035846724, 1.2095129375951295, 1.0, 3.0, 8.0, 1.1102985984156002, 1.0, 1.1652365775925473, 2.0454545454545454, 1.1499643620812545, 1.3493975903614457, 1.3617208077260754, 1.0, 1.2217795484727756, 3.0, 1.0, 1.0, 1.0, 2.0, 2.8, 8.0, 5.0, 1.0, 8.0, 1.0, 1.0, 1.0, 1.3789020452099032, 3.0, 1.0, 7.0, 1.156833824975418, 2.1904761904761907, 1.0, 1.0, 1.1019210245464248, 3.0, 1.0, 1.0714285714285714, 1.0, 1.0, 1.0, 1.0216016859852477, 1.2857142857142858, 1.0, 1.1666666666666667, 1.8414634146341464, 7.0, 1.0, 5.0, 2.462121212121212, 4.0, 1.1622558286074354, 1.0, 1.0, 15.0, 1.0891569512770403, 1.0, 1.5, 1.0, 4.0, 2.8333333333333335, 1.3879274824886692, 1.0, 1.0, 2.3076923076923075, 1.0, 1.0, 1.1830985915492958, 1.0, 1.0, 1.0, 1.0, 2.404494382022472, 3.0, 1.7551020408163265, 1.0, 1.1954022988505748, 1.0, 1.0, 5.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.1121794871794872, 1.2920782935559072, 12.0, 1.2158730158730158, 24.0, 7.0, 1.2894736842105263, 2.3010752688172045, 2.4, 10.0, 1.5, 1.0, 1.3443983402489628, 1.0, 1.75, 1.0, 1.0, 1.377159523432327, 3.0, 1.1176470588235294, 1.2463768115942029, 1.0, 12.0, 1.0, 1.0, 4.2, 1.0, 14.0, 1.0, 6.0, 2.0, 8.0, 1.0, 8.0, 1.0890905115872322, 1.4173913043478261, 1.0, 1.0, 3.090909090909091, 1.1271820448877805, 1.0, 2.0, 1.1902262443438913, 3.8333333333333335, 1.6666666666666667, 1.6097560975609757, 1.0, 4.0, 1.0, 6.25, 1.0, 1.1735313977042539, 2.0, 1.0, 1.5, 1.32, 1.16, 1.4242424242424243, 1.1521739130434783, 2.0, 1.0182510883775515, 1.0, 1.0831864675475802, 1.0395331749602188, 8.0, 1.0624793164017752, 8.0, 2.8, 2.0, 1.0, 1.427719821162444, 2.0, 16.0, 1.0, 1.3556338028169015, 1.0, 1.1725663716814159, 1.5, 1.0, 7.0, 1.168421052631579, 1.0, 6.0, 2.0, 1.076865671641791, 8.0, 12.0, 1.462686567164179, 1.0517188926072407, 3.0, 1.0211763735357202]
origin-forest_43.39 	max: 24.0000	99th: 15.0100	95th: 8.0000	median: 1.1233	mean: 2.3415

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 15/15 | Workload-time: 23.971235 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=7, #drift=7 | total-time=340.041728