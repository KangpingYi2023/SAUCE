Input arguments = Namespace(data_update='sample', update_size=80000, dataset='bjaq', debug=False, drift_test='js', model_update='adapt', model='face', end2end=False, query_seed=0, random_seed=42, num_workload=3)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-3'}, 'random_seed': 29, 'face': {'learning_rate': '1e-4', 'epochs': 0, 'factor': 'auto'}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/face/bjaq-id2-best-val.t
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/bjaq/end2end/bjaq.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/FACE/evaluate/Evaluate-FACE-end2end.py', '--dataset=bjaq', '--end2end']
/home/kangping/anaconda3/envs/LndCar/lib/python3.9/site-packages/torchquad/integration/vegas_map.py:314: UserWarning: torch.searchsorted(): input value tensor is non-contiguous, this will lower the performance due to extra data copy when converting non-contiguous tensor to contiguous, please use contiguous input value tensor if possible. This message will only appear once per program. (Triggered internally at /opt/conda/conda-bld/pytorch_1682343997789/work/aten/src/ATen/native/BucketizationUtils.h:33.)
  iy = torch.searchsorted(self.x_edges[d, :], x[:, d], side='right')
DEVICE NAME
 Tesla V100S-PCIE-32GB
GET-MODEL-PATH=./models/end2end/face/bjaq-id2-best-val.t
Load model - START
Load model from: /home/kangping/code_copy/SAUCE/models/end2end/face/bjaq-id2-best-val.t
There are 104179 trainable parameters in this model.
Parameters total size is 0.3974113464355469 MB
Load model - END
There are 104179 trainable parameters in this model.
Parameters total size is 0.3974113464355469 MB
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
data shape: (382168, 5)
Save oracle results to :
./FACE/evaluate/oracle/bjaq_rng-1234.csv
Found oracle card!
torch.Size([5, 2])
******** ANY
******** ANY
******** ANY
******** ANY
******** ANY
******** ANY
******** ANY
******** ANY
******** ANY
******** ANY
******** ANY
******** ANY
******** ANY
Took  8.16123080253601
tensor(0.9936)
result is  tensor(379723.3125)
Enter testHyper
ReportEsts: [1.1749927997589111, 1.0665959119796753, 1.1682729721069336, 1.152874231338501, 1.2350378036499023, 1.1389081478118896, 1.2444318532943726, 1.2008099555969238, 1.059911847114563, 1.0560978651046753, 1.0439276695251465, 1.1256356239318848, 1.0674806833267212, 1.0446428060531616, 1.1087726354599, 1.5100294351577759, 1.2893140316009521, 1.1095012426376343, 1.1800593137741089, 1.0102040767669678, 1.0840764045715332, 1.0344147682189941, 1.128430724143982, 1.0316188335418701, 1.1095319986343384, 1.0650994777679443, 1.0551801919937134, 1.3946459293365479, 1.0206778049468994, 1.109347939491272, 1.0642071962356567, 1.183359980583191, 1.1707626581192017, 1.068143606185913, 1.225333571434021, 1.0685441493988037, 1.5043091773986816, 1.0773550271987915, 1.0262912511825562, 1.0994012355804443, 1.0085694789886475, 1.1336477994918823, 1.142924427986145, 1.1056932210922241, 1.0986689329147339, 1.0351474285125732, 1.174480676651001, 1.2803961038589478, 1.1542978286743164, 1.1116751432418823, 1.1912144422531128, 1.3297569751739502, 1.0610535144805908, 1.179892659187317, 1.1578110456466675, 1.0179330110549927, 1.3336448669433594, 1.1941481828689575, 1.1667308807373047, 1.229435682296753, 1.5848268270492554, 1.2032856941223145, 1.446755051612854, 1.0599477291107178, 1.3469387292861938, 1.1428571939468384, 1.2440476417541504, 1.0508201122283936, 1.0113123655319214, 1.399999976158142, 1.0122150182724, 1.0057588815689087, 1.2159568071365356, 1.1028416156768799, 1.2127066850662231, 1.2620121240615845, 2.0825390815734863, 1.0064414739608765, 1.0036472082138062, 1.2635531425476074, 1.1469192504882812, 1.1857534646987915, 1.0036633014678955, 1.2299578189849854, 1.2561627626419067, 1.0575177669525146, 1.1011254787445068, 1.1520806550979614, 1.0609709024429321, 1.0289249420166016, 1.044965147972107, 1.4280450344085693, 1.0025306940078735, 1.3539975881576538, 1.1470588445663452, 1.1261589527130127, 1.072677731513977, 1.4598922729492188, 1.01694917678833, 1.1041101217269897, 1.0920000076293945, 1.1716530323028564, 1.0141323804855347, 1.0007320642471313, 1.0616323947906494, 1.0543814897537231, 1.2197002172470093, 1.169284462928772, 1.0742695331573486, 1.0206815004348755, 1.329067349433899, 1.1004694700241089, 1.2546871900558472, 1.056175947189331, 1.0944708585739136, 1.140703558921814, 1.0534991025924683, 1.0367599725723267, 1.3265583515167236, 1.114766001701355, 1.1526240110397339, 1.0895543098449707, 1.0159881114959717, 1.269792079925537, 1.2751938104629517, 1.2222450971603394, 1.2153128385543823, 1.1887552738189697, 1.3126592636108398, 1.1232465505599976, 1.2209718227386475, 1.1253376007080078, 1.1084524393081665, 1.4642857313156128, 1.1262181997299194, 1.031241774559021, 1.0105254650115967, 1.1674796342849731, 1.146277666091919, 1.1721813678741455, 1.17616605758667, 1.1013599634170532, 1.0156992673873901, 1.2952243089675903, 1.1792550086975098, 1.0782755613327026, 1.1071094274520874, 1.5276198387145996, 1.0158535242080688, 1.0243724584579468, 1.2095919847488403, 1.1629278659820557, 1.2902042865753174, 1.107545256614685, 1.0990206003189087, 1.1349328756332397, 1.1701369285583496, 1.0295442342758179, 1.0588756799697876, 1.170337200164795, 1.0624504089355469, 1.0335782766342163, 1.03889799118042, 1.2783082723617554, 1.250331163406372, 1.1578947305679321, 1.223893404006958, 1.3420780897140503, 1.171876311302185, 1.0509212017059326, 1.049989104270935, 1.0240896940231323, 1.1363636255264282, 1.282784342765808, 1.041212558746338, 1.0041087865829468, 1.0668740272521973, 1.365652322769165, 1.2873997688293457, 1.1391650438308716, 1.0284173488616943, 1.0437572002410889, 1.0157171487808228, 1.1409602165222168, 1.1017746925354004, 1.0887949466705322, 1.056471824645996, 1.216316819190979, 1.0175894498825073, 1.3128879070281982, 1.0261874198913574, 1.025107502937317, 1.4973766803741455, 1.3918209075927734, 1.7020933628082275, 1.2463022470474243, 1.158857822418213, 1.1343283653259277, 1.0533615350723267, 1.1209163665771484]
********** total_n=[200] batchn=[100]  N=[3200]  nitr=[4]  alpha=[0.4]  beta=[0.2] ******
@ Average per query          [3.7844693660736084] ms
 --  Average per query NF    [1.3662385940551758] ms
 --  Average per query vegas [2.4182307720184326] ms
Mean [1.157]  Median [1.126]  95th [1.429]  99th [1.586]  max [2.083]
Mean [1.157]  Median [1.126]  95th [1.429]  99th [1.586]  max [2.083]


WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/3 | Workload-time: 11.806867 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=face', '--data_update=sample', '--dataset=bjaq', '--drift_test=js', '--end2end', '--update_size=80000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/face/bjaq-id2-best-val.t
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
Sample - START
Sample - END
load_npy_dataset_from_path - df.shape = (458601, 5)
Parsing... done, took 0.0s
Data updated!
Previous data size: (382168, 5), new data size: (76433, 5)
[2.3841858e-07 1.7881393e-07 5.9604645e-08 6.9737434e-06 6.5565109e-07]
Distance score: 1.62124638336536e-06
SAUCE Drift detection: False
Detection latency: 0.0233s

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/3 | Workload-time: 2.020376 | Model-update-time: 0.000000


WORKLOAD-START | Type: QueryWorkload | Progress: 3/3
Going to run: ['python', '/home/kangping/code_copy/SAUCE/FACE/evaluate/Evaluate-FACE-end2end.py', '--dataset=bjaq', '--query_seed=0', '--end2end', '--num_workload=3', '--data_update=sample', '--model_update=adapt']
/home/kangping/anaconda3/envs/LndCar/lib/python3.9/site-packages/torchquad/integration/vegas_map.py:314: UserWarning: torch.searchsorted(): input value tensor is non-contiguous, this will lower the performance due to extra data copy when converting non-contiguous tensor to contiguous, please use contiguous input value tensor if possible. This message will only appear once per program. (Triggered internally at /opt/conda/conda-bld/pytorch_1682343997789/work/aten/src/ATen/native/BucketizationUtils.h:33.)
  iy = torch.searchsorted(self.x_edges[d, :], x[:, d], side='right')
DEVICE NAME
 Tesla V100S-PCIE-32GB
GET-MODEL-PATH=./models/end2end/face/bjaq-id2-best-val.t
Load model - START
Load model from: /home/kangping/code_copy/SAUCE/models/end2end/face/bjaq-id2-best-val.t
There are 104179 trainable parameters in this model.
Parameters total size is 0.3974113464355469 MB
Load model - END
There are 104179 trainable parameters in this model.
Parameters total size is 0.3974113464355469 MB
GET-DATASET-PATH=./data/bjaq/end2end/bjaq.npy
data shape: (458601, 5)
Save oracle results to :
./FACE/evaluate/oracle/bjaq_rng-0.csv
Found oracle card!
torch.Size([5, 2])
******** ANY
******** ANY
******** ANY
******** ANY
******** ANY
******** ANY
******** ANY
******** ANY
******** ANY
******** ANY
******** ANY
******** ANY
******** ANY
******** ANY
******** ANY
Took  8.169571161270142
tensor(0.9979)
result is  tensor(457648.8438)
Enter testHyper
ReportEsts: [1.0549049377441406, 1.0744285583496094, 1.185289978981018, 1.2941805124282837, 1.019087553024292, 1.1141808032989502, 1.1189355850219727, 1.021655797958374, 1.073547601699829, 1.024113416671753, 1.0554949045181274, 1.18674635887146, 1.1759259700775146, 1.2185481786727905, 1.0674344301223755, 1.0080957412719727, 1.119001865386963, 1.1261556148529053, 1.092996597290039, 1.2750765085220337, 1.048112154006958, 2.081458568572998, 1.1351077556610107, 1.0476738214492798, 1.1520403623580933, 1.2079722881317139, 1.0330374240875244, 1.2049102783203125, 1.1858333349227905, 1.5958219766616821, 1.1465892791748047, 1.2071428298950195, 1.1482523679733276, 1.2503374814987183, 1.0654103755950928, 1.0738182067871094, 1.0871047973632812, 1.2061471939086914, 1.1871962547302246, 1.021692156791687, 1.0768580436706543, 1.0446428060531616, 1.1485631465911865, 1.0496727228164673, 1.0936851501464844, 1.0855257511138916, 1.3655340671539307, 1.0538195371627808, 1.1039999723434448, 1.2100456953048706, 1.0634052753448486, 1.0734254121780396, 1.0528614521026611, 1.2682594060897827, 1.1140280961990356, 1.4291431903839111, 1.188297152519226, 1.1497323513031006, 1.276328682899475, 1.1219550371170044, 1.586034893989563, 1.08891761302948, 1.1055347919464111, 1.5583446025848389, 1.002570390701294, 1.1305896043777466, 1.2685656547546387, 1.031488299369812, 1.1670454740524292, 1.1214665174484253, 1.1084791421890259, 1.1283693313598633, 1.1102226972579956, 1.0666009187698364, 1.0861613750457764, 1.2096272706985474, 1.3439348936080933, 1.1495901346206665, 1.2419655323028564, 1.0001591444015503, 1.1262686252593994, 1.083681344985962, 1.1517014503479004, 1.164495587348938, 1.2959723472595215, 1.3254237174987793, 1.1998486518859863, 1.5492138862609863, 1.1526029109954834, 1.0988610982894897, 1.200110912322998, 1.2780944108963013, 1.402791142463684, 1.2013212442398071, 1.333910346031189, 1.0310125350952148, 1.2382980585098267, 1.1866682767868042, 1.1241906881332397, 1.2511836290359497, 1.0851719379425049, 1.1487716436386108, 1.0791208744049072, 1.0966391563415527, 1.1394485235214233, 1.2154775857925415, 1.1199183464050293, 1.00840425491333, 1.0984042882919312, 1.239320158958435, 1.018775463104248, 1.1384847164154053, 1.278505802154541, 1.2441307306289673, 1.0190554857254028, 1.2521908283233643, 1.133233904838562, 1.3952360153198242, 1.034841537475586, 1.2280701398849487, 1.10520601272583, 1.0458095073699951, 1.1226269006729126, 1.5169939994812012, 1.0718324184417725, 1.1098592281341553, 1.2090075016021729, 1.2597200870513916, 1.1809000968933105, 1.009320616722107, 1.0304075479507446, 1.0569733381271362, 1.0263432264328003, 1.6974248886108398, 1.3458930253982544, 1.0267666578292847, 1.038379192352295, 1.1206660270690918, 1.001342535018921, 1.029033899307251, 1.0214980840682983, 1.1519447565078735, 1.0144836902618408, 1.0016593933105469, 1.0971159934997559, 1.0568697452545166, 1.4912281036376953, 1.0341823101043701, 1.0556827783584595, 1.0208388566970825, 1.0794464349746704, 1.0076531171798706, 1.1424683332443237, 1.137068271636963, 1.0355453491210938, 1.1629997491836548, 1.0016443729400635, 1.20895516872406, 1.0676337480545044, 1.1928644180297852, 1.0840201377868652, 1.168597936630249, 1.0208981037139893, 1.0092225074768066, 1.1894841194152832, 1.1502145528793335, 1.0050783157348633, 1.4392915964126587, 1.0141593217849731, 1.2281690835952759, 1.134223461151123, 1.1581170558929443, 1.355304479598999, 1.1108059883117676, 1.0271964073181152, 1.0022066831588745, 1.1345347166061401, 1.0481094121932983, 1.0612711906433105, 1.170809030532837, 1.5306122303009033, 1.1872665882110596, 1.029661774635315, 1.4446308612823486, 1.3404617309570312, 1.1190747022628784, 1.29975426197052, 1.1537238359451294, 1.4493635892868042, 1.0108431577682495, 1.1602073907852173, 1.1277427673339844, 1.2244318723678589, 1.5489007234573364, 1.084563136100769, 1.0063996315002441, 1.2799460887908936, 1.1182488203048706, 1.2143927812576294, 1.0707308053970337]
********** total_n=[200] batchn=[100]  N=[3200]  nitr=[4]  alpha=[0.4]  beta=[0.2] ******
@ Average per query          [3.743011951446533] ms
 --  Average per query NF    [1.3605749607086182] ms
 --  Average per query vegas [2.382436990737915] ms
Mean [1.161]  Median [1.126]  95th [1.451]  99th [1.597]  max [2.081]
Mean [1.161]  Median [1.126]  95th [1.451]  99th [1.597]  max [2.081]


WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/3 | Workload-time: 12.217936 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=1, #drift=0 | total-time=26.107051