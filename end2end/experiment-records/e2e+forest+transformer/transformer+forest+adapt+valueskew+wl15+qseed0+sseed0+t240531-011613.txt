Input arguments = Namespace(data_update='valueskew', update_size=25000, dataset='forest', debug=False, drift_test='distribution', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=15)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-2'}, 'random_seed': 0, 'transformer': {'epochs': 40}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/forest/end2end/forest.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=forest', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
load_csv_dataset - forest (581012, 10)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
query_seed:0
origin-forest_39.80 	max: 42.5000	99th: 5.6668	95th: 2.2929	median: 1.0095	mean: 1.3732
ReportEsts: [1.0, 1.0619489034591907, 1.0, 1.3111111111111111, 1.3333333333333333, 1.0, 1.2268370607028753, 1.0, 1.0987261146496816, 1.0, 1.1166666666666667, 1.0, 1.0, 1.0, 2.0, 1.0492148517757558, 1.0, 1.1111111111111112, 2.0384615384615383, 1.0, 1.0, 3.0, 1.0526315789473684, 1.6, 1.4, 1.0, 1.1141505078485687, 1.3, 1.5, 1.2006920415224913, 1.0, 1.110896196002579, 1.8571428571428572, 1.0, 1.0603448275862069, 1.0519910197329552, 1.0470656595002905, 1.0, 1.0629834254143646, 1.0, 2.0, 1.0, 1.0625, 1.0, 1.3252032520325203, 1.1040723981900453, 1.0, 2.0, 1.0, 1.0, 3.0, 1.145613048368954, 1.0, 1.0, 1.125, 1.0656565656565657, 1.164406779661017, 2.2666666666666666, 1.0, 1.0, 1.009556313993174, 5.7, 1.0, 1.4246575342465753, 1.1528662420382165, 1.0, 1.2287917737789202, 1.188235294117647, 1.1526104417670682, 1.0, 2.0, 1.0, 1.1538461538461537, 1.3892808255238496, 1.3333333333333333, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0677408070457024, 3.5, 2.1666666666666665, 1.0, 1.0, 1.0, 1.1591739000299313, 1.0, 1.6, 1.2777777777777777, 1.0, 1.2245580506450071, 1.0, 1.0, 1.0077691453940067, 1.3800424628450105, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 1.1448275862068966, 1.0, 1.0, 1.0, 1.0905797101449275, 1.0, 1.0422535211267605, 1.0, 1.0, 1.0378449408672799, 1.1326530612244898, 2.0, 1.0, 2.0, 1.0, 1.0, 1.0, 2.0, 3.0, 1.0, 1.2004521477015826, 1.1428571428571428, 1.0, 1.0, 1.0, 1.0, 1.0, 1.5246530314097881, 1.135799397994975, 1.0, 1.375, 1.0, 1.0, 2.0, 1.0310584389047814, 1.1904761904761905, 1.0870730491149339, 1.0, 1.0, 1.2, 1.0, 1.099257994433223, 1.0, 1.2, 1.6, 1.0833333333333333, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.6666666666666667, 1.7777777777777777, 2.0, 1.0063813229571985, 4.0, 1.0035964672675954, 1.0, 1.3333333333333333, 2.0, 1.1294498381877023, 1.0, 1.0, 1.0, 1.0075187969924813, 1.1153846153846154, 1.0, 1.0, 1.1216730038022813, 1.0, 1.1752808988764045, 1.0, 1.4672897196261683, 1.0, 1.0, 1.096894113908968, 1.0, 1.1304677144480213, 1.0, 1.0, 1.2285714285714286, 1.0527976058075343, 1.0, 1.050420168067227, 1.5333333333333334, 1.0, 1.0, 1.0, 1.0, 1.1666666666666667, 1.1428571428571428, 1.3081892788545486, 1.1355022109917878, 1.3333333333333333, 1.0, 1.0, 2.0, 3.0, 1.4242424242424243, 1.0, 1.0, 1.0, 1.0, 1.1470588235294117, 1.0, 1.3333333333333333, 1.0, 1.0, 1.0, 1.0804020100502512, 1.0, 2.0, 1.0, 1.3596668917398154, 1.0, 1.0, 1.1521739130434783, 1.0, 1.2, 1.0, 1.625978090766823, 1.0, 1.0, 1.0, 1.2222222222222223, 1.0, 1.5769230769230769, 1.0, 2.0, 1.0, 1.0480985387785688, 1.0093709884467266, 1.0, 2.0, 1.5, 1.0378644452858765, 1.0103092783505154, 1.5, 1.0, 1.0210378681626928, 10.0, 1.1806506849315068, 1.0, 1.6666666666666667, 1.1317365269461077, 1.0, 1.1529411764705881, 1.080092711820757, 1.5714285714285714, 2.0, 1.2741935483870968, 1.017283950617284, 4.0, 1.0, 1.0029683377308707, 1.25, 2.0, 1.0, 1.1428571428571428, 1.0, 1.0, 1.0, 1.1875, 1.5, 1.127952167414051, 2.0, 1.0, 1.0746758444053146, 1.2857142857142858, 1.0, 1.0416666666666667, 1.0, 1.0, 1.0, 1.8, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0164835164835164, 1.0, 1.1111111111111112, 1.0, 1.0, 2.0, 1.0, 1.0987179487179488, 1.6090909090909091, 1.1480384900074019, 1.3146067415730338, 1.0, 1.5201612903225807, 1.0, 1.0, 3.0, 1.0, 1.1818181818181819, 1.0, 2.0, 1.0, 1.173913043478261, 1.0, 1.0, 1.1666666666666667, 1.5, 1.0, 1.0, 1.0, 1.0, 1.0, 2.5714285714285716, 1.0, 1.0, 1.2862279755483639, 1.5, 1.0, 1.0253863134657837, 1.0, 1.0, 1.0, 1.0, 1.2, 2.0, 3.0, 1.0, 1.6666666666666667, 1.0804020100502512, 1.0, 1.0476190476190477, 1.8597560975609757, 1.0, 1.2461133700071754, 1.018018018018018, 1.0, 1.4, 1.5, 1.1428571428571428, 3.9, 1.5, 1.0, 1.0, 1.0, 1.0, 1.0, 1.543103448275862, 11.0, 1.4320987654320987, 6.0, 1.0, 1.0, 1.0, 1.2432432432432432, 1.4, 1.1181818181818182, 1.0931813198859899, 1.1403270352023147, 1.4885786802030456, 1.082059730790802, 1.3520408163265305, 1.0, 2.8783783783783785, 1.0, 1.2280171327790375, 1.011029083970827, 1.0, 1.0161751541674955, 1.0673607555327986, 1.043036435488774, 1.0, 1.6666666666666667, 1.0, 1.0389610389610389, 1.0, 1.0, 1.0704647676161918, 2.7450980392156863, 1.0, 2.4285714285714284, 1.0, 1.0718554354012522, 1.0, 10.0, 1.0714285714285714, 1.0, 1.0, 5.666666666666667, 1.0, 1.0251572327044025, 1.0, 1.0, 1.0, 1.0, 1.0096425383726204, 1.0, 2.0, 1.126086956521739, 1.2192307692307693, 1.2555555555555555, 1.281615302869288, 1.3221153846153846, 1.0628005556940834, 1.1386430678466077, 2.75, 1.0, 1.0, 1.1091129332836378, 1.116346219950959, 1.0, 1.3636363636363635, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.1561944279786602, 2.5, 1.184995737425405, 1.0, 1.0, 1.0, 1.2027972027972027, 1.0876721000158254, 2.5, 1.2909647779479325, 2.8, 1.0, 1.0, 1.0, 1.013547723036693, 2.0, 1.0, 1.3333333333333333, 1.0, 1.5833333333333333, 1.0, 1.0, 1.0, 1.026682202155549, 1.0, 1.0, 2.0, 1.3333333333333333, 1.2195121951219512, 1.0059435364041605, 1.75, 1.0, 1.0, 1.3266666666666667, 1.25, 2.0, 1.0531450577663672, 1.0, 1.4444444444444444, 1.0, 1.0, 1.0909090909090908, 1.0, 1.0, 1.5, 1.0000721813194746, 1.0260890323754093, 5.678571428571429, 1.3666666666666667, 1.0, 1.0, 2.0, 1.0, 1.1810053429287972, 1.2972972972972974, 1.5, 1.0, 1.0265151515151516, 1.0160427807486632, 1.0, 1.0555388395767513, 2.0, 2.0, 1.0839876836531392, 2.5, 1.0259228876127975, 1.0, 1.0, 1.0, 1.01010388870178, 1.6428571428571428, 2.0, 1.0, 1.0, 2.0, 1.0, 1.1346153846153846, 1.0, 1.1390728476821192, 1.1037959147891645, 2.0, 1.0, 1.0, 1.0903790087463556, 2.0, 1.0, 1.2409638554216869, 1.0, 1.0510324596159708, 3.0, 1.12, 1.0, 3.6, 1.0, 2.0, 1.1578648495173196, 1.5, 4.0, 1.080047789725209, 1.6666666666666667, 1.0, 1.0209142679549172, 1.0, 2.0, 1.0, 2.0, 1.0, 1.0337078651685394, 1.0, 1.0, 1.4285714285714286, 1.0329956692408555, 1.0986842105263157, 3.608695652173913, 1.0, 1.3972602739726028, 2.0, 1.4615384615384615, 1.062111801242236, 1.0, 1.0, 1.0897435897435896, 1.2848167539267015, 1.6666666666666667, 2.0, 1.1428571428571428, 1.1714285714285715, 1.0, 1.25503355704698, 1.0, 1.5703125, 1.0, 3.0, 1.0398383733872612, 6.0, 1.0484804253766355, 2.0, 1.0, 3.0, 1.0625, 1.0, 2.0, 1.1054421768707483, 1.0, 1.0, 1.0, 1.0, 1.0, 1.1153846153846154, 2.0, 42.5, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 2.1739130434782608, 1.74, 1.0, 1.2183333333333333, 1.0, 1.0, 1.75, 1.0175775071180007, 2.2857142857142856, 1.0, 1.0, 1.0, 1.0, 1.0075087993742666, 1.0, 1.0, 1.0041918956683744, 1.5853365384615385, 1.148936170212766, 2.0, 1.0, 1.0, 1.0, 2.076923076923077, 2.0, 1.0, 1.0, 1.3699551569506727, 1.0, 1.061211477151966, 1.0, 1.0, 1.0344646464646465, 1.0, 1.0, 1.0, 1.3548387096774193, 1.0961492914380453, 1.0, 2.0, 1.1818181818181819, 1.2734375, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0179534077782055, 1.0, 2.0, 1.0776897521083568, 1.0, 1.0, 1.0839071665391482, 1.0, 1.1015575535013296, 1.0, 1.0, 1.0805785123966942, 1.027701778385773, 3.3333333333333335, 1.4130434782608696, 1.0, 1.0, 4.0, 1.017645710793675, 1.0, 1.0, 1.0, 1.0, 1.1111111111111112, 1.0, 1.0, 1.5, 1.4535082715345122, 1.0, 2.0, 1.0, 1.0, 1.0, 1.125, 1.202127659574468, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.6666666666666667, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0054329774614472, 1.0215384615384615, 1.0, 2.0, 1.5, 1.091726618705036, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0177045177045176, 1.0108695652173914, 1.0909090909090908, 1.0306251581878005, 1.0, 23.0, 1.0, 1.32, 1.0, 1.5, 1.0, 1.0, 1.0, 1.0173623937938678, 1.625, 1.0, 4.0, 1.0962962962962963, 1.1776615863833575, 1.0, 1.0, 1.2111317254174396, 1.0349586016559338, 1.164179104477612, 1.1111111111111112, 1.0, 1.0, 1.005406844573699, 1.0, 1.375, 1.0, 1.0, 1.3333333333333333, 1.0398593200468933, 1.0, 1.0, 1.0666666666666667, 1.0, 1.0, 3.0, 1.2333333333333334, 1.0, 1.1489754098360656, 1.025785656728445, 2.0, 1.0, 1.0, 3.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 2.0, 3.0, 1.0392156862745099, 1.0, 1.0980159201615778, 1.0, 2.0, 1.1666666666666667, 1.3499036608863197, 1.5, 1.0, 1.0, 1.0, 1.0, 1.5714285714285714, 1.0807339449541284, 3.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0316455696202531, 1.0, 1.0, 1.0, 1.0, 1.069811320754717, 1.0095514950166113, 1.0, 1.0, 1.1781609195402298, 1.04, 2.0, 1.427710843373494, 1.0, 1.0, 1.0, 1.0, 1.0, 1.4545454545454546, 2.0, 1.0, 1.121580547112462, 1.1206952043772127, 1.3333333333333333, 1.0, 1.0, 1.0, 1.0, 3.2, 1.0, 1.0, 1.184313725490196, 1.0, 1.0, 1.0, 1.25, 1.8611111111111112, 1.0, 5.052173913043478, 1.0, 1.0, 1.3333333333333333, 1.0, 1.1481481481481481, 1.2263513513513513, 1.0, 1.0657894736842106, 1.0, 1.2272727272727273, 1.0, 1.0, 1.0, 1.2142857142857142, 1.0, 1.0, 1.0, 1.5, 1.0309278350515463, 1.0, 1.0, 1.0426017497147204, 1.107205862396526, 1.0, 1.0, 1.0, 1.0185060170237745, 1.0, 1.3357142857142856, 1.0, 1.1147540983606556, 2.0, 1.0, 1.1538461538461537, 1.25, 1.6666666666666667, 1.0860042735042734, 1.0, 1.3636363636363635, 1.0, 1.5, 1.6666666666666667, 1.0, 2.0, 1.0, 2.0, 1.6666666666666667, 1.0, 1.0, 1.6666666666666667, 1.0, 1.1428571428571428, 1.0, 4.0, 1.0, 1.3333333333333333, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0923923923923924, 2.0, 1.0, 1.0, 1.0, 1.0, 1.105263157894737, 2.0, 1.0, 1.1813570069752695, 1.0, 1.2620571916346564, 1.0, 1.5151311365164761, 1.0, 1.2647058823529411, 1.3333333333333333, 6.5, 1.0, 1.0, 1.0555555555555556, 1.061603716420925, 1.0, 2.0, 1.003440366972477, 1.0, 1.0, 1.0, 2.0, 1.088473115741014, 1.0, 2.6, 1.0, 1.0727272727272728, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 3.0, 2.0, 1.0, 1.0, 1.0, 1.0700330628193568, 1.0688402332919018, 1.0, 1.0, 1.2307692307692308, 1.0591549295774647, 1.0, 2.0, 1.0488518856447688, 1.125, 1.2536231884057971, 1.0, 1.0, 1.0, 1.5, 1.5333333333333334, 1.0, 1.2639708652517896, 1.0, 1.0, 1.2566929133858267, 1.0, 3.4285714285714284, 1.0, 1.0, 1.1666666666666667, 1.0640569395017794, 1.0, 1.5, 1.0394736842105263, 1.050609013049871, 1.0, 1.5, 1.0, 1.0, 1.3074692646717698, 2.0, 1.75, 1.0, 1.459016393442623, 1.0, 1.345643153526971, 3.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.2142857142857142, 1.0, 1.1609649122807018, 1.0, 1.013410382839735, 1.0, 1.0, 1.0, 1.0, 1.0, 1.027027027027027, 1.0523820275457214, 2.0, 1.0155610155610155, 1.0, 1.0740507920543123, 1.0357142857142858, 2.0, 1.11864406779661, 1.2966101694915255, 1.0, 1.0, 1.0, 1.2163034705407587, 1.0, 1.0, 1.2696629213483146, 2.0, 1.0]
origin-forest_39.80 	max: 42.5000	99th: 5.6668	95th: 2.2929	median: 1.0095	mean: 1.3732

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/15 | Workload-time: 28.127692 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=valueskew', '--dataset=forest', '--drift_test=distribution', '--end2end', '--update_size=25000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
ValueSample - START
ValueSample - END
load_npy_dataset_from_path - df.shape = (606012, 10)
Parsing... done, took 0.1s
Data updated!
Previous data size: (581012, 10), new data size: (25000, 10)
[5.9604645e-08 0.0000000e+00 1.7881393e-07 3.5762787e-07 4.1723251e-07
 5.7917833e-04 0.0000000e+00 7.1525574e-07 1.7881393e-07 1.1920929e-07]
Distance score: 5.8120487665291876e-05
SAUCE Drift detection: True
Detection latency: 0.0604s

DRIFT-DETECTED after 2-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=forest', '--end2end', '--model=transformer', '--model_update=adapt', '--update_size=25000', '--epochs=40']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
update_size: 25000
AdaptTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (606012, 10)
Parsing... done, took 0.1s
done, took 0.1s
dataset size: 606012
train data shape: torch.Size([25000, 10]), transfer data shape:torch.Size([5000, 10])
Epoch 0 Iter 0, train entropy gap 13.6688 bits (loss 32.876, data 19.207) 0.00300 lr
epoch 10 train loss 20.2583 nats / 29.2266 bits
time since start: 5.7 secs
Epoch 10 Iter 0, train entropy gap 9.9463 bits (loss 29.154, data 19.207) 0.00256 lr
epoch 20 train loss 19.0818 nats / 27.5292 bits
time since start: 11.3 secs
Epoch 20 Iter 0, train entropy gap 8.1706 bits (loss 27.378, data 19.207) 0.00150 lr
epoch 30 train loss 18.6108 nats / 26.8497 bits
time since start: 16.9 secs
Epoch 30 Iter 0, train entropy gap 7.6575 bits (loss 26.865, data 19.207) 0.00044 lr
epoch 40 train loss 18.5231 nats / 26.7232 bits
time since start: 22.6 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 37.4193 nats / 53.9846 bits
Saved to: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
AdaptTask - END

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/15 | Workload-time: 2.201603 | Model-update-time: 25.694724


WORKLOAD-START | Type: QueryWorkload | Progress: 3/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=forest', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
data size: 606012, total size: 606012, split index: [505010 606012]
Parsing... done, took 0.1s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
query_seed:0
origin-forest_39.80 	max: 68.0000	99th: 11.0071	95th: 4.0000	median: 1.3064	mean: 1.9031
ReportEsts: [1.0, 1.2670258620689656, 2.0, 2.4583333333333335, 2.6666666666666665, 1.0, 1.562015503875969, 2.0, 1.5122615803814714, 2.0, 1.0597014925373134, 1.0, 2.0, 2.0, 1.6, 4.833333333333333, 1.9836065573770492, 1.0, 2.9, 6.8507309566555525, 1.0, 2.3333333333333335, 1.2941176470588236, 1.25, 5.0, 1.0, 1.0119257283751824, 1.1333333333333333, 1.25, 1.8408488063660478, 2.0, 1.3333333333333333, 2.0, 1.0, 1.0, 2.0, 2.0, 2.0, 1.375, 2.0, 1.0, 1.056338028169014, 1.0, 1.105149513908638, 2.0, 1.6628571428571428, 2.0, 2.0, 1.725, 2.0, 1.5, 1.0099961867407528, 2.0, 1.0, 19.0, 1.079646017699115, 5.611111111111111, 1.1176470588235294, 1.0, 2.0, 1.1511343234862086, 10.0, 2.0, 1.029038112522686, 1.1376811594202898, 1.0, 1.0634920634920635, 1.3047619047619048, 1.5698924731182795, 1.0, 3.0, 2.0, 1.1111111111111112, 1.010897240044811, 2.0, 1.3333333333333333, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0101172343764424, 9.0, 1.5555555555555556, 1.0, 1.0, 1.0, 1.0391829689298044, 2.0, 2.0, 2.0, 1.1049421472777827, 2.425531914893617, 1.0333333333333334, 1.7142857142857142, 2.0, 2.0, 3.0, 1.1193548387096774, 2.0, 1.2568627450980392, 2.0, 2.6233766233766236, 1.0, 1.0, 1.0303139013452915, 1.0042208189947992, 2.0, 1.0, 1.3275261324041812, 3.0, 1.0758620689655172, 1.0, 2.0, 1.1033190578158458, 1.161764705882353, 1.5, 1.0, 3.0, 1.0, 1.0, 2.0, 3.0, 3.0, 1.0, 1.2448979591836735, 1.1428571428571428, 1.0, 1.1111111111111112, 1.0, 2.0, 1.0, 1.420864533696392, 1.0452288902556892, 2.0, 1.25, 2.0, 2.0, 3.0, 1.3511871893981227, 1.0144927536231885, 1.0287846481876333, 2.0, 2.0, 5.0, 1.0, 1.0129230995802754, 1.0, 1.096774193548387, 2.1666666666666665, 1.4444444444444444, 1.2666666666666666, 1.0, 1.0, 1.0, 2.0, 5.0, 1.0, 2.0, 2.0, 1.25, 3.0, 2.0, 1.0666470501691923, 4.0, 1.021576474682443, 1.0, 4.0, 2.0, 1.1304347826086956, 1.0, 2.0, 1.3333333333333333, 1.0, 1.1012245511231313, 1.0467091295116773, 2.0, 1.220825852782765, 1.0143014301430142, 2.0, 1.0, 1.5, 1.2589285714285714, 2.0, 1.0, 1.0406610663048284, 1.0, 1.1565750371471026, 2.0, 2.0, 1.0208333333333333, 1.0350558942153631, 2.0, 1.43359375, 2.4, 2.0, 2.0, 1.0, 2.0, 1.0657894736842106, 1.4, 1.0454545454545454, 1.517010062290369, 1.0, 1.0, 1.0, 2.0, 2.25, 1.4166666666666667, 2.0, 2.0, 2.0, 1.0, 1.2258064516129032, 2.0, 1.1111111111111112, 1.0, 2.0, 1.0, 1.081447963800905, 1.0, 3.0, 2.0, 1.0918882531134297, 3.0, 1.0, 1.4583333333333333, 3.0, 1.0121951219512195, 1.0, 1.6307237813884785, 2.0, 1.0, 1.0, 4.333333333333333, 1.0, 4.333333333333333, 2.0, 1.0, 1.5, 1.2557656697155042, 1.1060070671378093, 2.0, 4.0, 2.0, 1.1373109930527177, 1.066137566137566, 4.0, 1.0, 1.5423728813559323, 1.6, 2.0, 19.0, 1.6666666666666667, 2.25, 1.0, 1.25, 1.051998183469573, 1.1538461538461537, 2.5, 1.1742243436754176, 1.3302752293577982, 1.6666666666666667, 1.0, 1.5069375619425174, 1.4, 1.2, 1.0, 1.2857142857142858, 1.0, 2.0, 1.0, 1.0731707317073171, 1.5, 1.26131221719457, 1.0, 2.0, 1.0555555555555556, 1.0, 2.107142857142857, 1.3670212765957446, 1.0, 2.0, 2.6666666666666665, 1.0743405275779376, 1.0659898477157361, 1.0963318740170866, 1.6666666666666667, 1.0, 1.0, 2.8333333333333335, 1.0908084163898117, 1.0, 1.401015228426396, 1.0, 1.3655172413793104, 1.0, 2.0, 1.2162162162162162, 1.25, 1.0, 2.0, 1.131578947368421, 1.0, 4.0, 1.0, 2.0, 1.1153846153846154, 1.0, 1.0, 2.0, 2.0, 1.8387096774193548, 1.0, 2.0, 2.0, 2.0, 2.0, 1.0, 2.0, 2.0, 1.0, 1.5, 1.0, 2.0, 1.0837383177570092, 1.0, 1.0, 1.0154473914310698, 1.0, 1.0, 3.0, 1.0, 1.0059612518628913, 3.0, 3.0, 1.0, 1.25, 1.162162162162162, 2.0, 1.0106382978723405, 1.660919540229885, 1.0, 1.5185385656292287, 1.3837209302325582, 1.0, 1.5217391304347827, 3.0, 8.0, 11.0, 4.863082738345233, 1.0, 2.0, 1.0, 1.0, 1.0, 1.2, 1.0909090909090908, 1.1058823529411765, 1.5, 1.0, 1.0, 1.0, 1.9130434782608696, 1.3333333333333333, 1.5, 1.0906436097114063, 1.0700648414985592, 1.0064338235294117, 1.2227147796790496, 1.8827586206896552, 1.0, 1.1243781094527363, 1.0, 1.0541368743615935, 1.2869776089240967, 2.0, 1.0364851398088986, 1.0526358828981082, 1.032859284469835, 1.0, 3.0, 1.0, 1.2030075187969924, 3.8, 3.0, 1.0, 1.0340659340659342, 2.0, 1.1666666666666667, 2.0, 2.0, 1.2380952380952381, 1.0, 1.0, 1.0, 1.0, 1.3846153846153846, 3.0, 1.0677966101694916, 2.0, 1.0, 1.0, 1.0, 1.0466097380020658, 1.0, 3.0, 1.2931726907630523, 1.1596575169982373, 1.0056737588652482, 1.5526315789473684, 1.494773519163763, 1.0054990094951841, 1.0825958702064897, 68.0, 2.0, 1.0, 1.0006481895395618, 1.0152468970443789, 2.0, 4.0, 3.0, 4.0, 1.0, 1.2695652173913043, 1.0595448685275688, 2.0, 1.766199649737303, 11.714285714285714, 1.0, 1.0, 1.2428571428571429, 1.7142857142857142, 2.0, 2.0, 1.20500403551251, 1.0284306610093792, 1.2, 1.2228464419475655, 4.666666666666667, 1.0, 1.0, 2.0, 1.2832886505808758, 1.0, 1.0, 1.2960829493087558, 1.0, 1.3255813953488371, 2.0, 2.0, 2.0, 1.3167256985438804, 1.0, 2.0, 2.25, 2.0, 1.1320754716981132, 1.4, 1.0, 1.2227272727272727, 3.0, 2.0, 1.0521799878192957, 2.0, 1.0, 1.2403800475059383, 2.0, 13.0, 2.0, 1.0, 1.0, 2.0, 2.0, 1.6666666666666667, 1.4226306602320566, 1.2991920690863372, 1.0029940119760479, 1.4516129032258065, 3.0, 2.0, 1.1818181818181819, 1.0, 1.0355128472947566, 2.1818181818181817, 1.5, 1.0, 1.0912220309810672, 1.2660550458715596, 1.0, 1.0018244429747543, 4.0, 2.0, 1.0418554201493013, 2.0, 1.0838874680306905, 1.0, 1.0, 1.0, 1.0798631787400812, 14.0, 1.5, 1.04, 1.0, 2.0, 1.0, 1.0555555555555556, 3.0, 1.1585365853658536, 1.7276422764227641, 3.0, 1.5, 2.0, 1.011142061281337, 2.0, 21.0, 1.4342105263157894, 1.0, 1.2968011845723553, 1.077922077922078, 1.173913043478261, 1.0, 1.2857142857142858, 2.0, 1.5, 1.066677101267804, 2.0, 5.0, 1.0834998002397123, 1.2, 2.0, 1.0751291512915129, 1.1143615340873192, 2.4642857142857144, 1.0, 2.0, 1.0, 1.0625, 1.0, 1.0, 1.0, 1.0207528772255792, 1.1333333333333333, 2.619047619047619, 4.333333333333333, 1.144736842105263, 2.0, 1.7142857142857142, 1.0486725663716814, 2.0, 2.0, 1.66, 1.0345368916797488, 5.0, 3.0, 1.5714285714285714, 1.0078740157480315, 1.0, 1.2277227722772277, 1.0, 1.036764705882353, 2.0, 2.3333333333333335, 1.0083096331947787, 6.0, 1.1142386743852568, 2.5, 3.0, 4.0, 2.3684210526315788, 1.0, 1.25, 17.0, 1.123249299719888, 1.0678840809845176, 2.0, 1.0, 1.0, 1.3098159509202454, 1.1428571428571428, 1.625, 2.0, 1.1692307692307693, 2.0, 1.1176470588235294, 2.0, 2.0, 2.0, 2.0, 1.0, 1.5, 2.0, 2.0, 3.0, 2.6166666666666667, 1.0701754385964912, 2.0, 1.0420168067226891, 1.0, 2.0, 1.2, 1.073579405217618, 3.3448275862068964, 3.0, 1.0, 2.0, 1.0, 1.046654895036296, 2.0, 2.0, 1.1301160659743432, 2.0, 1.0, 2.0, 6.0, 4.0, 2.0, 1.0, 1.0, 1.0, 1.75, 1.562240663900415, 1.1156876790830945, 1.5, 1.0, 2.0, 1.009837240150657, 1.0, 1.0, 3.0, 1.9318181818181819, 1.2325369788834764, 1.0, 1.0, 1.75, 1.2315175097276265, 1.0, 1.0, 1.3333333333333333, 2.0, 1.0, 1.1401890707862579, 1.0, 2.0, 1.0201109570041609, 1.0, 1.0, 1.0439093484419264, 2.0, 1.0466911299506516, 2.0, 2.0, 1.02, 1.1555697823303457, 2.625, 5.75, 2.0, 1.0, 5.0, 1.4507060929523303, 1.0, 2.0, 2.0, 1.0, 1.4285714285714286, 2.0, 2.0, 2.0, 1.2530980097634248, 2.0, 2.0, 1.0, 1.0, 2.0, 1.3333333333333333, 1.039301310043668, 2.0, 2.0, 2.0, 2.0, 2.0, 1.0, 5.5, 1.0, 1.0, 2.0, 2.0, 2.0, 2.5, 1.1742255404501893, 1.0708215297450425, 2.0, 2.0, 1.6666666666666667, 1.2093425605536332, 1.0, 2.0, 1.0, 2.0, 2.0, 1.0467289719626167, 1.0736842105263158, 1.7352941176470589, 1.2054054054054053, 1.0, 1.2894736842105263, 1.0, 1.368421052631579, 2.0, 3.0, 1.0, 3.0, 1.0, 1.0780724691819201, 1.2586750788643533, 2.0, 5.0, 1.0465116279069768, 1.0709863588667365, 1.0, 1.0, 1.1030759162303665, 1.1, 1.0597014925373134, 3.0, 2.0, 1.0, 1.1610716468072104, 1.0, 2.9, 1.0, 2.0, 1.6666666666666667, 1.0636871508379888, 2.0, 2.0, 3.75, 1.0, 2.0, 4.0, 1.2, 2.5, 1.0438431238225723, 1.1716738197424892, 2.0, 1.0, 1.4736842105263157, 1.3067738017378305, 5.0, 3.0, 1.0, 2.0, 2.0, 1.0, 1.1799189273464297, 1.3059631834248902, 1.28125, 1.5, 1.2002084418968213, 1.0, 2.0, 1.0936605316973416, 1.0, 1.087719298245614, 1.049075336693888, 1.25, 1.2622950819672132, 1.17375, 3.0, 5.5, 1.1726342710997442, 1.0178412132024979, 4.0, 1.0, 2.0, 2.0, 1.0, 2.0, 1.2150537634408602, 1.0, 1.0, 2.0, 2.0, 1.5474452554744527, 1.038039502560351, 1.0, 2.0, 1.0918918918918918, 1.380952380952381, 3.0, 1.1741573033707866, 2.0, 2.0, 1.0, 1.0, 1.0, 1.3076923076923077, 2.0, 2.0, 1.1724137931034482, 1.118256299273458, 1.2727272727272727, 2.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.5473393227366967, 2.0, 1.0, 1.894736842105263, 6.0, 37.0, 1.0, 1.150190114068441, 1.0909090909090908, 2.0, 1.1893551688843398, 1.3211009174311927, 1.0, 1.089578896750704, 1.0, 1.7186629526462396, 2.25, 2.0, 2.0, 1.0, 1.3333333333333333, 1.25, 1.0, 1.0, 1.0, 1.5, 1.308641975308642, 2.0, 2.0, 1.132701421800948, 1.0070154165944916, 1.0, 1.0, 2.0, 1.250458782940615, 1.0, 1.7412935323383085, 1.0, 1.0028854080791427, 3.0, 2.0, 1.4666666666666666, 1.25, 1.5, 1.138077285579642, 1.0, 2.7222222222222223, 1.0, 1.3333333333333333, 1.5, 2.0, 1.5, 2.0, 8.0, 5.0, 1.0, 1.0, 2.6, 2.0, 1.1111111111111112, 2.0, 5.0, 2.0, 5.0, 2.0, 1.0, 2.0, 2.0, 2.0, 2.0, 1.0, 2.0, 1.0987427008259245, 3.0, 2.0, 1.0, 2.0, 2.0, 1.0862068965517242, 1.3333333333333333, 1.0, 1.8273584905660378, 2.0, 1.0064020486555698, 2.0, 1.4768041237113403, 2.0, 1.9545454545454546, 15.5, 1.0, 2.0, 1.0, 5.721558317399618, 2.643835616438356, 1.6, 1.0, 1.2268041237113403, 1.0, 1.051948051948052, 2.0, 2.0, 1.0, 1.0, 1.0117247007616974, 1.0304636485341931, 1.2236842105263157, 2.0, 2.0, 1.0, 2.0, 2.0, 1.0, 1.0, 1.0, 6.0, 2.0, 1.0, 2.0, 1.0, 1.0535882590548, 1.0012045083025036, 2.0, 2.0, 2.0, 1.0675675675675675, 2.0, 2.0, 1.046305060065526, 1.1111111111111112, 1.393939393939394, 2.0, 1.0, 2.0, 2.3333333333333335, 4.8, 1.0, 1.0251732248426673, 2.0, 2.0, 1.263047619047619, 2.0, 1.4410480349344978, 1.0, 5.0, 3.0, 1.1522491349480968, 2.0, 2.0, 1.5542168674698795, 1.2534521006109007, 2.0, 1.5294117647058822, 1.5, 1.0, 1.1008454846219826, 2.0, 1.0, 2.0, 1.4591439688715953, 1.0, 1.0292035398230088, 1.5, 2.0, 1.0, 2.0, 2.0, 2.0, 2.0, 3.0, 1.8666666666666667, 2.0, 1.8614457831325302, 3.0, 1.009692513368984, 1.0, 1.0, 2.0, 1.0, 2.0, 3.0, 1.6363636363636365, 2.0, 2.0, 2.0, 1.335907335907336, 2.0, 1.1818181818181819, 1.2941176470588236, 1.603960396039604, 1.0]
origin-forest_39.80 	max: 68.0000	99th: 11.0071	95th: 4.0000	median: 1.3064	mean: 1.9031

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/15 | Workload-time: 27.780586 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 4/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=valueskew', '--dataset=forest', '--drift_test=distribution', '--end2end', '--update_size=25000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
ValueSample - START
ValueSample - END
load_npy_dataset_from_path - df.shape = (631012, 10)
Parsing... done, took 0.1s
Data updated!
Previous data size: (606012, 10), new data size: (25000, 10)
[5.9604645e-08 0.0000000e+00 3.5762787e-07 4.1723251e-07 4.7683716e-07
 4.8327446e-04 5.9604645e-08 4.7683716e-07 5.9604645e-08 0.0000000e+00]
Distance score: 4.851818084716797e-05
SAUCE Drift detection: True
Detection latency: 0.0853s

DRIFT-DETECTED after 4-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=forest', '--end2end', '--model=transformer', '--model_update=adapt', '--update_size=25000', '--epochs=40']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
update_size: 25000
AdaptTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (631012, 10)
Parsing... done, took 0.1s
done, took 0.1s
dataset size: 631012
train data shape: torch.Size([25000, 10]), transfer data shape:torch.Size([5000, 10])
Epoch 0 Iter 0, train entropy gap 16.6472 bits (loss 35.831, data 19.184) 0.00300 lr
epoch 10 train loss 20.6308 nats / 29.7639 bits
time since start: 5.8 secs
Epoch 10 Iter 0, train entropy gap 10.4061 bits (loss 29.590, data 19.184) 0.00256 lr
epoch 20 train loss 19.3661 nats / 27.9393 bits
time since start: 11.4 secs
Epoch 20 Iter 0, train entropy gap 8.7112 bits (loss 27.895, data 19.184) 0.00150 lr
epoch 30 train loss 18.8321 nats / 27.1689 bits
time since start: 17.3 secs
Epoch 30 Iter 0, train entropy gap 7.9485 bits (loss 27.132, data 19.184) 0.00044 lr
epoch 40 train loss 18.7385 nats / 27.0339 bits
time since start: 23.1 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 36.2961 nats / 52.3642 bits
Saved to: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
AdaptTask - END

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 4/15 | Workload-time: 2.238990 | Model-update-time: 26.106579


WORKLOAD-START | Type: QueryWorkload | Progress: 5/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=forest', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
data size: 631012, total size: 631012, split index: [525843 631012]
Parsing... done, took 0.1s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
query_seed:0
origin-forest_39.80 	max: 52.0000	99th: 10.5036	95th: 5.0000	median: 1.3766	mean: 2.2370
ReportEsts: [1.0, 1.0556356892643726, 3.0, 1.5945945945945945, 4.0, 1.0, 1.7325102880658436, 4.0, 1.3519163763066202, 3.0, 1.1029411764705883, 4.0, 1.0, 2.0, 1.2916666666666667, 1.10752688172043, 1.5, 2.0, 1.9047619047619047, 3.711853476073778, 1.0, 2.6666666666666665, 1.0434782608695652, 2.2, 5.0, 1.0, 1.043852517813591, 1.4166666666666667, 5.0, 1.084375, 3.0, 2.1176470588235294, 3.0, 1.0, 1.0, 2.0, 3.0, 3.0, 1.4444444444444444, 3.0, 1.5, 1.1899350649350648, 1.0, 1.1231958865220066, 3.0, 1.1975308641975309, 1.0, 3.0, 5.0, 3.0, 3.0, 1.0483354151957855, 4.0, 1.0, 20.0, 1.1586538461538463, 1.2790697674418605, 1.0, 1.0, 3.0, 1.2019556224144414, 10.0, 3.0, 1.0017064846416381, 1.2076923076923076, 1.0, 1.2754716981132075, 1.676923076923077, 1.5048543689320388, 1.0, 4.0, 3.0, 1.3350515463917525, 1.175357280803399, 4.0, 1.3333333333333333, 1.0, 1.0, 1.0, 10.2, 1.0, 1.0, 1.0096019274717878, 11.0, 1.2, 1.0, 1.0, 2.0, 1.1016101488167847, 3.0, 2.0, 4.0, 1.0120528771384136, 1.16, 1.0298507462686568, 1.6, 4.0, 3.0, 4.0, 1.0721821210438645, 3.0, 1.123083661848445, 3.0, 1.1322751322751323, 1.0, 1.0, 1.0973939509225794, 1.0306355385480652, 4.0, 2.0, 1.2861952861952861, 2.0, 1.128654970760234, 1.0, 3.0, 1.045613218524552, 1.2085308056872037, 4.0, 1.0, 4.0, 1.0, 1.0, 3.0, 4.0, 3.0, 1.0, 1.1844380403458212, 1.3333333333333333, 1.0, 1.375, 1.0, 3.0, 1.0, 1.4877049180327868, 1.0058725514102251, 3.0, 2.0, 3.0, 3.0, 4.0, 1.1193961573650504, 1.0547945205479452, 1.0187214789968408, 3.0, 3.0, 2.5, 1.0, 1.0116379056481537, 1.0, 1.1428571428571428, 2.6666666666666665, 1.625, 1.0771587743732591, 1.0, 1.0, 1.0, 4.0, 6.0, 1.0, 3.0, 3.0, 1.6666666666666667, 1.5454545454545454, 1.5, 1.138544645694312, 4.0, 1.105418764724904, 1.0, 4.0, 3.0, 1.0089153046062407, 1.0, 3.0, 1.2, 1.0, 1.0136233683724154, 1.0527617477328937, 3.0, 2.8446215139442232, 1.3982930298719773, 3.0, 3.0, 1.6, 1.1787234042553192, 3.0, 1.0, 1.0401573362605196, 1.0, 1.0655495317890586, 3.0, 3.0, 1.8, 1.0197391112093743, 3.0, 1.47985347985348, 1.7857142857142858, 3.0, 3.0, 1.0, 3.0, 1.225, 1.0833333333333333, 1.1410582908885116, 1.163115356355621, 1.0, 1.0, 1.0, 2.0, 1.5454545454545454, 1.114864864864865, 3.0, 3.0, 3.0, 2.0, 1.8333333333333333, 1.0, 1.0, 1.0, 3.0, 1.0, 1.1806167400881058, 1.0, 2.5, 3.0, 1.4420877521314202, 1.5, 1.0, 1.1363636363636365, 5.0, 1.819767441860465, 3.0, 1.0832627082000104, 1.1652935118434604, 1.1311475409836065, 1.0, 1.875, 1.0, 52.0, 3.0, 2.0, 2.0, 1.2952646239554317, 1.0536912751677852, 3.0, 4.0, 3.0, 1.0, 4.0, 1.75, 1.0, 1.4330708661417322, 3.3333333333333335, 4.0, 7.333333333333333, 1.3333333333333333, 1.125, 1.0, 1.4655172413793103, 1.0047608742696386, 1.1428571428571428, 9.0, 1.1157205240174672, 1.0547045951859957, 6.0, 1.0, 1.3805992736077481, 3.0, 1.5, 1.0, 2.0, 1.0, 3.0, 1.0, 1.4193548387096775, 3.0, 1.1072492552135054, 2.0214634146341464, 1.0, 1.1555183946488294, 1.0, 1.7878787878787878, 1.4490161001788908, 1.0, 3.0, 2.5, 1.0525059665871122, 1.0728155339805825, 1.111240840647395, 1.3333333333333333, 1.0, 1.0, 1.8421052631578947, 1.3174157303370786, 1.0, 1.4137931034482758, 1.0, 1.3181818181818181, 1.0, 3.0, 1.2926829268292683, 2.0, 1.0, 3.0, 1.6875, 1.0, 5.0, 1.0, 3.0, 2.0, 1.0, 1.6666666666666667, 3.0, 3.0, 1.4634146341463414, 1.5, 3.0, 1.6, 4.0, 3.0, 1.0, 3.0, 3.0, 1.0, 1.8, 1.0, 3.0, 1.0674336283185841, 1.5, 1.0, 1.0278836066478936, 1.0, 1.0, 5.0, 1.0, 1.085925925925926, 1.3333333333333333, 3.0, 1.0, 5.0, 1.3782051282051282, 4.0, 1.13, 1.2826086956521738, 1.0, 1.2435940099833611, 1.015748031496063, 1.0, 1.8421052631578947, 1.0, 8.0, 6.0, 2.6267087276551, 1.0, 3.0, 1.0, 1.0, 1.0, 1.2222222222222223, 13.0, 1.1111111111111112, 6.0, 1.0, 1.0, 1.0, 1.4308093994778068, 2.0, 1.5488721804511278, 1.0552814419494512, 1.1625117591721543, 1.0260908681961314, 1.2451902173913043, 1.4802867383512546, 1.0, 1.1711491442542787, 2.0, 3.2498955286251565, 1.273083491671534, 3.0, 1.0274933039231133, 1.0620536334583854, 1.0898453823652319, 1.0, 2.6666666666666665, 1.0, 1.1851851851851851, 10.5, 4.0, 2.0, 1.3411644535240042, 3.0, 4.0, 6.0, 3.0, 1.1830985915492958, 1.0, 1.5, 1.0, 1.0, 3.8, 5.0, 1.175064047822374, 3.0, 1.0, 1.0, 1.0, 1.0658334875378987, 1.0, 3.0, 1.0037243947858474, 1.041299420800806, 1.0483641536273116, 1.2903225806451613, 1.8866666666666667, 1.008974698635581, 1.0265486725663717, 1.4, 3.0, 1.0, 1.0335710296834058, 1.0600676103950983, 1.5, 1.4444444444444444, 5.0, 6.0, 1.0, 1.263157894736842, 1.0177950445555315, 3.0, 2.209200438116101, 1.8125, 1.0, 1.0, 1.0276243093922652, 1.95, 3.0, 3.0, 1.3100840336134454, 1.0556601769911504, 1.4, 1.3245436105476673, 1.2857142857142858, 1.0, 1.0, 3.0, 1.1812845962970033, 1.0, 1.0, 1.0385500575373994, 1.0, 1.8461538461538463, 4.0, 3.0, 3.0, 1.2940284790107541, 1.0, 3.0, 1.2, 1.45, 1.0803571428571428, 1.4444444444444444, 1.0, 1.474145486415425, 3.0, 4.0, 1.0665165636890426, 3.0, 1.0, 1.3159522757401678, 3.0, 9.0, 3.0, 1.122701437646272, 1.0, 1.0, 3.0, 6.0, 1.3650246305418718, 1.3205558488573799, 1.5981735159817352, 1.0816326530612246, 5.0, 3.0, 2.3333333333333335, 1.0, 1.0935403104656984, 1.1428571428571428, 3.0, 1.0, 1.2463768115942029, 1.3033932135728543, 1.0, 1.026582933801517, 1.5714285714285714, 2.0, 1.0040356548143794, 3.5, 1.0736295815763865, 1.0, 1.0, 1.0, 1.1108610177218075, 1.5714285714285714, 1.0, 2.5185185185185186, 1.0, 2.0, 3.0, 1.018181818181818, 3.0, 1.335195530726257, 1.3396946564885497, 4.0, 1.3333333333333333, 3.0, 1.194267515923567, 1.0, 22.0, 1.1274509803921569, 1.0, 1.3644681850780227, 14.823529411764707, 1.206896551724138, 1.5, 2.2222222222222223, 6.0, 2.0, 1.2360029662588061, 1.0, 6.0, 1.1694695989650712, 2.0, 3.0, 1.1848549186128805, 1.0276317261438639, 1.7333333333333334, 1.0, 3.0, 1.0, 1.2061855670103092, 1.0, 1.0, 1.1111111111111112, 1.0115226705746792, 1.0224719101123596, 4.6767676767676765, 2.3076923076923075, 1.4683544303797469, 1.0, 1.5217391304347827, 1.004092769440655, 3.0, 3.0, 1.4193548387096775, 1.55109765329296, 2.5, 4.0, 4.333333333333333, 1.31, 1.0, 1.0092592592592593, 1.0, 1.3804347826086956, 3.0, 3.2, 1.012165783864773, 6.0, 1.0276468740182219, 2.6666666666666665, 5.0, 2.5, 3.3333333333333335, 1.0, 1.3389830508474576, 1.2352941176470589, 1.0833333333333333, 1.103988603988604, 3.0, 1.0, 1.0, 1.1033707865168538, 1.1428571428571428, 5.0, 3.0, 1.1911764705882353, 3.0, 1.3952439524395244, 3.0, 3.0, 3.0, 3.0, 1.0, 1.3333333333333333, 3.0, 3.0, 4.0, 1.2560975609756098, 2.0, 2.0, 1.3930131004366813, 1.0, 3.0, 1.2307692307692308, 1.0035324628867823, 2.6333333333333333, 5.0, 1.0, 3.0, 1.0, 1.0187752108544188, 3.0, 2.0, 1.0896376350921806, 3.0, 1.0, 3.0, 4.0, 1.6666666666666667, 3.0, 1.0, 1.0, 1.0, 1.1333333333333333, 1.4961977186311788, 1.1476533059266871, 2.0, 1.0, 3.0, 1.0401186083044405, 1.0, 1.0, 5.0, 1.0952380952380953, 1.3507515322502188, 1.0, 1.0, 1.3636363636363635, 1.0743494423791822, 1.0, 1.0, 2.0, 3.0, 1.0, 1.0226604550183183, 1.0, 2.0, 1.003045464433326, 1.0, 1.0, 1.141304347826087, 3.0, 1.0041628122109159, 3.0, 3.0, 1.9148148148148147, 1.0715828448009874, 2.4444444444444446, 4.866666666666666, 3.0, 1.0, 6.0, 1.5327042550697456, 1.0, 3.0, 3.0, 1.0, 1.25, 3.0, 3.0, 2.0, 1.0975873244508463, 3.0, 3.0, 1.0, 1.6666666666666667, 3.0, 1.1578947368421053, 1.0240963855421688, 3.0, 3.0, 3.0, 3.0, 3.0, 1.0, 1.0909090909090908, 1.0, 1.0, 3.0, 3.0, 3.0, 3.0, 3.0, 1.0, 1.0, 1.0260869565217392, 3.0, 1.5841346153846154, 3.0, 1.0, 34.5, 3.0, 3.0, 3.0, 1.148573545757688, 1.4776119402985075, 2.0, 2.2, 1.2380952380952381, 1.0, 1.0384615384615385, 3.0, 2.0, 1.0, 5.0, 2.0, 1.0669539277427909, 1.3134920634920635, 3.0, 6.0, 1.0465116279069768, 1.1204944891271968, 1.0, 1.0, 1.079640533002789, 1.0516273849607183, 1.0275862068965518, 3.0, 3.0, 1.0, 1.2290101039157169, 1.0, 1.4166666666666667, 1.0, 3.0, 3.5, 1.0373931623931625, 3.0, 3.0, 5.0, 1.17, 1.295825771324864, 5.0, 1.5, 2.0, 1.0, 1.0705149229255493, 1.784431137724551, 1.0946346724184417, 3.0, 1.0, 5.0, 3.0, 3.0, 1.0, 1.0, 3.0, 1.0, 3.0, 2.0, 2.5, 2.23125, 2.0, 1.062072562883969, 1.0, 1.0, 1.6923076923076923, 1.8223314606741574, 8.0, 2.0, 1.0, 1.0, 1.0, 1.3125, 1.0695142378559463, 5.0, 1.0, 3.0, 3.0, 1.0, 1.5, 1.2696629213483146, 1.0, 1.0, 5.0, 3.0, 1.118867924528302, 1.2450374227139602, 1.0, 3.0, 1.3435897435897435, 1.1428571428571428, 5.0, 1.287958115183246, 3.0, 3.0, 1.0, 1.0, 1.0, 2.25, 2.0, 3.0, 1.2904411764705883, 1.1453116675546084, 1.7777777777777777, 3.0, 1.0, 1.0, 1.0, 1.1428571428571428, 3.0, 1.0, 1.694905213270142, 3.0, 1.0, 39.0, 4.0, 3.5789473684210527, 1.0, 27.304347826086957, 1.0, 3.0, 1.3661016949152542, 1.2258064516129032, 1.0, 1.051477729984737, 1.0, 1.127986348122867, 2.6, 3.0, 3.0, 1.0, 4.0, 1.2222222222222223, 1.0, 1.0, 1.0, 1.3333333333333333, 1.0990990990990992, 3.0, 3.0, 1.2241191991308398, 1.0914110174768568, 1.0, 1.0, 3.0, 1.381496780699713, 1.0, 2.488372093023256, 1.0, 1.0160595377986683, 4.0, 3.0, 1.1176470588235294, 1.5, 2.3333333333333335, 1.1525577184246265, 1.0, 4.818181818181818, 1.0, 4.0, 1.0, 3.0, 4.0, 3.0, 2.6666666666666665, 5.0, 1.0, 1.0, 1.1428571428571428, 3.0, 1.5, 3.0, 2.0, 3.0, 1.0601020868534425, 3.0, 3.0, 1.2692307692307692, 1.0, 1.0, 1.6161616161616161, 1.0, 3.0, 3.0, 1.0, 3.051282051282051, 5.0, 1.1274509803921569, 3.0, 1.1, 2.5, 3.0, 3.5, 3.0, 1.0, 1.0, 2.0, 1.0, 2.0392156862745097, 1.3413577119201372, 1.0, 1.5125786163522013, 2.0, 1.368421052631579, 1.0, 1.5783926218708828, 3.0, 3.0, 1.2021829521829521, 1.0, 1.0, 2.7222222222222223, 1.5131086142322097, 2.5, 3.0, 1.015323030482003, 1.0272016320979258, 10.857142857142858, 4.0, 3.0, 3.0, 3.0, 3.0, 1.0, 1.0, 1.0, 6.0, 2.0, 1.0, 3.0, 1.0, 1.0209817893903406, 1.300768386388584, 3.0, 3.0, 1.8181818181818181, 1.2, 3.0, 2.0, 1.001818945011893, 3.142857142857143, 1.0978260869565217, 3.0, 1.0, 3.0, 2.6666666666666665, 1.411764705882353, 1.0, 1.0694775435380386, 3.0, 3.0, 1.356060606060606, 2.0, 1.2212389380530972, 1.0558202859087815, 3.5, 4.0, 2.057239057239057, 3.0, 2.0, 1.2777777777777777, 1.3411404700349094, 3.0, 1.85, 1.0, 1.0, 1.0043854957749492, 2.0, 4.0, 3.0, 1.3977695167286246, 1.0, 1.0228720324261726, 3.0, 3.0, 1.0, 3.0, 3.0, 3.0, 3.0, 4.0, 1.1730769230769231, 3.0, 1.098901098901099, 1.0, 1.0091220843817093, 1.0, 1.0, 3.0, 1.0, 3.0, 6.0, 3.0, 3.0, 4.0, 2.0, 1.3405797101449275, 3.0, 1.3333333333333333, 1.3428571428571427, 3.0357142857142856]
origin-forest_39.80 	max: 52.0000	99th: 10.5036	95th: 5.0000	median: 1.3766	mean: 2.2370

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 5/15 | Workload-time: 28.055103 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 6/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=valueskew', '--dataset=forest', '--drift_test=distribution', '--end2end', '--update_size=25000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
ValueSample - START
ValueSample - END
load_npy_dataset_from_path - df.shape = (656012, 10)
Parsing... done, took 0.1s
Data updated!
Previous data size: (631012, 10), new data size: (25000, 10)
[0.0000000e+00 5.9604645e-08 5.9604645e-08 5.9604645e-08 4.1723251e-07
 4.9382448e-04 5.9604645e-08 5.3644180e-07 5.9604645e-08 5.9604645e-08]
Distance score: 4.9513579142512754e-05
SAUCE Drift detection: True
Detection latency: 0.0867s

DRIFT-DETECTED after 6-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=forest', '--end2end', '--model=transformer', '--model_update=adapt', '--update_size=25000', '--epochs=40']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
update_size: 25000
AdaptTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (656012, 10)
Parsing... done, took 0.1s
done, took 0.1s
dataset size: 656012
train data shape: torch.Size([25000, 10]), transfer data shape:torch.Size([5000, 10])
Epoch 0 Iter 0, train entropy gap 16.2247 bits (loss 35.358, data 19.134) 0.00300 lr
epoch 10 train loss 20.7057 nats / 29.8720 bits
time since start: 6.7 secs
Epoch 10 Iter 0, train entropy gap 10.7242 bits (loss 29.858, data 19.134) 0.00256 lr
epoch 20 train loss 19.3784 nats / 27.9571 bits
time since start: 13.4 secs
Epoch 20 Iter 0, train entropy gap 8.6625 bits (loss 27.796, data 19.134) 0.00150 lr
epoch 30 train loss 18.8389 nats / 27.1789 bits
time since start: 20.0 secs
Epoch 30 Iter 0, train entropy gap 8.0060 bits (loss 27.140, data 19.134) 0.00044 lr
epoch 40 train loss 18.7462 nats / 27.0450 bits
time since start: 26.6 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 35.7578 nats / 51.5875 bits
Saved to: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
AdaptTask - END

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 6/15 | Workload-time: 2.248636 | Model-update-time: 29.686479


WORKLOAD-START | Type: QueryWorkload | Progress: 7/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=forest', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
data size: 656012, total size: 656012, split index: [546676 656012]
Parsing... done, took 0.1s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
query_seed:0
origin-forest_39.80 	max: 69.0000	99th: 8.3370	95th: 6.0000	median: 1.3961	mean: 2.5784
ReportEsts: [1.0, 1.424056883270788, 4.0, 1.475, 8.0, 1.0, 1.5770609318996416, 6.0, 1.2106824925816024, 4.0, 1.2658227848101267, 6.0, 1.0, 2.0, 1.0416666666666667, 1.1894736842105262, 4.0, 4.0, 2.0606060606060606, 2.442918454935622, 1.0, 3.0, 1.5294117647058822, 1.8, 1.2, 1.0, 1.0475433625872435, 1.2666666666666666, 6.0, 2.1353846153846154, 4.0, 1.2857142857142858, 4.0, 1.0, 1.0, 2.0, 4.0, 4.0, 2.142857142857143, 4.0, 2.0, 1.031166039763568, 1.0, 1.0257324984275107, 4.0, 1.168384879725086, 2.0, 2.0, 7.0, 4.0, 3.0, 1.0079636235743354, 6.0, 1.0, 4.2, 1.1283185840707965, 1.184873949579832, 1.8888888888888888, 1.0, 5.0, 1.0514763934943945, 10.0, 4.0, 1.0, 4.0, 1.1271186440677967, 1.2047993126304162, 1.25, 5.0, 4.0, 3.0, 1.1079136690647482, 1.1417747392162392, 6.970588235294118, 1.0, 1.4378698224852071, 4.0, 1.0, 1.0, 1.0, 4.125, 1.0, 1.0, 1.0336436100015836, 3.25, 3.2, 1.0, 1.0, 2.3333333333333335, 1.0375968992248061, 4.0, 3.0, 6.0, 1.0987525211025622, 1.5849056603773586, 1.4339622641509433, 1.263157894736842, 1.5, 4.0, 4.0, 1.0, 4.0, 1.1238440389902524, 1.4545454545454546, 1.1666666666666667, 1.0, 4.0, 1.0, 1.1278307667714604, 2.2, 1.0, 1.0919540229885059, 1.0, 4.0, 4.0, 1.0, 1.0, 4.0, 4.0, 4.0, 4.0, 1.011173184357542, 1.0, 4.0, 5.0, 3.0, 1.0, 1.2745930644019816, 1.6, 1.0, 1.1424766977363516, 1.0, 4.0, 1.0, 1.1421340629274965, 1.038156380594755, 4.0, 1.1428571428571428, 4.0, 4.0, 5.0, 1.1052393857271907, 1.2537313432835822, 1.0103476211518634, 4.0, 4.0, 1.6666666666666667, 1.0, 1.014199419471248, 1.0, 1.1379310344827587, 2.5, 1.3076923076923077, 1.0992489270386265, 1.0, 1.0, 1.0, 6.0, 2.3333333333333335, 1.0, 4.0, 4.0, 2.0, 2.1875, 1.0, 1.0208361520768503, 4.0, 1.0070858808762198, 1.0, 1.3333333333333333, 5.0, 1.1669044222539229, 1.0, 4.0, 2.6666666666666665, 1.0, 1.0240818098362523, 1.1710992907801419, 4.0, 1.007307636841032, 1.3653136531365313, 1.0174813855616704, 9.0, 1.25, 1.0, 1.0, 1.0, 6.0, 1.0, 1.047978676143936, 4.0, 4.0, 1.1521739130434783, 1.0345297911845197, 4.0, 1.3689655172413793, 1.625, 4.0, 4.0, 1.0, 4.0, 1.1547619047619047, 1.0, 1.1650634323156281, 1.0743128605361385, 1.0, 1.0, 1.0, 1.0, 2.3636363636363638, 1.25, 4.0, 4.0, 4.0, 4.0, 1.3725490196078431, 1.0, 1.0, 1.0, 4.0, 4.0, 3.0, 1.0, 2.2, 8.333333333333334, 1.0, 1.0, 1.0928442028985508, 1.3116807457034663, 1.5357142857142858, 1.0, 1.0831333312553897, 4.0, 1.4864864864864864, 3.0, 1.3, 2.052889324191969, 1.0081967213114753, 1.0, 1.4090909090909092, 3.0, 7.0, 1.110690872415532, 1.5, 4.0, 1.0, 1.0, 6.0, 2.0, 1.0, 1.6396396396396395, 2.5, 6.0, 3.6, 1.3333333333333333, 1.687830687830688, 1.0, 1.214705882352941, 1.12940901658491, 1.4166666666666667, 1.5, 1.1297872340425532, 1.1650485436893203, 7.0, 1.0, 1.601088101088101, 5.0, 7.0, 1.0, 2.75, 1.0, 4.0, 1.0, 1.1521739130434783, 3.0, 1.2132752992383025, 1.2050610820244327, 1.0, 1.0657350915174177, 1.0, 1.0, 1.435593220338983, 1.0, 4.0, 3.0, 1.259100642398287, 1.1712962962962963, 1.0366762002355352, 1.6666666666666667, 1.2073490813648293, 1.0, 1.3125, 1.2376543209876543, 2.0, 4.027027027027027, 6.0, 4.393939393939394, 1.0, 4.0, 1.0465116279069768, 1.1428571428571428, 1.0, 4.0, 1.3557692307692308, 1.0, 1.6666666666666667, 1.0, 4.0, 2.3846153846153846, 1.0, 1.5, 4.0, 4.0, 1.4651162790697674, 1.3333333333333333, 2.0, 1.1666666666666667, 7.0, 4.0, 1.0, 4.0, 4.0, 1.0, 1.6363636363636365, 1.0, 4.0, 1.2685185185185186, 1.5, 1.0, 1.0908800850837543, 4.0, 1.0, 7.0, 1.0, 1.288148148148148, 2.5, 3.0, 1.5, 4.0, 3.0714285714285716, 6.0, 1.0566037735849056, 2.0208333333333335, 1.0, 1.1746997348307597, 1.0384615384615385, 1.0, 1.1666666666666667, 1.0, 8.0, 3.1538461538461537, 2.026275115919629, 1.0, 4.0, 1.0, 1.0, 1.0, 1.9333333333333333, 14.0, 1.0555555555555556, 6.0, 1.0, 4.0, 2.0280898876404496, 1.177685950413223, 1.0364013781591732, 6.0, 1.2436548223350254, 1.0769230769230769, 1.0496407576747224, 1.125, 1.3706293706293706, 1.0, 2.1900990099009903, 1.0, 2.2122749317130275, 1.2640708856621352, 4.0, 1.0337494321009022, 1.1108534711551892, 1.159702612860564, 1.0, 3.3333333333333335, 1.0, 1.0738255033557047, 7.666666666666667, 6.0, 2.0, 1.2903533906399236, 5.0, 1.4285714285714286, 8.0, 4.0, 1.0, 1.1666666666666667, 1.0, 1.0, 1.0, 10.0, 7.0, 1.2018502943650127, 4.0, 1.0, 1.0, 1.0, 1.0468783638320776, 1.0, 5.0, 1.0105633802816902, 1.212142358688067, 1.0835694050991502, 1.7333333333333334, 1.3993610223642172, 1.02795726856512, 1.1799410029498525, 2.013888888888889, 4.0, 1.0, 1.0167459168906348, 1.0024806832045547, 5.0, 4.666666666666667, 7.0, 8.0, 1.0, 1.25, 1.0734189280107647, 4.0, 1.8436928702010968, 1.4021739130434783, 1.0, 1.0, 1.0585106382978724, 3.0, 4.0, 4.0, 1.2488443759630201, 1.033748192522206, 1.6, 1.3747368421052633, 1.75, 1.0, 1.0, 4.0, 1.1685808314863322, 1.0, 1.0, 1.4598930481283423, 1.0, 1.509433962264151, 6.0, 4.0, 4.0, 1.2526142896249657, 1.0, 4.0, 4.0, 3.3333333333333335, 1.0172413793103448, 2.5, 1.0, 1.203883495145631, 5.0, 6.0, 1.0849361440221572, 4.0, 1.0, 1.2701921090683743, 5.0, 2.625, 4.0, 1.0929559343840463, 1.0, 1.0, 4.0, 1.1666666666666667, 1.4690912946665253, 1.2277981882453077, 1.2119205298013245, 6.0, 7.0, 4.0, 1.3333333333333333, 1.0, 1.015542521994135, 1.3714285714285714, 1.5, 1.25, 1.2515151515151515, 1.5061946902654868, 1.0, 1.0172665578558544, 2.6666666666666665, 2.0, 1.0092450069361305, 4.0, 1.0354780517137703, 1.0, 1.0, 1.0, 1.2405816469390352, 2.3333333333333335, 1.0, 1.75, 1.0, 4.0, 5.0, 2.9, 1.5, 1.1237113402061856, 2.2841726618705036, 5.0, 1.0, 4.0, 1.1073446327683616, 1.0, 8.695652173913043, 1.1090909090909091, 1.0, 1.2407240836519002, 1.0255474452554745, 1.0689655172413792, 4.0, 2.75, 8.0, 2.5, 1.011673719538888, 1.0, 7.0, 1.4641509433962263, 1.0, 1.1428571428571428, 1.0, 5.0, 2.0, 2.3333333333333335, 1.0, 1.0539861895794098, 2.0, 1.0, 1.256281407035176, 2.0, 1.0299398932170607, 1.0, 4.0, 1.0588472390165256, 1.0, 1.0, 1.2312925170068028, 1.2294117647058824, 6.0, 1.3623188405797102, 1.3137632338787295, 1.6666666666666667, 5.0, 3.0, 1.0, 1.0, 1.073394495412844, 1.0, 1.233644859813084, 4.0, 2.5714285714285716, 1.0079797238546877, 1.4, 1.373385975367501, 1.5, 7.0, 6.0, 1.1702127659574468, 1.0, 1.2857142857142858, 5.666666666666667, 1.3928571428571428, 1.0714285714285714, 4.0, 1.0, 1.0, 1.0021505376344086, 1.1111111111111112, 1.0334918337812693, 1.582546494992847, 1.0, 4.0, 6.0, 1.0, 4.0, 4.0, 4.0, 1.0, 5.0, 4.0, 4.0, 5.0, 2.80327868852459, 3.0869565217391304, 2.5, 1.1603053435114503, 1.0, 4.0, 1.6, 1.0218587693048533, 1.6451612903225807, 7.0, 1.0, 5.0, 1.0, 1.0994862036156041, 4.0, 2.0, 1.0789156626506025, 4.0, 1.0, 4.0, 2.2, 3.0, 5.0, 1.0, 1.0, 1.0, 1.3333333333333333, 1.271604938271605, 1.0371588293324565, 5.0, 1.0, 4.0, 1.0338013856812933, 1.0, 1.0, 7.0, 1.2083333333333333, 1.242783297529538, 1.0, 2.0, 2.0, 1.0180831826401446, 1.0, 1.0, 1.6666666666666667, 4.0, 1.0, 1.0829537612146307, 1.0, 2.0, 1.1686922702965483, 1.0, 1.0, 1.0483769633507853, 4.0, 1.1289214056091343, 5.0, 4.0, 4.0, 1.2311320754716981, 4.0, 1.0, 4.0, 1.5714285714285714, 4.0, 1.0106343896827086, 1.0029852612494334, 4.0, 7.0, 4.555555555555555, 4.0, 5.0, 1.6666666666666667, 1.0, 1.0, 1.1069817851274342, 1.0, 4.0, 2.1666666666666665, 1.6694214876033058, 1.0785714285714285, 1.5092348284960422, 1.035820895522388, 1.0, 1.6849315068493151, 1.048780487804878, 1.0909090909090908, 2.5, 3.0, 4.0, 1.0, 4.0, 1.1647058823529413, 4.0, 1.7252336448598131, 4.0, 5.0, 3.3333333333333335, 1.0, 1.5234159779614325, 4.0, 1.184, 4.0, 1.0, 69.0, 4.0, 4.0, 4.0, 1.0873889875666074, 1.4776119402985075, 2.0, 1.7142857142857142, 56.0, 1.25, 1.3214285714285714, 4.0, 3.0, 1.0, 7.0, 3.0, 1.0338037413849688, 1.0266272189349113, 4.0, 7.0, 1.0518518518518518, 1.0191718875123652, 1.0, 1.0, 1.1258609893550406, 1.0870967741935484, 1.5384615384615385, 1.5555555555555556, 4.0, 4.0, 2.664429530201342, 1.1073770491803279, 1.2307692307692308, 4.0, 4.0, 4.0, 1.215007215007215, 4.0, 1.2280701754385965, 1.0, 4.0, 1.064516129032258, 7.0, 3.0, 2.0, 1.0, 1.1080214465937763, 2.3, 1.0811431487624394, 4.0, 1.0, 6.0, 4.0, 4.0, 1.0, 1.0, 4.0, 2.0, 4.0, 2.0, 3.0, 1.3271375464684014, 2.0, 1.002329940612792, 1.0, 1.0, 1.2083333333333333, 1.7416107382550337, 3.6666666666666665, 1.6666666666666667, 1.0, 1.0, 1.0, 1.7, 1.2620192307692308, 6.0, 1.0, 4.0, 4.0, 1.0, 4.0, 1.236013986013986, 1.0, 1.0, 8.0, 4.0, 1.0122641509433963, 1.3600937591561677, 1.0, 4.0, 1.8807339449541285, 1.6666666666666667, 8.0, 1.4482758620689655, 5.0, 4.0, 1.0, 1.0, 1.0, 1.2666666666666666, 2.0, 4.0, 1.2491349480968859, 1.1254977520873475, 1.3846153846153846, 4.0, 2.6462625936734665, 1.0, 1.162162162162162, 4.0, 4.0, 4.0, 1.0472715369507453, 1.6875, 1.0, 1.0, 1.1203830369357046, 1.0975413434801697, 1.0, 3.0, 4.0, 1.5714285714285714, 1.0, 1.2823502161828289, 1.6666666666666667, 1.0930783242258653, 2.625, 1.01218428734611, 1.0, 1.2034188034188034, 1.1666666666666667, 4.0, 4.0, 1.0, 5.0, 1.35, 2.6666666666666665, 2.25, 2.0, 4.0, 4.0, 1.0, 1.0, 2.0224719101123596, 1.5, 1.0, 8.0, 1.6985221674876847, 1.6181818181818182, 5.0, 1.0, 1.5102711585866886, 6.0, 1.0740740740740742, 5.0, 4.0, 1.0, 1.0, 2.6666666666666665, 1.1428571428571428, 1.0, 3.0, 1.0, 1.2, 1.3333333333333333, 4.0, 5.0, 4.0, 2.6666666666666665, 5.0, 1.0, 1.0, 1.8, 5.0, 1.1666666666666667, 4.0, 7.0, 4.0, 1.0488016613331517, 4.0, 4.0, 1.2777777777777777, 1.0, 1.0, 2.3703703703703702, 1.0, 4.0, 4.0, 1.0, 42.0, 6.0, 1.0480769230769231, 5.0, 1.0, 8.0, 4.0, 8.0, 4.0, 1.0, 1.0, 2.0, 1.0, 1.223529411764706, 1.2732804648241205, 1.0, 1.0780590717299579, 1.0, 1.1014492753623188, 1.0, 1.3358033007746717, 4.0, 1.3333333333333333, 1.0069513406156902, 1.0, 1.0, 4.076923076923077, 1.6420233463035019, 3.5, 5.0, 1.0423899652816664, 1.0647677178704646, 30.4, 6.0, 4.0, 5.0, 4.0, 4.0, 1.0, 5.0, 1.0, 6.0, 2.0, 1.0, 4.0, 1.0, 1.110738255033557, 1.0139186295503213, 4.0, 4.0, 2.2, 1.032258064516129, 4.0, 2.0, 1.017833797056753, 1.0416666666666667, 1.1174089068825912, 4.0, 1.0, 4.0, 3.0, 1.606060606060606, 1.0, 1.0312095540651842, 4.0, 4.0, 1.1421804752729607, 3.0, 1.2672413793103448, 1.0614672835426306, 2.25, 5.0, 1.0666666666666667, 4.0, 1.0, 1.3432835820895523, 1.0, 4.0, 1.5, 4.0, 5.0, 1.1313799621928167, 2.0, 1.0, 4.0, 1.5, 1.1424870466321244, 1.0, 1.2649896623018608, 1.5, 4.0, 1.0, 4.0, 4.0, 4.0, 4.0, 5.0, 2.2, 4.0, 1.076950354609929, 3.0, 1.0229647860658841, 1.0, 1, 4.0, 1.0, 4.0, 9.0, 2.1176470588235294, 4.0, 6.0, 2.0, 1.226027397260274]
origin-forest_39.80 	max: 69.0000	99th: 8.3370	95th: 6.0000	median: 1.3961	mean: 2.5784

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 7/15 | Workload-time: 28.279100 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 8/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=valueskew', '--dataset=forest', '--drift_test=distribution', '--end2end', '--update_size=25000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
ValueSample - START
ValueSample - END
load_npy_dataset_from_path - df.shape = (681012, 10)
Parsing... done, took 0.1s
Data updated!
Previous data size: (656012, 10), new data size: (25000, 10)
[-2.9802322e-08  0.0000000e+00  1.1920929e-07  0.0000000e+00
  2.3841858e-07  3.7831068e-04 -2.9802322e-08  9.5367432e-07
  1.1920929e-07  5.9604645e-08]
Distance score: 3.7974117731209844e-05
SAUCE Drift detection: True
Detection latency: 0.0895s

DRIFT-DETECTED after 8-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=forest', '--end2end', '--model=transformer', '--model_update=adapt', '--update_size=25000', '--epochs=40']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
update_size: 25000
AdaptTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (681012, 10)
Parsing... done, took 0.1s
done, took 0.1s
dataset size: 681012
train data shape: torch.Size([25000, 10]), transfer data shape:torch.Size([5000, 10])
Epoch 0 Iter 0, train entropy gap 16.0643 bits (loss 35.134, data 19.070) 0.00300 lr
epoch 10 train loss 20.6998 nats / 29.8635 bits
time since start: 5.7 secs
Epoch 10 Iter 0, train entropy gap 10.5835 bits (loss 29.654, data 19.070) 0.00256 lr
epoch 20 train loss 19.3837 nats / 27.9648 bits
time since start: 11.3 secs
Epoch 20 Iter 0, train entropy gap 8.7581 bits (loss 27.828, data 19.070) 0.00150 lr
epoch 30 train loss 18.8407 nats / 27.1814 bits
time since start: 17.0 secs
Epoch 30 Iter 0, train entropy gap 8.0432 bits (loss 27.113, data 19.070) 0.00044 lr
epoch 40 train loss 18.7438 nats / 27.0416 bits
time since start: 22.6 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 35.1443 nats / 50.7025 bits
Saved to: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
AdaptTask - END

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 8/15 | Workload-time: 2.269824 | Model-update-time: 25.634666


WORKLOAD-START | Type: QueryWorkload | Progress: 9/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=forest', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
data size: 681012, total size: 681012, split index: [567510 681012]
Parsing... done, took 0.1s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
query_seed:0
origin-forest_39.80 	max: 127.0000	99th: 11.0000	95th: 8.0000	median: 1.5000	mean: 3.2795
ReportEsts: [6.0, 1.113550021105952, 2.5, 1.903225806451613, 8.0, 1.0, 1.196078431372549, 9.0, 1.6229508196721312, 5.0, 1.072289156626506, 8.0, 1.0, 1.5, 1.1602564102564104, 1.0206185567010309, 5.0, 7.0, 4.352941176470588, 2.1965090815406416, 1.0, 8.0, 7.0, 1.0, 1.0784313725490196, 5.0, 1.418421052631579, 6.0, 1.0, 5.5, 1.1428571428571428, 1.0, 1.0, 5.0, 1.0, 2.0, 5.0, 2.375, 5.0, 5.0, 3.0, 5.0, 1.206896551724138, 5.0, 1.6783216783216783, 1.1685393258426966, 1.0, 6.0, 1.0, 5.0, 3.0, 1.0861605862257804, 8.0, 1.0, 7.333333333333333, 1.112033195020747, 127.0, 1.1176470588235294, 1.0, 8.0, 1.0664547818549552, 10.0, 6.0, 1.0, 5.0, 1.0719424460431655, 1.0339682726897446, 1.2727272727272727, 6.0, 6.0, 1.6666666666666667, 1.1093247588424437, 1.1087983188630206, 1.1829268292682926, 1.0, 1.1571428571428573, 5.0, 1.0, 1.0, 1.0, 5.833333333333333, 1.0, 1.0, 1.0831351389727024, 7.5, 1.5454545454545454, 1.0, 1.0, 4.0, 1.0255543822597677, 5.0, 4.0, 8.0, 1.010564898663217, 1.6607142857142858, 1.0240963855421688, 2.1818181818181817, 8.0, 5.0, 6.0, 4.0, 5.0, 1.1296319557844492, 2.4615384615384617, 9.0, 1.0, 5.0, 1.0, 1.1111210556640134, 2.1666666666666665, 1.0, 1.0, 1.0, 6.0, 5.0, 1.0, 1.0, 5.0, 5.0, 5.0, 6.0, 1.1147540983606556, 1.0, 5.0, 3.0, 3.0, 1.0, 1.0719656283566057, 1.6363636363636365, 1.0, 1.0965250965250966, 1.0, 5.0, 1.0, 1.4540229885057472, 1.0966090193094655, 2.5, 1.75, 5.0, 5.0, 6.0, 1.0448334756618276, 1.1204819277108433, 1.011580272748231, 5.0, 5.0, 2.5, 1.0, 1.0143368193845632, 1.0, 1.0, 2.2857142857142856, 3.25, 1.0959648215209519, 1.0, 1.0, 1.0, 8.0, 4.0, 1.0, 5.0, 5.0, 1.75, 1.8, 2.5, 1.3064345991561181, 4.0, 1.0019367083704536, 1.0, 1.3333333333333333, 7.0, 1.3794520547945206, 1.0, 5.0, 2.0, 1.0, 1.0725487175021269, 1.1804413673734313, 5.0, 1.0123678001221688, 1.2142857142857142, 1.0595572185843467, 13.0, 2.5, 1.0, 1.0, 1.0, 7.0, 1.0, 1.0403191337797406, 5.0, 6.0, 1.3571428571428572, 1.0245269567070123, 5.0, 1.2549019607843137, 1.1082666831362133, 6.0, 2.489795918367347, 1.8258426966292134, 1.1532824427480917, 5.0, 5.0, 5.5, 8.0, 2.75, 1.0, 1.0, 5.0, 2.0, 3.218978102189781, 5.5, 1.1735537190082646, 31.0, 5.0, 6.0, 1.1044776119402986, 1.0, 1.0, 1.0, 5.0, 6.0, 9.0, 1.0, 3.25, 4.833333333333333, 1.0, 1.0, 1.0161194029850746, 1.1064935064935064, 1.4545454545454546, 1.0, 1.0941323358091202, 5.0, 8.0, 1.0, 1.0, 1.7, 1.0, 1.7692307692307692, 5.0, 1.0, 1.0, 1.2740294006784771, 1.1748251748251748, 5.0, 4.0, 7.0, 1.0, 9.0, 1.1666666666666667, 1.0, 1.4387351778656126, 2.5, 8.0, 3.142857142857143, 1.3333333333333333, 2.589041095890411, 1.0, 1.566820276497696, 1.3502673796791445, 1.3846153846153846, 2.0, 1.1618181818181819, 1.1093439363817097, 8.0, 1.0, 1.3331871985971064, 7.0, 1.3333333333333333, 1.0, 2.4, 1.0, 5.0, 1.0, 1.170731707317073, 3.0, 1.8139913232104121, 1.4477848101265822, 1.0, 1.5972222222222223, 1.0, 1.3111111111111111, 1.2697274031563845, 1.0, 5.0, 2.8, 1.486404833836858, 1.0044444444444445, 1.0398039301373654, 3.0, 1.0753880266075388, 1.0, 1.5333333333333334, 1.005, 2.0, 1.2117647058823529, 9.0, 1.6137931034482758, 1.0, 5.0, 1.0869565217391304, 8.0, 1.0, 5.0, 1.401360544217687, 1.0, 1.125, 1.0, 5.0, 2.0, 1.0, 2.3333333333333335, 5.0, 5.0, 1.1785714285714286, 1.25, 5.0, 6.666666666666667, 10.0, 5.0, 1.0, 5.0, 5.0, 1.0, 1.2, 1.0, 5.0, 1.2195535026943802, 1.0, 1.0, 1.0467524478392372, 6.0, 1.0, 9.0, 1.0, 1.7110266159695817, 3.0, 3.0, 1.125, 5.0, 5.375, 8.0, 1.018181818181818, 2.2238805970149254, 2.0, 1.0739653654241268, 1.153225806451613, 1.0, 1.8421052631578947, 3.0, 8.0, 14.0, 1.888302364864865, 1.0, 5.0, 1.0, 1.0, 1.0, 1.083916083916084, 3.0, 1.09, 6.0, 1.0, 6.0, 1.0726256983240223, 1.1452702702702702, 1.017570727305047, 7.0, 1.1972477064220184, 7.636363636363637, 1.0811684424757573, 1.8888888888888888, 1.1015037593984962, 3.4444444444444446, 1.3838951310861423, 3.0, 2.124123246492986, 1.1692794322838076, 5.0, 1.0301029811426845, 1.0200034573876966, 1.1242749224335626, 1.0, 3.0, 1.0, 1.06875, 1.7857142857142858, 9.0, 2.0, 1.135183527305282, 7.0, 3.0, 3.3333333333333335, 5.0, 1.05, 1.0, 1.6, 1.0, 1.0, 7.0, 9.0, 1.1051454138702461, 5.0, 1.0, 1.0, 1.0, 1.0372664422113136, 1.0, 1.2142857142857142, 1.340867279894875, 5.0, 1.4285714285714286, 1.0, 1.0, 1.0231232698257613, 2.3116837024417944, 1.0724637681159421, 5.0, 1.0, 1.024168642531232, 1.034512476985153, 7.0, 1.4666666666666666, 9.0, 10.0, 1.0, 1.056910569105691, 1.0456481724953983, 5.0, 2.0623721881390593, 97.0, 1.0, 1.0, 1.115606936416185, 1.9565217391304348, 8.0, 5.0, 1.002375296912114, 1.0341343222289974, 2.25, 1.2704280155642023, 1.4736842105263157, 1.0, 1.0, 5.0, 1.1551051399405226, 1.5, 1.0, 1.1352459016393444, 4.0, 1.0, 1.1807909604519775, 5.0, 5.0, 1.4322033898305084, 2.3333333333333335, 1.6521739130434783, 2.0, 1.021722265321955, 5.0, 4.0, 1.0, 5.0, 8.0, 1.0009878586264545, 1.0, 1.0, 1.0157894736842106, 1.3070866141732282, 5.0, 1.0, 1.0, 8.0, 1.3311688311688312, 6.0, 1.0006942034015966, 1.0284786126753414, 3.5, 3.3333333333333335, 1.2722063037249283, 1.0, 5.0, 1.0, 1.0526315789473684, 1.0, 1.0, 1.0, 2.466666666666667, 1.105263157894737, 1.0412972185108709, 5.0, 1.1333333333333333, 1.0, 1.375, 5.0, 2.5, 1.0, 1.0, 1.0, 1.111193444959031, 7.0, 1.6666666666666667, 1.9310344827586208, 1.0, 6.0, 7.0, 2.4, 1.0, 1.2919254658385093, 1.3003412969283277, 6.0, 3.0, 5.0, 1.3304878048780489, 1.36, 24.0, 1.0310077519379846, 1.0, 1.1881177458601606, 1.4372881355932203, 1.1, 5.0, 7.0, 5.0, 1.0, 1.0, 10.0, 1.0720631786771964, 2.75, 1.6363636363636365, 6.0, 1.0, 1.2662798194713087, 5.0, 6.0, 9.0, 2.0, 1.0792922673656618, 3.0256410256410255, 1.0, 1.5678391959798994, 2.0, 1.0010803678563995, 1.0, 5.0, 1.1535769828926905, 1.0, 1.0, 1.2549019607843137, 1.2882352941176471, 8.0, 1.1782178217821782, 1.5336640680368534, 1.6666666666666667, 2.0, 8.5, 1.0719424460431655, 1.0, 1.6168831168831168, 1.0, 1.1956521739130435, 6.0, 3.3333333333333335, 1.0434150993283047, 1.6666666666666667, 1.2172410757515735, 1.0786516853932584, 9.0, 7.0, 1.2261904761904763, 1.0, 1.0461538461538462, 1.4705882352941178, 1.59375, 1.0703947368421052, 5.0, 1.0, 1.0, 1.5934426229508196, 1.4285714285714286, 1.0459363957597174, 1.4077373377449733, 1.0, 5.0, 1.75, 1.0, 5.0, 5.0, 5.0, 1.0, 6.0, 5.0, 5.0, 6.0, 1.6635514018691588, 1.2278397898883782, 1.0253807106598984, 5.0, 5.0, 1.6, 5.0, 5.0, 5.0, 9.0, 1.0, 7.0, 1.0, 1.0333088823686316, 5.0, 1.5, 1.0506756756756757, 5.0, 1.0, 5.0, 1.1666666666666667, 3.5, 7.0, 1.0, 1.0, 1.0, 2.3, 1.0378824672170957, 1.156813152070819, 3.0, 1.0, 5.0, 1.0055349915245442, 1.0, 1.0, 9.0, 4.166666666666667, 1.298803802574806, 1.0, 2.5, 1.4166666666666667, 1.1358234295415959, 1.0, 1.0, 1.2, 5.0, 1.0, 1.0734894326054547, 1.0, 2.0, 1.1954545454545455, 1.0, 1.0, 1.1034343434343434, 5.0, 1.215022874773912, 7.0, 5.0, 6.0, 1.2897637795275592, 5.0, 1.0, 5.0, 1.7142857142857142, 5.0, 1.0428177310517093, 1.0290239092925808, 5.0, 10.0, 3.142857142857143, 5.0, 3.6666666666666665, 1.2, 1.0, 1.0, 1.046908100474125, 1.0, 5.0, 3.75, 1.0714285714285714, 1.2635658914728682, 1.2576142131979695, 1.0740740740740742, 2.0, 1.6666666666666667, 1.2045454545454546, 1.5909090909090908, 7.0, 3.0, 5.0, 1.0, 5.0, 1.0196078431372548, 5.0, 1.55, 5.0, 7.0, 5.5, 5.0, 1.405759162303665, 5.0, 1.3310344827586207, 5.0, 1.0, 69.0, 5.0, 5.0, 5.0, 1.0505119453924914, 1.434782608695652, 2.0, 1.8571428571428572, 59.0, 1.5, 1.1724137931034482, 5.0, 1.6666666666666667, 5.0, 9.0, 5.0, 1.0134146341463415, 1.259515570934256, 5.0, 2.0, 1.35, 1.062911681677645, 1.0, 1.0, 1.08134110787172, 1.0906040268456376, 1.7852760736196318, 4.5, 6.0, 5.0, 2.586826347305389, 1.1796020556067992, 4.166666666666667, 5.0, 5.0, 1.6666666666666667, 1.0942472460220318, 5.0, 6.444444444444445, 1.0, 5.0, 1.2424242424242424, 9.0, 3.0, 2.0, 1.0, 1.034364087251379, 2.098265895953757, 1.0622171945701357, 5.0, 1.0, 7.0, 8.0, 5.0, 1.0, 1.0, 5.0, 1.0, 5.0, 2.0, 7.0, 1.7163461538461537, 2.0, 1.0226529980391483, 1.0, 1.0, 1.3, 1.0613496932515338, 7.0, 2.0, 1.0, 1.0, 1.0, 1.3846153846153846, 1.0337682271680737, 7.0, 1.0, 6.0, 5.0, 1.0, 5.0, 1.0601092896174864, 1.0, 1.0, 10.0, 5.0, 1.1546840958605664, 1.257462686567164, 1.0, 5.0, 1.0591133004926108, 1.5833333333333333, 11.0, 1.3630573248407643, 7.0, 5.0, 1.0, 1.0, 1.0, 1.25, 1.5, 5.0, 1.2926829268292683, 1.2807240393775803, 1.25, 5.0, 2.2463321483209877, 1.0, 1.375, 5.0, 7.5, 5.0, 1.1470963082543864, 1.875, 1.0, 1.0, 1.088310580204778, 1.0611812857243668, 1.0, 7.0, 5.0, 1.0769230769230769, 1.0, 1.3779371051323916, 3.4716981132075473, 1.493900921085387, 1.0357142857142858, 1.0210449039520373, 1.0, 1.1941097724230254, 1.1428571428571428, 5.0, 5.0, 1.0, 6.0, 1.5714285714285714, 1.2, 6.5, 2.0, 6.0, 5.0, 1.0, 1.0, 1.0568181818181819, 3.0, 1.0, 11.0, 1.1607026675341574, 1.1772151898734178, 6.0, 1.0, 1.5796019900497513, 1.0213979397851365, 1.0, 1.1875, 5.0, 5.0, 5.0, 2.0, 1.5, 1.0, 1.4285714285714286, 1.3449691991786448, 7.0, 1.0, 1.8571428571428572, 1.0648648648648649, 5.0, 1.116295025728988, 1.0, 5.0, 5.0, 7.0, 1.0526315789473684, 1.0, 5.0, 1.0, 5.0, 6.0, 5.0, 5.0, 5.0, 5.0, 5.0, 1.0, 5.0, 1.0432336393248445, 6.0, 5.0, 1.0, 5.0, 7.0, 1.12, 11.0, 5.0, 4.5, 5.0, 1.0, 1.0, 2.0, 1.0, 1.1142857142857143, 1.241648347688205, 9.0, 1.70125786163522, 2.0, 1.028169014084507, 1.0, 1.4149116436698137, 5.0, 5.0, 1.356769596199525, 1.0, 1.0, 1.7352941176470589, 1.111392405063291, 4.5, 7.0, 1.069836472556533, 1.1213669331356875, 2.814814814814815, 8.0, 6.0, 7.0, 5.0, 5.0, 1.0, 8.0, 1.0, 6.0, 2.0, 1.0, 5.0, 1.0, 1.0492038788459237, 1.1697154471544715, 5.0, 5.0, 2.6666666666666665, 1.0153846153846153, 5.0, 2.0, 1.0657597833795371, 1.625, 1.1521739130434783, 6.0, 1.0, 5.0, 3.3333333333333335, 1.6, 1.0, 1.0500439479429526, 5.0, 5.0, 1.1241898234373835, 8.0, 1.367816091954023, 1.0025673940949935, 3.6666666666666665, 6.0, 1.2282958199356913, 5.0, 2.0, 1.0674157303370786, 1.0, 5.0, 3.1875, 5.0, 6.0, 1.1571050308914386, 1.6, 1.0, 5.0, 1.25, 1.2139303482587065, 1.0, 1.3420015760441293, 1.5, 5.0, 1.0, 5.0, 5.0, 5.0, 5.0, 6.0, 1.9189189189189189, 5.0, 1.1132208157524612, 3.0, 1.0029119622695442, 1.0, 1.0, 5.0, 1.0, 5.0, 12.0, 3.272727272727273, 5.0, 8.0, 2.0, 1.1838709677419355]
origin-forest_39.80 	max: 127.0000	99th: 11.0000	95th: 8.0000	median: 1.5000	mean: 3.2795

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 9/15 | Workload-time: 28.558676 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 10/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=valueskew', '--dataset=forest', '--drift_test=distribution', '--end2end', '--update_size=25000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
ValueSample - START
ValueSample - END
load_npy_dataset_from_path - df.shape = (706012, 10)
Parsing... done, took 0.1s
Data updated!
Previous data size: (681012, 10), new data size: (25000, 10)
[0.0000000e+00 0.0000000e+00 1.7881393e-07 2.9802322e-07 2.3841858e-07
 4.6551228e-04 5.9604645e-08 7.7486038e-07 5.9604645e-08 0.0000000e+00]
Distance score: 4.6712160838069394e-05
SAUCE Drift detection: True
Detection latency: 0.0928s

DRIFT-DETECTED after 10-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=forest', '--end2end', '--model=transformer', '--model_update=adapt', '--update_size=25000', '--epochs=40']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
update_size: 25000
AdaptTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (706012, 10)
Parsing... done, took 0.1s
done, took 0.1s
dataset size: 706012
train data shape: torch.Size([25000, 10]), transfer data shape:torch.Size([5000, 10])
Epoch 0 Iter 0, train entropy gap 15.9663 bits (loss 34.965, data 18.999) 0.00300 lr
epoch 10 train loss 20.5632 nats / 29.6664 bits
time since start: 5.9 secs
Epoch 10 Iter 0, train entropy gap 10.4600 bits (loss 29.459, data 18.999) 0.00256 lr
epoch 20 train loss 19.2579 nats / 27.7833 bits
time since start: 11.6 secs
Epoch 20 Iter 0, train entropy gap 8.7400 bits (loss 27.739, data 18.999) 0.00150 lr
epoch 30 train loss 18.7181 nats / 27.0045 bits
time since start: 18.2 secs
Epoch 30 Iter 0, train entropy gap 7.9463 bits (loss 26.945, data 18.999) 0.00044 lr
epoch 40 train loss 18.6144 nats / 26.8550 bits
time since start: 24.9 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 34.8382 nats / 50.2609 bits
Saved to: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
AdaptTask - END

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 10/15 | Workload-time: 2.283694 | Model-update-time: 27.950372


WORKLOAD-START | Type: QueryWorkload | Progress: 11/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=forest', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
data size: 706012, total size: 706012, split index: [588343 706012]
Parsing... done, took 0.1s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
query_seed:0
origin-forest_39.80 	max: 26.2000	99th: 15.0100	95th: 10.0500	median: 1.5000	mean: 3.5160
ReportEsts: [1.0, 1.0948825350573665, 6.0, 2.107142857142857, 8.0, 1.0, 1.3464788732394366, 13.0, 1.1830238726790452, 6.0, 1.0919540229885059, 5.0, 1.0, 2.0, 1.3496932515337423, 1.1647058823529413, 6.0, 10.0, 1.725, 2.0909231562661166, 1.0, 11.0, 9.0, 1.0, 1.0463576158940397, 7.0, 1.424936386768448, 14.0, 1.6, 3.0, 3.0, 1.0, 1.0, 6.0, 1.0, 2.0, 7.0, 7.666666666666667, 6.0, 11.0, 3.5, 6.0, 1.0666666666666667, 6.0, 1.251700680272109, 1.3568464730290457, 1.0, 3.5, 1.0, 6.0, 3.0, 2.8297872340425534, 10.0, 1.0, 2.090909090909091, 1.00355871886121, 3.3555555555555556, 1.3529411764705883, 1.0, 11.0, 1.0569368839193762, 1.1111111111111112, 8.0, 1.0, 6.0, 2.0, 1.1176470588235294, 1.0, 1.2380952380952381, 1.0, 17.0, 1.90625, 1.134649553711407, 1.5, 1.0, 1.1893004115226338, 6.0, 1.0, 1.0, 1.0, 2.8333333333333335, 1.0, 1.0, 1.0244995711765943, 8.5, 10.0, 1.02, 1.372093023255814, 6.0, 1.0, 1.394379246448425, 6.0, 9.0, 1.2159668049792531, 6.0, 1.1701807228915662, 6.0, 9.0, 1.8717948717948718, 1.2593582887700534, 5.0, 1.0305676855895196, 6.0, 2.0, 11.0, 1.0357142857142858, 1.2114285714285715, 3.5663430420711975, 6.0, 1.6126126126126126, 2.6315789473684212, 1.0, 1.3529411764705883, 5.5, 1.0, 2.0, 1.0, 6.0, 1.0, 1.0555555555555556, 10.0, 1.0, 6.5, 1.1972789115646258, 1.5, 11.0, 1.3846153846153846, 2.0, 13.0, 1.0153119092627598, 1.0, 6.0, 1.0, 1.4008389261744967, 1.007478903335627, 2.0, 2.125, 6.0, 6.0, 7.0, 1.0620659722222223, 1.1348314606741574, 1.0798562997177317, 6.0, 6.0, 2.5, 1.0, 1.0203684882599744, 1.0, 1.1714285714285715, 1.34, 1.8461538461538463, 1.127, 1.0, 1.0, 1.0, 10.0, 9.0, 1.0, 6.0, 6.0, 1.6, 1.7619047619047619, 6.0, 1.19659117441046, 4.0, 1.0677141489870792, 1.0, 1.3333333333333333, 4.5, 1.2342105263157894, 1.0, 6.0, 1.7142857142857142, 1.0, 1.0167644042390933, 1.0229007633587786, 6.0, 1.0054050556565906, 1.1607669616519174, 1.0252540806898676, 18.0, 2.0, 1.0, 1.0, 1.0, 8.0, 1.0, 1.1053931659118978, 6.0, 8.0, 5.0, 1.0115500462476184, 6.0, 1.0807453416149069, 1.075538754964804, 7.0, 25.2, 1.2781065088757397, 1.0507076262660138, 6.0, 6.0, 2.7, 10.0, 2.2083333333333335, 1.0, 1.0, 6.0, 6.0, 1.0165656565656567, 4.0, 1.0873015873015872, 3.393939393939394, 6.0, 8.0, 1.2, 1.0, 1.0, 1.0, 6.0, 9.0, 12.0, 1.0, 2.5, 3.3, 1.0, 1.0, 1.036783660519532, 1.0256831723854531, 1.4324324324324325, 1.0, 1.0786379008746356, 6.0, 11.0, 1.0, 1.0, 1.0, 1.0, 17.333333333333332, 6.0, 2.0, 1.0, 1.3902691511387164, 1.196629213483146, 6.0, 4.0, 9.0, 1.0, 4.0, 4.0, 1.0, 1.288495575221239, 2.0, 10.0, 3.2, 1.0, 3.7058823529411766, 1.0, 3.9080459770114944, 1.2003651300775902, 1.1176470588235294, 1.5, 1.1195079086115993, 1.1688804554079697, 9.0, 1.0, 1.4804056795131846, 9.0, 9.0, 1.0, 2.6, 1.0, 6.0, 1.0, 2.7777777777777777, 1.5, 1.0719581334496293, 1.851878612716763, 1.0, 1.4256198347107438, 1.0, 1.0338983050847457, 1.1113513513513513, 1.0, 6.0, 3.2, 1.3532818532818534, 1.0212765957446808, 1.022939671237449, 1.4, 1.513353115727003, 6.0, 1.0, 1.113490364025696, 1.0, 1.4524886877828054, 12.0, 1.9078947368421053, 1.0, 6.0, 7.0, 1.569767441860465, 1.0, 1.0, 1.08, 1.0027595788131154, 1.00581088219757, 6.703703703703703, 6.0, 1.5416666666666667, 1.0, 4.0, 6.0, 6.0, 1.2105263157894737, 1.2, 6.0, 11.0, 13.0, 7.0, 1.0, 6.0, 6.0, 1.0, 3.6, 1.0, 6.0, 1.157644259369423, 1.0, 1.0, 1.0238036324046123, 8.0, 1.0, 11.0, 1.0, 1.04570100697134, 7.0, 3.0, 1.5, 6.0, 1.5925925925925926, 11.0, 1.0535714285714286, 1.1904761904761905, 2.0, 1.4121237342211126, 1.513157894736842, 1.0, 2.5, 1.3333333333333333, 8.0, 15.0, 1.8586183542160515, 1.0, 6.0, 1.0, 1.0, 1.0, 1.1538461538461537, 16.0, 1.2476190476190476, 23.0, 1.0, 8.0, 1.7342995169082125, 1.2404040404040404, 1.0500505428432647, 7.0, 1.0222222222222221, 1.5, 1.1179427687548338, 1.5, 1.4, 1.5, 4.201492537313433, 1.0, 1.872932607170303, 1.1397212871636733, 6.0, 1.0355887963055919, 1.0272661870503597, 1.0338977635782747, 1.0, 3.5, 1.0, 1.0256410256410255, 5.6, 12.0, 2.0, 1.2839090143218197, 9.0, 8.0, 12.0, 6.0, 1.0632911392405062, 2.5, 1.0, 1.0, 1.0, 11.0, 11.0, 1.2110236220472441, 6.0, 1.0, 1.0, 1.0, 1.0702859044255035, 1.0, 1.0666666666666667, 1.2279181708784597, 6.0, 2.2, 1.0, 1.0, 1.0120546253016274, 1.9780868577916548, 1.6521739130434783, 6.0, 1.0, 1.0283214766391078, 1.0962777305963503, 9.0, 2.0, 11.0, 12.0, 1.0, 1.1111111111111112, 1.0047295658501092, 6.0, 2.120925341745531, 1.9615384615384615, 1.0, 1.0, 1.0476190476190477, 2.1818181818181817, 11.0, 6.0, 1.1581342434584756, 1.014373941748992, 2.5, 1.198165137614679, 2.5454545454545454, 1.0, 1.0, 6.0, 1.2537241998205204, 1.0, 1.0, 1.5643070787637088, 6.0, 1.0, 1.2369942196531791, 6.0, 6.0, 1.6761904761904762, 1.6, 1.0232558139534884, 1.4688796680497926, 1.1432791728212703, 6.0, 6.0, 7.0, 6.0, 10.0, 1.0967612276251384, 1.0, 1.0, 1.0179640718562875, 1.165016501650165, 6.0, 1.0, 1.0, 10.0, 1.3293413173652695, 8.0, 1.5237843551797041, 1.003112087000121, 4.0, 3.6666666666666665, 1.1065375302663438, 1.0, 6.0, 1.0, 1.6923076923076923, 1.175, 1.0, 13.0, 1.23861852433281, 1.548913043478261, 1.1313131313131313, 1.0, 1.0008061503372068, 1.0, 2.0, 1.000586100584495, 10.0, 1.071593200806684, 1.0, 1.0, 1.0, 1.190122250881397, 7.0, 3.0, 1.7, 1.0, 8.0, 8.0, 1.3777777777777778, 3.0, 1.0, 1.5616883116883118, 7.0, 3.5, 6.0, 1.0981308411214954, 1.15625, 25.0, 1.1397058823529411, 1.0, 1.2251310063060663, 1.903030303030303, 1.4583333333333333, 6.0, 9.0, 7.0, 1.0, 1.0, 13.0, 1.0747398297067172, 5.666666666666667, 2.2, 7.0, 1.0, 1.5379796397807362, 6.0, 9.0, 10.0, 5.5, 1.3890845070422535, 1.7465753424657535, 1.0, 1.0, 2.0, 1.0200010237248227, 1.0, 6.0, 1.3179791976225854, 2.0, 1.0, 1.2893081761006289, 1.3795180722891567, 10.0, 1.0185185185185186, 2.914171656686627, 1.8, 7.0, 4.75, 1.0833333333333333, 1.0, 1.4224598930481283, 1.0, 1.6941176470588235, 8.0, 3.6666666666666665, 1.0077185661179884, 1.0, 1.2673487391588283, 1.1428571428571428, 11.0, 8.0, 1.4684684684684686, 1.0, 1.3013698630136987, 5.666666666666667, 1.565217391304348, 1.0615332885003363, 7.0, 1.0, 1.0, 1.1976190476190476, 1.8333333333333333, 1.174055931047312, 1.3786141575274178, 1.0, 7.0, 9.0, 1.0, 6.0, 6.0, 6.0, 1.0, 7.0, 6.0, 6.0, 3.5, 2.308108108108108, 1.0153232577665827, 1.0887755102040817, 6.0, 6.0, 1.1818181818181819, 6.0, 7.0, 7.0, 11.0, 1.0, 9.0, 1.0, 1.082433656056279, 6.0, 2.3333333333333335, 1.0374331550802138, 6.0, 1.0, 6.0, 1.4, 4.0, 9.0, 1.0, 1.0, 1.0, 13.0, 1.0036264732547597, 1.0734084678647577, 2.2857142857142856, 1.0, 6.0, 1.0110202302934816, 1.0, 1.0, 11.0, 1.0196078431372548, 1.3121987524808618, 1.0, 3.0, 1.5, 1.0301507537688441, 1.0, 1.0, 2.3333333333333335, 6.0, 1.0, 1.0162257213651986, 1.0, 2.0, 1.070218917802561, 1.0, 1.0, 1.0450995704802812, 6.0, 1.1788601248337256, 9.0, 6.0, 8.0, 1.1639344262295082, 6.0, 1.0, 6.0, 2.1666666666666665, 6.0, 1.043264689212167, 1.0274825835399692, 6.0, 6.5, 3.652173913043478, 6.0, 6.0, 5.0, 1.0, 1.0, 1.114927259177656, 1.0, 6.0, 2.8333333333333335, 26.2, 1.0114942528735633, 1.4564831261101243, 1.0154929577464789, 1.0, 1.0547826086956522, 6.0, 1.0, 6.0, 1.0, 1.1818181818181819, 1.0, 1.0, 6.0, 6.0, 8.0, 6.0, 1.0045209595449063, 1.144578313253012, 2.1189931350114417, 6.0, 2.0, 1.4, 1.243445692883895, 1.0, 10.0, 9.0, 1.0357377049180327, 1.104822671528008, 1.0, 6.0, 2.75, 12.0, 1.0, 1.009009009009009, 1.0, 1.0, 9.0, 1.7203389830508475, 1.0, 5.0, 7.0, 1.0011747430249633, 1.0854700854700854, 6.0, 9.0, 1.1538461538461537, 1.0430323490449127, 1.0, 1.0, 1.018409818569904, 1.025812856788285, 1.5847953216374269, 3.0, 8.0, 6.0, 2.4224598930481283, 1.315173116089613, 3.3076923076923075, 6.0, 6.0, 3.0, 1.029443838604144, 6.0, 2.4237288135593222, 1.0, 6.0, 1.1785714285714286, 1.1111111111111112, 3.0, 2.0, 1.0, 1.1123957266208109, 1.2394366197183098, 1.107022607022607, 6.0, 1.0, 8.0, 11.0, 6.0, 1.0, 1.0, 6.0, 1.0, 6.0, 2.0, 8.0, 1.3222222222222222, 2.0, 1.092351555720838, 1.0, 1.0, 1.3571428571428572, 1.1421654929577465, 17.0, 1.75, 1.0, 1.0734966592427617, 1.0, 1.394736842105263, 1.0514705882352942, 8.0, 1.0, 8.0, 6.0, 1.0, 6.0, 1.9292795769993392, 1.0, 1.0, 12.0, 6.0, 1.0613207547169812, 1.2631964809384164, 1.0, 6.0, 1.8907563025210083, 1.2058823529411764, 14.0, 1.1243781094527363, 9.0, 6.0, 1.0, 1.0, 1.0, 3.0, 2.0, 6.0, 1.2615894039735098, 1.3143307086614173, 2.4444444444444446, 6.0, 1.9428689694044705, 1.0, 1.2790697674418605, 6.0, 9.0, 6.0, 1.0355748141015353, 2.357142857142857, 1.0, 1.0, 1.2096109839816933, 1.0715901627380866, 1.0, 2.6666666666666665, 7.0, 1.5454545454545454, 1.0, 1.3744988498192574, 1.6071428571428572, 1.2052621008234585, 1.7142857142857142, 1.101010101010101, 1.0, 1.1126760563380282, 1.25, 6.0, 6.0, 1.0, 2.3333333333333335, 2.0, 1.8571428571428572, 9.0, 2.0, 8.0, 6.0, 1.0, 1.0, 1.4145077720207253, 3.0, 1.0, 14.0, 1.110910186859554, 3.4642857142857144, 7.0, 1.0, 1.0776380535811918, 1.040547111176881, 1.0, 1.4285714285714286, 6.0, 6.0, 6.0, 1.0, 1.6, 1.0, 2.064516129032258, 1.2051185783117453, 9.0, 1.0, 1.6666666666666667, 1.0365853658536586, 6.0, 1.1484297520661157, 1.0, 6.0, 6.0, 10.0, 1.0714285714285714, 1.0, 6.0, 1.0, 6.0, 8.0, 6.0, 6.0, 6.0, 6.0, 6.0, 1.0, 6.0, 1.0453102100635077, 7.0, 6.0, 1.0, 6.0, 9.0, 1.4761904761904763, 14.0, 6.0, 10.0, 6.0, 1.0, 1.0, 2.0, 1.0, 1.0224358974358974, 1.250018730800929, 13.0, 1.3652065293659545, 3.6, 1.0, 1.0, 1.5930318754633062, 6.0, 3.0, 1.0746132848043677, 1.0, 1.0, 2.035740878629933, 1.8666666666666667, 2.142857142857143, 3.3333333333333335, 1.0394763953699775, 3.0, 1.0, 1.0, 8.0, 1.0, 7.5, 6.0, 1.0, 11.0, 1.0, 6.0, 2.0, 1.0, 6.0, 1.0, 1.148216553157105, 1.4854651162790697, 6.0, 6.0, 2.0, 1.0769230769230769, 6.0, 2.0, 1.0183329645668047, 1.6470588235294117, 1.5593220338983051, 8.0, 1.0, 6.0, 2.2, 3.7719298245614037, 1.0, 1.027555823117338, 6.0, 6.0, 1.3573959563676787, 10.0, 1.7183098591549295, 1.2713661883967562, 6.5, 7.0, 1.009433962264151, 6.0, 3.0, 7.0, 7.0, 12.0, 13.333333333333334, 6.0, 3.5, 1.2064676616915422, 1.2, 1.0, 6.0, 1.0, 1.090692124105012, 1.0, 1.2520901950848746, 1.5, 6.0, 6.0, 1.0346420323325636, 6.0, 8.0, 1.0769230769230769, 1.019922380336352, 11.0, 1.2268041237113403, 6.0, 1.3197973917539594, 8.0, 1.8333333333333333, 1.1652173913043478, 6.0, 7.0, 2.0, 7.0, 16.0, 1.8, 6.0, 10.0]
origin-forest_39.80 	max: 26.2000	99th: 15.0100	95th: 10.0500	median: 1.5000	mean: 3.5160

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 11/15 | Workload-time: 28.730674 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 12/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=valueskew', '--dataset=forest', '--drift_test=distribution', '--end2end', '--update_size=25000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
ValueSample - START
ValueSample - END
load_npy_dataset_from_path - df.shape = (731012, 10)
Parsing... done, took 0.1s
Data updated!
Previous data size: (706012, 10), new data size: (25000, 10)
[ 5.9604645e-08  0.0000000e+00  1.4305115e-06  0.0000000e+00
  7.7486038e-07  3.0994415e-04 -2.9802322e-08  4.1723251e-07
  1.1920929e-07  0.0000000e+00]
Distance score: 3.1271578336600214e-05
SAUCE Drift detection: True
Detection latency: 0.0969s

DRIFT-DETECTED after 12-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=forest', '--end2end', '--model=transformer', '--model_update=adapt', '--update_size=25000', '--epochs=40']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
update_size: 25000
AdaptTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (731012, 10)
Parsing... done, took 0.1s
done, took 0.1s
dataset size: 731012
train data shape: torch.Size([25000, 10]), transfer data shape:torch.Size([5000, 10])
Epoch 0 Iter 0, train entropy gap 15.8778 bits (loss 34.800, data 18.922) 0.00300 lr
epoch 10 train loss 20.4309 nats / 29.4755 bits
time since start: 5.8 secs
Epoch 10 Iter 0, train entropy gap 10.2939 bits (loss 29.216, data 18.922) 0.00256 lr
epoch 20 train loss 19.1740 nats / 27.6623 bits
time since start: 11.6 secs
Epoch 20 Iter 0, train entropy gap 8.7275 bits (loss 27.650, data 18.922) 0.00150 lr
epoch 30 train loss 18.6490 nats / 26.9048 bits
time since start: 17.2 secs
Epoch 30 Iter 0, train entropy gap 7.9505 bits (loss 26.873, data 18.922) 0.00044 lr
epoch 40 train loss 18.5572 nats / 26.7724 bits
time since start: 22.9 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 34.4478 nats / 49.6976 bits
Saved to: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
AdaptTask - END

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 12/15 | Workload-time: 2.296577 | Model-update-time: 25.966569


WORKLOAD-START | Type: QueryWorkload | Progress: 13/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=forest', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
data size: 731012, total size: 731012, split index: [609176 731012]
Parsing... done, took 0.1s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
query_seed:0
origin-forest_39.80 	max: 188.0000	99th: 17.0000	95th: 12.0000	median: 1.4248	mean: 4.0365
ReportEsts: [2.0, 1.0979670522257272, 3.5, 1.5128205128205128, 8.0, 1.0, 1.1191011235955055, 17.0, 1.5464362850971922, 7.0, 1.120879120879121, 1.7142857142857142, 1.0, 2.0, 1.0, 1.1222222222222222, 7.0, 13.0, 1.1756756756756757, 1.806772286592575, 1.0, 14.0, 12.0, 1.0, 1.0613496932515338, 9.0, 1.0246913580246915, 8.0, 10.0, 1.0833333333333333, 1.6666666666666667, 1.0, 1.0, 7.0, 1.0, 2.0, 9.0, 1.0384615384615385, 8.0, 6.5, 4.0, 8.0, 1.5454545454545454, 7.0, 1.0633802816901408, 1.2666666666666666, 1.0, 1.6, 1.0, 7.0, 3.0, 1.0, 12.0, 1.0, 9.0, 1.2049180327868851, 1.1748251748251748, 1.5294117647058822, 1.0, 14.0, 1.0288554466381334, 1.2, 10.0, 2.0, 5.0, 5.0, 1.1428571428571428, 1.0, 1.9259259259259258, 1.0, 10.0, 2.013927576601671, 1.0949842452587146, 4.15625, 1.0, 1.1853658536585365, 7.0, 1.0, 1.0, 1.0, 7.0, 1.0188679245283019, 1.0, 1.034599844158793, 1.0, 1.0109892651818584, 13.0, 1.0408163265306123, 1.162162162162162, 7.0, 1.0, 1.2167923056927477, 7.0, 10.0, 1.1811879272539663, 7.0, 1.143148866653053, 7.0, 11.0, 1.8181818181818181, 1.526539278131635, 7.0, 1.1544715447154472, 7.0, 1.0, 13.0, 1.0344827586206897, 1.04, 12.920454545454545, 7.0, 1.6785714285714286, 1.24, 1.0, 1.1578947368421053, 2.4, 1.0, 2.0, 1.0, 7.0, 1.0, 1.263157894736842, 13.0, 1.0, 8.0, 1.304635761589404, 1.1785714285714286, 15.0, 1.1666666666666667, 3.5, 16.0, 1.0827586206896551, 1.0, 7.0, 1.0, 1.3369095276220977, 1.0986818667616673, 7.666666666666667, 11.0, 1.0, 1.7, 1.25, 7.0, 1.2043010752688172, 1.16, 7.0, 7.0, 2.0413793103448277, 1.0249531227462858, 1.0, 1.0, 1.2758620689655173, 8.0, 1.0, 1.0, 1.0138888888888888, 1.3586604249189773, 9.0, 1.0, 1.4285714285714286, 9.0, 1.0, 7.0, 1.6666666666666667, 7.0, 1.6795827123695977, 7.0, 1.0, 1.0, 1.0, 11.0, 1.1886792452830188, 1.0, 6.0, 1.1459390862944163, 1.0, 7.0, 2.0, 1.0, 1.0717842038518963, 1.2017241379310344, 7.0, 1.005457515753191, 1.0962962962962963, 1.001740139211137, 23.0, 2.5, 1.0, 1.0, 1.0, 9.0, 1.0, 1.0989417989417989, 7.0, 10.0, 7.0, 1.0281768630624304, 7.0, 1.0857988165680474, 1.0818428158783624, 8.0, 3.7142857142857144, 1.457142857142857, 1.1735579008240566, 7.0, 7.0, 1.8235294117647058, 12.0, 1.3076923076923077, 1.0, 1.0, 7.0, 8.0, 1.0203025477707006, 10.0, 1.0155038759689923, 1.4583333333333333, 7.0, 10.0, 1.0933333333333333, 1.0, 1.0, 1.0, 7.0, 11.0, 7.5, 1.0, 3.4, 2.235294117647059, 1.0, 1.0, 1.044326923076923, 1.1683501683501682, 1.78125, 1.0, 1.1152410582329941, 7.0, 14.0, 1.0, 1.0, 1.0526315789473684, 1.1692307692307693, 52.0, 7.0, 2.0, 2.0, 1.2758730158730158, 1.1682242990654206, 7.0, 4.0, 11.0, 1.0, 7.5, 5.0, 1.0, 1.3709981167608287, 1.4285714285714286, 12.0, 1.3846153846153846, 1.4210526315789473, 9.45, 1.0, 1.566820276497696, 1.0026004088504088, 1.5, 1.0, 1.0573476702508962, 1.102, 5.5, 1.0, 1.4762135922330097, 11.0, 5.0, 1.0, 2.3333333333333335, 1.0, 7.0, 1.0, 1.4054054054054055, 1.5, 1.7316546762589928, 1.118391660461653, 1.0, 1.4033149171270718, 1.0, 1.3728813559322033, 1.368271954674221, 2.5, 7.0, 3.6, 1.1455696202531647, 1.1593806921675773, 1.2807565967864392, 1.25, 1.6697819314641744, 8.0, 1.0, 1.0781563126252505, 1.0, 1.2021660649819494, 7.0, 1.806896551724138, 1.0, 8.0, 9.0, 1.8969555035128807, 1.0, 1.0, 1.3333333333333333, 1.0108329472806448, 1.3122081387591729, 188.0, 8.0, 2.05, 1.0, 3.0, 7.0, 8.0, 1.2166666666666666, 1.75, 3.5, 12.0, 16.0, 9.0, 1.0, 7.0, 7.0, 1.0, 2.0, 1.0, 8.0, 1.0609067317966723, 1.5, 1.0, 1.0030610292710924, 10.0, 1.0, 13.0, 1.0, 1.02, 8.0, 3.0, 1.0, 7.0, 2.15, 15.0, 1.0161290322580645, 1.2032967032967032, 1.0, 1.4509056244041945, 1.2298136645962734, 1.0, 2.9166666666666665, 1.5, 2.6666666666666665, 16.0, 1.700381679389313, 1.0, 7.0, 1.0, 1.0, 1.0, 1.2661870503597121, 17.0, 1.0185185185185186, 26.0, 1.0, 10.0, 1.3603603603603605, 1.0813559322033899, 1.0579675376738489, 9.0, 1.0206896551724138, 1.4523809523809523, 1.0188972876834148, 1.4615384615384615, 1.4642857142857142, 3.6, 1.3097345132743363, 1.0, 1.8295745628689164, 1.2086619163346395, 7.0, 1.0208642226550766, 1.0115571360186009, 1.0777683341427877, 1.0, 5.333333333333333, 1.0, 1.3114754098360655, 10.333333333333334, 15.0, 1.0, 1.0320460147904684, 12.0, 5.5, 14.0, 7.0, 1.0714285714285714, 1.6666666666666667, 3.5, 1.0, 1.0, 23.0, 13.0, 1.0403645833333333, 7.0, 1.0, 1.0, 1.0, 1.0818454613653414, 2.6666666666666665, 1.8, 1.3913280610853558, 7.0, 2.6, 1.0, 1.0, 1.0103123308930888, 1.8907026259758695, 1.0684931506849316, 7.0, 1.0, 1.0029250116441546, 1.0056934306569343, 10.0, 4.25, 14.0, 14.0, 1.0, 1.4071428571428573, 1.0192647409883027, 7.0, 1.6532786885245903, 1.3644859813084111, 1.0, 1.0, 1.0147058823529411, 2.125, 14.0, 3.5, 2.5035971223021583, 1.080772087840661, 2.4, 1.3733333333333333, 4.666666666666667, 1.0, 1.0, 7.0, 1.2413551887773429, 1.5, 1.0, 1.5003620564808111, 6.0, 1.0, 1.1774193548387097, 7.0, 7.0, 1.6160714285714286, 2.25, 1.1666666666666667, 1.404494382022472, 1.0603053435114504, 7.0, 8.0, 8.0, 7.0, 12.0, 1.0984121218411085, 1.0, 1.0, 1.1049085659287776, 1.0895953757225434, 7.0, 1.0, 1.0, 12.0, 1.3976608187134503, 10.0, 1.1893860561914673, 1.007067551085195, 3.0, 4.0, 1.0398230088495575, 1.0, 7.0, 1.0, 1.1829268292682926, 1.0869565217391304, 1.0, 17.0, 1.4415744157441575, 2.112403100775194, 1.0793650793650793, 1.0, 1.0134220532319391, 1.5714285714285714, 2.0, 1.027314661880067, 5.5, 1.0686790362780394, 1.0, 1.0, 1.0, 1.173801782273603, 14.0, 3.5, 7.75, 1.0, 10.0, 9.0, 1.7297297297297298, 3.0, 1.0635593220338984, 1.7476923076923077, 8.0, 8.0, 7.0, 1.0526905829596414, 1.1081081081081081, 26.0, 1.2016806722689075, 1.0, 1.1203273162906862, 1.6274509803921569, 1.2758620689655173, 2.3333333333333335, 11.0, 9.0, 1.0, 1.0, 17.0, 1.0127272727272727, 2.1621621621621623, 2.1666666666666665, 8.0, 1.0, 1.2541507024265646, 7.0, 12.0, 1.1818181818181819, 4.666666666666667, 1.1503972758229284, 1.9829545454545454, 1.0, 1.3668341708542713, 2.0, 1.000181199706786, 1.0, 7.0, 1.1707109408258833, 1.0, 1.0, 1.1829268292682926, 1.2918918918918918, 6.0, 1.8253968253968254, 1.2489626556016598, 1.25, 9.0, 7.0, 1.1653543307086613, 1.0, 1.6987951807228916, 1.0, 2.0547945205479454, 10.0, 2.6666666666666665, 1.0323296030300178, 1.2, 1.280953263235907, 1.0449438202247192, 13.0, 9.0, 1.5, 1.0, 1.2820512820512822, 1.5454545454545454, 2.1052631578947367, 1.0677966101694916, 9.0, 1.0, 1.0, 1.021113243761996, 3.2857142857142856, 1.0273364906180684, 1.527478597072632, 1.0, 10.0, 11.0, 1.0, 7.0, 7.0, 7.0, 1.0, 8.0, 7.0, 7.0, 4.0, 1.1497005988023952, 1.0395010395010396, 1.0781928757602086, 7.0, 7.0, 1.0, 7.0, 9.0, 9.0, 13.0, 1.0, 11.0, 1.0, 1.194334088293172, 4.0, 3.2, 1.2452130945027795, 7.0, 1.0, 7.0, 2.6666666666666665, 1.5, 11.0, 1.0, 1.0, 1.0, 7.25, 1.0370872908186342, 1.0705882352941176, 2.6666666666666665, 1.0, 7.0, 1.0236581327830698, 1.0, 1.0, 13.0, 1.0188679245283019, 1.3123537890781918, 1.0, 3.5, 2.111111111111111, 1.0342679127725856, 1.0, 1.0, 2.0, 7.0, 1.0, 1.0448338643604915, 1.0, 2.0, 1.058614564831261, 1.0, 1.0, 1.060858060858061, 7.0, 1.0935067494334416, 11.0, 7.0, 10.0, 1.0845546786922209, 7.0, 1.0, 7.0, 2.8, 7.0, 1.0177021927765315, 1.036618707022728, 7.0, 16.0, 11.75, 7.0, 1.0833333333333333, 1.2, 1.0, 1.0, 1.0120516226988043, 1.0, 7.0, 3.8, 2.2295081967213113, 1.3028169014084507, 1.1421856639247943, 1.1890080428954424, 1.0, 1.1183879093198992, 5.0, 1.0, 7.0, 1.0, 4.333333333333333, 1.0, 1.0, 7.0, 7.0, 10.0, 7.0, 1.0098165303538773, 1.413265306122449, 3.7459016393442623, 7.0, 2.0, 8.0, 1.275092936802974, 1.0, 12.0, 11.0, 1.1847317248829672, 1.0118113421244237, 1.0, 7.0, 6.0, 14.0, 1.0, 1.0642201834862386, 1.0, 1.0, 11.0, 1.4926470588235294, 1.0, 7.0, 10.0, 1.0540158371040724, 1.6936170212765957, 7.0, 2.5, 1.0148148148148148, 1.0087819622579854, 1.0, 1.2258064516129032, 1.111535523300229, 1.053413958175863, 1.6201117318435754, 2.25, 7.0, 7.0, 1.0994764397905759, 1.205991124260355, 1.6363636363636365, 6.5, 8.0, 7.0, 1.1358447488584476, 7.0, 1.3953488372093024, 1.0, 7.0, 1.6666666666666667, 11.0, 3.0, 2.0, 1.0, 1.1565618527584258, 1.5363128491620113, 1.0954668894923751, 7.0, 1.0, 9.0, 14.0, 7.0, 1.0, 1.0, 7.0, 1.0, 7.0, 2.0, 9.0, 1.5387931034482758, 1.0, 1.1095448074719627, 6.0, 1.0, 1.0, 1.4031065088757397, 8.0, 8.0, 4.5, 1.1750179812994486, 1.2505809841366071, 1.1548780487804877, 1.0, 13.0, 2.5, 7.0, 7.0, 1.0, 7.0, 1.1460014673514307, 1.0, 1.0, 14.0, 7.0, 1.2292452830188678, 1.2764136066681686, 1.1666666666666667, 7.0, 1.9421487603305785, 1.1891891891891893, 18.0, 1.281512605042017, 11.0, 7.0, 1.0, 1.0, 1.0, 1.2222222222222223, 6.0, 12.0, 1.1381074168797953, 1.0623152709359607, 1.5, 7.0, 1.7674838520258367, 1.0, 1.1794871794871795, 3.5, 10.5, 7.0, 1.0681704863916923, 4.5, 1.0, 1.0, 1.0163751395608485, 1.1257236842105263, 1.0, 9.0, 8.0, 1.75, 1.0, 1.452599388379205, 1.475, 1.2855612682090831, 1.2261904761904763, 1.1068166248001827, 1.0, 1.0275779376498801, 1.5, 7.0, 7.0, 1.0, 2.6666666666666665, 1.1818181818181819, 1.1111111111111112, 5.75, 2.0, 10.0, 7.0, 1.0, 1.0, 1.4975124378109452, 3.0, 1.0, 17.0, 1.4504573170731707, 1.0206185567010309, 8.0, 2.0, 1.1182531894013739, 1.0550388068170304, 1.0, 1.4, 7.0, 7.0, 7.0, 1.0235604184969251, 1.7, 1.0, 1.2647058823529411, 1.4665338885871204, 11.0, 1.0, 1.3125, 1.3967213114754098, 7.0, 1.186862244897959, 1.0, 7.0, 7.0, 13.0, 1.1287128712871286, 1.0, 7.0, 1.0, 7.0, 1.4602272727272727, 10.0, 8.0, 1.0, 1.0, 7.0, 2.4363636363636365, 1.0, 7.0, 2.857142857142857, 1.0, 51.0, 2.3076923076923075, 1.0076923076923077, 11.0, 1.0, 8.5, 7.0, 11.0, 7.0, 1.0, 1.0, 2.0, 1.0, 1.151291512915129, 1.1305408702724684, 11.0, 1.2290697177987449, 3.3333333333333335, 1.0, 1.0, 1.2629928315412187, 7.0, 1.303030303030303, 1.1769331585845346, 1.0, 1.0, 1.570273631840796, 1.7222222222222223, 3.4, 4.0, 1.0389105513986956, 3.0, 1.0897927858787413, 1.082191780821918, 1.0, 5.0, 1.0, 7.0, 1.1851851851851851, 1.0, 13.0, 1.0, 2.0, 2.0, 1.0, 7.0, 10.0, 1.0173508732138807, 1.1830357142857142, 7.0, 7.0, 1.8666666666666667, 1.064516129032258, 7.0, 2.0, 1.083881972707685, 5.0, 2.5, 1.5657894736842106, 1.0, 4.0, 7.0, 2.074074074074074, 1.0, 1.2605633802816902, 8.0, 7.0, 3.3333333333333335, 1.1182266009852218, 1.3189655172413792, 1.6071428571428572, 1.108695652173913, 2.0, 1.0148670771201822, 7.0, 1.0251428810685201, 1.0650773555750004, 6.0, 1.2156560307162716, 15.0, 1.7142857142857142, 1.6, 1.0, 1.1298521256931608, 2.0, 12.0, 7.0, 9.0, 1.0, 1.2766489527977494, 1.0, 8.0, 8.0, 1.237142857142857, 8.0, 10.0, 1.4, 1.1242390702822358, 14.0, 1.4545454545454546, 1.029126213592233, 1.279373368146214, 3.0, 1.0005389762767518, 1.0, 2.0, 7.0, 1.0]
origin-forest_39.80 	max: 188.0000	99th: 17.0000	95th: 12.0000	median: 1.4248	mean: 4.0365

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 13/15 | Workload-time: 28.668494 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 14/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=valueskew', '--dataset=forest', '--drift_test=distribution', '--end2end', '--update_size=25000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
ValueSample - START
ValueSample - END
load_npy_dataset_from_path - df.shape = (756012, 10)
Parsing... done, took 0.1s
Data updated!
Previous data size: (731012, 10), new data size: (25000, 10)
[1.1920929e-07 0.0000000e+00 4.1723251e-07 5.9604645e-08 2.3841858e-07
 2.7447939e-04 0.0000000e+00 4.7683716e-07 1.1920929e-07 0.0000000e+00]
Distance score: 2.759098970273044e-05
SAUCE Drift detection: True
Detection latency: 0.0996s

DRIFT-DETECTED after 14-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=forest', '--end2end', '--model=transformer', '--model_update=adapt', '--update_size=25000', '--epochs=40']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
update_size: 25000
AdaptTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (756012, 10)
Parsing... done, took 0.1s
done, took 0.1s
dataset size: 756012
train data shape: torch.Size([25000, 10]), transfer data shape:torch.Size([5000, 10])
Epoch 0 Iter 0, train entropy gap 16.0908 bits (loss 34.935, data 18.844) 0.00300 lr
epoch 10 train loss 20.4299 nats / 29.4741 bits
time since start: 5.8 secs
Epoch 10 Iter 0, train entropy gap 10.4467 bits (loss 29.291, data 18.844) 0.00256 lr
epoch 20 train loss 19.1821 nats / 27.6739 bits
time since start: 11.5 secs
Epoch 20 Iter 0, train entropy gap 8.8630 bits (loss 27.707, data 18.844) 0.00150 lr
epoch 30 train loss 18.6830 nats / 26.9539 bits
time since start: 17.1 secs
Epoch 30 Iter 0, train entropy gap 8.0618 bits (loss 26.906, data 18.844) 0.00044 lr
epoch 40 train loss 18.5928 nats / 26.8238 bits
time since start: 22.7 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 34.1929 nats / 49.3299 bits
Saved to: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
AdaptTask - END

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 14/15 | Workload-time: 2.305967 | Model-update-time: 25.715976


WORKLOAD-START | Type: QueryWorkload | Progress: 15/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=forest', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
data size: 756012, total size: 756012, split index: [630010 756012]
Parsing... done, took 0.1s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
query_seed:0
origin-forest_39.80 	max: 209.0000	99th: 20.0000	95th: 14.0000	median: 1.4706	mean: 4.5027
ReportEsts: [1.0, 1.3821745216985535, 8.0, 1.475, 8.0, 1.0, 1.3445595854922279, 21.0, 1.025, 8.0, 1.1595744680851063, 1.75, 1.0, 2.0, 1.1714285714285715, 2.1020408163265305, 8.0, 17.0, 3.064516129032258, 1.6442112774273066, 1.0, 17.0, 15.0, 1.0, 1.0932539682539681, 11.0, 1.1358490566037736, 18.0, 2.4, 1.0, 1.04, 1.0, 1.0, 8.0, 1.0, 2.0, 11.0, 1.4516129032258065, 10.0, 15.0, 4.5, 11.0, 1.2857142857142858, 8.0, 1.2820512820512822, 1.3522727272727273, 1.0, 4.5, 1.0, 8.0, 3.0, 2.5, 8.0, 1.0, 1.579520697167756, 4.5, 1.0474980383123007, 12.0, 2.75, 17.0, 1.2082901554404144, 10.0, 12.0, 1.0, 4.0, 8.0, 2.0714285714285716, 1.0, 1.1304347826086956, 1.0, 8.333333333333334, 1.2534246575342465, 1.085753842676311, 1.2391304347826086, 1.0, 1.4197530864197532, 7.0, 1.0, 1.0, 1.0, 9.0, 2.7017543859649122, 1.0, 1.001003701147983, 2.111111111111111, 1.0035663902556515, 16.0, 1.2682926829268293, 1.1162790697674418, 8.0, 1.0, 1.128551467163484, 8.0, 11.0, 1.308483657796035, 8.0, 1.3450965100409435, 1.9333333333333333, 1.35768779342723, 17.0, 1.32409381663113, 1.0, 1.25, 2.0, 1.0, 1.099236641221374, 2.04, 1.0473503434739941, 4.0, 1.2658959537572254, 1.0, 1.1588235294117648, 1.0204081632653061, 1.0, 1.1904761904761905, 2.1666666666666665, 1.0, 1.0, 1.0, 8.0, 1.0, 5.0, 16.0, 1.0, 9.5, 1.7516129032258065, 1.5, 19.0, 1.1666666666666667, 4.0, 19.0, 1.1056325671170382, 1.0, 8.0, 1.0, 1.6842848497074843, 1.0119874913134121, 8.333333333333334, 1.4, 1.0, 2.076923076923077, 6.666666666666667, 8.0, 1.2574257425742574, 2.0714285714285716, 8.0, 8.0, 1.3828183873398643, 1.0345396468812524, 8.0, 1.0, 9.0, 1.001941109410786, 8.0, 1.0, 2.0, 26.0, 19.0, 1.0, 14.0, 11.0, 1.0, 8.0, 8.0, 1.2, 1.1594202898550725, 8.0, 1.0398406374501992, 4.0, 1.1257315684041007, 9.0, 2.0, 7.5, 1.0514075887392902, 1.0, 8.0, 3.2, 1.0, 1.0531212992725427, 1.0792903692976104, 8.0, 1.0191368456038348, 1.053030303030303, 1.3678380443086327, 27.0, 2.4285714285714284, 1.0, 1.0, 1.0, 10.0, 1.0, 1.1634958382877527, 8.0, 12.0, 9.0, 1.0043656470274316, 8.0, 1.07909604519774, 1.049717850521672, 9.0, 1.0676691729323309, 1.946236559139785, 1.4054867848778856, 8.0, 8.0, 1.1666666666666667, 14.0, 1.1785714285714286, 1.0, 1.0, 8.0, 10.0, 1.006777108433735, 4.0, 1.1911764705882353, 4.0, 8.0, 12.0, 1.2463768115942029, 1.0, 1.0, 1.0, 8.0, 13.0, 18.0, 1.0, 9.5, 2.6875, 1.0, 1.0, 1.1696706028589186, 1.1281560826319816, 1.5128205128205128, 1.0, 1.0554944264348651, 8.0, 17.0, 1.0, 1.0, 2.2, 1.9782608695652173, 17.333333333333332, 8.0, 1.0, 2.0, 1.1695064629847238, 1.1653944020356235, 8.0, 2.0, 13.0, 1.0, 18.0, 6.0, 1.0, 1.4081237911025144, 1.4285714285714286, 14.0, 1.5, 2.066666666666667, 3.2586206896551726, 1.0, 1.0647058823529412, 1.0179320206372824, 1.105263157894737, 1.0, 1.337719298245614, 1.0323741007194245, 13.0, 1.0, 1.2917522123893805, 6.5, 2.75, 1.0, 3.75, 1.0, 8.0, 1.0, 1.9285714285714286, 1.5, 1.1992868462757529, 1.1267692307692307, 1.0, 1.1973094170403586, 1.0, 1.0169491525423728, 1.1898584905660377, 2.6, 8.0, 5.0, 1.101933216168717, 1.1695856471593336, 1.2395715086287413, 1.2857142857142858, 1.0089126559714796, 10.0, 1.0, 1.1050269299820468, 1.0, 1.3536231884057972, 8.0, 1.0275862068965518, 1.0, 10.0, 11.0, 2.375, 1.0, 1.0, 1.3181818181818181, 1.0425027072376567, 1.1637080867850098, 14.0, 10.0, 1.393939393939394, 1.0, 2.5, 8.0, 10.0, 2.4838709677419355, 2.0, 4.0, 6.5, 19.0, 11.0, 1.0, 8.0, 8.0, 1.0, 2.5714285714285716, 1.0, 11.0, 1.0663137364168291, 1.5, 1.0, 1.0546120058565154, 12.0, 1.0, 15.0, 1.0, 1.7241379310344827, 9.0, 3.0, 1.1666666666666667, 8.0, 1.7479674796747968, 19.0, 1.0077519379844961, 1.3734939759036144, 1.0, 1.2384403899025245, 1.0, 1.0, 1.9444444444444444, 1.6666666666666667, 8.0, 1.8823529411764706, 1.5488803932277444, 1.0, 8.0, 1.0, 1.0, 1.0, 1.3576642335766422, 9.0, 1.182608695652174, 1.16, 1.0, 12.0, 1.1518987341772151, 1.2974559686888454, 1.0192018873546025, 2.2, 1.1131386861313868, 1.9285714285714286, 1.0705932839824053, 1.25, 1.2741935483870968, 2.0, 1.3183279742765273, 4.0, 1.580868320610687, 1.1897915727630208, 8.0, 1.0433764725713108, 1.0878855201254574, 1.033219613738869, 1.0, 3.6, 1.0, 1.0389610389610389, 3.4, 18.0, 1.0, 1.12, 15.0, 14.0, 8.0, 8.0, 1.0357142857142858, 1.8333333333333333, 5.333333333333333, 1.0, 1.0, 8.0, 1.0, 19.0, 1.0, 1.4444444444444444, 1.0, 8.0, 11.0, 4.0, 1.1012658227848102, 1.0, 1.3759479956663054, 3.0, 8.0, 3.0, 1.0, 1.0031406942845245, 1.7293650472061266, 1.8625, 8.0, 1.0, 1.001619170984456, 1.0037550037195793, 11.0, 9.0, 17.0, 16.0, 1.0, 1.0342465753424657, 1.0668986852281517, 9.0, 2.0373737373737373, 1.7589285714285714, 1.0, 1.0, 1.1290322580645162, 3.0, 17.0, 8.0, 1.1695464362850971, 1.0039767684824248, 2.3333333333333335, 1.0506329113924051, 4.666666666666667, 1.0, 1.0, 8.0, 1.2688796233061357, 1.0, 1.0, 1.9786839666357738, 8.0, 1.0, 1.009009009009009, 8.0, 8.0, 1.15527950310559, 2.0, 1.0, 1.2668810289389068, 1.079187105816398, 8.0, 10.0, 9.0, 8.0, 14.0, 1.059396747993735, 1.0, 1.0, 1.005607476635514, 1.4119718309859155, 7.0, 1.0, 1.6666666666666667, 1.0, 4.0, 11.0, 1.0, 1.2527124773960217, 1.153929646910884, 1.0694444444444444, 1.0023320630225812, 1.826086956521739, 1.0, 9.0, 1.0340909090909092, 1.0, 1.010508617065994, 2.1818181818181817, 1.5, 2.25, 1.068893528183716, 1.1085526315789473, 1.0, 1.2131537242472266, 13.0, 1.110726508643805, 1.0, 2.0, 8.0, 1.0, 1.0, 1.255340727981068, 1.0359712230215827, 4.0, 1.3333333333333333, 1.0, 12.0, 10.0, 1.064516129032258, 1.5, 1.0960698689956332, 1.0521472392638036, 9.0, 3.0, 8.0, 1.0700431034482758, 1.0714285714285714, 27.0, 1.0533333333333332, 1.0, 1.2090765657185432, 1.8670212765957446, 1.054054054054054, 8.0, 13.0, 11.0, 1.0, 2.8, 1.014127144298688, 1.1557917284560884, 1.4, 1.4705882352941178, 8.0, 1.0, 4.0, 2.3333333333333335, 1.0, 8.0, 1.0, 1.0510638297872341, 1.0, 3.0, 1.1111111111111112, 1.0150723015321406, 1.4620253164556962, 4.4, 4.5, 1.7395833333333333, 2.0, 1.2941176470588236, 1.122875816993464, 11.0, 17.0, 1.0245901639344261, 1.1437782076079948, 1.2, 10.0, 23.0, 1.1417910447761195, 1.0, 1.6555555555555554, 1.0, 1.358974358974359, 12.0, 4.333333333333333, 1.0033609787944, 5.0, 1.2750619560832228, 1.532258064516129, 15.0, 10.0, 1.872340425531915, 1.0, 1.4578313253012047, 5.666666666666667, 1.76, 1.100584036340039, 11.0, 1.0, 1.0, 1.148619957537155, 3.7142857142857144, 1.272093833468819, 1.4251481576913168, 1.0, 13.0, 13.0, 1.0, 8.0, 8.0, 8.0, 1.0, 3.0, 8.0, 8.0, 9.0, 1.5590551181102361, 1.2577896786757545, 1.1115602263540825, 8.0, 8.0, 16.0, 1.876923076923077, 1.5625, 1.5643564356435644, 1.1875, 2.1923076923076925, 4.733333333333333, 13.0, 1.0, 1.032044713553796, 10.0, 3.0, 1.2396204033214708, 8.0, 1.0, 8.0, 1.5, 10.0, 23.0, 1.0, 1.0, 1.0, 3.2, 1.0407002188183807, 1.091296928327645, 3.0, 1.0, 8.0, 1.0302536329854217, 1.0, 2.171875, 15.0, 1.0892857142857142, 1.208479758032052, 1.0, 8.0, 1.1764705882352942, 1.2522522522522523, 1.0, 11.0, 1.8, 8.0, 1.0, 1.022500935979034, 1.0, 2.0, 1.0519293184276957, 1.0, 1.0, 1.0393685812095854, 8.0, 1.2264280798348246, 14.0, 8.0, 12.0, 1.1518438177874186, 8.0, 1.0, 8.0, 2.142857142857143, 4.0, 1.0236476823420544, 1.00745809008623, 8.0, 19.0, 4.8, 8.0, 4.666666666666667, 4.8, 1.0, 1.0, 1.060027161611589, 1.0, 8.0, 3.5, 20.0, 1.8666666666666667, 2.107398568019093, 1.1554404145077721, 2.0, 1.3111291632818847, 6.0, 1.0, 8.0, 1.0, 1.4666666666666666, 1.0, 1.0, 8.0, 8.0, 12.0, 8.0, 1.011667992574914, 1.01, 1.2230769230769232, 8.0, 2.0, 1.8, 1.0254596888260255, 1.0, 14.0, 13.0, 1.236931818181818, 1.0296991464874676, 1.0, 8.0, 3.5, 16.0, 1.0, 1.4, 1.0, 1.0, 13.0, 1.460431654676259, 1.0, 9.0, 13.0, 1.0032858707557504, 1.2769230769230768, 8.0, 11.0, 1.0546875, 1.0271791572853008, 1.0, 1.0975609756097562, 1.1293755250630075, 1.4405874499332443, 1.7787114845938374, 1.0, 1.1031746031746033, 1.445692883895131, 1.0, 1.0706859104603097, 1.0, 1.0, 10.0, 10.0, 3.4, 1.0255331088664421, 8.0, 9.0, 1.1666666666666667, 1.0170068027210883, 12.0, 10.0, 1.2743362831858407, 12.0, 1.0, 5.0, 14.0, 1.0, 1.0, 1.6564885496183206, 12.0, 4.5, 5.5, 1.0, 1.32, 3.25, 1.0, 8.0, 17.0, 1.1733729408587632, 8.0, 7.375, 1.7142857142857142, 12.0, 1.2698412698412698, 8.0, 4.428571428571429, 1.5460472697636511, 10.0, 9.0, 1.380952380952381, 1.1399864529239105, 1.1641754867900138, 1.4396728016359919, 1.0, 16.0, 1.0, 9.0, 8.0, 1.0, 8.0, 1.1678018575851392, 10.0, 1.0, 16.0, 8.0, 1.378413524057217, 1.2274624373956595, 4.375, 8.0, 1.4787878787878788, 1.4545454545454546, 21.0, 1.092741935483871, 13.0, 8.0, 1.0, 1.0, 1.0, 1.0952380952380953, 2.0, 16.0, 1.015228426395939, 1.1835215946843853, 1.7333333333333334, 8.0, 1.6579329872581405, 1.0, 1.0204081632653061, 8.0, 12.0, 8.0, 1.0091467463479415, 1.2580645161290323, 1.0, 1.0, 1.069429684732554, 1.0677309782608695, 1.0, 5.0, 9.0, 1.4705882352941178, 1.0, 1.3612017167381973, 1.2096774193548387, 1.2609791973103592, 7.636363636363637, 1.0347379466504667, 1.0, 1.2670454545454546, 1.4, 8.0, 8.0, 1.0, 9.0, 1.2173913043478262, 1.8333333333333333, 7.0, 2.0, 6.0, 8.0, 1.0, 1.0, 209.0, 3.0, 1.0, 20.0, 1.3374233128834356, 1.1683168316831682, 9.0, 1.0, 2.05859375, 1.0130180969060127, 1.0, 2.0, 8.0, 8.0, 8.0, 1.0665329052969503, 2.0, 1.0, 1.5675675675675675, 1.4475551613260893, 13.0, 1.0, 2.4285714285714284, 1.5347222222222223, 8.0, 1.2206471494607087, 1.0, 8.0, 13.0, 1.3142857142857143, 13.0, 7.333333333333333, 8.0, 11.0, 9.0, 1.0680284990650224, 8.0, 8.0, 1.5714285714285714, 1.0, 1.0, 2.508771929824561, 1.0, 8.0, 6.0, 1.0, 13.5, 16.0, 1.2, 13.0, 1.6363636363636365, 20.0, 8.0, 12.0, 8.0, 1.0, 1.0, 2.0, 1.0, 1.0224358974358974, 1.5260377358490567, 13.0, 1.2318287212889503, 1.084033613445378, 1.875, 1.6640204865556978, 1.2173913043478262, 4.4, 13.0, 1.2647058823529411, 1.0, 1.148936170212766, 8.0, 11.0, 1.0, 1.0, 1.0189766641379545, 3.0, 1.3049370764762827, 1.0666666666666667, 1.0, 3.1666666666666665, 1.0, 8.0, 1.0091743119266054, 1.0, 15.0, 1.0, 6.0, 2.0, 1.0, 8.0, 13.0, 1.0119599181122725, 1.1390041493775933, 8.0, 8.0, 2.066666666666667, 1.0098231827111985, 8.0, 2.0, 1.0792532801446069, 1.7142857142857142, 1.6666666666666667, 1.6153846153846154, 1.0, 1.25, 8.0, 2.25, 1.0, 1.3198653198653199, 9.0, 8.0, 3.6666666666666665, 1.394736842105263, 2.056603773584906, 1.119047619047619, 1.7666666666666666, 2.0, 1.0362445122902413, 8.0, 1.0477671167969675, 1.015552435468193, 2.6666666666666665, 1.2056554594814626, 9.5, 1.4, 1.8, 1.0, 1.1024606299212598, 2.0, 14.0, 9.0, 11.0, 1.0, 1.1749112426035504, 1.5, 10.0, 11.0, 2.0917874396135265, 10.0, 8.0, 1.5555555555555556, 1.0305854241338113, 18.0, 2.6666666666666665, 1.3058823529411765, 1.0677255019478573, 3.0, 1.0571781717207633]
origin-forest_39.80 	max: 209.0000	99th: 20.0000	95th: 14.0000	median: 1.4706	mean: 4.5027

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 15/15 | Workload-time: 28.886833 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=7, #drift=7 | total-time=429.807969