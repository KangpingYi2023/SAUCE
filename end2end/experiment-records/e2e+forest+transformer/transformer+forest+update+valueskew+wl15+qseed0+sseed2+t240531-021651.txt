Input arguments = Namespace(data_update='valueskew', update_size=25000, dataset='forest', debug=False, drift_test='ddup', model_update='update', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=15)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-2'}, 'random_seed': 2, 'transformer': {'epochs': 40}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/forest/end2end/forest.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=forest', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=update', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
load_csv_dataset - forest (581012, 10)
Parsing... done, took 0.1s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
query_seed:0
origin-forest_39.80 	max: 22.5000	99th: 5.0000	95th: 2.3762	median: 1.0195	mean: 1.3564
ReportEsts: [1.0, 1.4787696422601138, 1.0, 1.4047619047619047, 1.3333333333333333, 1.0, 1.203125, 1.0, 1.0917721518987342, 1.0, 1.1551724137931034, 1.0, 1.0, 1.0, 2.0, 1.0632888171411798, 1.0, 1.1111111111111112, 1.1132075471698113, 1.125, 1.0, 3.0, 1.1764705882352942, 1.6, 1.4, 1.0, 1.1031054481044482, 1.3, 3.0, 2.4874551971326166, 1.0, 1.1166989039329465, 1.2142857142857142, 1.0, 1.0603448275862069, 1.0560085076214107, 1.1104009296920394, 1.0, 1.0748603351955308, 1.0, 2.0, 1.0, 1.8888888888888888, 1.0, 1.4227642276422765, 1.1348837209302325, 1.0, 3.0, 1.0, 1.0, 3.0, 1.1114454443194601, 1.0, 1.0, 18.0, 1.0603015075376885, 1.180494905385735, 2.2666666666666666, 1.0, 1.0, 1.0824232081911263, 5.0, 1.0, 1.4292237442922375, 1.1847133757961783, 1.0, 1.2513089005235603, 1.2469135802469136, 1.1164658634538152, 1.0, 2.0, 1.0, 1.1320754716981132, 1.4747815099505106, 1.25, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0658327171144524, 3.5, 1.7333333333333334, 1.0, 1.0, 1.25, 1.060580664471715, 1.0, 1.6, 1.3142857142857143, 1.0, 1.023972602739726, 1.0, 1.0, 1.0493470472668438, 1.1804511278195489, 1.0, 1.0, 1.5, 1.0, 1.0, 1.0, 1.103448275862069, 1.0, 1.0, 1.0, 1.105072463768116, 1.0, 1.0774647887323943, 1.0, 1.0, 1.0405165864775892, 1.1887755102040816, 2.0, 1.0, 2.0, 1.0, 1.0, 1.0, 2.0, 3.0, 1.0, 1.0508474576271187, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.1963031953001864, 1.1292261271733486, 1.0, 1.375, 1.0, 1.0, 2.0, 1.0641601961585616, 1.253968253968254, 1.1137912407545916, 1.0, 1.0, 1.25, 1.0, 1.070690203024751, 1.0, 1.2, 1.5483870967741935, 1.0833333333333333, 1.0, 1.0, 1.0, 1.0, 1.0, 1.25, 1.0, 1.0, 1.0, 2.0, 1.7777777777777777, 3.0, 1.0219455252918288, 4.0, 1.0011340440009073, 1.0, 1.3333333333333333, 5.0, 1.0776699029126213, 1.0, 1.0, 1.0, 1.0310077519379846, 1.0357142857142858, 1.0, 1.0, 1.3460076045627376, 1.0, 1.3387640449438203, 1.0, 7.379310344827586, 1.0, 1.0, 1.1110016681229644, 1.0, 1.082894975512425, 1.0, 1.0, 1.8695652173913044, 1.0632901051771673, 1.0, 1.1050420168067228, 2.090909090909091, 1.0, 1.0, 1.0, 1.0, 1.1388888888888888, 1.1428571428571428, 1.3113950638893752, 1.2113076437144663, 1.3333333333333333, 1.0, 1.0, 2.0, 3.0, 1.2260869565217392, 1.0, 2.0, 1.0, 1.0, 1.2352941176470589, 1.0, 1.0, 1.0, 1.0, 1.0, 1.018957345971564, 1.0, 2.0, 1.0, 1.2850457349500106, 1.5, 1.0, 1.0222222222222221, 1.0, 1.1875, 1.0, 1.3661971830985915, 1.0, 1.0, 1.0, 1.1, 2.0, 3.466666666666667, 1.0, 2.0, 1.0, 1.0266695212025752, 1.0295052778837595, 1.0, 4.0, 1.5, 1.0454373343430519, 1.101123595505618, 1.375, 1.0, 1.0097087378640777, 5.0, 1.0447227191413238, 1.0, 1.6666666666666667, 1.1595092024539877, 1.0, 1.1643835616438356, 1.0636571138726858, 3.142857142857143, 2.0, 1.5095541401273886, 1.0537084398976981, 2.0, 1.0, 1.1288047512991835, 1.25, 2.0, 1.0, 1.1428571428571428, 1.0, 1.0, 1.0, 1.1515151515151516, 1.5, 1.2011958146487294, 2.0, 1.0, 1.4425324155594685, 1.2857142857142858, 1.0, 1.0869565217391304, 1.0, 1.0, 1.0, 1.125, 1.0, 1.5, 1.0, 2.0, 1.0, 2.9351351351351354, 1.0, 1.1111111111111112, 1.0, 1.0, 1.0, 1.0, 1.2543757292882147, 1.10625, 1.1317542561065876, 2.4569288389513106, 1.0, 1.5141129032258065, 1.0, 1.0, 3.0, 1.0, 1.207142857142857, 1.0, 2.0, 1.0, 1.2857142857142858, 1.0, 1.0, 1.0833333333333333, 1.5, 1.0, 1.0, 1.0, 1.0, 1.0, 1.6363636363636365, 1.0, 1.0, 1.1779935275080906, 1.5, 1.0, 1.0993360068371574, 1.0, 1.0, 1.0, 1.0, 1.6443361753958587, 1.0, 3.0, 1.0, 1.6666666666666667, 1.2573099415204678, 1.0, 1.0731707317073171, 1.5731707317073171, 1.0, 1.3790365272631022, 1.2252252252252251, 1.0, 1.4, 1.5, 1.1428571428571428, 10.0, 1.5, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0948275862068964, 2.75, 1.5432098765432098, 6.0, 1.0, 1.0, 2.0, 1.3280839895013123, 1.2, 2.1363636363636362, 1.1128042096031572, 1.1362500547981238, 1.4479695431472082, 1.042589840583626, 1.5018867924528303, 1.0, 1.083969465648855, 1.0, 1.3018392542202066, 1.0410737656985325, 1.0, 1.0287091577304537, 1.0200830630938158, 1.0436878447040432, 1.0, 1.6666666666666667, 2.0, 1.0126582278481013, 1.0, 1.0, 1.1035548686244203, 3.980392156862745, 1.0, 1.8888888888888888, 1.0, 1.1833176248821866, 1.0, 1.3, 1.0, 1.0, 1.0, 5.666666666666667, 1.0, 1.0133647798742138, 1.0, 1.0, 1.0, 1.0, 1.0047824700733312, 1.0, 2.0, 1.0521739130434782, 1.0362776025236593, 1.2532347504621073, 1.2259535655058043, 1.1088709677419355, 1.1275246678302995, 1.168141592920354, 1.4696969696969697, 1.0, 1.0, 1.120177972418934, 1.1157962279716753, 1.0, 1.1, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.1429827131555816, 2.5, 1.1517476555839727, 1.0, 1.0, 1.0, 1.341958041958042, 1.0656805284212485, 2.5, 1.2419601837672283, 1.75, 1.0, 1.0, 1.0, 1.002634901465664, 2.0, 1.0, 1.4292565947242206, 1.0, 2.375, 1.0, 1.0, 1.0, 1.0330760267987182, 1.0, 1.0, 2.0, 1.4285714285714286, 1.1904761904761905, 1.0211161387631975, 1.75, 1.0, 1.0, 1.3233333333333333, 1.25, 2.0, 1.0310654685494223, 1.0, 1.4444444444444444, 1.0, 1.0, 1.0909090909090908, 1.0, 1.0, 2.25, 1.0112594731143991, 1.0793584030556567, 3.2448979591836733, 1.4642857142857142, 1.0, 1.0, 1.2, 1.0, 1.1255043070548467, 1.4545454545454546, 1.5, 1.0, 1.6420664206642066, 1.0401069518716577, 1.0, 1.071579483263332, 1.2, 2.0, 1.0502988525341204, 2.5, 1.0166805671392827, 1.0, 1.0, 1.0, 1.0312640516306504, 1.7857142857142858, 2.0, 1.32, 1.0, 2.0, 1.0, 1.4054054054054055, 1.0, 1.1125827814569536, 1.0209128878281624, 2.0, 1.0, 1.0, 1.1848013816925733, 2.0, 1.4285714285714286, 1.2409638554216869, 1.0, 1.055496040096415, 1.4285714285714286, 1.12, 1.0, 1.0, 1.0, 2.0, 1.0863168219715547, 1.5, 4.0, 1.1751474926253687, 1.4, 1.0, 1.02153989682801, 1.0, 1.4, 1.0, 2.0, 1.0, 1.202247191011236, 1.0, 1.0, 1.4285714285714286, 1.0392243352336565, 1.0855263157894737, 1.217008797653959, 1.0454545454545454, 1.3972602739726028, 1.0, 1.8095238095238095, 1.062111801242236, 1.0, 1.0, 1.1538461538461537, 1.2045639771801142, 1.6666666666666667, 2.0, 1.1428571428571428, 1.1941747572815533, 1.0, 1.1835443037974684, 1.0, 1.1467661691542288, 1.0, 2.0, 1.0357304581368476, 6.0, 1.0331312923772344, 2.3333333333333335, 1.0, 3.0, 1.0625, 1.0, 2.0, 1.0706436420722134, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0961538461538463, 2.0, 1.8478260869565217, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.1450381679389312, 1.44, 2.0, 1.2816666666666667, 1.0, 1.0, 2.3333333333333335, 1.0224424366074032, 2.0714285714285716, 1.0, 1.0, 1.0, 1.0, 1.0438865074505002, 1.0, 1.0, 1.0405405405405406, 1.366839378238342, 1.1914893617021276, 2.0, 1.0, 1.0, 1.0, 1.4594594594594594, 2.0, 1.0, 1.0, 1.2650103519668736, 2.0, 1.0480340063761955, 1.0, 1.0, 1.020888888888889, 1.0, 1.0, 1.0, 2.0, 1.108931352581766, 1.0, 3.0, 1.3, 1.0964125560538116, 1.0, 1.0, 1.5, 1.0, 1.0, 1.1218713900654602, 1.0, 2.0, 1.0697615423642821, 1.0, 1.0, 1.1838440111420614, 1.0, 1.0999113587438267, 1.0, 1.0, 1.1152073732718895, 1.0050167224080269, 2.4, 1.4772727272727273, 1.0, 1.0, 4.0, 1.002979145978153, 1.0, 1.0, 1.0, 1.0, 1.25, 1.0, 1.0, 1.5, 1.4069574820541138, 1.0, 2.0, 1.0, 1.0, 1.0, 1.2, 1.153061224489796, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.4, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0384578884934756, 1.2072727272727273, 1.0, 2.0, 1.5, 1.0107913669064748, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0085470085470085, 1.0454545454545454, 3.0, 1.6924355777223608, 1.0, 1.0, 1.0, 1.32, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0404231205137893, 1.375, 1.0, 1.5, 1.0888888888888888, 1.1622538658360217, 1.0, 1.0, 1.221556886227545, 1.112235510579577, 1.1791044776119404, 1.125, 1.0, 1.0, 1.0904442769550426, 2.0, 1.25, 1.0, 1.0, 1.5, 1.164126611957796, 1.0, 1.0, 1.0666666666666667, 2.0, 1.0, 1.5, 1.3, 1.0, 1.0633415512990707, 1.1261343012704175, 2.0, 1.0, 1.0, 3.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 2.0, 3.0, 1.0336134453781514, 1.0, 1.188566789434082, 1.0, 1.0, 1.3333333333333333, 1.5564547206165704, 1.5, 1.0, 1.0, 1.0, 1.0, 1.8928571428571428, 1.3506815365551426, 3.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0642002176278564, 1.0, 1.0, 1.0, 1.0, 1.1632075471698113, 1.0147492625368733, 1.0, 1.0, 1.0459770114942528, 1.0, 2.0, 1.2590361445783131, 1.0, 1.0, 1.0, 1.0, 1.0, 1.3333333333333333, 2.0, 1.0, 1.0911854103343466, 1.2380444444444445, 1.3333333333333333, 1.0, 1.0, 1.0, 1.0, 1.8, 1.0, 1.0, 1.5968543046357615, 1.0, 1.0, 16.5, 2.0, 1.8055555555555556, 1.0, 1.1666666666666667, 1.0, 1.0, 3.0, 1.0, 1.0740740740740742, 1.037162162162162, 1.0, 1.0723684210526316, 1.0, 1.2272727272727273, 1.0, 1.0, 2.0, 1.4285714285714286, 1.0, 1.0, 1.0, 2.0, 1.098901098901099, 1.0, 1.0, 1.1567135793077217, 1.0657710227529742, 1.0, 1.0, 1.0, 1.0431401365543003, 1.0, 1.1761006289308176, 1.0, 1.0841242450388267, 2.0, 1.0, 1.1538461538461537, 1.5, 1.6666666666666667, 1.1036916395222585, 1.0, 7.5, 1.0, 1.0, 1.6, 1.0, 1.0, 1.0, 2.0, 1.6666666666666667, 1.0, 1.0, 1.3333333333333333, 1.0, 1.1428571428571428, 1.0, 4.0, 1.0, 1.3333333333333333, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0468468468468468, 2.0, 1.0, 1.0, 1.0, 1.0, 1.105263157894737, 2.0, 1.0, 1.2769019876627827, 1.0, 1.3358941527955612, 1.0, 1.4404841963685273, 1.0, 1.2285714285714286, 1.6833333333333333, 1.0833333333333333, 1.0, 1.0, 1.1176470588235294, 1.0414288432267884, 1.0, 1.0, 1.0606060606060606, 1.0, 1.0, 1.0, 2.0, 1.0232308327923036, 1.0, 3.25, 1.0, 1.0784313725490196, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 3.0, 2.0, 1.0, 1.0, 1.0, 1.0303907380607815, 1.1395514780835883, 1.0, 1.0, 1.2307692307692308, 1.0591549295774647, 1.0, 2.0, 1.1242396593673967, 1.125, 1.1596638655462186, 1.0, 1.0, 1.0, 1.5, 22.5, 1.0, 1.2610674908118944, 1.0, 1.0, 1.272020997375328, 1.0, 4.0, 1.0, 1.0, 1.0, 1.03690036900369, 1.0, 1.5, 1.144736842105263, 1.0270123652877126, 1.0, 1.5, 1.0, 1.0, 1.3531663187195546, 2.0, 1.75, 1.0, 1.5245901639344261, 1.0, 1.087881591119334, 3.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.2439024390243902, 1.0, 1.1671075837742504, 1.0, 1.0496843692095097, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0136986301369864, 1.071122149469406, 2.0, 1.0653225806451614, 1.0, 1.1330238726790451, 1.0740740740740742, 2.0, 1.0593220338983051, 1.275, 1.0, 1.0, 1.0, 1.1840193704600483, 1.0, 1.0, 1.2649253731343284, 2.0, 1.0]
origin-forest_39.80 	max: 22.5000	99th: 5.0000	95th: 2.3762	median: 1.0195	mean: 1.3564

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/15 | Workload-time: 28.001010 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=valueskew', '--dataset=forest', '--drift_test=ddup', '--end2end', '--update_size=25000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
ValueSample - START
ValueSample - END
load_npy_dataset_from_path - df.shape = (606012, 10)
Parsing... done, took 0.1s
Data updated!
Previous data size: (581012, 10), new data size: (25000, 10)
done, took 0.1s
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
done, took 0.1s
new data average log likelihood = 132.2985
detection mean = 40.8669
detection threshold = 0.3065
test statistic = 91.4316
Offline time = 4.158676624298096
Online time = 0.19222187995910645
Test result: True
DDUp Drift detection: True
Detection latency: 5.2482s

DRIFT-DETECTED after 2-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=forest', '--end2end', '--model=transformer', '--model_update=update', '--update_size=25000', '--epochs=40']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
update_size: 25000
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (606012, 10)
Parsing... done, took 0.1s
done, took 0.1s
dataset size: 606012
train data shape: torch.Size([25000, 10]), transfer data shape:torch.Size([5000, 10])
Epoch 0 Iter 0, train entropy gap 29.3258 bits (loss 48.532, data 19.206) 0.00300 lr
epoch 9 train loss 22.8120 nats / 32.9107 bits
time since start: 5.8 secs
Epoch 10 Iter 0, train entropy gap 13.5568 bits (loss 32.763, data 19.206) 0.00245 lr
epoch 19 train loss 21.0931 nats / 30.4310 bits
time since start: 11.5 secs
Epoch 20 Iter 0, train entropy gap 11.1683 bits (loss 30.375, data 19.206) 0.00200 lr
epoch 29 train loss 20.1250 nats / 29.0343 bits
time since start: 17.1 secs
Epoch 30 Iter 0, train entropy gap 9.8591 bits (loss 29.065, data 19.206) 0.00164 lr
epoch 39 train loss 19.5179 nats / 28.1583 bits
time since start: 22.8 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 44.5292 nats / 64.2421 bits
Saved to: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
UpdateTask - END

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/15 | Workload-time: 7.590178 | Model-update-time: 25.884800


WORKLOAD-START | Type: QueryWorkload | Progress: 3/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=forest', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=update', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
data size: 606012, total size: 606012, split index: [505010 606012]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
query_seed:0
origin-forest_39.80 	max: 46.0000	99th: 8.0110	95th: 3.6667	median: 1.0384	mean: 1.6170
ReportEsts: [1.0, 1.126095423563778, 1.0, 1.1071428571428572, 1.3333333333333333, 1.0, 1.8823529411764706, 1.0, 1.3342618384401115, 1.0, 1.6046511627906976, 2.0, 1.0, 2.0, 1.5, 1.319693094629156, 1.1140350877192982, 1.0, 1.018181818181818, 2.0476190476190474, 1.0, 3.0, 4.0, 1.0, 2.5, 1.0, 1.0179215033183366, 1.1875, 3.0, 6.871287128712871, 1.0, 1.25, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 1.2173913043478262, 1.0, 1.0, 1.265138154027043, 5.0, 1.0115695192628196, 1.0, 1.706840390879479, 2.0, 1.0, 1.7142857142857142, 1.0, 1.5, 1.052005563914043, 1.0, 1.0, 6.0, 1.014018691588785, 1.7567567567567568, 1.0571428571428572, 1.0, 1.0, 1.0874299439551642, 11.0, 1.0, 1.0763430725730443, 1.1975308641975309, 1.0, 1.3895027624309393, 1.364864864864865, 1.2153846153846153, 1.0, 2.0, 1.0, 1.1017699115044248, 1.0267329810382344, 1.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0306950689734014, 3.5, 1.08, 1.0, 1.0, 2.0, 1.3886118038237738, 1.0, 2.0, 4.0, 1.127958172812328, 3.86, 3.4375, 1.2272727272727273, 1.0, 1.0, 2.0, 1.122565864833906, 2.0, 1.2418333126319712, 1.0, 9.095238095238095, 1.0, 1.0, 1.0127840909090908, 1.028069745690999, 1.0, 1.0, 1.1077441077441077, 2.0, 1.42, 1.0, 1.0, 1.8671394799054373, 2.2528735632183907, 1.5, 1.0, 2.0, 1.0, 1.0, 1.0, 2.0, 3.0, 1.0, 1.7467105263157894, 2.3333333333333335, 1.0, 1.1111111111111112, 1.0, 1.0, 2.0, 1.0770290437378027, 1.0532244500509007, 2.0, 1.125, 1.0, 2.0, 2.0, 1.0867208672086721, 1.3125, 1.0193083047997245, 1.0, 1.0, 2.5, 1.0, 1.5151158563419627, 1.0, 1.25, 2.823529411764706, 1.3076923076923077, 1.2, 1.0, 1.0, 1.0, 1.0, 4.0, 1.0, 1.0, 1.0, 1.0, 2.3333333333333335, 1.0, 1.0938875305623472, 4.0, 1.0584903053470271, 1.0, 1.6666666666666667, 7.333333333333333, 1.3633540372670807, 1.0, 1.0, 4.450980392156863, 1.0, 1.6587750936161703, 1.288888888888889, 1.0, 1.5815085158150852, 1.078556263269639, 1.0, 1.0, 2.7142857142857144, 2.4597701149425286, 1.0, 1.0, 1.0197410510281797, 1.0, 1.1717133722023698, 1.0, 1.0, 1.0238095238095237, 1.3244152769926512, 1.0, 1.039301310043668, 4.6, 1.0, 1.0, 1.0, 1.0, 1.1891891891891893, 1.125, 1.057728621526841, 1.1062036412677005, 2.5, 2.0, 1.0, 2.0, 1.0, 2.4310344827586206, 1.0, 1.0, 1.0, 1.0, 1.0625, 1.0, 1.25, 1.0, 1.0, 1.0, 1.3690987124463518, 1.0, 1.0, 1.0, 1.6582486961295635, 3.0, 1.0, 1.2105263157894737, 1.0, 1.05, 1.0, 1.7849162011173185, 1.0, 1.0, 1.0, 5.5, 1.0, 3.2, 1.0, 2.0, 2.0, 1.1041997113502235, 1.1297178453646024, 1.0, 1.25, 1.0, 1.0890459363957596, 1.094850948509485, 1.6, 1.0, 1.164885496183206, 1.9, 5.0, 1.0, 2.0, 1.3581081081081081, 1.0, 2.312925170068027, 1.5898407884761183, 1.2857142857142858, 1.5, 1.1026785714285714, 1.4661921708185053, 1.1428571428571428, 1.0, 1.0065490651737614, 1.75, 2.0, 1.0, 1.6, 1.0, 1.0, 1.0, 1.2903225806451613, 1.5, 2.109079445145019, 2.0, 1.0, 1.0789473684210527, 1.0, 2.8181818181818183, 1.281198003327787, 1.0, 1.0, 2.3333333333333335, 1.1398104265402844, 1.0710382513661203, 1.0383964014014462, 2.0, 1.0, 1.0, 2.142857142857143, 2.150398406374502, 1.0, 9.172413793103448, 1.0, 1.8278145695364238, 1.0, 1.0, 1.125, 5.0, 1.0, 1.0, 1.1111111111111112, 1.0, 1.0, 1.0, 1.0, 1.44, 1.0, 1.5, 1.0, 1.0, 2.5714285714285716, 2.0, 1.0, 1.6153846153846154, 3.0, 1.0, 1.0, 1.0, 1.0, 1.0, 3.8, 1.0, 1.0, 1.1835571835571836, 2.0, 1.0, 1.0383449259853754, 1.0, 1.0, 1.0, 1.0, 1.0066666666666666, 2.0, 3.0, 1.0, 1.5, 1.9545454545454546, 2.196794300979519, 1.011111111111111, 1.4911242603550297, 1.0, 1.0278526504941599, 3.0, 1.0, 1.1290322580645162, 1.5, 4.0, 10.0, 3.0, 1.0, 1.0, 3.0, 1.0, 1.0, 1.5950413223140496, 11.0, 2.53125, 6.0, 1.0, 1.0, 2.0, 1.1048387096774193, 1.0909090909090908, 1.25, 1.0628517300941662, 1.0315972222222223, 1.1250374812593704, 1.0053487576577418, 1.2664233576642336, 1.0, 1.2417840375586855, 1.0, 1.1709381044487428, 1.0171454406343465, 1.0, 1.0331327774063779, 1.0020742924206447, 1.0002084549320438, 1.0, 3.5, 1.0, 1.0903614457831325, 6.0, 2.0, 1.0, 1.0851851851851853, 1.0, 1.3333333333333333, 1.0, 1.0, 1.9795918367346939, 1.0, 1.75, 1.0, 1.0, 5.666666666666667, 1.0, 1.0842880523731588, 1.0, 1.0, 1.0, 1.0, 1.0359787902365927, 1.0, 2.0, 1.0167364016736402, 1.1693821088226253, 1.2906666666666666, 1.186536485097636, 1.1418181818181818, 1.001231274368972, 1.3105413105413106, 1.5, 1.0, 1.0, 1.0172317457479383, 1.0009014357012511, 1.0, 3.6666666666666665, 2.0, 2.0, 1.0, 2.371212121212121, 1.0799926499862187, 1.0, 1.646530612244898, 19.0, 1.0, 1.0, 1.163265306122449, 1.565217391304348, 1.0, 1.0, 1.121313672922252, 1.3230028873917228, 1.25, 1.044822256568779, 7.0, 1.0, 1.0, 1.0, 1.0983240223463686, 1.0, 1.0, 1.2309963099630996, 1.0, 1.1515151515151516, 1.0, 1.0, 1.0, 1.0631685136558517, 1.0, 1.0, 2.0, 1.9090909090909092, 1.238532110091743, 1.123076923076923, 1.0, 1.4956521739130435, 1.0, 1.0, 1.117255669828717, 1.0, 1.0, 1.6121688741721854, 1.0, 2.8, 1.0, 1.0, 1.0833333333333333, 1.0, 1.0, 4.5, 1.089362342844237, 1.0061513600861838, 1.2567164179104477, 1.135135135135135, 1.0, 1.0, 1.625, 1.0, 1.1433792815371764, 2.0869565217391304, 1.5, 1.5, 1.1483050847457628, 1.2775919732441472, 1.0, 1.1685985716510556, 2.5, 2.0, 1.0061436041792946, 2.5, 1.0185185185185186, 1.0, 1.0, 1.0, 1.128347637901778, 2.142857142857143, 2.0, 1.3888888888888888, 1.0, 2.0, 1.0, 1.8653846153846154, 3.0, 1.055944055944056, 1.7806181504740795, 2.0, 1.0, 1.0, 1.0056258790436006, 2.0, 20.0, 1.1954022988505748, 1.0, 1.1016834314900714, 2.1689497716894977, 1.1304347826086956, 2.0, 3.8, 1.0, 1.0, 1.0811544991511035, 1.5, 4.0, 1.2497350759448957, 1.4, 1.0, 1.279115187549831, 1.066392301640138, 2.782608695652174, 1.0, 1.0, 1.0, 1.4990925589836661, 1.0, 1.0, 1.1, 1.0404741620808486, 2.4126984126984126, 3.161764705882353, 4.0, 1.1538461538461537, 2.0, 1.5526315789473684, 1.0013966480446927, 1.0, 1.0, 1.4736842105263157, 1.4424572317262832, 1.6666666666666667, 2.0, 4.5, 1.0948275862068966, 1.0, 1.544502617801047, 1.0, 1.3895486935866983, 1.0, 2.0, 1.0130003470615456, 6.0, 1.1741733340793374, 2.8, 1.0, 3.0, 1.0272727272727273, 1.0, 1.125, 3.6, 1.4148148148148147, 1.5254437869822486, 1.0, 1.0, 1.0, 1.0190023752969122, 1.3333333333333333, 5.5, 1.0, 1.0579710144927537, 1.0, 1.2, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.1730769230769231, 1.1627906976744187, 3.6666666666666665, 1.077720207253886, 1.0, 1.0, 1.3333333333333333, 1.0077508547366851, 4.297872340425532, 1.0, 1.0, 1.0, 1.0, 1.0093359829027784, 1.0, 1.0, 1.2476038338658146, 1.0, 1.0, 1.0, 6.5, 3.0, 1.0, 1.0, 1.0, 1.0, 1.375, 1.2884130982367759, 1.0814285714285714, 1.0, 1.0, 1.0, 1.0001258945778173, 1.0, 1.0, 1.0, 1.0476190476190477, 1.450898688541721, 1.0, 4.0, 2.6, 1.1330724070450098, 1.0, 1.0, 1.5, 1.0, 1.0, 1.0995617070357555, 1.0, 2.0, 1.0441595441595442, 1.0, 1.0, 1.0323232323232323, 1.0, 1.0630967741935484, 1.0, 1.0, 1.8205128205128205, 1.067515923566879, 3.55, 22.0, 1.0, 1.0, 4.0, 1.0661299147971548, 1.0, 1.0, 1.0, 1.0, 1.6666666666666667, 1.0, 1.0, 1.0, 2.1251042535446207, 1.0, 1.0, 1.0, 1.0, 1.0, 1.3571428571428572, 2.0925925925925926, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 3.3333333333333335, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.023270611762567, 1.360655737704918, 1.0, 2.0, 3.0, 1.4479166666666667, 1.0, 3.0, 1.0, 2.0, 1.0, 1.044954128440367, 1.0104166666666667, 1.65, 1.1886571361612375, 1.0, 46.0, 1.0, 1.04, 1.0, 1.4, 1.0, 1.0, 1.0, 1.0830838323353293, 1.125, 1.0, 4.0, 1.2394366197183098, 1.015426251691475, 1.0, 1.0, 1.0441176470588236, 1.1240539651201054, 1.0757575757575757, 1.125, 1.0, 1.0, 1.3493581814683488, 1.0, 1.0, 1.0, 1.0, 3.0, 1.1499436302142052, 1.0, 1.0, 1.875, 1.0, 1.0, 3.0, 1.2692307692307692, 1.0, 1.5133603238866398, 1.1674167416741674, 1.0, 1.0, 1.8888888888888888, 1.0796530508776498, 3.0, 2.0, 1.0, 1.0, 8.0, 1.0, 1.2172781680978402, 1.0107523414956556, 2.0, 2.0, 1.0152168399695662, 1.0, 1.0, 1.4585595367354325, 1.0, 1.2708333333333333, 1.0157595101815335, 3.0, 1.2244444444444444, 1.1600985221674878, 2.0, 1.5, 1.1276752767527676, 1.5061728395061729, 3.0, 1.0, 1.0, 2.0, 1.0, 3.0, 1.0644490644490645, 1.0, 1.0, 1.0, 1.0, 1.1095477386934673, 1.3526570048309179, 1.0, 1.0, 1.7788461538461537, 1.35, 2.0, 1.138728323699422, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 2.0, 1.0, 1.0360360360360361, 1.0706177207725196, 1.4444444444444444, 1.0, 1.0, 1.0, 1.0, 1.8, 1.0, 1.0, 1.5285396590066715, 1.0, 2.0, 1.4242424242424243, 4.0, 9.63888888888889, 1.0, 1.516971279373368, 1.0, 1.0, 1.6944444444444444, 2.6666666666666665, 1.0, 1.936538118723632, 1.0, 1.9731543624161074, 2.0, 1.0, 1.0, 1.0, 2.0, 1.1428571428571428, 1.0, 1.0, 1.0, 1.5, 1.8448275862068966, 1.0, 1.0, 1.009461426491994, 1.224128619500644, 1.0, 1.0, 1.0, 1.5278026905829596, 1.0, 1.6218905472636815, 1.0, 1.0531739488870568, 2.0, 3.0, 1.6428571428571428, 1.0, 2.5, 1.1438712730714624, 1.0, 1.1224489795918366, 1.0, 1.5, 1.25, 1.0, 1.0, 1.0, 8.0, 5.0, 1.0, 1.0, 1.6666666666666667, 1.0, 1.2222222222222223, 1.0, 2.0, 1.0, 1.6666666666666667, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0776740237691003, 2.0, 1.0, 1.0, 1.0, 1.0, 1.2671755725190839, 1.5, 1.0, 1.7879078694817658, 1.0, 1.4983579638752051, 1.0, 1.1257565568258239, 2.0, 1.0666666666666667, 7.111111111111111, 1.625, 1.0, 1.0, 1.092485549132948, 1.3586800573888091, 1.2, 1.6666666666666667, 1.305263157894737, 1.0, 1.0188679245283019, 1.0, 1.0, 1.0, 1.0, 1.002873312432447, 1.194613350958361, 1.6687898089171975, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 6.0, 2.0, 1.0, 1.0, 1.0, 1.021945272283934, 1.0492461414934429, 1.0, 1.0, 2.0, 1.0127551020408163, 1.0, 2.0, 1.2737397704711637, 1.2, 1.8224637681159421, 1.0, 1.0, 1.0, 2.0, 1.1777777777777778, 1.0, 1.0412652996343983, 1.0, 1.0, 1.0389949748743719, 1.0, 2.448529411764706, 2.0, 3.0, 2.0, 1.2949152542372881, 1.0, 2.0, 2.4050632911392404, 1.1512210264900662, 1.0, 1.2307692307692308, 2.0, 1.0, 1.5931263858093125, 2.0, 1.75, 1.0, 1.178294573643411, 1.0, 1.094897627559311, 1.5, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.6176470588235294, 1.0, 1.3421942967617206, 3.0, 1.00620665952328, 1.0, 1.0, 1.0, 1.0, 1.0, 6.0, 1.25, 1.0, 1.0, 2.0, 1.409356725146199, 1.0, 1.1, 1.3823529411764706, 1.4594594594594594, 2.0]
origin-forest_39.80 	max: 46.0000	99th: 8.0110	95th: 3.6667	median: 1.0384	mean: 1.6170

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/15 | Workload-time: 27.819766 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 4/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=valueskew', '--dataset=forest', '--drift_test=ddup', '--end2end', '--update_size=25000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
ValueSample - START
ValueSample - END
load_npy_dataset_from_path - df.shape = (631012, 10)
Parsing... done, took 0.1s
Data updated!
Previous data size: (606012, 10), new data size: (25000, 10)
done, took 0.1s
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
done, took 0.1s
new data average log likelihood = 45.6871
detection mean = 47.7156
detection threshold = 0.6582
test statistic = 2.0285
Offline time = 4.196202516555786
Online time = 0.1884148120880127
Test result: True
DDUp Drift detection: True
Detection latency: 5.1652s

DRIFT-DETECTED after 4-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=forest', '--end2end', '--model=transformer', '--model_update=update', '--update_size=25000', '--epochs=40']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
update_size: 25000
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (631012, 10)
Parsing... done, took 0.1s
done, took 0.1s
dataset size: 631012
train data shape: torch.Size([25000, 10]), transfer data shape:torch.Size([5000, 10])
Epoch 0 Iter 0, train entropy gap 18.4599 bits (loss 37.642, data 19.182) 0.00300 lr
epoch 9 train loss 22.0077 nats / 31.7504 bits
time since start: 5.6 secs
Epoch 10 Iter 0, train entropy gap 12.4374 bits (loss 31.620, data 19.182) 0.00245 lr
epoch 19 train loss 20.6811 nats / 29.8365 bits
time since start: 11.1 secs
Epoch 20 Iter 0, train entropy gap 10.6008 bits (loss 29.783, data 19.182) 0.00200 lr
epoch 29 train loss 19.8173 nats / 28.5903 bits
time since start: 16.6 secs
Epoch 30 Iter 0, train entropy gap 9.3142 bits (loss 28.496, data 19.182) 0.00164 lr
epoch 39 train loss 19.2585 nats / 27.7842 bits
time since start: 22.2 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 42.2425 nats / 60.9431 bits
Saved to: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
UpdateTask - END

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 4/15 | Workload-time: 7.503819 | Model-update-time: 25.151993


WORKLOAD-START | Type: QueryWorkload | Progress: 5/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=forest', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=update', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
data size: 631012, total size: 631012, split index: [525843 631012]
Parsing... done, took 0.1s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
query_seed:0
origin-forest_39.80 	max: 35.6667	99th: 10.0000	95th: 4.0000	median: 1.0553	mean: 1.6783
ReportEsts: [1.0, 1.1822700911350457, 1.0, 1.1607142857142858, 1.1428571428571428, 1.0, 1.0816901408450703, 1.0, 1.1072386058981234, 1.0, 1.0142857142857142, 4.0, 1.0, 1.5, 1.0671641791044777, 1.1868131868131868, 1.0, 2.0, 1.84375, 1.6428571428571428, 1.0, 3.0, 1.3333333333333333, 1.6, 1.25, 1.0, 1.0342472296522736, 1.2, 3.0, 1.4458333333333333, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0769230769230769, 1.0, 1.0, 1.2799097065462754, 1.25, 1.0742787295943106, 1.0, 1.4025974025974026, 1.0, 1.0, 6.0, 1.0, 3.0, 1.0329520186460204, 1.0, 1.0, 1.8, 1.120603015075377, 1.0508221225710015, 1.6666666666666667, 1.0, 1.6666666666666667, 1.118524096385542, 4.0, 1.0, 1.1676470588235295, 1.0421686746987953, 1.0, 1.269449715370019, 2.8857142857142857, 1.125925925925926, 1.0, 2.0, 1.0, 1.2682926829268293, 1.213476619227418, 2.0, 1.5, 1.0, 1.0, 1.0, 4.0, 1.0, 1.0, 1.0252899513864866, 7.0, 2.0, 1.0, 1.0, 1.3333333333333333, 1.844022519041837, 1.0, 1.0303030303030303, 2.5, 1.0287163480296528, 1.4642857142857142, 18.333333333333332, 1.5263157894736843, 1.0, 1.0, 2.0, 1.0774689532820816, 6.0, 1.1590017825311942, 1.0, 1.198952879581152, 1.0, 1.0, 1.0444365446142907, 1.0342046718576197, 1.0, 3.0, 1.08125, 1.0, 1.290909090909091, 1.0, 1.0, 1.8742287612719506, 1.2564102564102564, 4.0, 1.0, 2.0, 1.0, 1.0, 1.0, 2.0, 3.0, 1.0, 2.206371191135734, 1.0, 1.0, 1.125, 1.0, 1.0, 3.0, 1.0921797806964695, 1.0782661702915115, 1.0, 1.6, 1.0, 3.0, 2.0, 1.276064610866373, 1.7027027027027026, 1.0030869490653405, 1.0, 1.0, 1.2, 1.0, 1.4157913087011327, 1.0, 1.088235294117647, 1.1428571428571428, 1.1538461538461537, 1.0474416294088424, 1.0, 1.0, 1.0, 1.0, 4.0, 1.0, 1.0, 1.0, 1.0, 1.4615384615384615, 1.0, 1.2955428148696135, 4.0, 1.098842018196857, 1.0, 3.0, 14.0, 1.147766323024055, 1.0, 1.0, 2.9651162790697674, 1.0, 1.5027352027992706, 1.4290865384615385, 1.0, 2.5, 1.2134146341463414, 1.0, 2.0, 2.142857142857143, 35.666666666666664, 1.0, 1.0, 1.0298256392253233, 1.0, 1.068476249228871, 1.0, 1.0, 2.5294117647058822, 1.2528878461123418, 1.0, 1.6643356643356644, 3.2857142857142856, 1.0, 1.0, 1.0, 1.0, 1.4210526315789473, 1.3333333333333333, 1.1604588585186235, 1.0962532299741603, 6.0, 3.0, 1.0, 2.0, 1.0, 1.7195121951219512, 1.0, 1.0, 1.0, 4.0, 2.142857142857143, 1.0, 1.0, 1.0, 1.0, 1.0, 1.3625498007968126, 1.0, 1.0, 1.0, 1.6491946491946492, 3.0, 1.0, 2.1904761904761907, 1.0, 1.6342857142857143, 2.0, 1.0440243865077663, 1.1030134294136915, 1.2923976608187135, 1.0, 11.0, 1.0, 9.666666666666666, 1.0, 1.0, 2.0, 1.1500987491770902, 1.0715040507220852, 1.0, 1.0, 3.0, 1.0, 2.0, 4.0, 1.0, 1.0711409395973155, 10.0, 11.0, 2.0, 1.6666666666666667, 1.1584699453551912, 1.0, 1.2734082397003745, 1.4710627849877236, 2.0, 6.5, 1.0555555555555556, 1.7682403433476395, 1.2, 1.0, 1.0369605720328314, 1.2, 1.0, 1.0, 1.6, 1.0, 1.0, 1.0, 1.162162162162162, 1.5, 1.6559405940594059, 2.775, 1.0, 1.2254335260115607, 1.0, 1.25, 1.3377703826955074, 1.0, 1.0, 2.0, 1.1024498886414253, 1.1761363636363635, 1.0030404201910412, 1.5, 1.0, 1.0, 1.6666666666666667, 1.3820422535211268, 1.0, 1.103734439834025, 1.0, 1.0764331210191083, 1.0, 1.0, 1.4814814814814814, 1.2, 1.0, 1.0, 1.4455445544554455, 1.0, 2.5, 1.0, 1.0, 1.4444444444444444, 1.0, 1.5, 1.0, 1.0, 2.0, 1.0, 1.0, 1.5714285714285714, 4.0, 1.0, 1.0, 1.0, 1.0, 1.0, 5.0, 1.0, 1.0, 1.1205752212389382, 2.0, 1.0, 1.0060373216245884, 1.0, 1.0, 1.0, 1.0, 1.0127531882970742, 2.5, 3.0, 1.0, 3.0, 1.360759493670886, 2.1725965177895534, 1.1058823529411765, 1.0875, 1.0, 1.002196688070294, 2.3125, 1.0, 1.5217391304347827, 1.6666666666666667, 2.6666666666666665, 10.0, 3.5, 1.0, 1.0, 5.0, 1.0, 1.0, 1.04, 3.6666666666666665, 1.208955223880597, 2.0, 1.0, 1.0, 2.0, 1.1847389558232932, 1.875, 2.558139534883721, 1.002663584279827, 1.1830190485306786, 1.1392009099957343, 1.0469072319052886, 1.1795774647887325, 1.0, 1.6575875486381324, 3.0, 1.7076923076923076, 1.0167945823927764, 1.0, 1.076361670496013, 1.037968132915702, 1.024259092028569, 1.0, 4.5, 1.0, 1.2616279069767442, 7.0, 2.0, 1.0, 1.0380434782608696, 1.2, 2.0, 2.0, 1.0, 1.3982300884955752, 1.1428571428571428, 2.5, 1.0, 1.0, 4.25, 1.0, 1.1271534044298606, 1.0, 1.0, 1.0, 1.0, 1.0283919045262058, 1.0, 8.0, 1.4850299401197604, 1.1133017875920084, 1.266747868453106, 1.1478753541076487, 1.0261194029850746, 1.0262596422123749, 2.0220385674931127, 2.433333333333333, 1.0, 1.0, 1.0247905477980666, 1.0437184934070047, 1.0, 3.6666666666666665, 3.0, 2.0, 1.0, 2.2222222222222223, 1.0359129581151831, 1.0, 2.7554644808743167, 9.5, 1.0, 1.0, 1.0681818181818181, 1.56, 1.0, 1.0, 1.2586872586872586, 1.4725543128936882, 1.0, 1.024355300859599, 5.6, 1.0, 1.0, 1.0, 1.1261623461510002, 1.3333333333333333, 1.0, 1.5765595463137996, 1.0, 12.666666666666666, 1.0, 1.0, 1.0, 1.0365017216483394, 1.0, 1.0, 2.0, 1.8333333333333333, 1.2203389830508475, 1.1285714285714286, 1.0, 1.2921535893155258, 6.0, 1.0, 1.0357675111773472, 1.0, 1.0, 1.367626404494382, 3.0, 3.0, 1.0, 1.1402865711429524, 1.0, 1.0, 1.0, 6.0, 1.0285480684063502, 1.1610185971771594, 1.4017094017094016, 1.0, 1.0, 1.0, 2.8, 1.0, 1.1023330329428256, 1.411764705882353, 3.0, 2.0, 1.0018450184501846, 1.1602373887240356, 1.0, 1.1858790530215813, 1.6666666666666667, 2.0, 1.010319181595809, 1.6666666666666667, 1.067894315452362, 1.0, 1.0, 1.0, 1.097793735531724, 1.375, 2.0, 1.76, 1.0, 2.0, 1.5, 2.0, 3.0, 1.143939393939394, 1.737267363671858, 2.0, 1.5, 1.0, 1.1393568147013782, 2.0, 20.0, 1.09375, 1.0, 1.0190006798096534, 3.4545454545454546, 1.1851851851851851, 1.0, 2.0, 2.0, 1.0, 1.139510278113664, 1.0, 4.0, 1.1267796610169492, 2.5, 1.0, 1.3599507972768448, 1.0355467646227747, 2.9565217391304346, 1.0, 1.0, 1.0, 1.3621103117505995, 1.0, 1.0, 1.3, 1.0021672672495274, 3.8974358974358974, 2.142857142857143, 3.423076923076923, 1.4698795180722892, 1.0, 1.0789473684210527, 1.028, 1.0, 1.0, 1.5, 1.1915367483296213, 5.0, 2.0, 3.0, 1.368421052631579, 1.0, 1.1746987951807228, 1.0, 1.4639175257731958, 1.0, 2.4, 1.0272003025427145, 6.0, 1.0701910544552882, 2.8, 1.0, 1.5, 1.2421052631578948, 1.0, 1.368421052631579, 1.5833333333333333, 1.4629349470499244, 1.3159775395610005, 1.0, 1.0, 1.0, 1.2336182336182335, 1.1666666666666667, 5.5, 1.0, 1.1363636363636365, 1.0, 1.5013054830287207, 1.0, 1.0, 1.0, 1.0, 1.0, 1.5, 1.0, 1.0, 2.0, 1.3064516129032258, 1.9230769230769231, 3.25, 1.4323725055432373, 1.0, 1.0, 2.111111111111111, 1.0433949766376054, 5.030769230769231, 1.0, 1.0, 1.0, 1.0, 1.0010096275195615, 3.0, 2.0, 1.484790874524715, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.2, 1.0597701149425287, 1.1710974778459442, 1.5, 1.0, 1.0, 1.00181709748961, 1.0, 1.0, 1.0, 1.0769230769230769, 1.4936060349348501, 1.0, 3.0, 2.6, 1.3302063789868668, 1.0, 1.0, 1.0, 1.0, 1.0, 1.1321795836468522, 1.0, 2.0, 1.0255124291321414, 1.0, 1.0, 1.1399141630901288, 1.0, 1.1392095138160196, 1.0, 1.0, 1.5208333333333333, 1.0253441802252816, 10.0, 22.333333333333332, 1.0, 1.0, 2.0, 1.0931331077270163, 1.0, 1.0, 1.0, 1.0, 1.25, 1.0, 1.0, 1.0, 1.0468364831552999, 1.0, 1.0, 1.0, 1.5, 1.0, 1.25, 1.6376811594202898, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.6666666666666667, 1.0, 1.0, 1.0, 1.0, 1.0, 4.0, 1.5, 1.0, 1.0, 3.2142857142857144, 1.0, 2.0, 1.0, 1.0, 2.5357142857142856, 1.0, 1.0, 1.0, 1.520910209102091, 1.0925925925925926, 1.0, 4.0, 2.875, 1.0, 1.0416666666666667, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0096281540504648, 1.375, 1.0, 4.0, 1.0067114093959733, 1.0346415596377219, 1.0, 1.0, 1.1524983776768332, 1.0871636771300448, 1.0596026490066226, 2.25, 1.0, 1.0, 1.5300772970951253, 1.0, 2.6666666666666665, 1.0, 1.0, 1.5, 1.0606060606060606, 2.0, 1.0, 5.0, 2.263157894736842, 1.059782608695652, 2.0, 1.0, 2.0, 1.0, 1.0712727669320536, 1.5962732919254659, 1.363698164513936, 1.0, 1.0, 3.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 2.5, 1.5924369747899159, 3.0, 1.0956048769803606, 1.0, 1.0, 1.125, 1.3087818696883853, 3.0, 1.0, 1.0, 1.0, 1.0, 1.12, 1.1139455782312926, 3.0, 1.0, 1.0, 3.0, 1.0, 1.0, 1.0710944808231992, 1.0, 1.0, 2.0, 1.0, 1.1020942408376964, 1.052352048558422, 1.0, 1.0, 1.1951219512195121, 1.3181818181818181, 2.0, 1.0526315789473684, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0625, 2.0, 1.0, 1.128125, 1.0231450866287528, 2.3333333333333335, 1.0, 1.0, 1.0, 1.0, 2.4, 1.0, 1.0, 1.7743451981195433, 1.0, 3.0, 3.1515151515151514, 2.0, 1.5555555555555556, 1.0, 2.0974729241877257, 1.1818181818181819, 1.0, 1.375, 1.2058823529411764, 1.0, 1.7499745909137108, 1.0, 1.2955032119914347, 3.0, 1.0, 1.0, 1.0, 1.0, 1.1666666666666667, 1.0, 1.0, 1.0, 3.0, 1.369047619047619, 1.0, 1.0, 1.1180708890180129, 1.2647330003841721, 1.0, 1.0, 1.0, 1.0915119363395225, 2.0, 1.2976744186046512, 1.0, 1.0522821576763486, 2.0, 2.0, 1.2, 1.3333333333333333, 1.6666666666666667, 1.064751481988144, 1.0, 2.5238095238095237, 1.0, 2.0, 2.5, 1.0, 2.0, 1.0, 1.3333333333333333, 5.0, 1.0, 1.0, 1.6666666666666667, 1.0, 1.1111111111111112, 1.0, 4.0, 1.0, 1.2088901392600928, 1.0, 1.0, 3.0, 1.0, 1.0, 1.1547619047619047, 1.0, 3.0, 1.0, 1.0, 5.143434343434343, 3.0, 1.3909090909090909, 1.0, 1.7, 1.0, 1.0, 5.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.1282051282051282, 1.0003213049925852, 1.0, 2.0825688073394497, 1.3333333333333333, 1.4588235294117646, 1.0, 1.2351885098743267, 1.0, 4.8, 1.591976516634051, 1.0, 1.0, 3.0, 2.0, 1.1333333333333333, 1.0, 1.055064914972345, 1.5795936202752896, 2.219178082191781, 2.0, 1.0, 2.0, 1.0, 3.0, 1.0, 1.0, 1.0, 6.0, 2.0, 1.0, 1.0, 1.0, 1.0869688787835725, 1.0775563258232235, 1.0, 1.0, 2.2857142857142856, 1.026190476190476, 1.0, 2.0, 1.4480594549958712, 2.0, 1.0108695652173914, 1.0, 1.0, 1.0, 3.0, 1.8, 1.0, 1.0720811562318575, 1.0, 1.0, 1.117624373312765, 1.0, 1.157190635451505, 3.0, 3.0, 2.0, 1.6990291262135921, 1.0, 2.0, 1.2682926829268293, 1.0896986063748004, 1.0, 3.6, 2.0, 1.0, 1.5820183486238533, 2.0, 3.0, 1.0, 1.2683823529411764, 1.0, 2.6216216216216215, 3.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.3409090909090908, 1.0, 1.3614232209737829, 1.5, 1.0298823052339896, 1.0, 1.0, 1.0, 1.0, 1.0, 8.5, 1.5, 1.0, 1.0, 2.0, 1.1493775933609958, 1.0, 1.1111111111111112, 1.1142857142857143, 2.8983050847457625]
origin-forest_39.80 	max: 35.6667	99th: 10.0000	95th: 4.0000	median: 1.0553	mean: 1.6783

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 5/15 | Workload-time: 28.054145 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 6/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=valueskew', '--dataset=forest', '--drift_test=ddup', '--end2end', '--update_size=25000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
ValueSample - START
ValueSample - END
load_npy_dataset_from_path - df.shape = (656012, 10)
Parsing... done, took 0.1s
Data updated!
Previous data size: (631012, 10), new data size: (25000, 10)
done, took 0.1s
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
done, took 0.1s
new data average log likelihood = 43.9924
detection mean = 48.2661
detection threshold = 0.7256
test statistic = 4.2737
Offline time = 4.172330856323242
Online time = 0.19114947319030762
Test result: True
DDUp Drift detection: True
Detection latency: 5.1391s

DRIFT-DETECTED after 6-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=forest', '--end2end', '--model=transformer', '--model_update=update', '--update_size=25000', '--epochs=40']
