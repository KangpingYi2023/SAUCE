Input arguments = Namespace(data_update='valueskew', update_size=25000, dataset='forest', debug=False, drift_test='ddup', model_update='update', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=15)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-2'}, 'random_seed': 3, 'transformer': {'epochs': 40}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/forest/end2end/forest.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=forest', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=update', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
load_csv_dataset - forest (581012, 10)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
query_seed:0
origin-forest_39.80 	max: 102.0000	99th: 4.2675	95th: 2.0383	median: 1.0035	mean: 1.4303
ReportEsts: [1.0, 1.0790436691876066, 1.0, 1.2553191489361701, 1.3333333333333333, 1.0, 1.1328125, 1.0, 1.7692307692307692, 1.0, 1.1964285714285714, 2.0, 1.0, 1.0, 3.0, 1.0457807455239214, 1.0, 1.1111111111111112, 1.169811320754717, 1.125, 1.0, 3.0, 1.0, 1.4, 1.4, 1.0, 1.105379176090006, 1.3, 3.0, 1.6177156177156178, 1.0, 1.1115409413281754, 2.0, 1.0, 1.1982758620689655, 1.0503367600141793, 1.021499128413713, 1.0, 1.0513661202185793, 1.0, 2.0, 1.0, 1.2142857142857142, 1.0, 1.618421052631579, 1.094170403587444, 1.0, 1.0, 1.0, 1.0, 3.0, 1.1706411698537682, 1.0, 1.0, 3.6, 1.0603015075376885, 1.1382823871906842, 1.619047619047619, 1.0, 1.0, 1.0087794801170598, 1.6666666666666667, 1.0, 1.428310502283105, 1.1656050955414012, 1.0, 1.2225063938618925, 1.02020202020202, 1.2369477911646587, 1.0, 2.0, 1.0, 1.1374407582938388, 1.1801621564704643, 1.5, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.06040913085239, 3.5, 1.0, 1.0, 1.0, 1.3333333333333333, 1.2329242741694104, 1.0, 1.6, 1.3142857142857143, 1.0, 1.0367892976588629, 1.0, 1.0, 1.0250042332223288, 1.3305084745762712, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0551724137931036, 1.0, 1.0, 1.0, 1.0724637681159421, 1.0, 1.0140845070422535, 1.0, 1.0, 1.0549506204102304, 1.2346938775510203, 2.0, 1.0, 2.0, 1.0, 1.0, 1.0, 2.0, 3.0, 1.0, 1.1644695543000627, 1.1428571428571428, 1.0, 1.1111111111111112, 1.0, 1.0, 1.0, 1.211404526987812, 1.1899090458940345, 1.0, 1.5, 1.0, 1.0, 2.0, 1.008581937065795, 1.4444444444444444, 1.0705559710795314, 1.0, 1.0, 1.2, 1.0, 1.049280797185469, 1.0, 1.3, 2.0869565217391304, 1.2307692307692308, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.3333333333333335, 1.6842105263157894, 1.0, 1.0485603112840467, 2.0, 1.0369238005644403, 1.0, 1.3333333333333333, 6.0, 1.035598705501618, 1.0, 1.0, 1.0, 1.064, 1.2083333333333333, 1.0, 1.0, 1.1741071428571428, 1.0, 1.0853658536585367, 1.0, 1.4758620689655173, 1.0, 1.0, 1.104027325442847, 1.0, 1.1362771221926151, 1.0, 1.0, 1.0232558139534884, 1.0783203023869932, 1.0, 1.23109243697479, 2.5555555555555554, 1.0, 1.0, 1.0, 1.0, 1.1944444444444444, 1.1428571428571428, 1.3330960854092526, 1.0979153506001262, 1.3333333333333333, 1.0, 1.0, 2.0, 3.0, 1.2935779816513762, 1.0, 1.0, 1.0, 1.0, 1.1176470588235294, 1.0, 1.125, 1.0, 1.0, 1.0, 1.075, 1.0, 2.0, 1.0, 1.1302151543498598, 1.5, 1.0, 1.3529411764705883, 1.0, 1.25625, 1.0, 1.3615023474178405, 1.0, 1.0, 1.0, 1.2222222222222223, 2.0, 3.423076923076923, 1.0, 1.0, 1.0, 1.0701852265119394, 1.0057559478127398, 1.0, 2.0, 1.5, 1.0594471790988262, 1.2852459016393443, 1.375, 1.0, 1.0013755158184319, 2.5, 1.2748287671232876, 1.0, 1.6666666666666667, 1.1886792452830188, 1.0, 1.526470588235294, 1.2284710017574691, 1.7857142857142858, 2.0, 1.4363636363636363, 1.0377833753148615, 2.0, 1.0, 1.1413737019892405, 1.25, 2.0, 1.0, 1.1428571428571428, 1.0, 1.0, 1.0, 1.027027027027027, 1.5, 1.7189105858170606, 2.0, 1.0, 1.175684577020796, 1.2857142857142858, 1.0, 1.0869565217391304, 1.0, 1.0, 1.0, 1.3333333333333333, 1.0, 1.0, 1.0, 2.0, 1.0, 2.6056338028169015, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.5087514585764294, 1.5932203389830508, 1.0355292376017764, 1.0037593984962405, 1.0, 1.389516129032258, 1.0, 1.0, 1.5, 1.0, 1.2803030303030303, 1.0, 2.0, 1.0, 1.148936170212766, 1.0, 1.0, 1.0833333333333333, 1.5, 1.0, 1.0, 1.0, 1.0, 1.0, 3.6, 1.0, 1.0, 1.08594030924128, 1.5, 1.0, 1.0544170502553756, 1.0, 1.0, 1.0, 1.0, 1.274787535410765, 2.0, 3.0, 1.0, 1.0, 1.048780487804878, 1.0, 1.0731707317073171, 1.146341463414634, 1.0, 1.164245810055866, 1.5765765765765767, 1.0, 1.2962962962962963, 1.0, 1.1428571428571428, 10.0, 1.5, 1.0, 1.0, 1.0, 1.0, 1.0, 1.3275862068965518, 11.0, 1.4320987654320987, 1.2, 1.0, 1.0, 1.0, 1.39010989010989, 1.3, 1.0891089108910892, 1.0961960096470071, 1.156503441322169, 1.4831852791878173, 1.049073916737468, 1.6264150943396227, 1.0, 1.4413145539906103, 1.0, 1.218694885361552, 1.0196181818181818, 1.0, 1.0220713285314125, 1.039426523297491, 1.0843357797368307, 1.0, 1.6666666666666667, 1.0, 1.0526315789473684, 1.0, 1.0, 1.043859649122807, 102.0, 1.0, 3.4, 1.0, 1.1633976833976833, 1.0, 10.0, 1.0769230769230769, 1.0, 1.0, 4.25, 1.0, 1.0227987421383649, 1.0, 1.0, 1.0, 1.0, 1.003636257854317, 1.0, 2.0, 1.076086956521739, 1.7088948787061995, 1.311411992263056, 1.1946508172362555, 1.2114537444933922, 1.111281302318954, 1.1740412979351031, 1.434782608695652, 1.0, 1.0, 1.119479127841968, 1.1396750464055732, 1.0, 1.0909090909090908, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.105099150141643, 2.5, 1.1406649616368287, 1.0, 1.0, 1.0, 1.1167832167832168, 1.0819873429677906, 2.5, 1.2679938744257273, 3.5, 1.0, 1.0, 1.0, 1.0185630416550182, 2.0, 1.0, 1.381294964028777, 1.0, 1.8095238095238095, 1.0, 1.0, 1.0, 1.0352170113603263, 1.0, 1.0, 2.0, 1.4285714285714286, 1.0869565217391304, 1.0089418777943369, 1.75, 1.0, 1.0, 1.1538461538461537, 1.25, 2.0, 1.0102695763799743, 1.0, 1.4444444444444444, 1.0, 1.0, 1.1818181818181819, 1.0, 1.0, 2.7777777777777777, 1.0134247564056298, 1.0715601127682794, 1.452054794520548, 1.64, 1.0, 1.0, 1.7142857142857142, 1.0, 1.21110020717479, 1.3714285714285714, 1.5, 1.0, 1.8339483394833949, 1.0614973262032086, 1.0, 1.0270065869724323, 1.0, 2.0, 1.0544114043405535, 2.5, 1.0154948350549817, 1.0, 1.0, 1.0, 1.0210954993649088, 1.7142857142857142, 2.0, 1.28, 1.0, 2.0, 1.0, 1.1538461538461537, 1.0, 1.0264900662251655, 1.092603956634815, 2.0, 1.0, 1.0, 1.1064516129032258, 2.0, 20.0, 1.2560975609756098, 1.0, 1.035469644365206, 1.3761904761904762, 1.12, 1.0, 1.0, 1.0, 2.0, 1.1951934349355218, 1.5, 4.0, 1.038716814159292, 2.6, 1.0, 1.0435599159074982, 1.0, 2.0, 1.0, 2.0, 1.0, 1.2453183520599251, 1.0, 1.0, 1.4285714285714286, 1.0378423305489757, 2.814814814814815, 2.610062893081761, 1.1, 1.3972602739726028, 2.0, 1.3103448275862069, 1.062111801242236, 1.0, 1.0, 1.1538461538461537, 1.2956705385427667, 2.5, 2.0, 1.1428571428571428, 1.1714285714285715, 1.0, 1.206451612903226, 1.0, 1.3137254901960784, 1.0, 1.7142857142857142, 1.0661242038856409, 6.0, 1.0215867533522958, 2.0, 1.0, 3.0, 1.0, 1.0, 2.0, 1.0852956567242282, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0961538461538463, 2.0, 2.2941176470588234, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.3466666666666667, 1.08, 1.5, 1.2066666666666668, 1.0, 1.0, 1.75, 1.0403169565700772, 2.5714285714285716, 1.0, 1.0, 1.0, 1.0, 1.0004692999608917, 1.0, 1.0, 1.037536092396535, 1.4903954802259887, 1.1914893617021276, 2.0, 1.0, 1.0, 1.0, 1.0588235294117647, 1.0, 1.0, 1.0, 1.3060556464811783, 2.0, 1.07375132837407, 1.0, 1.0, 1.0355656565656566, 1.0, 1.0, 1.0, 1.105263157894737, 1.1003625772705659, 1.0, 2.0, 1.4444444444444444, 1.2103960396039604, 1.0, 1.0, 1.5, 1.0, 1.0, 1.0130438968040045, 1.0, 2.0, 1.0351006381934218, 1.0, 1.0, 1.1090814196242171, 1.0, 1.0842091933645688, 1.0, 1.0, 1.365702479338843, 1.0210669384981312, 1.4285714285714286, 1.4772727272727273, 1.0, 1.0, 2.0, 1.0108471468948133, 1.0, 1.0, 1.0, 1.0, 1.3, 1.0, 1.0, 1.5, 1.0247252747252746, 1.0, 2.0, 1.0, 1.5, 1.0, 1.2, 1.153061224489796, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.1111111111111112, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0016370106761565, 1.6517412935323383, 1.0, 2.0, 1.5, 1.0881294964028776, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0145555899659338, 1.0434782608695652, 1.303030303030303, 1.011425732737208, 1.0, 1.393939393939394, 1.0, 1.48, 1.0, 1.2, 1.0, 1.0, 1.0, 1.0410312273057372, 1.125, 1.0, 4.0, 1.0666666666666667, 1.174602291689843, 1.0, 1.0, 1.1938551572787126, 1.170193192272309, 1.2835820895522387, 1.125, 1.0, 1.0, 1.0209000540697917, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0215568862275448, 1.0, 1.0, 1.0666666666666667, 2.0, 1.0, 1.5, 1.2666666666666666, 1.0, 1.0623342175066313, 1.0432955023118957, 1.0, 1.0, 1.0, 3.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 2.0, 3.0, 1.0317919075144508, 2.0, 1.1548453526593006, 1.0, 1.0, 1.6363636363636365, 1.3838150289017341, 1.5, 1.0, 1.0, 1.0, 1.0, 2.0357142857142856, 1.4046391752577319, 3.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0262329485834207, 1.0, 1.0, 1.0, 1.0, 1.1320754716981132, 1.0092204526404023, 1.0, 1.0, 1.0804597701149425, 1.0, 2.0, 1.4036144578313252, 1.0, 1.0, 1.0, 1.0, 1.0, 1.6, 2.0, 1.0, 1.027355623100304, 1.054033600726502, 1.3333333333333333, 1.0, 1.0, 1.0, 1.0, 2.4, 1.0, 1.0, 1.2682119205298013, 1.0, 1.0, 1.2424242424242424, 1.3333333333333333, 18.0, 1.0, 2.008605851979346, 1.0, 1.0, 7.666666666666667, 1.0, 1.1111111111111112, 1.0033898305084745, 1.0, 1.0526315789473684, 1.0, 1.1136363636363635, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0101010101010102, 1.0, 1.0, 1.0383096366508688, 1.0759940290405754, 1.0, 1.0, 1.0, 1.005074045666411, 1.0, 1.2384105960264902, 1.0, 1.1134598792062123, 2.0, 1.0, 1.1538461538461537, 1.5, 1.6666666666666667, 1.0756613756613758, 1.0, 1.8, 1.0, 1.5, 1.25, 1.0, 1.0, 1.0, 2.0, 2.5, 1.0, 1.0, 1.6666666666666667, 1.0, 2.0, 1.0, 4.0, 1.0, 1.3333333333333333, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.038888888888889, 2.0, 1.0, 1.0, 1.0, 1.0, 1.105263157894737, 2.0, 1.0, 1.072538860103627, 1.0, 1.2880921895006403, 1.0, 1.5137861466039004, 1.0, 1.34375, 1.5384615384615385, 1.1818181818181819, 1.0, 1.0, 1.0555555555555556, 1.0298310066127847, 1.0, 1.0, 1.0142857142857142, 1.0, 1.0, 1.0, 2.0, 1.0711444254264297, 1.0, 1.8571428571428572, 1.0, 1.0784313725490196, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 3.0, 2.0, 1.0, 1.0, 1.0, 1.0421545667447307, 1.0382860720994722, 1.0, 1.0, 1.2307692307692308, 1.0502793296089385, 1.0, 2.0, 1.0348571878196553, 1.125, 1.1948051948051948, 1.0, 1.0, 1.0, 1.5, 2.2888888888888888, 1.0, 1.279883011190234, 1.0, 1.0, 1.214488188976378, 1.0, 12.0, 1.0, 1.0, 1.0, 1.0462633451957295, 1.0, 1.5, 1.0555555555555556, 1.0661074020319303, 1.0, 1.5714285714285714, 2.0, 1.0, 1.072952911157504, 2.0, 1.75, 1.0, 1.209016393442623, 1.0, 1.1538698735738513, 1.5, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.3076923076923077, 1.0, 1.2634844868735084, 1.0, 1.0748092082535097, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.059494242492662, 2.0, 1.0491935483870967, 1.0, 1.1179010730175347, 1.0357142857142858, 2.0, 1.0847457627118644, 1.275, 1.0, 1.0, 1.0, 1.2276029055690072, 1.0, 1.0, 1.2555555555555555, 2.0, 1.0]
origin-forest_39.80 	max: 102.0000	99th: 4.2675	95th: 2.0383	median: 1.0035	mean: 1.4303

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/15 | Workload-time: 28.172329 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=valueskew', '--dataset=forest', '--drift_test=ddup', '--end2end', '--update_size=25000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
ValueSample - START
ValueSample - END
load_npy_dataset_from_path - df.shape = (606012, 10)
Parsing... done, took 0.1s
Data updated!
Previous data size: (581012, 10), new data size: (25000, 10)
done, took 0.1s
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
done, took 0.1s
new data average log likelihood = 129.3023
detection mean = 40.8669
detection threshold = 0.3065
test statistic = 88.4354
Offline time = 4.185040235519409
Online time = 0.18019771575927734
Test result: True
DDUp Drift detection: True
Detection latency: 5.3551s

DRIFT-DETECTED after 2-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=forest', '--end2end', '--model=transformer', '--model_update=update', '--update_size=25000', '--epochs=40']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
update_size: 25000
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (606012, 10)
Parsing... done, took 0.1s
done, took 0.1s
dataset size: 606012
train data shape: torch.Size([25000, 10]), transfer data shape:torch.Size([5000, 10])
Epoch 0 Iter 0, train entropy gap 28.7537 bits (loss 47.960, data 19.207) 0.00300 lr
epoch 9 train loss 22.4631 nats / 32.4074 bits
time since start: 5.7 secs
Epoch 10 Iter 0, train entropy gap 13.0274 bits (loss 32.234, data 19.207) 0.00245 lr
epoch 19 train loss 20.8950 nats / 30.1450 bits
time since start: 11.3 secs
Epoch 20 Iter 0, train entropy gap 10.8093 bits (loss 30.016, data 19.207) 0.00200 lr
epoch 29 train loss 19.9920 nats / 28.8424 bits
time since start: 16.9 secs
Epoch 30 Iter 0, train entropy gap 9.6074 bits (loss 28.814, data 19.207) 0.00164 lr
epoch 39 train loss 19.4119 nats / 28.0055 bits
time since start: 22.5 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 43.9522 nats / 63.4096 bits
Saved to: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
UpdateTask - END

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/15 | Workload-time: 7.710419 | Model-update-time: 25.551256


WORKLOAD-START | Type: QueryWorkload | Progress: 3/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=forest', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=update', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
data size: 606012, total size: 606012, split index: [505010 606012]
Parsing... done, took 0.1s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
query_seed:0
origin-forest_39.80 	max: 76.0000	99th: 11.0133	95th: 3.7125	median: 1.0296	mean: 1.7472
ReportEsts: [1.0, 1.035119315623593, 1.0, 1.84375, 1.0, 1.0, 1.0169491525423728, 1.0, 2.3630573248407645, 1.0, 1.5813953488372092, 2.0, 1.0, 1.0, 2.3333333333333335, 1.155, 1.3085106382978724, 1.0, 1.4363636363636363, 4.375, 1.0, 3.0, 20.0, 1.6, 2.5, 1.0, 1.0481542125632628, 1.2142857142857142, 3.0, 6.36697247706422, 1.0, 3.8, 1.0, 1.0, 2.0, 2.0, 1.0, 1.0, 1.037037037037037, 1.0, 2.0, 1.237090909090909, 5.0, 1.0256594881193952, 1.0, 1.3654485049833887, 2.0, 2.0, 12.333333333333334, 1.0, 1.5, 1.0302744139540052, 1.0, 1.0, 2.25, 1.0642201834862386, 1.305944055944056, 1.2162162162162162, 1.0, 1.0, 1.1252187748607796, 1.0909090909090908, 1.0, 1.047004608294931, 1.2891566265060241, 1.0, 1.1569086651053864, 1.9803921568627452, 1.1245136186770428, 1.0, 2.0, 1.0, 1.0638297872340425, 1.154931219398461, 1.3333333333333333, 1.5, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0485766366739062, 7.0, 1.04, 1.0, 1.0, 2.2, 1.5286420204978037, 1.0, 1.3333333333333333, 2.0, 1.1301029790364105, 1.0, 7.857142857142857, 1.1363636363636365, 1.0, 1.0, 2.0, 1.029603315571344, 3.0, 1.1062765691422856, 1.0, 1.4083769633507854, 1.0, 1.0, 1.0053676865271068, 1.0257351714009146, 1.0, 1.0, 1.2912280701754386, 2.0, 1.5949367088607596, 1.0, 1.0, 1.105967353492106, 2.419753086419753, 1.0, 1.0, 3.0, 1.0, 1.0, 1.0, 2.0, 3.0, 1.0, 1.5500894454382828, 1.3333333333333333, 1.0, 1.1, 1.0, 1.0, 1.0, 1.3159166414980368, 1.0651303277771562, 2.0, 1.6666666666666667, 1.0, 1.0, 2.0, 1.0193423597678917, 1.3695652173913044, 1.0136069329614503, 1.0, 1.0, 5.0, 1.0, 1.1706659397056993, 1.0, 1.3333333333333333, 4.8, 1.2307692307692308, 1.3846153846153846, 1.0, 1.0, 1.0, 1.0, 4.0, 1.0, 1.0, 1.0, 1.3333333333333333, 3.7777777777777777, 1.0, 1.105046851882295, 1.5, 1.0500571428571428, 1.0, 2.0, 1.0, 1.1360294117647058, 1.0, 1.0, 6.96969696969697, 1.0, 1.317925638431842, 1.1915571485463958, 1.0, 5.327868852459017, 2.0, 1.0, 1.0, 2.857142857142857, 2.4597701149425286, 1.0, 1.0, 1.0529352658181597, 2.0, 1.2647058823529411, 1.0, 1.0, 2.15, 1.3832461011185206, 1.0, 1.9833333333333334, 23.0, 1.0, 1.0, 1.0, 1.0, 1.118421052631579, 1.3333333333333333, 1.0654307524536533, 1.190990990990991, 1.3333333333333333, 1.0, 1.0, 2.0, 1.0, 3.710526315789474, 1.0, 1.0, 1.0, 1.0, 1.411764705882353, 1.0, 1.2857142857142858, 1.0, 1.0, 1.0, 1.1818181818181819, 1.0, 1.0, 1.0, 1.0786993402450518, 3.0, 1.0, 6.571428571428571, 1.0, 1.1702127659574468, 2.0, 1.6384615384615384, 1.0, 1.0, 1.0, 5.5, 1.0, 4.416666666666667, 1.0, 1.0, 1.0, 1.1436078308177806, 1.405857740585774, 1.0, 1.0, 1.5, 1.0270848182466144, 1.5372549019607844, 2.0, 1.0, 1.1083455344070279, 3.1176470588235294, 1.75, 1.0, 2.3333333333333335, 1.6083333333333334, 1.0, 1.0119047619047619, 1.1938037087290818, 1.2857142857142858, 1.0, 1.0040983606557377, 1.2780269058295963, 2.0, 1.0, 1.1661143838978891, 1.75, 2.6666666666666665, 1.0, 1.1428571428571428, 1.0, 1.0, 1.0, 2.6, 1.5, 1.888763410502541, 2.0, 1.0, 1.3103448275862069, 1.0, 1.3061224489795917, 1.3111111111111111, 1.0, 1.0, 2.3333333333333335, 1.2645631067961165, 1.0903954802259888, 1.021836950767602, 3.5, 1.0, 1.0, 1.2666666666666666, 1.310708898944193, 1.0, 2.2735042735042734, 1.0, 1.7763157894736843, 1.0, 1.0, 1.1428571428571428, 1.3333333333333333, 1.0, 1.0, 1.1729323308270676, 1.0, 1.0, 1.0, 1.0, 1.2916666666666667, 1.0, 1.5, 1.0, 1.0, 1.7272727272727273, 1.0, 1.0, 2.4166666666666665, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 3.1666666666666665, 1.0, 1.0, 1.0052002080083204, 2.0, 1.0, 1.022338348455266, 1.0, 1.0, 1.0, 1.0, 1.171851851851852, 2.0, 3.0, 1.0, 3.0, 1.0696517412935322, 1.1875, 1.010989010989011, 2.5964912280701755, 1.0, 2.090690208667737, 2.176470588235294, 1.0, 1.0256410256410255, 1.6666666666666667, 4.0, 10.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.6611570247933884, 11.0, 3.0, 6.0, 1.0, 1.0, 1.0, 2.6914893617021276, 1.4, 1.375, 1.0506970849176172, 1.0775728949041694, 1.4623057295291115, 1.002052940993499, 1.2401433691756272, 1.0, 3.0869565217391304, 1.0, 1.2974867085548574, 1.0677772602314346, 1.0, 1.0093539831391494, 1.0023722528221628, 1.0962153761769815, 1.0, 2.5, 1.0, 1.0647058823529412, 2.0, 2.0, 1.0, 1.6646825396825398, 1.0, 4.0, 1.0, 1.0, 1.1428571428571428, 1.6666666666666667, 1.75, 1.0, 1.0, 17.0, 1.0, 1.1407725321888411, 1.0, 1.0, 1.0, 1.0, 1.021554725131076, 1.0, 2.0, 1.1124121779859484, 5.545907224600332, 1.36096256684492, 1.400739827373613, 1.4864864864864864, 1.0416296397566478, 1.3982808022922637, 1.4411764705882353, 1.0, 1.0, 1.010658958493293, 1.0123761276274275, 1.0, 11.0, 1.0, 2.0, 1.0, 1.8032786885245902, 1.0979129731579111, 1.0, 2.297266514806378, 76.0, 1.0, 1.0, 1.1523178807947019, 1.7, 1.0, 6.0, 1.3647276084949216, 1.12057668915183, 1.25, 1.0295420974889218, 1.2173913043478262, 1.0, 1.0, 1.0, 1.068535097962891, 1.5, 1.0, 1.4317596566523605, 1.0, 1.25, 1.0, 1.0, 1.0, 1.072348060103162, 1.0, 1.0, 2.0, 2.3333333333333335, 1.2574257425742574, 1.1142857142857143, 1.0, 1.0526315789473684, 1.0, 1.0, 1.0205911945321444, 1.0, 1.0, 1.6022213081036611, 1.0, 3.25, 1.0, 1.0, 1.3333333333333333, 1.0, 1.0, 10.0, 1.0415227403569371, 1.0107648664099493, 1.183453237410072, 3.8181818181818183, 1.0, 1.0, 1.0, 1.0, 1.0179123573941784, 1.5142857142857142, 1.5, 2.0, 1.952029520295203, 1.196969696969697, 1.0, 1.139924917253482, 1.2857142857142858, 2.0, 1.0250659078545423, 1.6666666666666667, 1.056254136333554, 1.0, 1.0, 1.0, 1.1807943603851445, 1.0, 3.0, 1.4705882352941178, 1.0, 2.0, 2.0, 1.4857142857142858, 1.0, 1.0559006211180124, 1.6981565801688696, 2.0, 1.0, 1.0, 1.138655462184874, 2.0, 2.35, 1.35, 1.0, 1.0074920790519368, 2.472972972972973, 1.0, 2.0, 2.0, 1.0, 1.0, 1.2987261146496816, 1.5, 5.0, 1.18339222614841, 5.0, 1.0, 8.204396910279263, 1.0217239776951672, 2.5, 2.0, 1.0, 1.0, 1.2558983666061705, 1.0, 1.0, 1.1, 1.0282912079689652, 1.853658536585366, 1.4551724137931035, 1.8571428571428572, 1.0135135135135136, 1.0, 1.5128205128205128, 1.0099857346647647, 2.0, 1.0, 1.7391304347826086, 1.6257901390644753, 2.5, 2.0, 2.6666666666666665, 1.015748031496063, 1.0, 1.4175257731958764, 1.0, 1.0796915167095116, 1.0, 2.0, 1.0236722098157824, 9.0, 1.109631039221905, 3.5, 1.0, 3.0, 1.0, 1.0, 1.358974358974359, 4.25, 1.8102345415778252, 1.132688927943761, 1.0, 1.0, 1.0, 1.1047120418848169, 1.5, 1.5714285714285714, 1.0, 1.2222222222222223, 1.0, 1.5, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 2.1506849315068495, 1.25, 2.0, 1.107394366197183, 1.0, 1.0, 1.0, 1.0265155861541404, 3.3333333333333335, 1.0, 1.0, 1.0, 1.0, 1.0233129776856014, 1.0, 2.0, 1.3532219570405728, 1.0, 1.0, 1.0, 3.5, 3.0, 1.0, 1.0, 1.0, 1.0, 1.0909090909090908, 1.0651041666666667, 1.1118729700469145, 2.5, 2.0, 2.0, 1.0240215505964205, 1.0, 1.0, 1.0, 1.2142857142857142, 1.0033125791290172, 1.0, 3.0, 1.3846153846153846, 1.1272321428571428, 1.0, 1.0, 1.5, 1.0, 1.0, 1.0759795401499728, 1.0, 3.0, 1.0226107226107226, 1.0, 1.0, 1.0077484047402006, 1.0, 1.0769432428889762, 1.0, 1.0, 1.1716566866267466, 1.0561582641991065, 20.0, 5.666666666666667, 1.0, 1.0, 4.0, 1.0050821241805996, 1.0, 1.0, 1.0, 1.0, 1.6666666666666667, 3.0, 1.0, 1.5, 2.4761904761904763, 1.0, 1.0, 1.0, 1.0, 1.0, 1.3571428571428572, 1.1563981042654028, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.25, 1.0, 1.0, 1.0, 1.0, 1.0, 1.3333333333333333, 1.0117732789834446, 1.1475903614457832, 1.0, 2.0, 3.0, 1.4005037783375316, 1.0, 1.0, 1.0, 1.5, 1.0, 1.069201995012469, 1.1022727272727273, 16.5, 1.072257758824923, 1.0, 46.0, 2.0, 1.125, 1.0, 3.0, 1.0, 1.0, 1.0, 1.0680044593088072, 1.65625, 1.0, 4.0, 1.1830985915492958, 1.0023994881092033, 1.0, 1.0, 1.0628321350422008, 1.2494489346069066, 1.119047619047619, 1.8, 1.0, 1.0, 1.489366220685052, 1.0, 1.1428571428571428, 1.0, 1.0, 1.0, 1.3210290827740492, 1.0, 1.0, 1.0666666666666667, 1.0, 1.0, 3.0, 1.1612903225806452, 2.0, 1.0813886210221793, 1.1802656546489563, 1.0, 1.0, 17.0, 1.0894702886713978, 2.6666666666666665, 2.0, 1.0, 1.0, 2.0, 2.0, 1.21385777546236, 1.0208447437095267, 1.28, 1.8571428571428572, 1.2468695580064681, 2.0, 1.0, 1.003975424647633, 1.0, 1.7714285714285714, 1.0128869981057664, 1.0, 2.634020618556701, 2.1058823529411765, 2.0, 4.5, 1.2734829592684955, 1.1974789915966386, 3.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.1532438478747205, 1.0, 1.0, 2.0, 1.0, 1.1296296296296295, 1.318878900052882, 1.0, 1.0, 1.4206349206349207, 1.588235294117647, 2.0, 1.036144578313253, 2.0, 1.0, 1.0, 1.0, 1.0, 2.2857142857142856, 1.0, 1.0, 1.220216606498195, 1.1423066336361134, 1.0909090909090908, 1.0, 1.0, 1.0, 1.0, 1.4, 1.0, 1.0, 2.2302631578947367, 1.0, 1.0, 1.3076923076923077, 1.5, 4.305555555555555, 1.0, 1.9366666666666668, 1.0, 1.0, 1.131578947368421, 2.7755102040816326, 1.0, 1.3701413427561837, 1.0, 2.1588447653429603, 1.6666666666666667, 1.0, 1.0, 1.0, 2.0, 1.0769230769230769, 1.0, 1.0, 1.0, 1.0, 1.5454545454545454, 1.0, 1.0, 1.0026839087471027, 1.19164486524646, 1.0, 1.0, 1.0, 1.0372806383532336, 1.0, 17.0, 1.0, 1.1545754328112119, 2.0, 1.0, 1.5714285714285714, 1.3333333333333333, 1.6666666666666667, 1.069223573433115, 1.0, 2.1555555555555554, 1.0, 2.0, 2.5, 1.0, 1.0, 1.0, 8.0, 5.0, 1.0, 1.0, 2.6666666666666665, 1.0, 1.0, 1.0, 1.5, 1.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.228352417904798, 2.0, 1.0, 1.0, 1.0, 1.0, 1.5037593984962405, 2.0, 1.0, 1.6633928571428571, 1.0, 1.5485969906466044, 1.0, 1.3277527366387636, 1.0, 1.0612244897959184, 2.3846153846153846, 1.4615384615384615, 1.0, 1.0, 2.5555555555555554, 1.1883116883116882, 1.2, 2.0, 1.5319148936170213, 1.0, 1.0462962962962963, 1.0, 1.0, 1.0, 1.0, 1.037532821195005, 1.3096989239520307, 1.6981132075471699, 1.3333333333333333, 1.0, 1.5, 1.0, 1.0, 1.0, 1.0, 1.0, 6.0, 1.0, 2.0, 1.0, 1.0, 1.0701375775559752, 1.3547018904508, 2.0, 1.0, 1.6363636363636365, 1.045822102425876, 1.0, 2.0, 1.3318481012658228, 1.6666666666666667, 1.6829268292682926, 1.0, 1.0, 1.0, 2.3333333333333335, 3.75, 1.0, 1.0709939148073022, 1.0, 1.0, 1.1392111368909512, 1.3333333333333333, 1.3493975903614457, 1.0, 3.0, 2.0, 1.5310344827586206, 1.0, 2.0, 1.7777777777777777, 1.1559459235642418, 1.0, 1.0, 2.0, 1.0, 1.6555299539170507, 2.0, 3.5, 1.0, 1.3134328358208955, 1.0, 1.3237016790316283, 3.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.6470588235294117, 1.0, 1.0984126984126985, 3.0, 1.0027926787615775, 1.0, 1.0, 1.0, 1.0, 1.0, 3.9, 1.3333333333333333, 1.0, 1.0, 2.0, 1.4695121951219512, 1.0, 1.4285714285714286, 1.32, 1.407079646017699, 1.0]
origin-forest_39.80 	max: 76.0000	99th: 11.0133	95th: 3.7125	median: 1.0296	mean: 1.7472

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/15 | Workload-time: 27.983863 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 4/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=valueskew', '--dataset=forest', '--drift_test=ddup', '--end2end', '--update_size=25000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
ValueSample - START
ValueSample - END
load_npy_dataset_from_path - df.shape = (631012, 10)
Parsing... done, took 0.1s
Data updated!
Previous data size: (606012, 10), new data size: (25000, 10)
done, took 0.1s
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
done, took 0.1s
new data average log likelihood = 45.6901
detection mean = 47.7414
detection threshold = 0.7111
test statistic = 2.0513
Offline time = 4.2431275844573975
Online time = 0.19430041313171387
Test result: True
DDUp Drift detection: True
Detection latency: 5.2229s

DRIFT-DETECTED after 4-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=forest', '--end2end', '--model=transformer', '--model_update=update', '--update_size=25000', '--epochs=40']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
update_size: 25000
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (631012, 10)
Parsing... done, took 0.1s
done, took 0.1s
dataset size: 631012
train data shape: torch.Size([25000, 10]), transfer data shape:torch.Size([5000, 10])
Epoch 0 Iter 0, train entropy gap 18.5046 bits (loss 37.687, data 19.183) 0.00300 lr
epoch 9 train loss 21.9447 nats / 31.6595 bits
time since start: 5.8 secs
Epoch 10 Iter 0, train entropy gap 12.3475 bits (loss 31.530, data 19.183) 0.00245 lr
epoch 19 train loss 20.6176 nats / 29.7450 bits
time since start: 12.0 secs
Epoch 20 Iter 0, train entropy gap 10.4886 bits (loss 29.671, data 19.183) 0.00200 lr
epoch 29 train loss 19.7612 nats / 28.5093 bits
time since start: 18.3 secs
Epoch 30 Iter 0, train entropy gap 9.2378 bits (loss 28.420, data 19.183) 0.00164 lr
epoch 39 train loss 19.2057 nats / 27.7080 bits
time since start: 24.6 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 42.0399 nats / 60.6508 bits
Saved to: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
UpdateTask - END

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 4/15 | Workload-time: 7.564234 | Model-update-time: 27.542570


WORKLOAD-START | Type: QueryWorkload | Progress: 5/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=forest', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=update', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
data size: 631012, total size: 631012, split index: [525843 631012]
Parsing... done, took 0.1s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
query_seed:0
origin-forest_39.80 	max: 60.8571	99th: 9.0038	95th: 4.0000	median: 1.0502	mean: 1.7247
ReportEsts: [1.0, 1.078985962706893, 1.0, 1.9666666666666666, 1.5, 1.0, 1.0585585585585586, 1.0, 2.089005235602094, 1.0, 1.2545454545454546, 1.0136054421768708, 1.0, 2.0, 1.5952380952380953, 1.032967032967033, 2.0, 2.0, 1.2954545454545454, 2.176470588235294, 1.0, 3.0, 6.666666666666667, 1.6, 1.6666666666666667, 1.0, 1.0466838070751798, 1.1538461538461537, 3.0, 9.378378378378379, 1.0, 1.1666666666666667, 1.0, 1.0, 2.0, 2.0, 1.0, 1.0, 1.0714285714285714, 2.0, 1.0, 1.0441988950276244, 1.6666666666666667, 1.0608481930635487, 1.0, 1.2839506172839505, 1.0, 4.0, 2.6578947368421053, 1.0, 3.0, 1.0304299125240026, 1.0, 1.0, 6.0, 1.2043010752688172, 1.4122516556291391, 1.425, 1.0, 2.0, 1.103812928209711, 3.0, 1.0, 1.0343007915567282, 1.0285714285714285, 1.0, 1.1640091116173121, 1.8363636363636364, 1.169811320754717, 1.0, 2.0, 1.0, 1.3650793650793651, 1.0914468580294803, 1.0, 1.5, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0104183506673132, 7.0, 1.8076923076923077, 1.0, 1.0, 1.6666666666666667, 1.9000227479526843, 1.0, 2.0, 3.0, 1.1674261757200146, 2.0, 1.6727272727272726, 1.3, 1.0, 1.0, 2.0, 1.0710479573712255, 7.0, 1.125917900565788, 1.0, 1.1646341463414633, 1.0, 1.0, 1.0294995610184372, 1.028864959894517, 1.0, 3.0, 1.227891156462585, 1.0, 1.7873563218390804, 1.0, 1.0, 1.063578117299162, 1.8846153846153846, 2.0, 1.0, 2.0, 1.0, 1.0, 1.0, 2.0, 3.0, 1.0, 1.0826589595375722, 1.8888888888888888, 1.0, 1.375, 1.0, 1.0, 1.0, 1.2081727062451812, 1.0467862197156919, 1.0, 1.3, 1.0, 1.0, 2.0, 1.0685232685965556, 1.6578947368421053, 1.0757749712973594, 1.0, 1.0, 5.0, 1.0, 1.1624986739473935, 1.0, 1.25, 6.857142857142857, 1.0833333333333333, 1.037037037037037, 1.0, 1.0, 1.0, 1.0, 4.0, 1.0, 1.0, 1.0, 1.0, 1.2, 1.0, 1.1538461538461537, 8.0, 1.208027905565947, 1.0, 4.0, 2.0, 1.4338747099767981, 1.0, 1.0, 4.5, 1.0, 1.5128800625636893, 1.05788876276958, 1.0, 2.2260273972602738, 3.0, 1.0, 2.0, 3.0, 6.294117647058823, 1.0, 1.0, 1.0206309083736358, 4.0, 1.02360346184107, 1.0, 1.0, 3.909090909090909, 1.3527508931471257, 1.0, 1.4424242424242424, 2.5555555555555554, 1.0, 1.0, 1.0, 1.0, 1.2560975609756098, 1.3333333333333333, 1.1837861397646374, 1.018628030751035, 4.0, 1.0, 1.0, 1.0, 1.0, 3.2045454545454546, 1.0, 1.0, 1.0, 3.0, 1.6756756756756757, 1.0, 1.0, 1.0, 1.0, 1.0, 1.204460966542751, 1.0, 1.0, 1.0, 1.0257906048510899, 3.0, 1.0, 3.2857142857142856, 1.0, 1.6058823529411765, 3.0, 1.1670715044785183, 1.1748239436619718, 1.4842767295597483, 1.0, 5.5, 2.0, 9.0, 1.0, 1.0, 1.5, 1.1374446902654867, 1.1235059760956174, 1.0, 1.3333333333333333, 2.0, 1.0, 2.0, 1.625, 1.0, 1.103932584269663, 3.130434782608696, 3.3333333333333335, 2.0, 1.6666666666666667, 1.0050761421319796, 1.0, 3.7777777777777777, 1.1155584247901873, 1.4285714285714286, 5.0, 1.0568421052631578, 1.1711899791231732, 4.0, 1.0, 1.0811136028004158, 5.0, 2.25, 1.0, 1.6, 1.0, 1.0, 1.0, 1.6666666666666667, 1.0, 2.4595588235294117, 3.0, 1.0, 1.1079331941544885, 1.0, 1.38, 1.4066901408450705, 1.0, 1.0, 1.6, 1.324766355140187, 1.3266666666666667, 1.0157094986894928, 1.5, 1.0, 1.0, 3.75, 1.8294736842105264, 1.0, 2.094488188976378, 1.0, 1.41875, 1.0, 1.0, 4.571428571428571, 1.5, 1.0, 1.0, 1.0909090909090908, 1.0, 1.3333333333333333, 1.0, 1.0, 2.4, 1.0, 1.5, 1.0, 1.0, 1.2, 1.0, 1.0, 1.5, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 3.3333333333333335, 1.0, 1.0, 1.0436514522821576, 2.5, 1.0, 1.0125939019001327, 1.0, 1.0, 1.0, 1.0, 1.9258202567760343, 1.0, 3.0, 1.0, 1.5, 1.34375, 1.5294117647058822, 1.0851063829787233, 1.679245283018868, 1.0, 1.5247292947029558, 2.22, 1.0, 1.048780487804878, 1.4, 2.0, 10.0, 3.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.3412698412698412, 11.0, 1.9285714285714286, 6.0, 1.0, 1.0, 2.0, 1.5333333333333334, 1.0, 2.2448979591836733, 1.0619593643130154, 1.1914111616210465, 1.4223826714801444, 1.0010771348213752, 1.595890410958904, 1.0, 60.857142857142854, 2.0, 2.518181818181818, 1.0056633240177544, 1.0, 1.0666899480674559, 1.0059552042160738, 1.0158387622149838, 1.0, 2.5, 1.0, 1.288888888888889, 3.0, 2.0, 2.0, 1.5422794117647058, 3.0, 1.0, 2.0, 1.0, 1.0, 1.5, 2.0, 1.0, 1.0, 17.0, 1.0, 1.2010398613518198, 1.0, 1.0, 1.0, 1.0, 1.0207025492657895, 1.0, 2.0, 1.651006711409396, 3.645200167679732, 1.3235653235653235, 1.1161137440758293, 1.131687242798354, 1.0717616920651603, 1.5487465181058495, 4.375, 1.0, 1.0, 1.0167836370270211, 1.0285899935022742, 1.0, 11.0, 3.0, 2.0, 1.0, 1.2941176470588236, 1.036710239651416, 1.0, 3.253225806451613, 25.333333333333332, 1.0, 1.0, 1.1923076923076923, 1.4583333333333333, 1.0, 1.0, 1.1857031857031857, 1.0395613365280814, 1.25, 1.0142247510668563, 1.5555555555555556, 1.0, 1.0, 1.0, 1.0944622200344574, 3.0, 1.0, 1.3495145631067962, 1.0, 2.0833333333333335, 1.0, 1.0, 1.0, 1.0442979638577772, 1.0, 1.0, 1.0, 1.4666666666666666, 1.2254901960784315, 1.2352941176470589, 1.0, 1.1109792284866469, 3.0, 1.0, 1.0928872083898125, 1.0, 1.0, 1.4241316270566728, 4.0, 1.5277777777777777, 1.0, 1.2039124668435013, 1.0, 1.0, 1.0, 4.0, 1.0458041715750814, 1.088115763546798, 2.0994152046783627, 1.2647058823529411, 1.0, 1.0, 1.0, 1.0, 1.1406832611105513, 1.1153846153846154, 1.5, 2.0, 1.1808278867102397, 1.0556962025316456, 1.0, 1.1862352401218341, 1.0, 2.0, 1.0420740045308896, 1.6666666666666667, 1.0910428244524355, 1.0, 1.0, 1.0, 1.0897383025604166, 2.35, 2.0, 1.2, 1.0, 2.0, 3.0, 1.625, 3.0, 1.416184971098266, 1.5562349599589727, 2.0, 1.5, 1.0, 1.125948406676783, 2.0, 20.0, 1.118811881188119, 1.0, 1.0595099183197199, 1.2446808510638299, 1.2, 2.0, 1.0, 2.5, 1.0, 1.1903093987157034, 1.0, 6.0, 1.1978954514596063, 1.0, 1.0, 4.563836104513064, 1.0285891158759637, 2.2222222222222223, 1.0, 1.0, 1.0, 1.1362725450901803, 1.0, 1.0, 1.0, 1.0173824959481361, 1.4205607476635513, 3.257142857142857, 2.3333333333333335, 1.6103896103896105, 2.0, 2.1, 1.0124826629680999, 3.0, 1.0, 1.4642857142857142, 1.1551596139569413, 5.0, 2.0, 2.6666666666666665, 1.40625, 1.0, 1.0864864864864865, 1.0, 1.0, 1.0, 1.5, 1.0237832153173287, 12.0, 1.499629236518022, 4.666666666666667, 1.0, 1.5, 2.0, 1.0, 1.537037037037037, 2.125, 2.0, 1.3288659793814432, 1.0, 1.0, 1.0, 1.040767386091127, 1.1666666666666667, 2.75, 1.0, 1.2, 1.0, 1.0562073276276565, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.006060606060606, 2.1739130434782608, 2.0, 1.4579646017699115, 1.0, 1.0, 1.7142857142857142, 1.0379576412037252, 3.239130434782609, 1.0, 1.0, 1.0, 1.0, 1.0119077689171148, 1.0, 3.0, 1.0914158305462653, 1.0, 1.0, 1.0, 1.0, 1.5, 1.0, 1.0, 1.0, 1.0, 2.75, 1.293398533007335, 1.1773913043478261, 1.5, 3.0, 3.0, 1.0161238432277966, 1.0, 1.0, 1.0, 6.0, 1.0266287680454784, 1.0, 2.0, 1.4615384615384615, 1.0740740740740742, 1.0, 1.0, 1.5, 1.0, 1.0, 1.0509023189819535, 1.0, 4.0, 1.0293795220346416, 1.0, 1.0, 1.1867916303400174, 1.0, 1.0621263626772945, 1.0, 1.0, 1.8597122302158273, 1.0447713463383435, 2.2222222222222223, 3.380952380952381, 1.0, 1.0, 2.25, 1.1072988586726786, 1.0, 1.0, 1.0, 1.0, 1.6, 4.0, 1.0, 1.0, 1.391589295466958, 1.0, 1.0, 1.0, 1.0, 1.0, 1.5384615384615385, 1.1532567049808429, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 4.0, 2.5, 1.0, 1.0, 1.2094017094017093, 1.0, 8.0, 1.0, 1.0, 3.5238095238095237, 1.0, 1.0, 1.0, 1.291383812010444, 1.0285714285714285, 1.0, 1.125, 1.15, 2.0, 1.1538461538461537, 1.0, 1.0, 1.0, 1.0, 2.0, 1.1677246909455397, 1.78125, 1.0, 4.0, 1.0337837837837838, 1.0428973637061685, 1.0, 1.0, 1.1758059155865737, 1.007679180887372, 1.2567567567567568, 3.0, 1.0, 1.0, 1.5644040790312301, 1.0, 1.25, 1.0, 1.0, 1.3333333333333333, 1.0601589103291713, 3.0, 1.0, 2.0, 1.4260869565217391, 1.9178885630498534, 2.0, 2.0, 2.0, 1.0, 1.0598234717227852, 1.631578947368421, 1.0749333333333333, 1.0, 1.0, 3.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.6958333333333333, 3.5, 1.047996790488174, 1.0, 1.0, 1.6363636363636365, 1.0710259301014655, 3.0, 1.5, 1.0, 3.0, 1.0, 1.2857142857142858, 2.2898272552783108, 3.0, 1.0, 1.0, 1.0, 1.0, 3.0, 1.3221912720519964, 1.0, 1.0, 3.0, 1.0, 1.1996481970096746, 1.0088974854932302, 1.0, 1.0, 1.2012987012987013, 1.5263157894736843, 2.0, 1.1731843575418994, 3.0, 1.0, 1.0, 1.0, 1.0, 1.0666666666666667, 2.0, 1.0, 1.0807453416149069, 1.1363756613756615, 1.2, 1.0, 1.0, 1.0, 1.0, 1.8, 1.0, 1.0, 1.6463654223968567, 1.0, 1.0, 1.1290322580645162, 1.3333333333333333, 7.2, 1.0, 6.180851063829787, 1.1818181818181819, 1.0, 1.2444444444444445, 1.1470588235294117, 1.0, 1.392696797366058, 1.0, 1.351409978308026, 3.0, 1.0, 1.0, 1.0, 2.0, 1.3571428571428572, 1.0, 1.0, 1.0, 1.5, 1.1954022988505748, 1.0, 1.0, 1.179523141654979, 1.3069071373752879, 1.0, 1.0, 1.0, 1.5173433718741598, 2.0, 4.794871794871795, 1.0, 1.0272511848341233, 2.0, 1.0, 1.1333333333333333, 1.3333333333333333, 1.6666666666666667, 1.0910307898259706, 1.0, 1.5, 1.0, 2.0, 1.6666666666666667, 1.0, 1.0, 1.0, 1.3333333333333333, 5.0, 1.0, 1.0, 2.0, 1.0, 1.125, 1.0, 4.0, 1.0, 1.1025641025641026, 1.0, 1.0, 3.5294117647058822, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 7.724137931034483, 3.0, 1.4576271186440677, 1.0, 1.1230283911671923, 1.0, 1.0, 5.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.273469387755102, 1.0144065915089917, 1.0, 2.9548387096774196, 2.0, 1.7857142857142858, 3.0, 1.2596118637861589, 1.0, 4.25, 1.0137142857142858, 3.0, 1.0, 2.0, 1.0, 2.2222222222222223, 1.0, 1.0279254719230744, 1.4416350947158525, 2.0617283950617282, 1.75, 1.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 6.0, 2.0, 3.0, 1.0, 1.0, 1.0896746817538896, 1.1645299145299146, 1.0, 1.0, 1.3333333333333333, 1.0625, 1.0, 2.0, 1.4702364317254486, 2.2, 1.049429657794677, 1.0, 1.0, 1.0, 2.6666666666666665, 22.5, 1.0, 1.0041791226892807, 1.0, 1.0, 1.2312020956631415, 6.0, 2.1511627906976742, 1.2532051282051282, 1.5, 2.0, 1.9063545150501673, 1.0, 2.0, 1.0238095238095237, 1.0956333880824491, 1.0, 1.2222222222222223, 2.0, 1.0, 1.6194590533433508, 2.0, 2.0, 1.0, 1.1413427561837455, 1.0, 2.0681946802490097, 3.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.4523809523809523, 1.0, 1.175010175010175, 1.5, 1.0040035673432985, 1.0, 1.0, 1.0, 1.0, 1.0, 2.6842105263157894, 2.1176470588235294, 1.0, 1.0, 2.0, 1.1476190476190475, 1.0, 1.4285714285714286, 1.2692307692307692, 3.8372093023255816]
origin-forest_39.80 	max: 60.8571	99th: 9.0038	95th: 4.0000	median: 1.0502	mean: 1.7247

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 5/15 | Workload-time: 28.082803 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 6/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=valueskew', '--dataset=forest', '--drift_test=ddup', '--end2end', '--update_size=25000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
ValueSample - START
ValueSample - END
load_npy_dataset_from_path - df.shape = (656012, 10)
Parsing... done, took 0.1s
Data updated!
Previous data size: (631012, 10), new data size: (25000, 10)
done, took 0.1s
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
done, took 0.1s
new data average log likelihood = 43.7488
detection mean = 48.3096
detection threshold = 0.7561
test statistic = 4.5608
Offline time = 4.181089878082275
Online time = 0.19885659217834473
Test result: True
DDUp Drift detection: True
Detection latency: 5.1674s

DRIFT-DETECTED after 6-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=forest', '--end2end', '--model=transformer', '--model_update=update', '--update_size=25000', '--epochs=40']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
update_size: 25000
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (656012, 10)
Parsing... done, took 0.1s
done, took 0.1s
dataset size: 656012
train data shape: torch.Size([25000, 10]), transfer data shape:torch.Size([5000, 10])
Epoch 0 Iter 0, train entropy gap 18.4844 bits (loss 37.617, data 19.132) 0.00300 lr
epoch 9 train loss 21.8556 nats / 31.5309 bits
time since start: 5.6 secs
Epoch 10 Iter 0, train entropy gap 12.2820 bits (loss 31.414, data 19.132) 0.00245 lr
epoch 19 train loss 20.4756 nats / 29.5400 bits
time since start: 11.3 secs
Epoch 20 Iter 0, train entropy gap 10.2702 bits (loss 29.403, data 19.132) 0.00200 lr
epoch 29 train loss 19.6060 nats / 28.2855 bits
time since start: 17.0 secs
Epoch 30 Iter 0, train entropy gap 9.0988 bits (loss 28.231, data 19.132) 0.00164 lr
epoch 39 train loss 19.0542 nats / 27.4894 bits
time since start: 22.8 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 41.1270 nats / 59.3338 bits
Saved to: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
UpdateTask - END

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 6/15 | Workload-time: 7.516490 | Model-update-time: 25.725502


WORKLOAD-START | Type: QueryWorkload | Progress: 7/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=forest', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=update', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
data size: 656012, total size: 656012, split index: [546676 656012]
Parsing... done, took 0.1s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
query_seed:0
origin-forest_39.80 	max: 210.0000	99th: 13.0000	95th: 4.0006	median: 1.0636	mean: 2.2520
ReportEsts: [1.0, 1.2216838279830406, 1.0, 1.7878787878787878, 1.6, 1.0, 1.0146750524109014, 1.0, 1.5527272727272727, 1.0, 1.1857142857142857, 1.0790378006872852, 1.0, 2.5, 134.0, 1.1145833333333333, 1.0, 3.0, 14.5, 1.490566037735849, 1.0, 3.0, 20.0, 1.2, 1.6, 1.0, 1.0495056303213404, 1.2307692307692308, 3.0, 4.011560693641618, 1.0, 3.7142857142857144, 1.0, 1.0, 2.0, 2.0, 1.0, 1.0, 1.0769230769230769, 1.0, 2.0, 1.408112582781457, 5.0, 1.0344854189168338, 1.0, 1.2705882352941176, 2.0, 3.0, 13.0, 1.0, 3.0, 1.0425079150879744, 1.0, 1.0, 4.5, 1.056768558951965, 1.2904238618524333, 1.0888888888888888, 1.0, 3.0, 1.1441398108064775, 13.0, 3.0, 1.0, 1.0, 1.4210526315789473, 1.063387116341138, 1.25, 2.0, 4.0, 3.0, 2.695970695970696, 1.0131416510692526, 210.0, 1.0, 1.5359116022099448, 1.0, 1.0, 1.0, 1.0, 3.0, 1.0, 1.0, 1.043427020463555, 3.5, 3.7142857142857144, 1.0, 1.0, 1.0, 1.491651040271453, 1.0, 3.0, 4.0, 1.1272204364743699, 1.1891891891891893, 55.0, 1.2222222222222223, 1.0, 1.0, 1.6666666666666667, 1.8333333333333333, 1.0, 1.1085432098765433, 1.5, 3.0, 1.0, 1.0, 1.0, 1.0445947638732307, 2.0, 1.0, 1.077922077922078, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.046242774566474, 1.0, 1.0, 2.0, 3.0, 1.0, 1.2373386295928501, 1.9090909090909092, 1.0, 4.0, 1.0, 1.0, 1.0, 1.1047558521343077, 1.023972669215987, 1.0, 1.1818181818181819, 1.0, 1.0, 2.0, 1.0894224077940153, 1.4, 1.007007786429366, 1.0, 1.0, 1.25, 1.0, 1.145869399991555, 1.0, 1.0344827586206897, 3.4285714285714284, 1.3846153846153846, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 1.0, 2.375, 1.0, 1.1119029567854435, 3.3333333333333335, 1.016844262295082, 1.0, 2.0, 1.0, 1.292887029288703, 1.0, 1.0, 3.6823529411764704, 1.0, 1.4646003487198311, 1.0436665463731505, 1.0, 1.015678756476684, 2.5107913669064748, 1.5525866969869244, 1.0, 3.0, 1.0, 1.0, 1.0, 3.0, 1.0, 1.1408325952170062, 1.0, 1.0, 1.2666666666666666, 1.4244401581373716, 1.0, 1.344632768361582, 2.5555555555555554, 1.0, 1.0, 1.0, 1.0, 1.4069767441860466, 1.6, 1.112583650439575, 1.0637414764304773, 2.0, 1.0, 1.0, 1.5, 3.0, 3.0, 1.0, 1.0, 1.0, 4.0, 1.2075471698113207, 1.0, 1.0, 1.0, 1.0, 4.0, 4.066666666666666, 1.0, 2.0, 8.5, 1.0, 1.0, 1.182961763606925, 1.2308967804338815, 1.4285714285714286, 1.0, 1.0415329922830139, 1.0, 1.518987341772152, 2.0357142857142856, 4.5, 1.3269230769230769, 1.5174825174825175, 1.0, 2.75, 3.0, 2.0, 1.0425328554360813, 1.5, 4.0, 1.0, 1.0, 2.0, 1.3333333333333333, 1.0, 1.2963549920760697, 2.896551724137931, 1.4444444444444444, 3.0, 3.0, 1.3532338308457712, 1.0, 4.415584415584416, 1.2973116848549375, 1.1666666666666667, 2.0, 1.166990291262136, 1.1832358674463939, 2.0, 1.0, 1.0635331916878272, 3.0, 1.2, 1.0, 2.0, 1.0, 1.0, 1.0, 1.1951219512195121, 1.0, 1.7180277349768875, 1.0555555555555556, 1.0, 1.0436677086293455, 1.0, 1.0, 1.5191956124314443, 1.0, 1.0, 2.25, 1.3723076923076922, 1.2576687116564418, 1.003740338793, 3.0, 1.7777777777777777, 1.0, 1.875, 1.310708898944193, 1.0, 8.06060606060606, 4.0, 1.0986842105263157, 1.0, 1.0, 3.5555555555555554, 3.0, 1.0, 1.0, 1.091549295774648, 1.0, 1.3333333333333333, 1.0, 1.0, 2.6666666666666665, 1.0, 1.5, 1.0, 1.0, 2.032258064516129, 1.0, 1.0, 2.5833333333333335, 1.5, 1.0, 1.0, 2.0, 1.0, 1.0, 1.9090909090909092, 1.0, 1.0, 1.017078724788549, 2.5, 1.0, 1.0636816483640892, 3.0, 1.0, 1.0, 1.0, 1.0714285714285714, 2.0, 3.0, 1.9166666666666667, 1.0, 2.216494845360825, 3.3333333333333335, 1.2989690721649485, 1.037837837837838, 1.0, 1.5062156692685746, 3.3636363636363638, 1.0, 1.5, 2.5, 1.6, 10.0, 4.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.2596153846153846, 5.5, 3.0, 6.0, 1.0, 4.0, 2.2, 2.568527918781726, 1.0239467011530161, 1.6666666666666667, 1.029626610065457, 1.2394366197183098, 1.1108493834003048, 1.625, 1.0, 1.0, 1.3107692307692307, 1.0, 3.120879120879121, 1.0542377440896287, 1.0, 1.0920706134789817, 1.0893112160826102, 1.0196441225100386, 1.0, 2.5, 1.0, 1.1111111111111112, 4.0, 2.0, 2.0, 1.4172297297297298, 4.0, 1.0, 2.0, 1.0, 1.135135135135135, 1.1666666666666667, 2.25, 1.0, 1.0, 17.0, 1.0, 1.210217755443886, 1.0, 1.0, 1.0, 1.0, 1.0244150156963094, 1.0, 5.0, 1.3186528497409327, 3.1359772310227316, 1.2278338945005611, 1.3701594533029613, 1.210909090909091, 1.0552163613919194, 1.4918478260869565, 2.263888888888889, 1.0, 1.0, 1.002608749663554, 1.087679915489238, 1.0, 1.5714285714285714, 2.0, 2.0, 1.0, 2.0, 1.0635823642600184, 1.0, 2.2842582106455267, 76.0, 1.0, 1.0, 1.0842105263157895, 2.769230769230769, 1.0, 1.0, 1.020356234096692, 1.0785812144140974, 1.6666666666666667, 1.1028744326777609, 4.666666666666667, 1.0, 1.0, 1.0, 1.1324376199616122, 1.5, 1.0, 2.4138929088277856, 1.0, 1.8214285714285714, 1.0, 1.0, 1.0, 1.0155948217361799, 1.0, 1.0, 2.0, 4.6, 1.1941747572815533, 1.5517241379310345, 1.0, 1.1185185185185185, 4.0, 1.0, 1.0003452117560294, 1.0, 1.0, 1.6128364389233953, 6.0, 1.896551724137931, 1.0, 1.0896211397644062, 1.0, 1.0, 1.0, 1.0, 1.0671646859083193, 1.1117235842406203, 1.3136531365313653, 6.285714285714286, 1.0, 1.0, 2.5, 1.0, 1.0368654311039485, 1.28, 3.0, 2.0, 1.9280442804428044, 1.1867881548974943, 1.0, 1.1634447088438318, 1.9090909090909092, 1.5, 1.0015153654289615, 5.0, 1.0757949984563138, 1.0, 1.0, 1.0, 1.0596785148290695, 1.1363636363636365, 3.0, 1.08, 1.0, 1.6666666666666667, 5.0, 1.0196078431372548, 1.3333333333333333, 1.0756756756756756, 1.524645630030629, 2.0, 2.0, 1.0, 1.016883116883117, 2.0, 10.0, 1.1568627450980393, 1.0, 1.0259552042160738, 2.3836734693877553, 1.16, 1.0, 1.0, 3.0, 1.0, 1.219740777666999, 1.0, 7.0, 4.0, 1.0434782608695652, 1.25, 1.0, 2.0, 1.5, 2.3333333333333335, 1.0, 1.0325615050651231, 2.0, 1.0, 1.1699029126213591, 2.0, 1.0035605500245792, 1.0, 1.0, 1.0055511498810468, 1.0, 1.0, 1.1785714285714286, 5.0, 3.0, 1.0, 1.0049786628733997, 5.0, 2.0, 2.6666666666666665, 1.0921985815602837, 1.0, 1.2093023255813953, 1.0, 1.0215541690300625, 1.0, 1.7142857142857142, 1.029373147471126, 1.6666666666666667, 1.0829915811925055, 2.314741035856574, 1.0, 3.0, 1.5, 1.0, 1.8518518518518519, 4.25, 3.0, 1.3039959534648458, 1.0, 1.0, 1.0, 1.0136363636363637, 1.6666666666666667, 4.066666666666666, 1.1071849234393405, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 4.119047619047619, 2.380952380952381, 2.0, 1.0495626822157433, 1.0, 1.0, 1.4, 1.0301802383103196, 3.129032258064516, 1.0, 1.0, 1.0, 1.0, 1.0268987906246656, 1.0, 4.0, 1.1607329842931937, 1.0, 1.0, 1.0, 3.0, 1.5, 1.0, 1.0, 1.0, 1.0, 2.75, 1.0408653846153846, 1.1255876427132303, 1.0, 4.0, 4.0, 1.0214664957890882, 1.0, 1.0, 1.0, 1.0238095238095237, 1.0358294310223364, 1.0, 1.0, 1.6153846153846154, 1.1595547309833023, 1.0, 1.0, 2.0, 1.0, 1.0, 1.1007795623180239, 1.0, 5.0, 1.151920272241128, 1.0, 1.0, 1.0637894736842106, 1.0, 1.1465068957721003, 1.0, 1.0, 1.894736842105263, 1.441988950276243, 1.0, 1.0, 1.0, 1.3333333333333333, 1.0, 1.0154567106037085, 1.1320236395510654, 1.0, 4.0, 4.0, 1.0, 1.75, 1.6666666666666667, 1.0, 1.0, 1.003902541925957, 1.0, 1.0, 1.1066481994459834, 3.0277777777777777, 1.4942528735632183, 4.0, 1.1743515850144093, 1.0, 1.74, 1.3333333333333333, 1.0930232558139534, 4.0, 3.0, 1.0, 1.0, 1.0, 1.139240506329114, 1.0, 3.1038062283737022, 1.0, 10.0, 3.3333333333333335, 1.0, 1.1493775933609958, 1.0, 5.833333333333333, 1.0, 1.0, 3.8, 1.0, 1.0, 1.0, 1.373888888888889, 1.3012048192771084, 1.0, 1.1111111111111112, 1.0869565217391304, 1.0, 1.15625, 1.0, 6.0, 1.0, 1.0, 3.0, 1.0781350482315113, 1.0892857142857142, 1.0, 4.0, 1.2129032258064516, 1.002954064300133, 1.0, 1.0, 1.1311980289497998, 1.0904154222101548, 1.6129032258064515, 2.4444444444444446, 4.0, 1.0, 2.3807106598984773, 1.316831683168317, 3.235415816772539, 1.0, 1.0, 3.0, 1.3707360861759426, 1.0, 1.4814814814814814, 1.0, 1.0, 1.2692307692307692, 4.0, 2.0, 2.0, 1.0, 1.0401862801527917, 2.288135593220339, 1.0123218168639767, 1.0, 1.0, 3.0, 1.0, 1.0, 1.0, 1.0, 1.0, 4.0, 1.0, 2.0, 1.5, 1.1096938775510203, 2.0, 1.0341956316667875, 1.0, 1.0, 1.2222222222222223, 1.060483870967742, 1.5, 2.0, 1.0, 4.0, 1.0, 2.0, 1.2267628205128205, 3.0, 1.0, 1.0, 1.0, 1.0, 4.0, 2.473684210526316, 1.0, 1.0, 4.0, 1.0, 1.1394557823129252, 1.0881913303437967, 1.0, 1.0, 2.7681159420289854, 2.5833333333333335, 2.0, 1.3279569892473118, 5.0, 1.0, 1.0, 1.0, 1.0, 2.0, 2.0, 1.0, 1.1737704918032787, 1.0406622516556292, 1.0909090909090908, 1.0, 1.0591397849462365, 1.0, 1.7411764705882353, 1.0, 6.0, 1.0, 1.0031115692032437, 3.6, 1.0, 1.0, 1.0118222584590297, 1.0980392156862746, 1.0, 3.0, 1.0, 1.1285615010423906, 1.0, 1.0703171753441054, 2.6818181818181817, 1.1336820691659402, 1.1612903225806452, 1.3151498021481063, 1.0, 1.267056530214425, 3.0, 1.0, 1.0, 1.0, 1.5, 1.3571428571428572, 4.0, 4.0, 1.0, 4.0, 1.0, 1.0, 1.0, 2.7023809523809526, 1.5, 1.0, 5.0, 1.1644562334217508, 1.64, 1.0, 1.0, 1.1420704845814977, 5.0, 1.0543782487005198, 2.0, 1.0, 1.0, 1.0782312925170068, 1.25, 3.6, 1.0, 45.0, 1.0, 1.5, 1.25, 1.0, 1.0, 1.0, 2.0, 5.0, 1.0, 1.0, 3.0, 1.0, 2.375, 1.0, 4.0, 1.0, 1.030723488602577, 1.0, 1.0, 2.142857142857143, 1.0, 1.0, 1.8666666666666667, 1.0, 1.0, 1.0, 1.0, 2.5301204819277108, 3.0, 1.6226415094339623, 1.0, 1.1101190476190477, 1.0, 1.0, 5.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.2430278884462151, 1.0095254050690472, 1.0, 1.45565749235474, 2.0, 1.72, 4.0, 1.3104761904761906, 1.0, 3.3636363636363638, 1.2598992080633549, 5.0, 1.0, 3.0, 1.0, 1.8333333333333333, 1.0, 1.012085004059322, 1.511498578357585, 2.7777777777777777, 1.0, 1.0, 1.25, 1.0, 1.0, 1.0, 6.0, 1.0, 6.0, 2.0, 4.0, 1.0, 1.0, 1.0900788189665958, 1.050709939148073, 1.0, 1.0, 1.4666666666666666, 1.075425790754258, 1.0, 2.0, 1.4516556291390728, 1.5, 1.7210144927536233, 1.0, 1.0, 1.0, 2.25, 45.0, 1.0, 1.0497360053674047, 1.0, 1.0, 1.125249763382059, 4.5, 1.2893258426966292, 1.3769470404984423, 1.0, 2.0, 1.2629870129870129, 1.0, 2.0, 1.3035307517084282, 1.0, 1.0, 1.117117117117117, 1.0, 2.0, 1.0074946466809422, 1.0, 1.0, 1.0, 1.1666666666666667, 1.0135135135135136, 1.0, 1.4272924579489963, 1.3333333333333333, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.8857142857142857, 1.0, 1.226623111474071, 1.5, 1.0118394885043585, 1.0, 1.0, 1.0, 1.0, 1.0, 1.896551724137931, 1.1111111111111112, 1.0, 1.0, 2.0, 1.309782608695652]
origin-forest_39.80 	max: 210.0000	99th: 13.0000	95th: 4.0006	median: 1.0636	mean: 2.2520

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 7/15 | Workload-time: 28.180729 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 8/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=valueskew', '--dataset=forest', '--drift_test=ddup', '--end2end', '--update_size=25000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
ValueSample - START
ValueSample - END
load_npy_dataset_from_path - df.shape = (681012, 10)
Parsing... done, took 0.1s
Data updated!
Previous data size: (656012, 10), new data size: (25000, 10)
done, took 0.1s
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
done, took 0.1s
new data average log likelihood = 43.0963
detection mean = 48.7433
detection threshold = 0.7621
test statistic = 5.6469
Offline time = 4.170432090759277
Online time = 0.21926331520080566
Test result: True
DDUp Drift detection: True
Detection latency: 5.1711s

DRIFT-DETECTED after 8-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=forest', '--end2end', '--model=transformer', '--model_update=update', '--update_size=25000', '--epochs=40']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
update_size: 25000
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (681012, 10)
Parsing... done, took 0.1s
done, took 0.1s
dataset size: 681012
train data shape: torch.Size([25000, 10]), transfer data shape:torch.Size([5000, 10])
Epoch 0 Iter 0, train entropy gap 18.7748 bits (loss 37.843, data 19.068) 0.00300 lr
epoch 9 train loss 21.8335 nats / 31.4991 bits
time since start: 5.6 secs
Epoch 10 Iter 0, train entropy gap 12.2052 bits (loss 31.274, data 19.068) 0.00245 lr
epoch 19 train loss 20.4315 nats / 29.4764 bits
time since start: 11.3 secs
Epoch 20 Iter 0, train entropy gap 10.3315 bits (loss 29.400, data 19.068) 0.00200 lr
epoch 29 train loss 19.5503 nats / 28.2052 bits
time since start: 16.8 secs
Epoch 30 Iter 0, train entropy gap 9.0791 bits (loss 28.148, data 19.068) 0.00164 lr
epoch 39 train loss 18.9866 nats / 27.3919 bits
time since start: 22.4 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 40.4651 nats / 58.3789 bits
Saved to: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
UpdateTask - END

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 8/15 | Workload-time: 7.533017 | Model-update-time: 25.362668


WORKLOAD-START | Type: QueryWorkload | Progress: 9/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=forest', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=update', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
data size: 681012, total size: 681012, split index: [567510 681012]
Parsing... done, took 0.1s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
query_seed:0
origin-forest_39.80 	max: 109.0000	99th: 8.0100	95th: 5.0000	median: 1.0513	mean: 1.9010
ReportEsts: [1.0, 1.246444574323008, 1.0, 2.95, 2.0, 1.0, 1.0345528455284554, 1.0, 3.04, 1.0, 1.1408450704225352, 1.003058103975535, 1.0, 3.0, 1.5227272727272727, 1.163265306122449, 1.0, 4.0, 3.6875, 1.2923076923076924, 1.0, 7.0, 1.0, 1.0, 1.0351648351648353, 1.0, 5.0, 5.0, 1.0, 3.0851063829787235, 1.0, 1.0, 1.0, 1.0, 2.0, 2.0, 1.0, 1.7121212121212122, 1.0, 5.0, 2.0, 1.0, 1.1764705882352942, 1.0, 1.4007782101167314, 1.110655737704918, 1.0, 2.0, 1.0, 1.0, 3.0, 1.0179351406749468, 1.0, 1.0, 9.0, 1.047008547008547, 2.0476900149031296, 2.588235294117647, 1.0, 4.0, 1.0104333868378812, 1.7142857142857142, 4.0, 1.0, 1.0, 1.2359550561797752, 1.0146148859685309, 1.3, 2.0, 5.0, 4.0, 1.5204081632653061, 1.0036446644031383, 1.3125, 1.0, 1.7875, 1.0, 1.0, 1.0, 1.0, 4.0, 1.0, 2.0, 1.0676644070780879, 7.0, 1.4615384615384615, 1.0, 1.0, 2.0, 1.6300741608118656, 1.0, 2.0, 5.0, 1.115328820116054, 1.8636363636363635, 27.5, 1.0357142857142858, 1.0, 1.0, 1.0, 1.5555555555555556, 1.0, 1.1329331046312179, 1.6666666666666667, 1.0, 1.0, 1.0, 1.0, 1.1237532175032174, 1.5, 1.0, 1.0823529411764705, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0721804511278195, 1.0, 1.0, 2.0, 3.0, 1.0, 1.4614670380687094, 1.8461538461538463, 1.0, 5.0, 1.0, 1.0, 1.0, 1.2931239276758613, 1.0268350737100738, 1.0, 2.25, 1.0, 1.0, 2.0, 1.0653183023872679, 1.4651162790697674, 1.0400583068861171, 1.0, 1.0, 2.5, 1.0, 1.1776007286594368, 1.0, 1.1666666666666667, 2.4, 1.1538461538461537, 1.6206896551724137, 1.0, 1.0, 1.0, 1.0, 4.0, 1.0, 1.0, 1.0, 1.5, 1.6666666666666667, 7.0, 1.1236863643804222, 1.7142857142857142, 1.0361291325123345, 1.0, 1.3333333333333333, 1.0, 1.1573033707865168, 1.0, 1.0, 3.0090909090909093, 1.0, 1.2812901412973667, 1.3091787439613527, 1.0, 1.0169255495437939, 2.2568306010928962, 1.1052205584783488, 1.0, 1.0, 1.0, 1.0, 1.0, 3.0, 1.0, 1.0009950248756219, 1.0, 1.0, 1.4210526315789473, 1.4289948948784104, 1.0, 1.3222222222222222, 1.0296580248158984, 2.0, 1.637037037037037, 1.2779503105590062, 1.2076049303149923, 1.0, 1.0, 4.0, 1.0, 3.0, 1.0, 1.0, 1.0, 1.0, 1.6493313521545319, 7.0, 2.2857142857142856, 1.3478260869565217, 1.0, 5.0, 1.2592592592592593, 1.0, 1.0, 1.0, 1.0, 5.0, 2.8780487804878048, 1.0, 1.2222222222222223, 3.6, 1.0, 1.0, 1.1225111743193823, 1.1321240348081874, 1.24, 1.0, 1.0492975519475056, 1.0, 5.0, 1.0, 1.0, 1.2222222222222223, 5.0, 2.0, 1.0, 1.0, 2.5, 1.0558170813718897, 1.2546125461254614, 1.0, 2.0, 1.75, 1.0, 2.0, 5.0, 1.0, 1.106631989596879, 1.1290322580645162, 2.4285714285714284, 4.0, 2.6666666666666665, 1.0512820512820513, 1.0, 2.328767123287671, 1.4314606741573033, 1.0769230769230769, 1.0, 1.066287878787879, 1.379120879120879, 4.0, 1.0, 1.0274603846334698, 7.0, 2.25, 1.0, 2.0, 1.0, 1.0, 1.0, 1.135135135135135, 1.5, 1.4042821158690175, 1.5909090909090908, 1.0, 1.1622641509433962, 1.0, 1.58, 1.5464285714285715, 1.0, 1.0, 2.0, 2.0762331838565022, 1.4452054794520548, 1.0067031032600757, 1.5, 5.666666666666667, 1.0, 1.1538461538461537, 1.6458333333333333, 1.0, 6.186046511627907, 5.0, 1.3384615384615384, 1.0, 1.0, 2.6666666666666665, 1.3333333333333333, 1.0, 1.0, 1.783132530120482, 1.0, 1.6666666666666667, 1.0, 1.0, 2.6666666666666665, 1.0, 1.0, 1.0, 1.0, 1.6923076923076923, 2.0, 1.0, 2.4, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 4.4, 1.0, 1.0, 1.0235387045813586, 2.5, 1.0, 1.0902834839769926, 3.0, 1.0, 1.0, 1.0, 1.5715948777648427, 2.0, 3.0, 1.9230769230769231, 1.0, 1.8859649122807018, 1.9473684210526316, 1.17, 1.8229166666666667, 1.0, 1.2110646211064622, 1.7076923076923076, 1.0, 1.0754716981132075, 6.5, 1.6, 10.0, 5.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0793650793650793, 11.0, 1.3728813559322033, 2.0, 1.0, 6.0, 1.1623376623376624, 2.2895927601809953, 1.0405964506983094, 3.0, 1.0117896541611207, 3.423076923076923, 1.0189812590100913, 2.1666666666666665, 1.4605678233438486, 5.0, 1.9741784037558685, 1.0, 2.255813953488372, 1.0075446185050592, 1.0, 1.0294357111542556, 1.0239191577270577, 1.0192095972058768, 1.0, 2.5, 1.0, 1.5606060606060606, 5.0, 2.0, 2.0, 1.7663157894736843, 5.0, 1.25, 1.0, 1.0, 1.037037037037037, 1.0, 1.5, 1.0, 1.0, 17.0, 1.0, 1.0827933765298776, 1.0, 1.0, 1.0, 1.0, 1.0606092533814484, 1.0, 1.2, 1.1628664495114007, 1.0, 1.5, 1.0, 1.0, 1.0261534267609473, 2.5, 4.866666666666666, 1.0, 1.0, 1.0117935920141685, 1.0699306524500718, 1.0, 1.4545454545454546, 2.5, 2.0, 1.0, 1.4102564102564104, 1.037035095536393, 1.0, 1.7944839857651245, 4.75, 1.0, 1.0, 1.0, 1.608695652173913, 9.0, 1.0, 1.1954236239950526, 1.1160014426544842, 1.6666666666666667, 1.098981077147016, 2.3333333333333335, 1.0, 1.0, 1.0, 1.1408548153107911, 2.0, 1.0, 1.9646643109540636, 4.0, 1.0, 1.146341463414634, 1.0, 1.0, 1.4201680672268908, 1.3333333333333333, 1.3888888888888888, 3.3552631578947367, 1.10530679933665, 1.0, 4.0, 2.0, 1.0, 1.0, 1.1006793402809913, 1.0, 1.0, 1.1308962264150944, 1.3407079646017699, 1.0, 1.0, 1.0, 1.0, 1.1560283687943262, 8.0, 1.676383399209486, 1.0339544488743524, 1.5, 6.0, 1.0608537693006357, 1.0, 1.0, 1.0, 2.111111111111111, 1.0, 1.0, 1.0, 3.9, 1.3888888888888888, 1.0944131658726721, 1.0, 2.260869565217391, 1.0, 1.0333333333333334, 1.0, 2.0, 1.0, 1.0, 1.0, 1.123192351250109, 1.1428571428571428, 2.0, 2.8, 1.0, 2.0, 7.0, 1.6774193548387097, 2.0, 1.0659898477157361, 1.4935870376984772, 2.0, 1.0, 1.0, 1.2158092848180677, 4.0, 20.0, 1.1388888888888888, 1.0, 1.0265087073525319, 1.031372549019608, 1.36, 1.0, 5.0, 1.0, 1.0, 1.0, 5.0, 1.1092184368737474, 1.2608695652173914, 1.6666666666666667, 2.0, 1.0, 1.1042584434654918, 1.0, 4.0, 2.5, 5.0, 1.0859969558599696, 5.0, 1.0, 1.1328125, 2.0, 1.0080753342513216, 1.0, 1.0, 1.0551974214343272, 1.0, 1.0, 1.3732394366197183, 3.5, 4.0, 1.0, 1.1139931740614335, 5.0, 2.0, 4.0, 1.0272108843537415, 1.0, 1.0976744186046512, 1.0, 1.1876196553924696, 1.0, 1.5, 1.0723070398642918, 1.6666666666666667, 1.0138658605239415, 1.8306188925081432, 1.0, 3.0, 2.5, 1.0, 1.537037037037037, 1.2142857142857142, 4.0, 1.1841984382177309, 1.0, 1.0, 1.0, 1.3761194029850747, 1.0, 2.25, 1.0291449814126394, 1.0, 5.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 3.1206896551724137, 1.0148433283145366, 1.2878504672897195, 1.0, 1.0, 2.857142857142857, 1.0, 5.0, 5.0, 1.0, 1.0, 1.0, 1.0, 1.0394974874371858, 1.0, 5.0, 1.0631163708086786, 1.0, 1.0, 1.0, 1.0, 3.0, 1.0, 1.0, 1.0, 1.0, 1.5714285714285714, 1.0309278350515463, 1.1537962362102532, 2.0, 5.0, 5.0, 1.0346189238204997, 1.0, 1.0, 1.0, 6.0, 1.0103769654512629, 1.0, 1.0, 1.5384615384615385, 1.0164233576642336, 1.0, 1.0, 2.5, 1.0, 1.0, 1.0647179801338993, 1.0, 6.0, 1.0089503661513426, 1.0, 1.0, 1.1060667752442996, 1.0, 1.032099574189322, 1.0, 1.0, 1.25, 1.2720247295208655, 1.0, 1.0, 1.0, 1.3333333333333333, 1.0, 1.062580117784755, 1.0581118926664062, 1.0, 5.0, 6.28125, 1.0, 2.3333333333333335, 1.0, 1.0, 1.0, 1.0142881558707912, 1.0, 1.0, 1.3653846153846154, 109.0, 1.03125, 4.5, 1.0301783264746227, 2.0, 1.6181818181818182, 1.3333333333333333, 1.7777777777777777, 5.0, 3.0, 1.0, 1.0, 1.0, 1.2795698924731183, 1.0, 3.1780821917808217, 1.0, 13.0, 2.0, 5.0, 1.3846153846153846, 1.0, 9.5, 1.0, 1.0, 4.875, 1.0, 1.0, 1.0, 1.2961215932914045, 1.009009009009009, 1.0, 1.2222222222222223, 1.5862068965517242, 1.5, 1.2592592592592593, 1.0, 2.0, 4.0, 1.0, 4.0, 1.06751316196965, 1.7384615384615385, 1.0, 2.0, 1.0188679245283019, 1.0217154236404153, 1.0, 1.0, 1.0133823143531882, 1.0656832730308934, 1.5617283950617284, 1.8, 5.0, 1.0, 1.2270742358078603, 1.0633802816901408, 2.707700553868144, 1.0, 1.0, 6.0, 1.2625649913344887, 1.0, 1.2272727272727273, 1.0, 1.0, 1.0303030303030303, 6.0, 1.3333333333333333, 2.0, 1.0, 1.0664149043303122, 1.6939890710382515, 1.1125431530494823, 1.0, 1.0, 3.0, 4.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.5, 1.2169197396963123, 2.0, 1.0029735254861545, 1.0, 1.0, 1.7222222222222223, 1.1255243626976443, 3.0, 1.5, 1.0, 5.0, 1.0, 1.4, 1.002309468822171, 3.0, 1.0, 1.0, 1.0, 1.0, 5.0, 1.8076923076923077, 1.0, 1.0, 5.0, 1.0, 1.0542317173377156, 1.146315028901734, 1.0, 1.0, 1.284263959390863, 1.736842105263158, 2.0, 1.7232142857142858, 7.0, 1.0, 1.0, 1.0, 1.0, 1.6, 2.0, 1.0, 1.1798365122615804, 1.0857409133271203, 1.3333333333333333, 1.0, 2.202127659574468, 1.0, 1.5294117647058822, 1.0, 7.0, 1.0, 1.0505558183538315, 6.0, 1.0, 1.0, 1.0217735550277118, 1.038288920056101, 1.0, 3.0, 5.0, 1.0875912408759123, 1.0, 1.243228651129308, 1.0454545454545454, 1.1369971491922712, 1.3251533742331287, 1.447428452924098, 1.0, 1.1580502215657311, 1.3333333333333333, 1.0, 1.0, 1.0, 2.0, 1.0, 5.0, 5.0, 2.0, 5.0, 1.0, 1.0, 1.0, 2.7438825448613375, 3.0, 1.0, 6.0, 1.2522275531185745, 1.75, 1.0, 1.0, 1.623535676251331, 3.5, 1.0, 1.2666666666666666, 1.0, 1.0, 1.0, 1.0, 1.2857142857142858, 1.0, 1.3333333333333333, 1.3482704402515724, 4.0, 1.0, 2.5, 2.272727272727273, 1.0, 1.2828740844087896, 1.0, 1.0, 1.0, 6.0, 1.5584415584415585, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.1062400781536208, 2.0, 1.0, 1.0, 1.0, 1.0, 1.095774647887324, 1.0, 1.0, 5.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.1570512820512822, 1.017518831317051, 6.0, 2.7597765363128492, 2.0, 1.209090909090909, 5.0, 2.216494845360825, 1.0, 2.7142857142857144, 1.070857142857143, 7.0, 1.0, 4.0, 1.5, 2.6666666666666665, 1.0, 1.0100788464784318, 1.4070686232532794, 1.1933701657458564, 1.2, 1.0, 2.0, 1.0, 1.0, 1.0, 8.0, 1.0, 6.0, 2.0, 5.0, 1.0, 1.0, 1.0329590727997102, 1.1414728682170543, 1.0, 1.0, 2.0833333333333335, 1.080568720379147, 1.0, 2.0, 1.3347541482721876, 1.4444444444444444, 1.7037037037037037, 1.0, 1.0, 1.0, 3.3333333333333335, 2.0454545454545454, 1.0, 1.078804881470052, 1.0, 1.0, 1.0513837555215, 4.0, 1.654708520179372, 1.1545454545454545, 1.5, 2.0, 1.3974763406940063, 1.0, 2.0, 1.0351464435146442, 1.0, 1.0, 1.0966183574879227, 1.0, 2.0, 1.0092879256965945, 1.6, 1.0, 1.0, 1.3333333333333333, 1.0351351351351352, 1.0, 1.5054659031754294, 1.5, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.8205128205128205, 1.0, 1.0156402737047898, 3.0, 1.0584794797843182, 1.0, 1.0, 1.0, 1.0, 1.0, 1.5, 1.44, 1.0, 1.0, 2.0, 1.1825726141078838]
origin-forest_39.80 	max: 109.0000	99th: 8.0100	95th: 5.0000	median: 1.0513	mean: 1.9010

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 9/15 | Workload-time: 28.462008 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 10/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=valueskew', '--dataset=forest', '--drift_test=ddup', '--end2end', '--update_size=25000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
ValueSample - START
ValueSample - END
load_npy_dataset_from_path - df.shape = (706012, 10)
Parsing... done, took 0.1s
Data updated!
Previous data size: (681012, 10), new data size: (25000, 10)
done, took 0.1s
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
done, took 0.1s
new data average log likelihood = 41.9671
detection mean = 48.9292
detection threshold = 0.8255
test statistic = 6.9621
Offline time = 4.214644908905029
Online time = 0.20204758644104004
Test result: True
DDUp Drift detection: True
Detection latency: 5.2143s

DRIFT-DETECTED after 10-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=forest', '--end2end', '--model=transformer', '--model_update=update', '--update_size=25000', '--epochs=40']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
update_size: 25000
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (706012, 10)
Parsing... done, took 0.1s
done, took 0.1s
dataset size: 706012
train data shape: torch.Size([25000, 10]), transfer data shape:torch.Size([5000, 10])
Epoch 0 Iter 0, train entropy gap 18.5039 bits (loss 37.501, data 18.997) 0.00300 lr
epoch 9 train loss 21.6893 nats / 31.2910 bits
time since start: 5.6 secs
Epoch 10 Iter 0, train entropy gap 12.0726 bits (loss 31.069, data 18.997) 0.00245 lr
epoch 19 train loss 20.2349 nats / 29.1928 bits
time since start: 11.2 secs
Epoch 20 Iter 0, train entropy gap 10.1447 bits (loss 29.141, data 18.997) 0.00200 lr
epoch 29 train loss 19.3652 nats / 27.9381 bits
time since start: 16.8 secs
Epoch 30 Iter 0, train entropy gap 8.7288 bits (loss 27.725, data 18.997) 0.00164 lr
epoch 39 train loss 18.7956 nats / 27.1164 bits
time since start: 22.3 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 39.9737 nats / 57.6698 bits
Saved to: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
UpdateTask - END

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 10/15 | Workload-time: 7.583644 | Model-update-time: 25.347500


WORKLOAD-START | Type: QueryWorkload | Progress: 11/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=forest', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=update', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
data size: 706012, total size: 706012, split index: [588343 706012]
Parsing... done, took 0.1s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
query_seed:0
origin-forest_39.80 	max: 169.0000	99th: 14.0300	95th: 6.0000	median: 1.0717	mean: 2.3715
ReportEsts: [1.0, 1.0186125211505923, 1.0, 1.2040816326530612, 1.3333333333333333, 1.0, 1.967153284671533, 1.0, 2.1859504132231407, 1.0, 1.0588235294117647, 1.125, 1.0, 2.0, 1.3814432989690721, 1.05, 1.0, 5.0, 2.05, 1.1578947368421053, 1.0, 9.0, 1.0, 1.0, 1.143552311435523, 1.0, 5.0, 12.0, 1.2, 2.381818181818182, 2.0, 1.0, 1.0, 1.0, 2.0, 2.0, 1.0, 1.9146341463414633, 1.0, 2.75, 3.5, 1.0, 3.4, 1.0, 1.3686006825938566, 1.257918552036199, 1.0, 1.0, 1.0, 1.0, 3.0, 1.8074454428754814, 1.0, 1.0, 18.0, 1.1548117154811715, 2.616477272727273, 1.6842105263157894, 1.0, 5.0, 1.2686923321667196, 8.0625, 5.0, 1.0, 1.0, 1.6338028169014085, 9.0, 1.0, 1.6774193548387097, 1.0, 14.0, 1.1911764705882353, 1.1331395994521156, 1.206896551724138, 1.0, 1.129251700680272, 1.0, 1.0, 1.0, 1.0, 5.0, 1.0, 1.0, 1.071463892914997, 7.0, 5.0, 1.3111111111111111, 1.8372093023255813, 1.0, 1.0, 1.5808923964182728, 1.0, 1.0, 1.0734458239529234, 1.0, 1.339103628171686, 1.0, 6.0, 1.3703703703703705, 1.464226289517471, 5.0, 1.125, 1.0, 1.0, 1.0, 1.0769230769230769, 1.1902439024390243, 1.487111111111111, 1.0, 1.4390243902439024, 1.24, 1.0, 3.875, 2.0, 1.0, 2.0, 1.0, 1.0, 1.0, 1.1538461538461537, 1.0, 1.0, 5.8, 1.0711610486891385, 1.5833333333333333, 17.0, 2.4146341463414633, 4.0, 5.0, 1.135172143974961, 1.0, 1.0, 1.0, 1.0750502805123319, 1.0447676828578965, 2.0, 1.0769230769230769, 1.0, 1.0, 2.0, 1.2678741658722592, 1.3404255319148937, 1.0120577942552234, 2.0, 1.0, 2.5, 1.0, 1.1935075504114296, 1.0, 1.2333333333333334, 3.4285714285714284, 1.6153846153846154, 1.4285714285714286, 1.0, 1.0, 1.0, 1.0, 4.0, 1.0, 1.0, 1.0, 1.6666666666666667, 1.4, 8.0, 1.0141351675395973, 3.5, 1.0362498125656021, 1.0, 1.3333333333333333, 1.0, 1.0747826086956522, 1.0, 1.0, 2.3777777777777778, 1.0, 1.321499544588888, 1.0932848164075422, 1.0, 1.0407434132066584, 1.841409691629956, 1.1318198462101794, 1.0, 2.0, 1.0, 1.0, 1.0, 3.0, 1.0, 1.0487278999568779, 1.0, 1.0, 1.6666666666666667, 1.4830090865069645, 1.0, 2.087719298245614, 1.0670180283552773, 2.0, 1.792857142857143, 1.063076923076923, 1.0444489274426736, 1.0, 1.0, 4.0, 1.0, 4.333333333333333, 1.0, 1.0, 1.0, 5.0, 1.3157894736842106, 1.0803571428571428, 2.0, 1.2777777777777777, 1.0, 6.0, 1.2857142857142858, 1.0, 1.0, 1.0, 1.0, 6.0, 2.169811320754717, 1.0, 1.1, 3.8, 1.0, 1.0, 1.0694730644686488, 1.0146325946347152, 1.4545454545454546, 1.0, 1.0636146954877947, 1.0, 6.0, 1.0, 1.0, 2.75, 6.0, 57.0, 1.0, 1.0, 1.5, 1.16016016016016, 1.2142857142857142, 1.0, 2.0, 1.6, 1.0, 2.0, 6.0, 1.0, 1.1358974358974359, 1.9761904761904763, 1.9090909090909092, 5.0, 4.0, 2.09, 1.0, 1.0088235294117647, 1.0345832523800271, 1.9285714285714286, 1.0, 1.4962962962962962, 1.2093425605536332, 4.0, 1.0, 1.0133038714726328, 2.6666666666666665, 1.6428571428571428, 1.0, 4.0, 1.0, 1.0, 1.0, 1.4333333333333333, 1.5, 2.3026771944162503, 1.9615384615384615, 1.0, 1.1745454545454546, 1.0, 1.2173913043478262, 1.2110960757780784, 1.0, 1.0, 2.2, 1.0975056689342404, 1.0637254901960784, 1.0639365605397089, 3.0, 1.125, 7.0, 1.0, 1.6303939962476548, 1.0, 1.406015037593985, 5.0, 1.691588785046729, 1.0, 1.0, 1.4751381215469612, 1.4126163391933817, 1.0, 1.0, 1.2, 1.0041580357651887, 1.066348195329087, 169.0, 6.0, 2.1818181818181817, 1.0, 1.0, 1.0, 1.0, 1.1884057971014492, 2.0, 1.0, 1.7142857142857142, 2.5, 1.0, 1.0, 1.0, 1.0, 1.0, 2.090909090909091, 1.0, 1.0, 1.0313749615502923, 1.5, 1.0, 1.0171275381025666, 3.0, 1.0, 1.0, 1.0, 1.1111111111111112, 2.0, 3.0, 2.6, 1.0, 1.5034965034965035, 1.9, 1.1067961165048543, 1.228395061728395, 1.0, 1.199079401611047, 1.027027027027027, 1.0, 1.0545454545454545, 3.2, 1.3333333333333333, 4.9, 6.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.75, 11.0, 1.5, 8.125, 1.0, 7.0, 1.578616352201258, 1.5911949685534592, 1.025721561396043, 1.5, 1.0480879262408138, 1.0227272727272727, 1.1169167097775479, 1.1538461538461537, 1.0509554140127388, 6.0, 17.04, 1.0, 1.389261744966443, 1.0626593066349748, 1.0, 1.0150394105034277, 1.0350807208560164, 1.0333184590212703, 1.0, 1.6666666666666667, 1.0, 1.0842105263157895, 6.0, 2.0, 1.0, 1.2712121212121212, 6.0, 1.2, 2.0, 1.0, 1.0119047619047619, 3.0, 2.25, 1.0, 1.0, 3.4, 1.0, 1.2359905288082083, 1.0, 1.0, 1.0, 1.0, 1.0226943919962728, 1.0, 3.5, 1.1238875044499823, 1.0, 2.0, 1.0, 1.0, 1.010328767412633, 2.4, 2.4594594594594597, 1.0, 1.0, 1.006840844090593, 1.1733629642668544, 1.0, 1.4545454545454546, 3.0, 2.0, 1.0, 2.2448979591836733, 1.0561137733807389, 1.0, 1.8956766917293233, 3.1666666666666665, 1.0, 1.0, 1.1170731707317074, 2.235294117647059, 12.0, 1.0, 1.137101623571858, 1.063743505259156, 1.0, 1.0925666199158486, 3.5, 1.0, 1.0, 1.0, 1.1888040278192602, 1.5, 1.0, 1.6968463886063072, 5.0, 1.0, 1.0291666666666666, 1.0, 1.0, 1.7549019607843137, 1.3333333333333333, 1.08, 2.897727272727273, 1.0455235204855842, 1.0, 5.0, 2.0, 1.0, 1.0, 1.1102157314701433, 1.0, 1.0, 1.0300207039337475, 1.0982456140350878, 1.0, 1.0, 1.0, 1.0, 1.12, 10.0, 1.58000896458987, 1.0141550723302313, 1.5, 6.0, 1.0249791840133222, 1.0, 1.0, 1.0, 1.0117073170731707, 1.236842105263158, 1.0, 5.0, 1.8656294200848655, 2.0608365019011408, 1.2868632707774799, 1.0, 1.106781903166064, 2.142857142857143, 1.0, 1.0070885260238662, 5.0, 1.0829631752400057, 1.0, 1.0, 1.0, 1.171591672263264, 3.4615384615384617, 2.0, 1.1363636363636365, 1.0, 2.3333333333333335, 9.0, 3.466666666666667, 1.5, 1.066350710900474, 1.3230617784804464, 2.0, 1.5, 1.0, 1.1601941747572815, 5.0, 20.0, 1.3203125, 1.0, 1.0866943308355972, 1.311881188118812, 1.04, 1.0, 6.0, 1.0, 1.0, 1.0, 6.0, 1.2736030828516378, 23.0, 1.5, 7.0, 1.0, 1.1629185407296352, 1.0, 5.0, 1.2, 6.0, 1.1667834618079889, 6.0, 1.0, 1.348148148148148, 2.0, 1.0254121024978868, 1.0, 1.0, 1.1284977908689249, 1.0, 1.0, 1.4305555555555556, 2.25, 5.0, 1.0227272727272727, 1.4386792452830188, 3.8, 2.0, 1.6, 1.0551724137931036, 1.0, 1.48, 1.0, 1.3135245901639345, 1.0, 1.7142857142857142, 1.0158329747295634, 1.6, 1.0389225953549484, 2.160664819944598, 1.0, 3.0, 1.8823529411764706, 1.0, 1.0555555555555556, 3.4, 5.0, 1.370547581073897, 1.0, 1.0, 1.0, 1.3131868131868132, 1.1666666666666667, 2.4583333333333335, 1.1242432581177766, 1.0, 6.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.5, 1.0, 1.0, 2.0, 1.7989417989417988, 1.0004528239749713, 1.1761702127659575, 1.0, 1.0, 1.1742424242424243, 2.0, 6.0, 6.0, 1.0, 1.0, 1.0, 1.0, 1.0320459325032547, 1.0, 6.0, 1.2104526364909005, 1.0, 1.0, 1.0, 69.5, 3.0, 1.0, 1.0, 1.0, 1.0, 1.8333333333333333, 2.122448979591837, 1.038956958843858, 1.5, 6.0, 7.0, 1.0058557958218106, 1.0, 1.0, 1.0, 1.5, 1.0006927632314053, 1.0, 1.0, 1.8461538461538463, 1.1149825783972125, 1.0, 1.0, 1.5, 1.0, 1.0, 1.022668727460072, 1.0, 2.3333333333333335, 1.0829257920476292, 1.0, 1.0, 1.110782574413562, 1.0, 1.1051187335092347, 1.0, 1.0, 1.1666666666666667, 1.0718711276332094, 1.0, 1.0, 1.0, 1.1428571428571428, 1.0, 1.0475115149560013, 1.0467917139349485, 1.0, 6.0, 6.4, 1.0, 3.5, 5.0, 1.0, 1.0, 1.0412498375990646, 1.0, 1.0, 1.0535279805352797, 109.0, 1.1355932203389831, 1.0, 1.162091503267974, 1.0, 1.9759036144578312, 1.5, 1.0, 1.0, 1.0, 1.375, 1.0, 1.0, 1.0, 1.0, 1.75, 1.0, 1.0166409806735044, 1.1580882352941178, 2.8376068376068377, 1.0, 2.0, 1.5, 1.8289473684210527, 1.0, 3.0, 6.0, 1.1696658097686374, 1.061936286488648, 1.0, 1.0, 6.444444444444445, 2.0, 1.0, 2.2222222222222223, 1.0, 1.0, 1.0, 1.3602150537634408, 1.0, 5.0, 5.0, 1.1587685921826358, 1.3623188405797102, 1.0, 4.0, 1.096774193548387, 1.0012805268453306, 1.0, 1.0, 1.0428118393234673, 1.0015098137896326, 1.207142857142857, 1.2222222222222223, 6.0, 1.0, 2.021072796934866, 1.0268456375838926, 2.1429838534501484, 1.0, 1.0, 3.0, 1.1532663316582914, 1.0, 2.5, 1.0, 1.0, 2.2, 8.0, 1.0, 2.0, 1.0, 1.106256977816611, 1.3703703703703705, 1.1680083095299922, 1.0, 1.0, 3.0, 5.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.5, 1.1546391752577319, 2.0, 1.0090278004106508, 1.0, 1.0, 1.2857142857142858, 1.0179924242424243, 3.0, 1.0, 1.0, 10.0, 1.0, 1.0357142857142858, 1.1461342395921834, 3.0, 1.0, 1.0, 1.0, 1.0, 3.0, 2.6363636363636362, 1.0, 1.0, 6.0, 1.0, 1.1405877680698968, 1.1410570528526427, 1.0, 1.0, 2.241758241758242, 1.5909090909090908, 2.0, 1.0301507537688441, 9.0, 1.0, 1.0, 1.0, 1.0, 4.0, 2.0, 1.0, 1.0593220338983051, 1.0440028388928317, 1.3333333333333333, 1.0, 1.0483091787439613, 1.0, 1.5897435897435896, 2.0, 4.0, 1.0, 1.0579215701307165, 4.5, 1.0, 1.0, 1.1366723259762308, 1.2359128474830954, 2.0, 1.3333333333333333, 6.0, 1.2003117692907248, 1.0, 1.095519791213571, 5.5, 1.086482558139535, 2.577777777777778, 1.265319071791153, 1.0, 1.408817635270541, 3.0, 1.0, 1.0, 1.0, 2.0, 1.3571428571428572, 6.0, 5.0, 1.0, 6.0, 1.0, 1.0, 1.0, 2.1430555555555557, 1.5, 1.0, 7.0, 1.2341772151898733, 1.178082191780822, 1.0, 3.0, 1.2701446280991735, 2.0, 1.0, 1.1333333333333333, 1.0, 1.0, 1.0, 2.0, 1.8, 1.0, 1.2142857142857142, 1.0781487101669196, 5.0, 1.0, 10.0, 1.3211382113821137, 1.0, 1.241495453014483, 1.0, 1.0, 1.0, 8.0, 1.5286624203821657, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.144929791123731, 2.0, 1.0, 1.0, 1.0, 1.0, 1.1573333333333333, 1.0, 1.0, 5.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.1386861313868613, 1.0312623795061402, 7.0, 1.2112910500655083, 2.6666666666666665, 1.0, 6.0, 1.4098360655737705, 1.0, 2.5294117647058822, 1.0869565217391304, 9.0, 1.0, 4.333333333333333, 1.5714285714285714, 1.2, 6.0, 1.4687141997242772, 3.0, 1.0, 1.0, 1.0, 1.0, 6.0, 1.0, 1.0, 10.0, 1.0, 6.0, 1.0, 6.0, 1.0, 1.0, 1.1135090993933738, 1.3345724907063197, 1.0, 1.0, 1.6470588235294117, 1.0532407407407407, 1.0, 2.0, 1.3471269077127932, 2.5454545454545454, 3.101123595505618, 1.0, 1.0, 1.0, 1.5714285714285714, 45.0, 3.0, 1.0466951305193752, 1.0, 1.0, 1.028991816123977, 1.75, 1.0380434782608696, 1.047197640117994, 1.5, 2.0, 1.4570552147239264, 1.0, 4.6, 1.0, 1.0, 10.0, 1.3076923076923077, 1.0, 2.0, 1.053014553014553, 2.8, 1.0, 1.0, 1.8, 1.0127877237851663, 1.0, 1.2343122102009274, 1.0, 1.0, 5.0, 1.139622641509434, 1.0, 1.0, 1.1666666666666667, 1.080295566502463, 6.0, 1.5185185185185186, 1.0, 1.0218577236515687, 3.0, 1.3333333333333333, 1.0, 1.0, 1.0, 2.0, 2.0, 1.92, 1.44, 1.0, 1.0]
origin-forest_39.80 	max: 169.0000	99th: 14.0300	95th: 6.0000	median: 1.0717	mean: 2.3715

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 11/15 | Workload-time: 28.632663 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 12/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=valueskew', '--dataset=forest', '--drift_test=ddup', '--end2end', '--update_size=25000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
ValueSample - START
ValueSample - END
load_npy_dataset_from_path - df.shape = (731012, 10)
Parsing... done, took 0.1s
Data updated!
Previous data size: (706012, 10), new data size: (25000, 10)
done, took 0.1s
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
done, took 0.1s
new data average log likelihood = 41.7245
detection mean = 49.1944
detection threshold = 0.8389
test statistic = 7.4699
Offline time = 4.209417104721069
Online time = 0.2110433578491211
Test result: True
DDUp Drift detection: True
Detection latency: 5.2215s

DRIFT-DETECTED after 12-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=forest', '--end2end', '--model=transformer', '--model_update=update', '--update_size=25000', '--epochs=40']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
update_size: 25000
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (731012, 10)
Parsing... done, took 0.1s
done, took 0.1s
dataset size: 731012
train data shape: torch.Size([25000, 10]), transfer data shape:torch.Size([5000, 10])
Epoch 0 Iter 0, train entropy gap 19.1551 bits (loss 38.076, data 18.920) 0.00300 lr
epoch 9 train loss 21.5696 nats / 31.1184 bits
time since start: 5.6 secs
Epoch 10 Iter 0, train entropy gap 11.9724 bits (loss 30.893, data 18.920) 0.00245 lr
epoch 19 train loss 20.1130 nats / 29.0169 bits
time since start: 11.3 secs
Epoch 20 Iter 0, train entropy gap 10.0584 bits (loss 28.979, data 18.920) 0.00200 lr
epoch 29 train loss 19.2399 nats / 27.7573 bits
time since start: 16.9 secs
Epoch 30 Iter 0, train entropy gap 8.7188 bits (loss 27.639, data 18.920) 0.00164 lr
epoch 39 train loss 18.6970 nats / 26.9741 bits
time since start: 22.6 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 39.7267 nats / 57.3135 bits
Saved to: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
UpdateTask - END

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 12/15 | Workload-time: 7.608094 | Model-update-time: 25.660065


WORKLOAD-START | Type: QueryWorkload | Progress: 13/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=forest', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=update', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
data size: 731012, total size: 731012, split index: [609176 731012]
Parsing... done, took 0.1s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
query_seed:0
origin-forest_39.80 	max: 20.0000	99th: 12.0100	95th: 7.0000	median: 1.1007	mean: 2.1531
ReportEsts: [1.0, 1.0603082851637764, 1.0, 1.9666666666666666, 1.3333333333333333, 1.0, 1.1888111888111887, 1.0, 1.5750487329434697, 1.0, 1.042857142857143, 1.1265822784810127, 1.0, 2.0, 2.627450980392157, 1.2156862745098038, 7.0, 6.0, 1.326086956521739, 1.6970954356846473, 1.0, 6.0, 1.0, 1.0, 1.025369978858351, 1.0, 5.0, 14.0, 7.0, 2.0476190476190474, 1.3333333333333333, 1.0, 2.0, 1.0, 2.0, 2.0, 1.0, 1.6122448979591837, 1.0, 4.0, 4.0, 1.0, 1.2941176470588236, 1.0, 1.2801556420233462, 1.4179104477611941, 1.0, 2.0, 1.0, 1.0, 3.0, 2.1161327231121283, 1.0, 1.0, 1.4782608695652173, 1.1296296296296295, 1.146417445482866, 1.3548387096774193, 1.0, 6.0, 1.12056230640934, 9.0, 6.0, 1.0, 2.892857142857143, 1.3584905660377358, 11.0, 1.0, 1.368421052631579, 1.0, 8.5, 1.2358490566037736, 1.1289047831917747, 2.019230769230769, 1.0, 1.055944055944056, 1.0, 1.0, 1.0, 1.0, 7.0, 1.4166666666666667, 1.0, 1.0211025088652028, 1.8, 1.04042121169193, 6.0, 1.0888888888888888, 1.069767441860465, 1.0, 1.0, 1.6186558747429178, 1.0, 1.0, 1.1050979380334989, 1.0, 1.3759848723605421, 1.0, 7.0, 2.0, 1.1112877583465819, 6.0, 1.1032608695652173, 1.0, 1.0, 1.0, 1.380952380952381, 1.0414746543778801, 1.3429228998849252, 1.0, 1.0053763440860215, 1.2820512820512822, 1.0, 3.75, 1.8333333333333333, 1.0, 2.0, 1.0, 1.0, 1.0, 1.3846153846153846, 1.0, 1.0, 7.75, 1.1750841750841752, 1.3, 20.0, 1.3061224489795917, 3.0, 6.0, 1.0704282524863, 1.0, 1.0, 1.0, 1.0820818761571693, 1.1111111111111112, 9.0, 2.1803435114503817, 1.0, 1.3674242424242424, 2.5, 1.0, 1.9166666666666667, 1.0, 1.0, 1.0, 1.2115902964959568, 1.0194064181870965, 1.0, 1.0, 2.1551724137931036, 2.0, 1.0, 1.0, 1.3717948717948718, 1.5832985386221294, 1.0, 1.0, 1.011111111111111, 1.0, 1.0, 1.0, 1.0, 1.0, 1.723763570566948, 7.0, 1.0, 1.0, 1.0, 2.045936395759717, 2.0, 1.25, 1.0, 1.1195652173913044, 1.0, 1.0, 2.088607594936709, 1.0, 1.277188700384123, 1.118020304568528, 1.0, 1.0312787702379735, 1.2804428044280443, 1.4480381760339343, 1.0, 1.5, 1.0, 1.0, 1.0, 3.0, 1.0, 1.0403439153439153, 1.0, 1.0, 1.5510204081632653, 1.3671191870388362, 1.0, 1.3522727272727273, 1.052512058254978, 2.0, 1.8571428571428572, 1.0081411126187245, 1.0476252524594436, 1.0, 1.0, 4.0, 1.0, 18.0, 1.0, 1.0, 1.0, 6.0, 1.2137359384251036, 1.5609756097560976, 1.3333333333333333, 4.6, 1.0, 7.0, 1.3571428571428572, 1.0, 1.0, 1.0, 1.0, 7.0, 2.1384615384615384, 1.0, 1.1818181818181819, 5.0, 1.0, 1.0, 1.1350170907709836, 1.0331001357418816, 1.434782608695652, 1.0, 1.1159770210640247, 1.0, 7.0, 2.0, 1.0, 1.5714285714285714, 7.0, 19.333333333333332, 1.0, 2.0, 2.0, 1.113888888888889, 1.2777777777777777, 1.0, 1.75, 2.25, 1.0, 2.0, 7.0, 1.0, 1.2044560943643512, 2.204081632653061, 1.25, 6.0, 2.5757575757575757, 3.736842105263158, 1.0, 1.076470588235294, 1.331009762829687, 2.8, 2.0, 1.0289855072463767, 1.0540983606557377, 4.0, 1.0, 1.0450189044227556, 4.5, 1.375, 1.0, 2.6666666666666665, 1.0, 1.0, 1.0, 1.0731707317073171, 1.5, 2.038984868079274, 1.24, 1.0, 1.0737463126843658, 1.0, 1.1282051282051282, 1.0972716488730723, 1.5555555555555556, 1.0, 4.0, 1.1396396396396395, 1.080439258750858, 1.0016503154746708, 1.0, 1.368421052631579, 9.0, 1.0, 1.8528784648187633, 1.0, 1.694267515923567, 5.0, 1.2129032258064516, 1.0, 1.0, 1.0980392156862746, 1.138, 1.0, 1.0, 1.0, 1.0430141287284145, 1.3052560646900269, 19.333333333333332, 7.0, 2.0, 1.0, 1.5, 1.0, 1.0, 1.2, 1.0, 1.0, 1.0833333333333333, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.1818181818181817, 1.0, 1.0, 1.1942433643571182, 2.5, 1.0, 1.0640699293982037, 3.0, 1.0, 1.0, 1.0, 2.303754266211604, 2.0, 3.0, 3.375, 1.0, 1.0141509433962264, 3.35, 1.0943396226415094, 1.0341463414634147, 2.0, 1.2461133700071754, 3.3636363636363638, 1.0, 1.0952380952380953, 9.5, 2.375, 10.0, 7.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.2083333333333333, 11.0, 1.5, 3.272727272727273, 1.0, 8.0, 1.1533742331288344, 2.279279279279279, 1.0252090971959447, 2.8666666666666667, 1.0460413279730474, 2.681318681318681, 1.0101755563010175, 1.1818181818181819, 1.4476987447698744, 7.0, 1.2241379310344827, 1.0, 1.2592592592592593, 1.005026161633396, 1.0, 1.0473982483256055, 1.0120006351943014, 1.0906193078324227, 1.0, 2.5, 3.0, 1.0239234449760766, 7.0, 2.0, 1.5, 1.8480176211453745, 7.0, 2.0, 2.0, 1.0, 1.1785714285714286, 1.5, 1.6, 1.0, 1.0, 2.1176470588235294, 1.0, 1.1031207598371777, 1.0, 1.0, 1.0, 1.0, 1.1207559423301727, 7.0, 8.0, 1.3944350042480884, 1.0, 1.2, 1.0, 1.0, 1.0003884219978005, 4.333333333333333, 3.409090909090909, 1.0, 1.0, 1.0340601475877924, 1.0546301066651402, 1.0, 1.2727272727272727, 3.5, 2.0, 1.0, 1.25, 1.0662726358148893, 1.0, 1.8850467289719626, 10.857142857142858, 1.0, 1.0, 1.1639344262295082, 1.1470588235294117, 15.0, 1.0, 1.042084380773541, 1.0827609852129578, 1.2, 1.4333333333333333, 2.5454545454545454, 1.0, 1.0, 1.0, 1.151952773919438, 1.5, 1.0, 1.4657293497363797, 7.0, 1.0, 1.2149532710280373, 1.0, 1.0, 1.3333333333333333, 1.6666666666666667, 1.3103448275862069, 8.793103448275861, 1.002820874471086, 1.0, 6.0, 2.0, 1.0, 1.0, 1.0286607272317185, 1.0, 1.0, 1.0727449078564502, 1.2243346007604563, 1.0, 1.0, 1.0, 1.0, 1.186206896551724, 13.0, 1.0998905309250138, 1.0251237830319888, 1.5, 3.0, 1.0081037277147489, 1.0, 1.0, 1.0, 1.1559590316573556, 1.1363636363636365, 1.0, 6.0, 1.3640124095139607, 1.7371794871794872, 1.210144927536232, 1.0, 1.1059068261504135, 1.6, 2.0, 1.0250575183944965, 2.5, 1.1113626715720957, 1.0, 1.0, 1.0, 1.0658735381967297, 2.6785714285714284, 2.0, 1.7857142857142858, 1.0, 2.6666666666666665, 11.0, 1.1555555555555554, 1.5, 1.1814159292035398, 1.363816932880907, 2.0, 2.0, 1.0, 1.0823529411764705, 6.0, 3.3333333333333335, 1.0307692307692307, 1.0, 1.0906415878144473, 1.536231884057971, 1.16, 2.0, 7.0, 1.0, 1.0, 1.0, 8.0, 1.2115027829313543, 8.608695652173912, 1.8333333333333333, 8.0, 1.0, 1.0934792521659826, 1.0, 10.0, 1.459915611814346, 7.0, 1.0756832515767345, 7.0, 1.0, 1.0246478873239437, 2.0, 1.0169688173894507, 1.0, 1.0, 1.2778962331201138, 1.0, 1.0, 1.226027397260274, 3.6666666666666665, 6.0, 1.5789473684210527, 1.1073170731707318, 1.2, 2.0, 2.0, 1.1865671641791045, 1.0, 2.923076923076923, 1.0, 1.0300829875518671, 1.0, 1.5, 1.0983148643215372, 1.0, 1.0089964502823965, 1.5710843373493977, 1.0, 3.0, 1.2148760330578512, 1.0, 2.0185185185185186, 1.4705882352941178, 6.0, 1.2693254554406697, 1.0, 1.0, 1.0, 1.1252847380410023, 2.3333333333333335, 2.392857142857143, 1.0150918635170603, 1.0, 7.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0858585858585859, 1.0272379369986517, 1.024, 1.0, 1.0, 1.2962962962962963, 3.0, 7.0, 7.0, 1.0, 1.0, 1.0, 1.0, 1.0469578885323203, 1.0, 7.0, 1.0858925143953935, 1.0, 1.0, 1.0, 2.5, 1.5, 1.0, 1.0, 1.0, 1.0, 2.2, 1.9351851851851851, 1.1405059433099665, 2.0, 7.0, 9.0, 1.0173932260546434, 1.0, 1.0, 1.0, 1.5555555555555556, 1.0041138279566784, 1.0, 2.0, 1.3846153846153846, 1.2588832487309645, 1.0, 1.0, 1.5, 1.0, 1.0, 1.1111441686501191, 1.0, 8.0, 1.015381693885302, 1.0, 1.0, 1.1347585417064325, 1.0, 1.1018991219113743, 1.0, 1.0, 1.5, 1.0419889502762432, 1.0, 1.0, 1.0, 2.0, 1.0, 1.05945435975557, 1.0161769849597762, 1.0, 7.0, 1.5238095238095237, 1.0, 1.75, 5.0, 1.0, 1.0, 1.0300504496600131, 1.0, 1.0, 1.036739380022962, 8.384615384615385, 1.1623931623931625, 5.5, 1.087281795511222, 1.0, 1.8218623481781377, 1.0, 1.0, 1.0, 1.0, 4.615384615384615, 1.0, 1.0, 1.0, 1.0, 1.2666666666666666, 1.0, 1.0164526567107, 1.055045871559633, 1.4625550660792952, 1.0, 2.0, 2.0, 2.0, 1.0, 3.5, 7.0, 1.0594732370433304, 1.0158486294169968, 1.0, 1.0, 1.8, 2.0, 1.0, 1.4827586206896552, 1.0, 1.0, 1.0, 1.003787878787879, 1.0, 6.0, 6.0, 1.0040532715691952, 1.2602739726027397, 1.0, 4.0, 1.0842696629213484, 1.0493878686700056, 1.0, 7.0, 1.043956043956044, 1.0873812038014783, 1.1428571428571428, 1.8, 9.0, 1.0, 1.401023890784983, 1.6421052631578947, 1.9904276365849947, 7.0, 1.0, 15.0, 1.1013787510137876, 1.0, 1.4814814814814814, 1.0, 1.0, 1.2121212121212122, 10.0, 3.0, 2.0, 1.0, 1.1561197245772636, 1.9183673469387754, 1.0515574650912998, 1.0, 1.0, 3.0, 6.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.5, 1.2289156626506024, 1.0, 1.034949083503055, 9.0, 1.0, 1.0, 1.2613933996856994, 1.0, 2.0, 1.0, 1.1648605026516026, 1.0177389292370975, 1.2278481012658229, 1.0, 6.0, 11.0, 1.0, 1.0, 1.0, 1.4, 1.4390243902439024, 1.0, 1.0, 7.0, 1.0, 1.1456086286594762, 1.0783316378433367, 17.0, 1.0, 1.2183908045977012, 1.8095238095238095, 2.0, 1.3658536585365855, 11.0, 1.0, 1.0, 1.0, 1.0, 2.6666666666666665, 2.0, 7.0, 1.0132275132275133, 1.065879201169021, 1.25, 1.0, 1.523489932885906, 1.0, 1.2748091603053435, 2.0, 4.5, 1.0, 1.0299027765612683, 3.6, 1.0, 1.0, 1.1131167268351383, 1.0502258108662925, 1.0, 1.3333333333333333, 7.0, 1.1189303307529908, 1.0, 1.1227671048196832, 2.0952380952380953, 1.019682456370555, 1.1840796019900497, 1.2298678414096915, 1.0, 1.4736842105263157, 1.6666666666666667, 1.0, 1.0, 1.0, 2.0, 1.5555555555555556, 7.0, 5.0, 3.0, 7.0, 1.0, 1.0, 1.0, 1.878787878787879, 3.0, 1.0, 7.0, 1.186673448626653, 2.696969696969697, 1.0, 3.0, 1.0633652822151225, 1.1, 1.0, 1.0666666666666667, 1.0, 1.0, 1.0, 1.5414798206278026, 1.5, 1.0, 1.5833333333333333, 2.1818181818181817, 6.0, 1.0, 2.5, 1.8156424581005586, 1.0, 1.2088628217660475, 1.0, 1.0, 1.0, 10.0, 1.1793611793611793, 1.0, 1.0, 1.0, 1.0, 5.0, 6.0, 7.0, 1.0, 1.0, 1.0, 1.2380952380952381, 1.0, 1.0, 1.1176470588235294, 1.0, 3.326797385620915, 3.0, 1.178082191780822, 1.0, 1.0177215189873419, 1.0, 1.0, 5.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0947368421052632, 1.4439108824933802, 11.0, 1.1523373635024121, 1.6, 1.0, 7.0, 1.4086814086814088, 1.0, 2.143312101910828, 1.1662857142857144, 11.0, 1.0, 3.0, 1.1578947368421053, 1.6666666666666667, 7.0, 1.4266500369303983, 3.0, 14.0, 1.7160493827160495, 1.0, 10.0, 1.0, 1.0, 5.0, 1.0, 12.0, 1.0, 6.0, 1.0, 7.0, 1.0, 7.0, 1.063529677273753, 1.299283154121864, 1.0, 1.0, 1.4761904761904763, 1.1809954751131222, 1.0, 2.0, 1.2978733902402921, 2.625, 1.25, 1.032258064516129, 1.0, 4.0, 1.0, 2.2, 1.0, 1.2357836338418862, 2.0, 1.0, 4.0, 1.4563106796116505, 1.2397260273972603, 1.5757575757575757, 1.0625, 2.0, 1.0372271857478668, 1.0, 1.0983535943333014, 1.010447211512911, 7.0, 1.1078248235782482, 7.0, 1.1923076923076923, 1.0, 1.0, 1.763550828390264, 2.0, 7.0, 1.0, 1.8661710037174721, 1.0, 1.1129343629343629, 1.0, 1.0, 6.0, 1.1482254697286012, 1.0, 1.0, 1.5555555555555556, 1.014016433059449, 7.0, 3.4166666666666665, 3.6153846153846154, 1.299641148325359, 3.0, 1.013069220940817, 1.0, 1.0, 1.0, 1.0]
origin-forest_39.80 	max: 20.0000	99th: 12.0100	95th: 7.0000	median: 1.1007	mean: 2.1531

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 13/15 | Workload-time: 28.796078 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 14/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=valueskew', '--dataset=forest', '--drift_test=ddup', '--end2end', '--update_size=25000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
ValueSample - START
ValueSample - END
load_npy_dataset_from_path - df.shape = (756012, 10)
Parsing... done, took 0.1s
Data updated!
Previous data size: (731012, 10), new data size: (25000, 10)
done, took 0.1s
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
sample size: 500
done, took 0.1s
new data average log likelihood = 41.4810
detection mean = 49.3077
detection threshold = 0.8671
test statistic = 7.8266
Offline time = 4.230915546417236
Online time = 0.21402454376220703
Test result: True
DDUp Drift detection: True
Detection latency: 5.2588s

DRIFT-DETECTED after 14-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=forest', '--end2end', '--model=transformer', '--model_update=update', '--update_size=25000', '--epochs=40']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
update_size: 25000
UpdateTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (756012, 10)
Parsing... done, took 0.1s
done, took 0.1s
dataset size: 756012
train data shape: torch.Size([25000, 10]), transfer data shape:torch.Size([5000, 10])
Epoch 0 Iter 0, train entropy gap 19.0428 bits (loss 37.885, data 18.842) 0.00300 lr
epoch 9 train loss 21.4594 nats / 30.9594 bits
time since start: 5.6 secs
Epoch 10 Iter 0, train entropy gap 11.8379 bits (loss 30.680, data 18.842) 0.00245 lr
epoch 19 train loss 19.9926 nats / 28.8432 bits
time since start: 11.3 secs
Epoch 20 Iter 0, train entropy gap 9.9210 bits (loss 28.763, data 18.842) 0.00200 lr
epoch 29 train loss 19.1354 nats / 27.6066 bits
time since start: 16.8 secs
Epoch 30 Iter 0, train entropy gap 8.7346 bits (loss 27.576, data 18.842) 0.00164 lr
epoch 39 train loss 18.6020 nats / 26.8370 bits
time since start: 22.4 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 39.1420 nats / 56.4700 bits
Saved to: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
UpdateTask - END

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 14/15 | Workload-time: 7.642767 | Model-update-time: 25.446416


WORKLOAD-START | Type: QueryWorkload | Progress: 15/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=forest', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=update', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
data size: 756012, total size: 756012, split index: [630010 756012]
Parsing... done, took 0.1s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
query_seed:0
origin-forest_39.80 	max: 38.0000	99th: 18.0200	95th: 8.0000	median: 1.1027	mean: 2.4389
ReportEsts: [1.0, 1.21502727432694, 1.0, 1.372093023255814, 1.0, 1.0, 1.4760330578512397, 1.0, 1.242562929061785, 1.0, 1.1756756756756757, 1.24496644295302, 1.0, 3.0, 26.8, 2.08, 1.0, 7.0, 2.1379310344827585, 1.2055335968379446, 1.0, 16.0, 1.0, 1.0, 1.0718562874251496, 1.0, 5.0, 16.0, 8.0, 2.0, 1.6, 1.0, 1.0, 1.0, 2.0, 2.0, 1.0, 1.5913043478260869, 1.0, 3.25, 9.0, 1.0, 2.8333333333333335, 1.0, 1.0712328767123287, 1.1411764705882352, 1.0, 2.0, 1.0, 1.0, 3.0, 1.018052150657455, 1.0, 1.0, 1.3180987202925045, 2.3333333333333335, 1.0381378285056588, 2.5, 8.0, 7.0, 1.0784577723378213, 20.0, 8.0, 1.0, 2.984848484848485, 1.2586206896551724, 13.0, 1.0, 1.4054054054054055, 1.0, 20.0, 1.1391752577319587, 1.0804981406209462, 2.3863636363636362, 1.0, 1.110032362459547, 8.0, 1.0, 1.0, 1.0, 8.0, 3.1176470588235294, 1.0, 1.0861290869870817, 2.5, 1.043751043679477, 7.0, 1.0465116279069768, 1.8837209302325582, 1.0, 1.0, 1.3356919629695148, 1.0, 1.0, 1.0250565693051836, 1.0, 1.026368269443829, 7.0, 1.2155220547180345, 22.0, 3.566666666666667, 1.0, 2.5, 2.0, 1.0, 1.9491525423728813, 1.0357142857142858, 1.000965950253562, 2.5, 1.1498476538695916, 1.0, 1.0103092783505154, 1.3888888888888888, 1.0, 2.875, 1.1666666666666667, 1.0, 2.0, 1.0, 1.0, 1.0, 2.1666666666666665, 1.0, 1.0, 11.333333333333334, 1.064724919093851, 1.1428571428571428, 21.0, 1.8070175438596492, 5.0, 6.0, 1.1413865546218487, 1.0, 1.0, 1.0, 1.1357895835507776, 2.2, 10.0, 2.0189344262295084, 1.0, 1.2906574394463668, 5.0, 1.0, 2.0, 1.8125, 1.0, 1.0, 1.119763694951665, 1.053014790803033, 8.0, 1.0, 2.0, 1.0299899863078086, 1.0, 1.0, 2.5, 2.186046511627907, 8.0, 1.0, 1.0, 4.0, 1.0, 1.0, 1.0, 1.6666666666666667, 1.013477088948787, 16.0, 1.0448274847780687, 6.0, 1.13256884374256, 13.0, 2.0, 1.0, 1.069204152249135, 1.0, 1.0, 2.0444444444444443, 1.0, 1.2483427521070025, 1.104109589041096, 1.0, 1.0009171342252914, 1.5015974440894568, 1.070560564484516, 1.0, 3.2, 1.0, 1.0, 1.0, 3.0, 1.0, 1.0203389830508474, 1.0, 1.0, 1.5892857142857142, 1.4266259299346478, 1.0, 1.619047619047619, 1.0569092425396134, 2.0, 1.1869918699186992, 1.6602972399150744, 1.1639952404283616, 1.0, 1.0, 4.0, 1.0, 18.0, 1.0, 1.0, 1.0, 7.0, 1.6129032258064515, 1.4361702127659575, 1.2307692307692308, 3.8333333333333335, 1.0, 8.0, 1.095890410958904, 1.0, 1.0, 1.0, 1.0, 8.0, 2.4743589743589745, 1.0, 1.25, 2.3333333333333335, 1.0, 1.0, 1.1510692356553038, 1.0385084332452754, 1.5454545454545454, 1.0, 1.1515957446808511, 1.0, 8.0, 1.0, 1.0, 1.5714285714285714, 8.0, 1.0925925925925926, 1.0, 2.0, 1.0, 1.0796364423285003, 1.054054054054054, 1.0, 4.0, 2.0, 1.0, 2.0, 8.0, 1.0, 1.2379713914174253, 1.4107142857142858, 2.0714285714285716, 7.0, 1.2857142857142858, 1.5138888888888888, 1.0, 5.230769230769231, 1.2886338301473927, 1.7142857142857142, 2.0, 1.1350806451612903, 1.4083850931677018, 4.0, 1.0, 1.0169513181992418, 5.0, 1.2777777777777777, 1.0, 2.0, 1.0, 1.0, 1.0, 1.2, 1.5, 1.93121169439263, 1.09375, 1.0, 1.053370786516854, 1.0, 1.4603174603174602, 1.0939289805269188, 1.2307692307692308, 1.0, 3.25, 1.1931818181818181, 1.0417526139839248, 1.0224277192179774, 2.5, 2.857142857142857, 11.0, 1.0, 1.1198453608247423, 1.0, 1.023076923076923, 5.0, 1.441025641025641, 1.0, 1.0, 1.2532188841201717, 1.0409652076318743, 1.0, 1.0, 1.6363636363636365, 1.05638344945514, 1.015832482124617, 16.181818181818183, 8.0, 1.411764705882353, 1.0, 1.0, 1.0, 1.0, 2.7777777777777777, 1.0, 2.0, 1.4166666666666667, 3.5, 1.0, 1.0, 1.0, 1.0, 1.0, 2.7777777777777777, 1.0, 1.0, 1.0215354495874702, 2.5, 1.0, 1.0078608307363133, 3.0, 1.0, 1.0, 1.0, 1.089588377723971, 2.0, 3.0, 2.8, 1.0, 1.069767441860465, 2.15, 1.146788990825688, 1.5598086124401913, 2.0, 1.10171283569465, 1.6323529411764706, 1.0, 1.0597014925373134, 11.0, 1.125, 1.6666666666666667, 8.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.1824324324324325, 5.5, 1.35, 2.1944444444444446, 1.0, 4.5, 1.346774193548387, 1.8467153284671534, 1.0344945053558587, 2.0, 1.0592971557342103, 1.434782608695652, 1.0991458536057952, 1.1818181818181819, 1.1528662420382165, 8.0, 1.0784810126582278, 1.0, 1.060897435897436, 1.0042123290036116, 1.0, 1.1111257294828543, 1.1634863463356069, 1.0553876781968787, 1.0, 2.5, 2.0, 1.0471698113207548, 8.0, 2.0, 1.0, 1.282874617737003, 8.0, 2.5, 1.0, 1.0, 1.05, 1.6666666666666667, 1.7, 1.0, 1.0, 8.0, 1.0, 1.0, 1.0, 9.5, 8.0, 1.0, 1.0, 1.0, 1.0106382978723405, 1.0, 1.0299116247450715, 1.0, 1.0, 1.5, 1.0, 1.0388949543788506, 2.3333333333333335, 38.0, 1.0, 1.0, 1.022813279050164, 1.0370330088639947, 1.0, 11.0, 3.0, 2.0, 1.0, 1.1181818181818182, 1.0387023335230507, 1.0, 2.3157290470723306, 38.0, 1.0, 1.0, 1.1493212669683257, 1.4814814814814814, 18.0, 1.0, 1.0380447784708566, 1.0191716731352012, 1.0, 1.1891891891891893, 2.8, 1.0, 1.0, 1.0, 1.165030662826466, 1.0, 1.0, 2.382857142857143, 8.0, 1.0, 1.066147859922179, 1.0, 1.0, 1.0659898477157361, 1.3333333333333333, 1.2258064516129032, 1.4406779661016949, 1.0422919508867667, 1.0, 7.0, 2.0, 1.0, 1.0, 1.1054869271199492, 1.0, 1.0, 1.0674789128397375, 1.1608391608391608, 8.0, 1.0, 11.0, 1.0, 1.0, 1.0, 4.0, 1.0016466326362587, 1.04963185164985, 1.2760290556900726, 1.0043738394883432, 1.0, 1.0, 2.0, 1.2692307692307692, 1.0, 1.0243695338371401, 2.6875, 1.5, 2.0, 2.2487562189054726, 1.3846153846153846, 1.0, 1.4113181504485852, 1.0, 1.3356001584576787, 1.0, 5.5, 1.0, 1.0, 1.0, 1.1015982628428342, 1.2479674796747968, 3.0, 1.64, 1.0, 2.25, 13.0, 1.4054054054054055, 1.5, 1.090497737556561, 1.25, 2.0, 2.0, 1.0, 1.225142857142857, 7.0, 20.0, 1.0719424460431655, 1.0, 1.0435055602840837, 1.3344947735191637, 1.32, 1.0, 8.0, 1.0, 1.0, 4.666666666666667, 1.0999432140829075, 1.0056174515494805, 1.0384615384615385, 2.272727272727273, 1.0, 1.0, 2.0, 3.1578947368421053, 1.0, 1.0, 1.0, 1.0331230283911672, 1.0, 1.0, 2.5, 1.0244992717537993, 2.2686567164179103, 1.0853889943074004, 1.606060606060606, 1.528735632183908, 2.5, 1.3953488372093024, 1.053817271589487, 8.0, 1.1666666666666667, 1.0108695652173914, 1.1132075471698113, 1.25, 2.0, 4.0, 1.3225806451612903, 1.0, 2.1363636363636362, 1.0, 1.095029239766082, 1.0, 1.3333333333333333, 1.0011525058477737, 2.5, 1.0215101090413448, 1.2942430703624734, 1.0, 3.0, 1.2947368421052632, 1.0, 2.2222222222222223, 5.666666666666667, 7.0, 2.028324154209284, 1.0, 1.0, 1.0, 1.0431372549019609, 2.7777777777777777, 2.3125, 1.1309101235269061, 1.0, 8.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.5096153846153846, 1.0817363067401229, 1.0772563176895307, 1.0, 1.0, 8.0, 1.6341463414634145, 1.6666666666666667, 6.0, 2.4960629921259843, 2.4210526315789473, 1.4, 1.0, 1.0, 1.063756443298969, 1.0, 8.0, 1.0465934065934066, 1.0, 1.0, 1.0, 1.0, 3.0, 1.353846153846154, 1.0, 1.0, 1.0, 1.5714285714285714, 4.826086956521739, 1.132622853759621, 1.5, 8.0, 11.0, 1.001205587704561, 1.0, 1.25, 1.0, 21.0, 1.0560603104707227, 1.0, 1.0, 1.6153846153846154, 1.5148026315789473, 1.0, 12.0, 2.0, 1.0, 1.0, 1.0838107447618284, 1.0, 3.0, 1.0600624024960998, 1.0, 1.0, 1.0305329385640267, 1.0, 1.1123610202746894, 1.0, 1.0, 1.608695652173913, 1.1021052631578947, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0229171200428546, 1.0053126960886845, 1.0, 8.0, 4.0, 1.0, 7.0, 2.5, 1.0, 1.0, 1.0803728136536948, 1.0, 1.0, 1.1791044776119404, 2.9357798165137616, 1.1694915254237288, 12.0, 1.162097735399285, 2.0, 1.6777003484320558, 1.5, 1.0, 1.0, 1.0, 1.0307692307692307, 1.0, 1.0, 1.0, 1.0, 4.0, 1.0, 1.0011516689439781, 1.0591715976331362, 1.5961538461538463, 1.0, 2.0, 2.0, 2.0291970802919708, 1.0, 4.0, 8.0, 1.3990976210008204, 1.0524483729662077, 1.0, 1.0, 3.6363636363636362, 2.0, 1.0, 1.2777777777777777, 1.0, 1.0, 1.0, 1.036231884057971, 1.0, 7.0, 7.0, 1.0178926441351888, 1.7402597402597402, 1.0, 4.0, 1.1935483870967742, 1.0152824208743976, 1.0, 8.0, 1.121051234404035, 1.6666666666666667, 2.1058823529411765, 1.0, 1.6884057971014492, 1.1711711711711712, 1.0, 1.0279450768040668, 1.0, 1.0, 3.0, 12.0, 1.5, 1.013145826964231, 1.0, 2.0, 2.090909090909091, 1.2305194805194806, 1.5, 1.0, 1.900763358778626, 7.0, 1.0, 5.0, 1.0, 1.0, 1.0, 1.8983957219251337, 4.0, 1.0, 2.6055944055944056, 1.0, 2.3333333333333335, 4.0, 1.0, 1.0, 10.0, 2.0094694884274045, 1.0, 3.225806451612903, 1.4666666666666666, 1.0, 1.320754716981132, 1.0, 2.066666666666667, 1.2219500244977952, 1.0, 2.0, 1.25, 1.1317611423626135, 1.015267175572519, 1.1875, 1.0, 7.0, 6.0, 1.0, 1.0, 1.0, 8.0, 1.7, 10.0, 1.0, 8.0, 1.0, 1.2460391425908668, 1.1559528337771015, 21.0, 1.0, 1.4503311258278146, 2.2777777777777777, 2.0, 1.1787709497206704, 13.0, 1.0, 1.0, 1.0, 1.0, 1.0666666666666667, 1.5, 8.0, 1.081841432225064, 1.1033149171270717, 1.0, 1.0, 1.490566037735849, 1.0, 1.404109589041096, 2.0, 5.0, 1.0, 1.1597761573681533, 4.5, 1.0, 1.0, 1.0828979449669105, 1.0726192886549235, 2.0, 3.0, 8.0, 1.1540084388185654, 1.0, 1.0910353844896625, 2.933333333333333, 1.1190178942987932, 1.6026785714285714, 1.403902242783868, 1.0, 1.0400552486187846, 2.3333333333333335, 1.0, 1.0, 1.0, 2.0, 2.8, 8.0, 5.0, 2.0, 8.0, 1.0, 1.0, 1.0, 2.5016146393972014, 3.0, 1.0, 7.0, 1.051622418879056, 1.434782608695652, 1.0, 1.0, 1.141404358353511, 4.0, 1.0, 1.25, 1.0, 1.0, 1.0, 1.5226554267650159, 1.2857142857142858, 1.0, 1.105263157894737, 2.451219512195122, 7.0, 1.0, 1.0, 1.5330188679245282, 4.0, 1.1710775047258979, 1.0, 1.0, 15.0, 1.105330547880585, 1.0, 2.0, 1.0, 4.0, 1.0, 1.3055212196126906, 1.0, 1.0, 2.727272727272727, 1.0, 1.0, 4.421052631578948, 1.0, 1.0, 1.8, 1.0, 1.2247191011235956, 3.0, 1.0886075949367089, 1.0, 1.0697115384615385, 1.0, 1.0, 2.5, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0263157894736843, 1.3703219300829161, 12.0, 1.1930034982508746, 8.0, 7.0, 2.375, 1.0439024390243903, 1.4, 10.0, 1.1153846153846154, 1.0, 1.6615384615384616, 1.0, 3.5, 1.0, 1.0, 1.4230167724848382, 3.0, 1.588235294117647, 1.186046511627907, 1.0, 12.0, 1.0, 1.0, 5.25, 1.0, 14.0, 1.0, 6.0, 2.0, 8.0, 1.0, 8.0, 1.0689768255356362, 1.5333333333333334, 1.0, 1.0, 2.0, 1.3407079646017699, 1.0, 2.0, 1.3225400975413546, 1.7692307692307692, 2.5, 1.5, 1.0, 4.0, 1.0, 5.0, 1.0, 1.0356643356643356, 2.0, 1.0, 4.0, 1.875, 1.0933333333333333, 1.1515151515151516, 1.394736842105263, 2.0, 1.0085473773229148, 1.0, 1.0516472309670555, 1.0064506241012627, 8.0, 1.1055866144876607, 8.0, 1.037037037037037, 1.0, 1.0, 1.5993322203672788, 2.0, 5.333333333333333, 1.0, 2.0211267605633805, 1.0, 1.1446204005589193, 1.0, 1.0, 7.0, 1.2311015118790496, 1.0, 4.0, 1.4, 1.1432201432201432, 8.0, 6.0, 8.166666666666666, 1.0412650602409639, 3.0, 1.047081313810575]
origin-forest_39.80 	max: 38.0000	99th: 18.0200	95th: 8.0000	median: 1.1027	mean: 2.4389

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 15/15 | Workload-time: 28.866274 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=7, #drift=7 | total-time=461.037445