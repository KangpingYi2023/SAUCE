Input arguments = Namespace(data_update='valueskew', update_size=25000, dataset='forest', debug=False, drift_test='distribution', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=15)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-2'}, 'random_seed': 1, 'transformer': {'epochs': 40}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/forest/end2end/forest.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=forest', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
load_csv_dataset - forest (581012, 10)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
query_seed:0
origin-forest_39.80 	max: 52.0000	99th: 4.8717	95th: 2.5000	median: 1.0048	mean: 1.3739
ReportEsts: [3.0, 1.033894343151005, 1.0, 1.475, 1.3333333333333333, 1.0, 1.0208333333333333, 1.0, 1.1188405797101448, 1.0, 1.0634920634920635, 1.0, 1.0, 1.0, 3.0, 1.0267317287936601, 1.0, 1.1111111111111112, 1.65625, 1.3333333333333333, 1.0, 3.0, 1.0526315789473684, 1.2, 1.4, 1.0, 1.0851249192029901, 1.3, 3.0, 4.448717948717949, 1.0, 1.1121856866537718, 1.6428571428571428, 1.0, 1.0, 1.053940682972941, 1.0330132052821128, 1.0, 1.0857787810383748, 1.0, 2.0, 1.0, 1.1176470588235294, 1.0, 1.853658536585366, 1.0655021834061136, 1.0, 1.5, 1.0, 1.0, 3.0, 1.1037682789651293, 1.0, 1.0, 1.2222222222222223, 1.055, 1.274582560296846, 3.090909090909091, 1.0, 1.0, 1.079863481228669, 5.7, 1.0, 1.4511415525114155, 1.21656050955414, 1.0, 1.0301724137931034, 1.463768115942029, 1.144578313253012, 1.0, 2.0, 1.0, 1.2, 1.316836895861851, 1.25, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0621891056477861, 3.5, 2.888888888888889, 1.0, 1.0, 1.0, 1.2655492367554624, 1.0, 1.6, 1.0952380952380953, 1.0, 1.125268817204301, 1.0, 1.0, 1.0474118942731279, 1.1241050119331741, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.2482758620689656, 1.0, 1.0, 1.0, 1.0978260869565217, 1.0, 1.0422535211267605, 1.0, 1.0, 1.1250712250712251, 1.2040816326530612, 2.0, 1.0, 2.0, 1.0, 1.0, 1.0, 1.0, 3.0, 1.0, 1.1801632140615193, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.260797342192691, 1.1517582362141163, 1.0, 1.25, 1.0, 1.0, 2.0, 1.0441356763383736, 1.2698412698412698, 1.138701903099809, 1.0, 1.0, 1.0, 1.0, 1.037091123407878, 1.0, 1.2666666666666666, 1.3333333333333333, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.6666666666666667, 1.7777777777777777, 2.0, 1.0174188440221694, 4.0, 1.0165544590980355, 1.0, 1.3333333333333333, 1.0, 1.1957928802588997, 1.0, 1.0, 1.0, 1.0725806451612903, 1.3181818181818181, 1.0, 1.0, 1.6540880503144655, 1.0, 1.246067415730337, 1.0, 4.863636363636363, 3.0, 1.0, 1.11405195011518, 1.0, 1.059449866903283, 1.0, 1.0, 1.2647058823529411, 1.0692845626970353, 1.0, 1.0168067226890756, 2.5555555555555554, 1.0, 1.0, 1.0, 1.0, 1.1944444444444444, 1.1428571428571428, 1.3141554113313454, 1.0631711939355655, 1.3333333333333333, 1.0, 1.0, 2.0, 3.0, 1.2260869565217392, 1.0, 1.0, 1.0, 1.0, 1.096774193548387, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0093896713615023, 1.0, 2.0, 1.0, 1.037576560172157, 1.0, 1.0, 1.0869565217391304, 1.0, 1.15, 1.0, 1.8560250391236306, 1.0, 1.0, 1.0, 1.2222222222222223, 2.0, 52.0, 1.0, 2.0, 2.0, 1.069384049314283, 1.0101742337530204, 1.0, 4.0, 1.5, 1.046951912154487, 1.187878787878788, 1.375, 1.0, 1.037037037037037, 10.0, 1.2517123287671232, 1.0, 1.6666666666666667, 1.0988372093023255, 1.0, 1.588785046728972, 1.0979057591623036, 2.142857142857143, 2.0, 1.4023668639053255, 1.0325814536340852, 4.0, 1.0, 1.2607794361525704, 1.25, 2.0, 1.0, 1.1428571428571428, 1.0, 1.0, 1.0, 1.263157894736842, 1.5, 1.4486790818536164, 2.0, 1.0, 1.2637265887626061, 1.2857142857142858, 1.0, 1.0869565217391304, 1.0, 1.0, 1.0, 1.125, 1.0, 1.0, 1.0, 2.0, 1.0, 1.1837837837837837, 1.0, 1.25, 1.0, 1.0, 1.0, 1.0, 2.0676779463243875, 1.0960451977401129, 1.1117690599555885, 2.108614232209738, 1.0, 1.3762096774193548, 1.0, 1.0, 3.0, 1.0, 1.2611940298507462, 1.0, 2.0, 1.0, 1.2857142857142858, 1.0, 1.0, 1.1666666666666667, 1.5, 1.0, 1.0, 1.0, 1.0, 1.0, 3.0, 1.0, 1.0, 1.186623516720604, 1.5, 1.0, 1.1176313327095309, 1.0, 1.0, 1.0, 1.0, 1.2066666666666668, 1.0, 3.0, 1.0, 1.0, 2.193877551020408, 1.0, 1.0731707317073171, 1.3475609756097562, 2.0, 1.0667485667485668, 1.4234234234234233, 1.0, 1.4583333333333333, 1.5, 1.1428571428571428, 3.0, 1.5, 1.0, 1.0, 1.0, 1.0, 1.0, 1.1896551724137931, 11.0, 1.5432098765432098, 6.0, 1.0, 1.0, 1.0, 1.0811965811965811, 1.3, 1.8909090909090909, 1.1020609515457136, 1.1391872342291, 1.4993654822335025, 1.026673761931686, 1.1830357142857142, 1.0, 6.264705882352941, 1.0, 1.130007558578987, 1.0034803925954423, 1.0, 1.0525820991629105, 1.0658246572225067, 1.0898076171450906, 1.0, 1.6666666666666667, 2.0, 1.0389610389610389, 1.0, 1.0, 1.0423357664233577, 4.636363636363637, 1.0, 1.7708333333333333, 1.0, 1.2033546325878595, 1.0, 10.0, 1.1666666666666667, 1.0, 1.0, 5.666666666666667, 1.0, 1.0125786163522013, 1.0, 1.0, 1.0, 1.0, 1.0176371699371032, 1.0, 2.0, 1.0934782608695652, 1.0482226508680077, 1.206405693950178, 1.4097019286966685, 1.2790697674418605, 1.1141666369821537, 1.1415929203539823, 13.2, 1.0, 1.0, 1.1145872158032053, 1.0967298393565095, 1.0, 1.1, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.1072949191030372, 2.5, 1.1730605285592497, 1.0, 1.0, 1.0, 1.190909090909091, 1.0729841542424479, 2.5, 1.2618683001531394, 4.666666666666667, 1.0, 1.0, 1.0, 1.0189383542844597, 2.0, 1.0, 1.0209832134292567, 1.0, 1.9, 1.0, 1.0, 1.0, 1.0804981066122925, 1.0, 1.0, 2.0, 1.4285714285714286, 1.2048192771084338, 1.0249810749432249, 1.75, 1.0, 1.0, 1.4492753623188406, 1.25, 2.0, 1.0297817715019255, 1.0, 1.3, 1.0, 1.0, 1.0909090909090908, 2.0, 1.0, 3.4444444444444446, 1.012919523637676, 1.0485062750090943, 2.2714285714285714, 1.3225806451612903, 1.0, 1.0, 1.0833333333333333, 1.0, 1.254934031185258, 1.2, 1.5, 1.0, 1.1070110701107012, 1.0080862533692723, 1.0, 1.0879745690434963, 1.25, 2.0, 1.0467403232508337, 2.5, 1.0074380165289256, 1.0, 1.0, 1.0, 1.0156427054977402, 1.7142857142857142, 2.0, 1.2, 1.0, 2.0, 1.0, 1.4423076923076923, 1.0, 1.0728476821192052, 1.0699570439203998, 2.0, 1.0, 1.0, 1.2098765432098766, 2.0, 1.0, 1.2409638554216869, 1.0, 1.0882428354470326, 1.9857142857142858, 1.12, 1.0, 1.2, 1.0, 2.0, 1.1071493212669683, 1.5, 4.0, 1.0401917404129795, 3.0, 1.0, 1.0106780565937, 1.0, 1.5555555555555556, 1.0, 2.0, 1.0, 1.2284644194756553, 1.0, 1.0, 1.4285714285714286, 1.0326326061428028, 1.0, 1.2388059701492538, 1.2222222222222223, 1.4109589041095891, 1.0, 1.9, 1.062111801242236, 1.0, 1.0, 1.1282051282051282, 1.5710627400768247, 1.25, 2.0, 1.1428571428571428, 1.1603773584905661, 1.0, 1.1761006289308176, 1.0, 1.0522388059701493, 1.0, 2.0, 1.059410961420209, 6.0, 1.0126371966569327, 2.8, 1.0, 3.0, 1.0625, 2.0, 2.0, 1.044479330193616, 1.0, 1.0, 1.0, 1.0, 1.0, 1.1153846153846154, 2.0, 3.5416666666666665, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.16, 1.16, 2.0, 1.2166666666666666, 1.0, 1.0, 1.4, 1.0037112600796658, 2.3214285714285716, 1.0, 1.0, 1.0, 1.0, 1.015730515611345, 1.0, 1.0, 1.061023622047244, 1.2062168309325247, 1.148936170212766, 2.0, 1.0, 1.0, 1.0, 2.25, 1.0, 1.0, 1.0, 1.142056074766355, 1.0, 1.0255047821466525, 1.0, 1.0, 1.0767373737373738, 1.0, 1.0, 1.0, 1.2352941176470589, 1.1300397790280081, 1.0, 2.0, 1.1818181818181819, 1.2411167512690355, 1.0, 1.0, 1.5, 1.0, 1.0, 1.0039949942241047, 1.0, 2.0, 1.0505729945191828, 1.0, 1.0, 1.0625, 1.0, 1.1030771178928707, 1.0, 1.0, 1.0103305785123966, 1.0315825609337452, 1.6, 1.4130434782608696, 1.0, 1.0, 4.0, 1.0319303338171262, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.5, 2.1040462427745665, 1.0, 1.0, 1.0, 1.0, 1.0, 1.2, 1.1709844559585492, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.1, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.013594306049822, 1.544186046511628, 1.0, 2.0, 1.5, 1.1007194244604317, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0073260073260073, 1.0434782608695652, 1.736842105263158, 1.9980372914622178, 1.0, 2.0, 1.0, 1.32, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0245535714285714, 1.25, 1.0, 1.5, 1.1037037037037036, 1.1779953276226498, 1.0, 1.0, 1.235895494131011, 1.1349279362158846, 1.2014925373134329, 1.0, 1.0, 1.0, 1.1168442280662443, 2.0, 2.25, 1.0, 1.0, 1.5, 1.1395076201641265, 1.0, 1.0, 1.0714285714285714, 2.0, 1.0, 3.0, 1.2666666666666666, 1.0, 1.0310776020595807, 1.0481418918918919, 1.0, 1.0, 1.0, 3.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 2.0, 3.0, 1.1036414565826331, 1.0, 1.0721753593917072, 1.0, 1.0, 1.125, 1.436994219653179, 1.5, 1.0, 1.0, 1.0, 1.0, 2.0, 1.1295336787564767, 3.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.1186094069529653, 1.0, 1.0, 1.0, 1.0, 1.140566037735849, 1.0092204526404023, 1.0, 1.0, 1.0574712643678161, 1.0, 2.0, 1.3072289156626506, 1.0, 1.0, 1.0, 1.0, 1.0, 1.7777777777777777, 2.0, 1.0, 1.155015197568389, 1.0607768469154608, 1.3333333333333333, 1.0, 1.0, 1.0, 1.0, 2.8, 1.0, 1.0, 1.076158940397351, 1.0, 1.0, 1.2692307692307692, 1.3333333333333333, 1.3055555555555556, 1.0, 1.2630434782608695, 1.0, 1.0, 3.0, 1.0, 1.037037037037037, 1.0574324324324325, 1.0, 1.006578947368421, 1.0, 1.3181818181818181, 1.0, 1.0, 1.0, 1.4285714285714286, 1.0, 1.0, 1.0, 2.0, 1.075268817204301, 1.0, 1.0, 1.054552747693542, 1.1138101053964808, 1.0, 1.0, 1.0, 1.0644848840622247, 1.0, 2.7058823529411766, 1.0, 1.0612597066436584, 2.0, 1.0, 1.3076923076923077, 1.25, 1.6666666666666667, 1.0768008474576272, 1.0, 1.8444444444444446, 1.0, 1.5, 1.4, 1.0, 1.0, 1.0, 2.0, 1.6666666666666667, 1.0, 1.0, 1.6666666666666667, 1.0, 1.6, 1.0, 1.0, 1.0, 1.3333333333333333, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0757757757757758, 2.0, 1.0, 1.0, 1.0, 1.0, 1.1775700934579438, 2.0, 1.0, 1.5841836734693877, 1.0, 1.2620571916346564, 1.0, 1.519166106254203, 1.0, 1.1944444444444444, 1.05, 1.3, 1.0, 1.0, 1.0526315789473684, 1.0056126331811264, 1.0, 1.0, 1.0593220338983051, 1.0, 1.0, 1.0, 2.0, 1.102543823407897, 1.0, 2.1666666666666665, 1.0, 1.0185185185185186, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 3.0, 2.0, 1.0, 1.0, 1.0, 1.0574780929748997, 1.1178101798014133, 1.0, 1.0, 1.2307692307692308, 1.0502793296089385, 1.0, 2.0, 1.1101076176408524, 1.2857142857142858, 1.985611510791367, 1.0, 1.0, 1.0, 1.5, 2.8222222222222224, 1.0, 1.2562406390414378, 1.0, 1.0, 1.218792650918635, 1.0, 1.75, 1.0, 1.0, 1.1666666666666667, 1.0181159420289856, 1.0, 1.5, 1.1973684210526316, 1.015691371681416, 1.0, 1.3571428571428572, 1.0, 1.0, 1.1934585942936673, 2.0, 1.75, 1.0, 1.1040723981900453, 1.0, 1.3943879124267653, 1.5, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.275, 1.0, 1.018860662047729, 1.0, 1.0709462642504946, 1.0, 1.0, 1.0, 1.0, 1.0, 1.027027027027027, 1.0563332580717995, 2.0, 1.075, 1.0, 1.117170132077939, 1.16, 2.0, 1.1016949152542372, 1.2857142857142858, 1.0, 1.0, 1.0, 1.188861985472155, 1.0, 1.0, 1.2649253731343284, 2.0, 1.0]
origin-forest_39.80 	max: 52.0000	99th: 4.8717	95th: 2.5000	median: 1.0048	mean: 1.3739

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/15 | Workload-time: 28.153943 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=valueskew', '--dataset=forest', '--drift_test=distribution', '--end2end', '--update_size=25000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
ValueSample - START
ValueSample - END
load_npy_dataset_from_path - df.shape = (606012, 10)
Parsing... done, took 0.1s
Data updated!
Previous data size: (581012, 10), new data size: (25000, 10)
[1.7881393e-07 5.9604645e-08 1.1920929e-07 5.9604645e-07 2.3841858e-07
 5.9604645e-08 0.0000000e+00 1.7285347e-06 4.7898293e-04 1.1920929e-07]
Distance score: 4.8208235966740176e-05
SAUCE Drift detection: True
Detection latency: 0.0631s

DRIFT-DETECTED after 2-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=forest', '--end2end', '--model=transformer', '--model_update=adapt', '--update_size=25000', '--epochs=40']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
update_size: 25000
AdaptTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (606012, 10)
Parsing... done, took 0.1s
done, took 0.1s
dataset size: 606012
train data shape: torch.Size([25000, 10]), transfer data shape:torch.Size([5000, 10])
Epoch 0 Iter 0, train entropy gap 29.9240 bits (loss 49.130, data 19.206) 0.00300 lr
epoch 10 train loss 22.6815 nats / 32.7225 bits
time since start: 5.8 secs
Epoch 10 Iter 0, train entropy gap 13.3130 bits (loss 32.519, data 19.206) 0.00256 lr
epoch 20 train loss 21.0224 nats / 30.3290 bits
time since start: 11.6 secs
Epoch 20 Iter 0, train entropy gap 10.9586 bits (loss 30.165, data 19.206) 0.00150 lr
epoch 30 train loss 20.4106 nats / 29.4463 bits
time since start: 17.2 secs
Epoch 30 Iter 0, train entropy gap 10.2317 bits (loss 29.438, data 19.206) 0.00044 lr
epoch 40 train loss 20.3008 nats / 29.2878 bits
time since start: 22.9 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 44.7117 nats / 64.5053 bits
Saved to: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
AdaptTask - END

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/15 | Workload-time: 2.198102 | Model-update-time: 26.015880


WORKLOAD-START | Type: QueryWorkload | Progress: 3/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=forest', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
data size: 606012, total size: 606012, split index: [505010 606012]
Parsing... done, took 0.1s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
query_seed:0
origin-forest_39.80 	max: 46.0000	99th: 7.0020	95th: 3.0000	median: 1.0457	mean: 1.5913
ReportEsts: [1.0, 1.1699263398526798, 1.0, 2.2962962962962963, 1.3333333333333333, 1.0, 1.3568904593639577, 1.0, 1.4621848739495797, 1.0, 1.8205128205128205, 2.0, 1.0, 1.0, 3.0, 2.3333333333333335, 1.26, 1.0, 1.1851851851851851, 1.9230769230769231, 1.0, 3.0, 5.75, 2.0, 2.0, 1.0, 1.0749584253766538, 1.3076923076923077, 3.0, 2.360544217687075, 1.0, 1.1428571428571428, 1.0, 1.0, 1.0, 3.0, 1.0, 1.0, 1.1153846153846154, 1.0, 1.0, 1.2874779541446209, 2.5, 1.0144030035926592, 2.0, 1.0305084745762711, 3.0, 1.0, 3.3636363636363638, 1.0, 1.0, 1.0431209187120019, 1.0, 1.0, 1.5833333333333333, 1.0045454545454546, 1.7723577235772359, 1.0833333333333333, 1.0, 1.0, 1.1620200732834156, 10.0, 1.0, 1.0959692898272553, 1.0662650602409638, 1.0, 1.1077844311377245, 1.10989010989011, 1.3091603053435115, 1.0, 2.0, 1.0, 1.051792828685259, 1.0335738939441481, 1.3333333333333333, 1.5, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0087439640546638, 7.0, 2.5925925925925926, 1.0, 1.0, 2.0, 1.6300741608118656, 1.0, 2.6666666666666665, 5.666666666666667, 1.1753277825629247, 1.5909090909090908, 2.8947368421052633, 1.1363636363636365, 1.0, 1.0, 2.0, 1.081875, 1.0, 1.1619902731013843, 1.0, 1.4692307692307693, 1.0, 1.0, 1.048780487804878, 1.0209388532053922, 1.0, 1.0, 1.1754385964912282, 2.0, 1.4343434343434343, 1.0, 1.0, 1.7411816578483246, 1.1329479768786128, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 2.0, 3.0, 1.0, 1.8588098016336057, 1.4, 1.0, 1.3333333333333333, 1.0, 1.0, 1.0, 1.2083275503122832, 1.0266430988769373, 2.0, 1.7777777777777777, 1.0, 1.0, 2.0, 1.1630602782071098, 1.4651162790697674, 1.0456533511059274, 1.0, 1.0, 2.5, 1.0, 1.18191941148946, 1.0, 1.4666666666666666, 3.2, 1.2727272727272727, 1.0285714285714285, 1.0, 1.0, 1.0, 1.0, 4.0, 2.0, 1.0, 1.0, 1.3333333333333333, 2.5384615384615383, 1.0, 1.1638349514563107, 1.75, 1.0585231193926845, 1.0, 1.3333333333333333, 29.5, 1.2, 1.0, 1.0, 4.5, 1.0, 1.3980618669586642, 1.1962727993655828, 1.0, 1.7195767195767195, 1.5, 1.0, 1.0, 2.142857142857143, 2.3777777777777778, 1.0, 1.0, 1.0356288383291934, 1.0, 1.2075983717774763, 1.0, 1.0, 2.8125, 1.2770142556837252, 1.0, 1.904, 3.8333333333333335, 1.0, 1.0, 1.0, 1.0, 1.2133333333333334, 1.0, 1.1371578334304018, 1.0971390552228875, 1.3333333333333333, 1.0, 1.0, 2.0, 1.0, 1.4387755102040816, 1.0, 1.0, 1.0, 1.0, 1.4411764705882353, 1.0, 1.125, 1.0, 1.0, 1.0, 1.2207792207792207, 1.0, 1.0, 1.0, 1.4434886499402628, 3.0, 2.0, 3.5384615384615383, 1.0, 1.0058823529411764, 1.0, 1.6177215189873417, 1.0, 1.0, 1.0, 5.5, 1.0, 7.714285714285714, 1.0, 1.0, 1.0, 1.1050686905288387, 1.1401673640167365, 1.0, 2.5, 3.0, 1.032728566346496, 1.0299251870324189, 1.8, 1.0, 1.178294573643411, 1.4285714285714286, 12.875, 2.0, 2.0, 1.5126903553299493, 1.0, 3.6559139784946235, 1.0216203914428768, 1.1428571428571428, 1.0, 1.098876404494382, 1.8311111111111111, 2.0, 1.0, 1.089412302766979, 1.2, 5.5, 1.0, 1.3333333333333333, 1.0, 1.0, 1.0, 1.1515151515151516, 1.5, 1.888763410502541, 2.0, 1.0, 1.0555555555555556, 1.0, 1.441860465116279, 1.3061224489795917, 1.0, 1.0, 2.0, 1.3227383863080684, 1.155688622754491, 1.006186892824247, 2.5, 1.0, 1.0, 1.6666666666666667, 1.7257590597453476, 1.0, 2.509433962264151, 1.0, 2.8333333333333335, 1.0, 1.0, 1.0303030303030303, 1.3333333333333333, 1.0, 1.0, 1.2666666666666666, 1.0, 1.5, 1.0, 1.0, 1.4166666666666667, 1.0, 1.5, 1.0, 1.0, 1.3846153846153846, 1.0, 1.0, 1.6666666666666667, 2.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.8, 1.0, 1.0, 1.0597069597069597, 2.0, 1.0, 1.0213002516238516, 1.0, 1.0, 1.0, 1.0, 1.6443361753958587, 2.0, 3.0, 1.0, 1.5, 1.72, 2.0, 1.0112359550561798, 1.4576271186440677, 1.0, 1.2760764448537878, 1.0571428571428572, 1.0, 1.8421052631578947, 1.5, 4.0, 1.25, 3.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.319672131147541, 11.0, 6.230769230769231, 2.5, 1.0, 1.0, 1.0, 1.5689149560117301, 1.0, 1.134020618556701, 1.056651412340224, 1.0586535040910707, 1.3461456331411488, 1.0423695821437842, 1.3978494623655915, 1.0, 2.434285714285714, 1.0, 1.4553593031696104, 1.005551258915528, 1.0, 1.0292118769187504, 1.0040264044482183, 1.0085365853658537, 1.0, 2.5, 1.0, 1.0710059171597632, 2.0, 2.0, 1.0, 1.2600574712643677, 1.0, 4.0, 1.0, 1.0, 1.2976190476190477, 1.5, 2.0, 1.0, 1.0, 17.0, 1.0, 1.0122982321291314, 1.0, 1.0, 1.0, 1.0, 1.0344515089617077, 1.0, 2.0, 1.0553097345132743, 1.2211878009630819, 1.2365591397849462, 1.4269521410579344, 2.0676691729323307, 1.029083875505539, 1.2936046511627908, 1.7, 1.0, 1.0, 1.0363867854988944, 1.0272593929820601, 1.0, 5.5, 1.4285714285714286, 2.0, 1.0, 2.6222222222222222, 1.0626053455333493, 1.0, 1.96588693957115, 1.1176470588235294, 1.0, 1.0, 1.1866666666666668, 1.7619047619047619, 1.0, 1.0, 1.2473262032085561, 1.1879904587409686, 1.0, 1.0535168195718654, 1.5555555555555556, 1.0, 1.0, 1.0, 1.0708152836502296, 1.0, 1.0, 1.4787234042553192, 1.0, 1.3157894736842106, 1.0, 1.0, 2.0, 1.0625204096778982, 1.0, 1.0, 2.0, 1.8181818181818181, 1.1826923076923077, 1.2777777777777777, 1.0, 1.0457179652285897, 1.0, 1.0, 1.0001189586024064, 1.0, 1.0, 1.458255335080494, 1.0, 2.1666666666666665, 1.0, 2.0, 1.0909090909090908, 1.0, 1.0, 3.111111111111111, 1.0674746877540462, 1.0042820749092092, 1.2404580152671756, 3.230769230769231, 1.0, 1.0, 1.3, 1.0, 1.1133221617092586, 3.0, 1.3333333333333333, 1.5, 1.4414893617021276, 1.2125, 1.0, 1.1460497114957835, 1.6666666666666667, 3.0, 1.0374615955079987, 1.6666666666666667, 1.0737373737373737, 1.0, 1.0, 1.0, 1.131612538969487, 2.0, 2.0, 1.9230769230769231, 1.0, 2.0, 1.5, 1.5576923076923077, 1.0, 1.1518987341772151, 1.735245028409091, 2.0, 1.0, 1.0, 1.115085536547434, 2.0, 20.0, 1.2976190476190477, 1.0, 1.0460271402012058, 1.68348623853211, 1.2380952380952381, 1.0, 1.6666666666666667, 1.0, 2.0, 1.0151752190237797, 1.5, 4.0, 1.3148739794107207, 1.6666666666666667, 1.0, 5.972361809045226, 1.0340909090909092, 2.142857142857143, 1.0, 1.0, 2.0, 1.0530973451327434, 1.0, 1.0, 1.0, 1.0278907388935778, 1.3217391304347825, 3.013986013986014, 1.2962962962962963, 1.121212121212121, 3.0, 1.9230769230769231, 1.011126564673157, 1.0, 1.0, 1.5185185185185186, 1.1253943217665616, 1.25, 2.0, 2.0, 1.1293103448275863, 1.0, 1.829145728643216, 1.0, 1.0333333333333334, 1.0, 2.0, 1.0043928572718768, 6.0, 1.0885984023238926, 2.8, 1.0, 4.0, 1.2363636363636363, 1.0, 2.25, 2.0, 1.5528455284552845, 1.2329029172644668, 1.0, 2.0, 1.0, 1.054590570719603, 1.3333333333333333, 2.75, 1.0, 1.0579710144927537, 1.0, 1.2307692307692308, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 2.0, 2.289855072463768, 1.16, 1.3333333333333333, 1.0498281786941581, 1.0, 1.0, 1.4, 1.0184867416880765, 4.423076923076923, 1.0, 1.0, 1.0, 1.0, 1.0289855072463767, 1.0, 2.0, 1.4063981042654028, 1.0, 1.0, 1.0, 10.5, 3.0, 1.0, 1.0, 1.0, 1.0, 1.2727272727272727, 1.1867704280155642, 1.1577047997112955, 1.5, 1.0, 1.0, 1.048237117396358, 1.0, 1.0, 1.0, 1.1666666666666667, 1.0988905836988754, 1.0, 3.0, 1.4444444444444444, 1.3424657534246576, 1.0, 1.0, 1.5, 1.0, 1.0, 1.065777821509397, 2.0, 2.0, 1.0573639881629866, 1.0, 1.0, 1.026404874746107, 1.0, 1.104503541360417, 1.0, 2.0, 1.3753424657534246, 1.0883661792752701, 6.666666666666667, 6.7, 1.0, 1.0, 1.3333333333333333, 1.0521057485398093, 1.0, 1.0, 1.0, 1.0, 1.25, 2.5, 1.0, 1.5, 1.6396396396396395, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.237623762376238, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.4285714285714286, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.1100175027845338, 1.4728915662650603, 1.0, 3.0, 2.5, 1.3206650831353919, 1.0, 5.0, 1.0, 2.0, 1.0, 1.0303915838690825, 1.105263157894737, 2.0625, 1.0961810466760962, 1.0, 46.0, 1.0, 1.08, 1.0, 1.5, 1.0, 1.0, 1.0, 1.1891105569409808, 1.2923076923076924, 1.0, 4.0, 1.2137931034482758, 1.0141866666666666, 1.0, 1.0, 1.0111633372502937, 1.1839080459770115, 1.0222222222222221, 1.125, 1.0, 1.0, 1.5685528964437485, 1.0, 2.0, 1.0, 1.0, 1.5, 1.2430632630410654, 1.0, 1.0, 1.6666666666666667, 1.0, 1.0, 4.0, 1.2, 1.25, 1.115820895522388, 1.07909604519774, 1.0, 1.0, 1.8888888888888888, 1.0458566108007448, 2.6666666666666665, 2.0, 1.0, 1.0, 2.0, 2.0, 1.1698508243915204, 1.0146109137875363, 2.6666666666666665, 7.0, 1.109430826755297, 1.0, 1.0, 1.0478541587542727, 1.0, 1.0655737704918034, 1.0163681909414821, 2.25, 1.1464435146443515, 1.2036637931034482, 2.0, 2.0, 1.1005788712011577, 1.2902654867256638, 3.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.3255512321660181, 1.0, 1.0, 2.0, 1.0, 1.3855878634639696, 1.3702894593118515, 1.0, 1.0, 1.218543046357616, 1.5, 2.0, 1.0542168674698795, 1.0, 1.0, 1.0, 1.0, 1.0, 1.7777777777777777, 2.0, 1.0, 1.0984126984126985, 1.1240203492369036, 1.2, 1.0, 2.0, 2.0, 1.0, 1.8, 1.0, 1.0, 1.698307579102281, 1.0, 1.0, 1.2142857142857142, 1.3333333333333333, 7.2, 1.0, 2.5707964601769913, 1.0909090909090908, 1.0, 1.6666666666666667, 1.7215189873417722, 1.0, 1.2096187175043327, 1.0, 1.7537091988130564, 2.0, 1.0, 1.0, 1.0, 2.0, 1.75, 1.0, 1.0, 1.0, 1.0, 1.3972602739726028, 1.0, 1.0, 1.0078902646273367, 1.2232150278447345, 1.0, 1.0, 2.0, 1.5070220059714696, 1.0, 1.3645320197044335, 1.0, 1.0335403726708075, 2.0, 4.0, 1.8461538461538463, 1.25, 1.6666666666666667, 1.010401891252955, 1.0, 3.75, 1.0, 1.0, 1.6666666666666667, 2.0, 1.0, 1.0, 4.0, 2.5, 1.0, 1.0, 1.5, 1.0, 2.6666666666666665, 1.0, 2.0, 1.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0785910425149134, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0757575757575757, 1.5, 1.0, 1.1694915254237288, 1.0, 1.0356265356265357, 1.0, 1.2011308562197092, 3.0, 1.0, 7.0, 1.2307692307692308, 1.0, 2.0, 1.148936170212766, 2.0, 1.4, 1.0, 1.3592233009708738, 1.0, 4.05, 1.0, 1.0, 1.0, 1.0, 1.0008932709163079, 1.2004449905356491, 1.7272727272727273, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 6.0, 1.0, 1.0, 1.0, 1.0, 1.0932203389830508, 1.032088374539716, 1.0, 1.0, 1.8181818181818181, 1.0453400503778338, 1.0, 2.0, 1.3021137567447156, 1.2, 1.1311475409836065, 1.0, 1.0, 1.0, 2.0, 2.25, 1.0, 1.0021658120202568, 1.0, 1.0, 1.0314576411960132, 1.0, 1.316205533596838, 2.0, 3.0, 2.0, 1.03859649122807, 1.0, 2.0, 1.525, 1.1087769189007524, 1.0, 1.0625, 2.0, 1.0, 1.1835277968428277, 2.0, 3.5, 1.0, 1.2822966507177034, 1.0, 1.312094395280236, 4.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.7419354838709677, 1.0, 1.052037845705968, 1.0, 1.0121800476348397, 1.0, 1.0, 1.0, 1.0, 1.0, 4.980769230769231, 1.1666666666666667, 1.0, 1.0, 2.0, 1.0746887966804979, 1.0, 1.1111111111111112, 1.25, 1.6702127659574468, 2.0]
origin-forest_39.80 	max: 46.0000	99th: 7.0020	95th: 3.0000	median: 1.0457	mean: 1.5913

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/15 | Workload-time: 27.826794 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 4/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=valueskew', '--dataset=forest', '--drift_test=distribution', '--end2end', '--update_size=25000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
ValueSample - START
ValueSample - END
load_npy_dataset_from_path - df.shape = (631012, 10)
Parsing... done, took 0.1s
Data updated!
Previous data size: (606012, 10), new data size: (25000, 10)
[ 5.9604645e-08 -5.9604645e-08  5.9604645e-08  1.1920929e-07
  1.7881393e-07  1.7881393e-07  5.9604645e-08  1.1920929e-07
  4.2313337e-04  0.0000000e+00]
Distance score: 4.238486144458875e-05
SAUCE Drift detection: True
Detection latency: 0.0820s

DRIFT-DETECTED after 4-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=forest', '--end2end', '--model=transformer', '--model_update=adapt', '--update_size=25000', '--epochs=40']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
update_size: 25000
AdaptTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (631012, 10)
Parsing... done, took 0.1s
done, took 0.1s
dataset size: 631012
train data shape: torch.Size([25000, 10]), transfer data shape:torch.Size([5000, 10])
Epoch 0 Iter 0, train entropy gap 17.3213 bits (loss 36.504, data 19.183) 0.00300 lr
epoch 10 train loss 21.9080 nats / 31.6066 bits
time since start: 6.0 secs
Epoch 10 Iter 0, train entropy gap 12.2052 bits (loss 31.388, data 19.183) 0.00256 lr
epoch 20 train loss 20.6402 nats / 29.7775 bits
time since start: 11.7 secs
Epoch 20 Iter 0, train entropy gap 10.5923 bits (loss 29.775, data 19.183) 0.00150 lr
epoch 30 train loss 20.1040 nats / 29.0039 bits
time since start: 17.3 secs
Epoch 30 Iter 0, train entropy gap 9.7597 bits (loss 28.942, data 19.183) 0.00044 lr
epoch 40 train loss 20.0059 nats / 28.8624 bits
time since start: 23.1 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 42.1261 nats / 60.7751 bits
Saved to: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
AdaptTask - END

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 4/15 | Workload-time: 2.232985 | Model-update-time: 26.115130


WORKLOAD-START | Type: QueryWorkload | Progress: 5/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=forest', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
data size: 631012, total size: 631012, split index: [525843 631012]
Parsing... done, took 0.1s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
query_seed:0
origin-forest_39.80 	max: 21.4000	99th: 8.7069	95th: 3.5000	median: 1.0511	mean: 1.6050
ReportEsts: [1.0, 1.1014613778705638, 1.0, 1.0833333333333333, 1.3333333333333333, 1.0, 1.900990099009901, 1.0, 1.072674418604651, 1.0, 1.3888888888888888, 2.176470588235294, 1.0, 1.5, 7.444444444444445, 1.063157894736842, 2.0, 3.0, 11.0, 1.3333333333333333, 1.0, 3.0, 8.666666666666666, 2.0, 1.6, 1.0, 1.0249554367201426, 1.0, 3.0, 5.464566929133858, 1.0, 1.4285714285714286, 1.0, 1.0, 1.0, 4.0, 1.0, 1.0, 1.0666666666666667, 1.0, 1.0, 1.1501014198782962, 1.25, 1.042048844617485, 3.0, 1.427927927927928, 2.0, 1.0, 1.7619047619047619, 1.0, 3.0, 1.0228357733927436, 1.0, 1.0, 4.0, 1.2180851063829787, 1.330316742081448, 1.2894736842105263, 1.0, 4.0, 1.1085364030497833, 1.6666666666666667, 1.0, 1.1100746268656716, 1.1818181818181819, 1.0, 1.0478011472275335, 1.4752475247524752, 1.105072463768116, 1.0, 2.0, 1.0, 1.1963470319634704, 1.0928828741115764, 1.3333333333333333, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 1.007009387572642, 3.5, 1.5357142857142858, 1.0, 1.0, 2.0, 1.4969979388834125, 1.0, 3.0, 5.2, 1.0193331246086412, 1.2222222222222223, 1.0, 1.3, 1.0, 1.0, 2.0, 1.1269574944071588, 3.0, 1.116554863440345, 1.0, 5.162162162162162, 1.0, 1.0, 1.0870288248337028, 1.0098995082317725, 1.0, 3.0, 1.2053872053872055, 1.0, 1.5434782608695652, 1.0, 1.0, 1.3764377831997212, 1.0828729281767955, 2.0, 1.0, 2.0, 1.0, 1.0, 1.0, 2.0, 3.0, 1.0, 1.8020361990950227, 1.0, 1.0, 1.125, 1.0, 1.0, 1.0, 1.2435140700068634, 1.0366696905553876, 1.0, 1.3, 1.0, 1.0, 2.0, 1.181151448478181, 1.3695652173913044, 1.0183286140659678, 1.0, 1.0, 2.5, 1.0, 1.1871315676465504, 1.0, 1.1111111111111112, 2.0869565217391304, 1.0714285714285714, 3.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 1.3333333333333333, 1.2142857142857142, 1.0, 1.1705400434709914, 2.0, 1.0619962802231866, 1.0, 2.0, 17.666666666666668, 1.8017492711370262, 1.0, 1.0, 2.903225806451613, 1.0, 1.4312072637596682, 1.162162162162162, 1.0, 1.7060367454068242, 4.0, 1.0, 2.0, 3.0, 21.4, 1.0, 1.0, 1.0031137091325677, 1.0, 1.021256931608133, 1.0, 1.0, 15.666666666666666, 1.2657226019557184, 1.0, 1.7372262773722629, 1.6428571428571428, 1.0, 1.0, 1.0, 1.0, 1.4743589743589745, 1.25, 1.1016535646516672, 1.0312687913409502, 2.0, 1.0, 1.0, 2.0, 1.5, 1.5842696629213484, 1.0, 1.0, 1.0, 3.0, 1.7222222222222223, 1.0, 1.0, 1.0, 1.0, 1.0, 1.3360323886639676, 1.0, 1.0, 1.0, 1.6655638268541495, 3.0, 3.0, 3.066666666666667, 1.0, 1.4505494505494505, 2.0, 1.207896229089878, 1.2174306939662982, 1.3470588235294119, 1.0, 5.5, 1.0, 3.2941176470588234, 1.0, 1.0, 1.0, 1.083620068816516, 1.2875647668393781, 1.0, 6.0, 4.0, 1.0, 2.0, 1.2, 1.0, 1.125, 1.6666666666666667, 2.25, 3.0, 1.3333333333333333, 1.0686274509803921, 1.0, 1.1846689895470384, 1.022855898998694, 1.1428571428571428, 3.5, 1.1503416856492028, 1.5315985130111525, 4.0, 1.0, 1.051447269066197, 1.2328767123287672, 5.25, 1.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.5, 1.2950058072009292, 1.5, 1.0, 1.0813648293963254, 1.0, 1.0655737704918034, 1.06375, 1.0, 1.0, 1.2, 1.175771971496437, 1.0416666666666667, 1.028323958385186, 1.5, 1.0, 1.0, 1.3636363636363635, 1.1506382978723404, 1.0, 1.5465116279069768, 1.0, 2.1604938271604937, 1.0, 1.0, 1.2142857142857142, 1.25, 1.0, 1.0, 1.1935483870967742, 1.0, 1.5, 1.0, 1.0, 1.8461538461538463, 1.0, 1.0, 1.0, 1.0, 1.255813953488372, 1.0, 1.0, 1.1666666666666667, 1.5, 1.0, 1.0, 1.0, 3.0, 1.0, 2.25, 1.0, 1.0, 1.173681583763101, 2.0, 1.0, 1.0408653846153846, 1.0, 1.0, 1.0, 1.0, 1.5789473684210527, 1.5, 3.0, 1.0, 1.5, 2.6875, 3.0, 1.1666666666666667, 1.553072625698324, 1.0, 1.1148602590320382, 1.608695652173913, 1.0, 1.9444444444444444, 1.6666666666666667, 2.6666666666666665, 1.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0940170940170941, 11.0, 4.5, 6.0, 1.0, 1.0, 1.0, 1.119047619047619, 1.0, 1.1956521739130435, 1.0718366108892372, 1.1831886270394045, 1.3571582346609257, 1.0139504250987905, 1.378839590443686, 1.0, 8.693877551020408, 1.0, 2.111111111111111, 1.0025664859706993, 1.0, 1.0478759878146113, 1.0209709776648388, 1.0216838826037056, 1.0, 1.6666666666666667, 1.0, 1.1412429378531073, 3.0, 2.0, 1.0, 1.0077262693156732, 2.0, 1.75, 2.0, 1.0, 1.0, 1.1666666666666667, 2.5, 1.0, 1.0, 17.0, 1.0, 1.0681818181818181, 1.0, 1.0, 1.0, 1.0, 1.0508524562536865, 1.0, 4.166666666666667, 1.7826086956521738, 1.0149413020277482, 1.2286773794808405, 1.307182320441989, 1.2557077625570776, 1.0299954004862344, 1.4126074498567336, 2.5925925925925926, 1.0, 1.0, 1.0313586606567933, 1.0627227689479701, 1.0, 11.0, 2.2, 2.0, 1.0, 2.2264150943396226, 1.0089241987266693, 1.0, 2.0623721881390593, 3.4545454545454546, 1.0, 1.0, 1.1063829787234043, 1.64, 1.0, 1.0, 1.346551724137931, 1.3835655044689588, 1.0, 1.088855421686747, 1.3333333333333333, 1.0, 1.0, 1.0, 1.0583228790003198, 1.25, 1.0, 3.1235955056179776, 1.0, 3.8, 1.0, 1.0, 3.0, 1.0214673466030597, 1.0, 1.0, 2.0, 1.0526315789473684, 1.0555555555555556, 1.3157894736842106, 1.0, 1.0417434008594229, 3.0, 1.0, 1.0563047933998175, 1.0, 1.0, 1.3705137227304716, 2.0, 1.0481927710843373, 1.0, 1.1630254882489242, 1.0, 1.0, 1.0, 4.0, 1.0134734572891404, 1.109912353708784, 2.1842105263157894, 1.627906976744186, 1.0, 1.0, 1.2727272727272727, 1.0, 1.008960032215846, 1.7777777777777777, 1.0, 2.0, 1.1706263498920086, 1.064516129032258, 1.0, 1.215327935391212, 1.6666666666666667, 2.0, 1.013840417598807, 1.6666666666666667, 1.0837534558464792, 1.0, 1.0, 1.0, 1.0952179183880042, 1.3571428571428572, 2.0, 1.72, 1.0, 2.0, 1.3333333333333333, 1.0833333333333333, 3.0, 1.216867469879518, 1.5763267740011926, 2.0, 1.0, 1.0, 1.1194029850746268, 1.0, 10.0, 1.116504854368932, 1.0, 1.034451117784451, 1.3392857142857142, 1.0740740740740742, 1.0, 1.25, 2.0, 2.0, 1.248463037936722, 1.3333333333333333, 4.0, 1.0136892539356606, 2.2, 1.0, 3.800498753117207, 1.025865432855789, 2.2222222222222223, 1.0, 1.0, 3.0, 1.5426356589147288, 1.0, 1.0, 1.2, 1.0152667760710854, 1.3333333333333333, 1.5133928571428572, 1.90625, 1.1866666666666668, 2.0, 1.05, 1.0251322751322751, 1.0, 1.0, 1.6862745098039216, 1.1347626339969372, 5.0, 2.0, 3.0, 1.4526315789473685, 1.0, 1.2464454976303319, 1.0, 3.764705882352941, 1.0, 2.4, 1.0022371364653244, 6.0, 1.024701146621127, 2.8, 1.0, 2.5, 1.271111111111111, 1.0, 1.78125, 1.3571428571428572, 4.0, 1.1896631287494233, 1.0, 3.0, 1.0, 1.0523809523809524, 1.1666666666666667, 1.2222222222222223, 1.0, 1.0714285714285714, 1.0, 1.781199058141641, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 3.0, 2.0, 1.2868217054263567, 2.380952380952381, 3.0, 1.4498834498834499, 1.0, 1.0, 1.1428571428571428, 1.0006436789829871, 3.453333333333333, 1.0, 1.0, 1.0, 1.0, 1.0262436059011046, 1.0, 3.0, 1.1515151515151516, 1.0, 1.0, 1.0, 3.5, 1.0, 1.0, 1.0, 1.0, 1.0, 2.75, 1.3831932773109243, 1.165102537365311, 1.0, 1.0, 1.0, 1.0260924588699472, 1.0, 1.0, 1.0, 5.25, 1.0431328232158108, 1.0, 1.0, 1.0833333333333333, 1.137218045112782, 1.0, 1.0, 1.0, 1.0, 1.0, 1.150538182931184, 3.0, 2.0, 1.13679142044211, 1.0, 1.0, 1.102124891587164, 1.0, 1.0333758257040213, 1.0, 3.0, 1.4364640883977902, 1.0064357952804168, 2.857142857142857, 6.2727272727272725, 1.0, 1.0, 2.0, 1.126723112448394, 1.0, 1.0, 1.0, 1.0, 1.9, 2.0, 1.0, 2.0, 1.012316249503377, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0588235294117647, 1.751937984496124, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 10.0, 1.0, 1.0, 1.0, 1.0, 1.0, 4.0, 3.0, 1.0, 1.0, 6.375, 1.0, 1.5, 1.0, 1.0, 2.92, 1.0, 1.0, 1.0, 1.2740855229263266, 1.121212121212121, 1.0, 1.125, 1.173913043478261, 2.0, 1.1904761904761905, 1.0, 1.3333333333333333, 1.0, 1.0, 2.0, 1.020896528479946, 1.3484848484848484, 1.0, 4.0, 1.1548387096774193, 1.0575307377049181, 1.0, 1.0, 1.0818320610687022, 1.0601524992939848, 1.147887323943662, 2.25, 1.0, 1.0, 1.3270348444300273, 1.0, 4.0, 1.0, 1.0, 1.6666666666666667, 1.0771850170261068, 2.0, 1.0, 1.875, 1.6764705882352942, 1.1612403100775195, 2.0, 2.0, 2.0, 1.0, 1.0727875625135899, 2.4029850746268657, 1.3501344086021505, 1.0, 1.0, 3.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.5, 1.2804054054054055, 1.5, 1.0095008844393385, 1.0, 1.0, 1.5714285714285714, 1.3190053285968029, 3.0, 1.3333333333333333, 1.0, 1.0, 1.0, 1.5357142857142858, 1.146278870829769, 3.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.069277108433735, 1.0, 1.0, 2.0, 1.0, 1.253968253968254, 1.0072824837102339, 1.0, 1.0, 1.0466321243523315, 1.380952380952381, 2.0, 1.0165745856353592, 1.0, 1.0, 1.0, 1.0, 1.0, 1.1428571428571428, 3.0, 1.0, 1.1134969325153374, 1.1143911439114391, 1.0909090909090908, 1.0, 3.0, 3.0, 1.0, 2.0, 1.0, 1.0, 1.5463576158940397, 1.0, 1.0, 1.1666666666666667, 1.3333333333333333, 1.2777777777777777, 1.0, 1.9496644295302012, 1.0909090909090908, 1.0, 3.0, 1.3088235294117647, 1.0, 1.3375814488309696, 1.0, 1.1992110453648914, 4.0, 1.0, 1.0, 1.0, 2.0, 1.0769230769230769, 1.0, 1.0, 1.0, 2.0, 1.2682926829268293, 1.0, 1.0, 1.0745052386495926, 1.3107635553164507, 1.0, 1.0, 1.0, 1.6736842105263159, 1.0, 1.6712328767123288, 1.0, 1.0248776508972268, 2.0, 2.0, 1.3076923076923077, 1.0, 1.6666666666666667, 1.0377272727272728, 1.0, 1.8, 1.0, 2.0, 1.6666666666666667, 3.0, 2.0, 1.0, 2.6666666666666665, 2.5, 1.0, 1.0, 1.0, 1.0, 1.1428571428571428, 1.0, 2.0, 1.0, 1.01274346972671, 1.0, 1.0, 1.0166666666666666, 1.0, 1.0, 1.5, 1.0, 1.0, 1.0, 1.0, 4.513274336283186, 10.333333333333334, 1.2110091743119267, 1.0, 1.40625, 1.0, 3.0, 2.5, 1.0, 1.0, 1.0, 2.0, 1.0, 2.1818181818181817, 1.005627636021818, 1.0, 1.5032679738562091, 2.0, 1.1304347826086956, 1.0, 2.0415430267062313, 1.0, 7.75, 1.4259892525647289, 1.0, 1.0, 2.0, 4.191093386507145, 1.4, 1.0, 1.0086345238017893, 1.494872219005872, 2.108108108108108, 2.0, 1.0, 2.0, 1.0, 3.0, 1.0, 1.0, 1.0, 6.0, 2.0, 1.0, 1.0, 1.0, 1.0306054557551563, 1.120440156768164, 1.0, 1.0, 1.7692307692307692, 1.0286396181384247, 1.0, 2.0, 1.4565590564261588, 2.0, 1.1702898550724639, 1.0, 1.0, 1.0, 2.0, 1.288888888888889, 2.0, 1.0234823500671797, 1.0, 1.0, 1.1856576785541704, 2.0, 1.4364161849710984, 1.0555555555555556, 3.0, 2.0, 1.864516129032258, 1.0, 2.0, 1.105263157894737, 1.0986903947517361, 1.0, 1.1764705882352942, 2.0, 1.0, 1.4381984987489576, 2.0, 3.0, 1.0, 1.024390243902439, 1.0, 1.052765237020316, 5.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.3571428571428572, 1.0, 1.056792873051225, 1.0, 1.0648088202610906, 1.0, 1.0, 1.0, 1.0, 1.0, 3.6153846153846154, 1.0277777777777777, 1.0, 1.0, 2.0, 1.103734439834025, 1.0, 1.25, 1.425, 3.1372549019607843]
origin-forest_39.80 	max: 21.4000	99th: 8.7069	95th: 3.5000	median: 1.0511	mean: 1.6050

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 5/15 | Workload-time: 27.957553 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 6/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=valueskew', '--dataset=forest', '--drift_test=distribution', '--end2end', '--update_size=25000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
ValueSample - START
ValueSample - END
load_npy_dataset_from_path - df.shape = (656012, 10)
Parsing... done, took 0.1s
Data updated!
Previous data size: (631012, 10), new data size: (25000, 10)
[0.0000000e+00 0.0000000e+00 5.9604645e-08 2.3841858e-07 1.7881393e-07
 5.9604645e-08 0.0000000e+00 5.9604645e-08 4.0936470e-04 5.9604645e-08]
Distance score: 4.1002036596182734e-05
SAUCE Drift detection: True
Detection latency: 0.0884s

DRIFT-DETECTED after 6-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=forest', '--end2end', '--model=transformer', '--model_update=adapt', '--update_size=25000', '--epochs=40']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
update_size: 25000
AdaptTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (656012, 10)
Parsing... done, took 0.1s
done, took 0.1s
dataset size: 656012
train data shape: torch.Size([25000, 10]), transfer data shape:torch.Size([5000, 10])
Epoch 0 Iter 0, train entropy gap 17.3895 bits (loss 36.522, data 19.132) 0.00300 lr
epoch 10 train loss 21.7108 nats / 31.3220 bits
time since start: 5.9 secs
Epoch 10 Iter 0, train entropy gap 12.1205 bits (loss 31.253, data 19.132) 0.00256 lr
epoch 20 train loss 20.4177 nats / 29.4566 bits
time since start: 11.7 secs
Epoch 20 Iter 0, train entropy gap 10.1275 bits (loss 29.260, data 19.132) 0.00150 lr
epoch 30 train loss 19.8897 nats / 28.6948 bits
time since start: 17.5 secs
Epoch 30 Iter 0, train entropy gap 9.4751 bits (loss 28.607, data 19.132) 0.00044 lr
epoch 40 train loss 19.7993 nats / 28.5643 bits
time since start: 23.3 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 40.9577 nats / 59.0894 bits
Saved to: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
AdaptTask - END

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 6/15 | Workload-time: 2.252650 | Model-update-time: 26.259798


WORKLOAD-START | Type: QueryWorkload | Progress: 7/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=forest', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
data size: 656012, total size: 656012, split index: [546676 656012]
Parsing... done, took 0.1s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
query_seed:0
origin-forest_39.80 	max: 44.6667	99th: 9.0100	95th: 4.0000	median: 1.0691	mean: 1.7881
ReportEsts: [1.0, 1.5073455423626485, 1.0, 1.4782608695652173, 2.6666666666666665, 1.0, 2.0869565217391304, 1.0, 1.7285067873303168, 1.0, 1.1142857142857143, 2.176470588235294, 1.0, 1.5, 44.666666666666664, 1.1951219512195121, 1.0, 4.0, 7.0, 2.066666666666667, 1.0, 3.0, 4.142857142857143, 3.8, 1.1111111111111112, 1.0, 1.0138846966495623, 1.1538461538461537, 3.0, 1.1683501683501682, 1.0, 2.0, 1.0, 1.0, 1.0, 5.0, 1.0, 1.0, 1.2916666666666667, 1.0, 2.0, 1.0578358208955223, 5.0, 1.0053214690744132, 4.0, 1.0061349693251533, 5.0, 1.0, 2.2972972972972974, 1.0, 3.0, 1.0360355702616069, 1.0, 1.0, 1.5, 1.1333333333333333, 3.2, 1.9047619047619047, 1.0, 5.0, 1.0634635533602754, 5.0, 3.0, 1.0, 1.0, 1.4805194805194806, 1.0331848959921919, 1.1428571428571428, 2.0, 4.0, 3.0, 3.0, 1.0126516417011255, 35.0, 1.0, 1.103305785123967, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0542131796903134, 3.5, 1.896551724137931, 1.0, 1.0, 2.0, 2.3334264562089677, 1.0, 1.3333333333333333, 1.4285714285714286, 1.099146856622215, 1.0476190476190477, 5.5, 1.037037037037037, 1.0, 1.0, 3.0, 1.3333333333333333, 1.0, 1.1816035415641908, 6.0, 1.0, 1.0, 1.0, 1.0, 1.0381578947368422, 2.0, 1.0, 1.048780487804878, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.020679468242245, 1.0, 1.0, 2.0, 3.0, 1.0, 1.5663716814159292, 1.0, 1.0, 1.4722222222222223, 1.0, 1.0, 1.0, 1.0594491119855365, 1.0468575603222599, 2.0, 1.3636363636363635, 1.0, 1.0, 2.0, 1.2330774598743894, 1.5, 1.0329467680608364, 1.0, 1.0, 1.6666666666666667, 1.0, 1.1477639149402517, 1.0, 1.1333333333333333, 2.526315789473684, 2.1875, 4.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 1.3333333333333333, 2.0588235294117645, 1.0, 1.1969448094612352, 2.0, 1.0932227165243877, 1.0, 2.0, 19.25, 1.1594746716697937, 1.0, 1.0, 2.2134831460674156, 1.0, 1.4725224030355104, 1.103166133048737, 1.0, 1.0364306298298183, 2.0, 1.1145311381531855, 1.0, 3.0, 1.0, 1.0, 1.0, 3.0, 1.0, 1.0186528497409326, 1.0, 1.0, 1.8461538461538463, 1.216293567367195, 1.0, 1.3370786516853932, 1.4375, 1.0, 1.0, 1.0, 1.0, 1.3875, 1.1428571428571428, 1.070253164556962, 1.073449729078868, 1.3333333333333333, 1.0, 1.0, 1.0, 1.3333333333333333, 3.0, 1.0, 1.0, 1.0, 5.0, 1.5609756097560976, 1.0, 1.0, 1.0, 1.0, 4.0, 2.54149377593361, 1.0, 5.0, 14.0, 1.0, 1.0, 1.0986736793962955, 1.1591532732261858, 1.5, 1.0, 1.0045143580175426, 1.0, 1.7076923076923076, 1.40625, 3.0, 1.3864278982092366, 1.2231404958677685, 1.0, 4.4, 3.0, 4.0, 1.0, 1.125, 3.0, 1.0, 1.0, 2.0, 1.1, 1.0, 1.2450832072617246, 1.5, 2.5, 4.0, 2.0, 1.8056872037914693, 1.0, 2.2666666666666666, 1.078882127563669, 1.0769230769230769, 2.0, 1.0441458733205373, 2.019607843137255, 4.0, 1.0, 1.1038402011994584, 1.1341463414634145, 4.0, 1.0, 1.3333333333333333, 1.0, 1.0, 1.0, 1.105263157894737, 3.0, 2.21083939193655, 1.28, 1.0, 1.0635118306351183, 1.0, 2.2666666666666666, 1.2901234567901234, 1.0, 1.0, 1.5, 1.094688221709007, 1.0670103092783505, 1.0231809716731466, 1.5, 1.375, 1.0, 1.875, 1.5528882220555138, 1.0, 1.8344827586206895, 4.0, 1.0174418604651163, 1.0, 1.0, 1.2962962962962963, 1.5, 1.0, 1.0, 1.0522875816993464, 1.0, 2.6666666666666665, 1.0, 1.0, 3.0, 1.0, 1.0, 1.0, 1.0, 1.3170731707317074, 1.0, 1.0, 1.6666666666666667, 4.0, 1.0, 1.0, 1.0, 4.0, 1.0, 2.25, 1.0, 1.0, 1.046804227478611, 2.0, 1.0, 1.066649048625793, 4.0, 1.0, 1.0, 1.0, 1.328740157480315, 1.5, 3.0, 2.5, 1.0, 1.4930555555555556, 4.0, 1.3186813186813187, 1.3777777777777778, 1.0, 1.1208205459538039, 1.5633802816901408, 1.0, 1.206896551724138, 1.0, 4.0, 10.0, 5.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.7972972972972974, 11.0, 1.8, 3.0, 1.0, 3.0, 1.18, 1.535897435897436, 1.0186231065542908, 3.0, 1.0149257190534684, 1.0786516853932584, 1.019711236660389, 3.185595567867036, 1.0165016501650166, 1.0, 1.4740484429065743, 1.0, 1.3409090909090908, 1.0217012769250613, 1.0, 1.0162673018451642, 1.0811488364488528, 1.0521286544951816, 1.0, 1.6666666666666667, 1.0, 1.086021505376344, 4.0, 2.0, 2.0, 1.0204741379310345, 5.0, 1.3333333333333333, 2.0, 1.0, 1.0632911392405062, 2.1666666666666665, 1.75, 1.0, 1.0, 17.0, 1.0, 1.172069825436409, 1.0, 1.0, 1.0, 1.0, 1.025109789389004, 1.0, 1.4285714285714286, 1.343915343915344, 1.2521395655036207, 1.3881278538812785, 1.4183908045977012, 1.095617529880478, 1.0295765472312703, 1.8644067796610169, 1.7777777777777777, 1.0, 1.0, 1.0351685114819098, 1.0595340440165062, 1.0, 1.5454545454545454, 2.0, 2.0, 1.0, 1.7417582417582418, 1.0446194225721785, 1.0, 2.2765237020316027, 1.855263157894737, 1.0, 1.0, 1.0707070707070707, 2.5, 1.0, 1.0, 1.192874692874693, 1.2832816759401022, 1.0, 1.21256038647343, 1.75, 1.0, 1.0, 1.0, 1.0571682533741902, 1.6666666666666667, 1.0, 2.618524332810047, 1.0, 1.5833333333333333, 1.0, 1.0, 4.0, 1.0396734825396399, 1.0, 1.0, 2.0, 3.3333333333333335, 1.0803571428571428, 1.3, 1.0, 1.306047197640118, 4.0, 1.0, 1.0192750693432373, 1.0, 1.0, 1.3013698630136987, 3.0, 1.6931818181818181, 1.0, 1.1290834126228988, 1.0, 1.0, 1.0, 4.5, 1.0987498244135412, 1.0774434542192417, 1.0857988165680474, 3.6666666666666665, 1.0, 1.0, 1.6666666666666667, 1.0, 1.0790621063850403, 1.2307692307692308, 1.3333333333333333, 2.0, 1.6625766871165644, 1.0789473684210527, 1.0, 1.1477459819678557, 1.25, 5.0, 1.0067047640602014, 2.5, 1.0806652160397887, 1.0, 1.0, 1.0, 1.1329211222390523, 1.0, 3.0, 1.7857142857142858, 1.0, 6.0, 1.0, 1.8571428571428572, 1.5, 1.2298850574712643, 1.6002866738803558, 2.0, 2.5, 1.0, 1.0191326530612246, 1.0, 20.0, 1.2222222222222223, 1.0, 1.012159712530279, 1.0300429184549356, 1.0714285714285714, 1.0, 1.4, 4.0, 2.0, 1.0832493158576983, 5.0, 4.0, 16.6, 1.0384615384615385, 2.7142857142857144, 1.0, 2.0, 1.625, 2.6666666666666665, 1.0, 1.5510869565217391, 2.0, 1.0, 1.1555555555555554, 2.0, 1.0219337636822903, 1.0, 1.0, 1.2281481481481482, 1.0, 1.0, 1.3741935483870968, 4.0, 4.0, 1.875, 1.1130952380952381, 2.5, 2.0, 4.666666666666667, 1.0211267605633803, 1.0, 1.399103139013453, 1.0, 4.3125, 1.0, 2.0, 1.0841202436162485, 1.6, 1.0501369816965562, 1.3728813559322033, 1.0, 6.0, 1.1219512195121952, 1.0, 1.3555555555555556, 2.0, 3.3333333333333335, 1.0979557069846677, 1.0, 4.0, 1.0, 1.1565656565656566, 1.5, 8.5, 1.068988281894702, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 4.0, 2.0, 1.6551724137931034, 2.1739130434782608, 2.8, 1.1234177215189873, 1.0, 1.0, 2.142857142857143, 1.0084229867687844, 3.2989690721649483, 1.0, 1.0, 1.0, 1.0, 1.0285632471902069, 1.0, 4.0, 1.1319979455572675, 1.0, 1.0, 1.0, 2.0, 1.5, 1.0, 1.0, 1.0, 1.0, 2.2, 1.0619684082624545, 1.075402144772118, 1.0, 1.0, 1.0, 1.0009407843453484, 1.0, 1.0, 1.0, 1.4, 1.0069767813995167, 1.0, 1.0, 1.8571428571428572, 1.2764976958525345, 1.0, 1.0, 1.5, 1.0, 1.0, 1.0612281812426516, 4.0, 2.0, 1.0044482101249734, 1.0, 1.0, 1.022373748135521, 1.0, 1.1895228561895228, 1.0, 5.0, 1.6666666666666667, 1.3910614525139664, 1.0, 1.0, 1.0, 1.6, 1.0, 1.019987477724799, 1.1103193408070162, 1.0, 4.0, 16.0, 1.0, 3.5, 4.130434782608695, 1.0, 1.0, 1.0650883441581116, 1.0, 1.0, 3.0, 1.7580645161290323, 1.315217391304348, 4.26, 1.1092436974789917, 1.0, 1.70995670995671, 2.0, 1.1818181818181819, 6.0, 1.3333333333333333, 1.0, 1.0, 1.0, 1.0357142857142858, 1.0, 2.024390243902439, 1.0, 9.0, 1.4, 1.0, 4.416666666666667, 1.0, 4.0, 1.0, 1.0, 2.8846153846153846, 1.0, 1.0, 1.0, 1.2934100418410042, 1.0, 1.0, 1.1111111111111112, 1.3695652173913044, 1.0, 1.12, 1.0, 1.5, 1.0, 1.0, 3.0, 1.0797610681658467, 1.462686567164179, 1.0, 1.3333333333333333, 1.1818181818181819, 1.0067993448806392, 1.0, 1.0, 1.0151891742612538, 1.1301165627541339, 1.6369863013698631, 2.5555555555555554, 7.0, 1.0, 1.1106407542813161, 1.238550922761449, 3.267529665587918, 1.0, 1.0, 4.0, 1.1548004314994607, 1.0, 1.5, 1.0, 1.0, 1.1818181818181819, 3.0, 3.0, 2.0, 1.0, 1.1918001147566637, 1.4161490683229814, 1.0503778337531486, 1.0, 1.0, 3.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 2.0, 1.5, 1.0794871794871794, 1.0, 1.0787784170642716, 1.0, 1.0, 1.125, 1.0667122819021553, 3.0, 1.6666666666666667, 1.0, 1.0, 1.0, 1.5555555555555556, 1.2936763129689175, 3.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.262158054711246, 1.0, 1.0, 2.0, 1.0, 1.0094664371772806, 1.0874861572535992, 1.0, 1.0, 2.125, 1.7647058823529411, 2.0, 1.2797927461139897, 1.0, 1.0, 1.0, 1.0, 1.0, 2.2857142857142856, 2.0, 1.0, 1.0614525139664805, 1.0071437683377982, 1.2, 1.0, 2.3157894736842106, 1.0, 1.3333333333333333, 1.0, 1.5, 1.0, 1.012133072407045, 3.6, 1.0, 1.0, 1.1211849192100538, 1.0874580230690611, 1.0, 1.0, 1.0, 1.3695652173913044, 1.0, 1.0297171159158014, 1.5909090909090908, 1.0732315820369827, 3.18796992481203, 1.5309278350515463, 1.0, 1.0740103270223753, 3.0, 1.0, 1.0, 1.0, 2.0, 1.4285714285714286, 4.0, 4.0, 1.0, 1.0126582278481013, 1.0, 1.0, 1.0, 2.997929606625259, 3.0, 1.0, 5.0, 1.4227941176470589, 1.5084745762711864, 4.0, 1.0, 1.0245810055865923, 5.0, 1.0116324156649865, 2.0, 2.0, 1.0769230769230769, 4.0, 1.25, 1.1375, 1.0, 7.5, 1.0, 1.5, 1.25, 4.0, 1.5, 1.0, 2.6666666666666665, 2.5, 1.0, 1.0, 3.0, 1.0, 1.625, 1.0, 4.0, 1.0, 1.1053689348262992, 1.0, 1.0, 1.1111111111111112, 1.0, 1.0, 2.27027027027027, 1.0, 1.0, 1.0, 1.0, 3.8333333333333335, 3.0, 1.2479338842975207, 1.0, 1.457142857142857, 1.0, 4.0, 5.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.3109243697478992, 1.0048442000523696, 1.0, 1.8932806324110671, 1.5, 1.4166666666666667, 1.0, 1.3978057700121902, 1.0, 6.2, 1.2663934426229508, 1.0, 1.0, 4.0, 3.0979053895034125, 1.4857142857142858, 1.0, 1.0046224290460253, 1.5562013000990143, 1.353448275862069, 3.0, 1.0, 1.0, 1.0, 4.0, 1.0, 6.0, 1.0, 6.0, 2.0, 1.0, 1.0, 1.0, 1.0692995529061102, 1.063780619319057, 1.0, 1.0, 1.8571428571428572, 1.1133786848072562, 1.0, 2.0, 1.3566455206560422, 1.6111111111111112, 1.0471014492753623, 1.0, 1.0, 1.0, 1.5, 2.3684210526315788, 1.0, 1.013251843798666, 1.0, 1.0, 1.1524788521254952, 3.0, 1.0805555555555555, 1.0263157894736843, 1.3333333333333333, 2.0, 1.0743034055727554, 1.0, 2.0, 1.1951219512195121, 1.0, 1.0, 1.1169957413859852, 1.0, 2.0, 1.0054704595185995, 1.2, 1.0, 1.0, 1.75, 1.1246290801186944, 1.0, 1.295995670995671, 3.5, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.903225806451613, 1.0, 1.1187666539779215, 1.5, 1.0295486762959274, 1.0, 1.0, 1.0, 1.0, 1.0, 2.8181818181818183, 1.2777777777777777, 1.0, 1.0, 2.0, 1.353932584269663]
origin-forest_39.80 	max: 44.6667	99th: 9.0100	95th: 4.0000	median: 1.0691	mean: 1.7881

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 7/15 | Workload-time: 28.293322 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 8/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=valueskew', '--dataset=forest', '--drift_test=distribution', '--end2end', '--update_size=25000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
ValueSample - START
ValueSample - END
load_npy_dataset_from_path - df.shape = (681012, 10)
Parsing... done, took 0.1s
Data updated!
Previous data size: (656012, 10), new data size: (25000, 10)
[-5.9604645e-08  0.0000000e+00  5.9604645e-08  2.3841858e-07
  1.7881393e-07  1.7881393e-07  0.0000000e+00  5.9604645e-08
  3.6710501e-04  1.1920929e-07]
Distance score: 3.6787987482966855e-05
SAUCE Drift detection: True
Detection latency: 0.0895s

DRIFT-DETECTED after 8-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=forest', '--end2end', '--model=transformer', '--model_update=adapt', '--update_size=25000', '--epochs=40']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
update_size: 25000
AdaptTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (681012, 10)
Parsing... done, took 0.1s
done, took 0.1s
dataset size: 681012
train data shape: torch.Size([25000, 10]), transfer data shape:torch.Size([5000, 10])
Epoch 0 Iter 0, train entropy gap 17.4302 bits (loss 36.499, data 19.069) 0.00300 lr
epoch 10 train loss 21.6206 nats / 31.1920 bits
time since start: 5.7 secs
Epoch 10 Iter 0, train entropy gap 11.9230 bits (loss 30.992, data 19.069) 0.00256 lr
epoch 20 train loss 20.3147 nats / 29.3079 bits
time since start: 11.5 secs
Epoch 20 Iter 0, train entropy gap 10.0814 bits (loss 29.150, data 19.069) 0.00150 lr
epoch 30 train loss 19.7818 nats / 28.5391 bits
time since start: 17.1 secs
Epoch 30 Iter 0, train entropy gap 9.3815 bits (loss 28.450, data 19.069) 0.00044 lr
epoch 40 train loss 19.6837 nats / 28.3976 bits
time since start: 22.8 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 40.1954 nats / 57.9897 bits
Saved to: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
AdaptTask - END

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 8/15 | Workload-time: 2.265975 | Model-update-time: 25.812561


WORKLOAD-START | Type: QueryWorkload | Progress: 9/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=forest', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
data size: 681012, total size: 681012, split index: [567510 681012]
Parsing... done, took 0.1s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
query_seed:0
origin-forest_39.80 	max: 105.0000	99th: 9.0000	95th: 5.0000	median: 1.0521	mean: 1.9300
ReportEsts: [1.0, 1.2287378640776698, 1.0, 1.5777777777777777, 2.0, 1.0, 1.5673469387755101, 1.0, 1.0025445292620865, 1.0, 2.189189189189189, 2.1176470588235294, 1.0, 1.5, 1.654320987654321, 1.1348314606741574, 4.0, 5.0, 8.142857142857142, 2.3333333333333335, 1.0, 1.5595238095238095, 1.0, 1.0, 1.088235294117647, 1.0, 1.4137931034482758, 2.0, 1.0, 3.8666666666666667, 1.5, 1.0, 1.0, 1.0, 1.0, 6.0, 1.0, 1.0, 1.0, 3.0, 1.0, 1.0, 1.5666666666666667, 1.0, 1.0789473684210527, 1.1330645161290323, 1.0, 6.0, 1.1818181818181819, 1.0, 3.0, 1.052161594697832, 1.0, 1.0, 4.4, 1.0510638297872341, 1.0654205607476634, 2.1666666666666665, 1.0, 6.0, 1.0520431252495674, 3.3, 4.0, 1.0, 1.0, 1.5, 1.0074323128649796, 1.7142857142857142, 2.0, 5.0, 4.0, 1.4523809523809523, 1.0954890387858347, 105.0, 1.0, 1.2924528301886793, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 1.098370134798164, 2.3333333333333335, 1.3666666666666667, 1.0, 1.0, 4.0, 1.755280025218031, 1.0, 2.1666666666666665, 1.8, 1.184477714679057, 1.5909090909090908, 27.5, 1.1666666666666667, 1.0, 1.0, 5.0, 2.0, 1.0, 1.097870326549929, 6.0, 1.0, 1.0, 1.0, 1.0, 1.050667642216938, 2.0, 1.0, 1.0229885057471264, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.1408, 1.0, 1.0, 2.0, 3.0, 1.0, 1.1593886462882097, 1.0, 1.0, 1.7974683544303798, 1.0, 1.0, 1.0, 1.0391717365780766, 1.064088814744201, 1.0, 2.0, 1.0, 1.0, 2.0, 1.2617226471566345, 1.3125, 1.0988190651819278, 1.0, 1.0, 2.5, 1.0, 1.1586497174012902, 1.0, 1.1333333333333333, 9.6, 1.3076923076923077, 5.0, 1.0, 1.0, 1.0, 1.0, 4.0, 1.0, 1.0, 1.0, 1.6666666666666667, 1.6363636363636365, 2.0, 1.0689655172413792, 4.0, 1.0736553746431052, 1.0, 1.3333333333333333, 17.4, 1.331896551724138, 1.0, 1.0, 2.033613445378151, 1.0, 1.2668102036969053, 1.0013545546901457, 1.0, 1.0652852682372977, 3.3333333333333335, 1.5462132921174652, 1.0, 2.0, 1.0, 1.0, 1.0, 3.0, 1.0, 1.130360450206582, 1.0, 1.0, 1.7857142857142858, 1.2219145119034058, 1.0, 1.0347826086956522, 1.0180552753681662, 2.0, 1.3385826771653544, 1.6875, 1.200652139335136, 1.0, 1.0, 4.0, 1.0, 3.142857142857143, 1.0, 1.0, 1.0, 2.0, 1.0219473264166001, 7.0, 1.5625, 1.0869565217391304, 1.0, 7.0, 1.064516129032258, 1.0, 1.0, 1.0, 1.0, 5.0, 2.8555555555555556, 1.0, 1.6666666666666667, 7.0, 1.0, 1.0, 1.0628817462701512, 1.1418457334492609, 1.5, 1.0, 1.0125151142482147, 1.0, 9.0, 1.0, 1.0, 1.8333333333333333, 4.0, 4.066666666666666, 1.0, 1.0, 1.5, 1.0412204330071655, 1.2574074074074073, 1.0, 8.0, 6.0, 1.0, 2.0, 2.8181818181818183, 1.0, 1.2430858806404659, 1.3, 4.0, 5.0, 2.3333333333333335, 1.4183006535947713, 1.0, 1.9767441860465116, 1.4295147861039335, 1.0769230769230769, 2.0, 1.2667910447761195, 1.7835497835497836, 4.0, 1.0, 1.0665012406947891, 1.1428571428571428, 5.75, 1.0, 1.6, 1.0, 1.0, 1.0, 1.368421052631579, 1.5, 1.7494769874476988, 2.0689655172413794, 1.0, 1.0348873108984253, 1.0, 1.3653846153846154, 1.3634945397815912, 1.0, 1.0, 1.2, 1.2, 1.2298850574712643, 1.0246986574588683, 1.0, 1.312169312169312, 1.0, 3.0, 1.4241610738255033, 2.0, 1.3103448275862069, 6.0, 1.591160220994475, 1.0, 1.0, 1.1612903225806452, 1.5, 1.0, 1.0, 1.8275862068965518, 1.0, 2.6666666666666665, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 4.0, 5.0, 1.0, 1.0, 1.0, 5.0, 1.0, 2.5714285714285716, 1.0, 1.0, 1.0089602966167155, 1.5, 1.0, 1.1492931963795383, 5.0, 1.0, 1.0, 1.0, 1.2881679389312977, 1.0, 3.0, 3.0, 1.0, 1.6538461538461537, 5.0, 1.391304347826087, 1.2835051546391754, 1.0, 1.186588921282799, 1.5416666666666667, 1.0, 1.4, 1.0, 8.0, 2.0, 6.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.1694915254237288, 1.3636363636363635, 3.24, 6.0, 1.0, 4.0, 1.019736842105263, 1.1111111111111112, 1.0485742763345902, 3.0, 1.0267790344584782, 2.5, 1.0628990305036652, 2.84375, 1.7486338797814207, 4.0, 8.52, 1.0, 1.0508474576271187, 1.0587847135603177, 1.0, 1.0217402848433998, 1.0514627048552612, 1.0578424414478353, 1.0, 1.6666666666666667, 1.0, 1.5487179487179488, 5.0, 2.0, 2.0, 1.2320302648171502, 3.0, 2.1, 2.0, 1.0, 1.1071428571428572, 1.1666666666666667, 1.5, 1.0, 1.0, 17.0, 1.0, 1.0096153846153846, 1.0, 1.0, 1.0, 1.0, 1.0501888758629674, 1.0, 5.0, 1.007607776838546, 1.0, 2.0, 1.0, 1.0, 1.0053093786342344, 2.4, 1.8918918918918919, 1.0, 1.0, 1.0053145962300205, 1.0615043146365748, 1.0, 1.3636363636363635, 1.8571428571428572, 2.0, 1.0, 2.251231527093596, 1.0400713311654253, 1.0, 1.935700575815739, 4.75, 1.0, 1.0, 1.2530120481927711, 1.6896551724137931, 5.0, 1.0, 1.071473750790639, 1.3354707082483241, 1.25, 1.2105263157894737, 1.4736842105263157, 1.0, 1.0, 1.0, 1.1102520109628111, 1.2, 1.0, 2.393113342898135, 4.0, 1.0, 1.106280193236715, 1.0, 1.0, 1.2767857142857142, 1.3333333333333333, 2.4285714285714284, 1.1538461538461537, 1.0892857142857142, 1.0, 4.0, 2.0, 1.0, 1.0, 1.041710397425133, 1.0, 1.0, 1.0933179723502304, 1.3214285714285714, 1.0, 1.0, 1.0, 1.0, 1.3305785123966942, 5.0, 1.2255045334893244, 1.0442318937432127, 1.5, 2.0, 1.1267326732673266, 1.0, 1.0, 1.0, 1.4736842105263157, 1.0, 1.0, 1.0, 1.1891891891891893, 1.4761904761904763, 1.0153033138830783, 1.0, 1.75, 1.0, 1.09375, 1.0, 1.0, 1.0, 1.0, 1.0, 1.1311555603869985, 1.75, 2.0, 3.2, 1.0, 7.0, 2.0, 2.888888888888889, 1.6666666666666667, 1.1263736263736264, 1.554546841623436, 2.0, 1.0, 1.0, 1.1236230110159118, 4.0, 20.0, 1.1981132075471699, 1.0, 1.0492682689658526, 1.3615819209039548, 1.0357142857142858, 1.0, 5.0, 1.0, 1.0, 1.0, 5.0, 1.1165338645418326, 1.4054054054054055, 2.0, 2.0, 1.0, 1.1319274153997056, 1.0, 11.0, 5.0, 5.0, 1.1174628034455756, 5.0, 1.0, 1.3733905579399142, 2.0, 1.003991066354782, 1.0, 1.0, 1.1776255707762557, 1.0, 1.0, 1.312883435582822, 5.0, 5.0, 1.3285714285714285, 1.1336705202312138, 5.0, 2.0, 8.0, 1.0132450331125828, 1.0, 1.0085836909871244, 1.0, 3.7, 1.0, 1.5, 1.0316353454310485, 1.8, 1.0429505063427718, 1.4727272727272727, 1.0, 7.0, 1.5555555555555556, 1.0, 1.2037037037037037, 1.3125, 3.0, 1.1012387868432294, 1.0, 4.0, 1.0, 1.0149892933618843, 1.0, 1.2, 1.0204803300427288, 1.0, 6.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 5.0, 2.0, 1.2362637362637363, 1.0026332927485346, 2.103896103896104, 1.0, 1.0, 2.5, 1.0, 6.0, 5.0, 1.0, 1.0, 1.0, 1.0, 1.054964241345734, 1.0, 2.5, 1.0177884615384616, 1.0, 1.0, 1.0, 1.0, 1.5, 1.0, 1.0, 1.0, 1.0, 1.1, 1.4848484848484849, 1.0629257216996433, 2.0, 1.0, 1.0, 1.0216106211842233, 1.0, 1.0, 1.0, 1.1666666666666667, 1.0141134504284441, 1.0, 1.0, 2.6, 1.0931558935361216, 1.0, 1.0, 1.5, 1.0, 1.0, 1.1820827472474171, 5.0, 2.0, 1.0280334728033473, 1.0, 1.0, 1.040529695024077, 1.0, 1.1362956633198034, 1.0, 6.0, 1.5, 1.2721311475409836, 1.0, 1.0, 1.0, 1.6, 1.0, 1.0942306444285808, 1.0951380955580943, 1.0, 5.0, 10.666666666666666, 1.0, 7.0, 2.1785714285714284, 1.0, 1.0, 1.0033602150537635, 1.0, 1.0, 4.0, 2.422222222222222, 1.2066115702479339, 1.125, 1.0147255689424364, 2.0, 1.9395348837209303, 1.2903225806451613, 2.2, 8.0, 3.0, 1.0, 1.0, 1.0, 1.3647058823529412, 1.0, 2.34320987654321, 1.0, 12.0, 2.3333333333333335, 5.0, 5.25, 1.0, 5.0, 1.0, 1.0, 3.2083333333333335, 1.0, 1.0, 1.0, 1.392454954954955, 1.0789473684210527, 1.0, 1.1111111111111112, 1.4838709677419355, 1.0, 1.08, 1.0, 2.0, 4.0, 1.0, 4.0, 1.0278407251537713, 1.4264705882352942, 1.0, 4.0, 1.062857142857143, 1.0187164505249158, 1.0, 1.0, 1.0389751976015262, 1.028127511384945, 1.390728476821192, 1.8, 9.0, 1.0, 1.1177539523896056, 1.1718362282878412, 3.298069122180756, 1.0, 1.0, 3.0, 1.0430944963655244, 1.0, 2.6363636363636362, 1.0, 1.0, 1.434782608695652, 4.0, 3.0, 2.0, 1.0, 1.0649884665530036, 1.3726708074534162, 1.056005554269845, 1.0, 1.0, 3.0, 4.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 3.0, 1.054862842892768, 1.0, 1.0452538241424383, 1.0, 1.0, 1.3076923076923077, 1.3238760366652118, 3.0, 2.0, 1.0, 1.0, 1.0, 1.1785714285714286, 1.0601926163723916, 3.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.1908127208480566, 1.0, 1.0, 2.0, 1.0, 1.011676396997498, 1.0805416963649324, 1.0, 1.0, 1.360759493670886, 1.7222222222222223, 2.0, 1.7, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 2.0, 1.0, 1.2398753894080996, 1.1482777933352002, 1.0833333333333333, 1.0, 2.25, 1.0, 1.6470588235294117, 1.0, 3.0, 1.0, 1.1139571570906674, 2.25, 1.0, 1.0, 1.1326663766855154, 1.0334060060482453, 1.0, 2.3333333333333335, 5.0, 1.148936170212766, 1.0, 1.104627409183764, 4.7272727272727275, 1.1137433322874177, 3.966666666666667, 1.306533133657806, 1.0, 1.128125, 1.6666666666666667, 1.0, 1.0, 1.0, 2.0, 1.4, 5.0, 5.0, 1.5, 1.0120481927710843, 1.0, 1.0, 1.0, 2.618887015177066, 3.0, 1.0, 6.0, 1.0368385800401876, 1.690909090909091, 5.0, 1.0, 1.1666666666666667, 1.0, 1.0, 1.15, 1.0, 1.0, 1.0, 3.0, 2.2222222222222223, 1.0, 1.8, 1.2120079937440265, 4.0, 1.0, 5.0, 1.1373056994818653, 1.0, 1.2256956372380625, 1.0, 1.0, 1.0, 6.0, 1.431855500821018, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.05116658088866, 2.0, 1.0, 1.0, 1.0, 1.0, 1.1710526315789473, 1.0, 5.0, 5.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.1685393258426966, 1.0406436134022465, 6.0, 1.3777777777777778, 1.0, 1.0518518518518518, 1.0, 1.6349809885931559, 1.0, 6.0, 1.3489561141883255, 1.0, 1.0, 6.0, 2.5426962209302326, 1.4473684210526316, 1.0, 1.014970309779887, 1.3472346451997614, 1.0126582278481013, 4.0, 1.0, 4.0, 1.0, 5.0, 1.0, 8.0, 1.0, 6.0, 2.0, 1.0, 1.0, 1.0, 1.038222884090345, 1.0291081158589046, 1.0, 1.0, 2.6363636363636362, 1.0732758620689655, 1.0, 2.0, 1.370856785490932, 1.5, 1.568840579710145, 1.0, 1.0, 1.0, 2.0, 3.2142857142857144, 1.0, 1.0082205857167323, 1.0, 1.0, 1.0231451834232916, 1.3333333333333333, 1.0535211267605633, 1.175, 1.5, 2.0, 1.7410714285714286, 1.0, 2.0, 1.0638297872340425, 1.0, 1.0, 1.2261355885963716, 1.0, 2.0, 1.062076749435666, 2.6, 1.0, 1.0, 1.25, 1.151603498542274, 1.0, 1.09422146313692, 9.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.6486486486486487, 1.0, 1.0112174199934014, 1.0, 1.0288013436320516, 1.0, 1.0, 1.0, 1.0, 1.0, 2.3157894736842106, 1.4166666666666667, 1.0, 1.0, 2.0, 1.2171717171717171]
origin-forest_39.80 	max: 105.0000	99th: 9.0000	95th: 5.0000	median: 1.0521	mean: 1.9300

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 9/15 | Workload-time: 28.427931 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 10/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=valueskew', '--dataset=forest', '--drift_test=distribution', '--end2end', '--update_size=25000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
ValueSample - START
ValueSample - END
load_npy_dataset_from_path - df.shape = (706012, 10)
Parsing... done, took 0.1s
Data updated!
Previous data size: (681012, 10), new data size: (25000, 10)
[-2.9802322e-08  0.0000000e+00  5.9604645e-08  1.1920929e-07
  2.3841858e-07  0.0000000e+00  5.9604645e-08  5.9604645e-08
  3.4457445e-04  1.1920929e-07]
Distance score: 3.4520031476859e-05
SAUCE Drift detection: True
Detection latency: 0.0932s

DRIFT-DETECTED after 10-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=forest', '--end2end', '--model=transformer', '--model_update=adapt', '--update_size=25000', '--epochs=40']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
update_size: 25000
AdaptTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (706012, 10)
Parsing... done, took 0.1s
done, took 0.1s
dataset size: 706012
train data shape: torch.Size([25000, 10]), transfer data shape:torch.Size([5000, 10])
Epoch 0 Iter 0, train entropy gap 17.3070 bits (loss 36.304, data 18.997) 0.00300 lr
epoch 10 train loss 21.4747 nats / 30.9814 bits
time since start: 5.8 secs
Epoch 10 Iter 0, train entropy gap 11.8737 bits (loss 30.871, data 18.997) 0.00256 lr
epoch 20 train loss 20.1548 nats / 29.0773 bits
time since start: 11.6 secs
Epoch 20 Iter 0, train entropy gap 10.1083 bits (loss 29.105, data 18.997) 0.00150 lr
epoch 30 train loss 19.6167 nats / 28.3009 bits
time since start: 17.3 secs
Epoch 30 Iter 0, train entropy gap 9.2570 bits (loss 28.254, data 18.997) 0.00044 lr
epoch 40 train loss 19.5222 nats / 28.1646 bits
time since start: 23.0 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 39.8224 nats / 57.4515 bits
Saved to: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
AdaptTask - END

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 10/15 | Workload-time: 2.280873 | Model-update-time: 26.059862


WORKLOAD-START | Type: QueryWorkload | Progress: 11/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=forest', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
data size: 706012, total size: 706012, split index: [588343 706012]
Parsing... done, took 0.1s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
query_seed:0
origin-forest_39.80 	max: 76.0000	99th: 11.0000	95th: 6.0000	median: 1.0668	mean: 2.0671
ReportEsts: [1.0, 1.0026227051330086, 1.0, 2.0, 2.0, 1.0, 1.7142857142857142, 1.0, 2.074074074074074, 1.0, 2.7096774193548385, 2.5294117647058822, 1.0, 2.0, 2.4363636363636365, 1.2530120481927711, 1.0, 6.0, 1.5344827586206897, 1.1515151515151516, 1.0, 1.0093457943925233, 1.0, 1.0, 1.1636828644501278, 1.0, 1.7647058823529411, 4.0, 3.0, 1.5833333333333333, 2.0, 1.0, 1.0, 1.0, 1.0, 7.0, 1.0, 1.75, 1.0, 1.1666666666666667, 1.0, 1.0, 1.1818181818181819, 1.0, 2.1578947368421053, 1.3211009174311927, 1.0, 7.0, 1.5384615384615385, 1.0, 3.0, 1.3333333333333333, 1.0, 1.0, 5.75, 1.06198347107438, 1.2758620689655173, 1.9090909090909092, 1.0, 8.0, 1.0152700656234226, 1.0, 5.0, 1.0, 1.0, 3.5555555555555554, 6.0, 1.0, 1.1555555555555554, 1.0, 2.0, 1.2206303724928367, 1.1095472791016716, 1.2352941176470589, 1.0, 1.5587188612099645, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0677058624195188, 7.0, 6.0, 1.0416666666666667, 1.6666666666666667, 1.0, 1.0, 2.206670637284098, 1.0, 1.0, 1.0723232323232323, 1.0, 1.13618368962787, 1.0, 6.0, 1.4245283018867925, 1.6133720930232558, 5.0, 1.2105263157894737, 1.0, 1.0, 1.0, 1.7777777777777777, 1.1445086705202312, 3.0295698924731185, 1.0, 1.3057851239669422, 2.380952380952381, 1.0, 1.375, 3.0, 1.0, 2.0, 1.0, 1.0, 1.0, 1.1538461538461537, 1.0, 1.0, 1.8, 1.119047619047619, 1.2424242424242424, 9.0, 1.5384615384615385, 2.0, 2.0, 1.001371473354232, 1.0, 1.0, 1.0, 1.0294659300184161, 1.065262391229348, 4.0, 1.6153846153846154, 1.0, 1.0, 2.0, 1.2270853155724706, 1.4651162790697674, 1.005969281291691, 1.0, 1.0, 1.25, 1.0, 1.1851024261573349, 1.0, 1.2666666666666666, 4.8, 1.2, 6.0, 1.0, 1.0, 1.0, 1.0, 4.0, 1.0, 1.0, 1.0, 1.3333333333333333, 1.088235294117647, 1.0, 1.0632440476190477, 1.25, 1.0053915371458317, 1.0, 1.3333333333333333, 10.5, 1.105545617173524, 1.0, 1.0, 1.8299319727891157, 1.0, 1.3433143602638695, 1.1601675797615212, 1.0, 1.061464512170178, 2.4, 1.1096433289299867, 1.0, 2.0, 1.0, 1.0, 1.0, 3.0, 1.0, 1.0167582417582417, 1.0, 1.0, 1.4549418604651163, 1.2022855843686893, 1.0, 1.1553398058252426, 1.0858800372941055, 2.0, 1.5232558139534884, 1.2238805970149254, 1.141950543438617, 1.0, 1.0, 5.0, 1.0, 2.0434782608695654, 1.0, 1.0, 1.0, 5.0, 1.5805705474171163, 19.0, 1.5454545454545454, 2.090909090909091, 1.0, 9.0, 1.1724137931034482, 1.0, 1.0, 1.0, 1.0, 6.0, 2.4993548387096776, 1.0, 5.0, 2.8, 1.0, 1.0, 1.1856766960302025, 1.0033613445378151, 1.4482758620689655, 1.0, 1.050744078809474, 1.0, 11.0, 1.0, 1.0, 1.0, 5.0, 3.53125, 1.0, 1.0, 3.5, 1.0621255349500713, 1.0284191829484903, 1.0, 4.5, 7.0, 1.0, 2.0, 1.28, 1.0, 1.1423027166882276, 10.0, 7.0, 6.0, 3.3333333333333335, 1.7983870967741935, 1.0, 1.0897435897435896, 1.0721542608335062, 2.3333333333333335, 2.0, 1.0910891089108912, 1.6816326530612244, 4.0, 1.0, 1.2267876787678769, 1.0879120879120878, 5.75, 1.0, 2.0, 1.0, 1.0, 1.0, 2.375, 1.5, 2.8716639591552564, 1.2424242424242424, 1.0, 1.1103038309114928, 1.0, 1.3783783783783783, 1.3637724550898203, 1.0, 1.0, 1.2, 1.1541850220264318, 1.0566037735849056, 1.0823672137996416, 2.0, 1.3402061855670102, 6.0, 1.0, 1.047709923664122, 1.0, 1.4172932330827068, 8.0, 1.5759162303664922, 1.0, 1.0, 1.2307692307692308, 1.4481086323957324, 1.0, 1.0, 1.3846153846153846, 1.063910139255042, 1.1020642201834863, 1.7333333333333334, 2.25, 1.6, 1.0, 1.5, 1.0, 1.0, 1.037037037037037, 2.0, 1.0, 4.0, 6.0, 1.0, 1.0, 1.0, 6.0, 1.0, 2.0, 1.0, 1.0, 1.022574740695546, 2.0, 1.0, 1.006114096938021, 6.0, 1.0, 1.0, 1.0, 2.581261950286807, 2.0, 3.0, 3.5, 1.0, 1.1209302325581396, 6.0, 1.1720430107526882, 1.2315270935960592, 2.0, 1.037101957347356, 1.3214285714285714, 1.0, 2.1875, 1.6666666666666667, 8.0, 10.0, 7.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.7530864197530864, 11.0, 1.528301886792453, 1.051, 1.0, 5.0, 1.3875, 1.0153846153846153, 1.0480349344978166, 1.4086687306501549, 1.043424317617866, 1.1685393258426966, 1.1435070843624073, 2.724709784411277, 1.0753012048192772, 5.0, 1.199530516431925, 1.0, 1.3265306122448979, 1.0386269688411147, 1.0, 1.0082725601503, 1.0142328760709771, 1.0627080384129777, 1.0, 1.25, 1.0, 1.1428571428571428, 5.0, 2.0, 2.0, 1.0168818272095332, 3.5, 1.4761904761904763, 2.0, 1.0, 1.0238095238095237, 1.6666666666666667, 3.0, 1.0, 1.0, 17.0, 1.0, 1.1765625, 1.0, 1.0, 1.0, 1.0, 1.0637243663227613, 1.0, 6.0, 1.1265869365225392, 1.0, 2.75, 1.0, 1.0, 1.0092994453148156, 2.3333333333333335, 76.0, 1.0, 1.0, 1.034435049961568, 1.1689324666740113, 1.0, 1.8333333333333333, 1.2727272727272727, 2.0, 1.0, 1.3214285714285714, 1.0478193265529812, 1.0, 1.9375600384245917, 4.470588235294118, 1.0, 1.0, 1.0137614678899083, 2.0384615384615383, 7.0, 1.0, 1.0590238365493758, 1.3259636532006018, 1.0, 1.0654450261780104, 3.111111111111111, 1.0, 1.0, 1.0, 1.0990412618779362, 1.75, 1.0, 2.2063492063492065, 5.0, 1.0, 1.0436681222707425, 1.0, 1.0, 1.355140186915888, 1.6666666666666667, 1.7, 2.256637168141593, 1.0172786177105833, 1.0, 5.0, 2.0, 1.0, 1.0, 1.1023753435414212, 1.0, 1.0, 1.0800438596491229, 1.029325513196481, 1.0, 1.0, 1.0, 1.0, 1.0121212121212122, 7.0, 1.9640883977900552, 1.0029537249753857, 1.5, 3.0, 1.0387323943661972, 1.0, 1.0, 1.0, 2.5135640785781104, 1.0, 1.0, 5.0, 1.2148148148148148, 1.1268191268191268, 1.0022321428571428, 1.0, 1.0741591957753645, 2.5, 2.3333333333333335, 1.0520495303159692, 2.5, 1.0495533221663875, 1.0, 1.0, 1.0, 1.0990829721751145, 2.0, 2.0, 1.6666666666666667, 1.0, 8.0, 2.0, 2.3636363636363638, 1.3333333333333333, 1.094240837696335, 1.4664330227106568, 2.0, 1.5, 1.0, 1.0353356890459364, 5.0, 2.45, 1.08130081300813, 1.0, 1.0747259947581607, 3.661764705882353, 1.1111111111111112, 2.0, 7.0, 1.0, 1.0, 1.0, 6.0, 1.1902485659655833, 1.3465909090909092, 1.5, 2.0, 1.0, 1.202709483191169, 1.0, 14.0, 2.5, 6.0, 1.2741071428571429, 6.0, 1.0, 1.4173553719008265, 2.0, 1.0243257356093958, 1.0, 1.0, 1.1955257270693513, 2.0, 1.0, 1.3976608187134503, 6.0, 6.0, 1.0786516853932584, 1.3805185704274703, 2.2, 2.0, 3.6, 1.171641791044776, 1.0, 1.1066666666666667, 1.0, 3.761904761904762, 1.0, 2.4, 1.0530076653241522, 5.0, 1.0182067212010686, 1.4727272727272727, 1.0, 8.0, 1.3333333333333333, 1.0, 1.1896551724137931, 2.4444444444444446, 2.6, 1.2538910505836576, 1.0, 4.0, 1.0, 1.2760416666666667, 1.5, 3.1666666666666665, 1.015015015015015, 1.0, 7.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 5.0, 1.0, 1.0324324324324323, 1.0113593026423318, 2.511627906976744, 1.0, 1.0, 1.6666666666666667, 1.0, 8.0, 6.0, 1.0, 1.0, 1.0, 1.0, 1.0049561446411686, 1.0, 6.0, 1.1773755656108598, 1.0, 1.0, 1.0, 4.5, 3.0, 1.0, 1.0, 1.0, 1.0, 11.0, 1.2409638554216869, 1.055311125078567, 2.5, 1.0, 1.0, 1.0251078854452726, 1.0, 1.0, 1.0, 1.0476190476190477, 1.0192034726968224, 1.0, 2.0, 1.625, 1.5344537815126051, 1.0, 1.0, 2.5, 1.0, 1.0, 1.0461506622516556, 6.0, 2.0, 1.0351946519858435, 1.0, 1.0, 1.0356037151702786, 1.0, 1.09768875192604, 1.0, 6.0, 1.4, 1.1818181818181819, 1.0, 1.0, 1.0, 1.6, 1.0, 1.0407864295348774, 1.2116419195179686, 1.0, 6.0, 32.0, 1.0, 2.3333333333333335, 1.7272727272727273, 1.0, 1.0, 1.0518112889637743, 1.0, 1.0, 5.0, 54.5, 1.0826446280991735, 2.4, 1.0125156445556946, 1.0, 5.0, 1.5, 1.0, 1.0, 2.0, 1.3630952380952381, 1.0, 1.0, 1.0, 1.0, 1.0833333333333333, 1.0, 1.0019424395083811, 1.0088929776142288, 2.4411764705882355, 1.0, 7.0, 1.0, 1.9786476868327403, 1.0, 4.5, 6.0, 1.0310644129739608, 1.0229144888145516, 1.0, 1.0, 4.0, 2.0, 1.0, 2.3333333333333335, 1.0, 1.0, 1.0, 1.2575757575757576, 1.0, 5.0, 4.0, 1.160935838355193, 1.9130434782608696, 1.0, 4.0, 1.0765027322404372, 1.0182946749428292, 1.0, 1.0, 1.0658569500674764, 1.0689741660396288, 1.0064102564102564, 1.8, 11.0, 1.0, 1.125408567004989, 1.0186335403726707, 2.679625536341178, 1.0, 1.0, 1.0, 1.2791395697848924, 1.0, 1.6610169491525424, 1.0, 1.0, 2.357142857142857, 5.0, 1.5, 2.0, 1.0, 1.1721841521088698, 2.476923076923077, 1.115547791365111, 1.0, 1.0, 3.0, 5.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.5, 1.0, 1.0, 1.0789445910290238, 1.0, 1.0, 1.0, 1.4882240611075748, 3.0, 1.75, 1.0, 1.6551724137931034, 1.0, 1.0, 1.2956609485368316, 3.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.8433575677461995, 1.0, 1.0, 2.0, 1.0, 1.0032051282051282, 1.1333333333333333, 1.0, 1.0, 2.0545454545454547, 1.1428571428571428, 2.0, 1.1488372093023256, 1.0, 1.0, 1.0, 1.0, 1.0, 3.2, 2.0, 1.0, 1.0246305418719213, 1.1215294117647059, 1.5, 1.0, 2.3, 1.0, 1.4736842105263157, 2.0, 1.0, 1.0, 1.1075654356400144, 4.5, 1.0, 1.0, 1.1403951240016814, 1.2886615962933823, 1.0, 1.3333333333333333, 6.0, 1.1063829787234043, 1.0, 1.0894732348672416, 2.8636363636363638, 1.0944647448910543, 1.7916666666666667, 1.296100278551532, 1.0, 1.3442622950819672, 3.0, 1.0, 1.0, 1.0, 2.0, 1.0714285714285714, 7.0, 6.0, 2.5, 1.0804597701149425, 1.0, 1.0, 1.0, 2.2972972972972974, 3.0, 1.0, 3.5, 1.281456953642384, 2.255813953488372, 6.0, 1.0, 1.4121037463976944, 1.2857142857142858, 1.0, 1.3157894736842106, 1.0, 1.0, 1.0, 1.0, 2.3, 1.0, 1.6666666666666667, 1.1409102172297019, 5.0, 1.0, 10.0, 1.2810945273631842, 1.0, 1.0617161716171617, 1.0, 1.0, 1.0, 8.0, 1.3395638629283488, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.1554254488680717, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0853658536585367, 1.0, 6.0, 5.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.625, 1.0104904390934843, 7.0, 1.0087118782436293, 2.0, 1.0, 1.0, 1.8435155412647375, 1.0, 5.714285714285714, 1.1877502001601281, 1.0, 1.0, 1.25, 1.1, 1.6, 6.0, 1.1106817791516401, 1.3333333333333333, 1.0, 1.0, 1.0, 1.0, 6.0, 1.0, 1.0, 10.0, 1.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.1748992515831893, 1.0400670110288985, 1.0, 1.0, 2.2857142857142856, 1.0061601642710472, 1.0, 2.0, 1.7049520352605652, 1.0555555555555556, 1.4759358288770053, 1.0, 1.0, 1.0, 1.5, 2.25, 2.0, 1.019373172664426, 1.0, 1.0, 1.2051878662530162, 5.0, 1.187116564417178, 1.2619047619047619, 1.5, 2.0, 1.157593123209169, 1.0, 2.3250733615911314, 1.0, 1.0, 14.0, 10.666666666666666, 1.0, 2.0, 1.131958762886598, 2.5, 1.0, 1.0, 1.5, 1.1452513966480447, 1.0, 1.2710785873369392, 3.6666666666666665, 1.0, 5.0, 1.0036563071297988, 1.0, 1.0, 1.5555555555555556, 1.060271220492215, 10.0, 1.7446808510638299, 1.0, 1.0402790599693925, 3.0, 1.5, 1.3529411764705883, 1.0, 1.0, 6.0, 2.0, 2.081730769230769, 1.7222222222222223, 1.0, 1.0]
origin-forest_39.80 	max: 76.0000	99th: 11.0000	95th: 6.0000	median: 1.0668	mean: 2.0671

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 11/15 | Workload-time: 28.621883 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 12/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=valueskew', '--dataset=forest', '--drift_test=distribution', '--end2end', '--update_size=25000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
ValueSample - START
ValueSample - END
load_npy_dataset_from_path - df.shape = (731012, 10)
Parsing... done, took 0.1s
Data updated!
Previous data size: (706012, 10), new data size: (25000, 10)
[0.0000000e+00 0.0000000e+00 5.9604645e-08 1.7881393e-07 1.7881393e-07
 5.9604645e-08 5.9604645e-08 0.0000000e+00 3.0732155e-04 1.1920929e-07]
Distance score: 3.07977206830401e-05
SAUCE Drift detection: True
Detection latency: 0.0968s

DRIFT-DETECTED after 12-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=forest', '--end2end', '--model=transformer', '--model_update=adapt', '--update_size=25000', '--epochs=40']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
update_size: 25000
AdaptTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (731012, 10)
Parsing... done, took 0.1s
done, took 0.1s
dataset size: 731012
train data shape: torch.Size([25000, 10]), transfer data shape:torch.Size([5000, 10])
Epoch 0 Iter 0, train entropy gap 17.5928 bits (loss 36.514, data 18.921) 0.00300 lr
epoch 10 train loss 21.3749 nats / 30.8374 bits
time since start: 5.8 secs
Epoch 10 Iter 0, train entropy gap 11.7314 bits (loss 30.652, data 18.921) 0.00256 lr
epoch 20 train loss 20.0461 nats / 28.9204 bits
time since start: 11.5 secs
Epoch 20 Iter 0, train entropy gap 9.8865 bits (loss 28.807, data 18.921) 0.00150 lr
epoch 30 train loss 19.5136 nats / 28.1522 bits
time since start: 17.1 secs
Epoch 30 Iter 0, train entropy gap 9.1181 bits (loss 28.039, data 18.921) 0.00044 lr
epoch 40 train loss 19.4281 nats / 28.0288 bits
time since start: 22.8 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 39.2472 nats / 56.6217 bits
Saved to: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
AdaptTask - END

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 12/15 | Workload-time: 2.320201 | Model-update-time: 25.779987


WORKLOAD-START | Type: QueryWorkload | Progress: 13/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=forest', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
data size: 731012, total size: 731012, split index: [609176 731012]
Parsing... done, took 0.1s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
query_seed:0
origin-forest_39.80 	max: 210.0000	99th: 17.0300	95th: 7.0000	median: 1.0909	mean: 2.5750
ReportEsts: [17.0, 1.347739602169982, 1.0, 1.2833333333333334, 2.6666666666666665, 1.0, 1.265625, 1.0, 1.6139088729016786, 1.0, 1.5, 2.0588235294117645, 1.0, 2.0, 33.5, 1.2523364485981308, 1.0, 7.0, 1.5263157894736843, 1.7692307692307692, 1.0, 1.2290076335877862, 1.0, 1.0, 1.1824034334763949, 1.0, 1.9375, 4.0, 7.0, 2.3333333333333335, 1.25, 1.0, 1.0, 1.0, 1.0, 7.0, 1.0, 2.25, 1.0, 2.0, 2.0, 1.0, 1.4722222222222223, 1.0, 1.268041237113402, 1.337837837837838, 1.0, 4.0, 1.5333333333333334, 1.0, 3.0, 5.0, 1.0, 1.0, 6.5, 1.2912621359223302, 1.4936708860759493, 1.0638297872340425, 1.0, 10.0, 1.078490113840623, 1.9, 6.0, 1.0, 4.0, 5.0, 7.0, 1.0, 1.4857142857142858, 1.0, 2.0, 1.0193370165745856, 1.126033108522379, 210.0, 1.0, 1.0909090909090908, 1.0, 1.0, 1.0, 1.0, 7.0, 3.4, 1.0, 1.0128997212929165, 5.0, 1.0075954627682981, 7.0, 1.1590909090909092, 1.1224489795918366, 1.0, 1.0, 1.6674167416741674, 1.0, 1.0, 1.0886185736898024, 1.0, 1.273945267958951, 1.0, 7.0, 1.070967741935484, 1.055944055944056, 6.0, 1.1151515151515152, 1.0, 1.0, 1.0, 3.857142857142857, 1.1396648044692737, 2.3346693386773545, 1.0, 1.0063291139240507, 1.4285714285714286, 1.0, 1.75, 1.3333333333333333, 1.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.6666666666666667, 1.3235294117647058, 1.0303030303030303, 5.5, 1.4772727272727273, 2.0, 2.0, 1.1708509220173295, 1.0, 1.0, 1.0, 1.0442563017125264, 1.5742690058479532, 1.0, 1.0460863204096562, 1.0, 1.0633367929423976, 2.0, 1.0, 1.6944444444444444, 1.1475409836065573, 1.0, 1.0, 2.841683366733467, 1.0844486829557038, 1.0, 1.0, 1.7358490566037736, 2.0, 1.0, 1.0, 1.0256410256410255, 1.1869216533004319, 1.0, 1.0, 1.5466666666666666, 1.0, 1.0, 1.0, 1.3333333333333333, 1.0, 1.5582627118644068, 7.0, 1.0, 1.0, 1.0, 1.9717461787864752, 4.2, 1.5, 11.625, 1.3612334801762114, 1.0, 1.0, 1.8305084745762712, 1.0, 1.3895110298518834, 1.3135201724668926, 1.0, 1.0147109898288267, 4.666666666666667, 1.112352377912544, 1.0, 2.111111111111111, 1.0, 1.0, 1.0, 3.0, 1.0, 1.0061333333333333, 1.0, 1.0, 1.488857938718663, 1.1921697191312297, 1.0, 1.4166666666666667, 1.0858454781393492, 2.0, 1.1925925925925926, 1.9285714285714286, 1.241421568627451, 1.0, 1.0, 6.0, 1.0, 1.411764705882353, 1.0, 1.0, 1.0, 6.0, 1.3795423956931359, 21.0, 1.2093023255813953, 11.5, 1.0, 11.0, 1.0144927536231885, 1.0, 1.0, 1.0, 1.0, 7.0, 1.9253246753246753, 1.0, 2.5, 3.5, 1.0, 1.0, 1.0174002047082906, 1.0849162011173183, 1.375, 1.0, 1.0089923377186643, 1.0, 13.0, 1.0, 1.0, 1.8181818181818181, 6.0, 2.7916666666666665, 1.0, 2.0, 1.0, 1.0728650137741047, 1.089385474860335, 1.0, 3.0, 8.0, 1.0, 2.0, 1.65, 1.0, 1.3047210300429184, 1.6666666666666667, 4.0, 7.0, 1.75, 2.590909090909091, 1.0, 1.8784530386740332, 1.1008028974823314, 1.2142857142857142, 2.0, 1.2791519434628975, 1.73109243697479, 4.0, 1.0, 1.0039342844790315, 1.1683168316831682, 6.0, 1.0, 2.0, 1.0, 1.0, 1.0, 2.026315789473684, 1.5, 2.8959346430655515, 1.5135135135135136, 1.0, 1.098360655737705, 1.0, 1.0129870129870129, 1.3103448275862069, 7.5, 1.0, 1.5, 1.0647948164146868, 1.036181434599156, 1.0572899158094469, 3.0, 1.555, 7.0, 1.0, 1.4303097345132743, 1.0, 2.375, 10.0, 1.655, 1.0, 1.0, 1.1900452488687783, 1.0945121951219512, 1.0, 1.0, 1.3846153846153846, 1.054518279886317, 1.2899676375404532, 56.333333333333336, 2.5, 1.411764705882353, 1.0, 1.0, 1.0, 1.0, 1.1666666666666667, 1.0, 1.0, 4.0, 7.0, 1.0, 1.0, 1.0, 7.0, 1.0, 1.5, 1.0, 1.0, 1.0875954473418816, 3.0, 1.0, 1.0228154880242355, 7.0, 1.0, 1.0, 1.0, 1.1103703703703705, 2.0, 3.0, 4.0, 1.0, 1.7338709677419355, 7.0, 1.1914893617021276, 1.5754716981132075, 2.0, 1.1077659410220781, 3.8275862068965516, 1.0, 1.75, 1.0, 8.0, 3.3333333333333335, 8.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.5, 11.0, 1.5, 1.1532329495128433, 1.0, 6.0, 1.3333333333333333, 1.007267441860465, 1.0019033884211621, 1.2593582887700534, 1.010337401292175, 1.0555555555555556, 1.0623427758941266, 2.5922865013774103, 1.078369905956113, 6.0, 60.857142857142854, 1.0, 1.7, 1.0576629442232268, 1.0, 1.0799532132085685, 1.0194425247638792, 1.087967873920291, 1.0, 1.6666666666666667, 1.0, 1.0294117647058822, 2.5, 2.0, 1.0, 1.2774352651048089, 4.0, 1.4545454545454546, 1.5, 1.0, 1.0714285714285714, 1.3333333333333333, 1.7, 1.0, 1.0, 17.0, 1.0, 1.0283140283140284, 1.0, 1.0, 1.0, 1.0, 1.1312533549797719, 20.0, 7.0, 1.421738154053447, 1.0, 3.0, 1.0, 1.0, 1.0201699611281119, 1.6, 39.0, 1.0, 1.0, 1.0454258440738402, 1.0604247104247104, 1.0, 1.2222222222222223, 1.1538461538461537, 2.0, 1.0, 1.6382113821138211, 1.0252890173410405, 1.0, 1.9082308420056764, 2.814814814814815, 1.0, 1.0, 1.1407035175879396, 1.4, 9.0, 1.0, 1.0304840996556612, 1.3360937773371435, 1.4, 1.6619718309859155, 4.0, 1.0, 1.0, 1.0, 1.0593556255717045, 2.0, 1.0, 1.3517017828200972, 7.0, 1.0, 1.1923076923076923, 1.0, 1.0, 1.1967213114754098, 1.6666666666666667, 1.7, 3.591549295774648, 1.198329853862213, 1.0, 6.0, 2.0, 1.0, 1.0, 1.0531787054717852, 1.0, 1.0, 1.1433370660694289, 1.5081967213114753, 1.0, 1.0, 1.0, 1.0, 1.0432098765432098, 9.0, 1.040899241603467, 1.0109860157753623, 1.0, 3.0, 1.0016420361247949, 1.0, 1.0, 1.0, 2.4645362431800466, 1.0810810810810811, 1.0, 6.0, 1.2985856469355683, 1.2262443438914028, 1.266304347826087, 1.0, 1.1267852083923542, 2.0, 8.0, 1.04514263519054, 2.5, 1.0599022004889975, 1.0, 1.0, 1.0, 1.0783993054503973, 2.3333333333333335, 2.0, 8.333333333333334, 1.0, 9.0, 2.0, 1.4857142857142858, 1.5, 1.1959798994974875, 1.4937187136437864, 2.0, 2.0, 1.0, 1.030577576443941, 6.0, 20.0, 1.2990654205607477, 1.0, 1.146654208294401, 1.0936170212765957, 1.1923076923076923, 2.0, 9.0, 1.0, 1.0, 1.0, 7.0, 1.1544117647058822, 1.5245098039215685, 1.8333333333333333, 2.0, 1.0, 1.1486611265004616, 1.0, 11.0, 1.0471204188481675, 7.0, 1.0477239353891337, 7.0, 1.0, 1.3492063492063493, 2.0, 1.0017207825463486, 1.0, 1.0, 1.4828326180257512, 1.0, 1.0, 1.1629213483146068, 7.0, 7.0, 1.8, 1.2099184782608696, 1.8, 2.0, 2.2222222222222223, 1.4051724137931034, 1.0, 2.0310077519379846, 1.0, 2.7419354838709675, 1.0, 2.0, 1.0842877235282298, 4.6, 1.0198828982678703, 1.5, 1.0, 9.0, 2.6, 1.0, 1.0547945205479452, 2.0, 2.5, 1.3357512953367876, 1.0, 4.0, 1.0, 1.4173669467787116, 3.1875, 1.5, 1.04385222786238, 1.0, 8.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 5.0, 1.0, 1.1173184357541899, 1.00651362300421, 2.8421052631578947, 1.0, 1.0, 2.0, 3.0, 10.0, 7.0, 1.0, 1.0, 1.0, 1.0, 1.0289995478912355, 1.0, 7.0, 1.1015037593984962, 1.0, 1.0, 1.0, 64.5, 5.333333333333333, 1.0, 1.0, 1.0, 1.0, 1.375, 1.6145833333333333, 1.111246571167327, 1.5, 1.0, 1.0, 1.0234022958260698, 1.0, 1.0, 1.0, 1.2619047619047619, 1.0449784174708263, 1.0, 2.0, 2.6, 1.2272727272727273, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0082784644411074, 7.0, 2.0, 1.0485436893203883, 1.0, 1.0, 1.1024682124158565, 1.0, 1.0281954887218046, 1.0, 6.0, 2.0, 1.1014319809069213, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0110758675377958, 1.1194846763223174, 1.0, 7.0, 32.0, 1.0, 1.4, 1.6521739130434783, 1.0, 1.0, 1.0340564059223087, 1.0, 1.0, 6.0, 1.329268292682927, 1.4049586776859504, 2.24, 1.0396530359355638, 1.0, 1.3333333333333333, 1.5, 1.0, 1.0, 2.0, 3.95, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0091158136594451, 1.099119373776908, 4.256410256410256, 1.0, 8.0, 2.0, 2.1384615384615384, 1.0, 10.0, 7.0, 1.2456140350877194, 1.0374392084521213, 1.0, 1.0, 2.25, 2.0, 1.0, 2.0, 1.0, 1.0, 1.0, 1.3565891472868217, 1.0, 6.0, 4.0, 1.0837881219903691, 1.5, 1.0, 2.0, 1.219895287958115, 1.0232747690635755, 1.0, 7.0, 1.005911330049261, 1.05, 1.1258741258741258, 4.5, 6.0, 1.0, 1.3275523560209423, 1.1587689301416708, 2.4290679991310014, 6.0, 1.0, 9.0, 1.0303907380607815, 1.0, 1.0344827586206897, 1.0, 1.0, 1.064516129032258, 6.0, 3.0, 1.0, 1.0, 1.0792189679218969, 1.8505747126436782, 1.0704519119351101, 1.0, 1.0, 3.0, 6.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 3.0, 1.0841836734693877, 1.0, 1.1282256344636383, 5.0, 1.0, 1.0, 1.155700652938222, 1.0, 8.0, 9.0, 1.063401187446989, 1.1624975507804847, 1.3666210670314638, 1.0, 6.0, 4.5, 1.0, 1.0, 1.0, 1.0, 1.2697160883280758, 1.0, 1.0, 2.0, 1.0, 1.160216718266254, 1.1116038433111604, 7.0, 1.0, 1.3352272727272727, 1.434782608695652, 2.0, 1.0789473684210527, 1.0, 1.0, 1.0, 1.0, 1.0, 3.2, 2.0, 7.0, 1.1935483870967742, 1.1660797455412928, 1.0909090909090908, 1.0, 1.41, 1.0, 1.3333333333333333, 2.0, 3.0, 1.0, 1.0621296860291267, 2.5714285714285716, 1.0, 1.0, 1.1397979797979798, 1.0551041803171275, 1.0, 1.5, 7.0, 1.1914893617021276, 1.0, 1.156039441248973, 1.1, 1.0759103641456582, 1.6108108108108108, 1.4204742037244327, 1.0, 1.1406779661016948, 3.0, 1.0, 1.0, 1.0, 1.0, 1.1666666666666667, 9.0, 7.0, 3.0, 1.076086956521739, 1.0, 1.0, 1.0, 1.1555555555555554, 3.0, 1.0, 8.0, 1.5206286836935168, 1.8214285714285714, 7.0, 1.0, 1.1395610579628588, 2.0, 1.0, 1.2857142857142858, 1.0, 1.0, 1.0, 1.8255813953488371, 2.6, 1.0, 1.375, 1.1202076570171438, 6.0, 1.0, 10.0, 1.11244019138756, 1.0, 1.2905276541640178, 1.0, 1.0, 1.0, 10.0, 1.4651851851851851, 1.0, 1.0, 1.0, 1.0, 1.2261904761904763, 6.0, 1.0, 1.0, 1.0, 1.0, 2.238095238095238, 1.0, 1.0, 1.5, 1.0, 2.175604007071302, 3.0, 1.3290322580645162, 1.0, 1.101123595505618, 1.0, 7.0, 5.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.060897435897436, 1.095435684647303, 2.0, 1.1250157102279867, 2.0, 1.0, 1.0, 1.0061046511627907, 1.0, 1.1926345609065157, 1.3183704262542437, 1.0, 1.0, 1.2222222222222223, 1.1578947368421053, 1.4, 7.0, 1.1261380640070275, 3.0, 1.5457774907153237, 1.8493150684931507, 1.0, 10.0, 1.0, 1.0, 1.4782608695652173, 1.0, 11.0, 1.0, 1.5, 1.5, 1.0, 1.0, 10.0, 1.0250943815234288, 1.09040824975279, 1.0, 1.0, 2.0588235294117645, 1.0847457627118644, 1.0, 2.0, 1.2054442967783328, 1.2, 2.5, 1.326086956521739, 1.0, 1.0, 1.0, 3.5, 1.0, 1.0704178123532961, 2.0, 1.0, 1.3333333333333333, 1.6304347826086956, 1.446808510638298, 1.2424242424242424, 1.14, 4.0, 1.0291033339867068, 1.0, 1.0400964537989887, 1.002403778964139, 7.0, 1.1094101477210347, 6.0, 1.0333333333333334, 2.0, 1.0, 1.4104367740880093, 2.0, 7.0, 1.0, 1.0270989882255488, 1.0, 1.0174147657591366, 4.333333333333333, 1.0, 6.0, 1.5390835579514826, 1.0, 1.0, 1.4, 1.1116517977831846, 12.0, 2.342857142857143, 1.0476190476190477, 1.1669698072026191, 3.0, 1.061876982565974, 1.0, 1.0, 1.0, 1.0]
origin-forest_39.80 	max: 210.0000	99th: 17.0300	95th: 7.0000	median: 1.0909	mean: 2.5750

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 13/15 | Workload-time: 28.738110 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 14/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=valueskew', '--dataset=forest', '--drift_test=distribution', '--end2end', '--update_size=25000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
ValueSample - START
ValueSample - END
load_npy_dataset_from_path - df.shape = (756012, 10)
Parsing... done, took 0.1s
Data updated!
Previous data size: (731012, 10), new data size: (25000, 10)
[ 0.0000000e+00  5.9604645e-08  5.9604645e-08  1.7881393e-07
  1.7881393e-07  5.9604645e-08  0.0000000e+00 -5.9604645e-08
  2.8979778e-04  5.9604645e-08]
Distance score: 2.9033422833890654e-05
SAUCE Drift detection: True
Detection latency: 0.1000s

DRIFT-DETECTED after 14-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=forest', '--end2end', '--model=transformer', '--model_update=adapt', '--update_size=25000', '--epochs=40']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
update_size: 25000
AdaptTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (756012, 10)
Parsing... done, took 0.1s
done, took 0.1s
dataset size: 756012
train data shape: torch.Size([25000, 10]), transfer data shape:torch.Size([5000, 10])
Epoch 0 Iter 0, train entropy gap 17.7316 bits (loss 36.574, data 18.842) 0.00300 lr
epoch 10 train loss 21.2525 nats / 30.6609 bits
time since start: 5.8 secs
Epoch 10 Iter 0, train entropy gap 11.6590 bits (loss 30.501, data 18.842) 0.00256 lr
epoch 20 train loss 19.8984 nats / 28.7074 bits
time since start: 11.4 secs
Epoch 20 Iter 0, train entropy gap 9.9542 bits (loss 28.797, data 18.842) 0.00150 lr
epoch 30 train loss 19.3776 nats / 27.9559 bits
time since start: 17.1 secs
Epoch 30 Iter 0, train entropy gap 9.0221 bits (loss 27.864, data 18.842) 0.00044 lr
epoch 40 train loss 19.2854 nats / 27.8230 bits
time since start: 22.7 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 39.0348 nats / 56.3153 bits
Saved to: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
AdaptTask - END

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 14/15 | Workload-time: 2.314999 | Model-update-time: 25.739595


WORKLOAD-START | Type: QueryWorkload | Progress: 15/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=forest', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
data size: 756012, total size: 756012, split index: [630010 756012]
Parsing... done, took 0.1s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
query_seed:0
origin-forest_39.80 	max: 70.0000	99th: 13.0100	95th: 8.0000	median: 1.1209	mean: 2.4192
ReportEsts: [1.0, 1.186268409043767, 1.0, 1.1594202898550725, 2.6666666666666665, 1.0, 1.8285714285714285, 1.0, 2.2162790697674417, 1.0, 1.3043478260869565, 2.588235294117647, 1.0, 2.0, 22.333333333333332, 1.4533333333333334, 1.0, 8.0, 3.625, 1.2586206896551724, 1.0, 1.1578947368421053, 1.0, 1.0, 1.0821052631578947, 1.0, 1.5454545454545454, 4.0, 8.0, 2.0652173913043477, 9.0, 1.0, 1.0, 1.0, 1.0, 7.0, 1.0, 1.2222222222222223, 1.0, 1.2, 2.0, 1.0, 1.205128205128205, 1.0, 1.016260162601626, 1.2191235059760956, 1.0, 3.0, 1.0625, 1.0, 3.0, 1.4472895668755108, 1.0, 1.0, 1.7761557177615572, 7.0, 1.0437074556531045, 5.0, 8.0, 12.0, 1.0061601642710472, 5.0, 6.0, 1.0, 4.666666666666667, 3.3421052631578947, 8.0, 1.0, 1.1304347826086956, 1.0, 1.0, 1.1677018633540373, 1.079202522343124, 8.4, 1.0, 1.027972027972028, 12.0, 1.0, 1.0, 1.0, 8.0, 2.3529411764705883, 1.0, 1.0228661561049164, 2.5, 1.0036220883343612, 8.0, 1.2682926829268293, 1.5, 1.0, 1.0, 2.0709893795416434, 1.0, 1.0, 1.0385115576624575, 1.0, 1.3699309749784296, 8.0, 1.1130922058074375, 16.0, 2.568, 1.0, 5.0, 2.0, 1.0, 1.158371040723982, 1.4, 1.0135135135135136, 1.5, 1.4331266607617361, 1.0, 1.1875, 1.1, 1.0, 1.3333333333333333, 1.6666666666666667, 1.0, 2.0, 1.0, 1.0, 1.0, 1.625, 1.0, 1.0, 2.2, 1.1563636363636363, 1.32, 13.0, 1.3725490196078431, 2.0, 2.0, 1.05326360643037, 1.0, 1.0, 1.0, 1.0632810950208291, 1.611967361740707, 2.0, 1.2202937249666221, 1.0, 1.0784190872409212, 4.0, 1.0, 1.4772727272727273, 1.6956521739130435, 1.0, 1.0, 1.351763584366063, 1.1087662865126555, 8.0, 1.0, 9.0, 1.035376488079547, 1.0, 1.0, 1.75, 13.0, 8.0, 1.0, 1.0, 4.0, 1.0, 1.0, 1.0, 2.6666666666666665, 1.8452380952380953, 1.0, 1.1496062992125984, 4.0, 1.0906720084662485, 7.0, 1.3333333333333333, 8.3, 1.3037974683544304, 1.0, 1.0, 1.296116504854369, 1.0, 1.2829252117643513, 1.0786914235190097, 1.0, 1.040416092091852, 4.0, 1.2636388811963446, 1.0, 1.4615384615384615, 1.0, 1.0, 1.0, 3.0, 1.0, 1.1717156568686262, 1.0, 1.0, 1.0627503337783712, 1.1658813846410765, 1.0, 1.6413793103448275, 1.1075110456553756, 2.0, 1.0298507462686568, 2.095890410958904, 1.0670487106017192, 1.0, 1.0, 7.0, 1.0, 1.3888888888888888, 1.0, 1.0, 1.0, 7.0, 1.3073979591836735, 1.4782608695652173, 1.0392156862745099, 2.3, 1.0, 13.0, 1.2456140350877194, 1.0, 1.0, 1.0, 1.0, 8.0, 1.866852886405959, 1.0, 1.25, 2.0, 1.0, 1.0, 1.0141345978478935, 1.0829234703915012, 1.5862068965517242, 1.0, 1.0645635212134448, 1.0, 15.0, 1.0, 1.0, 1.8181818181818181, 7.0, 70.0, 1.0, 2.0, 1.0, 1.0653794940079893, 1.1056466302367942, 1.0, 3.0, 9.0, 1.0, 2.0, 4.857142857142857, 1.0, 1.3119777158774373, 10.0, 6.0, 8.0, 1.5, 2.478723404255319, 1.0, 1.497797356828194, 1.0993860908341224, 2.5714285714285716, 1.0, 1.218487394957983, 1.3966101694915254, 4.0, 1.0, 1.023680273562727, 1.0721649484536082, 5.25, 1.0, 1.6, 1.0, 1.0, 1.0, 1.394736842105263, 3.0, 2.1911222780569513, 1.1714285714285715, 1.0, 1.0498106612292455, 1.0, 1.0256410256410255, 1.1617819460726846, 17.0, 1.0, 1.5, 1.3932346723044398, 1.0233482871125612, 1.0308668046345961, 2.5, 1.2475728155339805, 8.0, 1.0, 1.7653944020356234, 1.0, 1.3045112781954886, 12.0, 1.8076923076923077, 1.0, 1.0, 1.037174721189591, 1.3333333333333333, 1.0, 1.0, 1.2857142857142858, 1.0048602933304784, 1.2108579738245273, 2.7341040462427744, 3.6666666666666665, 1.0909090909090908, 1.0, 1.3333333333333333, 1.0, 1.0, 1.2857142857142858, 2.0, 2.0, 1.0833333333333333, 8.0, 1.0, 1.0, 1.0, 9.0, 1.0, 1.3846153846153846, 1.0, 1.0, 1.028665615594095, 3.5, 1.0, 1.0220319955094022, 8.0, 1.0, 1.0, 1.0, 1.5888888888888888, 2.0, 3.0, 4.5, 1.0, 2.5, 8.0, 1.2659574468085106, 1.481818181818182, 1.0, 1.0714183688044565, 2.522727272727273, 1.0, 1.1290322580645162, 1.5, 8.0, 1.6666666666666667, 9.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.1029411764705883, 11.0, 1.0246913580246915, 1.0892561983471074, 1.0, 7.0, 1.3905325443786982, 1.011126564673157, 1.0184933473724513, 1.5778301886792452, 1.0697988175072417, 1.1428571428571428, 1.016538502054145, 1.7790834312573442, 1.1866666666666668, 7.0, 4.217821782178218, 1.0, 1.7073170731707317, 1.0124605197539758, 1.0, 1.1174151477498855, 1.084561087687716, 1.0067439978419206, 1.0, 1.6666666666666667, 2.0, 1.2453703703703705, 5.0, 2.0, 1.0, 1.0587064676616915, 4.5, 1.565217391304348, 1.0, 1.0, 1.0909090909090908, 1.1666666666666667, 9.5, 1.0, 1.0, 8.0, 1.0, 1.0, 1.0, 8.0, 1.0, 1.0, 1.0, 2.0, 1.0898876404494382, 1.0, 1.0194952003261555, 1.5, 1.0, 1.6666666666666667, 1.0, 1.0049661244619623, 1.8, 2.5875, 1.0, 1.0, 1.02860531138822, 1.1019315801722132, 1.0, 11.0, 3.2, 2.0, 2.0, 1.9514925373134329, 1.0109963269054179, 1.0, 2.083677685950413, 2.235294117647059, 1.0, 1.0, 1.3905325443786982, 2.0344827586206895, 11.0, 1.0, 1.1600382620212648, 1.3480964242982956, 1.2, 2.278688524590164, 1.75, 1.0, 1.0, 1.0, 1.1321816694581857, 3.0, 1.0, 1.4099746407438716, 8.0, 1.0, 1.1206225680933852, 1.0, 1.0, 1.0068027210884354, 1.6666666666666667, 1.3076923076923077, 1.4739884393063585, 1.0356662180349934, 1.0, 7.0, 2.0, 1.0, 1.0, 1.0858626460165377, 1.0, 1.0, 1.0740365111561867, 1.3556338028169015, 12.0, 1.0, 11.0, 1.0, 1.0, 1.0, 9.0, 1.0394546466332777, 1.052925875608867, 1.6657608695652173, 1.0062893647489741, 1.3461538461538463, 1.0, 2.0, 8.0, 1.0, 1.13259808048493, 1.1875, 1.5, 2.0, 2.1004588499463046, 1.2678571428571428, 1.0, 1.121099947117927, 1.0, 1.1267937054856398, 1.0, 13.0, 1.0, 1.0, 1.0, 1.0870489150566354, 1.2763397739701057, 2.0, 4.166666666666667, 1.0, 10.0, 2.0, 1.6774193548387097, 1.3333333333333333, 1.3478260869565217, 1.3877942251823159, 2.0, 2.0, 1.0, 1.0283842794759825, 7.0, 20.0, 1.3063063063063063, 1.0, 1.0180282785632935, 1.6415094339622642, 1.103448275862069, 1.0, 10.0, 1.0, 1.0, 8.0, 1.11787072243346, 1.1274490785645004, 1.7884615384615385, 2.1551724137931036, 1.0, 1.0, 4.0, 1.7647058823529411, 1.0, 1.0, 8.0, 1.4461538461538461, 1.0, 1.0, 1.7, 1.0035073627023863, 1.6703296703296704, 3.9477611940298507, 2.1724137931034484, 1.275, 2.5, 1.4375, 1.0215749730312838, 8.0, 12.0, 1.0098039215686274, 1.5236180904522614, 1.25, 2.0, 5.25, 1.3412698412698412, 1.0, 1.191304347826087, 1.0, 6.066666666666666, 1.0, 1.5, 1.0734442647749205, 1.2, 1.004731938143324, 1.3728813559322033, 1.0, 5.0, 1.6, 1.0, 1.6493506493506493, 2.4444444444444446, 2.2857142857142856, 1.3823056300268097, 1.0, 4.0, 1.0, 1.1526548672566372, 4.384615384615385, 1.1904761904761905, 1.0228156598392533, 1.0, 9.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 5.0, 2.0, 1.4784688995215312, 1.0310584285096533, 1.7851239669421488, 1.0, 1.0, 8.0, 1.4166666666666667, 9.0, 2.481981981981982, 2.032051282051282, 1.71875, 8.0, 1.0, 1.0, 1.0087073828795683, 1.0, 8.0, 1.206627680311891, 1.0, 1.0, 1.0, 11.0, 1.6666666666666667, 2.582089552238806, 1.0, 1.0, 1.0, 3.6666666666666665, 2.44954128440367, 1.1350872007094295, 1.5, 1.0, 1.0, 1.0435431235431236, 1.0, 15.0, 1.0, 1.1904761904761905, 1.0520278489886528, 1.0, 1.0, 2.1666666666666665, 1.205651491365777, 1.0, 16.0, 2.5, 1.0, 1.0, 1.2075791350869371, 8.0, 2.0, 1.0826017557861134, 1.0, 1.0, 1.1262986351599105, 1.0, 1.4426094137076797, 1.0, 6.0, 1.8, 1.217241379310345, 1.0, 1.0, 1.0, 2.0, 1.0, 1.029745844575464, 1.115840118430792, 1.0, 8.0, 6.4, 1.0, 7.0, 3.558139534883721, 1.0, 1.0, 1.0631658595641647, 1.0, 1.0, 7.0, 2.5348837209302326, 1.0330578512396693, 1.293103448275862, 1.1160409556313993, 1.0, 1.1666666666666667, 3.0, 1.0, 1.0, 2.0, 1.2189054726368158, 1.0, 1.0, 1.0, 1.0, 1.5, 1.0, 1.000739970466377, 1.0307347058249585, 2.990990990990991, 1.0, 9.0, 2.0, 1.6352941176470588, 1.0, 11.0, 8.0, 1.1549237742068397, 1.0920039100684262, 1.0, 1.0, 5.0, 2.0, 1.0, 3.0, 1.0, 1.0, 1.0, 1.015209125475285, 1.0, 7.0, 4.0, 1.127431906614786, 1.0923076923076922, 1.0, 4.0, 1.121212121212121, 1.003476693278393, 1.0, 8.0, 1.1808272778088318, 5.666666666666667, 1.4337349397590362, 1.0, 1.4963768115942029, 1.096774193548387, 1.0, 1.1116991508736536, 1.0, 1.0, 3.0, 3.5, 1.3333333333333333, 1.0771812080536913, 1.0, 2.0, 1.6363636363636365, 1.0403096636412172, 7.0, 1.0, 2.6769230769230767, 7.0, 1.0, 1.25, 1.0, 1.0, 1.0, 2.0436893203883497, 12.0, 1.0, 2.75, 1.0, 1.6666666666666667, 2.4545454545454546, 1.0, 1.0, 9.0, 1.8123957754307949, 1.0, 4.714285714285714, 1.2413793103448276, 1.0, 1.2424242424242424, 1.0, 1.125, 1.4630086313193589, 1.0, 3.0, 4.666666666666667, 1.061462814996927, 1.1354622061711968, 1.0585412667946257, 1.0, 7.0, 2.5, 1.0, 1.0, 1.0, 2.0, 1.1350632069194944, 11.0, 1.0, 2.0, 1.0, 1.0060422960725075, 1.0327974276527332, 8.0, 1.0, 1.384180790960452, 1.5454545454545454, 2.0, 1.0864197530864197, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 3.5, 8.0, 1.086092715231788, 1.0950186526223393, 1.0909090909090908, 1.0, 1.8041958041958042, 1.0, 1.0357142857142858, 1.0, 3.0, 1.0, 1.0240597205642517, 2.5714285714285716, 1.0, 1.0, 1.1277758797403485, 1.142567665364018, 2.0, 1.3333333333333333, 8.0, 1.7234042553191489, 1.0, 1.0803231939163498, 3.090909090909091, 1.010909090909091, 1.0398009950248757, 1.187090739008419, 1.0, 1.002911208151383, 1.3333333333333333, 1.0, 1.0, 1.0, 1.0, 1.0714285714285714, 11.0, 8.0, 1.0, 1.1443298969072164, 1.0, 1.0, 1.0, 2.1995661605206074, 3.0, 1.0, 3.0, 1.0170827858081473, 1.1388888888888888, 7.0, 1.0, 1.3358851674641148, 1.8333333333333333, 1.0, 1.45, 1.0, 1.0, 1.0, 2.6129032258064515, 2.9, 1.0, 3.0, 1.0419939694330491, 7.0, 1.0, 10.0, 1.28175519630485, 12.0, 1.1598159509202455, 1.0, 1.0, 16.0, 2.128941176470588, 1.0, 1.0, 1.0, 4.0, 2.0, 1.0764195668570198, 1.0, 1.0, 1.0666666666666667, 1.0, 1.0, 1.5849056603773586, 1.0, 1.0, 2.1666666666666665, 1.0, 2.858366935483871, 3.0, 1.1066666666666667, 1.0, 1.0520833333333333, 1.0, 8.0, 2.5, 1.0, 1.0, 1.0, 2.0, 1.0, 1.21875, 1.3370328056144933, 2.0, 1.0679536590431793, 1.2826086956521738, 8.0, 3.302325581395349, 3.0, 1.4, 7.0, 1.6545454545454545, 1.0, 1.0648148148148149, 1.0, 7.0, 1.0, 1.0, 1.147285663464959, 3.0, 1.5480572597137015, 1.4025974025974026, 1.0, 12.0, 1.0, 1.0, 1.2678571428571428, 1.0, 12.0, 1.0, 6.0, 1.5, 1.0, 1.0, 12.0, 1.0584638489594507, 1.0092650557155378, 1.0, 1.0, 2.533333333333333, 1.003717472118959, 1.0, 2.0, 1.2966577935522035, 3.6666666666666665, 2.5, 1.1403508771929824, 1.0, 1.75, 1.0, 4.0, 1.0, 1.0418933623503808, 2.0, 1.0, 1.3333333333333333, 2.0547945205479454, 1.3611111111111112, 1.1, 1.7647058823529411, 2.0, 1.032158372871709, 1.0, 1.0064569689143068, 1.0559719264191807, 8.0, 1.072474520056653, 6.0, 2.4615384615384617, 1.0, 1.0, 1.2685008091805208, 2.0, 8.0, 1.0, 1.0190796548016212, 1.0, 1.0557880055788005, 4.666666666666667, 1.0, 7.0, 1.2692307692307692, 1.0, 4.5, 1.5555555555555556, 1.0280594199481254, 14.0, 2.0, 1.1818181818181819, 1.161085653859711, 1.5, 1.0767828801646406]
origin-forest_39.80 	max: 70.0000	99th: 13.0100	95th: 8.0000	median: 1.1209	mean: 2.4192

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 15/15 | Workload-time: 28.826715 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=7, #drift=7 | total-time=424.560605