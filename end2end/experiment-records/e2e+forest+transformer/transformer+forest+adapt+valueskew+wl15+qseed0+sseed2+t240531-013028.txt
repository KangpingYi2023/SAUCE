Input arguments = Namespace(data_update='valueskew', update_size=25000, dataset='forest', debug=False, drift_test='distribution', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=15)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-2'}, 'random_seed': 2, 'transformer': {'epochs': 40}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/forest/end2end/forest.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=forest', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
load_csv_dataset - forest (581012, 10)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
query_seed:0
origin-forest_39.80 	max: 11.0000	99th: 4.6012	95th: 2.2683	median: 1.0089	mean: 1.3174
ReportEsts: [1.0, 1.1315848971286457, 1.0, 1.372093023255814, 1.3333333333333333, 1.0, 1.1260997067448681, 1.0, 1.1188405797101448, 1.0, 1.098360655737705, 1.0, 1.0, 1.0, 2.0, 1.0180657469914882, 1.0, 1.1111111111111112, 1.1521739130434783, 1.0, 1.0, 3.0, 1.1111111111111112, 1.4, 1.4, 1.0, 1.0945375173625875, 1.4444444444444444, 1.5, 2.5608856088560885, 1.0, 1.114119922630561, 1.4, 1.0, 1.1982758620689655, 1.0482689353657095, 1.0, 1.0, 1.0479302832244008, 1.0, 2.0, 1.0, 1.8888888888888888, 1.0, 1.5974025974025974, 1.1090909090909091, 1.0, 1.0, 1.0, 1.0, 3.0, 1.139060742407199, 1.0, 1.0, 1.7222222222222223, 1.0603015075376885, 1.631828978622328, 2.2666666666666666, 1.0, 1.0, 1.0996587030716725, 2.5, 1.0, 1.4310502283105022, 1.2229299363057324, 1.0, 1.2746666666666666, 1.1477272727272727, 1.2530120481927711, 1.0, 2.0, 1.0, 1.1764705882352942, 1.4425608086764241, 1.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0699204090890346, 3.5, 1.8571428571428572, 1.0, 1.0, 1.0, 1.1681532475306795, 1.0, 1.6, 1.069767441860465, 1.0, 1.1796464405160056, 1.0, 1.0, 1.0699976431769973, 1.3906581740976645, 1.0, 1.0, 1.5, 1.0, 1.0, 1.0, 1.2275862068965517, 1.0, 1.0, 1.0, 1.0543478260869565, 1.0, 1.0352112676056338, 1.0, 1.0, 1.301582069874753, 1.2142857142857142, 2.0, 1.0, 2.0, 1.0, 1.0, 1.0, 1.0, 3.0, 1.0, 1.0131826741996233, 1.0, 1.0, 1.1111111111111112, 1.0, 1.0, 1.0, 1.0507173420588976, 1.1357428919678616, 1.0, 1.25, 1.0, 1.0, 2.0, 1.03351042092358, 1.1746031746031746, 1.1226211252389262, 1.0, 1.0, 5.0, 1.0, 1.110122740240714, 1.0, 1.2666666666666666, 1.5, 1.1538461538461537, 1.0285714285714285, 1.0, 1.0, 1.0, 1.0, 1.25, 1.0, 1.0, 1.0, 1.6666666666666667, 1.7777777777777777, 1.0, 1.0194552529182879, 4.0, 1.007847584486278, 1.0, 1.3333333333333333, 1.0, 1.0566343042071198, 1.0, 1.0, 1.0, 1.015267175572519, 1.3181818181818181, 1.0, 1.0, 1.209125475285171, 1.0, 1.149438202247191, 1.0, 7.133333333333334, 1.0, 1.0, 1.0927952974819286, 1.0, 1.0310880829015545, 1.0, 1.0, 1.162162162162162, 1.0998816968058138, 1.0, 1.0818181818181818, 2.3, 1.0, 1.0, 1.0, 1.0, 1.1666666666666667, 1.125, 1.346997482919813, 1.0581174984207202, 1.3333333333333333, 1.0, 1.0, 2.0, 3.0, 1.036764705882353, 1.0, 1.0, 1.0, 1.0, 1.2941176470588236, 1.0, 1.3333333333333333, 1.0, 1.0, 1.0, 1.0238095238095237, 1.0, 2.0, 1.0, 1.1835815047021943, 1.5, 1.0, 1.15, 1.0, 1.3125, 1.0, 1.1330203442879498, 1.0, 1.0, 1.0, 1.2222222222222223, 1.0, 4.333333333333333, 1.0, 2.0, 1.5, 1.072561706206566, 1.0102788127971218, 1.0, 4.0, 3.0, 1.0552820901173798, 1.0343007915567282, 1.5, 1.0, 1.0097087378640777, 10.0, 1.1601027397260273, 1.0, 1.6666666666666667, 1.1595092024539877, 1.0, 1.2878787878787878, 1.255688622754491, 2.0714285714285716, 2.0, 1.3277310924369747, 1.0483460559796438, 2.0, 1.0, 1.3457737129370113, 1.25, 2.0, 1.0, 1.1428571428571428, 1.0, 1.0, 1.0, 1.236842105263158, 1.5, 1.0145586897179253, 2.0, 1.0, 1.0939651032495599, 1.0, 1.0, 1.0869565217391304, 1.0, 1.0, 1.0, 1.4444444444444444, 1.0, 1.0, 1.0, 2.0, 1.0, 1.6228070175438596, 1.0, 1.1111111111111112, 1.0, 1.0, 1.0, 1.0, 1.0130023640661938, 1.7184466019417475, 1.085862324204293, 1.348314606741573, 1.0, 1.356048387096774, 1.0, 1.0, 3.0, 1.0, 1.2246376811594204, 1.0, 2.0, 1.0, 1.173913043478261, 1.0, 1.0, 1.1666666666666667, 1.5, 1.0, 1.0, 1.0, 1.0, 1.0, 1.6363636363636365, 1.0, 1.0, 1.332254584681769, 1.5, 1.0, 1.0731613400077011, 1.0, 1.0, 1.0, 1.0, 1.2021371326803205, 2.0, 3.0, 1.0, 1.5, 1.372093023255814, 1.0, 1.0731707317073171, 1.079268292682927, 1.0, 1.2748560460652592, 1.4054054054054055, 1.0, 1.5909090909090908, 1.5, 1.1428571428571428, 10.0, 3.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0357142857142858, 11.0, 1.4074074074074074, 1.5, 1.0, 1.0, 1.0, 1.0390143737166324, 1.2, 1.7727272727272727, 1.121957903968428, 1.1352856078207882, 1.470019035532995, 1.02941274552306, 1.2452830188679245, 1.0, 2.5892018779342725, 1.0, 1.0349413298565842, 1.0013373990263734, 1.0, 1.025443824101374, 1.0488991295442909, 1.0938897815607764, 1.0, 1.6666666666666667, 1.0, 1.0666666666666667, 1.0, 1.0, 1.0672645739910314, 5.3431372549019605, 1.0, 4.722222222222222, 1.0, 1.024758536253571, 1.0, 10.0, 1.0769230769230769, 1.0, 1.0, 4.25, 1.0, 1.025943396226415, 1.0, 1.0, 1.0, 1.0, 1.0410524886468218, 1.0, 2.0, 1.076086956521739, 1.9937106918238994, 1.2938931297709924, 1.165780570323828, 1.104417670682731, 1.0844583763758773, 1.1799410029498525, 11.0, 1.0, 1.0, 1.1231131196421915, 1.1032609941105025, 1.0, 1.2222222222222223, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.1126640045636051, 2.5, 1.2387041773231031, 1.0, 1.0, 1.0, 1.116083916083916, 1.0679822857586823, 2.5, 1.2741194486983154, 2.5454545454545454, 1.0, 1.0, 1.0, 1.028715023858599, 2.0, 1.0, 1.1013189448441247, 1.0, 1.8095238095238095, 1.0, 1.0, 1.0, 1.0599912612875035, 1.0, 1.0, 1.5, 1.3333333333333333, 1.1627906976744187, 1.0089418777943369, 1.75, 1.0, 1.0, 1.4266666666666667, 1.25, 2.0, 1.0890885750962773, 1.0, 1.625, 1.0, 1.0, 1.0909090909090908, 1.0, 1.0, 1.5555555555555556, 1.030386142186936, 1.077801018552201, 1.65625, 1.3666666666666667, 1.0, 1.0, 1.25, 1.0, 1.1062043397666557, 1.0625, 1.0, 1.0, 1.4501845018450183, 1.0267379679144386, 1.0, 1.009835200422194, 1.4, 2.0, 1.0356705270671966, 2.5, 1.0001640689089417, 1.0, 1.0, 1.0, 1.0211891042430592, 1.7857142857142858, 2.0, 1.28, 1.0, 2.0, 1.0, 1.0576923076923077, 1.0, 1.1523178807947019, 1.1371672364922123, 2.0, 1.0, 1.0, 1.1082390953150243, 2.0, 2.15, 1.2409638554216869, 1.0, 1.0639220979560355, 1.5142857142857142, 1.12, 1.0, 4.6, 1.0, 2.0, 1.0521497466078142, 1.5, 4.0, 1.1644542772861357, 1.25, 1.0, 1.034617878647522, 1.0, 1.4, 1.0, 2.0, 1.0, 1.1385767790262171, 1.0, 1.0, 1.4285714285714286, 1.0419733306630619, 1.345132743362832, 1.5253012048192771, 1.1, 1.4109589041095891, 2.0, 1.5833333333333333, 1.062111801242236, 1.0, 1.0, 1.1666666666666667, 1.2834728033472804, 1.25, 2.0, 1.1428571428571428, 1.1495327102803738, 1.0, 1.2384105960264902, 1.0, 1.0199004975124377, 1.0, 2.0, 1.028208586199146, 6.0, 1.0143736130724228, 2.0, 1.0, 3.0, 1.0, 1.0, 2.0, 1.066718995290424, 1.0, 1.0, 1.0, 1.0, 1.0, 1.1538461538461537, 2.0, 2.023529411764706, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 1.5133333333333334, 1.2195121951219512, 2.0, 1.2333333333333334, 1.0, 1.0, 2.3333333333333335, 1.0095501797337996, 2.357142857142857, 1.0, 1.0, 1.0, 1.0, 1.0182382924498248, 1.0, 1.0, 1.065743944636678, 1.1531463229719485, 1.2553191489361701, 2.0, 1.0, 1.0, 1.0, 1.5, 2.0, 1.0, 1.0, 1.0910714285714285, 4.0, 1.0641870350690754, 1.0, 1.0, 1.0274141414141413, 1.0, 1.0, 1.0, 1.3548387096774193, 1.0334192383911875, 1.0, 2.0, 1.625, 1.081858407079646, 1.0, 1.0, 1.5, 1.0, 1.0, 1.052127454755487, 1.0, 2.0, 1.004047619047619, 1.0, 1.0, 1.0363326018044379, 1.0, 1.0450804102823856, 1.0, 1.0, 1.021097046413502, 1.035849706997587, 2.2222222222222223, 1.625, 1.0, 1.0, 2.0, 1.0088610495760446, 1.0, 1.0, 1.0, 1.0, 1.2, 1.0, 1.0, 1.5, 1.1592356687898089, 1.0, 1.0, 1.0, 1.0, 1.0, 1.2857142857142858, 1.158974358974359, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.4, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0160379596678528, 3.4583333333333335, 1.0, 2.0, 1.5, 1.0107913669064748, 1.0, 1.0, 1.0, 2.0, 1.0, 1.007936507936508, 1.0326086956521738, 1.4848484848484849, 1.2206235011990407, 1.0, 1.6428571428571428, 1.0, 1.36, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0855340953882537, 1.625, 1.0, 4.0, 1.0296296296296297, 1.1534653465346534, 1.0, 1.0, 1.2730109204368174, 1.0475314320760503, 1.1865671641791045, 1.0, 1.0, 1.0, 1.0740868998390745, 1.0, 1.125, 1.0, 1.0, 1.3333333333333333, 1.160609613130129, 1.0, 1.0, 1.1333333333333333, 2.0, 1.0, 1.5, 1.2333333333333334, 1.0, 1.0097244732576987, 1.0415442719261434, 1.0, 1.0, 1.0, 3.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 2.0, 3.0, 1.0142045454545454, 1.0, 1.0269226076700964, 1.0, 1.0, 1.2777777777777777, 1.0338645418326693, 1.5, 1.0, 1.0, 1.0, 1.0, 1.1785714285714286, 1.0779816513761469, 3.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.024083769633508, 1.0, 1.0, 1.0, 1.0, 1.1160377358490565, 1.018181818181818, 1.0, 1.0, 1.12987012987013, 1.0, 2.0, 1.2289156626506024, 1.0, 1.0, 1.0, 1.0, 1.0, 1.6, 2.0, 1.0, 1.1732522796352585, 1.2556797692030293, 1.3333333333333333, 1.0, 1.0, 1.0, 1.0, 1.4, 1.0, 1.0, 1.0873087308730873, 1.0, 1.0, 2.357142857142857, 4.0, 1.0588235294117647, 1.0, 1.3080895008605853, 1.1, 1.0, 2.0, 1.0, 1.1851851851851851, 1.114864864864865, 1.0, 1.118421052631579, 1.0, 1.3181818181818181, 1.0, 1.0, 2.0, 1.1428571428571428, 1.0, 1.0, 1.0, 1.5, 1.0309278350515463, 1.0, 1.0, 1.0639417239983813, 1.0832315556158683, 1.0, 1.0, 1.0, 1.0091824644549763, 1.0, 2.1390374331550803, 1.0, 1.1121656600517689, 2.0, 1.0, 1.0769230769230769, 1.5, 1.6666666666666667, 1.1018970189701898, 1.0, 3.4615384615384617, 1.0, 2.0, 1.0, 1.0, 2.0, 1.0, 2.0, 1.6666666666666667, 1.0, 1.0, 1.3333333333333333, 1.0, 1.125, 1.0, 4.0, 1.0, 1.3333333333333333, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.1114614614614615, 2.0, 1.0, 1.0, 1.0, 1.0, 1.125, 2.5, 1.0, 1.1851145038167938, 1.0, 1.2522407170294494, 1.0, 1.4324142568930733, 1.0, 1.162162162162162, 1.3636363636363635, 1.8461538461538463, 3.0, 1.0, 1.0555555555555556, 1.021261415525114, 1.0, 1.0, 1.0198135198135199, 1.0, 1.0, 1.0, 2.0, 1.020386000118043, 1.0, 1.8571428571428572, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 3.0, 2.0, 1.0, 1.0, 1.0, 1.0293479832297239, 1.0083889590474473, 1.0, 1.0, 1.1428571428571428, 1.0386740331491713, 1.0, 2.0, 1.1508135644768855, 1.0588235294117647, 1.2173913043478262, 1.0, 1.0, 1.0, 1.5, 3.2142857142857144, 1.0, 1.2473664642458793, 1.0, 1.0, 1.2330708661417322, 1.0, 1.6666666666666667, 1.0, 1.0, 1.2, 1.0107913669064748, 1.0, 1.5, 1.0263157894736843, 1.0393233308242165, 1.0, 1.3571428571428572, 1.0, 1.0, 1.2132915796798887, 2.0, 1.75, 1.0, 1.1475409836065573, 1.0, 1.4236172080772607, 1.5, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.2439024390243902, 1.0, 1.2855755220981058, 1.0, 1.0933701830972646, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0135135135135136, 1.0452698125987807, 2.0, 1.0016129032258065, 1.0, 1.1110677591364286, 1.0, 2.0, 1.11864406779661, 1.2540983606557377, 1.0, 1.0, 1.0, 1.2292171105730427, 1.0, 1.0, 1.2696629213483146, 2.0, 1.0]
origin-forest_39.80 	max: 11.0000	99th: 4.6012	95th: 2.2683	median: 1.0089	mean: 1.3174

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/15 | Workload-time: 28.088437 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=valueskew', '--dataset=forest', '--drift_test=distribution', '--end2end', '--update_size=25000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
ValueSample - START
ValueSample - END
load_npy_dataset_from_path - df.shape = (606012, 10)
Parsing... done, took 0.0s
Data updated!
Previous data size: (581012, 10), new data size: (25000, 10)
[ 2.3841858e-07  5.9604645e-08  5.9604645e-08  5.3644180e-07
  1.1920929e-07 -5.9604645e-08  1.1920929e-07  1.3113022e-06
  4.6628714e-04  5.9604645e-08]
Distance score: 4.687309410655871e-05
SAUCE Drift detection: True
Detection latency: 0.0596s

DRIFT-DETECTED after 2-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=forest', '--end2end', '--model=transformer', '--model_update=adapt', '--update_size=25000', '--epochs=40']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
update_size: 25000
AdaptTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (606012, 10)
Parsing... done, took 0.1s
done, took 0.1s
dataset size: 606012
train data shape: torch.Size([25000, 10]), transfer data shape:torch.Size([5000, 10])
Epoch 0 Iter 0, train entropy gap 29.3258 bits (loss 48.532, data 19.206) 0.00300 lr
epoch 10 train loss 22.5967 nats / 32.6001 bits
time since start: 6.6 secs
Epoch 10 Iter 0, train entropy gap 13.2448 bits (loss 32.451, data 19.206) 0.00256 lr
epoch 20 train loss 20.9684 nats / 30.2510 bits
time since start: 13.2 secs
Epoch 20 Iter 0, train entropy gap 11.0211 bits (loss 30.227, data 19.206) 0.00150 lr
epoch 30 train loss 20.3592 nats / 29.3722 bits
time since start: 19.7 secs
Epoch 30 Iter 0, train entropy gap 10.2400 bits (loss 29.446, data 19.206) 0.00044 lr
epoch 40 train loss 20.2586 nats / 29.2270 bits
time since start: 26.4 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 44.6940 nats / 64.4798 bits
Saved to: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
AdaptTask - END

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/15 | Workload-time: 2.196510 | Model-update-time: 29.560513


WORKLOAD-START | Type: QueryWorkload | Progress: 3/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=forest', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
data size: 606012, total size: 606012, split index: [505010 606012]
Parsing... done, took 0.1s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
query_seed:0
origin-forest_39.80 	max: 46.0000	99th: 7.1434	95th: 3.0000	median: 1.0315	mean: 1.5820
ReportEsts: [1.0, 1.198227410289667, 1.0, 1.1923076923076923, 1.6, 1.0, 1.5118110236220472, 1.0, 1.9095744680851063, 1.0, 1.6829268292682926, 2.0, 1.0, 2.0, 3.0, 1.1994884910485935, 1.1811023622047243, 1.0, 1.0892857142857142, 1.380952380952381, 1.0, 3.0, 4.0, 1.6666666666666667, 1.6666666666666667, 1.0, 1.0201834406303596, 1.1875, 3.0, 3.017391304347826, 1.0, 1.25, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 1.1666666666666667, 1.0, 1.0, 1.3532219570405728, 5.0, 1.0428772544368203, 1.0, 1.1123188405797102, 2.0, 1.0, 7.2, 1.0, 1.5, 1.0554210691196992, 1.0, 1.0, 18.0, 1.0382775119617225, 2.8508771929824563, 1.15625, 1.0, 1.0, 1.2546036829463572, 1.4545454545454546, 1.0, 1.0662931839402428, 1.2098765432098766, 1.0, 1.1272365805168987, 1.6290322580645162, 1.3038461538461539, 1.0, 2.0, 1.0, 1.0163265306122449, 1.0316501821967725, 1.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0179139303388969, 3.5, 1.35, 1.0, 1.0, 2.0, 1.5846139252513753, 1.0, 2.0, 4.0, 1.1505426646706587, 2.74, 27.5, 1.35, 1.0, 1.0, 2.0, 1.092783505154639, 1.0, 1.1598559185194386, 1.0, 1.3172413793103448, 1.0, 1.0, 1.0197088068181819, 1.011795189545429, 1.0, 1.0, 1.063973063973064, 2.0, 1.3653846153846154, 1.0, 1.0, 2.174559471365639, 2.0631578947368423, 1.5, 1.0, 2.0, 1.0, 1.0, 1.0, 2.0, 3.0, 1.0, 1.8544819557625145, 2.3333333333333335, 1.0, 1.3333333333333333, 1.0, 1.0, 2.0, 1.1932876712328768, 1.0671584895506323, 2.0, 1.0, 1.0, 2.0, 2.0, 1.1254355400696865, 1.5, 1.0219378427787935, 1.0, 1.0, 1.6666666666666667, 1.0, 1.354229374743467, 1.0, 1.032258064516129, 1.8461538461538463, 1.1818181818181819, 1.125, 1.0, 1.0, 1.0, 1.0, 4.0, 1.0, 1.0, 1.0, 1.3333333333333333, 2.1875, 1.0, 1.0082632211538463, 2.0, 1.0976693093896266, 1.0, 1.2, 13.0, 1.2903726708074534, 1.0, 1.0, 4.176470588235294, 1.0, 1.608405111477377, 1.2404799165362546, 1.0, 7.142857142857143, 1.1316348195329087, 1.0, 1.0, 2.4285714285714284, 7.133333333333334, 1.0, 1.0, 1.057852246763138, 1.0, 1.192801072180739, 1.0, 1.0, 1.8695652173913044, 1.340835217637083, 1.0, 1.3149171270718232, 3.8333333333333335, 1.0, 1.0, 1.0, 1.0, 1.1891891891891893, 1.6, 1.0794218857536133, 1.1717857142857142, 1.6666666666666667, 2.0, 1.0, 1.0, 1.0, 1.194915254237288, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.25, 1.0, 1.0, 1.0, 1.261802575107296, 1.0, 1.0, 1.0, 1.4719785575048734, 3.0, 1.0, 1.2105263157894737, 1.0, 1.0238095238095237, 1.0, 1.0441176470588236, 1.0, 1.0, 1.0, 5.5, 1.0, 2.4, 1.0, 2.0, 1.0, 1.1194467069633187, 1.156467570538659, 1.0, 2.0, 1.5, 1.0208480565371025, 1.0445544554455446, 1.3333333333333333, 1.0, 1.194053208137715, 2.4, 5.0, 1.0, 2.0, 1.4154929577464788, 1.0, 1.2676470588235293, 1.7946084724005136, 1.4285714285714286, 1.0, 1.002028397565923, 1.3376623376623376, 1.1428571428571428, 1.0, 1.0712157832611995, 1.75, 1.3333333333333333, 1.0, 1.6, 1.0, 1.0, 1.0, 1.3333333333333333, 1.5, 1.9711255156157925, 2.0, 1.0, 1.1578947368421053, 1.0, 1.631578947368421, 1.3321799307958477, 1.0, 1.0, 3.5, 1.0419753086419754, 1.1136363636363635, 1.0244342291371995, 2.5, 1.0, 1.0, 1.3636363636363635, 2.1344621513944224, 1.0, 3.2439024390243905, 1.0, 1.0794701986754967, 1.0, 1.0, 1.5, 2.0, 1.0, 1.0, 1.2518518518518518, 1.0, 1.25, 1.0, 1.0, 1.32, 1.0, 1.0, 1.0, 1.0, 2.076923076923077, 2.0, 1.0, 1.4615384615384615, 3.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.375, 1.0, 1.0, 1.0572623159425558, 1.5, 1.0, 1.0459750372151608, 1.0, 1.0, 1.0, 1.0, 1.0313216195569137, 2.0, 3.0, 1.0, 1.5, 1.027906976744186, 2.257346393588602, 1.058139534883721, 2.514792899408284, 1.0, 1.0790655884995508, 1.3703703703703705, 1.0, 1.4583333333333333, 1.5, 2.6666666666666665, 10.0, 2.0, 1.0, 1.0, 3.0, 1.0, 1.0, 1.2314049586776858, 2.2, 1.653061224489796, 6.0, 1.0, 1.0, 1.0, 1.1536842105263159, 1.0833333333333333, 1.509090909090909, 1.0255376344086022, 1.0271835429361684, 1.1622188905547226, 1.0360108219050284, 1.2116788321167884, 1.0, 1.443661971830986, 1.0, 1.0493230174081238, 1.0069237870550827, 1.0, 1.0116111326132085, 1.018400644856436, 1.1388282214414585, 1.0, 3.5, 1.0, 1.0375, 6.0, 2.0, 2.0, 1.082512315270936, 1.0, 4.0, 2.0, 1.0, 1.8775510204081634, 1.0, 1.5, 1.0, 1.0, 5.666666666666667, 1.0, 1.100498338870432, 1.0, 1.0, 1.0, 1.0, 1.012077532692389, 1.0, 2.0, 1.0170212765957447, 1.0801787592008412, 1.3146666666666667, 1.1145475372279496, 1.478494623655914, 1.0189588030334085, 1.2820512820512822, 4.4, 1.0, 1.0, 1.0232215095098676, 1.0199171054105522, 1.0, 3.6666666666666665, 2.0, 2.0, 1.0, 2.5833333333333335, 1.0643146013158689, 1.0, 1.95635305528613, 3.8, 1.0, 1.0, 1.1176470588235294, 1.6363636363636365, 1.0, 1.0, 1.0375521557719054, 1.3130193905817173, 1.25, 1.008955223880597, 2.3333333333333335, 1.0, 1.0, 1.0, 1.0810705469663506, 1.0, 1.0, 1.2860447185813415, 1.0, 2.111111111111111, 1.0, 1.0, 1.0, 1.1087989107731344, 1.0, 1.0, 2.0, 1.9090909090909092, 1.2201834862385321, 1.028169014084507, 1.0, 1.319693094629156, 1.0, 1.0, 1.0518864547537228, 1.0, 1.0, 1.7158590308370043, 1.0, 2.3333333333333335, 1.0, 1.0, 1.2, 1.0, 1.0, 1.8888888888888888, 1.1550127713920817, 1.0482305413412336, 1.109271523178808, 1.5555555555555556, 1.0, 1.0, 1.1818181818181819, 1.0, 1.0358031368307192, 1.5483870967741935, 1.5, 1.5, 1.040590405904059, 1.3691756272401434, 1.0, 1.1152023494337775, 1.25, 2.0, 1.043160103533121, 2.5, 1.0272097890838834, 1.0, 1.0, 1.0, 1.1218921378157047, 1.875, 2.0, 1.1363636363636365, 1.0, 2.0, 2.0, 1.75, 1.5, 1.0134228187919463, 1.700283216352666, 2.0, 2.0, 1.0, 1.1286713286713286, 2.0, 20.0, 1.1685393258426966, 1.0, 1.092423689650979, 7.064516129032258, 1.1304347826086956, 1.0, 2.2, 2.0, 1.0, 1.0504082914572865, 1.5, 4.0, 1.2310137760508655, 2.4, 1.0, 1.3236833810268422, 1.0345839938934884, 2.782608695652174, 1.0, 1.0, 1.0, 1.0090744101633393, 1.0, 1.0, 1.0, 1.022587552669752, 1.4074074074074074, 2.9655172413793105, 3.4285714285714284, 1.1666666666666667, 2.0, 1.3421052631578947, 1.0083798882681565, 1.0, 1.0, 1.4482758620689655, 1.0069984447900466, 2.5, 2.0, 3.0, 1.016, 1.0, 1.324607329842932, 1.0, 1.1440217391304348, 1.0, 2.4, 1.0187160168903286, 6.0, 1.1198505869797226, 3.5, 1.0, 3.0, 1.0619469026548674, 1.0, 1.5, 2.5714285714285716, 1.4360902255639099, 1.4227373068432672, 1.0, 1.0, 1.0, 1.0190023752969122, 1.3333333333333333, 2.2, 1.0, 1.0136986301369864, 1.0, 1.4666666666666666, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.8846153846153846, 1.26, 1.6666666666666667, 1.1345454545454545, 1.0, 1.0, 1.1428571428571428, 1.0011004896246212, 4.0212765957446805, 1.0, 1.0, 1.0, 1.0, 1.0274674474150551, 1.0, 1.0, 1.1762048192771084, 1.0, 1.0, 1.0, 5.0, 3.0, 1.0, 1.0, 1.0, 1.0, 1.1, 1.1278409090909092, 1.0703571428571428, 1.0, 1.0, 1.0, 1.0164244003060208, 1.0, 1.0, 1.0, 1.0952380952380953, 1.383060850941963, 1.0, 3.0, 2.1666666666666665, 1.2230919765166341, 1.0, 1.0, 1.5, 1.0, 1.0, 1.0605764055389735, 1.0, 2.0, 1.0682535827058537, 1.0, 1.0, 1.1090909090909091, 1.0, 1.1356305995864922, 1.0, 1.0, 1.702054794520548, 1.0671974522292993, 4.35, 13.2, 1.0, 1.0, 4.0, 1.061881369601877, 1.0, 1.0, 1.0, 1.0, 1.6666666666666667, 1.0, 1.0, 1.0, 1.5855631611698817, 1.0, 1.0, 1.0, 1.0, 1.0, 1.1176470588235294, 2.237623762376238, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.25, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0811062630669939, 1.1448275862068966, 1.0, 2.0, 5.5, 1.3865336658354115, 1.0, 3.0, 1.0, 2.0, 1.0, 1.018176400476758, 1.0212765957446808, 2.75, 1.185376142488868, 1.0, 46.0, 1.0, 1.1363636363636365, 1.0, 1.75, 1.0, 1.0, 1.0, 1.06007326007326, 1.0, 1.0, 4.0, 1.2887323943661972, 1.0235704932343954, 1.0, 1.0, 1.1021992238033635, 1.1281373844121532, 1.0923076923076922, 1.5, 1.0, 1.0, 1.6256374594343996, 1.0, 1.3333333333333333, 1.0, 1.0, 1.5, 1.1792559188275085, 1.0, 1.0, 2.5, 1.0, 1.0, 3.0, 1.32, 1.0, 1.2451698867421719, 1.0117004680187207, 1.0, 1.0, 8.5, 1.0853122131023993, 3.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.1009627894873797, 1.0010004679608204, 1.8823529411764706, 1.0, 1.127321175784828, 1.0, 1.0, 1.2762124711316398, 1.0, 1.1090909090909091, 1.0369480467817647, 2.25, 1.232662192393736, 1.1731008717310087, 2.0, 6.0, 1.2214228617106315, 1.430012610340479, 3.0, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0138613861386139, 1.0, 1.0, 1.0, 1.0, 1.4063694267515923, 1.2903225806451613, 1.0, 1.0, 1.3909774436090225, 1.2857142857142858, 2.0, 1.046242774566474, 1.0, 1.0, 1.0, 1.0, 1.0, 2.2857142857142856, 2.0, 1.0, 1.0582822085889572, 1.1578443877551021, 1.4444444444444444, 1.0, 1.0, 1.0, 1.0, 1.2, 1.0, 1.0, 1.4707190511489994, 1.0, 2.0, 1.1379310344827587, 4.0, 16.13888888888889, 1.0, 1.6094182825484764, 1.0909090909090908, 1.0, 1.22, 2.029850746268657, 1.0, 1.9174639015984314, 1.0, 1.75, 1.0, 1.0, 1.0, 1.0, 2.0, 1.1666666666666667, 1.0, 1.0, 1.0, 1.0, 1.7540983606557377, 1.0, 1.0, 1.0492554410080184, 1.152964147729633, 1.0, 1.0, 1.0, 1.4592568797515795, 1.0, 2.36318407960199, 1.0, 1.0456896551724137, 2.0, 3.0, 1.5, 1.3333333333333333, 1.6666666666666667, 1.1646947468054898, 1.0, 1.0408163265306123, 1.0, 1.5, 1.25, 1.0, 1.5, 1.0, 4.0, 5.0, 1.0, 1.0, 1.0, 1.0, 1.4444444444444444, 1.0, 1.3333333333333333, 1.0, 2.5, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.1536030937558952, 2.0, 1.0, 1.0, 1.0, 1.0, 1.3206106870229009, 1.5, 1.0, 1.4210526315789473, 1.0, 1.6555829228243022, 1.0, 1.0830298616168974, 2.0, 1.0714285714285714, 2.59375, 1.8571428571428572, 1.0, 1.0, 1.0635838150289016, 1.2453371592539455, 1.2, 1.6, 1.3473684210526315, 1.0, 1.8620689655172413, 1.0, 1.0, 1.0, 1.0, 1.0212947360647704, 1.2950596496256224, 1.9617834394904459, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 6.0, 2.0, 1.0, 1.0, 1.0, 1.04104578704958, 1.1728161148783407, 1.0, 1.0, 2.2857142857142856, 1.0302267002518892, 1.0, 2.0, 1.4223760341750933, 1.5, 1.2427536231884058, 1.0, 1.0, 1.0, 2.0, 1.8, 1.0, 1.0237800031791449, 1.0, 1.0, 1.0596379126730564, 1.0, 1.936046511627907, 1.0, 3.0, 2.0, 1.1389830508474577, 1.0, 2.0, 2.8607594936708862, 1.1329470198675498, 1.0, 1.6, 2.0, 1.0, 1.3749003348748206, 2.0, 2.3333333333333335, 1.0, 1.2364341085271318, 1.0, 1.1389452332657202, 1.5, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.7741935483870968, 1.0, 1.7227047146401986, 3.0, 1.0370906168374523, 1.0, 1.0, 1.0, 1.0, 1.0, 6.0, 1.1111111111111112, 1.0, 1.0, 2.0, 1.037344398340249, 1.0, 1.1, 1.2941176470588236, 1.514018691588785, 2.0]
origin-forest_39.80 	max: 46.0000	99th: 7.1434	95th: 3.0000	median: 1.0315	mean: 1.5820

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/15 | Workload-time: 27.460876 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 4/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=valueskew', '--dataset=forest', '--drift_test=distribution', '--end2end', '--update_size=25000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
ValueSample - START
ValueSample - END
load_npy_dataset_from_path - df.shape = (631012, 10)
Parsing... done, took 0.1s
Data updated!
Previous data size: (606012, 10), new data size: (25000, 10)
[ 5.9604645e-08  5.9604645e-08  5.9604645e-08 -2.9802322e-08
  5.9604645e-08  5.9604645e-08  5.9604645e-08  1.7881393e-07
  4.0811300e-04 -2.9802322e-08]
Distance score: 4.0858983993530273e-05
SAUCE Drift detection: True
Detection latency: 0.0831s

DRIFT-DETECTED after 4-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=forest', '--end2end', '--model=transformer', '--model_update=adapt', '--update_size=25000', '--epochs=40']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
update_size: 25000
AdaptTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (631012, 10)
Parsing... done, took 0.1s
done, took 0.1s
dataset size: 631012
train data shape: torch.Size([25000, 10]), transfer data shape:torch.Size([5000, 10])
Epoch 0 Iter 0, train entropy gap 17.3733 bits (loss 36.555, data 19.182) 0.00300 lr
epoch 10 train loss 21.8756 nats / 31.5599 bits
time since start: 6.7 secs
Epoch 10 Iter 0, train entropy gap 12.2347 bits (loss 31.417, data 19.182) 0.00256 lr
epoch 20 train loss 20.6155 nats / 29.7419 bits
time since start: 13.3 secs
Epoch 20 Iter 0, train entropy gap 10.5224 bits (loss 29.705, data 19.182) 0.00150 lr
epoch 30 train loss 20.0855 nats / 28.9772 bits
time since start: 19.8 secs
Epoch 30 Iter 0, train entropy gap 9.7521 bits (loss 28.934, data 19.182) 0.00044 lr
epoch 40 train loss 19.9895 nats / 28.8388 bits
time since start: 26.4 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 42.3778 nats / 61.1382 bits
Saved to: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
AdaptTask - END

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 4/15 | Workload-time: 2.233153 | Model-update-time: 29.461101


WORKLOAD-START | Type: QueryWorkload | Progress: 5/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=forest', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
data size: 631012, total size: 631012, split index: [525843 631012]
Parsing... done, took 0.1s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
query_seed:0
origin-forest_39.80 	max: 214.0000	99th: 7.4397	95th: 4.0000	median: 1.0378	mean: 1.8495
ReportEsts: [2.0, 1.263877381938691, 1.0, 1.0317460317460319, 1.3333333333333333, 1.0, 1.170731707317073, 1.0, 1.1394101876675604, 1.0, 1.126984126984127, 4.0, 1.0, 1.0, 1.0746268656716418, 1.032967032967033, 1.0, 2.0, 1.3111111111111111, 1.4375, 1.0, 3.0, 1.1764705882352942, 1.0, 1.25, 1.0, 1.0195596102407336, 1.2857142857142858, 3.0, 1.6926829268292682, 1.0, 1.3333333333333333, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.7199191102123357, 1.0, 1.066308388556651, 1.0, 3.3402061855670104, 1.0, 1.0, 36.0, 1.0, 3.0, 1.039356282179152, 1.0, 1.0, 1.6363636363636365, 1.120603015075377, 1.0340030911901081, 1.1764705882352942, 1.0, 1.6666666666666667, 1.0487951807228915, 1.3333333333333333, 1.0, 1.0567879325643301, 1.2108433734939759, 1.0, 1.081593927893738, 1.2023809523809523, 1.125925925925926, 1.0, 2.0, 1.0, 1.2149532710280373, 1.1103688643624745, 1.0, 1.5, 1.0, 1.0, 1.0, 4.0, 1.0, 1.0, 1.0100444827091404, 7.0, 4.666666666666667, 1.0, 1.0, 1.3333333333333333, 1.6342203091371552, 1.0, 1.2222222222222223, 5.0, 1.129572498898193, 1.625, 2.037037037037037, 1.6111111111111112, 1.0, 1.0, 2.0, 1.0164654226125138, 6.0, 1.2287581699346406, 1.0, 3.4727272727272727, 1.0, 1.0, 1.0829340213785477, 1.0112732095490715, 1.0, 3.0, 1.0625, 1.0, 1.2136752136752136, 1.0, 1.0, 1.6740144128868164, 1.1329479768786128, 4.0, 1.0, 2.0, 1.0, 1.0, 1.0, 2.0, 3.0, 1.0, 2.7898423817863396, 1.1666666666666667, 1.0, 1.125, 1.0, 1.0, 3.0, 1.0921797806964695, 1.0359989122931788, 1.0, 1.3333333333333333, 1.0, 3.0, 2.0, 1.2008076358296622, 1.6578947368421053, 1.0087844661674195, 1.0, 1.0, 2.5, 1.0, 1.4065242104515259, 1.0, 1.1176470588235294, 1.3333333333333333, 1.0, 1.0161450571286637, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 1.3333333333333333, 1.5833333333333333, 2.0, 1.1410653200847043, 4.0, 1.1463566634707574, 1.0, 3.0, 13.2, 1.1865008880994672, 1.0, 1.0, 2.9186046511627906, 1.0, 1.525023409393327, 1.4213986849970113, 1.0, 1.45413870246085, 1.170731707317073, 1.0, 2.0, 2.2857142857142856, 214.0, 1.0, 1.0, 1.0181820841378504, 1.0, 1.0537948967983097, 1.0, 1.0, 3.0714285714285716, 1.2343304202807321, 1.0, 2.2037037037037037, 3.8333333333333335, 1.0, 1.0, 1.0, 1.0, 1.4210526315789473, 1.6, 1.1827367205542725, 1.0023571007660577, 3.0, 3.0, 1.0, 1.0, 2.0, 1.7848101265822784, 1.0, 1.0, 1.0, 4.0, 1.935483870967742, 1.0, 1.0, 1.0, 1.0, 1.0, 1.3585657370517927, 1.0, 1.0, 1.0, 2.162133142448103, 3.0, 1.0, 1.3142857142857143, 1.0, 1.4, 2.0, 1.0028881310105386, 1.1275740833751884, 1.4444444444444444, 1.0, 5.5, 2.0, 5.2727272727272725, 1.0, 1.0, 1.0, 1.0704656862745099, 1.037689327227897, 1.0, 4.0, 3.0, 1.0, 2.0, 2.125, 1.0, 1.0740242261103634, 5.0, 5.5, 2.0, 1.3333333333333333, 1.092783505154639, 1.0, 1.297709923664122, 1.5707865168539326, 1.4285714285714286, 5.0, 1.0754716981132075, 1.615686274509804, 1.3, 1.0, 1.077302810024954, 1.2, 2.0, 1.0, 1.3333333333333333, 1.0, 1.0, 1.0, 1.4827586206896552, 1.5, 1.1232370718603089, 2.115, 1.0, 1.009433962264151, 1.0, 1.8571428571428572, 1.5, 1.0, 1.0, 2.0, 1.135857461024499, 1.072538860103627, 1.0054677856296652, 1.5, 1.0, 1.0, 1.1333333333333333, 1.4286971830985915, 1.0, 2.8297872340425534, 1.0, 1.0397350993377483, 1.0, 1.0, 1.9047619047619047, 1.5, 1.0, 1.0, 1.280701754385965, 1.0, 2.5, 1.0, 1.0, 1.4444444444444444, 1.0, 1.0, 1.0, 1.0, 2.076923076923077, 1.0, 1.0, 1.5714285714285714, 4.0, 1.0, 1.0, 1.0, 1.0, 1.0, 5.0, 1.0, 1.0, 1.2252385653175386, 3.0, 1.0, 1.0979692645444565, 1.0, 1.0, 1.0, 1.0, 1.0135135135135136, 4.0, 3.0, 1.0, 1.5, 3.5833333333333335, 2.1771385314155944, 1.0444444444444445, 1.1917808219178083, 1.0, 1.1917877661372085, 1.7619047619047619, 1.0, 1.8421052631578947, 1.3333333333333333, 2.6666666666666665, 10.0, 3.5, 1.0, 1.0, 5.0, 1.0, 1.0, 1.016, 11.0, 1.1571428571428573, 6.0, 1.0, 1.0, 2.0, 1.0154905335628228, 1.875, 1.0363636363636364, 1.0272891747914363, 1.189909979300053, 1.1568320773496374, 1.0497473766031868, 1.3786407766990292, 1.0, 1.5053003533568905, 1.0, 1.6818181818181819, 1.0166139954853273, 1.0, 1.0135040771275396, 1.0192024818806664, 1.0587504508475936, 1.0, 4.5, 1.0, 1.2790697674418605, 7.0, 2.0, 2.0, 1.0337078651685394, 1.2, 2.25, 2.0, 1.0, 1.4601769911504425, 1.25, 2.5, 1.0, 1.0, 2.125, 1.0, 1.1299342105263157, 1.0, 1.0, 1.0, 1.0, 1.0282222588804575, 1.0, 2.6666666666666665, 1.584664536741214, 2.033137359700695, 1.3227771010962242, 1.284304047384008, 1.5895953757225434, 1.0204825209256523, 1.7796143250688705, 1.3518518518518519, 1.0, 1.0, 1.0375080558539205, 1.033976665576273, 1.0, 3.6666666666666665, 3.0, 2.0, 1.0, 2.581699346405229, 1.0599912739965096, 1.0, 2.3701527614571094, 10.857142857142858, 1.0, 1.0, 1.0965909090909092, 1.625, 1.0, 1.0, 1.0514208389715831, 1.4391004836784689, 1.0, 1.0544412607449856, 2.0, 1.0, 1.0, 1.0, 1.0200774486347828, 1.0, 1.0, 1.8169934640522876, 1.0, 19.0, 1.0, 1.0, 1.0, 1.0849938231233196, 1.0, 1.0, 2.0, 1.5714285714285714, 1.0350877192982457, 1.161764705882353, 1.0, 1.3578947368421053, 6.0, 1.0, 1.05312096427034, 1.0, 1.0, 1.5061871616395979, 3.0, 3.0, 1.0, 1.1324558480506497, 1.0, 1.0, 1.0, 6.0, 1.0196740858505564, 1.1039886185685188, 1.4900284900284901, 1.6666666666666667, 1.0, 1.0, 1.5, 1.0, 1.128867527786122, 1.0909090909090908, 3.0, 2.0, 1.514760147601476, 1.1014084507042254, 1.0, 1.1871140602432335, 1.4, 2.0, 1.0019310128505474, 1.6666666666666667, 1.099406528189911, 1.0, 1.0, 1.0, 1.0963173808286484, 1.625, 2.0, 1.2, 1.0, 2.0, 3.0, 1.8269230769230769, 3.0, 1.1796875, 1.667140254218906, 2.0, 1.5, 1.0, 1.0333333333333334, 2.0, 20.0, 1.05, 1.0, 1.077737749758164, 1.1754385964912282, 1.0, 1.0, 1.0, 2.0, 1.0, 1.1037704371037704, 1.5, 4.0, 1.1271186440677967, 2.5, 1.0, 1.2819803529218368, 1.0053769340502579, 2.6153846153846154, 1.0, 1.0, 1.0, 1.0696798493408664, 1.0, 1.0, 1.2, 1.0044034117189957, 1.5670103092783505, 3.7966101694915255, 3.6538461538461537, 1.4216867469879517, 1.0, 1.1875, 1.0040160642570282, 1.0, 1.0, 1.4754098360655739, 1.0185597624350409, 5.0, 2.0, 2.25, 1.3829787234042554, 1.0, 1.0833333333333333, 1.0, 1.6536082474226803, 1.0, 2.4, 1.0098595600202032, 6.0, 1.0526432908414662, 2.3333333333333335, 1.0, 1.5, 1.2040816326530612, 1.0, 1.3157894736842106, 1.7272727272727273, 1.4039334341906202, 1.7442489851150202, 1.0, 1.0, 1.0, 1.4879725085910653, 1.1666666666666667, 2.2, 1.0, 1.1194029850746268, 1.0, 1.8563968668407311, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 3.425925925925926, 4.545454545454546, 2.25, 1.5023255813953489, 1.0, 1.0, 1.2222222222222223, 1.0125226015503321, 4.630769230769231, 1.0, 1.0, 1.0, 1.0, 1.0946766561514196, 2.0, 2.0, 1.525390625, 1.0, 1.0, 1.0, 14.5, 1.0, 1.0, 1.0, 1.0, 1.0, 1.375, 1.4735632183908045, 1.1751874573960464, 1.0, 1.0, 1.0, 1.0096922340035877, 1.0, 1.0, 1.0, 1.119047619047619, 1.5353726639389582, 1.0, 7.0, 1.625, 1.0806754221388368, 1.0, 1.0, 1.0, 1.0, 1.0, 1.1943062757963805, 1.0, 2.0, 1.0273297491039426, 1.0, 1.0, 1.1624463519313304, 1.0, 1.0785822548676693, 1.0, 1.0, 1.6537216828478964, 1.008849557522124, 1.65, 16.75, 1.0, 1.0, 4.0, 1.0341961356179366, 1.0, 1.0, 1.0, 1.0, 1.6, 1.0, 1.0, 1.0, 2.0351437699680512, 1.0, 1.0, 1.0, 1.5, 1.0, 1.1764705882352942, 1.6496350364963503, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 5.0, 1.0, 1.0, 1.0, 1.0, 1.0, 4.0, 3.0, 1.0, 1.0, 3.4285714285714284, 1.0, 2.0, 1.0, 1.0, 2.1515151515151514, 1.0, 1.0, 1.0, 1.300894266175697, 1.0462962962962963, 1.0, 4.073170731707317, 1.4782608695652173, 1.0, 1.04, 1.0, 2.6666666666666665, 1.0, 1.0, 2.0, 1.0190726734626767, 1.125, 1.0, 4.0, 1.0268456375838926, 1.0533694929130635, 1.0, 1.0, 1.220618556701031, 1.0378363228699552, 1.0728476821192052, 3.0, 1.0, 1.0, 1.5044283043731421, 1.0, 1.6, 1.0, 1.0, 1.0, 1.1645021645021645, 1.6666666666666667, 1.0, 3.0, 1.4333333333333333, 1.0788381742738589, 2.0, 1.5, 2.0, 1.0, 1.0603664521758098, 1.4037267080745341, 1.210987020827045, 1.0, 1.0, 3.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 2.5, 1.6266094420600858, 1.0, 1.0143827115426736, 1.0, 1.0, 1.0588235294117647, 1.2124645892351276, 3.0, 1.0, 1.0, 1.0, 1.0, 1.2727272727272727, 1.0547085201793722, 3.0, 1.0, 1.0, 3.0, 1.0, 1.0, 1.1318989710009355, 1.0, 1.0, 2.0, 1.0, 1.150087260034904, 1.0341426403641882, 1.0, 1.0, 1.2894736842105263, 1.3181818181818181, 2.0, 1.0944444444444446, 1.0, 1.0, 1.0, 1.0, 1.0, 1.1428571428571428, 2.0, 1.0, 1.1496815286624205, 1.151038222457347, 2.3333333333333335, 1.0, 1.0, 1.0, 1.0, 1.6, 1.0, 1.0, 1.5493619879113498, 1.0, 3.0, 1.375, 4.0, 3.388888888888889, 1.0, 1.2575757575757576, 1.0909090909090908, 1.0, 1.2692307692307692, 1.446808510638298, 1.0, 1.7027136904156928, 1.0, 1.400462962962963, 3.0, 1.0, 1.0, 1.0, 1.0, 1.1666666666666667, 1.0, 1.0, 1.0, 1.5, 1.1979166666666667, 1.0, 1.0, 1.0268448576409064, 1.3033422973492124, 1.0, 1.0, 1.0, 3.6255506607929515, 2.0, 7.413793103448276, 1.0, 1.0263051396195872, 2.0, 1.0, 1.3333333333333333, 1.3333333333333333, 1.6666666666666667, 1.076607387140903, 1.0, 2.789473684210526, 1.0, 1.0, 1.25, 1.0, 1.0, 1.0, 1.6, 5.0, 1.0, 1.0, 1.0, 1.0, 1.2, 1.0, 1.25, 1.0, 1.0673793782529188, 1.0, 1.0, 3.0, 1.0, 1.0, 4.666666666666667, 1.0, 3.0, 1.0, 1.0, 3.9474747474747476, 3.0, 1.290909090909091, 1.0, 1.5739130434782609, 1.0, 1.0, 2.5, 1.0, 1.0, 1.0, 2.0, 1.0, 1.8245614035087718, 1.0075605959528575, 1.0, 1.048498845265589, 1.3333333333333333, 1.403225806451613, 1.0, 1.130813953488372, 1.0, 5.8, 1.5445205479452055, 1.0, 1.0, 3.0, 2.0, 1.0666666666666667, 1.0, 1.0279099354599308, 1.5216146819884666, 1.5576923076923077, 2.0, 1.0, 2.0, 1.0, 3.0, 1.0, 1.0, 1.0, 6.0, 2.0, 1.0, 1.0, 1.0, 1.0875870894355182, 1.0529212531752752, 1.0, 1.0, 2.2857142857142856, 1.0785714285714285, 1.0, 2.0, 1.310090646478733, 3.0, 1.283720930232558, 1.0, 1.0, 1.0, 2.0, 4.5, 1.0, 1.0429920249335412, 1.0, 1.0, 1.068260701889703, 1.0, 1.1618497109826589, 3.0, 3.0, 2.0, 1.3398058252427185, 1.0, 2.0, 1.1341463414634145, 1.0898612288344405, 1.0, 2.25, 2.0, 1.0, 1.399448141535465, 2.0, 3.0, 1.0, 1.4595588235294117, 1.0, 1.2462772050400917, 1.5, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.2291666666666667, 1.0, 1.3376891334250345, 1.5, 1.0106852202423935, 1.0, 1.0, 1.0, 1.0, 1.0, 6.5, 1.3333333333333333, 1.0, 1.0, 2.0, 1.116182572614108, 1.0, 1.25, 1.2571428571428571, 3.109090909090909]
origin-forest_39.80 	max: 214.0000	99th: 7.4397	95th: 4.0000	median: 1.0378	mean: 1.8495

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 5/15 | Workload-time: 28.065378 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 6/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=valueskew', '--dataset=forest', '--drift_test=distribution', '--end2end', '--update_size=25000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
ValueSample - START
ValueSample - END
load_npy_dataset_from_path - df.shape = (656012, 10)
Parsing... done, took 0.1s
Data updated!
Previous data size: (631012, 10), new data size: (25000, 10)
[ 5.9604645e-08 -5.9604645e-08  1.1920929e-07  1.1920929e-07
  0.0000000e+00  0.0000000e+00  5.9604645e-08  5.9604645e-08
  3.6233664e-04  5.9604645e-08]
Distance score: 3.627538535511121e-05
SAUCE Drift detection: True
Detection latency: 0.0862s

DRIFT-DETECTED after 6-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=forest', '--end2end', '--model=transformer', '--model_update=adapt', '--update_size=25000', '--epochs=40']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
update_size: 25000
AdaptTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (656012, 10)
Parsing... done, took 0.1s
done, took 0.1s
dataset size: 656012
train data shape: torch.Size([25000, 10]), transfer data shape:torch.Size([5000, 10])
Epoch 0 Iter 0, train entropy gap 17.4971 bits (loss 36.629, data 19.132) 0.00300 lr
epoch 10 train loss 21.7100 nats / 31.3209 bits
time since start: 5.9 secs
Epoch 10 Iter 0, train entropy gap 12.1150 bits (loss 31.247, data 19.132) 0.00256 lr
epoch 20 train loss 20.4369 nats / 29.4841 bits
time since start: 11.7 secs
Epoch 20 Iter 0, train entropy gap 10.1624 bits (loss 29.294, data 19.132) 0.00150 lr
epoch 30 train loss 19.8964 nats / 28.7044 bits
time since start: 17.5 secs
Epoch 30 Iter 0, train entropy gap 9.5681 bits (loss 28.700, data 19.132) 0.00044 lr
epoch 40 train loss 19.8170 nats / 28.5899 bits
time since start: 23.2 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 41.2796 nats / 59.5538 bits
Saved to: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
AdaptTask - END

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 6/15 | Workload-time: 2.247039 | Model-update-time: 26.194991


WORKLOAD-START | Type: QueryWorkload | Progress: 7/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=forest', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
data size: 656012, total size: 656012, split index: [546676 656012]
Parsing... done, took 0.1s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
query_seed:0
origin-forest_39.80 	max: 45.0000	99th: 8.5050	95th: 4.1855	median: 1.0576	mean: 1.7600
ReportEsts: [1.0, 1.289515488482923, 1.0, 1.2173913043478262, 2.6666666666666665, 1.0, 1.2075471698113207, 1.0, 1.3298969072164948, 1.0, 1.0136986301369864, 5.0, 1.0, 1.5, 1.0671641791044777, 1.120879120879121, 1.0, 3.0, 6.2, 1.4705882352941178, 1.0, 2.0, 2.857142857142857, 1.2, 2.0, 1.0, 1.0205182319146442, 1.5384615384615385, 3.0, 1.3634577603143418, 1.0, 1.75, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 1.3333333333333333, 1.0, 2.0, 1.2510288065843622, 5.0, 1.0168781738305137, 1.0, 1.8852941176470588, 2.0, 1.0, 1.0277777777777777, 1.0, 3.0, 1.0460919750346016, 1.0, 1.0, 9.0, 1.1231527093596059, 1.6112412177985949, 1.0238095238095237, 1.0, 1.5714285714285714, 1.0682496800796246, 13.0, 3.0, 1.0, 1.0, 3.9310344827586206, 1.1156280428432328, 1.4285714285714286, 2.0, 4.0, 5.0, 4.299435028248587, 1.1114827201783724, 11.052631578947368, 1.0, 1.1538461538461537, 1.0, 1.0, 1.0, 1.0, 6.0, 1.0, 1.0, 1.0543374470768399, 7.0, 1.4137931034482758, 1.0, 1.0, 1.0, 1.4215811420304656, 1.0, 1.1714285714285715, 3.0, 1.1894905879204212, 1.6451612903225807, 27.5, 1.0, 2.0, 1.0, 1.6666666666666667, 4.0, 1.0, 1.1682888845629744, 3.0, 1.0, 1.0, 1.0, 1.0, 1.0028264300605534, 2.0, 1.0, 1.2028985507246377, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.089644513137558, 1.0, 1.0, 2.0, 3.0, 1.0, 1.023121387283237, 1.4285714285714286, 1.0, 1.5875099443118537, 1.0, 1.0, 4.0, 1.187839031159329, 1.0393400246380031, 3.0, 1.1428571428571428, 1.0, 4.0, 2.0, 1.1331010452961672, 1.4318181818181819, 1.0835330491575346, 1.0, 1.0, 1.0, 1.0, 1.4096290098622137, 1.0, 1.125, 2.0869565217391304, 1.2307692307692308, 1.0630437373376236, 1.0, 1.0, 1.0, 1.0, 1.3333333333333333, 1.0, 1.0, 1.0, 1.0, 2.7333333333333334, 3.0, 1.2367485182049112, 4.0, 1.0218419645427996, 1.0, 3.5, 7.571428571428571, 1.1552975326560233, 1.0, 1.0, 2.5166666666666666, 1.0, 1.4272295502758925, 1.2854054054054054, 1.0, 1.0000084808650482, 1.7916666666666667, 1.0058631921824104, 1.0, 4.0, 1.0, 1.0, 4.0, 3.0, 1.0, 1.0274643705463182, 1.0, 1.0, 1.2142857142857142, 1.1834516769789265, 1.0, 1.004201680672269, 1.6428571428571428, 1.0, 1.0, 1.0, 1.0, 1.4102564102564104, 2.0, 1.0738322451029634, 1.020954598370198, 1.75, 4.0, 1.0, 2.0, 2.0, 1.5, 1.0, 1.0, 1.0, 5.0, 1.525, 1.0, 1.0, 1.0, 1.0, 3.0, 1.5, 1.0, 2.5, 7.0, 1.0, 1.0, 1.1206453121346738, 1.2630830489192264, 1.5, 1.0, 1.006105526047751, 1.0, 1.0598290598290598, 1.3235294117647058, 3.1, 1.603883495145631, 1.1239669421487604, 1.0, 5.5, 4.0, 7.0, 1.0326721120186697, 1.1111111111111112, 4.0, 1.0, 1.0, 2.0, 1.375, 1.0, 1.2874806800618237, 1.0, 6.0, 3.0, 2.0, 1.5267857142857142, 1.0, 1.5044247787610618, 1.9054975011358473, 1.3571428571428572, 2.0, 1.0958646616541354, 1.9074074074074074, 1.0833333333333333, 1.0, 1.0304760061919505, 1.5, 4.0, 1.0, 1.3333333333333333, 1.0, 1.0, 1.0, 1.1794871794871795, 1.5, 1.7859049652963161, 1.8041666666666667, 1.0, 1.2387387387387387, 1.0, 1.2407407407407407, 1.4597902097902098, 1.0, 1.0, 2.25, 1.006276150627615, 1.0138248847926268, 1.0251770066882804, 1.5, 1.5957446808510638, 1.0, 2.5, 1.7365930599369086, 1.0, 2.607843137254902, 4.0, 4.17948717948718, 1.0, 1.0, 1.4666666666666666, 2.5714285714285716, 1.0, 1.0, 1.3109243697478992, 1.0, 1.2, 2.0, 1.0, 2.4545454545454546, 1.0, 1.5, 1.0, 1.0, 2.5714285714285716, 1.0, 1.0, 1.8, 5.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.75, 1.0, 1.0, 1.0115178289681288, 1.5, 1.0, 1.0170295776875626, 4.0, 1.0, 1.0, 1.0, 1.182962962962963, 1.0, 3.0, 4.0, 1.0, 2.388888888888889, 2.1655672823219, 1.0515463917525774, 1.4585635359116023, 1.0, 1.1735312899106003, 1.1935483870967742, 1.0, 1.2571428571428571, 1.0, 2.6666666666666665, 10.0, 4.0, 1.0, 1.0, 7.0, 1.0, 1.0, 1.3307692307692307, 11.0, 1.0657894736842106, 6.0, 1.0, 4.0, 1.4210526315789473, 1.623409669211196, 1.0073571641476375, 3.0, 1.0956450371022193, 1.6236559139784945, 1.0084130019120459, 2.903682719546742, 1.2610169491525425, 1.0, 2.2421052631578946, 1.0, 1.2127659574468086, 1.0156963081192503, 1.0, 1.0376482052947864, 1.0772874526992078, 1.0680159940640588, 1.0, 5.5, 1.0, 1.0617977528089888, 8.0, 2.0, 2.0, 1.0571725571725572, 1.1666666666666667, 2.25, 2.0, 1.0, 1.3228346456692914, 1.4444444444444444, 2.0, 1.0, 1.0, 8.5, 1.0, 1.1390887290167866, 1.0, 1.0, 1.0, 1.0, 1.0145960974102868, 1.0, 10.0, 1.155056179775281, 1.1835718730553828, 1.094170403587444, 1.3773708306082406, 1.0826771653543308, 1.0165119342092583, 1.6216931216931216, 2.566666666666667, 1.0, 1.0, 1.0083609599466232, 1.045422736815319, 1.0, 1.0909090909090908, 4.0, 2.0, 1.0, 1.8497109826589595, 1.0546351194104284, 1.0, 1.8555657773689052, 1.3289473684210527, 1.0, 1.0, 1.0441988950276244, 2.4705882352941178, 1.0, 1.0, 1.1139318885448917, 1.3889899357342064, 1.0, 1.099388379204893, 2.3333333333333335, 1.0, 1.0, 1.0, 1.1056843785204657, 1.6666666666666667, 1.0, 1.859531772575251, 1.0, 1.9, 1.0, 1.0, 1.0, 1.062279381584348, 1.0, 1.0, 2.0, 3.4285714285714284, 1.110236220472441, 1.2727272727272727, 1.0, 1.388340807174888, 8.0, 1.0, 1.0411021738774306, 1.0, 1.0, 1.6331236897274632, 4.0, 4.0, 1.0, 1.127642536835362, 1.0, 1.0, 1.0, 1.1428571428571428, 1.0689068770831915, 1.115777569801903, 1.6576576576576576, 2.210526315789474, 1.0, 1.0, 1.875, 1.0, 1.1035763557253528, 1.1162790697674418, 1.5, 2.0, 6.159090909090909, 1.0997506234413965, 1.0, 1.1103359683794467, 2.5, 2.0, 1.060408440218262, 2.5, 1.037716159809183, 1.0, 1.0, 1.0, 1.126545173604799, 1.4166666666666667, 3.0, 1.25, 1.0, 4.0, 5.0, 1.04, 1.0, 1.0633802816901408, 1.6118883829086328, 2.0, 2.5, 1.0, 1.0478654592496766, 2.0, 20.0, 1.0660377358490567, 1.0, 1.0362584954884595, 1.076271186440678, 1.3214285714285714, 1.0, 1.2, 3.0, 2.0, 1.0581039755351682, 1.0, 4.0, 1.3333333333333333, 1.45, 1.3, 1.0, 2.0, 1.6666666666666667, 1.6666666666666667, 1.0, 1.082701062215478, 2.0, 1.0, 1.6296296296296295, 2.0, 1.033209807508222, 1.0, 1.0, 1.1824077827320632, 2.0, 1.0, 1.3081761006289307, 1.75, 1.5, 1.1566265060240963, 1.7800711743772242, 5.0, 2.0, 1.125, 1.0, 1.0, 1.1256281407035176, 1.0, 1.2736572890025575, 1.0, 1.7142857142857142, 1.0021122636774302, 1.1428571428571428, 1.0485788070222664, 1.5, 1.0, 3.0, 1.1388888888888888, 1.0, 1.3166666666666667, 1.5384615384615385, 1.342896174863388, 1.2264509990485253, 1.0, 1.0, 1.0, 1.252808988764045, 1.5, 1.135483870967742, 1.0432958801498127, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.4285714285714286, 1.5625, 2.2, 1.094311377245509, 1.0, 1.0, 2.0, 1.0102829977435968, 4.571428571428571, 1.0, 1.0, 1.0, 1.0, 1.0388450876624546, 1.0, 2.0, 1.528375733855186, 1.0, 1.0, 1.0, 1.5, 1.0, 1.0, 1.0, 1.0, 1.0, 1.2222222222222223, 1.116745283018868, 1.077023498694517, 1.0, 1.0, 1.0, 1.0171466016236486, 1.0, 1.0, 1.0, 1.68, 1.2771204856679659, 1.0, 4.0, 1.4444444444444444, 1.0653846153846154, 1.0, 1.0, 1.5, 1.0, 1.0, 1.045869213061642, 1.0, 2.0, 1.0012591815320042, 1.0, 1.0, 1.0006167763157894, 1.0, 1.1912507010656197, 1.0, 1.0, 4.0, 1.4351145038167938, 1.0, 1.0, 1.0, 1.6, 1.0, 1.0055333508377824, 1.0222768649546483, 1.0, 7.0, 3.2, 1.0, 3.5, 3.0, 1.0, 1.0, 1.0387800020962163, 1.0, 1.0, 1.5384615384615385, 4.739130434782608, 1.2952380952380953, 2.0597014925373136, 1.2088235294117646, 1.0, 1.5854700854700854, 2.6666666666666665, 1.2941176470588236, 4.0, 3.0, 1.0, 1.0, 1.0, 1.0454545454545454, 1.0, 2.63953488372093, 1.0, 5.0, 1.1666666666666667, 1.0, 1.3571428571428572, 1.0, 3.0, 1.0, 1.0, 2.5714285714285716, 1.0, 1.0, 1.0, 1.3708425720620843, 1.2727272727272727, 1.0, 3.0847457627118646, 15.333333333333334, 1.0, 1.56, 1.0, 4.5, 1.0, 1.0, 3.0, 1.022763706316127, 1.375, 1.0, 4.0, 1.0264900662251655, 1.0031089617054876, 1.0, 1.0, 1.060189165950129, 1.0163978494623656, 1.4037267080745341, 1.125, 4.0, 2.0, 1.5286944045911048, 1.7607655502392345, 5.074074074074074, 1.0, 1.0, 3.0, 1.1257861635220126, 1.0, 5.363636363636363, 1.0, 1.0, 1.0909090909090908, 3.0, 1.5, 2.0, 1.0, 1.0405596604307499, 1.9254658385093169, 1.0180331810531378, 1.0, 1.0, 3.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 3.0, 1.041025641025641, 2.0, 1.0475028097780275, 1.0, 1.0, 1.8333333333333333, 1.253202391118702, 3.0, 1.0, 1.0, 1.0, 1.0, 1.8666666666666667, 1.0016433853738702, 3.0, 1.0, 1.0, 3.0, 1.0, 1.0, 1.2570754716981132, 1.0, 1.0, 3.0, 1.0, 1.0666666666666667, 1.1171335030920335, 1.0, 1.0, 2.1237113402061856, 1.4761904761904763, 2.0, 1.297872340425532, 1.0, 1.0, 1.0, 1.0, 1.0, 1.3333333333333333, 2.0, 1.0, 1.0134408602150538, 1.0055958285641613, 2.5, 1.0, 3.0, 1.0, 2.0, 1.0, 3.0, 1.0, 1.1091867469879517, 2.25, 1.0, 1.0, 1.0445962233828847, 1.1662220246035275, 1.0, 1.5, 1.0, 1.052892561983471, 1.0, 1.165583712367338, 1.7045454545454546, 1.0063096111518708, 1.2736842105263158, 1.67822265625, 1.0, 1.3610503282275712, 3.0, 1.0, 1.0, 1.0, 1.0, 1.2142857142857142, 7.0, 4.0, 2.0, 4.0, 1.0, 1.0, 1.0, 1.8768939393939394, 3.0, 1.0, 4.0, 2.013003901170351, 1.9111111111111112, 1.0, 1.0, 1.2023047375160052, 5.0, 1.05, 2.0, 2.0, 1.125, 4.0, 1.25, 1.625, 1.0, 5.181818181818182, 1.0, 1.0, 1.6666666666666667, 1.0, 1.0, 1.0, 2.0, 5.0, 1.0, 1.0, 3.0, 1.0, 1.1, 1.0, 4.0, 1.0, 1.030668887038579, 1.0, 1.0, 1.875, 1.0, 1.0, 1.119047619047619, 1.0, 3.0, 1.0, 1.0, 2.1002824858757063, 1.0, 1.0826446280991735, 1.0, 1.7677165354330708, 1.0, 1.0, 5.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.4786729857819905, 1.0175470398433817, 1.0, 1.6607773851590106, 2.0, 1.28, 1.0, 1.5453728661275832, 1.0, 4.714285714285714, 1.3737419945105216, 1.0, 1.0, 4.0, 3.0, 1.0625, 1.0, 1.0106942920378672, 1.427854801121776, 2.1973684210526314, 3.0, 1.0, 3.0, 1.0, 4.0, 1.0, 5.0, 1.0, 6.0, 2.0, 1.0, 1.0, 1.0, 1.0168056608541824, 1.0934362934362933, 1.0, 1.0, 2.0, 1.249438202247191, 1.0, 2.0, 1.4127504162414737, 1.1111111111111112, 2.173228346456693, 1.0, 1.0, 1.0, 2.0, 45.0, 2.0, 1.0311847253684798, 1.0, 1.0, 1.0549310917798846, 1.0, 1.0141242937853108, 5.0, 1.3333333333333333, 2.0, 1.2972136222910218, 1.0, 1.0, 1.1, 1.0, 1.0, 1.1226820250284415, 1.0, 5.0, 1.0561674008810573, 1.8, 1.0, 1.0, 2.0, 1.278523489932886, 1.0, 1.127420362273579, 1.5, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 2.032258064516129, 1.0, 1.1949292064537373, 1.0, 1.0002974198825192, 1.0, 1.0, 1.0, 1.0, 1.0, 2.6666666666666665, 1.0555555555555556, 1.0, 1.0, 2.0, 1.235897435897436]
origin-forest_39.80 	max: 45.0000	99th: 8.5050	95th: 4.1855	median: 1.0576	mean: 1.7600

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 7/15 | Workload-time: 28.195558 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 8/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=valueskew', '--dataset=forest', '--drift_test=distribution', '--end2end', '--update_size=25000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
ValueSample - START
ValueSample - END
load_npy_dataset_from_path - df.shape = (681012, 10)
Parsing... done, took 0.1s
Data updated!
Previous data size: (656012, 10), new data size: (25000, 10)
[-2.9802322e-08  5.9604645e-08  5.9604645e-08  0.0000000e+00
  5.9604645e-08  5.9604645e-08  5.9604645e-08  0.0000000e+00
  4.5454502e-04  5.9604645e-08]
Distance score: 4.548728611553088e-05
SAUCE Drift detection: True
Detection latency: 0.0925s

DRIFT-DETECTED after 8-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=forest', '--end2end', '--model=transformer', '--model_update=adapt', '--update_size=25000', '--epochs=40']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
update_size: 25000
AdaptTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (681012, 10)
Parsing... done, took 0.1s
done, took 0.1s
dataset size: 681012
train data shape: torch.Size([25000, 10]), transfer data shape:torch.Size([5000, 10])
Epoch 0 Iter 0, train entropy gap 17.3801 bits (loss 36.448, data 19.068) 0.00300 lr
epoch 10 train loss 21.5875 nats / 31.1442 bits
time since start: 5.8 secs
Epoch 10 Iter 0, train entropy gap 11.8584 bits (loss 30.926, data 19.068) 0.00256 lr
epoch 20 train loss 20.2959 nats / 29.2807 bits
time since start: 11.5 secs
Epoch 20 Iter 0, train entropy gap 10.1164 bits (loss 29.184, data 19.068) 0.00150 lr
epoch 30 train loss 19.7622 nats / 28.5109 bits
time since start: 17.2 secs
Epoch 30 Iter 0, train entropy gap 9.3665 bits (loss 28.434, data 19.068) 0.00044 lr
epoch 40 train loss 19.6611 nats / 28.3650 bits
time since start: 23.0 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 40.5075 nats / 58.4400 bits
Saved to: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
AdaptTask - END

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 8/15 | Workload-time: 2.261429 | Model-update-time: 25.961655


WORKLOAD-START | Type: QueryWorkload | Progress: 9/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=forest', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
data size: 681012, total size: 681012, split index: [567510 681012]
Parsing... done, took 0.1s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
query_seed:0
origin-forest_39.80 	max: 82.0000	99th: 9.5600	95th: 5.0000	median: 1.0683	mean: 2.0040
ReportEsts: [3.0, 1.4223661649838064, 1.0, 1.5208333333333333, 2.0, 1.0, 1.238709677419355, 1.0, 1.3211920529801324, 1.0, 1.3392857142857142, 5.0, 1.0, 1.5, 1.044776119402985, 1.0879120879120878, 1.0, 4.0, 2.6666666666666665, 1.2692307692307692, 1.0, 1.1428571428571428, 1.0, 1.0, 1.0957230142566192, 5.0, 1.1494742824666098, 2.0, 1.0, 2.8205128205128207, 1.5, 1.0, 1.0, 5.0, 1.0, 2.0, 1.0, 4.0, 1.0, 10.0, 2.0, 1.0, 1.5238095238095237, 1.0, 2.5625, 1.18503937007874, 1.0, 2.0, 18.0, 1.0, 3.0, 1.0590783973901519, 1.0, 1.0, 1.2777777777777777, 1.090128755364807, 1.1421647819063006, 2.760869565217391, 1.0, 1.7142857142857142, 1.0092891760904685, 6.285714285714286, 4.0, 1.0, 1.0, 1.0555555555555556, 1.0017514157277132, 1.8571428571428572, 2.0, 5.0, 7.0, 1.138671875, 1.1884161601716123, 6.0, 1.0, 1.982332155477032, 1.0, 1.0, 1.0, 1.0, 8.0, 1.0, 1.0, 1.0905597356654155, 1.4, 2.4, 1.0, 1.0, 2.0, 1.7881609933633056, 1.0, 1.6216216216216217, 7.0, 1.1751124692301163, 2.4776119402985075, 55.0, 1.2142857142857142, 1.0, 1.0, 2.0, 4.0, 1.0, 1.1256070227867014, 2.0, 3.0, 1.0, 1.0, 1.0, 1.0011895149036667, 2.0, 1.0, 1.1647058823529413, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.1924959216965743, 1.0, 1.0, 2.0, 3.0, 1.0, 2.839572192513369, 1.2857142857142858, 1.0, 1.6513464991023339, 1.0, 1.0, 5.0, 1.2201273567236859, 1.0504986917947003, 5.0, 1.625, 1.0, 5.0, 2.0, 1.2001327580484566, 1.575, 1.0437260351074682, 1.0, 1.0, 1.6666666666666667, 1.0, 1.4250915602587984, 1.0, 1.0789473684210527, 3.6923076923076925, 2.1666666666666665, 1.0662809349220899, 1.0, 1.0, 1.0, 1.0, 2.0, 2.0, 1.0, 1.0, 1.0, 2.933333333333333, 2.0, 1.0050028264556246, 4.0, 1.0856965511890444, 1.0, 1.1428571428571428, 9.555555555555555, 1.310296191819464, 1.0, 1.0, 1.966887417218543, 1.0, 1.4944604459074353, 1.3123620309050772, 1.0, 1.0308157786212642, 1.4893617021276595, 1.1233644859813083, 1.0, 2.0, 1.0, 1.0, 5.0, 3.0, 1.0, 1.0815567320074402, 1.0, 1.0, 3.2, 1.2765244010963586, 1.0, 1.816793893129771, 1.1584334203655353, 2.0, 1.315217391304348, 1.2391304347826086, 1.0834938558618399, 1.0, 1.0, 4.0, 1.0, 3.142857142857143, 1.0, 1.0, 1.0, 1.0, 1.332129963898917, 5.5, 1.3717948717948718, 1.3529411764705883, 1.0, 6.0, 1.2156862745098038, 1.0, 1.0, 1.0, 1.0, 4.0, 4.0, 1.0, 5.0, 3.5, 1.0, 1.0, 1.068709191361125, 1.083843617522374, 1.4, 1.0, 1.0055908387359747, 1.0, 9.0, 1.0, 1.0, 1.8333333333333333, 4.0, 2.4615384615384617, 1.0, 2.0, 1.0, 1.072934472934473, 1.0036041939711664, 1.0, 1.3333333333333333, 5.0, 1.0, 2.0, 1.25, 1.0, 1.1095541401273885, 10.0, 6.5, 4.0, 1.6666666666666667, 1.471698113207547, 1.0, 1.6346153846153846, 2.0319767441860463, 1.0714285714285714, 2.0, 1.135623869801085, 1.5725190839694656, 1.1764705882352942, 1.0, 1.1284341020118716, 1.1428571428571428, 1.3333333333333333, 1.0, 1.6, 1.0, 1.0, 1.0, 1.1951219512195121, 1.5, 1.1385296119809394, 3.1870503597122304, 1.0, 1.0230040595399188, 1.0, 1.0724637681159421, 1.1546666666666667, 1.0, 1.0, 2.5, 1.7152542372881356, 1.070754716981132, 1.0195379104290831, 1.5, 2.6, 1.0, 1.6666666666666667, 1.3297567954220315, 1.0, 1.6419753086419753, 5.0, 2.1242603550295858, 1.0, 1.0, 1.4242424242424243, 1.6, 1.0, 1.0, 1.2650602409638554, 1.0, 1.2857142857142858, 2.0, 1.0, 1.12, 1.0, 1.5, 1.0, 1.0, 1.9285714285714286, 1.0, 1.0, 4.0, 6.0, 1.0, 1.0, 1.0, 1.0, 1.0, 3.142857142857143, 1.0, 1.0, 1.0446834292638594, 2.0, 1.0, 1.0409353758750126, 5.0, 1.0, 1.0, 1.0, 3.2846715328467155, 1.5, 3.0, 4.0, 1.0, 1.5808823529411764, 2.0882524839275276, 1.0101010101010102, 3.9166666666666665, 1.0, 1.3720543806646526, 1.9137931034482758, 1.0, 1.4, 1.5, 2.0, 10.0, 4.5, 1.0, 1.0, 9.0, 1.0, 1.0, 1.511111111111111, 11.0, 2.1315789473684212, 6.0, 1.0, 5.0, 2.378787878787879, 1.044478527607362, 1.018105761752279, 3.0, 1.0107313811352758, 2.0425531914893615, 1.018414831404753, 2.827956989247312, 1.037037037037037, 4.0, 2.4788732394366195, 1.0, 3.5454545454545454, 1.0575780985949494, 1.0, 1.0122606172513848, 1.0565711221604757, 1.0571608534761043, 1.0, 4.0, 1.0, 1.434782608695652, 9.0, 2.0, 2.0, 1.197854588796186, 1.1428571428571428, 2.611111111111111, 2.0, 1.0, 1.375886524822695, 1.6666666666666667, 1.0, 1.0, 1.0, 8.5, 1.0, 1.0658465991316932, 1.0, 1.0, 1.0, 1.0, 1.0300454963705143, 1.0, 5.0, 1.323291857672997, 1.0, 1.5, 5.0, 1.0, 1.0116626564268214, 3.625, 82.0, 1.0, 1.0, 1.001777227525061, 1.0151088551374072, 1.0, 1.1, 2.5, 2.0, 1.0, 1.942408376963351, 1.0103950636249583, 1.0, 1.6808333333333334, 1.144736842105263, 1.0, 1.0, 1.064516129032258, 2.090909090909091, 9.0, 1.0, 1.1331981068289385, 1.300128631961259, 1.25, 1.1257575757575757, 5.6, 1.0, 1.0, 1.0, 1.1363127490931888, 1.25, 1.0, 1.8209606986899562, 4.0, 1.0, 1.0841584158415842, 1.0, 1.0, 1.236842105263158, 1.3333333333333333, 1.8888888888888888, 1.9754464285714286, 1.05703125, 1.0, 5.0, 2.0, 1.0, 1.0, 1.06009187845071, 1.0, 1.0, 1.0916380297823596, 1.1398601398601398, 1.0, 1.0, 1.0, 1.0, 1.2517985611510791, 5.0, 1.037923531240286, 1.001744043672765, 1.5, 2.0, 1.055045871559633, 1.0, 1.0, 1.0, 1.1176470588235294, 1.0, 1.0, 1.0, 1.3076923076923077, 1.3181818181818181, 1.1183939229517093, 1.0, 1.3333333333333333, 1.0, 1.2073170731707317, 1.0, 1.0, 1.0, 1.0, 1.0, 1.105616158079587, 2.25, 2.0, 1.12, 1.0, 5.0, 3.5, 2.08, 1.6666666666666667, 1.6063829787234043, 1.5784930799331192, 2.0, 1.0, 1.0, 1.1970074812967582, 4.0, 20.0, 1.1121495327102804, 1.0, 1.038134939014976, 1.4523809523809523, 1.0, 1.0, 6.0, 1.0, 1.0, 1.0, 4.0, 1.1605911330049261, 1.3625730994152048, 1.5, 2.0, 1.0, 1.1257309941520468, 1.0, 4.0, 5.0, 5.0, 1.7552275522755227, 5.0, 1.0, 1.7285067873303168, 2.0, 1.0078808171116138, 1.0, 1.0, 1.4906542056074767, 2.0, 1.0, 1.331360946745562, 2.0, 1.35, 1.1274509803921569, 1.4296448087431695, 1.6666666666666667, 2.0, 4.5, 1.125925925925926, 1.0, 1.3716216216216217, 1.0, 1.1428571428571428, 1.0, 1.2, 1.0555326640067804, 1.2857142857142858, 1.0058462347464312, 1.7608695652173914, 1.0, 3.0, 1.0476190476190477, 1.0, 1.0476190476190477, 1.3333333333333333, 1.3262764632627646, 1.117468573905505, 1.0, 1.0, 1.0, 1.0130718954248366, 1.0, 1.020994332818135, 1.0626857223715862, 1.0, 5.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 3.005714285714286, 1.0596833530416503, 2.189189189189189, 1.0, 2.0, 2.5, 1.0, 5.0, 5.0, 1.0, 1.0, 1.0, 1.0, 1.1002671118530885, 1.0, 2.0, 1.6220145379023885, 1.0, 1.0, 1.0, 1.5, 3.0, 1.0, 1.0, 1.0, 1.0, 1.8333333333333333, 2.826993865030675, 1.1416040100250626, 1.5, 1.0, 1.0, 1.044946451572225, 1.0, 1.0, 1.0, 2.4705882352941178, 1.3824239557923035, 1.0, 5.0, 1.625, 1.0156521739130435, 1.0, 1.0, 1.5, 1.0, 1.0, 1.2642782969885773, 1.0, 2.0, 1.0371458551941237, 1.0, 1.0, 1.069753694581281, 1.0, 1.2449443062614902, 1.0, 1.0, 6.0, 1.3823008849557523, 1.0, 1.0, 1.0, 1.3333333333333333, 1.0, 1.0397735750522232, 1.0547490734896667, 1.0, 9.0, 8.0, 1.0, 1.75, 12.0, 1.0, 1.0, 1.0404786061645033, 1.0, 1.0, 1.125, 3.2058823529411766, 1.1370967741935485, 1.7062937062937062, 1.109375, 1.0, 1.213166144200627, 1.7391304347826086, 1.0454545454545454, 5.0, 3.0, 1.0, 1.0, 1.0, 1.105263157894737, 1.0, 2.2126168224299065, 1.0, 6.0, 3.5, 8.0, 1.087719298245614, 1.0, 4.0, 1.0, 1.0, 2.92, 1.0, 1.0, 1.0, 1.441142191142191, 1.1153846153846154, 1.0, 3.371794871794872, 46.0, 1.0, 1.28, 1.0, 1.4285714285714286, 5.0, 1.0, 4.0, 1.0372670807453417, 1.0, 1.0, 4.0, 1.087837837837838, 1.005923328436715, 1.0, 1.0, 1.0511208310552214, 1.0173501577287065, 1.5290697674418605, 3.0, 5.0, 1.0, 1.0247206230951575, 1.2665148063781322, 1.8333333333333333, 1.0, 1.0, 8.0, 1.115736040609137, 1.0, 1.1290322580645162, 1.0, 1.0, 1.064516129032258, 4.0, 1.5, 2.0, 1.0, 1.0248321808913339, 1.204968944099379, 1.067922657411998, 1.0, 1.0, 3.0, 8.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 3.5, 1.15, 2.0, 1.0102546573235345, 1.0, 1.0, 1.9444444444444444, 1.1917808219178083, 3.0, 1.5, 1.0, 1.0, 1.0, 1.1071428571428572, 1.0924302788844622, 3.0, 1.0, 1.0, 3.0, 1.0, 1.0, 1.4012158054711246, 1.0, 1.0, 4.0, 1.0, 1.0285474391267841, 1.056913407821229, 1.0, 1.0, 1.6363636363636365, 1.9411764705882353, 1.0, 1.4444444444444444, 1.0, 1.0, 1.0, 1.0, 1.0, 2.6666666666666665, 1.0, 1.0, 1.0865139949109415, 1.2685314685314686, 1.3333333333333333, 1.0, 2.3333333333333335, 1.0, 1.8666666666666667, 1.0, 3.0, 1.0, 1.002664629374278, 9.0, 1.0, 1.0, 1.011587485515643, 1.0587813105576689, 1.0, 3.0, 5.0, 1.0940310711365495, 1.0, 1.126498479155484, 1.1590909090909092, 1.091846153846154, 3.0671641791044775, 1.5580598132314118, 1.0, 1.1236306729264476, 1.5, 1.0, 1.0, 1.0, 2.0, 2.7857142857142856, 9.0, 5.0, 2.0, 4.0, 1.0, 1.0, 1.0, 2.234567901234568, 3.0, 1.0, 5.0, 1.4645222327341532, 1.875, 1.0, 1.0, 1.619718309859155, 5.333333333333333, 1.0, 1.2222222222222223, 1.0, 1.0, 1.0, 4.0, 1.0, 1.0, 1.2857142857142858, 1.3357923497267759, 5.0, 1.0, 1.5, 1.280373831775701, 1.0, 1.1371853952499114, 1.0, 1.0, 1.0, 6.0, 1.2483221476510067, 1.0, 1.0, 1.0, 1.0, 5.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.040691596300764, 2.0, 1.0, 1.0, 1.0, 1.0, 1.5884476534296028, 1.0, 1.0, 5.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.2852564102564104, 1.0388046228219168, 5.0, 1.9836065573770492, 1.1428571428571428, 1.2358490566037736, 1.0, 1.754207037225905, 1.0, 3.0, 1.5955345641906398, 1.0, 1.0, 5.0, 4.0, 1.1176470588235294, 1.0, 1.0551379044730131, 1.2997626923630088, 1.7267441860465116, 2.0, 1.0, 4.0, 1.0, 5.0, 1.0, 8.0, 1.0, 6.0, 2.0, 1.0, 1.0, 1.0, 1.0803536086554955, 1.139301634472511, 1.0, 1.0, 2.0, 1.0148936170212766, 1.0, 2.0, 1.2915009574311387, 1.5, 1.248868778280543, 1.0, 1.0, 1.0, 2.0, 3.0, 1.0, 1.0726019235679631, 1.0, 1.0, 1.0230692076228687, 4.0, 1.8693467336683418, 7.0, 1.0, 2.0, 1.8902077151335313, 1.0, 2.0, 1.8181818181818181, 1.0, 1.0, 1.0304952427421323, 1.0, 6.0, 1.038420490928495, 4.2, 1.0, 1.0, 2.25, 1.005050505050505, 1.0, 1.4644295302013424, 3.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.8108108108108107, 1.0, 1.0922598479612993, 1.6666666666666667, 1.0193731479574937, 1.0, 1.0, 1.0, 1.0, 1.0, 2.5, 1.25, 1.0, 1.0, 2.0, 1.6174496644295302]
origin-forest_39.80 	max: 82.0000	99th: 9.5600	95th: 5.0000	median: 1.0683	mean: 2.0040

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 9/15 | Workload-time: 28.485592 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 10/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=valueskew', '--dataset=forest', '--drift_test=distribution', '--end2end', '--update_size=25000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
ValueSample - START
ValueSample - END
load_npy_dataset_from_path - df.shape = (706012, 10)
Parsing... done, took 0.1s
Data updated!
Previous data size: (681012, 10), new data size: (25000, 10)
[1.1920929e-07 0.0000000e+00 1.1920929e-07 2.9802322e-07 1.7881393e-07
 0.0000000e+00 5.9604645e-08 5.9604645e-08 3.1906366e-04 5.9604645e-08]
Distance score: 3.1995772587833926e-05
SAUCE Drift detection: True
Detection latency: 0.0947s

DRIFT-DETECTED after 10-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=forest', '--end2end', '--model=transformer', '--model_update=adapt', '--update_size=25000', '--epochs=40']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
update_size: 25000
AdaptTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (706012, 10)
Parsing... done, took 0.1s
done, took 0.1s
dataset size: 706012
train data shape: torch.Size([25000, 10]), transfer data shape:torch.Size([5000, 10])
Epoch 0 Iter 0, train entropy gap 17.4175 bits (loss 36.414, data 18.996) 0.00300 lr
epoch 10 train loss 21.4282 nats / 30.9143 bits
time since start: 5.8 secs
Epoch 10 Iter 0, train entropy gap 11.7543 bits (loss 30.750, data 18.996) 0.00256 lr
epoch 20 train loss 20.1101 nats / 29.0128 bits
time since start: 11.5 secs
Epoch 20 Iter 0, train entropy gap 9.9008 bits (loss 28.897, data 18.996) 0.00150 lr
epoch 30 train loss 19.5768 nats / 28.2433 bits
time since start: 17.1 secs
Epoch 30 Iter 0, train entropy gap 9.1293 bits (loss 28.125, data 18.996) 0.00044 lr
epoch 40 train loss 19.4771 nats / 28.0995 bits
time since start: 22.8 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 40.0434 nats / 57.7704 bits
Saved to: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
AdaptTask - END

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 10/15 | Workload-time: 2.276347 | Model-update-time: 25.840005


WORKLOAD-START | Type: QueryWorkload | Progress: 11/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=forest', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
data size: 706012, total size: 706012, split index: [588343 706012]
Parsing... done, took 0.1s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
query_seed:0
origin-forest_39.80 	max: 67.0000	99th: 14.0100	95th: 6.0000	median: 1.0677	mean: 2.1826
ReportEsts: [1.0, 1.019410227696902, 1.0, 1.711111111111111, 2.6666666666666665, 1.0, 2.6301369863013697, 1.0, 2.4549878345498786, 1.0, 1.1846153846153846, 5.0, 1.0, 2.5, 1.4477611940298507, 1.058139534883721, 1.0, 5.0, 3.142857142857143, 1.5, 1.0, 1.3333333333333333, 1.0, 1.0, 1.4685714285714286, 6.0, 1.2857581338244322, 4.0, 7.0, 2.0425531914893615, 2.0, 1.0, 1.0, 6.0, 1.0, 2.0, 1.0, 5.0, 1.0, 1.8333333333333333, 2.0, 1.0, 1.5, 1.0, 1.128440366972477, 1.4651162790697674, 1.0, 1.5, 18.0, 1.0, 3.0, 2.8141263940520447, 1.0, 1.0, 9.0, 1.096638655462185, 1.446896551724138, 1.7346938775510203, 1.0, 1.4444444444444444, 1.0797241379310345, 15.0, 5.0, 1.0, 1.0, 1.7444444444444445, 8.0, 1.0, 1.5294117647058822, 1.0, 2.0, 1.0517241379310345, 1.2203038674033149, 1.0809523809523809, 1.0, 1.273972602739726, 1.0, 1.0, 1.0, 1.0, 10.0, 1.0, 1.0, 1.0748249359521775, 3.5, 6.0, 1.1555555555555554, 1.3962264150943395, 1.0, 1.0, 1.6592028660994178, 1.0, 1.0, 1.069687900812313, 1.0, 1.1835081029551955, 1.0, 6.0, 1.1162790697674418, 1.5, 5.0, 1.3309090909090908, 1.0, 1.0, 1.0, 1.608695652173913, 1.0658682634730539, 2.8205128205128207, 1.0, 1.2936507936507937, 1.0204081632653061, 1.0, 1.125, 2.0, 1.0, 2.0, 1.0, 1.0, 1.0, 1.4444444444444444, 1.0, 1.0, 1.4864864864864864, 1.1398601398601398, 1.064516129032258, 8.0, 1.2, 2.0, 10.0, 1.033814514534309, 1.0, 1.0, 5.0, 1.0341059940774022, 1.0695000096635163, 3.0, 1.625, 1.0, 6.0, 2.0, 1.2640911969601014, 1.6578947368421053, 1.0647248094834885, 1.0, 1.0, 1.25, 1.0, 1.4273521220697052, 1.0, 1.2926829268292683, 2.2857142857142856, 1.4615384615384615, 1.0605843439911797, 1.0, 1.0, 1.0, 1.0, 4.0, 1.0, 1.0, 1.0, 3.3333333333333335, 1.88, 2.0, 1.042267924099534, 4.0, 1.0764047467525175, 1.0, 2.25, 7.909090909090909, 1.0027397260273974, 1.0, 1.0, 1.9944751381215469, 1.0, 1.3884393225530802, 1.1731623088307843, 1.0, 1.0028852567720647, 3.642857142857143, 1.2675675675675675, 1.0, 3.0, 1.0, 1.0, 6.0, 3.0, 1.0, 1.0765510570678458, 1.0, 1.0, 6.0, 1.2411135104057334, 1.0, 1.36, 1.169001310087675, 2.0, 1.2580645161290323, 1.0729166666666667, 1.0795737614171048, 1.0, 1.0, 5.0, 1.0, 1.0434782608695652, 1.0, 1.0, 1.0, 2.5, 1.2764632627646326, 1.1666666666666667, 1.4625, 23.0, 1.0, 7.0, 1.3125, 1.0, 1.0, 1.0, 1.0, 5.0, 1.6666666666666667, 1.0, 1.6666666666666667, 2.8, 1.0, 1.0, 1.0719626168224299, 1.0264886400344568, 1.2758620689655173, 1.0, 1.0310111055133289, 1.0, 11.0, 1.0, 1.0, 1.1, 5.0, 67.0, 1.0, 2.0, 4.5, 1.2374603174603174, 1.0302552789158526, 1.0, 4.0, 6.0, 1.0, 1.0, 1.4444444444444444, 1.0, 1.1960526315789475, 2.5, 2.8, 5.0, 1.6666666666666667, 1.6486486486486487, 1.0, 1.4225941422594142, 1.8211029092488058, 1.1666666666666667, 1.0, 1.1867364746945899, 1.2117647058823529, 1.1764705882352942, 1.0, 1.1175762439807384, 1.1428571428571428, 4.0, 1.0, 1.3333333333333333, 1.0, 1.0, 1.0, 1.625, 1.5, 3.1240601503759398, 1.4169278996865204, 1.0, 1.0173980784211893, 1.0, 1.1408450704225352, 1.4554294975688817, 1.0, 1.0, 2.75, 1.1532710280373832, 1.0675675675675675, 1.0839207949378054, 2.5, 1.975609756097561, 5.0, 1.0, 1.3211249182472204, 1.0, 1.1367521367521367, 6.0, 1.0342857142857143, 1.0, 1.0, 1.5, 1.1676706827309238, 1.0, 1.0, 1.125, 1.0091405995282023, 1.0116929334011184, 2.407185628742515, 6.0, 1.1724137931034482, 1.0, 1.5, 1.0, 1.0, 1.8, 2.0, 1.0, 4.25, 7.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.3, 1.0, 1.0, 1.1024034959941733, 2.0, 1.0, 1.0300498387569628, 6.0, 1.0, 1.0, 1.0, 1.542857142857143, 2.0, 3.0, 4.0, 1.0, 1.2797619047619047, 1.8560962846677131, 1.030612244897959, 1.2125, 1.0, 1.259578131726216, 1.018018018018018, 1.0, 1.4, 1.3333333333333333, 1.6, 10.0, 5.0, 1.0, 1.0, 11.0, 1.0, 1.0, 1.1071428571428572, 11.0, 1.4464285714285714, 1.2, 1.0, 6.0, 1.087837837837838, 1.3302752293577982, 1.0414291221164966, 1.3278688524590163, 1.0019363217757487, 1.08, 1.0571178602674665, 2.733102253032929, 1.3181818181818181, 5.0, 1.488262910798122, 1.0, 3.870967741935484, 1.0641242010844936, 1.0, 1.0422570595920009, 1.068442854453022, 1.1014934833419165, 1.0, 4.333333333333333, 1.0, 1.2526315789473683, 10.0, 2.0, 1.0, 1.0028708133971291, 1.5, 4.5, 2.0, 1.0, 1.1741935483870967, 1.3636363636363635, 1.75, 1.0, 1.0, 17.0, 1.0, 1.2197273456295108, 1.0, 1.0, 1.0, 1.0, 1.0659196201804653, 1.0, 6.0, 1.0407149950347567, 1.0, 1.5, 6.0, 1.0, 1.0161025968497233, 1.375, 1.8125, 1.0, 1.0, 1.0301712526457572, 1.1176049517874438, 1.0, 2.2, 6.0, 2.0, 1.0, 1.9711538461538463, 1.0075212073387256, 1.0, 1.7881205673758864, 5.846153846153846, 1.0, 1.0, 1.1162790697674418, 2.5, 11.0, 1.0, 1.2212078651685394, 1.4132960457321462, 1.0, 1.0677966101694916, 5.6, 1.0, 1.0, 1.0, 1.1484620818082578, 1.6666666666666667, 1.0, 1.1599443671766343, 5.0, 1.0, 1.1609756097560975, 1.0, 1.0, 1.2543859649122806, 1.6666666666666667, 1.0588235294117647, 1.5494949494949495, 1.0270462633451958, 1.0, 6.0, 2.0, 1.0, 1.0, 1.0927474910888098, 1.0, 1.0, 1.0866228070175439, 1.0087719298245614, 1.0, 1.0, 1.0, 1.0, 1.1528662420382165, 5.0, 1.440685045948204, 1.0053442531926708, 1.5, 6.0, 1.1236203090507726, 1.0, 1.0, 1.0, 64.0, 1.135135135135135, 1.0, 6.0, 1.0586894586894586, 1.3228782287822878, 1.3157894736842106, 1.0, 1.0865829360278945, 1.6666666666666667, 2.0, 1.0002411534751485, 2.5, 1.075049843349473, 1.0, 1.0, 1.0, 1.1041780966448618, 2.375, 2.0, 1.7857142857142858, 1.0, 6.0, 8.0, 1.4857142857142858, 3.0, 1.0066666666666666, 1.546543190164458, 2.0, 1.0, 1.0, 1.296875, 5.0, 1.65, 1.0648148148148149, 1.0, 1.0180854705943645, 31.5, 1.2, 1.0, 7.0, 1.0, 1.0, 1.0, 5.0, 1.1564561734213006, 3.1739130434782608, 2.0, 2.0, 1.0, 1.170731707317073, 1.0, 5.0, 5.0, 6.0, 1.058864751226349, 6.0, 1.0, 1.881057268722467, 2.0, 1.0514619434647037, 1.0, 1.0, 1.1581342434584756, 1.0, 1.0, 1.449438202247191, 3.0, 1.1, 1.0925925925925926, 1.3278116826503923, 1.0, 2.0, 2.25, 1.1322314049586777, 1.0, 1.6612903225806452, 1.0, 1.326996197718631, 1.0, 2.0, 1.0219911595926174, 1.0, 1.014227519156798, 2.25, 1.0, 3.0, 1.0, 1.0, 1.1, 2.75, 1.225769669327252, 1.344809598330725, 1.0, 1.0, 1.0, 1.095137420718816, 1.0, 1.2219138409557138, 1.018566552901024, 1.0, 6.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.5, 1.0, 1.0, 2.0, 1.2833333333333334, 1.0249191554118318, 2.561264822134387, 1.0, 1.0, 2.217391304347826, 1.0, 6.0, 6.0, 1.0, 1.0, 1.0, 1.0, 1.0526601520086862, 1.0, 2.0, 1.605344295991778, 1.0, 1.0, 1.0, 2.0, 3.0, 1.0, 1.0, 1.0, 1.0, 5.5, 2.37493881546745, 1.0581851070244197, 3.5, 1.0, 1.0, 1.0419280490763525, 1.0, 1.0, 1.0, 6.0, 1.381615772125132, 1.0, 1.0, 3.25, 1.0536912751677852, 1.0, 1.0, 2.5, 1.0, 1.0, 1.11056338028169, 1.0, 2.0, 1.1384444444444444, 1.0, 1.0, 1.0289826881929585, 1.0, 1.2447552447552448, 1.0, 1.0, 8.0, 1.0240202275600505, 1.0, 1.0, 1.0, 1.6, 1.0, 1.0510255532945563, 1.019625886257354, 1.0, 11.0, 1.9375, 1.0, 3.5, 19.454545454545453, 1.0, 1.0, 1.0464121345692616, 1.0, 1.0, 1.105263157894737, 2.0185185185185186, 1.0740740740740742, 1.2567567567567568, 1.0649526387009471, 2.0, 14.0, 1.5, 1.0, 1.0, 2.0, 12.0, 1.0, 1.0, 1.0, 1.0, 2.142857142857143, 1.0, 1.0166941774053004, 1.0436588775714, 1.1254237288135593, 1.0, 2.0, 2.5, 1.9106529209621994, 1.0, 7.0, 4.0, 1.2019427402862985, 1.0134584516606988, 1.0, 1.0, 2.5, 2.0, 1.0, 3.375, 1.0, 1.0, 1.0, 1.0508474576271187, 1.0, 5.0, 5.0, 1.2252283907238228, 1.125, 1.0, 4.0, 1.0434782608695652, 1.010519575557995, 1.0, 1.0, 1.0529867533116721, 1.1112493777999004, 1.0338983050847457, 2.25, 6.0, 1.0, 1.0923965351299327, 1.2130434782608697, 3.3805970149253732, 1.0, 1.0, 17.0, 1.1952662721893492, 1.0, 2.4153846153846152, 1.0, 1.0, 1.1379310344827587, 5.0, 3.0, 2.0, 1.0, 1.1254564042646416, 1.2236024844720497, 1.0944553483807655, 1.0, 1.0, 3.0, 10.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 4.0, 1.0539845758354756, 2.0, 1.1044009515570934, 1.0, 1.0, 2.0, 1.2570612503966994, 3.0, 1.0, 1.0, 1.5576923076923077, 1.0, 1.12, 1.0464396284829722, 3.0, 1.0, 1.0, 3.0, 1.0, 2.0, 1.245, 1.0, 1.0, 5.0, 1.0, 1.0343698854337153, 1.0587840107490762, 1.0, 1.0, 1.9652173913043478, 1.5909090909090908, 2.0, 1.303225806451613, 1.0, 1.0, 1.0, 1.0, 1.0, 2.2857142857142856, 2.0, 1.0, 1.117359413202934, 1.0072069943289226, 2.125, 1.0, 1.1428571428571428, 1.0, 1.8666666666666667, 2.0, 1.5, 1.0, 1.0276166804750069, 1.8, 1.0, 1.0, 1.0022296544035674, 1.05228088159918, 1.0, 3.0, 6.0, 1.0620741862225587, 1.0, 1.033709802569187, 1.1590909090909092, 1.0261659436008677, 3.2432432432432434, 1.551192543502144, 1.0, 1.2958579881656804, 3.0, 1.0, 1.0, 1.0, 2.0, 1.1666666666666667, 11.0, 6.0, 1.0, 4.0, 1.0, 1.0, 1.0, 2.651773981603154, 3.0, 1.0, 6.0, 1.7161862527716185, 3.032258064516129, 1.0, 1.0, 1.0610837438423646, 4.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.125, 1.0, 1.1428571428571428, 1.3581661891117478, 7.0, 1.0, 2.5, 1.4955947136563876, 1.0, 1.1251289102784463, 1.0, 1.0, 1.0, 8.0, 1.2288, 1.0, 1.0, 1.0, 1.0, 6.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0645519672068344, 2.0, 1.0, 1.0, 1.0, 1.0, 1.6688963210702341, 1.0, 1.0, 5.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.1955128205128205, 1.029951605613308, 6.0, 1.0354536398934764, 6.5, 1.0, 1.0, 1.099041533546326, 1.0, 4.090909090909091, 1.3023915687069314, 1.0, 1.0, 3.6666666666666665, 2.076923076923077, 1.25, 6.0, 1.1172313215167153, 3.0, 1.0, 1.0, 1.0, 1.0, 6.0, 1.0, 1.0, 11.0, 1.0, 6.0, 1.0, 1.0, 1.0, 1.0, 1.1399361777567663, 1.0933699489996076, 1.0, 1.0, 2.0, 1.0184426229508197, 1.0, 2.0, 1.5733939466443354, 1.0, 5.111111111111111, 1.0, 1.0, 1.0, 1.2, 45.0, 2.0, 1.0779982459986845, 1.0, 1.0, 1.0963555097129105, 1.25, 1.3116883116883118, 9.0, 3.0, 2.0, 1.5954415954415955, 1.0, 1.5126050420168067, 1.0, 1.0, 10.0, 1.1111111111111112, 1.0, 3.5, 1.033160621761658, 2.2, 1.0, 1.0, 3.5, 1.1573033707865168, 1.0, 1.1336801040312094, 1.5, 1.0, 5.0, 1.047337278106509, 1.0, 1.0, 1.4, 1.0063756743501717, 9.0, 1.4642857142857142, 1.0, 1.0157144678758143, 3.0, 1.0, 3.0, 1.0, 1.0, 1.0, 2.0, 3.4, 1.0588235294117647, 1.0, 1.0]
origin-forest_39.80 	max: 67.0000	99th: 14.0100	95th: 6.0000	median: 1.0677	mean: 2.1826

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 11/15 | Workload-time: 28.670866 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 12/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=valueskew', '--dataset=forest', '--drift_test=distribution', '--end2end', '--update_size=25000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
ValueSample - START
ValueSample - END
load_npy_dataset_from_path - df.shape = (731012, 10)
Parsing... done, took 0.1s
Data updated!
Previous data size: (706012, 10), new data size: (25000, 10)
[0.0000000e+00 0.0000000e+00 5.9604645e-08 1.7881393e-07 1.1920929e-07
 0.0000000e+00 5.9604645e-08 0.0000000e+00 2.8860569e-04 0.0000000e+00]
Distance score: 2.8902291887789033e-05
SAUCE Drift detection: True
Detection latency: 0.0961s

DRIFT-DETECTED after 12-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=forest', '--end2end', '--model=transformer', '--model_update=adapt', '--update_size=25000', '--epochs=40']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
update_size: 25000
AdaptTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (731012, 10)
Parsing... done, took 0.1s
done, took 0.1s
dataset size: 731012
train data shape: torch.Size([25000, 10]), transfer data shape:torch.Size([5000, 10])
Epoch 0 Iter 0, train entropy gap 17.8010 bits (loss 36.721, data 18.920) 0.00300 lr
epoch 10 train loss 21.3235 nats / 30.7633 bits
time since start: 6.0 secs
Epoch 10 Iter 0, train entropy gap 11.6235 bits (loss 30.543, data 18.920) 0.00256 lr
epoch 20 train loss 20.0014 nats / 28.8559 bits
time since start: 11.7 secs
Epoch 20 Iter 0, train entropy gap 9.9212 bits (loss 28.841, data 18.920) 0.00150 lr
epoch 30 train loss 19.4628 nats / 28.0789 bits
time since start: 17.5 secs
Epoch 30 Iter 0, train entropy gap 9.0702 bits (loss 27.990, data 18.920) 0.00044 lr
epoch 40 train loss 19.3759 nats / 27.9536 bits
time since start: 23.3 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 39.6009 nats / 57.1320 bits
Saved to: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
AdaptTask - END

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 12/15 | Workload-time: 2.293558 | Model-update-time: 26.278649


WORKLOAD-START | Type: QueryWorkload | Progress: 13/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=forest', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
data size: 731012, total size: 731012, split index: [609176 731012]
Parsing... done, took 0.1s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
query_seed:0
origin-forest_39.80 	max: 27.2500	99th: 12.5050	95th: 7.0000	median: 1.0889	mean: 2.0973
ReportEsts: [1.0, 1.0500554118950869, 1.0, 1.051948051948052, 4.0, 1.0, 1.6695652173913043, 1.0, 2.9788732394366195, 1.0, 1.082191780821918, 2.5, 1.0, 2.0, 1.0307692307692307, 1.120879120879121, 1.0, 6.0, 1.4782608695652173, 1.3424657534246576, 1.0, 1.0, 1.0, 1.0, 1.0266666666666666, 7.0, 1.2988609112709832, 4.0, 8.0, 1.7407407407407407, 1.25, 1.0, 3.0, 7.0, 1.0, 2.0, 1.0, 6.0, 1.0, 4.0, 1.5, 1.0, 1.6521739130434783, 1.0, 1.0081967213114753, 1.7407407407407407, 1.0, 1.5, 22.0, 1.0, 3.0, 2.821981424148607, 1.0, 1.0, 1.098901098901099, 1.1571428571428573, 1.0376344086021505, 1.5192307692307692, 1.0, 1.5555555555555556, 1.1404275996112732, 2.8125, 6.0, 1.0, 1.364864864864865, 2.6216216216216215, 10.0, 1.0, 1.3333333333333333, 1.0, 1.0, 1.0459770114942528, 1.271118530884808, 3.442622950819672, 1.0, 1.9370860927152318, 1.0, 1.0, 1.0, 1.0, 7.0, 2.125, 1.0, 1.0108821901965575, 2.0, 1.1194228143336902, 7.0, 1.0, 1.0980392156862746, 1.0, 1.0, 1.2692702980472765, 1.0, 1.0, 1.0312676668841052, 1.0, 1.2150265038027195, 1.0, 7.0, 1.2291666666666667, 1.2864493996569468, 6.0, 1.2745762711864406, 1.0, 1.0, 1.0, 1.2105263157894737, 1.1071428571428572, 1.9066079295154186, 1.0, 1.4761904761904763, 1.4705882352941178, 1.0, 1.375, 1.3333333333333333, 1.0, 2.0, 1.0, 1.0, 1.0, 1.0833333333333333, 1.0, 1.0, 1.6829268292682926, 1.2474576271186442, 1.2727272727272727, 2.0, 1.372093023255814, 2.0, 12.0, 1.0889022677102147, 1.0, 1.0, 5.0, 1.051044747638584, 1.1026785714285714, 1.3333333333333333, 1.16793893129771, 1.0, 1.0725558121632024, 1.15625, 1.0, 1.3174224343675418, 1.346938775510204, 1.0, 1.0, 1.5296655879180152, 1.0782809925365902, 1.0, 1.0, 1.681159420289855, 2.0, 1.0, 1.0, 1.0891675374433996, 1.3734513274336284, 1.0, 1.0, 1.202127659574468, 1.0, 1.0, 1.0, 2.0, 1.0, 1.316934720908231, 7.0, 1.0, 1.0, 1.0, 2.0434272300469485, 3.0, 2.0, 11.076923076923077, 1.358288770053476, 1.0, 1.0, 1.5093457943925233, 1.0, 1.3102387515445835, 1.2391870766023971, 1.0, 1.0170226829814957, 4.583333333333333, 1.097504352872896, 1.0, 7.0, 1.0, 1.0, 7.0, 3.0, 1.0, 1.0081561706110442, 1.0, 1.0, 7.0, 1.2284057971014493, 1.0, 1.344632768361582, 1.2893467777290661, 2.0, 1.27, 1.54, 1.0043338286280337, 1.0, 1.0, 6.0, 1.0, 1.4444444444444444, 1.0, 1.0, 1.0, 3.0, 1.2630930375847196, 9.5, 1.4691358024691359, 5.75, 1.0, 8.0, 1.2549019607843137, 1.0, 1.0, 1.0, 1.0, 6.0, 1.0, 1.0, 5.0, 4.666666666666667, 1.0, 1.0, 1.0259885949331589, 1.0232251521298175, 1.3448275862068966, 1.0, 1.0145432914196633, 1.0, 13.0, 2.0, 1.0, 1.0, 6.0, 1.1475409836065573, 1.0, 3.0, 1.5, 1.1028446389496718, 1.2069385270846014, 1.0, 1.3333333333333333, 7.0, 1.0, 2.0, 1.6, 1.0, 1.1871859296482412, 5.0, 2.142857142857143, 6.0, 1.1515151515151516, 2.1810344827586206, 1.0, 1.168384879725086, 1.0663333022865924, 2.5714285714285716, 2.0, 1.1247892074198989, 1.9619047619047618, 1.1, 1.0, 1.03125, 1.2857142857142858, 2.0, 1.0, 1.3333333333333333, 1.0, 1.0, 1.0, 1.896551724137931, 1.0, 2.906230333543109, 2.5083333333333333, 1.0, 1.0274451097804391, 1.0, 1.309090909090909, 1.5561139028475712, 4.166666666666667, 1.0, 2.4, 1.287015945330296, 1.0518757122589948, 1.0756866438593333, 2.0, 1.7142857142857142, 6.0, 1.0, 1.1998792270531402, 1.0, 8.06060606060606, 7.0, 1.2967032967032968, 1.0, 1.0, 1.75, 1.0918762088974856, 1.0, 1.0, 1.125, 1.0457968076242259, 1.4059474412171507, 1.2222222222222223, 7.0, 1.0, 1.0, 1.5, 1.0, 1.0, 1.0588235294117647, 2.0, 1.0, 3.6, 8.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.6, 1.0, 1.0, 1.0443436265183668, 3.5, 1.0, 1.1429379329845892, 7.0, 1.0, 1.0, 1.0, 1.4136125654450262, 2.0, 3.0, 4.0, 1.0, 1.6666666666666667, 1.9655172413793103, 1.0510204081632653, 1.4316546762589928, 1.0, 1.2246208498428748, 2.5813953488372094, 1.0, 1.5909090909090908, 1.5, 1.6, 10.0, 5.5, 1.0, 1.0, 13.0, 1.0, 1.0, 1.3448275862068966, 1.375, 2.1315789473684212, 1.4230769230769231, 1.0, 7.0, 1.1, 1.250809061488673, 1.0004771273014856, 1.5405405405405406, 1.041027006466337, 1.7019230769230769, 1.0649811234412538, 2.2243125904486254, 1.2333333333333334, 6.0, 1.1126760563380282, 1.0, 1.113821138211382, 1.0430625550399988, 1.0, 1.045449694900127, 1.0340275326509, 1.0955210237659962, 1.0, 4.666666666666667, 1.0, 1.0051020408163265, 11.0, 2.0, 1.0, 1.4624664879356568, 1.6666666666666667, 3.1578947368421053, 1.0, 1.0, 1.2514619883040936, 1.0, 1.3076923076923077, 1.0, 1.0, 4.25, 1.0, 1.0070830650354152, 1.0, 1.0, 1.0, 1.0, 1.059088737243179, 7.0, 4.666666666666667, 1.0240945365254757, 1.0, 1.5, 7.0, 1.0, 1.007611389268194, 1.8108108108108107, 4.0, 1.0, 1.0, 1.0239043083562764, 1.0532952607270847, 1.0, 2.75, 7.0, 2.0, 1.0, 1.9866666666666666, 1.0247174113423567, 1.0, 1.4626540971718636, 1.1343283582089552, 1.0, 1.0, 1.0050761421319796, 1.7419354838709677, 13.0, 1.0, 1.0138856413115815, 1.3134208565040417, 1.4, 1.2777777777777777, 1.75, 1.0, 1.0, 1.0, 1.1379069958172723, 1.6666666666666667, 1.0, 1.2655538694992412, 7.0, 1.0, 1.0048076923076923, 1.0, 1.0, 1.228813559322034, 1.6666666666666667, 1.0625, 1.1654411764705883, 1.0788211103495544, 1.0, 7.0, 2.0, 1.0, 1.0, 1.101286201464504, 1.0, 1.0, 1.1060311284046693, 1.4094488188976377, 1.0, 1.0, 1.0, 1.0, 1.0621468926553672, 5.0, 1.4851374088614695, 1.0015451741099963, 1.0, 2.0, 1.044543429844098, 1.0, 1.0, 1.0, 1.2203389830508475, 1.236842105263158, 1.0, 7.0, 1.2809782608695652, 1.533210332103321, 1.2206703910614525, 1.0, 1.069915254237288, 3.0, 2.0, 1.0478630502902349, 5.0, 1.047036328871893, 1.0, 1.0, 1.0, 1.1141812105836926, 2.857142857142857, 2.0, 2.5, 1.0, 7.0, 9.0, 1.5, 3.0, 1.102189781021898, 1.4396413845724934, 2.0, 2.0, 1.0, 1.2023121387283238, 6.0, 20.0, 1.0091743119266054, 1.0, 1.124186200255817, 1.8251748251748252, 1.1071428571428572, 2.0, 8.0, 1.0, 1.0, 1.0, 6.0, 1.181735985533454, 2.8298755186721993, 1.8333333333333333, 2.0, 1.0, 1.0423657718120805, 1.0, 11.0, 3.875, 7.0, 1.3500473036896878, 7.0, 1.0, 1.96137339055794, 2.0, 1.0024324079189306, 1.0, 1.0, 1.115069615069615, 1.0, 1.0, 1.2352941176470589, 2.5, 1.3333333333333333, 1.1287128712871286, 1.3911894273127754, 5.0, 2.0, 2.25, 1.3725490196078431, 1.0, 2.1770833333333335, 1.0, 1.0390334572490707, 1.0, 1.0909090909090908, 1.0275653327092598, 1.2, 1.0229022505393646, 1.4464285714285714, 1.0, 3.0, 1.047244094488189, 1.0, 1.1129032258064515, 1.8695652173913044, 1.2747368421052632, 1.4581447963800904, 1.0, 1.0, 1.0, 1.1513002364066194, 1.9473684210526316, 1.1566111881645862, 1.0455089820359282, 1.0, 7.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.2671232876712328, 1.0478830953985663, 2.16, 1.0, 1.0, 1.5517241379310345, 2.0, 7.0, 7.0, 1.0, 1.0, 1.0, 1.0, 1.0848316885223739, 1.0, 2.0, 1.525390625, 1.0, 1.0, 1.0, 12.5, 3.3333333333333335, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0345668971126476, 1.084568439407149, 2.0, 1.0, 1.0, 1.0376040093809233, 1.0, 1.0, 1.0, 2.625, 1.4095812182741116, 1.0, 2.0, 1.3, 1.4172077922077921, 1.0, 1.0, 1.5, 1.0, 1.0, 1.0018410555385087, 1.0, 2.0, 1.1036757775683317, 1.0, 1.0, 1.0861035422343324, 1.0, 1.0692959451281017, 1.0, 1.0, 10.0, 1.0096153846153846, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0209252730991862, 1.0159773617762298, 1.0, 13.0, 2.909090909090909, 1.0, 2.3333333333333335, 4.416666666666667, 1.0, 1.0, 1.0189883317170831, 1.0, 1.0, 1.8571428571428572, 27.25, 1.088235294117647, 1.3896103896103895, 1.1545454545454545, 1.0, 1.8888888888888888, 1.0, 1.0, 1.0, 3.0, 14.0, 1.0, 1.0, 1.0, 1.0, 2.5, 1.0, 1.0124976581793408, 1.1548889423165838, 1.0240963855421688, 1.0, 2.0, 1.0, 1.8847457627118644, 1.0, 8.0, 4.0, 1.0457069628363946, 1.045158988184918, 1.0, 1.0, 5.25, 2.0, 1.0, 3.2222222222222223, 1.0, 1.0, 1.0, 1.1828793774319066, 1.0, 6.0, 6.0, 1.0341685649202734, 1.25, 1.0, 4.0, 1.0742857142857143, 1.027180324893366, 1.0, 7.0, 1.0484603735487128, 1.0371293296785447, 1.220125786163522, 1.5, 10.0, 1.0, 1.1192910702113157, 1.2020833333333334, 4.39622641509434, 9.0, 1.0, 11.0, 1.0910834132310643, 1.0, 1.3235294117647058, 1.0, 1.0, 1.3636363636363635, 6.0, 1.5, 2.0, 1.0, 1.023682310469314, 1.5403726708074534, 1.1678594664931685, 1.0, 1.0, 3.0, 12.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 9.0, 1.1836158192090396, 2.0, 1.0719193192562244, 2.5, 1.0, 1.0, 1.0778688524590163, 1.0, 2.0, 1.375, 1.2595322826639552, 1.1024335031126202, 1.1761846901579587, 1.0, 6.0, 8.0, 1.0, 3.0, 1.0, 3.0, 1.3073170731707318, 1.0, 1.0, 6.0, 1.0, 1.0219263899765074, 1.083791653186671, 6.0, 1.0, 1.5031847133757963, 1.6818181818181819, 2.0, 1.1770334928229664, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 2.0, 7.0, 1.4, 1.099197391522448, 1.8, 1.0, 1.125, 1.0, 1.6470588235294117, 2.0, 3.0, 1.0, 1.1295489617721173, 2.0, 1.0, 1.0, 1.0397849462365591, 1.1174843106822323, 1.0, 1.3333333333333333, 7.0, 1.229026845637584, 1.0, 1.0393641810918774, 4.0, 1.0761221331082031, 1.6196319018404908, 1.3544344576527818, 1.0, 1.1421319796954315, 3.0, 1.0, 1.0, 1.0, 6.5, 1.1428571428571428, 13.0, 7.0, 1.0, 4.0, 1.0, 1.0, 1.0, 1.174731182795699, 3.0, 1.0, 7.0, 1.6627282491944146, 2.45, 1.0, 1.0, 1.2807551766138856, 6.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0834784050402055, 1.125, 1.0, 2.25, 1.1671732522796352, 9.0, 1.0, 1.4285714285714286, 1.0521920668058455, 1.0, 1.2602602602602602, 1.0, 1.0, 1.0, 10.0, 1.3911042944785277, 1.0, 1.0, 1.0, 1.0, 1.213768115942029, 6.0, 1.0, 1.0, 1.0, 1.0, 1.0238095238095237, 1.0, 4.0, 1.5, 1.0, 1.7393292682926829, 3.0, 1.2418300653594772, 1.0, 1.468944099378882, 1.0, 1.0, 5.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.4246575342465753, 1.0467292061296691, 7.0, 1.0213578168435065, 4.666666666666667, 1.0, 1.0, 1.1261627906976743, 1.0, 1.467065868263473, 1.5340253748558246, 1.0, 1.0, 4.333333333333333, 1.75, 2.75, 7.0, 1.0558364726659817, 3.0, 1.0137018114259173, 1.1636363636363636, 1.0, 10.0, 2.0, 1.0, 1.1538461538461537, 1.0, 14.0, 1.0, 1.2, 1.0, 1.0, 1.0, 7.0, 1.010770121598147, 1.3199167244968772, 1.0, 1.0, 2.2857142857142856, 1.0521042084168337, 1.0, 2.0, 1.3056686190807107, 1.0588235294117647, 2.5, 1.1297709923664123, 1.0, 1.0, 1.0, 1.64, 1.0, 1.0241105557189063, 2.0, 1.0, 2.0, 1.5151515151515151, 4.461538461538462, 1.1333333333333333, 1.0888888888888888, 4.0, 1.002285301900409, 1.0, 1.1325478645066274, 1.005645320104654, 11.0, 1.1264929019861187, 8.0, 1.16, 1.0, 1.0, 1.648565965583174, 2.0, 7.0, 1.0, 1.1396648044692737, 1.0, 1.042687747035573, 1.5, 1.0, 6.0, 1.1702127659574468, 1.0, 1.0, 1.4, 1.1318739989321944, 11.0, 2.1578947368421053, 10.0, 1.0629206906643254, 1.5, 1.0068678338368076, 1.0, 1.0, 1.0, 1.0]
origin-forest_39.80 	max: 27.2500	99th: 12.5050	95th: 7.0000	median: 1.0889	mean: 2.0973

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 13/15 | Workload-time: 28.662213 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 14/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=valueskew', '--dataset=forest', '--drift_test=distribution', '--end2end', '--update_size=25000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
GET-DATASET-PATH=./data/forest/end2end/forest.npy
ValueSample - START
ValueSample - END
load_npy_dataset_from_path - df.shape = (756012, 10)
Parsing... done, took 0.1s
Data updated!
Previous data size: (731012, 10), new data size: (25000, 10)
[1.1920929e-07 0.0000000e+00 5.9604645e-08 5.9604645e-08 1.7881393e-07
 0.0000000e+00 0.0000000e+00 0.0000000e+00 2.6488304e-04 5.9604645e-08]
Distance score: 2.6535988581599668e-05
SAUCE Drift detection: True
Detection latency: 0.1012s

DRIFT-DETECTED after 14-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=forest', '--end2end', '--model=transformer', '--model_update=adapt', '--update_size=25000', '--epochs=40']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
update_size: 25000
AdaptTask - START
GET-DATASET-PATH=./data/forest/end2end/forest.npy
load_npy_dataset_from_path - df.shape = (756012, 10)
Parsing... done, took 0.1s
done, took 0.1s
dataset size: 756012
train data shape: torch.Size([25000, 10]), transfer data shape:torch.Size([5000, 10])
Epoch 0 Iter 0, train entropy gap 17.7997 bits (loss 36.641, data 18.841) 0.00300 lr
epoch 10 train loss 21.2154 nats / 30.6074 bits
time since start: 6.1 secs
Epoch 10 Iter 0, train entropy gap 11.5339 bits (loss 30.375, data 18.841) 0.00256 lr
epoch 20 train loss 19.8793 nats / 28.6798 bits
time since start: 12.1 secs
Epoch 20 Iter 0, train entropy gap 9.8281 bits (loss 28.669, data 18.841) 0.00150 lr
epoch 30 train loss 19.3635 nats / 27.9356 bits
time since start: 17.9 secs
Epoch 30 Iter 0, train entropy gap 8.9326 bits (loss 27.773, data 18.841) 0.00044 lr
epoch 40 train loss 19.2723 nats / 27.8041 bits
time since start: 23.9 secs
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 39.3235 nats / 56.7319 bits
Saved to: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
AdaptTask - END

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 14/15 | Workload-time: 2.307065 | Model-update-time: 26.945871


WORKLOAD-START | Type: QueryWorkload | Progress: 15/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=forest', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=15', '--data_update=valueskew', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt')]
Validate Argument: DATASET="forest" is valid.
data size: 756012, total size: 756012, split index: [630010 756012]
Parsing... done, took 0.1s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-forest-2.0MB-model58.950-data19.148-300epochs-seed0.pt
query_seed:0
origin-forest_39.80 	max: 35.0000	99th: 15.9100	95th: 9.0000	median: 1.1122	mean: 2.3431
ReportEsts: [1.0, 1.2975122694195296, 1.0, 1.1486486486486487, 4.0, 1.0, 1.391304347826087, 1.0, 1.944954128440367, 1.0, 1.0246913580246915, 5.0, 1.0, 2.5, 1.3507462686567164, 1.2297297297297298, 1.0, 6.0, 35.0, 2.5, 1.0, 1.1, 1.0, 1.0, 1.0930232558139534, 8.0, 1.2990437554332077, 4.0, 9.0, 1.540983606557377, 4.5, 1.0, 1.0, 8.0, 1.0, 2.0, 1.0, 8.0, 1.0, 3.25, 1.0, 1.0, 1.625, 1.0, 1.032520325203252, 1.4658119658119657, 1.0, 2.0, 26.0, 1.0, 3.0, 1.8047658288696609, 1.0, 1.0, 1.3823529411764706, 2.8461538461538463, 1.0369706007362423, 5.0, 8.0, 1.5, 1.0133818523300857, 17.0, 7.0, 1.0, 1.8253968253968254, 1.0471698113207548, 12.0, 1.0, 1.625, 1.0, 1.0, 1.0091324200913243, 1.1902454780361758, 1.5217391304347827, 1.0, 1.0803858520900322, 9.0, 1.0, 1.0, 1.0, 8.0, 2.7058823529411766, 1.0, 1.0438951065459643, 1.0, 1.0423965110459712, 9.0, 1.0227272727272727, 1.4576271186440677, 1.0, 1.0, 1.341419261404779, 1.0, 1.0, 1.0018119758965067, 1.0, 1.0078072719161275, 8.0, 1.2027334851936218, 17.0, 1.3155737704918034, 1.0, 1.6666666666666667, 9.0, 1.0, 1.423913043478261, 1.1904761904761905, 1.0031182537778844, 4.25, 1.5897435897435896, 1.0, 1.162162162162162, 2.380952380952381, 1.0, 1.25, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0, 2.6, 1.0, 1.0, 1.5333333333333334, 1.144736842105263, 1.736842105263158, 12.0, 1.0980392156862746, 2.0, 14.0, 1.220629750271444, 1.0, 1.0, 5.0, 1.0151431209602955, 1.1323938260952928, 2.0, 1.60075329566855, 1.0, 1.064623955431755, 3.24, 1.0, 1.1952941176470588, 1.0612244897959184, 1.0, 1.0, 1.150974025974026, 1.1195377128953772, 11.0, 1.0, 2.0, 1.0309719551112708, 1.0, 1.0, 2.75, 1.5909090909090908, 7.0, 1.0, 1.0, 4.0, 1.0, 1.0, 1.0, 1.6666666666666667, 10.0, 1.0, 1.0292138949242167, 4.0, 1.0290272625778802, 7.0, 5.5, 6.0, 1.0365058670143417, 1.0, 1.0, 1.5220883534136547, 1.0, 1.3152505578001568, 1.187812187812188, 1.0, 1.000962746841676, 1.8135593220338984, 1.2137508509189925, 1.0, 5.333333333333333, 1.0, 1.0, 8.0, 3.0, 1.0, 1.0674312560453227, 1.0, 1.0, 8.0, 1.1646901072705602, 1.0, 1.2268041237113403, 1.1861737244176176, 2.0, 1.1153846153846154, 1.1923076923076923, 1.3726682554030734, 1.0, 1.0, 7.0, 1.0, 3.857142857142857, 1.0, 1.0, 1.0, 6.0, 1.7387616624257847, 2.857142857142857, 1.2926829268292683, 1.2777777777777777, 1.0, 9.0, 1.1403508771929824, 1.0, 1.0, 1.0, 1.0, 6.0, 1.4, 1.0, 1.0, 2.0, 1.0, 1.0, 1.0046028880866427, 1.1118634088901973, 1.5, 1.0, 1.009893824786113, 1.0, 15.0, 1.0, 1.0, 1.1818181818181819, 7.0, 4.5625, 1.0, 2.0, 5.0, 1.112230215827338, 1.0623346074683917, 1.0, 1.0, 8.0, 1.0, 2.0, 1.0909090909090908, 1.0, 1.496941896024465, 10.0, 3.466666666666667, 7.0, 1.2903225806451613, 1.3717277486910995, 1.0, 1.8579234972677596, 1.0431355729221787, 1.2727272727272727, 2.0, 1.1538461538461537, 1.2484848484848485, 1.1666666666666667, 1.0, 1.0997192776637197, 1.0, 1.3333333333333333, 1.0, 1.1428571428571428, 1.0, 1.0, 1.0, 1.6571428571428573, 1.0, 3.0313852813852815, 1.2388059701492538, 1.0, 1.034548944337812, 1.0, 1.178082191780822, 1.6216216216216217, 4.2105263157894735, 1.0, 3.25, 1.1266540642722118, 1.1078938854739566, 1.0636501493248927, 1.5, 1.7916666666666667, 7.0, 1.0, 1.549272116461366, 1.0, 2.7142857142857144, 8.0, 1.8783068783068784, 1.0, 1.0, 2.6666666666666665, 1.4285714285714286, 1.0, 1.0, 1.2857142857142858, 1.0193603272575886, 1.0457142857142858, 15.909090909090908, 8.0, 1.4090909090909092, 1.0, 1.0, 1.0, 1.0, 1.542857142857143, 2.0, 2.0, 1.4615384615384615, 9.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.28, 1.0, 1.0, 1.1891154278375342, 3.0, 1.0, 1.0832574654042244, 8.0, 1.0, 1.0, 1.0, 1.2465373961218837, 1.0, 3.0, 4.0, 1.0, 1.9196428571428572, 1.8108573890564412, 1.0, 1.8774509803921569, 1.0, 1.1985616010006255, 1.5, 1.0, 2.0588235294117645, 1.0, 1.6, 10.0, 6.0, 1.0, 1.0, 15.0, 1.0, 1.0, 1.25, 2.0, 1.1571428571428573, 1.4736842105263157, 1.0, 8.0, 1.8777777777777778, 1.3791946308724832, 1.0062418182853023, 1.0740740740740742, 1.0409865022005682, 1.8148148148148149, 1.0422583997228958, 1.975093399750934, 1.1103896103896105, 7.0, 1.1932773109243697, 1.0, 3.9375, 1.0599026717973712, 1.0, 1.0646491918851015, 1.0055383252104564, 1.001817080557238, 1.0, 5.0, 2.0, 1.1862745098039216, 12.0, 2.0, 1.0, 1.1195652173913044, 1.8333333333333333, 2.4444444444444446, 1.0, 1.0, 1.1336898395721926, 1.4444444444444444, 4.357142857142857, 1.0, 1.0, 2.25, 1.0, 1.0, 1.0, 1.6875, 1.0, 1.0, 1.0, 1.0, 1.0657894736842106, 1.0, 1.416117006022369, 1.5, 1.0, 1.5, 1.0, 1.007318754925138, 2.6666666666666665, 1.7636363636363637, 1.0, 1.0, 1.0044301394137751, 1.0901070236679582, 1.0, 11.0, 4.0, 2.0, 1.0, 2.0, 1.0038178472861086, 1.0, 2.339907192575406, 10.857142857142858, 1.0, 1.0, 1.053921568627451, 2.32, 16.0, 1.0, 1.0673204385495931, 1.4342055840741204, 1.2, 1.05, 1.3214285714285714, 1.0, 1.0, 1.0, 1.0977107651122966, 1.6666666666666667, 1.0, 1.992831541218638, 9.0, 1.0, 1.0497512437810945, 1.0, 1.0, 1.1221374045801527, 1.6666666666666667, 1.1333333333333333, 1.3915254237288135, 1.0270805812417436, 1.0, 8.0, 2.0, 1.0, 1.0, 1.1230862500320205, 1.0, 1.0, 1.1868544600938966, 1.5982905982905984, 8.0, 1.0, 2.75, 1.0, 1.0, 1.0, 4.5, 1.0050215208034434, 1.0601408912188728, 1.8555045871559632, 1.0679775280898876, 1.4, 1.0, 2.0, 1.6904761904761905, 1.0, 1.0499739266469668, 12.0, 1.0, 2.0, 2.1507479861910244, 1.2461538461538462, 1.0, 1.0461236506378804, 1.0, 1.1121800377941935, 1.0, 1.0408163265306123, 1.0, 1.0, 1.0, 1.1256575447721497, 1.128125, 2.0, 1.5625, 1.0, 8.0, 9.0, 1.4444444444444444, 3.0, 1.2479338842975207, 1.4081689433575593, 2.0, 1.0, 1.0, 1.17, 7.0, 20.0, 1.209090909090909, 1.0, 1.0274583333333334, 1.3814432989690721, 1.125, 1.0, 9.0, 1.0, 1.0, 2.1379310344827585, 1.1191715237302249, 1.0600764087870105, 1.2105263157894737, 1.5625, 1.0, 1.0, 2.5, 2.6470588235294117, 1.0, 1.0, 1.0, 1.1890909090909092, 1.0, 1.0, 1.4, 1.009712260333231, 1.6703296703296704, 1.0036563071297988, 1.3333333333333333, 1.4485981308411215, 1.0, 1.868421052631579, 1.0043525571273122, 20.0, 2.75, 1.411764705882353, 1.3303498779495524, 1.0, 2.0, 2.25, 1.311926605504587, 1.0, 2.0784313725490198, 1.0, 1.9031141868512111, 1.0, 2.0, 1.053427814681412, 4.666666666666667, 1.0052843959437172, 1.9285714285714286, 1.0, 3.0, 1.1226053639846743, 1.0, 1.0416666666666667, 3.0, 1.571011673151751, 1.9861325115562403, 1.0, 1.0, 1.0, 1.3577235772357723, 2.2222222222222223, 1.0299325945390152, 1.0288101771015217, 1.0, 8.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 2.0, 2.676056338028169, 1.0262413719706875, 1.9228486646884273, 1.0, 1.0, 9.0, 1.5416666666666667, 4.5, 1.574468085106383, 2.908256880733945, 2.736842105263158, 3.0, 1.0, 1.0, 1.0496646842971025, 2.0, 2.0, 1.6442105263157896, 1.0, 1.0, 1.0, 1.5, 1.5, 1.5, 1.0, 1.0, 1.0, 2.75, 2.0340395970823204, 1.1205832865956253, 1.5, 1.0, 1.0, 1.0060955250304777, 1.0, 8.0, 1.0, 1.4, 1.389288439168991, 1.0, 1.0, 2.1666666666666665, 1.0455259026687598, 1.0, 5.0, 2.5, 1.0, 1.0, 1.0143817355713267, 1.0, 2.0, 1.0178107606679034, 1.0, 1.0, 1.022349365278026, 1.0, 1.146919431279621, 1.0, 1.0, 12.0, 1.2319173363949483, 1.0, 1.0, 1.0, 1.6, 1.0, 1.0404592627535547, 1.0612361526288026, 1.0, 15.0, 1.96875, 1.0, 2.3333333333333335, 2.076923076923077, 1.0, 1.0, 1.0336906584992342, 1.0, 1.0, 1.7647058823529411, 2.0458715596330275, 1.4803921568627452, 1.3445378151260505, 1.295, 2.0, 2.2222222222222223, 1.5, 1.0, 1.0, 2.0, 16.0, 1.0, 1.0, 1.0, 1.0, 1.2222222222222223, 1.0, 1.0121144685599912, 1.087850166362563, 1.3333333333333333, 1.0, 2.0, 1.5, 1.6547619047619047, 1.0, 9.0, 4.0, 1.1341354723707664, 1.0565034429992348, 1.0, 1.0, 4.25, 2.0, 1.0, 2.8181818181818183, 1.0, 1.0, 1.0, 1.2146118721461188, 1.0, 7.0, 7.0, 1.1415607985480944, 1.125, 1.0, 2.0, 1.0824175824175823, 1.0149884704073788, 1.0, 8.0, 1.0550660792951543, 14.0, 1.1987951807228916, 1.0, 1.1577235772357723, 1.4565217391304348, 1.0, 1.0180180802830918, 1.0, 1.0, 3.0, 1.2857142857142858, 1.3333333333333333, 1.1335403726708075, 1.0, 2.0, 2.272727272727273, 1.102376137512639, 8.0, 1.0, 2.3149606299212597, 9.0, 1.0, 5.0, 1.0, 1.0, 1.0, 1.4797687861271676, 8.0, 1.0, 7.333333333333333, 1.0, 1.0909090909090908, 2.8, 1.0, 1.0, 8.0, 1.9636706861347613, 1.0, 8.857142857142858, 1.375, 1.0, 1.032258064516129, 1.0, 1.1428571428571428, 1.380225988700565, 1.0, 2.0, 1.5625, 1.0758054327226785, 1.108158932362754, 1.051094890510949, 1.0, 7.0, 5.5, 1.0, 3.0, 1.0, 2.0, 1.2234042553191489, 11.0, 1.0, 7.0, 1.0, 1.0684014869888476, 1.047752808988764, 3.5, 1.0, 1.732394366197183, 1.95, 2.0, 1.0185185185185186, 1.0, 1.0, 1.0, 1.0, 1.0, 2.6666666666666665, 2.0, 8.0, 1.1473922902494331, 1.037740164684355, 1.7272727272727273, 1.0, 1.4, 1.0, 1.4, 1.0, 3.0, 1.0, 1.1506892806416575, 2.25, 1.0, 1.0, 1.1294565593631014, 1.0604819109784043, 1.0, 1.5, 8.0, 1.0494505494505495, 1.0, 1.0139224207307258, 2.0952380952380953, 1.0686631593147173, 2.8820224719101124, 1.3215909762003188, 1.0, 1.0517985611510792, 3.0, 1.0, 1.0, 1.0, 1.0, 1.2142857142857142, 15.0, 8.0, 2.5, 4.0, 1.0, 1.0, 1.0, 1.9159067882472138, 3.0, 1.0, 8.0, 1.6955093099671412, 1.2156862745098038, 1.0, 2.0, 1.1318327974276527, 4.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0714622641509435, 1.0, 1.0, 5.0, 1.4180327868852458, 11.0, 1.0, 10.0, 1.3287128712871288, 18.0, 1.171261758027895, 1.0, 1.0, 15.0, 3.688888888888889, 1.0, 1.1111111111111112, 1.0, 4.0, 2.0, 1.0193616521943205, 1.0, 1.0, 1.2765957446808511, 1.0, 1.0, 2.4705882352941178, 1.0, 4.0, 1.7058823529411764, 1.0, 2.2793629727936295, 3.0, 1.0576923076923077, 1.0, 1.4927113702623906, 1.0, 1.0, 1.25, 1.0, 1.0, 1.0, 2.0, 1.0, 1.5678391959798994, 1.128668236375122, 8.0, 1.0396053625377644, 9.0, 7.0, 2.4239130434782608, 1.183179723502304, 1.2, 1.2222222222222223, 1.813953488372093, 1.0, 1.3981481481481481, 1.0, 7.0, 1.0, 1.0, 1.057587237771249, 3.0, 1.188041787063792, 1.3095238095238095, 1.0, 13.0, 2.0, 1.0, 1.3571428571428572, 1.0, 17.0, 1.0, 6.0, 1.0, 1.0, 1.0, 9.0, 1.0519408297186075, 1.3585349462365592, 1.0, 1.0, 1.7777777777777777, 1.0278293135435992, 1.0, 2.0, 1.4163256515184148, 1.6363636363636365, 2.5, 1.2462686567164178, 1.0, 1.0, 1.0, 1.162162162162162, 1.0, 1.0423331494760066, 2.0, 1.0, 1.0, 1.8518518518518519, 1.7723577235772359, 1.2894736842105263, 1.4375, 2.0, 1.0370714101572571, 1.0, 1.136021505376344, 1.0090121238314036, 14.0, 1.0517349177840523, 10.0, 1.8571428571428572, 1.0, 1.0, 1.2114655051285654, 2.0, 9.0, 1.0, 1.0741599073001158, 1.0, 1.0496924969249692, 3.0, 1.0, 7.0, 1.0289855072463767, 1.0, 3.0, 2.0, 1.0440608675902794, 13.0, 1.2260869565217392, 12.0, 1.123770231672485, 1.5, 1.0397268204280596]
origin-forest_39.80 	max: 35.0000	99th: 15.9100	95th: 9.0000	median: 1.1122	mean: 2.3431

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 15/15 | Workload-time: 28.556351 | Model-update-time: 0.000000


Experiment Summary: #data-update-times=7, #drift=7 | total-time=432.373298