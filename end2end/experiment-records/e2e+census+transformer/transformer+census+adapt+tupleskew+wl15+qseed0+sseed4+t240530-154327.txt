Input arguments = Namespace(data_update='tupleskew', update_size=4000, dataset='census', debug=False, drift_test='distribution', model_update='adapt', model='transformer', end2end=False, query_seed=0, random_seed=42, num_workload=15)
JSON-passed parameters = {'data_updater': {'skew_ratio': '1e-2'}, 'random_seed': 4, 'transformer': {'epochs': 0}}
MODEL-PATH=/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-census-2.8MB-model16.858-data14.989-200epochs-seed0.pt
DATASET-PATH=/home/kangping/code_copy/SAUCE/data/census/end2end/census_int.npy
Workloads: ['QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload', 'DataUpdateWorkload', 'QueryWorkload']

WORKLOAD-START | Type: QueryWorkload | Progress: 1/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=census', '--model=transformer', '--query_seed=0', '--end2end', '--eval_type=first_estimate', '--num_workload=15', '--data_update=tupleskew', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-census-2.8MB-model16.858-data14.989-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-census-2.8MB-model16.858-data14.989-200epochs-seed0.pt')]
Validate Argument: DATASET="census" is valid.
load_csv_dataset - census (32561, 13)
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-census-2.8MB-model16.858-data14.989-200epochs-seed0.pt
query_seed:0
origin-census_1.87 	max: 13.0000	99th: 4.6680	95th: 2.1708	median: 1.0909	mean: 1.3560
ReportEsts: [1.0, 1.0260707635009312, 1.0985915492957747, 2.0, 1.1206896551724137, 1.0708154506437768, 1.2857142857142858, 1.7142857142857142, 1.0, 1.0, 1.0, 1.0136054421768708, 1.25, 1.0240963855421688, 1.1055555555555556, 1.5, 1.4064516129032258, 1.0, 2.0, 1.0, 6.0, 2.0, 1.163677130044843, 2.0, 1.0440251572327044, 1.0, 1.0, 1.0202052597819116, 1.0, 1.0359746061603574, 1.0734448510193413, 1.2758620689655173, 1.1296296296296295, 1.5555555555555556, 1.0, 1.2857142857142858, 1.0, 1.1475409836065573, 1.125, 1.0277023356871267, 2.0, 1.0, 2.0, 1.0, 1.48, 1.02, 1.0, 1.0875287923659098, 1.0, 2.0, 1.0, 2.0, 1.0, 1.1428571428571428, 1.1720430107526882, 13.0, 1.0657894736842106, 1.75, 1.0293663060278206, 1.1528662420382165, 1.1111111111111112, 1.7142857142857142, 1.0576923076923077, 1.0256410256410255, 1.0, 1.0, 1.0, 1.2364729458917836, 1.0, 1.1666666666666667, 1.0555555555555556, 1.4545454545454546, 1.5, 1.0, 1.0833884844473858, 1.0, 1.0, 4.8, 2.5, 1.0, 1.0, 1.0, 1.5, 1.25, 1.1626016260162602, 1.6666666666666667, 1.0, 1.108695652173913, 1.014459121742235, 1.0, 1.0909090909090908, 1.0, 1.2156862745098038, 1.0, 1.1895424836601307, 3.0, 1.0324324324324323, 2.5, 1.0140845070422535, 1.2083333333333333, 2.0, 2.0, 1.0, 1.0909090909090908, 1.0, 1.238938053097345, 1.436241610738255, 1.3333333333333333, 1.417857142857143, 1.4375, 1.3333333333333333, 1.0, 2.5555555555555554, 4.5, 1.2222222222222223, 1.0, 1.0, 1.103448275862069, 1.5, 1.0611854684512427, 1.0, 1.0602205258693809, 1.3424124513618676, 1.4, 1.011802575107296, 1.1538461538461537, 1.0155599782884024, 1.0718874273478127, 1.1025641025641026, 1.1106194690265487, 1.0, 1.14959928762244, 2.0, 1.0, 1.0, 1.0, 1.0698869475847894, 2.0, 2.0, 1.2857142857142858, 1.0, 1.9714285714285715, 1.0, 1.0, 2.0, 2.0, 1.0, 1.0, 1.0188284518828452, 1.0901639344262295, 1.5789473684210527, 1.25, 2.0, 1.0, 1.0, 1.5, 3.0, 1.0, 2.0, 4.0, 2.0, 1.5, 1.625, 1.0769230769230769, 1.0773809523809523, 1.0741525423728813, 1.0116959064327486, 1.0356891289034984, 1.127439024390244, 1.1116071428571428, 1.0504767246214246, 1.25, 2.0, 2.0, 1.8823529411764706, 1.4578313253012047, 1.0, 1.0267260579064588, 1.0898245614035087, 1.2911392405063291, 2.0, 1.1304347826086956, 1.0204081632653061, 1.305084745762712, 1.5263157894736843, 1.0670683783075714, 1.5, 1.0, 1.0833333333333333, 1.2798353909465021, 1.4157303370786516, 1.44, 1.0033262057495842, 1.0, 1.1333333333333333, 1.0638297872340425, 1.0374291817590786, 1.0, 1.16, 1.062857142857143, 1.0, 1.7254901960784315, 1.1067961165048543, 2.2857142857142856, 2.0, 1.4, 1.0, 1.0526315789473684, 2.0, 1.0, 1.1084656084656084, 1.2298850574712643, 1.0714285714285714, 1.6666666666666667, 1.0, 2.0, 1.0192307692307692, 1.133523628290517, 1.2814814814814814, 1.4038461538461537, 1.0, 1.2222222222222223, 1.0589225589225588, 1.9423076923076923, 1.0, 1.1578947368421053, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0833333333333333, 1.5, 1.146067415730337, 1.0, 1.0, 2.0, 1.0, 1.0239043824701195, 2.0, 1.0, 1.0252808988764044, 1.0, 1.0, 1.5, 1.7142857142857142, 1.380952380952381, 1.0, 2.0, 1.148936170212766, 2.0, 1.1549295774647887, 1.0588235294117647, 1.0, 2.0, 1.6666666666666667, 1.4, 1.4173913043478261, 1.1818181818181819, 1.0332473488105474, 1.0, 2.0, 2.25, 3.1818181818181817, 9.0, 1.0, 1.1428571428571428, 1.0895522388059702, 2.0, 1.1428571428571428, 1.1724137931034482, 1.0, 1.0, 1.0, 1.153159671972986, 1.0807453416149069, 1.0, 1.102803738317757, 1.0, 2.0, 1.2727272727272727, 1.3414634146341464, 1.0568181818181819, 1.0, 1.0864197530864197, 1.0, 1.108359133126935, 1.5, 1.1009174311926606, 2.0, 1.1333333333333333, 1.038936727817297, 2.0, 1.0077777777777779, 1.065040650406504, 1.0, 2.0, 1.037037037037037, 1.0347490347490347, 1.0204081632653061, 1.3333333333333333, 2.0, 1.0, 1.2222222222222223, 1.0352112676056338, 1.0816326530612246, 2.0, 1.1345565749235473, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0142857142857142, 1.0, 1.0, 1.0, 1.059311981020166, 1.0, 1.026091516979153, 1.0, 1.1763662171753015, 1.0, 1.0, 1.0885922330097086, 1.0769230769230769, 2.0, 1.0047405846721096, 2.0, 1.0024502297090352, 1.0, 1.2232472324723247, 2.0, 1.0711201422402845, 1.0, 1.0, 2.0, 1.75, 1.0, 1.2840909090909092, 1.4, 1.1538461538461537, 1.0, 2.1666666666666665, 1.0980392156862746, 2.0, 1.0909090909090908, 1.0, 1.0, 1.0, 1.0, 1.0, 1.6666666666666667, 1.0, 1.4, 1.023554227456495, 1.0434782608695652, 6.0, 1.0, 2.5, 1.0352771778257739, 1.5, 1.0, 1.1666666666666667, 1.0, 1.1818181818181819, 1.0, 1.1169415292353824, 1.48, 1.0, 1.1209677419354838, 1.8333333333333333, 1.0, 1.0, 1.3333333333333333, 1.0, 1.0, 1.1111111111111112, 1.0666666666666667, 1.0975609756097562, 1.0049019607843137, 2.0, 1.256198347107438, 1.4, 1.0, 1.0689655172413792, 1.0, 1.0, 1.0, 2.0, 1.5, 1.1540178571428572, 3.0, 1.0, 1.625, 1.1818181818181819, 1.2083333333333333, 1.0, 2.0, 1.0, 1.0, 1.078125, 1.0, 1.1020408163265305, 2.423076923076923, 2.0, 1.03784344219803, 1.074766355140187, 1.0833333333333333, 1.8571428571428572, 1.0714285714285714, 2.0, 2.0, 3.2, 1.0, 1.1140350877192982, 1.2608695652173914, 2.5, 1.0344827586206897, 1.625, 1.35, 1.0, 1.0311626907371587, 1.0, 1.8571428571428572, 1.0119426751592357, 1.0135135135135136, 1.0053763440860215, 1.9411764705882353, 1.4310344827586208, 1.0, 1.0, 1.2222222222222223, 2.5, 1.1692307692307693, 1.0, 1.0161662817551964, 1.0, 1.2207357859531773, 1.0, 2.0, 1.0909090909090908, 2.0, 1.0, 2.0, 1.0869565217391304, 1.0, 1.5, 1.0831099195710456, 1.1176470588235294, 1.0941080196399344, 1.0476190476190477, 1.0, 1.0, 3.2, 1.4794520547945205, 2.0, 1.0032786885245901, 1.0048661800486618, 1.0, 1.0238858141567142, 1.1818181818181819, 2.0, 1.1578947368421053, 1.0, 1.0888888888888888, 3.0, 1.0, 1.0381206620395087, 1.1304347826086956, 1.183673469387755, 1.0, 1.0, 1.0, 1.2222222222222223, 1.6140350877192982, 1.0833333333333333, 1.046641791044776, 1.0, 2.0, 1.0, 7.0, 1.0268199233716475, 1.0, 1.0, 2.0, 2.0, 1.3073593073593073, 2.0, 1.0, 1.0, 2.0, 1.196969696969697, 2.0, 1.0833333333333333, 1.2727272727272727, 2.3, 1.1978891820580475, 1.0317343173431734, 1.0972222222222223, 2.0, 2.0, 1.0434782608695652, 7.0, 1.0, 1.0680453635757172, 1.1321961620469083, 1.0, 1.0, 1.039179104477612, 1.6, 2.0, 1.1403940886699508, 1.0400667779632722, 1.0, 1.0057142857142858, 1.0109793588054459, 1.8181818181818181, 2.0, 1.1304347826086956, 1.1485148514851484, 1.1090365944734877, 1.0, 1.1136363636363635, 1.0483870967741935, 1.1102661596958174, 1.1428571428571428, 1.0, 1.0849184782608696, 1.0384294068504596, 1.0, 1.5625, 5.0, 1.1395348837209303, 1.9090909090909092, 1.0007687708208763, 1.0769230769230769, 1.0, 1.3333333333333333, 2.0, 1.1142857142857143, 3.0, 1.032967032967033, 1.2, 1.022408963585434, 1.069172932330827, 1.3094170403587444, 2.0, 1.1229722658294088, 1.0, 1.1896551724137931, 1.0, 1.0205128205128204, 2.0, 2.0, 1.2857142857142858, 2.0, 2.0, 1.0, 2.0, 1.2987012987012987, 3.0, 1.1, 1.1620962827544181, 1.0555555555555556, 1.0704225352112675, 1.06, 1.2524271844660195, 1.0, 1.0, 1.0, 2.0, 1.1162790697674418, 7.0, 1.0255388516573085, 1.3333333333333333, 2.0, 1.127659574468085, 1.1846153846153846, 1.0240549828178693, 1.0, 1.017605633802817, 1.0, 1.5757575757575757, 1.0434782608695652, 1.0, 1.5, 1.0434782608695652, 2.3333333333333335, 1.0, 2.0, 2.0, 1.0, 1.0619178568260446, 1.0050327126321088, 1.5, 1.0, 1.2222222222222223, 1.3, 1.054079696394687, 2.0, 1.2215743440233235, 1.0, 1.0865671641791044, 2.0, 1.5, 1.002911208151383, 1.0, 1.4444444444444444, 1.0, 1.0477322242028124, 1.3008849557522124, 1.2391304347826086, 1.0980392156862746, 1.0436835891381346, 1.0, 2.5, 2.0, 2.5, 1.0, 1.0120481927710843, 1.0, 1.967741935483871, 1.029591836734694, 1.45, 1.0, 1.0555555555555556, 1.0, 1.0, 1.0943396226415094, 1.0, 1.3953488372093024, 1.1, 2.3333333333333335, 1.0854863674246935, 1.0, 1.1333333333333333, 1.4137931034482758, 1.0822784810126582, 1.0194909424443934, 1.0, 1.0592797783933519, 1.0, 1.0161507402422612, 1.0, 1.0, 1.1515151515151516, 1.8, 1.0629482071713148, 1.0863309352517985, 1.102672889266016, 1.0611570247933884, 1.1666666666666667, 1.0689655172413792, 1.1666666666666667, 1.0, 1.0363636363636364, 1.0785340314136125, 4.285714285714286, 2.0, 1.4666666666666666, 1.214574898785425, 1.0, 1.0, 2.0, 2.0, 1.105263157894737, 1.0661157024793388, 2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.489795918367347, 1.0630434782608695, 1.135135135135135, 1.3617021276595744, 1.0, 1.0, 1.0896860986547086, 1.0319675821701937, 2.0, 2.0, 1.0, 1.3218390804597702, 4.666666666666667, 1.0, 1.0, 1.023688915375447, 1.2083333333333333, 1.0, 1.0, 1.030701754385965, 1.2, 1.2857142857142858, 1.2906976744186047, 1.4, 1.0405405405405406, 1.0, 1.0, 3.0, 1.5932203389830508, 1.0, 1.07690036900369, 1.4907407407407407, 1.0923423423423424, 1.0, 1.002627430373095, 1.0358511837655018, 1.1666666666666667, 1.108910891089109, 1.0, 1.0, 1.0174081237911026, 2.0, 1.2209302325581395, 1.8666666666666667, 1.0108695652173914, 1.0, 1.25, 1.1328374070138152, 1.0, 1.5, 1.15, 1.25, 1.002967359050445, 1.131578947368421, 1.0416666666666667, 1.0288392213410238, 1.0158730158730158, 5.0, 1.0, 1.3043478260869565, 1.25, 1.0, 1.0, 1.1081081081081081, 1.1498405951115833, 1.0, 3.0, 1.5, 1.0, 1.0, 1.0, 1.1470588235294117, 1.04168305151396, 1.0268423621278673, 1.0, 1.144278606965174, 1.0144724556489262, 1.5, 1.1176470588235294, 1.2043478260869565, 1.0, 1.3214285714285714, 1.0, 1.0319148936170213, 1.0851063829787233, 1.2544642857142858, 1.0301227222015619, 1.2688821752265862, 1.0214067278287462, 1.0, 1.008187134502924, 1.1379310344827587, 1.1666666666666667, 1.1777777777777778, 1.0277456647398844, 1.0, 2.0, 2.0, 1.1309047237790233, 1.0144230769230769, 1.180327868852459, 1.1818181818181819, 1.0129870129870129, 2.0, 1.3116883116883118, 1.2727272727272727, 1.0, 1.1458333333333333, 1.3076923076923077, 1.04375, 1.0, 1.1538461538461537, 1.0143124893508264, 1.1159420289855073, 1.4228571428571428, 1.0, 1.0473977695167287, 1.0, 1.096774193548387, 1.0, 1.0524590163934426, 1.0, 1.0, 1.75, 1.0, 1.023088023088023, 2.0, 1.0, 2.5, 1.1238095238095238, 1.0019602352282273, 1.04, 1.3666666666666667, 1.5588235294117647, 1.0502857142857143, 1.029327022020992, 1.0, 1.0404624277456647, 1.0, 1.2571428571428571, 1.088235294117647, 3.0, 1.0, 1.125, 1.206896551724138, 1.0561167227833894, 1.0, 1.0, 1.0, 1.25, 1.0923076923076922, 1.0, 1.1118012422360248, 1.3125, 1.025925925925926, 1.8, 1.2103658536585367, 1.0365412445730824, 1.1688400823610159, 3.0, 1.0, 1.0454545454545454, 1.4680851063829787, 1.0952380952380953, 1.0758293838862558, 1.0, 1.0909090909090908, 1.0524918300653594, 1.224, 1.0288749251944944, 1.0, 1.0, 1.0644762845849802, 1.0, 2.0, 2.0, 1.0, 1.25, 1.0, 2.317073170731707, 1.393939393939394, 1.0, 1.0, 1.0099750623441397, 1.00965424337674, 1.0126903553299493, 1.0, 2.051282051282051, 1.0921985815602837, 1.0146412884333822, 1.12, 1.2124833997343958, 2.0, 1.0016353229762878, 1.009493670886076, 1.0909090909090908, 1.0919264588329336, 1.2249443207126949, 2.25, 1.2432432432432432, 1.2962962962962963, 2.0, 1.25, 1.0, 3.75, 1.3764705882352941, 1.0, 2.4285714285714284, 3.0, 1.3333333333333333, 1.0, 1.0940170940170941, 1.1290322580645162, 1.1666666666666667, 1.1702127659574468, 1.1, 1.0, 1.0564516129032258, 1.0169235418555456, 1.1139934234563391, 1.0855521606285465, 1.2, 1.1428571428571428, 1.0, 2.0, 1.0, 1.1956521739130435, 1.1326352530541013, 2.0, 1.0119305856832972, 1.0, 1.7, 1.719298245614035, 1.0, 1.1869158878504673, 1.1081081081081081, 1.0634920634920635, 1.0, 1.0555555555555556, 1.194078947368421, 1.1067961165048543, 1.5, 1.5, 1.2388535031847134, 1.5, 1.0, 1.0, 1.0, 1.0751515151515152, 1.0397208803005904, 1.0, 1.08670260557053, 1.8333333333333333, 1.3, 1.1136363636363635, 1.0, 1.0, 1.044110275689223, 1.075, 1.1171875, 1.149241819632881, 1.0301204819277108, 1.0, 1.0, 1.0097087378640777, 1.0, 1.35, 1.1370967741935485, 1.0349854227405249, 2.0, 2.0, 1.1853658536585365, 1.0, 1.0, 1.0, 1.0086241883116882, 2.0, 1.12, 1.0, 2.0, 3.0, 1.0, 1.5454545454545454, 1.1071428571428572, 1.1237785016286646, 1.3333333333333333, 1.1142857142857143, 2.0, 1.0, 1.0, 1.0655581947743469, 1.0599022004889975, 1.1887640449438202, 2.0, 4.5, 1.0782268578878749, 1.0, 4.4, 1.043115438108484, 1.1176470588235294, 1.1192292252107587, 1.09477866061294, 1.1, 1.0, 1.5, 2.0, 1.1703296703296704, 1.0, 1.0643395641846536, 1.0625, 1.5, 1.0, 1.1696428571428572, 1.0, 1.0, 2.0, 1.3333333333333333, 1.0, 2.0, 1.2, 1.108967082860386, 1.0, 1.0, 1.3333333333333333, 1.2, 1.106837606837607]
origin-census_1.87 	max: 13.0000	99th: 4.6680	95th: 2.1708	median: 1.0909	mean: 1.3560

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 1/15 | Workload-time: 39.282753 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 2/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=tupleskew', '--dataset=census', '--drift_test=distribution', '--end2end', '--update_size=4000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-census-2.8MB-model16.858-data14.989-200epochs-seed0.pt
GET-DATASET-PATH=./data/census/end2end/census_int.npy
TupleSkewSample - START
0.01
TupleSkewSample - END
load_npy_dataset_from_path - df.shape = (36561, 13)
Parsing... done, took 0.0s
Data updated!
Previous data size: (32561, 13), new data size: (4000, 13)
[1.32024288e-04 3.09348106e-05 7.69495964e-05 2.65836716e-05
 4.69684601e-05 7.68899918e-06 4.43458557e-05 1.07288361e-05
 5.96046448e-08 4.83214855e-04 2.93850899e-05 1.79111958e-04
 1.15931034e-04]
Distance score: 9.107131336349994e-05
SAUCE Drift detection: True
Detection latency: 0.0036s

DRIFT-DETECTED after 2-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=census', '--end2end', '--model=transformer', '--model_update=adapt', '--update_size=4000', '--epochs=0']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-census-2.8MB-model16.858-data14.989-200epochs-seed0.pt
update_size: 4000
AdaptTask - START
GET-DATASET-PATH=./data/census/end2end/census_int.npy
load_npy_dataset_from_path - df.shape = (36561, 13)
Parsing... done, took 0.0s
done, took 0.0s
dataset size: 36561
train data shape: torch.Size([4000, 13]), transfer data shape:torch.Size([800, 13])
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 12.0903 nats / 17.4427 bits
Saved to: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-census-2.8MB-model16.858-data14.989-200epochs-seed0.pt
AdaptTask - END

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 2/15 | Workload-time: 3.951011 | Model-update-time: 4.619463


WORKLOAD-START | Type: QueryWorkload | Progress: 3/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=census', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=15', '--data_update=tupleskew', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-census-2.8MB-model16.858-data14.989-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-census-2.8MB-model16.858-data14.989-200epochs-seed0.pt')]
Validate Argument: DATASET="census" is valid.
data size: 36561, total size: 36561, split index: [30467 36561]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-census-2.8MB-model16.858-data14.989-200epochs-seed0.pt
query_seed:0
origin-census_1.87 	max: 22.0000	99th: 15.0000	95th: 5.2625	median: 1.1222	mean: 1.8707
ReportEsts: [1.209090909090909, 1.0, 1.0204081632653061, 1.0, 5.0, 1.2222222222222223, 1.0283505154639174, 1.1666666666666667, 1.0, 1.0, 1.0422018348623854, 1.2808219178082192, 1.2131147540983607, 1.4104234527687296, 1.1016949152542372, 6.5, 1.3783783783783783, 1.0338983050847457, 1.0, 22.0, 1.654320987654321, 1.5263157894736843, 2.0, 1.1142857142857143, 1.0, 1.0, 1.3333333333333333, 1.902097902097902, 1.0, 1.0, 1.2637362637362637, 3.0, 1.2542372881355932, 1.1270884689126266, 1.0, 1.1666666666666667, 1.1031390134529149, 1.0, 1.4973262032085561, 1.0211802748585288, 1.170764119601329, 1.0, 1.1, 1.028673835125448, 1.0, 1.0, 1.2966751918158568, 1.0, 1.0, 1.0358829084041548, 1.2463768115942029, 2.0, 2.0, 1.3673469387755102, 1.3333333333333333, 1.1421052631578947, 1.123076923076923, 1.1724137931034482, 1.0854922279792747, 1.1177536231884058, 1.1237113402061856, 1.0, 1.0178571428571428, 1.0183135833904613, 1.0556792873051224, 1.0222285551439156, 1.4857142857142858, 2.2, 2.4, 1.553191489361702, 4.0, 1.1197223828802776, 1.059301625526791, 1.0, 1.1666666666666667, 6.0, 1.1600771456123433, 1.5, 7.333333333333333, 1.0, 1.0, 1.0, 1.2093023255813953, 1.0696517412935322, 1.170731707317073, 1.0122448979591836, 1.0561224489795917, 8.0, 1.0, 2.0, 1.118320610687023, 1.0, 1.0, 1.5, 1.2205882352941178, 1.150281778334377, 1.0, 1.088235294117647, 1.0, 1.005736137667304, 1.75, 1.8615384615384616, 2.7142857142857144, 1.0, 1.0, 2.0, 1.0433520016594067, 16.0, 3.0, 1.8461538461538463, 1.7727272727272727, 1.1886956521739132, 1.0, 1.0, 1.2758620689655173, 2.0, 2.0, 1.0, 2.0, 2.0, 1.0, 1.2777777777777777, 1.6363636363636365, 2.5, 1.0204778156996588, 1.111340206185567, 1.5909090909090908, 1.0, 1.2105263157894737, 1.0200708382526564, 1.0090293453724606, 1.5, 1.3, 1.2583025830258303, 3.0, 1.2, 1.5, 1.0, 9.0, 1.5, 1.0, 1.0, 1.2519280205655527, 1.2037037037037037, 2.0, 1.0482472672446288, 1.0, 1.020217209690894, 1.0998573466476462, 2.0, 1.0848, 5.0, 1.0, 1.031055900621118, 1.2352941176470589, 1.8, 3.0, 1.0847298060628883, 1.4, 1.1618497109826589, 1.0420168067226891, 1.0424354243542435, 1.3103448275862069, 1.3426573426573427, 1.111340206185567, 1.0, 1.2287581699346406, 1.0263157894736843, 1.0164609053497942, 1.1428571428571428, 1.0805134189031504, 1.0, 1.368421052631579, 2.0, 1.5217391304347827, 1.1524590163934427, 1.0171252105558675, 1.0393700787401574, 1.0, 13.0, 1.8571428571428572, 1.0953177257525084, 1.1779448621553885, 1.069672131147541, 4.0, 1.1428571428571428, 2.0, 1.0, 1.0, 1.4166666666666667, 1.5357142857142858, 1.7096774193548387, 2.0, 1.440625, 1.5, 2.0, 1.0, 1.157185628742515, 2.0, 1.0, 1.0576923076923077, 7.333333333333333, 1.0081013710012463, 6.333333333333333, 1.452513966480447, 1.1544715447154472, 1.0593607305936072, 1.1337698783910197, 1.0, 1.1756756756756757, 2.0, 1.100721346513492, 1.1329479768786128, 1.0434782608695652, 1.0, 17.0, 5.2, 1.2682926829268293, 1.0, 1.2097902097902098, 3.4285714285714284, 2.0, 1.074235807860262, 1.1764705882352942, 7.0, 1.0769230769230769, 1.0, 1.6, 1.119161105815062, 2.0, 1.0440188431539115, 1.0, 1.0, 1.87012987012987, 1.5, 12.0, 1.0857307249712314, 1.1136363636363635, 1.0, 1.530612244897959, 1.0, 1.4444444444444444, 1.296875, 2.5, 1.0, 1.5454545454545454, 1.103732950466619, 1.03125, 13.0, 1.023344191096634, 2.5, 2.0, 1.0612244897959184, 2.3684210526315788, 1.0, 1.4375, 1.0, 1.009090909090909, 5.25, 1.0883787078423406, 10.5, 1.0, 1.0, 1.3617021276595744, 1.0, 1.1666666666666667, 22.0, 1.0263157894736843, 1.1303816793893129, 1.2777777777777777, 1.2647058823529411, 8.0, 1.105263157894737, 1.2222222222222223, 1.6153846153846154, 1.122244488977956, 2.0, 2.2, 1.5, 1.6, 1.3333333333333333, 3.25, 1.0611464968152866, 1.088235294117647, 2.0, 1.0, 2.0, 1.0, 1.0149253731343284, 1.3333333333333333, 1.042844391550134, 1.5, 12.0, 1.069775357385977, 1.0499405469678953, 1.12012987012987, 1.0567200986436498, 1.045392022008253, 8.5, 1.0, 1.0816326530612246, 1.0, 2.0, 1.25, 1.0595238095238095, 2.0, 1.0, 1.0, 2.0, 1.2667332667332667, 1.4340836012861737, 1.0807692307692307, 1.0, 1.0609756097560976, 2.0, 1.4615384615384615, 2.0, 1.0, 2.0, 1.1347723085022374, 2.0, 1.0564657694558222, 1.25, 1.0, 1.029574416927146, 1.0555555555555556, 1.0, 1.0, 1.0, 4.75, 1.0, 1.0063856960408684, 1.0, 1.0666666666666667, 1.0, 6.0, 2.0, 14.0, 1.0, 1.75, 1.0, 2.0, 1.0, 1.3181818181818181, 1.2758620689655173, 1.0, 1.0082101806239738, 1.0, 1.0, 1.2, 1.2727272727272727, 1.0, 1.6666666666666667, 1.25, 1.0, 2.642857142857143, 1.5, 1.528301886792453, 1.0, 1.0770702377698824, 1.030127462340672, 1.2272727272727273, 1.0093582887700534, 2.0, 2.0, 1.0, 1.0, 1.0714285714285714, 1.3333333333333333, 1.125, 1.1254045307443366, 1.0, 1.0330578512396693, 1.0666666666666667, 1.0, 1.0229885057471264, 1.0, 2.0, 1.0, 1.0, 2.0, 1.15203426124197, 2.0, 17.0, 1.3, 1.5238095238095237, 1.1458333333333333, 1.7118644067796611, 2.0, 2.0, 1.020746887966805, 8.0, 1.0, 1.0377965420184962, 1.1666666666666667, 1.0235109717868338, 1.1316348195329087, 1.25, 1.0285714285714285, 2.25, 1.0106626047220106, 1.0, 1.3571428571428572, 1.0, 1.0579710144927537, 1.2428571428571429, 14.0, 1.070110701107011, 1.441860465116279, 1.5, 1.0, 1.5, 1.0273972602739727, 13.0, 1.2641509433962264, 1.0929487179487178, 1.1779475982532752, 1.102880658436214, 2.5, 1.0, 1.0833333333333333, 1.037037037037037, 1.3548387096774193, 1.1231527093596059, 1.0, 1.078920041536864, 1.6708860759493671, 1.3835616438356164, 1.0, 5.5, 1.125, 2.0, 13.0, 1.0, 1.0763289413902772, 1.3, 1.0406723120348986, 1.0, 1.3333333333333333, 1.0, 1.206896551724138, 1.0, 8.0, 1.1134020618556701, 3.0, 1.0, 1.5, 1.0, 2.0, 2.0, 2.5625, 1.0194174757281553, 1.3777777777777778, 1.5, 1.01353001017294, 1.0, 1.205128205128205, 4.666666666666667, 1.0780141843971631, 2.0, 1.0315315315315314, 1.0, 1.0597165991902835, 1.0, 1.0, 1.3132530120481927, 1.0952380952380953, 1.0826416456153014, 5.0, 1.0078125, 1.0021598272138228, 14.0, 1.3333333333333333, 1.066096535729816, 1.3430232558139534, 1.0, 1.0, 1.9056603773584906, 1.0, 1.5, 1.0736579275905118, 1.2857142857142858, 11.0, 1.0767735665694849, 4.0, 2.0, 1.0, 1.1343692870201096, 3.0, 3.0, 1.0390455531453362, 1.0666666666666667, 3.5714285714285716, 1.0, 1.1666666666666667, 1.0, 1.2742980561555075, 5.0, 2.0, 2.0, 1.3129770992366412, 1.0, 1.0769230769230769, 4.0, 1.0, 1.5, 1.0997150997150997, 1.1183699870633894, 8.5, 1.0, 1.0419463087248322, 1.1176470588235294, 1.5, 1.1153846153846154, 1.0884955752212389, 1.0429767952766718, 1.0, 1.205128205128205, 1.1935483870967742, 1.0588235294117647, 1.0, 1.0, 1.065891472868217, 1.0, 1.0, 1.0, 1.0, 1.0, 5.0, 1.0107361963190185, 1.0, 1.1239669421487604, 1.078078078078078, 1.0, 1.6081081081081081, 2.0, 1.048780487804878, 1.0, 1.0743427017225748, 1.17375, 1.0183397683397684, 1.1428571428571428, 1.3185840707964602, 1.0434782608695652, 3.0, 2.0, 1.1428571428571428, 2.0, 1.1831164709615996, 1.0731707317073171, 1.0, 1.2770448548812665, 1.0, 1.105835806132542, 1.0700379266750948, 2.5, 1.2727272727272727, 1.9863013698630136, 1.8, 1.0078479699053056, 1.0, 13.0, 1.075, 1.0, 1.0, 1.1647058823529413, 1.0, 1.5, 1.0, 1.0, 1.0514018691588785, 1.3409090909090908, 1.0234309623430962, 1.1785714285714286, 1.0786516853932584, 1.017636684303351, 1.0, 1.0031698676114116, 13.0, 14.0, 1.5, 3.0833333333333335, 1.4444444444444444, 1.2147239263803682, 1.0461538461538462, 1.0, 1.0476497102382485, 1.25, 2.0, 1.0, 2.0, 1.2341463414634146, 1.75, 1.0, 6.5, 1.661764705882353, 1.0063025210084033, 1.0227272727272727, 1.0, 1.2105263157894737, 1.0, 1.0, 1.0, 1.2513274336283187, 1.1818181818181819, 2.3684210526315788, 1.0125541125541127, 1.5957446808510638, 1.0384615384615385, 1.1933333333333334, 1.0186666666666666, 1.0952380952380953, 1.1497326203208555, 1.148936170212766, 2.0, 1.007989347536618, 1.4545454545454546, 1.4, 1.2727272727272727, 1.271186440677966, 1.25, 1.6, 1.0535592449397317, 1.0, 1.0, 1.1666666666666667, 1.0, 1.1666666666666667, 1.0, 1.1428571428571428, 1.3333333333333333, 1.0843039378813089, 1.2232558139534884, 1.2867132867132867, 3.0, 1.3062381852551985, 1.4854651162790697, 1.0848356309650053, 1.0, 1.0041888804265042, 1.3298969072164948, 1.0, 1.1666666666666667, 1.2114093959731544, 2.0, 3.0, 1.2222222222222223, 1.0, 1.3229813664596273, 1.1091492776886036, 1.0625, 1.3888888888888888, 1.1870967741935483, 1.3846153846153846, 1.0058637798827244, 2.0, 1.053416149068323, 1.0833333333333333, 2.0, 1.0727848101265822, 3.6666666666666665, 1.6666666666666667, 1.6666666666666667, 1.0, 1.0879120879120878, 1.0, 1.0434782608695652, 1.2542372881355932, 1.0, 2.0, 2.0, 1.0, 2.0, 1.0, 1.0765957446808512, 1.4, 1.7142857142857142, 1.2333333333333334, 1.4, 1.0649350649350648, 1.0, 1.108695652173913, 2.0, 2.0, 2.0, 1.0145461241023752, 1.0, 1.001432664756447, 1.021875, 1.0, 2.0, 1.0, 1.0, 7.5, 1.125, 2.0, 1.1411764705882352, 1.5789473684210527, 1.0154666109311319, 1.1196581196581197, 1.2846715328467153, 1.0833333333333333, 1.0892857142857142, 1.0072992700729928, 1.3333333333333333, 1.0, 2.0, 1.0, 1.0, 1.071001431820096, 1.25, 2.0, 1.0, 1.041185852331363, 1.105263157894737, 2.0, 1.0, 1.0298578199052133, 1.1055045871559632, 1.0606060606060606, 1.125, 1.1068627450980393, 6.5, 1.1818181818181819, 1.06, 1.0, 1.0025695931477516, 1.0, 1.8958333333333333, 1.1669505962521294, 1.3333333333333333, 1.1176470588235294, 1.228846153846154, 2.0, 2.3333333333333335, 1.0, 1.2183908045977012, 2.0, 1.0724637681159421, 1.347457627118644, 1.053030303030303, 1.6581632653061225, 1.4, 2.0, 1.0452261306532664, 3.0, 16.0, 1.0, 2.0, 1.0259403372243838, 1.0414224306369675, 1.0844594594594594, 2.0, 1.0, 1.0, 2.0, 1.033112582781457, 1.391304347826087, 1.0769230769230769, 1.3214285714285714, 1.196078431372549, 1.2763157894736843, 1.1588235294117648, 14.0, 1.0, 1.0, 1.375, 15.0, 1.0076656775469832, 1.0, 1.3333333333333333, 1.0588235294117647, 1.0795715378729915, 1.2053571428571428, 1.0573678290213724, 1.0, 1.0564102564102564, 1.4285714285714286, 1.1967213114754098, 1.0, 1.032258064516129, 1.0841487279843445, 1.028301886792453, 1.0333333333333334, 13.0, 1.105263157894737, 1.0, 1.0714285714285714, 1.0602459016393442, 2.0, 1.230019493177388, 1.3043478260869565, 1.0, 1.0, 1.5, 8.5, 17.0, 1.0, 1.4285714285714286, 1.054945054945055, 1.127659574468085, 1.6666666666666667, 1.0, 1.3793103448275863, 1.1169590643274854, 1.0, 1.0384940778341794, 1.03404518724853, 1.1750154607297465, 1.2380952380952381, 1.0, 1.0, 1.2083333333333333, 1.3636363636363635, 1.0084033613445378, 20.0, 1.0, 1.0342857142857143, 1.0, 1.125, 1.004870515561891, 1.3333333333333333, 1.0576923076923077, 1.0423728813559323, 1.328358208955224, 1.003579952267303, 1.0, 15.0, 1.4242424242424243, 1.005, 2.0, 1.2258064516129032, 1.0211907164480323, 1.0816326530612246, 1.0357747345745498, 4.0, 1.3333333333333333, 1.0, 9.0, 1.2127272727272727, 1.0909090909090908, 1.3463611859838276, 1.5733333333333333, 1.2054794520547945, 1.0227272727272727, 1.0416666666666667, 1.0177748518762344, 1.0440366972477064, 2.0, 1.337837837837838, 1.5555555555555556, 1.5, 1.9473684210526316, 1.0, 1.1963636363636363, 1.4574468085106382, 1.0, 1.0644786523380774, 1.4545454545454546, 1.0095541401273886, 1.0, 1.9230769230769231, 1.0, 1.0, 1.0265639735932097, 4.25, 1.0, 1.0, 2.111111111111111, 1.0, 1.0, 1.0, 2.0, 1.6666666666666667, 2.5, 1.2549019607843137, 1.0, 1.0251572327044025, 1.6666666666666667, 1.0, 1.0489372219476025, 1.0, 1.1111111111111112, 1.0, 1.0506329113924051, 1.0, 1.006034561579958, 1.0, 1.3177570093457944, 6.0, 1.5, 1.0816326530612246, 1.4130434782608696, 1.1052195526097763, 1.1011904761904763, 1.1228070175438596, 1.25, 1.0057504312823462, 1.0543248945147679, 1.0, 2.0, 2.0, 1.0507462686567164, 1.8, 1.0, 1.4576271186440677, 1.0217391304347827, 1.11275415896488, 1.4166666666666667, 1.0, 1.0139966916910548, 3.0, 1.417989417989418, 1.0151133501259446, 1.4, 1.1031793641271745, 3.0, 1.0, 1.1224256292906178, 1.0, 1.0155642023346303, 1.0723981900452488, 5.0, 1.0555555555555556, 1.5, 1.1666666666666667, 3.0, 1.0416666666666667, 1.0, 1.2735849056603774, 1.6363636363636365, 1.0289855072463767, 2.0, 1.003919647231749, 1.0, 1.1578947368421053, 10.0, 1.037037037037037, 1.025, 1.2188841201716738, 1.3333333333333333, 1.0, 1.2388059701492538, 1.0, 1.7466666666666666, 14.0, 1.8666666666666667, 1.001050105010501, 2.5172413793103448, 1.9333333333333333, 1.0422077922077921, 1.0666666666666667, 1.0807453416149069, 1.3171140939597314, 1.1176470588235294, 1.2831858407079646, 1.6666666666666667, 1.1956521739130435, 1.0244233378561738, 1.0, 19.0, 1.1044277360066834, 1.101468624833111, 1.0, 1.5, 1.0, 1.25, 1.0385756676557865, 1.0182270091135046, 1.3171806167400881, 4.666666666666667, 1.0198830409356725, 1.0, 1.0183028286189684, 1.3333333333333333, 1.2, 1.0, 2.0, 1.0, 1.0351170568561874, 1.0776092774308652, 1.2272727272727273, 1.0590331810652076, 3.0, 1.0, 1.058027079303675, 2.0, 1.3333333333333333, 1.3488372093023255, 1.0, 1.0, 4.25, 1.0, 1.4210526315789473, 1.0395703787450536, 1.1221052631578947, 1.0021008403361344, 1.0685249709639955, 1.0, 1.0]
origin-census_1.87 	max: 22.0000	99th: 15.0000	95th: 5.2625	median: 1.1222	mean: 1.8707

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 3/15 | Workload-time: 39.212023 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 4/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=tupleskew', '--dataset=census', '--drift_test=distribution', '--end2end', '--update_size=4000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-census-2.8MB-model16.858-data14.989-200epochs-seed0.pt
GET-DATASET-PATH=./data/census/end2end/census_int.npy
TupleSkewSample - START
0.01
TupleSkewSample - END
load_npy_dataset_from_path - df.shape = (40561, 13)
Parsing... done, took 0.0s
Data updated!
Previous data size: (36561, 13), new data size: (4000, 13)
[8.6426735e-06 3.3378601e-06 2.2828579e-05 6.6757202e-06 2.1755695e-05
 6.4373016e-06 1.2397766e-05 1.4126301e-05 1.1980534e-05 4.7260523e-04
 2.2649765e-06 1.1146069e-05 9.9539757e-06]
Distance score: 4.647328387363814e-05
SAUCE Drift detection: True
Detection latency: 0.0054s

DRIFT-DETECTED after 4-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=census', '--end2end', '--model=transformer', '--model_update=adapt', '--update_size=4000', '--epochs=0']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-census-2.8MB-model16.858-data14.989-200epochs-seed0.pt
update_size: 4000
AdaptTask - START
GET-DATASET-PATH=./data/census/end2end/census_int.npy
load_npy_dataset_from_path - df.shape = (40561, 13)
Parsing... done, took 0.0s
done, took 0.0s
dataset size: 40561
train data shape: torch.Size([4000, 13]), transfer data shape:torch.Size([800, 13])
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 11.7350 nats / 16.9301 bits
Saved to: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-census-2.8MB-model16.858-data14.989-200epochs-seed0.pt
AdaptTask - END

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 4/15 | Workload-time: 3.978981 | Model-update-time: 4.359822


WORKLOAD-START | Type: QueryWorkload | Progress: 5/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=census', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=15', '--data_update=tupleskew', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-census-2.8MB-model16.858-data14.989-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-census-2.8MB-model16.858-data14.989-200epochs-seed0.pt')]
Validate Argument: DATASET="census" is valid.
data size: 40561, total size: 40561, split index: [33800 40561]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-census-2.8MB-model16.858-data14.989-200epochs-seed0.pt
query_seed:0
origin-census_1.87 	max: 27.0000	99th: 16.0000	95th: 9.0000	median: 1.1703	mean: 2.1744
ReportEsts: [1.3103448275862069, 1.0, 1.3877551020408163, 1.0, 1.2, 1.1933701657458564, 1.0626830697129468, 1.106060606060606, 1.0, 2.0, 1.0573770491803278, 1.0883977900552486, 1.1044776119402986, 1.1761904761904762, 1.75, 1.4166666666666667, 1.3783783783783783, 1.078125, 1.0, 22.0, 1.4403669724770642, 1.368421052631579, 2.0, 2.9166666666666665, 2.0, 2.0, 1.0333333333333334, 2.1333333333333333, 2.0, 1.086114307633295, 1.0202063628546862, 1.6666666666666667, 1.0375841842276776, 1.316008316008316, 1.7272727272727273, 6.333333333333333, 1.0, 2.0, 2.0, 1.0416666666666667, 1.0238095238095237, 2.0, 13.5, 1.0790178571428573, 2.5, 1.375, 1.0, 1.0566037735849056, 1.0, 1.0, 14.0, 1.2727272727272727, 1.5, 1.0, 1.0225563909774436, 1.037037037037037, 1.1333333333333333, 1.106752931661949, 1.6206896551724137, 1.0, 1.2934782608695652, 2.6818181818181817, 2.0, 1.5, 1.1137724550898203, 1.0123359580052493, 1.0399728997289972, 1.0392051557465092, 1.552511415525114, 1.1, 4.0, 1.9210526315789473, 1.3333333333333333, 1.0871134020618556, 1.0262025811497848, 1.0, 1.0, 6.0, 1.0184534270650263, 1.1666666666666667, 5.5, 1.0, 27.0, 1.0, 1.1, 1.1238532110091743, 1.0408163265306123, 1.010989010989011, 1.1073825503355705, 8.0, 1.0, 3.0, 15.0, 1.3617021276595744, 1.0076433121019108, 2.0, 1.0632137030995106, 12.5, 1.1203007518796992, 1.0, 1.0, 1.1666666666666667, 1.2467391304347826, 1.6551724137931034, 1.0, 1.3832335329341316, 1.0, 1.0, 2.0, 1.0642361111111112, 16.0, 3.0, 1.0786240786240786, 1.56, 1.0997398091934085, 1.0, 1.0, 1.263157894736842, 1.0, 2.0, 1.0, 3.0, 4.0, 2.0, 1.391304347826087, 1.3043478260869565, 2.5, 1.0918032786885246, 1.1497227356746764, 1.7613636363636365, 1.0, 1.4375, 1.0287574606619643, 1.0924464487034948, 2.0, 1.1, 1.185430463576159, 1.0, 1.0993657505285412, 2.0, 1.0, 1.0, 2.0, 1.0, 1.1041666666666667, 1.0, 2.0, 1.0358929736784859, 1.0640138408304498, 3.0, 1.2450980392156863, 1.019551466359977, 3.0, 1.0480795799944735, 5.0, 1.0, 1.0052083333333333, 1.005128205128205, 1.5, 1.0, 1.0540363517275257, 2.2857142857142856, 1.103960396039604, 1.0141935483870967, 1.0940170940170941, 1.4482758620689655, 1.4345047923322685, 1.0867992766726944, 8.5, 1.2307692307692308, 1.3529411764705883, 1.053085600530856, 1.3255813953488371, 1.0625241717158695, 1.1282467532467533, 1.0409956076134699, 1.288702928870293, 1.0, 1.25, 1.0, 3.0, 3.0, 1.0, 1.234375, 1.071186440677966, 1.0, 1.1902654867256637, 2.4285714285714284, 2.5, 1.408450704225352, 1.6666666666666667, 1.0, 1.5895522388059702, 1.0, 1.7777777777777777, 2.0, 1.0718509227736965, 1.1252086811352253, 1.027027027027027, 1.0, 1.1228070175438596, 1.59375, 1.0, 1.1032863849765258, 1.0323222277473894, 1.3548387096774193, 1.12, 1.0, 4.0, 1.0, 1.5, 1.5, 21.0, 1.0655763989097322, 3.0, 13.0, 1.068041237113402, 1.395, 2.142857142857143, 1.0951111111111111, 1.5, 1.1353846153846154, 1.0650936329588014, 1.0, 1.0, 1.022857142857143, 1.1643356643356644, 1.3636363636363635, 1.7619047619047619, 1.0354609929078014, 1.1194029850746268, 1.3333333333333333, 1.0959725792630677, 2.0, 1.0543683878652, 1.0, 1.0, 1.7555555555555555, 2.0, 12.0, 1.2223508975101331, 1.0891089108910892, 1.0, 1.2285714285714286, 1.0, 1.2251908396946565, 1.484375, 2.0, 2.0, 1.2124645892351276, 1.0136186770428015, 1.1927710843373494, 4.0, 1.3888888888888888, 1.5384615384615385, 1.0, 1.1590909090909092, 1.0062434963579605, 1.0379965457685665, 1.1163069544364508, 1.1458080194410694, 1.0762406015037593, 2.0, 6.5, 1.0, 1.1696428571428572, 19.0, 1.491891891891892, 1.0, 1.045188512317953, 1.0, 1.070154577883472, 1.0, 2.869565217391304, 1.0, 1.051455082243779, 2.0, 1.1579804560260587, 1.0476190476190477, 1.1245901639344262, 1.0, 1.009671179883946, 2.0, 1.5, 1.1666666666666667, 1.107843137254902, 1.4523809523809523, 2.0, 2.0, 1.2740740740740741, 2.0, 2.0, 2.0, 1.1111111111111112, 1.019704433497537, 1.0769230769230769, 1.1339285714285714, 11.0, 20.0, 1.1764705882352942, 1.0483245149911817, 1.5151515151515151, 1.0, 1.0, 1.0838061981667395, 2.0, 1.0, 1.288888888888889, 1.0, 1.0, 1.0, 1.005789235639982, 1.0172820109976433, 1.023391812865497, 1.0210198520825224, 1.6829268292682926, 1.2516129032258065, 2.0, 1.6153846153846154, 1.0, 1.0, 2.0, 1.048967940272288, 2.0, 1.0124409056979349, 1.0, 1.0, 1.0317460317460319, 1.0138888888888888, 1.0, 1.0, 1.0, 6.75, 1.3333333333333333, 1.3673469387755102, 1.0, 2.0, 2.6, 1.0, 4.5, 1.0, 1.0667961165048543, 1.021379980563654, 3.25, 1.1875, 1.0, 1.8571428571428572, 1.3333333333333333, 1.0, 2.0, 1.01019131056678, 2.0, 1.4444444444444444, 1.2, 1.1818181818181819, 8.0, 1.6666666666666667, 1.04, 1.0, 2.466666666666667, 1.125, 1.1886792452830188, 2.0, 1.0990173847316704, 1.0174973488865324, 1.4545454545454546, 1.1709844559585492, 1.0, 8.0, 1.0, 1.0, 1.297872340425532, 2.0, 1.0714285714285714, 1.0563486100676183, 2.0, 1.0083333333333333, 1.2285714285714286, 1.0, 1.3368421052631578, 1.0, 2.0, 1.0, 1.5925925925925926, 2.0, 1.6405405405405404, 2.0, 17.0, 1.2307692307692308, 1.105263157894737, 1.3818181818181818, 1.6756756756756757, 2.0, 2.0, 1.37, 23.5, 1.0, 1.0231770369049742, 1.3333333333333333, 1.0873655913978495, 1.0356394129979036, 3.6, 11.0, 1.6031746031746033, 1.1408450704225352, 1.25, 1.2666666666666666, 1.0, 1.6382488479262673, 1.3846153846153846, 14.0, 1.1535580524344569, 1.5116279069767442, 1.5, 1.0, 1.0, 1.171875, 13.0, 1.046875, 1.188622754491018, 1.1156205757432751, 1.078125, 1.6666666666666667, 1.0, 1.4444444444444444, 1.055, 1.8387096774193548, 1.2629107981220657, 1.0, 1.0123511248345831, 6.0, 1.1018867924528302, 12.0, 12.5, 1.0, 2.0, 13.0, 1.0, 1.0520388349514562, 1.3583333333333334, 1.0846713497240341, 1.0, 4.0, 1.3333333333333333, 1.8, 1.0, 5.333333333333333, 1.2272727272727273, 3.25, 1.0, 1.4, 1.0, 2.0, 2.0, 1.375, 1.0571428571428572, 1.4172185430463575, 1.6153846153846154, 1.03460531238309, 2.0, 1.492537313432836, 1.5, 1.1529850746268657, 2.0, 16.0, 2.0, 1.0478119935170178, 1.0, 1.0, 1.2566666666666666, 1.4285714285714286, 1.049162187796396, 5.0, 1.0276296655356276, 1.2505854800936769, 7.0, 3.0, 1.1388189196753429, 1.0570175438596492, 1.0, 12.0, 1.5185185185185186, 1.0, 4.333333333333333, 1.0795072788353863, 1.125, 11.75, 1.1070645019745502, 3.0, 2.066666666666667, 1.0, 1.146523178807947, 1.0, 1.0, 1.011214953271028, 1.7142857142857142, 3.5714285714285716, 2.0, 1.1428571428571428, 1.0, 1.025, 7.2, 7.5, 1.2714932126696832, 1.049553208773355, 1.0727791651801641, 1.0669885334942668, 1.0231607629427792, 2.727272727272727, 1.1, 1.1952662721893492, 1.2209944751381216, 13.0, 12.0, 11.0, 1.0, 1.305084745762712, 1.2261904761904763, 1.2608695652173914, 2.2, 1.5, 1.0, 1.5, 1.3636363636363635, 1.3376623376623376, 1.0625, 1.0754716981132075, 2.4285714285714284, 4.0, 1.0, 1.8888888888888888, 1.0, 4.0, 1.5, 1.1056603773584905, 1.0, 2.0, 1.0408163265306123, 1.118673647469459, 1.2092198581560283, 1.5666666666666667, 4.0, 1.0, 1.0, 1.0, 1.5, 1.116564417177914, 1.0283687943262412, 1.0284615384615385, 1.0559847854510875, 1.075098814229249, 1.3333333333333333, 3.5, 1.0488052872394509, 1.017467248908297, 1.0, 1.025735294117647, 1.0, 1.0279424216765454, 1.1187951807228915, 1.0, 1.1428571428571428, 1.1409395973154361, 1.0, 1.029746911359002, 2.0, 13.0, 1.1384615384615384, 1.0, 1.0, 1.1219117051437828, 1.0, 2.0, 2.0, 1.0, 1.09375, 1.2264150943396226, 1.123907863383638, 1.2692307692307692, 1.02, 1.1206597222222223, 1.0, 1.0172298427567747, 4.333333333333333, 26.0, 2.0, 2.4705882352941178, 1.3846153846153846, 1.215528781793842, 1.1785714285714286, 1.5, 1.0021674342996478, 1.25, 2.0, 1.0, 2.0, 1.0598290598290598, 4.0, 2.0, 2.0, 1.3148148148148149, 1.1341991341991342, 2.588235294117647, 1.065217391304348, 1.5, 1.6666666666666667, 1.3728813559322033, 1.0513368983957219, 1.0318716800333299, 1.0883882149046793, 1.097254004576659, 1.1526315789473685, 1.0237203495630463, 1.0, 1.0, 1.13125, 1.074698795180723, 7.2, 1.2215189873417722, 1.2159090909090908, 2.0, 1.0104529616724738, 1.3220338983050848, 2.0588235294117645, 2.75, 1.3125, 1.0434782608695652, 2.5, 1.0008699014111735, 10.0, 1.1298342541436464, 1.0245651510527922, 1.9, 1.0, 1.0522009491081656, 2.0, 1.6, 1.5753424657534247, 1.0327868852459017, 1.1282051282051282, 2.7857142857142856, 1.0, 1.0, 1.3622448979591837, 1.0, 1.10305745914602, 1.1605839416058394, 1.0, 1.2105263157894737, 1.0895522388059702, 1.1225071225071226, 2.0, 11.0, 1.6923076923076923, 1.174757281553398, 1.0854700854700854, 1.5714285714285714, 1.0, 1.0791304347826087, 1.1432355338223308, 1.0837473385379701, 1.1551724137931034, 1.0, 1.1521739130434783, 1.0769230769230769, 2.0, 1.4375, 1.2272727272727273, 1.1146245059288538, 1.0597014925373134, 1.017779803966264, 1.2142857142857142, 1.2040816326530612, 3.4, 2.0, 1.0426716141001855, 1.1187214611872147, 11.0, 2.0, 1.2374283895607894, 1.08, 3.0, 1.0795564551614891, 1.0666666666666667, 1.0316939890710382, 1.375, 2.0, 2.0, 3.0, 1.179245283018868, 1.0, 1.1832218219248585, 1.4222222222222223, 1.1333333333333333, 1.0, 1.1428571428571428, 3.0, 10.0, 1.0249307479224377, 1.0, 2.5, 1.0, 1.0, 7.5, 1.0755813953488371, 2.0, 1.1134020618556701, 10.0, 1.0039133339696478, 4.5, 1.75, 1.0366858386444893, 1.5, 1.4166666666666667, 1.5192307692307692, 1.25, 1.0870535714285714, 1.0317195325542572, 1.0285204991087344, 1.1579558652729385, 1.0, 1.4444444444444444, 2.0, 1.5434782608695652, 1.380952380952381, 1.239080459770115, 1.0325581395348837, 1.0, 1.0, 1.16016713091922, 1.005736137667304, 1.5636363636363637, 2.0, 1.0, 1.0068897637795275, 1.1691301876065947, 1.2966101694915255, 2.0, 1.5, 1.588235294117647, 1.070841239721695, 1.2625169147496618, 1.0058750773036487, 2.0, 1.011111111111111, 1.9615384615384615, 1.5280898876404494, 1.0470588235294118, 1.2395915161036921, 1.6666666666666667, 4.0, 1.375, 1.268041237113402, 1.7727272727272727, 1.0133400453058143, 1.0018726591760299, 1.0, 1.1384180790960452, 1.0674698795180724, 1.046814501935938, 1.1059190031152648, 10.0, 2.142857142857143, 2.0, 2.5, 1.613861386138614, 1.1063829787234043, 1.1428571428571428, 1.3214285714285714, 1.392156862745098, 12.0, 1.2670157068062826, 7.0, 1.0, 1.0, 1.25, 15.0, 1.0808440018966334, 1.6, 1.3333333333333333, 1.1666666666666667, 1.0656396517079705, 15.0, 1.357487922705314, 12.0, 1.4434782608695653, 1.33206106870229, 1.2850779510022272, 1.0538778311599177, 4.090909090909091, 1.0, 1.1133720930232558, 1.4317460317460318, 1.0289465831095195, 1.3333333333333333, 1.95, 1.2, 1.088199513381995, 1.1145833333333333, 1.0, 1.0, 1.0044247787610618, 13.0, 1.3333333333333333, 1.75, 1.09375, 1.1034816247582204, 1.0660377358490567, 1.1666666666666667, 1.0, 1.5, 1.1196911196911197, 1.0, 1.0006135596686778, 2.0, 1.1904761904761905, 1.5555555555555556, 8.0, 1.0, 2.0, 2.2142857142857144, 2.0, 1.186842105263158, 15.0, 2.0, 1.0, 9.0, 1.565217391304348, 1.200433369447454, 14.0, 1.5, 1.0277589051732505, 1.0, 2.0, 1.0, 1.0, 1.0, 1.0, 1.3225806451612903, 2.090909090909091, 1.0, 1.0, 1.1027056874654886, 1.1025641025641026, 1.0811823480432972, 1.0, 1.941860465116279, 14.0, 1.1923076923076923, 1.0, 1.1048218029350105, 1.5789473684210527, 1.3414634146341464, 11.0, 1.0, 7.2, 2.1666666666666665, 1.25, 3.0, 1.3794642857142858, 1.5, 1.0735294117647058, 1.1048096192384769, 1.017817371937639, 2.0, 1.0, 1.015915340388301, 2.2758620689655173, 1.0009136592051164, 1.1904761904761905, 2.0, 1.0088584322246366, 1.2857142857142858, 1.0075187969924813, 2.0, 1.5, 1.007026419336706, 1.033674963396779, 14.0, 1.0, 1.1855670103092784, 1.139502113668389, 1.0, 1.1304347826086956, 1.0996978851963746, 10.5, 1.0273972602739727, 1.2195121951219512, 1.3333333333333333, 1.0, 1.1585421412300683, 1.0, 1.6363636363636365, 2.0, 1.1368421052631579, 1.0, 1.0508415755682805, 1.0, 1.035820895522388, 1.5135135135135136, 1.4, 2.0, 8.5, 1.0, 1.0475708502024292, 1.0, 21.0, 1.0098429319371727, 6.0, 3.375, 2.0, 1.0185307743216414, 1.0, 2.0, 1.2, 1.0766283524904214, 1.054696132596685, 1.7241379310344827, 1.0, 1.0347568208778173, 3.0, 1.3333333333333333, 1.1051344743276283, 1.5, 1.0212981744421907, 6.0, 1.0, 1.0210748155953635, 1.0, 1.1885964912280702, 1.0878661087866108, 3.0, 1.3255813953488371, 1.5735294117647058, 1.2916666666666667, 3.0, 1.1875, 11.0, 1.1595330739299612, 1.7727272727272727, 10.0, 1.0341726618705036, 1.0, 1.5, 2.0, 9.0, 1.0, 1.1147260273972603, 1.0178394449950445, 1.1805425631431243, 1.3333333333333333, 2.0, 2.357142857142857, 1.1303867403314918, 1.5, 1.127388535031847, 1.1071428571428572, 1.1238938053097345, 1.0370226032735776, 1.0, 1.2630541871921181, 1.1565836298932384, 2.0, 3.0, 1.0, 1.106312292358804, 1.0456152758132957, 2.066666666666667, 1.0, 1.1205673758865249, 2.0, 1.5217391304347827, 1.0, 1.6666666666666667, 1.0888888888888888, 1.05, 1.0009538134194211, 1.1898148148148149, 1.0, 1.2424242424242424, 1.0213523131672597, 1.6, 1.181063122923588, 1.0, 3.6, 1.0, 2.0, 1.0, 1.1124780316344465, 1.0532168387609213, 1.0190058479532165, 1.0414678735452803, 1.3, 3.0, 1.0228070175438597, 2.0, 1.0, 1.1587301587301588, 1.0, 1.7222222222222223]
origin-census_1.87 	max: 27.0000	99th: 16.0000	95th: 9.0000	median: 1.1703	mean: 2.1744

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 5/15 | Workload-time: 39.430952 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 6/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=tupleskew', '--dataset=census', '--drift_test=distribution', '--end2end', '--update_size=4000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-census-2.8MB-model16.858-data14.989-200epochs-seed0.pt
GET-DATASET-PATH=./data/census/end2end/census_int.npy
TupleSkewSample - START
0.01
TupleSkewSample - END
load_npy_dataset_from_path - df.shape = (44561, 13)
Parsing... done, took 0.0s
Data updated!
Previous data size: (40561, 13), new data size: (4000, 13)
[3.4570694e-06 1.2218952e-04 1.4889240e-04 6.3180923e-06 1.3113022e-06
 1.6808510e-05 3.3676624e-05 2.9861927e-05 2.9802322e-07 2.5794506e-03
 1.1622906e-05 5.5491924e-05 4.6789646e-05]
Distance score: 0.0002350898867007345
SAUCE Drift detection: True
Detection latency: 0.0057s

DRIFT-DETECTED after 6-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=census', '--end2end', '--model=transformer', '--model_update=adapt', '--update_size=4000', '--epochs=0']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-census-2.8MB-model16.858-data14.989-200epochs-seed0.pt
update_size: 4000
AdaptTask - START
GET-DATASET-PATH=./data/census/end2end/census_int.npy
load_npy_dataset_from_path - df.shape = (44561, 13)
Parsing... done, took 0.0s
done, took 0.0s
dataset size: 44561
train data shape: torch.Size([4000, 13]), transfer data shape:torch.Size([800, 13])
Training done; evaluating likelihood on full data:
Epoch None Iter 0, test loss 11.5650 nats / 16.6848 bits
Saved to: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-census-2.8MB-model16.858-data14.989-200epochs-seed0.pt
AdaptTask - END

WORKLOAD-FINISHED | Type: DataUpdateWorkload | Progress: 6/15 | Workload-time: 3.959548 | Model-update-time: 4.467769


WORKLOAD-START | Type: QueryWorkload | Progress: 7/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--dataset=census', '--model=transformer', '--end2end', '--query_seed=0', '--eval_type=estimate', '--num_workload=15', '--data_update=tupleskew', '--model_update=adapt', '--random_seed=42']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-census-2.8MB-model16.858-data14.989-200epochs-seed0.pt
ckpts [PosixPath('/home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-census-2.8MB-model16.858-data14.989-200epochs-seed0.pt')]
Validate Argument: DATASET="census" is valid.
data size: 44561, total size: 44561, split index: [37134 44561]
Parsing... done, took 0.0s
Loading ckpt: /home/kangping/code_copy/SAUCE/models/end2end/transformer/origin-census-2.8MB-model16.858-data14.989-200epochs-seed0.pt
query_seed:0
origin-census_1.87 	max: 46.0000	99th: 25.0100	95th: 12.0000	median: 1.2144	mean: 2.6088
ReportEsts: [8.0, 1.0354885755955274, 1.675531914893617, 1.4655172413793103, 1.1, 1.2, 12.0, 1.012591815320042, 2.0, 1.0, 1.2113475177304964, 2.0, 1.2191780821917808, 1.3216957605985038, 1.2285714285714286, 1.1333333333333333, 1.0980392156862746, 1.0, 38.0, 1.0, 6.0, 1.0, 1.0451306413301662, 7.0, 1.6511627906976745, 1.3, 1.6666666666666667, 1.030119018702939, 2.0, 1.1155272919978803, 1.081764705882353, 2.1818181818181817, 1.2352941176470589, 1.2236842105263157, 1.0, 9.5, 2.75, 1.0, 2.0, 14.0, 1.0378590078328982, 1.0, 1.0425967261904763, 3.0, 1.75, 2.0, 1.089430894308943, 1.0, 1.0, 5.75, 4.0, 2.0, 1.3333333333333333, 1.0152777777777777, 1.6631944444444444, 3.4, 1.097463768115942, 1.3793103448275863, 1.25, 1.1085972850678734, 3.0434782608695654, 1.7333333333333334, 1.6666666666666667, 1.2678571428571428, 1.0105389221556886, 1.1188299817184644, 1.0903010033444815, 1.524390243902439, 1.0526315789473684, 3.0, 1.643835616438356, 2.0, 1.0879848628192998, 1.0863979848866498, 1.3333333333333333, 1.0, 4.0, 1.00164744645799, 2.2857142857142856, 5.5, 1.0, 27.0, 1.0, 1.4545454545454546, 1.2436974789915967, 1.0740740740740742, 1.0132450331125828, 1.0707456978967496, 26.0, 1.0, 2.0, 15.0, 1.2682926829268293, 1.1865771812080537, 2.0, 1.02547065337763, 12.5, 1.4013157894736843, 1.0, 2.0, 1.2, 1.103321033210332, 2.2, 2.03125, 1.1886792452830188, 1.0, 1.0, 2.0, 1.14238042269188, 1.1731160896130346, 1.306930693069307, 1.1675977653631284, 1.039579247637725, 1.2307692307692308, 1.0, 1.3333333333333333, 1.0475785896346643, 2.0, 3.0, 1.0738916256157636, 8.0, 1.2452830188679245, 1.0523834468308015, 3.0, 1.5, 1.0, 1.0520547945205478, 1.2418879056047198, 1.6635514018691588, 2.0, 1.5333333333333334, 1.053665910808768, 1.0273843248347498, 1.0, 3.0, 1.249190938511327, 1.0, 1.0147874306839186, 2.0, 1.0, 1.0, 2.0, 1.0, 1.25, 1.0, 1.0, 1.072525420211662, 1.04318418314256, 3.0, 1.2685274302213667, 1.14006366530241, 19.0, 4.0, 16.0, 1.0, 1.0485436893203883, 1.0124469589816125, 1.1666666666666667, 1.0939737470167064, 1.0, 1.1818181818181819, 1.2380952380952381, 1.0236686390532543, 1.2152542372881356, 2.8, 1.3265306122448979, 1.0086447295036252, 1.0740740740740742, 1.0165589660743135, 46.0, 2.0, 1.44, 1.2692307692307692, 1.0122699386503067, 1.6595744680851063, 1.1428571428571428, 1.5681818181818181, 1.3333333333333333, 2.0, 3.3333333333333335, 2.0, 1.0, 1.282758620689655, 1.1827586206896552, 1.0, 1.0437956204379562, 1.7142857142857142, 5.0, 1.0684931506849316, 1.2142857142857142, 1.0, 1.0561797752808988, 1.0, 1.6, 2.0, 1.0347355003186742, 1.3448275862068966, 1.135135135135135, 1.0, 1.0491803278688525, 1.3125, 1.0, 1.1551362683438156, 1.1568930041152263, 1.0333333333333334, 2.107142857142857, 1.0, 4.0, 1.0, 1.0, 1.5, 3.0, 1.0631238990017615, 3.0, 13.0, 1.0346715328467153, 1.1168831168831168, 2.142857142857143, 1.0089485458612975, 1.3333333333333333, 1.301948051948052, 1.008124314913921, 1.0, 1.0, 1.0052083333333333, 1.126005361930295, 1.2, 5.25, 1.0885668276972624, 1.0307692307692307, 1.6, 1.0044280442804427, 2.0, 1.0682111512648425, 1.0, 1.0, 1.5486725663716814, 2.0, 12.0, 1.0539811066126856, 1.1683168316831682, 1.0, 1.11875, 2.0, 1.0814606741573034, 1.3636363636363635, 2.0, 2.0, 1.0577689243027888, 1.0020808561236623, 1.1145833333333333, 8.0, 1.8518518518518519, 1.275, 1.0, 1.0, 1.0412168792934249, 1.4454545454545455, 1.0800970873786409, 1.1936989498249708, 19.0, 1.0290920716112533, 1.12, 2.945945945945946, 1.0, 1.3, 1.3617021276595744, 1.0, 1.2105263157894737, 22.0, 1.1842105263157894, 1.0786970993818354, 2.066666666666667, 1.2391304347826086, 2.4, 1.46875, 1.036741214057508, 1.3333333333333333, 2.5, 1.1855670103092784, 1.0360938439943854, 1.0616740088105727, 1.3151515151515152, 1.1429359823399559, 2.0, 2.0, 1.0628865979381443, 1.141732283464567, 1.1869565217391305, 1.5, 2.0, 1.1121583411875589, 1.0, 3.0, 1.3371428571428572, 1.6666666666666667, 1.031858407079646, 2.0, 1.1685393258426966, 2.0, 1.4, 2.0, 1.15625, 3.2, 1.0, 1.2222222222222223, 1.8888888888888888, 1.0, 1.15, 1.0, 2.0, 1.0, 1.1000523834468308, 12.0, 1.0316785783272164, 1.0, 1.081573896353167, 2.75, 3.0, 22.0, 1.2857142857142858, 2.0, 1.0729145211122555, 2.0, 1.053706169551709, 1.3333333333333333, 1.0, 1.1083477508650519, 1.4166666666666667, 1.0, 1.0, 1.0, 3.75, 1.3333333333333333, 1.3253424657534247, 1.0, 2.0, 13.0, 11.0, 4.5, 1.0, 1.0768141592920355, 1.155367231638418, 10.0, 1.0812151270923744, 2.0, 2.4444444444444446, 1.25, 1.0, 2.0, 1.0517706576728498, 1.0, 1.5555555555555556, 10.0, 1.049618320610687, 1.1574803149606299, 1.0, 6.333333333333333, 6.0, 23.0, 1.2229299363057324, 1.0493827160493827, 1.0062893081761006, 1.0726548892759393, 1.064516129032258, 29.0, 1.0695404636030907, 1.0, 1.0287769784172662, 1.5, 1.3411764705882352, 1.0, 1.3333333333333333, 2.0, 1.1578947368421053, 2.0, 1.3333333333333333, 2.0, 1.2105263157894737, 1.0, 1.2072072072072073, 1.0, 2.0, 1.0, 1.7916666666666667, 2.5, 1.0887772194304857, 2.0, 29.0, 1.3, 12.0, 1.0185185185185186, 2.0533333333333332, 3.0, 2.4, 24.0, 29.0, 1.0, 1.0491228070175438, 1.5, 1.1596045197740112, 1.0418181818181818, 2.8, 22.0, 1.7301587301587302, 1.0044331855604813, 3.0, 14.0, 1.3157894736842106, 1.336283185840708, 1.3170731707317074, 7.0, 1.25, 1.7209302325581395, 1.0, 22.0, 3.076923076923077, 1.294871794871795, 13.0, 3.0, 1.1364902506963788, 1.068452380952381, 1.1635687732342008, 1.6666666666666667, 1.0, 2.8461538461538463, 1.5472972972972974, 1.4090909090909092, 1.1041666666666667, 1.0, 1.0315638450502151, 4.0, 1.0065573770491802, 12.0, 8.333333333333334, 1.125, 3.0, 13.0, 1.0, 1.016381507098653, 1.204225352112676, 1.0249363327674024, 1.0, 2.0, 1.5, 4.5, 1.0, 3.2, 1.3611111111111112, 2.5384615384615383, 1.0, 1.5, 1.0, 2.0, 2.0, 1.7692307692307692, 1.1061946902654867, 1.0972222222222223, 2.625, 1.0651408450704225, 2.0, 1.0896860986547086, 3.6666666666666665, 1.0933977455716586, 2.0, 25.0, 2.0, 1.0180995475113122, 1.0, 1.0, 1.0685279187817258, 1.176991150442478, 1.0427698574338085, 1.093150684931507, 1.0499139414802066, 2.1, 2.0, 3.0, 2.230769230769231, 1.3864734299516908, 1.0, 12.0, 2.9272727272727272, 10.0, 4.333333333333333, 1.0738940204180847, 1.1111111111111112, 19.333333333333332, 1.037198258804907, 3.0, 1.525, 1.0569558894813378, 1.0347446898297932, 1.5681818181818181, 1.5, 1.0, 14.0, 2.75, 2.0, 1.1240875912408759, 4.615384615384615, 1.0, 1.0952380952380953, 1.0, 1.0566037735849056, 1.0, 1.0051639106469394, 1.235, 1.186206896551724, 2.0, 1.1473684210526316, 1.0925925925925926, 1.1685393258426966, 3.75, 2.5, 1.2036036036036035, 1.0, 1.0412811387900356, 1.894736842105263, 1.0360655737704918, 1.0810810810810811, 1.1693719124911786, 1.4290123456790123, 1.0, 1.435897435897436, 1.2708333333333333, 1.00836820083682, 1.0, 1.0, 1.0168067226890756, 1.0, 1.0, 1.0, 1.5, 1.0, 5.0, 7.5, 1.0, 1.2050359712230216, 1.0879368658399098, 1.0, 1.6653992395437263, 2.25, 1.2481203007518797, 2.0, 1.2549167927382754, 1.055855855855856, 1.0076994557281296, 1.0, 1.2318840579710144, 1.2592592592592593, 26.0, 1.0, 1.1428571428571428, 2.9166666666666665, 1.0406504065040652, 1.070921985815603, 1.0, 1.1776937618147447, 1.0, 1.1254416961130742, 1.0541943521594683, 1.0, 2.9, 1.160621761658031, 2.25, 1.0406290072214348, 2.0, 13.0, 1.1857142857142857, 1.0, 1.0, 1.1703531237873497, 1.0, 1.5, 3.0, 1.15, 1.1921397379912664, 1.6984126984126984, 1.0308310991957104, 1.2222222222222223, 1.1176470588235294, 1.1855840927920465, 15.0, 1.0330578512396693, 13.0, 26.0, 1.5, 4.6923076923076925, 1.3846153846153846, 1.1245714285714286, 1.5234375, 1.0, 11.0, 1.0, 2.0, 1.5, 1.0, 1.0174825174825175, 1.5, 3.0, 1.0, 2.253731343283582, 1.2439024390243902, 1.1578947368421053, 1.0, 1.5, 1.3636363636363635, 1.0432098765432098, 1.0175438596491229, 1.0513468832052904, 1.1669505962521294, 1.3356973995271868, 1.0219298245614035, 1.1282608695652174, 1.0, 1.0, 1.0866666666666667, 1.1292596944770859, 6.0, 1.017751479289941, 1.268987341772152, 2.0, 1.1116333725029377, 1.0375426621160408, 1.9444444444444444, 1.2727272727272727, 1.2352941176470589, 1.1666666666666667, 1.6818181818181819, 1.0268578168950186, 10.0, 1.1439205955334988, 1.080449571132801, 3.1052631578947367, 1.0, 1.0839097744360902, 2.0, 1.5, 1.2307692307692308, 2.051282051282051, 1.2307692307692308, 1.1282051282051282, 1.0, 1.0, 1.175257731958763, 1.0, 1.0805084745762712, 1.0784313725490196, 1.0, 1.0, 1.1689497716894977, 1.828125, 2.0, 11.0, 2.3333333333333335, 1.2767527675276753, 1.072, 1.0, 1.1111111111111112, 1.024617776626069, 1.101125603001608, 1.0612516644474035, 1.0133333333333334, 1.0, 1.0932475884244373, 1.5384615384615385, 3.0, 1.3529411764705883, 1.173913043478261, 1.056390977443609, 1.0789473684210527, 1.054172127566623, 1.0808823529411764, 1.3333333333333333, 1.4051724137931034, 1.9047619047619047, 2.0, 1.0, 1.0, 5.0, 1.4887640449438202, 1.1168831168831168, 7.5, 1.0630347751000864, 1.0810810810810811, 1.0034877927254608, 1.75, 1.0, 2.0, 2.8333333333333335, 1.32, 1.5, 1.1716111364673665, 1.2073578595317727, 2.125, 1.0, 1.5238095238095237, 3.0, 10.0, 1.051219512195122, 1.0, 2.0, 1.0, 1.0, 12.5, 1.0358851674641147, 2.0, 1.35, 1.3, 1.0307990144315382, 8.0, 1.5, 1.070965797800211, 2.0, 2.125, 1.694915254237288, 1.5, 1.7030716723549488, 1.0503246753246753, 1.0976027397260273, 1.0390334572490707, 1.0, 1.3636363636363635, 2.0, 1.2241379310344827, 1.4761904761904763, 1.2336244541484715, 1.050779171417712, 1.25, 1.0, 1.1551939924906132, 1.0144665461121158, 2.15, 1.0, 1.0, 1.0664857530529173, 1.1017406227016426, 1.5333333333333334, 2.0, 2.0, 1.2926136363636365, 1.1544980443285529, 1.2176211453744494, 6.5, 3.0, 1.0222799048237075, 1.375, 6.0, 3.5, 1.625, 1.0221932114882506, 2.1666666666666665, 4.0, 1.25, 1.5157894736842106, 3.5454545454545454, 1.0276052449965494, 2.8, 2.0, 3.0, 2.0, 1.0256410256410255, 1.070291777188329, 1.4545454545454546, 1.093421779988944, 1.0, 3.125, 1.3590504451038576, 1.2659574468085106, 1.1428571428571428, 1.121212121212121, 1.1833333333333333, 12.0, 1.0, 7.0, 1.0, 1.0, 1.375, 15.0, 1.048093220338983, 1.6, 1.3333333333333333, 2.3333333333333335, 1.0598802395209581, 19.0, 1.0414746543778801, 3.1666666666666665, 1.1020408163265305, 1.0113788487282462, 1.060134784862623, 1.0, 4.0, 1.0, 1.65, 1.5, 1.0, 1.2512562814070352, 1.0, 2.0, 1.0, 1.5, 1.7142857142857142, 1.145374449339207, 13.0, 1.368107302533532, 2.1, 1.0571428571428572, 1.1690777576853526, 1.168141592920354, 8.5, 13.0, 1.2, 1.1426533523537803, 2.3333333333333335, 3.0, 1.1153846153846154, 1.0404040404040404, 10.8, 1.0856060606060607, 1.0360429447852761, 1.0423418714061683, 3.1904761904761907, 1.0, 1.0, 1.5, 1.7, 1.1041666666666667, 20.0, 5.5, 1.0158730158730158, 1.0, 1.434782608695652, 1.0200448765893793, 17.0, 1.0655737704918034, 1.1056338028169015, 1.3023952095808384, 1.0050581689428426, 2.0, 1.7238805970149254, 1.5, 1.0934959349593496, 2.0, 1.3896103896103895, 1.0813226094727435, 1.096774193548387, 1.0, 1.0526315789473684, 1.0241545893719808, 3.2142857142857144, 1.3614678899082568, 1.1090342679127725, 8.5, 1.146341463414634, 2.1578947368421053, 1.3333333333333333, 1.0085455477696121, 1.15018315018315, 12.0, 2.0, 1.4673913043478262, 1.3611111111111112, 2.5, 1.0647058823529412, 1.0, 1.3006329113924051, 1.3304347826086957, 1.0, 1.0293775676304162, 1.128, 1.0938441670253982, 1.04, 1.0, 1.5880398671096345, 1.2857142857142858, 1.048951048951049, 1.1888888888888889, 1.0, 1.0352112676056338, 1.0295521709479427, 1.0080645161290323, 1.08, 1.0602526724975705, 1.1538461538461537, 11.75, 2.0, 16.0, 1.2916666666666667, 1.072829131652661, 2.0, 1.0636734693877552, 2.0, 2.3333333333333335, 1.096476510067114, 1.0, 1.4, 6.5, 1.5593220338983051, 1.0556049822064058, 1.0099079971691436, 26.0, 1.6923076923076923, 1.380952380952381, 1.0, 1.253968253968254, 1.5, 4.0, 1.4, 6.0, 1.060381861575179, 1.0198019801980198, 1.0, 3.0, 1.6349206349206349, 1.4322916666666667, 9.0, 2.0, 1.0, 1.0663316582914573, 1.621212121212121, 1.0666239590006406, 2.0, 2.0, 6.5, 3.0, 1.0, 17.0, 1.267605633802817, 1.8333333333333333, 1.0, 1.2876318312559922, 1.0, 1.0357142857142858, 1.038022813688213, 3.0, 1.3877551020408163, 1.0393518518518519, 1.088235294117647, 3.0, 1.0166666666666666, 11.0, 1.0, 1.6818181818181819, 10.0, 1.0205627705627707, 1.0, 1.6, 3.0, 9.0, 1.0, 1.160563896008788, 1.1181902123730378, 1.2595419847328244, 1.3333333333333333, 2.0, 2.2142857142857144, 1.0338983050847457, 1.0969162995594715, 1.2526041666666667, 1.6153846153846154, 1.0684156378600822, 1.023585742152864, 1.0, 1.2600170502983803, 1.2145998240985048, 2.0, 5.0, 1.0, 1.046583850931677, 1.2112518628912072, 2.8181818181818183, 1.0, 1.0319148936170213, 1.0, 1.3714285714285714, 12.666666666666666, 1.2836879432624113, 1.1333333333333333, 1.1904761904761905, 1.0137083912999219, 1.1222707423580787, 1.0, 1.5833333333333333, 1.1174242424242424, 1.3333333333333333, 1.0714285714285714, 1.6666666666666667, 4.333333333333333, 1.0, 2.0, 1.0, 1.0615863141524107, 1.0380014074595356, 1.0173564753004005, 1.0302158856170764, 1.5789473684210527, 1.0, 1.2036697247706423, 2.0]
origin-census_1.87 	max: 46.0000	99th: 25.0100	95th: 12.0000	median: 1.2144	mean: 2.6088

...Done, result: results.csv

WORKLOAD-FINISHED | Type: QueryWorkload | Progress: 7/15 | Workload-time: 39.635697 | Model-update-time: 0.000000


WORKLOAD-START | Type: DataUpdateWorkload | Progress: 8/15
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/eval_model.py', '--model=transformer', '--data_update=tupleskew', '--dataset=census', '--drift_test=distribution', '--end2end', '--update_size=4000', '--query_seed=0', '--eval_type=drift']
Torch device: cuda:1
GET-MODEL-PATH=./models/end2end/transformer/origin-census-2.8MB-model16.858-data14.989-200epochs-seed0.pt
GET-DATASET-PATH=./data/census/end2end/census_int.npy
TupleSkewSample - START
0.01
TupleSkewSample - END
load_npy_dataset_from_path - df.shape = (48561, 13)
Parsing... done, took 0.0s
Data updated!
Previous data size: (44561, 13), new data size: (4000, 13)
[5.7995319e-05 3.8862228e-05 3.3974648e-06 2.6702881e-05 1.2576580e-05
 1.0669231e-05 1.1205673e-05 1.8358231e-05 2.2053719e-06 2.6869774e-04
 7.6234341e-05 5.9604645e-08 7.6889992e-06]
Distance score: 4.112720489501953e-05
SAUCE Drift detection: True
Detection latency: 0.0064s

DRIFT-DETECTED after 8-th workload
Going to run: ['python', '/home/kangping/code_copy/SAUCE/Naru/incremental_train.py', '--dataset=census', '--end2end', '--model=transformer', '--model_update=adapt', '--update_size=4000', '--epochs=0']
